<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="UTF-8">
<meta property="og:type" content="website">
<meta property="og:title" content="1319070 - (CVE-2017-5386) Web Extension's data: scheme pages can be controlled by other extensions">
<meta property="og:url" content="https://bugzilla.mozilla.org/show_bug.cgi?id=1319070">
<meta property="og:description"
      content="VERIFIED (tomica) in WebExtensions - General. Last updated 2018-06-19.">
<meta name="twitter:label1" value="Type">
<meta name="twitter:data1" value="defect">
<meta name="twitter:label2" value="Priority">
<meta name="twitter:data2" value="--">

    <meta name="viewport" content="width=1024">
    <meta name="color-scheme" content="dark light">
    <meta name="generator" content="Bugzilla 20211025.1">
    <meta name="bugzilla-global" content="dummy"
        id="bugzilla-global" data-bugzilla="{&quot;api_token&quot;:&quot;&quot;,&quot;config&quot;:{&quot;basepath&quot;:&quot;\/&quot;},&quot;constant&quot;:{&quot;COMMENT_COLS&quot;:80},&quot;param&quot;:{&quot;maxattachmentsize&quot;:&quot;10240&quot;,&quot;maxusermatches&quot;:&quot;50&quot;,&quot;splinter_base&quot;:&quot;\/page.cgi?id=splinter.html&amp;ignore=\/&quot;},&quot;string&quot;:{&quot;bug_type_required&quot;:&quot;You must select a Type for this bug&quot;,&quot;component_required&quot;:&quot;You must select a Component for this bug&quot;,&quot;description_required&quot;:&quot;You must enter a Description for this bug&quot;,&quot;short_desc_required&quot;:&quot;You must enter a Summary for this bug&quot;,&quot;version_required&quot;:&quot;You must select a Version for this bug&quot;},&quot;user&quot;:{&quot;is_new&quot;:1,&quot;login&quot;:&quot;&quot;}}">
    <title>1319070 - (CVE-2017-5386) Web Extension's data: scheme pages can be controlled by other extensions</title>

<link rel="Top" href="/">

  


  
    <link rel="Show" title="Dependency Tree"
          href="/showdependencytree.cgi?id=1319070&amp;hide_resolved=1">
      <link rel="Show" title="Dependency Graph"
            href="/showdependencygraph.cgi?id=1319070">

      <link rel="Show" title="Bug Activity"
            href="/show_activity.cgi?id=1319070">

<link href="/static/v20211025.1/skins/yui.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/standard/global.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BugModal/web/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BMO/web/styles/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/EditComments/web/styles/inline-editor.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-structure-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-theme-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/lib/prism.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Needinfo/web/styles/needinfo.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Review/web/styles/badge.css" rel="stylesheet" type="text/css">



    
<script nonce="jCtRVzj2MrzudWA4ELX1NfaEJJGLjr9sZNqBH9iZX2aHPZMN" src="/static/v20211025.1/js/jquery/jquery-min.js"></script><script nonce="jCtRVzj2MrzudWA4ELX1NfaEJJGLjr9sZNqBH9iZX2aHPZMN" src="/static/v20211025.1/js/jquery/ui/jquery-ui-min.js"></script><script nonce="jCtRVzj2MrzudWA4ELX1NfaEJJGLjr9sZNqBH9iZX2aHPZMN" src="/static/v20211025.1/js/yui.js"></script><script nonce="jCtRVzj2MrzudWA4ELX1NfaEJJGLjr9sZNqBH9iZX2aHPZMN" src="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu-min.js"></script><script nonce="jCtRVzj2MrzudWA4ELX1NfaEJJGLjr9sZNqBH9iZX2aHPZMN" src="/static/v20211025.1/js/jquery/plugins/devbridgeAutocomplete/devbridgeAutocomplete-min.js"></script><script nonce="jCtRVzj2MrzudWA4ELX1NfaEJJGLjr9sZNqBH9iZX2aHPZMN" src="/static/v20211025.1/js/global.js"></script><script nonce="jCtRVzj2MrzudWA4ELX1NfaEJJGLjr9sZNqBH9iZX2aHPZMN" src="/static/v20211025.1/js/util.js"></script><script nonce="jCtRVzj2MrzudWA4ELX1NfaEJJGLjr9sZNqBH9iZX2aHPZMN" src="/static/v20211025.1/js/dropdown.js"></script>

      <script nonce="jCtRVzj2MrzudWA4ELX1NfaEJJGLjr9sZNqBH9iZX2aHPZMN">
          YAHOO.namespace('bugzilla');
          if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
              YAHOO.util.Event._simpleRemove(window, "unload",
                                             YAHOO.util.Event._unload);
          }BUGZILLA.value_descs = JSON.parse('{\"bug_status\":{},\"resolution\":{\"\":\"---\"}}');

  
    var tracking_flags_str = "{\"comments\":{\"cf_tracking_firefox93\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr78\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox51\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr91\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox53\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox95\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr45\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_relnote\":{\"?\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox_sumo\":{\"none-needed\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox52\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox94\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_a11y_review_project_flag\":{\"requested\":\"Description:\\nPlease provide an explanation of the feature or change. Include a description of the user scenario in which it would be used and how the user would complete the task(s).\\nScreenshots and visual UI specs are welcome, but please include sufficient accompanying explanation so that blind members of the accessibility team are able to understand the feature\/change.\\n\\nHow do we test this?\\nIf there is an implementation to test, please provide instructions for testing it; e.g. setting preferences, other preparation, how to trigger the UI, etc.\\n\\nWhen will this ship?\\nTracking bug\/issue:\\nDesign documents (e.g. Product Requirements Document, UI spec):\\nEngineering lead:\\nProduct manager:\\n\\nThe accessibility team has developed the Mozilla Accessibility Release Guidelines which outline what is needed to make user interfaces accessible:\\nhttps:\/\/wiki.mozilla.org\/Accessibility\/Guidelines\\nPlease describe the accessibility guidelines you considered and what steps you\'ve taken to address them:\\n\\nDescribe any areas of concern to which you want the accessibility team to give special attention:\"}},\"flags\":{\"project\":{\"cf_webcompat_priority\":\"---\",\"cf_a11y_review_project_flag\":\"---\",\"cf_tracking_firefox_sumo\":\"---\",\"cf_fission_milestone\":\"---\",\"cf_root_cause\":\"---\"},\"tracking\":{\"cf_status_firefox_esr45\":\"verified\",\"cf_status_thunderbird_esr91\":\"---\",\"cf_status_thunderbird_esr78\":\"---\",\"cf_tracking_firefox52\":\"+\",\"cf_tracking_firefox94\":\"---\",\"cf_tracking_firefox_esr91\":\"---\",\"cf_status_firefox_esr78\":\"---\",\"cf_status_firefox94\":\"---\",\"cf_tracking_firefox_esr78\":\"---\",\"cf_tracking_firefox93\":\"---\",\"cf_status_firefox50\":\"wontfix\",\"cf_tracking_thunderbird_esr91\":\"---\",\"cf_tracking_firefox_relnote\":\"---\",\"cf_tracking_firefox95\":\"---\",\"cf_status_firefox52\":\"verified\",\"cf_tracking_firefox_esr45\":\"51+\",\"cf_status_firefox93\":\"---\",\"cf_status_firefox95\":\"---\",\"cf_tracking_thunderbird_esr78\":\"---\",\"cf_tracking_firefox51\":\"+\",\"cf_tracking_firefox53\":\"+\",\"cf_status_firefox51\":\"verified\",\"cf_status_firefox53\":\"verified\",\"cf_status_firefox_esr91\":\"---\"},\"blocking\":{\"cf_blocking_webextensions\":\"---\"}},\"types\":[\"blocking\",\"tracking\"]}";
    var TrackingFlags = $.parseJSON(tracking_flags_str);

  

  
  BUGZILLA.bug_id = 1319070;
  BUGZILLA.bug_title = '1319070 - (CVE-2017-5386) Web Extension\'s data: scheme pages can be controlled by other extensions';
  BUGZILLA.bug_summary = 'Web Extension\'s data: scheme pages can be controlled by other extensions';
  BUGZILLA.bug_url = 'https:\/\/bugzilla.mozilla.org\/show_bug.cgi?id=1319070';
  BUGZILLA.bug_keywords = 'sec-moderate',
  BUGZILLA.user = {
    id: 0,
    login: '',
    is_insider: false,
    is_timetracker: false,
    can_tag: false,
    timezone: 'America\/Los_Angeles',
    settings: {
      quote_replies: 'quoted_reply',
      zoom_textareas: true,
      remember_collapsed: true,
      inline_attachments: true,
      autosize_comments: false
    }
  };

  BUGZILLA.bug_secure = false;
      </script>
<script nonce="jCtRVzj2MrzudWA4ELX1NfaEJJGLjr9sZNqBH9iZX2aHPZMN" src="/static/v20211025.1/extensions/BugModal/web/autosize.min.js"></script><script nonce="jCtRVzj2MrzudWA4ELX1NfaEJJGLjr9sZNqBH9iZX2aHPZMN" src="/static/v20211025.1/extensions/ProdCompSearch/web/js/prod_comp_search.js"></script><script nonce="jCtRVzj2MrzudWA4ELX1NfaEJJGLjr9sZNqBH9iZX2aHPZMN" src="/static/v20211025.1/extensions/BugModal/web/bug_modal.js"></script><script nonce="jCtRVzj2MrzudWA4ELX1NfaEJJGLjr9sZNqBH9iZX2aHPZMN" src="/static/v20211025.1/extensions/BugModal/web/comments.js"></script><script nonce="jCtRVzj2MrzudWA4ELX1NfaEJJGLjr9sZNqBH9iZX2aHPZMN" src="/static/v20211025.1/extensions/ComponentWatching/web/js/overlay.js"></script><script nonce="jCtRVzj2MrzudWA4ELX1NfaEJJGLjr9sZNqBH9iZX2aHPZMN" src="/static/v20211025.1/js/bugzilla-readable-status-min.js"></script><script nonce="jCtRVzj2MrzudWA4ELX1NfaEJJGLjr9sZNqBH9iZX2aHPZMN" src="/static/v20211025.1/js/field.js"></script><script nonce="jCtRVzj2MrzudWA4ELX1NfaEJJGLjr9sZNqBH9iZX2aHPZMN" src="/static/v20211025.1/js/comments.js"></script><script nonce="jCtRVzj2MrzudWA4ELX1NfaEJJGLjr9sZNqBH9iZX2aHPZMN" src="/static/v20211025.1/extensions/TrackingFlags/web/js/flags.js"></script><script nonce="jCtRVzj2MrzudWA4ELX1NfaEJJGLjr9sZNqBH9iZX2aHPZMN" src="/static/v20211025.1/extensions/BMO/web/js/firefox-crash-table.js"></script><script nonce="jCtRVzj2MrzudWA4ELX1NfaEJJGLjr9sZNqBH9iZX2aHPZMN" src="/static/v20211025.1/extensions/MozChangeField/web/js/severity-s1-priority-p1.js"></script><script nonce="jCtRVzj2MrzudWA4ELX1NfaEJJGLjr9sZNqBH9iZX2aHPZMN" src="/static/v20211025.1/extensions/MozChangeField/web/js/clear-tracking-priority-s1.js"></script><script nonce="jCtRVzj2MrzudWA4ELX1NfaEJJGLjr9sZNqBH9iZX2aHPZMN" src="/static/v20211025.1/extensions/MozChangeField/web/js/set-tracking-severity-s1.js"></script><script nonce="jCtRVzj2MrzudWA4ELX1NfaEJJGLjr9sZNqBH9iZX2aHPZMN" src="/static/v20211025.1/js/lib/prism.js"></script><script nonce="jCtRVzj2MrzudWA4ELX1NfaEJJGLjr9sZNqBH9iZX2aHPZMN" src="/static/v20211025.1/extensions/GoogleAnalytics/web/js/analytics.js"></script><script nonce="jCtRVzj2MrzudWA4ELX1NfaEJJGLjr9sZNqBH9iZX2aHPZMN" src="/static/v20211025.1/js/lib/md5.min.js"></script><script nonce="jCtRVzj2MrzudWA4ELX1NfaEJJGLjr9sZNqBH9iZX2aHPZMN" src="/static/v20211025.1/extensions/Review/web/js/badge.js"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla@Mozilla" href="/search_plugin.cgi"><link rel="shortcut icon" href="/extensions/BMO/web/images/favicon.ico">
<link rel="canonical" href="https://bugzilla.mozilla.org/show_bug.cgi?id=1319070">
<link rel="shorturl" href="https://bugzilla.mozilla.org/1319070"><meta name="google-analytics" content="UA-36116321-3" data-location="https://bugzilla.mozilla.org/bug/show-modal" data-title="1319070 - (CVE-2017-5386) Web Extension's data: scheme pages can be controlled by other extensions">
<script async src="https://www.google-analytics.com/analytics.js"></script><meta name="robots" content="noarchive">
  </head>



  <body
        class="bugzilla-mozilla-org
               skin-standard bug_modal yui-skin-sam">



<div id="wrapper">

<header id="header" role="banner">
  <div class="inner">
    <h1 id="header-title" class="title"><a href="https://bugzilla.mozilla.org/home" title="Go to home page">Bugzilla</a></h1>
    <form role="search" id="header-search" class="quicksearch" action="/buglist.cgi" data-no-csrf>
      <section class="searchbox-outer dropdown" role="combobox" aria-expanded="false" aria-haspopup="listbox"
               aria-labelledby="header-search-label" aria-owns="header-search-dropdown">
        <h2 id="header-search-label">Quick Search</h2>
        <span class="icon" aria-hidden="true"></span>
        <input role="searchbox" id="quicksearch_top" class="dropdown-button" name="quicksearch" autocomplete="off"
               value="" placeholder="Search Bugs"
               title="Enter a bug number or some search terms" aria-controls="header-search-dropdown"
               aria-label="Quick Search"><div id="header-search-dropdown" class="dropdown-content right" role="listbox" style="display: none;">
  <div id="header-search-dropdown-wrapper">
  </div>
</div>
      </section>
    </form>
    <nav id="header-nav">
      <ul class="links">
        <li class="link-browse">
          <a href="/describecomponents.cgi" title="Browse bugs by component">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Browse</span>
          </a>
        </li>
        <li class="link-search">
          <a href="/query.cgi?format=advanced" title="Search bugs using various criteria">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Advanced Search</span>
          </a>
        </li>
      </ul>
      <div class="dropdown">
        <button type="button" id="header-tools-menu-button" class="dropdown-button minor" title="More tools…"
                aria-label="More tools…" aria-expanded="false" aria-haspopup="true" aria-controls="header-tools-menu">
          <span class="icon" aria-hidden="true"></span>
        </button>
        <ul class="dropdown-content left" id="header-tools-menu" role="menu" style="display:none;">
          <li role="presentation">
            <a href="/report.cgi" role="menuitem" tabindex="-1">Reports</a>
          </li>
            <li role="separator"></li>
            <li role="presentation">
              <a href="https://bmo.readthedocs.io/en/latest/" role="menuitem" tabindex="-1">Documentation</a>
            </li>
        </ul>
      </div>
    </nav>
      <ul id="header-login" class="links">
          <li id="moz_new_account_container_top"><a href="/createaccount.cgi">New Account</a></li><li id="mini_login_container_top">
  <a id="login_link_top" href="/index.cgi?GoAheadAndLogIn=1"
     class='show_mini_login_form' data-qs-suffix="_top">Log In</a>

  <div id="mini_login_top" class="mini-popup mini_login bz_default_hidden"><span id="github_mini_login_top" class="mini_login_top">
    <form method="post" action="/github.cgi">
      <input type="hidden" name="github_secret" value="urKNrymqts0AsQJgyfHZRtMqdmVd94dTJMelie5KaBJvBmzJBbCOD7oSH5KJRQ61sRlIJv5QdnLHN3oDiaHJnS2ceBqgzEv35Lt8dZx4dffvKdcYwXr1Vo34IBgV7MtMQxcxqgG7lgr6yvseNeSeRAkUjg2KrVBwl2vj32xaW2xQ7BMFM0aobaJ7Uxc4ghZG4tnzeQ4x96kAPZvkvajL6IIiHyGo5hzGGIZwvi0s6NsHUCIZ1XdF8LPUxNlFkpTE">
      <input type="hidden" name="target_uri" value="https://bugzilla.mozilla.org/show_bug.cgi">
      <input type="image" src="/extensions/GitHubAuth/web/images/sign_in.png" height="22" width="75" align="absmiddle"
             alt="Sign in with GitHub"
             title="Sign in with GitHub"> or
    </form>
  </span>

  <form action="/show_bug.cgi?id=1319070" method="POST"
        data-qs-suffix="_top">

    <input id="Bugzilla_login_top"
           class="bz_login"
           name="Bugzilla_login"
           title="Login"
           placeholder="Email"
           aria-label="Email"
           type="email"
           required
    >
    <input class="bz_password"
           id="Bugzilla_password_top"
           name="Bugzilla_password"
           type="password"
           title="Password"
           placeholder="Password"
           aria-label="Password"
           required
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text"
           id="Bugzilla_password_dummy_top" value="password"
           title="Password"
    >
      <input type="checkbox" id="Bugzilla_remember_top"
             name="Bugzilla_remember" value="on" class="bz_remember"
                 checked>
      <label for="Bugzilla_remember_top">Remember</label>
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
           class="check_mini_login_fields"
            id="log_in_top">
    <a href="#" id="hide_mini_login_top" aria-label="Close"
       class="close-button hide_mini_login_form" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
<li id="forgot_container_top">
  <a id="forgot_link_top" href="/index.cgi?GoAheadAndLogIn=1#forgot"
     class='show_forgot_form'
     data-qs-suffix="_top">Forgot Password</a>
  <div id="forgot_form_top" class="mini-popup mini_forgot bz_default_hidden">
  <form action="/token.cgi" method="post">
    <input type="email" name="loginname" size="20" placeholder="Email" aria-label="Email" required>
    <input id="forgot_button_top" value="Reset Password"
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <input type="hidden" id="token_top" name="token" value="1635623082-aiQ8ECna5ZjQ8bPr-4T8i1iCcvkG6uqGWfKanrOv5qY">
    <a href="#" class="close-button hide_forgot_form" aria-label="Close" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
      </ul><div id="header-external-links" class="dropdown first">
  <button type="button" id="header-external-menu-button" class="dropdown-button minor" title="Mozilla"
          aria-label="Mozilla" aria-expanded="false" aria-haspopup="true" aria-controls="header-external-menu">
    <img src="/static/v20211025.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg" width="32" height="32" alt="">
  </button>
  <ul class="dropdown-content right" id="header-external-menu" role="menu" style="display:none;">
    <li role="presentation">
      <a href="https://www.mozilla.org/" role="menuitem" tabindex="-1">Mozilla Home</a>
    </li>
    <li role="separator"></li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/" role="menuitem" tabindex="-1">Privacy</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/#cookies" role="menuitem" tabindex="-1">Cookies</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/about/legal/" role="menuitem" tabindex="-1">Legal</a>
    </li>
  </ul>
</div>
  </div>
</header> 


<main id="bugzilla-body" tabindex="-1">

<aside id="message-container" role="complementary">
  <noscript>
    <div class="noscript">
      <div class="inner">
        <p>Please enable JavaScript in your browser to use all the features on this site.</p>
      </div>
    </div>
  </noscript>
</aside>

<div id="main-inner">




<div role="toolbar" id="page-toolbar">
  <div role="group" class="buttons">
    <button type="button" id="copy-summary" class="secondary"
      title="Copy bug number and summary to your clipboard">Copy Summary</button>
    <div id="clip-container" style="display:none"><input type="text" id="clip"></div>
    <div class="dropdown">
      <button type="button" id="action-menu-btn" aria-haspopup="true" aria-label="View"
        aria-expanded="false" aria-controls="action-menu" class="dropdown-button secondary">View &#9662;</button>
      <ul class="dropdown-content left" id="action-menu" role="menu" style="display:none;">
        <li role="presentation">
          <a id="action-reset" role="menuitem" tabindex="-1">Reset Sections</a>
        </li>
        <li role="presentation">
          <a id="action-expand-all" role="menuitem" tabindex="-1">Expand All Sections</a>
        </li>
        <li role="presentation">
          <a id="action-collapse-all" role="menuitem" tabindex="-1">Collapse All Sections</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a id="action-history" role="menuitem" tabindex="-1">History</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a href="/rest/bug/1319070" role="menuitem" tabindex="-1">JSON</a>
        </li>
        <li role="presentation">
          <a href="/show_bug.cgi?ctype=xml&amp;id=1319070" role="menuitem" tabindex="-1">XML</a>
        </li>
      </ul>
    </div>
  </div>
</div>



<div role="status" id="io-error" style="display:none"></div>
<div role="status" id="floating-message" style="display:none">
  <div id="floating-message-text"></div>
</div>
<section class="module"
>
  <div class="module-content"
  >
  <div id="summary-container">
    <div class="field indent" id="field-status_summary"
>


  
    <div class=" container">
        <span id="field-value-status_summary">
      <span class="bug-status-label text" data-status="closed">Closed</span>
      <span id="field-value-bug_id">
        <a href="/show_bug.cgi?id=1319070">Bug 1319070</a>
          <span class="edit-hide">(CVE-2017-5386)</span>
      </span>
      <span>
        <span class="bug-time-label">Opened <span class="rel-time" title="2016-11-21 06:21 PST" data-time="1479738109">5 years ago</span></span>
          <span class="bug-time-label">Closed <span class="rel-time" title="2016-12-30 07:12 PST" data-time="1483110739">5 years ago</span></span>
      </span>
        </span>
    </div>

  
</div>
<div class="field indent edit-hide"
>


  
    <div class=" container">
      

      <h1 id="field-value-short_desc">Web Extension's data: scheme pages can be controlled by other extensions</h1>
    </div>

  
</div>

    <div class="field edit-show" id="field-short_desc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc" id="short_desc-help-link" class="help">Summary:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-short_desc">
            Web Extension's data: scheme pages can be controlled by other extensions

        </span>
    </div>

  
</div>
  </div>
  </div>
</section>


<section class="module" id="module-categories"
>
    <header id="module-categories-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Categories section"
           data-label-collapsed="Expand Categories section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-categories-content"
             aria-expanded="true"
             aria-labeledby="module-categories-title"
             aria-describedby="module-categories-subtitle"></div>
        <h2 class="module-title" id="module-categories-title">Categories</h2>
          <h3 class="module-subtitle" id="module-categories-subtitle">
            (WebExtensions :: General, defect)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-categories-content"
  ><div class="fields-lhs">

    <div class="field" id="field-product"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=WebExtensions" id="product-help-link" class="help">Product:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-product">
      <div class="name-info-outer dropdown">
        <span id="product-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="product-info">WebExtensions
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="product-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Product description and actions">
          <header>
            <div class="title">WebExtensions</div>
            <div class="description">File feature requests and bugs related to the WebExtension add-on API.</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=WebExtensions&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Product</a></div>
            <div><a href="/enter_bug.cgi?product=WebExtensions"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Product</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="WebExtensions"
                         data-label-watch="Watch This Product" data-label-unwatch="Unwatch This Product"
                         data-source="BugModal">Watch This Product</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-component"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=WebExtensions&component=General#General" id="component-help-link" class="help">Component:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-component">
      <div class="name-info-outer dropdown">
        <span id="component-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="component-info">General
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="component-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Component description and actions">
          <header>
            <div class="title">WebExtensions :: General</div>
            <div class="description">All other bugs about WebExtensions</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=WebExtensions&amp;component=General&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Component</a></div>
            <div><a href="/buglist.cgi?product=WebExtensions&amp;component=General&amp;chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__"
                    target="_blank" role="menuitem" tabindex="-1">Recently Fixed Bugs in This Component</a></div>
            <div><a href="/enter_bug.cgi?product=WebExtensions&amp;component=General"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Component</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="WebExtensions" data-component="General"
                         data-label-watch="Watch This Component" data-label-unwatch="Unwatch This Component"
                         data-source="BugModal">Watch This Component</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-version" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#version" id="version-help-link" class="help">Version:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-version">
            Trunk

        </span>
    </div>

  
</div>

    <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform" id="-help-link" class="help">Platform:
        </a>
    </div>


  
    <div class=" container"><div class="field inline" id="field-rep_platform"
>


  
    <div class="value">
        <span id="field-value-rep_platform">
            Unspecified

        </span>
    </div>

  
</div><div class="field indent inline" id="field-op_sys"
>


  
    <div class="value">
        <span id="field-value-op_sys">
            Unspecified

        </span>
    </div>

  
</div><div class="field indent inline"
>


  
    <div class=" container">
    </div>

  
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field contains-buttons" id="field-bug_type"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type" id="bug_type-help-link" class="help">Type:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_type">
      <span class="bug-type-label iconic-text" data-type="defect">
        <span class="icon" aria-hidden="true"></span>defect</span>
        </span>
    </div>

  
</div>

    <div class="field" id="field-importance"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority" id="importance-help-link" class="help">Priority:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-importance"><div class="field inline" id="field-priority"
>


  
    <div class="value">
        <span id="field-value-priority">
          <em>Not set</em>
        </span>
    </div>

  
</div><div class="field inline" id="field-bug_severity"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity" id="bug_severity-help-link" class="help">Severity:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_severity">
            normal

        </span>
    </div>

  
</div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-cf_fx_points" style="display:none"
>
    <div class="name">Points:
    </div>


  
    <div class="value">
        <span id="field-value-cf_fx_points">
            ---

        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-tracking"
>
    <header id="module-tracking-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Tracking section"
           data-label-collapsed="Expand Tracking section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-tracking-content"
             aria-expanded="true"
             aria-labeledby="module-tracking-title"
             aria-describedby="module-tracking-subtitle"></div>
        <h2 class="module-title" id="module-tracking-title">Tracking</h2>
          <h3 class="module-subtitle" id="module-tracking-subtitle">
            (firefox-esr4551+ verified, firefox50 wontfix, firefox51+ verified, firefox52+ verified, firefox53+ verified)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-tracking-content"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-status-view"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-view-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-view">VERIFIED
        FIXED
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-status-edit" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-edit-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-edit"><div class="field inline" id="field-bug_status"
>


  
    <div class="value">
        <span id="field-value-bug_status">
            VERIFIED

        </span>
    </div>

  
</div><div class="field indent inline" id="field-resolution"
>


  
    <div class="value">
        <span id="field-value-resolution">
            FIXED

        </span>
    </div>

  
</div>
  <div id="status-action-buttons">
      <div id="assigned-container" style="display:none">
        <button type="button" class="secondary" id="mark-as-assigned-btn">
          Mark as Assigned
        </button>
      </div>
  </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-target_milestone"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone" id="target_milestone-help-link" class="help">Milestone:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-target_milestone">
            mozilla53

        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-cf_fx_iteration" style="display:none"
>
    <div class="name">Iteration:
    </div>


  
    <div class="value">
        <span id="field-value-cf_fx_iteration">
            ---

        </span>
    </div>

  
</div>


      <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Project Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <td class="tracking-flag-name">a11y-review</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_a11y_review_project_flag-dirty">
  <select id="cf_a11y_review_project_flag" name="cf_a11y_review_project_flag">
        <option value="---"
          id="v4876_cf_a11y_review_project_flag" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Webcompat Priority</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_webcompat_priority-dirty">
  <select id="cf_webcompat_priority" name="cf_webcompat_priority">
        <option value="---"
          id="v4274_cf_webcompat_priority" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Root Cause</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_root_cause-dirty">
  <select id="cf_root_cause" name="cf_root_cause">
        <option value="---"
          id="v4701_cf_root_cause" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">user-doc-firefox</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_sumo-dirty">
  <select id="cf_tracking_firefox_sumo" name="cf_tracking_firefox_sumo">
        <option value="---"
          id="v4660_cf_tracking_firefox_sumo" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Fission Milestone</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_fission_milestone-dirty">
  <select id="cf_fission_milestone" name="cf_fission_milestone">
        <option value="---"
          id="v4222_cf_fission_milestone" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

      <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Tracking Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-hide">
    <table class="layout-table tracking-flags">
        <tr>
          <th></th>
          <th>Tracking</th>
          <th>Status</th>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox-esr45</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox_esr45&amp;o1=equals&amp;v1=51%2B">51+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=equals&amp;v1=verified">verified</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox50</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox50&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox51</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox51&amp;o1=equals&amp;v1=%2B">+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox51&amp;o1=equals&amp;v1=verified">verified</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox52</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox52&amp;o1=equals&amp;v1=%2B">+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox52&amp;o1=equals&amp;v1=verified">verified</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox53</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox53&amp;o1=equals&amp;v1=%2B">+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox53&amp;o1=equals&amp;v1=verified">verified</a>
          </td>
        </tr>
    </table>
  </div>


<div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <th></th>
        <th>Tracking</th>
        <th>Status</th>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr45</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr45-dirty">
  <select id="cf_tracking_firefox_esr45" name="cf_tracking_firefox_esr45">
        <option value="51+"
          id="v2803_cf_tracking_firefox_esr45" selected
        >51+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr45-dirty">
  <select id="cf_status_firefox_esr45" name="cf_status_firefox_esr45">
        <option value="verified"
          id="v2549_cf_status_firefox_esr45" selected
        >verified
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">relnote-firefox</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_relnote-dirty">
  <select id="cf_tracking_firefox_relnote" name="cf_tracking_firefox_relnote">
        <option value="---"
          id="v539_cf_tracking_firefox_relnote" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr78-dirty">
  <select id="cf_tracking_thunderbird_esr78" name="cf_tracking_thunderbird_esr78">
        <option value="---"
          id="v4823_cf_tracking_thunderbird_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr78-dirty">
  <select id="cf_status_thunderbird_esr78" name="cf_status_thunderbird_esr78">
        <option value="---"
          id="v4829_cf_status_thunderbird_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr91-dirty">
  <select id="cf_tracking_thunderbird_esr91" name="cf_tracking_thunderbird_esr91">
        <option value="---"
          id="v5236_cf_tracking_thunderbird_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr91-dirty">
  <select id="cf_status_thunderbird_esr91" name="cf_status_thunderbird_esr91">
        <option value="---"
          id="v5242_cf_status_thunderbird_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox50</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox50-dirty">
  <select id="cf_status_firefox50" name="cf_status_firefox50">
        <option value="wontfix"
          id="v2841_cf_status_firefox50" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox51</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox51-dirty">
  <select id="cf_tracking_firefox51" name="cf_tracking_firefox51">
        <option value="+"
          id="v2901_cf_tracking_firefox51" selected
        >+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox51-dirty">
  <select id="cf_status_firefox51" name="cf_status_firefox51">
        <option value="verified"
          id="v2911_cf_status_firefox51" selected
        >verified
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox52</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox52-dirty">
  <select id="cf_tracking_firefox52" name="cf_tracking_firefox52">
        <option value="+"
          id="v2960_cf_tracking_firefox52" selected
        >+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox52-dirty">
  <select id="cf_status_firefox52" name="cf_status_firefox52">
        <option value="verified"
          id="v2970_cf_status_firefox52" selected
        >verified
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox53</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox53-dirty">
  <select id="cf_tracking_firefox53" name="cf_tracking_firefox53">
        <option value="+"
          id="v2998_cf_tracking_firefox53" selected
        >+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox53-dirty">
  <select id="cf_status_firefox53" name="cf_status_firefox53">
        <option value="verified"
          id="v3008_cf_status_firefox53" selected
        >verified
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr78-dirty">
  <select id="cf_tracking_firefox_esr78" name="cf_tracking_firefox_esr78">
        <option value="---"
          id="v4808_cf_tracking_firefox_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr78-dirty">
  <select id="cf_status_firefox_esr78" name="cf_status_firefox_esr78">
        <option value="---"
          id="v4813_cf_status_firefox_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr91-dirty">
  <select id="cf_tracking_firefox_esr91" name="cf_tracking_firefox_esr91">
        <option value="---"
          id="v5194_cf_tracking_firefox_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr91-dirty">
  <select id="cf_status_firefox_esr91" name="cf_status_firefox_esr91">
        <option value="---"
          id="v5199_cf_status_firefox_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox93</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox93-dirty">
  <select id="cf_tracking_firefox93" name="cf_tracking_firefox93">
        <option value="---"
          id="v5266_cf_tracking_firefox93" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox93-dirty">
  <select id="cf_status_firefox93" name="cf_status_firefox93">
        <option value="---"
          id="v5271_cf_status_firefox93" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox94</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox94-dirty">
  <select id="cf_tracking_firefox94" name="cf_tracking_firefox94">
        <option value="---"
          id="v5284_cf_tracking_firefox94" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox94-dirty">
  <select id="cf_status_firefox94" name="cf_status_firefox94">
        <option value="---"
          id="v5289_cf_status_firefox94" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox95</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox95-dirty">
  <select id="cf_tracking_firefox95" name="cf_tracking_firefox95">
        <option value="---"
          id="v5311_cf_tracking_firefox95" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox95-dirty">
  <select id="cf_status_firefox95" name="cf_status_firefox95">
        <option value="---"
          id="v5316_cf_status_firefox95" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>

      <div class="field edit-show" style="display:none"
>
    <div class="name">Blocking Flags:
    </div>


  
    <div class=" container"><div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <td class="tracking-flag-name">webextensions</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_blocking_webextensions-dirty">
  <select id="cf_blocking_webextensions" name="cf_blocking_webextensions">
        <option value="---"
          id="v2817_cf_blocking_webextensions" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>
</div>
  </div>
</section>



<section class="module" id="module-people"
>
    <header id="module-people-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse People section"
           data-label-collapsed="Expand People section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-people-content"
             aria-expanded="false"
             aria-labeledby="module-people-title"
             aria-describedby="module-people-subtitle"></div>
        <h2 class="module-title" id="module-people-title">People</h2>
          <h3 class="module-subtitle" id="module-people-subtitle">
            (Reporter: sdna.muneaki.nishimura, Assigned: zombie, NeedInfo)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-people-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-assigned_to"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to"><div class="vcard vcard_445095" ><img src="https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=445095" > <span class="fna">zombie</span></a>
</div>
        </span>
    </div>

  
</div><div class="field edit-show" id="field-assigned_to" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-assignee" name="set_default_assignee" class="set-default"
          value="1" data-for="assigned_to">
        <label for="set-default-assignee">Reset Assignee to default</label>
      </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-bug_mentors" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor" id="bug_mentors-help-link" class="help">Mentors:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_mentors">---
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-qa_contact" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact" id="qa_contact-help-link" class="help">QA Contact:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-qa_contact">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-qa-contact" name="set_default_qa_contact" class="set-default"
          value="1" data-for="qa_contact">
        <label for="set-default-qa-contact">Reset QA Contact to default</label>
      </div>
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-reporter"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter" id="reporter-help-link" class="help">Reporter:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-reporter">
            <div class="vcard vcard_507051" ><img src="https://secure.gravatar.com/avatar/7e8b2996acb6304c9b7b7000f408632a?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=507051" > <span class="fna">sdna.muneaki.nishimura</span></a>
</div>

        </span>
    </div>

  
</div>

    <div class="field" id="field-triage_owner"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner" id="triage_owner-help-link" class="help">Triage Owner:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-triage_owner">
            <div class="vcard vcard_372685" ><img src="https://secure.gravatar.com/avatar/b2fec98200b3938bef69471c7005458c?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=372685" > <span class="fna">mixedpuppy</span></a>
</div>

        </span>
    </div>

  
</div>

    <div class="field edit-hide"
>
    <div class="name">NeedInfo From:
    </div>


  
    <div class=" container"><div class="flags edit-hide">
        <div class="flag"><div class="vcard vcard_395186" ><a class="email disabled" href="/user_profile?user_id=395186" > <span class="fna">wbamberg</span></a>
</div>
            <a href="#c70"
            class=" activity-ref"
          ><span class="rel-time" title="2017-03-07 19:08 PST" data-time="1488942528">5 years ago</span></a>
        </div>
  </div>
    </div>

  
</div><div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#needinfo" id="-help-link" class="help">NeedInfo:
        </a>
    </div>


  
    <div class=" container">
        <button type="button" id="needinfo-scroll" class="secondary">Update</button>
    </div>

  
</div>

    <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc" id="-help-link" class="help">CC:
        </a>
    </div>


  
    <div class=" container">


        <span aria-owns="cc-summary cc-latch">
          <span role="button" tabindex="0" id="cc-summary" data-count="17">17 people
          </span>
        </span>


        <div id="cc-list" style="display:none"></div>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-references"
>
    <header id="module-references-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse References section"
           data-label-collapsed="Expand References section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-references-content"
             aria-expanded="false"
             aria-labeledby="module-references-title"
             aria-describedby="module-references-subtitle"></div>
        <h2 class="module-title" id="module-references-title">References</h2>
      </div>
    </header>
  <div class="module-content" id="module-references-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field bug-list edit-show" id="field-dependson" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson" id="dependson-help-link" class="help">Depends on:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-dependson">
        ---
        </span>
    </div>

  
</div><div class="field bug-list edit-show" id="field-blocked" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks" id="blocked-help-link" class="help">Blocks:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-blocked">
        ---
        </span>
    </div>

  
</div>

    <div class="field bug-list edit-show" id="field-regresses" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses" id="regresses-help-link" class="help">Regressions:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regresses">
        ---
        </span>
    </div>

  
</div><div class="field bug-list edit-show" id="field-regressed_by" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by" id="regressed_by-help-link" class="help">Regressed by:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regressed_by">
        ---
        </span>
    </div>

  
</div>

    
</div><div class="fields-rhs">

    <div class="field edit-show" id="field-bug_file_loc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc" id="bug_file_loc-help-link" class="help">URL:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_file_loc"><div class="link">
    <a href="" target="_blank"
      rel="noreferrer" title=""
      class="bug-url" data-safe="0"></a>
  </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-see_also" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also" id="see_also-help-link" class="help">See Also:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-see_also">
        ---
        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-details"
>
    <header id="module-details-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Details section"
           data-label-collapsed="Expand Details section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-details-content"
             aria-expanded="false"
             aria-labeledby="module-details-title"
             aria-describedby="module-details-subtitle"></div>
        <h2 class="module-title" id="module-details-title">Details</h2>
          <h3 class="module-subtitle" id="module-details-subtitle">
            (Keywords: sec-moderate, Whiteboard: [post-critsmash-triage][adv-main51+][adv-esr45.7+])
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-details-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-show" id="field-alias" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias" id="alias-help-link" class="help">Alias:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-alias">
            CVE-2017-5386

        </span>
    </div>

  
</div>

    <div class="field" id="field-keywords"
>
    <div class="name">
        <a href="/describekeywords.cgi" id="keywords-help-link" class="help">Keywords:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-keywords">
          <a href="/buglist.cgi?keywords=sec-moderate&amp;resolution=---">sec-moderate</a>
        </span>
    </div>

  
</div>

    <div class="field" id="field-status_whiteboard"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/Whiteboard" id="status_whiteboard-help-link" class="help">Whiteboard:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-status_whiteboard">[post-critsmash-triage][adv-main51+][adv-esr45.7+]
        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_qa_whiteboard" style="display:none"
>
    <div class="name">QA Whiteboard:
    </div>


  
    <div class="value">
        <span id="field-value-cf_qa_whiteboard">
        ---
        </span>
    </div>

  
</div>

    

    <div class="field edit-show" id="field-cf_has_regression_range" style="display:none"
>
    <div class="name">Has Regression Range:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_regression_range">
            ---

        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_has_str" style="display:none"
>
    <div class="name">Has STR:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_str">
            ---

        </span>
    </div>

  
</div>

    <div class="field" id="field-votes"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes" id="votes-help-link" class="help">Votes:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-votes">0
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-bug_flags"
>
    <div class="name">Bug Flags:
    </div>


  
    <div class=" container">
        <span id="field-value-bug_flags"><div id="bug-flags" class="flags">
  <table class="layout-table">
          <tbody class="edit-hide"><tr>
    <td class="flag-setter"><div class="vcard vcard_1689" ><a class="email " href="/user_profile?user_id=1689" > <span class="fna">dveditz</span></a>
</div>
    </td>

    <td class="flag-name">
        <a href="#c57"
            class="rel-time-title activity-ref"
            title="5 years ago"
        data-time="1479888739"
      >sec-bounty</a>
    </td>

    <td class="flag-value">+
    </td>

  </tr>
          </tbody>
          <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter"><div class="vcard vcard_1689" ><a class="email " href="/user_profile?user_id=1689" > <span class="fna">dveditz</span></a>
</div>
    </td>

    <td class="flag-name">
      <label title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug." for="flag-1491010">sec-bounty</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag-1491010-dirty">
      <select id="flag-1491010" name="flag-1491010"
        title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug."
        class="bug-flag">
            <option value="+" selected>+</option>
      </select>
    </td>


  </tr>
          </tbody>
          <tbody class="edit-hide"><tr>
    <td class="flag-setter"><div class="vcard vcard_580382" ><a class="email " href="/user_profile?user_id=580382" > <span class="fna">jcristau</span></a>
</div>
    </td>

    <td class="flag-name">
        <a href="#a9920651_580382"
            class="rel-time-title activity-ref"
            title="5 years ago"
        data-time="1483110739"
      >in-testsuite</a>
    </td>

    <td class="flag-value">+
    </td>

  </tr>
          </tbody>
          <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter"><div class="vcard vcard_580382" ><a class="email " href="/user_profile?user_id=580382" > <span class="fna">jcristau</span></a>
</div>
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag-1504790">in-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag-1504790-dirty">
      <select id="flag-1504790" name="flag-1504790"
        title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" selected>+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr>
          </tbody>
          <tbody class="edit-hide"><tr>
    <td class="flag-setter"><div class="vcard vcard_452604" ><a class="email disabled" href="/user_profile?user_id=452604" > <span class="fna">mwobensmith</span></a>
</div>
    </td>

    <td class="flag-name">
        <a href="#a4239638_452604"
            class="rel-time-title activity-ref"
            title="5 years ago"
        data-time="1483977747"
      >qe-verify</a>
    </td>

    <td class="flag-value">+
    </td>

  </tr>
          </tbody>
          <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter"><div class="vcard vcard_452604" ><a class="email disabled" href="/user_profile?user_id=452604" > <span class="fna">mwobensmith</span></a>
</div>
    </td>

    <td class="flag-name">
      <label title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually" for="flag-1508613">qe-verify</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag-1508613-dirty">
      <select id="flag-1508613" name="flag-1508613"
        title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually"
          disabled
        class="bug-flag">
            <option value="+" selected>+</option>
      </select>
    </td>


  </tr>
          </tbody>
    <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?" for="flag_type-930">behind-pref</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-930-dirty">
      <select id="flag_type-930" name="flag_type-930"
        title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?"
        class="bug-flag">
          <option value="X"></option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag tracking inclusion in the desktop Firefox product backlog." for="flag_type-846">firefox-backlog</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-846-dirty">
      <select id="flag_type-846" name="flag_type-846"
        title="Flag tracking inclusion in the desktop Firefox product backlog."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame." for="flag_type-913">sec-bounty-hof</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-913-dirty">
      <select id="flag_type-913" name="flag_type-913"
        title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-787">in-qa-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-787-dirty">
      <select id="flag_type-787" name="flag_type-787"
        title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>

      <td class="flag-requestee">
        <div id="requestee_type-787-container" style="display:none"><input
    name="requestee_type-787"
    value="" class="requestee bz_autocomplete_user"  id="requestee_type-787" 
  >
        </div>
      <td>

  </tr>
    </tbody>
  </table>
</div>
        </span>
    </div>

  
</div>
</div>

  
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-crash-data"
>
    <header id="module-crash-data-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Crash Data section"
           data-label-collapsed="Expand Crash Data section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-crash-data-content"
             aria-expanded="false"
             aria-labeledby="module-crash-data-title"
             aria-describedby="module-crash-data-subtitle"></div>
        <h2 class="module-title" id="module-crash-data-title">Crash Data</h2>
      </div>
    </header>
  <div class="module-content" id="module-crash-data-content" style="display:none"
  ><div class="field edit-show" id="field-cf_crash_signature" style="display:none"
>
    <div class="name">Signature:
    </div>


  
    <div class="value">
        <span id="field-value-cf_crash_signature">
        </span>
    </div>

  
</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-security"
>
    <header id="module-security-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Security section"
           data-label-collapsed="Expand Security section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-security-content"
             aria-expanded="false"
             aria-labeledby="module-security-title"
             aria-describedby="module-security-subtitle"></div>
        <h2 class="module-title" id="module-security-title">Security</h2>
          <h3 class="module-subtitle" id="module-security-subtitle">
            (public)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-security-content" style="display:none"
  ><div class="groups edit-hide">
    This bug is publicly visible.
</div>

<div class="groups edit-show" style="display:none">


</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-user-story" data-non-stick="1"
>
    <header id="module-user-story-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse User Story section"
           data-label-collapsed="Expand User Story section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-user-story-content"
             aria-expanded="false"
             aria-labeledby="module-user-story-title"
             aria-describedby="module-user-story-subtitle"></div>
        <h2 class="module-title" id="module-user-story-title">User Story</h2>
      </div>
    </header>
  <div class="module-content" id="module-user-story-content" style="display:none"
  >
    <pre id="user-story"></pre>
  </div>
</section>







<section class="module" id="module-attachments"
>
    <header id="module-attachments-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Attachments section"
           data-label-collapsed="Expand Attachments section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-attachments-content"
             aria-expanded="true"
             aria-labeledby="module-attachments-title"
             aria-describedby="module-attachments-subtitle"></div>
        <h2 class="module-title" id="module-attachments-title">Attachments</h2>
          <h3 class="module-subtitle" id="module-attachments-subtitle">
            (6 files, 12 obsolete files)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-attachments-content"
  ><table role="table" class="layout-table" id="attachments">
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8812756">poc.zip</a>
        </div>
        <div>
            <a href="#c0" class="attach-time activity-ref"><span class="rel-time" title="2016-11-21 06:21 PST" data-time="1479738109">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_507051" ><a class="email " href="/user_profile?user_id=507051" > <span class="fna">Muneaki Nishimura</span></a>
</div></span>
        </div>
        <div class="attach-info">5.65 KB,
          application/zip        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8812756&amp;action=edit">Details</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8813787">bug-1319070-fix.patch</a>
        </div>
        <div>
            <a href="#c6" class="attach-time activity-ref"><span class="rel-time" title="2016-11-23 10:47 PST" data-time="1479926873">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_445095" ><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div></span>
        </div>
        <div class="attach-info">1.95 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8813787&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8813787&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1319070&attachment=8813787">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8813789">bug-1319070-tests.patch</a>
        </div>
        <div>
            <a href="#c7" class="attach-time activity-ref"><span class="rel-time" title="2016-11-23 10:49 PST" data-time="1479926986">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_445095" ><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div></span>
        </div>
        <div class="attach-info">7.75 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8813789&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8813789&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1319070&attachment=8813789">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8813894">bug-1319070-fix-v2.patch</a>
        </div>
        <div>
            <a href="#c12" class="attach-time activity-ref"><span class="rel-time" title="2016-11-23 15:11 PST" data-time="1479942674">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_445095" ><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div></span>
        </div>
        <div class="attach-info">1.95 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8813894&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8813894&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1319070&attachment=8813894">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8814476">bug-1319070-tests-v2.patch</a>
        </div>
        <div>
            <a href="#c16" class="attach-time activity-ref"><span class="rel-time" title="2016-11-25 10:53 PST" data-time="1480100032">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_445095" ><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div></span>
        </div>
        <div class="attach-info">7.77 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_106098" ><span class="fn">kmag</span>
</div>:
              <a href="#c19"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1480100032"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8814476&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8814476&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1319070&attachment=8814476">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8814740">bug-1319070-fix-v3.patch</a>
        </div>
        <div>
            <a href="#c20" class="attach-time activity-ref"><span class="rel-time" title="2016-11-27 13:30 PST" data-time="1480282235">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_445095" ><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div></span>
        </div>
        <div class="attach-info">2.08 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_106098" ><span class="fn">kmag</span>
</div>:
              <a href="#a705555_106098"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1480282235"
            >
              review+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_280903" ><span class="fn">abillings</span>
</div>:
              <a href="#c25"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1480622879"
            >
              sec-approval+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8814740&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8814740&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1319070&attachment=8814740">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8814747">bug-1319070-tests-v3.patch</a>
        </div>
        <div>
            <a href="#c21" class="attach-time activity-ref"><span class="rel-time" title="2016-11-27 13:54 PST" data-time="1480283670">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_445095" ><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div></span>
        </div>
        <div class="attach-info">7.96 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_106098" ><span class="fn">kmag</span>
</div>:
              <a href="#c22"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1480283670"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8814747&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8814747&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1319070&attachment=8814747">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8816734">bug-1319070-fix-beta.patch</a>
        </div>
        <div>
            <a href="#c28" class="attach-time activity-ref"><span class="rel-time" title="2016-12-03 19:45 PST" data-time="1480823109">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_445095" ><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div></span>
        </div>
        <div class="attach-info">1.21 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_106098" ><span class="fn">kmag</span>
</div>:
              <a href="#a2266107_106098"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1480823109"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8816734&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8816734&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1319070&attachment=8816734">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8816737">bug-1319070-fix-aurora.patch</a>
        </div>
        <div>
            <a href="#c29" class="attach-time activity-ref"><span class="rel-time" title="2016-12-03 20:41 PST" data-time="1480826500">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_445095" ><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div></span>
        </div>
        <div class="attach-info">1.69 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8816737&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8816737&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1319070&attachment=8816737">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8820053">bug-1319070-fix-v4.patch</a>
        </div>
        <div>
            <a href="#c34" class="attach-time activity-ref"><span class="rel-time" title="2016-12-19 14:09 PST" data-time="1482185399">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_445095" ><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div></span>
        </div>
        <div class="attach-info">2.07 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_280903" ><span class="fn">abillings</span>
</div>:
              <a href="#c43"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1482504853"
            >
              sec-approval+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8820053&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8820053&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1319070&attachment=8820053">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8820054">bug-1319070-fix-aurora-v2.patch</a>
        </div>
        <div>
            <a href="#c35" class="attach-time activity-ref"><span class="rel-time" title="2016-12-19 14:16 PST" data-time="1482185774">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_445095" ><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div></span>
        </div>
        <div class="attach-info">1.67 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_280903" ><span class="fn">abillings</span>
</div>:
              <a href="#c44"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1482185774"
            >
              approval-mozilla-aurora+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8820054&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8820054&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1319070&attachment=8820054">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8820056">bug-1319070-fix-beta-v2.patch</a>
        </div>
        <div>
            <a href="#c36" class="attach-time activity-ref"><span class="rel-time" title="2016-12-19 14:30 PST" data-time="1482186600">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_445095" ><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div></span>
        </div>
        <div class="attach-info">1.20 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_280903" ><span class="fn">abillings</span>
</div>:
              <a href="#a3229232_280903"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1482186600"
            >
              approval-mozilla-beta+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8820056&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8820056&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1319070&attachment=8820056">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8822479">bug-1319070-fix-v5.patch</a>
        </div>
        <div>
            <a href="#c47" class="attach-time activity-ref"><span class="rel-time" title="2016-12-29 10:22 PST" data-time="1483035755">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_445095" ><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div></span>
        </div>
        <div class="attach-info">2.88 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8822479&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8822479&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1319070&attachment=8822479">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8822514">bug-1319070-fix-aurora-v3.patch</a>
        </div>
        <div>
            <a href="#c49" class="attach-time activity-ref"><span class="rel-time" title="2016-12-29 13:04 PST" data-time="1483045495">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_445095" ><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div></span>
        </div>
        <div class="attach-info">2.49 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8822514&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8822514&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1319070&attachment=8822514">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8822515">bug-1319070-fix-beta-v3.patch</a>
        </div>
        <div>
            <a href="#c50" class="attach-time activity-ref"><span class="rel-time" title="2016-12-29 13:06 PST" data-time="1483045577">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_445095" ><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div></span>
        </div>
        <div class="attach-info">2.01 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8822515&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8822515&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1319070&attachment=8822515">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8822683">bug-1319070-fix-esr45-v2.patch</a>
        </div>
        <div>
            <a href="#c54" class="attach-time activity-ref"><span class="rel-time" title="2016-12-30 07:38 PST" data-time="1483112321">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_445095" ><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div></span>
        </div>
        <div class="attach-info">1.19 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_538805" ><span class="fn">ritu</span>
</div>:
              <a href="#c64"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1483125754"
            >
              approval-mozilla-esr45+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8822683&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8822683&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1319070&attachment=8822683">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8827632">Match against the principal</a>
        </div>
        <div>
            <a href="#c66" class="attach-time activity-ref"><span class="rel-time" title="2017-01-17 13:42 PST" data-time="1484689370">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_281791" ><a class="email disabled" href="/user_profile?user_id=281791" > <span class="fna">Jason Orendorff [:jorendorff]</span></a>
</div></span>
        </div>
        <div class="attach-info">1.20 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8827632&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8827632&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1319070&attachment=8827632">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8847547">bug-1319070-tests-v4.patch</a>
        </div>
        <div>
            <a href="#c72" class="attach-time activity-ref"><span class="rel-time" title="2017-03-15 04:14 PDT" data-time="1489576476">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_445095" ><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div></span>
        </div>
        <div class="attach-info">7.10 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_277293" ><span class="fn">cbook</span>
</div>:
              <a href="#c73"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1489576614"
            >
              checkin+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8847547&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8847547&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1319070&attachment=8847547">Splinter Review</a>
    </tr>
</table>

<footer id="attachments-footer">
  <div id="attachments-actions">
      <button type="button" id="attachments-obsolete-btn" class="secondary">Show Obsolete</button>
  </div>
  
</footer>
  </div>
</section>



<script nonce="jCtRVzj2MrzudWA4ELX1NfaEJJGLjr9sZNqBH9iZX2aHPZMN">
  init_module_visibility();
</script>



<meta name="firefox-versions" content="{&quot;FIREFOX_AURORA&quot;:&quot;&quot;,&quot;FIREFOX_DEVEDITION&quot;:&quot;94.0b9&quot;,&quot;FIREFOX_ESR&quot;:&quot;78.15.0esr&quot;,&quot;FIREFOX_ESR_NEXT&quot;:&quot;91.2.0esr&quot;,&quot;FIREFOX_NIGHTLY&quot;:&quot;95.0a1&quot;,&quot;FIREFOX_PINEBUILD&quot;:&quot;&quot;,&quot;LAST_MERGE_DATE&quot;:&quot;2021-10-04&quot;,&quot;LAST_RELEASE_DATE&quot;:&quot;2021-10-05&quot;,&quot;LAST_SOFTFREEZE_DATE&quot;:&quot;2021-09-30&quot;,&quot;LATEST_FIREFOX_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_OLDER_VERSION&quot;:&quot;3.6.28&quot;,&quot;LATEST_FIREFOX_RELEASED_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_VERSION&quot;:&quot;93.0&quot;,&quot;NEXT_MERGE_DATE&quot;:&quot;2021-11-01&quot;,&quot;NEXT_RELEASE_DATE&quot;:&quot;2021-11-02&quot;,&quot;NEXT_SOFTFREEZE_DATE&quot;:&quot;2021-10-28&quot;}">


<div id="comment-actions">
    <button type="button" id="bottom-btn" class="secondary" aria-label="Go to Page Bottom">Bottom &darr;</button>
  <div class="dropdown">
    <button type="button" id="comment-tags-btn" aria-haspopup="true" aria-label="Tags"
      aria-expanded="false" aria-controls="comment-tags-menu" class="dropdown-button minor">Tags &#9662;</button>
    <ul id="comment-tags-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a role="menuitem" tabindex="-1" data-comment-tag="">Reset</a>
      </li>
    </ul>
  </div>
  <div class="dropdown">
    <button type="button" id="view-menu-btn" aria-haspopup="true" aria-label="Timeline"
      aria-expanded="false" aria-controls="view-menu" class="dropdown-button minor">Timeline &#9662;</button>
    <ul id="view-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a id="view-reset" role="menuitem" tabindex="-1">Reset</a>
      </li>
      <li role="separator"></li>
      <li role="presentation">
        <a id="view-collapse-all" role="menuitem" tabindex="-1">Collapse All</a>
      </li>
      <li role="presentation">
        <a id="view-expand-all" role="menuitem" tabindex="-1">Expand All</a>
      </li>
      <li role="presentation">
        <a id="view-comments-only" role="menuitem" tabindex="-1">Comments Only</a>
      </li>
    </ul>
   </div>
</div>
<div class="change-set" id="c0"><div class="comment" data-id="11875576" data-no="0"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-0" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_507051" ><img src="https://secure.gravatar.com/avatar/7e8b2996acb6304c9b7b7000f408632a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_507051" ><a class="email " href="/user_profile?user_id=507051" > <span class="fna">Muneaki Nishimura</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-0"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-0" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c0">Description</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-11-21 06:21 PST" data-time="1479738109">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-0">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8812756"
         class="attachment"
         data-id="8812756" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="poc.zip">
      <meta itemprop="contentSize" content="5788">
      <meta itemprop="encodingFormat" content="application/zip">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=8812756" itemprop="contentUrl">
        <span id="att-8812756-description" itemprop="description">poc.zip</span></a>
        — <a href="attachment.cgi?id=8812756&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-0" data-comment-id="11875576">User Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit/602.1.50 (KHTML, like Gecko) Version/10.0 Safari/602.1.50

Steps to reproduce:

1) Install both &quot;attacker&quot; and &quot;victim&quot; extensions in the attachment to Firefox
2. Open the browser_action of &quot;victim&quot; and click a link &quot;Click to Reproduce&quot; in the page



Actual results:

You can see a message &quot;victim is pwned by attacker&quot; in the page and an alert is shown with the content of victim extension's localStorage, i.e., SECRET

This means that the the attacker's extensions can control other extension's pages with data: scheme.

The cause of this issue is below.
<a rel="nofollow" href="https://dxr.mozilla.org/mozilla-central/source/toolkit/modules/addons/MatchPattern.jsm#21">https://dxr.mozilla.org/mozilla-central/source/toolkit/modules/addons/MatchPattern.jsm#21</a>
Here the data: scheme is whitelisted but data: documents in Firefox inherits opener's context.


Expected results:

The data: scheme pages in another extension should be controlled by other extensions.</pre></div><div class="change-set" id="c1"><div class="comment" data-id="11875842" data-no="1"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-1" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" ><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" ><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-1"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-1" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c1">Comment 1</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-11-21 07:20 PST" data-time="1479741624">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-1">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-1" data-comment-id="11875842">Kris, is this as simple as removing &quot;data&quot; from the whitelist, or is this more complicated? Maybe if add-ons like using data: for their initial URIs or something, we just need to make sure that any followup navigations include DISABLE_INHERIT_PRINCIPAL or whatever the flag is?</pre><div class="activity"><div class="change">Group: firefox-core-security &rarr; toolkit-core-security</div><div class="change">Component: Untriaged &rarr; WebExtensions: General</div><div class="change">Flags: needinfo?(kmaglione+bmo)</div><div class="change">Product: Firefox &rarr; Toolkit</div></div></div><div class="change-set" id="c2"><div class="comment" data-id="11876227" data-no="2"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-2" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" ><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_106098" ><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-2"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-2" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c2">Comment 2</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-11-21 09:10 PST" data-time="1479748231">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-2">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-2" data-comment-id="11876227">We should probably do something similar to what we're now doing for about:blank, and checking the URL of the principal rather than of the page.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(kmaglione+bmo)</span></div></div></div><div class="change-set" id="c3"><div class="comment" data-id="11876458" data-no="3"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-3" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" ><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_106098" ><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-3"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-3" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c3">Comment 3</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-11-21 10:26 PST" data-time="1479752809">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-3">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-3" data-comment-id="11876458">zombie, any chance you want to work on this? If not, I'll take care of it.</pre><div class="activity"><div class="change">Flags: needinfo?(tomica)</div></div></div><div class="change-set" id="a15455_507051"><div class="change" id="aa15455_507051">
    <table class="layout-table change-head reporter" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_507051" id="a15455_507051"><img src="https://secure.gravatar.com/avatar/7e8b2996acb6304c9b7b7000f408632a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_507051" id="a15455_507051"><a class="email " href="/user_profile?user_id=507051" > <span class="fna">Muneaki Nishimura</span></a>
</div>
            <span class="user-role">Reporter</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a15455_507051"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a15455_507051">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#a15455_507051">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-11-21 10:39 PST" data-time="1479753564">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Summary: Web Extension's data: scheme pages can be controller by other extensions &rarr; Web Extension's data: scheme pages can be controlled by other extensions</div></div></div><div class="change-set" id="c4"><div class="comment" data-id="11876651" data-no="4"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-4" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445095" id="a15455_507051"><img src="https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445095" id="a15455_507051"><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-4"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-4" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c4">Comment 4</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-11-21 11:17 PST" data-time="1479755851">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-4">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-4" data-comment-id="11876651">sure, i can try.</pre><div class="activity"><div class="change">Assignee: nobody &rarr; tomica</div><div class="change">Status: NEW &rarr; ASSIGNED</div><div class="change">Flags: <span class="activity-deleted">needinfo?(tomica)</span></div></div></div><div class="change-set" id="c5"><div class="comment" data-id="11877058" data-no="5"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-5" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" id="a15455_507051"><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_106098" id="a15455_507051"><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-5"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-5" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c5">Comment 5</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-11-21 13:15 PST" data-time="1479762901">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-5">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-5" data-comment-id="11877058">Potential for privilege escalation. Mitigated by the fact that extension permissions aren't currently exposed to users, and legacy extensions aren't sandboxed at all. Can't be used to gain chrome privileges since content scripts are never allowed to inherit the system principal.</pre><div class="activity"><div class="change">Keywords: <a href="/buglist.cgi?keywords=sec-high&amp;resolution=---">sec-high</a></div></div></div><div class="change-set" id="a150630_411311"><div class="change" id="aa150630_411311">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_411311" id="a150630_411311"><img src="https://secure.gravatar.com/avatar/c05fddac7f28cc31ba6cff141ca4787e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_411311" id="a150630_411311"><a class="email disabled" href="/user_profile?user_id=411311" > <span class="fna">Raymond Forbes[:rforbes]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a150630_411311"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a150630_411311">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#a150630_411311">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-11-23 00:12 PST" data-time="1479888739">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: sec-bounty?</div></div></div><div class="change-set" id="c6"><div class="comment" data-id="11883299" data-no="6"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-6" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445095" id="a150630_411311"><img src="https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445095" id="a150630_411311"><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-6"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-6" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c6">Comment 6</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-11-23 10:47 PST" data-time="1479926873">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-6">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8813787"
         class="attachment patch obsolete"
         data-id="8813787" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug-1319070-fix.patch">
      <meta itemprop="contentSize" content="1992">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8813787">
          <a class="link" href="attachment.cgi?id=8813787&amp;action=diff">
        <span id="att-8813787-description" itemprop="description">bug-1319070-fix.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8813787&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1319070&attachment=8813787">Splinter Review</a>
      </div>
    </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8813787&amp;action=edit"
           title="bug-1319070-fix.patch"
           class=""
        >Attachment #8813787</a> -
        Flags: review?(kmaglione+bmo)</div></div></div><div class="change-set" id="c7"><div class="comment" data-id="11883308" data-no="7"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-7" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445095" id="a150630_411311"><img src="https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445095" id="a150630_411311"><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-7"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-7" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c7">Comment 7</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-11-23 10:49 PST" data-time="1479926986">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-7">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8813789"
         class="attachment patch obsolete"
         data-id="8813789" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug-1319070-tests.patch">
      <meta itemprop="contentSize" content="7940">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8813789">
          <a class="link" href="attachment.cgi?id=8813789&amp;action=diff">
        <span id="att-8813789-description" itemprop="description">bug-1319070-tests.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8813789&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1319070&attachment=8813789">Splinter Review</a>
      </div>
    </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8813789&amp;action=edit"
           title="bug-1319070-tests.patch"
           class=""
        >Attachment #8813789</a> -
        Flags: review?(kmaglione+bmo)</div></div></div><div class="change-set" id="c8"><div class="comment" data-id="11883345" data-no="8"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-8" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445095" id="a150630_411311"><img src="https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445095" id="a150630_411311"><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-8"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-8" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c8">Comment 8</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-11-23 10:58 PST" data-time="1479927507">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-8">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-8" data-comment-id="11883345">(In reply to Kris Maglione [:kmag] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web Extension's data: scheme pages can be controlled by other extensions"
   href="/show_bug.cgi?id=1319070#c2">comment #2</a>)
<span class="quote">&gt; We should probably do something similar to what we're now doing for
&gt; about:blank, and checking the URL of the principal rather than of the page.</span >

That made sense to me, so I did that, but I'm not the happiest with the outcome.

This does in fact fix the security issue at hand, but the bigger dev story about specifying a &quot;data:&quot; scheme in the match pattern makes little sense after this fix.

We could either deprecate the use case, or at least document the issue (later, obviously).  Not sure if there would be any actual impact on compatibility.  Maybe Andy could check what percentage of Chrome extensions actually tries to match against data: URIs (explicitly), for what purpose, and if this would break any?</pre></div><div class="change-set" id="c9"><div class="comment" data-id="11883366" data-no="9"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-9" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" id="a150630_411311"><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_106098" id="a150630_411311"><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-9"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-9" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c9">Comment 9</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-11-23 11:08 PST" data-time="1479928090">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-9">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-9" data-comment-id="11883366">(In reply to Tomislav Jovanovic :zombie from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web Extension's data: scheme pages can be controlled by other extensions"
   href="/show_bug.cgi?id=1319070#c8">comment #8</a>)
<span class="quote">&gt; (In reply to Kris Maglione [:kmag] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web Extension's data: scheme pages can be controlled by other extensions"
   href="/show_bug.cgi?id=1319070#c2">comment #2</a>)
&gt; &gt; We should probably do something similar to what we're now doing for
&gt; &gt; about:blank, and checking the URL of the principal rather than of the page.
&gt; 
&gt; That made sense to me, so I did that, but I'm not the happiest with the
&gt; outcome.
&gt; 
&gt; This does in fact fix the security issue at hand, but the bigger dev story
&gt; about specifying a &quot;data:&quot; scheme in the match pattern makes little sense
&gt; after this fix.
&gt; 
&gt; We could either deprecate the use case, or at least document the issue
&gt; (later, obviously).  Not sure if there would be any actual impact on
&gt; compatibility.  Maybe Andy could check what percentage of Chrome extensions
&gt; actually tries to match against data: URIs (explicitly), for what purpose,
&gt; and if this would break any?</span >

Yeah. So, I can see two... three alternatives:

1) Remove support for data: URL match patterns, and just match them based on the principal URL.
2) Keep supporting match patterns, but check that the principal URL either matches another match pattern or matches a host permission.
3) Treat data: URLs the same way we treat about:blank and about:srcdoc, and either add matchDataURLs or reuse matchAboutBlank to match them.</pre></div><div class="change-set" id="c10"><div class="comment" data-id="11883403" data-no="10"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-10" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" id="a150630_411311"><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_106098" id="a150630_411311"><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-10"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-10" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c10">Comment 10</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-11-23 11:19 PST" data-time="1479928745">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-10">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-10" data-comment-id="11883403">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8813787" name="attach_8813787" title="bug-1319070-fix.patch">attachment 8813787</a> <a href="/attachment.cgi?id=8813787&amp;action=edit" title="bug-1319070-fix.patch">[details]</a> <a href="/attachment.cgi?id=8813787&amp;action=diff" title="bug-1319070-fix.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1319070&amp;attachment=8813787'>[review]</a>
bug-1319070-fix.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8813787" name="attach_8813787" title="bug-1319070-fix.patch">attachment 8813787</a> <a href="/attachment.cgi?id=8813787&amp;action=edit" title="bug-1319070-fix.patch">[details]</a> <a href="/attachment.cgi?id=8813787&amp;action=diff" title="bug-1319070-fix.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1319070&amp;attachment=8813787'>[review]</a>:
-----------------------------------------------------------------

This looks pretty good to me, but I'm leaving it r? pending a decision on how we should handle the match patterns.

::: toolkit/components/extensions/ExtensionContent.jsm
&#64;&#64; +155,3 &#64;&#64;
<span class="quote">&gt;        // When matching top-level about:blank documents,
&gt;        // allow loading into any with a NullPrincipal.
&gt; +      if (uri.spec === &quot;about.blank&quot; &amp;&amp; window === window.top &amp;&amp; principal.isNullPrincipal) {</span >

&quot;about:blank&quot;

Which means I guess we're missing a test for this?

&#64;&#64; +165,5 &#64;&#64;
<span class="quote">&gt; +      }
&gt; +    }
&gt; +
&gt; +    // Documents with data: URIs also inherit the principal.
&gt; +    if (uri.scheme === &quot;data&quot;) {</span >

I wonder if we should just check `Services.netUtils.URIChainHasFlags(uri, URI_INHERITS_SECURITY_CONTEXT)`? I guess it shouldn't make a difference, given that we already restrict match patterns, though...</pre></div><div class="change-set" id="c11"><div class="comment" data-id="11883921" data-no="11"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-11" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445095" id="a150630_411311"><img src="https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445095" id="a150630_411311"><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-11"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-11" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c11">Comment 11</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-11-23 14:35 PST" data-time="1479940518">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-11">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-11" data-comment-id="11883921"><span class="quote">&gt; &gt; +      if (uri.spec === &quot;about.blank&quot; &amp;&amp; window === window.top &amp;&amp; principal.isNullPrincipal) {
&gt; 
&gt; &quot;about:blank&quot;
&gt; 
&gt; Which means I guess we're missing a test for this?</span >

No, this only means I didn't run those tests after the last &quot;just some code cleanup&quot;, I'm sorry! :(

browser_ext_tabs_executeScript.js#205 fails with that.


<span class="quote">&gt; I wonder if we should just check `Services.netUtils.URIChainHasFlags(uri,
&gt; URI_INHERITS_SECURITY_CONTEXT)`? I guess it shouldn't make a difference,
&gt; given that we already restrict match patterns, though...</span >

I was considering that, but no other scheme that we allow inherits.  Using a check against &quot;data&quot; probably results in more explicit, readable code.  Although, this being a security fix, maybe that's not desirable?  ;)</pre></div><div class="change-set" id="c12"><div class="comment" data-id="11884036" data-no="12"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-12" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445095" id="a150630_411311"><img src="https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445095" id="a150630_411311"><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-12"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-12" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c12">Comment 12</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-11-23 15:11 PST" data-time="1479942674">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-12">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8813894"
         class="attachment patch obsolete"
         data-id="8813894" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug-1319070-fix-v2.patch">
      <meta itemprop="contentSize" content="1992">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8813894">
          <a class="link" href="attachment.cgi?id=8813894&amp;action=diff">
        <span id="att-8813894-description" itemprop="description">bug-1319070-fix-v2.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8813894&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1319070&attachment=8813894">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-12" data-comment-id="11884036">Typo corrected.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8813787&amp;action=edit"
           title="bug-1319070-fix.patch"
           class=""
        >Attachment #8813787</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8813787&amp;action=edit"
           title="bug-1319070-fix.patch"
           class=""
        >Attachment #8813787</a> -
        Flags: <span class="activity-deleted">review?(kmaglione+bmo)</span></div><div class="change">
        <a href="/attachment.cgi?id=8813894&amp;action=edit"
           title="bug-1319070-fix-v2.patch"
           class=""
        >Attachment #8813894</a> -
        Flags: review?(kmaglione+bmo)</div></div></div><div class="change-set" id="c13"><div class="comment" data-id="11884077" data-no="13"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-13" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445095" id="a150630_411311"><img src="https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445095" id="a150630_411311"><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-13"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-13" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c13">Comment 13</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-11-23 15:27 PST" data-time="1479943641">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-13">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-13" data-comment-id="11884077">(In reply to Kris Maglione [:kmag] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web Extension's data: scheme pages can be controlled by other extensions"
   href="/show_bug.cgi?id=1319070#c9">comment #9</a>)
<span class="quote">&gt; 2) Keep supporting match patterns, but check that the principal URL either
&gt; matches another match pattern or matches a host permission.</span >

This is basically my current fix (host permissions are already used for tabs.executeScript).

Options 1) and 3) need to be public by nature, and can be done as a follow-up after this lands to fix the immediate threat.  So my current thinking is to go with this, and decide on further actions outside the time pressure of this bug.


Andy, what do you think about the big picture?  Can your script/stats help us estimate how many Chrome extensions explicitly match against data: URIs?  (not &lt;all_urls&gt;, as those will continue to work).</pre><div class="activity"><div class="change">Flags: needinfo?(amckay)</div></div></div><div class="change-set" id="c14"><div class="comment" data-id="11884227" data-no="14"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-14" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_397635" id="a150630_411311"><img src="https://secure.gravatar.com/avatar/4ae11454315077053052b613d6d77241?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_397635" id="a150630_411311"><a class="email " href="/user_profile?user_id=397635" > <span class="fna">Andy McKay</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-14"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-14" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c14">Comment 14</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-11-23 16:43 PST" data-time="1479948209">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-14">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-14" data-comment-id="11884227">(In reply to Tomislav Jovanovic :zombie from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web Extension's data: scheme pages can be controlled by other extensions"
   href="/show_bug.cgi?id=1319070#c13">comment #13</a>)
<span class="quote">&gt; Andy, what do you think about the big picture?  Can your script/stats help
&gt; us estimate how many Chrome extensions explicitly match against data: URIs? 
&gt; (not &lt;all_urls&gt;, as those will continue to work).</span >

I found only 1 mention of data: in the manifests of 100k extensions. 

  	&quot;web_accessible_resources&quot;: [
  		&quot;css/images/*.png&quot;, 
  		&quot;css/images/*.gif&quot;,
  		&quot;data:image/*&quot;
  	],

<a rel="nofollow" href="https://chrome.google.com/webstore/detail/rummage/pahcjlpnciigaejakjnndfmmnppihhmg">https://chrome.google.com/webstore/detail/rummage/pahcjlpnciigaejakjnndfmmnppihhmg</a>

Has one user. Assuming I'm searching for the right thing.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(amckay)</span></div></div></div><div class="change-set" id="c15"><div class="comment" data-id="11885025" data-no="15"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-15" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a150630_411311"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a150630_411311"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-15"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-15" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c15">Comment 15</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-11-24 01:54 PST" data-time="1479981241">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-15">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-15" data-comment-id="11885025">In case it's relevant: note that data: is treated differently by chrome than by us - it can inherit a principal in Firefox, and doesn't in Chrome, see <a rel="nofollow" href="https://groups.google.com/d/msg/mozilla.dev.platform/w0IgmymXDds/4-EvoXPvAAAJ">https://groups.google.com/d/msg/mozilla.dev.platform/w0IgmymXDds/4-EvoXPvAAAJ</a> (which is about us aligning with Chrome, which is... difficult).</pre></div><div class="change-set" id="c16"><div class="comment" data-id="11888104" data-no="16"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-16" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445095" id="a150630_411311"><img src="https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445095" id="a150630_411311"><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-16"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-16" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c16">Comment 16</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-11-25 10:53 PST" data-time="1480100032">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-16">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8814476"
         class="attachment patch obsolete"
         data-id="8814476" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug-1319070-tests-v2.patch">
      <meta itemprop="contentSize" content="7954">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8814476">
          <a class="link" href="attachment.cgi?id=8814476&amp;action=diff">
        <span id="att-8814476-description" itemprop="description">bug-1319070-tests-v2.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8814476&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1319070&attachment=8814476">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-16" data-comment-id="11888104">Updated test to avoid checking tabId from webNavigation (not available on android),
and to use the same mechanism in the other test (works better in non-e10s mode).</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8813789&amp;action=edit"
           title="bug-1319070-tests.patch"
           class=""
        >Attachment #8813789</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8813789&amp;action=edit"
           title="bug-1319070-tests.patch"
           class=""
        >Attachment #8813789</a> -
        Flags: <span class="activity-deleted">review?(kmaglione+bmo)</span></div><div class="change">
        <a href="/attachment.cgi?id=8814476&amp;action=edit"
           title="bug-1319070-tests-v2.patch"
           class=""
        >Attachment #8814476</a> -
        Flags: review?(kmaglione+bmo)</div></div></div><div class="change-set" id="c17"><div class="comment" data-id="11888135" data-no="17"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-17" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445095" id="a150630_411311"><img src="https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445095" id="a150630_411311"><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-17"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-17" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c17">Comment 17</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-11-25 11:19 PST" data-time="1480101591">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-17">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-17" data-comment-id="11888135">(In reply to Andy McKay [:andym] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web Extension's data: scheme pages can be controlled by other extensions"
   href="/show_bug.cgi?id=1319070#c14">comment #14</a>)
<span class="quote">&gt; I found only 1 mention of data: in the manifests of 100k extensions. </span >

No other mentions in content_scripts declarations?  That's almost unbelievable.


(In reply to :Gijs Kruitbosch from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web Extension's data: scheme pages can be controlled by other extensions"
   href="/show_bug.cgi?id=1319070#c15">comment #15</a>)
<span class="quote">&gt; In case it's relevant: note that data: is treated differently by chrome than
&gt; by us - it can inherit a principal in Firefox, and doesn't in Chrome, see
&gt; <a rel="nofollow" href="https://groups.google.com/d/msg/mozilla.dev.platform/w0IgmymXDds/4-EvoXPvAAAJ">https://groups.google.com/d/msg/mozilla.dev.platform/w0IgmymXDds/4-EvoXPvAAAJ</a>
&gt; (which is about us aligning with Chrome, which is... difficult).</span >

From smaug's last email in that thread, it looks like this is actually happening.

Once that is done, alternatives 1) and 3) become unnecessary, and we might want to revert to matching against the data: URI (and not principal) for compat reasons.

Which brings the question whether we should do anything here, apart from fixing the (temporary) security issue until data: URIs get the unique opaque origins?</pre></div><div class="change-set" id="c18"><div class="comment" data-id="11888216" data-no="18"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-18" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" id="a150630_411311"><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_106098" id="a150630_411311"><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-18"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-18" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c18">Comment 18</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-11-25 12:22 PST" data-time="1480105326">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-18">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-18" data-comment-id="11888216">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8813894" name="attach_8813894" title="bug-1319070-fix-v2.patch">attachment 8813894</a> <a href="/attachment.cgi?id=8813894&amp;action=edit" title="bug-1319070-fix-v2.patch">[details]</a> <a href="/attachment.cgi?id=8813894&amp;action=diff" title="bug-1319070-fix-v2.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1319070&amp;attachment=8813894'>[review]</a>
bug-1319070-fix-v2.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8813894" name="attach_8813894" title="bug-1319070-fix-v2.patch">attachment 8813894</a> <a href="/attachment.cgi?id=8813894&amp;action=edit" title="bug-1319070-fix-v2.patch">[details]</a> <a href="/attachment.cgi?id=8813894&amp;action=diff" title="bug-1319070-fix-v2.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1319070&amp;attachment=8813894'>[review]</a>:
-----------------------------------------------------------------

Sorry to be such a pain about this. Given the discussion so far, I'd be happy with just the two changes below. They should also allow the code to correctly match non-inherited data: URI origins, when they're implemented, without any changes.

::: toolkit/components/extensions/ExtensionContent.jsm
&#64;&#64; +165,5 &#64;&#64;
<span class="quote">&gt; +      }
&gt; +    }
&gt; +
&gt; +    // Documents with data: URIs also inherit the principal.
&gt; +    if (uri.scheme === &quot;data&quot;) {</span >

Let's go with the URI_INHERITS_SECURITY_CONTEXT flag check for now, just for the sake of future proofing, and add a comment that it currently applies only to data: URIs. I agree that this version is more readable, but it seems like this behavior is going to change, and we might wind up overlooking other similar cases in the future.

&#64;&#64; +170,1 &#64;&#64;
<span class="quote">&gt;        uri = principal.URI;</span >

Given the way we're currently handling this, and how similar it is to the use case and handling of about:srcdoc, I think maybe we should only do this if match_about_blank is set, and reject the match otherwise.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8813894&amp;action=edit"
           title="bug-1319070-fix-v2.patch"
           class=""
        >Attachment #8813894</a> -
        Flags: <span class="activity-deleted">review?(kmaglione+bmo)</span></div></div></div><div class="change-set" id="c19"><div class="comment" data-id="11888226" data-no="19"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-19" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" id="a150630_411311"><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_106098" id="a150630_411311"><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-19"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-19" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c19">Comment 19</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-11-25 12:39 PST" data-time="1480106359">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-19">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-19" data-comment-id="11888226">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8814476" name="attach_8814476" title="bug-1319070-tests-v2.patch">attachment 8814476</a> <a href="/attachment.cgi?id=8814476&amp;action=edit" title="bug-1319070-tests-v2.patch">[details]</a> <a href="/attachment.cgi?id=8814476&amp;action=diff" title="bug-1319070-tests-v2.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1319070&amp;attachment=8814476'>[review]</a>
bug-1319070-tests-v2.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8814476" name="attach_8814476" title="bug-1319070-tests-v2.patch">attachment 8814476</a> <a href="/attachment.cgi?id=8814476&amp;action=edit" title="bug-1319070-tests-v2.patch">[details]</a> <a href="/attachment.cgi?id=8814476&amp;action=diff" title="bug-1319070-tests-v2.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1319070&amp;attachment=8814476'>[review]</a>:
-----------------------------------------------------------------

Looks good aside from a few nits. Thanks!

::: browser/components/extensions/test/browser/browser_ext_tabs_executeScript_bad.js
&#64;&#64; +147,5 &#64;&#64;
<span class="quote">&gt; +    permissions: [&quot;&lt;all_urls&gt;&quot;, &quot;webNavigation&quot;],
&gt; +  };
&gt; +
&gt; +  const files = {
&gt; +    &quot;page.html&quot;: `</span >

Please always include a `&lt;!DOCTYPE html&gt;` declaration so we don't wind up in quirks mode.

&#64;&#64; +166,5 &#64;&#64;
<span class="quote">&gt; +    let tab;
&gt; +
&gt; +    browser.webNavigation.onCompleted.addListener(({url, frameId}) =&gt; {
&gt; +      browser.test.log(`Document loading complete: ${url}`);
&gt; +      if (!frameId) {</span >

Nit: `if (frameId === 0)` so it's clearer we're looking for the top-level frame rather than an omitted frame ID.

&#64;&#64; +179,5 &#64;&#64;
<span class="quote">&gt; +          allFrames: true,
&gt; +        }).then(([result]) =&gt; {
&gt; +          browser.test.fail(`Should not have matched ${result}`);
&gt; +          browser.test.sendMessage(&quot;done&quot;);
&gt; +        }).catch(({message}) =&gt; {</span >

Nit: Please use a second argument to the `.then()` clause rather than a `.catch()` clause here, since we're not trying to catch errors from the success handler.

Or, even better, please just use `browser.test.assertRejects`, and make this an async function, so we wind up with something like:

    if (cmd === &quot;execute&quot;) {
      await browser.test.assertRejects(
        browser.tabs.executeScript(tab.id, {
          code: &quot;location.href;&quot;,
          allFrames: true,
        }),
        /No matching window/,
        &quot;Should not execute in `data:` frame&quot;);

      browser.test.sendMessage(&quot;done&quot;);
    }

&#64;&#64; +195,5 &#64;&#64;
<span class="quote">&gt; +  yield extension.startup();
&gt; +
&gt; +  // Test extension page with a data: iframe.
&gt; +  const page = yield extension.awaitMessage(&quot;tab-ready&quot;);
&gt; +  ok(page.includes(&quot;page.html&quot;), &quot;Extension page loaded into a tab&quot;);</span >

Nit: s/includes/endsWith/

&#64;&#64; +198,5 &#64;&#64;
<span class="quote">&gt; +  const page = yield extension.awaitMessage(&quot;tab-ready&quot;);
&gt; +  ok(page.includes(&quot;page.html&quot;), &quot;Extension page loaded into a tab&quot;);
&gt; +
&gt; +  extension.sendMessage(&quot;execute&quot;);
&gt; +  yield extension.awaitMessage(&quot;done&quot;);</span >

mixedpuppy is currently working on allowing extensions to match their own moz-extension: URLs. I'm not actually sure what the expected behavior will be for executeScript with actual extension pages at that point... so this might break. But we'll deal with that when we come to it.

The fix would probably involve just loading two extensions rather than one.

::: toolkit/components/extensions/test/mochitest/test_chrome_ext_contentscript_data_uri.html
&#64;&#64; +33,5 &#64;&#64;
<span class="quote">&gt; +      body { background: yellow; }
&gt; +    `,
&gt; +    &quot;all_urls.js&quot;: function() {
&gt; +      document.body.style.color = &quot;red&quot;;
&gt; +      browser.test.assertFalse(window.location.href.startsWith(&quot;data:&quot;),</span >

Nit: `assertTrue(location.protocol != &quot;data:&quot;, ...`

&#64;&#64; +34,5 &#64;&#64;
<span class="quote">&gt; +    `,
&gt; +    &quot;all_urls.js&quot;: function() {
&gt; +      document.body.style.color = &quot;red&quot;;
&gt; +      browser.test.assertFalse(window.location.href.startsWith(&quot;data:&quot;),
&gt; +        `Matched document not a data URI: ${window.location.href}`);</span >

Nit: Please align with opening `(`</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8814476&amp;action=edit"
           title="bug-1319070-tests-v2.patch"
           class=""
        >Attachment #8814476</a> -
        Flags: review?(kmaglione+bmo) &rarr; review+</div></div></div><div class="change-set" id="c20"><div class="comment" data-id="11889660" data-no="20"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-20" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445095" id="a150630_411311"><img src="https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445095" id="a150630_411311"><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-20"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-20" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c20">Comment 20</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-11-27 13:30 PST" data-time="1480282235">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-20">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8814740"
         class="attachment patch obsolete"
         data-id="8814740" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug-1319070-fix-v3.patch">
      <meta itemprop="contentSize" content="2133">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8814740">
          <a class="link" href="attachment.cgi?id=8814740&amp;action=diff">
        <span id="att-8814740-description" itemprop="description">bug-1319070-fix-v3.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8814740&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1319070&attachment=8814740">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-20" data-comment-id="11889660"><span class="quote">&gt; Sorry to be such a pain about this.</span >

Based on what I know about security bugs, it wasn't really that painful.  ;)

Anyway, your arguments make sense, even if I don't fully agree with the match_about_blank part.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8813894&amp;action=edit"
           title="bug-1319070-fix-v2.patch"
           class=""
        >Attachment #8813894</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8814740&amp;action=edit"
           title="bug-1319070-fix-v3.patch"
           class=""
        >Attachment #8814740</a> -
        Flags: review?(kmaglione+bmo)</div></div></div><div class="change-set" id="c21"><div class="comment" data-id="11889685" data-no="21"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-21" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445095" id="a150630_411311"><img src="https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445095" id="a150630_411311"><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-21"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-21" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c21">Comment 21</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-11-27 13:54 PST" data-time="1480283670">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-21">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8814747"
         class="attachment patch obsolete"
         data-id="8814747" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug-1319070-tests-v3.patch">
      <meta itemprop="contentSize" content="8155">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8814747">
          <a class="link" href="attachment.cgi?id=8814747&amp;action=diff">
        <span id="att-8814747-description" itemprop="description">bug-1319070-tests-v3.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8814747&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1319070&attachment=8814747">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-21" data-comment-id="11889685"><span class="quote">&gt; Or, even better, please just use `browser.test.assertRejects`, and make this</span >
This loses the ability to fail with the matched document's URI in the log (which was useful to me during debugging), so I kept the other approach.


<span class="quote">&gt; mixedpuppy is currently working on allowing extensions to match their own
&gt; moz-extension: URLs.   [...]   so this might break. </span >
Since Shane's changes are likely to land before these tests, I went ahead and updated them, so r? again.


<span class="quote">&gt; Nit: Please align with opening `(`</span >
I hate this rule.  It feels ugly and foreign to JS, coming from C++ land.
Why does WE code style even differ from the general Mozilla style guide?</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8814476&amp;action=edit"
           title="bug-1319070-tests-v2.patch"
           class=""
        >Attachment #8814476</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8814747&amp;action=edit"
           title="bug-1319070-tests-v3.patch"
           class=""
        >Attachment #8814747</a> -
        Flags: review?(kmaglione+bmo)</div></div></div><div class="change-set" id="a705555_106098"><div class="change" id="aa705555_106098">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" id="a705555_106098"><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_106098" id="a705555_106098"><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a705555_106098"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a705555_106098">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#a705555_106098">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-11-29 10:21 PST" data-time="1480443664">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8814740&amp;action=edit"
           title="bug-1319070-fix-v3.patch"
           class=""
        >Attachment #8814740</a> -
        Flags: review?(kmaglione+bmo) &rarr; review+</div></div></div><div class="change-set" id="c22"><div class="comment" data-id="11895362" data-no="22"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-22" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" id="a705555_106098"><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_106098" id="a705555_106098"><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-22"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-22" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c22">Comment 22</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-11-29 10:26 PST" data-time="1480444007">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-22">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-22" data-comment-id="11895362">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8814747" name="attach_8814747" title="bug-1319070-tests-v3.patch">attachment 8814747</a> <a href="/attachment.cgi?id=8814747&amp;action=edit" title="bug-1319070-tests-v3.patch">[details]</a> <a href="/attachment.cgi?id=8814747&amp;action=diff" title="bug-1319070-tests-v3.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1319070&amp;attachment=8814747'>[review]</a>
bug-1319070-tests-v3.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8814747" name="attach_8814747" title="bug-1319070-tests-v3.patch">attachment 8814747</a> <a href="/attachment.cgi?id=8814747&amp;action=edit" title="bug-1319070-tests-v3.patch">[details]</a> <a href="/attachment.cgi?id=8814747&amp;action=diff" title="bug-1319070-tests-v3.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1319070&amp;attachment=8814747'>[review]</a>:
-----------------------------------------------------------------

::: browser/components/extensions/test/browser/browser_ext_tabs_executeScript_bad.js
&#64;&#64; +145,5 &#64;&#64;
<span class="quote">&gt; +add_task(function* testMatchDataURI() {
&gt; +  const target = ExtensionTestUtils.loadExtension({
&gt; +    files: {
&gt; +      &quot;page.html&quot;: `
&gt; +        &lt;!doctype html&gt;</span >

Nit: DOCTYPE should be capitalized, and this should start on the previous line.

&#64;&#64; +174,5 &#64;&#64;
<span class="quote">&gt; +        }
&gt; +      });
&gt; +
&gt; +      browser.test.onMessage.addListener(msg =&gt; {
&gt; +        browser.tabs.executeScript({</span >

Nit: Please use browser.test.assertRejects and an async function. If you really want the document URL for debugging, you can add it to the assertion message, or change assertRejects to report the resolution value.

::: toolkit/components/extensions/test/mochitest/test_chrome_ext_contentscript_data_uri.html
&#64;&#64; +15,5 &#64;&#64;
<span class="quote">&gt; +add_task(function* test_contentscript_data_uri() {
&gt; +  const target = ExtensionTestUtils.loadExtension({
&gt; +    files: {
&gt; +      &quot;page.html&quot;: `
&gt; +        &lt;!doctype html&gt;</span >

As above, DOCTYPE, and on the line above.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8814747&amp;action=edit"
           title="bug-1319070-tests-v3.patch"
           class=""
        >Attachment #8814747</a> -
        Flags: review?(kmaglione+bmo) &rarr; review+</div></div></div><div class="change-set" id="c23"><div class="comment" data-id="11895380" data-no="23"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-23" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" id="a705555_106098"><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_106098" id="a705555_106098"><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-23"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-23" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c23">Comment 23</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-11-29 10:30 PST" data-time="1480444231">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-23">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-23" data-comment-id="11895380">(In reply to Tomislav Jovanovic :zombie from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web Extension's data: scheme pages can be controlled by other extensions"
   href="/show_bug.cgi?id=1319070#c21">comment #21</a>)
<span class="quote">&gt; &gt; Nit: Please align with opening `(`
&gt; I hate this rule.  It feels ugly and foreign to JS, coming from C++ land.</span >
&gt;
<span class="quote">&gt; Why does WE code style even differ from the general Mozilla style guide?</span >

It's a common rule in C and C++, too, and also in Toolkit code. All arguments
are aligned with the first argument, and the first argument either goes
immediately after the opening paren, or on its own line at the next indent
level.</pre></div><div class="change-set" id="c24"><div class="comment" data-id="11901769" data-no="24"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-24" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445095" id="a705555_106098"><img src="https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445095" id="a705555_106098"><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-24"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-24" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c24">Comment 24</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-12-01 12:07 PST" data-time="1480622879">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-24">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-24" data-comment-id="11901769">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8814740" name="attach_8814740" title="bug-1319070-fix-v3.patch">attachment 8814740</a> <a href="/attachment.cgi?id=8814740&amp;action=edit" title="bug-1319070-fix-v3.patch">[details]</a> <a href="/attachment.cgi?id=8814740&amp;action=diff" title="bug-1319070-fix-v3.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1319070&amp;attachment=8814740'>[review]</a>
bug-1319070-fix-v3.patch

[Security approval request comment]
<span class="quote">&gt; How easily could an exploit be constructed based on the patch?</span >
Not too easily.  Understanding the issue in this bug could be considered easy (for a security researcher).  Realizing that this could also apply to another extension's page is a first non-obvious leap IMO.  Finally, constructing an exploit extension that navigates a &quot;victim&quot; extension's page to a data: URI is probably fairly hard (I'm not aware of a way to do that).


<span class="quote">&gt; Do comments in the patch, the check-in comment, or tests included
&gt; in the patch paint a bulls-eye on the security problem?</span >
The tests are in a separate patch.  The use of URI_INHERITS_SECURITY_CONTEXT constant, and the comment above make it somewhat obvious this a security-related patch, especially if it lands linked to a protected bug.  But nothing in the patch points to this applying for extension pages, the first necessary leap explained above.


<span class="quote">&gt; Which older supported branches are affected by this flaw?</span >
The original POC works on aurora.  It doesn't work on beta and release, but that is related to the use of popup.  Opening victim extension's page in a tab still allows the attacker extension to attach the content script after navigating to a data:URI.  The `localStorage.get()` method call throws &quot;Component is not available&quot; for some reason, but that is only one venue of attack, there are likely others available to attacker that can attach a content script.


<span class="quote">&gt; If not all supported branches, which bug introduced the flaw?</span >
No bug.  This is an architectural mismatch between Chrome's extension API and our inheriting principals for data: URIs.


<span class="quote">&gt; Do you have backports for the affected branches?</span >
No.


<span class="quote">&gt; If not, how different, hard to create, and risky will they be?</span >
Slightly different because the code is related to `match_about_blank` which was implemented in the last cycle (current aurora).  But not risky as the actual fix is fairly simple and easy to understand/test. 


<span class="quote">&gt; How likely is this patch to cause regressions; how much testing does it need?</span >
It is unlikely this will cause a lot of regressions.  Per Andy's comment above, explicitly matching against data: URIs is rare, and using &lt;all_urls&gt; will continue to work if extensions have the right to match the owner document.

Not a single existing web extensions test failed as a result of this fix.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8814740&amp;action=edit"
           title="bug-1319070-fix-v3.patch"
           class=""
        >Attachment #8814740</a> -
        Flags: sec-approval?</div></div></div><div class="change-set" id="c25"><div class="comment" data-id="11904777" data-no="25"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-25" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a705555_106098"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_280903" id="a705555_106098"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-25"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-25" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c25">Comment 25</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-12-02 19:43 PST" data-time="1480736609">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-25">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-25" data-comment-id="11904777">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8814740" name="attach_8814740" title="bug-1319070-fix-v3.patch">attachment 8814740</a> <a href="/attachment.cgi?id=8814740&amp;action=edit" title="bug-1319070-fix-v3.patch">[details]</a> <a href="/attachment.cgi?id=8814740&amp;action=diff" title="bug-1319070-fix-v3.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1319070&amp;attachment=8814740'>[review]</a>
bug-1319070-fix-v3.patch

sec-approval+ for trunk for the patch (but please don't check in tests yet). Please nominate this for affected branches as well so we can patch there.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8814740&amp;action=edit"
           title="bug-1319070-fix-v3.patch"
           class=""
        >Attachment #8814740</a> -
        Flags: sec-approval? &rarr; sec-approval+</div></div></div><div class="change-set" id="c26"><div class="comment" data-id="11905177" data-no="26"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-26" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445095" id="a705555_106098"><img src="https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445095" id="a705555_106098"><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-26"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-26" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c26">Comment 26</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-12-03 11:00 PST" data-time="1480791616">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-26">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-26" data-comment-id="11905177">(In reply to Tomislav Jovanovic :zombie from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web Extension's data: scheme pages can be controlled by other extensions"
   href="/show_bug.cgi?id=1319070#c24">comment #24</a>)
<span class="quote">&gt; &gt; How likely is this patch to cause regressions; how much testing does it need?
&gt; It is unlikely this will cause a lot of regressions.  Per Andy's comment
&gt; above, explicitly matching against data: URIs is rare, and using &lt;all_urls&gt;
&gt; will continue to work if extensions have the right to match the owner
&gt; document.</span >

Looking again into this, I disagree with myself here.  I was thinking of the impact of my original proposed patch.  With the final patch, which refuses the match without match_about_blank, this is much more likely to break existing extensions.

And this is especially true for backports to earlier branches where match_about_blank was not implemented, and extensions couldn't even include it because schema validation would throw.


Kris, in light of this, do you agree with backports ignoring match_about_blank, and always matching against the principal (basically my original patch)?  I know it's not your preferred fix, but it would only be &quot;temporary&quot;, and would give us time to document the new behavior in Nightly and let developers &quot;fix&quot; extensions while this rides the trains?</pre><div class="activity"><div class="change">Flags: needinfo?(kmaglione+bmo)</div></div></div><div class="change-set" id="c27"><div class="comment" data-id="11905178" data-no="27"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-27" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445095" id="a705555_106098"><img src="https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445095" id="a705555_106098"><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-27"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-27" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c27">Comment 27</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-12-03 11:06 PST" data-time="1480791963">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-27">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-27" data-comment-id="11905178">Andy, can you please check again how many extensions is this likely to affect?

The number of Chrome extensions that specify &lt;all_urls&gt; in `content_scripts`, and how many of those also specify match_about_blank?</pre><div class="activity"><div class="change">Flags: needinfo?(amckay)</div></div></div><div class="change-set" id="c28"><div class="comment" data-id="11905400" data-no="28"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-28" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445095" id="a705555_106098"><img src="https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445095" id="a705555_106098"><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-28"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-28" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c28">Comment 28</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-12-03 19:45 PST" data-time="1480823109">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-28">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8816734"
         class="attachment patch obsolete"
         data-id="8816734" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug-1319070-fix-beta.patch">
      <meta itemprop="contentSize" content="1241">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8816734">
          <a class="link" href="attachment.cgi?id=8816734&amp;action=diff">
        <span id="att-8816734-description" itemprop="description">bug-1319070-fix-beta.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8816734&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1319070&attachment=8816734">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-28" data-comment-id="11905400">This is the patch I propose for beta and earlier branches.


Built and passing all tests on beta, but:
 - Couldn't build on ESR45 for some reason,
 - Successfully built on the release branch, but our mochitests don't run for for another obscure reason.  Manually confirmed the security fix.


Including match_about_blank in those versions would require changes in quite a few more places: tabs.executeScript, schema...  To minimize risk from those, I suggest we go with this.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(kmaglione+bmo)</span></div><div class="change">
        <a href="/attachment.cgi?id=8816734&amp;action=edit"
           title="bug-1319070-fix-beta.patch"
           class=""
        >Attachment #8816734</a> -
        Flags: review?(kmaglione+bmo)</div></div></div><div class="change-set" id="c29"><div class="comment" data-id="11905413" data-no="29"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-29" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445095" id="a705555_106098"><img src="https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445095" id="a705555_106098"><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-29"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-29" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c29">Comment 29</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-12-03 20:41 PST" data-time="1480826500">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-29">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8816737"
         class="attachment patch obsolete"
         data-id="8816737" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug-1319070-fix-aurora.patch">
      <meta itemprop="contentSize" content="1730">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8816737">
          <a class="link" href="attachment.cgi?id=8816737&amp;action=diff">
        <span id="att-8816737-description" itemprop="description">bug-1319070-fix-aurora.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8816737&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1319070&attachment=8816737">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-29" data-comment-id="11905413">I'm not sure about the protocol for security bugs.  Do I need to ask for review/sec-approval for each of these, or just approval-branch?</pre></div><div class="change-set" id="c30"><div class="comment" data-id="11905690" data-no="30"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-30" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445095" id="a705555_106098"><img src="https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445095" id="a705555_106098"><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-30"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-30" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c30">Comment 30</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-12-04 10:22 PST" data-time="1480875777">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-30">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-30" data-comment-id="11905690">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8816737" name="attach_8816737" title="bug-1319070-fix-aurora.patch">attachment 8816737</a> <a href="/attachment.cgi?id=8816737&amp;action=edit" title="bug-1319070-fix-aurora.patch">[details]</a> <a href="/attachment.cgi?id=8816737&amp;action=diff" title="bug-1319070-fix-aurora.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1319070&amp;attachment=8816737'>[review]</a>
bug-1319070-fix-aurora.patch

This is a trivial port of the original patch that got r+ and sec-approval+ above.


Approval Request Comment
<span class="quote">&gt; [Feature/Bug causing the regression]:</span >
No bug.  Web extensions content scripts have a security issue.

<span class="quote">&gt; [User impact if declined]:</span >
Potential privilege escalation between extensions.

<span class="quote">&gt; [Is this code covered by automated tests?]:</span >
Existing functionality around this code has good test coverage.  I wrote new tests for this issue, though they are not landing yet because security bug.

<span class="quote">&gt; [Has the fix been verified in Nightly?]:</span >
Yes, I built and manually verified on both nightly and aurora.

<span class="quote">&gt; [Needs manual test from QE? If yes, steps to reproduce]: </span >
Unsure what is the protocol for security bugs.  I'm guessing no.
If I'm wrong, STR are in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web Extension's data: scheme pages can be controlled by other extensions"
   href="/show_bug.cgi?id=1319070#c0">comment #0</a>.

<span class="quote">&gt; [List of other uplifts needed for the feature/fix]:</span >
None

<span class="quote">&gt; [Is the change risky?]:</span >
Somewhat

<span class="quote">&gt; [Why is the change risky/not risky?]:</span >
Overall, not too risky as impact is limited to Web extensions.  But the change might break some existing extensions.  This is unavoidable, and we have steps for developers to mitigate (not yet public due to security bug).

<span class="quote">&gt; [String changes made/needed]:</span >
None</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8816737&amp;action=edit"
           title="bug-1319070-fix-aurora.patch"
           class=""
        >Attachment #8816737</a> -
        Flags: approval-mozilla-aurora?</div></div></div><div class="change-set" id="c31"><div class="comment" data-id="11922020" data-no="31"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-31" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445095" id="a705555_106098"><img src="https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445095" id="a705555_106098"><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-31"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-31" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c31">Comment 31</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-12-15 11:27 PST" data-time="1481830027">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-31">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-31" data-comment-id="11922020">(In reply to Tomislav Jovanovic :zombie from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web Extension's data: scheme pages can be controlled by other extensions"
   href="/show_bug.cgi?id=1319070#c27">comment #27</a>)
<span class="quote">&gt; The number of Chrome extensions that specify &lt;all_urls&gt; in
&gt; `content_scripts`, and how many of those also specify match_about_blank?</span >

From Andy:

    198 match_about_blank
   4339 all_urls
     68 both

out of ~50k Chrome extensions.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(amckay)</span></div></div></div><div class="change-set" id="c32"><div class="comment" data-id="11925112" data-no="32"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-32" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" id="a705555_106098"><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_106098" id="a705555_106098"><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-32"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-32" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c32">Comment 32</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-12-16 14:24 PST" data-time="1481927065">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-32">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-32" data-comment-id="11925112">(In reply to Tomislav Jovanovic :zombie from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web Extension's data: scheme pages can be controlled by other extensions"
   href="/show_bug.cgi?id=1319070#c26">comment #26</a>)
<span class="quote">&gt; (In reply to Tomislav Jovanovic :zombie from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web Extension's data: scheme pages can be controlled by other extensions"
   href="/show_bug.cgi?id=1319070#c24">comment #24</a>)
&gt; &gt; &gt; How likely is this patch to cause regressions; how much testing does it need?
&gt; &gt; It is unlikely this will cause a lot of regressions.  Per Andy's comment
&gt; &gt; above, explicitly matching against data: URIs is rare, and using &lt;all_urls&gt;
&gt; &gt; will continue to work if extensions have the right to match the owner
&gt; &gt; document.
&gt; 
&gt; Looking again into this, I disagree with myself here.  I was thinking of the
&gt; impact of my original proposed patch.  With the final patch, which refuses
&gt; the match without match_about_blank, this is much more likely to break
&gt; existing extensions.</span >

I don't this is very likely to cause serious issues in practice.

<span class="quote">&gt; Kris, in light of this, do you agree with backports ignoring
&gt; match_about_blank, and always matching against the principal (basically my
&gt; original patch)?  I know it's not your preferred fix, but it would only be
&gt; &quot;temporary&quot;, and would give us time to document the new behavior in Nightly
&gt; and let developers &quot;fix&quot; extensions while this rides the trains?</span >

I don't really have a strong opinion either way.</pre></div><div class="change-set" id="a2266107_106098"><div class="change" id="aa2266107_106098">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" id="a2266107_106098"><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_106098" id="a2266107_106098"><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a2266107_106098"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a2266107_106098">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#a2266107_106098">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-12-17 11:50 PST" data-time="1482004216">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8816734&amp;action=edit"
           title="bug-1319070-fix-beta.patch"
           class=""
        >Attachment #8816734</a> -
        Flags: review?(kmaglione+bmo) &rarr; review+</div></div></div><div class="change-set" id="c33"><div class="comment" data-id="11926053" data-no="33"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-33" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" id="a2266107_106098"><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_106098" id="a2266107_106098"><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-33"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-33" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c33">Comment 33</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-12-17 11:51 PST" data-time="1482004292">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-33">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-33" data-comment-id="11926053">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8816734" name="attach_8816734" title="bug-1319070-fix-beta.patch">attachment 8816734</a> <a href="/attachment.cgi?id=8816734&amp;action=edit" title="bug-1319070-fix-beta.patch">[details]</a> <a href="/attachment.cgi?id=8816734&amp;action=diff" title="bug-1319070-fix-beta.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1319070&amp;attachment=8816734'>[review]</a>
bug-1319070-fix-beta.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8816734" name="attach_8816734" title="bug-1319070-fix-beta.patch">attachment 8816734</a> <a href="/attachment.cgi?id=8816734&amp;action=edit" title="bug-1319070-fix-beta.patch">[details]</a> <a href="/attachment.cgi?id=8816734&amp;action=diff" title="bug-1319070-fix-beta.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1319070&amp;attachment=8816734'>[review]</a>:
-----------------------------------------------------------------

(Please remove the reference to data: URIs from the commit message before landing)</pre></div><div class="change-set" id="c34"><div class="comment" data-id="11929622" data-no="34"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-34" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445095" id="a2266107_106098"><img src="https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445095" id="a2266107_106098"><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-34"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-34" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c34">Comment 34</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-12-19 14:09 PST" data-time="1482185399">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-34">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8820053"
         class="attachment patch obsolete"
         data-id="8820053" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug-1319070-fix-v4.patch">
      <meta itemprop="contentSize" content="2118">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8820053">
          <a class="link" href="attachment.cgi?id=8820053&amp;action=diff">
        <span id="att-8820053-description" itemprop="description">bug-1319070-fix-v4.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8820053&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1319070&attachment=8820053">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-34" data-comment-id="11929622">This is the patch that got r+ and sec-approval+ above, with the vaguer commit message.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8814740&amp;action=edit"
           title="bug-1319070-fix-v3.patch"
           class=""
        >Attachment #8814740</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="c35"><div class="comment" data-id="11929637" data-no="35"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-35" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445095" id="a2266107_106098"><img src="https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445095" id="a2266107_106098"><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-35"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-35" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c35">Comment 35</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-12-19 14:16 PST" data-time="1482185774">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-35">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8820054"
         class="attachment patch obsolete"
         data-id="8820054" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug-1319070-fix-aurora-v2.patch">
      <meta itemprop="contentSize" content="1715">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8820054">
          <a class="link" href="attachment.cgi?id=8820054&amp;action=diff">
        <span id="att-8820054-description" itemprop="description">bug-1319070-fix-aurora-v2.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8820054&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1319070&attachment=8820054">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-35" data-comment-id="11929637">This is a trivial port (with vaguer commit message) of the original patch that got r+ and sec-approval+ above.

<span class="quote">&gt; Approval Request Comment</span >

See <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web Extension's data: scheme pages can be controlled by other extensions"
   href="/show_bug.cgi?id=1319070#c30">comment #30</a> above.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8816737&amp;action=edit"
           title="bug-1319070-fix-aurora.patch"
           class=""
        >Attachment #8816737</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8816737&amp;action=edit"
           title="bug-1319070-fix-aurora.patch"
           class=""
        >Attachment #8816737</a> -
        Flags: <span class="activity-deleted">approval-mozilla-aurora?</span></div><div class="change">
        <a href="/attachment.cgi?id=8820054&amp;action=edit"
           title="bug-1319070-fix-aurora-v2.patch"
           class=""
        >Attachment #8820054</a> -
        Flags: approval-mozilla-aurora?</div></div></div><div class="change-set" id="c36"><div class="comment" data-id="11929674" data-no="36"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-36" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445095" id="a2266107_106098"><img src="https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445095" id="a2266107_106098"><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-36"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-36" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c36">Comment 36</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-12-19 14:30 PST" data-time="1482186600">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-36">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8820056"
         class="attachment patch obsolete"
         data-id="8820056" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug-1319070-fix-beta-v2.patch">
      <meta itemprop="contentSize" content="1226">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8820056">
          <a class="link" href="attachment.cgi?id=8820056&amp;action=diff">
        <span id="att-8820056-description" itemprop="description">bug-1319070-fix-beta-v2.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8820056&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1319070&attachment=8820056">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-36" data-comment-id="11929674">This is the patch for beta and release that got r+ above, with a vaguer commit message.

<span class="quote">&gt; Approval Request Comment</span >
Same as aurora approval request <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web Extension's data: scheme pages can be controlled by other extensions"
   href="/show_bug.cgi?id=1319070#c30">comment #30</a> above.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8816734&amp;action=edit"
           title="bug-1319070-fix-beta.patch"
           class=""
        >Attachment #8816734</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8820056&amp;action=edit"
           title="bug-1319070-fix-beta-v2.patch"
           class=""
        >Attachment #8820056</a> -
        Flags: approval-mozilla-release?</div><div class="change">
        <a href="/attachment.cgi?id=8820056&amp;action=edit"
           title="bug-1319070-fix-beta-v2.patch"
           class=""
        >Attachment #8820056</a> -
        Flags: approval-mozilla-beta?</div></div></div><div class="change-set" id="c37"><div class="comment" data-id="11936548" data-no="37"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-37" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_451704" id="a2266107_106098"><img src="https://secure.gravatar.com/avatar/6168ea97fda0cefa449331e59b24e8f7?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_451704" id="a2266107_106098"><a class="email " href="/user_profile?user_id=451704" > <span class="fna">Liz Henry (:lizzard Please n-i to RyanVM, jcristau, or pascal)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-37"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-37" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c37">Comment 37</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-12-21 17:21 PST" data-time="1482369711">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-37">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-37" data-comment-id="11936548">Kris and zombie - Is ESR affected here?</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox50&amp;o1=isnotempty">status-firefox50</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox50&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox51&amp;o1=isnotempty">status-firefox51</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox51&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox52&amp;o1=isnotempty">status-firefox52</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox52&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox53&amp;o1=isnotempty">status-firefox53</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox53&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">Flags: needinfo?(tomica)</div><div class="change">Flags: needinfo?(kmaglione+bmo)</div></div></div><div class="change-set" id="c38"><div class="comment" data-id="11936997" data-no="38"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-38" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_506302" id="a2266107_106098"><img src="https://secure.gravatar.com/avatar/58cce0c47d9c6efb7d83bc34b9d79816?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_506302" id="a2266107_106098"><a class="email disabled" href="/user_profile?user_id=506302" > <span class="fna">Gerry Chang [:gchang]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-38"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-38" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c38">Comment 38</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-12-21 23:41 PST" data-time="1482392488">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-38">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-38" data-comment-id="11936997">Hi :abillings,
Do we need sec-approval for the patch?</pre><div class="activity"><div class="change">Flags: needinfo?(abillings)</div></div></div><div class="change-set" id="c39"><div class="comment" data-id="11937450" data-no="39"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-39" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445095" id="a2266107_106098"><img src="https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445095" id="a2266107_106098"><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-39"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-39" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c39">Comment 39</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-12-22 04:32 PST" data-time="1482409928">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-39">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-39" data-comment-id="11937450">From my understanding of the ESR_Landing_Process wiki, we're supposed to wait for things to land on beta before asking for ESR approval.  Is that right for security bugs too?


(In reply to Liz Henry (:lizzard) (needinfo? me) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web Extension's data: scheme pages can be controlled by other extensions"
   href="/show_bug.cgi?id=1319070#c37">comment #37</a>)
<span class="quote">&gt; Kris and zombie - Is ESR affected here?</span >
From the most conservative point of view, yes, this code is present in esr45.

Beyond that, many other major parts of Web Extensions were not present in 45, so the likelihood of actual impact is IMO much lower.  Unfortunately, I can't verify this, as I'm unable to build from the esr45 branch on Windows (`mach build` claims I need to run `mercurial-setup`, which throws with an unhelpful error).


(In reply to Gerry Chang [:gchang] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web Extension's data: scheme pages can be controlled by other extensions"
   href="/show_bug.cgi?id=1319070#c38">comment #38</a>)
<span class="quote">&gt; Hi :abillings,
&gt; Do we need sec-approval for the patch?</span >
Not trying to speak for :abillings, just to give details:
 - the original patch got sec-approval+, the latest version changed just the commit message,
 - the patch for aurora is a trivial back-port,
 - the patch for beta/release is modified because the flag used in the original patch was not present in those versions of the code.  IMO, this change does not modify the security implications of the patch.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(tomica)</span></div></div></div><div class="change-set" id="c40"><div class="comment" data-id="11938258" data-no="40"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-40" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a2266107_106098"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_280903" id="a2266107_106098"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-40"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-40" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c40">Comment 40</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-12-22 10:02 PST" data-time="1482429776">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-40">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-40" data-comment-id="11938258">(In reply to Gerry Chang [:gchang] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web Extension's data: scheme pages can be controlled by other extensions"
   href="/show_bug.cgi?id=1319070#c38">comment #38</a>)
<span class="quote">&gt; Hi :abillings,
&gt; Do we need sec-approval for the patch?</span >

Yes, it is a sec-high that affects more than one branch.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(abillings)</span></div></div></div><div class="change-set" id="c41"><div class="comment" data-id="11938264" data-no="41"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-41" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a2266107_106098"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_280903" id="a2266107_106098"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-41"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-41" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c41">Comment 41</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-12-22 10:03 PST" data-time="1482429820">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-41">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-41" data-comment-id="11938264">Re-reading <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web Extension's data: scheme pages can be controlled by other extensions"
   href="/show_bug.cgi?id=1319070#c39">comment 39</a>, please fill out the sec-approval? template anyway but I'll just approve it.</pre></div><div class="change-set" id="a2691876_106098"><div class="change" id="aa2691876_106098">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" id="a2691876_106098"><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_106098" id="a2691876_106098"><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a2691876_106098"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a2691876_106098">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#a2691876_106098">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-12-22 10:06 PST" data-time="1482429985">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(kmaglione+bmo)</span></div></div></div><div class="change-set" id="c42"><div class="comment" data-id="11940257" data-no="42"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-42" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445095" id="a2691876_106098"><img src="https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445095" id="a2691876_106098"><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-42"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-42" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c42">Comment 42</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-12-23 06:54 PST" data-time="1482504853">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-42">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-42" data-comment-id="11940257">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8820053" name="attach_8820053" title="bug-1319070-fix-v4.patch">attachment 8820053</a> <a href="/attachment.cgi?id=8820053&amp;action=edit" title="bug-1319070-fix-v4.patch">[details]</a> <a href="/attachment.cgi?id=8820053&amp;action=diff" title="bug-1319070-fix-v4.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1319070&amp;attachment=8820053'>[review]</a>
bug-1319070-fix-v4.patch

[Security approval request comment]
Mostly the same as <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web Extension's data: scheme pages can be controlled by other extensions"
   href="/show_bug.cgi?id=1319070#c24">comment #24</a>, as the only thing changed is a commit message.


<span class="quote">&gt; How easily could an exploit be constructed based on the patch?</span >
Not too easily.  Understanding the issue in this bug could be considered easy (for a security researcher).  Realizing that this could also apply to another extension's page is a first non-obvious leap IMO.  Finally, constructing an exploit extension that navigates a &quot;victim&quot; extension's page to a data: URI is probably fairly hard (I'm not aware of a way to do that).


<span class="quote">&gt; Do comments in the patch, the check-in comment, or tests included
&gt; in the patch paint a bulls-eye on the security problem?</span >
The tests are in a separate patch.  The use of URI_INHERITS_SECURITY_CONTEXT constant, and the comment above make it somewhat obvious this a security-related patch, especially if it lands linked to a protected bug.  But nothing in the patch points to this applying for extension pages, the first necessary leap explained above.


<span class="quote">&gt; Which older supported branches are affected by this flaw?</span >
The original POC works on aurora.  It doesn't work on beta and release, but that is related to the use of popup.  Opening victim extension's page in a tab still allows the attacker extension to attach the content script after navigating to a data:URI.  The `localStorage.get()` method call throws &quot;Component is not available&quot; for some reason, but that is only one venue of attack, there are likely others available to attacker that can attach a content script.

ESR 45 is potentially also affected, see <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web Extension's data: scheme pages can be controlled by other extensions"
   href="/show_bug.cgi?id=1319070#c39">comment #39</a> for details.


<span class="quote">&gt; If not all supported branches, which bug introduced the flaw?</span >
No bug.  This is an architectural mismatch between Chrome's extension API and our inheriting principals for data: URIs.


<span class="quote">&gt; Do you have backports for the affected branches?</span >
Yes, attached above, except for ESR 45, which I'm unable to build from source (will try via a push to try _after_ this lands to all other branches).


<span class="quote">&gt; If not, how different, hard to create, and risky will they be?</span >
It was slightly different and not hard or risky.


<span class="quote">&gt; How likely is this patch to cause regressions; how much testing does it need?</span >
It is unlikely this will cause a lot of regressions.  All existing web extensions tests pass with this patch applied.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8820053&amp;action=edit"
           title="bug-1319070-fix-v4.patch"
           class=""
        >Attachment #8820053</a> -
        Flags: sec-approval?</div></div></div><div class="change-set" id="c43"><div class="comment" data-id="11945567" data-no="43"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-43" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a2691876_106098"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_280903" id="a2691876_106098"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-43"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-43" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c43">Comment 43</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-12-28 15:20 PST" data-time="1482967206">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-43">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-43" data-comment-id="11945567">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8820053" name="attach_8820053" title="bug-1319070-fix-v4.patch">attachment 8820053</a> <a href="/attachment.cgi?id=8820053&amp;action=edit" title="bug-1319070-fix-v4.patch">[details]</a> <a href="/attachment.cgi?id=8820053&amp;action=diff" title="bug-1319070-fix-v4.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1319070&amp;attachment=8820053'>[review]</a>
bug-1319070-fix-v4.patch

sec-approval+ for trunk landing. Please nominate for branch, aurora, and beta. If you need altered patches for branches, please attach those and nominate them. 

Do *not* land any tests. We won't land tests for this issue until after we publicly ship a fix so we don't 0day ourselves with our own tests.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8820053&amp;action=edit"
           title="bug-1319070-fix-v4.patch"
           class=""
        >Attachment #8820053</a> -
        Flags: sec-approval? &rarr; sec-approval+</div></div></div><div class="change-set" id="a3229118_280903"><div class="change" id="aa3229118_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a3229118_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a3229118_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a3229118_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a3229118_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#a3229118_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-12-28 15:20 PST" data-time="1482967227">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox50&amp;o1=isnotempty">status-firefox50</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox50&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox50&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=isnotempty">status-firefox-esr45</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox51&amp;o1=isnotempty">tracking-firefox51</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox51&amp;o1=equals&amp;v1=%2B">+</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox52&amp;o1=isnotempty">tracking-firefox52</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox52&amp;o1=equals&amp;v1=%2B">+</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox53&amp;o1=isnotempty">tracking-firefox53</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox53&amp;o1=equals&amp;v1=%2B">+</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr45&amp;o1=isnotempty">tracking-firefox-esr45</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox_esr45&amp;o1=equals&amp;v1=51%2B">51+</a></div></div></div><div class="change-set" id="c44"><div class="comment" data-id="11945569" data-no="44"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-44" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a3229118_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_280903" id="a3229118_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-44"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-44" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c44">Comment 44</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-12-28 15:22 PST" data-time="1482967334">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-44">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-44" data-comment-id="11945569">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8820054" name="attach_8820054" title="bug-1319070-fix-aurora-v2.patch">attachment 8820054</a> <a href="/attachment.cgi?id=8820054&amp;action=edit" title="bug-1319070-fix-aurora-v2.patch">[details]</a> <a href="/attachment.cgi?id=8820054&amp;action=diff" title="bug-1319070-fix-aurora-v2.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1319070&amp;attachment=8820054'>[review]</a>
bug-1319070-fix-aurora-v2.patch

Giving aurora and beta approval. Release approval would only be given if we were chemspilling for it or it was going in another point release so I'm clearing that.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8820054&amp;action=edit"
           title="bug-1319070-fix-aurora-v2.patch"
           class=""
        >Attachment #8820054</a> -
        Flags: approval-mozilla-aurora? &rarr; approval-mozilla-aurora+</div></div></div><div class="change-set" id="a3229232_280903"><div class="change" id="aa3229232_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a3229232_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a3229232_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a3229232_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a3229232_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#a3229232_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-12-28 15:22 PST" data-time="1482967341">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8820056&amp;action=edit"
           title="bug-1319070-fix-beta-v2.patch"
           class=""
        >Attachment #8820056</a> -
        Flags: <span class="activity-deleted">approval-mozilla-release?</span></div><div class="change">
        <a href="/attachment.cgi?id=8820056&amp;action=edit"
           title="bug-1319070-fix-beta-v2.patch"
           class=""
        >Attachment #8820056</a> -
        Flags: <span class="activity-deleted">approval-mozilla-beta?</span></div><div class="change">
        <a href="/attachment.cgi?id=8820056&amp;action=edit"
           title="bug-1319070-fix-beta-v2.patch"
           class=""
        >Attachment #8820056</a> -
        Flags: approval-mozilla-beta+</div></div></div><div class="change-set" id="c45"><div class="comment" data-id="11946084" data-no="45"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-45" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_277293" id="a3229232_280903"><img src="https://secure.gravatar.com/avatar/8378311bf1bd5e9eddc7896a07688876?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_277293" id="a3229232_280903"><a class="email disabled" href="/user_profile?user_id=277293" > <span class="fna">Carsten Book [:Tomcat]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-45"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-45" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c45">Comment 45</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-12-29 00:48 PST" data-time="1483001289">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-45">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-45" data-comment-id="11946084"><a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-aurora/rev/2f4f0b816009">https://hg.mozilla.org/releases/mozilla-aurora/rev/2f4f0b816009</a></pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox52&amp;o1=isnotempty">status-firefox52</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox52&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox52&amp;o1=equals&amp;v1=fixed">fixed</a></div></div></div><div class="change-set" id="c46"><div class="comment" data-id="11946485" data-no="46"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-46" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a3229232_280903"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a3229232_280903"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-46"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-46" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c46">Comment 46</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-12-29 06:47 PST" data-time="1483022835">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-46">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-46" data-comment-id="11946485">Iris backed this out from Aurora for Jetpack failures. Not sure why this got uplifted to Aurora prior to landing on trunk, though, TBH.
<a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-aurora/rev/bf6b75460a2544ee06f6331cb6ed0a0da32cddf1">https://hg.mozilla.org/releases/mozilla-aurora/rev/bf6b75460a2544ee06f6331cb6ed0a0da32cddf1</a></pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox52&amp;o1=isnotempty">status-firefox52</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox52&amp;o1=equals&amp;v1=fixed">fixed</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox52&amp;o1=equals&amp;v1=affected">affected</a></div></div></div><div class="change-set" id="c47"><div class="comment" data-id="11946908" data-no="47"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-47" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445095" id="a3229232_280903"><img src="https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445095" id="a3229232_280903"><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-47"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-47" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c47">Comment 47</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-12-29 10:22 PST" data-time="1483035755">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-47">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8822479"
         class="attachment patch"
         data-id="8822479" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug-1319070-fix-v5.patch">
      <meta itemprop="contentSize" content="2952">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8822479">
          <a class="link" href="attachment.cgi?id=8822479&amp;action=diff">
        <span id="att-8822479-description" itemprop="description">bug-1319070-fix-v5.patch</span></a>
        — <a href="attachment.cgi?id=8822479&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1319070&attachment=8822479">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-47" data-comment-id="11946908">Since this already got landed once, in order to speed things up, and per discussion with Ryan, this is the updated patch containing a one-line test-only fix, with r=me on the Jetpack part (where I am a peer).</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8820053&amp;action=edit"
           title="bug-1319070-fix-v4.patch"
           class=""
        >Attachment #8820053</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="c48"><div class="comment" data-id="11946926" data-no="48"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-48" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a3229232_280903"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a3229232_280903"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-48"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-48" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c48">Comment 48</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-12-29 10:30 PST" data-time="1483036216">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-48">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-48" data-comment-id="11946926"><a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/6ccd471984af">https://hg.mozilla.org/integration/mozilla-inbound/rev/6ccd471984af</a></pre></div><div class="change-set" id="c49"><div class="comment" data-id="11947317" data-no="49"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-49" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445095" id="a3229232_280903"><img src="https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445095" id="a3229232_280903"><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-49"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-49" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c49">Comment 49</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-12-29 13:04 PST" data-time="1483045495">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-49">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8822514"
         class="attachment patch"
         data-id="8822514" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug-1319070-fix-aurora-v3.patch">
      <meta itemprop="contentSize" content="2549">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8822514">
          <a class="link" href="attachment.cgi?id=8822514&amp;action=diff">
        <span id="att-8822514-description" itemprop="description">bug-1319070-fix-aurora-v3.patch</span></a>
        — <a href="attachment.cgi?id=8822514&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1319070&attachment=8822514">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-49" data-comment-id="11947317">Same thing as <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web Extension's data: scheme pages can be controlled by other extensions"
   href="/show_bug.cgi?id=1319070#c47">comment #47</a>.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8820054&amp;action=edit"
           title="bug-1319070-fix-aurora-v2.patch"
           class=""
        >Attachment #8820054</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="c50"><div class="comment" data-id="11947318" data-no="50"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-50" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445095" id="a3229232_280903"><img src="https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445095" id="a3229232_280903"><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-50"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-50" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c50">Comment 50</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-12-29 13:06 PST" data-time="1483045577">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-50">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8822515"
         class="attachment patch"
         data-id="8822515" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug-1319070-fix-beta-v3.patch">
      <meta itemprop="contentSize" content="2060">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8822515">
          <a class="link" href="attachment.cgi?id=8822515&amp;action=diff">
        <span id="att-8822515-description" itemprop="description">bug-1319070-fix-beta-v3.patch</span></a>
        — <a href="attachment.cgi?id=8822515&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1319070&attachment=8822515">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-50" data-comment-id="11947318">Again, same as <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web Extension's data: scheme pages can be controlled by other extensions"
   href="/show_bug.cgi?id=1319070#c47">comment #47</a>.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8820056&amp;action=edit"
           title="bug-1319070-fix-beta-v2.patch"
           class=""
        >Attachment #8820056</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="c51"><div class="comment" data-id="11947711" data-no="51"
       data-tags="uplift">
    
    <table class="layout-table change-head " id="ch-51" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a3229232_280903"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a3229232_280903"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-51"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-51" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c51">Comment 51</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-12-29 17:53 PST" data-time="1483062817">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-51">
        <td colspan="2" class="comment-tags"><span class="comment-tag">uplift</span>
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-51" data-comment-id="11947711"><a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-aurora/rev/31d044fc3878">https://hg.mozilla.org/releases/mozilla-aurora/rev/31d044fc3878</a></pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox52&amp;o1=isnotempty">status-firefox52</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox52&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox52&amp;o1=equals&amp;v1=fixed">fixed</a></div></div></div><div class="change-set" id="c52"><div class="comment" data-id="11947799" data-no="52"
       data-tags="uplift">
    
    <table class="layout-table change-head " id="ch-52" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a3229232_280903"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a3229232_280903"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-52"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-52" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c52">Comment 52</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-12-29 18:52 PST" data-time="1483066349">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-52">
        <td colspan="2" class="comment-tags"><span class="comment-tag">uplift</span>
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-52" data-comment-id="11947799"><a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-beta/rev/0ef9b3667a06">https://hg.mozilla.org/releases/mozilla-beta/rev/0ef9b3667a06</a>

ni? zombie as a reminder for the ESR45 patch.</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox51&amp;o1=isnotempty">status-firefox51</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox51&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox51&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">Flags: needinfo?(tomica)</div></div></div><div class="change-set" id="c53"><div class="comment" data-id="11948458" data-no="53"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-53" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a3229232_280903"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a3229232_280903"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-53"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-53" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c53">Comment 53</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-12-30 07:12 PST" data-time="1483110739">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-53">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-53" data-comment-id="11948458"><a rel="nofollow" href="https://hg.mozilla.org/mozilla-central/rev/6ccd471984af">https://hg.mozilla.org/mozilla-central/rev/6ccd471984af</a></pre><div class="activity"><div class="change">Status: ASSIGNED &rarr; RESOLVED</div><div class="change">Closed: <span class="rel-time" title="2016-12-30 07:12 PST" data-time="1483110739">5 years ago</span></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox53&amp;o1=isnotempty">status-firefox53</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox53&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox53&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">Flags: in-testsuite?</div><div class="change">Resolution: --- &rarr; FIXED</div><div class="change">Target Milestone: --- &rarr; mozilla53</div></div></div><div class="change-set" id="c54"><div class="comment" data-id="11948497" data-no="54"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-54" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445095" id="a3229232_280903"><img src="https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445095" id="a3229232_280903"><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-54"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-54" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c54">Comment 54</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-12-30 07:38 PST" data-time="1483112321">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-54">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8822683"
         class="attachment patch"
         data-id="8822683" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug-1319070-fix-esr45-v2.patch">
      <meta itemprop="contentSize" content="1215">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8822683">
          <a class="link" href="attachment.cgi?id=8822683&amp;action=diff">
        <span id="att-8822683-description" itemprop="description">bug-1319070-fix-esr45-v2.patch</span></a>
        — <a href="attachment.cgi?id=8822683&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1319070&attachment=8822683">Splinter Review</a>
      </div>
    </div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(tomica)</span></div></div></div><div class="change-set" id="c55"><div class="comment" data-id="11948828" data-no="55"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-55" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445095" id="a3229232_280903"><img src="https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445095" id="a3229232_280903"><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-55"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-55" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c55">Comment 55</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-12-30 11:21 PST" data-time="1483125714">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-55">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-55" data-comment-id="11948828">Try push for the esr45 patch:
<a rel="nofollow" href="https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=c78f31b7e0c4">https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=c78f31b7e0c4</a>

Failures seem unrelated to this bug.</pre></div><div class="change-set" id="c56"><div class="comment" data-id="11948831" data-no="56"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-56" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445095" id="a3229232_280903"><img src="https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445095" id="a3229232_280903"><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-56"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-56" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c56">Comment 56</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-12-30 11:22 PST" data-time="1483125754">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-56">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-56" data-comment-id="11948831">Comment on <span class=""><a href="/attachment.cgi?id=8822683" name="attach_8822683" title="bug-1319070-fix-esr45-v2.patch">attachment 8822683</a> <a href="/attachment.cgi?id=8822683&amp;action=edit" title="bug-1319070-fix-esr45-v2.patch">[details]</a> <a href="/attachment.cgi?id=8822683&amp;action=diff" title="bug-1319070-fix-esr45-v2.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1319070&amp;attachment=8822683'>[review]</a>
bug-1319070-fix-esr45-v2.patch

[Approval Request Comment]
<span class="quote">&gt; If this is not a sec:{high,crit} bug, please state case for ESR consideration:</span >
This is a sec:high bug.

<span class="quote">&gt; User impact if declined: </span >
Potential privilege escalation across extensions.

<span class="quote">&gt; Fix Landed on Version:</span >
Just landed on trunk which is currently at version 53.

<span class="quote">&gt; Risk to taking this patch (and alternatives if risky): </span >
Mild risk or breaking some existing Web Extensions.

<span class="quote">&gt; String or UUID changes made by this patch: </span >
N/A</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8822683&amp;action=edit"
           title="bug-1319070-fix-esr45-v2.patch"
           class=""
        >Attachment #8822683</a> -
        Flags: approval-mozilla-esr45?</div></div></div><div class="change-set" id="a4239638_452604"><div class="change" id="aa4239638_452604">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_452604" id="a4239638_452604"><img src="https://secure.gravatar.com/avatar/7bb698c4991c5af83adabe3c3b8ee8aa?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_452604" id="a4239638_452604"><a class="email disabled" href="/user_profile?user_id=452604" > <span class="fna">Matt Wobensmith [:mwobensmith][:matt:]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a4239638_452604"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a4239638_452604">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#a4239638_452604">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-09 08:02 PST" data-time="1483977747">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: qe-verify+</div><div class="change">Whiteboard: [post-critsmash-triage]</div></div></div><div class="change-set" id="c57"><div class="comment" data-id="11967791" data-no="57"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-57" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a4239638_452604"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a4239638_452604"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-57"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-57" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c57">Comment 57</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-09 10:39 PST" data-time="1483987185">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-57">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-57" data-comment-id="11967791">Although this does violate the isolation WebExtensions are trying to create and is therefore important, in the bigger picture this is not a sec-high. If you install a malicious extension you're going to have a bad time and users don't know which add-ons are web extensions and which aren't.</pre><div class="activity"><div class="change">Flags: sec-bounty? &rarr; sec-bounty+</div><div class="change">Keywords: <a href="/buglist.cgi?keywords=sec-high&amp;resolution=---">sec-high</a> &rarr; <a href="/buglist.cgi?keywords=sec-moderate&amp;resolution=---">sec-moderate</a></div></div></div><div class="change-set" id="c58"><div class="comment" data-id="11968094" data-no="58"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-58" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_538805" id="a4239638_452604"><img src="https://secure.gravatar.com/avatar/9bd092443d615af36b31b04e81ad7806?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_538805" id="a4239638_452604"><a class="email disabled" href="/user_profile?user_id=538805" > <span class="fna">Ritu Kothari (:ritu) (Inactive, please n-i to RyanVM, jcristau, or pascal)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-58"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-58" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c58">Comment 58</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-09 11:55 PST" data-time="1483991707">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-58">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-58" data-comment-id="11968094">Hi Andy, Jorge, I am planning to take uplift in ESR45.7 (go-live late Jan). In <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web Extension's data: scheme pages can be controlled by other extensions"
   href="/show_bug.cgi?id=1319070#c56">comment 56</a>, there is a mention of milk risk to some webext that might notice breakage. I just wanted to make you aware and please let me know if you have any concerns.</pre><div class="activity"><div class="change">Flags: needinfo?(jorge)</div><div class="change">Flags: needinfo?(amckay)</div></div></div><div class="change-set" id="c59"><div class="comment" data-id="11968669" data-no="59"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-59" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_189742" id="a4239638_452604"><img src="https://secure.gravatar.com/avatar/3bd14a58b7b755d332e388e1646ba037?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_189742" id="a4239638_452604"><a class="email " href="/user_profile?user_id=189742" > <span class="fna">Jorge Villalobos [:jorgev] (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-59"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-59" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c59">Comment 59</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-09 15:11 PST" data-time="1484003481">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-59">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-59" data-comment-id="11968669">Looks okay to me.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(jorge)</span></div></div></div><div class="change-set" id="c60"><div class="comment" data-id="11969042" data-no="60"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-60" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_397635" id="a4239638_452604"><img src="https://secure.gravatar.com/avatar/4ae11454315077053052b613d6d77241?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_397635" id="a4239638_452604"><a class="email " href="/user_profile?user_id=397635" > <span class="fna">Andy McKay</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-60"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-60" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c60">Comment 60</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-09 17:00 PST" data-time="1484010049">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-60">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-60" data-comment-id="11969042">Given the amount of WebExtensions in 45 (not many) and the amount that affected by this (even less), I'm happy with this change. Thanks Tomica in your persistence with this bug.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(amckay)</span></div></div></div><div class="change-set" id="c61"><div class="comment" data-id="11973838" data-no="61"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-61" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_522000" id="a4239638_452604"><img src="https://secure.gravatar.com/avatar/ec561b842650e65a4a312f6e5bcae35a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_522000" id="a4239638_452604"><a class="email " href="/user_profile?user_id=522000" > <span class="fna">Vasilica Tamas, QA [:vtamas]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-61"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-61" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c61">Comment 61</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-11 05:18 PST" data-time="1484140715">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-61">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-61" data-comment-id="11973838">I was able to reproduce the initial issue on Firefox 53.0a1 (2016-11-21) under Windows 10 64-bit (the following window was promped: <a rel="nofollow" href="http://screencast.com/t/mJVw2gPsRF">http://screencast.com/t/mJVw2gPsRF</a>).

Manually tested on Firefox 53.0a1 (2017-01-10), Firefox 52.0a2 (2017-01-10), Firefox 51.0b13 (20170109165508) using Windows 10 64-bit, Ubuntu 16.04 32-bit and Mac OS X 10.12.1 and I noticed the following: 

  - “Null has been stolen by attacked” pop-up is prompted in the First Run Page after installing the attacker webextension: <a rel="nofollow" href="http://screencast.com/t/r1bNdoiYvz5">http://screencast.com/t/r1bNdoiYvz5</a> 
  - received the “victim” value after clicking on “Click to Reproduce” link: <a rel="nofollow" href="http://screencast.com/t/ZUd58xLUja">http://screencast.com/t/ZUd58xLUja</a> 
  - there is no “SECRET has been stolen by attacker” pop-up displayed.


Could you please confirm that this is the expected behavior?</pre><div class="activity"><div class="change">Flags: needinfo?(tomica)</div></div></div><div class="change-set" id="a4446129_1689"><div class="change" id="aa4446129_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a4446129_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a4446129_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a4446129_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a4446129_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#a4446129_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-11 17:23 PST" data-time="1484184238">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: toolkit-core-security &rarr; core-security-release</div></div></div><div class="change-set" id="c62"><div class="comment" data-id="11976157" data-no="62"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-62" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445095" id="a4446129_1689"><img src="https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445095" id="a4446129_1689"><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-62"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-62" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c62">Comment 62</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-11 18:03 PST" data-time="1484186617">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-62">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-62" data-comment-id="11976157">(In reply to Vasilica Mihasca, QA [:vasilica_mihasca] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web Extension's data: scheme pages can be controlled by other extensions"
   href="/show_bug.cgi?id=1319070#c61">comment #61</a>)
<span class="quote">&gt; Could you please confirm that this is the expected behavior?</span >

Yes, this is correct.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(tomica)</span></div></div></div><div class="change-set" id="c63"><div class="comment" data-id="11976869" data-no="63"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-63" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_522000" id="a4446129_1689"><img src="https://secure.gravatar.com/avatar/ec561b842650e65a4a312f6e5bcae35a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_522000" id="a4446129_1689"><a class="email " href="/user_profile?user_id=522000" > <span class="fna">Vasilica Tamas, QA [:vtamas]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-63"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-63" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c63">Comment 63</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-12 01:33 PST" data-time="1484213608">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-63">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-63" data-comment-id="11976869">(In reply to Tomislav Jovanovic :zombie from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web Extension's data: scheme pages can be controlled by other extensions"
   href="/show_bug.cgi?id=1319070#c62">comment #62</a>)
<span class="quote">&gt; (In reply to Vasilica Mihasca, QA [:vasilica_mihasca] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web Extension's data: scheme pages can be controlled by other extensions"
   href="/show_bug.cgi?id=1319070#c61">comment #61</a>)
&gt; &gt; Could you please confirm that this is the expected behavior?
&gt; 
&gt; Yes, this is correct.</span >

Thanks for your reply!
Based on <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web Extension's data: scheme pages can be controlled by other extensions"
   href="/show_bug.cgi?id=1319070#c61">Comment 61</a> and <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web Extension's data: scheme pages can be controlled by other extensions"
   href="/show_bug.cgi?id=1319070#c62">Comment 62</a> I am marking this bug as Verified.</pre><div class="activity"><div class="change">Status: RESOLVED &rarr; VERIFIED</div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox51&amp;o1=isnotempty">status-firefox51</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox51&amp;o1=equals&amp;v1=fixed">fixed</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox51&amp;o1=equals&amp;v1=verified">verified</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox52&amp;o1=isnotempty">status-firefox52</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox52&amp;o1=equals&amp;v1=fixed">fixed</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox52&amp;o1=equals&amp;v1=verified">verified</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox53&amp;o1=isnotempty">status-firefox53</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox53&amp;o1=equals&amp;v1=fixed">fixed</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox53&amp;o1=equals&amp;v1=verified">verified</a></div></div></div><div class="change-set" id="c64"><div class="comment" data-id="11988026" data-no="64"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-64" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_538805" id="a4446129_1689"><img src="https://secure.gravatar.com/avatar/9bd092443d615af36b31b04e81ad7806?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_538805" id="a4446129_1689"><a class="email disabled" href="/user_profile?user_id=538805" > <span class="fna">Ritu Kothari (:ritu) (Inactive, please n-i to RyanVM, jcristau, or pascal)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-64"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-64" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c64">Comment 64</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-17 11:02 PST" data-time="1484679735">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-64">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-64" data-comment-id="11988026">Comment on <span class=""><a href="/attachment.cgi?id=8822683" name="attach_8822683" title="bug-1319070-fix-esr45-v2.patch">attachment 8822683</a> <a href="/attachment.cgi?id=8822683&amp;action=edit" title="bug-1319070-fix-esr45-v2.patch">[details]</a> <a href="/attachment.cgi?id=8822683&amp;action=diff" title="bug-1319070-fix-esr45-v2.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1319070&amp;attachment=8822683'>[review]</a>
bug-1319070-fix-esr45-v2.patch

We could take this one in ESR45, fix is verified, DVeditz agrees. Let's uplift and include in ESR45.7</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8822683&amp;action=edit"
           title="bug-1319070-fix-esr45-v2.patch"
           class=""
        >Attachment #8822683</a> -
        Flags: approval-mozilla-esr45? &rarr; approval-mozilla-esr45+</div></div></div><div class="change-set" id="c65"><div class="comment" data-id="11988104" data-no="65"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-65" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_308534" id="a4446129_1689"><img src="https://secure.gravatar.com/avatar/bb55b2a8c34fd29f570ca139f13d46b8?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_308534" id="a4446129_1689"><a class="email " href="/user_profile?user_id=308534" > <span class="fna">Wes Kocher (:KWierso) (Not reading bugmail; email directly if needed)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-65"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-65" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c65">Comment 65</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-17 11:22 PST" data-time="1484680923">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-65">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-65" data-comment-id="11988104"><a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-esr45/rev/8c171b75a0c6524b117c602740adf1260ccf889e">https://hg.mozilla.org/releases/mozilla-esr45/rev/8c171b75a0c6524b117c602740adf1260ccf889e</a></pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=isnotempty">status-firefox-esr45</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=equals&amp;v1=fixed">fixed</a></div></div></div><div class="change-set" id="c66"><div class="comment" data-id="11988619" data-no="66"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-66" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_281791" id="a4446129_1689"><img src="https://secure.gravatar.com/avatar/5a83f46f9f97d184457cb2dedfa19173?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_281791" id="a4446129_1689"><a class="email disabled" href="/user_profile?user_id=281791" > <span class="fna">Jason Orendorff [:jorendorff]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-66"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-66" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c66">Comment 66</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-17 13:42 PST" data-time="1484689370">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-66">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8827632"
         class="attachment patch obsolete"
         data-id="8827632" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="8c171b75a0c6">
      <meta itemprop="contentSize" content="1229">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8827632">
          <a class="link" href="attachment.cgi?id=8827632&amp;action=diff">
        <span id="att-8827632-description" itemprop="description">Match against the principal</span></a> (obsolete)
        — <a href="attachment.cgi?id=8827632&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1319070&attachment=8827632">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-66" data-comment-id="11988619">MozReview-Commit-ID: 8FnBZsUyvtg</pre></div><div class="change-set" id="a4959420_280903"><div class="change" id="aa4959420_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a4959420_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a4959420_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a4959420_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a4959420_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#a4959420_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-17 15:58 PST" data-time="1484697529">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: [post-critsmash-triage] &rarr; [post-critsmash-triage][adv-main51+][adv-esr45.7+]</div></div></div><div class="change-set" id="a4964786_280903"><div class="change" id="aa4964786_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a4964786_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a4964786_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a4964786_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a4964786_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#a4964786_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-17 17:28 PST" data-time="1484702895">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Alias: CVE-2017-5386</div></div></div><div class="change-set" id="c67"><div class="comment" data-id="11991649" data-no="67"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-67" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_281791" id="a4964786_280903"><img src="https://secure.gravatar.com/avatar/5a83f46f9f97d184457cb2dedfa19173?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_281791" id="a4964786_280903"><a class="email disabled" href="/user_profile?user_id=281791" > <span class="fna">Jason Orendorff [:jorendorff]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-67"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-67" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c67">Comment 67</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-18 10:07 PST" data-time="1484762843">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-67">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-67" data-comment-id="11991649">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8827632" name="attach_8827632" title="Match against the principal">attachment 8827632</a> <a href="/attachment.cgi?id=8827632&amp;action=edit" title="Match against the principal">[details]</a> <a href="/attachment.cgi?id=8827632&amp;action=diff" title="Match against the principal">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1319070&amp;attachment=8827632'>[review]</a>
Match against the principal

This patch upload was an `hg bzexport` misfire. Sorry for the noise.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8827632&amp;action=edit"
           title="Match against the principal"
           class=""
        >Attachment #8827632</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="c68"><div class="comment" data-id="11994341" data-no="68"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-68" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_522000" id="a4964786_280903"><img src="https://secure.gravatar.com/avatar/ec561b842650e65a4a312f6e5bcae35a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_522000" id="a4964786_280903"><a class="email " href="/user_profile?user_id=522000" > <span class="fna">Vasilica Tamas, QA [:vtamas]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-68"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-68" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c68">Comment 68</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-01-19 06:41 PST" data-time="1484836861">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-68">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-68" data-comment-id="11994341">Confirm that this issue is also fixed on Firefox 45.7.0 esr (20170118123525) under Windows 10 64-bit, Ubuntu 16.04 32-bit and Mac OS X 10.12.1. Received the same results as those mentioned in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web Extension's data: scheme pages can be controlled by other extensions"
   href="/show_bug.cgi?id=1319070#c61">Comment 61</a>.</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=isnotempty">status-firefox-esr45</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=equals&amp;v1=fixed">fixed</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=equals&amp;v1=verified">verified</a></div></div></div><div class="change-set" id="c69"><div class="comment" data-id="12124696" data-no="69"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-69" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445095" id="a4964786_280903"><img src="https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445095" id="a4964786_280903"><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-69"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-69" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c69">Comment 69</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-07 18:37 PST" data-time="1488940629">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-69">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-69" data-comment-id="12124696">(In reply to Al Billings [:abillings] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web Extension's data: scheme pages can be controlled by other extensions"
   href="/show_bug.cgi?id=1319070#c43">comment #43</a>)
<span class="quote">&gt; Do *not* land any tests. We won't land tests for this issue until after we
&gt; publicly ship a fix so we don't 0day ourselves with our own tests.</span >

Hi Al, is it time now to land the tests for this?  It has been over two months since this landed on m-c (two release cycles).</pre><div class="activity"><div class="change">Flags: needinfo?(abillings)</div></div></div><div class="change-set" id="c70"><div class="comment" data-id="12124758" data-no="70"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-70" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445095" id="a4964786_280903"><img src="https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445095" id="a4964786_280903"><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-70"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-70" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c70">Comment 70</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-07 19:08 PST" data-time="1488942528">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-70">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-70" data-comment-id="12124758">Hey Will, can you please make sure this compatibility issue is documented?</pre><div class="activity"><div class="change">Flags: needinfo?(wbamberg)</div></div></div><div class="change-set" id="c71"><div class="comment" data-id="12125000" data-no="71"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-71" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a4964786_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_280903" id="a4964786_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-71"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-71" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c71">Comment 71</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-07 21:39 PST" data-time="1488951569">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-71">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-71" data-comment-id="12125000">(In reply to Tomislav Jovanovic :zombie from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web Extension's data: scheme pages can be controlled by other extensions"
   href="/show_bug.cgi?id=1319070#c69">comment #69</a>)
 
<span class="quote">&gt; Hi Al, is it time now to land the tests for this?  It has been over two
&gt; months since this landed on m-c (two release cycles).</span >

Yes! You could probably have landed it two or more weeks after 51 shipped with the fix but we're good now.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(abillings)</span></div></div></div><div class="change-set" id="c72"><div class="comment" data-id="12146758" data-no="72"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-72" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445095" id="a4964786_280903"><img src="https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445095" id="a4964786_280903"><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-72"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-72" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c72">Comment 72</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-15 04:14 PDT" data-time="1489576476">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-72">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8847547"
         class="attachment patch"
         data-id="8847547" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug-1319070-tests-v4.patch">
      <meta itemprop="contentSize" content="7268">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8847547">
          <a class="link" href="attachment.cgi?id=8847547&amp;action=diff">
        <span id="att-8847547-description" itemprop="description">bug-1319070-tests-v4.patch</span></a>
        — <a href="attachment.cgi?id=8847547&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1319070&attachment=8847547">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-72" data-comment-id="12146758"><a rel="nofollow" href="https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=d33b140a3efc0e6e90e035fa0665e974172f37dd">https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=d33b140a3efc0e6e90e035fa0665e974172f37dd</a></pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8814747&amp;action=edit"
           title="bug-1319070-tests-v3.patch"
           class=""
        >Attachment #8814747</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="a9838505_445095"><div class="change" id="aa9838505_445095">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445095" id="a9838505_445095"><img src="https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_445095" id="a9838505_445095"><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a9838505_445095"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a9838505_445095">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#a9838505_445095">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-15 04:16 PDT" data-time="1489576614">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8847547&amp;action=edit"
           title="bug-1319070-tests-v4.patch"
           class=""
        >Attachment #8847547</a> -
        Flags: checkin?</div></div></div><div class="change-set" id="c73"><div class="comment" data-id="12146796" data-no="73"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-73" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_277293" id="a9838505_445095"><img src="https://secure.gravatar.com/avatar/8378311bf1bd5e9eddc7896a07688876?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_277293" id="a9838505_445095"><a class="email disabled" href="/user_profile?user_id=277293" > <span class="fna">Carsten Book [:Tomcat]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-73"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-73" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c73">Comment 73</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-15 04:32 PDT" data-time="1489577566">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-73">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-73" data-comment-id="12146796">Comment on <span class=""><a href="/attachment.cgi?id=8847547" name="attach_8847547" title="bug-1319070-tests-v4.patch">attachment 8847547</a> <a href="/attachment.cgi?id=8847547&amp;action=edit" title="bug-1319070-tests-v4.patch">[details]</a> <a href="/attachment.cgi?id=8847547&amp;action=diff" title="bug-1319070-tests-v4.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1319070&amp;attachment=8847547'>[review]</a>
bug-1319070-tests-v4.patch

<a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/8c704b823d38f479ad228c585439ae41100be166">https://hg.mozilla.org/integration/mozilla-inbound/rev/8c704b823d38f479ad228c585439ae41100be166</a></pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8847547&amp;action=edit"
           title="bug-1319070-tests-v4.patch"
           class=""
        >Attachment #8847547</a> -
        Flags: checkin? &rarr; checkin+</div></div></div><div class="change-set" id="c74"><div class="comment" data-id="12148894" data-no="74"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-74" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_308534" id="a9838505_445095"><img src="https://secure.gravatar.com/avatar/bb55b2a8c34fd29f570ca139f13d46b8?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_308534" id="a9838505_445095"><a class="email " href="/user_profile?user_id=308534" > <span class="fna">Wes Kocher (:KWierso) (Not reading bugmail; email directly if needed)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-74"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-74" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c74">Comment 74</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-15 14:28 PDT" data-time="1489613287">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-74">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-74" data-comment-id="12148894"><a rel="nofollow" href="https://hg.mozilla.org/mozilla-central/rev/8c704b823d38">https://hg.mozilla.org/mozilla-central/rev/8c704b823d38</a></pre></div><div class="change-set" id="a9920651_580382"><div class="change" id="aa9920651_580382">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_580382" id="a9920651_580382"><img src="https://secure.gravatar.com/avatar/15b9b3783e4671cd882bff1316df14c9?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_580382" id="a9920651_580382"><a class="email " href="/user_profile?user_id=580382" > <span class="fna">Julien Cristau [:jcristau]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a9920651_580382"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a9920651_580382">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#a9920651_580382">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-16 03:06 PDT" data-time="1489658760">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: in-testsuite? &rarr; in-testsuite+</div></div></div><div class="change-set" id="a24214564_1689"><div class="change" id="aa24214564_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a24214564_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a24214564_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a24214564_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a24214564_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#a24214564_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-08-28 13:37 PDT" data-time="1503952673">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: <span class="activity-deleted">core-security-release</span></div></div></div><div class="change-set" id="c75"><div class="comment" data-id="12884394" data-no="75"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-75" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445095" id="a24214564_1689"><img src="https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445095" id="a24214564_1689"><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-75"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-75" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c75">Comment 75</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-29 12:15 PST" data-time="1511986512">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-75">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-75" data-comment-id="12884394">There were recent changes to how Firefox treats data: URIs, specifically about inheriting principals.

Ni? myself to investigate if this is still a compat issue or not.</pre><div class="activity"><div class="change">Flags: needinfo?(tomica)</div></div></div><div class="change-set" id="c76"><div class="comment" data-id="12884924" data-no="76"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-76" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" id="a24214564_1689"><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_106098" id="a24214564_1689"><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-76"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-76" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c76">Comment 76</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-29 15:05 PST" data-time="1511996721">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-76">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-76" data-comment-id="12884924">(In reply to Tomislav Jovanovic :zombie from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Web Extension's data: scheme pages can be controlled by other extensions"
   href="/show_bug.cgi?id=1319070#c75">comment #75</a>)
<span class="quote">&gt; There were recent changes to how Firefox treats data: URIs, specifically
&gt; about inheriting principals.</span >

Principal inheritance for data: URIs is actually pretty weird at this point. They do inherit principals in most cases, but they're special cased in document loads:

<a rel="nofollow" href="https://searchfox.org/mozilla-central/rev/be78e6ea9b10b1f5b2b3b013f01d86e1062abb2b/docshell/base/nsDocShell.cpp#11267-11270">https://searchfox.org/mozilla-central/rev/be78e6ea9b10b1f5b2b3b013f01d86e1062abb2b/docshell/base/nsDocShell.cpp#11267-11270</a>

SVG images with data: URLs, though, still wind up creating documents with inherited principals.</pre></div><div class="change-set" id="c77"><div class="comment" data-id="12915752" data-no="77"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-77" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445095" id="a24214564_1689"><img src="https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445095" id="a24214564_1689"><a class="email " href="/user_profile?user_id=445095" > <span class="fna">Tomislav Jovanovic :zombie</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-77"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-77" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#c77">Comment 77</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-12-12 15:50 PST" data-time="1513122606">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-77">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-77" data-comment-id="12915752">Also, recent blog post relevant to this
<a rel="nofollow" href="https://blog.mozilla.org/security/2017/11/27/blocking-top-level-navigations-data-urls-firefox-58/">https://blog.mozilla.org/security/2017/11/27/blocking-top-level-navigations-data-urls-firefox-58/</a>

So, the original POC in this bug wouldn't even work currently, since top-level navigation to data: URIs is blocked (which is probably worth documenting somewhere, separately from this issue).

But this remains a compat issue for data: iframes inside web pages, so it should still be documented.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(tomica)</span></div></div></div><div class="change-set" id="a49700545_546015"><div class="change" id="aa49700545_546015">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_546015" id="a49700545_546015"><img src="https://secure.gravatar.com/avatar/d0465b8931b44330f542efbeeae855da?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_546015" id="a49700545_546015"><a class="email " href="/user_profile?user_id=546015" > <span class="fna">BMO Automation</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a49700545_546015"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a49700545_546015">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1319070#a49700545_546015">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-19 13:04 PDT" data-time="1529438654">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Product: Toolkit &rarr; WebExtensions</div></div></div><div id="new-comment-notice">
          You need to <a href="/show_bug.cgi?id=1319070&amp;GoAheadAndLogIn=1">log in</a>
          before you can comment on or make changes to this bug.
        </div>



<div id="bottom-actions">
  <div id="bottom-right-actions">
    <button type="button" id="top-btn" class="secondary" aria-label="Go to Page Top">Top &uarr;</button>
  </div>
</div></div> 
</main> 
</div> 


</body>
</html>