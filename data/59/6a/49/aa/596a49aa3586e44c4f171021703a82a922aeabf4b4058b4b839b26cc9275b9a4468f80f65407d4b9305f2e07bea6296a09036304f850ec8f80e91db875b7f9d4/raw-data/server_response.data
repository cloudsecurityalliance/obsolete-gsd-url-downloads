<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="UTF-8">
<meta property="og:type" content="website">
<meta property="og:title" content="1673240 - (CVE-2021-23991) RNP-01-014 WP1 Thunderbird: Key manipulation via uncertified Auto-Import (Medium)">
<meta property="og:url" content="https://bugzilla.mozilla.org/show_bug.cgi?id=1673240">
<meta property="og:description"
      content="RESOLVED (kaie) in MailNews Core - Security: OpenPGP. Last updated 2021-06-10.">
<meta name="twitter:label1" value="Type">
<meta name="twitter:data1" value="defect">
<meta name="twitter:label2" value="Priority">
<meta name="twitter:data2" value="P1">

    <meta name="viewport" content="width=1024">
    <meta name="color-scheme" content="dark light">
    <meta name="generator" content="Bugzilla 20211025.1">
    <meta name="bugzilla-global" content="dummy"
        id="bugzilla-global" data-bugzilla="{&quot;api_token&quot;:&quot;&quot;,&quot;config&quot;:{&quot;basepath&quot;:&quot;\/&quot;},&quot;constant&quot;:{&quot;COMMENT_COLS&quot;:80},&quot;param&quot;:{&quot;maxattachmentsize&quot;:&quot;10240&quot;,&quot;maxusermatches&quot;:&quot;50&quot;,&quot;splinter_base&quot;:&quot;\/page.cgi?id=splinter.html&amp;ignore=\/&quot;},&quot;string&quot;:{&quot;bug_type_required&quot;:&quot;You must select a Type for this bug&quot;,&quot;component_required&quot;:&quot;You must select a Component for this bug&quot;,&quot;description_required&quot;:&quot;You must enter a Description for this bug&quot;,&quot;short_desc_required&quot;:&quot;You must enter a Summary for this bug&quot;,&quot;version_required&quot;:&quot;You must select a Version for this bug&quot;},&quot;user&quot;:{&quot;is_new&quot;:1,&quot;login&quot;:&quot;&quot;}}">
    <title>1673240 - (CVE-2021-23991) RNP-01-014 WP1 Thunderbird: Key manipulation via uncertified Auto-Import (Medium)</title>

<link rel="Top" href="/">

  


  
    <link rel="Show" title="Dependency Tree"
          href="/showdependencytree.cgi?id=1673240&amp;hide_resolved=1">
      <link rel="Show" title="Dependency Graph"
            href="/showdependencygraph.cgi?id=1673240">

      <link rel="Show" title="Bug Activity"
            href="/show_activity.cgi?id=1673240">

<link href="/static/v20211025.1/skins/yui.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/standard/global.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BugModal/web/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BMO/web/styles/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/EditComments/web/styles/inline-editor.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-structure-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-theme-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/lib/prism.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Needinfo/web/styles/needinfo.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Review/web/styles/badge.css" rel="stylesheet" type="text/css">



    
<script nonce="2mnjvba9JDw11sNTKCWP2jcfJJIvKNjH8GwNB4S6kFCvYk2f" src="/static/v20211025.1/js/jquery/jquery-min.js"></script><script nonce="2mnjvba9JDw11sNTKCWP2jcfJJIvKNjH8GwNB4S6kFCvYk2f" src="/static/v20211025.1/js/jquery/ui/jquery-ui-min.js"></script><script nonce="2mnjvba9JDw11sNTKCWP2jcfJJIvKNjH8GwNB4S6kFCvYk2f" src="/static/v20211025.1/js/yui.js"></script><script nonce="2mnjvba9JDw11sNTKCWP2jcfJJIvKNjH8GwNB4S6kFCvYk2f" src="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu-min.js"></script><script nonce="2mnjvba9JDw11sNTKCWP2jcfJJIvKNjH8GwNB4S6kFCvYk2f" src="/static/v20211025.1/js/jquery/plugins/devbridgeAutocomplete/devbridgeAutocomplete-min.js"></script><script nonce="2mnjvba9JDw11sNTKCWP2jcfJJIvKNjH8GwNB4S6kFCvYk2f" src="/static/v20211025.1/js/global.js"></script><script nonce="2mnjvba9JDw11sNTKCWP2jcfJJIvKNjH8GwNB4S6kFCvYk2f" src="/static/v20211025.1/js/util.js"></script><script nonce="2mnjvba9JDw11sNTKCWP2jcfJJIvKNjH8GwNB4S6kFCvYk2f" src="/static/v20211025.1/js/dropdown.js"></script>

      <script nonce="2mnjvba9JDw11sNTKCWP2jcfJJIvKNjH8GwNB4S6kFCvYk2f">
          YAHOO.namespace('bugzilla');
          if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
              YAHOO.util.Event._simpleRemove(window, "unload",
                                             YAHOO.util.Event._unload);
          }BUGZILLA.value_descs = JSON.parse('{\"bug_status\":{},\"resolution\":{\"\":\"---\"}}');

  
    var tracking_flags_str = "{\"comments\":{\"cf_tracking_firefox_relnote\":{\"?\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox_sumo\":{\"none-needed\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"}},\"types\":[\"tracking\"],\"flags\":{\"project\":{\"cf_tracking_firefox_sumo\":\"---\"},\"tracking\":{\"cf_tracking_seamonkey253\":\"---\",\"cf_tracking_thunderbird_esr91\":\"---\",\"cf_status_thunderbird_93\":\"---\",\"cf_tracking_thunderbird_95\":\"---\",\"cf_status_thunderbird_esr91\":\"---\",\"cf_status_seamonkey253\":\"---\",\"cf_status_thunderbird_esr78\":\"fixed\",\"cf_status_thunderbird_94\":\"---\",\"cf_status_thunderbird_95\":\"---\",\"cf_tracking_firefox_relnote\":\"---\",\"cf_tracking_thunderbird_esr78\":\"+\",\"cf_tracking_seamonkey257esr\":\"---\",\"cf_status_seamonkey257esr\":\"---\",\"cf_tracking_thunderbird_94\":\"---\",\"cf_tracking_thunderbird_93\":\"---\"}}}";
    var TrackingFlags = $.parseJSON(tracking_flags_str);

  

  
  BUGZILLA.bug_id = 1673240;
  BUGZILLA.bug_title = '1673240 - (CVE-2021-23991) RNP-01-014 WP1 Thunderbird: Key manipulation via uncertified Auto-Import (Medium)';
  BUGZILLA.bug_summary = 'RNP-01-014 WP1 Thunderbird: Key manipulation via uncertified Auto-Import (Medium)';
  BUGZILLA.bug_url = 'https:\/\/bugzilla.mozilla.org\/show_bug.cgi?id=1673240';
  BUGZILLA.bug_keywords = 'sec-high',
  BUGZILLA.user = {
    id: 0,
    login: '',
    is_insider: false,
    is_timetracker: false,
    can_tag: false,
    timezone: 'America\/Los_Angeles',
    settings: {
      quote_replies: 'quoted_reply',
      zoom_textareas: true,
      remember_collapsed: true,
      inline_attachments: true,
      autosize_comments: false
    }
  };

  BUGZILLA.bug_secure = false;
      </script>
<script nonce="2mnjvba9JDw11sNTKCWP2jcfJJIvKNjH8GwNB4S6kFCvYk2f" src="/static/v20211025.1/extensions/BugModal/web/autosize.min.js"></script><script nonce="2mnjvba9JDw11sNTKCWP2jcfJJIvKNjH8GwNB4S6kFCvYk2f" src="/static/v20211025.1/extensions/ProdCompSearch/web/js/prod_comp_search.js"></script><script nonce="2mnjvba9JDw11sNTKCWP2jcfJJIvKNjH8GwNB4S6kFCvYk2f" src="/static/v20211025.1/extensions/BugModal/web/bug_modal.js"></script><script nonce="2mnjvba9JDw11sNTKCWP2jcfJJIvKNjH8GwNB4S6kFCvYk2f" src="/static/v20211025.1/extensions/BugModal/web/comments.js"></script><script nonce="2mnjvba9JDw11sNTKCWP2jcfJJIvKNjH8GwNB4S6kFCvYk2f" src="/static/v20211025.1/extensions/ComponentWatching/web/js/overlay.js"></script><script nonce="2mnjvba9JDw11sNTKCWP2jcfJJIvKNjH8GwNB4S6kFCvYk2f" src="/static/v20211025.1/js/bugzilla-readable-status-min.js"></script><script nonce="2mnjvba9JDw11sNTKCWP2jcfJJIvKNjH8GwNB4S6kFCvYk2f" src="/static/v20211025.1/js/field.js"></script><script nonce="2mnjvba9JDw11sNTKCWP2jcfJJIvKNjH8GwNB4S6kFCvYk2f" src="/static/v20211025.1/js/comments.js"></script><script nonce="2mnjvba9JDw11sNTKCWP2jcfJJIvKNjH8GwNB4S6kFCvYk2f" src="/static/v20211025.1/extensions/TrackingFlags/web/js/flags.js"></script><script nonce="2mnjvba9JDw11sNTKCWP2jcfJJIvKNjH8GwNB4S6kFCvYk2f" src="/static/v20211025.1/extensions/BMO/web/js/firefox-crash-table.js"></script><script nonce="2mnjvba9JDw11sNTKCWP2jcfJJIvKNjH8GwNB4S6kFCvYk2f" src="/static/v20211025.1/extensions/MozChangeField/web/js/severity-s1-priority-p1.js"></script><script nonce="2mnjvba9JDw11sNTKCWP2jcfJJIvKNjH8GwNB4S6kFCvYk2f" src="/static/v20211025.1/extensions/MozChangeField/web/js/clear-tracking-priority-s1.js"></script><script nonce="2mnjvba9JDw11sNTKCWP2jcfJJIvKNjH8GwNB4S6kFCvYk2f" src="/static/v20211025.1/extensions/MozChangeField/web/js/set-tracking-severity-s1.js"></script><script nonce="2mnjvba9JDw11sNTKCWP2jcfJJIvKNjH8GwNB4S6kFCvYk2f" src="/static/v20211025.1/js/lib/prism.js"></script><script nonce="2mnjvba9JDw11sNTKCWP2jcfJJIvKNjH8GwNB4S6kFCvYk2f" src="/static/v20211025.1/extensions/GoogleAnalytics/web/js/analytics.js"></script><script nonce="2mnjvba9JDw11sNTKCWP2jcfJJIvKNjH8GwNB4S6kFCvYk2f" src="/static/v20211025.1/js/lib/md5.min.js"></script><script nonce="2mnjvba9JDw11sNTKCWP2jcfJJIvKNjH8GwNB4S6kFCvYk2f" src="/static/v20211025.1/extensions/Review/web/js/badge.js"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla@Mozilla" href="/search_plugin.cgi"><link rel="shortcut icon" href="/extensions/BMO/web/images/favicon.ico">
<link rel="canonical" href="https://bugzilla.mozilla.org/show_bug.cgi?id=1673240">
<link rel="shorturl" href="https://bugzilla.mozilla.org/1673240"><meta name="google-analytics" content="UA-36116321-3" data-location="https://bugzilla.mozilla.org/bug/show-modal" data-title="1673240 - (CVE-2021-23991) RNP-01-014 WP1 Thunderbird: Key manipulation via uncertified Auto-Import (Medium)">
<script async src="https://www.google-analytics.com/analytics.js"></script><meta name="robots" content="noarchive">
  </head>



  <body
        class="bugzilla-mozilla-org
               skin-standard bug_modal yui-skin-sam">



<div id="wrapper">

<header id="header" role="banner">
  <div class="inner">
    <h1 id="header-title" class="title"><a href="https://bugzilla.mozilla.org/home" title="Go to home page">Bugzilla</a></h1>
    <form role="search" id="header-search" class="quicksearch" action="/buglist.cgi" data-no-csrf>
      <section class="searchbox-outer dropdown" role="combobox" aria-expanded="false" aria-haspopup="listbox"
               aria-labelledby="header-search-label" aria-owns="header-search-dropdown">
        <h2 id="header-search-label">Quick Search</h2>
        <span class="icon" aria-hidden="true"></span>
        <input role="searchbox" id="quicksearch_top" class="dropdown-button" name="quicksearch" autocomplete="off"
               value="" placeholder="Search Bugs"
               title="Enter a bug number or some search terms" aria-controls="header-search-dropdown"
               aria-label="Quick Search"><div id="header-search-dropdown" class="dropdown-content right" role="listbox" style="display: none;">
  <div id="header-search-dropdown-wrapper">
  </div>
</div>
      </section>
    </form>
    <nav id="header-nav">
      <ul class="links">
        <li class="link-browse">
          <a href="/describecomponents.cgi" title="Browse bugs by component">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Browse</span>
          </a>
        </li>
        <li class="link-search">
          <a href="/query.cgi?format=advanced" title="Search bugs using various criteria">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Advanced Search</span>
          </a>
        </li>
      </ul>
      <div class="dropdown">
        <button type="button" id="header-tools-menu-button" class="dropdown-button minor" title="More tools…"
                aria-label="More tools…" aria-expanded="false" aria-haspopup="true" aria-controls="header-tools-menu">
          <span class="icon" aria-hidden="true"></span>
        </button>
        <ul class="dropdown-content left" id="header-tools-menu" role="menu" style="display:none;">
          <li role="presentation">
            <a href="/report.cgi" role="menuitem" tabindex="-1">Reports</a>
          </li>
            <li role="separator"></li>
            <li role="presentation">
              <a href="https://bmo.readthedocs.io/en/latest/" role="menuitem" tabindex="-1">Documentation</a>
            </li>
        </ul>
      </div>
    </nav>
      <ul id="header-login" class="links">
          <li id="moz_new_account_container_top"><a href="/createaccount.cgi">New Account</a></li><li id="mini_login_container_top">
  <a id="login_link_top" href="/index.cgi?GoAheadAndLogIn=1"
     class='show_mini_login_form' data-qs-suffix="_top">Log In</a>

  <div id="mini_login_top" class="mini-popup mini_login bz_default_hidden"><span id="github_mini_login_top" class="mini_login_top">
    <form method="post" action="/github.cgi">
      <input type="hidden" name="github_secret" value="0oq4nU4sMdFtzFbS6eOHgvMS8XMMqxrs0UqxPY913oFd1uu9aVEBRveN4SAUIyM6S9IMb2VeoiYSuBQHwYwq1uSe3Rd80upwOg1EuR0rdDKHsZKVPCZDC0CytqvZCPmwSX2rnyjcKjm4iQhoo6stLbEEhstPZODI6CdmCRqsPb5YpJErEtPNRX1evqhaGqgYhBboFbs7bySQcb2DVSWDFKOI0d7InLms9Q0pu5o0nBEQr8GCBXp3Cvfuk6yn3xrm">
      <input type="hidden" name="target_uri" value="https://bugzilla.mozilla.org/show_bug.cgi">
      <input type="image" src="/extensions/GitHubAuth/web/images/sign_in.png" height="22" width="75" align="absmiddle"
             alt="Sign in with GitHub"
             title="Sign in with GitHub"> or
    </form>
  </span>

  <form action="/show_bug.cgi?id=1673240" method="POST"
        data-qs-suffix="_top">

    <input id="Bugzilla_login_top"
           class="bz_login"
           name="Bugzilla_login"
           title="Login"
           placeholder="Email"
           aria-label="Email"
           type="email"
           required
    >
    <input class="bz_password"
           id="Bugzilla_password_top"
           name="Bugzilla_password"
           type="password"
           title="Password"
           placeholder="Password"
           aria-label="Password"
           required
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text"
           id="Bugzilla_password_dummy_top" value="password"
           title="Password"
    >
      <input type="checkbox" id="Bugzilla_remember_top"
             name="Bugzilla_remember" value="on" class="bz_remember"
                 checked>
      <label for="Bugzilla_remember_top">Remember</label>
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
           class="check_mini_login_fields"
            id="log_in_top">
    <a href="#" id="hide_mini_login_top" aria-label="Close"
       class="close-button hide_mini_login_form" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
<li id="forgot_container_top">
  <a id="forgot_link_top" href="/index.cgi?GoAheadAndLogIn=1#forgot"
     class='show_forgot_form'
     data-qs-suffix="_top">Forgot Password</a>
  <div id="forgot_form_top" class="mini-popup mini_forgot bz_default_hidden">
  <form action="/token.cgi" method="post">
    <input type="email" name="loginname" size="20" placeholder="Email" aria-label="Email" required>
    <input id="forgot_button_top" value="Reset Password"
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <input type="hidden" id="token_top" name="token" value="1635623561-65Y6LL_8eziKp9stvHx8y60_LkHqySdfhB7pFQeV8a8">
    <a href="#" class="close-button hide_forgot_form" aria-label="Close" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
      </ul><div id="header-external-links" class="dropdown first">
  <button type="button" id="header-external-menu-button" class="dropdown-button minor" title="Mozilla"
          aria-label="Mozilla" aria-expanded="false" aria-haspopup="true" aria-controls="header-external-menu">
    <img src="/static/v20211025.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg" width="32" height="32" alt="">
  </button>
  <ul class="dropdown-content right" id="header-external-menu" role="menu" style="display:none;">
    <li role="presentation">
      <a href="https://www.mozilla.org/" role="menuitem" tabindex="-1">Mozilla Home</a>
    </li>
    <li role="separator"></li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/" role="menuitem" tabindex="-1">Privacy</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/#cookies" role="menuitem" tabindex="-1">Cookies</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/about/legal/" role="menuitem" tabindex="-1">Legal</a>
    </li>
  </ul>
</div>
  </div>
</header> 


<main id="bugzilla-body" tabindex="-1">

<aside id="message-container" role="complementary">
  <noscript>
    <div class="noscript">
      <div class="inner">
        <p>Please enable JavaScript in your browser to use all the features on this site.</p>
      </div>
    </div>
  </noscript>
</aside>

<div id="main-inner">




<div role="toolbar" id="page-toolbar">
  <div role="group" class="buttons">
    <button type="button" id="copy-summary" class="secondary"
      title="Copy bug number and summary to your clipboard">Copy Summary</button>
    <div id="clip-container" style="display:none"><input type="text" id="clip"></div>
    <div class="dropdown">
      <button type="button" id="action-menu-btn" aria-haspopup="true" aria-label="View"
        aria-expanded="false" aria-controls="action-menu" class="dropdown-button secondary">View &#9662;</button>
      <ul class="dropdown-content left" id="action-menu" role="menu" style="display:none;">
        <li role="presentation">
          <a id="action-reset" role="menuitem" tabindex="-1">Reset Sections</a>
        </li>
        <li role="presentation">
          <a id="action-expand-all" role="menuitem" tabindex="-1">Expand All Sections</a>
        </li>
        <li role="presentation">
          <a id="action-collapse-all" role="menuitem" tabindex="-1">Collapse All Sections</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a id="action-history" role="menuitem" tabindex="-1">History</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a href="/rest/bug/1673240" role="menuitem" tabindex="-1">JSON</a>
        </li>
        <li role="presentation">
          <a href="/show_bug.cgi?ctype=xml&amp;id=1673240" role="menuitem" tabindex="-1">XML</a>
        </li>
      </ul>
    </div>
  </div>
</div>



<div role="status" id="io-error" style="display:none"></div>
<div role="status" id="floating-message" style="display:none">
  <div id="floating-message-text"></div>
</div>
<section class="module"
>
  <div class="module-content"
  >
  <div id="summary-container">
    <div class="field indent" id="field-status_summary"
>


  
    <div class=" container">
        <span id="field-value-status_summary">
      <span class="bug-status-label text" data-status="closed">Closed</span>
      <span id="field-value-bug_id">
        <a href="/show_bug.cgi?id=1673240">Bug 1673240</a>
          <span class="edit-hide">(CVE-2021-23991)</span>
      </span>
      <span>
        <span class="bug-time-label">Opened <span class="rel-time" title="2020-10-25 05:25 PDT" data-time="1603628708">1 year ago</span></span>
          <span class="bug-time-label">Closed <span class="rel-time" title="2021-03-23 06:48 PDT" data-time="1616507334">7 months ago</span></span>
      </span>
        </span>
    </div>

  
</div>
<div class="field indent edit-hide"
>


  
    <div class=" container">
      

      <h1 id="field-value-short_desc">RNP-01-014 WP1 Thunderbird: Key manipulation via uncertified Auto-Import (Medium)</h1>
    </div>

  
</div>

    <div class="field edit-show" id="field-short_desc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc" id="short_desc-help-link" class="help">Summary:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-short_desc">
            RNP-01-014 WP1 Thunderbird: Key manipulation via uncertified Auto-Import (Medium)

        </span>
    </div>

  
</div>
  </div>
  </div>
</section>


<section class="module" id="module-categories"
>
    <header id="module-categories-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Categories section"
           data-label-collapsed="Expand Categories section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-categories-content"
             aria-expanded="true"
             aria-labeledby="module-categories-title"
             aria-describedby="module-categories-subtitle"></div>
        <h2 class="module-title" id="module-categories-title">Categories</h2>
          <h3 class="module-subtitle" id="module-categories-subtitle">
            (MailNews Core :: Security: OpenPGP, defect, P1)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-categories-content"
  ><div class="fields-lhs">

    <div class="field" id="field-product"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=MailNews%20Core" id="product-help-link" class="help">Product:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-product">
      <div class="name-info-outer dropdown">
        <span id="product-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="product-info">MailNews Core
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="product-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Product description and actions">
          <header>
            <div class="title">MailNews Core</div>
            <div class="description">Mail and news components common to Thunderbird and SeaMonkey</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=MailNews%20Core&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Product</a></div>
            <div><a href="/enter_bug.cgi?product=MailNews%20Core"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Product</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="MailNews Core"
                         data-label-watch="Watch This Product" data-label-unwatch="Unwatch This Product"
                         data-source="BugModal">Watch This Product</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-component"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=MailNews%20Core&component=Security%3A%20OpenPGP#Security%3A%20OpenPGP" id="component-help-link" class="help">Component:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-component">
      <div class="name-info-outer dropdown">
        <span id="component-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="component-info">Security: OpenPGP
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="component-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Component description and actions">
          <header>
            <div class="title">MailNews Core :: Security: OpenPGP</div>
            <div class="description">OpenPGP is about all aspects related to encrypted or signed email messages using the OpenPGP protocol.</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=MailNews%20Core&amp;component=Security%3A%20OpenPGP&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Component</a></div>
            <div><a href="/buglist.cgi?product=MailNews%20Core&amp;component=Security%3A%20OpenPGP&amp;chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__"
                    target="_blank" role="menuitem" tabindex="-1">Recently Fixed Bugs in This Component</a></div>
            <div><a href="/enter_bug.cgi?product=MailNews%20Core&amp;component=Security%3A%20OpenPGP"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Component</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="MailNews Core" data-component="Security: OpenPGP"
                         data-label-watch="Watch This Component" data-label-unwatch="Unwatch This Component"
                         data-source="BugModal">Watch This Component</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-version"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#version" id="version-help-link" class="help">Version:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-version">
            78

        </span>
    </div>

  
</div>

    <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform" id="-help-link" class="help">Platform:
        </a>
    </div>


  
    <div class=" container"><div class="field inline" id="field-rep_platform"
>


  
    <div class="value">
        <span id="field-value-rep_platform">
            Unspecified

        </span>
    </div>

  
</div><div class="field indent inline" id="field-op_sys"
>


  
    <div class="value">
        <span id="field-value-op_sys">
            Unspecified

        </span>
    </div>

  
</div><div class="field indent inline"
>


  
    <div class=" container">
    </div>

  
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field contains-buttons" id="field-bug_type"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type" id="bug_type-help-link" class="help">Type:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_type">
      <span class="bug-type-label iconic-text" data-type="defect">
        <span class="icon" aria-hidden="true"></span>defect</span>
        </span>
    </div>

  
</div>

    <div class="field" id="field-importance"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority" id="importance-help-link" class="help">Priority:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-importance"><div class="field inline" id="field-priority"
>


  
    <div class="value">
        <span id="field-value-priority">P1
        </span>
    </div>

  
</div><div class="field inline" id="field-bug_severity"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity" id="bug_severity-help-link" class="help">Severity:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_severity">
            --

        </span>
    </div>

  
</div>
        </span>
    </div>

  
</div>

    
</div>
  </div>
</section>


<section class="module" id="module-tracking"
>
    <header id="module-tracking-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Tracking section"
           data-label-collapsed="Expand Tracking section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-tracking-content"
             aria-expanded="true"
             aria-labeledby="module-tracking-title"
             aria-describedby="module-tracking-subtitle"></div>
        <h2 class="module-title" id="module-tracking-title">Tracking</h2>
          <h3 class="module-subtitle" id="module-tracking-subtitle">
            (thunderbird_esr78+ fixed)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-tracking-content"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-status-view"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-view-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-view">RESOLVED
        FIXED
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-status-edit" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-edit-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-edit"><div class="field inline" id="field-bug_status"
>


  
    <div class="value">
        <span id="field-value-bug_status">
            RESOLVED

        </span>
    </div>

  
</div><div class="field indent inline" id="field-resolution"
>


  
    <div class="value">
        <span id="field-value-resolution">
            FIXED

        </span>
    </div>

  
</div>
  <div id="status-action-buttons">
      <div id="assigned-container" style="display:none">
        <button type="button" class="secondary" id="mark-as-assigned-btn">
          Mark as Assigned
        </button>
      </div>
  </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-target_milestone"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone" id="target_milestone-help-link" class="help">Milestone:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-target_milestone">
            88 Branch

        </span>
    </div>

  
</div>

    


      <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Project Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <td class="tracking-flag-name">user-doc-firefox</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_sumo-dirty">
  <select id="cf_tracking_firefox_sumo" name="cf_tracking_firefox_sumo">
        <option value="---"
          id="v4660_cf_tracking_firefox_sumo" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

      <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Tracking Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-hide">
    <table class="layout-table tracking-flags">
        <tr>
          <th></th>
          <th>Tracking</th>
          <th>Status</th>
        </tr>
        <tr>
          <td class="tracking-flag-name">thunderbird_esr78</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_thunderbird_esr78&amp;o1=equals&amp;v1=%2B">+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_thunderbird_esr78&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
    </table>
  </div>


<div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <th></th>
        <th>Tracking</th>
        <th>Status</th>
      </tr>
      <tr>
        <td class="tracking-flag-name">relnote-firefox</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_relnote-dirty">
  <select id="cf_tracking_firefox_relnote" name="cf_tracking_firefox_relnote">
        <option value="---"
          id="v539_cf_tracking_firefox_relnote" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr78-dirty">
  <select id="cf_tracking_thunderbird_esr78" name="cf_tracking_thunderbird_esr78">
        <option value="+"
          id="v4825_cf_tracking_thunderbird_esr78" selected
        >+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr78-dirty">
  <select id="cf_status_thunderbird_esr78" name="cf_status_thunderbird_esr78">
        <option value="fixed"
          id="v4832_cf_status_thunderbird_esr78" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr91-dirty">
  <select id="cf_tracking_thunderbird_esr91" name="cf_tracking_thunderbird_esr91">
        <option value="---"
          id="v5236_cf_tracking_thunderbird_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr91-dirty">
  <select id="cf_status_thunderbird_esr91" name="cf_status_thunderbird_esr91">
        <option value="---"
          id="v5242_cf_status_thunderbird_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird93</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_93-dirty">
  <select id="cf_tracking_thunderbird_93" name="cf_tracking_thunderbird_93">
        <option value="---"
          id="v5262_cf_tracking_thunderbird_93" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_93-dirty">
  <select id="cf_status_thunderbird_93" name="cf_status_thunderbird_93">
        <option value="---"
          id="v5256_cf_status_thunderbird_93" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird94</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_94-dirty">
  <select id="cf_tracking_thunderbird_94" name="cf_tracking_thunderbird_94">
        <option value="---"
          id="v5300_cf_tracking_thunderbird_94" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_94-dirty">
  <select id="cf_status_thunderbird_94" name="cf_status_thunderbird_94">
        <option value="---"
          id="v5304_cf_status_thunderbird_94" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird95</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_95-dirty">
  <select id="cf_tracking_thunderbird_95" name="cf_tracking_thunderbird_95">
        <option value="---"
          id="v5332_cf_tracking_thunderbird_95" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_95-dirty">
  <select id="cf_status_thunderbird_95" name="cf_status_thunderbird_95">
        <option value="---"
          id="v5326_cf_status_thunderbird_95" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">seamonkey2.53</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_seamonkey253-dirty">
  <select id="cf_tracking_seamonkey253" name="cf_tracking_seamonkey253">
        <option value="---"
          id="v3334_cf_tracking_seamonkey253" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_seamonkey253-dirty">
  <select id="cf_status_seamonkey253" name="cf_status_seamonkey253">
        <option value="---"
          id="v3338_cf_status_seamonkey253" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">seamonkey2.57esr</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_seamonkey257esr-dirty">
  <select id="cf_tracking_seamonkey257esr" name="cf_tracking_seamonkey257esr">
        <option value="---"
          id="v3594_cf_tracking_seamonkey257esr" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_seamonkey257esr-dirty">
  <select id="cf_status_seamonkey257esr" name="cf_status_seamonkey257esr">
        <option value="---"
          id="v3588_cf_status_seamonkey257esr" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>

</div>
  </div>
</section>



<section class="module" id="module-people"
>
    <header id="module-people-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse People section"
           data-label-collapsed="Expand People section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-people-content"
             aria-expanded="false"
             aria-labeledby="module-people-title"
             aria-describedby="module-people-subtitle"></div>
        <h2 class="module-title" id="module-people-title">People</h2>
          <h3 class="module-subtitle" id="module-people-subtitle">
            (Reporter: wsmwk, Assigned: KaiE)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-people-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-assigned_to"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to"><div class="vcard vcard_36541" ><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=36541" > <span class="fna">KaiE</span></a>
</div>
        </span>
    </div>

  
</div><div class="field edit-show" id="field-assigned_to" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-assignee" name="set_default_assignee" class="set-default"
          value="1" data-for="assigned_to">
        <label for="set-default-assignee">Reset Assignee to default</label>
      </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-bug_mentors" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor" id="bug_mentors-help-link" class="help">Mentors:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_mentors">---
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-qa_contact" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact" id="qa_contact-help-link" class="help">QA Contact:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-qa_contact">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-qa-contact" name="set_default_qa_contact" class="set-default"
          value="1" data-for="qa_contact">
        <label for="set-default-qa-contact">Reset QA Contact to default</label>
      </div>
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-reporter"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter" id="reporter-help-link" class="help">Reporter:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-reporter">
            <div class="vcard vcard_29811" ><img src="https://secure.gravatar.com/avatar/20697ca69672a5276f24a34382a1ddbd?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=29811" > <span class="fna">wsmwk</span></a>
</div>

        </span>
    </div>

  
</div>

    <div class="field" id="field-triage_owner"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner" id="triage_owner-help-link" class="help">Triage Owner:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-triage_owner">
            <div class="vcard vcard_36541" ><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=36541" > <span class="fna">KaiE</span></a>
</div>

        </span>
    </div>

  
</div>

    

    <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc" id="-help-link" class="help">CC:
        </a>
    </div>


  
    <div class=" container">


        <span aria-owns="cc-summary cc-latch">
          <span role="button" tabindex="0" id="cc-summary" data-count="7">7 people
          </span>
        </span>


        <div id="cc-list" style="display:none"></div>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-references"
>
    <header id="module-references-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse References section"
           data-label-collapsed="Expand References section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-references-content"
             aria-expanded="false"
             aria-labeledby="module-references-title"
             aria-describedby="module-references-subtitle"></div>
        <h2 class="module-title" id="module-references-title">References</h2>
      </div>
    </header>
  <div class="module-content" id="module-references-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field bug-list edit-show" id="field-dependson" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson" id="dependson-help-link" class="help">Depends on:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-dependson">
        ---
        </span>
    </div>

  
</div><div class="field bug-list" id="field-blocked"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks" id="blocked-help-link" class="help">Blocks:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-blocked">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Audit-Report RNP &amp; Thunderbird Integration 08.2020 (tracking)"
   href="/show_bug.cgi?id=1671735">RNP-01-audit</a>
      </div>

        </span>
    </div>

  
</div><div class="field" id="field-dependencytree"
>
    <div class="name">
    </div>


  
    <div class=" container">
        <span id="field-value-dependencytree">
        Dependency <a href="/showdependencytree.cgi?id=1673240&amp;hide_resolved=1">tree</a>
        / <a href="/showdependencygraph.cgi?id=1673240">graph</a>
        </span>
    </div>

  
</div>

    <div class="field bug-list edit-show" id="field-regresses" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses" id="regresses-help-link" class="help">Regressions:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regresses">
        ---
        </span>
    </div>

  
</div><div class="field bug-list edit-show" id="field-regressed_by" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by" id="regressed_by-help-link" class="help">Regressed by:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regressed_by">
        ---
        </span>
    </div>

  
</div>

    
</div><div class="fields-rhs">

    <div class="field edit-show" id="field-bug_file_loc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc" id="bug_file_loc-help-link" class="help">URL:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_file_loc"><div class="link">
    <a href="" target="_blank"
      rel="noreferrer" title=""
      class="bug-url" data-safe="0"></a>
  </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-see_also"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also" id="see_also-help-link" class="help">See Also:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-see_also">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED INVALID"
   href="/show_bug.cgi?id=1666236">1666236</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED"
   href="/show_bug.cgi?id=1666360">1666360</a>
      </div>

    <div class="link">
      <a href="https://github.com/rnpgp/rnp/issues/1214" title="https://github.com/rnpgp/rnp/issues/1214">github.com/rnpgp/rnp/issues/1214</a>
    </div>

        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-details"
>
    <header id="module-details-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Details section"
           data-label-collapsed="Expand Details section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-details-content"
             aria-expanded="false"
             aria-labeledby="module-details-title"
             aria-describedby="module-details-subtitle"></div>
        <h2 class="module-title" id="module-details-title">Details</h2>
          <h3 class="module-subtitle" id="module-details-subtitle">
            (Keywords: sec-high, Whiteboard: [RNP][fixed-in-rnp][needs tb adjustments])
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-details-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-show" id="field-alias" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias" id="alias-help-link" class="help">Alias:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-alias">
            CVE-2021-23991

        </span>
    </div>

  
</div>

    <div class="field" id="field-keywords"
>
    <div class="name">
        <a href="/describekeywords.cgi" id="keywords-help-link" class="help">Keywords:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-keywords">
          <a href="/buglist.cgi?keywords=sec-high&amp;resolution=---">sec-high</a>
        </span>
    </div>

  
</div>

    <div class="field" id="field-status_whiteboard"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/Whiteboard" id="status_whiteboard-help-link" class="help">Whiteboard:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-status_whiteboard">[RNP][fixed-in-rnp][needs tb adjustments]
        </span>
    </div>

  
</div>

    

    

    <div class="field" id="field-votes"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes" id="votes-help-link" class="help">Votes:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-votes">0
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field edit-show" id="field-bug_flags" style="display:none"
>
    <div class="name">Bug Flags:
    </div>


  
    <div class=" container">
        <span id="field-value-bug_flags"><div id="bug-flags" class="flags">
  <table class="layout-table">
    <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="This bug should be considered by thunderbird-drivers and developers as high-value and worthy of design &amp; review attention if a contributor offers a patch." for="flag_type-598">wanted-thunderbird</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-598-dirty">
      <select id="flag_type-598" name="flag_type-598"
        title="This bug should be considered by thunderbird-drivers and developers as high-value and worthy of design &amp; review attention if a contributor offers a patch."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug." for="flag_type-803">sec-bounty</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-803-dirty">
      <select id="flag_type-803" name="flag_type-803"
        title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame." for="flag_type-913">sec-bounty-hof</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-913-dirty">
      <select id="flag_type-913" name="flag_type-913"
        title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-787">in-qa-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-787-dirty">
      <select id="flag_type-787" name="flag_type-787"
        title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>

      <td class="flag-requestee">
        <div id="requestee_type-787-container" style="display:none"><input
    name="requestee_type-787"
    value="" class="requestee bz_autocomplete_user"  id="requestee_type-787" 
  >
        </div>
      <td>

  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-37">in-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-37-dirty">
      <select id="flag_type-37" name="flag_type-37"
        title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Include a summary of changes made by this bug in the release notes." for="flag_type-893">relnote</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-893-dirty">
      <select id="flag_type-893" name="flag_type-893"
        title="Include a summary of changes made by this bug in the release notes."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr>
    </tbody>
  </table>
</div>
        </span>
    </div>

  
</div>
</div>

  
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-crash-data"
>
    <header id="module-crash-data-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Crash Data section"
           data-label-collapsed="Expand Crash Data section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-crash-data-content"
             aria-expanded="false"
             aria-labeledby="module-crash-data-title"
             aria-describedby="module-crash-data-subtitle"></div>
        <h2 class="module-title" id="module-crash-data-title">Crash Data</h2>
      </div>
    </header>
  <div class="module-content" id="module-crash-data-content" style="display:none"
  ><div class="field edit-show" id="field-cf_crash_signature" style="display:none"
>
    <div class="name">Signature:
    </div>


  
    <div class="value">
        <span id="field-value-cf_crash_signature">
        </span>
    </div>

  
</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-security"
>
    <header id="module-security-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Security section"
           data-label-collapsed="Expand Security section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-security-content"
             aria-expanded="false"
             aria-labeledby="module-security-title"
             aria-describedby="module-security-subtitle"></div>
        <h2 class="module-title" id="module-security-title">Security</h2>
          <h3 class="module-subtitle" id="module-security-subtitle">
            (public)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-security-content" style="display:none"
  ><div class="groups edit-hide">
    This bug is publicly visible.
</div>

<div class="groups edit-show" style="display:none">


</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-user-story" data-non-stick="1"
>
    <header id="module-user-story-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse User Story section"
           data-label-collapsed="Expand User Story section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-user-story-content"
             aria-expanded="false"
             aria-labeledby="module-user-story-title"
             aria-describedby="module-user-story-subtitle"></div>
        <h2 class="module-title" id="module-user-story-title">User Story</h2>
      </div>
    </header>
  <div class="module-content" id="module-user-story-content" style="display:none"
  >
    <pre id="user-story"></pre>
  </div>
</section>







<section class="module" id="module-attachments"
>
    <header id="module-attachments-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Attachments section"
           data-label-collapsed="Expand Attachments section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-attachments-content"
             aria-expanded="true"
             aria-labeledby="module-attachments-title"
             aria-describedby="module-attachments-subtitle"></div>
        <h2 class="module-title" id="module-attachments-title">Attachments</h2>
          <h3 class="module-subtitle" id="module-attachments-subtitle">
            (2 files, 1 obsolete file)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-attachments-content"
  ><table role="table" class="layout-table" id="attachments">
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9187335">bug1673240_subkey_check.patch</a>
        </div>
        <div>
            <a href="#c1" class="attach-time activity-ref"><span class="rel-time" title="2020-11-12 01:53 PST" data-time="1605174816">1 year ago</span></a>
          <span class="attach-author"><div class="vcard vcard_101158" ><a class="email " href="/user_profile?user_id=101158" > <span class="fna">Magnus Melin [:mkmelin]</span></a>
</div></span>
        </div>
        <div class="attach-info">2.97 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_36541" ><span class="fn">KaiE</span>
</div>:
              <a href="#c13"
                  class="flag-name-status rel-time-title activity-ref"
                  title="1 year ago"
              data-time="1605174816"
            >
              feedback-</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9187335&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=9187335&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1673240&attachment=9187335">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9210268">Bug 1673240 - Use new RNP APIs for checking key validity. r=mkmelin</a>
        </div>
        <div>
            <a href="#c14" class="attach-time activity-ref"><span class="rel-time" title="2021-03-19 05:10 PDT" data-time="1616155849">8 months ago</span></a>
          <span class="attach-author"><div class="vcard vcard_36541" ><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div></span>
        </div>
        <div class="attach-info">48 bytes,
          text/x-phabricator-request        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_29811" ><span class="fn">wsmwk</span>
</div>:
              <a href="#c20"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 months ago"
              data-time="1616440773"
            >
              approval-comm-esr78+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9210268&amp;action=edit">Details</a>&#x0020; |
  <a href="/attachment.cgi?id=9210268">Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9210693">Bug 1673240 - Add tests using test keys contributed by Neal Walfield. r=mkmelin</a>
        </div>
        <div>
            <a href="#c16" class="attach-time activity-ref"><span class="rel-time" title="2021-03-22 03:54 PDT" data-time="1616410474">7 months ago</span></a>
          <span class="attach-author"><div class="vcard vcard_36541" ><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div></span>
        </div>
        <div class="attach-info">48 bytes,
          text/x-phabricator-request        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_29811" ><span class="fn">wsmwk</span>
</div>:
              <a href="#c25"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 months ago"
              data-time="1618243145"
            >
              approval-comm-esr78+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9210693&amp;action=edit">Details</a>&#x0020; |
  <a href="/attachment.cgi?id=9210693">Review</a>
    </tr>
</table>

<footer id="attachments-footer">
  <div id="attachments-actions">
      <button type="button" id="attachments-obsolete-btn" class="secondary">Show Obsolete</button>
  </div>
  
</footer>
  </div>
</section>



<script nonce="2mnjvba9JDw11sNTKCWP2jcfJJIvKNjH8GwNB4S6kFCvYk2f">
  init_module_visibility();
</script>



<meta name="firefox-versions" content="{&quot;FIREFOX_AURORA&quot;:&quot;&quot;,&quot;FIREFOX_DEVEDITION&quot;:&quot;94.0b9&quot;,&quot;FIREFOX_ESR&quot;:&quot;78.15.0esr&quot;,&quot;FIREFOX_ESR_NEXT&quot;:&quot;91.2.0esr&quot;,&quot;FIREFOX_NIGHTLY&quot;:&quot;95.0a1&quot;,&quot;FIREFOX_PINEBUILD&quot;:&quot;&quot;,&quot;LAST_MERGE_DATE&quot;:&quot;2021-10-04&quot;,&quot;LAST_RELEASE_DATE&quot;:&quot;2021-10-05&quot;,&quot;LAST_SOFTFREEZE_DATE&quot;:&quot;2021-09-30&quot;,&quot;LATEST_FIREFOX_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_OLDER_VERSION&quot;:&quot;3.6.28&quot;,&quot;LATEST_FIREFOX_RELEASED_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_VERSION&quot;:&quot;93.0&quot;,&quot;NEXT_MERGE_DATE&quot;:&quot;2021-11-01&quot;,&quot;NEXT_RELEASE_DATE&quot;:&quot;2021-11-02&quot;,&quot;NEXT_SOFTFREEZE_DATE&quot;:&quot;2021-10-28&quot;}">


<div id="comment-actions">
    <button type="button" id="bottom-btn" class="secondary" aria-label="Go to Page Bottom">Bottom &darr;</button>
  <div class="dropdown">
    <button type="button" id="comment-tags-btn" aria-haspopup="true" aria-label="Tags"
      aria-expanded="false" aria-controls="comment-tags-menu" class="dropdown-button minor">Tags &#9662;</button>
    <ul id="comment-tags-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a role="menuitem" tabindex="-1" data-comment-tag="">Reset</a>
      </li>
    </ul>
  </div>
  <div class="dropdown">
    <button type="button" id="view-menu-btn" aria-haspopup="true" aria-label="Timeline"
      aria-expanded="false" aria-controls="view-menu" class="dropdown-button minor">Timeline &#9662;</button>
    <ul id="view-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a id="view-reset" role="menuitem" tabindex="-1">Reset</a>
      </li>
      <li role="separator"></li>
      <li role="presentation">
        <a id="view-collapse-all" role="menuitem" tabindex="-1">Collapse All</a>
      </li>
      <li role="presentation">
        <a id="view-expand-all" role="menuitem" tabindex="-1">Expand All</a>
      </li>
      <li role="presentation">
        <a id="view-comments-only" role="menuitem" tabindex="-1">Comments Only</a>
      </li>
    </ul>
   </div>
</div>
<div class="change-set" id="c0"><div class="comment" data-id="15098665" data-no="0"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-0" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_29811" ><img src="https://secure.gravatar.com/avatar/20697ca69672a5276f24a34382a1ddbd?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_29811" ><a class="email " href="/user_profile?user_id=29811" > <span class="fna">Wayne Mery (:wsmwk)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-0"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-0" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1673240#c0">Description</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-10-25 05:25 PDT" data-time="1603628708">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-0">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-0" data-comment-id="15098665" data-ismarkdown="true" ><p>It was found that Thunderbird allows importing primary keys and subkeys that are not bound to a valid cryptographically secure signature. Additionally, Thunderbird automatically imports detected, attached PGP primary keys with an already trusted fingerprint, as it has an extended expiry time. This introduces the risk of attackers obtaining a primary key with an extended or unset expiry time of a trusted person, while it has not yet been imported into the PGP key ring of the victim.</p>
<p>The attackers can abuse this by adding a malicious subkey, which has been used by Thunderbird for email encryption, signature verification and key certification. Although the subkey is flagged as invalid by RNP, it is silently accepted and imported by Thunderbird as soon as the user opens the attacker’s mail.</p>
<p><em><strong>Affected File:</strong></em><br>
comm/mail/extensions/openpgp/content/ui/enigmailMessengerOverlay.js</p>
<p><em><strong>Affected Code:</strong></em></p>
<pre><code>commonProcessAttachedKey(keyData, isBinaryAutocrypt) {
  let errorMsgObj = {};
  let preview = EnigmailKey.getKeyListFromKeyBlock(
     keyData,
     [...]
  );
  [...]
  for (let newKey of preview) {
     let oldKey = EnigmailKeyRing.getKeyById(newKey.fpr);
     if (!oldKey) {
        [...]
        continue; 
      }
      [...]
      let newHasNewValidity =
          oldKey.expiryTime &lt; newKey.expiryTime || 
          (oldKey.keyTrust != &quot;r&quot; &amp;&amp; newKey.keyTrust == &quot;r&quot;);
      if (!newHasNewValidity)
          continue;
      [...]
      !EnigmailKeyRing.importKeyDataSilent(
         window,
         keyData,
         isBinaryAutocrypt,
         &quot;0x&quot; + newKey.fpr
       )
  [...]
</code></pre>
<p>It is advised that the validity of the PGP keys returned from the RNP library is respected by Thunderbird and actions ensue accordingly. Additionally, Cure53 recommends for trusted primary keys not getting automatically imported. Instead, the user should be informed and asked about importing the new key. It is crucial to alert the user about every new subkey and user-identity which is about to be newly trusted.</p>
</div></div><div class="change-set" id="a1528306_1689"><div class="change" id="aa1528306_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a1528306_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a1528306_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1528306_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1528306_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1673240#a1528306_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-11-11 20:56 PST" data-time="1605157014">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Keywords: <a href="/buglist.cgi?keywords=sec-high&amp;resolution=---">sec-high</a></div></div></div><div class="change-set" id="c1"><div class="comment" data-id="15127807" data-no="1"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-1" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_101158" id="a1528306_1689"><img src="https://secure.gravatar.com/avatar/18eb16a976feb4b40d839c5e9036bc3a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_101158" id="a1528306_1689"><a class="email " href="/user_profile?user_id=101158" > <span class="fna">Magnus Melin [:mkmelin]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-1"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-1" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1673240#c1">Comment 1</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-11-12 01:53 PST" data-time="1605174816">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-1">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9187335"
         class="attachment patch obsolete"
         data-id="9187335" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1673240_subkey_check.patch">
      <meta itemprop="contentSize" content="3046">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=9187335">
          <a class="link" href="attachment.cgi?id=9187335&amp;action=diff">
        <span id="att-9187335-description" itemprop="description">bug1673240_subkey_check.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=9187335&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1673240&attachment=9187335">Splinter Review</a>
      </div>
    </div>

  
    <div
        class="comment-text markdown-body "
        id="ct-1" data-comment-id="15127807" data-ismarkdown="true" ><p>WIP, though I think this is the gist of it.<br>
I don&#39;t know how to generate a key with invalid subKeys, so no idea if it works.</p>
</div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9187335&amp;action=edit"
           title="bug1673240_subkey_check.patch"
           class=""
        >Attachment #9187335</a> -
        Flags: feedback?(kaie)</div></div></div><div class="change-set" id="a1552599_29811"><div class="change" id="aa1552599_29811">
    <table class="layout-table change-head reporter" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_29811" id="a1552599_29811"><img src="https://secure.gravatar.com/avatar/20697ca69672a5276f24a34382a1ddbd?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_29811" id="a1552599_29811"><a class="email " href="/user_profile?user_id=29811" > <span class="fna">Wayne Mery (:wsmwk)</span></a>
</div>
            <span class="user-role">Reporter</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1552599_29811"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1552599_29811">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1673240#a1552599_29811">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-11-12 03:41 PST" data-time="1605181307">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_thunderbird_esr78&amp;o1=isnotempty">status-thunderbird_esr78</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_thunderbird_esr78&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_thunderbird_esr78&amp;o1=isnotempty">tracking-thunderbird_esr78</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_thunderbird_esr78&amp;o1=equals&amp;v1=%2B">+</a></div><div class="change">Priority: -- &rarr; P1</div></div></div><div class="change-set" id="c2"><div class="comment" data-id="15128088" data-no="2"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-2" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_665047" id="a1552599_29811"><img src="https://secure.gravatar.com/avatar/a68d17cbd12e477e4a67745bd5b2452b?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_665047" id="a1552599_29811"><a class="email " href="/user_profile?user_id=665047" > <span class="fna">Nickolay Olshevsky</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-2"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-2" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1673240#c2">Comment 2</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-11-12 04:49 PST" data-time="1605185343">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-2">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-2" data-comment-id="15128088" data-ismarkdown="true" ><p>New RNP API would be added as this issue will be resolved: <a href="https://github.com/rnpgp/rnp/issues/1214" rel="nofollow">https://github.com/rnpgp/rnp/issues/1214</a><br>
Basically, before doing any manipulations with public keys/subkeys, those should be checked for validity. While we do that internally, still API is not exposed via FFI yet.</p>
</div></div><div class="change-set" id="a1559882_101158"><div class="change" id="aa1559882_101158">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_101158" id="a1559882_101158"><img src="https://secure.gravatar.com/avatar/18eb16a976feb4b40d839c5e9036bc3a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_101158" id="a1559882_101158"><a class="email " href="/user_profile?user_id=101158" > <span class="fna">Magnus Melin [:mkmelin]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1559882_101158"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1559882_101158">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1673240#a1559882_101158">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-11-12 05:43 PST" data-time="1605188590">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">See Also:  &rarr; <a href="https://github.com/rnpgp/rnp/issues/1214" target="_blank" rel="noreferrer">https://github.com/rnpgp/rnp/issues/1214</a></div></div></div><div class="change-set" id="a7429031_101158"><div class="change" id="aa7429031_101158">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_101158" id="a7429031_101158"><img src="https://secure.gravatar.com/avatar/18eb16a976feb4b40d839c5e9036bc3a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_101158" id="a7429031_101158"><a class="email " href="/user_profile?user_id=101158" > <span class="fna">Magnus Melin [:mkmelin]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a7429031_101158"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a7429031_101158">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1673240#a7429031_101158">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-01-19 04:02 PST" data-time="1611057739">9 months ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: [RNP][fixed-in-rnp][needs tb adjustments]</div></div></div><div class="change-set" id="c3"><div class="comment" data-id="15303242" data-no="3"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-3" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a7429031_101158"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a7429031_101158"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-3"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-3" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1673240#c3">Comment 3</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-03-10 09:24 PST" data-time="1615397053">8 months ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-3">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-3" data-comment-id="15303242" data-ismarkdown="true" ><p>I&#39;ve read this problem report many times, and I still think it is confusing.<br>
I think it&#39;s necessary that I state my assumptions, and ask questions, and get those clarified, before we can figure out how to fix this issue.</p>
<p>During development, we had the need to increase our compatibility with existing keys. So I had asked the RNP team to relax restrictions, and allow a wider keys to be imported.</p>
<p>I think it&#39;s necessary to distinguish between &quot;having a key available in the key store&quot; and &quot;querying key attributes&quot; and &quot;using a key for operations&quot;.</p>
<p>My assumptions:</p>
<ul>
<li>each public key defines a primary key</li>
<li>for each subkey, there must be a signature of the primary key, which confirms the subkey was added by the owner of the primary key</li>
<li>for each user id, there must be a signature of the primary key, which confirms the user id was added by the owner of the primary key</li>
<li>for each validity time change, there must be a signature of the primary key, which confirms the change was made by the owner of the primary key</li>
<li>RNP may import/store a public key, even if there are bad signatures</li>
<li>if the application asks RNP for a list of subkeys, RNP will check the subkey, and only return a subkey if it has a valid signature by the primary key</li>
<li>if the application asks RNP for a list of used IDs, RNP will check the user IDs, and only return a user ID if it has a valid signature by the primary key</li>
<li>if the application asks RNP for the key&#39;s validity time, RNP will only return information that has been confirmed with a valid signature by the primary key</li>
</ul>
<p>Are these assumptions correct?<br>
Could you please comment on each item, which ones are correct or not?<br>
For any of the above, did the RNP behavior change after the security audit?</p>
</div><div class="activity"><div class="change">Flags: needinfo?(o.nickolay)</div></div></div><div class="change-set" id="c4"><div class="comment" data-id="15303269" data-no="4"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-4" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a7429031_101158"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a7429031_101158"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-4"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-4" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1673240#c4">Comment 4</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-03-10 09:35 PST" data-time="1615397730">8 months ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-4">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-4" data-comment-id="15303269" data-ismarkdown="true" ><p>Maybe I will find some answers in the bugs that Neal has reported. I have to study them in detail.</p>
</div></div><div class="change-set" id="c5"><div class="comment" data-id="15303370" data-no="5"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-5" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a7429031_101158"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a7429031_101158"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-5"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-5" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1673240#c5">Comment 5</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-03-10 10:13 PST" data-time="1615399986">8 months ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-5">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-5" data-comment-id="15303370" data-ismarkdown="true" ><p>(In reply to Kai Engert (:KaiE:) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1673240#c3" title="RESOLVED FIXED - RNP-01-014 WP1 Thunderbird: Key manipulation via uncertified Auto-Import (Medium)">comment #3</a>)</p>
<blockquote>
<ul>
<li>if the application asks RNP for a list of user IDs, RNP will check the user IDs, and only return a user ID if it has a valid signature by the primary key</li>
</ul>
</blockquote>
<p>IIUC, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1666236" title="RESOLVED INVALID">bug 1666236</a> reports that my assumption was incorrect. RNP returned user IDs despite a missing or bad signature.</p>
<p><a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1666236" title="RESOLVED INVALID">Bug 1666236</a> links two RNP tickets, and both have been marked as fixed in November 2020. We recently updated Thunderbird to v0.14.0 from January 2021.</p>
</div></div><div class="change-set" id="c6"><div class="comment" data-id="15303459" data-no="6"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-6" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_665047" id="a7429031_101158"><img src="https://secure.gravatar.com/avatar/a68d17cbd12e477e4a67745bd5b2452b?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_665047" id="a7429031_101158"><a class="email " href="/user_profile?user_id=665047" > <span class="fna">Nickolay Olshevsky</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-6"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-6" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1673240#c6">Comment 6</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-03-10 10:52 PST" data-time="1615402335">8 months ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-6">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-6" data-comment-id="15303459" data-ismarkdown="true" ><p>Since this was originally posted RNP&#39;s API was updated with a number of functions allowing to check key/subkey/userid/signature validities.</p>
<blockquote>
<p>each public key defines a primary key</p>
</blockquote>
<p>And it considered as valid if it has at least one valid self-signature, and it doesn&#39;t expire key. There is one edge case, caused by &#39;stripped&#39; keys, i.e. keys without userids and certifications. In this case key also considered as valid if it has subkey with valid subkey binding signature.<br>
API function to check validity status: <code>rnp_key_is_valid()</code>. Also there is a function <code>rnp_key_valid_till()</code>, which return timestamp till which key was considered as valid. This is to distinguish the case of emails, signed 3 years ago, with the key which expired or revoked 1 year ago.</p>
<blockquote>
<p>for each subkey, there must be a signature of the primary key, which confirms the subkey was added by the owner of the primary key</p>
</blockquote>
<p>Subkey is considered as valid by RNP if it has at least one non-expiring subkey binding signature, and primary key is valid as well. Validity may be checked via the same <code>rnp_key_is_valid()</code> function. <code>rnp_key_valid_till()</code> also apply here.</p>
<blockquote>
<p>for each user id, there must be a signature of the primary key, which confirms the user id was added by the owner of the primary key</p>
</blockquote>
<p>Yeah, this is called self-certification. Also this signature includes information about the key usage - preferred algorithms, key expiration, flags and so on.<br>
This may lead to confusion if the key has multiple userids with different preferences, or direct-key signatures (i.e. signatures which tells some information about the key itself). So, in exotic situations, key preferences would depend on which userid was used to found this key.<br>
To check userid validity you may use function <code>rnp_uid_is_valid()</code>. Please note that functions <code>rnp_key_get_uid_*</code> will list all uids, including invalid ones. However, <code>rnp_locate_key()</code> will search for the key only via valid uids.</p>
<blockquote>
<p>for each validity time change, there must be a signature of the primary key, which confirms the change was made by the owner of the primary key</p>
</blockquote>
<p>Yes, usual practice is to add additional signature with extended expiration time. As far as I remember there is no strict MUST in RFC on which signatures take in account in such case, but it is recommended to check the most recent signature. I.e. if one year ago you set key expiration time to 5 years, and yesterday to 1 year, then it should expire in 1 year instead of the 4. While we have <code>rnp_key_get_expiration()</code>, you still may walk through all the sigs and override default decision.</p>
<blockquote>
<p>RNP may import/store a public key, even if there are bad signatures</p>
</blockquote>
<p>Yes, we do not remove anything automatically giving flexibility to the library user. However, you still may use functions <code>rnp_key_remove_signature()</code>, <code>rnp_key_remove_uid()</code> or <code>rnp_key_remove_signatures()</code> to cleanup the key. This functions were added recently and will be available in v0.15.0 release.</p>
<blockquote>
<p>if the application asks RNP for a list of subkeys, RNP will check the subkey, and only return a subkey if it has a valid signature by the primary key</p>
</blockquote>
<p>No, it will return all subkeys and you should check validity via <code>rnp_key_is_valid()</code></p>
<blockquote>
<p>if the application asks RNP for a list of used IDs, RNP will check the user IDs, and only return a user ID if it has a valid signature by the primary key</p>
</blockquote>
<p>No, it will return all the uids and you should call <code>rnp_uid_is_valid()</code> to check it.</p>
<blockquote>
<p>if the application asks RNP for the key&#39;s validity time, RNP will only return information that has been confirmed with a valid signature by the primary key</p>
</blockquote>
<p>That&#39;s right. But still there may be different edge cases, like different validity times for different userids or direct-key sigs. We have some issues to behave in other way in such cases, but didn&#39;t get to those yet. For these cases key validity/expiration may vary depending on which userid was used to find a key.</p>
<p>Hope this helps, feel free to ask for more details. Actually, as for me, OpenPGP standard in some places is too flexible and allows too much freedom of interpretation.</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(o.nickolay)</span></div></div></div><div class="change-set" id="c7"><div class="comment" data-id="15315601" data-no="7"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-7" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a7429031_101158"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a7429031_101158"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-7"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-7" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1673240#c7">Comment 7</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-03-17 09:50 PDT" data-time="1615999855">8 months ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-7">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-7" data-comment-id="15315601" data-ismarkdown="true" ><p>Thanks for the explanation.</p>
<p>Regarding user IDs, I think TB should completely ignore user IDs that don&#39;t pass signature checks.</p>
<p>However, in its key management user interface, TB wants to show the user ID of an expired key. This can allow the user to identify an expired key, select it, and request to extend the expiration.</p>
<p>This means, I need to be able to ask RNP: Is time the only reason why the user ID is invalid? Does the user ID pass all other validity checks?</p>
<p>rnp_uid_is_valid doesn&#39;t answer this question.</p>
<p>If TB hides all user IDs that rnp_uid_is_valid describes as invalid, then the user interface cannot show any user ID for expired keys - which makes it difficult for the user to identify a key that they might want to extend.</p>
<p>For subkeys, you are offering rnp_key_valid_till. I think this provides the answer I need for subkeys. If the timestamp returned by rnp_key_valid_till is nonzero, then in my understanding, the subkey passes all signature checks.</p>
</div></div><div class="change-set" id="c8"><div class="comment" data-id="15315636" data-no="8"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-8" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a7429031_101158"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a7429031_101158"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-8"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-8" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1673240#c8">Comment 8</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-03-17 10:07 PDT" data-time="1616000840">8 months ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-8">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-8" data-comment-id="15315636" data-ismarkdown="true" ><p>Maybe the following approach is mostly ok. If the primary key is expired or revoked, but the primary key was valid at some time (rnp_key_valid_till returns nonzero), then TB could use rnp_key_get_primary_uid, and show the result, regardless of the uid validity.</p>
</div></div><div class="change-set" id="c9"><div class="comment" data-id="15315695" data-no="9"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-9" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a7429031_101158"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a7429031_101158"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-9"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-9" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1673240#c9">Comment 9</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-03-17 10:29 PDT" data-time="1616002187">8 months ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-9">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-9" data-comment-id="15315695" data-ismarkdown="true" ><p>The plan from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1673240#c8" title="RESOLVED FIXED - RNP-01-014 WP1 Thunderbird: Key manipulation via uncertified Auto-Import (Medium)">comment 8</a> doesn&#39;t work, because rnp_key_get_primary_uid returns failure if all user IDs are expired.</p>
</div></div><div class="change-set" id="c10"><div class="comment" data-id="15315710" data-no="10"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-10" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_665047" id="a7429031_101158"><img src="https://secure.gravatar.com/avatar/a68d17cbd12e477e4a67745bd5b2452b?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_665047" id="a7429031_101158"><a class="email " href="/user_profile?user_id=665047" > <span class="fna">Nickolay Olshevsky</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-10"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-10" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1673240#c10">Comment 10</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-03-17 10:37 PDT" data-time="1616002670">8 months ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-10">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-10" data-comment-id="15315710" data-ismarkdown="true" ><p>Hi Kai,</p>
<blockquote>
<p>This means, I need to be able to ask RNP: Is time the only reason why the user ID is invalid? Does the user ID pass all other validity checks?</p>
</blockquote>
<p>To confirm this you may iterate through userid signatures, filter out self-sig, and call <code>rnp_signature_is_valid()</code> on it. It will return RNP_SUCCESS if signature is valid (despite the key expiration). The same could be done on the subkey. I have some plans on adding functions <code>rnp_uid_latest_selfsig()</code>/<code>rnp_key_latest_binding()</code> to make this easier.<br>
I.e. even if uid/key are expired, self-signatures are still valid (however, they may also be marked as expiring).</p>
<blockquote>
<p>The plan from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1673240#c8" title="RESOLVED FIXED - RNP-01-014 WP1 Thunderbird: Key manipulation via uncertified Auto-Import (Medium)">comment 8</a> doesn&#39;t work, because rnp_key_get_primary_uid returns failure if all user IDs are expired.</p>
</blockquote>
<p>Yeah, sorry, forgot to mention this in the first comment. If there are no valid signatures on the uid, primary flag is dropped.</p>
</div></div><div class="change-set" id="c11"><div class="comment" data-id="15315783" data-no="11"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-11" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a7429031_101158"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a7429031_101158"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-11"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-11" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1673240#c11">Comment 11</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-03-17 11:24 PDT" data-time="1616005486">8 months ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-11">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-11" data-comment-id="15315783" data-ismarkdown="true" ><p>Thanks Nickolay, that works!</p>
</div></div><div class="change-set" id="c12"><div class="comment" data-id="15315907" data-no="12"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-12" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a7429031_101158"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a7429031_101158"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-12"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-12" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1673240#c12">Comment 12</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-03-17 12:36 PDT" data-time="1616009809">8 months ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-12">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-12" data-comment-id="15315907" data-ismarkdown="true" ><p>Let&#39;s summarize.</p>
<p>This bug reports, we may automatically import keys with invalid data, and use that invalid data.<br>
The reported suggestion was, don&#39;t import automatically.<br>
However, not importing automatically is contrary to the intended convenience mechanism, so I&#39;d like to use a different fix.<br>
Also, because the user is allowed to use keys manually, preventing automatic import wouldn&#39;t be a complete fix against using manipulated keys.</p>
<p>The report is correct, we automatically import an updated key with new subkeys.<br>
It is correct that the TB code level would automatically accept the use of a new subkey, without checking the subkey&#39;s validity at the TB level.<br>
This could be abused to trick TB into using a different encryption key, when sending an encrypted message.<br>
I suggest to fix it by using the recently added new RNP API rnp_valid_till.<br>
We already limit use only subkeys for encryption that are not revoked and are not expired.<br>
By calling rnp_valid_till, and additional requiring that a subkey must have been valid at some time, we ensure that only subkeys certified by the key owner will be used.</p>
<p>Regarding user IDs:<br>
It is correct, we currently display inalid user IDs, based on Nickolay&#39;s explanation.<br>
However, we don&#39;t automatically trust/accept new user IDs.<br>
At the time the user views the details for a key, we store the acceptance setting for each email address reported on screen.<br>
We don&#39;t update the list of accepted email address, unless the user views the key details again (which would then show an updated list of email addresses) and confirms the acceptance settings again.<br>
Nevertheless, we should disallow the use of invalid user IDs (and their email addresses).<br>
The suggestion is to only allow accepting user IDs that carry a valid self signature, as reported by rnp_uid_is_valid.</p>
</div></div><div class="change-set" id="c13"><div class="comment" data-id="15318833" data-no="13"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-13" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a7429031_101158"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a7429031_101158"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-13"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-13" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1673240#c13">Comment 13</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-03-19 05:07 PDT" data-time="1616155643">8 months ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-13">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-13" data-comment-id="15318833" data-ismarkdown="true" ><p>Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=9187335" name="attach_9187335" title="bug1673240_subkey_check.patch">attachment 9187335</a> <a href="/attachment.cgi?id=9187335&amp;action=edit" title="bug1673240_subkey_check.patch">[details]</a> <a href="/attachment.cgi?id=9187335&amp;action=diff" title="bug1673240_subkey_check.patch">[diff]</a></span> <a href="/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1673240&amp;attachment=9187335">[review]</a><br>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1673240" title="RESOLVED FIXED - RNP-01-014 WP1 Thunderbird: Key manipulation via uncertified Auto-Import (Medium)">bug1673240</a>_subkey_check.patch</p>
<p>I think this isn&#39;t the right approach to solve the issue. We need to treat keys based on their properties, and the new RNP APIs make that possible. I have a patch in hand that prevents the use of invalid keys, as also reported in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1666236" title="RESOLVED INVALID">bug 1666236</a> and <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1666360" title="RESOLVED FIXED">bug 1666360</a>. If a key has only bad properties, it won&#39;t be imported as a consequence.</p>
</div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9187335&amp;action=edit"
           title="bug1673240_subkey_check.patch"
           class=""
        >Attachment #9187335</a> -
        Flags: feedback?(kaie) &rarr; feedback-</div></div></div><div class="change-set" id="a12526951_36541"><div class="change" id="aa12526951_36541">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a12526951_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_36541" id="a12526951_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a12526951_36541"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a12526951_36541">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1673240#a12526951_36541">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-03-19 05:07 PDT" data-time="1616155659">8 months ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Assignee: nobody &rarr; kaie</div></div></div><div class="change-set" id="a12526972_36541"><div class="change" id="aa12526972_36541">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a12526972_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_36541" id="a12526972_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a12526972_36541"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a12526972_36541">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1673240#a12526972_36541">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-03-19 05:08 PDT" data-time="1616155680">8 months ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9187335&amp;action=edit"
           title="bug1673240_subkey_check.patch"
           class=""
        >Attachment #9187335</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="c14"><div class="comment" data-id="15318841" data-no="14"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-14" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a12526972_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a12526972_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-14"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-14" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1673240#c14">Comment 14</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-03-19 05:10 PDT" data-time="1616155849">8 months ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-14">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9210268"
         class="attachment"
         data-id="9210268" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="phabricator-D109060-url.txt">
      <meta itemprop="contentSize" content="48">
      <meta itemprop="encodingFormat" content="text/x-phabricator-request">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=9210268" itemprop="contentUrl">
        <span id="att-9210268-description" itemprop="description">Bug 1673240 - Use new RNP APIs for checking key validity. r=mkmelin</span></a>
        — <a href="attachment.cgi?id=9210268&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div></div><div class="change-set" id="c15"><div class="comment" data-id="15318850" data-no="15"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-15" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a12526972_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a12526972_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-15"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-15" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1673240#c15">Comment 15</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-03-19 05:22 PDT" data-time="1616156576">8 months ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-15">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-15" data-comment-id="15318850" data-ismarkdown="true" ><p>Adding Neal to CC, because he independently found related issues, and I&#39;d like to fix the issues in this bug.</p>
</div></div><div class="change-set" id="a12527905_36541"><div class="change" id="aa12527905_36541">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a12527905_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_36541" id="a12527905_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a12527905_36541"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a12527905_36541">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1673240#a12527905_36541">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-03-19 05:23 PDT" data-time="1616156613">8 months ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">See Also:  &rarr; <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED INVALID"
   href="/show_bug.cgi?id=1666236">1666236</a></div></div></div><div class="change-set" id="a12777080_36541"><div class="change" id="aa12777080_36541">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a12777080_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_36541" id="a12777080_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a12777080_36541"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a12777080_36541">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1673240#a12777080_36541">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-03-22 02:36 PDT" data-time="1616405788">7 months ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">See Also:  &rarr; <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED"
   href="/show_bug.cgi?id=1666360">1666360</a></div></div></div><div class="change-set" id="c16"><div class="comment" data-id="15323014" data-no="16"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-16" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a12777080_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a12777080_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-16"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-16" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1673240#c16">Comment 16</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-03-22 03:54 PDT" data-time="1616410474">7 months ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-16">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9210693"
         class="attachment"
         data-id="9210693" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="phabricator-D109294-url.txt">
      <meta itemprop="contentSize" content="48">
      <meta itemprop="encodingFormat" content="text/x-phabricator-request">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=9210693" itemprop="contentUrl">
        <span id="att-9210693-description" itemprop="description">Bug 1673240 - Add tests using test keys contributed by Neal Walfield. r=mkmelin</span></a>
        — <a href="attachment.cgi?id=9210693&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div></div><div class="change-set" id="c17"><div class="comment" data-id="15323018" data-no="17"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-17" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a12777080_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a12777080_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-17"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-17" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1673240#c17">Comment 17</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-03-22 03:56 PDT" data-time="1616410586">7 months ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-17">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-17" data-comment-id="15323018" data-ismarkdown="true" ><p>Neal, thank you very much for contributing test keys in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1666236" title="RESOLVED INVALID">bug 1666236</a> and <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1666360" title="RESOLVED FIXED">bug 1666360</a>. I&#39;m adding these keys to the Thunderbird test suite, and have added automated tests.<br>
The tests fail without the fix from this bug, and work with the fix.</p>
</div></div><div class="change-set" id="a12782080_600971"><div class="change" id="aa12782080_600971">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_600971" id="a12782080_600971"><img src="https://secure.gravatar.com/avatar/a088418052679d9583556d277e6774ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_600971" id="a12782080_600971"><a class="email " href="/user_profile?user_id=600971" > <span class="fna">Phabricator Automation</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a12782080_600971"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a12782080_600971">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1673240#a12782080_600971">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-03-22 03:59 PDT" data-time="1616410788">7 months ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9210268&amp;action=edit"
           title="Bug 1673240 - Use new RNP APIs for checking key validity. r=mkmelin"
           class=""
        >Attachment #9210268</a> -
        Attachment description: Bug 1673240 - Prevent the use of invalid OpenPGP keys and user IDs. r=mkmelin &rarr; Bug 1673240 - Use new RNP APIs to check key validity. r=mkmelin</div></div></div><div class="change-set" id="a12782136_600971"><div class="change" id="aa12782136_600971">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_600971" id="a12782136_600971"><img src="https://secure.gravatar.com/avatar/a088418052679d9583556d277e6774ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_600971" id="a12782136_600971"><a class="email " href="/user_profile?user_id=600971" > <span class="fna">Phabricator Automation</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a12782136_600971"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a12782136_600971">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1673240#a12782136_600971">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-03-22 04:00 PDT" data-time="1616410844">7 months ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9210268&amp;action=edit"
           title="Bug 1673240 - Use new RNP APIs for checking key validity. r=mkmelin"
           class=""
        >Attachment #9210268</a> -
        Attachment description: Bug 1673240 - Use new RNP APIs to check key validity. r=mkmelin &rarr; Bug 1673240 - Use new RNP APIs for checking key validity. r=mkmelin</div></div></div><div class="change-set" id="a12808472_36541"><div class="change" id="aa12808472_36541">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a12808472_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_36541" id="a12808472_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a12808472_36541"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a12808472_36541">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1673240#a12808472_36541">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-03-22 11:19 PDT" data-time="1616437180">7 months ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Target Milestone: --- &rarr; 88 Branch</div></div></div><div class="change-set" id="c18"><div class="comment" data-id="15323921" data-no="18"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-18" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a12808472_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a12808472_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-18"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-18" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1673240#c18">Comment 18</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-03-22 12:19 PDT" data-time="1616440773">7 months ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-18">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-18" data-comment-id="15323921" data-ismarkdown="true" ><p>Comment on <span class=""><a href="/attachment.cgi?id=9210268" name="attach_9210268" title="Bug 1673240 - Use new RNP APIs for checking key validity. r=mkmelin">attachment 9210268</a> <a href="/attachment.cgi?id=9210268&amp;action=edit" title="Bug 1673240 - Use new RNP APIs for checking key validity. r=mkmelin">[details]</a></span><br>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1673240" title="RESOLVED FIXED - RNP-01-014 WP1 Thunderbird: Key manipulation via uncertified Auto-Import (Medium)">Bug 1673240</a> - Use new RNP APIs for checking key validity. r=mkmelin</p>
<p>[Approval Request Comment]<br>
Regression caused by (bug #): no<br>
User impact if declined: invalid keys are allowed<br>
Testing completed (on c-c, etc.):<br>
Risk to taking this patch (and alternatives if risky): low, should only affect scenarios that need to fail</p>
</div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9210268&amp;action=edit"
           title="Bug 1673240 - Use new RNP APIs for checking key validity. r=mkmelin"
           class=""
        >Attachment #9210268</a> -
        Flags: approval-comm-esr78?</div></div></div><div class="change-set" id="c19"><div class="comment" data-id="15325140" data-no="19"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-19" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a12808472_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a12808472_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-19"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-19" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1673240#c19">Comment 19</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-03-23 06:48 PDT" data-time="1616507334">7 months ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-19">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-19" data-comment-id="15325140" data-ismarkdown="true" ><p><a href="https://hg.mozilla.org/comm-central/rev/5f3efef0a3b5e117e38e2e6b42c4ac5921a65bfe" rel="nofollow">https://hg.mozilla.org/comm-central/rev/5f3efef0a3b5e117e38e2e6b42c4ac5921a65bfe</a></p>
</div><div class="activity"><div class="change">Status: NEW &rarr; RESOLVED</div><div class="change">Closed: <span class="rel-time" title="2021-03-23 06:48 PDT" data-time="1616507334">7 months ago</span></div><div class="change">Resolution: --- &rarr; FIXED</div></div></div><div class="change-set" id="c20"><div class="comment" data-id="15345904" data-no="20"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-20" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_29811" id="a12808472_36541"><img src="https://secure.gravatar.com/avatar/20697ca69672a5276f24a34382a1ddbd?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_29811" id="a12808472_36541"><a class="email " href="/user_profile?user_id=29811" > <span class="fna">Wayne Mery (:wsmwk)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-20"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-20" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1673240#c20">Comment 20</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-04-05 20:04 PDT" data-time="1617678271">7 months ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-20">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-20" data-comment-id="15345904" data-ismarkdown="true" ><p>Comment on <span class=""><a href="/attachment.cgi?id=9210268" name="attach_9210268" title="Bug 1673240 - Use new RNP APIs for checking key validity. r=mkmelin">attachment 9210268</a> <a href="/attachment.cgi?id=9210268&amp;action=edit" title="Bug 1673240 - Use new RNP APIs for checking key validity. r=mkmelin">[details]</a></span><br>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1673240" title="RESOLVED FIXED - RNP-01-014 WP1 Thunderbird: Key manipulation via uncertified Auto-Import (Medium)">Bug 1673240</a> - Use new RNP APIs for checking key validity. r=mkmelin</p>
<p>[Triage Comment]<br>
Approved for esr78</p>
</div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9210268&amp;action=edit"
           title="Bug 1673240 - Use new RNP APIs for checking key validity. r=mkmelin"
           class=""
        >Attachment #9210268</a> -
        Flags: approval-comm-esr78? &rarr; approval-comm-esr78+</div></div></div><div class="change-set" id="c21"><div class="comment" data-id="15346113" data-no="21"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-21" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a12808472_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a12808472_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-21"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-21" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1673240#c21">Comment 21</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-04-06 00:56 PDT" data-time="1617695819">7 months ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-21">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-21" data-comment-id="15346113" data-ismarkdown="true" ><p><a href="https://hg.mozilla.org/releases/comm-esr78/rev/f29328195e9166a13653ba4862a96cd2a7e38a16" rel="nofollow">https://hg.mozilla.org/releases/comm-esr78/rev/f29328195e9166a13653ba4862a96cd2a7e38a16</a><br>
78.9.1</p>
</div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_thunderbird_esr78&amp;o1=isnotempty">status-thunderbird_esr78</a>:
          <a href="/buglist.cgi?f1=cf_status_thunderbird_esr78&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_thunderbird_esr78&amp;o1=equals&amp;v1=fixed">fixed</a></div></div></div><div class="change-set" id="c22"><div class="comment" data-id="15349604" data-no="22"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-22" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a12808472_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a12808472_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-22"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-22" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1673240#c22">Comment 22</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-04-07 11:07 PDT" data-time="1617818856">7 months ago</span>
          </div>&bull;
<div class="change-revisions">
  <a href="/page.cgi?id=comment-revisions.html&amp;bug_id=1673240&amp;comment_id=15349604"
     title="1 revision">Edited</a>
</div>
        </td>
      </tr>

      <tr id="ctag-22">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-22" data-comment-id="15349604" data-ismarkdown="true" ><p>Suggested CVE text:</p>
<pre><code>CVE-??:
     title: An attacker may use Thunderbird&#39;s OpenPGP key refresh mechanism to
poison an existing key
     impact: moderate
     reporter: Cure53
     description: |
       If a Thunderbird user has previously imported Alice&#39;s OpenPGP key, and
Alice has extended the validity period of her key, but Alice&#39;s updated key has
not yet been imported, an attacker may send an email containing a crafted
version of Alice&#39;s key with an invalid subkey, Thunderbird might subsequently
attempt to use the invalid subkey, and will fail to send encrypted email to
Alice.
     bugs:
       - url: 1673240
</code></pre>
<p>Note we still allow the automatic import, but the invalid key details will no longer result in DoS.</p>
<p>Edit: fixed the bug number</p>
</div></div><div class="change-set" id="a14193191_578488"><div class="change" id="aa14193191_578488">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_578488" id="a14193191_578488"><img src="https://secure.gravatar.com/avatar/6822db445808be789b12cfae22d118dc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_578488" id="a14193191_578488"><a class="email " href="/user_profile?user_id=578488" > <span class="fna">Tom Ritter [:tjr] (ni? for response to CVE/sec-approval/advisories/etc)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a14193191_578488"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a14193191_578488">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1673240#a14193191_578488">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-04-07 11:58 PDT" data-time="1617821899">7 months ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Alias: CVE-2021-23991</div></div></div><div class="change-set" id="c23"><div class="comment" data-id="15357103" data-no="23"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-23" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a14193191_578488"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a14193191_578488"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-23"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-23" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1673240#c23">Comment 23</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-04-12 08:59 PDT" data-time="1618243145">7 months ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-23">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-23" data-comment-id="15357103" data-ismarkdown="true" ><p>Comment on <span class=""><a href="/attachment.cgi?id=9210693" name="attach_9210693" title="Bug 1673240 - Add tests using test keys contributed by Neal Walfield. r=mkmelin">attachment 9210693</a> <a href="/attachment.cgi?id=9210693&amp;action=edit" title="Bug 1673240 - Add tests using test keys contributed by Neal Walfield. r=mkmelin">[details]</a></span><br>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1673240" title="RESOLVED FIXED - RNP-01-014 WP1 Thunderbird: Key manipulation via uncertified Auto-Import (Medium)">Bug 1673240</a> - Add tests using test keys contributed by Neal Walfield. r=mkmelin</p>
<p>tests only</p>
</div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9210693&amp;action=edit"
           title="Bug 1673240 - Add tests using test keys contributed by Neal Walfield. r=mkmelin"
           class=""
        >Attachment #9210693</a> -
        Flags: approval-comm-esr78?</div></div></div><div class="change-set" id="c24"><div class="comment" data-id="15357106" data-no="24"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-24" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a14193191_578488"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a14193191_578488"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-24"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-24" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1673240#c24">Comment 24</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-04-12 08:59 PDT" data-time="1618243184">7 months ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-24">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-24" data-comment-id="15357106" data-ismarkdown="true" ><p>tests landed into c-c:<br>
<a href="https://hg.mozilla.org/comm-central/rev/5d9bce96055f4c4bca69ec574c1597e71280b4c4" rel="nofollow">https://hg.mozilla.org/comm-central/rev/5d9bce96055f4c4bca69ec574c1597e71280b4c4</a></p>
</div></div><div class="change-set" id="c25"><div class="comment" data-id="15362035" data-no="25"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-25" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_29811" id="a14193191_578488"><img src="https://secure.gravatar.com/avatar/20697ca69672a5276f24a34382a1ddbd?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_29811" id="a14193191_578488"><a class="email " href="/user_profile?user_id=29811" > <span class="fna">Wayne Mery (:wsmwk)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-25"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-25" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1673240#c25">Comment 25</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-04-14 17:40 PDT" data-time="1618447221">7 months ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-25">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-25" data-comment-id="15362035" data-ismarkdown="true" ><p>Comment on <span class=""><a href="/attachment.cgi?id=9210693" name="attach_9210693" title="Bug 1673240 - Add tests using test keys contributed by Neal Walfield. r=mkmelin">attachment 9210693</a> <a href="/attachment.cgi?id=9210693&amp;action=edit" title="Bug 1673240 - Add tests using test keys contributed by Neal Walfield. r=mkmelin">[details]</a></span><br>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1673240" title="RESOLVED FIXED - RNP-01-014 WP1 Thunderbird: Key manipulation via uncertified Auto-Import (Medium)">Bug 1673240</a> - Add tests using test keys contributed by Neal Walfield. r=mkmelin</p>
<p>[Triage Comment]<br>
Approved for esr78</p>
</div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9210693&amp;action=edit"
           title="Bug 1673240 - Add tests using test keys contributed by Neal Walfield. r=mkmelin"
           class=""
        >Attachment #9210693</a> -
        Flags: approval-comm-esr78? &rarr; approval-comm-esr78+</div></div></div><div class="change-set" id="c26"><div class="comment" data-id="15362530" data-no="26"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-26" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a14193191_578488"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a14193191_578488"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-26"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-26" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1673240#c26">Comment 26</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-04-15 02:03 PDT" data-time="1618477410">7 months ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-26">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-26" data-comment-id="15362530" data-ismarkdown="true" ><p>tests landed into 78.10<br>
<a href="https://hg.mozilla.org/releases/comm-esr78/rev/d25b83da0e46e61f20a149ffe0445cd9899067be" rel="nofollow">https://hg.mozilla.org/releases/comm-esr78/rev/d25b83da0e46e61f20a149ffe0445cd9899067be</a></p>
</div></div><div class="change-set" id="c27"><div class="comment" data-id="15362886" data-no="27"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-27" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_651911" id="a14193191_578488"><img src="https://secure.gravatar.com/avatar/83e0634dbf0811cffe4f5998688d730a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_651911" id="a14193191_578488"><a class="email " href="/user_profile?user_id=651911" > <span class="fna">neal</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-27"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-27" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1673240#c27">Comment 27</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-04-15 05:28 PDT" data-time="1618489697">7 months ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-27">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-27" data-comment-id="15362886" data-ismarkdown="true" ><p>I&#39;ve read this a few times now and, like Kai, I&#39;m having trouble understanding the issue.  I apologize for what may appear as nits, but in a discussion like this it is important to be precise and use accepted terminology.</p>
<p>(In reply to Wayne Mery (:wsmwk) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1673240#c0" title="RESOLVED FIXED - RNP-01-014 WP1 Thunderbird: Key manipulation via uncertified Auto-Import (Medium)">comment #0</a>)</p>
<blockquote>
<p>It was found that Thunderbird allows importing primary keys and subkeys that are not bound to a valid cryptographically secure signature.</p>
</blockquote>
<p>What does this mean?  In OpenPGP primary keys and subkeys are not bound to signatures.  A signature binds a component (e.g., a subkey or a User ID) to the primary key.  Slightly simplified, a certificate is a primary key (which solely determines the certificate&#39;s fingerprint), binding signatures made by the primary key, and components for which there are valid binding signatures made by the primary key. The validity of a primary key is determined by the trust model (web of trust, direct trust, TB&#39;s &quot;key acceptance&quot;).  The validity of a component is derived from any signatures that the primary key makes over the component; the primary key is the certificate&#39;s trust root.  In other words, if there is a valid binding signature over a subkey made by the primary key, the subkey is <em>de jure</em> associated with the primary key; a signature is the sufficient and necessary proof that the entity that controls the key (certificate plus secret key material) wants the component to be part of the certificate.</p>
<p>Note: subkeys cannot stand alone.</p>
<blockquote>
<p>Additionally, Thunderbird automatically imports detected, attached PGP primary keys with an already trusted fingerprint, as it has an extended expiry time. This introduces the risk of attackers obtaining a primary key with an extended or unset expiry time of a trusted person, while it has not yet been imported into the PGP key ring of the victim.</p>
</blockquote>
<p>I don&#39;t understand what is being claimed here :/.</p>
<p>Why is the primary important here: &quot;PGP primary keys&quot;?  Is the implication that Thunderbird is ignoring the rest of the certificate?</p>
<p>What is a trusted fingerprint?  I think what is meant is an authenticated certificate.</p>
<p>What does it mean to have an extended expiry time?  Some component has a new binding signature, whose expiration time has been extended?</p>
<p>What does &quot;while it has not yet been imported&quot; mean?</p>
<p>It sounds like: &quot;Thunderbird automatically imports certificates under certain conditions.  An attacker may automatically import a new version of the certificate, and a victim may not.&quot;  Please confirm or correct my understanding.  If I understood correctly, what&#39;s the risk there?</p>
<blockquote>
<p>The attackers can abuse this by adding a malicious subkey, which has been used by Thunderbird for email encryption, signature verification and key certification.</p>
</blockquote>
<p>Guessing again: &quot;An attacker can add an invalid subkey to a certificate, and the victim&#39;s Thunderbird may import it, and use it&quot;</p>
<blockquote>
<p>Although the subkey is flagged as invalid by RNP, it is silently accepted and imported by Thunderbird as soon as the user opens the attacker’s mail.</p>
</blockquote>
<p>Subkeys are not independent objects.  If a subkey is not bound to a primary key via a valid binding signature, then the OpenPGP implementation should ignore it.  If it doesn&#39;t, then the OpenPGP implementation is broken.</p>
<p>Justus reported this to RNP on July 13, 2018:</p>
<blockquote>
<p>Critical vulnerability in RNP, Ribose&#39;s fork of Netpgp.</p>
<h2>Overview</h2>
<p>RNP fails to validate subkey bindings, allowing malicious parties to<br>
add or replace subkeys, even if the authenticity of the key is<br>
verified by comparing fingerprints, or other means like the web of<br>
trust. This allows an attacker that is able to control a victims<br>
network traffic to read messages encrypted using RNP.</p>
<h2>Impact</h2>
<p>OpenPGP implementations need to aquire the transferable public key<br>
(TPK) of the peers one wants to communicate with. This happens when<br>
establishing a new peer, and periodically to refresh ones copy of the<br>
TPK to get new keys, certificates, or revocations.</p>
<p>If an attacker controlling the victims network traffic is able to<br>
modify the TPK in flight. Due to the missing signature verification,<br>
she can replace the encryption subkey present in the TPK with her own.</p>
<p>Key verification, like comparing key fingerprints, is ineffective<br>
because it is done on the primary key, which is not changed.</p>
<p>If the victim now encrypts a message using the attackers encryption<br>
key, the attacker can intercept the message, read it, re-encrypt it<br>
with the original encryption key, and send it to the intended<br>
recipient. The confidentiality of the message has been compromised.</p>
<p>Like subkey bindings, the following signatures are likely also<br>
affected: user-id bindings, user-attribute bindings, revocations of<br>
any kind.</p>
</blockquote>
<p>Ronald acknowledged the issue and indicated that they would fix it by the end of the week.  As far as I know, a report about the vulnerability was never published.</p>
<p>Anyway, that RNP flags a subkey as invalid is good.  That Thunderbird has to check if the subkey is valid before using it is deeply dangerous.  A context that requires a key should only accept a valid key.  Or, in the very least, be opt-in instead of opt-out.</p>
<p>Thunderbird <em>should</em> aggressively import certificates.  It should be up to the OpenPGP implementation, in this case RNP, to authenticate the components using the primary key as the trust anchor.</p>
<p>Thunderbird should <em>not</em> treat the keyring as a curated keyring; it is a cache.  If a binding between an identifier (email) and a certificate can be authenticated by the trust model, then the certificate should be used.  Otherwise, it should be ignored.</p>
<blockquote>
<p>It is advised that the validity of the PGP keys returned from the RNP library is respected by Thunderbird and actions ensue accordingly.</p>
</blockquote>
<p>If RNP exposes invalid subkeys to Thunderbird, then it is indeed Thunderbird&#39;s responsibility to add a check that they are valid before using them.  But, I don&#39;t see what that has to do with importing invalid components, and why that is risky, or what expiry has to do with any of this.</p>
<blockquote>
<p>Additionally, Cure53 recommends for trusted primary keys not getting automatically imported. Instead, the user should be informed and asked about importing the new key. It is crucial to alert the user about every new subkey and user-identity which is about to be newly trusted.</p>
</blockquote>
<p>This is horribly, horribly wrong.  Do not ask the user about importing new certificates.  Subkeys and User IDs are authenticated via binding signatures.  The user cannot make an informed choice.  Do not make the OpenPGP support less usable then it already is.</p>
<p>Finally, it&#39;s disappointing that no proof of concept was provided.</p>
</div></div><div class="change-set" id="c28"><div class="comment" data-id="15362942" data-no="28"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-28" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_651911" id="a14193191_578488"><img src="https://secure.gravatar.com/avatar/83e0634dbf0811cffe4f5998688d730a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_651911" id="a14193191_578488"><a class="email " href="/user_profile?user_id=651911" > <span class="fna">neal</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-28"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-28" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1673240#c28">Comment 28</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-04-15 05:56 PDT" data-time="1618491409">7 months ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-28">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-28" data-comment-id="15362942" data-ismarkdown="true" ><p>(In reply to Kai Engert (:KaiE:) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1673240#c7" title="RESOLVED FIXED - RNP-01-014 WP1 Thunderbird: Key manipulation via uncertified Auto-Import (Medium)">comment #7</a>)</p>
<blockquote>
<p>Regarding user IDs, I think TB should completely ignore user IDs that don&#39;t pass signature checks.</p>
</blockquote>
<p>This depends on the context.</p>
<p>If you are going to use a User ID in a security-relevant context (pretty much all contexts that matter to users!), the only User IDs that are relevant are those that are authenticated.  Interestingly, this normally has <em>nothing</em> to do with whether a User ID also has a self signature.  Let me repeat that: a self-signed User ID is not more or less authenticated that a User ID that is not self signed.  Consider.  Let&#39;s assume that I&#39;m using a CA as a trust anchor.  If that CA certifies the binding between the User ID &quot;&lt;<a href="mailto:alice@example.org" rel="nofollow">alice@example.org</a>&gt;&quot; and certificate 0xABCD, then that is what I care about; &quot;&lt;<a href="mailto:alice@example.org" rel="nofollow">alice@example.org</a>&gt;&quot; is authenticated for 0xABCD. The certificate doesn&#39;t even need to have a self signature for that User ID!  This is perhaps surprising, because current tooling gives an elevated status to self signed User IDs.  But, that is primarily due to a deeper problem: the available authentication mechanisms are inadequate not only in Thunderbird, but also in the broader ecosystem.</p>
<p>There are two places in Thunderbird where it makes sense to show self-signed User IDs and not User IDs that are not self signed.  First, when accepting a certificate, it makes sense to provide the self-signed user ids as a suggestion similar to how Android&#39;s address book uses the name field of a vcard as the suggested contact&#39;s name.  Second, the keyring manager is a low-level tool, which lists all of the keys in the local cache.  If an authenticated User ID is not available for a certificate, it should display: &quot;Allegedly: Self-signed User ID&quot;.</p>
<p>Well, we&#39;re not there.  So, yes, today, Thunderbird should only show self signed User IDs.</p>
<blockquote>
<p>However, in its key management user interface, TB wants to show the user ID of an expired key. This can allow the user to identify an expired key, select it, and request to extend the expiration.</p>
<p>This means, I need to be able to ask RNP: Is time the only reason why the user ID is invalid? Does the user ID pass all other validity checks?</p>
</blockquote>
<p>This is spot on and identifies an important issue that the RNP API overlooks again and again: context is essential.  See also <a href="https://github.com/rnpgp/rnp/issues/1483" rel="nofollow">this bug report</a>.</p>
<blockquote>
<p>rnp_uid_is_valid doesn&#39;t answer this question.</p>
<p>If TB hides all user IDs that rnp_uid_is_valid describes as invalid, then the user interface cannot show any user ID for expired keys - which makes it difficult for the user to identify a key that they might want to extend.</p>
</blockquote>
<p>Interestingly, we also want to show revoked keys.  Say I have an old key, which I&#39;ve revoked.  I still want to be able to use it to decrypt messages.  Or, say a certificate has been soft revoked (e.g., retired), and I want to check a signature.  That should still be possible.</p>
<blockquote>
<p>For subkeys, you are offering rnp_key_valid_till. I think this provides the answer I need for subkeys. If the timestamp returned by rnp_key_valid_till is nonzero, then in my understanding, the subkey passes all signature checks.</p>
</blockquote>
<p>Unfortunately I don&#39;t think it does.  See the referenced bug.</p>
</div></div><div class="change-set" id="c29"><div class="comment" data-id="15362951" data-no="29"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-29" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_651911" id="a14193191_578488"><img src="https://secure.gravatar.com/avatar/83e0634dbf0811cffe4f5998688d730a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_651911" id="a14193191_578488"><a class="email " href="/user_profile?user_id=651911" > <span class="fna">neal</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-29"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-29" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1673240#c29">Comment 29</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-04-15 06:01 PDT" data-time="1618491682">7 months ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-29">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-29" data-comment-id="15362951" data-ismarkdown="true" ><p>(In reply to Nickolay Olshevsky from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1673240#c10" title="RESOLVED FIXED - RNP-01-014 WP1 Thunderbird: Key manipulation via uncertified Auto-Import (Medium)">comment #10</a>)</p>
<blockquote>
<p>Yeah, sorry, forgot to mention this in the first comment. If there are no valid signatures on the uid, primary flag is dropped.</p>
</blockquote>
<p>This is unfortunate.  A certificate should always have exactly one primary User ID unless there are no self-signed User IDs.  If all self signed User IDs are revoked or expired, then a revoked or expired User ID should be used.  This is important, because the Primary User IDs self signature provides information about the primary key and certificate, e.g., key expiration, key flags, etc.</p>
</div></div><div class="change-set" id="a19628279_29811"><div class="change" id="aa19628279_29811">
    <table class="layout-table change-head reporter" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_29811" id="a19628279_29811"><img src="https://secure.gravatar.com/avatar/20697ca69672a5276f24a34382a1ddbd?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_29811" id="a19628279_29811"><a class="email " href="/user_profile?user_id=29811" > <span class="fna">Wayne Mery (:wsmwk)</span></a>
</div>
            <span class="user-role">Reporter</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a19628279_29811"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a19628279_29811">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1673240#a19628279_29811">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-06-09 09:43 PDT" data-time="1623256987">5 months ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: <span class="activity-deleted">mail-core-security</span></div></div></div><div class="change-set" id="c30"><div class="comment" data-id="15443278" data-no="30"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-30" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_617804" id="a19628279_29811"><img src="https://secure.gravatar.com/avatar/c303053dd50e573c4c5a5629b0bf1b36?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_617804" id="a19628279_29811"><a class="email " href="/user_profile?user_id=617804" > <span class="fna">Arvidt</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-30"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-30" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1673240#c30">Comment 30</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-06-10 04:00 PDT" data-time="1623322814">5 months ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-30">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-30" data-comment-id="15443278" data-ismarkdown="true" ><p>(In reply to neal from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1673240#c27" title="RESOLVED FIXED - RNP-01-014 WP1 Thunderbird: Key manipulation via uncertified Auto-Import (Medium)">comment #27</a>)</p>
<blockquote>
<p>This is horribly, horribly wrong.  Do not ask the user about importing new certificates.  Subkeys and User IDs are authenticated via binding signatures.  The user cannot make an informed choice.  Do not make the OpenPGP support less usable then it already is.</p>
</blockquote>
<p>That&#39;s what I thought, too, when reading the Cure53 report.</p>
</div></div><div id="new-comment-notice">
          You need to <a href="/show_bug.cgi?id=1673240&amp;GoAheadAndLogIn=1">log in</a>
          before you can comment on or make changes to this bug.
        </div>



<div id="bottom-actions">
  <div id="bottom-right-actions">
    <button type="button" id="top-btn" class="secondary" aria-label="Go to Page Top">Top &uarr;</button>
  </div>
</div></div> 
</main> 
</div> 


</body>
</html>