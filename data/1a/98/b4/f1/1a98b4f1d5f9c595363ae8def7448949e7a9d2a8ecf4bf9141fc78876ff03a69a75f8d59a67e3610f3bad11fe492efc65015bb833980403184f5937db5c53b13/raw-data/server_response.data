<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
<link rel="icon" href="/favicon.png">
<title>#596397 - CVE-2010-3293: local users may prevent virus signatures from being updated - Debian Bug report logs</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="/css/bugs.css" type="text/css">

<link rel="canonical" href="&lt;a href=&quot;bugreport.cgi?bug=596397&quot;&gt;596397&lt;/a&gt;">
<script type="text/javascript">
<!--
function toggle_infmessages()
{
        allDivs=document.getElementsByTagName("div");
        for (var i = 0 ; i < allDivs.length ; i++ )
        {
                if (allDivs[i].className == "infmessage")
                {
                        allDivs[i].style.display=(allDivs[i].style.display == 'none' | allDivs[i].style.display == '') ? 'block' : 'none';
                }
        }
}
-->
</script>
</head>
<body>
<h1>Debian Bug report logs - 
<a href="mailto:596397@bugs.debian.org">#596397</a><br>
CVE-2010-3293: local users may prevent virus signatures from being updated</h1>
<div class="versiongraph"><a href="version.cgi?collapse=1;fixed=4.79.11-2.2%2Brm;found=mailscanner%2F4.79.11-2;absolute=0;package=mailscanner;info=1"><img alt="version graph" src="version.cgi?found=mailscanner%2F4.79.11-2;fixed=4.79.11-2.2%2Brm;height=2;collapse=1;package=mailscanner;width=2;absolute=0"></a></div>
<div class="pkginfo">
  <p>Package:
     <a class="submitter" href="pkgreport.cgi?package=mailscanner">mailscanner</a>;
Maintainer for <a href="pkgreport.cgi?package=mailscanner">mailscanner</a> is <a href="pkgreport.cgi?maint=">(unknown)</a>; </p>

</div>

<div class="buginfo">
  <p>Reported by: <a href="pkgreport.cgi?submitter=geissert%40debian.org">Raphael Geissert &lt;geissert@debian.org&gt;</a></p>
  <p>Date: Sat, 11 Sep 2010 00:39:04 UTC</p>

<p>Severity: important</p>
<p>Tags: security</p>
<p>Merged with <a href="bugreport.cgi?bug=596398">596398</a>,
<a href="bugreport.cgi?bug=596399">596399</a>,
<a href="bugreport.cgi?bug=596400">596400</a></p>

<p>Found in version mailscanner/4.79.11-2</p>
<p>Fixed in version 4.79.11-2.2+rm</p>

<p><strong>Done:</strong> Debian FTP Masters &lt;ftpmaster@ftp-master.debian.org&gt;</p>

<p>Bug is archived. No further changes may be made.<p></div>

<p><a href="javascript:toggle_infmessages();">Toggle useless messages</a></p><div class="msgreceived"><p>View this report as an <a href="bugreport.cgi?bug=596397;mbox=yes">mbox folder</a>, <a href="bugreport.cgi?bug=596397;mbox=yes;mboxstatus=yes">status mbox</a>, <a href="bugreport.cgi?bug=596397;mbox=yes;mboxmaint=yes">maintainer mbox</a></p></div>

<div class="infmessage"><hr><p>
<a name="1"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Simon Walter &lt;simon.walter@hp-factory.de&gt; -->
<!-- time:1284165547 -->
<strong>Report forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Simon Walter &lt;simon.walter@hp-factory.de&gt;</code>:<br>
<code>Bug#596397</code>; Package <code>mailscanner</code>.
 (Sat, 11 Sep 2010 00:39:07 GMT) (<a href="bugreport.cgi?bug=596397;msg=2">full text</a>, <a href="bugreport.cgi?bug=596397;mbox=yes;msg=2">mbox</a>, <a href="#1">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="3"></a><a name="msg3"></a><a href="#3">Message #3</a> received at submit@bugs.debian.org (<a href="bugreport.cgi?bug=596397;msg=3">full text</a>, <a href="bugreport.cgi?bug=596397;mbox=yes;msg=3">mbox</a>, <a href="mailto:596397@bugs.debian.org?In-Reply-To=%3C201009101936.50225.geissert%40debian.org%3E&amp;References=%3C201009101936.50225.geissert%40debian.org%3E&amp;body=On%20Fri%2C%2010%20Sep%202010%2019%3A36%3A49%20-0500%20Raphael%20Geissert%20%3Cgeissert%40debian.org%3E%20wrote%3A%0A%3E%20Package%3A%20mailscanner%0A%3E%20Version%3A%204.79.11-2%0A%3E%20Severity%3A%20important%0A%3E%20Tags%3A%20security%0A%3E%20%0A%3E%20Hi%2C%0A%3E%20%0A%3E%20update_virus_scanners%20uses%20%2Ftmp%2FMailScanner.autoupdate.lock%20as%20lockfile%20and%20%0A%3E%20exits%20without%20doing%20anything%20if%20it%20is%20a%20file%20%28not%20a%20symlink%29%20and%20has%20recently%20%0A%3E%20been%20modified%20%28according%20to%20mtime.%29%0A%3E%20This%20check%20can%20be%20potentially%20abused%20by%20local%20users%20to%20prevent%20the%20signatures%20%0A%3E%20from%20being%20updated%20by%20continuously%20%28re-%29creating%20and%2For%20updating%20the%20mtime%20of%20%0A%3E%20that%20file.%0A%3E%20%0A%3E%20Cheers%2C%0A%3E%20--%20%0A%3E%20Raphael%20Geissert%20-%20Debian%20Developer%0A%3E%20www.debian.org%20-%20get.debian.net%0A%3E%20%0A%3E%20%0A%3E%20%0A&amp;subject=Re%3A%20mailscanner%3A%20local%20users%20may%20prevent%20virus%20signatures%20from%20being%20updated">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=geissert%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Raphael Geissert &lt;geissert@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> submit@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> mailscanner: local users may prevent virus signatures from being updated</div>
<div class="header"><span class="headerfield">Date:</span> Fri, 10 Sep 2010 19:36:49 -0500</div>
</div>
<pre class="message">Package: mailscanner
Version: 4.79.11-2
Severity: important
Tags: security

Hi,

update_virus_scanners uses /tmp/MailScanner.autoupdate.lock as lockfile and 
exits without doing anything if it is a file (not a symlink) and has recently 
been modified (according to mtime.)
This check can be potentially abused by local users to prevent the signatures 
from being updated by continuously (re-)creating and/or updating the mtime of 
that file.

Cheers,
-- 
Raphael Geissert - Debian Developer
www.debian.org - get.debian.net



</pre>

<div class="msgreceived"><hr><p>
<a name="4"></a>
<!-- requester: Raphael Geissert &lt;geissert@debian.org&gt; -->
<!-- request_addr: control@bugs.debian.org -->
<!-- time:1284222789 -->
<strong>Merged <a href="bugreport.cgi?bug=596397">596397</a> <a href="bugreport.cgi?bug=596398">596398</a> <a href="bugreport.cgi?bug=596399">596399</a> <a href="bugreport.cgi?bug=596400">596400</a>.</strong>
Request was from <code>Raphael Geissert &lt;geissert@debian.org&gt;</code>
to <code>control@bugs.debian.org</code>.
 (Sat, 11 Sep 2010 16:33:09 GMT) (<a href="bugreport.cgi?bug=596397;msg=5">full text</a>, <a href="bugreport.cgi?bug=596397;mbox=yes;msg=5">mbox</a>, <a href="#4">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="6"></a>
<!-- command:title -->
<!-- requester: Raphael Geissert &lt;geissert@debian.org&gt; -->
<!-- request_addr: control@bugs.debian.org -->
<!-- time:1284663603 -->
<!-- new_data:
$new_data = {
              &#39;subject&#39; =&gt; &#39;CVE-2010-3293: local users may prevent virus signatures from being updated&#39;
            };
-->
<!-- old_data:
$old_data = {
              &#39;subject&#39; =&gt; &#39;mailscanner: local users may prevent virus signatures from being updated&#39;
            };
-->
<strong>Changed Bug title to &#39;CVE-2010-3293: local users may prevent virus signatures from being updated&#39; from &#39;mailscanner: local users may prevent virus signatures from being updated&#39;</strong>
Request was from <code>Raphael Geissert &lt;geissert@debian.org&gt;</code>
to <code>control@bugs.debian.org</code>.
 (Thu, 16 Sep 2010 19:00:03 GMT) (<a href="bugreport.cgi?bug=596397;msg=7">full text</a>, <a href="bugreport.cgi?bug=596397;mbox=yes;msg=7">mbox</a>, <a href="#6">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="8"></a>
<!-- request_addr: Debian FTP Masters &lt;ftpmaster@ftp-master.debian.org&gt; -->
<!-- time:1298803011 -->
<strong>Reply sent</strong>
to <code>Debian FTP Masters &lt;ftpmaster@ftp-master.debian.org&gt;</code>:<br>
You have taken responsibility.
 (Sun, 27 Feb 2011 10:36:51 GMT) (<a href="bugreport.cgi?bug=596397;msg=9">full text</a>, <a href="bugreport.cgi?bug=596397;mbox=yes;msg=9">mbox</a>, <a href="#8">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="10"></a>
<!-- request_addr: Raphael Geissert &lt;geissert@debian.org&gt; -->
<!-- time:1298803011 -->
<strong>Notification sent</strong>
to <code>Raphael Geissert &lt;geissert@debian.org&gt;</code>:<br>
Bug acknowledged by developer.
 (Sun, 27 Feb 2011 10:36:51 GMT) (<a href="bugreport.cgi?bug=596397;msg=11">full text</a>, <a href="bugreport.cgi?bug=596397;mbox=yes;msg=11">mbox</a>, <a href="#10">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="12"></a><a name="msg12"></a><a href="#12">Message #12</a> received at 596397-done@bugs.debian.org (<a href="bugreport.cgi?bug=596397;msg=12">full text</a>, <a href="bugreport.cgi?bug=596397;mbox=yes;msg=12">mbox</a>, <a href="mailto:596397@bugs.debian.org?In-Reply-To=%3CE1Ptdwg-0003Wu-8A%40franck.debian.org%3E&amp;References=%3CE1Ptdwg-0003Wu-8A%40franck.debian.org%3E&amp;body=On%20Sun%2C%2027%20Feb%202011%2010%3A33%3A46%20%2B0000%20Debian%20FTP%20Masters%20%3Cftpmaster%40ftp-master.debian.org%3E%20wrote%3A%0A%3E%20Version%3A%204.79.11-2.2%2Brm%0A%3E%20%0A%3E%20Dear%20submitter%2C%0A%3E%20%0A%3E%20as%20the%20package%20mailscanner%20has%20just%20been%20removed%20from%20the%20Debian%20archive%0A%3E%20unstable%20we%20hereby%20close%20the%20associated%20bug%20reports.%20%20We%20are%20sorry%0A%3E%20that%20we%20couldn%27t%20deal%20with%20your%20issue%20properly.%0A%3E%20%0A%3E%20For%20details%20on%20the%20removal%2C%20please%20see%20http%3A%2F%2Fbugs.debian.org%2F531317%0A%3E%20%0A%3E%20The%20version%20of%20this%20package%20that%20was%20in%20Debian%20prior%20to%20this%20removal%0A%3E%20can%20still%20be%20found%20using%20http%3A%2F%2Fsnapshot.debian.org%2F.%0A%3E%20%0A%3E%20This%20message%20was%20generated%20automatically%3B%20if%20you%20believe%20that%20there%20is%0A%3E%20a%20problem%20with%20it%20please%20contact%20the%20archive%20administrators%20by%20mailing%0A%3E%20ftpmaster%40debian.org.%0A%3E%20%0A%3E%20Debian%20distribution%20maintenance%20software%0A%3E%20pp.%0A%3E%20Alexander%20Reichle-Schmehl%20%28the%20ftpmaster%20behind%20the%20curtain%29%0A%3E%20%0A%3E%20%0A%3E%20%0A&amp;subject=Re%3A%20Bug%23531317%3A%20Removed%20package%28s%29%20from%20unstable">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=ftpmaster%40ftp-master.debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Debian FTP Masters &lt;ftpmaster@ftp-master.debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> 303929-done@bugs.debian.org,313145-done@bugs.debian.org,353266-done@bugs.debian.org,408161-done@bugs.debian.org,410647-done@bugs.debian.org,490948-done@bugs.debian.org,506148-done@bugs.debian.org,577916-done@bugs.debian.org,583527-done@bugs.debian.org,595945-done@bugs.debian.org,596396-done@bugs.debian.org,596397-done@bugs.debian.org,596398-done@bugs.debian.org,596399-done@bugs.debian.org,596400-done@bugs.debian.org,596510-done@bugs.debian.org,596512-done@bugs.debian.org,596514-done@bugs.debian.org,597611-done@bugs.debian.org,598726-done@bugs.debian.org,605869-done@bugs.debian.org,607226-done@bugs.debian.org,607747-done@bugs.debian.org,608337-done@bugs.debian.org,</div>
<div class="header"><span class="headerfield">Cc:</span> mailscanner@packages.debian.org, mailscanner@packages.qa.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Bug#531317: Removed package(s) from unstable</div>
<div class="header"><span class="headerfield">Date:</span> Sun, 27 Feb 2011 10:33:46 +0000</div>
</div>
<pre class="message">Version: 4.79.11-2.2+rm

Dear submitter,

as the package mailscanner has just been removed from the Debian archive
unstable we hereby close the associated bug reports.  We are sorry
that we couldn&#39;t deal with your issue properly.

For details on the removal, please see <a href="http://bugs.debian.org/531317">http://bugs.debian.org/531317</a>

The version of this package that was in Debian prior to this removal
can still be found using <a href="http://snapshot.debian.org/">http://snapshot.debian.org/</a>.

This message was generated automatically; if you believe that there is
a problem with it please contact the archive administrators by mailing
ftpmaster@debian.org.

Debian distribution maintenance software
pp.
Alexander Reichle-Schmehl (the ftpmaster behind the curtain)



</pre>

<div class="msgreceived"><hr><p>
<a name="13"></a>
<!-- request_addr: Debian FTP Masters &lt;ftpmaster@ftp-master.debian.org&gt; -->
<!-- time:1298803012 -->
<strong>Reply sent</strong>
to <code>Debian FTP Masters &lt;ftpmaster@ftp-master.debian.org&gt;</code>:<br>
You have taken responsibility.
 (Sun, 27 Feb 2011 10:36:52 GMT) (<a href="bugreport.cgi?bug=596397;msg=14">full text</a>, <a href="bugreport.cgi?bug=596397;mbox=yes;msg=14">mbox</a>, <a href="#13">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="15"></a>
<!-- request_addr: Raphael Geissert &lt;geissert@debian.org&gt; -->
<!-- time:1298803012 -->
<strong>Notification sent</strong>
to <code>Raphael Geissert &lt;geissert@debian.org&gt;</code>:<br>
Bug acknowledged by developer.
 (Sun, 27 Feb 2011 10:36:52 GMT) (<a href="bugreport.cgi?bug=596397;msg=16">full text</a>, <a href="bugreport.cgi?bug=596397;mbox=yes;msg=16">mbox</a>, <a href="#15">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="18"></a>
<!-- request_addr: Debian FTP Masters &lt;ftpmaster@ftp-master.debian.org&gt; -->
<!-- time:1298803013 -->
<strong>Reply sent</strong>
to <code>Debian FTP Masters &lt;ftpmaster@ftp-master.debian.org&gt;</code>:<br>
You have taken responsibility.
 (Sun, 27 Feb 2011 10:36:53 GMT) (<a href="bugreport.cgi?bug=596397;msg=19">full text</a>, <a href="bugreport.cgi?bug=596397;mbox=yes;msg=19">mbox</a>, <a href="#18">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="20"></a>
<!-- request_addr: Raphael Geissert &lt;geissert@debian.org&gt; -->
<!-- time:1298803013 -->
<strong>Notification sent</strong>
to <code>Raphael Geissert &lt;geissert@debian.org&gt;</code>:<br>
Bug acknowledged by developer.
 (Sun, 27 Feb 2011 10:36:53 GMT) (<a href="bugreport.cgi?bug=596397;msg=21">full text</a>, <a href="bugreport.cgi?bug=596397;mbox=yes;msg=21">mbox</a>, <a href="#20">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="23"></a>
<!-- request_addr: Debian FTP Masters &lt;ftpmaster@ftp-master.debian.org&gt; -->
<!-- time:1298803014 -->
<strong>Reply sent</strong>
to <code>Debian FTP Masters &lt;ftpmaster@ftp-master.debian.org&gt;</code>:<br>
You have taken responsibility.
 (Sun, 27 Feb 2011 10:36:54 GMT) (<a href="bugreport.cgi?bug=596397;msg=24">full text</a>, <a href="bugreport.cgi?bug=596397;mbox=yes;msg=24">mbox</a>, <a href="#23">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="25"></a>
<!-- request_addr: Raphael Geissert &lt;geissert@debian.org&gt; -->
<!-- time:1298803014 -->
<strong>Notification sent</strong>
to <code>Raphael Geissert &lt;geissert@debian.org&gt;</code>:<br>
Bug acknowledged by developer.
 (Sun, 27 Feb 2011 10:36:54 GMT) (<a href="bugreport.cgi?bug=596397;msg=26">full text</a>, <a href="bugreport.cgi?bug=596397;mbox=yes;msg=26">mbox</a>, <a href="#25">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="28"></a>
<!-- command:archive -->
<!-- requester: Debbugs Internal Request &lt;owner@bugs.debian.org&gt; -->
<!-- request_addr: internal_control@bugs.debian.org -->
<!-- time:1301297500 -->
<!-- new_data:
$new_data = {};
-->
<!-- old_data:
$old_data = {};
-->
<strong>Bug archived.</strong>
Request was from <code>Debbugs Internal Request &lt;owner@bugs.debian.org&gt;</code>
to <code>internal_control@bugs.debian.org</code>.
 (Mon, 28 Mar 2011 07:31:40 GMT) (<a href="bugreport.cgi?bug=596397;msg=29">full text</a>, <a href="bugreport.cgi?bug=596397;mbox=yes;msg=29">mbox</a>, <a href="#28">link</a>).</p></p></div>

<hr>
<p class="msgreceived">Send a report that <a href="https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=596397">this bug log contains spam</a>.</p>
<hr>
<ADDRESS>Debian bug tracking system administrator &lt;<A HREF="mailto:owner@bugs.debian.org">owner@bugs.debian.org</A>&gt;.
Last modified:
<!--timestamp-->Sat Oct 30 18:24:37 2021<!--end timestamp-->; 
Machine Name:
<!--machinename-->bembo<!--machinename-->
<P>
<A HREF="https://www.debian.org/Bugs/">Debian Bug tracking system</A>
</p>
<p>
  Debbugs is free software and licensed under the terms of the GNU
  Public License version 2. The current version can be obtained
  from <a href="https://bugs.debian.org/debbugs-source/">https://bugs.debian.org/debbugs-source/</a>.
</p>
<p>
Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.
</p>
</ADDRESS>

</body>
</html>
