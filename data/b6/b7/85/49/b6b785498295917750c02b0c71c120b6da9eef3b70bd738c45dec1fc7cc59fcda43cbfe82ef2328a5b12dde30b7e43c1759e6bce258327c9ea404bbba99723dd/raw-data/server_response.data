<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
<link rel="icon" href="/favicon.png">
<title>#985405 - src:shibboleth-sp: Error templates allow query-based override of variables - Debian Bug report logs</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="/css/bugs.css" type="text/css">

<link rel="canonical" href="&lt;a href=&quot;bugreport.cgi?bug=985405&quot;&gt;985405&lt;/a&gt;">
<script type="text/javascript">
<!--
function toggle_infmessages()
{
        allDivs=document.getElementsByTagName("div");
        for (var i = 0 ; i < allDivs.length ; i++ )
        {
                if (allDivs[i].className == "infmessage")
                {
                        allDivs[i].style.display=(allDivs[i].style.display == 'none' | allDivs[i].style.display == '') ? 'block' : 'none';
                }
        }
}
-->
</script>
</head>
<body>
<h1>Debian Bug report logs - 
<a href="mailto:985405@bugs.debian.org">#985405</a><br>
src:shibboleth-sp: Error templates allow query-based override of variables</h1>
<div class="versiongraph"><a href="version.cgi?info=1;absolute=0;package=src%3Ashibboleth-sp;found=shibboleth-sp%2F3.0.2%2Bdfsg1-1;collapse=1;fixed=shibboleth-sp%2F3.2.1%2Bdfsg1-1;fixed=shibboleth-sp%2F3.0.4%2Bdfsg1-1%2Bdeb10u1"><img alt="version graph" src="version.cgi?found=shibboleth-sp%2F3.0.2%2Bdfsg1-1;package=src%3Ashibboleth-sp;absolute=0;fixed=shibboleth-sp%2F3.2.1%2Bdfsg1-1;fixed=shibboleth-sp%2F3.0.4%2Bdfsg1-1%2Bdeb10u1;collapse=1;width=2;height=2"></a></div>
<div class="pkginfo">
  <p>Package:
     <a class="submitter" href="pkgreport.cgi?src=shibboleth-sp">src:shibboleth-sp</a>;
Maintainer for <a href="pkgreport.cgi?src=shibboleth-sp">src:shibboleth-sp</a> is <a href="pkgreport.cgi?maint=pkg-shibboleth-devel%40alioth-lists.debian.net">Debian Shib Team &lt;pkg-shibboleth-devel@alioth-lists.debian.net&gt;</a>; </p>

</div>

<div class="buginfo">
  <p>Reported by: <a href="pkgreport.cgi?submitter=wferi%40debian.org">Ferenc Wágner &lt;wferi@debian.org&gt;</a></p>
  <p>Date: Wed, 17 Mar 2021 15:06:01 UTC</p>

<p>Severity: <em class="severity">grave</em></p>
<p>Tags: patch, security, upstream</p>

<p>Found in version shibboleth-sp/3.0.2+dfsg1-1</p>
<p>Fixed in versions shibboleth-sp/3.2.1+dfsg1-1, shibboleth-sp/3.0.4+dfsg1-1+deb10u1</p>

<p><strong>Done:</strong> Ferenc Wágner &lt;wferi@debian.org&gt;</p>

<p>Bug is archived. No further changes may be made.<p><p>Forwarded to <a href="https://issues.shibboleth.net/jira/browse/SSPCPP-922">https://issues.shibboleth.net/jira/browse/SSPCPP-922</a></p>
</div>

<p><a href="javascript:toggle_infmessages();">Toggle useless messages</a></p><div class="msgreceived"><p>View this report as an <a href="bugreport.cgi?bug=985405;mbox=yes">mbox folder</a>, <a href="bugreport.cgi?bug=985405;mbox=yes;mboxstatus=yes">status mbox</a>, <a href="bugreport.cgi?bug=985405;mbox=yes;mboxmaint=yes">maintainer mbox</a></p></div>

<div class="infmessage"><hr><p>
<a name="1"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Debian Shib Team &lt;pkg-shibboleth-devel@alioth-lists.debian.net&gt; -->
<!-- time:1615993563 -->
<strong>Report forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Debian Shib Team &lt;pkg-shibboleth-devel@alioth-lists.debian.net&gt;</code>:<br>
<code>Bug#985405</code>; Package <code>src:shibboleth-sp</code>.
 (Wed, 17 Mar 2021 15:06:03 GMT) (<a href="bugreport.cgi?bug=985405;msg=2">full text</a>, <a href="bugreport.cgi?bug=985405;mbox=yes;msg=2">mbox</a>, <a href="#1">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="3"></a>
<!-- request_addr: Ferenc Wágner &lt;wferi@debian.org&gt; -->
<!-- time:1615993564 -->
<strong>Acknowledgement sent</strong>
to <code>Ferenc Wágner &lt;wferi@debian.org&gt;</code>:<br>
New Bug report received and forwarded.  Copy sent to <code>Debian Shib Team &lt;pkg-shibboleth-devel@alioth-lists.debian.net&gt;</code>.
 (Wed, 17 Mar 2021 15:06:04 GMT) (<a href="bugreport.cgi?bug=985405;msg=4">full text</a>, <a href="bugreport.cgi?bug=985405;mbox=yes;msg=4">mbox</a>, <a href="#3">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="5"></a><a name="msg5"></a><a href="#5">Message #5</a> received at submit@bugs.debian.org (<a href="bugreport.cgi?bug=985405;msg=5">full text</a>, <a href="bugreport.cgi?bug=985405;mbox=yes;msg=5">mbox</a>, <a href="mailto:985405@bugs.debian.org?subject=Re%3A%20src%3Ashibboleth-sp%3A%20Error%20templates%20allow%20query-based%20override%20of%20variables&amp;References=%3C161599340505.14916.11364877723341266823.reportbug%40lant.ki.iif.hu%3E&amp;In-Reply-To=%3C161599340505.14916.11364877723341266823.reportbug%40lant.ki.iif.hu%3E&amp;body=On%20Wed%2C%2017%20Mar%202021%2016%3A03%3A25%20%2B0100%20%3D%3Futf-8%3Fq%3FFerenc_W%3DC3%3DA1gner%3F%3D%20%3Cwferi%40debian.org%3E%20wrote%3A%0A%3E%20Package%3A%20src%3Ashibboleth-sp%0A%3E%20Version%3A%203.0.2%2Bdfsg1-1%0A%3E%20Severity%3A%20important%0A%3E%20Tags%3A%20upstream%20patch%20security%0A%3E%20Forwarded%3A%20https%3A%2F%2Fissues.shibboleth.net%2Fjira%2Fbrowse%2FSSPCPP-922%0A%3E%20%0A%3E%20Shibboleth%20Service%20Provider%20Security%20Advisory%20%5B17%20March%202021%5D%0A%3E%20%0A%3E%20An%20updated%20version%20of%20the%20Service%20Provider%20software%20is%20available%0A%3E%20which%20fixes%20a%20phishing%20vulnerability.%0A%3E%20%0A%3E%20Template%20generation%20allows%20external%20parameters%20to%20override%20placeholders%0A%3E%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%3E%20The%20SP%20includes%20a%20primitive%20template%20engine%20used%20to%20render%20error%20pages%0A%3E%20and%20various%20other%20status%20or%20transition%20pages%2C%20and%20it%20supports%20a%20syntax%0A%3E%20for%20embedding%20placeholders%20that%20are%20replaced%20by%20internally%20supplied%0A%3E%20values%20or%20configuration%20settings.%0A%3E%20%0A%3E%20For%20reasons%20that%20are%20unclear%20in%20the%20code%20history%2C%20it%20was%20extended%20to%0A%3E%20allow%20replacement%20via%20query%20parameters%20also%2C%20though%20this%20is%20not%20a%0A%3E%20typical%20need.%20Because%20of%20this%20feature%2C%20it%27s%20possible%20to%20cause%20the%20SP%0A%3E%20to%20display%20some%20templates%20containing%20values%20supplied%20externally%20by%0A%3E%20URL%20manipulation.%20Though%20the%20values%20are%20encoded%20to%20prevent%20script%0A%3E%20injection%2C%20the%20content%20nevertheless%20appears%20to%20come%20from%20the%20server%0A%3E%20and%20so%20would%20be%20interpreted%20as%20trustworthy%2C%20allowing%20email%20addresses%2C%0A%3E%20logos%2C%20or%20support%20URLs%20to%20be%20manipulated%20by%20an%20attacker.%0A%3E%20%0A%3E%20All%20platforms%20are%20impacted%20by%20this%20issue.%0A%3E%20%0A%3E%20%0A%3E%20Recommendations%0A%3E%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%3E%20Update%20to%20V3.2.1%20or%20later%20of%20the%20Service%20Provider%20software%2C%20which%0A%3E%20is%20now%20available.%0A%3E%20%0A%3E%20The%20update%20adds%20a%20new%20%3CErrors%3E%20setting%20to%20the%20configuration%20called%0A%3E%20externalParameters%2C%20which%20defaults%20to%20false.%20When%20false%2C%20support%20for%0A%3E%20this%20%22feature%22%20is%20disabled.%20In%20the%20unlikely%20event%20that%20a%20valid%20need%0A%3E%20for%20this%20exists%2C%20the%20setting%20can%20be%20enabled%20temporarily%20to%20maintain%0A%3E%20function%20until%20the%20use%20case%20requiring%20it%20is%20addressed%20in%20some%20other%0A%3E%20way.%0A%3E%20%0A%3E%20%0A%3E%20Other%20Notes%0A%3E%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%3E%20The%20cpp-sp%20git%20commit%20containing%20the%20fix%20for%20this%20issue%20is%0A%3E%20d1dbebfadc1bdb824fea63843c4c38fa69e54379%0A%3E%20%0A%3E%20%0A%3E%20URL%20for%20this%20Security%20Advisory%3A%0A%3E%20https%3A%2F%2Fshibboleth.net%2Fcommunity%2Fadvisories%2Fsecadv_20210317.txt%0A%3E%20%0A%3E%20%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=wferi%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Ferenc Wágner &lt;wferi@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> Debian Bug Tracking System &lt;submit@bugs.debian.org&gt;</div>
<div class="header"><span class="headerfield">Subject:</span> src:shibboleth-sp: Error templates allow query-based override of variables</div>
<div class="header"><span class="headerfield">Date:</span> Wed, 17 Mar 2021 16:03:25 +0100</div>
</div>
<pre class="message">Package: src:shibboleth-sp
Version: 3.0.2+dfsg1-1
Severity: important
Tags: upstream patch security
Forwarded: <a href="https://issues.shibboleth.net/jira/browse/SSPCPP-922">https://issues.shibboleth.net/jira/browse/SSPCPP-922</a>

Shibboleth Service Provider Security Advisory [17 March 2021]

An updated version of the Service Provider software is available
which fixes a phishing vulnerability.

Template generation allows external parameters to override placeholders
======================================================================
The SP includes a primitive template engine used to render error pages
and various other status or transition pages, and it supports a syntax
for embedding placeholders that are replaced by internally supplied
values or configuration settings.

For reasons that are unclear in the code history, it was extended to
allow replacement via query parameters also, though this is not a
typical need. Because of this feature, it&#39;s possible to cause the SP
to display some templates containing values supplied externally by
URL manipulation. Though the values are encoded to prevent script
injection, the content nevertheless appears to come from the server
and so would be interpreted as trustworthy, allowing email addresses,
logos, or support URLs to be manipulated by an attacker.

All platforms are impacted by this issue.


Recommendations
===============
Update to V3.2.1 or later of the Service Provider software, which
is now available.

The update adds a new &lt;Errors&gt; setting to the configuration called
externalParameters, which defaults to false. When false, support for
this &quot;feature&quot; is disabled. In the unlikely event that a valid need
for this exists, the setting can be enabled temporarily to maintain
function until the use case requiring it is addressed in some other
way.


Other Notes
===========
The cpp-sp git commit containing the fix for this issue is
d1dbebfadc1bdb824fea63843c4c38fa69e54379


URL for this Security Advisory:
<a href="https://shibboleth.net/community/advisories/secadv_20210317.txt">https://shibboleth.net/community/advisories/secadv_20210317.txt</a>


</pre>

<div class="infmessage"><hr><p>
<a name="6"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Debian Shib Team &lt;pkg-shibboleth-devel@alioth-lists.debian.net&gt; -->
<!-- time:1616001662 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Debian Shib Team &lt;pkg-shibboleth-devel@alioth-lists.debian.net&gt;</code>:<br>
<code>Bug#985405</code>; Package <code>src:shibboleth-sp</code>.
 (Wed, 17 Mar 2021 17:21:02 GMT) (<a href="bugreport.cgi?bug=985405;msg=7">full text</a>, <a href="bugreport.cgi?bug=985405;mbox=yes;msg=7">mbox</a>, <a href="#6">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="8"></a>
<!-- request_addr: wferi@niif.hu -->
<!-- time:1616001663 -->
<strong>Acknowledgement sent</strong>
to <code>wferi@niif.hu</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Debian Shib Team &lt;pkg-shibboleth-devel@alioth-lists.debian.net&gt;</code>.
 (Wed, 17 Mar 2021 17:21:03 GMT) (<a href="bugreport.cgi?bug=985405;msg=9">full text</a>, <a href="bugreport.cgi?bug=985405;mbox=yes;msg=9">mbox</a>, <a href="#8">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="10"></a><a name="msg10"></a><a href="#10">Message #10</a> received at 985405@bugs.debian.org (<a href="bugreport.cgi?bug=985405;msg=10">full text</a>, <a href="bugreport.cgi?bug=985405;mbox=yes;msg=10">mbox</a>, <a href="mailto:985405@bugs.debian.org?body=On%20Wed%2C%2017%20Mar%202021%2018%3A19%3A07%20%2B0100%20wferi%40niif.hu%20wrote%3A%0A%3E%20Dear%20Security%20Team%2C%0A%3E%20%0A%3E%20Please%20review%20the%20debdiff%20below%20for%20a%20buster-security%20upload.%0A%3E%20The%20advisory%20text%20changed%20a%20little%20meanwhile%2C%20adding%20credits%20to%20Toni%0A%3E%20Huttunen%2C%20Fraktal%20Oy%20for%20discovering%20the%20problem%2C%20mentioning%20the%20style%0A%3E%20sheet%20spoofing%20and%20adding%20some%20mitigation%20tips.%0A%3E%20%0A%3E%20I%20haven%27t%20got%20a%20concrete%20exploit%20on%20hand%2C%20but%20I%27ll%20start%20testing%20the%0A%3E%20updated%20package%20shortly.%0A%3E%20%0A%3E%20diff%20-Nru%20shibboleth-sp-3.0.4%2Bdfsg1%2Fdebian%2Fchangelog%20shibboleth-sp-3.0.4%2Bdfsg1%2Fdebian%2Fchangelog%0A%3E%20---%20shibboleth-sp-3.0.4%2Bdfsg1%2Fdebian%2Fchangelog%092019-03-16%2020%3A51%3A16.000000000%20%2B0100%0A%3E%20%2B%2B%2B%20shibboleth-sp-3.0.4%2Bdfsg1%2Fdebian%2Fchangelog%092021-03-17%2016%3A55%3A49.000000000%20%2B0100%0A%3E%20%40%40%20-1%2C3%20%2B1%2C26%20%40%40%0A%3E%20%2Bshibboleth-sp%20%283.0.4%2Bdfsg1-1%2Bdeb10u1%29%20buster-security%3B%20urgency%3Dhigh%0A%3E%20%2B%0A%3E%20%2B%20%20%2A%20%5B594074b%5D%20New%20patch%3A%20SSPCPP-922%20-%20Add%20externalParameters%20option%20to%20Errors%0A%3E%20%2B%20%20%20%20element.%0A%3E%20%2B%20%20%20%20Fix%20a%20phishing%20vulnerability%3A%20Template%20generation%20allows%20external%0A%3E%20%2B%20%20%20%20parameters%20to%20override%20placeholders%0A%3E%20%2B%20%20%20%20The%20primitive%20template%20engine%20used%20to%20render%20error%20pages%20allows%0A%3E%20%2B%20%20%20%20replacement%20via%20query%20parameters%20also%2C%20though%20this%20is%20not%20a%20typical%0A%3E%20%2B%20%20%20%20need.%20Because%20of%20this%20feature%2C%20it%27s%20possible%20to%20cause%20the%20SP%20to%0A%3E%20%2B%20%20%20%20display%20some%20templates%20containing%20values%20supplied%20externally%20by%20URL%0A%3E%20%2B%20%20%20%20manipulation.%20Though%20the%20values%20are%20encoded%20to%20prevent%20script%0A%3E%20%2B%20%20%20%20injection%2C%20the%20content%20nevertheless%20appears%20to%20come%20from%20the%20server%0A%3E%20%2B%20%20%20%20and%20so%20would%20be%20interpreted%20as%20trustworthy%2C%20allowing%20email%20addresses%2C%0A%3E%20%2B%20%20%20%20logos%2C%20or%20support%20URLs%20to%20be%20manipulated%20by%20an%20attacker.%0A%3E%20%2B%20%20%20%20This%20update%20adds%20a%20new%20%3CErrors%3E%20setting%20to%20the%20configuration%20called%0A%3E%20%2B%20%20%20%20externalParameters%2C%20which%20defaults%20to%20false.%20When%20false%2C%20support%20for%0A%3E%20%2B%20%20%20%20this%20%22feature%22%20is%20disabled.%0A%3E%20%2B%20%20%20%20https%3A%2F%2Fshibboleth.net%2Fcommunity%2Fadvisories%2Fsecadv_20210317.txt%0A%3E%20%2B%20%20%20%20https%3A%2F%2Fissues.shibboleth.net%2Fjira%2Fbrowse%2FSSPCPP-922%0A%3E%20%2B%20%20%20%20Thanks%20to%20Scott%20Cantor%20%28Closes%3A%20%23985405%29%0A%3E%20%2B%0A%3E%20%2B%20--%20Ferenc%20W%C3%A1gner%20%3Cwferi%40debian.org%3E%20%20Wed%2C%2017%20Mar%202021%2016%3A55%3A49%20%2B0100%0A%3E%20%2B%0A%3E%20%20shibboleth-sp%20%283.0.4%2Bdfsg1-1%29%20unstable%3B%20urgency%3Dmedium%0A%3E%20%20%0A%3E%20%20%20%20%2A%20%5Bf284741%5D%20New%20upstream%20release%3A%203.0.4%0A%3E%20diff%20-Nru%20shibboleth-sp-3.0.4%2Bdfsg1%2Fdebian%2Fgbp.conf%20shibboleth-sp-3.0.4%2Bdfsg1%2Fdebian%2Fgbp.conf%0A%3E%20---%20shibboleth-sp-3.0.4%2Bdfsg1%2Fdebian%2Fgbp.conf%092019-03-13%2020%3A06%3A54.000000000%20%2B0100%0A%3E%20%2B%2B%2B%20shibboleth-sp-3.0.4%2Bdfsg1%2Fdebian%2Fgbp.conf%092021-03-17%2016%3A21%3A54.000000000%20%2B0100%0A%3E%20%40%40%20-1%2C5%20%2B1%2C5%20%40%40%0A%3E%20%20%5BDEFAULT%5D%0A%3E%20-debian-branch%20%3D%20debian%2Fmaster%0A%3E%20%2Bdebian-branch%20%3D%20debian%2Fbuster%0A%3E%20%20upstream-branch%20%3D%20upstream%2Flatest%0A%3E%20%20pristine-tar%20%3D%20True%0A%3E%20%20%0A%3E%20diff%20-Nru%20shibboleth-sp-3.0.4%2Bdfsg1%2Fdebian%2Fpatches%2Fseries%20shibboleth-sp-3.0.4%2Bdfsg1%2Fdebian%2Fpatches%2Fseries%0A%3E%20---%20shibboleth-sp-3.0.4%2Bdfsg1%2Fdebian%2Fpatches%2Fseries%092019-03-16%2020%3A48%3A54.000000000%20%2B0100%0A%3E%20%2B%2B%2B%20shibboleth-sp-3.0.4%2Bdfsg1%2Fdebian%2Fpatches%2Fseries%092021-03-17%2016%3A54%3A46.000000000%20%2B0100%0A%3E%20%40%40%20-3%2C3%20%2B3%2C4%20%40%40%0A%3E%20%20Debianize-the-systemd-service-file-of-shibd.patch%0A%3E%20%20seckeygen-defaults-for-Debian.patch%0A%3E%20%20Use-runstatedir-from-future-Autoconf-2.70.patch%0A%3E%20%2BSSPCPP-922-Add-externalParameters-option-to-Errors-elemen.patch%0A%3E%20diff%20-Nru%20shibboleth-sp-3.0.4%2Bdfsg1%2Fdebian%2Fpatches%2FSSPCPP-922-Add-externalParameters-option-to-Errors-elemen.patch%20shibboleth-sp-3.0.4%2Bdfsg1%2Fdebian%2Fpatches%2FSSPCPP-922-Add-externalParameters-option-to-Errors-elemen.patch%0A%3E%20---%20shibboleth-sp-3.0.4%2Bdfsg1%2Fdebian%2Fpatches%2FSSPCPP-922-Add-externalParameters-option-to-Errors-elemen.patch%091970-01-01%2001%3A00%3A00.000000000%20%2B0100%0A&amp;In-Reply-To=%3C87k0q5bsvo.fsf_-_%40lant.ki.iif.hu%3E&amp;References=%3C161599340505.14916.11364877723341266823.reportbug%40lant.ki.iif.hu%3E%0A%09%3Chandler.985405.B.16159934209342.ack%40bugs.debian.org%3E%0A%20%3C87k0q5bsvo.fsf_-_%40lant.ki.iif.hu%3E&amp;subject=Re%3A%20Bug%23985405%3A%20src%3Ashibboleth-sp%3A%20Error%20templates%20allow%20query-based%20override%20of%20variables">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=wferi%40niif.hu" alt="">
<div class="header"><span class="headerfield">From:</span> wferi@niif.hu</div>
<div class="header"><span class="headerfield">To:</span> team@security.debian.org</div>
<div class="header"><span class="headerfield">Cc:</span> 985405@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#985405: src:shibboleth-sp: Error templates allow query-based override of variables</div>
<div class="header"><span class="headerfield">Date:</span> Wed, 17 Mar 2021 18:19:07 +0100</div>
</div>
<pre class="message">Dear Security Team,

Please review the debdiff below for a buster-security upload.
The advisory text changed a little meanwhile, adding credits to Toni
Huttunen, Fraktal Oy for discovering the problem, mentioning the style
sheet spoofing and adding some mitigation tips.

I haven&#39;t got a concrete exploit on hand, but I&#39;ll start testing the
updated package shortly.

diff -Nru shibboleth-sp-3.0.4+dfsg1/debian/changelog shibboleth-sp-3.0.4+dfsg1/debian/changelog
--- shibboleth-sp-3.0.4+dfsg1/debian/changelog	2019-03-16 20:51:16.000000000 +0100
+++ shibboleth-sp-3.0.4+dfsg1/debian/changelog	2021-03-17 16:55:49.000000000 +0100
@@ -1,3 +1,26 @@
+shibboleth-sp (3.0.4+dfsg1-1+deb10u1) buster-security; urgency=high
+
+  * [594074b] New patch: SSPCPP-922 - Add externalParameters option to Errors
+    element.
+    Fix a phishing vulnerability: Template generation allows external
+    parameters to override placeholders
+    The primitive template engine used to render error pages allows
+    replacement via query parameters also, though this is not a typical
+    need. Because of this feature, it&#39;s possible to cause the SP to
+    display some templates containing values supplied externally by URL
+    manipulation. Though the values are encoded to prevent script
+    injection, the content nevertheless appears to come from the server
+    and so would be interpreted as trustworthy, allowing email addresses,
+    logos, or support URLs to be manipulated by an attacker.
+    This update adds a new &lt;Errors&gt; setting to the configuration called
+    externalParameters, which defaults to false. When false, support for
+    this &quot;feature&quot; is disabled.
+    <a href="https://shibboleth.net/community/advisories/secadv_20210317.txt">https://shibboleth.net/community/advisories/secadv_20210317.txt</a>
+    <a href="https://issues.shibboleth.net/jira/browse/SSPCPP-922">https://issues.shibboleth.net/jira/browse/SSPCPP-922</a>
+    Thanks to Scott Cantor (Closes: #<a href="bugreport.cgi?bug=985405">985405</a>)
+
+ -- Ferenc Wágner &lt;wferi@debian.org&gt;  Wed, 17 Mar 2021 16:55:49 +0100
+
 shibboleth-sp (3.0.4+dfsg1-1) unstable; urgency=medium
 
   * [f284741] New upstream release: 3.0.4
diff -Nru shibboleth-sp-3.0.4+dfsg1/debian/gbp.conf shibboleth-sp-3.0.4+dfsg1/debian/gbp.conf
--- shibboleth-sp-3.0.4+dfsg1/debian/gbp.conf	2019-03-13 20:06:54.000000000 +0100
+++ shibboleth-sp-3.0.4+dfsg1/debian/gbp.conf	2021-03-17 16:21:54.000000000 +0100
@@ -1,5 +1,5 @@
 [DEFAULT]
-debian-branch = debian/master
+debian-branch = debian/buster
 upstream-branch = upstream/latest
 pristine-tar = True
 
diff -Nru shibboleth-sp-3.0.4+dfsg1/debian/patches/series shibboleth-sp-3.0.4+dfsg1/debian/patches/series
--- shibboleth-sp-3.0.4+dfsg1/debian/patches/series	2019-03-16 20:48:54.000000000 +0100
+++ shibboleth-sp-3.0.4+dfsg1/debian/patches/series	2021-03-17 16:54:46.000000000 +0100
@@ -3,3 +3,4 @@
 Debianize-the-systemd-service-file-of-shibd.patch
 seckeygen-defaults-for-Debian.patch
 Use-runstatedir-from-future-Autoconf-2.70.patch
+SSPCPP-922-Add-externalParameters-option-to-Errors-elemen.patch
diff -Nru shibboleth-sp-3.0.4+dfsg1/debian/patches/SSPCPP-922-Add-externalParameters-option-to-Errors-elemen.patch shibboleth-sp-3.0.4+dfsg1/debian/patches/SSPCPP-922-Add-externalParameters-option-to-Errors-elemen.patch
--- shibboleth-sp-3.0.4+dfsg1/debian/patches/SSPCPP-922-Add-externalParameters-option-to-Errors-elemen.patch	1970-01-01 01:00:00.000000000 +0100
+++ shibboleth-sp-3.0.4+dfsg1/debian/patches/SSPCPP-922-Add-externalParameters-option-to-Errors-elemen.patch	2021-03-17 16:54:46.000000000 +0100
@@ -0,0 +1,125 @@
+From: Scott Cantor &lt;cantor.2@osu.edu&gt;
+Date: Tue, 16 Mar 2021 10:56:22 -0400
+Subject: SSPCPP-922 - Add externalParameters option to Errors element
+
+<a href="https://issues.shibboleth.net/jira/browse/SSPCPP-922">https://issues.shibboleth.net/jira/browse/SSPCPP-922</a>
+
+Closes: #<a href="bugreport.cgi?bug=985405">985405</a>
+---
+ schemas/shibboleth-3.0-native-sp-config.xsd     |  1 +
+ shibsp/ServiceProvider.cpp                      | 11 +++++++++--
+ shibsp/handler/impl/AttributeCheckerHandler.cpp | 12 ++++++++++--
+ shibsp/handler/impl/FormSessionInitiator.cpp    | 12 +++++++++++-
+ shibsp/handler/impl/LogoutHandler.cpp           | 10 +++++++++-
+ 5 files changed, 40 insertions(+), 6 deletions(-)
+
+diff --git a/schemas/shibboleth-3.0-native-sp-config.xsd b/schemas/shibboleth-3.0-native-sp-config.xsd
+index 5bfa3a2..3b1a664 100644
+--- a/schemas/shibboleth-3.0-native-sp-config.xsd
++++ b/schemas/shibboleth-3.0-native-sp-config.xsd
+@@ -732,6 +732,7 @@
+     &lt;attribute name=&quot;localLogout&quot; type=&quot;anyURI&quot;/&gt;
+     &lt;attribute name=&quot;globalLogout&quot; type=&quot;anyURI&quot;/&gt;
+     &lt;attribute name=&quot;partialLogout&quot; type=&quot;anyURI&quot;/&gt;
++    &lt;attribute name=&quot;externalParameters&quot; type=&quot;boolean&quot; /&gt;
+     &lt;anyAttribute namespace=&quot;##any&quot; processContents=&quot;lax&quot;/&gt;
+   &lt;/complexType&gt;
+ 
+diff --git a/shibsp/ServiceProvider.cpp b/shibsp/ServiceProvider.cpp
+index aacbba1..b9f6e4c 100644
+--- a/shibsp/ServiceProvider.cpp
++++ b/shibsp/ServiceProvider.cpp
+@@ -71,9 +71,16 @@ namespace shibsp {
+         if (!app)
+             app = request.getServiceProvider().getApplication(nullptr);
+ 
+-        const PropertySet* props=app-&gt;getPropertySet(&quot;Errors&quot;);
++        const PropertySet* props = app-&gt;getPropertySet(&quot;Errors&quot;);
+ 
+-        // First look for settings in the request map of the form pageError.
++        // If the externalParameters option isn&#39;t set, clear out the request field.
++        pair&lt;bool,bool&gt; externalParameters =
++                props ? props-&gt;getBool(&quot;externalParameters&quot;) : pair&lt;bool,bool&gt;(false,false);
++        if (!externalParameters.first || !externalParameters.second) {
++            tp.m_request = nullptr;
++        }
++
++        // Now look for settings in the request map of the form pageError.
+         try {
+             RequestMapper::Settings settings = request.getRequestSettings();
+             if (mderror)
+diff --git a/shibsp/handler/impl/AttributeCheckerHandler.cpp b/shibsp/handler/impl/AttributeCheckerHandler.cpp
+index 47dff9d..52f56fa 100644
+--- a/shibsp/handler/impl/AttributeCheckerHandler.cpp
++++ b/shibsp/handler/impl/AttributeCheckerHandler.cpp
+@@ -187,8 +187,16 @@ pair&lt;bool,long&gt; AttributeCheckerHandler::run(SPRequest&amp; request, bool isHandler)
+ 
+     ifstream infile(m_template.c_str());
+     if (infile) {
+-        TemplateParameters tp(nullptr, request.getApplication().getPropertySet(&quot;Errors&quot;), session);
+-        tp.m_request = &amp;request;
++        const PropertySet* props = request.getApplication().getPropertySet(&quot;Errors&quot;);
++        TemplateParameters tp(nullptr, props, session);
++
++        // If the externalParameters option isn&#39;t set, don&#39;t populate the request field.
++        pair&lt;bool,bool&gt; externalParameters =
++                props ? props-&gt;getBool(&quot;externalParameters&quot;) : pair&lt;bool,bool&gt;(false,false);
++        if (externalParameters.first &amp;&amp; externalParameters.second) {
++            tp.m_request = &amp;request;
++        }
++
+         stringstream str;
+         XMLToolingConfig::getConfig().getTemplateEngine()-&gt;run(infile, str, tp);
+         if (m_flushSession &amp;&amp; session) {
+diff --git a/shibsp/handler/impl/FormSessionInitiator.cpp b/shibsp/handler/impl/FormSessionInitiator.cpp
+index 522b31b..24dd77d 100644
+--- a/shibsp/handler/impl/FormSessionInitiator.cpp
++++ b/shibsp/handler/impl/FormSessionInitiator.cpp
+@@ -123,8 +123,18 @@ pair&lt;bool,long&gt; FormSessionInitiator::run(SPRequest&amp; request, string&amp; entityID,
+     ifstream infile(XMLToolingConfig::getConfig().getPathResolver()-&gt;resolve(fname, PathResolver::XMLTOOLING_CFG_FILE).c_str());
+     if (!infile)
+         throw ConfigurationException(&quot;Unable to access HTML template ($1).&quot;, params(1, m_template));
++
++    const PropertySet* props = app.getPropertySet(&quot;Errors&quot;);
++
+     TemplateParameters tp;
+-    tp.m_request = &amp;request;
++
++    // If the externalParameters option isn&#39;t set, don&#39;t populate the request field.
++    pair&lt;bool,bool&gt; externalParameters =
++            props ? props-&gt;getBool(&quot;externalParameters&quot;) : pair&lt;bool,bool&gt;(false,false);
++    if (externalParameters.first &amp;&amp; externalParameters.second) {
++        tp.m_request = &amp;request;
++    }
++
+     tp.setPropertySet(app.getPropertySet(&quot;Errors&quot;));
+     tp.m_map[&quot;action&quot;] = returnURL;
+     if (!target.empty())
+diff --git a/shibsp/handler/impl/LogoutHandler.cpp b/shibsp/handler/impl/LogoutHandler.cpp
+index 026be56..5673a12 100644
+--- a/shibsp/handler/impl/LogoutHandler.cpp
++++ b/shibsp/handler/impl/LogoutHandler.cpp
+@@ -63,6 +63,7 @@ pair&lt;bool,long&gt; LogoutHandler::sendLogoutPage(
+ {
+     string tname = string(type) + &quot;Logout&quot;;
+     const PropertySet* props = application.getPropertySet(&quot;Errors&quot;);
++
+     pair&lt;bool,const char*&gt; prop = props ? props-&gt;getString(tname.c_str()) : pair&lt;bool,const char*&gt;(false,nullptr);
+     if (!prop.first) {
+         tname += &quot;.html&quot;;
+@@ -76,7 +77,14 @@ pair&lt;bool,long&gt; LogoutHandler::sendLogoutPage(
+     if (!infile)
+         throw ConfigurationException(&quot;Unable to access $1 HTML template.&quot;, params(1,prop.second));
+     TemplateParameters tp;
+-    tp.m_request = &amp;request;
++
++    // If the externalParameters option isn&#39;t set, don&#39;t populate the request field.
++    pair&lt;bool,bool&gt; externalParameters =
++            props ? props-&gt;getBool(&quot;externalParameters&quot;) : pair&lt;bool,bool&gt;(false,false);
++    if (externalParameters.first &amp;&amp; externalParameters.second) {
++        tp.m_request = &amp;request;
++    }
++
+     tp.setPropertySet(props);
+     tp.m_map[&quot;logoutStatus&quot;] = &quot;Logout completed successfully.&quot;;  // Backward compatibility.
+     stringstream str;
-- 
Thanks,
Feri


</pre>

<div class="infmessage"><hr><p>
<a name="11"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Debian Shib Team &lt;pkg-shibboleth-devel@alioth-lists.debian.net&gt; -->
<!-- time:1616008144 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Debian Shib Team &lt;pkg-shibboleth-devel@alioth-lists.debian.net&gt;</code>:<br>
<code>Bug#985405</code>; Package <code>src:shibboleth-sp</code>.
 (Wed, 17 Mar 2021 19:09:04 GMT) (<a href="bugreport.cgi?bug=985405;msg=12">full text</a>, <a href="bugreport.cgi?bug=985405;mbox=yes;msg=12">mbox</a>, <a href="#11">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="13"></a>
<!-- request_addr: Moritz Muehlenhoff &lt;jmm@inutil.org&gt; -->
<!-- time:1616008144 -->
<strong>Acknowledgement sent</strong>
to <code>Moritz Muehlenhoff &lt;jmm@inutil.org&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Debian Shib Team &lt;pkg-shibboleth-devel@alioth-lists.debian.net&gt;</code>.
 (Wed, 17 Mar 2021 19:09:04 GMT) (<a href="bugreport.cgi?bug=985405;msg=14">full text</a>, <a href="bugreport.cgi?bug=985405;mbox=yes;msg=14">mbox</a>, <a href="#13">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="15"></a><a name="msg15"></a><a href="#15">Message #15</a> received at 985405@bugs.debian.org (<a href="bugreport.cgi?bug=985405;msg=15">full text</a>, <a href="bugreport.cgi?bug=985405;mbox=yes;msg=15">mbox</a>, <a href="mailto:985405@bugs.debian.org?subject=Re%3A%20Bug%23985405%3A%20src%3Ashibboleth-sp%3A%20Error%20templates%20allow%20query-based%0A%20override%20of%20variables&amp;References=%3C161599340505.14916.11364877723341266823.reportbug%40lant.ki.iif.hu%3E%0A%20%3Chandler.985405.B.16159934209342.ack%40bugs.debian.org%3E%0A%20%3C87k0q5bsvo.fsf_-_%40lant.ki.iif.hu%3E%0A%20%3C20210317190622.iy56wxnzdbmg22a7%40inutil.org%3E&amp;In-Reply-To=%3C20210317190622.iy56wxnzdbmg22a7%40inutil.org%3E&amp;body=On%20Wed%2C%2017%20Mar%202021%2020%3A06%3A22%20%2B0100%20Moritz%20Muehlenhoff%20%3Cjmm%40inutil.org%3E%20wrote%3A%0A%3E%20On%20Wed%2C%20Mar%2017%2C%202021%20at%2006%3A19%3A07PM%20%2B0100%2C%20wferi%40niif.hu%20wrote%3A%0A%3E%20%3E%20Dear%20Security%20Team%2C%0A%3E%20%3E%20%0A%3E%20%3E%20Please%20review%20the%20debdiff%20below%20for%20a%20buster-security%20upload.%0A%3E%20%3E%20The%20advisory%20text%20changed%20a%20little%20meanwhile%2C%20adding%20credits%20to%20Toni%0A%3E%20%3E%20Huttunen%2C%20Fraktal%20Oy%20for%20discovering%20the%20problem%2C%20mentioning%20the%20style%0A%3E%20%3E%20sheet%20spoofing%20and%20adding%20some%20mitigation%20tips.%0A%3E%20%3E%20%0A%3E%20%3E%20I%20haven%27t%20got%20a%20concrete%20exploit%20on%20hand%2C%20but%20I%27ll%20start%20testing%20the%0A%3E%20%3E%20updated%20package%20shortly.%0A%3E%20%0A%3E%20debdiff%20looks%20fine%2C%20please%20upload%20when%20you%20had%20a%20chance%20to%20test%20it%0A%3E%20%28and%20remember%20to%20build%20with%20-sa%2C%20since%20shib-sp%20is%20new%20in%20buster-security%2C%0A%3E%20ftp-master%20and%20security-master%20don%27t%20share%20tarballs%29%0A%3E%20%0A%3E%20Cheers%2C%0A%3E%20%20%20%20%20%20%20%20%20Moritz%0A%3E%20%0A%3E%20%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=jmm%40inutil.org" alt="">
<div class="header"><span class="headerfield">From:</span> Moritz Muehlenhoff &lt;jmm@inutil.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> wferi@niif.hu</div>
<div class="header"><span class="headerfield">Cc:</span> team@security.debian.org, 985405@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#985405: src:shibboleth-sp: Error templates allow query-based
 override of variables</div>
<div class="header"><span class="headerfield">Date:</span> Wed, 17 Mar 2021 20:06:22 +0100</div>
</div>
<pre class="message">On Wed, Mar 17, 2021 at 06:19:07PM +0100, wferi@niif.hu wrote:
&gt; Dear Security Team,
&gt; 
&gt; Please review the debdiff below for a buster-security upload.
&gt; The advisory text changed a little meanwhile, adding credits to Toni
&gt; Huttunen, Fraktal Oy for discovering the problem, mentioning the style
&gt; sheet spoofing and adding some mitigation tips.
&gt; 
&gt; I haven&#39;t got a concrete exploit on hand, but I&#39;ll start testing the
&gt; updated package shortly.

debdiff looks fine, please upload when you had a chance to test it
(and remember to build with -sa, since shib-sp is new in buster-security,
ftp-master and security-master don&#39;t share tarballs)

Cheers,
        Moritz


</pre>

<div class="msgreceived"><hr><p>
<a name="16"></a>
<!-- command:fixed -->
<!-- requester: Salvatore Bonaccorso &lt;carnil@debian.org&gt; -->
<!-- request_addr: control@bugs.debian.org -->
<!-- time:1616010305 -->
<!-- new_data:
$new_data = {
              &#39;fixed_versions&#39; =&gt; [
                                    &#39;shibboleth-sp/3.2.1+dfsg1-1&#39;
                                  ]
            };
-->
<!-- old_data:
$old_data = {
              &#39;fixed_versions&#39; =&gt; []
            };
-->
<strong>Marked as fixed in versions shibboleth-sp/3.2.1+dfsg1-1.</strong>
Request was from <code>Salvatore Bonaccorso &lt;carnil@debian.org&gt;</code>
to <code>control@bugs.debian.org</code>.
 (Wed, 17 Mar 2021 19:45:05 GMT) (<a href="bugreport.cgi?bug=985405;msg=17">full text</a>, <a href="bugreport.cgi?bug=985405;mbox=yes;msg=17">mbox</a>, <a href="#16">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="18"></a>
<!-- requester: Salvatore Bonaccorso &lt;carnil@debian.org&gt; -->
<!-- request_addr: control@bugs.debian.org -->
<!-- time:1616010307 -->
<strong>Severity set to &#39;grave&#39; from &#39;important&#39;</strong>
Request was from <code>Salvatore Bonaccorso &lt;carnil@debian.org&gt;</code>
to <code>control@bugs.debian.org</code>.
 (Wed, 17 Mar 2021 19:45:07 GMT) (<a href="bugreport.cgi?bug=985405;msg=19">full text</a>, <a href="bugreport.cgi?bug=985405;mbox=yes;msg=19">mbox</a>, <a href="#18">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="20"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Debian Shib Team &lt;pkg-shibboleth-devel@alioth-lists.debian.net&gt; -->
<!-- time:1616014267 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Debian Shib Team &lt;pkg-shibboleth-devel@alioth-lists.debian.net&gt;</code>:<br>
<code>Bug#985405</code>; Package <code>src:shibboleth-sp</code>.
 (Wed, 17 Mar 2021 20:51:07 GMT) (<a href="bugreport.cgi?bug=985405;msg=21">full text</a>, <a href="bugreport.cgi?bug=985405;mbox=yes;msg=21">mbox</a>, <a href="#20">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="22"></a>
<!-- request_addr: wferi@niif.hu -->
<!-- time:1616014267 -->
<strong>Acknowledgement sent</strong>
to <code>wferi@niif.hu</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Debian Shib Team &lt;pkg-shibboleth-devel@alioth-lists.debian.net&gt;</code>.
 (Wed, 17 Mar 2021 20:51:07 GMT) (<a href="bugreport.cgi?bug=985405;msg=23">full text</a>, <a href="bugreport.cgi?bug=985405;mbox=yes;msg=23">mbox</a>, <a href="#22">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="24"></a><a name="msg24"></a><a href="#24">Message #24</a> received at 985405@bugs.debian.org (<a href="bugreport.cgi?bug=985405;msg=24">full text</a>, <a href="bugreport.cgi?bug=985405;mbox=yes;msg=24">mbox</a>, <a href="mailto:985405@bugs.debian.org?subject=Re%3A%20Bug%23985405%3A%20src%3Ashibboleth-sp%3A%20Error%20templates%20allow%20query-based%20override%20of%20variables&amp;References=%3C161599340505.14916.11364877723341266823.reportbug%40lant.ki.iif.hu%3E%0A%09%3Chandler.985405.B.16159934209342.ack%40bugs.debian.org%3E%0A%09%3C87k0q5bsvo.fsf_-_%40lant.ki.iif.hu%3E%0A%09%3C20210317190622.iy56wxnzdbmg22a7%40inutil.org%3E%0A%20%3C87eegdbj6w.fsf%40lant.ki.iif.hu%3E&amp;body=On%20Wed%2C%2017%20Mar%202021%2021%3A48%3A23%20%2B0100%20wferi%40niif.hu%20wrote%3A%0A%3E%20Moritz%20Muehlenhoff%20%3Cjmm%40inutil.org%3E%20writes%3A%0A%3E%20%0A%3E%20%3E%20debdiff%20looks%20fine%2C%20please%20upload%20when%20you%20had%20a%20chance%20to%20test%20it%0A%3E%20%0A%3E%20The%20updated%20packages%20work%20fine%20in%20our%20infrastructure.%0A%3E%20I%20uploaded%20the%20full%20source%20package.%0A%3E%20--%20%0A%3E%20Thanks%2C%0A%3E%20Feri%0A%3E%20%0A%3E%20%0A&amp;In-Reply-To=%3C87eegdbj6w.fsf%40lant.ki.iif.hu%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=wferi%40niif.hu" alt="">
<div class="header"><span class="headerfield">From:</span> wferi@niif.hu</div>
<div class="header"><span class="headerfield">To:</span> Moritz Muehlenhoff &lt;jmm@inutil.org&gt;</div>
<div class="header"><span class="headerfield">Cc:</span> wferi@niif.hu,  team@security.debian.org,  985405@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#985405: src:shibboleth-sp: Error templates allow query-based override of variables</div>
<div class="header"><span class="headerfield">Date:</span> Wed, 17 Mar 2021 21:48:23 +0100</div>
</div>
<pre class="message">Moritz Muehlenhoff &lt;jmm@inutil.org&gt; writes:

&gt; debdiff looks fine, please upload when you had a chance to test it

The updated packages work fine in our infrastructure.
I uploaded the full source package.
-- 
Thanks,
Feri


</pre>

<div class="msgreceived"><hr><p>
<a name="25"></a>
<!-- request_addr: Ferenc Wágner &lt;wferi@debian.org&gt; -->
<!-- time:1616182575 -->
<strong>Reply sent</strong>
to <code>Ferenc Wágner &lt;wferi@debian.org&gt;</code>:<br>
You have taken responsibility.
 (Fri, 19 Mar 2021 19:36:15 GMT) (<a href="bugreport.cgi?bug=985405;msg=26">full text</a>, <a href="bugreport.cgi?bug=985405;mbox=yes;msg=26">mbox</a>, <a href="#25">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="27"></a>
<!-- request_addr: Ferenc Wágner &lt;wferi@debian.org&gt; -->
<!-- time:1616182575 -->
<strong>Notification sent</strong>
to <code>Ferenc Wágner &lt;wferi@debian.org&gt;</code>:<br>
Bug acknowledged by developer.
 (Fri, 19 Mar 2021 19:36:15 GMT) (<a href="bugreport.cgi?bug=985405;msg=28">full text</a>, <a href="bugreport.cgi?bug=985405;mbox=yes;msg=28">mbox</a>, <a href="#27">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="29"></a><a name="msg29"></a><a href="#29">Message #29</a> received at 985405-close@bugs.debian.org (<a href="bugreport.cgi?bug=985405;msg=29">full text</a>, <a href="bugreport.cgi?bug=985405;mbox=yes;msg=29">mbox</a>, <a href="mailto:985405@bugs.debian.org?subject=Re%3A%20Bug%23985405%3A%20fixed%20in%20shibboleth-sp%203.0.4%2Bdfsg1-1%2Bdeb10u1&amp;References=%3CE1lNKqv-000IUz-4C%40fasolo.debian.org%3E&amp;body=On%20Fri%2C%2019%20Mar%202021%2019%3A32%3A09%20%2B0000%20Debian%20FTP%20Masters%20%3Cftpmaster%40ftp-master.debian.org%3E%20wrote%3A%0A%3E%20Source%3A%20shibboleth-sp%0A%3E%20Source-Version%3A%203.0.4%2Bdfsg1-1%2Bdeb10u1%0A%3E%20Done%3A%20Ferenc%20W%C3%A1gner%20%3Cwferi%40debian.org%3E%0A%3E%20%0A%3E%20We%20believe%20that%20the%20bug%20you%20reported%20is%20fixed%20in%20the%20latest%20version%20of%0A%3E%20shibboleth-sp%2C%20which%20is%20due%20to%20be%20installed%20in%20the%20Debian%20FTP%20archive.%0A%3E%20%0A%3E%20A%20summary%20of%20the%20changes%20between%20this%20version%20and%20the%20previous%20one%20is%0A%3E%20attached.%0A%3E%20%0A%3E%20Thank%20you%20for%20reporting%20the%20bug%2C%20which%20will%20now%20be%20closed.%20%20If%20you%0A%3E%20have%20further%20comments%20please%20address%20them%20to%20985405%40bugs.debian.org%2C%0A%3E%20and%20the%20maintainer%20will%20reopen%20the%20bug%20report%20if%20appropriate.%0A%3E%20%0A%3E%20Debian%20distribution%20maintenance%20software%0A%3E%20pp.%0A%3E%20Ferenc%20W%C3%A1gner%20%3Cwferi%40debian.org%3E%20%28supplier%20of%20updated%20shibboleth-sp%20package%29%0A%3E%20%0A%3E%20%28This%20message%20was%20generated%20automatically%20at%20their%20request%3B%20if%20you%0A%3E%20believe%20that%20there%20is%20a%20problem%20with%20it%20please%20contact%20the%20archive%0A%3E%20administrators%20by%20mailing%20ftpmaster%40ftp-master.debian.org%29%0A%3E%20%0A%3E%20%0A%3E%20-----BEGIN%20PGP%20SIGNED%20MESSAGE-----%0A%3E%20Hash%3A%20SHA512%0A%3E%20%0A%3E%20Format%3A%201.8%0A%3E%20Date%3A%20Wed%2C%2017%20Mar%202021%2021%3A40%3A34%20CET%0A%3E%20Source%3A%20shibboleth-sp%0A%3E%20Architecture%3A%20source%0A%3E%20Version%3A%203.0.4%2Bdfsg1-1%2Bdeb10u1%0A%3E%20Distribution%3A%20buster-security%0A%3E%20Urgency%3A%20high%0A%3E%20Maintainer%3A%20Debian%20Shib%20Team%20%3Cpkg-shibboleth-devel%40lists.alioth.debian.org%3E%0A%3E%20Changed-By%3A%20Ferenc%20W%C3%A1gner%20%3Cwferi%40debian.org%3E%0A%3E%20Closes%3A%20985405%0A%3E%20Changes%3A%0A%3E%20%20shibboleth-sp%20%283.0.4%2Bdfsg1-1%2Bdeb10u1%29%20buster-security%3B%20urgency%3Dhigh%0A%3E%20%20.%0A%3E%20%20%20%20%2A%20%5B594074b%5D%20New%20patch%3A%20SSPCPP-922%20-%20Add%20externalParameters%20option%20to%20Errors%0A%3E%20%20%20%20%20%20element.%0A%3E%20%20%20%20%20%20Fix%20a%20phishing%20vulnerability%3A%20Template%20generation%20allows%20external%0A%3E%20%20%20%20%20%20parameters%20to%20override%20placeholders%0A%3E%20%20%20%20%20%20The%20primitive%20template%20engine%20used%20to%20render%20error%20pages%20allows%0A%3E%20%20%20%20%20%20replacement%20via%20query%20parameters%20also%2C%20though%20this%20is%20not%20a%20typical%0A%3E%20%20%20%20%20%20need.%20Because%20of%20this%20feature%2C%20it%27s%20possible%20to%20cause%20the%20SP%20to%0A%3E%20%20%20%20%20%20display%20some%20templates%20containing%20values%20supplied%20externally%20by%20URL%0A%3E%20%20%20%20%20%20manipulation.%20Though%20the%20values%20are%20encoded%20to%20prevent%20script%0A%3E%20%20%20%20%20%20injection%2C%20the%20content%20nevertheless%20appears%20to%20come%20from%20the%20server%0A%3E%20%20%20%20%20%20and%20so%20would%20be%20interpreted%20as%20trustworthy%2C%20allowing%20email%20addresses%2C%0A%3E%20%20%20%20%20%20logos%2C%20or%20support%20URLs%20to%20be%20manipulated%20by%20an%20attacker.%0A%3E%20%20%20%20%20%20This%20update%20adds%20a%20new%20%3CErrors%3E%20setting%20to%20the%20configuration%20called%0A%3E%20%20%20%20%20%20externalParameters%2C%20which%20defaults%20to%20false.%20When%20false%2C%20support%20for%0A%3E%20%20%20%20%20%20this%20%22feature%22%20is%20disabled.%0A%3E%20%20%20%20%20%20https%3A%2F%2Fshibboleth.net%2Fcommunity%2Fadvisories%2Fsecadv_20210317.txt%0A%3E%20%20%20%20%20%20https%3A%2F%2Fissues.shibboleth.net%2Fjira%2Fbrowse%2FSSPCPP-922%0A%3E%20%20%20%20%20%20Thanks%20to%20Scott%20Cantor%20%28Closes%3A%20%23985405%29%0A%3E%20Checksums-Sha256%3A%20%0A%3E%20%20c33ef8a0c0735abe7348e9825588bba01ac62325a6dc4375be21b153b8c0fd88%203034%20shibboleth-sp_3.0.4%2Bdfsg1-1%2Bdeb10u1.dsc%0A%3E%20%206790ac56e79c215dd38a065c94905b979185b72294d3fce2cd78ba43995831f4%2079324%20shibboleth-sp_3.0.4%2Bdfsg1-1%2Bdeb10u1.debian.tar.xz%0A&amp;In-Reply-To=%3CE1lNKqv-000IUz-4C%40fasolo.debian.org%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=ftpmaster%40ftp-master.debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Debian FTP Masters &lt;ftpmaster@ftp-master.debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> 985405-close@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Bug#985405: fixed in shibboleth-sp 3.0.4+dfsg1-1+deb10u1</div>
<div class="header"><span class="headerfield">Date:</span> Fri, 19 Mar 2021 19:32:09 +0000</div>
</div>
<pre class="message">Source: shibboleth-sp
Source-Version: 3.0.4+dfsg1-1+deb10u1
Done: Ferenc Wágner &lt;wferi@debian.org&gt;

We believe that the bug you reported is fixed in the latest version of
shibboleth-sp, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 985405@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Ferenc Wágner &lt;wferi@debian.org&gt; (supplier of updated shibboleth-sp package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Format: 1.8
Date: Wed, 17 Mar 2021 21:40:34 CET
Source: shibboleth-sp
Architecture: source
Version: 3.0.4+dfsg1-1+deb10u1
Distribution: buster-security
Urgency: high
Maintainer: Debian Shib Team &lt;pkg-shibboleth-devel@lists.alioth.debian.org&gt;
Changed-By: Ferenc Wágner &lt;wferi@debian.org&gt;
Closes: <a href="bugreport.cgi?bug=985405">985405</a>
Changes:
 shibboleth-sp (3.0.4+dfsg1-1+deb10u1) buster-security; urgency=high
 .
   * [594074b] New patch: SSPCPP-922 - Add externalParameters option to Errors
     element.
     Fix a phishing vulnerability: Template generation allows external
     parameters to override placeholders
     The primitive template engine used to render error pages allows
     replacement via query parameters also, though this is not a typical
     need. Because of this feature, it&#39;s possible to cause the SP to
     display some templates containing values supplied externally by URL
     manipulation. Though the values are encoded to prevent script
     injection, the content nevertheless appears to come from the server
     and so would be interpreted as trustworthy, allowing email addresses,
     logos, or support URLs to be manipulated by an attacker.
     This update adds a new &lt;Errors&gt; setting to the configuration called
     externalParameters, which defaults to false. When false, support for
     this &quot;feature&quot; is disabled.
     <a href="https://shibboleth.net/community/advisories/secadv_20210317.txt">https://shibboleth.net/community/advisories/secadv_20210317.txt</a>
     <a href="https://issues.shibboleth.net/jira/browse/SSPCPP-922">https://issues.shibboleth.net/jira/browse/SSPCPP-922</a>
     Thanks to Scott Cantor (Closes: #<a href="bugreport.cgi?bug=985405">985405</a>)
Checksums-Sha256: 
 c33ef8a0c0735abe7348e9825588bba01ac62325a6dc4375be21b153b8c0fd88 3034 shibboleth-sp_3.0.4+dfsg1-1+deb10u1.dsc
 6790ac56e79c215dd38a065c94905b979185b72294d3fce2cd78ba43995831f4 79324 shibboleth-sp_3.0.4+dfsg1-1+deb10u1.debian.tar.xz
 6f33456c355d811803afba004f90810f54fdd1f2398f3486fe73f8be0ca53b22 13808 shibboleth-sp_3.0.4+dfsg1-1+deb10u1_amd64.buildinfo
 b327701d111da4b5da370eddc945c382abc378ff9445e1eda9554c0d7e6f1dca 629664 shibboleth-sp_3.0.4+dfsg1.orig.tar.xz
Checksums-Sha1: 
 b772eca334b15268404717420e899765f6d19d38 3034 shibboleth-sp_3.0.4+dfsg1-1+deb10u1.dsc
 41ce923aef344361e7df8f2625f31ef3d84cf85f 79324 shibboleth-sp_3.0.4+dfsg1-1+deb10u1.debian.tar.xz
 f73d4690f2fad69caaac1beb0a871266b732c309 13808 shibboleth-sp_3.0.4+dfsg1-1+deb10u1_amd64.buildinfo
 cf6064d46a963cd5704439d0124bd7333ea8447e 629664 shibboleth-sp_3.0.4+dfsg1.orig.tar.xz
Files: 
 b2030bd2eafac8728d6aa75d9bf7eca0 3034 web optional shibboleth-sp_3.0.4+dfsg1-1+deb10u1.dsc
 74d4b3c702dd8219f9f81720c7fc5bc1 79324 web optional shibboleth-sp_3.0.4+dfsg1-1+deb10u1.debian.tar.xz
 ee57dbfb6777b3d0c9f64eced6efab02 13808 web optional shibboleth-sp_3.0.4+dfsg1-1+deb10u1_amd64.buildinfo
 050e90a66472f17e81acd2ab21b677c2 629664 web optional shibboleth-sp_3.0.4+dfsg1.orig.tar.xz

-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEwddEx0RNIUL7eugtOsj3Fkd+2yMFAmBSaYsACgkQOsj3Fkd+
2yOZyQ/+JOqrW/hSIdV64BRu0wYR7+gwrRM2/a29Dy9zZYKr1AAF6i2IgAmCYic2
7kNOmqKwqjEDpEf50NizKqcMxqqjlwE7M0sBz7pMIw2IR2VWL1HzOQgs1uP0HfLB
uU3sP9JUY6HmRMoZyjDsEx1iyLmHRsQ3Lb1+eMb5w/Rx7Fn1tOOlKmBE/0zOqy6A
m1drxjGtRoY65bOnjoqTJ1mUWJVLySg7OXMCsop2pCpftGDCSzSMDl7DWErM2OMF
CsisB5jx9RB3OsxYr2H7mQNY3LW7CI5MT2CKw92n7Ebv3WqSMltUjiDPj0Qqy4Pp
w9qv8mZ8iyEA7SQH13hKVSP0R7Ss7FeZIsRzjOHXocwZpxU+T+wVSNzeuD75oA8M
rP8TTDk7fSGTjhxg/rIffH04+RiJ1rDvSC1gncLphjUNzok5tnzs9OBaYH9Hy6sP
xQLCC+SCO8xfGBGM5dJgLJqzZ1jmdPFVd96wmzRdFNzdnMsCqSMlz/nexIYCjk1z
WafbGbjN+QnpuCRqDD15ySXZSE29KWvbBwnz8ULYf79RQp0AynkOLwub/3MQgXmQ
f+/adJACwlApqo+XP/hvuHsWo/VmgfxN7pNNvZTFvvPqwKlPD897phYFFUM48hKw
eVP3aDn4mkBfWQM6HlCIi9bwAF7CVnCTkFQEnAL6OtcSKpQJ4ZM=
=miVA
-----END PGP SIGNATURE-----



</pre>

<div class="msgreceived"><hr><p>
<a name="30"></a>
<!-- command:archive -->
<!-- requester: Debbugs Internal Request &lt;owner@bugs.debian.org&gt; -->
<!-- request_addr: internal_control@bugs.debian.org -->
<!-- time:1619162680 -->
<!-- new_data:
$new_data = {};
-->
<!-- old_data:
$old_data = {};
-->
<strong>Bug archived.</strong>
Request was from <code>Debbugs Internal Request &lt;owner@bugs.debian.org&gt;</code>
to <code>internal_control@bugs.debian.org</code>.
 (Fri, 23 Apr 2021 07:24:40 GMT) (<a href="bugreport.cgi?bug=985405;msg=31">full text</a>, <a href="bugreport.cgi?bug=985405;mbox=yes;msg=31">mbox</a>, <a href="#30">link</a>).</p></p></div>

<hr>
<p class="msgreceived">Send a report that <a href="https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=985405">this bug log contains spam</a>.</p>
<hr>
<ADDRESS>Debian bug tracking system administrator &lt;<A HREF="mailto:owner@bugs.debian.org">owner@bugs.debian.org</A>&gt;.
Last modified:
<!--timestamp-->Sat Oct 30 18:22:11 2021<!--end timestamp-->; 
Machine Name:
<!--machinename-->bembo<!--machinename-->
<P>
<A HREF="https://www.debian.org/Bugs/">Debian Bug tracking system</A>
</p>
<p>
  Debbugs is free software and licensed under the terms of the GNU
  Public License version 2. The current version can be obtained
  from <a href="https://bugs.debian.org/debbugs-source/">https://bugs.debian.org/debbugs-source/</a>.
</p>
<p>
Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.
</p>
</ADDRESS>

</body>
</html>
