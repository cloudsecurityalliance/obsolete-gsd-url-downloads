<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>CVE-2021-24213: GiveWP &lt;= 2.9.7 Reflected Cross Site Scripting </title>
		<meta name="viewport" content="width=device-width">
		
		<link rel="stylesheet" href="https://bentl.ee/css/hybrid.css">
		<link rel="stylesheet" href="https://bentl.ee/css/style.css">
		<link rel="stylesheet" href="https://bentl.ee/css/colors-dark.css">

		
	</head>
	<body>
		<header id="header">
			<h1><a href="https://bentl.ee/">bentl.ee</a></h1>
			<p></p>
		</header>

		<div id="page">
			<div id="sidebar">
				<nav>
	
		<ul class="nav">
			
				<li><a href="/about/"><span>About</span></a></li>
			
				<li><a href="/"><span>Home</span></a></li>
			
		</ul>
	
		<ul class="nav">
			
				<li><a href="/projects/"><span>Projects</span></a></li>
			
				<li><a href="/tutorials/"><span>Tutorials</span></a></li>
			
		</ul>
	
</nav>
			</div>

			<div id="content">
				
	<article class="post">
		<h1><a href="https://bentl.ee/posts/cve-givewp/">CVE-2021-24213: GiveWP &lt;= 2.9.7 Reflected Cross Site Scripting </a> </h1>

		<div class="post-content"><p>During source code review, I noticed a XSS vulnerability in the 2.9.7 version of the GiveWP WordPress plugin. It appears to have been vulnerable since 2.4.0. It has been fixed in 2.10.0.</p>
<h1 id="proof-of-concept">Proof of Concept</h1>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">http://localhost/wp-admin/edit.php?s<span style="color:#f92672">=</span>%22%3E&lt;script&gt;alert<span style="color:#f92672">(</span>0<span style="color:#f92672">)</span>&lt;/script&gt;&amp;start-date&amp;end-date&amp;form_id<span style="color:#f92672">=</span>0&amp;action<span style="color:#f92672">=</span>-1&amp;paged<span style="color:#f92672">=</span>1&amp;give_action<span style="color:#f92672">=</span>delete_bulk_donor&amp;orderby<span style="color:#f92672">=</span>id&amp;order<span style="color:#f92672">=</span>DESC&amp;action2<span style="color:#f92672">=</span>-1&amp;post_type<span style="color:#f92672">=</span>give_forms&amp;page<span style="color:#f92672">=</span>give-donors&amp;view<span style="color:#f92672">=</span>donors
</code></pre></div><h1 id="impact">Impact</h1>
<p>As of this writing, GiveWP is installed on <a href="https://wordpress.org/plugins/give/">100,000+ WP instances</a>. This vulnerability has been present <a href="https://github.com/impress-org/givewp/commit/097c4d0ab964493776950381ed64498040395f6b">since at least 2.4.0 (Jan 16th 2019)</a>. It may have been present earlier in another form. This vulnerability requires user interaction from an admin in order to be exploited.</p>
<h1 id="resolution">Resolution</h1>
<p>Install GiveWP 2.10.0 to remediate this issue. After I notified GiveWP, they released a fix the same day, around 8 hours later.</p>
<h1 id="analysis">Analysis</h1>
<p>In <code>class-donor-table.php</code>, we can see the source of the vulnerable parameter does not have any form of sanitation applied:
<img src="/cve/givewp-source.png" alt="GiveWP source"></p>
<p>We can identify in the sink that the above source is called directly. No sanitation is applied before the sink:
<img src="/cve/givewp-sink.png" alt="GiveWP sink"></p>
<p>We can identify that the sink is later included in <code>donors.php</code>. This page is visible to administrators at <code>/wp-admin/edit.php?post_type=give_forms&amp;page=give-donors</code>:
<img src="/cve/givewp-donors.png" alt="GiveWP donors.php"></p>
<p>To confirm the vulnerability, a request was crafted in Burp Suite: (payload highlighted)
<img src="/cve/givewp-burp-request.png" alt="Burp request"></p>
<p>We can then see the payload reflected in the response:
<img src="/cve/givewp-burp-response.png" alt="Burp response"></p>
<h1 id="testing-setup">Testing Setup</h1>
<ul>
<li>GiveWP 2.9.7</li>
<li>WordPress 5.7</li>
<li>XAMPP 7.4.16</li>
<li>Firefox 86.0.1</li>
<li>Default configurations on all products</li>
</ul>
<h1 id="disclosure-log">Disclosure Log</h1>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">3/21/2021 -- Emailed GiveWP <span style="color:#66d9ef">for</span> security contact information
3/22/2021 -- WPScan CNA issued CVE-2021-24213 <span style="color:#f92672">(</span>un-released<span style="color:#f92672">)</span>
3/22/2021 9AM -- Provided vendor with PoC
3/22/2021 5PM -- Vendor provided fix in 2.10.0
3/23/2021 8AM -- Fix validated, article posted, CVE unlocked
</code></pre></div></div>

		<p class="meta">Posted on <span class="postdate">23. March 2021</span></p>
	</article>

			</div>
		</div>

		
	</body>
</html>
