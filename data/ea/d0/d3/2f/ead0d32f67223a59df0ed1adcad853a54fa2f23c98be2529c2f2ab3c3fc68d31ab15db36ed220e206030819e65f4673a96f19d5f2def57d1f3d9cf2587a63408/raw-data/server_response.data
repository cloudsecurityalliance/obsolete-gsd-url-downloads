<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
<link rel="icon" href="/favicon.png">
<title>#908000 - zsh: CVE-2018-0502 + CVE-2018-13259: Two security bugs in shebang line parsing - Debian Bug report logs</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="/css/bugs.css" type="text/css">

<link rel="canonical" href="&lt;a href=&quot;bugreport.cgi?bug=908000&quot;&gt;908000&lt;/a&gt;">
<script type="text/javascript">
<!--
function toggle_infmessages()
{
        allDivs=document.getElementsByTagName("div");
        for (var i = 0 ; i < allDivs.length ; i++ )
        {
                if (allDivs[i].className == "infmessage")
                {
                        allDivs[i].style.display=(allDivs[i].style.display == 'none' | allDivs[i].style.display == '') ? 'block' : 'none';
                }
        }
}
-->
</script>
</head>
<body>
<h1>Debian Bug report logs - 
<a href="mailto:908000@bugs.debian.org">#908000</a><br>
zsh: CVE-2018-0502 + CVE-2018-13259: Two security bugs in shebang line parsing</h1>
<div class="versiongraph"><a href="version.cgi?fixed=zsh%2F5.6-1;collapse=1;found=zsh%2F5.5.1-1;found=zsh%2F5.3.1-4;info=1;absolute=0;package=zsh"><img alt="version graph" src="version.cgi?fixed=zsh%2F5.6-1;collapse=1;width=2;found=zsh%2F5.5.1-1;found=zsh%2F5.3.1-4;absolute=0;height=2;package=zsh"></a></div>
<div class="pkginfo">
  <p>Package:
     <a class="submitter" href="pkgreport.cgi?package=zsh">zsh</a>;
Maintainer for <a href="pkgreport.cgi?package=zsh">zsh</a> is <a href="pkgreport.cgi?maint=pkg-zsh-devel%40lists.alioth.debian.org">Debian Zsh Maintainers &lt;pkg-zsh-devel@lists.alioth.debian.org&gt;</a>; Source for <a href="pkgreport.cgi?package=zsh">zsh</a> is <a href="pkgreport.cgi?src=zsh">src:zsh</a> (<a href="https://tracker.debian.org/pkg/zsh">PTS</a>, <a href="https://buildd.debian.org/zsh">buildd</a>, <a href="https://qa.debian.org/popcon.php?package=zsh">popcon</a>). </p>

</div>

<div class="buginfo">
  <p>Reported by: <a href="pkgreport.cgi?submitter=abe%40debian.org">Axel Beckert &lt;abe@debian.org&gt;</a></p>
  <p>Date: Wed,  5 Sep 2018 00:27:02 UTC</p>

<p>Severity: important</p>
<p>Tags: security</p>

<p>Found in versions zsh/5.5.1-1, zsh/5.3.1-4</p>
<p>Fixed in version zsh/5.6-1</p>



</div>

<p><a href="mailto:908000@bugs.debian.org">Reply</a> or <a href="mailto:908000-subscribe@bugs.debian.org">subscribe</a> to this bug.</p>
<p><a href="javascript:toggle_infmessages();">Toggle useless messages</a></p><div class="msgreceived"><p>View this report as an <a href="bugreport.cgi?bug=908000;mbox=yes">mbox folder</a>, <a href="bugreport.cgi?bug=908000;mbox=yes;mboxstatus=yes">status mbox</a>, <a href="bugreport.cgi?bug=908000;mbox=yes;mboxmaint=yes">maintainer mbox</a></p></div>

<div class="infmessage"><hr><p>
<a name="1"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, abe@debian.org, danielsh@apache.org, team@security.debian.org, Debian Zsh Maintainers &lt;pkg-zsh-devel@lists.alioth.debian.org&gt; -->
<!-- time:1536107224 -->
<strong>Report forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, abe@debian.org, danielsh@apache.org, team@security.debian.org, Debian Zsh Maintainers &lt;pkg-zsh-devel@lists.alioth.debian.org&gt;</code>:<br>
<code>Bug#908000</code>; Package <code>zsh</code>.
 (Wed, 05 Sep 2018 00:27:04 GMT) (<a href="bugreport.cgi?bug=908000;msg=2">full text</a>, <a href="bugreport.cgi?bug=908000;mbox=yes;msg=2">mbox</a>, <a href="#1">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="3"></a>
<!-- request_addr: Axel Beckert &lt;abe@debian.org&gt; -->
<!-- time:1536107224 -->
<strong>Acknowledgement sent</strong>
to <code>Axel Beckert &lt;abe@debian.org&gt;</code>:<br>
New Bug report received and forwarded.  Copy sent to <code>abe@debian.org, danielsh@apache.org, team@security.debian.org, Debian Zsh Maintainers &lt;pkg-zsh-devel@lists.alioth.debian.org&gt;</code>.
 (Wed, 05 Sep 2018 00:27:04 GMT) (<a href="bugreport.cgi?bug=908000;msg=4">full text</a>, <a href="bugreport.cgi?bug=908000;mbox=yes;msg=4">mbox</a>, <a href="#3">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="5"></a><a name="msg5"></a><a href="#5">Message #5</a> received at submit@bugs.debian.org (<a href="bugreport.cgi?bug=908000;msg=5">full text</a>, <a href="bugreport.cgi?bug=908000;mbox=yes;msg=5">mbox</a>, <a href="mailto:908000@bugs.debian.org?body=On%20Wed%2C%2005%20Sep%202018%2002%3A23%3A05%20%2B0200%20Axel%20Beckert%20%3Cabe%40debian.org%3E%20wrote%3A%0A%3E%20Package%3A%20zsh%0A%3E%20Version%3A%205.5.1-1%0A%3E%20Severity%3A%20grave%0A%3E%20Tags%3A%20security%0A%3E%20Control%3A%20found%20-1%205.3.1-4%0A%3E%20Control%3A%20fixed%20-1%205.6-1%0A%3E%20%0A%3E%20Hi%2C%0A%3E%20%0A%3E%20these%20two%20issues%20have%20been%20already%20fixed%20with%20the%205.6-1%20upload%20which%0A%3E%20happened%20just%20minutes%20after%20the%20embargo%20for%20these%20issues%20was%20over.%0A%3E%20%0A%3E%20Because%20of%20the%20embargo%20there%20wasn%27t%20a%20proper%20bug%20report%20yet.%20So%20this%20bug%0A%3E%20report%20is%20primarily%20to%20track%20the%20fix%20of%20these%20issues%20in%20Debian%20Buster%2C%0A%3E%20Stretch%20and%20maybe%20also%20in%20Debian%20%28E%29LTS%20releases.%0A%3E%20%0A%3E%20From%20the%20upstream%205.6%20release%20notes%3A%0A%3E%20%3E%20CVE-2018-0502%3A%20Data%20from%20the%20second%20line%20of%20a%20%23%21%20script%20file%20might%20be%0A%3E%20%3E%20passed%20to%20execve%28%29.%20%20For%20example%2C%20in%20the%20following%20situation%20-%0A%3E%20%3E%0A%3E%20%3E%20%20%20%20%20printf%20%27%23%21foo%5Cnbar%27%20%3E%20baz%0A%3E%20%3E%20%20%20%20%20.%2Fbaz%0A%3E%20%3E%0A%3E%20%3E%20the%20shell%20might%20take%20%22bar%22%20rather%20than%20%22foo%22%20for%20the%20argv%5B0%5D%20to%20be%0A%3E%20%3E%20passed%20to%20execve%28%29.%20%20%5B%20Reported%20by%20Anthony%20Sottile%20and%20Buck%20Evan.%20%5D%0A%3E%20%3E%0A%3E%20%3E%20CVE-2018-13259%3A%20A%20shebang%20line%20longer%20than%2064%20characters%20would%20be%0A%3E%20%3E%20truncated.%20%20For%20example%2C%20in%20the%20following%20situation%3A%0A%3E%20%3E%0A%3E%20%3E%20%20%20%20%20%28%20printf%20%27%23%21%27%3B%20repeat%2064%20printf%20%27x%27%3B%20printf%20%27y%27%20%29%20%3E%20foo%0A%3E%20%3E%20%20%20%20%20.%2Ffoo%0A%3E%20%3E%0A%3E%20%3E%20the%20shell%20might%20execute%20x...x%20%2864%20repetitions%29%20rather%20than%20x...xy%20%2864%0A%3E%20%3E%20x%27s%2C%20one%20y%29.%20%20%5B%20Reported%20by%20Daniel%20Shahaf.%20%5D%0A%3E%20%0A%3E%20Links%20into%20the%20Debian%20Security%20Tracker%3A%0A%3E%20%0A%3E%20https%3A%2F%2Fsecurity-tracker.debian.org%2Ftracker%2FCVE-2018-0502%0A%3E%20https%3A%2F%2Fsecurity-tracker.debian.org%2Ftracker%2FCVE-2018-13259%0A%3E%20%0A%3E%20%28JFTR%3A%20The%20Debian%20Security%20Team%20doesn%27t%20consider%20a%20DSA%20necessary%20for%0A%3E%20these%20issues%20and%20recommends%20to%20fix%20the%20issues%20in%20Stretch%20via%20the%20next%0A%3E%20Debian%20Minor%20Stable%20Update.%29%0A%3E%20%0A%3E%20Upstream%20release%20announcement%3A%0A%3E%20%0A%3E%20https%3A%2F%2Fwww.zsh.org%2Fmla%2Fzsh-announce%2F136%0A%3E%20%0A%3E%20Upstream%20fix%2Fpatch%3A%0A%3E%20%0A%3E%20https%3A%2F%2Fsourceforge.net%2Fp%2Fzsh%2Fcode%2Fci%2F1c4c7b6a4d17294df028322b70c53803a402233d%0A%3E%20%0A%3E%20%28Details%20about%20affected%20versions%20will%20follow%20soon.%29%0A%3E%20%0A%3E%20%0A&amp;References=%3C87lg8gdc7q.fsf%40c6.deuxchevaux.org%3E&amp;subject=Re%3A%20zsh%3A%20CVE-2018-0502%20%2B%20CVE-2018-13259%3A%20Two%20security%20bugs%20in%20shebang%20line%20parsing&amp;In-Reply-To=%3C87lg8gdc7q.fsf%40c6.deuxchevaux.org%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=abe%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Axel Beckert &lt;abe@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> Debian Bug Tracking System &lt;submit@bugs.debian.org&gt;</div>
<div class="header"><span class="headerfield">Subject:</span> zsh: CVE-2018-0502 + CVE-2018-13259: Two security bugs in shebang line parsing</div>
<div class="header"><span class="headerfield">Date:</span> Wed, 05 Sep 2018 02:23:05 +0200</div>
</div>
<pre class="message">Package: zsh
Version: 5.5.1-1
Severity: grave
Tags: security
Control: found -1 5.3.1-4
Control: fixed -1 5.6-1

Hi,

these two issues have been already fixed with the 5.6-1 upload which
happened just minutes after the embargo for these issues was over.

Because of the embargo there wasn&#39;t a proper bug report yet. So this bug
report is primarily to track the fix of these issues in Debian Buster,
Stretch and maybe also in Debian (E)LTS releases.

From the upstream 5.6 release notes:
&gt; <a href="https://security-tracker.debian.org/tracker/CVE-2018-0502">CVE-2018-0502</a>: Data from the second line of a #! script file might be
&gt; passed to execve().  For example, in the following situation -
&gt;
&gt;     printf &#39;#!foo\nbar&#39; &gt; baz
&gt;     ./baz
&gt;
&gt; the shell might take &quot;bar&quot; rather than &quot;foo&quot; for the argv[0] to be
&gt; passed to execve().  [ Reported by Anthony Sottile and Buck Evan. ]
&gt;
&gt; <a href="https://security-tracker.debian.org/tracker/CVE-2018-13259">CVE-2018-13259</a>: A shebang line longer than 64 characters would be
&gt; truncated.  For example, in the following situation:
&gt;
&gt;     ( printf &#39;#!&#39;; repeat 64 printf &#39;x&#39;; printf &#39;y&#39; ) &gt; foo
&gt;     ./foo
&gt;
&gt; the shell might execute x...x (64 repetitions) rather than x...xy (64
&gt; x&#39;s, one y).  [ Reported by Daniel Shahaf. ]

Links into the Debian Security Tracker:

<a href="https://security-tracker.debian.org/tracker/CVE-2018-0502">https://security-tracker.debian.org/tracker/CVE-2018-0502</a>
<a href="https://security-tracker.debian.org/tracker/CVE-2018-13259">https://security-tracker.debian.org/tracker/CVE-2018-13259</a>

(JFTR: The Debian Security Team doesn&#39;t consider a DSA necessary for
these issues and recommends to fix the issues in Stretch via the next
Debian Minor Stable Update.)

Upstream release announcement:

<a href="https://www.zsh.org/mla/zsh-announce/136">https://www.zsh.org/mla/zsh-announce/136</a>

Upstream fix/patch:

<a href="https://sourceforge.net/p/zsh/code/ci/1c4c7b6a4d17294df028322b70c53803a402233d">https://sourceforge.net/p/zsh/code/ci/1c4c7b6a4d17294df028322b70c53803a402233d</a>

(Details about affected versions will follow soon.)


</pre>

<div class="msgreceived"><hr><p>
<a name="6"></a>
<!-- command:found -->
<!-- requester: Axel Beckert &lt;abe@debian.org&gt; -->
<!-- request_addr: submit@bugs.debian.org -->
<!-- time:1536107224 -->
<!-- new_data:
$new_data = {
              &#39;found_versions&#39; =&gt; [
                                    &#39;zsh/5.5.1-1&#39;,
                                    &#39;zsh/5.3.1-4&#39;
                                  ]
            };
-->
<!-- old_data:
$old_data = {
              &#39;found_versions&#39; =&gt; [
                                    &#39;zsh/5.5.1-1&#39;
                                  ]
            };
-->
<strong>Marked as found in versions zsh/5.3.1-4.</strong>
Request was from <code>Axel Beckert &lt;abe@debian.org&gt;</code>
to <code>submit@bugs.debian.org</code>.
 (Wed, 05 Sep 2018 00:27:04 GMT) (<a href="bugreport.cgi?bug=908000;msg=7">full text</a>, <a href="bugreport.cgi?bug=908000;mbox=yes;msg=7">mbox</a>, <a href="#6">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="8"></a>
<!-- command:fixed -->
<!-- requester: Axel Beckert &lt;abe@debian.org&gt; -->
<!-- request_addr: submit@bugs.debian.org -->
<!-- time:1536107225 -->
<!-- new_data:
$new_data = {
              &#39;fixed_versions&#39; =&gt; [
                                    &#39;zsh/5.6-1&#39;
                                  ]
            };
-->
<!-- old_data:
$old_data = {
              &#39;fixed_versions&#39; =&gt; []
            };
-->
<strong>Marked as fixed in versions zsh/5.6-1.</strong>
Request was from <code>Axel Beckert &lt;abe@debian.org&gt;</code>
to <code>submit@bugs.debian.org</code>.
 (Wed, 05 Sep 2018 00:27:05 GMT) (<a href="bugreport.cgi?bug=908000;msg=9">full text</a>, <a href="bugreport.cgi?bug=908000;mbox=yes;msg=9">mbox</a>, <a href="#8">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="10"></a>
<!-- requester: Axel Beckert &lt;abe@debian.org&gt; -->
<!-- request_addr: control@bugs.debian.org -->
<!-- time:1581883382 -->
<strong>Severity set to &#39;important&#39; from &#39;grave&#39;</strong>
Request was from <code>Axel Beckert &lt;abe@debian.org&gt;</code>
to <code>control@bugs.debian.org</code>.
 (Sun, 16 Feb 2020 20:03:02 GMT) (<a href="bugreport.cgi?bug=908000;msg=11">full text</a>, <a href="bugreport.cgi?bug=908000;mbox=yes;msg=11">mbox</a>, <a href="#10">link</a>).</p></p></div>

<hr>
<p class="msgreceived">Send a report that <a href="https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=908000">this bug log contains spam</a>.</p>
<hr>
<ADDRESS>Debian bug tracking system administrator &lt;<A HREF="mailto:owner@bugs.debian.org">owner@bugs.debian.org</A>&gt;.
Last modified:
<!--timestamp-->Sat Oct 30 18:19:48 2021<!--end timestamp-->; 
Machine Name:
<!--machinename-->bembo<!--machinename-->
<P>
<A HREF="https://www.debian.org/Bugs/">Debian Bug tracking system</A>
</p>
<p>
  Debbugs is free software and licensed under the terms of the GNU
  Public License version 2. The current version can be obtained
  from <a href="https://bugs.debian.org/debbugs-source/">https://bugs.debian.org/debbugs-source/</a>.
</p>
<p>
Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.
</p>
</ADDRESS>

</body>
</html>
