<!DOCTYPE html>
<html lang="en">
  <head>
    <title>13374 &ndash; (CVE-2018-1140) [SECURITY] CVE-2018-1140 ldbsearch '(distinguishedName=abc)' and DNS query with escapes crashes</title>

      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1">

<link href="data/assets/9a550fbe5564198f829468c7984d86b3.css" rel="stylesheet" type="text/css">



    
<script type="text/javascript" src="data/assets/a7c2f3a028f17a9aa60f56dc9d6e732d.js"></script>

    <script type="text/javascript">
    <!--
        YAHOO.namespace('bugzilla');
        YAHOO.util.Event.addListener = function (el, sType, fn, obj, overrideContext) {
               if ( ("onpagehide" in window || YAHOO.env.ua.gecko) && sType === "unload") { sType = "pagehide"; };
               var capture = ((sType == "focusin" || sType == "focusout") && !YAHOO.env.ua.ie) ? true : false;
               return this._addListener(el, this._getType(sType), fn, obj, overrideContext, capture);
         };
        if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
            YAHOO.util.Event._simpleRemove(window, "unload", 
                                           YAHOO.util.Event._unload);
        }
        
        function unhide_language_selector() { 
            YAHOO.util.Dom.removeClass(
                'lang_links_container', 'bz_default_hidden'
            ); 
        } 
        YAHOO.util.Event.onDOMReady(unhide_language_selector);

        
        var BUGZILLA = {
            param: {
                cookiepath: '\/',
                maxusermatches: 10
            },
            constant: {
                COMMENT_COLS: 80
            },
            string: {
                

                attach_desc_required:
                    "You must enter a Description for this attachment.",
                component_required:
                    "You must select a Component for this bug.",
                description_required:
                    "You must enter a Description for this bug.",
                short_desc_required:
                    "You must enter a Summary for this bug.",
                version_required:
                    "You must select a Version for this bug."
            }
              , api_token: ''
        };

    if (history && history.replaceState) {
      if(!document.location.href.match(/show_bug\.cgi/)) {
        history.replaceState( null,
                             "13374 – (CVE-2018-1140) [SECURITY] CVE-2018-1140 ldbsearch \'(distinguishedName=abc)\' and DNS query with escapes crashes",
                             "show_bug.cgi?id=13374" );
        document.title = "13374 – (CVE-2018-1140) [SECURITY] CVE-2018-1140 ldbsearch \'(distinguishedName=abc)\' and DNS query with escapes crashes";
      }
      if (document.location.href.match(/show_bug\.cgi\?.*list_id=/)) {
        var href = document.location.href;
        href = href.replace(/[\?&]+list_id=(\d+|cookie)/, '');
        history.replaceState(null, "13374 – (CVE-2018-1140) [SECURITY] CVE-2018-1140 ldbsearch \'(distinguishedName=abc)\' and DNS query with escapes crashes", href);
      }
    }
    YAHOO.util.Event.onDOMReady(function() {
      initDirtyFieldTracking();

    });
    // -->
    </script>
<script type="text/javascript" src="data/assets/daf5e0fb6826e6a35280e622913f0c4a.js"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="The Samba-Bugzilla" href="./search_plugin.cgi">
    <link rel="shortcut icon" href="favicon.ico">
  </head>

  <body 
        class="bugzilla-samba-org
                 bz_bug
                 bz_status_RESOLVED
                 bz_product_Samba_4.1_and_newer
                 bz_component_AD&#X3A;_LDB_DSDB_SAMDB
                 bz_bug_13374 yui-skin-sam">

  <div id="header"><div style="background-image:url(/images/blueHeaderSimple.png);
 background-repeat:repeat-x;
 background-size: contain;
 height:24px;
 border-radius: 38px 10px;
">
</div>

    <div id="titles">
      <span id="title">The Samba-Bugzilla &ndash; Bug&nbsp;13374</span>

        <span id="subtitle" class="subheader">[SECURITY] CVE-2018-1140 ldbsearch '(distinguishedName=abc)' and DNS query with escapes crashes</span>

        <span id="information" class="header_addl_info">Last modified: 2018-08-24 09:28:16 UTC</span>
    </div>


    <div id="common_links"><ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi">New</a></li>
  <li><span class="separator">| </span><a href="describecomponents.cgi">Browse</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_top" name="no_redirect" value="0">
    <script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_top");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_top" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_top"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li>
      <span class="separator">| </span>
        <a href="request.cgi">Requests</a></li>


  <li>
        <span class="separator">| </span>
        <a href="https://bugzilla.readthedocs.org/en/5.0/using/understanding.html" target="_blank">Help</a>
      </li>
    
      <li id="new_account_container_top">
        <span class="separator">| </span>
        <a href="createaccount.cgi">New&nbsp;Account</a>
      </li>

    <li id="mini_login_container_top">
  <span class="separator">| </span>
  <a id="login_link_top" href="show_bug.cgi?id=13374&amp;GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('_top')">Log In</a>

  <form action="show_bug.cgi?id=13374" method="POST"
        class="mini_login bz_default_hidden"
        id="mini_login_top">
    <input id="Bugzilla_login_top" required
           name="Bugzilla_login" class="bz_login"
        type="email" placeholder="Email Address">
    <input class="bz_password" name="Bugzilla_password" type="password"
           id="Bugzilla_password_top" required
           placeholder="Password">
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
            id="log_in_top">
    <a href="#" onclick="return hide_mini_login_form('_top')">[x]</a>
  </form>
</li>


  <li id="forgot_container_top">
    <span class="separator">| </span>
    <a id="forgot_link_top" href="show_bug.cgi?id=13374&amp;GoAheadAndLogIn=1#forgot"
       onclick="return show_forgot_form('_top')">Forgot Password</a>
    <form action="token.cgi" method="post" id="forgot_form_top"
          class="mini_forgot bz_default_hidden">
      <label for="login_top">Login:</label>
      <input name="loginname" size="20" id="login_top" required
          type="email" placeholder="Your Email Address">
      <input id="forgot_button_top" value="Reset Password" type="submit">
      <input type="hidden" name="a" value="reqpw">
      <input type="hidden" id="token_top" name="token"
             value="1635630129-GhugNKDCkeLmo8B0-kAT2soLf8Q1yr_-biFK2nW4I1I">
      <a href="#" onclick="return hide_forgot_form('_top')">[x]</a>
    </form>
  </li>
</ul>
    </div>
  </div>

  <div id="bugzilla-body">


<script type="text/javascript">
<!--

//-->
</script>

<form name="changeform" id="changeform" method="post" action="process_bug.cgi">

  <input type="hidden" name="delta_ts" value="2018-08-24 09:28:16">
  <input type="hidden" name="id" value="13374">
  <input type="hidden" name="token" value="1635630129-uOsfoUuU7ghHpgCX8uN244YOPThV0o29D-Ja8SB7UAs">
<div class="bz_short_desc_container edit_form">
     <a href="show_bug.cgi?id=13374"><b>Bug&nbsp;13374</b></a> <span id="summary_container" class="bz_default_hidden">
        (<span id="alias_nonedit_display">CVE-2018-1140</span>)
      - <span id="short_desc_nonedit_display">[SECURITY] CVE-2018-1140 ldbsearch '(distinguishedName=abc)' and DNS query with escapes crashes</span>
     </span>

    <div id="summary_input"><span class="field_label "
    id="field_label_short_desc">


  <a 
      title="The bug summary is a short sentence which succinctly describes what the bug is about."
      class="field_help_link"
      href="page.cgi?id=fields.html#short_desc"
  >Summary:</a>

</span><span title="[SECURITY] CVE-2018-1140 ldbsearch '(distinguishedName=abc)' and DNS query with escapes crashes">[SECURITY] CVE-2018-1140 ldbsearch '(distinguishedName=abc)' and DNS query wi...
        </span>
    </div>
  </div>
  <script type="text/javascript">
    hideEditableField('summary_container',
                      'summary_input',
                      'summary_edit_action',
                      'short_desc',
                      '[SECURITY] CVE-2018-1140 ldbsearch \'(distinguishedName=abc)\' and DNS query with escapes crashes' );
  </script>
  <table class="edit_form">
    <tr>
      
      <td id="bz_show_bug_column_1" class="bz_show_bug_column">     
        <table>
          <tr>
    <th class="field_label">
      <a href="page.cgi?id=fields.html#bug_status">Status</a>:
    </th>
    <td id="bz_field_status">
      <span id="static_bug_status">RESOLVED
          FIXED
      </span>
    </td>
  </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_alias">


  <a 
      title="A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla."
      class="field_help_link"
      href="page.cgi?id=fields.html#alias"
  >Alias:</a>

</th>
    <td>CVE-2018-1140
    </td>
  </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_product">


  <a 
      title="Bugs are categorised into Products and Components."
      class="field_help_link"
      href="describecomponents.cgi"
  >Product:</a>

</th>
  <td class="field_value "
      id="field_container_product" >Samba 4.1 and newer

</td>
    </tr>

    
    <tr class="bz_default_hidden"><th class="field_label "
    id="field_label_classification">


  <a 
      title="Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation."
      class="field_help_link"
      href="page.cgi?id=fields.html#classification"
  >Classification:</a>

</th>
  <td class="field_value "
      id="field_container_classification" >Unclassified

</td>
    </tr>
        
    
    
    <tr><th class="field_label "
    id="field_label_component">


  <a 
      title="Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list."
      class="field_help_link"
      href="describecomponents.cgi?product=Samba 4.1 and newer"
  >Component:</a>

</th>
  <td class="field_value "
      id="field_container_component" >AD: LDB/DSDB/SAMDB

  (<a href="buglist.cgi?component=AD%3A%20LDB%2FDSDB%2FSAMDB&amp;product=Samba%204.1%20and%20newer&amp;bug_status=__open__"
      target="_blank">show other bugs</a>)
</td>
    </tr>
    <tr><th class="field_label "
    id="field_label_version">


  <a 
      title="The version field defines the version of the software the bug was found in."
      class="field_help_link"
      href="page.cgi?id=fields.html#version"
  >Version:</a>

</th>
<td>4.8.0
  </td>
    </tr>
        
    
        
    <tr><th class="field_label "
    id="field_label_rep_platform">


  <a 
      title="The hardware platform the bug was observed on. Note: When searching, selecting the option &quot;All&quot; only finds bugs whose value for this field is literally the word &quot;All&quot;."
      class="field_help_link"
      href="page.cgi?id=fields.html#rep_platform"
  >Hardware:</a>

</th>
      <td class="field_value">All
        All
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          
          <tr>
      <th class="field_label">
        <label  accesskey="i">
          <a href="page.cgi?id=fields.html#importance"><u>I</u>mportance</a></label>:
      </th>
      <td>P5
       critical<span id="votes_container">
    (<a href="page.cgi?id=voting/user.html&amp;bug_id=13374#vote_13374">vote</a>)
  </span>
      </td>
    </tr>

      <tr><th class="field_label "
    id="field_label_target_milestone">


  <a 
      title="The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it."
      class="field_help_link"
      href="page.cgi?id=fields.html#target_milestone"
  >Target Milestone:</a>

</th><td>---
  </td>
      </tr>
          
          <tr><th class="field_label "
    id="field_label_assigned_to">


  <a 
      title="The person in charge of resolving the bug."
      class="field_help_link"
      href="page.cgi?id=fields.html#assigned_to"
  >Assignee:</a>

</th>
      <td><span class="vcard"><span class="fn">Karolin Seeger</span>
</span>
      </td>
    </tr>

    <tr><th class="field_label "
    id="field_label_qa_contact">


  <a 
      title="The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#qa_contact"
  >QA Contact:</a>

</th>
      <td><span class="vcard"><span class="fn">Samba QA Contact</span>
</span>
      </td>
    </tr>
    <script type="text/javascript">
      assignToDefaultOnChange(['product', 'component'],
        'samba-qa\x40samba.org',
        'samba-qa\x40samba.org');
    </script>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr><th class="field_label "
    id="field_label_bug_file_loc">


  <a 
      title="Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen."
      class="field_help_link"
      href="page.cgi?id=fields.html#bug_file_loc"
  >URL:</a>

</th>
    <td>
      <span id="bz_url_input_area">
      </span>
    </td>
  </tr>


    <tr><th class="field_label "
    id="field_label_keywords">


  <a 
      title="You can add keywords from a defined list to bugs, in order to easily identify and group them."
      class="field_help_link"
      href="describekeywords.cgi"
  >Keywords:</a>

</th>
  <td class="field_value "
      id="field_container_keywords" >

</td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>

          
<tr><th class="field_label "
    id="field_label_dependson">


  <a 
      title="The bugs listed here must be resolved before this bug can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#dependson"
  >Depends on:</a>

</th>

  <td>
    <span id="dependson_input_area">
    </span>

  </td>
  </tr>
  
  <tr><th class="field_label "
    id="field_label_blocked">


  <a 
      title="This bug must be resolved before the bugs listed in this field can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#blocked"
  >Blocks:</a>

</th>

  <td>
    <span id="blocked_input_area">
    </span>
<a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED FIXED - [SECURITY Hardening] DNS query with escapes characters in dns name makes samba crashing"
   href="show_bug.cgi?id=13466">13466</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED FIXED"
   href="show_bug.cgi?id=13509">13509</a> 
  </td>
  </tr>

    <tr>
      <th>&nbsp;</th>

      <td id="show_dependency_tree_or_graph">
        Show dependency <a href="showdependencytree.cgi?id=13374&amp;hide_resolved=1">tree</a>

          /&nbsp;<a href="showdependencygraph.cgi?id=13374">graph</a>
      </td>
    </tr>
          
        </table>
      </td>
      <td>
        <div class="bz_column_spacer">&nbsp;</div>
      </td>
      
      <td id="bz_show_bug_column_2" class="bz_show_bug_column">
        <table>
        <tr>
    <th class="field_label">
      Reported:
    </th>
    <td>2018-04-08 22:07 UTC by <span class="vcard"><span class="fn">Garming Sam</span>
</span>
    </td>
  </tr>
  
  <tr>
    <th class="field_label">
      Modified:
    </th>
    <td>2018-08-24 09:28 UTC
      (<a href="show_activity.cgi?id=13374">History</a>)
    </td>
  
  </tr>
<tr>
      <th class="field_label">
        <label  accesskey="a">
          CC List:
        </label>
      </th>
      <td>18 
          users
          <span id="cc_edit_area_showhide_container" class="bz_default_hidden">
            (<a href="#" id="cc_edit_area_showhide">show</a>)
          </span>
        <div id="cc_edit_area">
          <br>
            <select id="cc" multiple="multiple" size="5" >
                <option value="abartlet">abartlet</option>
                <option value="andrej.gessel">andrej.gessel</option>
                <option value="asn">asn</option>
                <option value="dbagnall">dbagnall</option>
                <option value="dmulder">dmulder</option>
                <option value="garming">garming</option>
                <option value="gary">gary</option>
                <option value="gd">gd</option>
                <option value="huzaifas">huzaifas</option>
                <option value="jmcd">jmcd</option>
                <option value="jra">jra</option>
                <option value="kai">kai</option>
                <option value="kseeger">kseeger</option>
                <option value="laurent.debomy">laurent.debomy</option>
                <option value="meissner">meissner</option>
                <option value="metze">metze</option>
                <option value="samba-vendor">samba-vendor</option>
                <option value="scabrero">scabrero</option>
            </select>
        </div>
          <script type="text/javascript">
            hideEditableField( 'cc_edit_area_showhide_container', 
                               'cc_edit_area', 
                               'cc_edit_area_showhide', 
                               '', 
                               '');  
          </script>
      </td>
    </tr>

<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_see_also">


  <a 
      title="This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields."
      class="field_help_link"
      href="page.cgi?id=fields.html#see_also"
  >See Also:</a>

</th>
  <td class="field_value "
      id="field_container_see_also" >

</td>
    </tr> 

<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>



        </table>
      </td>
    </tr>
    <tr>
      <td colspan="3">
          <hr id="bz_top_half_spacer">
      </td>
    </tr>
  </table>

  <table id="bz_big_form_parts">
  <tr>
  <td>

    
<script type="text/javascript">
<!--
function toggle_display(link) {
    var table = document.getElementById("attachment_table");
    var view_all = document.getElementById("view_all");
    var hide_obsolete_url_parameter = "&hide_obsolete=1";
    // Store current height for scrolling later
    var originalHeight = table.offsetHeight;
    var rows = YAHOO.util.Dom.getElementsByClassName(
        'bz_tr_obsolete', 'tr', table);

    for (var i = 0; i < rows.length; i++) {
        bz_toggleClass(rows[i], 'bz_default_hidden');
    }

    if (YAHOO.util.Dom.hasClass(rows[0], 'bz_default_hidden')) {
        link.innerHTML = "Show Obsolete";
        view_all.href = view_all.href + hide_obsolete_url_parameter 
    }
    else {
        link.innerHTML = "Hide Obsolete";
        view_all.href = view_all.href.replace(hide_obsolete_url_parameter,"");
    }

    var newHeight = table.offsetHeight;
    // This scrolling makes the window appear to not move at all.
    window.scrollBy(0, newHeight - originalHeight);

    return false;
}
//-->
</script>

<br>
<table id="attachment_table">
  <tr id="a0">
    <th colspan="3" class="left">
      Attachments
    </th>
  </tr>


      <tr id="a1" class="bz_contenttype_text_plain bz_patch">
        <td>
            <a href="attachment.cgi?id=14113"
               title="View the content of the attachment">
          <b>Patch for master (no test)</b></a>

          <span class="bz_attach_extra_info">
              (1.46 KB,
                patch)

            <br>
            <a href="#attach_14113"
               title="Go to the comment associated with the attachment">2018-04-08 22:12 UTC</a>,

            <span class="vcard"><span class="fn">Garming Sam</span>
</span>
          </span>
        </td>

          <td class="bz_attach_flags">
              <i>no flags</i>
          </td>

        <td>
          <a href="attachment.cgi?id=14113&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a2" class="bz_contenttype_text_plain bz_patch">
        <td>
            <a href="attachment.cgi?id=14206"
               title="View the content of the attachment">
          <b>patch also sent with the original report</b></a>

          <span class="bz_attach_extra_info">
              (1.35 KB,
                patch)

            <br>
            <a href="#attach_14206"
               title="Go to the comment associated with the attachment">2018-05-20 23:24 UTC</a>,

            <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
          </span>
        </td>

          <td class="bz_attach_flags">
              <i>no flags</i>
          </td>

        <td>
          <a href="attachment.cgi?id=14206&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a3" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td>
            <a href="attachment.cgi?id=14207"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">patch for master</span></b></a>

          <span class="bz_attach_extra_info">
              (16.21 KB,
                patch)

            <br>
            <a href="#attach_14207"
               title="Go to the comment associated with the attachment">2018-05-21 03:47 UTC</a>,

            <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
          </span>
        </td>

          <td class="bz_attach_flags">
              <i>no flags</i>
          </td>

        <td>
          <a href="attachment.cgi?id=14207&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a4" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td>
            <a href="attachment.cgi?id=14208"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">backported patch for 4.8</span></b></a>

          <span class="bz_attach_extra_info">
              (16.19 KB,
                patch)

            <br>
            <a href="#attach_14208"
               title="Go to the comment associated with the attachment">2018-05-21 04:00 UTC</a>,

            <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
          </span>
        </td>

          <td class="bz_attach_flags">
              <i>no flags</i>
          </td>

        <td>
          <a href="attachment.cgi?id=14208&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a5" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td>
            <a href="attachment.cgi?id=14267"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">patch for master</span></b></a>

          <span class="bz_attach_extra_info">
              (25.03 KB,
                patch)

            <br>
            <a href="#attach_14267"
               title="Go to the comment associated with the attachment">2018-07-02 05:09 UTC</a>,

            <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
          </span>
        </td>

          <td class="bz_attach_flags">
              <i>no flags</i>
          </td>

        <td>
          <a href="attachment.cgi?id=14267&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a6" class="bz_contenttype_text_plain bz_tr_obsolete bz_default_hidden">
        <td>
            <a href="attachment.cgi?id=14270"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">Inital CVE text</span></b></a>

          <span class="bz_attach_extra_info">
              (1.87 KB,
                text/plain)

            <br>
            <a href="#attach_14270"
               title="Go to the comment associated with the attachment">2018-07-03 02:52 UTC</a>,

            <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
          </span>
        </td>

          <td class="bz_attach_flags">
              <i>no flags</i>
          </td>

        <td>
          <a href="attachment.cgi?id=14270&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a7" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td>
            <a href="attachment.cgi?id=14271"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">patch for master</span></b></a>

          <span class="bz_attach_extra_info">
              (66.19 KB,
                patch)

            <br>
            <a href="#attach_14271"
               title="Go to the comment associated with the attachment">2018-07-03 05:45 UTC</a>,

            <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
          </span>
        </td>

          <td class="bz_attach_flags">
              <i>no flags</i>
          </td>

        <td>
          <a href="attachment.cgi?id=14271&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a8" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td>
            <a href="attachment.cgi?id=14272"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">backported patch for 4.8</span></b></a>

          <span class="bz_attach_extra_info">
              (66.32 KB,
                patch)

            <br>
            <a href="#attach_14272"
               title="Go to the comment associated with the attachment">2018-07-03 05:46 UTC</a>,

            <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
          </span>
        </td>

          <td class="bz_attach_flags">
              <i>no flags</i>
          </td>

        <td>
          <a href="attachment.cgi?id=14272&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a9" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td>
            <a href="attachment.cgi?id=14273"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">patch for 4.7 (security for SCOPE_ONELEVEL searchs on LDAP, hardening for DNS)</span></b></a>

          <span class="bz_attach_extra_info">
              (57.24 KB,
                patch)

            <br>
            <a href="#attach_14273"
               title="Go to the comment associated with the attachment">2018-07-03 05:47 UTC</a>,

            <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
          </span>
        </td>

          <td class="bz_attach_flags">
              <i>no flags</i>
          </td>

        <td>
          <a href="attachment.cgi?id=14273&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a10" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td>
            <a href="attachment.cgi?id=14274"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">additional API test patch for master</span></b></a>

          <span class="bz_attach_extra_info">
              (3.73 KB,
                patch)

            <br>
            <a href="#attach_14274"
               title="Go to the comment associated with the attachment">2018-07-04 02:23 UTC</a>,

            <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
          </span>
        </td>

          <td class="bz_attach_flags">
              <i>no flags</i>
          </td>

        <td>
          <a href="attachment.cgi?id=14274&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a11" class="bz_contenttype_text_plain bz_tr_obsolete bz_default_hidden">
        <td>
            <a href="attachment.cgi?id=14275"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">Updated CVE text</span></b></a>

          <span class="bz_attach_extra_info">
              (1.98 KB,
                text/plain)

            <br>
            <a href="#attach_14275"
               title="Go to the comment associated with the attachment">2018-07-04 02:46 UTC</a>,

            <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
          </span>
        </td>

          <td class="bz_attach_flags">
                  <span title="Douglas Bagnall">dbagnall</span>:
                review+
                <br>
          </td>

        <td>
          <a href="attachment.cgi?id=14275&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a12" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td>
            <a href="attachment.cgi?id=14276"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">reviewed version of patch 14271</span></b></a>

          <span class="bz_attach_extra_info">
              (66.42 KB,
                patch)

            <br>
            <a href="#attach_14276"
               title="Go to the comment associated with the attachment">2018-07-04 04:43 UTC</a>,

            <span class="vcard"><span class="fn">Douglas Bagnall</span>
</span>
          </span>
        </td>

          <td class="bz_attach_flags">
                  <span title="Douglas Bagnall">dbagnall</span>:
                review+
                <br>
          </td>

        <td>
          <a href="attachment.cgi?id=14276&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a13" class="bz_contenttype_text_plain">
        <td>
            <a href="attachment.cgi?id=14278"
               title="View the content of the attachment">
          <b>Updated CVE text</b></a>

          <span class="bz_attach_extra_info">
              (1.88 KB,
                text/plain)

            <br>
            <a href="#attach_14278"
               title="Go to the comment associated with the attachment">2018-07-05 04:38 UTC</a>,

            <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
          </span>
        </td>

          <td class="bz_attach_flags">
                  <span title="Douglas Bagnall">dbagnall</span>:
                review+
                <br>
          </td>

        <td>
          <a href="attachment.cgi?id=14278&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a14" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td>
            <a href="attachment.cgi?id=14279"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">reduce the 4.8 patchset to a smaller security subset</span></b></a>

          <span class="bz_attach_extra_info">
              (20.69 KB,
                patch)

            <br>
            <a href="#attach_14279"
               title="Go to the comment associated with the attachment">2018-07-05 04:45 UTC</a>,

            <span class="vcard"><span class="fn">Douglas Bagnall</span>
</span>
          </span>
        </td>

          <td class="bz_attach_flags">
              <i>no flags</i>
          </td>

        <td>
          <a href="attachment.cgi?id=14279&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a15" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td>
            <a href="attachment.cgi?id=14282"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">CVE-2018-1140 patch for master</span></b></a>

          <span class="bz_attach_extra_info">
              (20.69 KB,
                patch)

            <br>
            <a href="#attach_14282"
               title="Go to the comment associated with the attachment">2018-07-05 23:16 UTC</a>,

            <span class="vcard"><span class="fn">Douglas Bagnall</span>
</span>
          </span>
        </td>

          <td class="bz_attach_flags">
              <i>no flags</i>
          </td>

        <td>
          <a href="attachment.cgi?id=14282&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a16" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td>
            <a href="attachment.cgi?id=14283"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">Additional hardening patches for master</span></b></a>

          <span class="bz_attach_extra_info">
              (50.48 KB,
                patch)

            <br>
            <a href="#attach_14283"
               title="Go to the comment associated with the attachment">2018-07-06 01:16 UTC</a>,

            <span class="vcard"><span class="fn">Douglas Bagnall</span>
</span>
          </span>
        </td>

          <td class="bz_attach_flags">
              <i>no flags</i>
          </td>

        <td>
          <a href="attachment.cgi?id=14283&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a17" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td>
            <a href="attachment.cgi?id=14289"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">patch for master</span></b></a>

          <span class="bz_attach_extra_info">
              (44.44 KB,
                patch)

            <br>
            <a href="#attach_14289"
               title="Go to the comment associated with the attachment">2018-07-06 03:39 UTC</a>,

            <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
          </span>
        </td>

          <td class="bz_attach_flags">
              <i>no flags</i>
          </td>

        <td>
          <a href="attachment.cgi?id=14289&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a18" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td>
            <a href="attachment.cgi?id=14290"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">patch for Samba 4.8</span></b></a>

          <span class="bz_attach_extra_info">
              (44.37 KB,
                patch)

            <br>
            <a href="#attach_14290"
               title="Go to the comment associated with the attachment">2018-07-06 03:43 UTC</a>,

            <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
          </span>
        </td>

          <td class="bz_attach_flags">
              <i>no flags</i>
          </td>

        <td>
          <a href="attachment.cgi?id=14290&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a19" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td>
            <a href="attachment.cgi?id=14295"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">patch for master</span></b></a>

          <span class="bz_attach_extra_info">
              (45.38 KB,
                patch)

            <br>
            <a href="#attach_14295"
               title="Go to the comment associated with the attachment">2018-07-06 04:24 UTC</a>,

            <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
          </span>
        </td>

          <td class="bz_attach_flags">
              <i>no flags</i>
          </td>

        <td>
          <a href="attachment.cgi?id=14295&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a20" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td>
            <a href="attachment.cgi?id=14296"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">patch for master</span></b></a>

          <span class="bz_attach_extra_info">
              (43.86 KB,
                patch)

            <br>
            <a href="#attach_14296"
               title="Go to the comment associated with the attachment">2018-07-06 04:59 UTC</a>,

            <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
          </span>
        </td>

          <td class="bz_attach_flags">
              <i>no flags</i>
          </td>

        <td>
          <a href="attachment.cgi?id=14296&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a21" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td>
            <a href="attachment.cgi?id=14297"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">patch for Samba 4.8</span></b></a>

          <span class="bz_attach_extra_info">
              (43.79 KB,
                patch)

            <br>
            <a href="#attach_14297"
               title="Go to the comment associated with the attachment">2018-07-06 04:59 UTC</a>,

            <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
          </span>
        </td>

          <td class="bz_attach_flags">
              <i>no flags</i>
          </td>

        <td>
          <a href="attachment.cgi?id=14297&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a22" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td>
            <a href="attachment.cgi?id=14316"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">CVE-2018-1140 patch for master</span></b></a>

          <span class="bz_attach_extra_info">
              (43.97 KB,
                patch)

            <br>
            <a href="#attach_14316"
               title="Go to the comment associated with the attachment">2018-07-10 03:02 UTC</a>,

            <span class="vcard"><span class="fn">Douglas Bagnall</span>
</span>
          </span>
        </td>

          <td class="bz_attach_flags">
                  <span title="Andrew Bartlett">abartlet</span>:
                review+
                <br>
          </td>

        <td>
          <a href="attachment.cgi?id=14316&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a23" class="bz_contenttype_text_plain bz_patch">
        <td>
            <a href="attachment.cgi?id=14317"
               title="View the content of the attachment">
          <b>CVE-2018-1140 patch for 4.8</b></a>

          <span class="bz_attach_extra_info">
              (43.90 KB,
                patch)

            <br>
            <a href="#attach_14317"
               title="Go to the comment associated with the attachment">2018-07-10 03:03 UTC</a>,

            <span class="vcard"><span class="fn">Douglas Bagnall</span>
</span>
          </span>
        </td>

          <td class="bz_attach_flags">
                  <span title="Andrew Bartlett">abartlet</span>:
                review+
                <br>
          </td>

        <td>
          <a href="attachment.cgi?id=14317&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a24" class="bz_contenttype_text_plain bz_patch">
        <td>
            <a href="attachment.cgi?id=14418"
               title="View the content of the attachment">
          <b>CVE-2018-1140 patch for master (only)</b></a>

          <span class="bz_attach_extra_info">
              (44.14 KB,
                patch)

            <br>
            <a href="#attach_14418"
               title="Go to the comment associated with the attachment">2018-08-14 02:41 UTC</a>,

            <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
          </span>
        </td>

          <td class="bz_attach_flags">
                  <span title="Gary Lockyer">gary</span>:
                review+
                <br>
          </td>

        <td>
          <a href="attachment.cgi?id=14418&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a25" class="bz_contenttype_text_plain bz_patch">
        <td>
            <a href="attachment.cgi?id=14419"
               title="View the content of the attachment">
          <b>CVE-2018-1140 patch for 4.9 (only)</b></a>

          <span class="bz_attach_extra_info">
              (43.97 KB,
                patch)

            <br>
            <a href="#attach_14419"
               title="Go to the comment associated with the attachment">2018-08-14 02:43 UTC</a>,

            <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
          </span>
        </td>

          <td class="bz_attach_flags">
                  <span title="Gary Lockyer">gary</span>:
                review+
                <br>
          </td>

        <td>
          <a href="attachment.cgi?id=14419&amp;action=edit">Details</a>
        </td>
      </tr>

  <tr class="bz_attach_footer">
    <td colspan="3">
        <span class="bz_attach_view_hide">
            <a href="#a0" onclick="return toggle_display(this);">Show
              Obsolete</a> (19)
            <a id="view_all" href="attachment.cgi?bugid=13374&amp;action=viewall&amp;hide_obsolete=1">View All</a>
        </span>
        <a href="attachment.cgi?bugid=13374&amp;action=enter">Add an attachment</a>
        (proposed patch, testcase, etc.)
    </td>
  </tr>
</table>
<br>
<div id="add_comment" class="bz_section_additional_comments">
      <table>
        <tr>
          <td>
            <fieldset>
              <legend>Note</legend>
              You need to
              <a href="show_bug.cgi?id=13374&amp;GoAheadAndLogIn=1">log in</a>
              before you can comment on or make changes to this bug.
            </fieldset>
          </td>
        </tr> 
      </table>
  </div>
  </td>
  <td>
  </td>
  </tr></table>

  
  <div id="comments"><script src="js/comments.js" type="text/javascript">
</script>

<script type="text/javascript">
<!--
  /* Adds the reply text to the 'comment' textarea */
  function replyToComment(id, real_id, name) {
      var prefix = "(In reply to " + name + " from comment #" + id + ")\n";
      var replytext = "";
        replytext = prefix;


      /* <textarea id="comment"> */
      var textarea = document.getElementById('comment');
      if (textarea.value != replytext) {
          textarea.value += replytext;
      }

      textarea.focus();
  } 
//-->
</script>


<!-- This auto-sizes the comments and positions the collapse/expand links 
     to the right. -->
<table class="bz_comment_table">
<tr>
<td>
<div id="c0" class="bz_comment bz_first_comment">

      <div class="bz_first_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c0">Description</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Garming Sam</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-04-08 22:07:08 UTC
        </span>

      </div>




<pre class="bz_comment_text"></pre>
    </div>

    <div id="c1" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c1">Comment 1</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Garming Sam</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-04-08 22:08:08 UTC
        </span>

      </div>




<pre class="bz_comment_text">Original email from Andrej Gessel &lt;<a href="mailto:andrej.gessel&#64;janztec.com">andrej.gessel&#64;janztec.com</a>&gt;:

Hello,

if I run &quot;ldbsearch '(distinguishedName=abc)' I get following output:

===============================================================
INTERNAL ERROR: Signal 11 in pid 5500 (4.8.0)
Please read the Trouble-Shooting section of the Samba HOWTO
===============================================================
smb_panic(): calling panic action [/bin/sleep 999999999]
^Csmb_panic(): action returned status 0
PANIC: internal error
[1]    5500 abort (core dumped)  ldbsearch distinguishedName=abc

Samba version 4.8.0 and master.

Attached are 2 Patches:

1) I tried to test it, but it doesn't really work. I think someone can write better test for it, as me.

2) Patch to fix this issue.


Andrej</pre>
    </div>

    <div id="c2" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c2">Comment 2</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Garming Sam</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-04-08 22:12:31 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class=""><a href="attachment.cgi?id=14113" name="attach_14113" title="Patch for master (no test)">attachment 14113</a> <a href="attachment.cgi?id=14113&amp;action=edit" title="Patch for master (no test)">[details]</a></span>
Patch for master (no test)

Added just the patch to fix the issue. We probably need a proper test.

Seems to have been introduced in 4.8 (GUID indexing). DNs would have normally been parsed by this point in previous versions. We probably need to also check similar code paths that might also trigger failures in this way.</pre>
    </div>

    <div id="c3" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c3">Comment 3</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-05-01 21:44:11 UTC
        </span>

      </div>




<pre class="bz_comment_text">I've been talking with Jermey, and this needs a CVE.  Can someone get one for us?</pre>
    </div>

    <div id="c4" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c4">Comment 4</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Jeremy Allison</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-05-01 22:03:16 UTC
        </span>

      </div>




<pre class="bz_comment_text">Yeah, looks like an authenticated user DOS on the LDAP server, so CVE-worthy I'm afraid.</pre>
    </div>

    <div id="c5" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c5">Comment 5</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Garming Sam</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-05-14 03:52:23 UTC
        </span>

      </div>




<pre class="bz_comment_text">Ping on getting a CVE number for this?</pre>
    </div>

    <div id="c6" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c6">Comment 6</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-05-20 23:24:57 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class=""><a href="attachment.cgi?id=14206" name="attach_14206" title="patch also sent with the original report">attachment 14206</a> <a href="attachment.cgi?id=14206&amp;action=edit" title="patch also sent with the original report">[details]</a></span>
patch also sent with the original report</pre>
    </div>

    <div id="c7" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c7">Comment 7</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Garming Sam</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-05-21 00:08:55 UTC
        </span>

      </div>




<pre class="bz_comment_text">Valgrind output:

==25090== Invalid read of size 1
==25090==    at 0x4C2E0E2: strlen (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==25090==    by 0x87F5F34: ltdb_index_dn_attr (ldb_index.c:1394)
==25090==    by 0x87F6243: ltdb_index_dn_base_dn (ldb_index.c:1470)
==25090==    by 0x87F53FF: ltdb_index_dn_leaf (ldb_index.c:980)
==25090==    by 0x87F630A: ltdb_index_dn (ldb_index.c:1499)
==25090==    by 0x87F5CE8: ltdb_index_dn_and (ldb_index.c:1303)
==25090==    by 0x87F62B3: ltdb_index_dn (ldb_index.c:1487)
==25090==    by 0x87F6A1F: ltdb_search_indexed (ldb_index.c:1756)
==25090==    by 0x87F3740: ltdb_search (ldb_search.c:808)
==25090==    by 0x87F192C: ltdb_callback (ldb_tdb.c:1919)
==25090==    by 0x40A7C33: tevent_common_loop_timer_delay (tevent_timed.c:369)
==25090==    by 0x40A9F3D: epoll_event_loop_once (tevent_epoll.c:915)
==25090==  Address 0x0 is not stack'd, malloc'd or (recently) free'd
==25090== 
===============================================================
INTERNAL ERROR: Signal 11 in pid 25090 (4.9.0pre1-DEVELOPERBUILD)
Please read the Trouble-Shooting section of the Samba HOWTO
===============================================================</pre>
    </div>

    <div id="c8" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c8">Comment 8</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-05-21 02:59:05 UTC
        </span>

      </div>




<pre class="bz_comment_text">Can we please (again) get a CVE for this issue allocated please.</pre>
    </div>

    <div id="c9" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c9">Comment 9</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-05-21 03:47:15 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=14207" name="attach_14207" title="patch for master">attachment 14207</a> <a href="attachment.cgi?id=14207&amp;action=edit" title="patch for master">[details]</a></span>
patch for master

Here is a more comprehensive patch for master in addition to that provided by the reporter.</pre>
    </div>

    <div id="c10" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c10">Comment 10</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-05-21 04:00:58 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=14208" name="attach_14208" title="backported patch for 4.8">attachment 14208</a> <a href="attachment.cgi?id=14208&amp;action=edit" title="backported patch for 4.8">[details]</a></span>
backported patch for 4.8</pre>
    </div>

    <div id="c11" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c11">Comment 11</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Huzaifa Sidhpurwala</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-05-21 04:04:55 UTC
        </span>

      </div>




<pre class="bz_comment_text">(In reply to Andrew Bartlett from <a href="show_bug.cgi?id=13374#c8">comment #8</a>)

I will get a CVE for you, please give me some time.</pre>
    </div>

    <div id="c12" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c12">Comment 12</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Huzaifa Sidhpurwala</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-05-21 09:05:24 UTC
        </span>

      </div>




<pre class="bz_comment_text">(In reply to Huzaifa Sidhpurwala from <a href="show_bug.cgi?id=13374#c11">comment #11</a>)

Please use CVE-2018-1140</pre>
    </div>

    <div id="c13" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c13">Comment 13</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-06-25 17:35:10 UTC
        </span>

      </div>




<pre class="bz_comment_text">*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED FIXED - [SECURITY Hardening] DNS query with escapes characters in dns name makes samba crashing"
   href="show_bug.cgi?id=13466">Bug 13466</a> has been marked as a duplicate of this bug. ***</pre>
    </div>

    <div id="c14" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c14">Comment 14</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Kai Blin</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-06-26 08:51:50 UTC
        </span>

      </div>




<pre class="bz_comment_text">Note that #13466 makes this a DOS that does not require authentication.</pre>
    </div>

    <div id="c15" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c15">Comment 15</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Karolin Seeger</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-06-28 07:18:32 UTC
        </span>

      </div>




<pre class="bz_comment_text">Could someone provide an advisory and review the patch, please?
I would like to address this asap as a patch is available.

Thanks!</pre>
    </div>

    <div id="c16" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c16">Comment 16</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-07-02 05:09:32 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=14267" name="attach_14267" title="patch for master">attachment 14267</a> <a href="attachment.cgi?id=14267&amp;action=edit" title="patch for master">[details]</a></span>
patch for master

I've updated the patch to include Kai's test and done some work on the DNS server to validate the inputs more strongly.</pre>
    </div>

    <div id="c17" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c17">Comment 17</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-07-03 02:52:27 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=14270" name="attach_14270" title="Inital CVE text">attachment 14270</a> <a href="attachment.cgi?id=14270&amp;action=edit" title="Inital CVE text">[details]</a></span>
Inital CVE text

I'm also working on further robustness patches for the DNS server, given the level of untrusted input here.</pre>
    </div>

    <div id="c18" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c18">Comment 18</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-07-03 05:45:58 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=14271" name="attach_14271" title="patch for master">attachment 14271</a> <a href="attachment.cgi?id=14271&amp;action=edit" title="patch for master">[details]</a></span>
patch for master</pre>
    </div>

    <div id="c19" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c19">Comment 19</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-07-03 05:46:37 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=14272" name="attach_14272" title="backported patch for 4.8">attachment 14272</a> <a href="attachment.cgi?id=14272&amp;action=edit" title="backported patch for 4.8">[details]</a></span>
backported patch for 4.8</pre>
    </div>

    <div id="c20" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c20">Comment 20</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-07-03 05:47:09 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=14273" name="attach_14273" title="patch for 4.7 (security for SCOPE_ONELEVEL searchs on LDAP, hardening for DNS)">attachment 14273</a> <a href="attachment.cgi?id=14273&amp;action=edit" title="patch for 4.7 (security for SCOPE_ONELEVEL searchs on LDAP, hardening for DNS)">[details]</a></span>
patch for 4.7 (security for SCOPE_ONELEVEL searchs on LDAP, hardening for DNS)</pre>
    </div>

    <div id="c21" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c21">Comment 21</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-07-03 05:48:41 UTC
        </span>

      </div>




<pre class="bz_comment_text">The remaining question is if ldb_dn_valdiate() should also casefold the DN.  This might avoid similar issues elsewhere, as it is largely assumed that such a DN is very well formed.</pre>
    </div>

    <div id="c22" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c22">Comment 22</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-07-03 09:02:45 UTC
        </span>

      </div>




<pre class="bz_comment_text">Can I please have a peer review of this approach, as a one-line fix has become a monolith here.

In particular, should some of this be split back out into a 'make things safer later' patch set, or is this all required in the security release?  Should we have a different bug and/or CVE for the ldb_dn_add_child_fmt() use?

For that issue in the DNS server (and marked against that bug), the patches try to avoid DNS lookup of eg 

foo,dc=bar.samba.example.com

I can't see any real harm in those, as such an object shouldn't be able to exist, but they are of course invalid and should be prevented. 

Also, we need to check a corrupt base DN combined with a SCOPE_ONE search on an &#64;IDXONE database.  This is where the bug came in, and may be present in older versions.</pre>
    </div>

    <div id="c23" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c23">Comment 23</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-07-04 02:23:36 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=14274" name="attach_14274" title="additional API test patch for master">attachment 14274</a> <a href="attachment.cgi?id=14274&amp;action=edit" title="additional API test patch for master">[details]</a></span>
additional API test patch for master</pre>
    </div>

    <div id="c24" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c24">Comment 24</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-07-04 02:46:50 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=14275" name="attach_14275" title="Updated CVE text">attachment 14275</a> <a href="attachment.cgi?id=14275&amp;action=edit" title="Updated CVE text">[details]</a></span>
Updated CVE text

I've decided to assume that there is no check on SCOPE_ONELEVEL and so we have the same issue just in a different guise there.  I can't prove it yet but I can't prove otherwise yet either.</pre>
    </div>

    <div id="c25" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c25">Comment 25</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Douglas Bagnall</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-07-04 04:43:55 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=14276" name="attach_14276" title="reviewed version of patch 14271">attachment 14276</a> <a href="attachment.cgi?id=14276&amp;action=edit" title="reviewed version of patch 14271">[details]</a></span>
reviewed version of patch 14271

I reviewed the main patch and squashed in the following minor changes:

1. Fix a nearby non-check:

--- a/source4/dns_server/dnsserver_common.c
+++ b/source4/dns_server/dnsserver_common.c
&#64;&#64; -959,7 +959,11 &#64;&#64; WERROR dns_common_name2dn(struct ldb_context *samdb,
 
        if (host_part_len == 0) {
                dn = ldb_dn_copy(mem_ctx, z-&gt;dn);
-               ldb_dn_add_child_fmt(dn, &quot;DC=&#64;&quot;);
+               ok = ldb_dn_add_child_fmt(dn, &quot;DC=&#64;&quot;);
+               if (! ok) {
+                       TALLOC_FREE(dn);
+                       return WERR_NOT_ENOUGH_MEMORY;
+               }
                *_dn = dn;
                return WERR_OK;
        }


2. ldb_dn_add_child_val() can do its work without the talloc/format overhead, 
   and also in there because the value of ret is set once and always known, 
   I prefer explicit return values.

--- a/lib/ldb/common/ldb_dn.c
+++ b/lib/ldb/common/ldb_dn.c
&#64;&#64; -1616,12 +1616,14 &#64;&#64; bool ldb_dn_add_child_val(struct ldb_dn *dn,
 {
        bool ret;
        int ldb_ret;
+       struct ldb_dn *child = NULL;
 
        if ( !dn || dn-&gt;invalid) {
                return false;
        }
 
-       ret = ldb_dn_add_child_fmt(dn, &quot;X=Y&quot;);
+       child = ldb_dn_new(dn, dn-&gt;ldb, &quot;X=Y&quot;);
+       ret = ldb_dn_add_child(dn, child);
 
        if (ret == false) {
-               return ret;
+               return false;
        }
 
        ldb_ret = ldb_dn_set_component(dn,
&#64;&#64; -1637,7 +1637,7 &#64;&#64; bool ldb_dn_add_child_val(struct ldb_dn *dn,
                return false;
        }
 
-       return ret;
+       return true;
 }


3. One that ISN'T just fiddling (function returns bool, errcode would reverse polarity):

--- a/source4/dns_server/dlz_bind9.c
+++ b/source4/dns_server/dlz_bind9.c
&#64;&#64; -1262,7 +1262,7 &#64;&#64; static bool b9_has_soa(struct dlz_bind9_data *state, struct ldb_dn *dn, const ch
                                  &quot;DC&quot;,
                                  zone_name_val)) {
                talloc_free(tmp_ctx);
-               return ISC_R_NOMEMORY;
+               return false;
        }
 
        werr = dns_common_lookup(state-&gt;samdb, tmp_ctx, dn,


4. This constant ldb_val can come out of the loop:

--- a/source4/dns_server/dlz_bind9.c
+++ b/source4/dns_server/dlz_bind9.c
&#64;&#64; -1052,11 +1052,10 &#64;&#64; _PUBLIC_ isc_result_t dlz_allnodes(const char *zone, void *dbdata,
        struct ldb_dn *dn;
        struct ldb_result *res;
        TALLOC_CTX *tmp_ctx = talloc_new(state);
+       struct ldb_val zone_name_val = data_blob_string_const(zone);
 
        for (i=0; zone_prefixes[i]; i++) {
                const char *casefold;
-               struct ldb_val zone_name_val
-                       = data_blob_string_const(zone);
 
                dn = ldb_dn_copy(tmp_ctx, ldb_get_default_basedn(state-&gt;samdb));
                if (dn == NULL) {



5. Error string formatting:

--- a/lib/ldb/ldb_tdb/ldb_index.c
+++ b/lib/ldb/ldb_tdb/ldb_index.c
&#64;&#64; -1610,7 +1610,7 &#64;&#64; static int ltdb_index_dn_attr(struct ldb_module *module,
                const char *dn_str = ldb_dn_get_linearized(dn);
                ldb_asprintf_errstring(ldb_module_get_ctx(module),
                                       __location__
-                                      &quot;: Failed to get casefold DN&quot;
+                                      &quot;: Failed to get casefold DN &quot;
                                       &quot;from: %s&quot;,
                                       dn_str);
                return LDB_ERR_OPERATIONS_ERROR;



What I haven't entirely worked out yet:

* are there other cases lurking somewhere?

* and here around lib/ldb/ldb_tdb/ldb_search.c:790
	
+	} else if (ldb_dn_validate(req-&gt;op.search.base) == false) {
+
+		/* We don't want invalid base DNs here */
+		ldb_asprintf_errstring(ldb,
+				       &quot;Invalid Base DN: %s&quot;,
+				       ldb_dn_get_linearized(req-&gt;op.search.base));
+		ret = LDB_ERR_INVALID_DN_SYNTAX;
+
 	} else {
 		/* If we are not checking the base DN life is easy */
 		ret = LDB_SUCCESS;
 	}

do none of the other &quot;else if&quot; branches need the validation? 



Also it would be good to see more tests that pin this down (and I know Andrew is working on this).</pre>
    </div>

    <div id="c26" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c26">Comment 26</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-07-05 04:38:58 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class=""><a href="attachment.cgi?id=14278" name="attach_14278" title="Updated CVE text">attachment 14278</a> <a href="attachment.cgi?id=14278&amp;action=edit" title="Updated CVE text">[details]</a></span>
Updated CVE text

Pulling back to 4.8 only for the security release.  DNS input validation issue separated (will be a non-security bug, hardening improvement only) and just the actual LDb segfault marked as CVE.

LDAP one-level searches do not fault on older Samba versions due to protection in the acl_read module.  

Direct LDB one-level searches would still be an issue if UTF8 functions were loaded (only Samba is known to do so), but almost nobody uses LDB and we release the 1.4.1 LDB release anyway.</pre>
    </div>

    <div id="c27" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c27">Comment 27</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Douglas Bagnall</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-07-05 04:45:31 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=14279" name="attach_14279" title="reduce the 4.8 patchset to a smaller security subset">attachment 14279</a> <a href="attachment.cgi?id=14279&amp;action=edit" title="reduce the 4.8 patchset to a smaller security subset">[details]</a></span>
reduce the 4.8 patchset to a smaller security subset

These are the patches we actually need (apart from the LDB release).</pre>
    </div>

    <div id="c28" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c28">Comment 28</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Douglas Bagnall</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-07-05 23:16:29 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=14282" name="attach_14282" title="CVE-2018-1140 patch for master">attachment 14282</a> <a href="attachment.cgi?id=14282&amp;action=edit" title="CVE-2018-1140 patch for master">[details]</a></span>
CVE-2018-1140 patch for master

We believe this subset of the original patchset is sufficient for the security issue.</pre>
    </div>

    <div id="c29" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c29">Comment 29</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Douglas Bagnall</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-07-06 01:16:31 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=14283" name="attach_14283" title="Additional hardening patches for master">attachment 14283</a> <a href="attachment.cgi?id=14283&amp;action=edit" title="Additional hardening patches for master">[details]</a></span>
Additional hardening patches for master

These patches apply after the security ones 

I think they need another ldb release</pre>
    </div>

    <div id="c30" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c30">Comment 30</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-07-06 03:39:24 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=14289" name="attach_14289" title="patch for master">attachment 14289</a> <a href="attachment.cgi?id=14289&amp;action=edit" title="patch for master">[details]</a></span>
patch for master

The hardening patches have been sent back to <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED FIXED - [SECURITY Hardening] DNS query with escapes characters in dns name makes samba crashing"
   href="show_bug.cgi?id=13466">bug 13466</a>.  

Samba 4.7 is no longer considered impacted</pre>
    </div>

    <div id="c31" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c31">Comment 31</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-07-06 03:43:01 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=14290" name="attach_14290" title="patch for Samba 4.8">attachment 14290</a> <a href="attachment.cgi?id=14290&amp;action=edit" title="patch for Samba 4.8">[details]</a></span>
patch for Samba 4.8

Backported patches for 4.8 (only)</pre>
    </div>

    <div id="c32" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c32">Comment 32</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-07-06 04:24:24 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=14295" name="attach_14295" title="patch for master">attachment 14295</a> <a href="attachment.cgi?id=14295&amp;action=edit" title="patch for master">[details]</a></span>
patch for master</pre>
    </div>

    <div id="c33" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c33">Comment 33</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-07-06 04:59:00 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=14296" name="attach_14296" title="patch for master">attachment 14296</a> <a href="attachment.cgi?id=14296&amp;action=edit" title="patch for master">[details]</a></span>
patch for master</pre>
    </div>

    <div id="c34" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c34">Comment 34</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-07-06 04:59:50 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=14297" name="attach_14297" title="patch for Samba 4.8">attachment 14297</a> <a href="attachment.cgi?id=14297&amp;action=edit" title="patch for Samba 4.8">[details]</a></span>
patch for Samba 4.8</pre>
    </div>

    <div id="c35" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c35">Comment 35</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Douglas Bagnall</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-07-10 03:02:38 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=14316" name="attach_14316" title="CVE-2018-1140 patch for master">attachment 14316</a> <a href="attachment.cgi?id=14316&amp;action=edit" title="CVE-2018-1140 patch for master">[details]</a></span>
CVE-2018-1140 patch for master

This patch differs from previous one in Reviewed-bys only:

1/7: reviewed by Andrew
6/7: reviewed by me

A similar change is coming up in the 4.8 patch</pre>
    </div>

    <div id="c36" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c36">Comment 36</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Douglas Bagnall</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-07-10 03:03:45 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class=""><a href="attachment.cgi?id=14317" name="attach_14317" title="CVE-2018-1140 patch for 4.8">attachment 14317</a> <a href="attachment.cgi?id=14317&amp;action=edit" title="CVE-2018-1140 patch for 4.8">[details]</a></span>
CVE-2018-1140 patch for 4.8</pre>
    </div>

    <div id="c37" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c37">Comment 37</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-07-10 04:16:57 UTC
        </span>

      </div>




<pre class="bz_comment_text">Thanks Douglas.  I'm doing a private CI run and will approve if these pass, to make sure there are no unintended consequences of these fixes.</pre>
    </div>

    <div id="c38" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c38">Comment 38</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-07-10 08:31:59 UTC
        </span>

      </div>




<pre class="bz_comment_text">Comment on <span class="bz_obsolete"><a href="attachment.cgi?id=14316" name="attach_14316" title="CVE-2018-1140 patch for master">attachment 14316</a> <a href="attachment.cgi?id=14316&amp;action=edit" title="CVE-2018-1140 patch for master">[details]</a></span>
CVE-2018-1140 patch for master

The master patch passed a full autobuild in the Catalyst Cloud.</pre>
    </div>

    <div id="c39" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c39">Comment 39</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-07-10 09:38:05 UTC
        </span>

      </div>




<pre class="bz_comment_text">I think the patches are ready.  4.8 also passed a full autobuild in the Catalyst Cloud.</pre>
    </div>

    <div id="c40" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c40">Comment 40</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Huzaifa Sidhpurwala</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-07-30 08:00:43 UTC
        </span>

      </div>




<pre class="bz_comment_text">Andrew,

Why was this upgraded to critical?</pre>
    </div>

    <div id="c41" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c41">Comment 41</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-07-30 08:24:30 UTC
        </span>

      </div>




<pre class="bz_comment_text">The DoS on the DNS server takes down the full DC, and there is no auto restart.

Otherwise, pay no attention, it just didn't seem like 'normal' was the right rating.</pre>
    </div>

    <div id="c42" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c42">Comment 42</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-08-07 02:13:52 UTC
        </span>

      </div>




<pre class="bz_comment_text">For the DNS attack this is a CVSS 7.5

<a href="https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H">https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H</a></pre>
    </div>

    <div id="c43" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c43">Comment 43</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Karolin Seeger</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-08-10 09:05:47 UTC
        </span>

      </div>




<pre class="bz_comment_text">Neither patch for master nor for 4.8 applies on current v4-9-stable branch.</pre>
    </div>

    <div id="c44" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c44">Comment 44</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Karolin Seeger</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-08-13 09:57:42 UTC
        </span>

      </div>




<pre class="bz_comment_text">Re-assigning to Andrew. Could someone please provide a patch for 4.9?, please?</pre>
    </div>

    <div id="c45" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c45">Comment 45</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-08-14 01:32:22 UTC
        </span>

      </div>




<pre class="bz_comment_text">Passing on to Gary who will get the updated patch.  4.9 looks easy (change the version number) master got lots of files renamed since this work was done.</pre>
    </div>

    <div id="c46" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c46">Comment 46</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-08-14 02:41:57 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class=""><a href="attachment.cgi?id=14418" name="attach_14418" title="CVE-2018-1140 patch for master (only)">attachment 14418</a> <a href="attachment.cgi?id=14418&amp;action=edit" title="CVE-2018-1140 patch for master (only)">[details]</a></span>
CVE-2018-1140 patch for master (only)</pre>
    </div>

    <div id="c47" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c47">Comment 47</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-08-14 02:43:05 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class=""><a href="attachment.cgi?id=14419" name="attach_14419" title="CVE-2018-1140 patch for 4.9 (only)">attachment 14419</a> <a href="attachment.cgi?id=14419&amp;action=edit" title="CVE-2018-1140 patch for 4.9 (only)">[details]</a></span>
CVE-2018-1140 patch for 4.9 (only)

An autobuild is running on the Catalyst Cloud for the new master and 4.9 patches</pre>
    </div>

    <div id="c48" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c48">Comment 48</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Karolin Seeger</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-08-14 08:43:34 UTC
        </span>

      </div>




<pre class="bz_comment_text">Samba 4.8.4, 4.9.7 an 4.6.16 have been released in order to address these defects.</pre>
    </div>

    <div id="c49" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c49">Comment 49</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Karolin Seeger</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-08-14 08:53:26 UTC
        </span>

      </div>




<pre class="bz_comment_text">(In reply to Karolin Seeger from <a href="show_bug.cgi?id=13374#c48">comment #48</a>)
This was 4.8 only...</pre>
    </div>

    <div id="c50" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c50">Comment 50</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Karolin Seeger</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-08-14 10:05:40 UTC
        </span>

      </div>




<pre class="bz_comment_text">(In reply to Karolin Seeger from <a href="show_bug.cgi?id=13374#c49">comment #49</a>)
Pushed to autobuild-master and autobuild-v4-9-test.</pre>
    </div>

    <div id="c51" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c51">Comment 51</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andrew Bartlett</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-08-14 22:22:23 UTC
        </span>

      </div>




<pre class="bz_comment_text">Opening up bug.  I can't see anything needing redaction here.</pre>
    </div>

    <div id="c52" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=13374#c52">Comment 52</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Karolin Seeger</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-08-24 09:28:16 UTC
        </span>

      </div>




<pre class="bz_comment_text">Pushed to all relevant branches.
Closing out bug report.

Thanks!</pre>
    </div>


  

</td>
<td>
</td>
</tr></table>
  </div>
        

</form>

<hr>
<ul class="related_actions">
    <li><a href="show_bug.cgi?format=multiple&amp;id=13374">Format For Printing</a></li>
    <li>&nbsp;-&nbsp;<a href="show_bug.cgi?ctype=xml&amp;id=13374">XML</a></li>
    <li>&nbsp;-&nbsp;<a href="enter_bug.cgi?cloned_bug_id=13374">Clone This Bug</a></li>
    
    <li>&nbsp;-&nbsp;<a href="#">Top of page </a></li>
    </ul>

<br>
</div>

    <div id="footer">
      <div class="intro"></div>
<ul id="useful-links">
  <li id="links-actions"><ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi">New</a></li>
  <li><span class="separator">| </span><a href="describecomponents.cgi">Browse</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_bottom" name="no_redirect" value="0">
    <script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_bottom");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_bottom" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_bottom"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li>
      <span class="separator">| </span>
        <a href="request.cgi">Requests</a></li>


  <li>
        <span class="separator">| </span>
        <a href="https://bugzilla.readthedocs.org/en/5.0/using/understanding.html" target="_blank">Help</a>
      </li>
    
      <li id="new_account_container_bottom">
        <span class="separator">| </span>
        <a href="createaccount.cgi">New&nbsp;Account</a>
      </li>

    <li id="mini_login_container_bottom">
  <span class="separator">| </span>
  <a id="login_link_bottom" href="show_bug.cgi?id=13374&amp;GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('_bottom')">Log In</a>

  <form action="show_bug.cgi?id=13374" method="POST"
        class="mini_login bz_default_hidden"
        id="mini_login_bottom">
    <input id="Bugzilla_login_bottom" required
           name="Bugzilla_login" class="bz_login"
        type="email" placeholder="Email Address">
    <input class="bz_password" name="Bugzilla_password" type="password"
           id="Bugzilla_password_bottom" required
           placeholder="Password">
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
            id="log_in_bottom">
    <a href="#" onclick="return hide_mini_login_form('_bottom')">[x]</a>
  </form>
</li>


  <li id="forgot_container_bottom">
    <span class="separator">| </span>
    <a id="forgot_link_bottom" href="show_bug.cgi?id=13374&amp;GoAheadAndLogIn=1#forgot"
       onclick="return show_forgot_form('_bottom')">Forgot Password</a>
    <form action="token.cgi" method="post" id="forgot_form_bottom"
          class="mini_forgot bz_default_hidden">
      <label for="login_bottom">Login:</label>
      <input name="loginname" size="20" id="login_bottom" required
          type="email" placeholder="Your Email Address">
      <input id="forgot_button_bottom" value="Reset Password" type="submit">
      <input type="hidden" name="a" value="reqpw">
      <input type="hidden" id="token_bottom" name="token"
             value="1635630129-GhugNKDCkeLmo8B0-kAT2soLf8Q1yr_-biFK2nW4I1I">
      <a href="#" onclick="return hide_forgot_form('_bottom')">[x]</a>
    </form>
  </li>
</ul>
  </li>

  




  
</ul>

      <div class="outro"></div>
    </div>

  </body>
</html>