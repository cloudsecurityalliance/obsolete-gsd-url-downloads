<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="UTF-8">
<meta property="og:type" content="website">
<meta property="og:title" content="1278013 - (CVE-2016-5265) Same origin policy bypass in local document/Universal xss">
<meta property="og:url" content="https://bugzilla.mozilla.org/show_bug.cgi?id=1278013">
<meta property="og:description"
      content="RESOLVED (ckerschb) in Core - Networking: File. Last updated 2017-03-29.">
<meta name="twitter:label1" value="Type">
<meta name="twitter:data1" value="defect">
<meta name="twitter:label2" value="Priority">
<meta name="twitter:data2" value="--">

    <meta name="viewport" content="width=1024">
    <meta name="color-scheme" content="dark light">
    <meta name="generator" content="Bugzilla 20211025.1">
    <meta name="bugzilla-global" content="dummy"
        id="bugzilla-global" data-bugzilla="{&quot;api_token&quot;:&quot;&quot;,&quot;config&quot;:{&quot;basepath&quot;:&quot;\/&quot;},&quot;constant&quot;:{&quot;COMMENT_COLS&quot;:80},&quot;param&quot;:{&quot;maxattachmentsize&quot;:&quot;10240&quot;,&quot;maxusermatches&quot;:&quot;50&quot;,&quot;splinter_base&quot;:&quot;\/page.cgi?id=splinter.html&amp;ignore=\/&quot;},&quot;string&quot;:{&quot;bug_type_required&quot;:&quot;You must select a Type for this bug&quot;,&quot;component_required&quot;:&quot;You must select a Component for this bug&quot;,&quot;description_required&quot;:&quot;You must enter a Description for this bug&quot;,&quot;short_desc_required&quot;:&quot;You must enter a Summary for this bug&quot;,&quot;version_required&quot;:&quot;You must select a Version for this bug&quot;},&quot;user&quot;:{&quot;is_new&quot;:1,&quot;login&quot;:&quot;&quot;}}">
    <title>1278013 - (CVE-2016-5265) Same origin policy bypass in local document/Universal xss</title>

<link rel="Top" href="/">

  


  
    <link rel="Show" title="Dependency Tree"
          href="/showdependencytree.cgi?id=1278013&amp;hide_resolved=1">
      <link rel="Show" title="Dependency Graph"
            href="/showdependencygraph.cgi?id=1278013">

      <link rel="Show" title="Bug Activity"
            href="/show_activity.cgi?id=1278013">

<link href="/static/v20211025.1/skins/yui.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/standard/global.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BugModal/web/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BMO/web/styles/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/EditComments/web/styles/inline-editor.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-structure-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-theme-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/lib/prism.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Needinfo/web/styles/needinfo.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Review/web/styles/badge.css" rel="stylesheet" type="text/css">



    
<script nonce="KzqVkF9vWmCWDqSz14H7xyDl8m67drxsDsCAccM09L8x2qLu" src="/static/v20211025.1/js/jquery/jquery-min.js"></script><script nonce="KzqVkF9vWmCWDqSz14H7xyDl8m67drxsDsCAccM09L8x2qLu" src="/static/v20211025.1/js/jquery/ui/jquery-ui-min.js"></script><script nonce="KzqVkF9vWmCWDqSz14H7xyDl8m67drxsDsCAccM09L8x2qLu" src="/static/v20211025.1/js/yui.js"></script><script nonce="KzqVkF9vWmCWDqSz14H7xyDl8m67drxsDsCAccM09L8x2qLu" src="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu-min.js"></script><script nonce="KzqVkF9vWmCWDqSz14H7xyDl8m67drxsDsCAccM09L8x2qLu" src="/static/v20211025.1/js/jquery/plugins/devbridgeAutocomplete/devbridgeAutocomplete-min.js"></script><script nonce="KzqVkF9vWmCWDqSz14H7xyDl8m67drxsDsCAccM09L8x2qLu" src="/static/v20211025.1/js/global.js"></script><script nonce="KzqVkF9vWmCWDqSz14H7xyDl8m67drxsDsCAccM09L8x2qLu" src="/static/v20211025.1/js/util.js"></script><script nonce="KzqVkF9vWmCWDqSz14H7xyDl8m67drxsDsCAccM09L8x2qLu" src="/static/v20211025.1/js/dropdown.js"></script>

      <script nonce="KzqVkF9vWmCWDqSz14H7xyDl8m67drxsDsCAccM09L8x2qLu">
          YAHOO.namespace('bugzilla');
          if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
              YAHOO.util.Event._simpleRemove(window, "unload",
                                             YAHOO.util.Event._unload);
          }BUGZILLA.value_descs = JSON.parse('{\"bug_status\":{},\"resolution\":{\"\":\"---\"}}');

  
    var tracking_flags_str = "{\"flags\":{\"tracking\":{\"cf_status_thunderbird_esr91\":\"---\",\"cf_tracking_firefox94\":\"---\",\"cf_status_firefox47\":\"wontfix\",\"cf_tracking_firefox_esr91\":\"---\",\"cf_status_firefox48\":\"fixed\",\"cf_tracking_firefox95\":\"---\",\"cf_status_firefox50\":\"fixed\",\"cf_status_firefox46\":\"wontfix\",\"cf_status_firefox93\":\"---\",\"cf_status_firefox95\":\"---\",\"cf_tracking_firefox_esr78\":\"---\",\"cf_tracking_firefox_esr45\":\"48+\",\"cf_status_firefox49\":\"fixed\",\"cf_tracking_thunderbird_esr78\":\"---\",\"cf_status_firefox_esr45\":\"fixed\",\"cf_status_firefox_esr78\":\"---\",\"cf_tracking_firefox93\":\"---\",\"cf_status_firefox94\":\"---\",\"cf_tracking_thunderbird_esr91\":\"---\",\"cf_status_firefox_esr38\":\"wontfix\",\"cf_tracking_firefox_relnote\":\"---\",\"cf_status_firefox_esr91\":\"---\",\"cf_status_thunderbird_esr78\":\"---\"},\"project\":{\"cf_root_cause\":\"---\",\"cf_webcompat_priority\":\"---\",\"cf_a11y_review_project_flag\":\"---\",\"cf_tracking_firefox_sumo\":\"---\",\"cf_fission_milestone\":\"---\"}},\"comments\":{\"cf_a11y_review_project_flag\":{\"requested\":\"Description:\\nPlease provide an explanation of the feature or change. Include a description of the user scenario in which it would be used and how the user would complete the task(s).\\nScreenshots and visual UI specs are welcome, but please include sufficient accompanying explanation so that blind members of the accessibility team are able to understand the feature\/change.\\n\\nHow do we test this?\\nIf there is an implementation to test, please provide instructions for testing it; e.g. setting preferences, other preparation, how to trigger the UI, etc.\\n\\nWhen will this ship?\\nTracking bug\/issue:\\nDesign documents (e.g. Product Requirements Document, UI spec):\\nEngineering lead:\\nProduct manager:\\n\\nThe accessibility team has developed the Mozilla Accessibility Release Guidelines which outline what is needed to make user interfaces accessible:\\nhttps:\/\/wiki.mozilla.org\/Accessibility\/Guidelines\\nPlease describe the accessibility guidelines you considered and what steps you\'ve taken to address them:\\n\\nDescribe any areas of concern to which you want the accessibility team to give special attention:\"},\"cf_tracking_firefox94\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr91\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_sumo\":{\"none-needed\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox93\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr78\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox95\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr45\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_relnote\":{\"?\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"}},\"types\":[\"tracking\"]}";
    var TrackingFlags = $.parseJSON(tracking_flags_str);

  

  
  BUGZILLA.bug_id = 1278013;
  BUGZILLA.bug_title = '1278013 - (CVE-2016-5265) Same origin policy bypass in local document\/Universal xss';
  BUGZILLA.bug_summary = 'Same origin policy bypass in local document\/Universal xss';
  BUGZILLA.bug_url = 'https:\/\/bugzilla.mozilla.org\/show_bug.cgi?id=1278013';
  BUGZILLA.bug_keywords = 'csectype-sop, regression, sec-moderate',
  BUGZILLA.user = {
    id: 0,
    login: '',
    is_insider: false,
    is_timetracker: false,
    can_tag: false,
    timezone: 'America\/Los_Angeles',
    settings: {
      quote_replies: 'quoted_reply',
      zoom_textareas: true,
      remember_collapsed: true,
      inline_attachments: true,
      autosize_comments: false
    }
  };

  BUGZILLA.bug_secure = false;
      </script>
<script nonce="KzqVkF9vWmCWDqSz14H7xyDl8m67drxsDsCAccM09L8x2qLu" src="/static/v20211025.1/extensions/BugModal/web/autosize.min.js"></script><script nonce="KzqVkF9vWmCWDqSz14H7xyDl8m67drxsDsCAccM09L8x2qLu" src="/static/v20211025.1/extensions/ProdCompSearch/web/js/prod_comp_search.js"></script><script nonce="KzqVkF9vWmCWDqSz14H7xyDl8m67drxsDsCAccM09L8x2qLu" src="/static/v20211025.1/extensions/BugModal/web/bug_modal.js"></script><script nonce="KzqVkF9vWmCWDqSz14H7xyDl8m67drxsDsCAccM09L8x2qLu" src="/static/v20211025.1/extensions/BugModal/web/comments.js"></script><script nonce="KzqVkF9vWmCWDqSz14H7xyDl8m67drxsDsCAccM09L8x2qLu" src="/static/v20211025.1/extensions/ComponentWatching/web/js/overlay.js"></script><script nonce="KzqVkF9vWmCWDqSz14H7xyDl8m67drxsDsCAccM09L8x2qLu" src="/static/v20211025.1/js/bugzilla-readable-status-min.js"></script><script nonce="KzqVkF9vWmCWDqSz14H7xyDl8m67drxsDsCAccM09L8x2qLu" src="/static/v20211025.1/js/field.js"></script><script nonce="KzqVkF9vWmCWDqSz14H7xyDl8m67drxsDsCAccM09L8x2qLu" src="/static/v20211025.1/js/comments.js"></script><script nonce="KzqVkF9vWmCWDqSz14H7xyDl8m67drxsDsCAccM09L8x2qLu" src="/static/v20211025.1/extensions/TrackingFlags/web/js/flags.js"></script><script nonce="KzqVkF9vWmCWDqSz14H7xyDl8m67drxsDsCAccM09L8x2qLu" src="/static/v20211025.1/extensions/BMO/web/js/firefox-crash-table.js"></script><script nonce="KzqVkF9vWmCWDqSz14H7xyDl8m67drxsDsCAccM09L8x2qLu" src="/static/v20211025.1/extensions/MozChangeField/web/js/severity-s1-priority-p1.js"></script><script nonce="KzqVkF9vWmCWDqSz14H7xyDl8m67drxsDsCAccM09L8x2qLu" src="/static/v20211025.1/extensions/MozChangeField/web/js/clear-tracking-priority-s1.js"></script><script nonce="KzqVkF9vWmCWDqSz14H7xyDl8m67drxsDsCAccM09L8x2qLu" src="/static/v20211025.1/extensions/MozChangeField/web/js/set-tracking-severity-s1.js"></script><script nonce="KzqVkF9vWmCWDqSz14H7xyDl8m67drxsDsCAccM09L8x2qLu" src="/static/v20211025.1/js/lib/prism.js"></script><script nonce="KzqVkF9vWmCWDqSz14H7xyDl8m67drxsDsCAccM09L8x2qLu" src="/static/v20211025.1/extensions/GoogleAnalytics/web/js/analytics.js"></script><script nonce="KzqVkF9vWmCWDqSz14H7xyDl8m67drxsDsCAccM09L8x2qLu" src="/static/v20211025.1/js/lib/md5.min.js"></script><script nonce="KzqVkF9vWmCWDqSz14H7xyDl8m67drxsDsCAccM09L8x2qLu" src="/static/v20211025.1/extensions/Review/web/js/badge.js"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla@Mozilla" href="/search_plugin.cgi"><link rel="shortcut icon" href="/extensions/BMO/web/images/favicon.ico">
<link rel="canonical" href="https://bugzilla.mozilla.org/show_bug.cgi?id=1278013">
<link rel="shorturl" href="https://bugzilla.mozilla.org/1278013"><meta name="google-analytics" content="UA-36116321-3" data-location="https://bugzilla.mozilla.org/bug/show-modal" data-title="1278013 - (CVE-2016-5265) Same origin policy bypass in local document/Universal xss">
<script async src="https://www.google-analytics.com/analytics.js"></script><meta name="robots" content="noarchive">
  </head>



  <body
        class="bugzilla-mozilla-org
               skin-standard bug_modal yui-skin-sam">



<div id="wrapper">

<header id="header" role="banner">
  <div class="inner">
    <h1 id="header-title" class="title"><a href="https://bugzilla.mozilla.org/home" title="Go to home page">Bugzilla</a></h1>
    <form role="search" id="header-search" class="quicksearch" action="/buglist.cgi" data-no-csrf>
      <section class="searchbox-outer dropdown" role="combobox" aria-expanded="false" aria-haspopup="listbox"
               aria-labelledby="header-search-label" aria-owns="header-search-dropdown">
        <h2 id="header-search-label">Quick Search</h2>
        <span class="icon" aria-hidden="true"></span>
        <input role="searchbox" id="quicksearch_top" class="dropdown-button" name="quicksearch" autocomplete="off"
               value="" placeholder="Search Bugs"
               title="Enter a bug number or some search terms" aria-controls="header-search-dropdown"
               aria-label="Quick Search"><div id="header-search-dropdown" class="dropdown-content right" role="listbox" style="display: none;">
  <div id="header-search-dropdown-wrapper">
  </div>
</div>
      </section>
    </form>
    <nav id="header-nav">
      <ul class="links">
        <li class="link-browse">
          <a href="/describecomponents.cgi" title="Browse bugs by component">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Browse</span>
          </a>
        </li>
        <li class="link-search">
          <a href="/query.cgi?format=advanced" title="Search bugs using various criteria">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Advanced Search</span>
          </a>
        </li>
      </ul>
      <div class="dropdown">
        <button type="button" id="header-tools-menu-button" class="dropdown-button minor" title="More tools…"
                aria-label="More tools…" aria-expanded="false" aria-haspopup="true" aria-controls="header-tools-menu">
          <span class="icon" aria-hidden="true"></span>
        </button>
        <ul class="dropdown-content left" id="header-tools-menu" role="menu" style="display:none;">
          <li role="presentation">
            <a href="/report.cgi" role="menuitem" tabindex="-1">Reports</a>
          </li>
            <li role="separator"></li>
            <li role="presentation">
              <a href="https://bmo.readthedocs.io/en/latest/" role="menuitem" tabindex="-1">Documentation</a>
            </li>
        </ul>
      </div>
    </nav>
      <ul id="header-login" class="links">
          <li id="moz_new_account_container_top"><a href="/createaccount.cgi">New Account</a></li><li id="mini_login_container_top">
  <a id="login_link_top" href="/index.cgi?GoAheadAndLogIn=1"
     class='show_mini_login_form' data-qs-suffix="_top">Log In</a>

  <div id="mini_login_top" class="mini-popup mini_login bz_default_hidden"><span id="github_mini_login_top" class="mini_login_top">
    <form method="post" action="/github.cgi">
      <input type="hidden" name="github_secret" value="y196Tt2TtZ5naF1qM7LnkmFaW3Y6uupQWj2IQAVk6V5Xj3duDuTXWVZnelBbM7LbqbalrRyqQY9vmuCXGZ5EfQXiIdVOWmSfx824dGcKDqWOE7xRiy2c0p9CUpIYou7fihyif8xyyQQLg9zT7hAHXU0qGzZ7ib6ACOaPmF3Qqhx6Fh30iGveRYRwExG2LmVb1MlQwdUoRhcZM39NtnP8AgqyKhQ5b8zRudUpjuYljkepfZ58BLHv4w9EXKOk3eFW">
      <input type="hidden" name="target_uri" value="https://bugzilla.mozilla.org/show_bug.cgi">
      <input type="image" src="/extensions/GitHubAuth/web/images/sign_in.png" height="22" width="75" align="absmiddle"
             alt="Sign in with GitHub"
             title="Sign in with GitHub"> or
    </form>
  </span>

  <form action="/show_bug.cgi?id=1278013" method="POST"
        data-qs-suffix="_top">

    <input id="Bugzilla_login_top"
           class="bz_login"
           name="Bugzilla_login"
           title="Login"
           placeholder="Email"
           aria-label="Email"
           type="email"
           required
    >
    <input class="bz_password"
           id="Bugzilla_password_top"
           name="Bugzilla_password"
           type="password"
           title="Password"
           placeholder="Password"
           aria-label="Password"
           required
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text"
           id="Bugzilla_password_dummy_top" value="password"
           title="Password"
    >
      <input type="checkbox" id="Bugzilla_remember_top"
             name="Bugzilla_remember" value="on" class="bz_remember"
                 checked>
      <label for="Bugzilla_remember_top">Remember</label>
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
           class="check_mini_login_fields"
            id="log_in_top">
    <a href="#" id="hide_mini_login_top" aria-label="Close"
       class="close-button hide_mini_login_form" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
<li id="forgot_container_top">
  <a id="forgot_link_top" href="/index.cgi?GoAheadAndLogIn=1#forgot"
     class='show_forgot_form'
     data-qs-suffix="_top">Forgot Password</a>
  <div id="forgot_form_top" class="mini-popup mini_forgot bz_default_hidden">
  <form action="/token.cgi" method="post">
    <input type="email" name="loginname" size="20" placeholder="Email" aria-label="Email" required>
    <input id="forgot_button_top" value="Reset Password"
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <input type="hidden" id="token_top" name="token" value="1635622989-7X0JAq8pX5SIrLQI2NJuUUx0kA4VNwSwid3kW_wY85g">
    <a href="#" class="close-button hide_forgot_form" aria-label="Close" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
      </ul><div id="header-external-links" class="dropdown first">
  <button type="button" id="header-external-menu-button" class="dropdown-button minor" title="Mozilla"
          aria-label="Mozilla" aria-expanded="false" aria-haspopup="true" aria-controls="header-external-menu">
    <img src="/static/v20211025.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg" width="32" height="32" alt="">
  </button>
  <ul class="dropdown-content right" id="header-external-menu" role="menu" style="display:none;">
    <li role="presentation">
      <a href="https://www.mozilla.org/" role="menuitem" tabindex="-1">Mozilla Home</a>
    </li>
    <li role="separator"></li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/" role="menuitem" tabindex="-1">Privacy</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/#cookies" role="menuitem" tabindex="-1">Cookies</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/about/legal/" role="menuitem" tabindex="-1">Legal</a>
    </li>
  </ul>
</div>
  </div>
</header> 


<main id="bugzilla-body" tabindex="-1">

<aside id="message-container" role="complementary">
  <noscript>
    <div class="noscript">
      <div class="inner">
        <p>Please enable JavaScript in your browser to use all the features on this site.</p>
      </div>
    </div>
  </noscript>
</aside>

<div id="main-inner">




<div role="toolbar" id="page-toolbar">
  <div role="group" class="buttons">
    <button type="button" id="copy-summary" class="secondary"
      title="Copy bug number and summary to your clipboard">Copy Summary</button>
    <div id="clip-container" style="display:none"><input type="text" id="clip"></div>
    <div class="dropdown">
      <button type="button" id="action-menu-btn" aria-haspopup="true" aria-label="View"
        aria-expanded="false" aria-controls="action-menu" class="dropdown-button secondary">View &#9662;</button>
      <ul class="dropdown-content left" id="action-menu" role="menu" style="display:none;">
        <li role="presentation">
          <a id="action-reset" role="menuitem" tabindex="-1">Reset Sections</a>
        </li>
        <li role="presentation">
          <a id="action-expand-all" role="menuitem" tabindex="-1">Expand All Sections</a>
        </li>
        <li role="presentation">
          <a id="action-collapse-all" role="menuitem" tabindex="-1">Collapse All Sections</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a id="action-history" role="menuitem" tabindex="-1">History</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a href="/rest/bug/1278013" role="menuitem" tabindex="-1">JSON</a>
        </li>
        <li role="presentation">
          <a href="/show_bug.cgi?ctype=xml&amp;id=1278013" role="menuitem" tabindex="-1">XML</a>
        </li>
      </ul>
    </div>
  </div>
</div>



<div role="status" id="io-error" style="display:none"></div>
<div role="status" id="floating-message" style="display:none">
  <div id="floating-message-text"></div>
</div>
<section class="module"
>
  <div class="module-content"
  >
  <div id="summary-container">
    <div class="field indent" id="field-status_summary"
>


  
    <div class=" container">
        <span id="field-value-status_summary">
      <span class="bug-status-label text" data-status="closed">Closed</span>
      <span id="field-value-bug_id">
        <a href="/show_bug.cgi?id=1278013">Bug 1278013</a>
          <span class="edit-hide">(CVE-2016-5265)</span>
      </span>
      <span>
        <span class="bug-time-label">Opened <span class="rel-time" title="2016-06-03 18:06 PDT" data-time="1465002390">6 years ago</span></span>
          <span class="bug-time-label">Closed <span class="rel-time" title="2016-06-24 13:39 PDT" data-time="1466800797">5 years ago</span></span>
      </span>
        </span>
    </div>

  
</div>
<div class="field indent edit-hide"
>


  
    <div class=" container">
      

      <h1 id="field-value-short_desc">Same origin policy bypass in local document/Universal xss</h1>
    </div>

  
</div>

    <div class="field edit-show" id="field-short_desc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc" id="short_desc-help-link" class="help">Summary:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-short_desc">
            Same origin policy bypass in local document/Universal xss

        </span>
    </div>

  
</div>
  </div>
  </div>
</section>


<section class="module" id="module-categories"
>
    <header id="module-categories-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Categories section"
           data-label-collapsed="Expand Categories section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-categories-content"
             aria-expanded="true"
             aria-labeledby="module-categories-title"
             aria-describedby="module-categories-subtitle"></div>
        <h2 class="module-title" id="module-categories-title">Categories</h2>
          <h3 class="module-subtitle" id="module-categories-subtitle">
            (Core :: Networking: File, defect)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-categories-content"
  ><div class="fields-lhs">

    <div class="field" id="field-product"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=Core" id="product-help-link" class="help">Product:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-product">
      <div class="name-info-outer dropdown">
        <span id="product-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="product-info">Core
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="product-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Product description and actions">
          <header>
            <div class="title">Core</div>
            <div class="description">Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the <a href="https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox">Firefox</a> product. (<a href="https://wiki.mozilla.org/Modules/All#Core">More info</a>)</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=Core&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Product</a></div>
            <div><a href="/enter_bug.cgi?product=Core"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Product</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="Core"
                         data-label-watch="Watch This Product" data-label-unwatch="Unwatch This Product"
                         data-source="BugModal">Watch This Product</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-component"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=Core&component=Networking%3A%20File#Networking%3A%20File" id="component-help-link" class="help">Component:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-component">
      <div class="name-info-outer dropdown">
        <span id="component-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="component-info">Networking: File
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="component-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Component description and actions">
          <header>
            <div class="title">Core :: Networking: File</div>
            <div class="description">For bugs in Mozilla's File IO code. This component deals with File specific issues like writing to disk, reading local files, etc Related problems with file:// protocol may also be addressed here.</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=Core&amp;component=Networking%3A%20File&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Component</a></div>
            <div><a href="/buglist.cgi?product=Core&amp;component=Networking%3A%20File&amp;chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__"
                    target="_blank" role="menuitem" tabindex="-1">Recently Fixed Bugs in This Component</a></div>
            <div><a href="/enter_bug.cgi?product=Core&amp;component=Networking%3A%20File"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Component</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="Core" data-component="Networking: File"
                         data-label-watch="Watch This Component" data-label-unwatch="Unwatch This Component"
                         data-source="BugModal">Watch This Component</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-version"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#version" id="version-help-link" class="help">Version:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-version">
            38 Branch

        </span>
    </div>

  
</div>

    <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform" id="-help-link" class="help">Platform:
        </a>
    </div>


  
    <div class=" container"><div class="field inline" id="field-rep_platform"
>


  
    <div class="value">
        <span id="field-value-rep_platform">
            Unspecified

        </span>
    </div>

  
</div><div class="field indent inline" id="field-op_sys"
>


  
    <div class="value">
        <span id="field-value-op_sys">
            Unspecified

        </span>
    </div>

  
</div><div class="field indent inline"
>


  
    <div class=" container">
    </div>

  
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field contains-buttons" id="field-bug_type"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type" id="bug_type-help-link" class="help">Type:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_type">
      <span class="bug-type-label iconic-text" data-type="defect">
        <span class="icon" aria-hidden="true"></span>defect</span>
        </span>
    </div>

  
</div>

    <div class="field" id="field-importance"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority" id="importance-help-link" class="help">Priority:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-importance"><div class="field inline" id="field-priority"
>


  
    <div class="value">
        <span id="field-value-priority">
          <em>Not set</em>
        </span>
    </div>

  
</div><div class="field inline" id="field-bug_severity"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity" id="bug_severity-help-link" class="help">Severity:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_severity">
            normal

        </span>
    </div>

  
</div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-cf_fx_points" style="display:none"
>
    <div class="name">Points:
    </div>


  
    <div class="value">
        <span id="field-value-cf_fx_points">
            ---

        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-tracking"
>
    <header id="module-tracking-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Tracking section"
           data-label-collapsed="Expand Tracking section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-tracking-content"
             aria-expanded="true"
             aria-labeledby="module-tracking-title"
             aria-describedby="module-tracking-subtitle"></div>
        <h2 class="module-title" id="module-tracking-title">Tracking</h2>
          <h3 class="module-subtitle" id="module-tracking-subtitle">
            (<span id="readable-bug-status" data-readable-bug-status="{&quot;flags&quot;:[{&quot;status&quot;:&quot;+&quot;,&quot;name&quot;:&quot;sec-bounty&quot;}],&quot;cf_status_firefox_esr91&quot;:&quot;---&quot;,&quot;status&quot;:&quot;RESOLVED&quot;,&quot;cf_status_thunderbird_esr78&quot;:&quot;---&quot;,&quot;keywords&quot;:[&quot;csectype-sop&quot;,&quot;regression&quot;,&quot;sec-moderate&quot;],&quot;cf_tracking_firefox_relnote&quot;:&quot;---&quot;,&quot;cf_tracking_thunderbird_esr91&quot;:&quot;---&quot;,&quot;cf_status_firefox_esr38&quot;:&quot;wontfix&quot;,&quot;cf_status_firefox94&quot;:&quot;---&quot;,&quot;cf_webcompat_priority&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_sumo&quot;:&quot;---&quot;,&quot;cf_a11y_review_project_flag&quot;:&quot;---&quot;,&quot;cf_status_firefox_esr78&quot;:&quot;---&quot;,&quot;target_milestone&quot;:&quot;mozilla50&quot;,&quot;cf_tracking_firefox93&quot;:&quot;---&quot;,&quot;cf_status_firefox49&quot;:&quot;fixed&quot;,&quot;cf_tracking_thunderbird_esr78&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_esr45&quot;:&quot;48+&quot;,&quot;cf_status_firefox_esr45&quot;:&quot;fixed&quot;,&quot;cf_status_firefox95&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_esr78&quot;:&quot;---&quot;,&quot;cf_status_firefox93&quot;:&quot;---&quot;,&quot;cf_status_firefox50&quot;:&quot;fixed&quot;,&quot;resolution&quot;:&quot;FIXED&quot;,&quot;cf_status_firefox46&quot;:&quot;wontfix&quot;,&quot;cf_root_cause&quot;:&quot;---&quot;,&quot;dupe_of&quot;:null,&quot;cf_fission_milestone&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_esr91&quot;:&quot;---&quot;,&quot;cf_tracking_firefox94&quot;:&quot;---&quot;,&quot;cf_status_firefox47&quot;:&quot;wontfix&quot;,&quot;cf_status_firefox48&quot;:&quot;fixed&quot;,&quot;priority&quot;:&quot;--&quot;,&quot;cf_tracking_firefox95&quot;:&quot;---&quot;,&quot;id&quot;:1278013,&quot;cf_status_thunderbird_esr91&quot;:&quot;---&quot;}"></span>)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-tracking-content"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-status-view"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-view-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-view">RESOLVED
        FIXED
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-status-edit" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-edit-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-edit"><div class="field inline" id="field-bug_status"
>


  
    <div class="value">
        <span id="field-value-bug_status">
            RESOLVED

        </span>
    </div>

  
</div><div class="field indent inline" id="field-resolution"
>


  
    <div class="value">
        <span id="field-value-resolution">
            FIXED

        </span>
    </div>

  
</div>
  <div id="status-action-buttons">
      <div id="assigned-container" style="display:none">
        <button type="button" class="secondary" id="mark-as-assigned-btn">
          Mark as Assigned
        </button>
      </div>
  </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-target_milestone"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone" id="target_milestone-help-link" class="help">Milestone:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-target_milestone">
            mozilla50

        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-cf_fx_iteration" style="display:none"
>
    <div class="name">Iteration:
    </div>


  
    <div class="value">
        <span id="field-value-cf_fx_iteration">
            ---

        </span>
    </div>

  
</div>


      <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Project Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <td class="tracking-flag-name">Webcompat Priority</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_webcompat_priority-dirty">
  <select id="cf_webcompat_priority" name="cf_webcompat_priority">
        <option value="---"
          id="v4274_cf_webcompat_priority" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">a11y-review</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_a11y_review_project_flag-dirty">
  <select id="cf_a11y_review_project_flag" name="cf_a11y_review_project_flag">
        <option value="---"
          id="v4876_cf_a11y_review_project_flag" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Root Cause</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_root_cause-dirty">
  <select id="cf_root_cause" name="cf_root_cause">
        <option value="---"
          id="v4701_cf_root_cause" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">user-doc-firefox</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_sumo-dirty">
  <select id="cf_tracking_firefox_sumo" name="cf_tracking_firefox_sumo">
        <option value="---"
          id="v4660_cf_tracking_firefox_sumo" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Fission Milestone</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_fission_milestone-dirty">
  <select id="cf_fission_milestone" name="cf_fission_milestone">
        <option value="---"
          id="v4222_cf_fission_milestone" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

      <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Tracking Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-hide">
    <table class="layout-table tracking-flags">
        <tr>
          <th></th>
          <th>Tracking</th>
          <th>Status</th>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox46</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox46&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox47</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox47&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox48</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox48&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox49</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox49&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox-esr38</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox_esr38&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox-esr45</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox_esr45&amp;o1=equals&amp;v1=48%2B">48+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox50</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox50&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
    </table>
  </div>


<div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <th></th>
        <th>Tracking</th>
        <th>Status</th>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox46</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox46-dirty">
  <select id="cf_status_firefox46" name="cf_status_firefox46">
        <option value="wontfix"
          id="v2563_cf_status_firefox46" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox47</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox47-dirty">
  <select id="cf_status_firefox47" name="cf_status_firefox47">
        <option value="wontfix"
          id="v2611_cf_status_firefox47" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox48</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox48-dirty">
  <select id="cf_status_firefox48" name="cf_status_firefox48">
        <option value="fixed"
          id="v2676_cf_status_firefox48" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox49</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox49-dirty">
  <select id="cf_status_firefox49" name="cf_status_firefox49">
        <option value="fixed"
          id="v2785_cf_status_firefox49" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr38</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr38-dirty">
  <select id="cf_status_firefox_esr38" name="cf_status_firefox_esr38">
        <option value="wontfix"
          id="v2154_cf_status_firefox_esr38" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr45</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr45-dirty">
  <select id="cf_tracking_firefox_esr45" name="cf_tracking_firefox_esr45">
        <option value="48+"
          id="v2581_cf_tracking_firefox_esr45" selected
        >48+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr45-dirty">
  <select id="cf_status_firefox_esr45" name="cf_status_firefox_esr45">
        <option value="fixed"
          id="v2548_cf_status_firefox_esr45" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">relnote-firefox</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_relnote-dirty">
  <select id="cf_tracking_firefox_relnote" name="cf_tracking_firefox_relnote">
        <option value="---"
          id="v539_cf_tracking_firefox_relnote" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr78-dirty">
  <select id="cf_tracking_thunderbird_esr78" name="cf_tracking_thunderbird_esr78">
        <option value="---"
          id="v4823_cf_tracking_thunderbird_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr78-dirty">
  <select id="cf_status_thunderbird_esr78" name="cf_status_thunderbird_esr78">
        <option value="---"
          id="v4829_cf_status_thunderbird_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr91-dirty">
  <select id="cf_tracking_thunderbird_esr91" name="cf_tracking_thunderbird_esr91">
        <option value="---"
          id="v5236_cf_tracking_thunderbird_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr91-dirty">
  <select id="cf_status_thunderbird_esr91" name="cf_status_thunderbird_esr91">
        <option value="---"
          id="v5242_cf_status_thunderbird_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox50</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox50-dirty">
  <select id="cf_status_firefox50" name="cf_status_firefox50">
        <option value="fixed"
          id="v2840_cf_status_firefox50" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr78-dirty">
  <select id="cf_tracking_firefox_esr78" name="cf_tracking_firefox_esr78">
        <option value="---"
          id="v4808_cf_tracking_firefox_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr78-dirty">
  <select id="cf_status_firefox_esr78" name="cf_status_firefox_esr78">
        <option value="---"
          id="v4813_cf_status_firefox_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr91-dirty">
  <select id="cf_tracking_firefox_esr91" name="cf_tracking_firefox_esr91">
        <option value="---"
          id="v5194_cf_tracking_firefox_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr91-dirty">
  <select id="cf_status_firefox_esr91" name="cf_status_firefox_esr91">
        <option value="---"
          id="v5199_cf_status_firefox_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox93</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox93-dirty">
  <select id="cf_tracking_firefox93" name="cf_tracking_firefox93">
        <option value="---"
          id="v5266_cf_tracking_firefox93" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox93-dirty">
  <select id="cf_status_firefox93" name="cf_status_firefox93">
        <option value="---"
          id="v5271_cf_status_firefox93" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox94</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox94-dirty">
  <select id="cf_tracking_firefox94" name="cf_tracking_firefox94">
        <option value="---"
          id="v5284_cf_tracking_firefox94" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox94-dirty">
  <select id="cf_status_firefox94" name="cf_status_firefox94">
        <option value="---"
          id="v5289_cf_status_firefox94" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox95</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox95-dirty">
  <select id="cf_tracking_firefox95" name="cf_tracking_firefox95">
        <option value="---"
          id="v5311_cf_tracking_firefox95" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox95-dirty">
  <select id="cf_status_firefox95" name="cf_status_firefox95">
        <option value="---"
          id="v5316_cf_status_firefox95" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>

</div>
  </div>
</section>



<section class="module" id="module-people"
>
    <header id="module-people-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse People section"
           data-label-collapsed="Expand People section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-people-content"
             aria-expanded="false"
             aria-labeledby="module-people-title"
             aria-describedby="module-people-subtitle"></div>
        <h2 class="module-title" id="module-people-title">People</h2>
          <h3 class="module-subtitle" id="module-people-subtitle">
            (Reporter: qab, Assigned: ckerschb)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-people-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-assigned_to"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to"><div class="vcard vcard_363267" ><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=363267" > <span class="fna">ckerschb</span></a>
</div>
        </span>
    </div>

  
</div><div class="field edit-show" id="field-assigned_to" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-assignee" name="set_default_assignee" class="set-default"
          value="1" data-for="assigned_to">
        <label for="set-default-assignee">Reset Assignee to default</label>
      </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-bug_mentors" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor" id="bug_mentors-help-link" class="help">Mentors:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_mentors">---
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-qa_contact" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact" id="qa_contact-help-link" class="help">QA Contact:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-qa_contact">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-qa-contact" name="set_default_qa_contact" class="set-default"
          value="1" data-for="qa_contact">
        <label for="set-default-qa-contact">Reset QA Contact to default</label>
      </div>
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-reporter"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter" id="reporter-help-link" class="help">Reporter:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-reporter">
            <div class="vcard vcard_550582" ><img src="https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=550582" > <span class="fna">qab</span></a>
</div>

        </span>
    </div>

  
</div>

    <div class="field" id="field-triage_owner"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner" id="triage_owner-help-link" class="help">Triage Owner:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-triage_owner">
            <div class="vcard vcard_646284" ><img src="https://secure.gravatar.com/avatar/9dcff4a8838b41f34d204c2f4cadbcc4?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=646284" > <span class="fna">jstutte</span></a>
</div>

        </span>
    </div>

  
</div>

    

    <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc" id="-help-link" class="help">CC:
        </a>
    </div>


  
    <div class=" container">


        <span aria-owns="cc-summary cc-latch">
          <span role="button" tabindex="0" id="cc-summary" data-count="14">14 people
          </span>
        </span>


        <div id="cc-list" style="display:none"></div>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-references"
>
    <header id="module-references-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse References section"
           data-label-collapsed="Expand References section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-references-content"
             aria-expanded="false"
             aria-labeledby="module-references-title"
             aria-describedby="module-references-subtitle"></div>
        <h2 class="module-title" id="module-references-title">References</h2>
      </div>
    </header>
  <div class="module-content" id="module-references-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field bug-list" id="field-dependson"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson" id="dependson-help-link" class="help">Depends on:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-dependson">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox V48.0 UXSS &amp; Address Bar Spoofing"
   href="/show_bug.cgi?id=1292159">CVE-2016-5291</a>
      </div>

        </span>
    </div>

  
</div><div class="field bug-list" id="field-blocked"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks" id="blocked-help-link" class="help">Blocks:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-blocked">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Attach LoadInfo to remaining callers of ioService and ProtocolHandlers"
   href="/show_bug.cgi?id=1099296">1099296</a>
      </div>

        </span>
    </div>

  
</div><div class="field" id="field-dependencytree"
>
    <div class="name">
    </div>


  
    <div class=" container">
        <span id="field-value-dependencytree">
        Dependency <a href="/showdependencytree.cgi?id=1278013&amp;hide_resolved=1">tree</a>
        / <a href="/showdependencygraph.cgi?id=1278013">graph</a>
        </span>
    </div>

  
</div>

    <div class="field bug-list edit-show" id="field-regresses" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses" id="regresses-help-link" class="help">Regressions:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regresses">
        ---
        </span>
    </div>

  
</div><div class="field bug-list edit-show" id="field-regressed_by" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by" id="regressed_by-help-link" class="help">Regressed by:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regressed_by">
        ---
        </span>
    </div>

  
</div>

    
</div><div class="fields-rhs">

    <div class="field edit-show" id="field-bug_file_loc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc" id="bug_file_loc-help-link" class="help">URL:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_file_loc"><div class="link">
    <a href="" target="_blank"
      rel="noreferrer" title=""
      class="bug-url" data-safe="0"></a>
  </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-see_also" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also" id="see_also-help-link" class="help">See Also:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-see_also">
        ---
        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-details"
>
    <header id="module-details-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Details section"
           data-label-collapsed="Expand Details section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-details-content"
             aria-expanded="false"
             aria-labeledby="module-details-title"
             aria-describedby="module-details-subtitle"></div>
        <h2 class="module-title" id="module-details-title">Details</h2>
          <h3 class="module-subtitle" id="module-details-subtitle">
            (Keywords: csectype-sop, regression, sec-moderate, Whiteboard: [adv-main48+][adv-esr45.3+])
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-details-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-show" id="field-alias" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias" id="alias-help-link" class="help">Alias:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-alias">
            CVE-2016-5265

        </span>
    </div>

  
</div>

    <div class="field" id="field-keywords"
>
    <div class="name">
        <a href="/describekeywords.cgi" id="keywords-help-link" class="help">Keywords:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-keywords">
          <a href="/buglist.cgi?keywords=csectype-sop&amp;resolution=---">csectype-sop</a>, 
          <a href="/buglist.cgi?keywords=regression&amp;resolution=---">regression</a>, 
          <a href="/buglist.cgi?keywords=sec-moderate&amp;resolution=---">sec-moderate</a>
        </span>
    </div>

  
</div>

    <div class="field" id="field-status_whiteboard"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/Whiteboard" id="status_whiteboard-help-link" class="help">Whiteboard:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-status_whiteboard">[adv-main48+][adv-esr45.3+]
        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_qa_whiteboard" style="display:none"
>
    <div class="name">QA Whiteboard:
    </div>


  
    <div class="value">
        <span id="field-value-cf_qa_whiteboard">
        ---
        </span>
    </div>

  
</div>

    

    <div class="field" id="field-cf_has_regression_range"
>
    <div class="name">Has Regression Range:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_regression_range">
            yes

        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_has_str" style="display:none"
>
    <div class="name">Has STR:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_str">
            ---

        </span>
    </div>

  
</div>

    <div class="field" id="field-votes"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes" id="votes-help-link" class="help">Votes:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-votes">0
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-bug_flags"
>
    <div class="name">Bug Flags:
    </div>


  
    <div class=" container">
        <span id="field-value-bug_flags"><div id="bug-flags" class="flags">
  <table class="layout-table">
          <tbody class="edit-hide"><tr>
    <td class="flag-setter"><div class="vcard vcard_1689" ><a class="email " href="/user_profile?user_id=1689" > <span class="fna">dveditz</span></a>
</div>
    </td>

    <td class="flag-name">
        <a href="#c45"
            class="rel-time-title activity-ref"
            title="6 years ago"
        data-time="1465517834"
      >sec-bounty</a>
    </td>

    <td class="flag-value">+
    </td>

  </tr>
          </tbody>
          <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter"><div class="vcard vcard_1689" ><a class="email " href="/user_profile?user_id=1689" > <span class="fna">dveditz</span></a>
</div>
    </td>

    <td class="flag-name">
      <label title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug." for="flag-1408943">sec-bounty</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag-1408943-dirty">
      <select id="flag-1408943" name="flag-1408943"
        title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug."
        class="bug-flag">
            <option value="+" selected>+</option>
      </select>
    </td>


  </tr>
          </tbody>
    <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?" for="flag_type-930">behind-pref</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-930-dirty">
      <select id="flag_type-930" name="flag_type-930"
        title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?"
        class="bug-flag">
          <option value="X"></option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag tracking inclusion in the desktop Firefox product backlog." for="flag_type-846">firefox-backlog</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-846-dirty">
      <select id="flag_type-846" name="flag_type-846"
        title="Flag tracking inclusion in the desktop Firefox product backlog."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame." for="flag_type-913">sec-bounty-hof</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-913-dirty">
      <select id="flag_type-913" name="flag_type-913"
        title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-787">in-qa-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-787-dirty">
      <select id="flag_type-787" name="flag_type-787"
        title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>

      <td class="flag-requestee">
        <div id="requestee_type-787-container" style="display:none"><input
    name="requestee_type-787"
    value="" class="requestee bz_autocomplete_user"  id="requestee_type-787" 
  >
        </div>
      <td>

  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-37">in-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-37-dirty">
      <select id="flag_type-37" name="flag_type-37"
        title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually" for="flag_type-864">qe-verify</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-864-dirty">
      <select id="flag_type-864" name="flag_type-864"
        title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually"
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr>
    </tbody>
  </table>
</div>
        </span>
    </div>

  
</div>
</div>

  
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-crash-data"
>
    <header id="module-crash-data-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Crash Data section"
           data-label-collapsed="Expand Crash Data section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-crash-data-content"
             aria-expanded="false"
             aria-labeledby="module-crash-data-title"
             aria-describedby="module-crash-data-subtitle"></div>
        <h2 class="module-title" id="module-crash-data-title">Crash Data</h2>
      </div>
    </header>
  <div class="module-content" id="module-crash-data-content" style="display:none"
  ><div class="field edit-show" id="field-cf_crash_signature" style="display:none"
>
    <div class="name">Signature:
    </div>


  
    <div class="value">
        <span id="field-value-cf_crash_signature">
        </span>
    </div>

  
</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-security"
>
    <header id="module-security-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Security section"
           data-label-collapsed="Expand Security section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-security-content"
             aria-expanded="false"
             aria-labeledby="module-security-title"
             aria-describedby="module-security-subtitle"></div>
        <h2 class="module-title" id="module-security-title">Security</h2>
          <h3 class="module-subtitle" id="module-security-subtitle">
            (public)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-security-content" style="display:none"
  ><div class="groups edit-hide">
    This bug is publicly visible.
</div>

<div class="groups edit-show" style="display:none">


</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-user-story" data-non-stick="1"
>
    <header id="module-user-story-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse User Story section"
           data-label-collapsed="Expand User Story section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-user-story-content"
             aria-expanded="false"
             aria-labeledby="module-user-story-title"
             aria-describedby="module-user-story-subtitle"></div>
        <h2 class="module-title" id="module-user-story-title">User Story</h2>
      </div>
    </header>
  <div class="module-content" id="module-user-story-content" style="display:none"
  >
    <pre id="user-story"></pre>
  </div>
</section>







<section class="module" id="module-attachments"
>
    <header id="module-attachments-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Attachments section"
           data-label-collapsed="Expand Attachments section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-attachments-content"
             aria-expanded="true"
             aria-labeledby="module-attachments-title"
             aria-describedby="module-attachments-subtitle"></div>
        <h2 class="module-title" id="module-attachments-title">Attachments</h2>
          <h3 class="module-subtitle" id="module-attachments-subtitle">
            (8 files)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-attachments-content"
  ><table role="table" class="layout-table" id="attachments">
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8759911">bypass.zip</a>
        </div>
        <div>
            <a href="#c0" class="attach-time activity-ref"><span class="rel-time" title="2016-06-03 18:06 PDT" data-time="1465002390">6 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_550582" ><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div></span>
        </div>
        <div class="attach-info">562 bytes,
          application/zip        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8759911&amp;action=edit">Details</a>
    </tr>
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8759912"
              title="Screenshot of bypass being used to read full directory"
              class="lightbox">
              <img src="/extensions/BugModal/web/image.png" width="16" height="16">Screenshot of bypass being used to read full directory
            </a>
        </div>
        <div>
            <a href="#c1" class="attach-time activity-ref"><span class="rel-time" title="2016-06-03 18:16 PDT" data-time="1465002982">6 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_550582" ><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div></span>
        </div>
        <div class="attach-info">23.08 KB,
          image/png        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8759912&amp;action=edit">Details</a>
    </tr>
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8759914">PoC of reading facebook.com with full credentials (aka logged in)</a>
        </div>
        <div>
            <a href="#c2" class="attach-time activity-ref"><span class="rel-time" title="2016-06-03 18:29 PDT" data-time="1465003798">6 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_550582" ><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div></span>
        </div>
        <div class="attach-info">648 bytes,
          application/zip        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8759914&amp;action=edit">Details</a>
    </tr>
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8759915"
              title="Screenshot of using this bypass to read facebook whilst logged in"
              class="lightbox">
              <img src="/extensions/BugModal/web/image.png" width="16" height="16">Screenshot of using this bypass to read facebook whilst logged in
            </a>
        </div>
        <div>
            <a href="#c3" class="attach-time activity-ref"><span class="rel-time" title="2016-06-03 18:32 PDT" data-time="1465003940">6 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_550582" ><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div></span>
        </div>
        <div class="attach-info">39.40 KB,
          image/png        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8759915&amp;action=edit">Details</a>
    </tr>
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8759920">bypass3.zip</a>
        </div>
        <div>
            <a href="#c5" class="attach-time activity-ref"><span class="rel-time" title="2016-06-03 19:16 PDT" data-time="1465006574">6 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_550582" ><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div></span>
        </div>
        <div class="attach-info">618 bytes,
          application/zip        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8759920&amp;action=edit">Details</a>
    </tr>
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8760441"
              title="mozregression"
              class="lightbox">
              <img src="/extensions/BugModal/web/image.png" width="16" height="16">mozregression
            </a>
        </div>
        <div>
            <a href="#c13" class="attach-time activity-ref"><span class="rel-time" title="2016-06-06 14:11 PDT" data-time="1465247476">6 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_550582" ><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div></span>
        </div>
        <div class="attach-info">49.12 KB,
          image/png        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8760441&amp;action=edit">Details</a>
    </tr>
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8763946">Testcase that you can just unzip and run on Mac</a>
        </div>
        <div>
            <a href="#c29" class="attach-time activity-ref"><span class="rel-time" title="2016-06-21 09:42 PDT" data-time="1466527348">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_20209" ><a class="email " href="/user_profile?user_id=20209" > <span class="fna">Boris Zbarsky [:bzbarsky]</span></a>
</div></span>
        </div>
        <div class="attach-info">685 bytes,
          application/x-zip        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8763946&amp;action=edit">Details</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8764290">bug_1278013_remove_force_inherit_flag_in_basechannel_redirect.patch</a>
        </div>
        <div>
            <a href="#c33" class="attach-time activity-ref"><span class="rel-time" title="2016-06-22 08:20 PDT" data-time="1466608822">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_363267" ><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div></span>
        </div>
        <div class="attach-info">3.46 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_20209" ><span class="fn">bzbarsky</span>
</div>:
              <a href="#c34"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1466608822"
            >
              review+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_495955" ><span class="fn">Sylvestre</span>
</div>:
              <a href="#c42"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1466751490"
            >
              approval-mozilla-aurora+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_495955" ><span class="fn">Sylvestre</span>
</div>:
              <a href="#c42"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1466751490"
            >
              approval-mozilla-beta+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_495955" ><span class="fn">Sylvestre</span>
</div>:
              <a href="#c49"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1469084230"
            >
              approval-mozilla-esr45+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8764290&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8764290&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1278013&attachment=8764290">Splinter Review</a>
    </tr>
</table>

<footer id="attachments-footer">
  <div id="attachments-actions">
  </div>
  
</footer>
  </div>
</section>



<script nonce="KzqVkF9vWmCWDqSz14H7xyDl8m67drxsDsCAccM09L8x2qLu">
  init_module_visibility();
</script>



<meta name="firefox-versions" content="{&quot;FIREFOX_AURORA&quot;:&quot;&quot;,&quot;FIREFOX_DEVEDITION&quot;:&quot;94.0b9&quot;,&quot;FIREFOX_ESR&quot;:&quot;78.15.0esr&quot;,&quot;FIREFOX_ESR_NEXT&quot;:&quot;91.2.0esr&quot;,&quot;FIREFOX_NIGHTLY&quot;:&quot;95.0a1&quot;,&quot;FIREFOX_PINEBUILD&quot;:&quot;&quot;,&quot;LAST_MERGE_DATE&quot;:&quot;2021-10-04&quot;,&quot;LAST_RELEASE_DATE&quot;:&quot;2021-10-05&quot;,&quot;LAST_SOFTFREEZE_DATE&quot;:&quot;2021-09-30&quot;,&quot;LATEST_FIREFOX_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_OLDER_VERSION&quot;:&quot;3.6.28&quot;,&quot;LATEST_FIREFOX_RELEASED_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_VERSION&quot;:&quot;93.0&quot;,&quot;NEXT_MERGE_DATE&quot;:&quot;2021-11-01&quot;,&quot;NEXT_RELEASE_DATE&quot;:&quot;2021-11-02&quot;,&quot;NEXT_SOFTFREEZE_DATE&quot;:&quot;2021-10-28&quot;}">


<div id="comment-actions">
    <button type="button" id="bottom-btn" class="secondary" aria-label="Go to Page Bottom">Bottom &darr;</button>
  <div class="dropdown">
    <button type="button" id="comment-tags-btn" aria-haspopup="true" aria-label="Tags"
      aria-expanded="false" aria-controls="comment-tags-menu" class="dropdown-button minor">Tags &#9662;</button>
    <ul id="comment-tags-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a role="menuitem" tabindex="-1" data-comment-tag="">Reset</a>
      </li>
    </ul>
  </div>
  <div class="dropdown">
    <button type="button" id="view-menu-btn" aria-haspopup="true" aria-label="Timeline"
      aria-expanded="false" aria-controls="view-menu" class="dropdown-button minor">Timeline &#9662;</button>
    <ul id="view-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a id="view-reset" role="menuitem" tabindex="-1">Reset</a>
      </li>
      <li role="separator"></li>
      <li role="presentation">
        <a id="view-collapse-all" role="menuitem" tabindex="-1">Collapse All</a>
      </li>
      <li role="presentation">
        <a id="view-expand-all" role="menuitem" tabindex="-1">Expand All</a>
      </li>
      <li role="presentation">
        <a id="view-comments-only" role="menuitem" tabindex="-1">Comments Only</a>
      </li>
    </ul>
   </div>
</div>
<div class="change-set" id="c0"><div class="comment" data-id="11463250" data-no="0"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-0" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550582" ><img src="https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550582" ><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-0"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-0" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c0">Description</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-03 18:06 PDT" data-time="1465002390">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-0">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8759911"
         class="attachment"
         data-id="8759911" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bypass.zip">
      <meta itemprop="contentSize" content="562">
      <meta itemprop="encodingFormat" content="application/zip">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=8759911" itemprop="contentUrl">
        <span id="att-8759911-description" itemprop="description">bypass.zip</span></a>
        — <a href="attachment.cgi?id=8759911&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-0" data-comment-id="11463250">User Agent: Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36

Steps to reproduce:

This only works on local HTML files that have been extracted into a folder, a specially crafted .URL needs to be in the same folder as the locally executed HTML document. User interaction is required (a click)

I have attached a zip file which contains the PoC code, please extract both files into the same folder and open 'PoC.html' _locally_

Additionally, you should create a new file (and folder) located at 'C:/secret/secret.txt' 

Open the PoC file and you should see two anchor tag, one uses the .url bypass another doesnt. This is to clearly show there is a bypass.

On top of that, if we change the target file to a folder like 'C:/secret/' we will be able to read the list of files.

Works on FF-ESR 45.1.1 &amp;&amp; Nightly 49.0a1 (2016-06-03)

I have not played with this much yet, so I'm not sure if more dangerous bypasses or other bugs could be performed using the .URL redirects. Will test more.


Actual results:

Using a .URL file as a redirector, it seems like it breaks the SOP protection. 


Expected results:

I believe local HTML files are only allowed to read files within the same folder the html file has been opened in. What ever protection mechanism exists needs to keep the .url file in mind and block the ability to read arbitrary files.</pre></div><div class="change-set" id="c1"><div class="comment" data-id="11463279" data-no="1"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-1" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550582" ><img src="https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550582" ><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-1"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-1" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c1">Comment 1</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-03 18:16 PDT" data-time="1465002982">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-1">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8759912"
         class="attachment"
         data-id="8759912" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bypass-screenshot.png">
      <meta itemprop="contentSize" content="23639">
      <meta itemprop="encodingFormat" content="image/png">
      <div class="label">
        Attached image
          <a class="link lightbox" href="attachment.cgi?id=8759912" itemprop="contentUrl">
        <span id="att-8759912-description" itemprop="description">Screenshot of bypass being used to read full directory</span></a>
        — <a href="attachment.cgi?id=8759912&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div></div><div class="change-set" id="c2"><div class="comment" data-id="11463283" data-no="2"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-2" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550582" ><img src="https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550582" ><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-2"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-2" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c2">Comment 2</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-03 18:29 PDT" data-time="1465003798">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-2">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8759914"
         class="attachment"
         data-id="8759914" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bypass2.zip">
      <meta itemprop="contentSize" content="648">
      <meta itemprop="encodingFormat" content="application/zip">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=8759914" itemprop="contentUrl">
        <span id="att-8759914-description" itemprop="description">PoC of reading facebook.com with full credentials (aka logged in)</span></a>
        — <a href="attachment.cgi?id=8759914&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-2" data-comment-id="11463283">Its now also possible to read any website with full credentials.

Tested on latest nightly.

The difference here is we are using two layers of redirection using the .URL files.</pre></div><div class="change-set" id="c3"><div class="comment" data-id="11463284" data-no="3"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-3" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550582" ><img src="https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550582" ><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-3"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-3" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c3">Comment 3</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-03 18:32 PDT" data-time="1465003940">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-3">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8759915"
         class="attachment"
         data-id="8759915" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bypass-screenshot2.png">
      <meta itemprop="contentSize" content="40345">
      <meta itemprop="encodingFormat" content="image/png">
      <div class="label">
        Attached image
          <a class="link lightbox" href="attachment.cgi?id=8759915" itemprop="contentUrl">
        <span id="att-8759915-description" itemprop="description">Screenshot of using this bypass to read facebook whilst logged in</span></a>
        — <a href="attachment.cgi?id=8759915&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div></div><div class="change-set" id="c4"><div class="comment" data-id="11463292" data-no="4"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-4" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550582" ><img src="https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550582" ><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-4"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-4" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c4">Comment 4</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-03 18:56 PDT" data-time="1465005417">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-4">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-4" data-comment-id="11463292">Note: Forgot to change the directories in the .URL files in both PoC's please edit them and change them according to which file you want to test the bypass on.

Also keep in mind the hashtag in both PoCs (ln~9 open(XXX,&quot;qab&quot;) is crucial in this bug working, please dont remove but feel free to change the target to whatever youre testing.</pre></div><div class="change-set" id="c5"><div class="comment" data-id="11463307" data-no="5"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-5" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550582" ><img src="https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550582" ><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-5"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-5" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c5">Comment 5</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-03 19:16 PDT" data-time="1465006574">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-5">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8759920"
         class="attachment"
         data-id="8759920" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bypass3.zip">
      <meta itemprop="contentSize" content="618">
      <meta itemprop="encodingFormat" content="application/zip">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=8759920" itemprop="contentUrl">
        <span id="att-8759920-description" itemprop="description">bypass3.zip</span></a>
        — <a href="attachment.cgi?id=8759920&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-5" data-comment-id="11463307">User interaction is not required.

The PoC above will automatically read the file page of C:// using an iframe without requiring the user to click anything. Please change the URL file according to the path where you unzipped the PoC.

Would like to see someone test this using other OS than windows, as the .URL file mentioned here is a Windows only feature. However, the same implementation is used on other OS's which I have no ability to test at the moment.

ref:
- <a rel="nofollow" href="https://help.ubuntu.com/community/UnityLaunchersAndDesktopFiles">https://help.ubuntu.com/community/UnityLaunchersAndDesktopFiles</a>
- <a rel="nofollow" href="http://fileinfo.com/extension/webloc">http://fileinfo.com/extension/webloc</a>


(note: apologies for the constant updates, I usually report a bug before doing any further testing.)</pre></div><div class="change-set" id="c6"><div class="comment" data-id="11463380" data-no="6"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-6" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550582" ><img src="https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550582" ><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-6"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-6" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c6">Comment 6</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-03 23:04 PDT" data-time="1465020249">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-6">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-6" data-comment-id="11463380">It's worth pointing out this is probably more accurately a UXSS (universal xss,) as if you notice in the PoCs we actually end up with a window object that points to an external website (the q variable). So we have the ability to execute arbitrary javascript in that window.

And we can do things like execute q.document.body.innerHTML='&lt;b&gt;&#64;qab&lt;/b&gt;'; and completely take over that page.</pre></div><div class="change-set" id="a18663_550582"><div class="change" id="aa18663_550582">
    <table class="layout-table change-head reporter" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550582" id="a18663_550582"><img src="https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_550582" id="a18663_550582"><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div>
            <span class="user-role">Reporter</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a18663_550582"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a18663_550582">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#a18663_550582">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-03 23:17 PDT" data-time="1465021053">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Summary: Same origin policy bypass in local document &rarr; Same origin policy bypass in local document/Universal xss</div></div></div><div class="change-set" id="c7"><div class="comment" data-id="11463974" data-no="7"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-7" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550582" id="a18663_550582"><img src="https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550582" id="a18663_550582"><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-7"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-7" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c7">Comment 7</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-04 22:11 PDT" data-time="1465103468">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-7">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-7" data-comment-id="11463974">Could you check this please?</pre><div class="activity"><div class="change">Flags: needinfo?(jaws)</div></div></div><div class="change-set" id="c8"><div class="comment" data-id="11466582" data-no="8"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-8" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_409754" id="a18663_550582"><img src="https://secure.gravatar.com/avatar/f4a05c26aad642e94c39fd9fca7e3e25?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_409754" id="a18663_550582"><a class="email " href="/user_profile?user_id=409754" > <span class="fna">Jared Wein [:jaws] (please needinfo? me)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-8"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-8" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c8">Comment 8</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-06 10:26 PDT" data-time="1465234019">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-8">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-8" data-comment-id="11466582">I'm not familiar with the code that parses and loads .URL files. Daniel, do you know who may be a better person to redirect this to?</pre><div class="activity"><div class="change">Flags: needinfo?(jaws) &rarr; needinfo?(dveditz)</div></div></div><div class="change-set" id="c9"><div class="comment" data-id="11466871" data-no="9"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-9" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550582" id="a18663_550582"><img src="https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550582" id="a18663_550582"><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-9"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-9" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c9">Comment 9</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-06 12:05 PDT" data-time="1465239936">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-9">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-9" data-comment-id="11466871">This is the only source code I could find that I think deals with .URL files. 

<a rel="nofollow" href="https://github.com/mozilla/system-addons/blob/master/netwerk/protocol/file/nsFileProtocolHandler.cpp">https://github.com/mozilla/system-addons/blob/master/netwerk/protocol/file/nsFileProtocolHandler.cpp</a></pre></div><div class="change-set" id="c10"><div class="comment" data-id="11466916" data-no="10"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-10" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_20209" id="a18663_550582"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_20209" id="a18663_550582"><a class="email " href="/user_profile?user_id=20209" > <span class="fna">Boris Zbarsky [:bzbarsky]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-10"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-10" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c10">Comment 10</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-06 12:18 PDT" data-time="1465240687">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-10">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-10" data-comment-id="11466916">So the basic issue is that we decide whether to inherit the principal based on the pre-redirect URI.  Then nsBaseChannel::Redirect copies over the loadinfo to the post-redirect channel, so we end up inheriting the principal into the new thing too.

Looks to me at first glance like this behavior introduced in the patch in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Attach LoadInfo to remaining callers of ioService and ProtocolHandlers"
   href="/show_bug.cgi?id=1099296">bug 1099296</a>....  Just to check, is it the case that Firefox 37 does not show this behavior?

Anyway, one possibly annoying thing here is that for something like XHR to a local file we probably _do_ want to propagate the &quot;inherit the principal&quot; bits, unless XHR just stamps on the principal of the result anyway (needs checking).  If we don't, then the obvious thing here is to not propagate the &quot;inherit the principal&quot; flag across this redirect.  Possibly restricted to the .url case, of course; need to check what other things go through nsBaseChannel::Redirect.</pre><div class="activity"><div class="change">Blocks: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Attach LoadInfo to remaining callers of ioService and ProtocolHandlers"
   href="/show_bug.cgi?id=1099296">1099296</a></div><div class="change">Group: firefox-core-security &rarr; core-security</div><div class="change">Status: UNCONFIRMED &rarr; NEW</div><div class="change">Component: Untriaged &rarr; Networking: File</div><div class="change">Ever confirmed: true</div><div class="change">Flags: needinfo?(sworkman)</div><div class="change">Flags: needinfo?(qab)</div><div class="change">Flags: needinfo?(ckerschb)</div><div class="change">Keywords: <a href="/buglist.cgi?keywords=regression&amp;resolution=---">regression</a></div><div class="change">Product: Firefox &rarr; Core</div></div></div><div class="change-set" id="c11"><div class="comment" data-id="11467022" data-no="11"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-11" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_409754" id="a18663_550582"><img src="https://secure.gravatar.com/avatar/f4a05c26aad642e94c39fd9fca7e3e25?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_409754" id="a18663_550582"><a class="email " href="/user_profile?user_id=409754" > <span class="fna">Jared Wein [:jaws] (please needinfo? me)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-11"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-11" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c11">Comment 11</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-06 12:51 PDT" data-time="1465242714">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-11">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-11" data-comment-id="11467022">Abdulrahman, would you be able to run mozregression to narrow down what changeset introduced this bug? More details about mozregression can be found here: <a rel="nofollow" href="http://mozilla.github.io/mozregression/">http://mozilla.github.io/mozregression/</a></pre></div><div class="change-set" id="c12"><div class="comment" data-id="11467148" data-no="12"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-12" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550582" id="a18663_550582"><img src="https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550582" id="a18663_550582"><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-12"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-12" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c12">Comment 12</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-06 13:28 PDT" data-time="1465244897">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-12">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-12" data-comment-id="11467148">(In reply to Boris Zbarsky [:bz] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Same origin policy bypass in local document/Universal xss"
   href="/show_bug.cgi?id=1278013#c10">comment #10</a>)

<span class="quote">&gt; Just to check, is it the case that Firefox 37 does not show
&gt; this behavior?</span >

Just downloaded FF 37.0 and it does not work.


(In reply to Jared Wein [:jaws] (please needinfo? me) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Same origin policy bypass in local document/Universal xss"
   href="/show_bug.cgi?id=1278013#c11">comment #11</a>)
<span class="quote">&gt; Abdulrahman, would you be able to run mozregression to narrow down what
&gt; changeset introduced this bug? More details about mozregression can be found
&gt; here: <a rel="nofollow" href="http://mozilla.github.io/mozregression/">http://mozilla.github.io/mozregression/</a></span >

Yes I'll be happy to. Will reply when I pin point it.</pre></div><div class="change-set" id="a243306_550582"><div class="change" id="aa243306_550582">
    <table class="layout-table change-head reporter" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550582" id="a243306_550582"><img src="https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_550582" id="a243306_550582"><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div>
            <span class="user-role">Reporter</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a243306_550582"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a243306_550582">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#a243306_550582">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-06 13:41 PDT" data-time="1465245696">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(qab)</span></div></div></div><div class="change-set" id="c13"><div class="comment" data-id="11467257" data-no="13"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-13" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550582" id="a243306_550582"><img src="https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550582" id="a243306_550582"><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-13"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-13" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c13">Comment 13</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-06 14:11 PDT" data-time="1465247476">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-13">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8760441"
         class="attachment"
         data-id="8760441" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="mozregression.png">
      <meta itemprop="contentSize" content="50296">
      <meta itemprop="encodingFormat" content="image/png">
      <div class="label">
        Attached image
          <a class="link lightbox" href="attachment.cgi?id=8760441" itemprop="contentUrl">
        <span id="att-8760441-description" itemprop="description">mozregression</span></a>
        — <a href="attachment.cgi?id=8760441&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-13" data-comment-id="11467257">Alright so I ran mozregression and it appears that the bug works on 'mozilla-central build: 2015-02-18' and does not work on 'mozilla-central build: 2015-02-17'
note that this is for nightly builds
Screenshot provided for what its worth.</pre></div><div class="change-set" id="c14"><div class="comment" data-id="11467290" data-no="14"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-14" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_409754" id="a243306_550582"><img src="https://secure.gravatar.com/avatar/f4a05c26aad642e94c39fd9fca7e3e25?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_409754" id="a243306_550582"><a class="email " href="/user_profile?user_id=409754" > <span class="fna">Jared Wein [:jaws] (please needinfo? me)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-14"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-14" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c14">Comment 14</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-06 14:24 PDT" data-time="1465248250">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-14">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-14" data-comment-id="11467290">Thanks, that confirms it is <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Attach LoadInfo to remaining callers of ioService and ProtocolHandlers"
   href="/show_bug.cgi?id=1099296">bug 1099296</a>.</pre><div class="activity"><div class="change">Has Regression Range: --- &rarr; yes</div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox46&amp;o1=isnotempty">status-firefox46</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox46&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox47&amp;o1=isnotempty">status-firefox47</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox47&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox48&amp;o1=isnotempty">status-firefox48</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox48&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox49&amp;o1=isnotempty">status-firefox49</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox49&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr38&amp;o1=isnotempty">status-firefox-esr38</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr38&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">Version: 49 Branch &rarr; 38 Branch</div></div></div><div class="change-set" id="c15"><div class="comment" data-id="11469960" data-no="15"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-15" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_422298" id="a243306_550582"><img src="https://secure.gravatar.com/avatar/6452fd24ddc6682443335349e855487c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_422298" id="a243306_550582"><a class="email " href="/user_profile?user_id=422298" > <span class="fna">Steve Workman [:sworkman] (INACTIVE)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-15"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-15" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c15">Comment 15</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-07 10:29 PDT" data-time="1465320592">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-15">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-15" data-comment-id="11469960">Chris - can you look into this, please?</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(sworkman)</span></div></div></div><div class="change-set" id="a337691_1689"><div class="change" id="aa337691_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a337691_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a337691_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a337691_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a337691_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#a337691_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-07 15:54 PDT" data-time="1465340081">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: core-security &rarr; network-core-security</div><div class="change">Flags: <span class="activity-deleted">needinfo?(dveditz)</span></div></div></div><div class="change-set" id="c16"><div class="comment" data-id="11473137" data-no="16"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-16" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a337691_1689"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a337691_1689"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-16"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-16" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c16">Comment 16</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-08 10:15 PDT" data-time="1465406154">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-16">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-16" data-comment-id="11473137">Boris, I am slightly confused about what's going on here, maybe you can help me clarify so I can debug further.

I am using the PoC from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Same origin policy bypass in local document/Universal xss"
   href="/show_bug.cgi?id=1278013#c0">comment 0</a> using a redir.desktop file instead of the redir.url file, which is, according to the internet, the equivalent on Ubuntu (also inlined that file underneath in case someone wants to reproduce the problem on Linux). I am launching the testfile using [1] and then click the link which points to redir.desktop. The URL gets redirected and the contents of [2] is displayed. That part is fine, besides the fact that the contents of [2] should not be displayed.


Now, the odd part: When I click the second link (which directly points to [2]) then the contents of [2] is also displayed. LoadInfo of the channel looks like the following:

<span class="quote">&gt; LoadInfo {
&gt;  channelURI: file:///secret/secret.txt
&gt;  triggeringPrincipal: file:///home/ckerschb/Desktop/sop_bug/bypass/PoC.html
&gt;  contentPolicyType: 6 [TYPE_DOCUMENT]
&gt;  securityMode: SEC_NORMAL
&gt; }</span >

Now my question, is my test setup wrong? I don't see what security mechanism would block that load. What am I doing wrong?

[1] file:///home/ckerschb/Desktop/sop_bug/bypass/PoC.html
[2] file:///secret/secret.txt
[3] <a rel="nofollow" href="http://mxr.mozilla.org/mozilla-central/source/docshell/base/nsDocShell.cpp#10726">http://mxr.mozilla.org/mozilla-central/source/docshell/base/nsDocShell.cpp#10726</a>

%---snip----
[Desktop Entry]
Encoding=UTF-8
Name=secretLink
Type=Link
URL=file:///secret/secret.txt
Icon=text-html</pre><div class="activity"><div class="change">Flags: needinfo?(ckerschb) &rarr; needinfo?(bzbarsky)</div></div></div><div class="change-set" id="c17"><div class="comment" data-id="11473182" data-no="17"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-17" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_20209" id="a337691_1689"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_20209" id="a337691_1689"><a class="email " href="/user_profile?user_id=20209" > <span class="fna">Boris Zbarsky [:bzbarsky]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-17"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-17" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c17">Comment 17</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-08 10:28 PDT" data-time="1465406937">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-17">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-17" data-comment-id="11473182"><span class="quote">&gt; I am using the PoC from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Same origin policy bypass in local document/Universal xss"
   href="/show_bug.cgi?id=1278013#c0">comment 0</a> using a redir.desktop file instead of the redir.url file</span >

Yes, looks to me like it should be morally equivalent.

<span class="quote">&gt; The URL gets redirected and the contents of [2] is displayed.</span >

Displayed where?  When you click either link, I would expect a new tab to open showing the &quot;secret&quot; file.  The question is whether the contents of that &quot;secret&quot; file are also placed in the textarea in the original page.  _That_ should not happen.

Note that to test this properly you want one link or the other, but not both, to be present in your HTML: they have the same &quot;id&quot; and the testcase adds a click event listener to the _first_ element with that id in the document.  So really, there should be two testcases, one with each of the &lt;a&gt; elements.

<span class="quote">&gt; I don't see what security mechanism would block that load</span >

Nothing should block the load.  It's the access to q.document.body.innerHTML that should be blocked, by same-origin checks.

Note that I expect you can replace file:///secret/secret.txt with <a rel="nofollow" href="http://example.org">http://example.org</a> and end up reading the contents of random pages on the web using this.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(bzbarsky)</span></div></div></div><div class="change-set" id="c18"><div class="comment" data-id="11473237" data-no="18"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-18" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a337691_1689"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a337691_1689"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-18"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-18" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c18">Comment 18</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-08 10:41 PDT" data-time="1465407717">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-18">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-18" data-comment-id="11473237">(In reply to Boris Zbarsky [:bz] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Same origin policy bypass in local document/Universal xss"
   href="/show_bug.cgi?id=1278013#c17">comment #17</a>)
<span class="quote">&gt; Displayed where?  When you click either link, I would expect a new tab to
&gt; open showing the &quot;secret&quot; file.  The question is whether the contents of
&gt; that &quot;secret&quot; file are also placed in the textarea in the original page. 
&gt; _That_ should not happen.</span >

Got you.
 
<span class="quote">&gt; Note that to test this properly you want one link or the other, but not
&gt; both, to be present in your HTML</span >

Thanks!

<span class="quote">&gt; Nothing should block the load.  It's the access to q.document.body.innerHTML
&gt; that should be blocked, by same-origin checks.</span >

Yes, I see. That's what confused me because the only call to CheckMayLoad() I got was for ChannelShouldInteritPrincipal within docshell [1], so I suppose there needs to be a second call to CheckMayLoad whenever we try to access the innterHTML.


Thanks for the clarification!

[1] <a rel="nofollow" href="http://mxr.mozilla.org/mozilla-central/source/docshell/base/nsDocShell.cpp#10726">http://mxr.mozilla.org/mozilla-central/source/docshell/base/nsDocShell.cpp#10726</a></pre></div><div class="change-set" id="c19"><div class="comment" data-id="11473515" data-no="19"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-19" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_20209" id="a337691_1689"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_20209" id="a337691_1689"><a class="email " href="/user_profile?user_id=20209" > <span class="fna">Boris Zbarsky [:bzbarsky]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-19"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-19" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c19">Comment 19</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-08 11:56 PDT" data-time="1465412172">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-19">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-19" data-comment-id="11473515">Having a call to CheckMayLoad any time we try to access the innerHTML is how we did things 10 years ago.  It's super-slow.

The way we do things now is that the two compartments have whatever principals they have, and the cross-compartment wrapper picks a security policy based on those principals.  The problem is that we're inheriting the principal when we shouldn't be, in this case.</pre></div><div class="change-set" id="c20"><div class="comment" data-id="11473957" data-no="20"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-20" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550582" id="a337691_1689"><img src="https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550582" id="a337691_1689"><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-20"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-20" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c20">Comment 20</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-08 14:10 PDT" data-time="1465420233">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-20">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-20" data-comment-id="11473957">I would like to point out that (in windows OS atleast) when you re-edit the .URL files URL which it should redirect to will still point to the URL that was on the pre-edited .URL file. Some some sort of cache is done with .URL files. The only way to 'refresh' the new edited .URL is to rename the .URL file itself.</pre></div><div class="change-set" id="c21"><div class="comment" data-id="11474544" data-no="21"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-21" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550582" id="a337691_1689"><img src="https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550582" id="a337691_1689"><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-21"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-21" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c21">Comment 21</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-08 19:14 PDT" data-time="1465438491">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-21">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-21" data-comment-id="11474544">Thinking more about the attack scenario, I think the fact that a victim would need to download a zip file then unzip and finally execute the malicious html file locally could be shortened greatly.

So after some more testing I think the best attack scenario would be to have the user save the page from an attacker controlled website locally and simply open the index.html file from the downloads page, we can also trick the browser to download and save a .URL file using the (I think by default) option of saving a web page complete.

All we need to do is reference a .URL file using something like:

&lt;link rel=&quot;stylesheet&quot; href=&quot;<a rel="nofollow" href="http://localhost/q.url">http://localhost/q.url</a>&quot; /&gt;

Despite the 'stylesheet' being invalid, its still saved when performing a complete web page save. (this might be another bug in itself)

The location of the .URL file locally is also easily obtained (usually inside the folder 'index_files') and the bypass could be even more easily exploited.


So to summarize:


1. Victim must visit attacker owned website and be prompted to save the page hitting (CTRL+S) and save the page in web complete type and finally open the downloaded html file locally.

2. All local files can be read, as well as full file listings by reading something like 'file://C://' (no user interaction)

3. Binary files can also be read if we use <a rel="nofollow" href="view-source:file://thing.exe">view-source:file://thing.exe</a>

4. We can read external domains like '<a rel="nofollow" href="https://mozilla.org">https://mozilla.org</a>' with credentials (user interaction _required_)</pre></div><div class="change-set" id="c22"><div class="comment" data-id="11474552" data-no="22"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-22" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550582" id="a337691_1689"><img src="https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550582" id="a337691_1689"><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-22"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-22" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c22">Comment 22</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-08 19:41 PDT" data-time="1465440088">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-22">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-22" data-comment-id="11474552">Filed <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE - Save hidden executable in users computer and read external websites or local files using 'Save Page As'"
   href="/show_bug.cgi?id=1279126">Bug 1279126</a> for the 'save full web page' behavior described in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Same origin policy bypass in local document/Universal xss"
   href="/show_bug.cgi?id=1278013#c21">Comment 21</a></pre></div><div class="change-set" id="c23"><div class="comment" data-id="11475737" data-no="23"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-23" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a337691_1689"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a337691_1689"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-23"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-23" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c23">Comment 23</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-09 08:18 PDT" data-time="1465485514">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-23">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-23" data-comment-id="11475737">Boris, I am still having trouble figuring out what's going on with this bug. Running the example from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Same origin policy bypass in local document/Universal xss"
   href="/show_bug.cgi?id=1278013#c0">comment 0</a> using the redir.url testcase I see the contents of secret.txt to be displayed within the textarea. (Using the regular link it's not displayed within the textarea). So at least I can reproduce the problem. However, I don't get any call to nsBaseChannel::Redirect().

Total there are two channels created when clicking solely the link which uses the redir.url:

NewChannelFromURIWithProxyFlagsInternal {
  channelURI: file:///Users/ckerschb/Desktop/sop_bug/bypass/secret.txt#1
  triggeringPrincipal: file:///Users/ckerschb/Desktop/sop_bug/bypass/PoC.html
  contentPolicyType: TYPE_DOCUMENT
  securityMode: SEC_NORMAL
  initalSecurityChecksDone: no
  enforceSecurity: no
}


NewChannelFromURIWithProxyFlagsInternal {
  channelURI: file:///Users/ckerschb/Desktop/sop_bug/bypass/secret.txt#1
  loadingPrincipal: SystemPrincipal
  triggeringPrincipal: SystemPrincipal
  contentPolicyType: TYPE_OTHER
  securityMode: SEC_ALLOW_CROSS_ORIGIN_DATA_IS_NULL, 
  initalSecurityChecksDone: no
  enforceSecurity: no
}

Where the first originates from docshell and the second from browser.js [1] (see also stacktrace underneath). It seems the channel created within browser.js is only used to resolve the URI and not used otherwise. In general, if the initial channel would be redirected, then we should create a new channel internally somewhere, right? But I don't see any other channel creation besides the two listed above. Any suggestions what I could try next to debug this?


[1] <a rel="nofollow" href="http://mxr.mozilla.org/mozilla-central/source/browser/base/content/browser.js#7109">http://mxr.mozilla.org/mozilla-central/source/browser/base/content/browser.js#7109</a>


%---snip----
0 NetUtil_newChannel(aWhatToLoad = [object Object]) [&quot;resource://gre/modules/NetUtil.jsm&quot;:403]
    this = [object Object]
1 setURI(uri = [xpconnect wrapped nsIURI &#64; 0x11bfa7740 (native &#64; 0x18373e308)]) [&quot;chrome://browser/content/browser.js&quot;:7109]
    this = [object Object]
2 updateIdentity(state = 4, uri = [xpconnect wrapped nsIURI &#64; 0x11bfa7740 (native &#64; 0x18373e308)]) [&quot;chrome://browser/content/browser.js&quot;:6748]
    this = [object Object]
3 XULBrowserWindow.onSecurityChange(aWebProgress = [xpconnect wrapped (nsISupports, nsIDocShell, nsIWebNavigation, nsIInterfaceRequestor, nsIWebProgress, nsIDocumentLoader, nsILoadContext) &#64; 0x137d56160 (native &#64; 0x134868008)], aRequest = [xpconnect wrapped (nsISupports, nsIRequest, nsIChannel) &#64; 0x1837d6e20 (native &#64; 0x13138b030)], aState = 4) [&quot;chrome://browser/content/browser.js&quot;:4593]
    this = [object Object]
4 callListeners(listeners = [object Object], args = [xpconnect wrapped (nsISupports, nsIDocShell, nsIWebNavigation, nsIInterfaceRequestor, nsIWebProgress, nsIDocumentLoader, nsILoadContext) &#64; 0x137d56160 (native &#64; 0x134868008)],[xpconnect wrapped (nsISupports, nsIRequest, nsIChannel) &#64; 0x1837d6e20 (native &#64; 0x13138b030)],4) [&quot;chrome://browser/content/tabbrowser.xml&quot;:490]
    this = [object ChromeWindow]
5 _callProgressListeners(aBrowser = [object XULElement], aMethod = &quot;onSecurityChange&quot;, aArguments = [xpconnect wrapped (nsISupports, nsIDocShell, nsIWebNavigation, nsIInterfaceRequestor, nsIWebProgress, nsIDocumentLoader, nsILoadContext) &#64; 0x137d56160 (native &#64; 0x134868008)],[xpconnect wrapped (nsISupports, nsIRequest, nsIChannel) &#64; 0x1837d6e20 (native &#64; 0x13138b030)],4) [&quot;chrome://browser/content/tabbrowser.xml&quot;:505]
    this = [object XULElement]
6 mTabProgressListener/&lt;._callProgressListeners([object XULElement], &quot;onSecurityChange&quot;) [&quot;chrome://browser/content/tabbrowser.xml&quot;:560]
    this = [object Object]
7 mTabProgressListener/&lt;.onSecurityChange(aWebProgress = [xpconnect wrapped (nsISupports, nsIDocShell, nsIWebNavigation, nsIInterfaceRequestor, nsIWebProgress,(gdb)</pre><div class="activity"><div class="change">Flags: needinfo?(bzbarsky)</div></div></div><div class="change-set" id="c24"><div class="comment" data-id="11476468" data-no="24"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-24" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a337691_1689"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a337691_1689"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-24"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-24" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c24">Comment 24</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-09 11:33 PDT" data-time="1465497224">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-24">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-24" data-comment-id="11476468">(In reply to Christoph Kerschbaumer [:ckerschb] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Same origin policy bypass in local document/Universal xss"
   href="/show_bug.cgi?id=1278013#c23">comment #23</a>)
<span class="quote">&gt; Boris, I am still having trouble figuring out what's going on with this bug.
&gt; Running the example from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Same origin policy bypass in local document/Universal xss"
   href="/show_bug.cgi?id=1278013#c0">comment 0</a> using the redir.url testcase I see the
&gt; contents of secret.txt to be displayed within the textarea. (Using the
&gt; regular link it's not displayed within the textarea). So at least I can
&gt; reproduce the problem. However, I don't get any call to
&gt; nsBaseChannel::Redirect().
&gt; 
&gt; Total there are two channels created when clicking solely the link which
&gt; uses the redir.url:
&gt; 
&gt; NewChannelFromURIWithProxyFlagsInternal {
&gt;   channelURI: file:///Users/ckerschb/Desktop/sop_bug/bypass/secret.txt#1
&gt;   triggeringPrincipal: file:///Users/ckerschb/Desktop/sop_bug/bypass/PoC.html
&gt;   contentPolicyType: TYPE_DOCUMENT
&gt;   securityMode: SEC_NORMAL
&gt;   initalSecurityChecksDone: no
&gt;   enforceSecurity: no
&gt; }</span >

I defer to Boris on the details here, but in case this is easy to check: what's the channel's originalURI?</pre></div><div class="change-set" id="c25"><div class="comment" data-id="11476494" data-no="25"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-25" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_20209" id="a337691_1689"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_20209" id="a337691_1689"><a class="email " href="/user_profile?user_id=20209" > <span class="fna">Boris Zbarsky [:bzbarsky]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-25"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-25" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c25">Comment 25</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-09 11:43 PDT" data-time="1465497834">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-25">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-25" data-comment-id="11476494"><span class="quote">&gt; However, I don't get any call to nsBaseChannel::Redirect().</span >

Is this in an e10s build?  Are you checking in the right process?  The way .url files work is that nsFileChannel::OpenContentStream is called, does ReadURLFile, gets an nsIURI, creates a new channel via NS_NewChannel, hands that channel out.  The caller of OpenContentStream is nsBaseChannel::BeginPumpingData which sees a non-null channel and does a RedirectRunnable, and RedirectRunnable::Run calls nsBaseChannel::HandleAsyncRedirect which calls BaseChannel::Redirect.  So if the .url file is working at all, you should be hitting all those things.  I don't know whether that would happen in the child process or parent process in this case.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(bzbarsky)</span></div></div></div><div class="change-set" id="a515444_280903"><div class="change" id="aa515444_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a515444_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a515444_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a515444_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a515444_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#a515444_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-09 17:17 PDT" data-time="1465517834">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: sec-bounty?</div></div></div><div class="change-set" id="c26"><div class="comment" data-id="11492196" data-no="26"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-26" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550582" id="a515444_280903"><img src="https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550582" id="a515444_280903"><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-26"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-26" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c26">Comment 26</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-21 04:53 PDT" data-time="1466510026">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-26">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-26" data-comment-id="11492196">Any update on this? Is this a sec-high bug?</pre><div class="activity"><div class="change">Flags: needinfo?(ckerschb)</div></div></div><div class="change-set" id="c27"><div class="comment" data-id="11492560" data-no="27"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-27" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a515444_280903"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a515444_280903"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-27"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-27" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c27">Comment 27</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-21 07:24 PDT" data-time="1466519080">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-27">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-27" data-comment-id="11492560">On MacOS using the setup including the .url file I get:

a) same origin .url redirect
   * displays content of secret file in the textarea
   * nsBaseChannel::Redirect() is *not* hit at all; neither using e10s nor when using regular mode.

b) cross origin .url redirect:
   * does *not* display content of secret file in textarea
   * nsBaseChannel::Redirect() is *not* hit at all; neither using e10s nor when using regular mode.
   * in the console I see:
     || Error: Permission denied to access property &quot;document&quot;
     || qAnchor.onclick/&lt;/&lt;()
     || PoC.html:11


The .url redirection seems to work, but I don't get a call to nsBaseChannel::Redirect(). I put a MOZ_ASSERT() within that function which should crash the browser in regular mode and crash the tab in e10s mode.

I don't know where to go from here, probably it's wise if someone who has a windows machine handy can try to reproduce the issue. I am really happy to debug more, but I don't know what I could try next.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(ckerschb)</span></div></div></div><div class="change-set" id="c28"><div class="comment" data-id="11492876" data-no="28"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-28" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_20209" id="a515444_280903"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_20209" id="a515444_280903"><a class="email " href="/user_profile?user_id=20209" > <span class="fna">Boris Zbarsky [:bzbarsky]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-28"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-28" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c28">Comment 28</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-21 09:39 PDT" data-time="1466527189">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-28">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-28" data-comment-id="11492876"><span class="quote">&gt; On MacOS using the setup including the .url file</span >

Uh... what setup including the .url file on MacOS?  We only do interesting things with .url files on Windows.  On Mac, we _do_ do the .desktop thing.

On Mac, If I just use the original testcase attached to this bug and change from using a .url file to using a .desktop file so I'm actually testing something meaningful, then open a non-e10s window and click the link to the .desktop file from the testcase, my breakpoint in nsBaseChannel::Redirect gets hit, as expected.

I have no idea what you mean by &quot;same origin .url redirect&quot; and &quot;cross origin .url redirect&quot; in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Same origin policy bypass in local document/Universal xss"
   href="/show_bug.cgi?id=1278013#c27">comment 27</a>...

I guess I'll attach my testcase using a .desktop file, just in case that's useful.</pre><div class="activity"><div class="change">Flags: needinfo?(ckerschb)</div></div></div><div class="change-set" id="c29"><div class="comment" data-id="11492887" data-no="29"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-29" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_20209" id="a515444_280903"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_20209" id="a515444_280903"><a class="email " href="/user_profile?user_id=20209" > <span class="fna">Boris Zbarsky [:bzbarsky]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-29"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-29" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c29">Comment 29</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-21 09:42 PDT" data-time="1466527348">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-29">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8763946"
         class="attachment"
         data-id="8763946" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="test.zip">
      <meta itemprop="contentSize" content="685">
      <meta itemprop="encodingFormat" content="application/x-zip">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=8763946" itemprop="contentUrl">
        <span id="att-8763946-description" itemprop="description">Testcase that you can just unzip and run on Mac</span></a>
        — <a href="attachment.cgi?id=8763946&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-29" data-comment-id="11492887">Clicking the first link in that testcase _will_ trigger nsBaseChannel::Redirect for you on Mac.  It really will.</pre></div><div class="change-set" id="c30"><div class="comment" data-id="11494829" data-no="30"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-30" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a515444_280903"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a515444_280903"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-30"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-30" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c30">Comment 30</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-22 05:06 PDT" data-time="1466597217">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-30">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-30" data-comment-id="11494829">(In reply to Boris Zbarsky [:bz] (Out June 25-July 6) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Same origin policy bypass in local document/Universal xss"
   href="/show_bug.cgi?id=1278013#c29">comment #29</a>)
<span class="quote">&gt; Clicking the first link in that testcase _will_ trigger
&gt; nsBaseChannel::Redirect for you on Mac.  It really will.</span >

Thanks for the clarification - hitting nsBaseChannel::Redirect now.

(In reply to Boris Zbarsky [:bz] (Out June 25-July 6) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Same origin policy bypass in local document/Universal xss"
   href="/show_bug.cgi?id=1278013#c10">comment #10</a>)
<span class="quote">&gt; then the obvious thing here is to not propagate the
&gt; &quot;inherit the principal&quot; flag across this redirect.</span >

What 'inherit the principal' flag are you referring to exactly? As far as I can tell this is a TYPE_DOCUMENT load (see info underneath) for which we don't pass any 'securityMode' other than SEC_NORMAL which shouldn't influence principal inheritance, right?

(Please note that for TYPE_DOCUMENT loads we are not passing a loadingPrincipal, only a TriggeringPrincipal).

NewChannelFromURIWithProxyFlagsInternal {
  channelURI: file:///Users/ckerschb/Desktop/sop_bug/bypass_boris/redir.desktop
  triggeringPrincipal: file:///Users/ckerschb/Desktop/sop_bug/bypass_boris/PoC.html
  contentPolicyType: 6
  securityMode: 
  initalSecurityChecksDone: no
  enforceSecurity: no
}

NewChannelFromURIWithProxyFlagsInternal {
  channelURI: file:///private/etc/hosts
  loadingPrincipal: SystemPrincipal
  triggeringPrincipal: SystemPrincipal
  contentPolicyType: 1
  securityMode: SEC_ALLOW_CROSS_ORIGIN_DATA_IS_NULL, 
  initalSecurityChecksDone: no
  enforceSecurity: no
}

nsBaseChannel::Redirect {
  channelURI: file:///private/etc/hosts
  finalURI  : file:///private/etc/hosts
  triggeringPrincipal: file:///Users/ckerschb/Desktop/sop_bug/bypass_boris/PoC.html
  contentPolicyType: 6
  securityMode: 
Assertion failure: false, at /Users/ckerschb/Documents/moz/mc/netwerk/base/nsBaseChannel.cpp:160
#01: nsBaseChannel::Redirect(nsIChannel*, unsigned int, bool)[/Users/ckerschb/Documents/moz/mc-obj-ff-dbg/dist/NightlyDebug.app/Contents/MacOS/XUL +0x30634c]
#02: nsBaseChannel::HandleAsyncRedirect(nsIChannel*)[/Users/ckerschb/Documents/moz/mc-obj-ff-dbg/dist/NightlyDebug.app/Contents/MacOS/XUL +0x306e1c]
#03: nsBaseChannel::RedirectRunnable::Run()[/Users/ckerschb/Documents/moz/mc-obj-ff-dbg/dist/NightlyDebug.app/Contents/MacOS/XUL +0x31f520]</pre><div class="activity"><div class="change">Flags: needinfo?(ckerschb) &rarr; needinfo?(bzbarsky)</div></div></div><div class="change-set" id="c31"><div class="comment" data-id="11495188" data-no="31"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-31" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_20209" id="a515444_280903"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_20209" id="a515444_280903"><a class="email " href="/user_profile?user_id=20209" > <span class="fna">Boris Zbarsky [:bzbarsky]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-31"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-31" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c31">Comment 31</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-22 07:33 PDT" data-time="1466606009">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-31">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-31" data-comment-id="11495188"><span class="quote">&gt; What 'inherit the principal' flag are you referring to exactly?</span >

The one set at <a rel="nofollow" href="https://dxr.mozilla.org/mozilla-central/rev/51377a64158941f89ed73f388ae437cfa494c030/docshell/base/nsDocShell.cpp#10759">https://dxr.mozilla.org/mozilla-central/rev/51377a64158941f89ed73f388ae437cfa494c030/docshell/base/nsDocShell.cpp#10759</a>

<span class="quote">&gt; for which we don't pass any 'securityMode' other than SEC_NORMAL</span >

Totally not true.  See link above, and also line 10762 in the same file: TYPE_DOCUMENT loads can be SEC_SANDBOXED as well.

I don't know what you're logging and in which process, just like I don't know why you were not seeing us reach the code that is totally obviously being reached, but I can assure you that a load of file:///Users/ckerschb/Desktop/sop_bug/bypass_boris/redir.desktop triggered by file:///Users/ckerschb/Desktop/sop_bug/bypass_boris/PoC.html will have SEC_FORCE_INHERIT_PRINCIPAL.  See <a rel="nofollow" href="https://dxr.mozilla.org/mozilla-central/rev/51377a64158941f89ed73f388ae437cfa494c030/dom/base/nsContentUtils.cpp#6593">https://dxr.mozilla.org/mozilla-central/rev/51377a64158941f89ed73f388ae437cfa494c030/dom/base/nsContentUtils.cpp#6593</a> (which is passed the triggering principal for aLoadingPrincipal when docshell calls it at &lt;<a rel="nofollow" href="https://dxr.mozilla.org/mozilla-central/rev/51377a64158941f89ed73f388ae437cfa494c030/docshell/base/nsDocShell.cpp#10744">https://dxr.mozilla.org/mozilla-central/rev/51377a64158941f89ed73f388ae437cfa494c030/docshell/base/nsDocShell.cpp#10744</a>&gt;).</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(bzbarsky)</span></div></div></div><div class="change-set" id="c32"><div class="comment" data-id="11495217" data-no="32"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-32" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a515444_280903"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a515444_280903"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-32"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-32" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c32">Comment 32</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-22 07:44 PDT" data-time="1466606676">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-32">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-32" data-comment-id="11495217">(In reply to Boris Zbarsky [:bz] (Out June 25-July 6) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Same origin policy bypass in local document/Universal xss"
   href="/show_bug.cgi?id=1278013#c31">comment #31</a>)
<span class="quote">&gt; &gt; for which we don't pass any 'securityMode' other than SEC_NORMAL
&gt; 
&gt; Totally not true.  See link above, and also line 10762 in the same file:
&gt; TYPE_DOCUMENT loads can be SEC_SANDBOXED as well.</span >

Sorry for all the confusion - already banging my head at the keyboard - you are obviously right.

nsBaseChannel::Redirect {
  channelURI: file:///private/etc/hosts
  finalURI  : file:///private/etc/hosts
  triggeringPrincipal: file:///Users/ckerschb/Desktop/sop_bug/bypass_boris/PoC.html
  contentPolicyType: 6
  securityMode: SEC_FORCE_INHERIT_PRINCIPAL
}</pre></div><div class="change-set" id="c33"><div class="comment" data-id="11495303" data-no="33"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-33" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a515444_280903"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a515444_280903"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-33"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-33" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c33">Comment 33</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-22 08:20 PDT" data-time="1466608822">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-33">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8764290"
         class="attachment patch"
         data-id="8764290" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug_1278013_remove_force_inherit_flag_in_basechannel_redirect.patch">
      <meta itemprop="contentSize" content="3540">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8764290">
          <a class="link" href="attachment.cgi?id=8764290&amp;action=diff">
        <span id="att-8764290-description" itemprop="description">bug_1278013_remove_force_inherit_flag_in_basechannel_redirect.patch</span></a>
        — <a href="attachment.cgi?id=8764290&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1278013&attachment=8764290">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-33" data-comment-id="11495303">Boris, thanks for your help with setting up the test environment to reproduce the problem! It works now as expected and we are blocking the contents of the secret file to appear in the textarea; displaying the following error in the browser console:
<span class="quote">&gt; Error: Permission denied to access property &quot;document&quot;</span ></pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8764290&amp;action=edit"
           title="bug_1278013_remove_force_inherit_flag_in_basechannel_redirect.patch"
           class=""
        >Attachment #8764290</a> -
        Flags: review?(bzbarsky)</div></div></div><div class="change-set" id="c34"><div class="comment" data-id="11495385" data-no="34"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-34" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_20209" id="a515444_280903"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_20209" id="a515444_280903"><a class="email " href="/user_profile?user_id=20209" > <span class="fna">Boris Zbarsky [:bzbarsky]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-34"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-34" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c34">Comment 34</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-22 08:52 PDT" data-time="1466610777">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-34">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-34" data-comment-id="11495385">Comment on <span class=""><a href="/attachment.cgi?id=8764290" name="attach_8764290" title="bug_1278013_remove_force_inherit_flag_in_basechannel_redirect.patch">attachment 8764290</a> <a href="/attachment.cgi?id=8764290&amp;action=edit" title="bug_1278013_remove_force_inherit_flag_in_basechannel_redirect.patch">[details]</a> <a href="/attachment.cgi?id=8764290&amp;action=diff" title="bug_1278013_remove_force_inherit_flag_in_basechannel_redirect.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1278013&amp;attachment=8764290'>[review]</a>
bug_1278013_remove_force_inherit_flag_in_basechannel_redirect.patch

r=me</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8764290&amp;action=edit"
           title="bug_1278013_remove_force_inherit_flag_in_basechannel_redirect.patch"
           class=""
        >Attachment #8764290</a> -
        Flags: review?(bzbarsky) &rarr; review+</div></div></div><div class="change-set" id="c35"><div class="comment" data-id="11495800" data-no="35"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-35" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a515444_280903"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a515444_280903"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-35"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-35" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c35">Comment 35</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-22 11:19 PDT" data-time="1466619574">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-35">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-35" data-comment-id="11495800">(In reply to Abdulrahman Alqabandi from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Same origin policy bypass in local document/Universal xss"
   href="/show_bug.cgi?id=1278013#c21">comment #21</a>)
<span class="quote">&gt; Thinking more about the attack scenario, I think the fact that a victim
&gt; would need to download a zip file then unzip and finally execute the
&gt; malicious html file locally could be shortened greatly.
&gt; 
&gt; So after some more testing I think the best attack scenario would be to have
&gt; the user save the page from an attacker controlled website locally and
&gt; simply open the index.html file from the downloads page, we can also trick
&gt; the browser to download and save a .URL file using the (I think by default)
&gt; option of saving a web page complete.</span >

Dan, given that the page must be downloaded before the attack can be executed makes me think that this is at most a sec moderate, but I would like to get your rating before moving forward with this bug. What do you think?</pre><div class="activity"><div class="change">Flags: needinfo?(dveditz)</div></div></div><div class="change-set" id="c36"><div class="comment" data-id="11499876" data-no="36"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-36" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a515444_280903"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a515444_280903"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-36"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-36" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c36">Comment 36</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-23 21:28 PDT" data-time="1466742526">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-36">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-36" data-comment-id="11499876">sec-moderate seems appropriate, but that doesn't mean this is unimportant.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(dveditz)</span></div><div class="change">Keywords: <a href="/buglist.cgi?keywords=csectype-sop&amp;resolution=---">csectype-sop</a>, 
          
            <a href="/buglist.cgi?keywords=sec-moderate&amp;resolution=---">sec-moderate</a></div></div></div><div class="change-set" id="a1748870_363267"><div class="change" id="aa1748870_363267">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a1748870_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_363267" id="a1748870_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1748870_363267"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1748870_363267">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#a1748870_363267">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-23 23:54 PDT" data-time="1466751260">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Keywords: <a href="/buglist.cgi?keywords=checkin-needed&amp;resolution=---">checkin-needed</a></div></div></div><div class="change-set" id="c37"><div class="comment" data-id="11500011" data-no="37"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-37" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a1748870_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a1748870_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-37"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-37" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c37">Comment 37</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-23 23:58 PDT" data-time="1466751490">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-37">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-37" data-comment-id="11500011">Comment on <span class=""><a href="/attachment.cgi?id=8764290" name="attach_8764290" title="bug_1278013_remove_force_inherit_flag_in_basechannel_redirect.patch">attachment 8764290</a> <a href="/attachment.cgi?id=8764290&amp;action=edit" title="bug_1278013_remove_force_inherit_flag_in_basechannel_redirect.patch">[details]</a> <a href="/attachment.cgi?id=8764290&amp;action=diff" title="bug_1278013_remove_force_inherit_flag_in_basechannel_redirect.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1278013&amp;attachment=8764290'>[review]</a>
bug_1278013_remove_force_inherit_flag_in_basechannel_redirect.patch

Approval Request Comment
Users which can be tricked into downloading a webpage and open it locally are vulnerable to that attack which bypasses the Same origin policy.

[Feature/regressing bug #]:
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Attach LoadInfo to remaining callers of ioService and ProtocolHandlers"
   href="/show_bug.cgi?id=1099296">Bug 1099296</a>

[User impact if declined]:
SOP bypass.

[Describe test coverage new/current, TreeHerder]:
Tested manually using the crafted page from the reporter, Boris and myself.

[Risks and why]: 
Low, since it does not affect http redirects, but only redirects passing through nsBaseChannel::Redirect().

[String/UUID change made/needed]:
no</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8764290&amp;action=edit"
           title="bug_1278013_remove_force_inherit_flag_in_basechannel_redirect.patch"
           class=""
        >Attachment #8764290</a> -
        Flags: approval-mozilla-beta?</div><div class="change">
        <a href="/attachment.cgi?id=8764290&amp;action=edit"
           title="bug_1278013_remove_force_inherit_flag_in_basechannel_redirect.patch"
           class=""
        >Attachment #8764290</a> -
        Flags: approval-mozilla-aurora?</div></div></div><div class="change-set" id="c38"><div class="comment" data-id="11500013" data-no="38"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-38" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_277293" id="a1748870_363267"><img src="https://secure.gravatar.com/avatar/8378311bf1bd5e9eddc7896a07688876?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_277293" id="a1748870_363267"><a class="email disabled" href="/user_profile?user_id=277293" > <span class="fna">Carsten Book [:Tomcat]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-38"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-38" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c38">Comment 38</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-23 23:58 PDT" data-time="1466751528">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-38">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-38" data-comment-id="11500013"> <a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/6fcf253b6712">https://hg.mozilla.org/integration/mozilla-inbound/rev/6fcf253b6712</a></pre><div class="activity"><div class="change">Keywords: <span class="activity-deleted"><a href="/buglist.cgi?keywords=checkin-needed&amp;resolution=---">checkin-needed</a></span></div></div></div><div class="change-set" id="a1757242_363267"><div class="change" id="aa1757242_363267">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a1757242_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_363267" id="a1757242_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1757242_363267"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1757242_363267">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#a1757242_363267">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-24 02:13 PDT" data-time="1466759632">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Assignee: nobody &rarr; ckerschb</div><div class="change">Status: NEW &rarr; ASSIGNED</div></div></div><div class="change-set" id="c39"><div class="comment" data-id="11501511" data-no="39"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-39" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_308534" id="a1757242_363267"><img src="https://secure.gravatar.com/avatar/bb55b2a8c34fd29f570ca139f13d46b8?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_308534" id="a1757242_363267"><a class="email " href="/user_profile?user_id=308534" > <span class="fna">Wes Kocher (:KWierso) (Not reading bugmail; email directly if needed)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-39"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-39" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c39">Comment 39</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-24 13:39 PDT" data-time="1466800797">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-39">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-39" data-comment-id="11501511"><a rel="nofollow" href="https://hg.mozilla.org/mozilla-central/rev/6fcf253b6712">https://hg.mozilla.org/mozilla-central/rev/6fcf253b6712</a></pre><div class="activity"><div class="change">Status: ASSIGNED &rarr; RESOLVED</div><div class="change">Closed: <span class="rel-time" title="2016-06-24 13:39 PDT" data-time="1466800797">5 years ago</span></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox50&amp;o1=isnotempty">status-firefox50</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox50&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">Resolution: --- &rarr; FIXED</div><div class="change">Target Milestone: --- &rarr; mozilla50</div></div></div><div class="change-set ca-550582" id="c40"><div class="comment" data-id="11501860" data-no="40"
       data-tags="off-topic">
    
    <table class="layout-table change-head reporter" id="ch-40" style="display:none" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550582" id="a1757242_363267"><img src="https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550582" id="a1757242_363267"><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-40"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-40" style="display:none">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c40">Comment 40</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-24 19:55 PDT" data-time="1466823338">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-40">
        <td colspan="2" class="comment-tags"><span class="comment-tag">off-topic</span>
        </td>
      </tr>
    </table>

    
      <table class="layout-table change-head default-collapsed" id="cc-40"
             role="presentation">
      <tr>
        <td class="comment-collapse-reason"
            title="qab [5 years ago]">
            Comment hidden (off-topic)
        </td>
        <td class="comment-actions">
          <button type="button" class="change-spinner minor iconic" id="ccs-40"
                  aria-label="Expand"
                  aria-expanded="false"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </td>
      </tr>
      </table>
  </div><pre
        class="comment-text  "
        id="ct-40" data-comment-id="11501860" style="display:none">Does requiring the user to save page as really make this sec-moderate? 

I had a previous bug (<a class="bz_bug_link
          bz_status_NEW"
   title="NEW"
   href="/show_bug.cgi?id=1233936">https://bugzilla.mozilla.org/show_bug.cgi?id=1233936</a>) which also required an html file to be downloaded and opened but it only resulted in detecting arbitrary files locally.

The bug here is a full SOP bypass with a fully accessible external window object available (including file: files/folders)

I just dont feel these two bugs are equivalent :/

On the official Mozilla security rating guide, under sec-moderate it does say &quot;Client bugs that might have high or critical results but require the user perform unusual or complex actions to trigger.&quot;

But I dont think having the user hit ctrl+s and opening a file locally is 'unusual or complex'

Would you agree and possibly reconsider the rating Daniel?</pre><div class="activity" style="display:none"><div class="change">Flags: needinfo?(dveditz)</div></div></div><div class="change-set ca-550582" id="c41"><div class="comment" data-id="11501863" data-no="41"
       data-tags="off-topic">
    
    <table class="layout-table change-head reporter" id="ch-41" style="display:none" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550582" id="a1757242_363267"><img src="https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550582" id="a1757242_363267"><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-41"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-41" style="display:none">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c41">Comment 41</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-24 20:06 PDT" data-time="1466823996">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-41">
        <td colspan="2" class="comment-tags"><span class="comment-tag">off-topic</span>
        </td>
      </tr>
    </table>

    
      <table class="layout-table change-head default-collapsed" id="cc-41"
             role="presentation">
      <tr>
        <td class="comment-collapse-reason"
            title="qab [5 years ago]">
            Comment hidden (off-topic)
        </td>
        <td class="comment-actions">
          <button type="button" class="change-spinner minor iconic" id="ccs-41"
                  aria-label="Expand"
                  aria-expanded="false"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </td>
      </tr>
      </table>
  </div><pre
        class="comment-text  "
        id="ct-41" data-comment-id="11501863" style="display:none">Also, to further add to my argument,

There was a bug that enabled the reading of external domains as well as files (same as here) but this was done without user interactions (presumably) which was given sec-critical (from the usual sec-high for SOP bypasses) 

I can do the same except from local documents so logically it should follow that this gets a sec-high bounty  (since it does require some user interaction)

ref: <a rel="nofollow" href="https://www.mozilla.org/en-US/security/advisories/mfsa2015-149/">https://www.mozilla.org/en-US/security/advisories/mfsa2015-149/</a></pre></div><div class="change-set" id="a2028762_495955"><div class="change" id="aa2028762_495955">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_495955" id="a2028762_495955"><img src="https://secure.gravatar.com/avatar/5aa2e382197a147b42d020b6878f8623?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_495955" id="a2028762_495955"><a class="email " href="/user_profile?user_id=495955" > <span class="fna">Sylvestre Ledru [:Sylvestre]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a2028762_495955"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a2028762_495955">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#a2028762_495955">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-27 05:39 PDT" data-time="1467031152">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox46&amp;o1=isnotempty">status-firefox46</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox46&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox46&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox47&amp;o1=isnotempty">status-firefox47</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox47&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox47&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr38&amp;o1=isnotempty">status-firefox-esr38</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox_esr38&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr38&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=isnotempty">status-firefox-esr45</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=equals&amp;v1=affected">affected</a></div></div></div><div class="change-set" id="c42"><div class="comment" data-id="11504083" data-no="42"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-42" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_495955" id="a2028762_495955"><img src="https://secure.gravatar.com/avatar/5aa2e382197a147b42d020b6878f8623?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_495955" id="a2028762_495955"><a class="email " href="/user_profile?user_id=495955" > <span class="fna">Sylvestre Ledru [:Sylvestre]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-42"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-42" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c42">Comment 42</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-27 05:40 PDT" data-time="1467031254">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-42">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-42" data-comment-id="11504083">Comment on <span class=""><a href="/attachment.cgi?id=8764290" name="attach_8764290" title="bug_1278013_remove_force_inherit_flag_in_basechannel_redirect.patch">attachment 8764290</a> <a href="/attachment.cgi?id=8764290&amp;action=edit" title="bug_1278013_remove_force_inherit_flag_in_basechannel_redirect.patch">[details]</a> <a href="/attachment.cgi?id=8764290&amp;action=diff" title="bug_1278013_remove_force_inherit_flag_in_basechannel_redirect.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1278013&amp;attachment=8764290'>[review]</a>
bug_1278013_remove_force_inherit_flag_in_basechannel_redirect.patch

Already landed in nightly, so, we want this in aurora &amp; beta too.
For now, it doesn't match the esr criteria but if the severity increases, we should take it in esr45 too.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8764290&amp;action=edit"
           title="bug_1278013_remove_force_inherit_flag_in_basechannel_redirect.patch"
           class=""
        >Attachment #8764290</a> -
        Flags: <span class="activity-deleted">approval-mozilla-beta?</span></div><div class="change">
        <a href="/attachment.cgi?id=8764290&amp;action=edit"
           title="bug_1278013_remove_force_inherit_flag_in_basechannel_redirect.patch"
           class=""
        >Attachment #8764290</a> -
        Flags: approval-mozilla-beta+</div><div class="change">
        <a href="/attachment.cgi?id=8764290&amp;action=edit"
           title="bug_1278013_remove_force_inherit_flag_in_basechannel_redirect.patch"
           class=""
        >Attachment #8764290</a> -
        Flags: <span class="activity-deleted">approval-mozilla-aurora?</span></div><div class="change">
        <a href="/attachment.cgi?id=8764290&amp;action=edit"
           title="bug_1278013_remove_force_inherit_flag_in_basechannel_redirect.patch"
           class=""
        >Attachment #8764290</a> -
        Flags: approval-mozilla-aurora+</div></div></div><div class="change-set" id="c43"><div class="comment" data-id="11504119" data-no="43"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-43" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_277293" id="a2028762_495955"><img src="https://secure.gravatar.com/avatar/8378311bf1bd5e9eddc7896a07688876?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_277293" id="a2028762_495955"><a class="email disabled" href="/user_profile?user_id=277293" > <span class="fna">Carsten Book [:Tomcat]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-43"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-43" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c43">Comment 43</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-27 06:01 PDT" data-time="1467032481">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-43">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-43" data-comment-id="11504119"><a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-aurora/rev/15cc9baf2b6f">https://hg.mozilla.org/releases/mozilla-aurora/rev/15cc9baf2b6f</a></pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox49&amp;o1=isnotempty">status-firefox49</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox49&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox49&amp;o1=equals&amp;v1=fixed">fixed</a></div></div></div><div class="change-set" id="c44"><div class="comment" data-id="11504132" data-no="44"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-44" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_277293" id="a2028762_495955"><img src="https://secure.gravatar.com/avatar/8378311bf1bd5e9eddc7896a07688876?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_277293" id="a2028762_495955"><a class="email disabled" href="/user_profile?user_id=277293" > <span class="fna">Carsten Book [:Tomcat]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-44"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-44" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c44">Comment 44</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-27 06:07 PDT" data-time="1467032828">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-44">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-44" data-comment-id="11504132"> <a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-beta/rev/b7f4630c2e64">https://hg.mozilla.org/releases/mozilla-beta/rev/b7f4630c2e64</a></pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox48&amp;o1=isnotempty">status-firefox48</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox48&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox48&amp;o1=equals&amp;v1=fixed">fixed</a></div></div></div><div class="change-set" id="a2065747_1689"><div class="change" id="aa2065747_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a2065747_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a2065747_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a2065747_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a2065747_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#a2065747_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-27 15:55 PDT" data-time="1467068137">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: network-core-security &rarr; core-security-release</div></div></div><div class="change-set" id="c45"><div class="comment" data-id="11517719" data-no="45"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-45" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a2065747_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a2065747_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-45"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-45" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c45">Comment 45</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-01 10:41 PDT" data-time="1467394913">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-45">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-45" data-comment-id="11517719">(In reply to Abdulrahman Alqabandi[test] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Same origin policy bypass in local document/Universal xss"
   href="/show_bug.cgi?id=1278013#c40">comment #40</a>)
<span class="quote">&gt; On the official Mozilla security rating guide, under sec-moderate it does
&gt; say &quot;Client bugs that might have high or critical results but require the
&gt; user perform unusual or complex actions to trigger.&quot;
&gt; 
&gt; But I dont think having the user hit ctrl+s and opening a file locally is
&gt; 'unusual or complex'</span >

high and critical are for bugs that can be used for &quot;drive-by&quot; attacks on users, perhaps requiring them to click on something but that's extremely common on a web page (e.g. the web is made of links). Yes, users do save some pages and then open them later, but to create a successful attack out of this the attacker has to create a page that lots of users will want to save and re-open. I'm sure it can be done for a handful of victims making this a security bug and worth fixing, but not mass pwnage that rates a sec-high.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">sec-bounty?</span></div><div class="change">Flags: sec-bounty+</div><div class="change">Flags: <span class="activity-deleted">needinfo?(dveditz)</span></div></div></div><div class="change-set" id="c46"><div class="comment" data-id="11518240" data-no="46"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-46" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550582" id="a2065747_1689"><img src="https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550582" id="a2065747_1689"><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-46"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-46" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c46">Comment 46</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-01 13:58 PDT" data-time="1467406733">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-46">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-46" data-comment-id="11518240">(In reply to Daniel Veditz [:dveditz] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Same origin policy bypass in local document/Universal xss"
   href="/show_bug.cgi?id=1278013#c45">comment #45</a>)
<span class="quote">&gt; (In reply to Abdulrahman Alqabandi[test] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Same origin policy bypass in local document/Universal xss"
   href="/show_bug.cgi?id=1278013#c40">comment #40</a>)
&gt; &gt; On the official Mozilla security rating guide, under sec-moderate it does
&gt; &gt; say &quot;Client bugs that might have high or critical results but require the
&gt; &gt; user perform unusual or complex actions to trigger.&quot;
&gt; &gt; 
&gt; &gt; But I dont think having the user hit ctrl+s and opening a file locally is
&gt; &gt; 'unusual or complex'
&gt; 
&gt; high and critical are for bugs that can be used for &quot;drive-by&quot; attacks on
&gt; users, perhaps requiring them to click on something but that's extremely
&gt; common on a web page (e.g. the web is made of links). Yes, users do save
&gt; some pages and then open them later, but to create a successful attack out
&gt; of this the attacker has to create a page that lots of users will want to
&gt; save and re-open. I'm sure it can be done for a handful of victims making
&gt; this a security bug and worth fixing, but not mass pwnage that rates a
&gt; sec-high.</span >

Fair enough. Thank you for the bounty!</pre></div><div class="change-set" id="c47"><div class="comment" data-id="11564153" data-no="47"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-47" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a2065747_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a2065747_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-47"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-47" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c47">Comment 47</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-20 21:59 PDT" data-time="1469077142">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-47">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-47" data-comment-id="11564153">Christoph: I believe the ESR-45 branch contains the security flags changes this builds one. Any reason this patch wouldn't work on that branch?

[Tracking Requested - why for this release]:
Although we only promise sec-high/sec-critical support on ESR, because this vulnerability is easily explained and duplicated we should take this one. The patch in this bug is small and safe if the requisite support already exists on that branch (it looks like the underlying required change landed in Firefox 42).</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr45&amp;o1=isnotempty">tracking-firefox-esr45</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox_esr45&amp;o1=equals&amp;v1=%3F">?</a></div><div class="change">Flags: needinfo?(ckerschb)</div></div></div><div class="change-set" id="c48"><div class="comment" data-id="11564306" data-no="48"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-48" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a2065747_1689"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a2065747_1689"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-48"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-48" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c48">Comment 48</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-20 23:52 PDT" data-time="1469083944">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-48">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-48" data-comment-id="11564306">(In reply to Daniel Veditz [:dveditz] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Same origin policy bypass in local document/Universal xss"
   href="/show_bug.cgi?id=1278013#c47">comment #47</a>)
<span class="quote">&gt; Christoph: I believe the ESR-45 branch contains the security flags changes
&gt; this builds one. Any reason this patch wouldn't work on that branch?</span >

I don't fully understand what that sentence means. But let me explain: The problem was introduced within <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Attach LoadInfo to remaining callers of ioService and ProtocolHandlers"
   href="/show_bug.cgi?id=1099296">Bug 1099296</a>, which landed in Firefox 38. The patch within this bug should apply (more or less) cleanly to any branch that builds on Firefox 38 or later.

If you are talking about the SEC_FORCE_INHERIT_PRINCIPAL security flag, that was introduced within Firefox 35 [1].

To sum it up, that patch should apply and work fine on ESR-45.

[1] <a rel="nofollow" href="https://hg.mozilla.org/mozilla-central/rev/d0f7f15e15fb#l3.47">https://hg.mozilla.org/mozilla-central/rev/d0f7f15e15fb#l3.47</a></pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(ckerschb)</span></div></div></div><div class="change-set" id="c49"><div class="comment" data-id="11564320" data-no="49"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-49" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_495955" id="a2065747_1689"><img src="https://secure.gravatar.com/avatar/5aa2e382197a147b42d020b6878f8623?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_495955" id="a2065747_1689"><a class="email " href="/user_profile?user_id=495955" > <span class="fna">Sylvestre Ledru [:Sylvestre]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-49"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-49" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c49">Comment 49</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-20 23:57 PDT" data-time="1469084230">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-49">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-49" data-comment-id="11564320">Comment on <span class=""><a href="/attachment.cgi?id=8764290" name="attach_8764290" title="bug_1278013_remove_force_inherit_flag_in_basechannel_redirect.patch">attachment 8764290</a> <a href="/attachment.cgi?id=8764290&amp;action=edit" title="bug_1278013_remove_force_inherit_flag_in_basechannel_redirect.patch">[details]</a> <a href="/attachment.cgi?id=8764290&amp;action=diff" title="bug_1278013_remove_force_inherit_flag_in_basechannel_redirect.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1278013&amp;attachment=8764290'>[review]</a>
bug_1278013_remove_force_inherit_flag_in_basechannel_redirect.patch

ok, let's take it to esr 45 too.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8764290&amp;action=edit"
           title="bug_1278013_remove_force_inherit_flag_in_basechannel_redirect.patch"
           class=""
        >Attachment #8764290</a> -
        Flags: approval-mozilla-esr45+</div></div></div><div class="change-set" id="c50"><div class="comment" data-id="11564321" data-no="50"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-50" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_495955" id="a2065747_1689"><img src="https://secure.gravatar.com/avatar/5aa2e382197a147b42d020b6878f8623?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_495955" id="a2065747_1689"><a class="email " href="/user_profile?user_id=495955" > <span class="fna">Sylvestre Ledru [:Sylvestre]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-50"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-50" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c50">Comment 50</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-20 23:57 PDT" data-time="1469084266">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-50">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-50" data-comment-id="11564321">Looks quite safe and potentially high impact in term of security.</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr45&amp;o1=isnotempty">tracking-firefox-esr45</a>:
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr45&amp;o1=equals&amp;v1=%3F">?</a> &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox_esr45&amp;o1=equals&amp;v1=48%2B">48+</a></div></div></div><div class="change-set" id="c51"><div class="comment" data-id="11565577" data-no="51"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-51" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_452604" id="a2065747_1689"><img src="https://secure.gravatar.com/avatar/7bb698c4991c5af83adabe3c3b8ee8aa?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_452604" id="a2065747_1689"><a class="email disabled" href="/user_profile?user_id=452604" > <span class="fna">Matt Wobensmith [:mwobensmith][:matt:]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-51"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-51" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c51">Comment 51</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-21 08:52 PDT" data-time="1469116351">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-51">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-51" data-comment-id="11565577">Hi Abdulrahman, can you verify that this is fixed on your end?</pre><div class="activity"><div class="change">Flags: needinfo?(qab)</div></div></div><div class="change-set" id="c52"><div class="comment" data-id="11568052" data-no="52"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-52" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_277293" id="a2065747_1689"><img src="https://secure.gravatar.com/avatar/8378311bf1bd5e9eddc7896a07688876?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_277293" id="a2065747_1689"><a class="email disabled" href="/user_profile?user_id=277293" > <span class="fna">Carsten Book [:Tomcat]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-52"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-52" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c52">Comment 52</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-22 03:31 PDT" data-time="1469183473">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-52">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-52" data-comment-id="11568052"><a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-esr45/rev/3e8a4fa8cb04">https://hg.mozilla.org/releases/mozilla-esr45/rev/3e8a4fa8cb04</a></pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=isnotempty">status-firefox-esr45</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=equals&amp;v1=fixed">fixed</a></div></div></div><div class="change-set" id="a4490048_280903"><div class="change" id="aa4490048_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a4490048_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a4490048_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a4490048_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a4490048_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#a4490048_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-25 17:20 PDT" data-time="1469492438">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Alias: CVE-2016-5265</div><div class="change">Whiteboard: [adv-main48+][adv-esr45.3+]</div></div></div><div class="change-set" id="c53"><div class="comment" data-id="11586665" data-no="53"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-53" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550582" id="a4490048_280903"><img src="https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550582" id="a4490048_280903"><a class="email " href="/user_profile?user_id=550582" > <span class="fna">Abdulrahman Alqabandi</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-53"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-53" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c53">Comment 53</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-29 17:11 PDT" data-time="1469837469">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-53">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-53" data-comment-id="11586665">Yupp, looks like its fixed from my side.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(qab)</span></div></div></div><div class="change-set" id="c54"><div class="comment" data-id="11670673" data-no="54"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-54" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_20209" id="a4490048_280903"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_20209" id="a4490048_280903"><a class="email " href="/user_profile?user_id=20209" > <span class="fna">Boris Zbarsky [:bzbarsky]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-54"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-54" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#c54">Comment 54</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-08-31 10:50 PDT" data-time="1472665833">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-54">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-54" data-comment-id="11670673">The patch using &quot;^&quot; to &quot;remove&quot; a flag is likely causing <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox V48.0 UXSS &amp; Address Bar Spoofing"
   href="/show_bug.cgi?id=1292159">bug 1292159</a>...  :(  I can't believe I missed that.</pre><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox V48.0 UXSS &amp; Address Bar Spoofing"
   href="/show_bug.cgi?id=1292159">CVE-2016-5291</a></div></div></div><div class="change-set" id="a9587919_1689"><div class="change" id="aa9587919_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a9587919_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a9587919_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a9587919_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a9587919_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1278013#a9587919_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-22 17:25 PDT" data-time="1474590309">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: <span class="activity-deleted">core-security-release</span></div></div></div><div id="new-comment-notice">
          You need to <a href="/show_bug.cgi?id=1278013&amp;GoAheadAndLogIn=1">log in</a>
          before you can comment on or make changes to this bug.
        </div>



<div id="bottom-actions">
  <div id="bottom-right-actions">
    <button type="button" id="top-btn" class="secondary" aria-label="Go to Page Top">Top &uarr;</button>
  </div>
</div></div> 
</main> 
</div> 


</body>
</html>