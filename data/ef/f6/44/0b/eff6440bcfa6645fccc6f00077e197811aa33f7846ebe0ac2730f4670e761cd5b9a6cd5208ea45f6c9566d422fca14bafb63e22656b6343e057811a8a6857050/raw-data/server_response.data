<!DOCTYPE html>

<html class="no-js" lang="en-US">

	<head profile="http://gmpg.org/xfn/11">
		
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		 
		<meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1'/>
<script>document.documentElement.className=document.documentElement.className.replace("no-js","js");</script>

	<!-- This site is optimized with the Yoast SEO plugin v16.8 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Remote Code Execution in the Avatars - Dodd Security</title>
	<link rel="canonical" href="https://doddsecurity.com/94/remote-code-execution-in-the-avatars/"/>
	<meta property="og:locale" content="en_US"/>
	<meta property="og:type" content="article"/>
	<meta property="og:title" content="Remote Code Execution in the Avatars - Dodd Security"/>
	<meta property="og:description" content="Name:&nbsp;PHP Login &amp; User Management Vendor: Jigowatt via the Envato Market Place Vulnerability: Arbitrary File Upload Affected Versions: All versions before 4.1.1 CVE ID:&nbsp;CVE-2018-11392 It goes without saying, but all user-input should not be trusted. This includes images, text, and any other binaries that are supplied by users. This post will cover an arbitrary file [&hellip;]"/>
	<meta property="og:url" content="https://doddsecurity.com/94/remote-code-execution-in-the-avatars/"/>
	<meta property="og:site_name" content="Dodd Security"/>
	<meta property="article:published_time" content="2018-12-08T07:34:53+00:00"/>
	<meta property="article:modified_time" content="2018-12-13T06:59:47+00:00"/>
	<meta property="og:image" content="https://doddsecurity.com/wp-content/uploads/2018/12/doddsecurity-post2.png"/>
	<meta property="og:image:width" content="1200"/>
	<meta property="og:image:height" content="628"/>
	<meta name="twitter:card" content="summary_large_image"/>
	<meta name="twitter:label1" content="Written by"/>
	<meta name="twitter:data1" content="Reginald Dodd"/>
	<meta name="twitter:label2" content="Est. reading time"/>
	<meta name="twitter:data2" content="3 minutes"/>
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebSite","@id":"https://doddsecurity.com/#website","url":"https://doddsecurity.com/","name":"Dodd Security","description":"Offensive Security and Application Security Perspectives","publisher":{"@id":"https://doddsecurity.com/#/schema/person/d96c134db33b54058ef43854126d6165"},"potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://doddsecurity.com/?s={search_term_string}"},"query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","@id":"https://doddsecurity.com/94/remote-code-execution-in-the-avatars/#primaryimage","inLanguage":"en-US","url":"https://doddsecurity.com/wp-content/uploads/2018/12/doddsecurity-post2.png","contentUrl":"https://doddsecurity.com/wp-content/uploads/2018/12/doddsecurity-post2.png","width":1200,"height":628},{"@type":"WebPage","@id":"https://doddsecurity.com/94/remote-code-execution-in-the-avatars/#webpage","url":"https://doddsecurity.com/94/remote-code-execution-in-the-avatars/","name":"Remote Code Execution in the Avatars - Dodd Security","isPartOf":{"@id":"https://doddsecurity.com/#website"},"primaryImageOfPage":{"@id":"https://doddsecurity.com/94/remote-code-execution-in-the-avatars/#primaryimage"},"datePublished":"2018-12-08T07:34:53+00:00","dateModified":"2018-12-13T06:59:47+00:00","breadcrumb":{"@id":"https://doddsecurity.com/94/remote-code-execution-in-the-avatars/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://doddsecurity.com/94/remote-code-execution-in-the-avatars/"]}]},{"@type":"BreadcrumbList","@id":"https://doddsecurity.com/94/remote-code-execution-in-the-avatars/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://doddsecurity.com/"},{"@type":"ListItem","position":2,"name":"Remote Code Execution in the Avatars"}]},{"@type":"Article","@id":"https://doddsecurity.com/94/remote-code-execution-in-the-avatars/#article","isPartOf":{"@id":"https://doddsecurity.com/94/remote-code-execution-in-the-avatars/#webpage"},"author":{"@id":"https://doddsecurity.com/#/schema/person/d96c134db33b54058ef43854126d6165"},"headline":"Remote Code Execution in the Avatars","datePublished":"2018-12-08T07:34:53+00:00","dateModified":"2018-12-13T06:59:47+00:00","mainEntityOfPage":{"@id":"https://doddsecurity.com/94/remote-code-execution-in-the-avatars/#webpage"},"wordCount":512,"publisher":{"@id":"https://doddsecurity.com/#/schema/person/d96c134db33b54058ef43854126d6165"},"image":{"@id":"https://doddsecurity.com/94/remote-code-execution-in-the-avatars/#primaryimage"},"thumbnailUrl":"https://doddsecurity.com/wp-content/uploads/2018/12/doddsecurity-post2.png","keywords":["arbitrary file upload","cve","remote code execution","responsible disclosure"],"articleSection":["Vulnerability Research"],"inLanguage":"en-US"},{"@type":["Person","Organization"],"@id":"https://doddsecurity.com/#/schema/person/d96c134db33b54058ef43854126d6165","name":"Reginald Dodd","image":{"@type":"ImageObject","@id":"https://doddsecurity.com/#personlogo","inLanguage":"en-US","url":"https://secure.gravatar.com/avatar/3437b25bca2894ee732acfa46c82096e?s=96&d=mm&r=g","contentUrl":"https://secure.gravatar.com/avatar/3437b25bca2894ee732acfa46c82096e?s=96&d=mm&r=g","caption":"Reginald Dodd"},"logo":{"@id":"https://doddsecurity.com/#personlogo"},"description":"Reginald is an information security professional with experience that spans numerous industries. He has discovered unknown vulnerabilities in numerous products. He has earned a Master\u2019s degree in Information Security and Assurance, GIAC certifications, and Offensive Security certifications."}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel='dns-prefetch' href='//s.w.org'/>
<link rel="alternate" type="application/rss+xml" title="Dodd Security &raquo; Feed" href="https://doddsecurity.com/feed/"/>
<link rel="alternate" type="application/rss+xml" title="Dodd Security &raquo; Comments Feed" href="https://doddsecurity.com/comments/feed/"/>
		<!-- This site uses the Google Analytics by MonsterInsights plugin v8.1.0 - Using Analytics tracking - https://www.monsterinsights.com/ -->
							<script src="//www.googletagmanager.com/gtag/js?id=UA-54965703-3" type="text/javascript" data-cfasync="false" async></script>
			<script type="text/javascript" data-cfasync="false">var mi_version='8.1.0';var mi_track_user=true;var mi_no_track_reason='';var disableStrs=['ga-disable-UA-54965703-3',];function __gtagTrackerIsOptedOut(){for(var index=0;index<disableStrs.length;index++){if(document.cookie.indexOf(disableStrs[index]+'=true')>-1){return true;}}return false;}if(__gtagTrackerIsOptedOut()){for(var index=0;index<disableStrs.length;index++){window[disableStrs[index]]=true;}}function __gtagTrackerOptout(){for(var index=0;index<disableStrs.length;index++){document.cookie=disableStrs[index]+'=true; expires=Thu, 31 Dec 2099 23:59:59 UTC; path=/';window[disableStrs[index]]=true;}}if('undefined'===typeof gaOptout){function gaOptout(){__gtagTrackerOptout();}}window.dataLayer=window.dataLayer||[];window.MonsterInsightsDualTracker={helpers:{},trackers:{},};if(mi_track_user){function __gtagDataLayer(){dataLayer.push(arguments);}function __gtagTracker(type,name,parameters){if(type==='event'){parameters.send_to=monsterinsights_frontend.ua;__gtagDataLayer.apply(null,arguments);}else{__gtagDataLayer.apply(null,arguments);}}__gtagTracker('js',new Date());__gtagTracker('set',{'developer_id.dZGIzZG':true,});__gtagTracker('config','UA-54965703-3',{"forceSSL":"true"});window.gtag=__gtagTracker;(function(){var noopfn=function(){return null;};var newtracker=function(){return new Tracker();};var Tracker=function(){return null;};var p=Tracker.prototype;p.get=noopfn;p.set=noopfn;p.send=function(){var args=Array.prototype.slice.call(arguments);args.unshift('send');__gaTracker.apply(null,args);};var __gaTracker=function(){var len=arguments.length;if(len===0){return;}var f=arguments[len-1];if(typeof f!=='object'||f===null||typeof f.hitCallback!=='function'){if('send'===arguments[0]){var hitConverted,hitObject=false,action;if('event'===arguments[1]){if('undefined'!==typeof arguments[3]){hitObject={'eventAction':arguments[3],'eventCategory':arguments[2],'eventLabel':arguments[4],'value':arguments[5]?arguments[5]:1,}}}if('pageview'===arguments[1]){if('undefined'!==typeof arguments[2]){hitObject={'eventAction':'page_view','page_path':arguments[2],}}}if(typeof arguments[2]==='object'){hitObject=arguments[2];}if(typeof arguments[5]==='object'){Object.assign(hitObject,arguments[5]);}if('undefined'!==typeof arguments[1].hitType){hitObject=arguments[1];if('pageview'===hitObject.hitType){hitObject.eventAction='page_view';}}if(hitObject){action='timing'===arguments[1].hitType?'timing_complete':hitObject.eventAction;hitConverted=mapArgs(hitObject);__gtagTracker('event',action,hitConverted);}}return;}function mapArgs(args){var arg,hit={};var gaMap={'eventCategory':'event_category','eventAction':'event_action','eventLabel':'event_label','eventValue':'event_value','nonInteraction':'non_interaction','timingCategory':'event_category','timingVar':'name','timingValue':'value','timingLabel':'event_label','page':'page_path','location':'page_location','title':'page_title',};for(arg in args){if(!(!args.hasOwnProperty(arg)||!gaMap.hasOwnProperty(arg))){hit[gaMap[arg]]=args[arg];}else{hit[arg]=args[arg];}}return hit;}try{f.hitCallback();}catch(ex){}};__gaTracker.create=newtracker;__gaTracker.getByName=newtracker;__gaTracker.getAll=function(){return[];};__gaTracker.remove=noopfn;__gaTracker.loaded=true;window['__gaTracker']=__gaTracker;})();}else{console.log("");(function(){function __gtagTracker(){return null;}window['__gtagTracker']=__gtagTracker;window['gtag']=__gtagTracker;})();}</script>
				<!-- / Google Analytics by MonsterInsights -->
				<script type="text/javascript">window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/doddsecurity.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=28de890456b98cd115186dbe4d609003"}};!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([10084,65039,8205,55357,56613],[10084,65039,8203,55357,56613])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);</script>
		<style type="text/css">img.wp-smiley,img.emoji{display:inline!important;border:none!important;box-shadow:none!important;height:1em!important;width:1em!important;margin:0 .07em!important;vertical-align:-.1em!important;background:none!important;padding:0!important}</style>
	<link rel='stylesheet' id='wp-block-library-css' href='https://doddsecurity.com/wp-includes/css/dist/block-library/style.min.css?ver=28de890456b98cd115186dbe4d609003' type='text/css' media='all'/>
<link rel='stylesheet' id='simple-social-icons-font-css' href='https://doddsecurity.com/wp-content/plugins/simple-social-icons/css/style.css?ver=3.0.2' type='text/css' media='all'/>
<link rel='stylesheet' id='rowling_google_fonts-css' href='//fonts.googleapis.com/css?family=Lato%3A400%2C700%2C900%2C400italic%2C700italic%7CMerriweather%3A700%2C900%2C400italic&#038;ver=28de890456b98cd115186dbe4d609003' type='text/css' media='all'/>
<link rel='stylesheet' id='rowling_fontawesome-css' href='https://doddsecurity.com/wp-content/themes/rowling/assets/css/font-awesome.min.css?ver=5.13.0' type='text/css' media='all'/>
<link rel='stylesheet' id='rowling_style-css' href='https://doddsecurity.com/wp-content/themes/rowling/style.css?ver=2.0.2' type='text/css' media='all'/>
<script type='text/javascript' id='monsterinsights-frontend-script-js-extra'>//<![CDATA[
var monsterinsights_frontend={"js_events_tracking":"true","download_extensions":"doc,pdf,ppt,zip,xls,docx,pptx,xlsx","inbound_paths":"[]","home_url":"https:\/\/doddsecurity.com","hash_tracking":"false","ua":"UA-54965703-3","v4_id":""};
//]]></script>
<script type='text/javascript' src='https://doddsecurity.com/wp-content/plugins/google-analytics-for-wordpress/assets/js/frontend-gtag.min.js?ver=8.1.0' id='monsterinsights-frontend-script-js'></script>
<script type='text/javascript' src='https://doddsecurity.com/wp-includes/js/jquery/jquery.min.js?ver=3.6.0' id='jquery-core-js'></script>
<script type='text/javascript' src='https://doddsecurity.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2' id='jquery-migrate-js'></script>
<script type='text/javascript' src='https://doddsecurity.com/wp-content/themes/rowling/assets/js/flexslider.js?ver=1' id='rowling_flexslider-js'></script>
<script type='text/javascript' src='https://doddsecurity.com/wp-content/themes/rowling/assets/js/doubletaptogo.js?ver=1' id='rowling_doubletap-js'></script>
<script type='text/javascript' src='https://doddsecurity.com/wp-content/plugins/simple-social-icons/svgxuse.js?ver=1.1.21' id='svg-x-use-js'></script>
<link rel="https://api.w.org/" href="https://doddsecurity.com/wp-json/"/><link rel="alternate" type="application/json" href="https://doddsecurity.com/wp-json/wp/v2/posts/94"/><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://doddsecurity.com/xmlrpc.php?rsd"/>
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://doddsecurity.com/wp-includes/wlwmanifest.xml"/> 

<link rel='shortlink' href='https://doddsecurity.com/?p=94'/>
<link rel="alternate" type="application/json+oembed" href="https://doddsecurity.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fdoddsecurity.com%2F94%2Fremote-code-execution-in-the-avatars%2F"/>
<link rel="alternate" type="text/xml+oembed" href="https://doddsecurity.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fdoddsecurity.com%2F94%2Fremote-code-execution-in-the-avatars%2F&#038;format=xml"/>
		<style type="text/css" id="wp-custom-css">img[class^="wp-image-"]{border:1px solid silver;box-shadow:10px 10px 5px #ccc;-moz-box-shadow:10px 10px 5px #ccc;-webkit-box-shadow:10px 10px 5px #ccc;-khtml-box-shadow:10px 10px 5px #ccc}</style>
			
	</head>
	
	<body class="post-template-default single single-post postid-94 single-format-standard has-featured-image">

		
		<a class="skip-link button" href="#site-content">Skip to the content</a>
		
				
		<div class="search-container">
			
			<div class="section-inner">
			
				
<form method="get" class="search-form" id="search-form-617dd35fc88f3" action="https://doddsecurity.com/">
	<input type="search" class="search-field" placeholder="Search form" name="s" id="search-form-617dd35fc8973"/> 
	<button type="submit" class="search-button"><div class="fa fw fa-search"></div><span class="screen-reader-text">Search</span></button>
</form>			
			</div><!-- .section-inner -->
			
		</div><!-- .search-container -->
		
		<header class="header-wrapper">
		
			<div class="header">
					
				<div class="section-inner">
				
					
						<div class="blog-title">
							<a href="https://doddsecurity.com" rel="home">Dodd Security</a>
						</div>
					
													<div class="blog-description"><p>Offensive Security and Application Security Perspectives</p>
</div>
											
										
					<div class="nav-toggle">
						
						<div class="bars">
							<div class="bar"></div>
							<div class="bar"></div>
							<div class="bar"></div>
						</div>
						
					</div><!-- .nav-toggle -->
				
				</div><!-- .section-inner -->
				
			</div><!-- .header -->
			
			<div class="navigation">
				
				<div class="section-inner group">
					
					<ul class="primary-menu reset-list-style dropdown-menu">
						
						<li id="menu-item-19" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-19"><a href="https://doddsecurity.com/about/">About</a></li>
<li id="menu-item-53" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-53"><a href="https://doddsecurity.com/published-vulnerabilities/">Vulnerabilities</a></li>
															
					</ul>
					
				</div><!-- .section-inner -->
				
			</div><!-- .navigation -->
				
			<ul class="mobile-menu reset-list-style">
				
				<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-19"><a href="https://doddsecurity.com/about/">About</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-53"><a href="https://doddsecurity.com/published-vulnerabilities/">Vulnerabilities</a></li>
				
			</ul><!-- .mobile-menu -->
				
		</header><!-- .header-wrapper -->

		<main id="site-content">
<div class="wrapper section-inner group">
	
	<div class="content">
												        
				
				<article id="post-94" class="single single-post group post-94 post type-post status-publish format-standard has-post-thumbnail hentry category-vulnerability-research tag-arbitrary-file-upload tag-cve tag-remote-code-execution tag-responsible-disclosure">
					
					<div class="post-header">
											
													<p class="post-categories"><a href="https://doddsecurity.com/category/vulnerability-research/" rel="category tag">Vulnerability Research</a></p>
							<h1 class="post-title">Remote Code Execution in the Avatars</h1>						
							<div class="post-meta">

								<span class="resp">Posted</span> <span class="post-meta-author">by <a href="https://doddsecurity.com/author/regg/">Reginald Dodd</a></span> <span class="post-meta-date">on <a href="https://doddsecurity.com/94/remote-code-execution-in-the-avatars/">December 8, 2018</a></span> 
								
							</div><!-- .post-meta -->

												
					</div><!-- .post-header -->
					
								
						<figure class="post-image">
								
							<img width="816" height="427" src="https://doddsecurity.com/wp-content/uploads/2018/12/doddsecurity-post2-816x427.png" class="attachment-post-image size-post-image wp-post-image" alt="" loading="lazy" srcset="https://doddsecurity.com/wp-content/uploads/2018/12/doddsecurity-post2-816x427.png 816w, https://doddsecurity.com/wp-content/uploads/2018/12/doddsecurity-post2-300x157.png 300w, https://doddsecurity.com/wp-content/uploads/2018/12/doddsecurity-post2-768x402.png 768w, https://doddsecurity.com/wp-content/uploads/2018/12/doddsecurity-post2-1024x536.png 1024w, https://doddsecurity.com/wp-content/uploads/2018/12/doddsecurity-post2.png 1200w" sizes="(max-width: 816px) 100vw, 816px"/>							
						</figure><!-- .post-image -->
							
								
		<div class="related-posts">
			
			<p class="related-posts-title">Read Next &rarr;</p>
			
			<div class="row">
							
								
						<a class="related-post" href="https://doddsecurity.com/312/xml-external-entity-injection-xxe-in-opencats-applicant-tracking-system/">
							
															
								<img width="400" height="200" src="https://doddsecurity.com/wp-content/uploads/2019/07/opencats-400x200.png" class="attachment-post-image-thumb size-post-image-thumb wp-post-image" alt="" loading="lazy"/>								
														
							<p class="category">
								Vulnerability Research							</p>
					
							<h3 class="title">XML External Entity Injection (XXE) in OpenCats Applicant Tracking System</h3>
								
						</a>
					
										
						<a class="related-post" href="https://doddsecurity.com/234/command-injection-on-palo-alto-networks-expedition/">
							
															
								<img width="400" height="200" src="https://doddsecurity.com/wp-content/uploads/2018/12/doddsecurity-post6-400x200.png" class="attachment-post-image-thumb size-post-image-thumb wp-post-image" alt="" loading="lazy"/>								
														
							<p class="category">
								Vulnerability Research							</p>
					
							<h3 class="title">Command Injection on Palo Alto Networks Expedition</h3>
								
						</a>
					
										
						<a class="related-post" href="https://doddsecurity.com/213/command-injection-on-ipfire-firewalls/">
							
															
								<img width="400" height="200" src="https://doddsecurity.com/wp-content/uploads/2018/12/IPFire-Firewall-Post5-3-400x200.png" class="attachment-post-image-thumb size-post-image-thumb wp-post-image" alt="" loading="lazy"/>								
														
							<p class="category">
								Vulnerability Research							</p>
					
							<h3 class="title">Command Injection on IPFire Firewalls</h3>
								
						</a>
					
									
			</div><!-- .row -->

		</div><!-- .related-posts -->
		
									
					<div class="post-inner">
		
						<div class="post-content entry-content">
						
							
<p>Name:&nbsp;<a href="https://codecanyon.net/item/php-login-user-management/49008">PHP Login &amp; User Management</a></p>



<p>Vendor: Jigowatt via the Envato Market Place</p>



<p>Vulnerability: Arbitrary File Upload</p>



<p>Affected Versions: All versions before 4.1.1</p>



<p>CVE ID:&nbsp;<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-11392" target="_blank" rel="noreferrer noopener" aria-label="CVE ID:&nbsp;CVE-2018-11392 (opens in a new tab)">CVE-2018-11392</a></p>



<p>It goes without saying, but all user-input should not be trusted. This includes images, text, and any other binaries that are supplied by users. This post will cover an arbitrary file upload vulnerability that I discovered that could lead to remote code execution by uploading a malicious avatar to a user&#8217;s profile.</p>



<p>This is a PHP script that developers can use to give their apps the ability to accept user registrations (authentication) and restrict access based on a user&#8217;s level (authorization). Registered users can edit their profile, including uploading an avatar to make their accounts more personal.&nbsp; </p>



<p>For this example, I have this script running in VirtualBox at http://192.168.1.84/dev/.</p>



<p><strong>Fig I:</strong> Shows a portion of a user&#8217;s profile, specifically the feature that allows you to upload an avatar.</p>



<figure class="wp-block-image"><img loading="lazy" width="525" height="281" src="http://doddsecurity.com/wp-content/uploads/2018/12/image7.png" alt="" class="wp-image-105" srcset="https://doddsecurity.com/wp-content/uploads/2018/12/image7.png 525w, https://doddsecurity.com/wp-content/uploads/2018/12/image7-300x161.png 300w" sizes="(max-width: 525px) 100vw, 525px"/></figure>



<p><strong>Fig II:</strong>&nbsp;Shows the vulnerable code that processes the file upload.</p>



<figure class="wp-block-image"><img loading="lazy" width="895" height="418" src="https://doddsecurity.com/wp-content/uploads/2018/12/image6.png" alt="" class="wp-image-111" srcset="https://doddsecurity.com/wp-content/uploads/2018/12/image6.png 895w, https://doddsecurity.com/wp-content/uploads/2018/12/image6-300x140.png 300w, https://doddsecurity.com/wp-content/uploads/2018/12/image6-768x359.png 768w, https://doddsecurity.com/wp-content/uploads/2018/12/image6-816x381.png 816w" sizes="(max-width: 895px) 100vw, 895px"/></figure>



<p>The developers aren&#8217;t white-listing file extensions, and they are solely relying on the getimagesize() function on line 62 to determine whether or not the file is a valid image before allowing the file to be uploaded to the web server. PHP warns developers against relying on this function.</p>



<blockquote class="wp-block-quote"><p><strong>CAUTION</strong><br>Do not use&nbsp;<strong>getimagesize()</strong>&nbsp;to check that a given file is a valid image.</p><p></p><cite><a href="http://php.net/manual/en/function.getimagesize.php" target="_blank" rel="noreferrer noopener" aria-label="PHP (opens in a new tab)">PHP</a></cite></blockquote>



<p>If we can bypass the getimagesize() function, then we win and can gain remote code execution!</p>



<p>We can use a tool called &#8220;gifsicle&#8221; to embed PHP code into a legitimate image that can bypass getimagesize().</p>



<p><strong>Fig III:</strong> Shows gifsicle embedding PHP code that runs the &#8220;id&#8221; Linux command into a malicious image named output.php.gif.</p>



<figure class="wp-block-image"><img loading="lazy" width="822" height="24" src="https://doddsecurity.com/wp-content/uploads/2018/12/image9.png" alt="" class="wp-image-114" srcset="https://doddsecurity.com/wp-content/uploads/2018/12/image9.png 822w, https://doddsecurity.com/wp-content/uploads/2018/12/image9-300x9.png 300w, https://doddsecurity.com/wp-content/uploads/2018/12/image9-768x22.png 768w, https://doddsecurity.com/wp-content/uploads/2018/12/image9-816x24.png 816w" sizes="(max-width: 822px) 100vw, 822px"/></figure>



<p>The only thing left to do now is to upload the image. However, I&#8217;m going to intercept the upload and change the file extension so this image executes as PHP code since the developers aren&#8217;t white-listing file extensions.</p>



<p><strong>Fig IV:</strong> Shows the interception with Burp Suite. I am changing the &#8220;filename&#8221; from output.php.gif to output.php. Also, at the very bottom of the image, the PHP code is visible (partially cropped out by accident).</p>



<figure class="wp-block-image"><img loading="lazy" width="701" height="319" src="https://doddsecurity.com/wp-content/uploads/2018/12/image8.png" alt="" class="wp-image-115" srcset="https://doddsecurity.com/wp-content/uploads/2018/12/image8.png 701w, https://doddsecurity.com/wp-content/uploads/2018/12/image8-300x137.png 300w" sizes="(max-width: 701px) 100vw, 701px"/></figure>



<p>After allowing the HTTP POST request to be sent, the malicious image was successfully uploaded. Notice the broken image in place of our new avatar.</p>



<figure class="wp-block-image"><img loading="lazy" width="524" height="329" src="https://doddsecurity.com/wp-content/uploads/2018/12/image2.png" alt="" class="wp-image-117" srcset="https://doddsecurity.com/wp-content/uploads/2018/12/image2.png 524w, https://doddsecurity.com/wp-content/uploads/2018/12/image2-300x188.png 300w" sizes="(max-width: 524px) 100vw, 524px"/></figure>



<p>A closer look at the broken image reveals that the image is actually a PHP file that now has a URL on the web server.</p>



<figure class="wp-block-image"><img loading="lazy" width="726" height="383" src="https://doddsecurity.com/wp-content/uploads/2018/12/image1.png" alt="" class="wp-image-118" srcset="https://doddsecurity.com/wp-content/uploads/2018/12/image1.png 726w, https://doddsecurity.com/wp-content/uploads/2018/12/image1-300x158.png 300w" sizes="(max-width: 726px) 100vw, 726px"/></figure>



<p>If we navigate to that URL, notice that the &#8220;id&#8221; command executed. At this point, we can run any arbitrary command on this web server and get a shell.</p>



<figure class="wp-block-image"><img loading="lazy" width="592" height="201" src="https://doddsecurity.com/wp-content/uploads/2018/12/jigowatt-rce.png" alt="" class="wp-image-120" srcset="https://doddsecurity.com/wp-content/uploads/2018/12/jigowatt-rce.png 592w, https://doddsecurity.com/wp-content/uploads/2018/12/jigowatt-rce-300x102.png 300w" sizes="(max-width: 592px) 100vw, 592px"/></figure>



<hr class="wp-block-separator"/>



<h4>Timeline</h4>



<ul><li>April 28, 2018 &#8211; A detailed vulnerability report was sent to the vendor.</li><li>May 1, 2018 &#8211; The vendor acknowledged the report.</li><li>May 15, 2018 &#8211; The developer made the fix available through the vendor&#8217;s marketplace.</li><li>May 22, 2018 &#8211; I requested an update, and the vendor stated that this issue has been &#8220;resolved&#8221;.</li><li>May 22, 2018 &#8211; Mitre assigned a CVE.</li><li>May 23, 2018 &#8211; Published</li><li>December 8, 2018 &#8211; Detailed write-up (this post)</li></ul>
						
						</div><!-- .post-content -->

						
							<div class="post-tags"><a href="https://doddsecurity.com/tag/arbitrary-file-upload/" rel="tag">arbitrary file upload</a><a href="https://doddsecurity.com/tag/cve/" rel="tag">cve</a><a href="https://doddsecurity.com/tag/remote-code-execution/" rel="tag">remote code execution</a><a href="https://doddsecurity.com/tag/responsible-disclosure/" rel="tag">responsible disclosure</a></div>							
							<div class="post-author">
								
								<a class="avatar" href="https://doddsecurity.com/author/regg/">
									<img alt='' src='https://secure.gravatar.com/avatar/3437b25bca2894ee732acfa46c82096e?s=100&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3437b25bca2894ee732acfa46c82096e?s=200&#038;d=mm&#038;r=g 2x' class='avatar avatar-100 photo' height='100' width='100' loading='lazy'/>								</a>
								
								<h4 class="title"><a href="https://doddsecurity.com/author/regg/">Reginald Dodd</a></h4>

								
									<div class="post-author-description">
										<p>Reginald is an information security professional with experience that spans numerous industries. He has discovered unknown vulnerabilities in numerous products. He has earned a Master’s degree in Information Security and Assurance, GIAC certifications, and Offensive Security certifications.</p>
									</div><!-- .post-author-description -->

								
							</div><!-- .post-author -->

									
		<div class="related-posts">
			
			<p class="related-posts-title">Read Next &rarr;</p>
			
			<div class="row">
							
								
						<a class="related-post" href="https://doddsecurity.com/312/xml-external-entity-injection-xxe-in-opencats-applicant-tracking-system/">
							
															
								<img width="400" height="200" src="https://doddsecurity.com/wp-content/uploads/2019/07/opencats-400x200.png" class="attachment-post-image-thumb size-post-image-thumb wp-post-image" alt="" loading="lazy"/>								
														
							<p class="category">
								Vulnerability Research							</p>
					
							<h3 class="title">XML External Entity Injection (XXE) in OpenCats Applicant Tracking System</h3>
								
						</a>
					
										
						<a class="related-post" href="https://doddsecurity.com/234/command-injection-on-palo-alto-networks-expedition/">
							
															
								<img width="400" height="200" src="https://doddsecurity.com/wp-content/uploads/2018/12/doddsecurity-post6-400x200.png" class="attachment-post-image-thumb size-post-image-thumb wp-post-image" alt="" loading="lazy"/>								
														
							<p class="category">
								Vulnerability Research							</p>
					
							<h3 class="title">Command Injection on Palo Alto Networks Expedition</h3>
								
						</a>
					
										
						<a class="related-post" href="https://doddsecurity.com/213/command-injection-on-ipfire-firewalls/">
							
															
								<img width="400" height="200" src="https://doddsecurity.com/wp-content/uploads/2018/12/IPFire-Firewall-Post5-3-400x200.png" class="attachment-post-image-thumb size-post-image-thumb wp-post-image" alt="" loading="lazy"/>								
														
							<p class="category">
								Vulnerability Research							</p>
					
							<h3 class="title">Command Injection on IPFire Firewalls</h3>
								
						</a>
					
									
			</div><!-- .row -->

		</div><!-- .related-posts -->
		
								
																
					</div><!-- .post-inner -->
					
				</article><!-- .post -->
				
					
	</div><!-- .content -->
	
	<div class="sidebar">

	<div id="text-3" class="widget widget_text"><div class="widget-content"><h3 class="widget-title">The Author</h3>			<div class="textwidget"><p><img loading="lazy" class="size-full wp-image-90 aligncenter" src="https://doddsecurity.com/wp-content/uploads/2018/12/Reginald-Dodd-Cropped.png" alt="" width="200" height="200" srcset="https://doddsecurity.com/wp-content/uploads/2018/12/Reginald-Dodd-Cropped.png 200w, https://doddsecurity.com/wp-content/uploads/2018/12/Reginald-Dodd-Cropped-150x150.png 150w, https://doddsecurity.com/wp-content/uploads/2018/12/Reginald-Dodd-Cropped-88x88.png 88w" sizes="(max-width: 200px) 100vw, 200px"/></p>
<p>Hi, I&#8217;m Reginald Dodd, an offensive security engineer and the author of this blog. This is where I document my perspectives on offensive security and application security in my personal time.</p>
<p>Read my <a href="http://doddsecurity.com/about/">About Me</a> page for more on me.</p>
</div>
		</div></div><div id="simple-social-icons-2" class="widget simple-social-icons"><div class="widget-content"><h3 class="widget-title">Follow</h3><ul class="alignleft"><li class="ssi-github"><a href="https://github.com/doddr" target="_blank" rel="noopener noreferrer"><svg role="img" class="social-github" aria-labelledby="social-github-2"><title id="social-github-2">GitHub</title><use xlink:href="https://doddsecurity.com/wp-content/plugins/simple-social-icons/symbol-defs.svg#social-github"></use></svg></a></li><li class="ssi-linkedin"><a href="https://www.linkedin.com/in/reginalddodd/" target="_blank" rel="noopener noreferrer"><svg role="img" class="social-linkedin" aria-labelledby="social-linkedin-2"><title id="social-linkedin-2">LinkedIn</title><use xlink:href="https://doddsecurity.com/wp-content/plugins/simple-social-icons/symbol-defs.svg#social-linkedin"></use></svg></a></li><li class="ssi-rss"><a href="https://doddsecurity.com/feed/" target="_blank" rel="noopener noreferrer"><svg role="img" class="social-rss" aria-labelledby="social-rss-2"><title id="social-rss-2">RSS</title><use xlink:href="https://doddsecurity.com/wp-content/plugins/simple-social-icons/symbol-defs.svg#social-rss"></use></svg></a></li></ul></div></div><div id="categories-2" class="widget widget_categories"><div class="widget-content"><h3 class="widget-title">Categories</h3>
			<ul>
					<li class="cat-item cat-item-1"><a href="https://doddsecurity.com/category/general/">General</a>
</li>
	<li class="cat-item cat-item-2"><a href="https://doddsecurity.com/category/vulnerability-research/">Vulnerability Research</a>
</li>
			</ul>

			</div></div>
</div>	
</div><!-- .wrapper -->
		
		</main><!-- #site-content -->

		<footer class="credits">
					
			<div class="section-inner">
				
				<a href="#" class="to-the-top">
					<div class="fa fw fa-angle-up"></div>
					<span class="screen-reader-text">To the top</span>
				</a>
				
				<p class="copyright">&copy; 2021 <a href="https://doddsecurity.com/" rel="home">Dodd Security</a></p>
				
				
			</div><!-- .section-inner -->
			
		</footer><!-- .credits -->

		<style type="text/css" media="screen">#simple-social-icons-2 ul li a,#simple-social-icons-2 ul li a:hover,#simple-social-icons-2 ul li a:focus{background-color:#999!important;border-radius:3px;color:#fff!important;border:0 #fff solid!important;font-size:30px;padding:15px}#simple-social-icons-2 ul li a:hover,#simple-social-icons-2 ul li a:focus{background-color:#666!important;border-color:#fff!important;color:#fff!important}#simple-social-icons-2 ul li a:focus{outline:1px dotted #666!important}</style><script type='text/javascript' src='https://doddsecurity.com/wp-content/themes/rowling/assets/js/global.js?ver=2.0.2' id='rowling_global-js'></script>
<script type='text/javascript' src='https://doddsecurity.com/wp-includes/js/comment-reply.min.js?ver=28de890456b98cd115186dbe4d609003' id='comment-reply-js'></script>
<script type='text/javascript' src='https://doddsecurity.com/wp-includes/js/wp-embed.min.js?ver=28de890456b98cd115186dbe4d609003' id='wp-embed-js'></script>

	</body>
	
</html>