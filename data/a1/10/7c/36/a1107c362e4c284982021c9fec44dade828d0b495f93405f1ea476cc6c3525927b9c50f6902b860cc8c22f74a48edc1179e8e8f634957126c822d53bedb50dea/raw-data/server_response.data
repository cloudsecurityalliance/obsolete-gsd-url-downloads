<!DOCTYPE html>
<html lang="en">
    <head>
        <meta name="twitter:card" content="summary" />
        <meta name="twitter:creator" content="@i_am_cjc" />
        <!-- <meta property="og:url" content="{OGURL}" /> -->
        <meta property="og:title" content="cjc.im" />
        <meta property="og:description" content="Reflected XSS in wp-mail plugin 
" />

        <meta charset="UTF-8"> 
        <meta http-equiv="Pragma" content="no-cache">
        <meta http-equiv="Expires" content="-1">

        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="Personal homepage of Carl J Clegg">
        <title>cjc.im</title>
    </head>
    <body>
    <div id="main">
<h1>Reflected XSS in wp-mail plugin</h1>
<h3>Credit</h3>
<p>This vulnerability has been discovered and reported by Carl Clegg (carl(at)cjc(dot)im)</p>
<h3>Timeline</h3>
<ul>
<li>2016-07-23: Vendor Notified</li>
<li>2016-07-26: Fixed in version 1.2 </li>
<li>2016-11-21: Advisory Published</li>
</ul>
<h3>Product</h3>
<p>WP Mail plugin is simply a wp network mail or message system. User can send mail or messages to other users over one wp network. </p>
<h3>Versions Affected</h3>
<p>WP Mail &lt;= 1.2</p>
<h3>Risk / Severity Rating</h3>
<p>Not calculated</p>
<h3>Description and Impact</h3>
<p>The <code>replyto</code> parameter when composing a mail allows for a reflected XSS. </p>
<pre><code>$replyTo = isset($_GET['replyto']) ? $_GET['replyto'] : '';
...
&lt;input type="text" class="form-control" placeholder="Enter receiver's wordpress email" name="reciever_mail" required="required" value="&lt;?php echo !empty($replyTo) ? $replyTo : $to; ?&gt;"&gt;
</code></pre>
<h3>Proof of Concept</h3>
<p><code>http://wordpress.site/wp-admin/admin.php?page=wp_mail_compose&amp;replyto=%22%3E%3Cscript+src%3Ddata%3A%26comma%3Balert%281%29%2F%2F</code></p>
<p>would execute <code>alert(1)</code> but could be used to run something more malicious</p>
<h3>Solution</h3>
<p>Upgrade to version 1.2</p>
<h3>References</h3>
<ul>
<li>XSS <a href="https://www.owasp.org/index.php/Top_10_2013-A3-Cross-Site_Scripting_(XSS)">here</a></li>
<li><a href="http://www.cvedetails.com/cve/CVE-2017-5942/">CVE-2017-5942</a></li>
</ul>
<h3>Legal</h3>
<p>The information contained within this advisory is supplied "as-is" with no warranties or guarantees of fitness of use or otherwise.</p>
<a href="/site.html">home</a>
        </div>
    </body>
</html>
