-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

IBM SECURITY ADVISORY

First Issued:

The most recent version of this document is available here:

http://aix.software.ibm.com/aix/efixes/security/muxatmd_advisory.asc
or
ftp://aix.software.ibm.com/aix/efixes/security/muxatmd_advisory.asc

                           VULNERABILITY SUMMARY

VULNERABILITY:   AIX muxatmd buffer overflow

PLATFORMS:       AIX 5.2, 5.3, 6.1

SOLUTION:        Apply the fix or workaround as described below.

THREAT:          A local attacker may execute arbitrary code as root.

CERT VU Number:  n/a
CVE Number:      n/a

Reboot required?    NO
Workarounds?        YES
Protected by FPM?   YES (high, medium, or low)
Protected by SED?   YES

                           DETAILED INFORMATION

I. DESCRIPTION

    The muxatmd command contains a buffer which can overflow.  A local
    attacker may exploit this overflow to execute arbitrary code with
    root privileges because the command is setuid root.

    The following file is vulnerable:

    /usr/sbin/muxatmd

II. PLATFORM VULNERABILITY ASSESSMENT

    To determine if your system is vulnerable, execute the following
    command:

    lslpp -L devices.common.IBM.atm.rte

    The following fileset levels are currently vulnerable:

    AIX Fileset                 Lower Level  Upper Level
    ----------------------------------------------------------
    devices.common.IBM.atm.rte  5.2.0.51     5.2.0.97
    devices.common.IBM.atm.rte  5.3.0.60     5.3.0.63
    devices.common.IBM.atm.rte  5.3.7.0      5.3.7.2
    devices.common.IBM.atm.rte  5.3.8.0      5.3.8.0
    devices.common.IBM.atm.rte  5.3.9.0      5.3.9.0
    devices.common.IBM.atm.rte  6.1.0.0      6.1.0.1
    devices.common.IBM.atm.rte  6.1.1.0      6.1.1.0
    devices.common.IBM.atm.rte  6.1.2.0      6.1.2.0

III. SOLUTIONS

    A. APARS

        IBM has assigned the following APARs to this problem:

        AIX Level           APAR number        Availability
        ----------------------------------------------------
        5.2.0               IZ48495            07/22/2009
        5.3.0               IZ48496            07/01/2009
        5.3.7               IZ48499            07/01/2009
        5.3.8               IZ48500            07/01/2009
        5.3.9               IZ48501            07/01/2009
        6.1.0               IZ48502            06/03/2009
        6.1.1               IZ48561            06/03/2009
        6.1.2               IZ48562            06/03/2009

        Subscribe to the APARs here:

        http://www.ibm.com/support/docview.wss?uid=isg1IZ48495
        http://www.ibm.com/support/docview.wss?uid=isg1IZ48496
        http://www.ibm.com/support/docview.wss?uid=isg1IZ48499
        http://www.ibm.com/support/docview.wss?uid=isg1IZ48500
        http://www.ibm.com/support/docview.wss?uid=isg1IZ48501
        http://www.ibm.com/support/docview.wss?uid=isg1IZ48502
        http://www.ibm.com/support/docview.wss?uid=isg1IZ48561
        http://www.ibm.com/support/docview.wss?uid=isg1IZ48562

        By subscribing, you will receive periodic email alerting you
        to the status of the APAR, and a link to download the fix once
        it becomes available.

    B. FIXES

        Fixes are now available.  The fixes can be downloaded from:

        http://aix.software.ibm.com/aix/efixes/security/muxatmd_fix.tar
        ftp://aix.software.ibm.com/aix/efixes/security/muxatmd_fix.tar

        The links above are to a tar file containing this signed
        advisory, fix packages, and PGP signatures for each package.

        AIX Level         Fix
        ----------------------------------------------------
        5.2.0 TL10        IZ48495_10.090408.epkg.Z
        5.3.0 TL6         IZ48496_06.090408.epkg.Z
        5.3.7             IZ48499_07.090408.epkg.Z
        5.3.8             IZ48500_08.090408.epkg.Z
        5.3.9             IZ48501_09.090408.epkg.Z
        6.1.0             IZ48502_00.090408.epkg.Z
        6.1.1             IZ48561_01.090408.epkg.Z
        6.1.2             IZ48562_02.090408.epkg.Z

        To extract the fixes from the tar file:

        tar xvf muxatmd_fix.tar
        cd muxatmd_fix

        Verify you have retrieved the fixes intact:

        The checksums below were generated using the "csum -h SHA1"
        (sha1sum) commands and are as follows:

        csum -h SHA1 (sha1sum)                    filename
        ------------------------------------------------------------------
        180f448dcbddeaaea2070daa50978f0bd0b2fdd2  IZ48495_10.090408.epkg.Z
        ee85a18106d7e0b09b06576f08cfb545fb06b9f7  IZ48496_06.090408.epkg.Z
        0a5c7ec45e98c6e0beac89de13852fbab4992b7b  IZ48499_07.090408.epkg.Z
        78665878354668ed415a4dbad018fbf06d5140cb  IZ48500_08.090408.epkg.Z
        de7e8056650767d480dbc099e372332b39748b86  IZ48501_09.090408.epkg.Z
        2f3e0cd961a85822bace41f5c2a538e2df74a59e  IZ48502_00.090408.epkg.Z
        861973dd1ddeadd0969db52cf9342984ed0e96c2  IZ48561_01.090408.epkg.Z
        adacb27d2811cac2e47d06ef4724b5b8707aa714  IZ48562_02.090408.epkg.Z

        To verify the sums, use the text of this advisory as input to
        csum or sha1sum. For example:

        csum -h SHA1 -i Advisory.asc
        sha1sum -c Advisory.asc

        These sums should match exactly. The PGP signatures in the tar
        file and on this advisory can also be used to verify the
        integrity of the fixes.  If the sums or signatures cannot be
        confirmed, contact IBM AIX Security and describe the
        discrepancy at the following address:

            security-alert@austin.ibm.com

     C. INTERIM FIX INSTALLATION

        IMPORTANT: If possible, it is recommended that a mksysb backup
        of the system be created.  Verify it is both bootable and
        readable before proceeding.

        Interim fixes have had limited functional and regression
        testing but not the full regression testing that takes place
        for Service Packs; thus, IBM does not warrant the fully
        correct functionality of an interim fix.

        Interim fix management documentation can be found at:

        http://www14.software.ibm.com/webapp/set2/sas/f/aix.efixmgmt/home.html

        To preview an interim fix installation:

        emgr -e ipkg_name -p         # where ipkg_name is the name of the  
                                     # interim fix package being previewed.

        To install an interim fix package:

        emgr -e ipkg_name -X         # where ipkg_name is the name of the  
                                     # interim fix package being installed.

IV. WORKAROUNDS

    There are two workarounds available.

    A. OPTION 1

        Change the permissions of these commands to remove the setuid
        bit using the following commands:

        chmod 500 /usr/sbin/muxatmd

        NOTE: chmod will disable functionality of these commands for
        all users except root.

    B. OPTION 2

        Use the File Permissions Manager (fpm) command to manage
        setuid and setgid programs.

        fpm documentation can be found in the AIX 6 Security Redbook
        at:

        http://www.redbooks.ibm.com/abstracts/sg247430.html

        An fpm level of high, medium, or low will remove the setuid
        bit from the affected commands.  For example:

        fpm -l high -p    # to preview changes
        fpm -l high       # to execute changes

        NOTE: Please review the documentation before execution.  fpm
        will disable functionality of multiple commands for all users
        except root.

V. OBTAINING FIXES

    AIX security fixes can be downloaded from:

        http://aix.software.ibm.com/aix/efixes/security
        or
        ftp://aix.software.ibm.com/aix/efixes/security

    AIX fixes can be downloaded from:

        http://www.ibm.com/eserver/support/fixes/fixcentral/main/pseries/aix

    NOTE: Affected customers are urged to upgrade to the latest
    applicable Technology Level and Service Pack.

VI. CONTACT INFORMATION

    If you would like to receive AIX Security Advisories via email,
    please visit:
 
        http://www.ibm.com/systems/support
 
    and click on the "My notifications" link.
 
    To view previously issued advisories, please visit:
 
        http://www14.software.ibm.com/webapp/set2/subscriptions/pqvcmjd
 
    Comments regarding the content of this announcement can be
    directed to:
 
        security-alert@austin.ibm.com
 
    To obtain the PGP public key that can be used to communicate
    securely with the AIX Security Team you can either:
 
        A. Download the key from our web page:
 
  http://www.ibm.com/systems/resources/systems_p_os_aix_security_pgpkey.txt
 
        B. Download the key from a PGP Public Key Server. The key ID is:
 
            0xADA6EB4D
 
    Please contact your local IBM AIX support center for any
    assistance.
 
    eServer is a trademark of International Business Machines
    Corporation.  IBM, AIX and pSeries are registered trademarks of
    International Business Machines Corporation.  All other trademarks
    are property of their respective holders.

VII. ACKNOWLEDGMENTS

    This vulnerability was reported by iDefense Labs.

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.7 (AIX)

iD8DBQFJ5fqHP9Qud62m600RArWJAKCQw/a9fd7EDxZXeyV/t+uVdQfnsgCfY/vN
PMJwYfZ/ow9yGbXddMnVCtU=
=vj5R
-----END PGP SIGNATURE-----
