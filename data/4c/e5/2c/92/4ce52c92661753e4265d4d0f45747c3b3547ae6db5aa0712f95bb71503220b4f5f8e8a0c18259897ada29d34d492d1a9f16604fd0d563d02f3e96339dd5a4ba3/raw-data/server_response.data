<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>CVE-2020-6637 - My Cyber Endeavors</title>
<meta name="description" content="OpenSIS v7.3 is vulnerable to unauthenticated SQL injection via the ‘username’ field, this allows for remote database compromise as well as authentication bypass. The following is a brief write-up of the identification, exploitation, and reporting of CVE-2020-6637.">


  <meta name="author" content="cinzinga">
  
  <meta property="article:author" content="cinzinga">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="My Cyber Endeavors">
<meta property="og:title" content="CVE-2020-6637">
<meta property="og:url" content="https://cinzinga.com/CVE-2020-6637/">


  <meta property="og:description" content="OpenSIS v7.3 is vulnerable to unauthenticated SQL injection via the ‘username’ field, this allows for remote database compromise as well as authentication bypass. The following is a brief write-up of the identification, exploitation, and reporting of CVE-2020-6637.">



  <meta property="og:image" content="https://cinzinga.com/assets/images/Exploit-Dev/CVE.png">





  <meta property="article:published_time" content="2020-08-23T00:00:00+00:00">






<link rel="canonical" href="https://cinzinga.com/CVE-2020-6637/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": null,
      "url": "https://cinzinga.com/"
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="My Cyber Endeavors Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          My Cyber Endeavors
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/posts/">Posts</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/">Tags</a>
            </li><li class="masthead__menu-item">
              <a href="/about/">About</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person" class="h-card">

  
    <div class="author__avatar">
      <a href="https://cinzinga.com/">
        <img src="/assets/images/bio-photo.jpg" alt="cinzinga" itemprop="image" class="u-photo">
      </a>
    </div>
  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="https://cinzinga.com/" itemprop="url">cinzinga</a>
    </h3>
    
      <div class="author__bio p-note" itemprop="description">
        <p>OSEP, OSCP, Sec+</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      
        
          
            <li><a href="https://cinzinga.com" rel="nofollow noopener noreferrer me"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">Website</span></a></li>
          
        
          
            <li><a href="https://twitter.com/cinzinga_" rel="nofollow noopener noreferrer me"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
          
        
          
            <li><a href="https://github.com/cinzinga" rel="nofollow noopener noreferrer me"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://www.linkedin.com/in/christopher-inzinga/" rel="nofollow noopener noreferrer me"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
          
        
          
            <li><a href="https://bugcrowd.com/cinzinga" rel="nofollow noopener noreferrer me"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">BugCrowd</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>
  
  </div>



  <article class="page h-entry" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="CVE-2020-6637">
    <meta itemprop="description" content="OpenSIS v7.3 is vulnerable to unauthenticated SQL injection via the ‘username’ field, this allows for remote database compromise as well as authentication bypass. The following is a brief write-up of the identification, exploitation, and reporting of CVE-2020-6637.">
    <meta itemprop="datePublished" content="2020-08-23T00:00:00+00:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title p-name" itemprop="headline">
            <a href="https://cinzinga.com/CVE-2020-6637/" class="u-url" itemprop="url">CVE-2020-6637
</a>
          </h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          2 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content e-content" itemprop="text">
        
        <p>OpenSIS v7.3 is vulnerable to unauthenticated SQL injection via the ‘username’ field, this allows for remote database compromise as well as authentication bypass. The following is a brief write-up of the identification, exploitation, and reporting of <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-6637">CVE-2020-6637</a>.</p>

<h2 id="the-software">The Software</h2>
<p><a href="https://en.wikipedia.org/wiki/OpenSIS">Wikipedia</a> describes OpenSIS as the following:</p>
<blockquote>
  <p>OpenSIS is one of several free and open source student information system available to K-12 and higher education institutions. The solution has been in development for several years and appears to have much of the functionality that long time commercial versions have.</p>
</blockquote>

<p>The community edition of the software can be obtained <a href="https://sourceforge.net/projects/opensis-ce/">here</a>.</p>

<p>Selecting software to review for vulnerabilities can be very hit or miss. There are a handful of reasons I decided to look into this software:</p>
<ol>
  <li>Written in PHP with a SQL database. This is often a recipe for vulnerabilities.</li>
  <li>History of vulnerabilities on <a href="https://www.exploit-db.com/search?q=opensis">Exploit-DB</a>, if bugs existed in the past, more will likely exist in the future.</li>
  <li>This software is a school information system. That means it protects a lot of juicy PII and the impact of any bugs is greatly magnified.</li>
</ol>

<h2 id="the-bug">The Bug</h2>
<p>After installing OpenSIS locally, one will be greeted with the following login screen.</p>

<p><img src="/assets/images/Exploit-Dev/OpenSIS/1.png" alt="" /></p>

<p>Checking for SQL injection on the login page is perhaps one of the quickest and easiest check one can perform when analyzing a web application. It takes just a few seconds to drop a <code class="language-plaintext highlighter-rouge">'</code> in the username password fields and pray for that <code class="language-plaintext highlighter-rouge">Error in your SQL Synax</code> message.</p>

<p>Lo and behold… <br />
<img src="/assets/images/Exploit-Dev/OpenSIS/2.png" alt="" /></p>

<p>Not only does the web application tell us we have an error in our SQL syntax, it also provides an incredibly detailed error message that includes the whole SQL query. At this point, one could fire up SQLMap and exploit this error based SQL injection; however, let’s first look at the error message and code further.</p>

<p>Line 117 of index.php is show below.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nv">$login_uniform</span> <span class="o">=</span> <span class="nf">DBGet</span><span class="p">(</span><span class="nf">DBQuery</span><span class="p">(</span><span class="s1">'SELECT * FROM login_authentication WHERE UPPER(USERNAME)=UPPER(\''</span> <span class="mf">.</span> <span class="nv">$username</span> <span class="mf">.</span> <span class="s1">'\') AND UPPER(PASSWORD)=UPPER(\''</span> <span class="mf">.</span> <span class="nv">$password</span> <span class="mf">.</span> <span class="s1">'\')'</span><span class="p">));</span>
</code></pre></div></div>

<p>Placing a SQL query directly in PHP code is never a recommended practice. In the photo above, it is clear where our <code class="language-plaintext highlighter-rouge">'</code> is reflected in the SQL string.</p>

<p>Payload: <code class="language-plaintext highlighter-rouge">'</code><br />
SQL Query:</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">login_authentication</span> <span class="k">WHERE</span> <span class="k">UPPER</span><span class="p">(</span><span class="n">USERNAME</span><span class="p">)</span><span class="o">=</span><span class="k">UPPER</span><span class="p">(</span><span class="k">NULL</span><span class="s1">') AND UPPER(PASSWORD)=.....
</span></code></pre></div></div>

<p>Thus by changing our payload slightly we may be able to utilize tautology to cause this query to return <code class="language-plaintext highlighter-rouge">true</code>.</p>

<p>Payload: <code class="language-plaintext highlighter-rouge">') or 1=1;-- -</code><br />
SQL Query:</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">login_authentication</span> <span class="k">WHERE</span> <span class="k">UPPER</span><span class="p">(</span><span class="n">USERNAME</span><span class="p">)</span><span class="o">=</span><span class="k">UPPER</span><span class="p">(</span><span class="k">NULL</span><span class="s1">') or 1=1;-- -) AND UPPER(PASSWORD)=.....
</span></code></pre></div></div>

<p><img src="/assets/images/Exploit-Dev/OpenSIS/3.png" alt="" /></p>

<p>Interestingly enough, this returned an <code class="language-plaintext highlighter-rouge">INSERT</code> SQL statement, but upon refreshing the page, one would be logged in as the administrator.</p>

<p><img src="/assets/images/Exploit-Dev/OpenSIS/4.png" alt="" /></p>

<p>A video POC is shown below against the OpenSIS demo site.</p>

<p><a href="https://www.youtube.com/watch?v=IDc_3kwse5Q"><img src="https://img.youtube.com/vi/IDc_3kwse5Q/0.jpg" alt="Video POC" /></a></p>

<p>(Note: after contacting OpenSIS I was given explicit permission to demonstrate this vulnerability against their demo site)</p>

<h2 id="timeline">Timeline</h2>

<p>7 January 2020 - Bug discovered and reported to OpenSIS.<br />
8 January 2020 - Response recieved and video POC requested.<br />
8 January 2020 - CVE reserved.<br />
13 January 2020 - Issue patched. <br />
16 January 2020 - Code pushed to SourceForge. <br />
23 August 2020 - Sufficient time has passed, CVE publicly disclosured via blog post.</p>

<p><img src="/assets/images/Exploit-Dev/OpenSIS/5.png" alt="" /></p>

<h2 id="conclusion">Conclusion</h2>

<p>While using this simple SQL tautology no longer bypasses authentication, the newest version of OpenSIS still throws a verbose SQL syntax error if a <code class="language-plaintext highlighter-rouge">'</code> is submitted upon login. Thus, database compromise still may be possible with the assistance of SQLMap. Preliminary Google Dork-ing reveals the existance of many school using OpenSIS with each being (potentially) vulnerable to unauthenticated SQL injection.</p>

<p><img src="/assets/images/Exploit-Dev/OpenSIS/6.png" alt="" /></p>

<p><img src="https://hitcounter.pythonanywhere.com/count/tag.svg?url=https%3A%2F%2Fcinzinga.com%2FCVE-2020-6637%2F" alt="Hits" /></p>


        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#exploit-dev" class="page__taxonomy-item p-category" rel="tag">Exploit-Dev</a><span class="sep">, </span>
    
      <a href="/tags/#penetration-testing" class="page__taxonomy-item p-category" rel="tag">Penetration Testing</a>
    
    </span>
  </p>




        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time class="dt-published" datetime="2020-08-23T00:00:00+00:00">August 23, 2020</time></p>

      </footer>

      <section class="page__share">
  

  <a href="https://twitter.com/intent/tweet?text=CVE-2020-6637%20https%3A%2F%2Fcinzinga.com%2FCVE-2020-6637%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fcinzinga.com%2FCVE-2020-6637%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fcinzinga.com%2FCVE-2020-6637%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/Bug-Bounty/" class="pagination--pager" title="100 Days of Bug Hunting
">Previous</a>
    
    
      <a href="/Bug-Bounty-Thoughts/" class="pagination--pager" title="Bug Hunting Thoughts &amp; Statistics
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h2 class="page__related-title">You May Also Enjoy</h2>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/BB.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/XXE-Case-Studies/" rel="permalink">XXE Case Studies
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          4 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">As it has been some time since my last blog post, I decided I would set aside some time to write one now. The topic of this blog post is inspired by a bug I ...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/offsec.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/OSEP-PEN-300-Review/" rel="permalink">OSEP &amp; PEN-300 Course Review
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          8 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">I am proud to have completed Offensive Security’s Evasion Techniques and Breaching Defenses (PEN-300) course. After successfully passing the 48-hour exam, I ...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/BB.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/Bug-Bounty-Thoughts/" rel="permalink">Bug Hunting Thoughts &amp; Statistics
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          2 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Today marks a huge personal milestone in my bug bounty hunting career. I have achieved an all-time ranking of top 100 on Bugcrowd. This accomplishment comes ...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/BB.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/Bug-Bounty/" rel="permalink">100 Days of Bug Hunting
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          4 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">On April 1st 2019, I decided to try my hand at bug bounty hunting. What started initially as a short experiment quickly evolved into a daily obsession and a ...</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
          <li><a href="https://twitter.com/cinzinga_" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
        
      
        
          <li><a href="https://github.com/cinzinga" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2021 My Cyber Endeavors. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>







  </body>
</html>
