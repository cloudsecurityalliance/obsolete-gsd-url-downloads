<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
<link rel="icon" href="/favicon.png">
<title>#746498 - dpkg-source: Directory traversal on unpack through missing --- header line - Debian Bug report logs</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="/css/bugs.css" type="text/css">

<link rel="canonical" href="&lt;a href=&quot;bugreport.cgi?bug=746498&quot;&gt;746498&lt;/a&gt;">
<script type="text/javascript">
<!--
function toggle_infmessages()
{
        allDivs=document.getElementsByTagName("div");
        for (var i = 0 ; i < allDivs.length ; i++ )
        {
                if (allDivs[i].className == "infmessage")
                {
                        allDivs[i].style.display=(allDivs[i].style.display == 'none' | allDivs[i].style.display == '') ? 'block' : 'none';
                }
        }
}
-->
</script>
</head>
<body>
<h1>Debian Bug report logs - 
<a href="mailto:746498@bugs.debian.org">#746498</a><br>
dpkg-source: Directory traversal on unpack through missing --- header line</h1>
<div class="versiongraph"><a href="version.cgi?fixed=dpkg%2F1.17.10;fixed=dpkg%2F1.16.15;fixed=dpkg%2F1.15.11;collapse=1;found=1.3.0;package=dpkg-dev;absolute=0;info=1"><img alt="version graph" src="version.cgi?height=2;collapse=1;found=1.3.0;fixed=dpkg%2F1.17.10;fixed=dpkg%2F1.16.15;fixed=dpkg%2F1.15.11;package=dpkg-dev;absolute=0;width=2"></a></div>
<div class="pkginfo">
  <p>Package:
     <a class="submitter" href="pkgreport.cgi?package=dpkg-dev">dpkg-dev</a>;
Maintainer for <a href="pkgreport.cgi?package=dpkg-dev">dpkg-dev</a> is <a href="pkgreport.cgi?maint=debian-dpkg%40lists.debian.org">Dpkg Developers &lt;debian-dpkg@lists.debian.org&gt;</a>; Source for <a href="pkgreport.cgi?package=dpkg-dev">dpkg-dev</a> is <a href="pkgreport.cgi?src=dpkg">src:dpkg</a> (<a href="https://tracker.debian.org/pkg/dpkg">PTS</a>, <a href="https://buildd.debian.org/dpkg">buildd</a>, <a href="https://qa.debian.org/popcon.php?package=dpkg">popcon</a>). </p>

</div>

<div class="buginfo">
  <p>Reported by: <a href="pkgreport.cgi?submitter=javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9%40jasp.net">javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net</a></p>
  <p>Date: Wed, 30 Apr 2014 16:18:01 UTC</p>

<p>Severity: important</p>
<p>Tags: security</p>

<p>Found in version 1.3.0</p>
<p>Fixed in versions dpkg/1.17.10, dpkg/1.16.15, dpkg/1.15.11</p>

<p><strong>Done:</strong> Guillem Jover &lt;guillem@debian.org&gt;</p>

<p>Bug is archived. No further changes may be made.<p></div>

<p><a href="javascript:toggle_infmessages();">Toggle useless messages</a></p><div class="msgreceived"><p>View this report as an <a href="bugreport.cgi?bug=746498;mbox=yes">mbox folder</a>, <a href="bugreport.cgi?bug=746498;mbox=yes;mboxstatus=yes">status mbox</a>, <a href="bugreport.cgi?bug=746498;mbox=yes;mboxmaint=yes">maintainer mbox</a></p></div>

<div class="infmessage"><hr><p>
<a name="1"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Dpkg Developers &lt;debian-dpkg@lists.debian.org&gt; -->
<!-- time:1398874686 -->
<strong>Report forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Dpkg Developers &lt;debian-dpkg@lists.debian.org&gt;</code>:<br>
<code>Bug#746498</code>; Package <code>dpkg</code>.
 (Wed, 30 Apr 2014 16:18:06 GMT) (<a href="bugreport.cgi?bug=746498;msg=2">full text</a>, <a href="bugreport.cgi?bug=746498;mbox=yes;msg=2">mbox</a>, <a href="#1">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="3"></a>
<!-- request_addr: javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net -->
<!-- time:1398874686 -->
<strong>Acknowledgement sent</strong>
to <code>javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net</code>:<br>
New Bug report received and forwarded.  Copy sent to <code>Dpkg Developers &lt;debian-dpkg@lists.debian.org&gt;</code>.<p>
<P>

Your message had a Version: pseudo-header with an invalid package
version:
<P>

1.15.8.13 1.16.12
<P>

please either use found or fixed to the control server with a correct
version, or reply to this report indicating the correct version so the
maintainer (or someone else) can correct it for you.
<P>

<p>

 (Wed, 30 Apr 2014 16:18:06 GMT) (<a href="bugreport.cgi?bug=746498;msg=4">full text</a>, <a href="bugreport.cgi?bug=746498;mbox=yes;msg=4">mbox</a>, <a href="#3">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="5"></a><a name="msg5"></a><a href="#5">Message #5</a> received at submit@bugs.debian.org (<a href="bugreport.cgi?bug=746498;msg=5">full text</a>, <a href="bugreport.cgi?bug=746498;mbox=yes;msg=5">mbox</a>, <a href="mailto:746498@bugs.debian.org?body=On%20Wed%2C%2030%20Apr%202014%2018%3A14%3A29%20%2B0200%20Javier%20Serrano%20Polo%20%3Cjavier%40jasp.net%3E%20wrote%3A%0A%3E%20Package%3A%20dpkg%0A%3E%20Version%3A%201.15.8.13%201.16.12%0A%3E%20Tags%3A%20security%0A%3E%20%0A%3E%20Directory%20traversal%20was%20already%20possible.%20I%20have%20suggested%20a%20solution.%0A%3E%20That%20is%20the%20way%20I%20fixed%20it%3A%20dry%20run%2C%20let%20the%20patch%20tool%20say%20what%20files%0A%3E%20will%20be%20touched.%20Another%20solution%20would%20be%20to%20stop%20using%20an%20external%0A%3E%20tool.%0A%3E%20%0A%3E%20I%20will%20wait%20two%20days%20before%20releasing%20one%20of%20the%20exploit%20packages.%0A&amp;subject=Re%3A%20dpkg%3A%20directory%20traversal%20during%20unpack&amp;References=%3C1398874469.18363.36.camel%40sempati.menos4%3E&amp;In-Reply-To=%3C1398874469.18363.36.camel%40sempati.menos4%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=javier%40jasp.net" alt="">
<div class="header"><span class="headerfield">From:</span> Javier Serrano Polo &lt;javier@jasp.net&gt;</div>
<div class="header"><span class="headerfield">To:</span> submit@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> dpkg: directory traversal during unpack</div>
<div class="header"><span class="headerfield">Date:</span> Wed, 30 Apr 2014 18:14:29 +0200</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=0;bug=746498;msg=5">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message">Package: dpkg
Version: 1.15.8.13 1.16.12
Tags: security

Directory traversal was already possible. I have suggested a solution.
That is the way I fixed it: dry run, let the patch tool say what files
will be touched. Another solution would be to stop using an external
tool.

I will wait two days before releasing one of the exploit packages.
</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=746498;filename=smime.p7s;msg=5">smime.p7s</a> (application/pkcs7-signature, attachment)]</pre>

<div class="msgreceived"><hr><p>
<a name="6"></a>
<!-- command:found -->
<!-- requester: Javier Serrano Polo &lt;javier@jasp.net&gt; -->
<!-- request_addr: control@bugs.debian.org -->
<!-- time:1398877037 -->
<!-- new_data:
$new_data = {
              &#39;found_versions&#39; =&gt; [
                                    &#39;dpkg/1.15.8.13&#39;
                                  ]
            };
-->
<!-- old_data:
$old_data = {
              &#39;found_versions&#39; =&gt; []
            };
-->
<strong>Marked as found in versions dpkg/1.15.8.13.</strong>
Request was from <code>Javier Serrano Polo &lt;javier@jasp.net&gt;</code>
to <code>control@bugs.debian.org</code>.
 (Wed, 30 Apr 2014 16:57:17 GMT) (<a href="bugreport.cgi?bug=746498;msg=7">full text</a>, <a href="bugreport.cgi?bug=746498;mbox=yes;msg=7">mbox</a>, <a href="#6">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="8"></a>
<!-- command:found -->
<!-- requester: Javier Serrano Polo &lt;javier@jasp.net&gt; -->
<!-- request_addr: control@bugs.debian.org -->
<!-- time:1398877038 -->
<!-- new_data:
$new_data = {
              &#39;found_versions&#39; =&gt; [
                                    &#39;dpkg/1.16.12&#39;,
                                    &#39;dpkg/1.15.8.13&#39;
                                  ]
            };
-->
<!-- old_data:
$old_data = {
              &#39;found_versions&#39; =&gt; [
                                    &#39;dpkg/1.15.8.13&#39;
                                  ]
            };
-->
<strong>Marked as found in versions dpkg/1.16.12.</strong>
Request was from <code>Javier Serrano Polo &lt;javier@jasp.net&gt;</code>
to <code>control@bugs.debian.org</code>.
 (Wed, 30 Apr 2014 16:57:18 GMT) (<a href="bugreport.cgi?bug=746498;msg=9">full text</a>, <a href="bugreport.cgi?bug=746498;mbox=yes;msg=9">mbox</a>, <a href="#8">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="10"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Dpkg Developers &lt;debian-dpkg@lists.debian.org&gt; -->
<!-- time:1398920225 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Dpkg Developers &lt;debian-dpkg@lists.debian.org&gt;</code>:<br>
<code>Bug#746498</code>; Package <code>dpkg</code>.
 (Thu, 01 May 2014 04:57:05 GMT) (<a href="bugreport.cgi?bug=746498;msg=11">full text</a>, <a href="bugreport.cgi?bug=746498;mbox=yes;msg=11">mbox</a>, <a href="#10">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="12"></a>
<!-- request_addr: Guillem Jover &lt;guillem@debian.org&gt; -->
<!-- time:1398920225 -->
<strong>Acknowledgement sent</strong>
to <code>Guillem Jover &lt;guillem@debian.org&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Dpkg Developers &lt;debian-dpkg@lists.debian.org&gt;</code>.
 (Thu, 01 May 2014 04:57:05 GMT) (<a href="bugreport.cgi?bug=746498;msg=13">full text</a>, <a href="bugreport.cgi?bug=746498;mbox=yes;msg=13">mbox</a>, <a href="#12">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="14"></a><a name="msg14"></a><a href="#14">Message #14</a> received at 746498@bugs.debian.org (<a href="bugreport.cgi?bug=746498;msg=14">full text</a>, <a href="bugreport.cgi?bug=746498;mbox=yes;msg=14">mbox</a>, <a href="mailto:746498@bugs.debian.org?References=%3C1398874469.18363.36.camel%40sempati.menos4%3E%0A%20%3C20140501045430.GA954%40gaara.hadrons.org%3E&amp;subject=Re%3A%20Bug%23746498%3A%20dpkg%3A%20directory%20traversal%20during%20unpack&amp;In-Reply-To=%3C20140501045430.GA954%40gaara.hadrons.org%3E&amp;body=On%20Thu%2C%201%20May%202014%2006%3A54%3A30%20%2B0200%20Guillem%20Jover%20%3Cguillem%40debian.org%3E%20wrote%3A%0A%3E%20On%20Wed%2C%202014-04-30%20at%2018%3A14%3A29%20%2B0200%2C%20Javier%20Serrano%20Polo%20wrote%3A%0A%3E%20%3E%20Package%3A%20dpkg%0A%3E%20%3E%20Version%3A%201.15.8.13%201.16.12%0A%3E%20%3E%20Tags%3A%20security%0A%3E%20%0A%3E%20%3E%20Directory%20traversal%20was%20already%20possible.%20I%20have%20suggested%20a%20solution.%0A%3E%20%3E%20That%20is%20the%20way%20I%20fixed%20it%3A%20dry%20run%2C%20let%20the%20patch%20tool%20say%20what%20files%0A%3E%20%3E%20will%20be%20touched.%20Another%20solution%20would%20be%20to%20stop%20using%20an%20external%0A%3E%20%3E%20tool.%0A%3E%20%0A%3E%20Ok%2C%20now%20I%27m%20confused%2C%20do%20you%20mean%20there%27s%20another%20security%20problem%3F%0A%3E%20And%20that%20you%27ve%20got%20a%20patch%20fixing%20it%2C%20or%20just%20that%20you%20would%20fix%20it%0A%3E%20that%20way%3F%0A%3E%20%0A%3E%20%3E%20I%20will%20wait%20two%20days%20before%20releasing%20one%20of%20the%20exploit%20packages.%0A%3E%20%0A%3E%20Didn%27t%20you%20do%20that%20before%20filing%20this%20bug%20report%20in%3A%0A%3E%20%0A%3E%20%20%20%3Chttps%3A%2F%2Fbugs.debian.org%2Fcgi-bin%2Fbugreport.cgi%3Fbug%3D746306%2361%3E%0A%3E%20%0A%3E%20%3F%0A%3E%20%0A%3E%20Thanks%2C%0A%3E%20Guillem%0A%3E%20%0A%3E%20%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=guillem%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Guillem Jover &lt;guillem@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net, 746498@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#746498: dpkg: directory traversal during unpack</div>
<div class="header"><span class="headerfield">Date:</span> Thu, 1 May 2014 06:54:30 +0200</div>
</div>
<pre class="message">On Wed, 2014-04-30 at 18:14:29 +0200, Javier Serrano Polo wrote:
&gt; Package: dpkg
&gt; Version: 1.15.8.13 1.16.12
&gt; Tags: security

&gt; Directory traversal was already possible. I have suggested a solution.
&gt; That is the way I fixed it: dry run, let the patch tool say what files
&gt; will be touched. Another solution would be to stop using an external
&gt; tool.

Ok, now I&#39;m confused, do you mean there&#39;s another security problem?
And that you&#39;ve got a patch fixing it, or just that you would fix it
that way?

&gt; I will wait two days before releasing one of the exploit packages.

Didn&#39;t you do that before filing this bug report in:

  &lt;<a href="https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=746306#61">https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=746306#61</a>&gt;

?

Thanks,
Guillem


</pre>

<div class="infmessage"><hr><p>
<a name="15"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Dpkg Developers &lt;debian-dpkg@lists.debian.org&gt; -->
<!-- time:1398922924 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Dpkg Developers &lt;debian-dpkg@lists.debian.org&gt;</code>:<br>
<code>Bug#746498</code>; Package <code>dpkg</code>.
 (Thu, 01 May 2014 05:42:04 GMT) (<a href="bugreport.cgi?bug=746498;msg=16">full text</a>, <a href="bugreport.cgi?bug=746498;mbox=yes;msg=16">mbox</a>, <a href="#15">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="17"></a>
<!-- request_addr: Guillem Jover &lt;guillem@debian.org&gt; -->
<!-- time:1398922924 -->
<strong>Acknowledgement sent</strong>
to <code>Guillem Jover &lt;guillem@debian.org&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Dpkg Developers &lt;debian-dpkg@lists.debian.org&gt;</code>.
 (Thu, 01 May 2014 05:42:04 GMT) (<a href="bugreport.cgi?bug=746498;msg=18">full text</a>, <a href="bugreport.cgi?bug=746498;mbox=yes;msg=18">mbox</a>, <a href="#17">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="19"></a><a name="msg19"></a><a href="#19">Message #19</a> received at 746498@bugs.debian.org (<a href="bugreport.cgi?bug=746498;msg=19">full text</a>, <a href="bugreport.cgi?bug=746498;mbox=yes;msg=19">mbox</a>, <a href="mailto:746498@bugs.debian.org?subject=Re%3A%20Bug%23746498%3A%20dpkg%3A%20directory%20traversal%20during%20unpack&amp;References=%3C1398874469.18363.36.camel%40sempati.menos4%3E%0A%20%3C20140501045430.GA954%40gaara.hadrons.org%3E%0A%20%3C20140501053841.GA15594%40gaara.hadrons.org%3E&amp;In-Reply-To=%3C20140501053841.GA15594%40gaara.hadrons.org%3E&amp;body=On%20Thu%2C%201%20May%202014%2007%3A38%3A41%20%2B0200%20Guillem%20Jover%20%3Cguillem%40debian.org%3E%20wrote%3A%0A%3E%20On%20Thu%2C%202014-05-01%20at%2006%3A54%3A30%20%2B0200%2C%20Guillem%20Jover%20wrote%3A%0A%3E%20%3E%20On%20Wed%2C%202014-04-30%20at%2018%3A14%3A29%20%2B0200%2C%20Javier%20Serrano%20Polo%20wrote%3A%0A%3E%20%3E%20%3E%20Package%3A%20dpkg%0A%3E%20%3E%20%3E%20Version%3A%201.15.8.13%201.16.12%0A%3E%20%3E%20%3E%20Tags%3A%20security%0A%3E%20%3E%20%0A%3E%20%3E%20%3E%20Directory%20traversal%20was%20already%20possible.%20I%20have%20suggested%20a%20solution.%0A%3E%20%3E%20%3E%20That%20is%20the%20way%20I%20fixed%20it%3A%20dry%20run%2C%20let%20the%20patch%20tool%20say%20what%20files%0A%3E%20%3E%20%3E%20will%20be%20touched.%20Another%20solution%20would%20be%20to%20stop%20using%20an%20external%0A%3E%20%3E%20%3E%20tool.%0A%3E%20%3E%20%0A%3E%20%3E%20Ok%2C%20now%20I%27m%20confused%2C%20do%20you%20mean%20there%27s%20another%20security%20problem%3F%0A%3E%20%0A%3E%20If%20so%2C%20I%27d%20appreciate%20if%20you%20could%20send%20me%20a%20PoC%20package.%0A%3E%20%0A%3E%20Thanks%2C%0A%3E%20Guillem%0A%3E%20%0A%3E%20%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=guillem%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Guillem Jover &lt;guillem@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net, 746498@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#746498: dpkg: directory traversal during unpack</div>
<div class="header"><span class="headerfield">Date:</span> Thu, 1 May 2014 07:38:41 +0200</div>
</div>
<pre class="message">On Thu, 2014-05-01 at 06:54:30 +0200, Guillem Jover wrote:
&gt; On Wed, 2014-04-30 at 18:14:29 +0200, Javier Serrano Polo wrote:
&gt; &gt; Package: dpkg
&gt; &gt; Version: 1.15.8.13 1.16.12
&gt; &gt; Tags: security
&gt; 
&gt; &gt; Directory traversal was already possible. I have suggested a solution.
&gt; &gt; That is the way I fixed it: dry run, let the patch tool say what files
&gt; &gt; will be touched. Another solution would be to stop using an external
&gt; &gt; tool.
&gt; 
&gt; Ok, now I&#39;m confused, do you mean there&#39;s another security problem?

If so, I&#39;d appreciate if you could send me a PoC package.

Thanks,
Guillem


</pre>

<div class="infmessage"><hr><p>
<a name="20"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Dpkg Developers &lt;debian-dpkg@lists.debian.org&gt; -->
<!-- time:1398989344 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Dpkg Developers &lt;debian-dpkg@lists.debian.org&gt;</code>:<br>
<code>Bug#746498</code>; Package <code>dpkg</code>.
 (Fri, 02 May 2014 00:09:04 GMT) (<a href="bugreport.cgi?bug=746498;msg=21">full text</a>, <a href="bugreport.cgi?bug=746498;mbox=yes;msg=21">mbox</a>, <a href="#20">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="22"></a>
<!-- request_addr: Guillem Jover &lt;guillem@debian.org&gt; -->
<!-- time:1398989344 -->
<strong>Acknowledgement sent</strong>
to <code>Guillem Jover &lt;guillem@debian.org&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Dpkg Developers &lt;debian-dpkg@lists.debian.org&gt;</code>.
 (Fri, 02 May 2014 00:09:04 GMT) (<a href="bugreport.cgi?bug=746498;msg=23">full text</a>, <a href="bugreport.cgi?bug=746498;mbox=yes;msg=23">mbox</a>, <a href="#22">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="24"></a><a name="msg24"></a><a href="#24">Message #24</a> received at 746498@bugs.debian.org (<a href="bugreport.cgi?bug=746498;msg=24">full text</a>, <a href="bugreport.cgi?bug=746498;mbox=yes;msg=24">mbox</a>, <a href="mailto:746498@bugs.debian.org?subject=Re%3A%20Bug%23746498%3A%20dpkg%3A%20directory%20traversal%20during%20unpack&amp;References=%3C1398874469.18363.36.camel%40sempati.menos4%3E%0A%20%3C20140501045430.GA954%40gaara.hadrons.org%3E%0A%20%3C20140501053841.GA15594%40gaara.hadrons.org%3E%0A%20%3C20140502000519.GA9549%40gaara.hadrons.org%3E&amp;In-Reply-To=%3C20140502000519.GA9549%40gaara.hadrons.org%3E&amp;body=On%20Fri%2C%202%20May%202014%2002%3A05%3A19%20%2B0200%20Guillem%20Jover%20%3Cguillem%40debian.org%3E%20wrote%3A%0A%3E%20On%20Thu%2C%202014-05-01%20at%2007%3A38%3A41%20%2B0200%2C%20Guillem%20Jover%20wrote%3A%0A%3E%20%3E%20On%20Thu%2C%202014-05-01%20at%2006%3A54%3A30%20%2B0200%2C%20Guillem%20Jover%20wrote%3A%0A%3E%20%3E%20%3E%20On%20Wed%2C%202014-04-30%20at%2018%3A14%3A29%20%2B0200%2C%20Javier%20Serrano%20Polo%20wrote%3A%0A%3E%20%3E%20%3E%20%3E%20Package%3A%20dpkg%0A%3E%20%3E%20%3E%20%3E%20Version%3A%201.15.8.13%201.16.12%0A%3E%20%3E%20%3E%20%3E%20Tags%3A%20security%0A%3E%20%3E%20%3E%20%0A%3E%20%3E%20%3E%20%3E%20Directory%20traversal%20was%20already%20possible.%20I%20have%20suggested%20a%20solution.%0A%3E%20%3E%20%3E%20%3E%20That%20is%20the%20way%20I%20fixed%20it%3A%20dry%20run%2C%20let%20the%20patch%20tool%20say%20what%20files%0A%3E%20%3E%20%3E%20%3E%20will%20be%20touched.%20Another%20solution%20would%20be%20to%20stop%20using%20an%20external%0A%3E%20%3E%20%3E%20%3E%20tool.%0A%3E%20%3E%20%3E%20%0A%3E%20%3E%20%3E%20Ok%2C%20now%20I%27m%20confused%2C%20do%20you%20mean%20there%27s%20another%20security%20problem%3F%0A%3E%20%3E%20%0A%3E%20%3E%20If%20so%2C%20I%27d%20appreciate%20if%20you%20could%20send%20me%20a%20PoC%20package.%0A%3E%20%0A%3E%20Ok%2C%20I%20decided%20to%20take%20a%20look%20just%20now%2C%20and%20I%27ve%20found%20one%20issue%2C%0A%3E%20although%20as%20I%20don%27t%20know%20if%20it%27s%20the%20same%20we%20might%20end%20up%20having%0A%3E%20to%20prepare%20multiple%20security%20updates%E2%80%A6%0A%3E%20%0A%3E%20I%27ll%20provide%20more%20details%20to%20the%20security%20team%20in%20private%2C%20and%20start%0A%3E%20preparing%20fixed%20packages%20for%20all%20suites.%0A%3E%20%0A%3E%20Thanks%2C%0A%3E%20Guillem%0A%3E%20%0A%3E%20%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=guillem%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Guillem Jover &lt;guillem@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net, 746498@bugs.debian.org</div>
<div class="header"><span class="headerfield">Cc:</span> team@security.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#746498: dpkg: directory traversal during unpack</div>
<div class="header"><span class="headerfield">Date:</span> Fri, 2 May 2014 02:05:19 +0200</div>
</div>
<pre class="message">On Thu, 2014-05-01 at 07:38:41 +0200, Guillem Jover wrote:
&gt; On Thu, 2014-05-01 at 06:54:30 +0200, Guillem Jover wrote:
&gt; &gt; On Wed, 2014-04-30 at 18:14:29 +0200, Javier Serrano Polo wrote:
&gt; &gt; &gt; Package: dpkg
&gt; &gt; &gt; Version: 1.15.8.13 1.16.12
&gt; &gt; &gt; Tags: security
&gt; &gt; 
&gt; &gt; &gt; Directory traversal was already possible. I have suggested a solution.
&gt; &gt; &gt; That is the way I fixed it: dry run, let the patch tool say what files
&gt; &gt; &gt; will be touched. Another solution would be to stop using an external
&gt; &gt; &gt; tool.
&gt; &gt; 
&gt; &gt; Ok, now I&#39;m confused, do you mean there&#39;s another security problem?
&gt; 
&gt; If so, I&#39;d appreciate if you could send me a PoC package.

Ok, I decided to take a look just now, and I&#39;ve found one issue,
although as I don&#39;t know if it&#39;s the same we might end up having
to prepare multiple security updates…

I&#39;ll provide more details to the security team in private, and start
preparing fixed packages for all suites.

Thanks,
Guillem


</pre>

<div class="infmessage"><hr><p>
<a name="25"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Dpkg Developers &lt;debian-dpkg@lists.debian.org&gt; -->
<!-- time:1399051089 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Dpkg Developers &lt;debian-dpkg@lists.debian.org&gt;</code>:<br>
<code>Bug#746498</code>; Package <code>dpkg</code>.
 (Fri, 02 May 2014 17:18:09 GMT) (<a href="bugreport.cgi?bug=746498;msg=26">full text</a>, <a href="bugreport.cgi?bug=746498;mbox=yes;msg=26">mbox</a>, <a href="#25">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="27"></a>
<!-- request_addr: javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net -->
<!-- time:1399051089 -->
<strong>Acknowledgement sent</strong>
to <code>javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Dpkg Developers &lt;debian-dpkg@lists.debian.org&gt;</code>.
 (Fri, 02 May 2014 17:18:09 GMT) (<a href="bugreport.cgi?bug=746498;msg=28">full text</a>, <a href="bugreport.cgi?bug=746498;mbox=yes;msg=28">mbox</a>, <a href="#27">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="29"></a><a name="msg29"></a><a href="#29">Message #29</a> received at 746498@bugs.debian.org (<a href="bugreport.cgi?bug=746498;msg=29">full text</a>, <a href="bugreport.cgi?bug=746498;mbox=yes;msg=29">mbox</a>, <a href="mailto:746498@bugs.debian.org?In-Reply-To=%3C1399048636.24408.3.camel%40sempati.menos4%3E&amp;References=%3C1398874469.18363.36.camel%40sempati.menos4%3E%0A%09%20%3Chandler.746498.B.139887448021223.ack%40bugs.debian.org%3E%0A%20%3C1399048636.24408.3.camel%40sempati.menos4%3E&amp;subject=Re%3A%20Bug%23746498%3A%20Acknowledgement%20%28dpkg%3A%20directory%20traversal%20during%0A%20unpack%29&amp;body=On%20Fri%2C%2002%20May%202014%2018%3A37%3A16%20%2B0200%20Javier%20Serrano%20Polo%20%3Cjavier%40jasp.net%3E%20wrote%3A%0A%3E%20Here%20it%20is%20the%20package.%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=javier%40jasp.net" alt="">
<div class="header"><span class="headerfield">From:</span> Javier Serrano Polo &lt;javier@jasp.net&gt;</div>
<div class="header"><span class="headerfield">To:</span> 746498@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#746498: Acknowledgement (dpkg: directory traversal during
 unpack)</div>
<div class="header"><span class="headerfield">Date:</span> Fri, 02 May 2014 18:37:16 +0200</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=0;bug=746498;msg=29">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message wrapping">Here it is the package.
</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=746498;filename=exploto_0.2.debian.tar.gz;msg=29">exploto_0.2.debian.tar.gz</a> (application/x-compressed-tar, attachment)]</pre>
<pre class="mime">[<a href="bugreport.cgi?att=2;bug=746498;filename=exploto_0.2.dsc;msg=29">exploto_0.2.dsc</a> (text/plain, attachment)]</pre>
<pre class="mime">[<a href="bugreport.cgi?att=3;bug=746498;filename=exploto_0.2.orig.tar.gz;msg=29">exploto_0.2.orig.tar.gz</a> (application/x-compressed-tar, attachment)]</pre>
<pre class="mime">[<a href="bugreport.cgi?att=4;bug=746498;filename=smime.p7s;msg=29">smime.p7s</a> (application/pkcs7-signature, attachment)]</pre>

<div class="infmessage"><hr><p>
<a name="30"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Dpkg Developers &lt;debian-dpkg@lists.debian.org&gt; -->
<!-- time:1399053967 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Dpkg Developers &lt;debian-dpkg@lists.debian.org&gt;</code>:<br>
<code>Bug#746498</code>; Package <code>dpkg</code>.
 (Fri, 02 May 2014 18:06:07 GMT) (<a href="bugreport.cgi?bug=746498;msg=31">full text</a>, <a href="bugreport.cgi?bug=746498;mbox=yes;msg=31">mbox</a>, <a href="#30">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="32"></a>
<!-- request_addr: Guillem Jover &lt;guillem@debian.org&gt; -->
<!-- time:1399053967 -->
<strong>Acknowledgement sent</strong>
to <code>Guillem Jover &lt;guillem@debian.org&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Dpkg Developers &lt;debian-dpkg@lists.debian.org&gt;</code>.
 (Fri, 02 May 2014 18:06:07 GMT) (<a href="bugreport.cgi?bug=746498;msg=33">full text</a>, <a href="bugreport.cgi?bug=746498;mbox=yes;msg=33">mbox</a>, <a href="#32">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="34"></a><a name="msg34"></a><a href="#34">Message #34</a> received at 746498@bugs.debian.org (<a href="bugreport.cgi?bug=746498;msg=34">full text</a>, <a href="bugreport.cgi?bug=746498;mbox=yes;msg=34">mbox</a>, <a href="mailto:746498@bugs.debian.org?body=On%20Fri%2C%202%20May%202014%2020%3A04%3A32%20%2B0200%20Guillem%20Jover%20%3Cguillem%40debian.org%3E%20wrote%3A%0A%3E%20%5B%20BTW%2C%20I%20keep%20having%20to%20check%20the%20debbugs%20web%20interface%20as%20I%27m%20not%0A%3E%20%20%20receiving%20any%20of%20your%20mails.%20%5D%0A%3E%20%0A%3E%20On%20Fri%2C%202014-05-02%20at%2018%3A37%3A16%20%2B0200%2C%20Javier%20Serrano%20Polo%20wrote%3A%0A%3E%20%3E%20Here%20it%20is%20the%20package.%0A%3E%20%0A%3E%20Ok%2C%20had%20already%20found%20and%20reported%20this%20second%20one%20to%20the%20security%0A%3E%20team%20earlier%20today.%20So%20with%20this%20and%20the%20one%20I%20found%20yesterday%2C%0A%3E%20there%27s%20nothing%20new%20here%20%28and%20there%27s%20no%20problem%20disclosing%20there%27s%0A%3E%20more%20than%20one%20issue%20now%2C%20as%20one%20is%20enough%20to%20exploit%20this%29.%0A%3E%20%0A%3E%20Thanks%2C%0A%3E%20Guillem%0A%3E%20%0A%3E%20%0A&amp;subject=Re%3A%20Bug%23746498%3A%20Acknowledgement%20%28dpkg%3A%20directory%20traversal%20during%0A%20unpack%29&amp;References=%3C1398874469.18363.36.camel%40sempati.menos4%3E%0A%20%3Chandler.746498.B.139887448021223.ack%40bugs.debian.org%3E%0A%20%3C1399048636.24408.3.camel%40sempati.menos4%3E%0A%20%3C20140502180432.GA30177%40gaara.hadrons.org%3E&amp;In-Reply-To=%3C20140502180432.GA30177%40gaara.hadrons.org%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=guillem%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Guillem Jover &lt;guillem@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net, 746498@bugs.debian.org</div>
<div class="header"><span class="headerfield">Cc:</span> team@security.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#746498: Acknowledgement (dpkg: directory traversal during
 unpack)</div>
<div class="header"><span class="headerfield">Date:</span> Fri, 2 May 2014 20:04:32 +0200</div>
</div>
<pre class="message">[ BTW, I keep having to check the debbugs web interface as I&#39;m not
  receiving any of your mails. ]

On Fri, 2014-05-02 at 18:37:16 +0200, Javier Serrano Polo wrote:
&gt; Here it is the package.

Ok, had already found and reported this second one to the security
team earlier today. So with this and the one I found yesterday,
there&#39;s nothing new here (and there&#39;s no problem disclosing there&#39;s
more than one issue now, as one is enough to exploit this).

Thanks,
Guillem


</pre>

<div class="msgreceived"><hr><p>
<a name="35"></a>
<!-- command:found -->
<!-- requester: Guillem Jover &lt;guillem@debian.org&gt; -->
<!-- request_addr: control@bugs.debian.org -->
<!-- time:1400972404 -->
<!-- new_data:
$new_data = {
              &#39;found_versions&#39; =&gt; [
                                    &#39;dpkg/1.16.12&#39;,
                                    &#39;dpkg/1.13.0&#39;,
                                    &#39;dpkg/1.15.8.13&#39;
                                  ]
            };
-->
<!-- old_data:
$old_data = {
              &#39;found_versions&#39; =&gt; [
                                    &#39;dpkg/1.16.12&#39;,
                                    &#39;dpkg/1.15.8.13&#39;
                                  ]
            };
-->
<strong>Marked as found in versions dpkg/1.13.0.</strong>
Request was from <code>Guillem Jover &lt;guillem@debian.org&gt;</code>
to <code>control@bugs.debian.org</code>.
 (Sat, 24 May 2014 23:00:04 GMT) (<a href="bugreport.cgi?bug=746498;msg=36">full text</a>, <a href="bugreport.cgi?bug=746498;mbox=yes;msg=36">mbox</a>, <a href="#35">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="37"></a>
<!-- command:package -->
<!-- requester: Guillem Jover &lt;guillem@debian.org&gt; -->
<!-- request_addr: control@bugs.debian.org -->
<!-- time:1400972764 -->
<!-- new_data:
$new_data = {
              &#39;package&#39; =&gt; &#39;dpkg-dev&#39;
            };
-->
<!-- old_data:
$old_data = {
              &#39;package&#39; =&gt; &#39;dpkg&#39;
            };
-->
<strong>Bug reassigned from package &#39;<a href="pkgreport.cgi?package=dpkg">dpkg</a>&#39; to &#39;<a href="pkgreport.cgi?package=dpkg-dev">dpkg-dev</a>&#39;.</strong>
Request was from <code>Guillem Jover &lt;guillem@debian.org&gt;</code>
to <code>control@bugs.debian.org</code>.
 (Sat, 24 May 2014 23:06:04 GMT) (<a href="bugreport.cgi?bug=746498;msg=38">full text</a>, <a href="bugreport.cgi?bug=746498;mbox=yes;msg=38">mbox</a>, <a href="#37">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="39"></a>
<!-- command:found -->
<!-- requester: Guillem Jover &lt;guillem@debian.org&gt; -->
<!-- request_addr: control@bugs.debian.org -->
<!-- time:1400972765 -->
<!-- new_data:
$new_data = {
              &#39;found_versions&#39; =&gt; []
            };
-->
<!-- old_data:
$old_data = {
              &#39;found_versions&#39; =&gt; [
                                    &#39;dpkg/1.16.12&#39;,
                                    &#39;dpkg/1.13.0&#39;,
                                    &#39;dpkg/1.15.8.13&#39;
                                  ]
            };
-->
<strong>No longer marked as found in versions dpkg/1.16.12, dpkg/1.13.0, and dpkg/1.15.8.13.</strong>
Request was from <code>Guillem Jover &lt;guillem@debian.org&gt;</code>
to <code>control@bugs.debian.org</code>.
 (Sat, 24 May 2014 23:06:05 GMT) (<a href="bugreport.cgi?bug=746498;msg=40">full text</a>, <a href="bugreport.cgi?bug=746498;mbox=yes;msg=40">mbox</a>, <a href="#39">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="41"></a>
<!-- command:title -->
<!-- requester: Guillem Jover &lt;guillem@debian.org&gt; -->
<!-- request_addr: control@bugs.debian.org -->
<!-- time:1400972766 -->
<!-- new_data:
$new_data = {
              &#39;subject&#39; =&gt; &#39;dpkg-source: Directory traversal on unpack through missing --- header line&#39;
            };
-->
<!-- old_data:
$old_data = {
              &#39;subject&#39; =&gt; &#39;dpkg: directory traversal during unpack&#39;
            };
-->
<strong>Changed Bug title to &#39;dpkg-source: Directory traversal on unpack through missing --- header line&#39; from &#39;dpkg: directory traversal during unpack&#39;</strong>
Request was from <code>Guillem Jover &lt;guillem@debian.org&gt;</code>
to <code>control@bugs.debian.org</code>.
 (Sat, 24 May 2014 23:06:06 GMT) (<a href="bugreport.cgi?bug=746498;msg=42">full text</a>, <a href="bugreport.cgi?bug=746498;mbox=yes;msg=42">mbox</a>, <a href="#41">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="43"></a>
<!-- command:found -->
<!-- requester: Guillem Jover &lt;guillem@debian.org&gt; -->
<!-- request_addr: control@bugs.debian.org -->
<!-- time:1400972947 -->
<!-- new_data:
$new_data = {
              &#39;found_versions&#39; =&gt; [
                                    &#39;1.3.0&#39;
                                  ]
            };
-->
<!-- old_data:
$old_data = {
              &#39;found_versions&#39; =&gt; []
            };
-->
<strong>Marked as found in versions 1.3.0.</strong>
Request was from <code>Guillem Jover &lt;guillem@debian.org&gt;</code>
to <code>control@bugs.debian.org</code>.
 (Sat, 24 May 2014 23:09:07 GMT) (<a href="bugreport.cgi?bug=746498;msg=44">full text</a>, <a href="bugreport.cgi?bug=746498;mbox=yes;msg=44">mbox</a>, <a href="#43">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="45"></a>
<!-- requester: Guillem Jover &lt;guillem@debian.org&gt; -->
<!-- request_addr: control@bugs.debian.org -->
<!-- time:1400973309 -->
<strong>Severity set to &#39;important&#39; from &#39;normal&#39;</strong>
Request was from <code>Guillem Jover &lt;guillem@debian.org&gt;</code>
to <code>control@bugs.debian.org</code>.
 (Sat, 24 May 2014 23:15:09 GMT) (<a href="bugreport.cgi?bug=746498;msg=46">full text</a>, <a href="bugreport.cgi?bug=746498;mbox=yes;msg=46">mbox</a>, <a href="#45">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="47"></a>
<!-- command:tag -->
<!-- requester: Guillem Jover &lt;guillem@debian.org&gt; -->
<!-- request_addr: control@bugs.debian.org -->
<!-- time:1401996969 -->
<!-- new_data:
$new_data = {
              &#39;keywords&#39; =&gt; &#39;security pending&#39;
            };
-->
<!-- old_data:
$old_data = {
              &#39;keywords&#39; =&gt; &#39;security&#39;
            };
-->
<strong>Added tag(s) pending.</strong>
Request was from <code>Guillem Jover &lt;guillem@debian.org&gt;</code>
to <code>control@bugs.debian.org</code>.
 (Thu, 05 Jun 2014 19:36:09 GMT) (<a href="bugreport.cgi?bug=746498;msg=48">full text</a>, <a href="bugreport.cgi?bug=746498;mbox=yes;msg=48">mbox</a>, <a href="#47">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="49"></a>
<!-- request_addr: javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net -->
<!-- time:1401996980 -->
<strong>Message sent on</strong>
to <code>javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net</code>:<br>
Bug#746498.
 (Thu, 05 Jun 2014 19:36:20 GMT) (<a href="bugreport.cgi?bug=746498;msg=50">full text</a>, <a href="bugreport.cgi?bug=746498;mbox=yes;msg=50">mbox</a>, <a href="#49">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="51"></a><a name="msg51"></a><a href="#51">Message #51</a> received at 746498-submitter@bugs.debian.org (<a href="bugreport.cgi?bug=746498;msg=51">full text</a>, <a href="bugreport.cgi?bug=746498;mbox=yes;msg=51">mbox</a>, <a href="mailto:746498@bugs.debian.org?In-Reply-To=%3CE1WsdPu-0004l2-GH%40moszumanska.debian.org%3E&amp;References=%3CE1WsdPu-0004l2-GH%40moszumanska.debian.org%3E&amp;subject=Re%3A%20Bug%23746498%20marked%20as%20pending&amp;body=On%20Thu%2C%2005%20Jun%202014%2019%3A33%3A38%20%2B0000%20Guillem%20Jover%20%3Cguillem%40debian.org%3E%20wrote%3A%0A%3E%20tag%20746498%20pending%0A%3E%20thanks%0A%3E%20%0A%3E%20Hello%2C%0A%3E%20%0A%3E%20Bug%20%23746498%20reported%20by%20you%20has%20been%20fixed%20in%20the%20Git%20repository.%20You%20can%0A%3E%20see%20the%20changelog%20below%2C%20and%20you%20can%20check%20the%20diff%20of%20the%20fix%20at%3A%0A%3E%20%0A%3E%20%20%20%20%20http%3A%2F%2Fgit.debian.org%2F%3Fp%3Ddpkg%2Fdpkg.git%3Ba%3Dcommitdiff%3Bh%3D5348cbc%0A%3E%20%0A%3E%20---%0A%3E%20commit%205348cbc981a65c3c9b05bb4d13553bda930c2d78%0A%3E%20Author%3A%20Guillem%20Jover%20%3Cguillem%40debian.org%3E%0A%3E%20Date%3A%20%20%20Fri%20May%202%2001%3A41%3A18%202014%20%2B0200%0A%3E%20%0A%3E%20%20%20%20%20Dpkg%3A%3ASource%3A%3APatch%3A%20Fix%20patch%20header%20parsing%20to%20avoid%20directory%20traversals%0A%3E%20%20%20%20%20%0A%3E%20%20%20%20%20The%20code%20parsing%20the%20patches%20was%20not%20taking%20into%20account%20that%20patches%0A%3E%20%20%20%20%20w%2F%20partial%20or%20no%20pathname%20headers%20are%20still%20valid%20patches%2C%20and%20that%0A%3E%20%20%20%20%20they%20can%20specify%20the%20pathname%20in%20the%20Index%3A%20pseudo-header%20or%20in%20a%0A%3E%20%20%20%20%20single%20%C2%AB%2B%2B%2B%20%C2%BB%20pathname%20header%2C%20which%20allows%20doing%20directory%20traversal%0A%3E%20%20%20%20%20when%20unpacking%20source%20packages.%0A%3E%20%20%20%20%20%0A%3E%20%20%20%20%20The%20first%20vector%20is%20due%20to%20how%20the%20Index%3A%20pseudo-header%20is%20handled%20by%0A%3E%20%20%20%20%20patch.%20Its%20value%20gets%20used%20%28on%20non-POSIX%20mode%29%20only%20when%20both%20%C2%AB%2B%2B%2B%20%C2%BB%0A%3E%20%20%20%20%20and%20%C2%AB---%20%C2%BB%20pathname%20headers%20do%20not%20provide%20a%20pathname%2C%20by%20either%20having%0A%3E%20%20%20%20%20an%20empty%20pathname%20or%20by%20the%20header%20being%20completely%20absent.%20The%20minimal%0A%3E%20%20%20%20%20fix%20for%20this%20is%20to%20just%20consider%20that%20we%27ve%20parsed%20the%20header%20when%20we%0A%3E%20%20%20%20%20see%20a%20hunk%20header%20marker%20%C2%AB%40%40%20-%C2%BB.%20This%20is%20CVE-2014-3865%20and%20%23749183.%0A%3E%20%20%20%20%20%0A%3E%20%20%20%20%20The%20other%20vector%20is%20due%20to%20patches%20with%20only%20a%20%C2%AB%2B%2B%2B%20%C2%BB%20pathname%20header%2C%0A%3E%20%20%20%20%20which%20get%20skipped%20by%20the%20parser%20as%20it%20only%20checks%20for%20%C2%AB---%20%C2%BB%20pathname%0A%3E%20%20%20%20%20header%20lines.%20The%20minimal%20fix%20for%20this%20is%20to%20also%20check%20for%20%C2%AB%2B%2B%2B%20%C2%BB%20when%0A%3E%20%20%20%20%20parsing%20the%20patch%20header.%20This%20is%20CVE-2014-3864%20and%20%23746498.%0A%3E%20%20%20%20%20%0A%3E%20%20%20%20%20The%20first%20issue%20is%20a%20superset%20of%20the%20second%2C%20and%20its%20fix%20is%20sufficient%0A%3E%20%20%20%20%20and%20covers%20and%20fixes%20too%20the%20second%20vector%2C%20as%20the%20%C2%AB%40%40%20-%C2%BB%20marker%20is%0A%3E%20%20%20%20%20mandatory%20for%20a%20patch%20to%20be%20valid.%0A%3E%20%20%20%20%20%0A%3E%20%20%20%20%20An%20unspecified%20directory%20traversal%20vulnerability%20was%20initially%20reported%0A%3E%20%20%20%20%20in%20%23746498%20by%20Javier%20Serrano%20Polo%20%3Cjavier%40jasp.net%3E%2C%20and%20while%20no%0A%3E%20%20%20%20%20information%20had%20been%20provided%2C%20I%20independently%20found%20%23749183%20and%20what%0A%3E%20%20%20%20%20was%20supposed%20to%20be%20%23746498%2C%20which%20was%20later%20on%20published.%0A%3E%20%20%20%20%20%0A%3E%20%20%20%20%20Fixes%3A%20CVE-2014-3864%2C%20CVE-2014-3865%0A%3E%20%20%20%20%20Closes%3A%20%23746498%2C%20%23749183%0A%3E%20%0A%3E%20diff%20--git%20a%2Fdebian%2Fchangelog%20b%2Fdebian%2Fchangelog%0A%3E%20index%20ba0c19f..80990a7%20100644%0A%3E%20---%20a%2Fdebian%2Fchangelog%0A%3E%20%2B%2B%2B%20b%2Fdebian%2Fchangelog%0A%3E%20%40%40%20-66%2C6%20%2B66%2C13%20%40%40%20dpkg%20%281.17.10%29%20UNRELEASED%3B%20urgency%3Dlow%0A%3E%20%20%20%20%20%20Thanks%20to%20Hleb%20Valoshka%20%3C375gnu%40gmail.com%3E.%0A%3E%20%20%20%20%2A%20Add%20support%20for%20DragonFlyBSD%20to%20start-stop-daemon.%20Closes%3A%20%23734452%0A%3E%20%20%20%20%20%20Based%20on%20a%20patch%20by%20Hleb%20Valoshka%20%3C375gnu%40gmail.com%3E.%0A%3E%20%2B%20%20%2A%20Correctly%20parse%20patch%20headers%20in%20Dpkg%3A%3ASource%3A%3APatch%2C%20to%20avoid%20directory%0A%3E%20%2B%20%20%20%20traversal%20attempts%20from%20hostile%20source%20packages%20when%20unpacking%20them.%0A%3E%20%2B%20%20%20%20Reported%20by%20Javier%20Serrano%20Polo%20%3Cjavier%40jasp.net%3E%20as%20an%20unspecified%0A%3E%20%2B%20%20%20%20directory%20traversal%3B%20meanwhile%20also%20independently%20found%20by%20me%20both%0A%3E%20%2B%20%20%20%20%23749183%20and%20what%20was%20supposed%20to%20be%20%23746498%2C%20which%20was%20later%20on%20published%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=guillem%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Guillem Jover &lt;guillem@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> 746498-submitter@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Bug#746498 marked as pending</div>
<div class="header"><span class="headerfield">Date:</span> Thu, 05 Jun 2014 19:33:38 +0000</div>
</div>
<pre class="message">tag 746498 pending
thanks

Hello,

Bug #746498 reported by you has been fixed in the Git repository. You can
see the changelog below, and you can check the diff of the fix at:

    <a href="http://git.debian.org/?p=dpkg/dpkg.git;a=commitdiff;h=5348cbc">http://git.debian.org/?p=dpkg/dpkg.git;a=commitdiff;h=5348cbc</a>

---
commit 5348cbc981a65c3c9b05bb4d13553bda930c2d78
Author: Guillem Jover &lt;guillem@debian.org&gt;
Date:   Fri May 2 01:41:18 2014 +0200

    Dpkg::Source::Patch: Fix patch header parsing to avoid directory traversals
    
    The code parsing the patches was not taking into account that patches
    w/ partial or no pathname headers are still valid patches, and that
    they can specify the pathname in the Index: pseudo-header or in a
    single «+++ » pathname header, which allows doing directory traversal
    when unpacking source packages.
    
    The first vector is due to how the Index: pseudo-header is handled by
    patch. Its value gets used (on non-POSIX mode) only when both «+++ »
    and «--- » pathname headers do not provide a pathname, by either having
    an empty pathname or by the header being completely absent. The minimal
    fix for this is to just consider that we&#39;ve parsed the header when we
    see a hunk header marker «@@ -». This is <a href="https://security-tracker.debian.org/tracker/CVE-2014-3865">CVE-2014-3865</a> and #749183.
    
    The other vector is due to patches with only a «+++ » pathname header,
    which get skipped by the parser as it only checks for «--- » pathname
    header lines. The minimal fix for this is to also check for «+++ » when
    parsing the patch header. This is <a href="https://security-tracker.debian.org/tracker/CVE-2014-3864">CVE-2014-3864</a> and #746498.
    
    The first issue is a superset of the second, and its fix is sufficient
    and covers and fixes too the second vector, as the «@@ -» marker is
    mandatory for a patch to be valid.
    
    An unspecified directory traversal vulnerability was initially reported
    in #746498 by Javier Serrano Polo &lt;javier@jasp.net&gt;, and while no
    information had been provided, I independently found #749183 and what
    was supposed to be #746498, which was later on published.
    
    Fixes: <a href="https://security-tracker.debian.org/tracker/CVE-2014-3864">CVE-2014-3864</a>, <a href="https://security-tracker.debian.org/tracker/CVE-2014-3865">CVE-2014-3865</a>
    Closes: #<a href="bugreport.cgi?bug=746498">746498</a>, #<a href="bugreport.cgi?bug=749183">749183</a>

diff --git a/debian/changelog b/debian/changelog
index ba0c19f..80990a7 100644
--- a/debian/changelog
+++ b/debian/changelog
@@ -66,6 +66,13 @@ dpkg (1.17.10) UNRELEASED; urgency=low
     Thanks to Hleb Valoshka &lt;375gnu@gmail.com&gt;.
   * Add support for DragonFlyBSD to start-stop-daemon. Closes: #<a href="bugreport.cgi?bug=734452">734452</a>
     Based on a patch by Hleb Valoshka &lt;375gnu@gmail.com&gt;.
+  * Correctly parse patch headers in Dpkg::Source::Patch, to avoid directory
+    traversal attempts from hostile source packages when unpacking them.
+    Reported by Javier Serrano Polo &lt;javier@jasp.net&gt; as an unspecified
+    directory traversal; meanwhile also independently found by me both
+    #749183 and what was supposed to be #746498, which was later on published
+    and ended up being just a subset of the other non-reported issue.
+    Fixes <a href="https://security-tracker.debian.org/tracker/CVE-2014-3864">CVE-2014-3864</a> and <a href="https://security-tracker.debian.org/tracker/CVE-2014-3865">CVE-2014-3865</a>. Closes: #<a href="bugreport.cgi?bug=746498">746498</a>, #<a href="bugreport.cgi?bug=749183">749183</a>
 
   [ Updated programs translations ]
   * Catalan (Guillem Jover).


</pre>

<div class="msgreceived"><hr><p>
<a name="52"></a>
<!-- request_addr: Guillem Jover &lt;guillem@debian.org&gt; -->
<!-- time:1401997885 -->
<strong>Reply sent</strong>
to <code>Guillem Jover &lt;guillem@debian.org&gt;</code>:<br>
You have taken responsibility.
 (Thu, 05 Jun 2014 19:51:25 GMT) (<a href="bugreport.cgi?bug=746498;msg=53">full text</a>, <a href="bugreport.cgi?bug=746498;mbox=yes;msg=53">mbox</a>, <a href="#52">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="54"></a>
<!-- request_addr: javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net -->
<!-- time:1401997885 -->
<strong>Notification sent</strong>
to <code>javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net</code>:<br>
Bug acknowledged by developer.
 (Thu, 05 Jun 2014 19:51:25 GMT) (<a href="bugreport.cgi?bug=746498;msg=55">full text</a>, <a href="bugreport.cgi?bug=746498;mbox=yes;msg=55">mbox</a>, <a href="#54">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="56"></a><a name="msg56"></a><a href="#56">Message #56</a> received at 746498-close@bugs.debian.org (<a href="bugreport.cgi?bug=746498;msg=56">full text</a>, <a href="bugreport.cgi?bug=746498;mbox=yes;msg=56">mbox</a>, <a href="mailto:746498@bugs.debian.org?References=%3CE1WsdeT-0003O4-Jh%40franck.debian.org%3E&amp;subject=Re%3A%20Bug%23746498%3A%20fixed%20in%20dpkg%201.17.10&amp;In-Reply-To=%3CE1WsdeT-0003O4-Jh%40franck.debian.org%3E&amp;body=On%20Thu%2C%2005%20Jun%202014%2019%3A48%3A41%20%2B0000%20Guillem%20Jover%20%3Cguillem%40debian.org%3E%20wrote%3A%0A%3E%20Source%3A%20dpkg%0A%3E%20Source-Version%3A%201.17.10%0A%3E%20%0A%3E%20We%20believe%20that%20the%20bug%20you%20reported%20is%20fixed%20in%20the%20latest%20version%20of%0A%3E%20dpkg%2C%20which%20is%20due%20to%20be%20installed%20in%20the%20Debian%20FTP%20archive.%0A%3E%20%0A%3E%20A%20summary%20of%20the%20changes%20between%20this%20version%20and%20the%20previous%20one%20is%0A%3E%20attached.%0A%3E%20%0A%3E%20Thank%20you%20for%20reporting%20the%20bug%2C%20which%20will%20now%20be%20closed.%20%20If%20you%0A%3E%20have%20further%20comments%20please%20address%20them%20to%20746498%40bugs.debian.org%2C%0A%3E%20and%20the%20maintainer%20will%20reopen%20the%20bug%20report%20if%20appropriate.%0A%3E%20%0A%3E%20Debian%20distribution%20maintenance%20software%0A%3E%20pp.%0A%3E%20Guillem%20Jover%20%3Cguillem%40debian.org%3E%20%28supplier%20of%20updated%20dpkg%20package%29%0A%3E%20%0A%3E%20%28This%20message%20was%20generated%20automatically%20at%20their%20request%3B%20if%20you%0A%3E%20believe%20that%20there%20is%20a%20problem%20with%20it%20please%20contact%20the%20archive%0A%3E%20administrators%20by%20mailing%20ftpmaster%40ftp-master.debian.org%29%0A%3E%20%0A%3E%20%0A%3E%20-----BEGIN%20PGP%20SIGNED%20MESSAGE-----%0A%3E%20Hash%3A%20SHA256%0A%3E%20%0A%3E%20Format%3A%201.8%0A%3E%20Date%3A%20Thu%2C%2005%20Jun%202014%2020%3A18%3A04%20%2B0200%0A%3E%20Source%3A%20dpkg%0A%3E%20Binary%3A%20libdpkg-dev%20dpkg%20dpkg-dev%20libdpkg-perl%20dselect%0A%3E%20Architecture%3A%20source%20amd64%20all%0A%3E%20Version%3A%201.17.10%0A%3E%20Distribution%3A%20unstable%0A%3E%20Urgency%3A%20medium%0A%3E%20Maintainer%3A%20Dpkg%20Developers%20%3Cdebian-dpkg%40lists.debian.org%3E%0A%3E%20Changed-By%3A%20Guillem%20Jover%20%3Cguillem%40debian.org%3E%0A%3E%20Description%3A%20%0A%3E%20%20dpkg%20%20%20%20%20%20%20-%20Debian%20package%20management%20system%0A%3E%20%20dpkg-dev%20%20%20-%20Debian%20package%20development%20tools%0A%3E%20%20dselect%20%20%20%20-%20Debian%20package%20management%20front-end%0A%3E%20%20libdpkg-dev%20-%20Debian%20package%20management%20static%20library%0A%3E%20%20libdpkg-perl%20-%20Dpkg%20perl%20modules%0A%3E%20Closes%3A%20584233%20731530%20734452%20746122%20746498%20746973%20747148%20747370%20748012%20748544%20749044%20749183%20750105%0A%3E%20Changes%3A%20%0A%3E%20%20dpkg%20%281.17.10%29%20unstable%3B%20urgency%3Dmedium%0A%3E%20%20.%0A%3E%20%20%20%20%5B%20Guillem%20Jover%20%5D%0A%3E%20%20%20%20%2A%20Use%20libtool%20to%20build%20the%20static%20libraries%2C%20which%20makes%20it%20possible%20to%0A%3E%20%20%20%20%20%20embed%20libcompat%20inside%20libdpkg%2C%20as%20required%20by%20some%20external%20programs%0A%3E%20%20%20%20%20%20linking%20against%20the%20latter.%20Closes%3A%20%23746122%0A%3E%20%20%20%20%2A%20Fix%20word%20wrapping%20logic%20in%20dselect.%20Regression%20introduced%20in%20dpkg%201.17.3.%0A%3E%20%20%20%20%2A%20Fix%20possible%20out%20of%20bounds%20buffer%20read%20access%20in%20the%20error%20output%20on%0A%3E%20%20%20%20%20%20bogus%20ar%20member%20sizes.%0A%3E%20%20%20%20%2A%20Fix%20memory%20leaks%20in%20buffer_copy%28%29%20on%20error%20conditions.%0A%3E%20%20%20%20%2A%20Test%20suite%3A%0A%3E%20%20%20%20%20%20-%20Improve%20C%20code%20coverage.%0A%3E%20%20%20%20%20%20-%20Add%20template%20test%20cases%20for%20most%20perl%20modules.%0A%3E%20%20%20%20%20%20-%20Add%20test%20cases%20for%20Dpkg%3A%3ADeps%20OR%20relationships.%0A%3E%20%20%20%20%20%20-%20Add%20minimal%20test%20case%20for%20Dpkg%3A%3ASource%3A%3AQuilt.%0A%3E%20%20%20%20%20%20-%20Add%20test%20cases%20for%20Dpkg%3A%3ASource%3A%3APatch%20CVE-2014-0471%20and%20CVE-2014-3127.%0A%3E%20%20%20%20%20%20-%20Add%20test%20case%20for%20patch%20disabling%20hunks%3B%20not%20security%20sensitive.%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=guillem%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Guillem Jover &lt;guillem@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> 746498-close@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Bug#746498: fixed in dpkg 1.17.10</div>
<div class="header"><span class="headerfield">Date:</span> Thu, 05 Jun 2014 19:48:41 +0000</div>
</div>
<pre class="message">Source: dpkg
Source-Version: 1.17.10

We believe that the bug you reported is fixed in the latest version of
dpkg, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 746498@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Guillem Jover &lt;guillem@debian.org&gt; (supplier of updated dpkg package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Format: 1.8
Date: Thu, 05 Jun 2014 20:18:04 +0200
Source: dpkg
Binary: libdpkg-dev dpkg dpkg-dev libdpkg-perl dselect
Architecture: source amd64 all
Version: 1.17.10
Distribution: unstable
Urgency: medium
Maintainer: Dpkg Developers &lt;debian-dpkg@lists.debian.org&gt;
Changed-By: Guillem Jover &lt;guillem@debian.org&gt;
Description: 
 dpkg       - Debian package management system
 dpkg-dev   - Debian package development tools
 dselect    - Debian package management front-end
 libdpkg-dev - Debian package management static library
 libdpkg-perl - Dpkg perl modules
Closes: <a href="bugreport.cgi?bug=584233">584233</a> <a href="bugreport.cgi?bug=731530">731530</a> <a href="bugreport.cgi?bug=734452">734452</a> <a href="bugreport.cgi?bug=746122">746122</a> <a href="bugreport.cgi?bug=746498">746498</a> <a href="bugreport.cgi?bug=746973">746973</a> <a href="bugreport.cgi?bug=747148">747148</a> <a href="bugreport.cgi?bug=747370">747370</a> <a href="bugreport.cgi?bug=748012">748012</a> <a href="bugreport.cgi?bug=748544">748544</a> <a href="bugreport.cgi?bug=749044">749044</a> <a href="bugreport.cgi?bug=749183">749183</a> <a href="bugreport.cgi?bug=750105">750105</a>
Changes: 
 dpkg (1.17.10) unstable; urgency=medium
 .
   [ Guillem Jover ]
   * Use libtool to build the static libraries, which makes it possible to
     embed libcompat inside libdpkg, as required by some external programs
     linking against the latter. Closes: #<a href="bugreport.cgi?bug=746122">746122</a>
   * Fix word wrapping logic in dselect. Regression introduced in dpkg 1.17.3.
   * Fix possible out of bounds buffer read access in the error output on
     bogus ar member sizes.
   * Fix memory leaks in buffer_copy() on error conditions.
   * Test suite:
     - Improve C code coverage.
     - Add template test cases for most perl modules.
     - Add test cases for Dpkg::Deps OR relationships.
     - Add minimal test case for Dpkg::Source::Quilt.
     - Add test cases for Dpkg::Source::Patch <a href="https://security-tracker.debian.org/tracker/CVE-2014-0471">CVE-2014-0471</a> and <a href="https://security-tracker.debian.org/tracker/CVE-2014-3127">CVE-2014-3127</a>.
     - Add test case for patch disabling hunks; not security sensitive.
   * Fix non-security sensitive TOCTOU race in triggers database loading.
   * Fix non-security sensitive TOCTOU race in update-alternative alternative
     database loading.
   * Fix non-security sensitive TOCTOU race in update-alternative rename code.
   * Add a workaround to start-stop-daemon for bogus OpenVZ Linux kernels that
     prepend, instead of appending, the &quot; (deleted)&quot; marker in /proc/PID/exe.
     Closes: #<a href="bugreport.cgi?bug=731530">731530</a>
   * Move dpkg-architecture -L argument to the Commands --help output section.
   * Make dpkg-maintscript-helper print only once that we are moving a
     conffile, and not on every interim state transition. Closes: #<a href="bugreport.cgi?bug=747370">747370</a>
   * Do not use global match variables in perl code.
   * Man pages:
     - Attempt to clarify and improve wording of some strange or confused
       constructs. Reported by Helge Kreutzmann.
     - Expand Vcs-* field names into each supported field name in
       deb-src-control(5) to make it easier to search for them.
     - Change control.tar.gz reference to simply control.tar in deb(5).
     - Document in dpkg-deb(1) -Z option that bzip2 and lzma are deprecated.
     - Add notes in dpkg-gensymbols(1) about symbol backward-compatibility.
       Based on a patch by Bernhard R. Link &lt;brlink@debian.org&gt;.
       Closes: #<a href="bugreport.cgi?bug=746973">746973</a>
     - Document that dpkg-buildpackage(1) -j argument is optional.
     - Add current and deprecated media types to deb(5).
     - Document in dpkg(1) that --audit now does more than just searching for
       partially installed packages.
   * Add support for automatic parallel job selection in dpkg-buildpackage,
     matching currently active processors, when using -jauto. Closes: #<a href="bugreport.cgi?bug=748012">748012</a>
   * Perl modules:
     - Bump $VERSION for Dpkg::Patch, missed in 1.16.1.
     - Bump $VERSION for Dpkg::Deps, missed in 1.17.0.
     - Update and fix CHANGES POD sections for public modules.
     - Add missing Dpkg::Deps::Multiple profile_is_concerned() and
       reduce_profiles() methods, inherited by Dpkg::Deps::Union,
       Dpkg::Deps::AND and Dpkg::Deps::OR.
   * Do not mangle quilt series files with a missing newline on the last line.
     Closes: #<a href="bugreport.cgi?bug=584233">584233</a>
   * Quiesce tar warnings in cron job by redirecting stderr to /dev/null, as
     it seems --warning=none does not work correctly. Closes: #<a href="bugreport.cgi?bug=748544">748544</a>
   * Do not emit a trailing space from Dpkg::Control::Hash on a field&#39;s empty
     first line. Bump dpkg-dev Breaks on devscripts to 2.14.4, as previous
     versions expect a trailing space from dpkg-parsechangelog output.
     Based on a patch by Johannes Schauer &lt;j.schauer@email.de&gt;. Closes: #<a href="bugreport.cgi?bug=749044">749044</a>
   * Do not assume that sensible-editor is present on «dpkg-source --commit»,
     as that command is very Debian specific. Fallback to try VISUAL, EDITOR,
     or vi, if the previous commands are either unset or not found.
   * Use badusage() instead of ohshit() on dpkg --ignore-depends argument
     parsing errors.
   * Add per package dpkg --audit support.
   * Add support for DragonFlyBSD to ostable and triplettable.
     Thanks to Hleb Valoshka &lt;375gnu@gmail.com&gt;.
   * Add support for DragonFlyBSD to start-stop-daemon. Closes: #<a href="bugreport.cgi?bug=734452">734452</a>
     Based on a patch by Hleb Valoshka &lt;375gnu@gmail.com&gt;.
   * Correctly parse patch headers in Dpkg::Source::Patch, to avoid directory
     traversal attempts from hostile source packages when unpacking them.
     Reported by Javier Serrano Polo &lt;javier@jasp.net&gt; as an unspecified
     directory traversal; meanwhile also independently found by me both
     #749183 and what was supposed to be #746498, which was later on published
     and ended up being just a subset of the other non-reported issue.
     Fixes <a href="https://security-tracker.debian.org/tracker/CVE-2014-3864">CVE-2014-3864</a> and <a href="https://security-tracker.debian.org/tracker/CVE-2014-3865">CVE-2014-3865</a>. Closes: #<a href="bugreport.cgi?bug=746498">746498</a>, #<a href="bugreport.cgi?bug=749183">749183</a>
 .
   [ Updated programs translations ]
   * Catalan (Guillem Jover).
   * Italian (Milo Casagrande). Closes: #<a href="bugreport.cgi?bug=750105">750105</a>
 .
   [ Updated scripts translations ]
   * German (Helge Kreutzmann).
 .
   [ Updated manpages translations ]
   * German (Helge Kreutzmann).
 .
   [ Raphaël Hertzog ]
   * Let dpkg-source unpack additional tarballs in a deterministic order.
     Thanks to Samuel Bronson for the report. Closes: #<a href="bugreport.cgi?bug=747148">747148</a>
Checksums-Sha1: 
 c91e1e1bb0dc5918f20e3874c4b371425dac0da3 2055 dpkg_1.17.10.dsc
 2d88ef04db662d046fadb005bb31667fc0ba64de 4198340 dpkg_1.17.10.tar.xz
 be325d2d7fac12f031e537b5ed269724542f118c 799530 libdpkg-dev_1.17.10_amd64.deb
 ab90f4afdca78f0a5b8cf359b6c1c31c8c3f9e66 2704088 dpkg_1.17.10_amd64.deb
 6e9d00f6e0e8155085c619090292a548373842c5 1059422 dselect_1.17.10_amd64.deb
 8c56a5720faf36231f2ce88c271d34941bb4d61b 1425374 dpkg-dev_1.17.10_all.deb
 6bbd6bddfe2a6af99cfbf547e5de9abbb48d7a81 974696 libdpkg-perl_1.17.10_all.deb
Checksums-Sha256: 
 8552763122f36a4ede1e040dee28a84202de9f4b65dbcc90e2c068101d2a599d 2055 dpkg_1.17.10.dsc
 a3a6d4da2b99484c04b2aa8af83d59d87a988baea627d276308467b22310b4d9 4198340 dpkg_1.17.10.tar.xz
 a6b8ed0b95af7748ee3daf9e297c94bb0ab166d7908bbc46e2f5ef5ab93c08b1 799530 libdpkg-dev_1.17.10_amd64.deb
 81a2e6111e825e8a01caa8bf2c8876d806fe9e7297deea0eb61e5a9d93c9a82c 2704088 dpkg_1.17.10_amd64.deb
 1a8a3924786f18c9e0432b8cb34c8c99576dd96221fab9cda2a0f3b5b7606d51 1059422 dselect_1.17.10_amd64.deb
 ba58996d596f73a312b9d92bf01f40f2eeac1ba6db4011875bfbd685371c9619 1425374 dpkg-dev_1.17.10_all.deb
 702028918cfda7e1eaf7391717818b2e6dd05b00b02e4091ea084791e8308234 974696 libdpkg-perl_1.17.10_all.deb
Files: 
 7c8852829f4caa99b6c3a232915ac28c 799530 libdevel optional libdpkg-dev_1.17.10_amd64.deb
 90ba5aa300a72a9a54eeda5990b2641f 2704088 admin required dpkg_1.17.10_amd64.deb
 b6f581a13931bfedde3719dc4340b476 1059422 admin optional dselect_1.17.10_amd64.deb
 405cccbb6024ecb98fa6fc8939365cbc 1425374 utils optional dpkg-dev_1.17.10_all.deb
 be5fa2aa735a59ec34d1e4c889c6b7d4 974696 perl optional libdpkg-perl_1.17.10_all.deb
 274a6b2892d179ed04ad916dd2103676 2055 admin required dpkg_1.17.10.dsc
 545f3cbac8b5f0b3d888574f3f79936c 4198340 admin required dpkg_1.17.10.tar.xz

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.22 (GNU/Linux)

iQIcBAEBCAAGBQJTkMS1AAoJELlyvz6krlejNxcP+wT/0vQECEQh1CI3DIS9aPYE
FfvmpoHioGn8dE8Su318SeZy+IADIis9IeE6GytqwMGIIekh6tC4ES574GRuLiRc
Edy4IrAlLnrGfM5VbAh5f1F9vmgZkBy2Z8R/oRjnQthgy5SUbGe1Bx9jqbh2sR4k
94EsdCuAxTiDI9+O15prM2u3Vxe7TD4Z7n9kjD3Tj35THVp6okpj1qGbTQ9bQJ04
nIcaWtZf6NXxyTNvXJ9Ac8Cdv47q1/CB4yXNQf47v0U6Rjorvh3EHkWyEtVpP1Ps
JVprxVwuxb9ayYn5j2MeBcMWS3igyowsh9a23+lZCwz0SALChZMHeYV74TB1/b8p
Gc53g6jSjI6bKK5xy5hst7tcG/ALmY0HE+jpkgVK/EJPwGKYq1julwgjd6kmrHA+
MBGs3p5ZTbR2PmzLYAmyzD2Ctabz7dFHZpMJ0c3pPsrGLUYD89gSZqp2k4zmrPIp
EEkhJNCsUFJbnG0ZpEw5aYCCHgPcKWazvsGh/DgYYytrWatJkmzgZi4I8KW+jEYG
85volBskw5V6aqJWJ9Sum/W2A11iR3El46YKqfqqSI83D2ucLWE5eXaMF3o5x+LP
AJ/XshrbiouHSu4GKiH/N7WGbD9OSYpnU/fdNbtiw+GNUC5KfsztDFWUWmiX4JP1
XzNrK95rGu/atNhtRghC
=d8BF
-----END PGP SIGNATURE-----



</pre>

<div class="msgreceived"><hr><p>
<a name="57"></a>
<!-- command:tag -->
<!-- requester: Guillem Jover &lt;guillem@debian.org&gt; -->
<!-- request_addr: control@bugs.debian.org -->
<!-- time:1402005424 -->
<!-- new_data:
$new_data = {
              &#39;keywords&#39; =&gt; &#39;security pending&#39;
            };
-->
<!-- old_data:
$old_data = {
              &#39;keywords&#39; =&gt; &#39;security&#39;
            };
-->
<strong>Added tag(s) pending.</strong>
Request was from <code>Guillem Jover &lt;guillem@debian.org&gt;</code>
to <code>control@bugs.debian.org</code>.
 (Thu, 05 Jun 2014 21:57:04 GMT) (<a href="bugreport.cgi?bug=746498;msg=58">full text</a>, <a href="bugreport.cgi?bug=746498;mbox=yes;msg=58">mbox</a>, <a href="#57">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="59"></a>
<!-- request_addr: javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net -->
<!-- time:1402005439 -->
<strong>Message sent on</strong>
to <code>javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net</code>:<br>
Bug#746498.
 (Thu, 05 Jun 2014 21:57:19 GMT) (<a href="bugreport.cgi?bug=746498;msg=60">full text</a>, <a href="bugreport.cgi?bug=746498;mbox=yes;msg=60">mbox</a>, <a href="#59">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="61"></a><a name="msg61"></a><a href="#61">Message #61</a> received at 746498-submitter@bugs.debian.org (<a href="bugreport.cgi?bug=746498;msg=61">full text</a>, <a href="bugreport.cgi?bug=746498;mbox=yes;msg=61">mbox</a>, <a href="mailto:746498@bugs.debian.org?body=On%20Thu%2C%2005%20Jun%202014%2021%3A54%3A14%20%2B0000%20Guillem%20Jover%20%3Cguillem%40debian.org%3E%20wrote%3A%0A%3E%20tag%20746498%20pending%0A%3E%20thanks%0A%3E%20%0A%3E%20Hello%2C%0A%3E%20%0A%3E%20Bug%20%23746498%20reported%20by%20you%20has%20been%20fixed%20in%20the%20Git%20repository.%20You%20can%0A%3E%20see%20the%20changelog%20below%2C%20and%20you%20can%20check%20the%20diff%20of%20the%20fix%20at%3A%0A%3E%20%0A%3E%20%20%20%20%20http%3A%2F%2Fgit.debian.org%2F%3Fp%3Ddpkg%2Fdpkg.git%3Ba%3Dcommitdiff%3Bh%3D7095952%0A%3E%20%0A%3E%20---%0A%3E%20commit%20709595277b09eec1b4fc4b783a25d0dc02823ff1%0A%3E%20Author%3A%20Guillem%20Jover%20%3Cguillem%40debian.org%3E%0A%3E%20Date%3A%20%20%20Fri%20May%202%2001%3A41%3A18%202014%20%2B0200%0A%3E%20%0A%3E%20%20%20%20%20Dpkg%3A%3ASource%3A%3APatch%3A%20Fix%20patch%20header%20parsing%20to%20avoid%20directory%20traversals%0A%3E%20%20%20%20%20%0A%3E%20%20%20%20%20Cherry%20picked%20from%20commit%205348cbc981a65c3c9b05bb4d13553bda930c2d78.%0A%3E%20%20%20%20%20%0A%3E%20%20%20%20%20The%20code%20parsing%20the%20patches%20was%20not%20taking%20into%20account%20that%20patches%0A%3E%20%20%20%20%20w%2F%20partial%20or%20no%20pathname%20headers%20are%20still%20valid%20patches%2C%20and%20that%0A%3E%20%20%20%20%20they%20can%20specify%20the%20pathname%20in%20the%20Index%3A%20pseudo-header%20or%20in%20a%0A%3E%20%20%20%20%20single%20%C2%AB%2B%2B%2B%20%C2%BB%20pathname%20header%2C%20which%20allows%20doing%20directory%20traversal%0A%3E%20%20%20%20%20when%20unpacking%20source%20packages.%0A%3E%20%20%20%20%20%0A%3E%20%20%20%20%20The%20first%20vector%20is%20due%20to%20how%20the%20Index%3A%20pseudo-header%20is%20handled%20by%0A%3E%20%20%20%20%20patch.%20Its%20value%20gets%20used%20%28on%20non-POSIX%20mode%29%20only%20when%20both%20%C2%AB%2B%2B%2B%20%C2%BB%0A%3E%20%20%20%20%20and%20%C2%AB---%20%C2%BB%20pathname%20headers%20do%20not%20provide%20a%20pathname%2C%20by%20either%20having%0A%3E%20%20%20%20%20an%20empty%20pathname%20or%20by%20the%20header%20being%20completely%20absent.%20The%20minimal%0A%3E%20%20%20%20%20fix%20for%20this%20is%20to%20just%20consider%20that%20we%27ve%20parsed%20the%20header%20when%20we%0A%3E%20%20%20%20%20see%20a%20hunk%20header%20marker%20%C2%AB%40%40%20-%C2%BB.%20This%20is%20CVE-2014-3865%20and%20%23749183.%0A%3E%20%20%20%20%20%0A%3E%20%20%20%20%20The%20other%20vector%20is%20due%20to%20patches%20with%20only%20a%20%C2%AB%2B%2B%2B%20%C2%BB%20pathname%20header%2C%0A%3E%20%20%20%20%20which%20get%20skipped%20by%20the%20parser%20as%20it%20only%20checks%20for%20%C2%AB---%20%C2%BB%20pathname%0A%3E%20%20%20%20%20header%20lines.%20The%20minimal%20fix%20for%20this%20is%20to%20also%20check%20for%20%C2%AB%2B%2B%2B%20%C2%BB%20when%0A%3E%20%20%20%20%20parsing%20the%20patch%20header.%20This%20is%20CVE-2014-3864%20and%20%23746498.%0A%3E%20%20%20%20%20%0A%3E%20%20%20%20%20The%20first%20issue%20is%20a%20superset%20of%20the%20second%2C%20and%20its%20fix%20is%20sufficient%0A%3E%20%20%20%20%20and%20covers%20and%20fixes%20too%20the%20second%20vector%2C%20as%20the%20%C2%AB%40%40%20-%C2%BB%20marker%20is%0A%3E%20%20%20%20%20mandatory%20for%20a%20patch%20to%20be%20valid.%0A%3E%20%20%20%20%20%0A%3E%20%20%20%20%20An%20unspecified%20directory%20traversal%20vulnerability%20was%20initially%20reported%0A%3E%20%20%20%20%20in%20%23746498%20by%20Javier%20Serrano%20Polo%20%3Cjavier%40jasp.net%3E%2C%20and%20while%20no%0A%3E%20%20%20%20%20information%20had%20been%20provided%2C%20I%20independently%20found%20%23749183%20and%20what%0A%3E%20%20%20%20%20was%20supposed%20to%20be%20%23746498%2C%20which%20was%20later%20on%20published.%0A%3E%20%20%20%20%20%0A%3E%20%20%20%20%20Fixes%3A%20CVE-2014-3864%2C%20CVE-2014-3865%0A%3E%20%20%20%20%20Closes%3A%20%23746498%2C%20%23749183%0A%3E%20%0A%3E%20diff%20--git%20a%2Fdebian%2Fchangelog%20b%2Fdebian%2Fchangelog%0A%3E%20index%20cbbbf8d..94e53ab%20100644%0A%3E%20---%20a%2Fdebian%2Fchangelog%0A%3E%20%2B%2B%2B%20b%2Fdebian%2Fchangelog%0A%3E%20%40%40%20-3%2C6%20%2B3%2C13%20%40%40%20dpkg%20%281.16.15%29%20UNRELEASED%3B%20urgency%3Dlow%0A%3E%20%20%20%20%5B%20Guillem%20Jover%20%5D%0A%3E%20%20%20%20%2A%20Test%20suite%3A%0A%3E%20%20%20%20%20%20-%20Add%20test%20cases%20for%20Dpkg%3A%3ASource%3A%3APatch%20CVE-2014-0471%20and%20CVE-2014-3127.%0A%3E%20%2B%20%20%2A%20Correctly%20parse%20patch%20headers%20in%20Dpkg%3A%3ASource%3A%3APatch%2C%20to%20avoid%20directory%0A%3E%20%2B%20%20%20%20traversal%20attempts%20from%20hostile%20source%20packages%20when%20unpacking%20them.%0A%3E%20%2B%20%20%20%20Reported%20by%20Javier%20Serrano%20Polo%20%3Cjavier%40jasp.net%3E%20as%20an%20unspecified%0A&amp;In-Reply-To=%3CE1Wsfby-00075Q-28%40moszumanska.debian.org%3E&amp;subject=Re%3A%20Bug%23746498%20marked%20as%20pending&amp;References=%3CE1Wsfby-00075Q-28%40moszumanska.debian.org%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=guillem%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Guillem Jover &lt;guillem@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> 746498-submitter@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Bug#746498 marked as pending</div>
<div class="header"><span class="headerfield">Date:</span> Thu, 05 Jun 2014 21:54:14 +0000</div>
</div>
<pre class="message">tag 746498 pending
thanks

Hello,

Bug #746498 reported by you has been fixed in the Git repository. You can
see the changelog below, and you can check the diff of the fix at:

    <a href="http://git.debian.org/?p=dpkg/dpkg.git;a=commitdiff;h=7095952">http://git.debian.org/?p=dpkg/dpkg.git;a=commitdiff;h=7095952</a>

---
commit 709595277b09eec1b4fc4b783a25d0dc02823ff1
Author: Guillem Jover &lt;guillem@debian.org&gt;
Date:   Fri May 2 01:41:18 2014 +0200

    Dpkg::Source::Patch: Fix patch header parsing to avoid directory traversals
    
    Cherry picked from commit 5348cbc981a65c3c9b05bb4d13553bda930c2d78.
    
    The code parsing the patches was not taking into account that patches
    w/ partial or no pathname headers are still valid patches, and that
    they can specify the pathname in the Index: pseudo-header or in a
    single «+++ » pathname header, which allows doing directory traversal
    when unpacking source packages.
    
    The first vector is due to how the Index: pseudo-header is handled by
    patch. Its value gets used (on non-POSIX mode) only when both «+++ »
    and «--- » pathname headers do not provide a pathname, by either having
    an empty pathname or by the header being completely absent. The minimal
    fix for this is to just consider that we&#39;ve parsed the header when we
    see a hunk header marker «@@ -». This is <a href="https://security-tracker.debian.org/tracker/CVE-2014-3865">CVE-2014-3865</a> and #749183.
    
    The other vector is due to patches with only a «+++ » pathname header,
    which get skipped by the parser as it only checks for «--- » pathname
    header lines. The minimal fix for this is to also check for «+++ » when
    parsing the patch header. This is <a href="https://security-tracker.debian.org/tracker/CVE-2014-3864">CVE-2014-3864</a> and #746498.
    
    The first issue is a superset of the second, and its fix is sufficient
    and covers and fixes too the second vector, as the «@@ -» marker is
    mandatory for a patch to be valid.
    
    An unspecified directory traversal vulnerability was initially reported
    in #746498 by Javier Serrano Polo &lt;javier@jasp.net&gt;, and while no
    information had been provided, I independently found #749183 and what
    was supposed to be #746498, which was later on published.
    
    Fixes: <a href="https://security-tracker.debian.org/tracker/CVE-2014-3864">CVE-2014-3864</a>, <a href="https://security-tracker.debian.org/tracker/CVE-2014-3865">CVE-2014-3865</a>
    Closes: #<a href="bugreport.cgi?bug=746498">746498</a>, #<a href="bugreport.cgi?bug=749183">749183</a>

diff --git a/debian/changelog b/debian/changelog
index cbbbf8d..94e53ab 100644
--- a/debian/changelog
+++ b/debian/changelog
@@ -3,6 +3,13 @@ dpkg (1.16.15) UNRELEASED; urgency=low
   [ Guillem Jover ]
   * Test suite:
     - Add test cases for Dpkg::Source::Patch <a href="https://security-tracker.debian.org/tracker/CVE-2014-0471">CVE-2014-0471</a> and <a href="https://security-tracker.debian.org/tracker/CVE-2014-3127">CVE-2014-3127</a>.
+  * Correctly parse patch headers in Dpkg::Source::Patch, to avoid directory
+    traversal attempts from hostile source packages when unpacking them.
+    Reported by Javier Serrano Polo &lt;javier@jasp.net&gt; as an unspecified
+    directory traversal; meanwhile also independently found by me both
+    #749183 and what was supposed to be #746498, which was later on published
+    and ended up being just a subset of the other non-reported issue.
+    Fixes <a href="https://security-tracker.debian.org/tracker/CVE-2014-3864">CVE-2014-3864</a> and <a href="https://security-tracker.debian.org/tracker/CVE-2014-3865">CVE-2014-3865</a>. Closes: #<a href="bugreport.cgi?bug=746498">746498</a>, #<a href="bugreport.cgi?bug=749183">749183</a>
 
   [ Updated scripts translations ]
   * German (Helge Kreutzmann).


</pre>

<div class="msgreceived"><hr><p>
<a name="62"></a>
<!-- request_addr: javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net -->
<!-- time:1402005442 -->
<strong>Message sent on</strong>
to <code>javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net</code>:<br>
Bug#746498.
 (Thu, 05 Jun 2014 21:57:22 GMT) (<a href="bugreport.cgi?bug=746498;msg=63">full text</a>, <a href="bugreport.cgi?bug=746498;mbox=yes;msg=63">mbox</a>, <a href="#62">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="64"></a><a name="msg64"></a><a href="#64">Message #64</a> received at 746498-submitter@bugs.debian.org (<a href="bugreport.cgi?bug=746498;msg=64">full text</a>, <a href="bugreport.cgi?bug=746498;mbox=yes;msg=64">mbox</a>, <a href="mailto:746498@bugs.debian.org?body=On%20Thu%2C%2005%20Jun%202014%2021%3A54%3A31%20%2B0000%20Guillem%20Jover%20%3Cguillem%40debian.org%3E%20wrote%3A%0A%3E%20tag%20746498%20pending%0A%3E%20thanks%0A%3E%20%0A%3E%20Hello%2C%0A%3E%20%0A%3E%20Bug%20%23746498%20reported%20by%20you%20has%20been%20fixed%20in%20the%20Git%20repository.%20You%20can%0A%3E%20see%20the%20changelog%20below%2C%20and%20you%20can%20check%20the%20diff%20of%20the%20fix%20at%3A%0A%3E%20%0A%3E%20%20%20%20%20http%3A%2F%2Fgit.debian.org%2F%3Fp%3Ddpkg%2Fdpkg.git%3Ba%3Dcommitdiff%3Bh%3Db171991%0A%3E%20%0A%3E%20---%0A%3E%20commit%20b1719917979ac339a610a27aef8de7f4dcf93887%0A%3E%20Author%3A%20Guillem%20Jover%20%3Cguillem%40debian.org%3E%0A%3E%20Date%3A%20%20%20Fri%20May%202%2001%3A41%3A18%202014%20%2B0200%0A%3E%20%0A%3E%20%20%20%20%20Dpkg%3A%3ASource%3A%3APatch%3A%20Fix%20patch%20header%20parsing%20to%20avoid%20directory%20traversals%0A%3E%20%20%20%20%20%0A%3E%20%20%20%20%20Cherry%20picked%20from%20commit%205348cbc981a65c3c9b05bb4d13553bda930c2d78.%0A%3E%20%20%20%20%20%0A%3E%20%20%20%20%20The%20code%20parsing%20the%20patches%20was%20not%20taking%20into%20account%20that%20patches%0A%3E%20%20%20%20%20w%2F%20partial%20or%20no%20pathname%20headers%20are%20still%20valid%20patches%2C%20and%20that%0A%3E%20%20%20%20%20they%20can%20specify%20the%20pathname%20in%20the%20Index%3A%20pseudo-header%20or%20in%20a%0A%3E%20%20%20%20%20single%20%C2%AB%2B%2B%2B%20%C2%BB%20pathname%20header%2C%20which%20allows%20doing%20directory%20traversal%0A%3E%20%20%20%20%20when%20unpacking%20source%20packages.%0A%3E%20%20%20%20%20%0A%3E%20%20%20%20%20The%20first%20vector%20is%20due%20to%20how%20the%20Index%3A%20pseudo-header%20is%20handled%20by%0A%3E%20%20%20%20%20patch.%20Its%20value%20gets%20used%20%28on%20non-POSIX%20mode%29%20only%20when%20both%20%C2%AB%2B%2B%2B%20%C2%BB%0A%3E%20%20%20%20%20and%20%C2%AB---%20%C2%BB%20pathname%20headers%20do%20not%20provide%20a%20pathname%2C%20by%20either%20having%0A%3E%20%20%20%20%20an%20empty%20pathname%20or%20by%20the%20header%20being%20completely%20absent.%20The%20minimal%0A%3E%20%20%20%20%20fix%20for%20this%20is%20to%20just%20consider%20that%20we%27ve%20parsed%20the%20header%20when%20we%0A%3E%20%20%20%20%20see%20a%20hunk%20header%20marker%20%C2%AB%40%40%20-%C2%BB.%20This%20is%20CVE-2014-3865%20and%20%23749183.%0A%3E%20%20%20%20%20%0A%3E%20%20%20%20%20The%20other%20vector%20is%20due%20to%20patches%20with%20only%20a%20%C2%AB%2B%2B%2B%20%C2%BB%20pathname%20header%2C%0A%3E%20%20%20%20%20which%20get%20skipped%20by%20the%20parser%20as%20it%20only%20checks%20for%20%C2%AB---%20%C2%BB%20pathname%0A%3E%20%20%20%20%20header%20lines.%20The%20minimal%20fix%20for%20this%20is%20to%20also%20check%20for%20%C2%AB%2B%2B%2B%20%C2%BB%20when%0A%3E%20%20%20%20%20parsing%20the%20patch%20header.%20This%20is%20CVE-2014-3864%20and%20%23746498.%0A%3E%20%20%20%20%20%0A%3E%20%20%20%20%20The%20first%20issue%20is%20a%20superset%20of%20the%20second%2C%20and%20its%20fix%20is%20sufficient%0A%3E%20%20%20%20%20and%20covers%20and%20fixes%20too%20the%20second%20vector%2C%20as%20the%20%C2%AB%40%40%20-%C2%BB%20marker%20is%0A%3E%20%20%20%20%20mandatory%20for%20a%20patch%20to%20be%20valid.%0A%3E%20%20%20%20%20%0A%3E%20%20%20%20%20An%20unspecified%20directory%20traversal%20vulnerability%20was%20initially%20reported%0A%3E%20%20%20%20%20in%20%23746498%20by%20Javier%20Serrano%20Polo%20%3Cjavier%40jasp.net%3E%2C%20and%20while%20no%0A%3E%20%20%20%20%20information%20had%20been%20provided%2C%20I%20independently%20found%20%23749183%20and%20what%0A%3E%20%20%20%20%20was%20supposed%20to%20be%20%23746498%2C%20which%20was%20later%20on%20published.%0A%3E%20%20%20%20%20%0A%3E%20%20%20%20%20Fixes%3A%20CVE-2014-3864%2C%20CVE-2014-3865%0A%3E%20%20%20%20%20Closes%3A%20%23746498%2C%20%23749183%0A%3E%20%0A%3E%20diff%20--git%20a%2Fdebian%2Fchangelog%20b%2Fdebian%2Fchangelog%0A%3E%20index%20613b988..621875c%20100644%0A%3E%20---%20a%2Fdebian%2Fchangelog%0A%3E%20%2B%2B%2B%20b%2Fdebian%2Fchangelog%0A%3E%20%40%40%20-3%2C6%20%2B3%2C13%20%40%40%20dpkg%20%281.15.11%29%20UNRELEASED%3B%20urgency%3Dlow%0A%3E%20%20%20%20%5B%20Guillem%20Jover%20%5D%0A%3E%20%20%20%20%2A%20Test%20suite%3A%0A%3E%20%20%20%20%20%20-%20Add%20test%20cases%20for%20Dpkg%3A%3ASource%3A%3APatch%20CVE-2014-0471%20and%20CVE-2014-3127.%0A%3E%20%2B%20%20%2A%20Correctly%20parse%20patch%20headers%20in%20Dpkg%3A%3ASource%3A%3APatch%2C%20to%20avoid%20directory%0A%3E%20%2B%20%20%20%20traversal%20attempts%20from%20hostile%20source%20packages%20when%20unpacking%20them.%0A%3E%20%2B%20%20%20%20Reported%20by%20Javier%20Serrano%20Polo%20%3Cjavier%40jasp.net%3E%20as%20an%20unspecified%0A&amp;In-Reply-To=%3CE1WsfcF-0007Ca-SC%40moszumanska.debian.org%3E&amp;References=%3CE1WsfcF-0007Ca-SC%40moszumanska.debian.org%3E&amp;subject=Re%3A%20Bug%23746498%20marked%20as%20pending">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=guillem%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Guillem Jover &lt;guillem@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> 746498-submitter@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Bug#746498 marked as pending</div>
<div class="header"><span class="headerfield">Date:</span> Thu, 05 Jun 2014 21:54:31 +0000</div>
</div>
<pre class="message">tag 746498 pending
thanks

Hello,

Bug #746498 reported by you has been fixed in the Git repository. You can
see the changelog below, and you can check the diff of the fix at:

    <a href="http://git.debian.org/?p=dpkg/dpkg.git;a=commitdiff;h=b171991">http://git.debian.org/?p=dpkg/dpkg.git;a=commitdiff;h=b171991</a>

---
commit b1719917979ac339a610a27aef8de7f4dcf93887
Author: Guillem Jover &lt;guillem@debian.org&gt;
Date:   Fri May 2 01:41:18 2014 +0200

    Dpkg::Source::Patch: Fix patch header parsing to avoid directory traversals
    
    Cherry picked from commit 5348cbc981a65c3c9b05bb4d13553bda930c2d78.
    
    The code parsing the patches was not taking into account that patches
    w/ partial or no pathname headers are still valid patches, and that
    they can specify the pathname in the Index: pseudo-header or in a
    single «+++ » pathname header, which allows doing directory traversal
    when unpacking source packages.
    
    The first vector is due to how the Index: pseudo-header is handled by
    patch. Its value gets used (on non-POSIX mode) only when both «+++ »
    and «--- » pathname headers do not provide a pathname, by either having
    an empty pathname or by the header being completely absent. The minimal
    fix for this is to just consider that we&#39;ve parsed the header when we
    see a hunk header marker «@@ -». This is <a href="https://security-tracker.debian.org/tracker/CVE-2014-3865">CVE-2014-3865</a> and #749183.
    
    The other vector is due to patches with only a «+++ » pathname header,
    which get skipped by the parser as it only checks for «--- » pathname
    header lines. The minimal fix for this is to also check for «+++ » when
    parsing the patch header. This is <a href="https://security-tracker.debian.org/tracker/CVE-2014-3864">CVE-2014-3864</a> and #746498.
    
    The first issue is a superset of the second, and its fix is sufficient
    and covers and fixes too the second vector, as the «@@ -» marker is
    mandatory for a patch to be valid.
    
    An unspecified directory traversal vulnerability was initially reported
    in #746498 by Javier Serrano Polo &lt;javier@jasp.net&gt;, and while no
    information had been provided, I independently found #749183 and what
    was supposed to be #746498, which was later on published.
    
    Fixes: <a href="https://security-tracker.debian.org/tracker/CVE-2014-3864">CVE-2014-3864</a>, <a href="https://security-tracker.debian.org/tracker/CVE-2014-3865">CVE-2014-3865</a>
    Closes: #<a href="bugreport.cgi?bug=746498">746498</a>, #<a href="bugreport.cgi?bug=749183">749183</a>

diff --git a/debian/changelog b/debian/changelog
index 613b988..621875c 100644
--- a/debian/changelog
+++ b/debian/changelog
@@ -3,6 +3,13 @@ dpkg (1.15.11) UNRELEASED; urgency=low
   [ Guillem Jover ]
   * Test suite:
     - Add test cases for Dpkg::Source::Patch <a href="https://security-tracker.debian.org/tracker/CVE-2014-0471">CVE-2014-0471</a> and <a href="https://security-tracker.debian.org/tracker/CVE-2014-3127">CVE-2014-3127</a>.
+  * Correctly parse patch headers in Dpkg::Source::Patch, to avoid directory
+    traversal attempts from hostile source packages when unpacking them.
+    Reported by Javier Serrano Polo &lt;javier@jasp.net&gt; as an unspecified
+    directory traversal; meanwhile also independently found by me both
+    #749183 and what was supposed to be #746498, which was later on published
+    and ended up being just a subset of the other non-reported issue.
+    Fixes <a href="https://security-tracker.debian.org/tracker/CVE-2014-3864">CVE-2014-3864</a> and <a href="https://security-tracker.debian.org/tracker/CVE-2014-3865">CVE-2014-3865</a>. Closes: #<a href="bugreport.cgi?bug=746498">746498</a>, #<a href="bugreport.cgi?bug=749183">749183</a>
 
  -- Guillem Jover &lt;guillem@debian.org&gt;  Fri, 02 May 2014 00:09:43 +0200
 


</pre>

<div class="msgreceived"><hr><p>
<a name="65"></a>
<!-- request_addr: Guillem Jover &lt;guillem@debian.org&gt; -->
<!-- time:1402868177 -->
<strong>Reply sent</strong>
to <code>Guillem Jover &lt;guillem@debian.org&gt;</code>:<br>
You have taken responsibility.
 (Sun, 15 Jun 2014 21:36:17 GMT) (<a href="bugreport.cgi?bug=746498;msg=66">full text</a>, <a href="bugreport.cgi?bug=746498;mbox=yes;msg=66">mbox</a>, <a href="#65">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="67"></a>
<!-- request_addr: javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net -->
<!-- time:1402868177 -->
<strong>Notification sent</strong>
to <code>javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net</code>:<br>
Bug acknowledged by developer.
 (Sun, 15 Jun 2014 21:36:17 GMT) (<a href="bugreport.cgi?bug=746498;msg=68">full text</a>, <a href="bugreport.cgi?bug=746498;mbox=yes;msg=68">mbox</a>, <a href="#67">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="69"></a><a name="msg69"></a><a href="#69">Message #69</a> received at 746498-close@bugs.debian.org (<a href="bugreport.cgi?bug=746498;msg=69">full text</a>, <a href="bugreport.cgi?bug=746498;mbox=yes;msg=69">mbox</a>, <a href="mailto:746498@bugs.debian.org?body=On%20Sun%2C%2015%20Jun%202014%2021%3A33%3A14%20%2B0000%20Guillem%20Jover%20%3Cguillem%40debian.org%3E%20wrote%3A%0A%3E%20Source%3A%20dpkg%0A%3E%20Source-Version%3A%201.16.15%0A%3E%20%0A%3E%20We%20believe%20that%20the%20bug%20you%20reported%20is%20fixed%20in%20the%20latest%20version%20of%0A%3E%20dpkg%2C%20which%20is%20due%20to%20be%20installed%20in%20the%20Debian%20FTP%20archive.%0A%3E%20%0A%3E%20A%20summary%20of%20the%20changes%20between%20this%20version%20and%20the%20previous%20one%20is%0A%3E%20attached.%0A%3E%20%0A%3E%20Thank%20you%20for%20reporting%20the%20bug%2C%20which%20will%20now%20be%20closed.%20%20If%20you%0A%3E%20have%20further%20comments%20please%20address%20them%20to%20746498%40bugs.debian.org%2C%0A%3E%20and%20the%20maintainer%20will%20reopen%20the%20bug%20report%20if%20appropriate.%0A%3E%20%0A%3E%20Debian%20distribution%20maintenance%20software%0A%3E%20pp.%0A%3E%20Guillem%20Jover%20%3Cguillem%40debian.org%3E%20%28supplier%20of%20updated%20dpkg%20package%29%0A%3E%20%0A%3E%20%28This%20message%20was%20generated%20automatically%20at%20their%20request%3B%20if%20you%0A%3E%20believe%20that%20there%20is%20a%20problem%20with%20it%20please%20contact%20the%20archive%0A%3E%20administrators%20by%20mailing%20ftpmaster%40ftp-master.debian.org%29%0A%3E%20%0A%3E%20%0A%3E%20-----BEGIN%20PGP%20SIGNED%20MESSAGE-----%0A%3E%20Hash%3A%20SHA256%0A%3E%20%0A%3E%20Format%3A%201.8%0A%3E%20Date%3A%20Thu%2C%2005%20Jun%202014%2022%3A24%3A36%20%2B0200%0A%3E%20Source%3A%20dpkg%0A%3E%20Binary%3A%20libdpkg-dev%20dpkg%20dpkg-dev%20libdpkg-perl%20dselect%0A%3E%20Architecture%3A%20source%20amd64%20all%0A%3E%20Version%3A%201.16.15%0A%3E%20Distribution%3A%20wheezy-security%0A%3E%20Urgency%3A%20high%0A%3E%20Maintainer%3A%20Dpkg%20Developers%20%3Cdebian-dpkg%40lists.debian.org%3E%0A%3E%20Changed-By%3A%20Guillem%20Jover%20%3Cguillem%40debian.org%3E%0A%3E%20Description%3A%20%0A%3E%20%20dpkg%20%20%20%20%20%20%20-%20Debian%20package%20management%20system%0A%3E%20%20dpkg-dev%20%20%20-%20Debian%20package%20development%20tools%0A%3E%20%20dselect%20%20%20%20-%20Debian%20package%20management%20front-end%0A%3E%20%20libdpkg-dev%20-%20Debian%20package%20management%20static%20library%0A%3E%20%20libdpkg-perl%20-%20Dpkg%20perl%20modules%0A%3E%20Closes%3A%20746498%20749183%0A%3E%20Changes%3A%20%0A%3E%20%20dpkg%20%281.16.15%29%20wheezy-security%3B%20urgency%3Dhigh%0A%3E%20%20.%0A%3E%20%20%20%20%5B%20Guillem%20Jover%20%5D%0A%3E%20%20%20%20%2A%20Test%20suite%3A%0A%3E%20%20%20%20%20%20-%20Add%20test%20cases%20for%20Dpkg%3A%3ASource%3A%3APatch%20CVE-2014-0471%20and%20CVE-2014-3127.%0A%3E%20%20%20%20%20%20-%20Add%20test%20case%20for%20patch%20disabling%20hunks%3B%20not%20security%20sensitive.%0A%3E%20%20%20%20%2A%20Correctly%20parse%20patch%20headers%20in%20Dpkg%3A%3ASource%3A%3APatch%2C%20to%20avoid%20directory%0A%3E%20%20%20%20%20%20traversal%20attempts%20from%20hostile%20source%20packages%20when%20unpacking%20them.%0A%3E%20%20%20%20%20%20Reported%20by%20Javier%20Serrano%20Polo%20%3Cjavier%40jasp.net%3E%20as%20an%20unspecified%0A%3E%20%20%20%20%20%20directory%20traversal%3B%20meanwhile%20also%20independently%20found%20by%20me%20both%0A%3E%20%20%20%20%20%20%23749183%20and%20what%20was%20supposed%20to%20be%20%23746498%2C%20which%20was%20later%20on%20published%0A%3E%20%20%20%20%20%20and%20ended%20up%20being%20just%20a%20subset%20of%20the%20other%20non-reported%20issue.%0A%3E%20%20%20%20%20%20Fixes%20CVE-2014-3864%20and%20CVE-2014-3865.%20Closes%3A%20%23746498%2C%20%23749183%0A%3E%20%20.%0A%3E%20%20%20%20%5B%20Updated%20programs%20translations%20%5D%0A%3E%20%20%20%20%2A%20Merge%20translated%20strings%20from%20master.%0A%3E%20%20.%0A&amp;subject=Re%3A%20Bug%23746498%3A%20fixed%20in%20dpkg%201.16.15&amp;References=%3CE1WwI38-00052t-Mp%40franck.debian.org%3E&amp;In-Reply-To=%3CE1WwI38-00052t-Mp%40franck.debian.org%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=guillem%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Guillem Jover &lt;guillem@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> 746498-close@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Bug#746498: fixed in dpkg 1.16.15</div>
<div class="header"><span class="headerfield">Date:</span> Sun, 15 Jun 2014 21:33:14 +0000</div>
</div>
<pre class="message">Source: dpkg
Source-Version: 1.16.15

We believe that the bug you reported is fixed in the latest version of
dpkg, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 746498@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Guillem Jover &lt;guillem@debian.org&gt; (supplier of updated dpkg package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Format: 1.8
Date: Thu, 05 Jun 2014 22:24:36 +0200
Source: dpkg
Binary: libdpkg-dev dpkg dpkg-dev libdpkg-perl dselect
Architecture: source amd64 all
Version: 1.16.15
Distribution: wheezy-security
Urgency: high
Maintainer: Dpkg Developers &lt;debian-dpkg@lists.debian.org&gt;
Changed-By: Guillem Jover &lt;guillem@debian.org&gt;
Description: 
 dpkg       - Debian package management system
 dpkg-dev   - Debian package development tools
 dselect    - Debian package management front-end
 libdpkg-dev - Debian package management static library
 libdpkg-perl - Dpkg perl modules
Closes: <a href="bugreport.cgi?bug=746498">746498</a> <a href="bugreport.cgi?bug=749183">749183</a>
Changes: 
 dpkg (1.16.15) wheezy-security; urgency=high
 .
   [ Guillem Jover ]
   * Test suite:
     - Add test cases for Dpkg::Source::Patch <a href="https://security-tracker.debian.org/tracker/CVE-2014-0471">CVE-2014-0471</a> and <a href="https://security-tracker.debian.org/tracker/CVE-2014-3127">CVE-2014-3127</a>.
     - Add test case for patch disabling hunks; not security sensitive.
   * Correctly parse patch headers in Dpkg::Source::Patch, to avoid directory
     traversal attempts from hostile source packages when unpacking them.
     Reported by Javier Serrano Polo &lt;javier@jasp.net&gt; as an unspecified
     directory traversal; meanwhile also independently found by me both
     #749183 and what was supposed to be #746498, which was later on published
     and ended up being just a subset of the other non-reported issue.
     Fixes <a href="https://security-tracker.debian.org/tracker/CVE-2014-3864">CVE-2014-3864</a> and <a href="https://security-tracker.debian.org/tracker/CVE-2014-3865">CVE-2014-3865</a>. Closes: #<a href="bugreport.cgi?bug=746498">746498</a>, #<a href="bugreport.cgi?bug=749183">749183</a>
 .
   [ Updated programs translations ]
   * Merge translated strings from master.
 .
   [ Updated scripts translations ]
   * German (Helge Kreutzmann).
 .
   [ Updated man page translations ]
   * Merge translated strings from master.
   * Unfuzzy or update trivial translations (Guillem Jover).
Checksums-Sha1: 
 be105c05324861a6864c782031ee04a9e52f1ca5 2016 dpkg_1.16.15.dsc
 c034f88c1ea9d8df7c5a84cc04bb7749e2b3617a 3800328 dpkg_1.16.15.tar.xz
 7dfd3227baecfe2ad664d50d6a55ba4f9cf83b02 696352 libdpkg-dev_1.16.15_amd64.deb
 7d947c681e58819378f602b285bb4fbc5ecce669 2656714 dpkg_1.16.15_amd64.deb
 52e908a53fda707b37479dbb5268dd878a8ef412 1159292 dselect_1.16.15_amd64.deb
 113be782cd7f9c6b9e3b55c55ecf50be1ca0d95e 1355958 dpkg-dev_1.16.15_all.deb
 47c95b017e2d3f914921bbf721e264312d815f0b 957964 libdpkg-perl_1.16.15_all.deb
Checksums-Sha256: 
 00f01b04878d80d40e8d9420e5d35200101c5201f4fad36d4197a50a1d4c465d 2016 dpkg_1.16.15.dsc
 92bca9901ba2d9300be42f6de8dbea59b8367a918a2abeeb47d2176c9cf86b55 3800328 dpkg_1.16.15.tar.xz
 cf9fd73f4c8f54451ed9f2418737e232c0c9dc8907867af22c96ba649e60d248 696352 libdpkg-dev_1.16.15_amd64.deb
 47831eef504efd77a3998a5fecea04c278ba4d5512405e9da42008f38d726413 2656714 dpkg_1.16.15_amd64.deb
 4370e54fd4743969ffb86b53905ed7b96f8735eb0e9367a25eab98223306be88 1159292 dselect_1.16.15_amd64.deb
 ac4b9142ba4653faed8b902a39115a97ecc40ded51e67d01634f19389a39ba17 1355958 dpkg-dev_1.16.15_all.deb
 18a40e9f826f7ada39a03356924b86f14cc342e2ee0209459e394c89095b8073 957964 libdpkg-perl_1.16.15_all.deb
Files: 
 3e0e5af42ed579f3bf721ea1a7020033 2016 admin required dpkg_1.16.15.dsc
 0e7d105a57839cdab2b0bf5e3612442f 3800328 admin required dpkg_1.16.15.tar.xz
 8db3cf1534386da5215c1916ba1fa38a 696352 libdevel optional libdpkg-dev_1.16.15_amd64.deb
 11948b8a099f6e51b8deea79f4b92916 2656714 admin required dpkg_1.16.15_amd64.deb
 7f4a898524458a347e24297b50639b7f 1159292 admin optional dselect_1.16.15_amd64.deb
 4ad8e09db95f05eaa558ee621954be53 1355958 utils optional dpkg-dev_1.16.15_all.deb
 b098ae11ce598105b700dbba5613f781 957964 perl optional libdpkg-perl_1.16.15_all.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.22 (GNU/Linux)

iQIcBAEBCAAGBQJTkN8dAAoJELlyvz6krlejp14P/iqmUqt7Kk2B4AxPaOEONHkY
Pe9lT/72tUfvWq1q3Xws2RH7kyf9EgbXPtzljkD+mwEq3pVstSfhgzbmgbafRpti
kxDRrgRx2szQDW5YwKQtoDjpcnoaNg+2XXTFW/bZ2BQ1tWkIEyTacdhKhECenU2G
xw9/jQAvLClex9G1AE09LtyBR50IJVL2yPgCSUUu6stzVMcJPt8Zr9wGXDlc0Bq8
CwNA6wjNQOZQNsAFKAwIgRNKRDjGbCaqGJkTIJzw5kzoHMoR4SBKclHfVbC24nBg
VYEEdkj1E4/kYuNcYrCW3iJP5PuQKTfsu21IowORf1htN4T+07mPBZ/Gy90j0OfS
6oGMPfzzrntEBjSKuz4n50f8pwUHMYNxzTyVSb/XaBWPMeasrZs85sc8si11VvMa
LnxAyV9pCXXhKW9zqoojtsOLcz6cm/ypk1Pua9UaEsy+317Cv76fhqWJFpvzHFRV
52UtjxNRwojFtPUnloJ4HXIVe227hZ8JhRWxL8ottOpVYlphCHAzv7n8hIFMv/c8
ZVvZitX2dQBMrFBoMNbFI5YTjIQ7rACSjpZsHQdY4A9BDjsrNZBNW4bD9e1O20wi
vHM6wXi6ujzBjQ/POAYu1fdBb514R4ihFrG2iUvPF6EKaJAEJAgU+rY9PuiiA2Vw
wK84p9QsUKk8IOMJo7Vq
=HssJ
-----END PGP SIGNATURE-----



</pre>

<div class="msgreceived"><hr><p>
<a name="70"></a>
<!-- request_addr: Guillem Jover &lt;guillem@debian.org&gt; -->
<!-- time:1403009475 -->
<strong>Reply sent</strong>
to <code>Guillem Jover &lt;guillem@debian.org&gt;</code>:<br>
You have taken responsibility.
 (Tue, 17 Jun 2014 12:51:15 GMT) (<a href="bugreport.cgi?bug=746498;msg=71">full text</a>, <a href="bugreport.cgi?bug=746498;mbox=yes;msg=71">mbox</a>, <a href="#70">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="72"></a>
<!-- request_addr: javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net -->
<!-- time:1403009475 -->
<strong>Notification sent</strong>
to <code>javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net</code>:<br>
Bug acknowledged by developer.
 (Tue, 17 Jun 2014 12:51:15 GMT) (<a href="bugreport.cgi?bug=746498;msg=73">full text</a>, <a href="bugreport.cgi?bug=746498;mbox=yes;msg=73">mbox</a>, <a href="#72">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="74"></a><a name="msg74"></a><a href="#74">Message #74</a> received at 746498-close@bugs.debian.org (<a href="bugreport.cgi?bug=746498;msg=74">full text</a>, <a href="bugreport.cgi?bug=746498;mbox=yes;msg=74">mbox</a>, <a href="mailto:746498@bugs.debian.org?In-Reply-To=%3CE1WwspN-00039v-Sf%40franck.debian.org%3E&amp;subject=Re%3A%20Bug%23746498%3A%20fixed%20in%20dpkg%201.15.11&amp;References=%3CE1WwspN-00039v-Sf%40franck.debian.org%3E&amp;body=On%20Tue%2C%2017%20Jun%202014%2012%3A49%3A29%20%2B0000%20Guillem%20Jover%20%3Cguillem%40debian.org%3E%20wrote%3A%0A%3E%20Source%3A%20dpkg%0A%3E%20Source-Version%3A%201.15.11%0A%3E%20%0A%3E%20We%20believe%20that%20the%20bug%20you%20reported%20is%20fixed%20in%20the%20latest%20version%20of%0A%3E%20dpkg%2C%20which%20is%20due%20to%20be%20installed%20in%20the%20Debian%20FTP%20archive.%0A%3E%20%0A%3E%20A%20summary%20of%20the%20changes%20between%20this%20version%20and%20the%20previous%20one%20is%0A%3E%20attached.%0A%3E%20%0A%3E%20Thank%20you%20for%20reporting%20the%20bug%2C%20which%20will%20now%20be%20closed.%20%20If%20you%0A%3E%20have%20further%20comments%20please%20address%20them%20to%20746498%40bugs.debian.org%2C%0A%3E%20and%20the%20maintainer%20will%20reopen%20the%20bug%20report%20if%20appropriate.%0A%3E%20%0A%3E%20Debian%20distribution%20maintenance%20software%0A%3E%20pp.%0A%3E%20Guillem%20Jover%20%3Cguillem%40debian.org%3E%20%28supplier%20of%20updated%20dpkg%20package%29%0A%3E%20%0A%3E%20%28This%20message%20was%20generated%20automatically%20at%20their%20request%3B%20if%20you%0A%3E%20believe%20that%20there%20is%20a%20problem%20with%20it%20please%20contact%20the%20archive%0A%3E%20administrators%20by%20mailing%20ftpmaster%40ftp-master.debian.org%29%0A%3E%20%0A%3E%20%0A%3E%20-----BEGIN%20PGP%20SIGNED%20MESSAGE-----%0A%3E%20Hash%3A%20SHA256%0A%3E%20%0A%3E%20Format%3A%201.8%0A%3E%20Date%3A%20Thu%2C%2005%20Jun%202014%2022%3A52%3A45%20%2B0200%0A%3E%20Source%3A%20dpkg%0A%3E%20Binary%3A%20libdpkg-dev%20dpkg%20dpkg-dev%20libdpkg-perl%20dselect%0A%3E%20Architecture%3A%20source%20amd64%20all%0A%3E%20Version%3A%201.15.11%0A%3E%20Distribution%3A%20squeeze-security%0A%3E%20Urgency%3A%20high%0A%3E%20Maintainer%3A%20Dpkg%20Developers%20%3Cdebian-dpkg%40lists.debian.org%3E%0A%3E%20Changed-By%3A%20Guillem%20Jover%20%3Cguillem%40debian.org%3E%0A%3E%20Description%3A%20%0A%3E%20%20dpkg%20%20%20%20%20%20%20-%20Debian%20package%20management%20system%0A%3E%20%20dpkg-dev%20%20%20-%20Debian%20package%20development%20tools%0A%3E%20%20dselect%20%20%20%20-%20Debian%20package%20management%20front-end%0A%3E%20%20libdpkg-dev%20-%20Debian%20package%20management%20static%20library%0A%3E%20%20libdpkg-perl%20-%20Dpkg%20perl%20modules%0A%3E%20Closes%3A%20746498%20749183%0A%3E%20Changes%3A%20%0A%3E%20%20dpkg%20%281.15.11%29%20squeeze-security%3B%20urgency%3Dhigh%0A%3E%20%20.%0A%3E%20%20%20%20%5B%20Guillem%20Jover%20%5D%0A%3E%20%20%20%20%2A%20Test%20suite%3A%0A%3E%20%20%20%20%20%20-%20Add%20test%20cases%20for%20Dpkg%3A%3ASource%3A%3APatch%20CVE-2014-0471%20and%20CVE-2014-3127.%0A%3E%20%20%20%20%20%20-%20Add%20test%20case%20for%20patch%20disabling%20hunks%3B%20not%20security%20sensitive.%0A%3E%20%20%20%20%2A%20Correctly%20parse%20patch%20headers%20in%20Dpkg%3A%3ASource%3A%3APatch%2C%20to%20avoid%20directory%0A%3E%20%20%20%20%20%20traversal%20attempts%20from%20hostile%20source%20packages%20when%20unpacking%20them.%0A%3E%20%20%20%20%20%20Reported%20by%20Javier%20Serrano%20Polo%20%3Cjavier%40jasp.net%3E%20as%20an%20unspecified%0A%3E%20%20%20%20%20%20directory%20traversal%3B%20meanwhile%20also%20independently%20found%20by%20me%20both%0A%3E%20%20%20%20%20%20%23749183%20and%20what%20was%20supposed%20to%20be%20%23746498%2C%20which%20was%20later%20on%20published%0A%3E%20%20%20%20%20%20and%20ended%20up%20being%20just%20a%20subset%20of%20the%20other%20non-reported%20issue.%0A%3E%20%20%20%20%20%20Fixes%20CVE-2014-3864%20and%20CVE-2014-3865.%20Closes%3A%20%23746498%2C%20%23749183%0A%3E%20Checksums-Sha1%3A%20%0A%3E%20%204426c4d44a6c6c7c8eb21ad6e149d4b8bc71ec0e%201844%20dpkg_1.15.11.dsc%0A%3E%20%200d562e96d4df9592a8b96bfc76b19be91e88beee%205269052%20dpkg_1.15.11.tar.bz2%0A%3E%20%20641c051ee3adebdd4a76222b0a9b0d59fc2d950d%20440340%20libdpkg-dev_1.15.11_amd64.deb%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=guillem%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Guillem Jover &lt;guillem@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> 746498-close@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Bug#746498: fixed in dpkg 1.15.11</div>
<div class="header"><span class="headerfield">Date:</span> Tue, 17 Jun 2014 12:49:29 +0000</div>
</div>
<pre class="message">Source: dpkg
Source-Version: 1.15.11

We believe that the bug you reported is fixed in the latest version of
dpkg, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 746498@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Guillem Jover &lt;guillem@debian.org&gt; (supplier of updated dpkg package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Format: 1.8
Date: Thu, 05 Jun 2014 22:52:45 +0200
Source: dpkg
Binary: libdpkg-dev dpkg dpkg-dev libdpkg-perl dselect
Architecture: source amd64 all
Version: 1.15.11
Distribution: squeeze-security
Urgency: high
Maintainer: Dpkg Developers &lt;debian-dpkg@lists.debian.org&gt;
Changed-By: Guillem Jover &lt;guillem@debian.org&gt;
Description: 
 dpkg       - Debian package management system
 dpkg-dev   - Debian package development tools
 dselect    - Debian package management front-end
 libdpkg-dev - Debian package management static library
 libdpkg-perl - Dpkg perl modules
Closes: <a href="bugreport.cgi?bug=746498">746498</a> <a href="bugreport.cgi?bug=749183">749183</a>
Changes: 
 dpkg (1.15.11) squeeze-security; urgency=high
 .
   [ Guillem Jover ]
   * Test suite:
     - Add test cases for Dpkg::Source::Patch <a href="https://security-tracker.debian.org/tracker/CVE-2014-0471">CVE-2014-0471</a> and <a href="https://security-tracker.debian.org/tracker/CVE-2014-3127">CVE-2014-3127</a>.
     - Add test case for patch disabling hunks; not security sensitive.
   * Correctly parse patch headers in Dpkg::Source::Patch, to avoid directory
     traversal attempts from hostile source packages when unpacking them.
     Reported by Javier Serrano Polo &lt;javier@jasp.net&gt; as an unspecified
     directory traversal; meanwhile also independently found by me both
     #749183 and what was supposed to be #746498, which was later on published
     and ended up being just a subset of the other non-reported issue.
     Fixes <a href="https://security-tracker.debian.org/tracker/CVE-2014-3864">CVE-2014-3864</a> and <a href="https://security-tracker.debian.org/tracker/CVE-2014-3865">CVE-2014-3865</a>. Closes: #<a href="bugreport.cgi?bug=746498">746498</a>, #<a href="bugreport.cgi?bug=749183">749183</a>
Checksums-Sha1: 
 4426c4d44a6c6c7c8eb21ad6e149d4b8bc71ec0e 1844 dpkg_1.15.11.dsc
 0d562e96d4df9592a8b96bfc76b19be91e88beee 5269052 dpkg_1.15.11.tar.bz2
 641c051ee3adebdd4a76222b0a9b0d59fc2d950d 440340 libdpkg-dev_1.15.11_amd64.deb
 095bd30806da1bad9e231c3910ac13430e2d7728 2401838 dpkg_1.15.11_amd64.deb
 52ea8293218b9a00764a2517eb1d62da1dfccb85 908748 dselect_1.15.11_amd64.deb
 1c3b37c6157816a79674fcab8323d929bbeee11d 815412 dpkg-dev_1.15.11_all.deb
 71dfa4767c572e62d041c6ab3cf5f0c86571a030 697686 libdpkg-perl_1.15.11_all.deb
Checksums-Sha256: 
 207f68ed5ef4888e26f1918c84a3400fa32fd09ad098600ff7b4b9e6d8398c63 1844 dpkg_1.15.11.dsc
 7db2e5e23147e4159d95345dce420236a4af2c0ecff0a38dadee35160bb6f739 5269052 dpkg_1.15.11.tar.bz2
 9b9f1eb8f2536e8be4d4a9157f6262dff4f277285de1c25dc34fa2bc2df4cf72 440340 libdpkg-dev_1.15.11_amd64.deb
 b8921f46999dee2a1c48e08daf45d704de9951dff2879afabd458b341c402ed2 2401838 dpkg_1.15.11_amd64.deb
 0fd10aee9a03794e82530793b2ba71ff1b634b077d1d2475b259364a5debcb5b 908748 dselect_1.15.11_amd64.deb
 e0a6b0b3a506e5c48c7dfa5d439e645ad0416980c3c28f2c70ae4bdd3d8374e6 815412 dpkg-dev_1.15.11_all.deb
 afa97dfcddbf8a0856701622159a4711a8d471f9cacd9e0de1ba44b91ef0eba6 697686 libdpkg-perl_1.15.11_all.deb
Files: 
 ed3eaf21406b5cf68c7e497dad16b8d7 1844 admin required dpkg_1.15.11.dsc
 92f54904ddc5b63f01308d181d8fcdf4 5269052 admin required dpkg_1.15.11.tar.bz2
 49bd29615ce3eb1cfc9409d601770cad 440340 libdevel optional libdpkg-dev_1.15.11_amd64.deb
 790ecea2ea1793a396df0ad254f00df0 2401838 admin required dpkg_1.15.11_amd64.deb
 2548575c77fced8d6ef1dd5f78871a4d 908748 admin optional dselect_1.15.11_amd64.deb
 68c22adf6501b43523510c606a0366f4 815412 utils optional dpkg-dev_1.15.11_all.deb
 5569fd703e0c43f304b232108e4de210 697686 perl optional libdpkg-perl_1.15.11_all.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.22 (GNU/Linux)

iQIcBAEBCAAGBQJTkN8sAAoJELlyvz6krlejZ0AP/RrUH5XmCbk3LVFpJsR7Gpx3
q6kUkzTisedFG0bgHsGeOxTljSVjgdCVKJ1gD8a+rVKMxNxyPTg6eWxw/Aium6wJ
H8u5qyLC+ZrCiBvKF3Bb0TsaiKCzc3yihd6/Z7mbLaSetC9K2MUnybnm5ESJlnmy
0HzOH3YerDvkMY4RCJyl/Z7j0VR+dX+EnD2cJrg8ivAHxoldaUPHxUaZzGRz33b5
V5J+r+o9OrXr9R7LnKbaMTQqBTj5Y169k4ZBFL00aaUiNZ4Q8HbMYDosPRn+mbdf
lrbzhHgThOlemK8hKV1yR6NexsUxuGiX/fbIRu2MYAfiaXjkmVoOiI6bBlJ3HwH+
GvTTbQnB7Gjhj0Guh50eoxankAZDVaxDY9a8q/jCMqPDRxCj0ZT46cma+27R81Ve
SRR5F79FU7J6h1uKspG8hHtUpep7zcrlxy2cW/TNcuiwfEv/aezW3zGqyMpwHG+X
Go6nDSI6p6L5y9EphSR3aNQDwjAvmBZhJF4Lj1AdSKy7tg/z+9Ahqu0U71cXmnfz
mr+xB7hf0AToNK1EB6ir/vZke/X2WY9/Qgl/gnqXyMkCCgS8MJkIBtaRCdQn34Db
BH3N3chFDejUn532mjrDnQFFXVTtDJ84xJMI+CVFg2YwCKwCHABK9ADz4d6eq0X/
YOQfC0pitPinsMz6Sx+5
=tDcj
-----END PGP SIGNATURE-----



</pre>

<div class="msgreceived"><hr><p>
<a name="75"></a>
<!-- command:archive -->
<!-- requester: Debbugs Internal Request &lt;owner@bugs.debian.org&gt; -->
<!-- request_addr: internal_control@bugs.debian.org -->
<!-- time:1405496134 -->
<!-- new_data:
$new_data = {};
-->
<!-- old_data:
$old_data = {};
-->
<strong>Bug archived.</strong>
Request was from <code>Debbugs Internal Request &lt;owner@bugs.debian.org&gt;</code>
to <code>internal_control@bugs.debian.org</code>.
 (Wed, 16 Jul 2014 07:35:34 GMT) (<a href="bugreport.cgi?bug=746498;msg=76">full text</a>, <a href="bugreport.cgi?bug=746498;mbox=yes;msg=76">mbox</a>, <a href="#75">link</a>).</p></p></div>

<hr>
<p class="msgreceived">Send a report that <a href="https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=746498">this bug log contains spam</a>.</p>
<hr>
<ADDRESS>Debian bug tracking system administrator &lt;<A HREF="mailto:owner@bugs.debian.org">owner@bugs.debian.org</A>&gt;.
Last modified:
<!--timestamp-->Sat Oct 30 18:29:15 2021<!--end timestamp-->; 
Machine Name:
<!--machinename-->buxtehude<!--machinename-->
<P>
<A HREF="https://www.debian.org/Bugs/">Debian Bug tracking system</A>
</p>
<p>
  Debbugs is free software and licensed under the terms of the GNU
  Public License version 2. The current version can be obtained
  from <a href="https://bugs.debian.org/debbugs-source/">https://bugs.debian.org/debbugs-source/</a>.
</p>
<p>
Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.
</p>
</ADDRESS>

</body>
</html>
