<!DOCTYPE html>
<html lang='en'>
<head>
<title>gstreamer/gst-plugins-bad - 'Bad' GStreamer plugins and helper libraries  (mirrored from https://gitlab.freedesktop.org/gstreamer/gst-plugins-bad)</title>
<meta name='generator' content='cgit v1.2.1'/>
<meta name='robots' content='index, nofollow'/>
<link rel='stylesheet' type='text/css' href='https://cgit.freedesktop.org/cgit.css'/>
<link rel='shortcut icon' href='/favicon.ico'/>
<link rel='alternate' title='Atom feed' href='https://cgit.freedesktop.org/gstreamer/gst-plugins-bad/atom/gst/vmnc/vmncdec.c?h=master' type='application/atom+xml'/>
<link rel='vcs-git' href='https://gitlab.freedesktop.org/gstreamer/gst-plugins-bad' title='gstreamer/gst-plugins-bad Git repository'/>
</head>
<body>
<div id='cgit'><table id='header'>
<tr>
<td class='logo' rowspan='2'><a href='/'><img src='https://cgit.freedesktop.org/logo.png' alt='cgit logo'/></a></td>
<td class='main'><a href='/'>index</a> : <a title='gstreamer/gst-plugins-bad' href='/gstreamer/gst-plugins-bad/'>gstreamer/gst-plugins-bad</a></td><td class='form'><form method='get'>
<input type='hidden' name='id' value='4cb1bcf1422bbcd79c0f683edb7ee85e3f7a31fe'/><select name='h' onchange='this.form.submit();'>
<option value='0.10'>0.10</option>
<option value='0.11'>0.11</option>
<option value='1.0'>1.0</option>
<option value='1.10'>1.10</option>
<option value='1.12'>1.12</option>
<option value='1.14'>1.14</option>
<option value='1.16'>1.16</option>
<option value='1.18'>1.18</option>
<option value='1.2'>1.2</option>
<option value='1.4'>1.4</option>
<option value='1.6'>1.6</option>
<option value='1.8'>1.8</option>
<option value='BRANCH-ERROR'>BRANCH-ERROR</option>
<option value='BRANCH-EVENTS2'>BRANCH-EVENTS2</option>
<option value='BRANCH-GSTREAMER-0_6'>BRANCH-GSTREAMER-0_6</option>
<option value='BRANCH-GSTREAMER-0_8'>BRANCH-GSTREAMER-0_8</option>
<option value='BRANCH-RELEASE-0_10_19'>BRANCH-RELEASE-0_10_19</option>
<option value='BRANCH-RELEASE-0_3_3'>BRANCH-RELEASE-0_3_3</option>
<option value='BRANCH-RELEASE-0_3_4'>BRANCH-RELEASE-0_3_4</option>
<option value='BRANCH-RELEASE-0_4_0'>BRANCH-RELEASE-0_4_0</option>
<option value='BRANCH-RELEASE-0_4_1'>BRANCH-RELEASE-0_4_1</option>
<option value='BRANCH-RELEASE-0_4_2'>BRANCH-RELEASE-0_4_2</option>
<option value='BRANCH-RELEASE-0_5_0'>BRANCH-RELEASE-0_5_0</option>
<option value='BRANCH-RELEASE-0_5_1'>BRANCH-RELEASE-0_5_1</option>
<option value='BRANCH-RELEASE-0_5_2'>BRANCH-RELEASE-0_5_2</option>
<option value='BRANCH-RELEASE-0_7_4'>BRANCH-RELEASE-0_7_4</option>
<option value='BRANCH-RELEASE-0_7_5'>BRANCH-RELEASE-0_7_5</option>
<option value='BRANCH-RELEASE-0_8_2'>BRANCH-RELEASE-0_8_2</option>
<option value='BRANCH-THREADED'>BRANCH-THREADED</option>
<option value='BRANCH_RELEASE-0_7_2'>BRANCH_RELEASE-0_7_2</option>
<option value='CAPS'>CAPS</option>
<option value='TYPEFIND'>TYPEFIND</option>
<option value='master' selected='selected'>master</option>
</select> <input type='submit' value='switch'/></form></td></tr>
<tr><td class='sub'>'Bad' GStreamer plugins and helper libraries  (mirrored from https://gitlab.freedesktop.org/gstreamer/gst-plugins-bad)</td><td class='sub right'>bilboed</td></tr></table>
<table class='tabs'><tr><td>
<a href='/gstreamer/gst-plugins-bad/'>summary</a><a href='/gstreamer/gst-plugins-bad/refs/?id=4cb1bcf1422bbcd79c0f683edb7ee85e3f7a31fe'>refs</a><a href='/gstreamer/gst-plugins-bad/log/gst/vmnc/vmncdec.c'>log</a><a href='/gstreamer/gst-plugins-bad/tree/gst/vmnc/vmncdec.c?id=4cb1bcf1422bbcd79c0f683edb7ee85e3f7a31fe'>tree</a><a class='active' href='/gstreamer/gst-plugins-bad/commit/gst/vmnc/vmncdec.c?id=4cb1bcf1422bbcd79c0f683edb7ee85e3f7a31fe'>commit</a><a href='/gstreamer/gst-plugins-bad/diff/gst/vmnc/vmncdec.c?id=4cb1bcf1422bbcd79c0f683edb7ee85e3f7a31fe'>diff</a></td><td class='form'><form class='right' method='get' action='/gstreamer/gst-plugins-bad/log/gst/vmnc/vmncdec.c'>
<input type='hidden' name='id' value='4cb1bcf1422bbcd79c0f683edb7ee85e3f7a31fe'/><select name='qt'>
<option value='grep'>log msg</option>
<option value='author'>author</option>
<option value='committer'>committer</option>
<option value='range'>range</option>
</select>
<input class='txt' type='search' size='10' name='q' value=''/>
<input type='submit' value='search'/>
</form>
</td></tr></table>
<div class='path'>path: <a href='/gstreamer/gst-plugins-bad/commit/?id=4cb1bcf1422bbcd79c0f683edb7ee85e3f7a31fe'>root</a>/<a href='/gstreamer/gst-plugins-bad/commit/gst?id=4cb1bcf1422bbcd79c0f683edb7ee85e3f7a31fe'>gst</a>/<a href='/gstreamer/gst-plugins-bad/commit/gst/vmnc?id=4cb1bcf1422bbcd79c0f683edb7ee85e3f7a31fe'>vmnc</a>/<a href='/gstreamer/gst-plugins-bad/commit/gst/vmnc/vmncdec.c?id=4cb1bcf1422bbcd79c0f683edb7ee85e3f7a31fe'>vmncdec.c</a></div><div class='content'><div class='cgit-panel'><b>diff options</b><form method='get'><input type='hidden' name='id' value='4cb1bcf1422bbcd79c0f683edb7ee85e3f7a31fe'/><table><tr><td colspan='2'/></tr><tr><td class='label'>context:</td><td class='ctrl'><select name='context' onchange='this.form.submit();'><option value='1'>1</option><option value='2'>2</option><option value='3' selected='selected'>3</option><option value='4'>4</option><option value='5'>5</option><option value='6'>6</option><option value='7'>7</option><option value='8'>8</option><option value='9'>9</option><option value='10'>10</option><option value='15'>15</option><option value='20'>20</option><option value='25'>25</option><option value='30'>30</option><option value='35'>35</option><option value='40'>40</option></select></td></tr><tr><td class='label'>space:</td><td class='ctrl'><select name='ignorews' onchange='this.form.submit();'><option value='0' selected='selected'>include</option><option value='1'>ignore</option></select></td></tr><tr><td class='label'>mode:</td><td class='ctrl'><select name='dt' onchange='this.form.submit();'><option value='0' selected='selected'>unified</option><option value='1'>ssdiff</option><option value='2'>stat only</option></select></td></tr><tr><td/><td class='ctrl'><noscript><input type='submit' value='reload'/></noscript></td></tr></table></form></div><table summary='commit info' class='commit-info'>
<tr><th>author</th><td>Sebastian Dröge &lt;sebastian@centricular.com&gt;</td><td class='right'>2016-11-16 20:41:39 +0200</td></tr>
<tr><th>committer</th><td>Sebastian Dröge &lt;sebastian@centricular.com&gt;</td><td class='right'>2016-11-16 20:41:39 +0200</td></tr>
<tr><th>commit</th><td colspan='2' class='sha1'><a href='/gstreamer/gst-plugins-bad/commit/gst/vmnc/vmncdec.c?id=4cb1bcf1422bbcd79c0f683edb7ee85e3f7a31fe'>4cb1bcf1422bbcd79c0f683edb7ee85e3f7a31fe</a> (<a href='/gstreamer/gst-plugins-bad/patch/gst/vmnc/vmncdec.c?id=4cb1bcf1422bbcd79c0f683edb7ee85e3f7a31fe'>patch</a>)</td></tr>
<tr><th>tree</th><td colspan='2' class='sha1'><a href='/gstreamer/gst-plugins-bad/tree/?id=4cb1bcf1422bbcd79c0f683edb7ee85e3f7a31fe'>30ba305eb7f43a7d5a6c0ee8195db8d360d9873c</a> /<a href='/gstreamer/gst-plugins-bad/tree/gst/vmnc/vmncdec.c?id=4cb1bcf1422bbcd79c0f683edb7ee85e3f7a31fe'>gst/vmnc/vmncdec.c</a></td></tr>
<tr><th>parent</th><td colspan='2' class='sha1'><a href='/gstreamer/gst-plugins-bad/commit/gst/vmnc/vmncdec.c?id=c7192f045009ec4a7cf6d1026f226bb3426f1fd0'>c7192f045009ec4a7cf6d1026f226bb3426f1fd0</a> (<a href='/gstreamer/gst-plugins-bad/diff/gst/vmnc/vmncdec.c?id=4cb1bcf1422bbcd79c0f683edb7ee85e3f7a31fe&amp;id2=c7192f045009ec4a7cf6d1026f226bb3426f1fd0'>diff</a>)</td></tr></table>
<div class='commit-subject'>vmncdec: Sanity-check width/height before using it</div><div class='commit-msg'>We will allocate a screen area of width*height*bpp bytes, however this
calculation can easily overflow if too high width or height are given
inside the stream. Nonetheless we would just assume that enough memory
was allocated, try to fill it and overwrite as much memory as wanted.

Also allocate the screen area filled with zeroes to ensure that we start
with full-black and not any random (or not so random) data.

https://scarybeastsecurity.blogspot.gr/2016/11/0day-poc-risky-design-decisions-in.html

Ideally we should just remove this plugin in favour of the one in
gst-libav, which generally seems to be of better code quality.

https://bugzilla.gnome.org/show_bug.cgi?id=774533
</div><div class='diffstat-header'><a href='/gstreamer/gst-plugins-bad/diff/?id=4cb1bcf1422bbcd79c0f683edb7ee85e3f7a31fe'>Diffstat</a> (limited to 'gst/vmnc/vmncdec.c')</div><table summary='diffstat' class='diffstat'><tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/gstreamer/gst-plugins-bad/diff/gst/vmnc/vmncdec.c?id=4cb1bcf1422bbcd79c0f683edb7ee85e3f7a31fe'>gst/vmnc/vmncdec.c</a></td><td class='right'>6</td><td class='graph'><table summary='file diffstat' width='6%'><tr><td class='add' style='width: 83.3%;'/><td class='rem' style='width: 16.7%;'/><td class='none' style='width: 0.0%;'/></tr></table></td></tr>
</table><div class='diffstat-summary'>1 files changed, 5 insertions, 1 deletions</div><table summary='diff' class='diff'><tr><td><div class='head'>diff --git a/gst/vmnc/vmncdec.c b/gst/vmnc/vmncdec.c<br/>index e8d498c27..b3c977883 100644<br/>--- a/<a href='/gstreamer/gst-plugins-bad/tree/gst/vmnc/vmncdec.c?id=c7192f045009ec4a7cf6d1026f226bb3426f1fd0'>gst/vmnc/vmncdec.c</a><br/>+++ b/<a href='/gstreamer/gst-plugins-bad/tree/gst/vmnc/vmncdec.c?id=4cb1bcf1422bbcd79c0f683edb7ee85e3f7a31fe'>gst/vmnc/vmncdec.c</a></div><div class='hunk'>@@ -260,7 +260,7 @@ vmnc_handle_wmvi_rectangle (GstVMncDec * dec, struct RfbRectangle *rect,</div><div class='ctx'>   gst_video_codec_state_unref (state);</div><div class='ctx'> </div><div class='ctx'>   g_free (dec-&gt;imagedata);</div><div class='del'>-  dec-&gt;imagedata = g_malloc (dec-&gt;format.width * dec-&gt;format.height *</div><div class='add'>+  dec-&gt;imagedata = g_malloc0 (dec-&gt;format.width * dec-&gt;format.height *</div><div class='ctx'>       dec-&gt;format.bytes_per_pixel);</div><div class='ctx'>   GST_DEBUG_OBJECT (dec, "Allocated image data at %p", dec-&gt;imagedata);</div><div class='ctx'> </div><div class='hunk'>@@ -790,6 +790,10 @@ vmnc_handle_packet (GstVMncDec * dec, const guint8 * data, int len,</div><div class='ctx'>             GST_WARNING_OBJECT (dec, "Rectangle out of range, type %d", r.type);</div><div class='ctx'>             return ERROR_INVALID;</div><div class='ctx'>           }</div><div class='add'>+        } else if (r.width &gt; 16384 || r.height &gt; 16384) {</div><div class='add'>+          GST_WARNING_OBJECT (dec, "Width or height too high: %ux%u", r.width,</div><div class='add'>+              r.height);</div><div class='add'>+          return ERROR_INVALID;</div><div class='ctx'>         }</div><div class='ctx'> </div><div class='ctx'>         switch (r.type) {</div></td></tr></table></div> <!-- class=content -->
<div class='footer'>generated by <a href='https://git.zx2c4.com/cgit/about/'>cgit v1.2.1</a> (<a href='https://git-scm.com/'>git 2.18.0</a>) at 2021-10-30 22:00:08 +0000</div>
</div> <!-- id=cgit -->
</body>
</html>
