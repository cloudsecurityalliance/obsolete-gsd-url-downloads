<!DOCTYPE html>
<html lang="en">
  <head>
    <title>19086 &ndash; Multiple cross-site scripting vulnerabilities</title>

      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<link href="data/assets/4d521b9c27366343a6b4d89373a49afb.css" rel="stylesheet" type="text/css">



    
<script type="text/javascript" src="data/assets/a7c2f3a028f17a9aa60f56dc9d6e732d.js"></script>

    <script type="text/javascript">
    <!--
        YAHOO.namespace('bugzilla');
        YAHOO.util.Event.addListener = function (el, sType, fn, obj, overrideContext) {
               if ( ("onpagehide" in window || YAHOO.env.ua.gecko) && sType === "unload") { sType = "pagehide"; };
               var capture = ((sType == "focusin" || sType == "focusout") && !YAHOO.env.ua.ie) ? true : false;
               return this._addListener(el, this._getType(sType), fn, obj, overrideContext, capture);
         };
        if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
            YAHOO.util.Event._simpleRemove(window, "unload", 
                                           YAHOO.util.Event._unload);
        }
        
        function unhide_language_selector() { 
            YAHOO.util.Dom.removeClass(
                'lang_links_container', 'bz_default_hidden'
            ); 
        } 
        YAHOO.util.Event.onDOMReady(unhide_language_selector);

        
        var BUGZILLA = {
            param: {
                cookiepath: '\/',
                maxusermatches: 1000
            },
            constant: {
                COMMENT_COLS: 80
            },
            string: {
                

                attach_desc_required:
                    "You must enter a Description for this attachment.",
                component_required:
                    "You must select a Component for this bug.",
                description_required:
                    "You must enter a Description for this bug.",
                short_desc_required:
                    "You must enter a Summary for this bug.",
                version_required:
                    "You must select a Version for this bug."
            }
              , api_token: ''
        };

    if (history && history.replaceState) {
      if(!document.location.href.match(/show_bug\.cgi/)) {
        history.replaceState( null,
                             "19086 – Multiple cross-site scripting vulnerabilities",
                             "show_bug.cgi?id=19086" );
        document.title = "19086 – Multiple cross-site scripting vulnerabilities";
      }
      if (document.location.href.match(/show_bug\.cgi\?.*list_id=/)) {
        var href = document.location.href;
        href = href.replace(/[\?&]+list_id=(\d+|cookie)/, '');
        history.replaceState(null, "19086 – Multiple cross-site scripting vulnerabilities", href);
      }
    }
    YAHOO.util.Event.onDOMReady(function() {
      initDirtyFieldTracking();

    });
    // -->
    </script>
<script type="text/javascript" src="data/assets/daf5e0fb6826e6a35280e622913f0c4a.js"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla" href="./search_plugin.cgi">
    <link rel="shortcut icon" href="images/favicon.ico"><meta name="robots" content="noarchive">
  </head>

  <body 
        class="bugs-koha-community-org-bugzilla3
                 bz_bug
                 bz_status_CLOSED
                 bz_product_Koha
                 bz_component_Architecture&#X2C;_internals&#X2C;_and_plumbing
                 bz_bug_19086 yui-skin-sam">

  <div id="header"><div id="banner">
  </div>

    <div id="titles">
      <span id="title">Bugzilla &ndash; Bug&nbsp;19086</span>

        <span id="subtitle" class="subheader">Multiple cross-site scripting vulnerabilities</span>

        <span id="information" class="header_addl_info">Last modified: 2019-10-14 19:58:24 UTC</span>
    </div>


    <div id="common_links"><ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi">New</a></li>
  <li><span class="separator">| </span><a href="describecomponents.cgi">Browse</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_top" name="no_redirect" value="0">
    <script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_top");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_top" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_top"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li></li>


  <li>
        <span class="separator">| </span>
        <a href="https://bugzilla.readthedocs.org/en/5.0/using/understanding.html" target="_blank">Help</a>
      </li>
    
      <li id="new_account_container_top">
        <span class="separator">| </span>
        <a href="createaccount.cgi">New&nbsp;Account</a>
      </li>

    <li id="mini_login_container_top">
  <span class="separator">| </span>
  <a id="login_link_top" href="show_bug.cgi?id=19086&amp;GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('_top')">Log In</a>

  <form action="show_bug.cgi?id=19086" method="POST"
        class="mini_login bz_default_hidden"
        id="mini_login_top">
    <input id="Bugzilla_login_top" required
           name="Bugzilla_login" class="bz_login"
        type="email" placeholder="Email Address">
    <input class="bz_password" name="Bugzilla_password" type="password"
           id="Bugzilla_password_top" required
           placeholder="Password">
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
            id="log_in_top">
    <a href="#" onclick="return hide_mini_login_form('_top')">[x]</a>
  </form>
</li>


  <li id="forgot_container_top">
    <span class="separator">| </span>
    <a id="forgot_link_top" href="show_bug.cgi?id=19086&amp;GoAheadAndLogIn=1#forgot"
       onclick="return show_forgot_form('_top')">Forgot Password</a>
    <form action="token.cgi" method="post" id="forgot_form_top"
          class="mini_forgot bz_default_hidden">
      <label for="login_top">Login:</label>
      <input name="loginname" size="20" id="login_top" required
          type="email" placeholder="Your Email Address">
      <input id="forgot_button_top" value="Reset Password" type="submit">
      <input type="hidden" name="a" value="reqpw">
      <input type="hidden" id="token_top" name="token"
             value="1635619463-Q_Zy55MhXvqexBAqnD2HEwZ9zaWWnqFwHpeWl_Gz6zs">
      <a href="#" onclick="return hide_forgot_form('_top')">[x]</a>
    </form>
  </li>
</ul>
    </div>
  </div>

  <div id="bugzilla-body">


<script type="text/javascript">
<!--

//-->
</script>

<form name="changeform" id="changeform" method="post" action="process_bug.cgi">

  <input type="hidden" name="delta_ts" value="2019-10-14 19:58:24">
  <input type="hidden" name="id" value="19086">
  <input type="hidden" name="token" value="1635619463-KrPgyYmghQceGTTXHnAXHiXF0Ml5_pgpSJcjk_MBVtg">
<div class="bz_short_desc_container edit_form">
     <a href="show_bug.cgi?id=19086"><b>Bug&nbsp;19086</b></a> <span id="summary_container" class="bz_default_hidden">
      - <span id="short_desc_nonedit_display">Multiple cross-site scripting vulnerabilities</span>
     </span>

    <div id="summary_input"><span class="field_label "
    id="field_label_short_desc">


  <a 
      title="The bug summary is a short sentence which succinctly describes what the bug is about."
      class="field_help_link"
      href="page.cgi?id=fields.html#short_desc"
  >Summary:</a>

</span>Multiple cross-site scripting vulnerabilities
    </div>
  </div>
  <script type="text/javascript">
    hideEditableField('summary_container',
                      'summary_input',
                      'summary_edit_action',
                      'short_desc',
                      'Multiple cross-site scripting vulnerabilities' );
  </script>
  <table class="edit_form">
    <tr>
      
      <td id="bz_show_bug_column_1" class="bz_show_bug_column">     
        <table>
          <tr>
    <th class="field_label">
      <a href="page.cgi?id=fields.html#bug_status">Status</a>:
    </th>
    <td id="bz_field_status">
      <span id="static_bug_status">CLOSED
          FIXED
      </span>
    </td>
  </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_alias">


  <a 
      title="A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla."
      class="field_help_link"
      href="page.cgi?id=fields.html#alias"
  >Alias:</a>

</th>
    <td>
        None
    </td>
  </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_product">


  <a 
      title="Bugs are categorised into Products and Components."
      class="field_help_link"
      href="describecomponents.cgi"
  >Product:</a>

</th>
  <td class="field_value "
      id="field_container_product" >Koha

</td>
    </tr>

    
    <tr class="bz_default_hidden"><th class="field_label "
    id="field_label_classification">


  <a 
      title="Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation."
      class="field_help_link"
      href="page.cgi?id=fields.html#classification"
  >Classification:</a>

</th>
  <td class="field_value "
      id="field_container_classification" >Unclassified

</td>
    </tr>
        
    
    
    <tr><th class="field_label "
    id="field_label_component">


  <a 
      title="Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list."
      class="field_help_link"
      href="describecomponents.cgi?product=Koha"
  >Component:</a>

</th>
  <td class="field_value "
      id="field_container_component" >Architecture, internals, and plumbing

  (<a href="buglist.cgi?component=Architecture%2C%20internals%2C%20and%20plumbing&amp;product=Koha&amp;bug_status=__open__"
      target="_blank">show other bugs</a>)
</td>
    </tr>
    <tr><th class="field_label "
    id="field_label_version">


  <a 
      title="The version field defines the version of the software the bug was found in."
      class="field_help_link"
      href="page.cgi?id=fields.html#version"
  >Version:</a>

</th>
<td>unspecified
  </td>
    </tr>
        
    
        
    <tr><th class="field_label "
    id="field_label_rep_platform">


  <a 
      title="The hardware platform the bug was observed on. Note: When searching, selecting the option &quot;All&quot; only finds bugs whose value for this field is literally the word &quot;All&quot;."
      class="field_help_link"
      href="page.cgi?id=fields.html#rep_platform"
  >Hardware:</a>

</th>
      <td class="field_value">All
        All
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          
          <tr>
      <th class="field_label">
        <label  accesskey="i">
          <a href="page.cgi?id=fields.html#importance"><u>I</u>mportance</a></label>:
      </th>
      <td>P5 - low
       major<span id="votes_container">
    (<a href="page.cgi?id=voting/user.html&amp;bug_id=19086#vote_19086">vote</a>)
  </span>
      </td>
    </tr>
          
          <tr><th class="field_label "
    id="field_label_assigned_to">


  <a 
      title="The person in charge of resolving the bug."
      class="field_help_link"
      href="page.cgi?id=fields.html#assigned_to"
  >Assignee:</a>

</th>
      <td><span class="vcard"><span class="fn">Bugs List</span>
</span>
      </td>
    </tr>

    <tr><th class="field_label "
    id="field_label_qa_contact">


  <a 
      title="The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#qa_contact"
  >QA Contact:</a>

</th>
      <td><span class="vcard"><span class="fn">Marcel de Rooy</span>
</span>
      </td>
    </tr>
    <script type="text/javascript">
      assignToDefaultOnChange(['product', 'component'],
        'koha-bugs\x40lists.koha-community.org',
        'testopia\x40bugs.koha-community.org');
    </script>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr><th class="field_label "
    id="field_label_bug_file_loc">


  <a 
      title="Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen."
      class="field_help_link"
      href="page.cgi?id=fields.html#bug_file_loc"
  >URL:</a>

</th>
    <td>
      <span id="bz_url_input_area">
      </span>
    </td>
  </tr>


    <tr><th class="field_label "
    id="field_label_keywords">


  <a 
      title="You can add keywords from a defined list to bugs, in order to easily identify and group them."
      class="field_help_link"
      href="describekeywords.cgi"
  >Keywords:</a>

</th>
  <td class="field_value "
      id="field_container_keywords" >

</td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>

          <tr>
    <th class="field_label">
      <label>Duplicates (1)</label>:
    </th>
    <td class="field_value">
      <span id="duplicates"><a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE"
   href="show_bug.cgi?id=19362">19362</a> 
      </span>
      (<a href="buglist.cgi?bug_id=19362">view as bug list</a>)
    </td>
  </tr>
<tr><th class="field_label "
    id="field_label_dependson">


  <a 
      title="The bugs listed here must be resolved before this bug can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#dependson"
  >Depends on:</a>

</th>

  <td>
    <span id="dependson_input_area">
    </span>

  </td>
  </tr>
  
  <tr><th class="field_label "
    id="field_label_blocked">


  <a 
      title="This bug must be resolved before the bugs listed in this field can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#blocked"
  >Blocks:</a>

</th>

  <td>
    <span id="blocked_input_area">
    </span>
<a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED FIXED"
   href="show_bug.cgi?id=14568">14568</a> 
  </td>
  </tr>

    <tr>
      <th>&nbsp;</th>

      <td id="show_dependency_tree_or_graph">
        Show dependency <a href="showdependencytree.cgi?id=19086&amp;hide_resolved=1">tree</a>

          /&nbsp;<a href="showdependencygraph.cgi?id=19086">graph</a>
      </td>
    </tr>
          
        </table>
      </td>
      <td>
        <div class="bz_column_spacer">&nbsp;</div>
      </td>
      
      <td id="bz_show_bug_column_2" class="bz_show_bug_column">
        <table>
        <tr>
    <th class="field_label">
      Reported:
    </th>
    <td>2017-08-11 10:57 UTC by <span class="vcard"><span class="fn">Jiaky Ooi</span>
</span>
    </td>
  </tr>
  
  <tr>
    <th class="field_label">
      Modified:
    </th>
    <td>2019-10-14 19:58 UTC
      (<a href="show_activity.cgi?id=19086">History</a>)
    </td>
  
  </tr>
<tr>
      <th class="field_label">
        <label  accesskey="a">
          CC List:
        </label>
      </th>
      <td>10 
          users
          <span id="cc_edit_area_showhide_container" class="bz_default_hidden">
            (<a href="#" id="cc_edit_area_showhide">show</a>)
          </span>
        <div id="cc_edit_area">
          <br>
            <select id="cc" multiple="multiple" size="5" >
                <option value="amit.gupta">amit.gupta</option>
                <option value="amitddng135">amitddng135</option>
                <option value="fridolin.somers">fridolin.somers</option>
                <option value="jonathan.druart+koha">jonathan.druart+koha</option>
                <option value="katrin.fischer">katrin.fischer</option>
                <option value="kyle">kyle</option>
                <option value="m.de.rooy">m.de.rooy</option>
                <option value="mtj">mtj</option>
                <option value="nick">nick</option>
                <option value="tomascohen">tomascohen</option>
            </select>
        </div>
          <script type="text/javascript">
            hideEditableField( 'cc_edit_area_showhide_container', 
                               'cc_edit_area', 
                               'cc_edit_area_showhide', 
                               '', 
                               '');  
          </script>
      </td>
    </tr>

<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_see_also">


  <a 
      title="This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields."
      class="field_help_link"
      href="page.cgi?id=fields.html#see_also"
  >See Also:</a>

</th>
  <td class="field_value "
      id="field_container_see_also" >

</td>
    </tr> 
<tr>
      <th class="field_label "
    id="field_label_cf_sponsorship">


  <a 
      title="A custom Drop Down field in this installation of Bugzilla."
      class="field_help_link"
      href="page.cgi?id=fields.html#cf_sponsorship"
  >Change sponsored?:</a>

</th>
  <td class="field_value "
      id="field_container_cf_sponsorship" >---

</td>
    </tr>
    <tr>
      <th class="field_label "
    id="field_label_cf_patch_complexity">


  <a 
      title="A custom Drop Down field in this installation of Bugzilla."
      class="field_help_link"
      href="page.cgi?id=fields.html#cf_patch_complexity"
  >Patch complexity:</a>

</th>
  <td class="field_value "
      id="field_container_cf_patch_complexity" >Small patch

</td>
    </tr>
    <tr>
      <th class="field_label "
    id="field_label_cf_release_notes">


  <a 
      title="A custom Large Text Box field in this installation of Bugzilla."
      class="field_help_link"
      href="page.cgi?id=fields.html#cf_release_notes"
  >Text to go in the release notes:</a>

</th>
  <td class="field_value "
      id="field_container_cf_release_notes" >
      <div class="uneditable_textarea"></div>

</td>
    </tr>
    <tr>
      <th class="field_label "
    id="field_label_cf_release_version">


  <a 
      title="A custom Large Text Box field in this installation of Bugzilla."
      class="field_help_link"
      href="page.cgi?id=fields.html#cf_release_version"
  >Version(s) released in:</a>

</th>
  <td class="field_value "
      id="field_container_cf_release_version" >
      <div class="uneditable_textarea"></div>

</td>
    </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>



        </table>
      </td>
    </tr>
    <tr>
      <td colspan="3">
          <hr id="bz_top_half_spacer">
      </td>
    </tr>
  </table>

  <table id="bz_big_form_parts">
  <tr>
  <td>

    
<script type="text/javascript">
<!--
function toggle_display(link) {
    var table = document.getElementById("attachment_table");
    var view_all = document.getElementById("view_all");
    var hide_obsolete_url_parameter = "&hide_obsolete=1";
    // Store current height for scrolling later
    var originalHeight = table.offsetHeight;
    var rows = YAHOO.util.Dom.getElementsByClassName(
        'bz_tr_obsolete', 'tr', table);

    for (var i = 0; i < rows.length; i++) {
        bz_toggleClass(rows[i], 'bz_default_hidden');
    }

    if (YAHOO.util.Dom.hasClass(rows[0], 'bz_default_hidden')) {
        link.innerHTML = "Show Obsolete";
        view_all.href = view_all.href + hide_obsolete_url_parameter 
    }
    else {
        link.innerHTML = "Hide Obsolete";
        view_all.href = view_all.href.replace(hide_obsolete_url_parameter,"");
    }

    var newHeight = table.offsetHeight;
    // This scrolling makes the window appear to not move at all.
    window.scrollBy(0, newHeight - originalHeight);

    return false;
}
//-->
</script>

<br>
<table id="attachment_table">
  <tr id="a0">
    <th colspan="2" class="left">
      Attachments
    </th>
  </tr>


      <tr id="a1" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td>
            <a href="attachment.cgi?id=65927"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">Bug 19086 XSS in members/member.pl</span></b></a>

          <span class="bz_attach_extra_info">
              (1.65 KB,
                patch)

            <br>
            <a href="#attach_65927"
               title="Go to the comment associated with the attachment">2017-08-11 19:42 UTC</a>,

            <span class="vcard"><span class="fn">Chris Cormack</span>
</span>
          </span>
        </td>


        <td>
          <a href="attachment.cgi?id=65927&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=65927&amp;action=diff">Diff</a>&#x0020; |
    <a href="https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=65927">
      Splinter Review</a>
        </td>
      </tr>
      <tr id="a2" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td>
            <a href="attachment.cgi?id=65929"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">Bug 19086 Stored XSS in circulation.pl</span></b></a>

          <span class="bz_attach_extra_info">
              (1.77 KB,
                patch)

            <br>
            <a href="#attach_65929"
               title="Go to the comment associated with the attachment">2017-08-11 19:56 UTC</a>,

            <span class="vcard"><span class="fn">Chris Cormack</span>
</span>
          </span>
        </td>


        <td>
          <a href="attachment.cgi?id=65929&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=65929&amp;action=diff">Diff</a>&#x0020; |
    <a href="https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=65929">
      Splinter Review</a>
        </td>
      </tr>
      <tr id="a3" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td>
            <a href="attachment.cgi?id=65958"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">Bug 19086 XSS in members/member.pl</span></b></a>

          <span class="bz_attach_extra_info">
              (1.71 KB,
                patch)

            <br>
            <a href="#attach_65958"
               title="Go to the comment associated with the attachment">2017-08-14 16:09 UTC</a>,

            <span class="vcard"><span class="fn">Amit Gupta</span>
</span>
          </span>
        </td>


        <td>
          <a href="attachment.cgi?id=65958&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=65958&amp;action=diff">Diff</a>&#x0020; |
    <a href="https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=65958">
      Splinter Review</a>
        </td>
      </tr>
      <tr id="a4" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td>
            <a href="attachment.cgi?id=65960"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">Bug 19086 Stored XSS in circulation.pl</span></b></a>

          <span class="bz_attach_extra_info">
              (1.32 KB,
                patch)

            <br>
            <a href="#attach_65960"
               title="Go to the comment associated with the attachment">2017-08-14 16:22 UTC</a>,

            <span class="vcard"><span class="fn">Amit Gupta</span>
</span>
          </span>
        </td>


        <td>
          <a href="attachment.cgi?id=65960&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=65960&amp;action=diff">Diff</a>&#x0020; |
    <a href="https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=65960">
      Splinter Review</a>
        </td>
      </tr>
      <tr id="a5" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td>
            <a href="attachment.cgi?id=65965"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">Bug 19086 Stored XSS in routing-lists.pl</span></b></a>

          <span class="bz_attach_extra_info">
              (1.24 KB,
                patch)

            <br>
            <a href="#attach_65965"
               title="Go to the comment associated with the attachment">2017-08-14 16:54 UTC</a>,

            <span class="vcard"><span class="fn">Amit Gupta</span>
</span>
          </span>
        </td>


        <td>
          <a href="attachment.cgi?id=65965&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=65965&amp;action=diff">Diff</a>&#x0020; |
    <a href="https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=65965">
      Splinter Review</a>
        </td>
      </tr>
      <tr id="a6" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td>
            <a href="attachment.cgi?id=65966"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">Bug 19086 Stored XSS in readingrec.pl</span></b></a>

          <span class="bz_attach_extra_info">
              (1.39 KB,
                patch)

            <br>
            <a href="#attach_65966"
               title="Go to the comment associated with the attachment">2017-08-14 16:59 UTC</a>,

            <span class="vcard"><span class="fn">Amit Gupta</span>
</span>
          </span>
        </td>


        <td>
          <a href="attachment.cgi?id=65966&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=65966&amp;action=diff">Diff</a>&#x0020; |
    <a href="https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=65966">
      Splinter Review</a>
        </td>
      </tr>
      <tr id="a7" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td>
            <a href="attachment.cgi?id=65967"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">Bug 19086 Stored XSS in notices.pl</span></b></a>

          <span class="bz_attach_extra_info">
              (1.17 KB,
                patch)

            <br>
            <a href="#attach_65967"
               title="Go to the comment associated with the attachment">2017-08-14 17:02 UTC</a>,

            <span class="vcard"><span class="fn">Amit Gupta</span>
</span>
          </span>
        </td>


        <td>
          <a href="attachment.cgi?id=65967&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=65967&amp;action=diff">Diff</a>&#x0020; |
    <a href="https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=65967">
      Splinter Review</a>
        </td>
      </tr>
      <tr id="a8" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td>
            <a href="attachment.cgi?id=65968"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">Bug 19086 Stored XSS in maninvoice.pl</span></b></a>

          <span class="bz_attach_extra_info">
              (1.21 KB,
                patch)

            <br>
            <a href="#attach_65968"
               title="Go to the comment associated with the attachment">2017-08-14 17:08 UTC</a>,

            <span class="vcard"><span class="fn">Amit Gupta</span>
</span>
          </span>
        </td>


        <td>
          <a href="attachment.cgi?id=65968&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=65968&amp;action=diff">Diff</a>&#x0020; |
    <a href="https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=65968">
      Splinter Review</a>
        </td>
      </tr>
      <tr id="a9" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td>
            <a href="attachment.cgi?id=65969"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">Bug 19086 Stored XSS in boraccount.pl</span></b></a>

          <span class="bz_attach_extra_info">
              (1.19 KB,
                patch)

            <br>
            <a href="#attach_65969"
               title="Go to the comment associated with the attachment">2017-08-14 17:13 UTC</a>,

            <span class="vcard"><span class="fn">Amit Gupta</span>
</span>
          </span>
        </td>


        <td>
          <a href="attachment.cgi?id=65969&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=65969&amp;action=diff">Diff</a>&#x0020; |
    <a href="https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=65969">
      Splinter Review</a>
        </td>
      </tr>
      <tr id="a10" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td>
            <a href="attachment.cgi?id=65970"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">Bug 19086 Stored XSS in mancredit.pl</span></b></a>

          <span class="bz_attach_extra_info">
              (1.22 KB,
                patch)

            <br>
            <a href="#attach_65970"
               title="Go to the comment associated with the attachment">2017-08-14 17:16 UTC</a>,

            <span class="vcard"><span class="fn">Amit Gupta</span>
</span>
          </span>
        </td>


        <td>
          <a href="attachment.cgi?id=65970&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=65970&amp;action=diff">Diff</a>&#x0020; |
    <a href="https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=65970">
      Splinter Review</a>
        </td>
      </tr>
      <tr id="a11" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td>
            <a href="attachment.cgi?id=65972"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">Bug 19086 Stored XSS in circulation.pl</span></b></a>

          <span class="bz_attach_extra_info">
              (1.83 KB,
                patch)

            <br>
            <a href="#attach_65972"
               title="Go to the comment associated with the attachment">2017-08-14 19:24 UTC</a>,

            <span class="vcard"><span class="fn">Amit Gupta</span>
</span>
          </span>
        </td>


        <td>
          <a href="attachment.cgi?id=65972&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=65972&amp;action=diff">Diff</a>&#x0020; |
    <a href="https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=65972">
      Splinter Review</a>
        </td>
      </tr>
      <tr id="a12" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td>
            <a href="attachment.cgi?id=65984"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">Bug 19086 Stored XSS in /cgi-bin/koha/acqui/supplier.pl?op=enter</span></b></a>

          <span class="bz_attach_extra_info">
              (3.75 KB,
                patch)

            <br>
            <a href="#attach_65984"
               title="Go to the comment associated with the attachment">2017-08-14 21:10 UTC</a>,

            <span class="vcard"><span class="fn">Amit Gupta</span>
</span>
          </span>
        </td>


        <td>
          <a href="attachment.cgi?id=65984&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=65984&amp;action=diff">Diff</a>&#x0020; |
    <a href="https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=65984">
      Splinter Review</a>
        </td>
      </tr>
      <tr id="a13" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td>
            <a href="attachment.cgi?id=65985"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">Bug 19086 Stored XSS in subscription-add.pl</span></b></a>

          <span class="bz_attach_extra_info">
              (1.80 KB,
                patch)

            <br>
            <a href="#attach_65985"
               title="Go to the comment associated with the attachment">2017-08-14 21:21 UTC</a>,

            <span class="vcard"><span class="fn">Amit Gupta</span>
</span>
          </span>
        </td>


        <td>
          <a href="attachment.cgi?id=65985&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=65985&amp;action=diff">Diff</a>&#x0020; |
    <a href="https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=65985">
      Splinter Review</a>
        </td>
      </tr>
      <tr id="a14" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td>
            <a href="attachment.cgi?id=65986"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">Bug 19086 Stored XSS in supplier.pl</span></b></a>

          <span class="bz_attach_extra_info">
              (3.76 KB,
                patch)

            <br>
            <a href="#attach_65986"
               title="Go to the comment associated with the attachment">2017-08-14 21:30 UTC</a>,

            <span class="vcard"><span class="fn">Amit Gupta</span>
</span>
          </span>
        </td>


        <td>
          <a href="attachment.cgi?id=65986&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=65986&amp;action=diff">Diff</a>&#x0020; |
    <a href="https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=65986">
      Splinter Review</a>
        </td>
      </tr>
      <tr id="a15" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td>
            <a href="attachment.cgi?id=65987"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">Bug 19086 Stored XSS in subscription-add.pl</span></b></a>

          <span class="bz_attach_extra_info">
              (1.86 KB,
                patch)

            <br>
            <a href="#attach_65987"
               title="Go to the comment associated with the attachment">2017-08-14 21:33 UTC</a>,

            <span class="vcard"><span class="fn">Amit Gupta</span>
</span>
          </span>
        </td>


        <td>
          <a href="attachment.cgi?id=65987&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=65987&amp;action=diff">Diff</a>&#x0020; |
    <a href="https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=65987">
      Splinter Review</a>
        </td>
      </tr>
      <tr id="a16" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td>
            <a href="attachment.cgi?id=66058"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">[SIGNED OFF] Bug 19086 XSS in members/member.pl</span></b></a>

          <span class="bz_attach_extra_info">
              (1.78 KB,
                patch)

            <br>
            <a href="#attach_66058"
               title="Go to the comment associated with the attachment">2017-08-16 11:08 UTC</a>,

            <span class="vcard"><span class="fn">Katrin Fischer</span>
</span>
          </span>
        </td>


        <td>
          <a href="attachment.cgi?id=66058&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=66058&amp;action=diff">Diff</a>&#x0020; |
    <a href="https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=66058">
      Splinter Review</a>
        </td>
      </tr>
      <tr id="a17" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td>
            <a href="attachment.cgi?id=66059"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">[SIGNED OFF] Bug 19086 Stored XSS in circulation.pl</span></b></a>

          <span class="bz_attach_extra_info">
              (1.90 KB,
                patch)

            <br>
            <a href="#attach_66059"
               title="Go to the comment associated with the attachment">2017-08-16 11:08 UTC</a>,

            <span class="vcard"><span class="fn">Katrin Fischer</span>
</span>
          </span>
        </td>


        <td>
          <a href="attachment.cgi?id=66059&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=66059&amp;action=diff">Diff</a>&#x0020; |
    <a href="https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=66059">
      Splinter Review</a>
        </td>
      </tr>
      <tr id="a18" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td>
            <a href="attachment.cgi?id=66060"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">[SIGNED OFF] Bug 19086 Stored XSS in supplier.pl</span></b></a>

          <span class="bz_attach_extra_info">
              (3.83 KB,
                patch)

            <br>
            <a href="#attach_66060"
               title="Go to the comment associated with the attachment">2017-08-16 11:08 UTC</a>,

            <span class="vcard"><span class="fn">Katrin Fischer</span>
</span>
          </span>
        </td>


        <td>
          <a href="attachment.cgi?id=66060&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=66060&amp;action=diff">Diff</a>&#x0020; |
    <a href="https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=66060">
      Splinter Review</a>
        </td>
      </tr>
      <tr id="a19" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td>
            <a href="attachment.cgi?id=66061"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">[SIGNED OFF] Bug 19086 Stored XSS in subscription-add.pl</span></b></a>

          <span class="bz_attach_extra_info">
              (1.94 KB,
                patch)

            <br>
            <a href="#attach_66061"
               title="Go to the comment associated with the attachment">2017-08-16 11:08 UTC</a>,

            <span class="vcard"><span class="fn">Katrin Fischer</span>
</span>
          </span>
        </td>


        <td>
          <a href="attachment.cgi?id=66061&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=66061&amp;action=diff">Diff</a>&#x0020; |
    <a href="https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=66061">
      Splinter Review</a>
        </td>
      </tr>
      <tr id="a20" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td>
            <a href="attachment.cgi?id=66062"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">Bug 19086 - Follow-up - XSS in supplier.tt</span></b></a>

          <span class="bz_attach_extra_info">
              (3.20 KB,
                patch)

            <br>
            <a href="#attach_66062"
               title="Go to the comment associated with the attachment">2017-08-16 11:08 UTC</a>,

            <span class="vcard"><span class="fn">Katrin Fischer</span>
</span>
          </span>
        </td>


        <td>
          <a href="attachment.cgi?id=66062&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=66062&amp;action=diff">Diff</a>&#x0020; |
    <a href="https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=66062">
      Splinter Review</a>
        </td>
      </tr>
      <tr id="a21" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td>
            <a href="attachment.cgi?id=66063"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">Bug 19086 - Follow-up - subscription-detail.pl</span></b></a>

          <span class="bz_attach_extra_info">
              (1.51 KB,
                patch)

            <br>
            <a href="#attach_66063"
               title="Go to the comment associated with the attachment">2017-08-16 11:08 UTC</a>,

            <span class="vcard"><span class="fn">Katrin Fischer</span>
</span>
          </span>
        </td>


        <td>
          <a href="attachment.cgi?id=66063&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=66063&amp;action=diff">Diff</a>&#x0020; |
    <a href="https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=66063">
      Splinter Review</a>
        </td>
      </tr>
      <tr id="a22" class="bz_contenttype_text_plain bz_patch">
        <td>
            <a href="attachment.cgi?id=66433"
               title="View the content of the attachment">
          <b>Bug 19086 XSS in members/member.pl</b></a>

          <span class="bz_attach_extra_info">
              (1.86 KB,
                patch)

            <br>
            <a href="#attach_66433"
               title="Go to the comment associated with the attachment">2017-08-25 06:13 UTC</a>,

            <span class="vcard"><span class="fn">Marcel de Rooy</span>
</span>
          </span>
        </td>


        <td>
          <a href="attachment.cgi?id=66433&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=66433&amp;action=diff">Diff</a>&#x0020; |
    <a href="https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=66433">
      Splinter Review</a>
        </td>
      </tr>
      <tr id="a23" class="bz_contenttype_text_plain bz_patch">
        <td>
            <a href="attachment.cgi?id=66434"
               title="View the content of the attachment">
          <b>Bug 19086 Stored XSS in circulation.pl</b></a>

          <span class="bz_attach_extra_info">
              (1.98 KB,
                patch)

            <br>
            <a href="#attach_66434"
               title="Go to the comment associated with the attachment">2017-08-25 06:13 UTC</a>,

            <span class="vcard"><span class="fn">Marcel de Rooy</span>
</span>
          </span>
        </td>


        <td>
          <a href="attachment.cgi?id=66434&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=66434&amp;action=diff">Diff</a>&#x0020; |
    <a href="https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=66434">
      Splinter Review</a>
        </td>
      </tr>
      <tr id="a24" class="bz_contenttype_text_plain bz_patch">
        <td>
            <a href="attachment.cgi?id=66435"
               title="View the content of the attachment">
          <b>Bug 19086 Stored XSS in supplier.pl</b></a>

          <span class="bz_attach_extra_info">
              (3.91 KB,
                patch)

            <br>
            <a href="#attach_66435"
               title="Go to the comment associated with the attachment">2017-08-25 06:13 UTC</a>,

            <span class="vcard"><span class="fn">Marcel de Rooy</span>
</span>
          </span>
        </td>


        <td>
          <a href="attachment.cgi?id=66435&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=66435&amp;action=diff">Diff</a>&#x0020; |
    <a href="https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=66435">
      Splinter Review</a>
        </td>
      </tr>
      <tr id="a25" class="bz_contenttype_text_plain bz_patch">
        <td>
            <a href="attachment.cgi?id=66436"
               title="View the content of the attachment">
          <b>Bug 19086 Stored XSS in subscription-add.pl</b></a>

          <span class="bz_attach_extra_info">
              (2.02 KB,
                patch)

            <br>
            <a href="#attach_66436"
               title="Go to the comment associated with the attachment">2017-08-25 06:13 UTC</a>,

            <span class="vcard"><span class="fn">Marcel de Rooy</span>
</span>
          </span>
        </td>


        <td>
          <a href="attachment.cgi?id=66436&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=66436&amp;action=diff">Diff</a>&#x0020; |
    <a href="https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=66436">
      Splinter Review</a>
        </td>
      </tr>
      <tr id="a26" class="bz_contenttype_text_plain bz_patch">
        <td>
            <a href="attachment.cgi?id=66437"
               title="View the content of the attachment">
          <b>Bug 19086 - Follow-up - XSS in supplier.tt</b></a>

          <span class="bz_attach_extra_info">
              (3.30 KB,
                patch)

            <br>
            <a href="#attach_66437"
               title="Go to the comment associated with the attachment">2017-08-25 06:13 UTC</a>,

            <span class="vcard"><span class="fn">Marcel de Rooy</span>
</span>
          </span>
        </td>


        <td>
          <a href="attachment.cgi?id=66437&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=66437&amp;action=diff">Diff</a>&#x0020; |
    <a href="https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=66437">
      Splinter Review</a>
        </td>
      </tr>
      <tr id="a27" class="bz_contenttype_text_plain bz_patch">
        <td>
            <a href="attachment.cgi?id=66438"
               title="View the content of the attachment">
          <b>Bug 19086 - Follow-up - subscription-detail.pl</b></a>

          <span class="bz_attach_extra_info">
              (1.61 KB,
                patch)

            <br>
            <a href="#attach_66438"
               title="Go to the comment associated with the attachment">2017-08-25 06:13 UTC</a>,

            <span class="vcard"><span class="fn">Marcel de Rooy</span>
</span>
          </span>
        </td>


        <td>
          <a href="attachment.cgi?id=66438&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=66438&amp;action=diff">Diff</a>&#x0020; |
    <a href="https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=66438">
      Splinter Review</a>
        </td>
      </tr>

  <tr class="bz_attach_footer">
    <td colspan="2">
        <span class="bz_attach_view_hide">
            <a href="#a0" onclick="return toggle_display(this);">Show
              Obsolete</a> (21)
            <a id="view_all" href="attachment.cgi?bugid=19086&amp;action=viewall&amp;hide_obsolete=1">View All</a>
        </span>
        <a href="attachment.cgi?bugid=19086&amp;action=enter">Add an attachment</a>
        (proposed patch, testcase, etc.)
    </td>
  </tr>
</table>
<br>
<div id="add_comment" class="bz_section_additional_comments">
      <table>
        <tr>
          <td>
            <fieldset>
              <legend>Note</legend>
              You need to
              <a href="show_bug.cgi?id=19086&amp;GoAheadAndLogIn=1">log in</a>
              before you can comment on or make changes to this bug.
            </fieldset>
          </td>
        </tr> 
      </table>
  </div>
  </td>
  <td>
  </td>
  </tr></table>

  
  <div id="comments"><script src="js/comments.js" type="text/javascript">
</script>

<script type="text/javascript">
<!--
  /* Adds the reply text to the 'comment' textarea */
  function replyToComment(id, real_id, name) {
      var prefix = "(In reply to " + name + " from comment #" + id + ")\n";
      var replytext = "";
        /* pre id="comment_name_N" */
        var text_elem = document.getElementById('comment_text_'+id);
        var text = getText(text_elem);
        replytext = prefix + wrapReplyText(text);


      /* <textarea id="comment"> */
      var textarea = document.getElementById('comment');
      if (textarea.value != replytext) {
          textarea.value += replytext;
      }

      textarea.focus();
  } 
//-->
</script>


<!-- This auto-sizes the comments and positions the collapse/expand links 
     to the right. -->
<table class="bz_comment_table">
<tr>
<td>
<div id="c0" class="bz_comment bz_first_comment">

      <div class="bz_first_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=19086#c0">Description</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Jiaky Ooi</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-08-11 10:57:53 UTC
        </span>

      </div>




<pre class="bz_comment_text">The following issues were identified, Koha was installed on ubuntu 16.04 and mySQL with default configuration:

Vulnerability Type: Reflected Cross Site Scripting
Affected Product: koha library system
Tested Version: 17.05.02
Discovered by: Jiaky Ooi
Affected URL: /cgi-bin/koha/members/member.pl
Affected Parameter: searchmember


Proof of Concept:
Full link for PoC : /cgi-bin/koha/members/member.pl?&amp;searchmember=&lt;script&gt;alert('XSS Payload')&lt;/script&gt;


Vulnerability Type: Stored Cross Site Scripting
Affected Product: koha library system
Tested Version: 17.05.02
Discovered by: Jiaky Ooi
Affected URL: 1) /cgi-bin/koha/acqui/supplier.pl?op=enter
              2) /cgi-bin/koha/circ/circulation.pl?borrowernumber=[number]
              3) /cgi-bin/koha/serials/subscription-add.pl
Affected Parameter: 1) company_postal, physical, company_fax, accountnumber, contactposition, contact_fax, contact_notes, notes
                    2) borrower_message
                    3) Internalnotes, notes


Please be aware that we will publish these vulnerability on the disclosure date when agreed.

Please reserve CVE number for this vulnerability by contacting Mitre. Further information can be found at <a href="https://cve.mitre.org/cve/request_id.html">https://cve.mitre.org/cve/request_id.html</a> 

I will be happy to provide further information on this vulnerability, including the mechanisms by which it was identified, and any pertinent technical information if required.

Many thanks

_________________________________________________________

Jiaky Ooi | Consultant

Oxford        +44 (0)1865 877 830
Dubai          +971 (0)4 427 0428  
London       +44 (0)203 5983740
New York    +1 646-781-7580

E-Mail        <a href="mailto:jiaky.ooi&#64;dionach.com">jiaky.ooi&#64;dionach.com</a> 
Web          www.dionach.com

 ®</pre>
    </div>

    <div id="c1" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=19086#c1">Comment 1</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Chris Cormack</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-08-11 19:42:29 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=65927&amp;action=diff" name="attach_65927" title="Bug 19086 XSS in members/member.pl">attachment 65927</a> <a href="attachment.cgi?id=65927&amp;action=edit" title="Bug 19086 XSS in members/member.pl">[details]</a></span> <a href='page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=65927'>[review]</a>
<a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED FIXED - Multiple cross-site scripting vulnerabilities"
   href="show_bug.cgi?id=19086">Bug 19086</a> XSS in members/member.pl

To test
1/ hit /cgi-bin/koha/members/member.pl?&amp;searchmember=&lt;script&gt;alert('XSS Payload')&lt;/script&gt;
2/ Notice js is executed
3/ Apply patch, reload
4/ js is now escaped</pre>
    </div>

    <div id="c2" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=19086#c2">Comment 2</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Chris Cormack</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-08-11 19:56:36 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=65929&amp;action=diff" name="attach_65929" title="Bug 19086 Stored XSS in circulation.pl">attachment 65929</a> <a href="attachment.cgi?id=65929&amp;action=edit" title="Bug 19086 Stored XSS in circulation.pl">[details]</a></span> <a href='page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=65929'>[review]</a>
<a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED FIXED - Multiple cross-site scripting vulnerabilities"
   href="show_bug.cgi?id=19086">Bug 19086</a> Stored XSS in circulation.pl

1/ To test add a message to a borrower that contains js
2/ hit /cgi-bin/koha/circ/circulation.pl?borrowernumber=[number]
  where number is the borrowernumber of the borrower you set the message
  for
3/ Notice js is execute
4/ Apply patch, reload, js is escaped</pre>
    </div>

    <div id="c3" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=19086#c3">Comment 3</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Chris Cormack</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-08-11 20:03:14 UTC
        </span>

      </div>




<pre class="bz_comment_text">2 left to go, 
/cgi-bin/koha/acqui/supplier.pl?op=enter

and

/cgi-bin/koha/serials/subscription-add.pl

I have to go out now tho, so hopefully someone else will grab those</pre>
    </div>

    <div id="c4" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=19086#c4">Comment 4</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Amit Gupta</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-08-14 16:09:44 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=65958&amp;action=diff" name="attach_65958" title="Bug 19086 XSS in members/member.pl">attachment 65958</a> <a href="attachment.cgi?id=65958&amp;action=edit" title="Bug 19086 XSS in members/member.pl">[details]</a></span> <a href='page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=65958'>[review]</a>
<a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED FIXED - Multiple cross-site scripting vulnerabilities"
   href="show_bug.cgi?id=19086">Bug 19086</a> XSS in members/member.pl

Tested and work OK.</pre>
    </div>

    <div id="c5" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=19086#c5">Comment 5</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Amit Gupta</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-08-14 16:11:46 UTC
        </span>

      </div>




<pre class="bz_comment_text">Hi Chris,

I am able to execute the java script after applying the patch also. (circulation.pl)</pre>
    </div>

    <div id="c6" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=19086#c6">Comment 6</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Amit Gupta</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-08-14 16:17:23 UTC
        </span>

      </div>




<pre class="bz_comment_text">If we are using HTML::Entities wil able to escape the js.</pre>
    </div>

    <div id="c7" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=19086#c7">Comment 7</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Amit Gupta</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-08-14 16:22:33 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=65960&amp;action=diff" name="attach_65960" title="Bug 19086 Stored XSS in circulation.pl">attachment 65960</a> <a href="attachment.cgi?id=65960&amp;action=edit" title="Bug 19086 Stored XSS in circulation.pl">[details]</a></span> <a href='page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=65960'>[review]</a>
<a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED FIXED - Multiple cross-site scripting vulnerabilities"
   href="show_bug.cgi?id=19086">Bug 19086</a> Stored XSS in circulation.pl

Used HTML::Entities - Encode or decode strings with HTML entities.
********************************************************************
1. Hit /cgi-bin/koha/circ/circulation.pl?borrowernumber=xx&lt;script&gt;alert('amit')&lt;/script&gt;.
   xx - is a borrowernumber
2. Notice the java script is executed.
4. Apply patch.
5. Reload page, and hit the page again /cgi-bin/koha/circ/circulation.pl?borrowernumber=xx&lt;script&gt;alert('amit')&lt;/script&gt;.
   xx - is a borrowernumber.
6. Notice it is no longer executed.</pre>
    </div>

    <div id="c8" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=19086#c8">Comment 8</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Amit Gupta</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-08-14 16:30:23 UTC
        </span>

      </div>




<pre class="bz_comment_text">Fixed: /cgi-bin/koha/acqui/supplier.pl (Please see bug: <a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED FIXED - XSS issue in supplier.pl page"
   href="show_bug.cgi?id=19089">Bug 19089</a>)

I didn't find any vulnerability in: /cgi-bin/koha/serials/subscription-add.pl

Can you please provide us some screen shots.</pre>
    </div>

    <div id="c9" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=19086#c9">Comment 9</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Amit Gupta</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-08-14 16:54:00 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=65965&amp;action=diff" name="attach_65965" title="Bug 19086 Stored XSS in routing-lists.pl">attachment 65965</a> <a href="attachment.cgi?id=65965&amp;action=edit" title="Bug 19086 Stored XSS in routing-lists.pl">[details]</a></span> <a href='page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=65965'>[review]</a>
<a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED FIXED - Multiple cross-site scripting vulnerabilities"
   href="show_bug.cgi?id=19086">Bug 19086</a> Stored XSS in routing-lists.pl

1. Hit /cgi-bin/koha/members/routing-lists.pl?borrowernumber=xx&lt;script&gt;alert('XSS Payload')&lt;/script&gt;
   xx is a borrowernumber
2. Notice java script is execute.
3. Apply patch.
3. Reload page, and hit the page again /cgi-bin/koha/members/routing-lists.pl?borrowernumber=xx&lt;script&gt;alert('XSS Payload')&lt;/script&gt;
   xx is a borrowernumber
4. Notice it is no longer executed.</pre>
    </div>

    <div id="c10" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=19086#c10">Comment 10</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Amit Gupta</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-08-14 16:59:25 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=65966&amp;action=diff" name="attach_65966" title="Bug 19086 Stored XSS in readingrec.pl">attachment 65966</a> <a href="attachment.cgi?id=65966&amp;action=edit" title="Bug 19086 Stored XSS in readingrec.pl">[details]</a></span> <a href='page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=65966'>[review]</a>
<a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED FIXED - Multiple cross-site scripting vulnerabilities"
   href="show_bug.cgi?id=19086">Bug 19086</a> Stored XSS in readingrec.pl

1. Hit /cgi-bin/koha/members/readingrec.pl?borrowernumber=xx&lt;script&gt;alert('XSS Payload')&lt;/script&gt;
   xx is a borrowernumber
2. Notice java script is execute.
3. Apply patch.
4. Reload page, and hit the page again /cgi-bin/koha/members/readingrec.pl?borrowernumber=xx&lt;script&gt;alert('XSS Payload')&lt;/script&gt;
   xx is a borrowernumber
5. Notice it is no longer executed.</pre>
    </div>

    <div id="c11" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=19086#c11">Comment 11</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Amit Gupta</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-08-14 17:02:45 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=65967&amp;action=diff" name="attach_65967" title="Bug 19086 Stored XSS in notices.pl">attachment 65967</a> <a href="attachment.cgi?id=65967&amp;action=edit" title="Bug 19086 Stored XSS in notices.pl">[details]</a></span> <a href='page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=65967'>[review]</a>
<a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED FIXED - Multiple cross-site scripting vulnerabilities"
   href="show_bug.cgi?id=19086">Bug 19086</a> Stored XSS in notices.pl

1. Hit /cgi-bin/koha/members/notices.pl?borrowernumber=xx&lt;script&gt;alert('XSS Payload')&lt;/script&gt;
   xx is a borrowernumber
2. Notice java script is execute.
3. Apply patch.
4. Reload page, and hit the page again /cgi-bin/koha/members/notices.pl?borrowernumber=xx&lt;script&gt;alert('XSS Payload')&lt;/script&gt;
   xx is a borrowernumber
5. Notice it is no longer executed.</pre>
    </div>

    <div id="c12" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=19086#c12">Comment 12</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Amit Gupta</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-08-14 17:08:57 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=65968&amp;action=diff" name="attach_65968" title="Bug 19086 Stored XSS in maninvoice.pl">attachment 65968</a> <a href="attachment.cgi?id=65968&amp;action=edit" title="Bug 19086 Stored XSS in maninvoice.pl">[details]</a></span> <a href='page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=65968'>[review]</a>
<a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED FIXED - Multiple cross-site scripting vulnerabilities"
   href="show_bug.cgi?id=19086">Bug 19086</a> Stored XSS in maninvoice.pl

1. Hit /cgi-bin/koha/members/maninvoice.pl?borrowernumber=xx&lt;script&gt;alert('XSS Payload')&lt;/script&gt;
   xx is a borrowernumber
2. Notice java script is execute.
3. Apply patch.
4. Reload page, and hit the page again /cgi-bin/koha/members/maninvoice.pl?borrowernumber=xx&lt;script&gt;alert('XSS Payload')&lt;/script&gt;
   xx is a borrowernumber
5. Notice it is no longer executed.</pre>
    </div>

    <div id="c13" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=19086#c13">Comment 13</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Amit Gupta</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-08-14 17:13:18 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=65969&amp;action=diff" name="attach_65969" title="Bug 19086 Stored XSS in boraccount.pl">attachment 65969</a> <a href="attachment.cgi?id=65969&amp;action=edit" title="Bug 19086 Stored XSS in boraccount.pl">[details]</a></span> <a href='page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=65969'>[review]</a>
<a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED FIXED - Multiple cross-site scripting vulnerabilities"
   href="show_bug.cgi?id=19086">Bug 19086</a> Stored XSS in boraccount.pl

1. Hit /cgi-bin/koha/members/boraccount.pl?borrowernumber=xx&lt;script&gt;alert('XSS Payload')&lt;/script&gt;
   xx is a borrowernumber
2. Notice java script is execute.
3. Apply patch.
4. Reload page, and hit the page again /cgi-bin/koha/members/boraccount.pl?borrowernumber=xx&lt;script&gt;alert('XSS Payload')&lt;/script&gt;
   xx is a borrowernumber
5. Notice it is no longer executed.</pre>
    </div>

    <div id="c14" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=19086#c14">Comment 14</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Amit Gupta</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-08-14 17:16:20 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=65970&amp;action=diff" name="attach_65970" title="Bug 19086 Stored XSS in mancredit.pl">attachment 65970</a> <a href="attachment.cgi?id=65970&amp;action=edit" title="Bug 19086 Stored XSS in mancredit.pl">[details]</a></span> <a href='page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=65970'>[review]</a>
<a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED FIXED - Multiple cross-site scripting vulnerabilities"
   href="show_bug.cgi?id=19086">Bug 19086</a> Stored XSS in mancredit.pl

1. Hit /cgi-bin/koha/members/mancredit.pl?borrowernumber=xx&lt;script&gt;alert('XSS Payload')&lt;/script&gt;
   xx is a borrowernumber
2. Notice java script is execute.
3. Apply patch.
4. Reload page, and hit the page again /cgi-bin/koha/members/mancredit.pl?borrowernumber=xx&lt;script&gt;alert('XSS Payload')&lt;/script&gt;
   xx is a borrowernumber
5. Notice it is no longer executed.</pre>
    </div>

    <div id="c15" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=19086#c15">Comment 15</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Chris Cormack</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-08-14 18:25:19 UTC
        </span>

      </div>




<pre class="bz_comment_text">Amit the stored ones involve adding js to the database, if you see the test plan it is to do with adding js to a note then hitting the field. Different to passing js as a parameter.</pre>
    </div>

    <div id="c16" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=19086#c16">Comment 16</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Amit Gupta</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-08-14 19:24:09 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=65972&amp;action=diff" name="attach_65972" title="Bug 19086 Stored XSS in circulation.pl">attachment 65972</a> <a href="attachment.cgi?id=65972&amp;action=edit" title="Bug 19086 Stored XSS in circulation.pl">[details]</a></span> <a href='page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=65972'>[review]</a>
<a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED FIXED - Multiple cross-site scripting vulnerabilities"
   href="show_bug.cgi?id=19086">Bug 19086</a> Stored XSS in circulation.pl

Test and work OK.

I am moving others patches in new bug</pre>
    </div>

    <div id="c17" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=19086#c17">Comment 17</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Amit Gupta</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-08-14 19:35:50 UTC
        </span>

      </div>




<pre class="bz_comment_text">Need to fix 2 more.</pre>
    </div>

    <div id="c18" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=19086#c18">Comment 18</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Jiaky Ooi</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-08-14 20:43:15 UTC
        </span>

      </div>




<pre class="bz_comment_text">(In reply to Amit Gupta from <a href="show_bug.cgi?id=19086#c8">comment #8</a>)
<span class="quote">&gt; Fixed: /cgi-bin/koha/acqui/supplier.pl (Please see bug: <a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED FIXED - XSS issue in supplier.pl page"
   href="show_bug.cgi?id=19089">Bug 19089</a>)
&gt; 
&gt; I didn't find any vulnerability in: /cgi-bin/koha/serials/subscription-add.pl
&gt; 
&gt; Can you please provide us some screen shots.</span >

Hi Amit,

Apologies I am trying to reproduce this at the moment but my resources are at a different office.

Please allow me up to 24 hours to provide you with an update.

Best regards,
Jiaky</pre>
    </div>

    <div id="c19" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=19086#c19">Comment 19</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Amit Gupta</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-08-14 21:10:07 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=65984&amp;action=diff" name="attach_65984" title="Bug 19086 Stored XSS in /cgi-bin/koha/acqui/supplier.pl?op=enter">attachment 65984</a> <a href="attachment.cgi?id=65984&amp;action=edit" title="Bug 19086 Stored XSS in /cgi-bin/koha/acqui/supplier.pl?op=enter">[details]</a></span> <a href='page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=65984'>[review]</a>
<a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED FIXED - Multiple cross-site scripting vulnerabilities"
   href="show_bug.cgi?id=19086">Bug 19086</a> Stored XSS in /cgi-bin/koha/acqui/supplier.pl?op=enter

1. To test - add a text in the field company_postal, physical, company_fax,
   accountnumber, contactposition, contact_fax, contact_notes, notes that contains java script
2. Save the page.
3. Notice js is execute
4. Apply patch and reload the js is escaped</pre>
    </div>

    <div id="c20" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=19086#c20">Comment 20</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Amit Gupta</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-08-14 21:21:23 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=65985&amp;action=diff" name="attach_65985" title="Bug 19086 Stored XSS in subscription-add.pl">attachment 65985</a> <a href="attachment.cgi?id=65985&amp;action=edit" title="Bug 19086 Stored XSS in subscription-add.pl">[details]</a></span> <a href='page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=65985'>[review]</a>
<a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED FIXED - Multiple cross-site scripting vulnerabilities"
   href="show_bug.cgi?id=19086">Bug 19086</a> Stored XSS in subscription-add.pl

1. To test - add a text in the field Public note and Nonpublic note
   that contains js (Internalnotes, notes)
2. Save the page.
3. Notice js is execute
4. Apply patch and reload, the js is escaped</pre>
    </div>

    <div id="c21" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=19086#c21">Comment 21</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Amit Gupta</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-08-14 21:21:53 UTC
        </span>

      </div>




<pre class="bz_comment_text">(In reply to jiakyooi95 from <a href="show_bug.cgi?id=19086#c18">comment #18</a>)
<span class="quote">&gt; (In reply to Amit Gupta from <a href="show_bug.cgi?id=19086#c8">comment #8</a>)
&gt; &gt; Fixed: /cgi-bin/koha/acqui/supplier.pl (Please see bug: <a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED FIXED - XSS issue in supplier.pl page"
   href="show_bug.cgi?id=19089">Bug 19089</a>)
&gt; &gt; 
&gt; &gt; I didn't find any vulnerability in: /cgi-bin/koha/serials/subscription-add.pl
&gt; &gt; 
&gt; &gt; Can you please provide us some screen shots.
&gt; 
&gt; Hi Amit,
&gt; 
&gt; Apologies I am trying to reproduce this at the moment but my resources are
&gt; at a different office.
&gt; 
&gt; Please allow me up to 24 hours to provide you with an update.
&gt; 
&gt; Best regards,
&gt; Jiaky</span >

I have fixed the remaining 2.</pre>
    </div>

    <div id="c22" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=19086#c22">Comment 22</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Amit Gupta</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-08-14 21:30:47 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=65986&amp;action=diff" name="attach_65986" title="Bug 19086 Stored XSS in supplier.pl">attachment 65986</a> <a href="attachment.cgi?id=65986&amp;action=edit" title="Bug 19086 Stored XSS in supplier.pl">[details]</a></span> <a href='page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=65986'>[review]</a>
<a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED FIXED - Multiple cross-site scripting vulnerabilities"
   href="show_bug.cgi?id=19086">Bug 19086</a> Stored XSS in supplier.pl

Some changes in test case.
*****************************
1. Hit the page /cgi-bin/koha/acqui/supplier.pl?op=enter
2. Add a text in the field company_postal, physical, company_fax,
   accountnumber, contactposition, contact_fax, contact_notes, notes that contains java script
3. Save the page.
4. Notice js is execute
5. Apply patch and reload the js is escaped</pre>
    </div>

    <div id="c23" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=19086#c23">Comment 23</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Amit Gupta</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-08-14 21:33:27 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=65987&amp;action=diff" name="attach_65987" title="Bug 19086 Stored XSS in subscription-add.pl">attachment 65987</a> <a href="attachment.cgi?id=65987&amp;action=edit" title="Bug 19086 Stored XSS in subscription-add.pl">[details]</a></span> <a href='page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=65987'>[review]</a>
<a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED FIXED - Multiple cross-site scripting vulnerabilities"
   href="show_bug.cgi?id=19086">Bug 19086</a> Stored XSS in subscription-add.pl

To Test
1. Hit the page /cgi-bin/koha/serials/subscription-add.pl
2. Add a text in the field Public note and Nonpublic note
   that contains js (Internalnotes, notes)
2. Save the page.
3. Notice js is execute
4. Apply patch and reload, the js is escaped</pre>
    </div>

    <div id="c24" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=19086#c24">Comment 24</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Katrin Fischer</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-08-16 11:04:47 UTC
        </span>

      </div>




<pre class="bz_comment_text">For subscription-detail I am not sure - people might have added html to the note fields on purpose to highlight some things in the OPAC more. With the html filter, this won't be permitted.</pre>
    </div>

    <div id="c25" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=19086#c25">Comment 25</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Katrin Fischer</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-08-16 11:08:23 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=66058&amp;action=diff" name="attach_66058" title="[SIGNED OFF] Bug 19086 XSS in members/member.pl">attachment 66058</a> <a href="attachment.cgi?id=66058&amp;action=edit" title="[SIGNED OFF] Bug 19086 XSS in members/member.pl">[details]</a></span> <a href='page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=66058'>[review]</a>
[SIGNED OFF] <a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED FIXED - Multiple cross-site scripting vulnerabilities"
   href="show_bug.cgi?id=19086">Bug 19086</a> XSS in members/member.pl

To test
1/ hit /cgi-bin/koha/members/member.pl?&amp;searchmember=&lt;script&gt;alert('XSS Payload')&lt;/script&gt;
2/ Notice js is executed
3/ Apply patch, reload
4/ js is now escaped

Signed-off-by: Amit Gupta &lt;<a href="mailto:amit.gupta&#64;informaticsglobal.com">amit.gupta&#64;informaticsglobal.com</a>&gt;

Signed-off-by: Katrin Fischer &lt;<a href="mailto:katrin.fischer.83&#64;web.de">katrin.fischer.83&#64;web.de</a>&gt;</pre>
    </div>

    <div id="c26" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=19086#c26">Comment 26</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Katrin Fischer</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-08-16 11:08:27 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=66059&amp;action=diff" name="attach_66059" title="[SIGNED OFF] Bug 19086 Stored XSS in circulation.pl">attachment 66059</a> <a href="attachment.cgi?id=66059&amp;action=edit" title="[SIGNED OFF] Bug 19086 Stored XSS in circulation.pl">[details]</a></span> <a href='page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=66059'>[review]</a>
[SIGNED OFF] <a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED FIXED - Multiple cross-site scripting vulnerabilities"
   href="show_bug.cgi?id=19086">Bug 19086</a> Stored XSS in circulation.pl

1/ To test add a message to a borrower that contains js
2/ hit /cgi-bin/koha/circ/circulation.pl?borrowernumber=[number]
  where number is the borrowernumber of the borrower you set the message
  for
3/ Notice js is execute
4/ Apply patch, reload, js is escaped

Signed-off-by: Amit Gupta &lt;<a href="mailto:amit.gupta&#64;informaticsglobal.com">amit.gupta&#64;informaticsglobal.com</a>&gt;

Signed-off-by: Katrin Fischer &lt;<a href="mailto:katrin.fischer.83&#64;web.de">katrin.fischer.83&#64;web.de</a>&gt;</pre>
    </div>

    <div id="c27" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=19086#c27">Comment 27</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Katrin Fischer</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-08-16 11:08:30 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=66060&amp;action=diff" name="attach_66060" title="[SIGNED OFF] Bug 19086 Stored XSS in supplier.pl">attachment 66060</a> <a href="attachment.cgi?id=66060&amp;action=edit" title="[SIGNED OFF] Bug 19086 Stored XSS in supplier.pl">[details]</a></span> <a href='page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=66060'>[review]</a>
[SIGNED OFF] <a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED FIXED - Multiple cross-site scripting vulnerabilities"
   href="show_bug.cgi?id=19086">Bug 19086</a> Stored XSS in supplier.pl

1. Hit the page /cgi-bin/koha/acqui/supplier.pl?op=enter
2. Add a text in the field company_postal, physical, company_fax,
   accountnumber, contactposition, contact_fax, contact_notes, notes that contains java script
3. Save the page.
4. Notice js is execute
5. Apply patch and reload the js is escaped

Signed-off-by: Katrin Fischer &lt;<a href="mailto:katrin.fischer.83&#64;web.de">katrin.fischer.83&#64;web.de</a>&gt;</pre>
    </div>

    <div id="c28" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=19086#c28">Comment 28</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Katrin Fischer</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-08-16 11:08:34 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=66061&amp;action=diff" name="attach_66061" title="[SIGNED OFF] Bug 19086 Stored XSS in subscription-add.pl">attachment 66061</a> <a href="attachment.cgi?id=66061&amp;action=edit" title="[SIGNED OFF] Bug 19086 Stored XSS in subscription-add.pl">[details]</a></span> <a href='page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=66061'>[review]</a>
[SIGNED OFF] <a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED FIXED - Multiple cross-site scripting vulnerabilities"
   href="show_bug.cgi?id=19086">Bug 19086</a> Stored XSS in subscription-add.pl

To Test
1. Hit the page /cgi-bin/koha/serials/subscription-add.pl
2. Add a text in the field Public note and Nonpublic note
   that contains js (Internalnotes, notes)
2. Save the page.
3. Notice js is execute
4. Apply patch and reload, the js is escaped

Signed-off-by: Katrin Fischer &lt;<a href="mailto:katrin.fischer.83&#64;web.de">katrin.fischer.83&#64;web.de</a>&gt;</pre>
    </div>

    <div id="c29" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=19086#c29">Comment 29</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Katrin Fischer</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-08-16 11:08:37 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=66062&amp;action=diff" name="attach_66062" title="Bug 19086 - Follow-up - XSS in supplier.tt">attachment 66062</a> <a href="attachment.cgi?id=66062&amp;action=edit" title="Bug 19086 - Follow-up - XSS in supplier.tt">[details]</a></span> <a href='page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=66062'>[review]</a>
<a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED FIXED - Multiple cross-site scripting vulnerabilities"
   href="show_bug.cgi?id=19086">Bug 19086</a> - Follow-up - XSS in supplier.tt

In preparation:
Make sure you enter &lt;script&gt;alert(&quot;sth&quot;)&lt;/script&gt;
in all fields of a new vendor that are not validated
and save.

1) Access vendor summary page.
2) Verify scripts are executed
3) Apply patch
4) Verify scripts are on longer executed

This works in combination with the other patches for XSS
on this bug.</pre>
    </div>

    <div id="c30" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=19086#c30">Comment 30</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Katrin Fischer</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-08-16 11:08:40 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=66063&amp;action=diff" name="attach_66063" title="Bug 19086 - Follow-up - subscription-detail.pl">attachment 66063</a> <a href="attachment.cgi?id=66063&amp;action=edit" title="Bug 19086 - Follow-up - subscription-detail.pl">[details]</a></span> <a href='page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=66063'>[review]</a>
<a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED FIXED - Multiple cross-site scripting vulnerabilities"
   href="show_bug.cgi?id=19086">Bug 19086</a> - Follow-up - subscription-detail.pl

Add script to the callnumber field on adding a subscription.

Verify script is executed without this patch, but not with it.</pre>
    </div>

    <div id="c31" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=19086#c31">Comment 31</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Marcel de Rooy</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-08-25 06:12:33 UTC
        </span>

      </div>




<pre class="bz_comment_text">koha-tmpl/intranet-tmpl/prog/en/modules/acqui/supplier.tt
[% name |html %]&lt;/a&gt; &amp;rsaquo; Update: [% name %]
Forgot the second one here?</pre>
    </div>

    <div id="c32" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=19086#c32">Comment 32</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Marcel de Rooy</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-08-25 06:13:04 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class=""><a href="attachment.cgi?id=66433&amp;action=diff" name="attach_66433" title="Bug 19086 XSS in members/member.pl">attachment 66433</a> <a href="attachment.cgi?id=66433&amp;action=edit" title="Bug 19086 XSS in members/member.pl">[details]</a></span> <a href='page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=66433'>[review]</a>
<a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED FIXED - Multiple cross-site scripting vulnerabilities"
   href="show_bug.cgi?id=19086">Bug 19086</a> XSS in members/member.pl

To test
1/ hit /cgi-bin/koha/members/member.pl?&amp;searchmember=&lt;script&gt;alert('XSS Payload')&lt;/script&gt;
2/ Notice js is executed
3/ Apply patch, reload
4/ js is now escaped

Signed-off-by: Amit Gupta &lt;<a href="mailto:amit.gupta&#64;informaticsglobal.com">amit.gupta&#64;informaticsglobal.com</a>&gt;

Signed-off-by: Katrin Fischer &lt;<a href="mailto:katrin.fischer.83&#64;web.de">katrin.fischer.83&#64;web.de</a>&gt;

Signed-off-by: Marcel de Rooy &lt;<a href="mailto:m.de.rooy&#64;rijksmuseum.nl">m.de.rooy&#64;rijksmuseum.nl</a>&gt;</pre>
    </div>

    <div id="c33" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=19086#c33">Comment 33</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Marcel de Rooy</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-08-25 06:13:09 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class=""><a href="attachment.cgi?id=66434&amp;action=diff" name="attach_66434" title="Bug 19086 Stored XSS in circulation.pl">attachment 66434</a> <a href="attachment.cgi?id=66434&amp;action=edit" title="Bug 19086 Stored XSS in circulation.pl">[details]</a></span> <a href='page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=66434'>[review]</a>
<a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED FIXED - Multiple cross-site scripting vulnerabilities"
   href="show_bug.cgi?id=19086">Bug 19086</a> Stored XSS in circulation.pl

1/ To test add a message to a borrower that contains js
2/ hit /cgi-bin/koha/circ/circulation.pl?borrowernumber=[number]
  where number is the borrowernumber of the borrower you set the message
  for
3/ Notice js is execute
4/ Apply patch, reload, js is escaped

Signed-off-by: Amit Gupta &lt;<a href="mailto:amit.gupta&#64;informaticsglobal.com">amit.gupta&#64;informaticsglobal.com</a>&gt;

Signed-off-by: Katrin Fischer &lt;<a href="mailto:katrin.fischer.83&#64;web.de">katrin.fischer.83&#64;web.de</a>&gt;

Signed-off-by: Marcel de Rooy &lt;<a href="mailto:m.de.rooy&#64;rijksmuseum.nl">m.de.rooy&#64;rijksmuseum.nl</a>&gt;</pre>
    </div>

    <div id="c34" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=19086#c34">Comment 34</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Marcel de Rooy</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-08-25 06:13:13 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class=""><a href="attachment.cgi?id=66435&amp;action=diff" name="attach_66435" title="Bug 19086 Stored XSS in supplier.pl">attachment 66435</a> <a href="attachment.cgi?id=66435&amp;action=edit" title="Bug 19086 Stored XSS in supplier.pl">[details]</a></span> <a href='page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=66435'>[review]</a>
<a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED FIXED - Multiple cross-site scripting vulnerabilities"
   href="show_bug.cgi?id=19086">Bug 19086</a> Stored XSS in supplier.pl

1. Hit the page /cgi-bin/koha/acqui/supplier.pl?op=enter
2. Add a text in the field company_postal, physical, company_fax,
   accountnumber, contactposition, contact_fax, contact_notes, notes that contains java script
3. Save the page.
4. Notice js is execute
5. Apply patch and reload the js is escaped

Signed-off-by: Katrin Fischer &lt;<a href="mailto:katrin.fischer.83&#64;web.de">katrin.fischer.83&#64;web.de</a>&gt;

Signed-off-by: Marcel de Rooy &lt;<a href="mailto:m.de.rooy&#64;rijksmuseum.nl">m.de.rooy&#64;rijksmuseum.nl</a>&gt;</pre>
    </div>

    <div id="c35" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=19086#c35">Comment 35</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Marcel de Rooy</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-08-25 06:13:18 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class=""><a href="attachment.cgi?id=66436&amp;action=diff" name="attach_66436" title="Bug 19086 Stored XSS in subscription-add.pl">attachment 66436</a> <a href="attachment.cgi?id=66436&amp;action=edit" title="Bug 19086 Stored XSS in subscription-add.pl">[details]</a></span> <a href='page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=66436'>[review]</a>
<a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED FIXED - Multiple cross-site scripting vulnerabilities"
   href="show_bug.cgi?id=19086">Bug 19086</a> Stored XSS in subscription-add.pl

To Test
1. Hit the page /cgi-bin/koha/serials/subscription-add.pl
2. Add a text in the field Public note and Nonpublic note
   that contains js (Internalnotes, notes)
2. Save the page.
3. Notice js is execute
4. Apply patch and reload, the js is escaped

Signed-off-by: Katrin Fischer &lt;<a href="mailto:katrin.fischer.83&#64;web.de">katrin.fischer.83&#64;web.de</a>&gt;

Signed-off-by: Marcel de Rooy &lt;<a href="mailto:m.de.rooy&#64;rijksmuseum.nl">m.de.rooy&#64;rijksmuseum.nl</a>&gt;</pre>
    </div>

    <div id="c36" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=19086#c36">Comment 36</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Marcel de Rooy</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-08-25 06:13:23 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class=""><a href="attachment.cgi?id=66437&amp;action=diff" name="attach_66437" title="Bug 19086 - Follow-up - XSS in supplier.tt">attachment 66437</a> <a href="attachment.cgi?id=66437&amp;action=edit" title="Bug 19086 - Follow-up - XSS in supplier.tt">[details]</a></span> <a href='page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=66437'>[review]</a>
<a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED FIXED - Multiple cross-site scripting vulnerabilities"
   href="show_bug.cgi?id=19086">Bug 19086</a> - Follow-up - XSS in supplier.tt

In preparation:
Make sure you enter &lt;script&gt;alert(&quot;sth&quot;)&lt;/script&gt;
in all fields of a new vendor that are not validated
and save.

1) Access vendor summary page.
2) Verify scripts are executed
3) Apply patch
4) Verify scripts are on longer executed

This works in combination with the other patches for XSS
on this bug.

Signed-off-by: Marcel de Rooy &lt;<a href="mailto:m.de.rooy&#64;rijksmuseum.nl">m.de.rooy&#64;rijksmuseum.nl</a>&gt;</pre>
    </div>

    <div id="c37" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=19086#c37">Comment 37</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Marcel de Rooy</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-08-25 06:13:28 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class=""><a href="attachment.cgi?id=66438&amp;action=diff" name="attach_66438" title="Bug 19086 - Follow-up - subscription-detail.pl">attachment 66438</a> <a href="attachment.cgi?id=66438&amp;action=edit" title="Bug 19086 - Follow-up - subscription-detail.pl">[details]</a></span> <a href='page.cgi?id=splinter.html&amp;bug=19086&amp;attachment=66438'>[review]</a>
<a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED FIXED - Multiple cross-site scripting vulnerabilities"
   href="show_bug.cgi?id=19086">Bug 19086</a> - Follow-up - subscription-detail.pl

Add script to the callnumber field on adding a subscription.

Verify script is executed without this patch, but not with it.

Signed-off-by: Marcel de Rooy &lt;<a href="mailto:m.de.rooy&#64;rijksmuseum.nl">m.de.rooy&#64;rijksmuseum.nl</a>&gt;</pre>
    </div>

    <div id="c38" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=19086#c38">Comment 38</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Jiaky Ooi</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-09-04 15:21:45 UTC
        </span>

      </div>




<pre class="bz_comment_text">Hello,

Just a quick question please.

As the last comment made on this thread was on the 25th August, and this has been marked as Passed QA, will there be a CVE number assigned to this vulnerability please?

Best regards,
Jiaky</pre>
    </div>

    <div id="c39" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=19086#c39">Comment 39</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Jonathan Druart</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-09-04 15:40:47 UTC
        </span>

      </div>




<pre class="bz_comment_text">(In reply to Jiaky Ooi from <a href="show_bug.cgi?id=19086#c38">comment #38</a>)
<span class="quote">&gt; As the last comment made on this thread was on the 25th August, and this has
&gt; been marked as Passed QA, will there be a CVE number assigned to this
&gt; vulnerability please?</span >

Hello Jiaky,

No, no CVE number will be assigned.

The patch is going to be pushed to master and stable branches simultaneously around September 22th.</pre>
    </div>

    <div id="c40" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=19086#c40">Comment 40</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Katrin Fischer</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-09-19 20:59:57 UTC
        </span>

      </div>




<pre class="bz_comment_text">These patches have been pushed to 16.11.x and will be in 16.11.12.</pre>
    </div>

    <div id="c41" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=19086#c41">Comment 41</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Fridolin Somers</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-09-22 15:05:29 UTC
        </span>

      </div>




<pre class="bz_comment_text">These patches have been pushed to 17.05.x and are in 17.05.04.</pre>
    </div>

    <div id="c42" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=19086#c42">Comment 42</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Amit Gupta</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-09-25 04:21:15 UTC
        </span>

      </div>




<pre class="bz_comment_text">*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE"
   href="show_bug.cgi?id=19362">Bug 19362</a> has been marked as a duplicate of this bug. ***</pre>
    </div>

    <div id="c43" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=19086#c43">Comment 43</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Jonathan Druart</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-09-29 15:46:11 UTC
        </span>

      </div>




<pre class="bz_comment_text">Pushed to master for 17.11, thanks to everybody involved!</pre>
    </div>

    <div id="c44" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=19086#c44">Comment 44</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Mason James</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-11-23 22:02:41 UTC
        </span>

      </div>




<pre class="bz_comment_text">Pushed to 16.05.x, for 16.05.17 release</pre>
    </div>

    <div id="c45" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=19086#c45">Comment 45</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Jonathan Druart</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-06-19 20:42:07 UTC
        </span>

      </div>




<pre class="bz_comment_text">Interesting thing: on <a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED FIXED - Add additional template filter methods and a filter presence test to Koha"
   href="show_bug.cgi?id=13618">bug 13618</a> it was decided to not escape the patron's messages. So maybe this will be be considered as a bug by some libraries.</pre>
    </div>


  

</td>
<td>
</td>
</tr></table>
  </div>
        

</form>

<hr>
<ul class="related_actions">
    <li><a href="show_bug.cgi?format=multiple&amp;id=19086">Format For Printing</a></li>
    <li>&nbsp;-&nbsp;<a href="show_bug.cgi?ctype=xml&amp;id=19086">XML</a></li>
    <li>&nbsp;-&nbsp;<a href="enter_bug.cgi?cloned_bug_id=19086">Clone This Bug</a></li>
    
    <li>&nbsp;-&nbsp;<a href="#">Top of page </a></li>
    </ul>

<br>
</div>

    <div id="footer">
      <div class="intro"></div>
<ul id="useful-links">
  <li id="links-actions"><ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi">New</a></li>
  <li><span class="separator">| </span><a href="describecomponents.cgi">Browse</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_bottom" name="no_redirect" value="0">
    <script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_bottom");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_bottom" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_bottom"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li></li>


  <li>
        <span class="separator">| </span>
        <a href="https://bugzilla.readthedocs.org/en/5.0/using/understanding.html" target="_blank">Help</a>
      </li>
    
      <li id="new_account_container_bottom">
        <span class="separator">| </span>
        <a href="createaccount.cgi">New&nbsp;Account</a>
      </li>

    <li id="mini_login_container_bottom">
  <span class="separator">| </span>
  <a id="login_link_bottom" href="show_bug.cgi?id=19086&amp;GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('_bottom')">Log In</a>

  <form action="show_bug.cgi?id=19086" method="POST"
        class="mini_login bz_default_hidden"
        id="mini_login_bottom">
    <input id="Bugzilla_login_bottom" required
           name="Bugzilla_login" class="bz_login"
        type="email" placeholder="Email Address">
    <input class="bz_password" name="Bugzilla_password" type="password"
           id="Bugzilla_password_bottom" required
           placeholder="Password">
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
            id="log_in_bottom">
    <a href="#" onclick="return hide_mini_login_form('_bottom')">[x]</a>
  </form>
</li>


  <li id="forgot_container_bottom">
    <span class="separator">| </span>
    <a id="forgot_link_bottom" href="show_bug.cgi?id=19086&amp;GoAheadAndLogIn=1#forgot"
       onclick="return show_forgot_form('_bottom')">Forgot Password</a>
    <form action="token.cgi" method="post" id="forgot_form_bottom"
          class="mini_forgot bz_default_hidden">
      <label for="login_bottom">Login:</label>
      <input name="loginname" size="20" id="login_bottom" required
          type="email" placeholder="Your Email Address">
      <input id="forgot_button_bottom" value="Reset Password" type="submit">
      <input type="hidden" name="a" value="reqpw">
      <input type="hidden" id="token_bottom" name="token"
             value="1635619463-Q_Zy55MhXvqexBAqnD2HEwZ9zaWWnqFwHpeWl_Gz6zs">
      <a href="#" onclick="return hide_forgot_form('_bottom')">[x]</a>
    </form>
  </li>
</ul>
  </li>

  




  
</ul>

      <div class="outro"></div>
    </div>

  </body>
</html>