<!DOCTYPE html>
<html lang="en-us">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
				[CVE-2019-19466] SCEditor - XSS Vulnerability in Version 2.1.3 &middot; Edric Teo
		</title>
<meta property="og:type" content="website" />
<meta property="og:url" content="https://edricteo.com/sceditor-xss-vulnerability-in-version-2.1.3/" />
<meta property="og:image" content="https://edricteo.com/uploads/og-meta.jpg" />
<script src="/cdn-cgi/apps/head/5PfuO59QjFPFHNxMJZH4ILRAG0o.js"></script><link rel="stylesheet" href="/css/style.css" type="text/css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Libre+Baskerville:400,400i,700">
<link rel="stylesheet" href="/custom.css" type="text/css">
<link rel="icon" type="image/png" sizes="32x32" href="/uploads/logo.png">
<link rel="icon" type="image/png" sizes="16x16" href="/uploads/logo.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
<link href="" rel="alternate" type="application/rss+xml" title="Edric Teo" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.16.0/themes/prism-okaidia.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.16.0/plugins/line-numbers/prism-line-numbers.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.16.0/plugins/toolbar/prism-toolbar.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.16.0/prism.min.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.16.0/plugins/line-numbers/prism-line-numbers.min.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.16.0/plugins/toolbar/prism-toolbar.min.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.16.0/plugins/normalize-whitespace/prism-normalize-whitespace.min.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.16.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.16.0/components/prism-python.min.js" type="text/javascript"></script>
<script async src='/cdn-cgi/challenge-platform/h/b/scripts/invisible.js'></script></head>
<body>
<nav class="nav">
<div class="nav-container">
<a href="/">
<h2 class="nav-title">Edric Teo</h2>
</a>
<ul>
<li><a href="/about">About</a></li>
<li><a href="/advisory">Advisory</a></li>
<li><a href="/">Posts</a></li>
</ul>
</div>
</nav>
<main>
<div class="post">
<div class="post-info">
<span>Written by</span>
Edric Teo
<br>
<span>on&nbsp;</span><time datetime="2019-12-05 09:00:40 &#43;0000 UTC">December 5, 2019</time>
</div>
<h1 class="post-title">[CVE-2019-19466] SCEditor - XSS Vulnerability in Version 2.1.3</h1>
<div class="post-line"></div>
<p>[CVE-2019-19466] SCEditor - XSS Vulnerability in Version 2.1.3</p>
<hr />
<p>Product Information:</p>
<p>Software: SCEditor</p>
<p>Tested Version: 2.1.3, released 04.05.2018</p>
<p>Vulnerability Type: Cross-Site Scripting (CWE-79)</p>
<p>Description: A lightweight, open source, WYSIWYG BBCode and (X)HTML editor. (copied from <a href="https://www.sceditor.com/">https://www.sceditor.com/</a>)</p>
<hr />
<p>Vulnerability description:</p>
<p>There are 3 XSS vulnerabilities in SCEditor version 2.1.3.</p>
<p>The following are the three default features which are vulnerable to XSS:</p>
<ol>
<li>Insert image</li>
<li>Insert email</li>
<li>Insert link</li>
</ol>
<p>The relevant code could be found in <strong>/src/lib/defaultCommands.js</strong>.</p>
<pre><code class="language-markup">editor.wysiwygEditorInsertHtml(
	'&lt;img' + attrs + ' src=&quot;' + url + '&quot; /&gt;' // line 505
);
</code></pre>
<pre><code class="language-markup">editor.wysiwygEditorInsertHtml(
  '&lt;a href=&quot;' + 'mailto:' + email + '&quot;&gt;' + // line 550
  	 (text || email) +
  '&lt;/a&gt;'
  );
</code></pre>
<pre><code class="language-markup">editor.wysiwygEditorInsertHtml(
	'&lt;a href=&quot;' + url + '&quot;&gt;' + text + '&lt;/a&gt;' // line 610
 );
</code></pre>
<hr />
<p>Impact:</p>
<p>The 3 identified dom-based XSS have limited impact and dependent on how these variables are used. Projects implementing SCEditor should take extra care to ensure proper sanitisation.</p>
<hr />
<p>Solution:</p>
<ul>
<li>Sanitise on the variables mentioned in the vulnerability description section.</li>
</ul>
<hr />
<p>Timeline:</p>
<p>Vulnerability found: 1.09.2019</p>
<p>Vendor informed: 01.09.2019 &amp; 26.11.2019</p>
<p>Public Advisory: 05.12.2019 (Passed 90-days since initial contact)</p>
<hr />
<p>References:</p>
<p><a href="https://github.com/samclarke/SCEditor/commit/7fd14aecc6f0c68f1e8bb98b12f6f0da769c671a" title="https://github.com/samclarke/SCEditor/commit/7fd14aecc6f0c68f1e8bb98b12f6f0da769c671a">https://github.com/samclarke/SCEditor/commit/7fd14aecc6f0c68f1e8bb98b12f6f0da769c671a</a> - reference for the latest version</p>
</div>
<div class="pagination">
<a href="/adcause-io-third-month/" class="left arrow">&#8592;</a>
<a href="/adcause-io-end-of-year-zero/" class="right arrow">&#8594;</a>
<a href="#" class="top">Top</a>
</div>
</main>
<footer>
<span>
&copy; 2015-<time datetime="2021-09-30 05:55:48.828289566 &#43;0000 UTC m=&#43;0.181091082">2021</time> Edric Teo.
</span>
</footer>
<script type="text/javascript">(function(){window['__CF$cv$params']={r:'6a68714a6c2061e9',m:'F0h_sZbSVh50N0kqPalncpbd_slO0ony9SGPfJ6UO2E-1635636742-0-AVcRpywdbJbC0Yjy/VPaBx7LJxhmpVF9mpv/rDIvs1+/pzUwNPFNwwOZlQwfHZdmwChnEiBZgwdeqr+ladXSNRU1ghb/cLhDfQrqpGS5m3sv4IcvIGUy7TX5MguiZy4JNuvGvS8vLBrmaUuqwCZqCGmzSKMgx/GbeTn+DNw15Ktp',s:[0xf9c27352a5,0x248c7864e0],u:'/cdn-cgi/challenge-platform/h/b'}})();</script><script defer src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon='{"rayId":"6a68714a6c2061e9","version":"2021.10.0","r":1,"token":"e7388f078919472ebde7c41dc94a8070","si":100}'></script>
</body>
</html>
