<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8" />
<title>mp3splt: invalid free in free_options (options_manager.c) | agostino&#039;s blog</title>
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="profile" href="http://gmpg.org/xfn/11" />
<link rel="stylesheet" type="text/css" media="all" href="https://blogs.gentoo.org/ago/wp-content/themes/kde-breathe/style.css" />
<link rel="pingback" href="https://blogs.gentoo.org/ago/xmlrpc.php" />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="agostino&#039;s blog &raquo; Feed" href="https://blogs.gentoo.org/ago/feed/" />
<link rel="alternate" type="application/rss+xml" title="agostino&#039;s blog &raquo; Comments Feed" href="https://blogs.gentoo.org/ago/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="agostino&#039;s blog &raquo; mp3splt: invalid free in free_options (options_manager.c) Comments Feed" href="https://blogs.gentoo.org/ago/2017/01/29/mp3splt-invalid-free-in-free_options-options_manager-c/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/12.0.0-1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/12.0.0-1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/blogs.gentoo.org\/ago\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.4.1"}};
			/*! This file is auto-generated */
			!function(e,a,t){var r,n,o,i,p=a.createElement("canvas"),s=p.getContext&&p.getContext("2d");function c(e,t){var a=String.fromCharCode;s.clearRect(0,0,p.width,p.height),s.fillText(a.apply(this,e),0,0);var r=p.toDataURL();return s.clearRect(0,0,p.width,p.height),s.fillText(a.apply(this,t),0,0),r===p.toDataURL()}function l(e){if(!s||!s.fillText)return!1;switch(s.textBaseline="top",s.font="600 32px Arial",e){case"flag":return!c([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])&&(!c([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!c([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]));case"emoji":return!c([55357,56424,55356,57342,8205,55358,56605,8205,55357,56424,55356,57340],[55357,56424,55356,57342,8203,55358,56605,8203,55357,56424,55356,57340])}return!1}function d(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(i=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},o=0;o<i.length;o++)t.supports[i[o]]=l(i[o]),t.supports.everything=t.supports.everything&&t.supports[i[o]],"flag"!==i[o]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[i[o]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(r=t.source||{}).concatemoji?d(r.concatemoji):r.wpemoji&&r.twemoji&&(d(r.twemoji),d(r.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='openid-css'  href='https://blogs.gentoo.org/ago/wp-content/plugins/openid/f/openid.css?ver=519' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://blogs.gentoo.org/ago/wp-includes/css/dist/block-library/style.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='toc-screen-css'  href='https://blogs.gentoo.org/ago/wp-content/plugins/table-of-contents-plus/screen.min.css?ver=2002' type='text/css' media='all' />
<link rel='stylesheet' id='wp-syntax-css-css'  href='https://blogs.gentoo.org/ago/wp-content/plugins/wp-syntax/css/wp-syntax.css?ver=1.1' type='text/css' media='all' />
<link rel='stylesheet' id='easy_table_style-css'  href='https://blogs.gentoo.org/ago/wp-content/plugins/easy-table/themes/default/style.css?ver=1.8' type='text/css' media='all' />
<script type='text/javascript' src='https://blogs.gentoo.org/ago/wp-includes/js/jquery/jquery.js?ver=1.12.4-wp'></script>
<script type='text/javascript' src='https://blogs.gentoo.org/ago/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript' src='https://blogs.gentoo.org/ago/wp-content/plugins/openid/f/openid.js?ver=519'></script>
<link rel='https://api.w.org/' href='https://blogs.gentoo.org/ago/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://blogs.gentoo.org/ago/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://blogs.gentoo.org/ago/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='mp3splt: NULL pointer dereference in  main (mp3splt.c)' href='https://blogs.gentoo.org/ago/2017/01/29/mp3splt-null-pointer-dereference-in-main-mp3splt-c/' />
<link rel='next' title='libmp3splt: NULL pointer dereference in splt_cue_export_to_file (cue.c)' href='https://blogs.gentoo.org/ago/2017/01/29/mp3splt-null-pointer-dereference-in-splt_cue_export_to_file-cue-c/' />
<meta name="generator" content="WordPress 5.4.1" />
<link rel="canonical" href="https://blogs.gentoo.org/ago/2017/01/29/mp3splt-invalid-free-in-free_options-options_manager-c/" />
<link rel='shortlink' href='https://blogs.gentoo.org/ago/?p=1160' />
<link rel="alternate" type="application/json+oembed" href="https://blogs.gentoo.org/ago/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fblogs.gentoo.org%2Fago%2F2017%2F01%2F29%2Fmp3splt-invalid-free-in-free_options-options_manager-c%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://blogs.gentoo.org/ago/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fblogs.gentoo.org%2Fago%2F2017%2F01%2F29%2Fmp3splt-invalid-free-in-free_options-options_manager-c%2F&#038;format=xml" />
            <link rel="alternate" media="only screen and (max-width: 640px)" href="https://blogs.gentoo.org/ago/#article/1160" />

	<!-- Clean Archives Reloaded v3.2.0 | http://www.viper007bond.com/wordpress-plugins/clean-archives-reloaded/ -->
	<style type="text/css">.car-collapse .car-yearmonth { cursor: s-resize; } </style>
	<script type="text/javascript">
		/* <![CDATA[ */
			jQuery(document).ready(function() {
				jQuery('.car-collapse').find('.car-monthlisting').hide();
				jQuery('.car-collapse').find('.car-monthlisting:first').show();
				jQuery('.car-collapse').find('.car-yearmonth').click(function() {
					jQuery(this).next('ul').slideToggle('fast');
				});
				jQuery('.car-collapse').find('.car-toggler').click(function() {
					if ( 'Expand All' == jQuery(this).text() ) {
						jQuery(this).parent('.car-container').find('.car-monthlisting').show();
						jQuery(this).text('Collapse All');
					}
					else {
						jQuery(this).parent('.car-container').find('.car-monthlisting').hide();
						jQuery(this).text('Expand All');
					}
					return false;
				});
			});
		/* ]]> */
	</script>

		<style type="text/css" id="wp-custom-css">
			/*
Welcome to Custom CSS!

To learn how this works, see http://wp.me/PEmnE-Bt
*/
#access li:hover &gt; a,
#access ul ul :hover &gt; a {
	color: red;
}		</style>
		</head>

<body class="post-template-default single single-post postid-1160 single-format-standard">
<div id="wrapper" class="hfeed">
	<div id="header">
            <div class="plasma-left" ></div>
            <div class="plasma-center" >
		<div id="masthead">
			<div id="branding" role="banner">
				<div id="site-title">
					<span>
						<a href="https://blogs.gentoo.org/ago/" title="agostino&#039;s blog" rel="home">agostino&#039;s blog</a>
					</span>
				</div>
				<div id="site-description">my fuzzer always find something more than your&#8230;</div>

										<img src="https://blogs.gentoo.org/ago/files/2015/06/cropped-modificato2.png" width="882" height="165" alt="" /> 
								</div><!-- #branding -->

			<div id="access" role="navigation">
			  				<div class="skip-link screen-reader-text"><a href="#content" title="Skip to content">Skip to content</a></div>
								<div class="menu-header"><ul id="menu-top-menu" class="menu"><li id="menu-item-285" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-285"><a href="https://blogs.gentoo.org/ago/agostino_sarubbo/">About me</a></li>
<li id="menu-item-286" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-286"><a href="https://blogs.gentoo.org/ago/contact/">Contact</a></li>
<li id="menu-item-287" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-287"><a href="https://blogs.gentoo.org/ago/advisories/">Advisories</a></li>
</ul></div>			</div><!-- #access -->
		</div><!-- #masthead -->
            </div><!-- #plasma-center -->
            <div class="plasma-right" ></div>
	    <div class="plasma-left-bottom" ></div>
            <div class="plasma-bottom" ></div>
            <div class="plasma-right-bottom" ></div>
            <div class="clear" ></div>
	</div><!-- #header -->

	<div id="main">

		<div id="container">
			<div id="content" role="main">


				<div id="nav-above" class="navigation">
					<div class="nav-previous"><a href="https://blogs.gentoo.org/ago/2017/01/29/mp3splt-null-pointer-dereference-in-main-mp3splt-c/" rel="prev"><span class="meta-nav">&larr;</span> mp3splt: NULL pointer dereference in  main (mp3splt.c)</a></div>
					<div class="nav-next"><a href="https://blogs.gentoo.org/ago/2017/01/29/mp3splt-null-pointer-dereference-in-splt_cue_export_to_file-cue-c/" rel="next">libmp3splt: NULL pointer dereference in splt_cue_export_to_file (cue.c) <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-above -->
                            <div class="plasma-left-top"></div>
                            <div class="plasma-top"></div>
                            <div class="plasma-right-top"></div>
                            <div class="plasma-post-center" >

				<div id="post-1160" class="post-1160 post type-post status-publish format-standard hentry category-advisories category-security">
					<h1 class="entry-title">mp3splt: invalid free in free_options (options_manager.c)</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted on</span> <a href="https://blogs.gentoo.org/ago/2017/01/29/mp3splt-invalid-free-in-free_options-options_manager-c/" title="6:44 pm" rel="bookmark"><span class="entry-date">January 29, 2017</span></a> <span class="meta-sep">by</span> <span class="author vcard"><a class="url fn n" href="https://blogs.gentoo.org/ago/author/ago/" title="View all posts by ago">ago</a></span>					</div><!-- .entry-meta -->

					<div class="entry-content">
						<p><strong>Description</strong>:<br />
<a href="http://mp3splt.sourceforge.net">mp3splt</a> is a command line utility to split mp3 and ogg files without decoding.</p>
<p>A fuzz on it discovered an invalid free.</p>
<p>The complete ASan output:</p>
<pre><font size="2"># mp3splt -P -f -t 0.1 -a $FILE
==2631==ERROR: AddressSanitizer: attempting free on address which was not malloc()-ed: 0x000000d3ef65 in thread T0
    #0 0x4d3770 in free /tmp/portage/sys-devel/llvm-3.9.0-r1/work/llvm-3.9.0.src/projects/compiler-rt/lib/asan/asan_malloc_linux.cc:47
    #1 0x50dbaa in free_options /tmp/portage/media-sound/mp3splt-2.6.2/work/mp3splt-2.6.2/src/options_manager.c:67:9
    #2 0x515623 in free_main_struct /tmp/portage/media-sound/mp3splt-2.6.2/work/mp3splt-2.6.2/src/data_manager.c:74:7
    #3 0x50ffa5 in process_confirmation_error /tmp/portage/media-sound/mp3splt-2.6.2/work/mp3splt-2.6.2/src/print_utils.c:266:7
    #4 0x51df29 in main /tmp/portage/media-sound/mp3splt-2.6.2/work/mp3splt-2.6.2/src/mp3splt.c:873:9
    #5 0x7f783aba361f in __libc_start_main /var/tmp/portage/sys-libs/glibc-2.22-r4/work/glibc-2.22/csu/libc-start.c:289
    #6 0x41ad08 in _init (/usr/bin/mp3splt+0x41ad08)

AddressSanitizer can not describe address in more detail (wild memory access suspected).
SUMMARY: AddressSanitizer: bad-free /tmp/portage/sys-devel/llvm-3.9.0-r1/work/llvm-3.9.0.src/projects/compiler-rt/lib/asan/asan_malloc_linux.cc:47 in free
==2631==ABORTING
</font></pre>
<p><strong>Affected version:</strong><br />
0.9.2</p>
<p><strong>Fixed version:</strong><br />
N/A</p>
<p><strong>Commit fix:</strong><br />
N/A</p>
<p><strong>Credit:</strong><br />
This bug was discovered by Agostino Sarubbo of Gentoo.</p>
<p><strong>CVE:</strong><br />
CVE-2017-5666</p>
<p><strong>Reproducer:</strong><br />
<a href="https://github.com/asarubbo/poc/blob/master/00130-mp3splt-badfree-free_options">https://github.com/asarubbo/poc/blob/master/00130-mp3splt-badfree-free_options</a></p>
<p><strong>Timeline:</strong><br />
2017-01-01: private report to upstream via mail<br />
2017-01-29: public upstream report on sourceforge<br />
2017-01-29: blog post about the issue<br />
2017-01-31: CVE assigned</p>
<p><strong>Note:</strong><br />
This bug was found with <a href="http://lcamtuf.coredump.cx/afl">American Fuzzy Lop</a>.</p>
<p><strong>Permalink:</strong><br />
https://blogs.gentoo.org/ago/2017/01/29/mp3splt-invalid-free-in-free_options-options_manager-c</p>
											</div><!-- .entry-content -->


					<div class="entry-utility">
						This entry was posted in <a href="https://blogs.gentoo.org/ago/category/advisories/" rel="category tag">advisories</a>, <a href="https://blogs.gentoo.org/ago/category/security/" rel="category tag">security</a>. Bookmark the <a href="https://blogs.gentoo.org/ago/2017/01/29/mp3splt-invalid-free-in-free_options-options_manager-c/" title="Permalink to mp3splt: invalid free in free_options (options_manager.c)" rel="bookmark">permalink</a>.											</div><!-- .entry-utility -->
				</div><!-- #post-## -->
                     </div><!-- plasma-post-center -->
                     <div class="plasma-left-bottom" ></div>
                     <div class="plasma-bottom" ></div>
                     <div class="plasma-right-bottom" ></div>

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="https://blogs.gentoo.org/ago/2017/01/29/mp3splt-null-pointer-dereference-in-main-mp3splt-c/" rel="prev"><span class="meta-nav">&larr;</span> mp3splt: NULL pointer dereference in  main (mp3splt.c)</a></div>
					<div class="nav-next"><a href="https://blogs.gentoo.org/ago/2017/01/29/mp3splt-null-pointer-dereference-in-splt_cue_export_to_file-cue-c/" rel="next">libmp3splt: NULL pointer dereference in splt_cue_export_to_file (cue.c) <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

                            <div class="plasma-left-top"></div>
                            <div class="plasma-top"></div>
                            <div class="plasma-right-top"></div>
                            <div class="plasma-post-center" >
				
			<div id="comments">


			<h3 id="comments-title">16 Responses to <em>mp3splt: invalid free in free_options (options_manager.c)</em></h3>


			<ol class="commentlist">
					<li class="comment even thread-even depth-1" id="li-comment-158735">
		<div id="comment-158735">
		<span class="comment-author vcard">
			<img alt='' src='https://secure.gravatar.com/avatar/62c01d55b68ac04566a9d5dd4c8d0400?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/62c01d55b68ac04566a9d5dd4c8d0400?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' />			<cite class="fn">Jonas Meurer</cite> <span class="says">says:</span>		</span><!-- .comment-author .vcard -->
		
		<span class="comment-meta commentmetadata"><a href="https://blogs.gentoo.org/ago/2017/01/29/mp3splt-invalid-free-in-free_options-options_manager-c/#comment-158735">
			February 22, 2017 at 7:38 pm</a>		</span><!-- .comment-meta .commentmetadata -->

		<span class="comment-body"><p>Hi, unfortunately I fail to reproduce the crash as the reproducer file is not accepted as input by mp3splt:</p>
<p>$ mp3splt -P -f -t 0.1 -a 00130-mp3splt-badfree-free_options<br />
mp3splt 2.6.2 (09/11/14) &#8211; using libmp3splt 0.9.2<br />
	Matteo Trotta<br />
	Alexandru Munteanu<br />
THIS SOFTWARE COMES WITH ABSOLUTELY NO WARRANTY! USE AT YOUR OWN RISK!<br />
 Pretending to split file &#8216;00130-mp3splt-badfree-free_options&#8217; &#8230;<br />
 error: no plugin matches the file &#8216;00130-mp3splt-badfree-free_options&#8217;</p>
<p>$ cat 00130-mp3splt-badfree-free_options | mp3splt -P -f -t 0.1 -a m-<br />
mp3splt 2.6.2 (09/11/14) &#8211; using libmp3splt 0.9.2<br />
	Matteo Trotta<br />
	Alexandru Munteanu<br />
THIS SOFTWARE COMES WITH ABSOLUTELY NO WARRANTY! USE AT YOUR OWN RISK!<br />
 Pretending to split file &#8216;m-&#8216; &#8230;<br />
 info: file matches the plugin &#8216;mp3 (libmad)&#8217;<br />
 error: invalid input file &#8216;m-&#8216; for &#8216;mp3 (libmad)&#8217; plugin</p>
</span>

		<span class="reply">
                        			<a rel='nofollow' class='comment-reply-link' href='https://blogs.gentoo.org/ago/2017/01/29/mp3splt-invalid-free-in-free_options-options_manager-c/?replytocom=158735#respond' data-commentid="158735" data-postid="1160" data-belowelement="comment-158735" data-respondelement="respond" aria-label='Reply to Jonas Meurer'>Reply</a>		</span><!-- .reply -->
	</div><!-- #comment-##  -->

	<ul class="children">
	<li class="comment byuser comment-author-ago bypostauthor odd alt depth-2" id="li-comment-158744">
		<div id="comment-158744">
		<span class="comment-author vcard">
			<img alt='' src='https://secure.gravatar.com/avatar/ffd3ec5554c5bffa647e2bf8ae171e68?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ffd3ec5554c5bffa647e2bf8ae171e68?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' />			<cite class="fn">ago</cite> <span class="says">says:</span>		</span><!-- .comment-author .vcard -->
		
		<span class="comment-meta commentmetadata"><a href="https://blogs.gentoo.org/ago/2017/01/29/mp3splt-invalid-free-in-free_options-options_manager-c/#comment-158744">
			February 23, 2017 at 12:17 pm</a>		</span><!-- .comment-meta .commentmetadata -->

		<span class="comment-body"><p>Are you sure you have downloaded the file instead of the html page? i.e.:<br />
# wget <a href="https://github.com/asarubbo/poc/blob/master/00130-mp3splt-badfree-free_options" rel="nofollow ugc">https://github.com/asarubbo/poc/blob/master/00130-mp3splt-badfree-free_options</a><br />
# file 00130-mp3splt-badfree-free_options<br />
00130-mp3splt-badfree-free_options: HTML document, UTF-8 Unicode text, with very long lines</p>
<p># wget <a href="https://github.com/asarubbo/poc/raw/master/00130-mp3splt-badfree-free_options" rel="nofollow ugc">https://github.com/asarubbo/poc/raw/master/00130-mp3splt-badfree-free_options</a><br />
# file 00130-mp3splt-badfree-free_options<br />
00130-mp3splt-badfree-free_options: data</p>
</span>

		<span class="reply">
                        			<a rel='nofollow' class='comment-reply-link' href='https://blogs.gentoo.org/ago/2017/01/29/mp3splt-invalid-free-in-free_options-options_manager-c/?replytocom=158744#respond' data-commentid="158744" data-postid="1160" data-belowelement="comment-158744" data-respondelement="respond" aria-label='Reply to ago'>Reply</a>		</span><!-- .reply -->
	</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment even thread-odd thread-alt depth-1" id="li-comment-158747">
		<div id="comment-158747">
		<span class="comment-author vcard">
			<img alt='' src='https://secure.gravatar.com/avatar/62c01d55b68ac04566a9d5dd4c8d0400?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/62c01d55b68ac04566a9d5dd4c8d0400?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' />			<cite class="fn">Jonas Meurer</cite> <span class="says">says:</span>		</span><!-- .comment-author .vcard -->
		
		<span class="comment-meta commentmetadata"><a href="https://blogs.gentoo.org/ago/2017/01/29/mp3splt-invalid-free-in-free_options-options_manager-c/#comment-158747">
			February 23, 2017 at 3:53 pm</a>		</span><!-- .comment-meta .commentmetadata -->

		<span class="comment-body"><p>@ago: I&#8217;m sure that I downloaded the *file*, not the HTML page. I also checked with &#8216;file &#8230;&#8217; and it gave &#8216;data&#8217;. Are you able to run &#8216;mp3splt -P -f -t 0.1 -a 00130-mp3splt-badfree-free_options&#8217; successfully?</p>
</span>

		<span class="reply">
                        			<a rel='nofollow' class='comment-reply-link' href='https://blogs.gentoo.org/ago/2017/01/29/mp3splt-invalid-free-in-free_options-options_manager-c/?replytocom=158747#respond' data-commentid="158747" data-postid="1160" data-belowelement="comment-158747" data-respondelement="respond" aria-label='Reply to Jonas Meurer'>Reply</a>		</span><!-- .reply -->
	</div><!-- #comment-##  -->

	<ul class="children">
	<li class="comment byuser comment-author-ago bypostauthor odd alt depth-2" id="li-comment-158748">
		<div id="comment-158748">
		<span class="comment-author vcard">
			<img alt='' src='https://secure.gravatar.com/avatar/ffd3ec5554c5bffa647e2bf8ae171e68?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ffd3ec5554c5bffa647e2bf8ae171e68?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' />			<cite class="fn">ago</cite> <span class="says">says:</span>		</span><!-- .comment-author .vcard -->
		
		<span class="comment-meta commentmetadata"><a href="https://blogs.gentoo.org/ago/2017/01/29/mp3splt-invalid-free-in-free_options-options_manager-c/#comment-158748">
			February 23, 2017 at 5:49 pm</a>		</span><!-- .comment-meta .commentmetadata -->

		<span class="comment-body"><p>yes.</p>
<p># wget <a href="https://github.com/asarubbo/poc/raw/master/00130-mp3splt-badfree-free_options" rel="nofollow ugc">https://github.com/asarubbo/poc/raw/master/00130-mp3splt-badfree-free_options</a> &amp;&amp; mp3splt -P -f -t 0.1 -a 00130*<br />
&#8211;2017-02-23 15:48:14&#8211;  <a href="https://github.com/asarubbo/poc/raw/master/00130-mp3splt-badfree-free_options" rel="nofollow ugc">https://github.com/asarubbo/poc/raw/master/00130-mp3splt-badfree-free_options</a><br />
Resolving github.com&#8230; 192.30.253.113, 192.30.253.112<br />
Connecting to github.com|192.30.253.113|:443&#8230; connected.<br />
HTTP request sent, awaiting response&#8230; 302 Found<br />
Location: <a href="https://raw.githubusercontent.com/asarubbo/poc/master/00130-mp3splt-badfree-free_options" rel="nofollow ugc">https://raw.githubusercontent.com/asarubbo/poc/master/00130-mp3splt-badfree-free_options</a> [following]<br />
&#8211;2017-02-23 15:48:15&#8211;  <a href="https://raw.githubusercontent.com/asarubbo/poc/master/00130-mp3splt-badfree-free_options" rel="nofollow ugc">https://raw.githubusercontent.com/asarubbo/poc/master/00130-mp3splt-badfree-free_options</a><br />
Resolving raw.githubusercontent.com&#8230; 151.101.64.133, 151.101.128.133, 151.101.192.133, &#8230;<br />
Connecting to raw.githubusercontent.com|151.101.64.133|:443&#8230; connected.<br />
HTTP request sent, awaiting response&#8230; 200 OK<br />
Length: 26968 (26K) [application/octet-stream]<br />
Saving to: &#8216;00130-mp3splt-badfree-free_options&#8217;</p>
<p>00130-mp3splt-badfree-free_options                                  100%[==================================================================================================================================================================&gt;]  26.34K  &#8211;.-KB/s    in 0.05s   </p>
<p>2017-02-23 15:48:15 (579 KB/s) &#8211; &#8216;00130-mp3splt-badfree-free_options&#8217; saved [26968/26968]</p>
<p>mp3splt 2.6.1a (19/07/14) &#8211; using libmp3splt 0.9.1a<br />
        Matteo Trotta<br />
        Alexandru Munteanu<br />
THIS SOFTWARE COMES WITH ABSOLUTELY NO WARRANTY! USE AT YOUR OWN RISK!<br />
 Pretending to split file &#8216;00130-mp3splt-badfree-free_options&#8217; &#8230;<br />
 error: no plugin matches the file &#8216;00130-mp3splt-badfree-free_options&#8217;<br />
=================================================================<br />
==26813==ERROR: AddressSanitizer: attempting free on address which was not malloc()-ed: 0x000000d3ef65 in thread T0<br />
    #0 0x4d35d0  (/usr/bin/mp3splt+0x4d35d0)<br />
    #1 0x50c598  (/usr/bin/mp3splt+0x50c598)<br />
    #2 0x511a94  (/usr/bin/mp3splt+0x511a94)<br />
    #3 0x50df37  (/usr/bin/mp3splt+0x50df37)<br />
    #4 0x517567  (/usr/bin/mp3splt+0x517567)<br />
    #5 0x7fa66fb8378f  (/lib64/libc.so.6+0x2078f)<br />
    #6 0x41ab68  (/usr/bin/mp3splt+0x41ab68)</p>
<p>AddressSanitizer can not describe address in more detail (wild memory access suspected).<br />
SUMMARY: AddressSanitizer: bad-free (/usr/bin/mp3splt+0x4d35d0)<br />
==26813==ABORTING<br />
Aborted</p>
<p>As you can see 2.6.1 is affected too.</p>
</span>

		<span class="reply">
                        			<a rel='nofollow' class='comment-reply-link' href='https://blogs.gentoo.org/ago/2017/01/29/mp3splt-invalid-free-in-free_options-options_manager-c/?replytocom=158748#respond' data-commentid="158748" data-postid="1160" data-belowelement="comment-158748" data-respondelement="respond" aria-label='Reply to ago'>Reply</a>		</span><!-- .reply -->
	</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment even thread-even depth-1" id="li-comment-158749">
		<div id="comment-158749">
		<span class="comment-author vcard">
			<img alt='' src='https://secure.gravatar.com/avatar/62c01d55b68ac04566a9d5dd4c8d0400?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/62c01d55b68ac04566a9d5dd4c8d0400?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' />			<cite class="fn">Jonas Meurer</cite> <span class="says">says:</span>		</span><!-- .comment-author .vcard -->
		
		<span class="comment-meta commentmetadata"><a href="https://blogs.gentoo.org/ago/2017/01/29/mp3splt-invalid-free-in-free_options-options_manager-c/#comment-158749">
			February 23, 2017 at 8:27 pm</a>		</span><!-- .comment-meta .commentmetadata -->

		<span class="comment-body"><p>Interesting, at least on Debian the reproducer doesn&#8217;t work. I tried it on Debian Stretch with mp3plt 2.6.2, on Debian Jessie with mp3splt 2.4.2 and on Debian Wheezy, also with mp3splt 2.4.2.</p>
<p>Unfortunately that doesn&#8217;t mean that the mp3splt Debian packages aren&#8217;t affected, only it makes debugging the issue more complicated. I guess that you use mp3splt 2.6.1a compiled from the Gentoo port sources?</p>
<p>Below is the output of the exact same command like you ran:</p>
<p>&#8220;`<br />
$ wget <a href="https://github.com/asarubbo/poc/raw/master/00130-mp3splt-badfree-free_options" rel="nofollow ugc">https://github.com/asarubbo/poc/raw/master/00130-mp3splt-badfree-free_options</a> &amp;&amp; mp3splt -P -f -t 0.1 -a 00130*<br />
&#8211;2017-02-23 18:24:58&#8211;  <a href="https://github.com/asarubbo/poc/raw/master/00130-mp3splt-badfree-free_options" rel="nofollow ugc">https://github.com/asarubbo/poc/raw/master/00130-mp3splt-badfree-free_options</a><br />
Resolving github.com (github.com)&#8230; 192.30.253.113, 192.30.253.112<br />
Connecting to github.com (github.com)|192.30.253.113|:443&#8230; connected.<br />
HTTP request sent, awaiting response&#8230; 302 Found<br />
Location: <a href="https://raw.githubusercontent.com/asarubbo/poc/master/00130-mp3splt-badfree-free_options" rel="nofollow ugc">https://raw.githubusercontent.com/asarubbo/poc/master/00130-mp3splt-badfree-free_options</a> [following]<br />
&#8211;2017-02-23 18:24:59&#8211;  <a href="https://raw.githubusercontent.com/asarubbo/poc/master/00130-mp3splt-badfree-free_options" rel="nofollow ugc">https://raw.githubusercontent.com/asarubbo/poc/master/00130-mp3splt-badfree-free_options</a><br />
Resolving raw.githubusercontent.com (raw.githubusercontent.com)&#8230; 151.101.112.133<br />
Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|151.101.112.133|:443&#8230; connected.<br />
HTTP request sent, awaiting response&#8230; 200 OK<br />
Length: 26968 (26K) [application/octet-stream]<br />
Saving to: `00130-mp3splt-badfree-free_options&#8217;</p>
<p>100%[=================================================&gt;] 26,968      &#8211;.-K/s   in 0.04s   </p>
<p>2017-02-23 18:25:00 (738 KB/s) &#8211; `00130-mp3splt-badfree-free_options&#8217; saved [26968/26968]</p>
<p>mp3splt 2.4.2 (13/05/12) &#8211; using libmp3splt 0.7.2<br />
	Matteo Trotta<br />
	Alexandru Munteanu<br />
THIS SOFTWARE COMES WITH ABSOLUTELY NO WARRANTY! USE AT YOUR OWN RISK!<br />
 Pretending to split file &#8216;00130-mp3splt-badfree-free_options&#8217; &#8230;<br />
 error: no plugin matches the file &#8216;00130-mp3splt-badfree-free_options&#8217;<br />
&#8220;`</p>
</span>

		<span class="reply">
                        			<a rel='nofollow' class='comment-reply-link' href='https://blogs.gentoo.org/ago/2017/01/29/mp3splt-invalid-free-in-free_options-options_manager-c/?replytocom=158749#respond' data-commentid="158749" data-postid="1160" data-belowelement="comment-158749" data-respondelement="respond" aria-label='Reply to Jonas Meurer'>Reply</a>		</span><!-- .reply -->
	</div><!-- #comment-##  -->

	<ul class="children">
	<li class="comment byuser comment-author-ago bypostauthor odd alt depth-2" id="li-comment-158759">
		<div id="comment-158759">
		<span class="comment-author vcard">
			<img alt='' src='https://secure.gravatar.com/avatar/ffd3ec5554c5bffa647e2bf8ae171e68?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ffd3ec5554c5bffa647e2bf8ae171e68?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' />			<cite class="fn">ago</cite> <span class="says">says:</span>		</span><!-- .comment-author .vcard -->
		
		<span class="comment-meta commentmetadata"><a href="https://blogs.gentoo.org/ago/2017/01/29/mp3splt-invalid-free-in-free_options-options_manager-c/#comment-158759">
			February 24, 2017 at 12:16 pm</a>		</span><!-- .comment-meta .commentmetadata -->

		<span class="comment-body"><p>Your package, if comes from the apt repo, is not compiled with any special flags like -fsanitize=address. So you won&#8217;t see what I&#8217;m able to see here. However I tried to build without -fsanitize=address and I see something like:<br />
*** Error in `mp3splt&#8217;: munmap_chunk(): invalid pointer: 0x0000000000a6a110 ***</p>
</span>

		<span class="reply">
                        			<a rel='nofollow' class='comment-reply-link' href='https://blogs.gentoo.org/ago/2017/01/29/mp3splt-invalid-free-in-free_options-options_manager-c/?replytocom=158759#respond' data-commentid="158759" data-postid="1160" data-belowelement="comment-158759" data-respondelement="respond" aria-label='Reply to ago'>Reply</a>		</span><!-- .reply -->
	</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment even thread-odd thread-alt depth-1" id="li-comment-158773">
		<div id="comment-158773">
		<span class="comment-author vcard">
			<img alt='' src='https://secure.gravatar.com/avatar/98f6fc2611e67d79ebf098fe520eb801?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/98f6fc2611e67d79ebf098fe520eb801?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' />			<cite class="fn">Jan Naumann</cite> <span class="says">says:</span>		</span><!-- .comment-author .vcard -->
		
		<span class="comment-meta commentmetadata"><a href="https://blogs.gentoo.org/ago/2017/01/29/mp3splt-invalid-free-in-free_options-options_manager-c/#comment-158773">
			February 25, 2017 at 4:06 pm</a>		</span><!-- .comment-meta .commentmetadata -->

		<span class="comment-body"><p>I also have tried to reproduce the bug, but cannot get the bug even if enabling -fsanitize=address.<br />
Could you post your complete gcc/clang command line for reference?</p>
</span>

		<span class="reply">
                        			<a rel='nofollow' class='comment-reply-link' href='https://blogs.gentoo.org/ago/2017/01/29/mp3splt-invalid-free-in-free_options-options_manager-c/?replytocom=158773#respond' data-commentid="158773" data-postid="1160" data-belowelement="comment-158773" data-respondelement="respond" aria-label='Reply to Jan Naumann'>Reply</a>		</span><!-- .reply -->
	</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	<li class="comment odd alt thread-even depth-1" id="li-comment-158802">
		<div id="comment-158802">
		<span class="comment-author vcard">
			<img alt='' src='https://secure.gravatar.com/avatar/31f75b7989f2aea73af13a346c8210eb?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/31f75b7989f2aea73af13a346c8210eb?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' />			<cite class="fn">Dave Kennedy</cite> <span class="says">says:</span>		</span><!-- .comment-author .vcard -->
		
		<span class="comment-meta commentmetadata"><a href="https://blogs.gentoo.org/ago/2017/01/29/mp3splt-invalid-free-in-free_options-options_manager-c/#comment-158802">
			February 27, 2017 at 9:31 am</a>		</span><!-- .comment-meta .commentmetadata -->

		<span class="comment-body"><p>This bug is marked as a release critical in Debian, and therefore mp3splt is marked for autoremoval from testing on 2017-03-06. This means that it won&#8217;t be included in the upcoming release of Debian stable (codename stretch) unless we can fix this bug.</p>
<p>I am NOT able to reproduce the original error message in the bug report. Following is a list of symptoms that I see on Gentoo (default/linux/amd64/13.0).</p>
<p>1.) With default optimizations and AddressSanitizer enabled (but no _FORTIFY_SOURCE or stack protector):<br />
AddressSanitizer: heap-buffer-overflow on address 0x61e00000ee87 at pc 0x7f3944bd4b43 bp 0x7ffcf2d62e40 sp 0x7ffcf2d625e8<br />
The backtrace starts with mad_layer_III (/usr/lib64/libmad.so.0+0x1b8bd)</p>
<p>2.) With -Og (debugging compatible optimizations) and -g enabled for libmad, libmp3splt, mp3splt, and with AddressSanitizer enabled (but no _FORTIFY_SOURCE or stack protector) for only mp3splt:</p>
<p>Program received signal SIGABRT, Aborted.<br />
0x00007ffff693d167 in raise () from /lib64/libc.so.6<br />
(gdb) bt<br />
#0  0x00007ffff693d167 in raise () from /lib64/libc.so.6<br />
#1  0x00007ffff693e5ea in abort () from /lib64/libc.so.6<br />
#2  0x00007ffff693619d in ?? () from /lib64/libc.so.6<br />
#3  0x00007ffff6936252 in __assert_fail () from /lib64/libc.so.6<br />
#4  0x00007ffff2858d36 in mad_layer_III (stream=0x62c000000a28, frame=0x62c000000aa0) at /var/tmp/portage/media-libs/libmad-0.15.1b-r8/work/libmad-0.15.1b/layer3.c:2632<br />
#5  0x00007ffff283deb0 in mad_frame_decode (frame=0x62c000000aa0, stream=0x62c000000a28) at /var/tmp/portage/media-libs/libmad-0.15.1b-r8/work/libmad-0.15.1b/frame.c:453<br />
#6  0x00007ffff2a88c02 in splt_mp3_get_frame (mp3state=mp3state@entry=0x62c000000200) at mp3_utils.c:1109<br />
#7  0x00007ffff2a7a72f in splt_mp3_info (file_input=file_input@entry=0x61600000e180, state=state@entry=0x62300000e100, framemode=, error=error@entry=0x7fffffffdbe0) at mp3.c:1247<br />
#8  0x00007ffff2a7b747 in splt_mp3_get_info (state=state@entry=0x62300000e100, file_input=, error=error@entry=0x7fffffffdbe0) at mp3.c:1479<br />
#9  0x00007ffff2a82956 in splt_mp3_init (state=state@entry=0x62300000e100, error=error@entry=0x7fffffffdbe0) at mp3.c:3377<br />
#10 0x00007ffff2a82fd6 in splt_pl_check_plugin_is_for_file (state=0x62300000e100, error=0x7fffffffdbe0) at mp3.c:3496<br />
#11 0x00007ffff6cc4d26 in splt_p_check_plugin_is_for_file (state=state@entry=0x62300000e100, error=error@entry=0x7fffffffdbe0) at plugins.c:748<br />
#12 0x00007ffff6cc0f6c in splt_check_file_type_and_set_plugin (state=state@entry=0x62300000e100, force_check_by_extension=force_check_by_extension@entry=0, show_warnings=show_warnings@entry=1, error=error@entry=0x7fffffffdca0)<br />
    at checks.c:317<br />
#13 0x00007ffff6cbcaa3 in mp3splt_split (state=state@entry=0x62300000e100) at mp3splt.c:1226<br />
#14 0x000000000040ed88 in main (argc=, orig_argv=) at mp3splt.c:872</p>
<p>This assert fails on the second call to mad_layer_III(). An initial inspection of various variables reveals only one clue so far: stream-&gt;main_data = 0x0. That means it&#8217;s a NULL pointer at the time of crash, even though it IS valid (nonzero) at the beginning of the second call to the function.</p>
<p>In my opinion, the next step is to try feeding the same data to libmad with a minimal test case (ie. remove mp3splt from the test case).</p>
<p>agostino, could you please rebuild the relevant packages with debugging enabled and provide a complete backtrace and AddressSanitizer log? And if you want extra credit then you could do some fuzzing on libmad, as that might be the root cause anyway.</p>
<p>On Gentoo in order to build packages with debugging, edit make.conf<br />
CFLAGS=&#8221;-Og -g<br />
CXXFLAGS=&#8221;${CFLAGS}</p>
<p>If you want AddressSanitizer enabled then you can use these CFLAGS.</p>
<p>CFLAGS=&#8221;${CFLAGS} -fsanitize=address -U_FORTIFY_SOURCE&#8221;<br />
CXXFLAGS=&#8221;${CXXFLAGS} -fsanitize=address -U_FORTIFY_SOURCE&#8221;<br />
LDFLAGS=&#8221;${LDFLAGS} -fsanitize=address -U_FORTIFY_SOURCE&#8221;</p>
<p>You will need to patch configure.ac in libmad to prevent stripping of -fsanitize=address. (Remove |-f from the case statement.) You also need to patch ltmain.sh in all packages so that it doesn&#8217;t strip -fsanitize=address from the LDFLAGS. Search AddressSanitizer on the Gentoo wiki for instructions (the Asantoo overlay also configures AddressSanitizer with the ASAN_OPTIONS environment variable so that logs are stored on the disk).</p>
<p>Then emerge with the following command.</p>
<p>USE=&#8221;debug c-debug no-optimise&#8221; FEATURES=nostrip emerge &#8211;ask &#8211;verbose libmad libmp3splt mp3splt</p>
<p>And to start debugging, use the following command.</p>
<p>gdb $(which mp3splt)<br />
set args -P -f -t 0.1 -a 00130-mp3splt-badfree-free_options<br />
set logging file gdb_output.txt<br />
set logging on<br />
start<br />
cont<br />
(when it crashes then type the following to get a backtrace including debugging symbols)<br />
bt</p>
<p>The output will be stored in gdb_output.txt.</p>
</span>

		<span class="reply">
                        			<a rel='nofollow' class='comment-reply-link' href='https://blogs.gentoo.org/ago/2017/01/29/mp3splt-invalid-free-in-free_options-options_manager-c/?replytocom=158802#respond' data-commentid="158802" data-postid="1160" data-belowelement="comment-158802" data-respondelement="respond" aria-label='Reply to Dave Kennedy'>Reply</a>		</span><!-- .reply -->
	</div><!-- #comment-##  -->

	<ul class="children">
	<li class="comment byuser comment-author-ago bypostauthor even depth-2" id="li-comment-158803">
		<div id="comment-158803">
		<span class="comment-author vcard">
			<img alt='' src='https://secure.gravatar.com/avatar/ffd3ec5554c5bffa647e2bf8ae171e68?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ffd3ec5554c5bffa647e2bf8ae171e68?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' />			<cite class="fn">ago</cite> <span class="says">says:</span>		</span><!-- .comment-author .vcard -->
		
		<span class="comment-meta commentmetadata"><a href="https://blogs.gentoo.org/ago/2017/01/29/mp3splt-invalid-free-in-free_options-options_manager-c/#comment-158803">
			February 27, 2017 at 10:21 am</a>		</span><!-- .comment-meta .commentmetadata -->

		<span class="comment-body"><p>Hello Dave,</p>
<p>the fuzzing stuff is done into a dedicated chroot where all packages have the debug symbols, i.e. -O2 -mtune=generic -march=x86-64 -fno-stack-protector -g3 -ggdb3 -U_FORTIFY_SOURCE ( I didn&#8217;t investigate if I can use just one between -g3/-ggdb3 but for now it is fine as is).<br />
The asan stuff is delegated via package.env, so thanks for let me know how to do it but I&#8217;m already doing this since a lot of time 🙂<br />
I&#8217;ll try to work on it and make you able to reproduce the issue.</p>
</span>

		<span class="reply">
                        			<a rel='nofollow' class='comment-reply-link' href='https://blogs.gentoo.org/ago/2017/01/29/mp3splt-invalid-free-in-free_options-options_manager-c/?replytocom=158803#respond' data-commentid="158803" data-postid="1160" data-belowelement="comment-158803" data-respondelement="respond" aria-label='Reply to ago'>Reply</a>		</span><!-- .reply -->
	</div><!-- #comment-##  -->

	<ul class="children">
	<li class="comment byuser comment-author-ago bypostauthor odd alt depth-3" id="li-comment-158806">
		<div id="comment-158806">
		<span class="comment-author vcard">
			<img alt='' src='https://secure.gravatar.com/avatar/ffd3ec5554c5bffa647e2bf8ae171e68?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ffd3ec5554c5bffa647e2bf8ae171e68?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' />			<cite class="fn">ago</cite> <span class="says">says:</span>		</span><!-- .comment-author .vcard -->
		
		<span class="comment-meta commentmetadata"><a href="https://blogs.gentoo.org/ago/2017/01/29/mp3splt-invalid-free-in-free_options-options_manager-c/#comment-158806">
			February 27, 2017 at 3:16 pm</a>		</span><!-- .comment-meta .commentmetadata -->

		<span class="comment-body"><p>I investigate a bit.<br />
When you launch mp3splt, the order where thing go are: mp3splt init -&gt; libmad stuff -&gt; bad free. While you compile libmad with debug, it hangs before you can see the bad free for some reasons. So you can compile libmad with -g/-ggdb  but you shouldn&#8217;t use &#8211;enable-debugging. Does it helps?<br />
In the meantime I&#8217;m investigating on the libmad status&#8230;</p>
</span>

		<span class="reply">
                        			<a rel='nofollow' class='comment-reply-link' href='https://blogs.gentoo.org/ago/2017/01/29/mp3splt-invalid-free-in-free_options-options_manager-c/?replytocom=158806#respond' data-commentid="158806" data-postid="1160" data-belowelement="comment-158806" data-respondelement="respond" aria-label='Reply to ago'>Reply</a>		</span><!-- .reply -->
	</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment even thread-odd thread-alt depth-1" id="li-comment-158904">
		<div id="comment-158904">
		<span class="comment-author vcard">
			<img alt='' src='https://secure.gravatar.com/avatar/31f75b7989f2aea73af13a346c8210eb?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/31f75b7989f2aea73af13a346c8210eb?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' />			<cite class="fn">Dave K</cite> <span class="says">says:</span>		</span><!-- .comment-author .vcard -->
		
		<span class="comment-meta commentmetadata"><a href="https://blogs.gentoo.org/ago/2017/01/29/mp3splt-invalid-free-in-free_options-options_manager-c/#comment-158904">
			March 5, 2017 at 8:13 am</a>		</span><!-- .comment-meta .commentmetadata -->

		<span class="comment-body"><p>I tried using the following make.conf settings. This is not a complete list. See the links below for a complete list of make.conf settings.</p>
<p>CFLAGS=-O2 -pipe -mtune=generic -march=x86-64 -g3 -ggdb3 -U_FORTIFY_SOURCE -fsanitize=address CXXFLAGS=${CFLAGS}<br />
LDFLAGS=-U_FORTIFY_SOURCE -fsanitize=address</p>
<p>And I modified libmad in the following ways.</p>
<p>1. FEATURES=nostrip ebuild /usr/portage/media-libs/libmad/libmad-0.15.1b-r8.ebuild prepare<br />
2. As a side effect of the above command, the asantoo overlay automatically runs a script that fixes libtool CFLAGS filtering for asan.<br />
3. cd /var/tmp/portage/media-libs/libmad/libmad-0.15.1b-r8/work/libmad-0.15.1b-r8<br />
4. autoupdate<br />
5. Patch configure.ac and Makefile.in to ensure that the CFLAGS from make.conf are used during the build (below is a link to the patch file that I wrote).<br />
6. touch NEWS AUTHOR ChangeLog<br />
7. Copy autogen.sh from mp3splt and run it so that the changes in step 3 take effect.<br />
8. FEATURES=nostrip ebuild /usr/portage/media-libs/libmad/libmad-0.15.1b-r8.ebuild compile<br />
9. In order to allow gdb to read the source code, make a backup copy of /var/tmp/portage/media-libs/libmad/libmad-0.15.1b-r8<br />
10. FEATURES=nostrip ebuild /usr/portage/media-libs/libmad/libmad-0.15.1b-r8.ebuild merge<br />
11. Restore the backup of /var/tmp/portage/media-libs/libmad/libmad-0.15.1b-r8<br />
12. Now the gdb backtrace and debugging include the source code</p>
<p>I followed a similar process for libmp3splt and mp3splt, except that I built them with the environment variables USE=-optimise FEATURES=nostrip in order to prevent the use of -O3. I don&#8217;t know why the Makefile sets LDFLAGS= -Wl,-O1 because it isn&#8217;t in any of the autoconf files, but one can edit the Makefile before compiling (I did not).</p>
<p>Anyway, I again ran the test case that you provided, but I still haven&#8217;t reproduced the symptoms that you described. Instead, the assert failed and the program aborted without any errors from AddressSanitizer.</p>
<p>Following are relevant settings.</p>
<p>PACKAGE.USE settings<br />
<a href="http://pastebin.com/raw/QGKf3ae7" rel="nofollow ugc">http://pastebin.com/raw/QGKf3ae7</a></p>
<p>MAKE.CONF settings<br />
<a href="http://pastebin.com/raw/tc2ug1J1" rel="nofollow ugc">http://pastebin.com/raw/tc2ug1J1</a></p>
<p>patch to ensure the correct build flags with libmad (the comments explain how it can be improved).<br />
<a href="http://pastebin.com/raw/p27bDBMt" rel="nofollow ugc">http://pastebin.com/raw/p27bDBMt</a></p>
</span>

		<span class="reply">
                        			<a rel='nofollow' class='comment-reply-link' href='https://blogs.gentoo.org/ago/2017/01/29/mp3splt-invalid-free-in-free_options-options_manager-c/?replytocom=158904#respond' data-commentid="158904" data-postid="1160" data-belowelement="comment-158904" data-respondelement="respond" aria-label='Reply to Dave K'>Reply</a>		</span><!-- .reply -->
	</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	<li class="comment odd alt thread-even depth-1" id="li-comment-158908">
		<div id="comment-158908">
		<span class="comment-author vcard">
			<img alt='' src='https://secure.gravatar.com/avatar/31f75b7989f2aea73af13a346c8210eb?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/31f75b7989f2aea73af13a346c8210eb?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' />			<cite class="fn">Dave K</cite> <span class="says">says:</span>		</span><!-- .comment-author .vcard -->
		
		<span class="comment-meta commentmetadata"><a href="https://blogs.gentoo.org/ago/2017/01/29/mp3splt-invalid-free-in-free_options-options_manager-c/#comment-158908">
			March 5, 2017 at 9:00 am</a>		</span><!-- .comment-meta .commentmetadata -->

		<span class="comment-body"><p>UPDATE. I did more debugging and found that libmp3splt loops on calls to mad_frame_decode() without doing any operations on memory between said calls. </p>
<p>Also, what I said earlier about main_data being a NULL pointer is not correct. As long as mp3splt, libmp3splt and libmad were built with debugging symbols and working assert(), whenever I checked main_data it was valid if it was supposed to be valid.</p>
<p>So in my opinion this bug should be filed with libmad. Sure enough, there is a bug already reported with libmad that in my opinion matches the symptoms exactly: Debian Bug #287519.</p>
<p><a href="https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=287519" rel="nofollow ugc">https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=287519</a></p>
<p>Glenn Maynard said that &#8220;&#8230;the assertion isn&#8217;t compiled into release<br />
libraries, which means that it&#8217;s clobbering memory and crashing later&#8211;causing<br />
hard-to-trace memory corruption later on.&#8221;</p>
<p>I don&#8217;t know what the solution to this problem is immediately, but for now can we agree to request that this bug be reassigned to libmad instead of mp3splt? My guess is that the reproducer file would cause the same symptoms in madplay if it were patched to continue processing the file despite synchronization failure.</p>
<p>Here is some of the output from my debugging session and a link to the ISO/IEC 11172-3 standard (MP3 decoding guidelines).</p>
<p>Debugging session with the values of relevant variables just before the assert fails<br />
<a href="http://pastebin.com/raw/PSb8SDiD" rel="nofollow ugc">http://pastebin.com/raw/PSb8SDiD</a></p>
<p>ISO/IEC 11172 &#8211; Part 3: Audio<br />
<a href="http://www.mp3-tech.org/programmer/docs/iso11172-3.zip" rel="nofollow ugc">http://www.mp3-tech.org/programmer/docs/iso11172-3.zip</a></p>
<p>More MP3 technical documents<br />
<a href="http://www.mp3-tech.org/programmer/docs/index.php" rel="nofollow ugc">http://www.mp3-tech.org/programmer/docs/index.php</a></p>
</span>

		<span class="reply">
                        			<a rel='nofollow' class='comment-reply-link' href='https://blogs.gentoo.org/ago/2017/01/29/mp3splt-invalid-free-in-free_options-options_manager-c/?replytocom=158908#respond' data-commentid="158908" data-postid="1160" data-belowelement="comment-158908" data-respondelement="respond" aria-label='Reply to Dave K'>Reply</a>		</span><!-- .reply -->
	</div><!-- #comment-##  -->

	<ul class="children">
	<li class="comment byuser comment-author-ago bypostauthor even depth-2" id="li-comment-158913">
		<div id="comment-158913">
		<span class="comment-author vcard">
			<img alt='' src='https://secure.gravatar.com/avatar/ffd3ec5554c5bffa647e2bf8ae171e68?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ffd3ec5554c5bffa647e2bf8ae171e68?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' />			<cite class="fn">ago</cite> <span class="says">says:</span>		</span><!-- .comment-author .vcard -->
		
		<span class="comment-meta commentmetadata"><a href="https://blogs.gentoo.org/ago/2017/01/29/mp3splt-invalid-free-in-free_options-options_manager-c/#comment-158913">
			March 5, 2017 at 1:38 pm</a>		</span><!-- .comment-meta .commentmetadata -->

		<span class="comment-body"><p>Dave,</p>
<p>it is great that you spend time on it, but you made a process that I never suggester and/or described.</p>
<p>When I do fuzzing, I use more advanced features but basically you _need_ to have:</p>
<p># cat /etc/portage/env/asan<br />
CC=&#8221;clang&#8221;<br />
CXX=&#8221;clang++&#8221;<br />
CFLAGS=&#8221;${CFLAGS} -fsanitize=address&#8221;<br />
CXXFLAGS=&#8221;${CXXFLAGS} -fsanitize=address&#8221;<br />
LDFLAGS=&#8221;${LDFLAGS} -fsanitize=address&#8221;</p>
<p># cat /etc/portage/package.env<br />
media-sound/mp3splt asan</p>
<p># grep mp3splt /etc/portage/package.keywords<br />
media-sound/mp3splt</p>
<p>and FEATURES=&#8221;splitdebug&#8221; in make.conf</p>
<p>then, simply emerge -v mp3splt</p>
<p>Apart that. I worked on it too this morning and I discovered that if you compile it with gcc you see an overflow in libmad (which I already reported days ago after your input to fuzz libmad too) and if you compile with clang-3.9.1 you can see the bad free. Would at this point it help? If not, send me an email and I will provide a chroot where you will able to reproduce what I described. Thanks.</p>
</span>

		<span class="reply">
                        			<a rel='nofollow' class='comment-reply-link' href='https://blogs.gentoo.org/ago/2017/01/29/mp3splt-invalid-free-in-free_options-options_manager-c/?replytocom=158913#respond' data-commentid="158913" data-postid="1160" data-belowelement="comment-158913" data-respondelement="respond" aria-label='Reply to ago'>Reply</a>		</span><!-- .reply -->
	</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-158929">
		<div id="comment-158929">
		<span class="comment-author vcard">
			<img alt='' src='https://secure.gravatar.com/avatar/31f75b7989f2aea73af13a346c8210eb?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/31f75b7989f2aea73af13a346c8210eb?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' />			<cite class="fn">Dave K</cite> <span class="says">says:</span>		</span><!-- .comment-author .vcard -->
		
		<span class="comment-meta commentmetadata"><a href="https://blogs.gentoo.org/ago/2017/01/29/mp3splt-invalid-free-in-free_options-options_manager-c/#comment-158929">
			March 6, 2017 at 6:11 am</a>		</span><!-- .comment-meta .commentmetadata -->

		<span class="comment-body"><p>I am able to reproduce the symptoms (invalid free in options_manager.c) after building mp3splt with clang and the other portage settings that you listed.</p>
<p>Let us call this test &#8220;Test A&#8221;. This particular test does not determine which package is at fault for causing memory corruption. That&#8217;s because the stack protection and AddressSanitizer are disabled for everything except the main mp3splt binary.  Yet mp3splt loads several dynamic libraries that could be the culprit.</p>
<p>Test A also does not enable the critical assert() in libmad. Therefore a buffer overflow occurs, overwriting memory that later causes options_manager.c to attempt to free data that was not malloc&#8217;d. The reason that Test A does not enable the critical assert() is because the default USE flags are -debug, which eventually passes &#8211;disable-debugging to configure.ac. This in turn causes the NDEBUG variable to be set, which causes assert to be defined as /* nothing */.</p>
<p>Sure enough, when I build with the following command</p>
<p>USE=debug ebuild /usr/portage/media-libs/libmad/libmad-0.15.1b-r8.ebuild merge</p>
<p>which we shall call &#8220;Test B&#8221;, the assert fails and the program aborts with no buffer overflow and no invalid free. And yes, mp3splt is built with clang.</p>
<p>In conclusion, the configure flags of libmad are the root cause of the problem, and mp3splt is only affected in the case that all protections are disabled (stack protection and AddressSanitizer).</p>
<p>Do you think that the solution is to enable the asserts in libmad regardless of the debug flags?</p>
</span>

		<span class="reply">
                        			<a rel='nofollow' class='comment-reply-link' href='https://blogs.gentoo.org/ago/2017/01/29/mp3splt-invalid-free-in-free_options-options_manager-c/?replytocom=158929#respond' data-commentid="158929" data-postid="1160" data-belowelement="comment-158929" data-respondelement="respond" aria-label='Reply to Dave K'>Reply</a>		</span><!-- .reply -->
	</div><!-- #comment-##  -->

	<ul class="children">
	<li class="comment byuser comment-author-ago bypostauthor even depth-2" id="li-comment-158933">
		<div id="comment-158933">
		<span class="comment-author vcard">
			<img alt='' src='https://secure.gravatar.com/avatar/ffd3ec5554c5bffa647e2bf8ae171e68?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ffd3ec5554c5bffa647e2bf8ae171e68?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' />			<cite class="fn">ago</cite> <span class="says">says:</span>		</span><!-- .comment-author .vcard -->
		
		<span class="comment-meta commentmetadata"><a href="https://blogs.gentoo.org/ago/2017/01/29/mp3splt-invalid-free-in-free_options-options_manager-c/#comment-158933">
			March 6, 2017 at 10:41 am</a>		</span><!-- .comment-meta .commentmetadata -->

		<span class="comment-body"><p>Dave, I&#8217;m happy you finally reached the bug 🙂</p>
<p>I didn&#8217;t look deeper in the code as I&#8217;m devolving the time only to fuzz and I let to do analysis to upstream. However as I explained in the past comment, the process looks like &#8220;mp3splt -&gt; $OTHER_LIBS -&gt; bad free&#8221;. While you enable the asserts in libmad it denies you to reach the bad free bug with the provided testcase, so consider the following:<br />
1) It may be possible that the bug comes up with another round of fuzzing where libmad has debug symbols (I&#8217;ll try);<br />
2) An attacker that know this story, can provide a crafted audio which can bypass what fails in the assert, but reach the bad free.</p>
</span>

		<span class="reply">
                        			<a rel='nofollow' class='comment-reply-link' href='https://blogs.gentoo.org/ago/2017/01/29/mp3splt-invalid-free-in-free_options-options_manager-c/?replytocom=158933#respond' data-commentid="158933" data-postid="1160" data-belowelement="comment-158933" data-respondelement="respond" aria-label='Reply to ago'>Reply</a>		</span><!-- .reply -->
	</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="post pingback">
		<p>Pingback: <a href='https://www.sec.uno/2017/03/06/sb17-065-vulnerability-summary-for-the-week-of-february-27-2017/' rel='external nofollow ugc' class='url'>SB17-065: Vulnerability Summary for the Week of February 27, 2017 &#8211; sec.uno</a></p>
	</li><!-- #comment-## -->
			</ol>



	<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/ago/2017/01/29/mp3splt-invalid-free-in-free_options-options_manager-c/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://blogs.gentoo.org/ago/wp-comments-post.php" method="post" id="commentform" class="comment-form"><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" required='required' /></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="text" value="" size="30" maxlength="100" aria-describedby="email-notes" required='required' /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="text" value="" size="30" maxlength="200" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='1160' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="19cb51c006" /></p>		<span id="openid_comment">
			<label>
				<input type="checkbox" id="login_with_openid" name="login_with_openid" checked="checked" />
				Authenticate this comment using <span class="openid_link">OpenID</span>.			</label>
		</span>
		<script type="text/javascript">jQuery(function(){ add_openid_to_comment_form('https://blogs.gentoo.org/ago/index.php', 'ce29c63e06') })</script>
		<p style="display: none;"><input type="hidden" id="ak_js" name="ak_js" value="20"/></p></form>	</div><!-- #respond -->
	<p class="akismet_comment_form_privacy_notice">This site uses Akismet to reduce spam. <a href="https://akismet.com/privacy/" target="_blank" rel="nofollow noopener">Learn how your comment data is processed</a>.</p>
</div><!-- #comments -->
                     </div><!-- plasma-post-center -->
                     <div class="plasma-left-bottom" ></div>
                     <div class="plasma-bottom" ></div>
                     <div class="plasma-right-bottom" ></div>


			</div><!-- #content -->
		</div><!-- #container -->


		<div id="primary" class="widget-area" role="complementary">
                    <div class="plasma-left-top"></div>
                    <div class="plasma-top"></div>
                    <div class="plasma-right-top"></div>
                    <div class="plasma-side-center">
			<ul class="xoxo">

<li id="search-2" class="widget-container widget_search"><form role="search" method="get" id="searchform" class="searchform" action="https://blogs.gentoo.org/ago/">
				<div>
					<label class="screen-reader-text" for="s">Search for:</label>
					<input type="text" value="" name="s" id="s" />
					<input type="submit" id="searchsubmit" value="Search" />
				</div>
			</form></li>		<li id="recent-posts-2" class="widget-container widget_recent_entries">		<h3 class="widget-title">Recent Posts</h3>		<ul>
											<li>
					<a href="https://blogs.gentoo.org/ago/2020/07/04/gentoo-tinderbox/">gentoo tinderbox</a>
									</li>
											<li>
					<a href="https://blogs.gentoo.org/ago/2020/04/19/re2c-heap-overflow-in-scannerfill-scanner-cc/">re2c: heap overflow in Scanner::fill (scanner.cc)</a>
									</li>
											<li>
					<a href="https://blogs.gentoo.org/ago/2020/04/16/why-i-stopped-fuzzing-research/">Why I stopped fuzzing research</a>
									</li>
											<li>
					<a href="https://blogs.gentoo.org/ago/2019/03/20/install-gentoo-in-less-than-one-minute/">Install Gentoo in less than one minute</a>
									</li>
											<li>
					<a href="https://blogs.gentoo.org/ago/2017/10/24/binutils-invalid-memory-read-in-find_abstract_instance_name-dwarf2-c/">binutils: invalid memory read in find_abstract_instance_name (dwarf2.c)</a>
									</li>
					</ul>
		</li><li id="recent-comments-2" class="widget-container widget_recent_comments"><h3 class="widget-title">Recent Comments</h3><ul id="recentcomments"><li class="recentcomments"><span class="comment-author-link">strongcourage</span> on <a href="https://blogs.gentoo.org/ago/2020/04/16/why-i-stopped-fuzzing-research/#comment-181437">Why I stopped fuzzing research</a></li><li class="recentcomments"><span class="comment-author-link"><a href='http://www.graphicsmagick.org/' rel='external nofollow ugc' class='url'>Bob Friesenhahn</a></span> on <a href="https://blogs.gentoo.org/ago/2020/04/16/why-i-stopped-fuzzing-research/#comment-181419">Why I stopped fuzzing research</a></li><li class="recentcomments"><span class="comment-author-link"><a href='https://placeholderapi.wordpress.com/2020/04/18/gentoo-dev-why-i-stopped-fuzzing-research-https-blogs-gentoo-or/' rel='external nofollow ugc' class='url'>#gentoo dev: Why I stopped fuzzing research https://blogs.gentoo.or&#8230; | Dr. Roy Schestowitz (罗伊)</a></span> on <a href="https://blogs.gentoo.org/ago/2020/04/16/why-i-stopped-fuzzing-research/#comment-181400">Why I stopped fuzzing research</a></li><li class="recentcomments"><span class="comment-author-link">Ulya</span> on <a href="https://blogs.gentoo.org/ago/2020/04/16/why-i-stopped-fuzzing-research/#comment-181396">Why I stopped fuzzing research</a></li><li class="recentcomments"><span class="comment-author-link">ago</span> on <a href="https://blogs.gentoo.org/ago/2019/03/20/install-gentoo-in-less-than-one-minute/#comment-178429">Install Gentoo in less than one minute</a></li></ul></li><li id="archives-2" class="widget-container widget_archive"><h3 class="widget-title">Archives</h3>		<ul>
				<li><a href='https://blogs.gentoo.org/ago/2020/07/'>July 2020</a></li>
	<li><a href='https://blogs.gentoo.org/ago/2020/04/'>April 2020</a></li>
	<li><a href='https://blogs.gentoo.org/ago/2019/03/'>March 2019</a></li>
	<li><a href='https://blogs.gentoo.org/ago/2017/10/'>October 2017</a></li>
	<li><a href='https://blogs.gentoo.org/ago/2017/09/'>September 2017</a></li>
	<li><a href='https://blogs.gentoo.org/ago/2017/08/'>August 2017</a></li>
	<li><a href='https://blogs.gentoo.org/ago/2017/07/'>July 2017</a></li>
	<li><a href='https://blogs.gentoo.org/ago/2017/06/'>June 2017</a></li>
	<li><a href='https://blogs.gentoo.org/ago/2017/05/'>May 2017</a></li>
	<li><a href='https://blogs.gentoo.org/ago/2017/04/'>April 2017</a></li>
	<li><a href='https://blogs.gentoo.org/ago/2017/03/'>March 2017</a></li>
	<li><a href='https://blogs.gentoo.org/ago/2017/02/'>February 2017</a></li>
	<li><a href='https://blogs.gentoo.org/ago/2017/01/'>January 2017</a></li>
	<li><a href='https://blogs.gentoo.org/ago/2016/12/'>December 2016</a></li>
	<li><a href='https://blogs.gentoo.org/ago/2016/11/'>November 2016</a></li>
	<li><a href='https://blogs.gentoo.org/ago/2016/10/'>October 2016</a></li>
	<li><a href='https://blogs.gentoo.org/ago/2016/09/'>September 2016</a></li>
	<li><a href='https://blogs.gentoo.org/ago/2016/08/'>August 2016</a></li>
	<li><a href='https://blogs.gentoo.org/ago/2016/07/'>July 2016</a></li>
	<li><a href='https://blogs.gentoo.org/ago/2016/02/'>February 2016</a></li>
	<li><a href='https://blogs.gentoo.org/ago/2015/07/'>July 2015</a></li>
	<li><a href='https://blogs.gentoo.org/ago/2013/08/'>August 2013</a></li>
	<li><a href='https://blogs.gentoo.org/ago/2013/06/'>June 2013</a></li>
	<li><a href='https://blogs.gentoo.org/ago/2013/05/'>May 2013</a></li>
	<li><a href='https://blogs.gentoo.org/ago/2013/01/'>January 2013</a></li>
	<li><a href='https://blogs.gentoo.org/ago/2012/12/'>December 2012</a></li>
	<li><a href='https://blogs.gentoo.org/ago/2012/11/'>November 2012</a></li>
	<li><a href='https://blogs.gentoo.org/ago/2012/10/'>October 2012</a></li>
	<li><a href='https://blogs.gentoo.org/ago/2012/08/'>August 2012</a></li>
	<li><a href='https://blogs.gentoo.org/ago/2012/07/'>July 2012</a></li>
	<li><a href='https://blogs.gentoo.org/ago/2012/06/'>June 2012</a></li>
		</ul>
			</li><li id="categories-2" class="widget-container widget_categories"><h3 class="widget-title">Categories</h3>		<ul>
				<li class="cat-item cat-item-12"><a href="https://blogs.gentoo.org/ago/category/advisories/">advisories</a>
</li>
	<li class="cat-item cat-item-4"><a href="https://blogs.gentoo.org/ago/category/arch-testing/">arch testing</a>
</li>
	<li class="cat-item cat-item-3"><a href="https://blogs.gentoo.org/ago/category/gentoo/">gentoo</a>
</li>
	<li class="cat-item cat-item-10"><a href="https://blogs.gentoo.org/ago/category/security/">security</a>
</li>
		</ul>
			</li><li id="meta-2" class="widget-container widget_meta"><h3 class="widget-title">Meta</h3>			<ul>
						<li><a href="https://blogs.gentoo.org/ago/wp-login.php">Log in</a></li>
			<li><a href="https://blogs.gentoo.org/ago/feed/">Entries feed</a></li>
			<li><a href="https://blogs.gentoo.org/ago/comments/feed/">Comments feed</a></li>
			<li><a href="https://wordpress.org/">WordPress.org</a></li>			</ul>
			</li>			</ul>
                    </div><!-- plasam-center -->
                    <div class="plasma-left-bottom" ></div>
                    <div class="plasma-bottom" ></div>
                    <div class="plasma-right-bottom" ></div>
		</div><!-- #primary .widget-area -->

	</div><!-- #main -->

	<div id="footer" role="contentinfo">
 
            <div class="plasma-left-top"></div>
            <div class="plasma-top"></div>
            <div class="plasma-right-top"></div>
            <div class="plasma-left"></div>
            <div class="plasma-center" >
                <div id="colophon">
			<div id="site-info">
				<a href="https://blogs.gentoo.org/ago/" title="agostino&#039;s blog" rel="home">
					agostino&#039;s blog				</a>
                                Original theme twentyten, modified by csslayer. Better experience in firefox and webkit.
			</div><!-- #site-info -->

			<div id="site-generator">
								<a href="http://wordpress.org/"
						title="Semantic Personal Publishing Platform" rel="generator">
					Proudly powered by WordPress.				</a>
			</div><!-- #site-generator -->

		</div><!-- #colophon -->
            </div><!-- plasma-post-center -->
            <div class="plasma-right" ></div>
	</div><!-- #footer -->

</div><!-- #wrapper -->

<script type='text/javascript' src='https://blogs.gentoo.org/ago/wp-includes/js/comment-reply.min.js?ver=5.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var tocplus = {"visibility_show":"show","visibility_hide":"hide","width":"Auto"};
/* ]]> */
</script>
<script type='text/javascript' src='https://blogs.gentoo.org/ago/wp-content/plugins/table-of-contents-plus/front.min.js?ver=2002'></script>
<script type='text/javascript' src='https://blogs.gentoo.org/ago/wp-content/plugins/wp-syntax/js/wp-syntax.js?ver=1.1'></script>
<script type='text/javascript' src='https://blogs.gentoo.org/ago/wp-includes/js/wp-embed.min.js?ver=5.4.1'></script>
<script async="async" type='text/javascript' src='https://blogs.gentoo.org/ago/wp-content/plugins/akismet/_inc/form.js?ver=4.1.5'></script>
</body>
</html>
