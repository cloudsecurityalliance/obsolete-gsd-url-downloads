<!DOCTYPE html>
<html lang="en"><meta charset="UTF-8">
<link rel="stylesheet" href="https://dino.im/scss/main.min.c077f789c253e74e4149d003cf6f7de2f36e3482946942bf5a1f8aa8cb810508.css">
<title>Path traversal in Dino file transfers - Dino. Communicating happiness.</title><meta property="og:image" content="https://dino.im/img/open_graph_image.png" />
<meta property="og:description" content="A privacy-friendly messaging app for the desktop. It uses the XMPP protocol and provides a clean UI with modern features." />
<link rel="me" href="https://fosstodon.org/@dino" />

<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Dino is a modern open-source chat client for the desktop. It focuses on providing a clean and reliable Jabber/XMPP experience while having your privacy in mind.">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="icon" type="image/png" href="/favicon.png" sizes="32x32">
<meta name="theme-color" content="#009688">
<meta name="msapplication-navbutton-color" content="#009688">
<meta name="apple-mobile-web-app-status-bar-style" content="#009688">

<noscript>
    <style>
        #navbar {
            box-shadow: #212529 0 0 3px 0;
        }
    </style>
</noscript>

    <body>
        <nav id="navbar" class="navbar navbar-expand-md fixed-top navbar-light bg-light">
    <div class="container">
        <a class="h1 navbar-brand mb-0" href="/">
            <img src="/img/logo.svg" height="48" class="d-inline-block align-middle" alt=""> Dino.
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse"
                aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse justify-content-between" id="navbarCollapse">
            <ul class="navbar-nav">
                <li class="nav-item"><a class="nav-link" href="/#features">Features</a></li>
                <li class="nav-item"><a class="nav-link" href="/#download">Downloads</a></li>
                <li class="nav-item"><a class="nav-link" href="/blog/">Blog</a></li>
            </ul>
            <div class="nav-item nav-ext-links">
                <a class="nav-icon-link" href="https://fosstodon.org/@dino" style="margin-right: 10px"><img height="28" src="/img/mastodon.svg" alt="Mastodon" title="Dino on Mastodon" /></a>
                <a class="nav-icon-link" href="https://github.com/dino/dino"><img height="28" src="/img/github.svg" title="Dino on GitHub" /></a>
            </div>
        </div>
    </div>
</nav>

        <div id="content" style="padding-top: 77px">
<main class="container">
    <div class="row justify-content-center py-5">
        <div class="col blog-post-container">
            <p class="post-title h1">Path traversal in Dino file transfers</p>
            
            <p class="post-subtitle h3">CVE-2021-33896</p>
            


<div class="post-date-and-length d-flex justify-content-between">
    <small>
        Published: <time datetime='2021-06-07T18:30:00&#43;02:00'>Mon Jun 7, 2021</time>
        
        &middot;
        Last updated: <time datetime='2021-06-08T01:30:00&#43;02:00'>Tue Jun 8, 2021</time>
        
    </small>
</div>

            <div class="post-content">
                <h3 id="severity">Severity</h3>
<p>Medium (4.7): AV:N/AC:L/PR:N/UI:R/S:C/C:N/I:L/A:N</p>
<h3 id="affected-versions">Affected versions</h3>
<ul>
<li>Release version 0.2.0</li>
<li>Release version 0.1.1 and earlier</li>
<li>Nightly version 0.2.0~git113.20210601.1ac16ecd and earlier</li>
</ul>
<h3 id="fixed-versions">Fixed versions</h3>
<ul>
<li>Release version 0.2.1</li>
<li>Release version 0.1.2</li>
<li>Nightly version 0.2.0~git114.20210607.0c8d25b7</li>
</ul>
<h3 id="description">Description</h3>
<p>It was discovered that when a user receives and downloads a file in
Dino, URI-encoded path separators in the file name will be decoded,
allowing an attacker to traverse directories and create arbitrary files
in the context of the user.</p>
<p>This vulnerability does not allow to overwrite or modify existing files
and the attacker cannot control the executable flag of created files.
However, third-party software may be affected by newly created
configuration files, potentially allowing for code execution.</p>
<p>The file name, including path separators, is displayed to the user,
however, long file names are ellipsized in the middle of the file name,
allowing the attacker to hide the malicious path separators, as long as
the resulting file name has sufficient length.</p>
<h3 id="advice">Advice</h3>
<p>All deployments should upgrade to a fixed version or apply the patch
from commit 0c8d25b7a3e7a10a506f1e19b868fe9b0c761495.</p>
<h3 id="credits">Credits</h3>
<p>Many thanks to CTurt (Google) for discovering and reporting this issue.</p>
<h3 id="links">Links</h3>
<ul>
<li><a href="https://dino.im/security/cve-2021-33896/">https://dino.im/security/cve-2021-33896/</a></li>
<li><a href="https://github.com/dino/dino/commit/0c8d25b7">https://github.com/dino/dino/commit/0c8d25b7</a></li>
<li><a href="https://github.com/dino/dino/releases/tag/v0.2.1">https://github.com/dino/dino/releases/tag/v0.2.1</a></li>
<li><a href="https://github.com/dino/dino/releases/tag/v0.1.2">https://github.com/dino/dino/releases/tag/v0.1.2</a></li>
<li><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-33896">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-33896</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-33896">https://nvd.nist.gov/vuln/detail/CVE-2021-33896</a></li>
<li><a href="https://www.openwall.com/lists/oss-security/2021/06/07/2">https://www.openwall.com/lists/oss-security/2021/06/07/2</a></li>
<li><a href="https://security-tracker.debian.org/tracker/CVE-2021-33896">https://security-tracker.debian.org/tracker/CVE-2021-33896</a></li>
<li><a href="https://bugzilla.redhat.com/show_bug.cgi?id=1968753">https://bugzilla.redhat.com/show_bug.cgi?id=1968753</a></li>
<li><a href="https://bugs.gentoo.org/show_bug.cgi?id=CVE-2021-33896">https://bugs.gentoo.org/show_bug.cgi?id=CVE-2021-33896</a></li>
<li><a href="https://security.archlinux.org/CVE-2021-33896">https://security.archlinux.org/CVE-2021-33896</a></li>
</ul>

            </div>
        </div>
    </div>
</main>

        </div>
        <div class="container">
    <footer style="margin-top: 16px; padding:1em 0">
        <p>Copyright &copy; 2016 &#8211; 2021 Dino Team</p>
    </footer>
</div>
<script src="/js/jquery-slim.min.js"></script>
<script src="/js/popper.min.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script type="text/javascript">
    (function ($) {
        var originalBoxShadow = '#212529 0 0 3px 0';

        function resetNavbar() {
            var navbar = $('#navbar');
            if (!originalBoxShadow) originalBoxShadow = navbar.css('box-shadow');
            if ($(this).scrollTop() > 0) {
                navbar.css('box-shadow', originalBoxShadow);
                navbar.css('transition', 'box-shadow .2s')
            } else {
                navbar.css('box-shadow', 'none')
            }
        }

        $(document).ready(function () {
            resetNavbar();

            $(function () {
                $(window).scroll(function () {
                    resetNavbar();
                });
            });
        });

        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    }(jQuery))
</script>
    </body>
</html>
