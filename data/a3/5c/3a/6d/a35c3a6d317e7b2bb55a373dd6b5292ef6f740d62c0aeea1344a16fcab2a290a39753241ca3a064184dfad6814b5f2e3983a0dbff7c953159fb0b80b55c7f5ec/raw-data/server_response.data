<!DOCTYPE html>
<html lang = "en">
    <head>
        <!-- Google analytics -->
        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-35698287-5"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());

            gtag('config', 'UA-35698287-5');
        </script>

        <!-- SEO Stuff -->
        <meta charset = "utf-8">
        <title>Christopher Cerne | CVE-2020-12123</title>
        <meta name = "description" content = "Christopher Cerne is a computer science student, cyber security nerd, and published writer.">
        <link rel = "canonical" href = "https://cerne.xyz" />

        <!-- Temporary fix, later switch to stylesheet -->
        <style>
            p img {
                /* make img responsive */
                width: 100%;
            }
        </style>

        <!-- Bootstrap CDN -->
        <link rel="stylesheet" href = "https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity = "sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin = "anonymous">

        <!-- FontAwesome Kit -->
        <script src = "https://kit.fontawesome.com/616992053c.js" crossorigin = "anonymous"></script>

        <!-- Make the site responsive -->
        <meta name = "viewport" content = "width=device-width, initial-scale=1, shrink-to-fit=no">
    </head>

    <body>
        <div class = "d-flex flex-column flex-md-row align-items-center p-3 px-md-4 mb-0 bg-white border-bottom shadow-sm">
    <h5 class = "my-0 mr-md-auto font-weight-normal">cerne.xyz</h5>
    <nav class="my-2 my-md-0 mr-md-3">
        <a class="p-2 text-dark" href="/pages/trophies.html">Bug Trophies</a>
    </nav>
    <nav class="my-2 my-md-0 mr-md-3">
        <a class="p-2 text-dark" href="/pages/portfolio.html">Portfolio</a>
    </nav>
    <a class="btn btn-outline-primary" href="/">Home</a>
</div>

        <div class = "container">
            <h1 class = "mt-5">CVE-2020-12123</h1>
            <p>This vulnerability is a Cross-Site Request Forgery (CSRF) in the WAVLINK WN530H4 router.</p>

<p>Many endpoints in the web interface <kbd>/cgi-bin/</kbd> directory are vulnerable to CSRF. This effectively allows other websites to submit requests to the router page without the user knowing – even if the router manufacturers patch the cgi-bin authentication bypass (however, the attack will only work if the admin is logged in).</p>

<p>Malicious websites with hoards of router vulnerabilities could create traps on the Internet with maliciously-crafted websites that trigger vulnerabilities in the router. As an example, consider this malicious HTML page.</p>

<pre>
<code>
&#x3C;html&#x3E;
    &#x3C;head&#x3E;
        &#x3C;title&#x3E;Reboot!&#x3C;/title&#x3E;
        &#x3C;script src = &#x22;http://192.168.10.1/cgi-bin/live_api.cgi?page=hacked&#x26;id=1337&#x26;ip=;reboot;&#x22;&#x3E;&#x3C;/script&#x3E;
   &#x3C;/head&#x3E;
   &#x3C;body&#x3E;
       &#x3C;h1&#x3E;This webpage reboots the WAVLINK router.&#x3C;/h1&#x3E;
   &#x3C;/body&#x3E;
&#x3C;/html&#x3E;
</code>
</pre>

<p>This malicious HTML exploits the command line injection vulnerability “remotely” by rebooting the router (effectively causing a denial of service). An unsuspecting user could succumb themselves to this attack if they click a link with this vulnerable code. Of course, many more vulnerable attacks can be executed – including malicious binaries being downloaded remotely and executed.</p>

<p>To solve this, the router must employ protections. One such protection is employing anti-forgery tokens. It seems that the router manufacturers try this by protecting most of the webpages with a token, but none of the cgi-bin endpoints are protected by this, rendering this defense useless.</p>

<p>For more information and vulnerability analysis, please see <a href="/assets/reports/report_wavlink.pdf">my report on the WAVLINK WN530H4</a>.</p>

        </div>

        <!-- Silly hack to add table class to table -->
        <!-- Will remove once adding bootstrap to npm -->
        <script>
        window.onload = function() {
            var tables = document.getElementsByTagName("table"),
                len = tables !== null ? tables.length : 0,
                i = 0;
            for (i; i < len; i++) {
                tables[i].className += " table"; 
            }
}
        </script>

        <footer class = "pt-md-5 border-top p-3 p-md-5 m-md-3">
    <div class = "row">
        <div class = "col-8 col-md">
        <ul class = "list-unstyled text-small">
            <li>
                Christopher Cerne © 2020
            </li>
        </ul>
        </div>
        <div class = "col-8 col-md">
            <h5>Contact</h5>
            <ul class = "list-unstyled text-small">
                <li>
                    <a class = "text-primary" href="#"><i class = "fas fa-paper-plane"></i> <span id = "econtact">chris (AT) cerne (DOT) xyz</span></a>
                </li>
            </ul>
        </div>
        <div class = "col-8 col-md">
            <h5>Social</h5>
            <ul class = "list-unstyled text-small">
                <li><a class = "text-primary" href = "https://github.com/cernec1999"  target = "_blank"><i class = "fab fa-github"></i> cernec1999</a></li>
                <li><a class = "text-primary" href = "https://linkedin.com/in/cernec1999"  target = "_blank"><i  class = "fab fa-linkedin"  target = "_blank"></i> cernec1999</a></li>
            </ul>
        </div>

        <div class = "col-8 col-md">
            <h5>Business</h5>
            <ul class = "list-unstyled text-small">
                <li><a class = "text-primary" href = "/res/resume-rev-2.pdf" target = "_blank"><i class = "fas fa-file"></i> Resume</a></li>
            </ul>
        </div>
    </div>
</footer>

<!-- More Bootstrap content -->
<script src = "https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity = "sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin = "anonymous"></script>
<script src = "https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity = "sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin = "anonymous"></script>
<script src = "https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity = "sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin = "anonymous"></script>

<!-- Prevent crawlers from spamming by obfuscating email -->
<script type = "text/javascript">
    var name = "chris";
    var domain = "cerne";
    var tld = "xyz";

    var mail = name + String.fromCharCode(64) + domain + String.fromCharCode(46) + tld;

    var link = "mail" + "to" + ":" + mail;
    var alink = "<a href = \"" + link  + "\">" + mail + "</a>";
    document.getElementById("econtact").innerHTML = alink;
</script>

    </body>
</html>
