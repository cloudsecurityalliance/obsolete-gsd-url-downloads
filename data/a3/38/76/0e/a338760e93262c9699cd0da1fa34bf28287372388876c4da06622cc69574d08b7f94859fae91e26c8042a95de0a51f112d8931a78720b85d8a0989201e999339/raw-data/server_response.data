<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="UTF-8">
<meta property="og:type" content="website">
<meta property="og:title" content="1342742 - (CVE-2017-7766) Arbitrary code execution as SYSTEM using Updater to overwrite updater.ini">
<meta property="og:url" content="https://bugzilla.mozilla.org/show_bug.cgi?id=1342742">
<meta property="og:description"
      content="RESOLVED (robert.strong.bugs) in Toolkit - Application Update. Last updated 2020-04-20.">
<meta name="twitter:label1" value="Type">
<meta name="twitter:data1" value="defect">
<meta name="twitter:label2" value="Priority">
<meta name="twitter:data2" value="--">

    <meta name="viewport" content="width=1024">
    <meta name="color-scheme" content="dark light">
    <meta name="generator" content="Bugzilla 20211025.1">
    <meta name="bugzilla-global" content="dummy"
        id="bugzilla-global" data-bugzilla="{&quot;api_token&quot;:&quot;&quot;,&quot;config&quot;:{&quot;basepath&quot;:&quot;\/&quot;},&quot;constant&quot;:{&quot;COMMENT_COLS&quot;:80},&quot;param&quot;:{&quot;maxattachmentsize&quot;:&quot;10240&quot;,&quot;maxusermatches&quot;:&quot;50&quot;,&quot;splinter_base&quot;:&quot;\/page.cgi?id=splinter.html&amp;ignore=\/&quot;},&quot;string&quot;:{&quot;bug_type_required&quot;:&quot;You must select a Type for this bug&quot;,&quot;component_required&quot;:&quot;You must select a Component for this bug&quot;,&quot;description_required&quot;:&quot;You must enter a Description for this bug&quot;,&quot;short_desc_required&quot;:&quot;You must enter a Summary for this bug&quot;,&quot;version_required&quot;:&quot;You must select a Version for this bug&quot;},&quot;user&quot;:{&quot;is_new&quot;:1,&quot;login&quot;:&quot;&quot;}}">
    <title>1342742 - (CVE-2017-7766) Arbitrary code execution as SYSTEM using Updater to overwrite updater.ini</title>

<link rel="Top" href="/">

  


  
    <link rel="Show" title="Dependency Tree"
          href="/showdependencytree.cgi?id=1342742&amp;hide_resolved=1">
      <link rel="Show" title="Dependency Graph"
            href="/showdependencygraph.cgi?id=1342742">

      <link rel="Show" title="Bug Activity"
            href="/show_activity.cgi?id=1342742">

<link href="/static/v20211025.1/skins/yui.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/standard/global.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BugModal/web/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BMO/web/styles/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/EditComments/web/styles/inline-editor.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-structure-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-theme-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/lib/prism.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Needinfo/web/styles/needinfo.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Review/web/styles/badge.css" rel="stylesheet" type="text/css">



    
<script nonce="wpAA6NqONZHJVqWCBz4L1LislFG1eHnEj7OBfSTGgXzpq4GO" src="/static/v20211025.1/js/jquery/jquery-min.js"></script><script nonce="wpAA6NqONZHJVqWCBz4L1LislFG1eHnEj7OBfSTGgXzpq4GO" src="/static/v20211025.1/js/jquery/ui/jquery-ui-min.js"></script><script nonce="wpAA6NqONZHJVqWCBz4L1LislFG1eHnEj7OBfSTGgXzpq4GO" src="/static/v20211025.1/js/yui.js"></script><script nonce="wpAA6NqONZHJVqWCBz4L1LislFG1eHnEj7OBfSTGgXzpq4GO" src="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu-min.js"></script><script nonce="wpAA6NqONZHJVqWCBz4L1LislFG1eHnEj7OBfSTGgXzpq4GO" src="/static/v20211025.1/js/jquery/plugins/devbridgeAutocomplete/devbridgeAutocomplete-min.js"></script><script nonce="wpAA6NqONZHJVqWCBz4L1LislFG1eHnEj7OBfSTGgXzpq4GO" src="/static/v20211025.1/js/global.js"></script><script nonce="wpAA6NqONZHJVqWCBz4L1LislFG1eHnEj7OBfSTGgXzpq4GO" src="/static/v20211025.1/js/util.js"></script><script nonce="wpAA6NqONZHJVqWCBz4L1LislFG1eHnEj7OBfSTGgXzpq4GO" src="/static/v20211025.1/js/dropdown.js"></script>

      <script nonce="wpAA6NqONZHJVqWCBz4L1LislFG1eHnEj7OBfSTGgXzpq4GO">
          YAHOO.namespace('bugzilla');
          if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
              YAHOO.util.Event._simpleRemove(window, "unload",
                                             YAHOO.util.Event._unload);
          }BUGZILLA.value_descs = JSON.parse('{\"bug_status\":{},\"resolution\":{\"\":\"---\"}}');

  
    var tracking_flags_str = "{\"flags\":{\"project\":{\"cf_a11y_review_project_flag\":\"---\",\"cf_fission_milestone\":\"---\",\"cf_tracking_firefox_sumo\":\"---\",\"cf_webcompat_priority\":\"---\",\"cf_root_cause\":\"---\",\"cf_install_update_workflow\":\"---\"},\"tracking\":{\"cf_tracking_firefox_esr52\":\"54+\",\"cf_status_firefox52\":\"wontfix\",\"cf_status_firefox95\":\"---\",\"cf_status_firefox93\":\"---\",\"cf_tracking_firefox_esr78\":\"---\",\"cf_status_thunderbird_esr91\":\"---\",\"cf_tracking_firefox_esr91\":\"---\",\"cf_tracking_firefox94\":\"---\",\"cf_status_firefox55\":\"fixed\",\"cf_tracking_firefox95\":\"---\",\"cf_status_firefox53\":\"wontfix\",\"cf_tracking_firefox54\":\"+\",\"cf_tracking_firefox_relnote\":\"---\",\"cf_tracking_thunderbird_esr91\":\"---\",\"cf_status_firefox94\":\"---\",\"cf_status_firefox_esr52\":\"fixed\",\"cf_status_firefox_esr91\":\"---\",\"cf_status_thunderbird_esr78\":\"---\",\"cf_status_firefox54\":\"fixed\",\"cf_tracking_thunderbird_esr78\":\"---\",\"cf_status_firefox_esr45\":\"wontfix\",\"cf_status_firefox_esr78\":\"---\",\"cf_tracking_firefox93\":\"---\"}},\"types\":[\"tracking\"],\"comments\":{\"cf_tracking_firefox_esr91\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_sumo\":{\"none-needed\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_a11y_review_project_flag\":{\"requested\":\"Description:\\nPlease provide an explanation of the feature or change. Include a description of the user scenario in which it would be used and how the user would complete the task(s).\\nScreenshots and visual UI specs are welcome, but please include sufficient accompanying explanation so that blind members of the accessibility team are able to understand the feature\/change.\\n\\nHow do we test this?\\nIf there is an implementation to test, please provide instructions for testing it; e.g. setting preferences, other preparation, how to trigger the UI, etc.\\n\\nWhen will this ship?\\nTracking bug\/issue:\\nDesign documents (e.g. Product Requirements Document, UI spec):\\nEngineering lead:\\nProduct manager:\\n\\nThe accessibility team has developed the Mozilla Accessibility Release Guidelines which outline what is needed to make user interfaces accessible:\\nhttps:\/\/wiki.mozilla.org\/Accessibility\/Guidelines\\nPlease describe the accessibility guidelines you considered and what steps you\'ve taken to address them:\\n\\nDescribe any areas of concern to which you want the accessibility team to give special attention:\"},\"cf_tracking_firefox94\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox95\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox93\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr78\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_relnote\":{\"?\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox54\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr52\":{\"?\":\"[Tracking Requested - why for this release]:\"}}}";
    var TrackingFlags = $.parseJSON(tracking_flags_str);

  

  
  BUGZILLA.bug_id = 1342742;
  BUGZILLA.bug_title = '1342742 - (CVE-2017-7766) Arbitrary code execution as SYSTEM using Updater to overwrite updater.ini';
  BUGZILLA.bug_summary = 'Arbitrary code execution as SYSTEM using Updater to overwrite updater.ini';
  BUGZILLA.bug_url = 'https:\/\/bugzilla.mozilla.org\/show_bug.cgi?id=1342742';
  BUGZILLA.bug_keywords = 'csectype-priv-escalation, sec-high',
  BUGZILLA.user = {
    id: 0,
    login: '',
    is_insider: false,
    is_timetracker: false,
    can_tag: false,
    timezone: 'America\/Los_Angeles',
    settings: {
      quote_replies: 'quoted_reply',
      zoom_textareas: true,
      remember_collapsed: true,
      inline_attachments: true,
      autosize_comments: false
    }
  };

  BUGZILLA.bug_secure = false;
      </script>
<script nonce="wpAA6NqONZHJVqWCBz4L1LislFG1eHnEj7OBfSTGgXzpq4GO" src="/static/v20211025.1/extensions/BugModal/web/autosize.min.js"></script><script nonce="wpAA6NqONZHJVqWCBz4L1LislFG1eHnEj7OBfSTGgXzpq4GO" src="/static/v20211025.1/extensions/ProdCompSearch/web/js/prod_comp_search.js"></script><script nonce="wpAA6NqONZHJVqWCBz4L1LislFG1eHnEj7OBfSTGgXzpq4GO" src="/static/v20211025.1/extensions/BugModal/web/bug_modal.js"></script><script nonce="wpAA6NqONZHJVqWCBz4L1LislFG1eHnEj7OBfSTGgXzpq4GO" src="/static/v20211025.1/extensions/BugModal/web/comments.js"></script><script nonce="wpAA6NqONZHJVqWCBz4L1LislFG1eHnEj7OBfSTGgXzpq4GO" src="/static/v20211025.1/extensions/ComponentWatching/web/js/overlay.js"></script><script nonce="wpAA6NqONZHJVqWCBz4L1LislFG1eHnEj7OBfSTGgXzpq4GO" src="/static/v20211025.1/js/bugzilla-readable-status-min.js"></script><script nonce="wpAA6NqONZHJVqWCBz4L1LislFG1eHnEj7OBfSTGgXzpq4GO" src="/static/v20211025.1/js/field.js"></script><script nonce="wpAA6NqONZHJVqWCBz4L1LislFG1eHnEj7OBfSTGgXzpq4GO" src="/static/v20211025.1/js/comments.js"></script><script nonce="wpAA6NqONZHJVqWCBz4L1LislFG1eHnEj7OBfSTGgXzpq4GO" src="/static/v20211025.1/extensions/TrackingFlags/web/js/flags.js"></script><script nonce="wpAA6NqONZHJVqWCBz4L1LislFG1eHnEj7OBfSTGgXzpq4GO" src="/static/v20211025.1/extensions/BMO/web/js/firefox-crash-table.js"></script><script nonce="wpAA6NqONZHJVqWCBz4L1LislFG1eHnEj7OBfSTGgXzpq4GO" src="/static/v20211025.1/extensions/MozChangeField/web/js/severity-s1-priority-p1.js"></script><script nonce="wpAA6NqONZHJVqWCBz4L1LislFG1eHnEj7OBfSTGgXzpq4GO" src="/static/v20211025.1/extensions/MozChangeField/web/js/clear-tracking-priority-s1.js"></script><script nonce="wpAA6NqONZHJVqWCBz4L1LislFG1eHnEj7OBfSTGgXzpq4GO" src="/static/v20211025.1/extensions/MozChangeField/web/js/set-tracking-severity-s1.js"></script><script nonce="wpAA6NqONZHJVqWCBz4L1LislFG1eHnEj7OBfSTGgXzpq4GO" src="/static/v20211025.1/js/lib/prism.js"></script><script nonce="wpAA6NqONZHJVqWCBz4L1LislFG1eHnEj7OBfSTGgXzpq4GO" src="/static/v20211025.1/extensions/GoogleAnalytics/web/js/analytics.js"></script><script nonce="wpAA6NqONZHJVqWCBz4L1LislFG1eHnEj7OBfSTGgXzpq4GO" src="/static/v20211025.1/js/lib/md5.min.js"></script><script nonce="wpAA6NqONZHJVqWCBz4L1LislFG1eHnEj7OBfSTGgXzpq4GO" src="/static/v20211025.1/extensions/Review/web/js/badge.js"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla@Mozilla" href="/search_plugin.cgi"><link rel="shortcut icon" href="/extensions/BMO/web/images/favicon.ico">
<link rel="canonical" href="https://bugzilla.mozilla.org/show_bug.cgi?id=1342742">
<link rel="shorturl" href="https://bugzilla.mozilla.org/1342742"><meta name="google-analytics" content="UA-36116321-3" data-location="https://bugzilla.mozilla.org/bug/show-modal" data-title="1342742 - (CVE-2017-7766) Arbitrary code execution as SYSTEM using Updater to overwrite updater.ini">
<script async src="https://www.google-analytics.com/analytics.js"></script><meta name="robots" content="noarchive">
  </head>



  <body
        class="bugzilla-mozilla-org
               skin-standard bug_modal yui-skin-sam">



<div id="wrapper">

<header id="header" role="banner">
  <div class="inner">
    <h1 id="header-title" class="title"><a href="https://bugzilla.mozilla.org/home" title="Go to home page">Bugzilla</a></h1>
    <form role="search" id="header-search" class="quicksearch" action="/buglist.cgi" data-no-csrf>
      <section class="searchbox-outer dropdown" role="combobox" aria-expanded="false" aria-haspopup="listbox"
               aria-labelledby="header-search-label" aria-owns="header-search-dropdown">
        <h2 id="header-search-label">Quick Search</h2>
        <span class="icon" aria-hidden="true"></span>
        <input role="searchbox" id="quicksearch_top" class="dropdown-button" name="quicksearch" autocomplete="off"
               value="" placeholder="Search Bugs"
               title="Enter a bug number or some search terms" aria-controls="header-search-dropdown"
               aria-label="Quick Search"><div id="header-search-dropdown" class="dropdown-content right" role="listbox" style="display: none;">
  <div id="header-search-dropdown-wrapper">
  </div>
</div>
      </section>
    </form>
    <nav id="header-nav">
      <ul class="links">
        <li class="link-browse">
          <a href="/describecomponents.cgi" title="Browse bugs by component">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Browse</span>
          </a>
        </li>
        <li class="link-search">
          <a href="/query.cgi?format=advanced" title="Search bugs using various criteria">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Advanced Search</span>
          </a>
        </li>
      </ul>
      <div class="dropdown">
        <button type="button" id="header-tools-menu-button" class="dropdown-button minor" title="More tools…"
                aria-label="More tools…" aria-expanded="false" aria-haspopup="true" aria-controls="header-tools-menu">
          <span class="icon" aria-hidden="true"></span>
        </button>
        <ul class="dropdown-content left" id="header-tools-menu" role="menu" style="display:none;">
          <li role="presentation">
            <a href="/report.cgi" role="menuitem" tabindex="-1">Reports</a>
          </li>
            <li role="separator"></li>
            <li role="presentation">
              <a href="https://bmo.readthedocs.io/en/latest/" role="menuitem" tabindex="-1">Documentation</a>
            </li>
        </ul>
      </div>
    </nav>
      <ul id="header-login" class="links">
          <li id="moz_new_account_container_top"><a href="/createaccount.cgi">New Account</a></li><li id="mini_login_container_top">
  <a id="login_link_top" href="/index.cgi?GoAheadAndLogIn=1"
     class='show_mini_login_form' data-qs-suffix="_top">Log In</a>

  <div id="mini_login_top" class="mini-popup mini_login bz_default_hidden"><span id="github_mini_login_top" class="mini_login_top">
    <form method="post" action="/github.cgi">
      <input type="hidden" name="github_secret" value="7GUfJC2KMBS1q8kdSGsmGTCbzoZdmVs2ynkHusBPHcn8uvlaa3QLKxc64luznzn39iHa5JB3zIK5VZSQIzn4xWmRqZUiLtBcFQ6PqjEp9uiASg9azSNEvPMW71fhNuZS0vewLnxOS6olYkDlmM4yuVky9nrnJwYHFeyrNFRdZXrzZrd75T4vOTixNBnNHVzheFHGXuCZ8SG1Z2usaYCz7IubQSzrWg2Tu0wkWMtyJl2STQ66OixKyKc9dQk1kWt4">
      <input type="hidden" name="target_uri" value="https://bugzilla.mozilla.org/show_bug.cgi">
      <input type="image" src="/extensions/GitHubAuth/web/images/sign_in.png" height="22" width="75" align="absmiddle"
             alt="Sign in with GitHub"
             title="Sign in with GitHub"> or
    </form>
  </span>

  <form action="/show_bug.cgi?id=1342742" method="POST"
        data-qs-suffix="_top">

    <input id="Bugzilla_login_top"
           class="bz_login"
           name="Bugzilla_login"
           title="Login"
           placeholder="Email"
           aria-label="Email"
           type="email"
           required
    >
    <input class="bz_password"
           id="Bugzilla_password_top"
           name="Bugzilla_password"
           type="password"
           title="Password"
           placeholder="Password"
           aria-label="Password"
           required
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text"
           id="Bugzilla_password_dummy_top" value="password"
           title="Password"
    >
      <input type="checkbox" id="Bugzilla_remember_top"
             name="Bugzilla_remember" value="on" class="bz_remember"
                 checked>
      <label for="Bugzilla_remember_top">Remember</label>
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
           class="check_mini_login_fields"
            id="log_in_top">
    <a href="#" id="hide_mini_login_top" aria-label="Close"
       class="close-button hide_mini_login_form" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
<li id="forgot_container_top">
  <a id="forgot_link_top" href="/index.cgi?GoAheadAndLogIn=1#forgot"
     class='show_forgot_form'
     data-qs-suffix="_top">Forgot Password</a>
  <div id="forgot_form_top" class="mini-popup mini_forgot bz_default_hidden">
  <form action="/token.cgi" method="post">
    <input type="email" name="loginname" size="20" placeholder="Email" aria-label="Email" required>
    <input id="forgot_button_top" value="Reset Password"
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <input type="hidden" id="token_top" name="token" value="1635623132-mo1PgHWv-GTeWBAuRZySoD7AprBORSuKIzls1PbWMws">
    <a href="#" class="close-button hide_forgot_form" aria-label="Close" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
      </ul><div id="header-external-links" class="dropdown first">
  <button type="button" id="header-external-menu-button" class="dropdown-button minor" title="Mozilla"
          aria-label="Mozilla" aria-expanded="false" aria-haspopup="true" aria-controls="header-external-menu">
    <img src="/static/v20211025.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg" width="32" height="32" alt="">
  </button>
  <ul class="dropdown-content right" id="header-external-menu" role="menu" style="display:none;">
    <li role="presentation">
      <a href="https://www.mozilla.org/" role="menuitem" tabindex="-1">Mozilla Home</a>
    </li>
    <li role="separator"></li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/" role="menuitem" tabindex="-1">Privacy</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/#cookies" role="menuitem" tabindex="-1">Cookies</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/about/legal/" role="menuitem" tabindex="-1">Legal</a>
    </li>
  </ul>
</div>
  </div>
</header> 


<main id="bugzilla-body" tabindex="-1">

<aside id="message-container" role="complementary">
  <noscript>
    <div class="noscript">
      <div class="inner">
        <p>Please enable JavaScript in your browser to use all the features on this site.</p>
      </div>
    </div>
  </noscript>
</aside>

<div id="main-inner">




<div role="toolbar" id="page-toolbar">
  <div role="group" class="buttons">
    <button type="button" id="copy-summary" class="secondary"
      title="Copy bug number and summary to your clipboard">Copy Summary</button>
    <div id="clip-container" style="display:none"><input type="text" id="clip"></div>
    <div class="dropdown">
      <button type="button" id="action-menu-btn" aria-haspopup="true" aria-label="View"
        aria-expanded="false" aria-controls="action-menu" class="dropdown-button secondary">View &#9662;</button>
      <ul class="dropdown-content left" id="action-menu" role="menu" style="display:none;">
        <li role="presentation">
          <a id="action-reset" role="menuitem" tabindex="-1">Reset Sections</a>
        </li>
        <li role="presentation">
          <a id="action-expand-all" role="menuitem" tabindex="-1">Expand All Sections</a>
        </li>
        <li role="presentation">
          <a id="action-collapse-all" role="menuitem" tabindex="-1">Collapse All Sections</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a id="action-history" role="menuitem" tabindex="-1">History</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a href="/rest/bug/1342742" role="menuitem" tabindex="-1">JSON</a>
        </li>
        <li role="presentation">
          <a href="/show_bug.cgi?ctype=xml&amp;id=1342742" role="menuitem" tabindex="-1">XML</a>
        </li>
      </ul>
    </div>
  </div>
</div>



<div role="status" id="io-error" style="display:none"></div>
<div role="status" id="floating-message" style="display:none">
  <div id="floating-message-text"></div>
</div>
<section class="module"
>
  <div class="module-content"
  >
  <div id="summary-container">
    <div class="field indent" id="field-status_summary"
>


  
    <div class=" container">
        <span id="field-value-status_summary">
      <span class="bug-status-label text" data-status="closed">Closed</span>
      <span id="field-value-bug_id">
        <a href="/show_bug.cgi?id=1342742">Bug 1342742</a>
          <span class="edit-hide">(CVE-2017-7766)</span>
      </span>
      <span>
        <span class="bug-time-label">Opened <span class="rel-time" title="2017-02-26 00:19 PST" data-time="1488097144">5 years ago</span></span>
          <span class="bug-time-label">Closed <span class="rel-time" title="2017-04-29 14:18 PDT" data-time="1493500712">5 years ago</span></span>
      </span>
        </span>
    </div>

  
</div>
<div class="field indent edit-hide"
>


  
    <div class=" container">
      

      <h1 id="field-value-short_desc">Arbitrary code execution as SYSTEM using Updater to overwrite updater<wbr>.ini</h1>
    </div>

  
</div>

    <div class="field edit-show" id="field-short_desc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc" id="short_desc-help-link" class="help">Summary:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-short_desc">
            Arbitrary code execution as SYSTEM using Updater to overwrite updater.ini

        </span>
    </div>

  
</div>
  </div>
  </div>
</section>


<section class="module" id="module-categories"
>
    <header id="module-categories-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Categories section"
           data-label-collapsed="Expand Categories section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-categories-content"
             aria-expanded="true"
             aria-labeledby="module-categories-title"
             aria-describedby="module-categories-subtitle"></div>
        <h2 class="module-title" id="module-categories-title">Categories</h2>
          <h3 class="module-subtitle" id="module-categories-subtitle">
            (Toolkit :: Application Update, defect)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-categories-content"
  ><div class="fields-lhs">

    <div class="field" id="field-product"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=Toolkit" id="product-help-link" class="help">Product:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-product">
      <div class="name-info-outer dropdown">
        <span id="product-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="product-info">Toolkit
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="product-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Product description and actions">
          <header>
            <div class="title">Toolkit</div>
            <div class="description">The Mozilla Toolkit is a set of APIs, built on top of Gecko, which provide advanced services to XUL applications. These services include Profile Management, Chrome Registration, Browsing History, Extension and Theme Management, Application Update Service, and Safe Mode. (<a href="https://wiki.mozilla.org/Modules/Toolkit">More info</a>)</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=Toolkit&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Product</a></div>
            <div><a href="/enter_bug.cgi?product=Toolkit"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Product</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="Toolkit"
                         data-label-watch="Watch This Product" data-label-unwatch="Unwatch This Product"
                         data-source="BugModal">Watch This Product</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-component"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=Toolkit&component=Application%20Update#Application%20Update" id="component-help-link" class="help">Component:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-component">
      <div class="name-info-outer dropdown">
        <span id="component-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="component-info">Application Update
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="component-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Component description and actions">
          <header>
            <div class="title">Toolkit :: Application Update</div>
            <div class="description">Application update for Firefox and Thunderbird.</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=Toolkit&amp;component=Application%20Update&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Component</a></div>
            <div><a href="/buglist.cgi?product=Toolkit&amp;component=Application%20Update&amp;chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__"
                    target="_blank" role="menuitem" tabindex="-1">Recently Fixed Bugs in This Component</a></div>
            <div><a href="/enter_bug.cgi?product=Toolkit&amp;component=Application%20Update"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Component</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="Toolkit" data-component="Application Update"
                         data-label-watch="Watch This Component" data-label-unwatch="Unwatch This Component"
                         data-source="BugModal">Watch This Component</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-version"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#version" id="version-help-link" class="help">Version:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-version">
            51 Branch

        </span>
    </div>

  
</div>

    <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform" id="-help-link" class="help">Platform:
        </a>
    </div>


  
    <div class=" container"><div class="field inline" id="field-rep_platform"
>


  
    <div class="value">
        <span id="field-value-rep_platform">
            Unspecified

        </span>
    </div>

  
</div><div class="field indent inline" id="field-op_sys"
>


  
    <div class="value">
        <span id="field-value-op_sys">
            Windows

        </span>
    </div>

  
</div><div class="field indent inline"
>


  
    <div class=" container">
    </div>

  
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field contains-buttons" id="field-bug_type"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type" id="bug_type-help-link" class="help">Type:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_type">
      <span class="bug-type-label iconic-text" data-type="defect">
        <span class="icon" aria-hidden="true"></span>defect</span>
        </span>
    </div>

  
</div>

    <div class="field" id="field-importance"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority" id="importance-help-link" class="help">Priority:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-importance"><div class="field inline" id="field-priority"
>


  
    <div class="value">
        <span id="field-value-priority">
          <em>Not set</em>
        </span>
    </div>

  
</div><div class="field inline" id="field-bug_severity"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity" id="bug_severity-help-link" class="help">Severity:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_severity">
            normal

        </span>
    </div>

  
</div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-cf_fx_points" style="display:none"
>
    <div class="name">Points:
    </div>


  
    <div class="value">
        <span id="field-value-cf_fx_points">
            ---

        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-tracking"
>
    <header id="module-tracking-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Tracking section"
           data-label-collapsed="Expand Tracking section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-tracking-content"
             aria-expanded="true"
             aria-labeledby="module-tracking-title"
             aria-describedby="module-tracking-subtitle"></div>
        <h2 class="module-title" id="module-tracking-title">Tracking</h2>
          <h3 class="module-subtitle" id="module-tracking-subtitle">
            (<span id="readable-bug-status" data-readable-bug-status="{&quot;keywords&quot;:[&quot;csectype-priv-escalation&quot;,&quot;sec-high&quot;],&quot;cf_status_thunderbird_esr78&quot;:&quot;---&quot;,&quot;status&quot;:&quot;RESOLVED&quot;,&quot;cf_status_firefox_esr91&quot;:&quot;---&quot;,&quot;flags&quot;:[{&quot;status&quot;:&quot;+&quot;,&quot;name&quot;:&quot;sec-bounty&quot;},{&quot;status&quot;:&quot;+&quot;,&quot;name&quot;:&quot;in-testsuite&quot;},{&quot;status&quot;:&quot;-&quot;,&quot;name&quot;:&quot;qe-verify&quot;}],&quot;cf_webcompat_priority&quot;:&quot;---&quot;,&quot;cf_status_firefox_esr52&quot;:&quot;fixed&quot;,&quot;cf_status_firefox94&quot;:&quot;---&quot;,&quot;cf_tracking_thunderbird_esr91&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_relnote&quot;:&quot;---&quot;,&quot;cf_tracking_firefox54&quot;:&quot;+&quot;,&quot;cf_tracking_firefox93&quot;:&quot;---&quot;,&quot;target_milestone&quot;:&quot;mozilla55&quot;,&quot;cf_a11y_review_project_flag&quot;:&quot;---&quot;,&quot;cf_status_firefox_esr78&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_sumo&quot;:&quot;---&quot;,&quot;cf_status_firefox_esr45&quot;:&quot;wontfix&quot;,&quot;cf_status_firefox54&quot;:&quot;fixed&quot;,&quot;cf_tracking_thunderbird_esr78&quot;:&quot;---&quot;,&quot;cf_status_firefox95&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_esr78&quot;:&quot;---&quot;,&quot;cf_status_firefox93&quot;:&quot;---&quot;,&quot;cf_status_firefox52&quot;:&quot;wontfix&quot;,&quot;cf_tracking_firefox_esr52&quot;:&quot;54+&quot;,&quot;cf_root_cause&quot;:&quot;---&quot;,&quot;cf_install_update_workflow&quot;:&quot;---&quot;,&quot;resolution&quot;:&quot;FIXED&quot;,&quot;cf_tracking_firefox95&quot;:&quot;---&quot;,&quot;cf_status_firefox55&quot;:&quot;fixed&quot;,&quot;cf_status_firefox53&quot;:&quot;wontfix&quot;,&quot;priority&quot;:&quot;--&quot;,&quot;cf_tracking_firefox94&quot;:&quot;---&quot;,&quot;cf_fission_milestone&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_esr91&quot;:&quot;---&quot;,&quot;dupe_of&quot;:null,&quot;cf_status_thunderbird_esr91&quot;:&quot;---&quot;,&quot;id&quot;:1342742}"></span>)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-tracking-content"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-status-view"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-view-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-view">RESOLVED
        FIXED
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-status-edit" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-edit-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-edit"><div class="field inline" id="field-bug_status"
>


  
    <div class="value">
        <span id="field-value-bug_status">
            RESOLVED

        </span>
    </div>

  
</div><div class="field indent inline" id="field-resolution"
>


  
    <div class="value">
        <span id="field-value-resolution">
            FIXED

        </span>
    </div>

  
</div>
  <div id="status-action-buttons">
      <div id="assigned-container" style="display:none">
        <button type="button" class="secondary" id="mark-as-assigned-btn">
          Mark as Assigned
        </button>
      </div>
  </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-target_milestone"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone" id="target_milestone-help-link" class="help">Milestone:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-target_milestone">
            mozilla55

        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-cf_fx_iteration" style="display:none"
>
    <div class="name">Iteration:
    </div>


  
    <div class="value">
        <span id="field-value-cf_fx_iteration">
            ---

        </span>
    </div>

  
</div>


      <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Project Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <td class="tracking-flag-name">Root Cause</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_root_cause-dirty">
  <select id="cf_root_cause" name="cf_root_cause">
        <option value="---"
          id="v4701_cf_root_cause" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">a11y-review</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_a11y_review_project_flag-dirty">
  <select id="cf_a11y_review_project_flag" name="cf_a11y_review_project_flag">
        <option value="---"
          id="v4876_cf_a11y_review_project_flag" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Webcompat Priority</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_webcompat_priority-dirty">
  <select id="cf_webcompat_priority" name="cf_webcompat_priority">
        <option value="---"
          id="v4274_cf_webcompat_priority" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">user-doc-firefox</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_sumo-dirty">
  <select id="cf_tracking_firefox_sumo" name="cf_tracking_firefox_sumo">
        <option value="---"
          id="v4660_cf_tracking_firefox_sumo" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Fission Milestone</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_fission_milestone-dirty">
  <select id="cf_fission_milestone" name="cf_fission_milestone">
        <option value="---"
          id="v4222_cf_fission_milestone" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Install Update Workflow</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_install_update_workflow-dirty">
  <select id="cf_install_update_workflow" name="cf_install_update_workflow">
        <option value="---"
          id="v4664_cf_install_update_workflow" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

      <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Tracking Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-hide">
    <table class="layout-table tracking-flags">
        <tr>
          <th></th>
          <th>Tracking</th>
          <th>Status</th>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox-esr45</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox52</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox52&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox-esr52</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox_esr52&amp;o1=equals&amp;v1=54%2B">54+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox_esr52&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox53</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox53&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox54</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox54&amp;o1=equals&amp;v1=%2B">+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox54&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox55</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox55&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
    </table>
  </div>


<div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <th></th>
        <th>Tracking</th>
        <th>Status</th>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr45</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr45-dirty">
  <select id="cf_status_firefox_esr45" name="cf_status_firefox_esr45">
        <option value="wontfix"
          id="v2553_cf_status_firefox_esr45" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">relnote-firefox</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_relnote-dirty">
  <select id="cf_tracking_firefox_relnote" name="cf_tracking_firefox_relnote">
        <option value="---"
          id="v539_cf_tracking_firefox_relnote" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr78-dirty">
  <select id="cf_tracking_thunderbird_esr78" name="cf_tracking_thunderbird_esr78">
        <option value="---"
          id="v4823_cf_tracking_thunderbird_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr78-dirty">
  <select id="cf_status_thunderbird_esr78" name="cf_status_thunderbird_esr78">
        <option value="---"
          id="v4829_cf_status_thunderbird_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr91-dirty">
  <select id="cf_tracking_thunderbird_esr91" name="cf_tracking_thunderbird_esr91">
        <option value="---"
          id="v5236_cf_tracking_thunderbird_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr91-dirty">
  <select id="cf_status_thunderbird_esr91" name="cf_status_thunderbird_esr91">
        <option value="---"
          id="v5242_cf_status_thunderbird_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox52</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox52-dirty">
  <select id="cf_status_firefox52" name="cf_status_firefox52">
        <option value="wontfix"
          id="v2969_cf_status_firefox52" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr52</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr52-dirty">
  <select id="cf_tracking_firefox_esr52" name="cf_tracking_firefox_esr52">
        <option value="54+"
          id="v3129_cf_tracking_firefox_esr52" selected
        >54+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr52-dirty">
  <select id="cf_status_firefox_esr52" name="cf_status_firefox_esr52">
        <option value="fixed"
          id="v3137_cf_status_firefox_esr52" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr78-dirty">
  <select id="cf_tracking_firefox_esr78" name="cf_tracking_firefox_esr78">
        <option value="---"
          id="v4808_cf_tracking_firefox_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr78-dirty">
  <select id="cf_status_firefox_esr78" name="cf_status_firefox_esr78">
        <option value="---"
          id="v4813_cf_status_firefox_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr91-dirty">
  <select id="cf_tracking_firefox_esr91" name="cf_tracking_firefox_esr91">
        <option value="---"
          id="v5194_cf_tracking_firefox_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr91-dirty">
  <select id="cf_status_firefox_esr91" name="cf_status_firefox_esr91">
        <option value="---"
          id="v5199_cf_status_firefox_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox53</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox53-dirty">
  <select id="cf_status_firefox53" name="cf_status_firefox53">
        <option value="wontfix"
          id="v3007_cf_status_firefox53" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox54</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox54-dirty">
  <select id="cf_tracking_firefox54" name="cf_tracking_firefox54">
        <option value="+"
          id="v3038_cf_tracking_firefox54" selected
        >+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox54-dirty">
  <select id="cf_status_firefox54" name="cf_status_firefox54">
        <option value="fixed"
          id="v3046_cf_status_firefox54" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox55</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox55-dirty">
  <select id="cf_status_firefox55" name="cf_status_firefox55">
        <option value="fixed"
          id="v3183_cf_status_firefox55" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox93</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox93-dirty">
  <select id="cf_tracking_firefox93" name="cf_tracking_firefox93">
        <option value="---"
          id="v5266_cf_tracking_firefox93" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox93-dirty">
  <select id="cf_status_firefox93" name="cf_status_firefox93">
        <option value="---"
          id="v5271_cf_status_firefox93" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox94</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox94-dirty">
  <select id="cf_tracking_firefox94" name="cf_tracking_firefox94">
        <option value="---"
          id="v5284_cf_tracking_firefox94" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox94-dirty">
  <select id="cf_status_firefox94" name="cf_status_firefox94">
        <option value="---"
          id="v5289_cf_status_firefox94" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox95</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox95-dirty">
  <select id="cf_tracking_firefox95" name="cf_tracking_firefox95">
        <option value="---"
          id="v5311_cf_tracking_firefox95" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox95-dirty">
  <select id="cf_status_firefox95" name="cf_status_firefox95">
        <option value="---"
          id="v5316_cf_status_firefox95" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>

</div>
  </div>
</section>



<section class="module" id="module-people"
>
    <header id="module-people-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse People section"
           data-label-collapsed="Expand People section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-people-content"
             aria-expanded="false"
             aria-labeledby="module-people-title"
             aria-describedby="module-people-subtitle"></div>
        <h2 class="module-title" id="module-people-title">People</h2>
          <h3 class="module-subtitle" id="module-people-subtitle">
            (Reporter: sebbity, Assigned: robert.strong.bugs)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-people-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-assigned_to"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to"><div class="vcard vcard_141755" ><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=141755" > <span class="fna">robert.strong.bugs</span></a>
</div>
        </span>
    </div>

  
</div><div class="field edit-show" id="field-assigned_to" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-assignee" name="set_default_assignee" class="set-default"
          value="1" data-for="assigned_to">
        <label for="set-default-assignee">Reset Assignee to default</label>
      </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-bug_mentors" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor" id="bug_mentors-help-link" class="help">Mentors:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_mentors">---
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-qa_contact" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact" id="qa_contact-help-link" class="help">QA Contact:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-qa_contact">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-qa-contact" name="set_default_qa_contact" class="set-default"
          value="1" data-for="qa_contact">
        <label for="set-default-qa-contact">Reset QA Contact to default</label>
      </div>
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-reporter"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter" id="reporter-help-link" class="help">Reporter:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-reporter">
            <div class="vcard vcard_465312" ><img src="https://secure.gravatar.com/avatar/d6607825cb6a68be435e0fde66f25db5?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=465312" > <span class="fna">sebbity</span></a>
</div>

        </span>
    </div>

  
</div>

    <div class="field" id="field-triage_owner"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner" id="triage_owner-help-link" class="help">Triage Owner:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-triage_owner">
            <div class="vcard vcard_692168" ><img src="https://secure.gravatar.com/avatar/d727fb8d9edb9b1a5b541d7621cb3124?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=692168" > <span class="fna">Amir</span></a>
</div>

        </span>
    </div>

  
</div>

    

    <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc" id="-help-link" class="help">CC:
        </a>
    </div>


  
    <div class=" container">


        <span aria-owns="cc-summary cc-latch">
          <span role="button" tabindex="0" id="cc-summary" data-count="13">13 people
          </span>
        </span>


        <div id="cc-list" style="display:none"></div>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-references"
>
    <header id="module-references-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse References section"
           data-label-collapsed="Expand References section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-references-content"
             aria-expanded="false"
             aria-labeledby="module-references-title"
             aria-describedby="module-references-subtitle"></div>
        <h2 class="module-title" id="module-references-title">References</h2>
      </div>
    </header>
  <div class="module-content" id="module-references-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field bug-list edit-show" id="field-dependson" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson" id="dependson-help-link" class="help">Depends on:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-dependson">
        ---
        </span>
    </div>

  
</div><div class="field bug-list" id="field-blocked"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks" id="blocked-help-link" class="help">Blocks:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-blocked">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Arbitrary file &quot;deletion&quot; as SYSTEM with maintenance service"
   href="/show_bug.cgi?id=1336964">CVE-2017-7767</a>
      </div>

        </span>
    </div>

  
</div><div class="field" id="field-dependencytree"
>
    <div class="name">
    </div>


  
    <div class=" container">
        <span id="field-value-dependencytree">
        Dependency <a href="/showdependencytree.cgi?id=1342742&amp;hide_resolved=1">tree</a>
        / <a href="/showdependencygraph.cgi?id=1342742">graph</a>
        </span>
    </div>

  
</div>

    <div class="field bug-list" id="field-regresses"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses" id="regresses-help-link" class="help">Regressions:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regresses">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox bounces in Dock once and won't open"
   href="/show_bug.cgi?id=1574139">1574139</a>
      </div>

        </span>
    </div>

  
</div><div class="field bug-list edit-show" id="field-regressed_by" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by" id="regressed_by-help-link" class="help">Regressed by:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regressed_by">
        ---
        </span>
    </div>

  
</div>

    
</div><div class="fields-rhs">

    <div class="field edit-show" id="field-bug_file_loc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc" id="bug_file_loc-help-link" class="help">URL:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_file_loc"><div class="link">
    <a href="" target="_blank"
      rel="noreferrer" title=""
      class="bug-url" data-safe="0"></a>
  </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-see_also" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also" id="see_also-help-link" class="help">See Also:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-see_also">
        ---
        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-details"
>
    <header id="module-details-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Details section"
           data-label-collapsed="Expand Details section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-details-content"
             aria-expanded="false"
             aria-labeledby="module-details-title"
             aria-describedby="module-details-subtitle"></div>
        <h2 class="module-title" id="module-details-title">Details</h2>
          <h3 class="module-subtitle" id="module-details-subtitle">
            (Keywords: csectype-priv-escalation, sec-high, Whiteboard: [adv-main54+][adv-esr52.2+])
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-details-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-show" id="field-alias" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias" id="alias-help-link" class="help">Alias:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-alias">
            CVE-2017-7766

        </span>
    </div>

  
</div>

    <div class="field" id="field-keywords"
>
    <div class="name">
        <a href="/describekeywords.cgi" id="keywords-help-link" class="help">Keywords:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-keywords">
          <a href="/buglist.cgi?keywords=csectype-priv-escalation&amp;resolution=---">csectype-priv-escalation</a>, 
          <a href="/buglist.cgi?keywords=sec-high&amp;resolution=---">sec-high</a>
        </span>
    </div>

  
</div>

    <div class="field" id="field-status_whiteboard"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/Whiteboard" id="status_whiteboard-help-link" class="help">Whiteboard:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-status_whiteboard">[adv-main54+][adv-esr52.2+]
        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_qa_whiteboard" style="display:none"
>
    <div class="name">QA Whiteboard:
    </div>


  
    <div class="value">
        <span id="field-value-cf_qa_whiteboard">
        ---
        </span>
    </div>

  
</div>

    

    <div class="field edit-show" id="field-cf_has_regression_range" style="display:none"
>
    <div class="name">Has Regression Range:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_regression_range">
            ---

        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_has_str" style="display:none"
>
    <div class="name">Has STR:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_str">
            ---

        </span>
    </div>

  
</div>

    <div class="field" id="field-votes"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes" id="votes-help-link" class="help">Votes:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-votes">0
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-bug_flags"
>
    <div class="name">Bug Flags:
    </div>


  
    <div class=" container">
        <span id="field-value-bug_flags"><div id="bug-flags" class="flags">
  <table class="layout-table">
          <tbody class="edit-hide"><tr>
    <td class="flag-setter"><div class="vcard vcard_1689" ><a class="email " href="/user_profile?user_id=1689" > <span class="fna">dveditz</span></a>
</div>
    </td>

    <td class="flag-name">
        <a href="#a5563396_1689"
            class="rel-time-title activity-ref"
            title="5 years ago"
        data-time="1489624229"
      >sec-bounty</a>
    </td>

    <td class="flag-value">+
    </td>

  </tr>
          </tbody>
          <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter"><div class="vcard vcard_1689" ><a class="email " href="/user_profile?user_id=1689" > <span class="fna">dveditz</span></a>
</div>
    </td>

    <td class="flag-name">
      <label title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug." for="flag-1546615">sec-bounty</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag-1546615-dirty">
      <select id="flag-1546615" name="flag-1546615"
        title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug."
        class="bug-flag">
            <option value="+" selected>+</option>
      </select>
    </td>


  </tr>
          </tbody>
          <tbody class="edit-hide"><tr>
    <td class="flag-setter"><div class="vcard vcard_141755" ><a class="email " href="/user_profile?user_id=141755" > <span class="fna">robert.strong.bugs</span></a>
</div>
    </td>

    <td class="flag-name">
        <a href="#c40"
            class="rel-time-title activity-ref"
            title="5 years ago"
        data-time="1493500712"
      >in-testsuite</a>
    </td>

    <td class="flag-value">+
    </td>

  </tr>
          </tbody>
          <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter"><div class="vcard vcard_141755" ><a class="email " href="/user_profile?user_id=141755" > <span class="fna">robert.strong.bugs</span></a>
</div>
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag-1573401">in-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag-1573401-dirty">
      <select id="flag-1573401" name="flag-1573401"
        title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" selected>+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr>
          </tbody>
          <tbody class="edit-hide"><tr>
    <td class="flag-setter"><div class="vcard vcard_488993" ><a class="email " href="/user_profile?user_id=488993" > <span class="fna">avaida</span></a>
</div>
    </td>

    <td class="flag-name">
        <a href="#c52"
            class="rel-time-title activity-ref"
            title="5 years ago"
        data-time="1493959726"
      >qe-verify</a>
    </td>

    <td class="flag-value">-
    </td>

  </tr>
          </tbody>
          <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter"><div class="vcard vcard_488993" ><a class="email " href="/user_profile?user_id=488993" > <span class="fna">avaida</span></a>
</div>
    </td>

    <td class="flag-name">
      <label title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually" for="flag-1576171">qe-verify</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag-1576171-dirty">
      <select id="flag-1576171" name="flag-1576171"
        title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually"
          disabled
        class="bug-flag">
            <option value="-" selected>-</option>
      </select>
    </td>


  </tr>
          </tbody>
    <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?" for="flag_type-930">behind-pref</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-930-dirty">
      <select id="flag_type-930" name="flag_type-930"
        title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?"
        class="bug-flag">
          <option value="X"></option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag tracking inclusion in the desktop Firefox product backlog." for="flag_type-846">firefox-backlog</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-846-dirty">
      <select id="flag_type-846" name="flag_type-846"
        title="Flag tracking inclusion in the desktop Firefox product backlog."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame." for="flag_type-913">sec-bounty-hof</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-913-dirty">
      <select id="flag_type-913" name="flag_type-913"
        title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-787">in-qa-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-787-dirty">
      <select id="flag_type-787" name="flag_type-787"
        title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>

      <td class="flag-requestee">
        <div id="requestee_type-787-container" style="display:none"><input
    name="requestee_type-787"
    value="" class="requestee bz_autocomplete_user"  id="requestee_type-787" 
  >
        </div>
      <td>

  </tr>
    </tbody>
  </table>
</div>
        </span>
    </div>

  
</div>
</div>

  
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-crash-data"
>
    <header id="module-crash-data-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Crash Data section"
           data-label-collapsed="Expand Crash Data section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-crash-data-content"
             aria-expanded="false"
             aria-labeledby="module-crash-data-title"
             aria-describedby="module-crash-data-subtitle"></div>
        <h2 class="module-title" id="module-crash-data-title">Crash Data</h2>
      </div>
    </header>
  <div class="module-content" id="module-crash-data-content" style="display:none"
  ><div class="field edit-show" id="field-cf_crash_signature" style="display:none"
>
    <div class="name">Signature:
    </div>


  
    <div class="value">
        <span id="field-value-cf_crash_signature">
        </span>
    </div>

  
</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-security"
>
    <header id="module-security-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Security section"
           data-label-collapsed="Expand Security section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-security-content"
             aria-expanded="false"
             aria-labeledby="module-security-title"
             aria-describedby="module-security-subtitle"></div>
        <h2 class="module-title" id="module-security-title">Security</h2>
          <h3 class="module-subtitle" id="module-security-subtitle">
            (public)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-security-content" style="display:none"
  ><div class="groups edit-hide">
    This bug is publicly visible.
</div>

<div class="groups edit-show" style="display:none">


</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-user-story" data-non-stick="1"
>
    <header id="module-user-story-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse User Story section"
           data-label-collapsed="Expand User Story section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-user-story-content"
             aria-expanded="false"
             aria-labeledby="module-user-story-title"
             aria-describedby="module-user-story-subtitle"></div>
        <h2 class="module-title" id="module-user-story-title">User Story</h2>
      </div>
    </header>
  <div class="module-content" id="module-user-story-content" style="display:none"
  >
    <pre id="user-story"></pre>
  </div>
</section>







<section class="module" id="module-attachments"
>
    <header id="module-attachments-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Attachments section"
           data-label-collapsed="Expand Attachments section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-attachments-content"
             aria-expanded="true"
             aria-labeledby="module-attachments-title"
             aria-describedby="module-attachments-subtitle"></div>
        <h2 class="module-title" id="module-attachments-title">Attachments</h2>
          <h3 class="module-subtitle" id="module-attachments-subtitle">
            (7 files, 11 obsolete files)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-attachments-content"
  ><table role="table" class="layout-table" id="attachments">
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8841306">poc + source.zip</a>
        </div>
        <div>
            <a href="#c0" class="attach-time activity-ref"><span class="rel-time" title="2017-02-26 00:19 PST" data-time="1488097144">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_465312" ><a class="email " href="/user_profile?user_id=465312" > <span class="fna">Seb Patane (he/him)</span></a>
</div></span>
        </div>
        <div class="attach-info">12.17 KB,
          application/x-zip-compressed        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8841306&amp;action=edit">Details</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8853880">Patch in progress</a>
        </div>
        <div>
            <a href="#c6" class="attach-time activity-ref"><span class="rel-time" title="2017-04-03 00:57 PDT" data-time="1491206270">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_141755" ><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div></span>
        </div>
        <div class="attach-info">79.54 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_550257" ><span class="fn">mhowell</span>
</div>:
              <a href="#c7"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1491206270"
            >
              feedback+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8853880&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8853880&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1342742&attachment=8853880">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8854370">patch in progress</a>
        </div>
        <div>
            <a href="#c10" class="attach-time activity-ref"><span class="rel-time" title="2017-04-04 02:51 PDT" data-time="1491299508">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_141755" ><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div></span>
        </div>
        <div class="attach-info">88.48 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8854370&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8854370&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1342742&attachment=8854370">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8855040">Patch in progress</a>
        </div>
        <div>
            <a href="#c12" class="attach-time activity-ref"><span class="rel-time" title="2017-04-05 13:40 PDT" data-time="1491424811">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_141755" ><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div></span>
        </div>
        <div class="attach-info">91.03 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8855040&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8855040&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1342742&attachment=8855040">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8855107">patch rev1</a>
        </div>
        <div>
            <a href="#c13" class="attach-time activity-ref"><span class="rel-time" title="2017-04-05 16:40 PDT" data-time="1491435653">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_141755" ><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div></span>
        </div>
        <div class="attach-info">91.03 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8855107&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8855107&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1342742&attachment=8855107">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8855119">patch rev1</a>
        </div>
        <div>
            <a href="#c15" class="attach-time activity-ref"><span class="rel-time" title="2017-04-05 17:31 PDT" data-time="1491438680">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_141755" ><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div></span>
        </div>
        <div class="attach-info">91.01 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_550257" ><span class="fn">mhowell</span>
</div>:
              <a href="#c20"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1491439248"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8855119&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8855119&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1342742&attachment=8855119">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8855689">patch rev2</a>
        </div>
        <div>
            <a href="#c22" class="attach-time activity-ref"><span class="rel-time" title="2017-04-07 00:58 PDT" data-time="1491551927">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_141755" ><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div></span>
        </div>
        <div class="attach-info">91.60 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_141755" ><span class="fn">robert.strong.bugs</span>
</div>:
              <a href="#c22"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1491551927"
            >
              review+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_280903" ><span class="fn">abillings</span>
</div>:
              <a href="#c24"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1491552245"
            >
              sec-approval+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8855689&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8855689&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1342742&attachment=8855689">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8856070">patch for checkin - client code</a>
        </div>
        <div>
            <a href="#c27" class="attach-time activity-ref"><span class="rel-time" title="2017-04-07 20:15 PDT" data-time="1491621352">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_141755" ><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div></span>
        </div>
        <div class="attach-info">30.74 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8856070&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8856070&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1342742&attachment=8856070">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8856071">patch for checkin - test code</a>
        </div>
        <div>
            <a href="#c28" class="attach-time activity-ref"><span class="rel-time" title="2017-04-07 20:16 PDT" data-time="1491621381">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_141755" ><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div></span>
        </div>
        <div class="attach-info">60.42 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8856071&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8856071&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1342742&attachment=8856071">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8857761">patch for m-c after bug 1156046</a>
        </div>
        <div>
            <a href="#c29" class="attach-time activity-ref"><span class="rel-time" title="2017-04-12 22:29 PDT" data-time="1492061369">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_141755" ><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div></span>
        </div>
        <div class="attach-info">29.97 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_141755" ><span class="fn">robert.strong.bugs</span>
</div>:
              <a href="#c29"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1492061369"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8857761&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8857761&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1342742&attachment=8857761">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8857762">test patch after bug 1354850</a>
        </div>
        <div>
            <a href="#c30" class="attach-time activity-ref"><span class="rel-time" title="2017-04-12 22:31 PDT" data-time="1492061503">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_141755" ><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div></span>
        </div>
        <div class="attach-info">51.65 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_550257" ><span class="fn">mhowell</span>
</div>:
              <a href="#a4000053_550257"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1492061503"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8857762&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8857762&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1342742&attachment=8857762">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8860766">patch for m-c checkin - client code</a>
        </div>
        <div>
            <a href="#c36" class="attach-time activity-ref"><span class="rel-time" title="2017-04-23 14:00 PDT" data-time="1492981229">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_141755" ><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div></span>
        </div>
        <div class="attach-info">31.13 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_550257" ><span class="fn">mhowell</span>
</div>:
              <a href="#a4960573_550257"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1492981229"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8860766&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8860766&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1342742&attachment=8860766">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8863067">pushed client patch for m-c</a>
        </div>
        <div>
            <a href="#c37" class="attach-time activity-ref"><span class="rel-time" title="2017-04-28 16:42 PDT" data-time="1493422926">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_141755" ><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div></span>
        </div>
        <div class="attach-info">31.13 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_141755" ><span class="fn">robert.strong.bugs</span>
</div>:
              <a href="#c37"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1493422926"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8863067&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8863067&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1342742&attachment=8863067">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8863068">pushed test patch for m-c</a>
        </div>
        <div>
            <a href="#c38" class="attach-time activity-ref"><span class="rel-time" title="2017-04-28 16:43 PDT" data-time="1493422992">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_141755" ><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div></span>
        </div>
        <div class="attach-info">52.30 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_141755" ><span class="fn">robert.strong.bugs</span>
</div>:
              <a href="#c38"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1493422992"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8863068&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8863068&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1342742&attachment=8863068">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8863532">client patch for beta</a>
        </div>
        <div>
            <a href="#c41" class="attach-time activity-ref"><span class="rel-time" title="2017-05-01 17:18 PDT" data-time="1493684304">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_141755" ><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div></span>
        </div>
        <div class="attach-info">31.13 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_141755" ><span class="fn">robert.strong.bugs</span>
</div>:
              <a href="#c41"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1493684304"
            >
              review+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_538805" ><span class="fn">ritu</span>
</div>:
              <a href="#c47"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1493684304"
            >
              approval-mozilla-beta+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8863532&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8863532&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1342742&attachment=8863532">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8863534">test patch for beta</a>
        </div>
        <div>
            <a href="#c43" class="attach-time activity-ref"><span class="rel-time" title="2017-05-01 17:26 PDT" data-time="1493684790">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_141755" ><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div></span>
        </div>
        <div class="attach-info">66.70 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_141755" ><span class="fn">robert.strong.bugs</span>
</div>:
              <a href="#c43"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1493684790"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8863534&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8863534&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1342742&attachment=8863534">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8863537">client patch for esr52</a>
        </div>
        <div>
            <a href="#c44" class="attach-time activity-ref"><span class="rel-time" title="2017-05-01 17:30 PDT" data-time="1493685052">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_141755" ><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div></span>
        </div>
        <div class="attach-info">38.04 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_141755" ><span class="fn">robert.strong.bugs</span>
</div>:
              <a href="#c44"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1493685052"
            >
              review+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_538805" ><span class="fn">ritu</span>
</div>:
              <a href="#c48"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1493685052"
            >
              approval-mozilla-esr52+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8863537&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8863537&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1342742&attachment=8863537">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8863539">test patch for esr52</a>
        </div>
        <div>
            <a href="#c45" class="attach-time activity-ref"><span class="rel-time" title="2017-05-01 17:31 PDT" data-time="1493685112">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_141755" ><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div></span>
        </div>
        <div class="attach-info">59.25 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_141755" ><span class="fn">robert.strong.bugs</span>
</div>:
              <a href="#c45"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1493685112"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8863539&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8863539&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1342742&attachment=8863539">Splinter Review</a>
    </tr>
</table>

<footer id="attachments-footer">
  <div id="attachments-actions">
      <button type="button" id="attachments-obsolete-btn" class="secondary">Show Obsolete</button>
  </div>
  
</footer>
  </div>
</section>



<script nonce="wpAA6NqONZHJVqWCBz4L1LislFG1eHnEj7OBfSTGgXzpq4GO">
  init_module_visibility();
</script>



<meta name="firefox-versions" content="{&quot;FIREFOX_AURORA&quot;:&quot;&quot;,&quot;FIREFOX_DEVEDITION&quot;:&quot;94.0b9&quot;,&quot;FIREFOX_ESR&quot;:&quot;78.15.0esr&quot;,&quot;FIREFOX_ESR_NEXT&quot;:&quot;91.2.0esr&quot;,&quot;FIREFOX_NIGHTLY&quot;:&quot;95.0a1&quot;,&quot;FIREFOX_PINEBUILD&quot;:&quot;&quot;,&quot;LAST_MERGE_DATE&quot;:&quot;2021-10-04&quot;,&quot;LAST_RELEASE_DATE&quot;:&quot;2021-10-05&quot;,&quot;LAST_SOFTFREEZE_DATE&quot;:&quot;2021-09-30&quot;,&quot;LATEST_FIREFOX_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_OLDER_VERSION&quot;:&quot;3.6.28&quot;,&quot;LATEST_FIREFOX_RELEASED_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_VERSION&quot;:&quot;93.0&quot;,&quot;NEXT_MERGE_DATE&quot;:&quot;2021-11-01&quot;,&quot;NEXT_RELEASE_DATE&quot;:&quot;2021-11-02&quot;,&quot;NEXT_SOFTFREEZE_DATE&quot;:&quot;2021-10-28&quot;}">


<div id="comment-actions">
    <button type="button" id="bottom-btn" class="secondary" aria-label="Go to Page Bottom">Bottom &darr;</button>
  <div class="dropdown">
    <button type="button" id="comment-tags-btn" aria-haspopup="true" aria-label="Tags"
      aria-expanded="false" aria-controls="comment-tags-menu" class="dropdown-button minor">Tags &#9662;</button>
    <ul id="comment-tags-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a role="menuitem" tabindex="-1" data-comment-tag="">Reset</a>
      </li>
    </ul>
  </div>
  <div class="dropdown">
    <button type="button" id="view-menu-btn" aria-haspopup="true" aria-label="Timeline"
      aria-expanded="false" aria-controls="view-menu" class="dropdown-button minor">Timeline &#9662;</button>
    <ul id="view-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a id="view-reset" role="menuitem" tabindex="-1">Reset</a>
      </li>
      <li role="separator"></li>
      <li role="presentation">
        <a id="view-collapse-all" role="menuitem" tabindex="-1">Collapse All</a>
      </li>
      <li role="presentation">
        <a id="view-expand-all" role="menuitem" tabindex="-1">Expand All</a>
      </li>
      <li role="presentation">
        <a id="view-comments-only" role="menuitem" tabindex="-1">Comments Only</a>
      </li>
    </ul>
   </div>
</div>
<div class="change-set" id="c0"><div class="comment" data-id="12098427" data-no="0"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-0" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_465312" ><img src="https://secure.gravatar.com/avatar/d6607825cb6a68be435e0fde66f25db5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_465312" ><a class="email " href="/user_profile?user_id=465312" > <span class="fna">Seb Patane (he/him)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-0"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-0" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c0">Description</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-02-26 00:19 PST" data-time="1488097144">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-0">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8841306"
         class="attachment"
         data-id="8841306" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="170626 -- poc + source.zip">
      <meta itemprop="contentSize" content="12460">
      <meta itemprop="encodingFormat" content="application/x-zip-compressed">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=8841306" itemprop="contentUrl">
        <span id="att-8841306-description" itemprop="description">poc + source.zip</span></a>
        — <a href="attachment.cgi?id=8841306&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-0" data-comment-id="12098427">An unprivileged, standard, Windows user can execute arbitrary code as SYSTEM using the Firefox Updater (via the Maintenance Service).

This is possible by combining two bugs. The first is that the Updater can be tricked into executing an arbitrary PostUpdate file by the updater.ini file after a successful action is performed. The second allows overwrite of any file as SYSTEM with partially attacker controlled data.

We use the overwrite bug to write a new updater.ini, which triggers an install of Firefox into an attacker controlled directory which allows arbitrary code execution via the maintenanceservice_installer.exe binary.


# Reproduction

I've attached a poc + source, to run it you'll need the full update.mar for the current installed version of Firefox [0] (or higher), as well as a full firefox installer [1]. The poc can be run as follows:

firefox_poc.exe payload.exe firefox-51.0.1.complete.mar &quot;Firefox Setup 51.0.1.exe&quot; C:\Program Files (x86)\Mozilla Firefox

The payload.exe is the file to be executed as SYSTEM. The final argument needs to be a legitimate Firefox installation directory, and will default to C:\Program Files(x86)\Mozilla Firefox if not supplied. One of the bugs relies on a small race condition, which has always executed in less than a minute for me but let me know if you have any problems. It will continue trying until it succeeds or you use ctrl+c to kill it.

The included payload.exe just runs &quot;whoami &gt; /foo.txt&quot;, which should create a foo.txt file in your drive root with the contents &quot;nt authority\system&quot;.


# ExeRelPath in updater.ini allows execution of arbitrary Mozilla binaries using absolute paths

 The ExeRelPath entry in the C:\Program Files (x86)\Mozilla Firefox\updater.ini file is executed by the updater after a successful action is made. There are allowances made to prevent directory traversal using '..', however if an absolute file path is provided instead of a filename then PathAppendSafe [2] (which uses PathAppendW) will return the absolute file path instead.

 Eg. PathAppendW(&quot;C:\Program Files (x86)\Mozilla Firefox&quot;, &quot;C:\some\mozilla.exe&quot;)
 		=&gt; &quot;C:\some\mozilla.exe&quot;

The updater will happily execute this file, as long as it is signed by Mozilla with a current certificate. We can use then use these binaries in ways never intended to gain arbitrary code execution.

The avenue used in this proof of concept is to use the Firefox setup.exe to install Firefox into an attacker controlled directory [3], which then executes whatever is in the maintenanceservice_installer.exe file on post-install (in fairness, this would have no practical chance of being intercepted otherwise). I imagine there are similar avenues in other Mozilla signed binaries, however I have not investigated them.


# Arbitrary file overwrite with partial content injection

Soon after the updater starts, updater.cpp [4] calls LogInit, which calls GetTempFileNameW with the attacker-supplied patch directory to get a temp filename for the log file. By providing a file which starts with \\.\, GetTempFileNameW will just copy the input into the output buffer instead of providing a valid temp directory.

Eg. GetTempFileNameW(&quot;\\.\c:\target\file.txt&quot;, L&quot;log&quot;, 0, mTmpFilePath)
		=&gt; mTmpFilePath = &quot;\\.\c:\target\file.txt&quot;

Since it is essentially a normal file path, the log file will happily truncate and write to this file.

We can insert up to 260 characters at some point in the file using the fact that the working directory argument gets logged in updater.cpp [5]. The resulting file ends up looking something like the following (ABC's are user supplied):

	Performing a replace request
	PATCH DIRECTORY \\.\C:\target\file.txt
	INSTALLATION DIRECTORY C:\Program Files (x86)\Mozilla Firefox
	WORKING DIRECTORY AAAAAAAAAAAAAAA
	BBBBBBBBBBBBBBBBBB
	CCCCCCCCCCCCCCCCCC

	The apply-to directory must be the same as or a child of the installation directory! Exiting.


In order to reach the line of code which logs the working directory argument, we need to first avoid a failure of WriteStatusFile [6], otherwise the updater will exit early and we will only truncate the file without our content written. The reason WriteStatusFile fails is that it tries to move a file to &lt;patch-dir&gt;/update.status, which in this case is \\.\c:\target\file.txt\update.status, which is not possible because file.txt is a file.

However, if we create a directory junction in an attacker controlled directory, eg. c:\exploit\junction\ pointing to c:\target\, then we can supply that to the updater instead. Now after the updater has opened a file descriptor to file.txt, we race it to switch the junction out with a directory named file.txt before it has attempted the status file move. If we win the race, the updater creates c:\exploit\junction\file.txt\update.status and execution continues.


# Arbitrary code execution

Because GetPrivateProfileStringW [7] isn't very picky about the formatting of the updater.ini, we can use the arbitrary file overwrite to replace the C:\Program Files (x86)\Mozilla Firefox\updater.ini with one which looks like this:

	Performing a replace request
	PATCH DIRECTORY \\.\C:\temp\ff-exploit\overwrite-target\updater.ini
	INSTALLATION DIRECTORY C:\Program Files (x86)\Mozilla Firefox
	WORKING DIRECTORY 

	[PostUpdateWin]
	ExeRelPath=C:\temp\ff-exploit\setup-dir\ff_setup.exe
	ExeArg=/INI=C:\temp\ff-exploit\setup-dir\ff_setup.ini



	The apply-to directory must be the same as or a child of the installation directory! Exiting.

The ff_setup.ini has the InstallDirectoryPath entry set to an attacker controlled directory, eg. c:\temp\ff-exploit\new-firefox\ and the MaintenanceService entry set to true. The attacker just needs to copy their payload.exe into c:\temp\ff-exploit-new-firefox\maintenanceservice_installer.exe and keep it locked for shared reads (so it can't be overwritten on install, but can be executed).

Then, we trigger some action which will succeed, like staging an upate.mar file
 	-&gt; which will execute the PostUpdateWin command
 	-&gt; which will install a new copy of firefox into the attacker controlled c:\temp\ff-exploit\new-firefox\ directory
 	-&gt; which will then run the maintenanceservice_install.exe payload as SYSTEM

Let me know if you need any more information. I tested on Windows 8.1 x64, Firefox 51.0.1

[0] - <a rel="nofollow" href="http://archive.mozilla.org/pub/firefox/releases/51.0.1/update/win32/en-US/firefox-51.0.1.complete.mar">http://archive.mozilla.org/pub/firefox/releases/51.0.1/update/win32/en-US/firefox-51.0.1.complete.mar</a>
[1] - <a rel="nofollow" href="http://archive.mozilla.org/pub/firefox/releases/51.0.1/win32/en-US/Firefox%20Setup%2051.0.1.exe">http://archive.mozilla.org/pub/firefox/releases/51.0.1/win32/en-US/Firefox%20Setup%2051.0.1.exe</a>

[2] - <a rel="nofollow" href="https://dxr.mozilla.org/mozilla-central/rev/f36062d04d165f6f6e781cf0633ffcbbebe6c273/toolkit/mozapps/update/updater/updater.cpp#2029">https://dxr.mozilla.org/mozilla-central/rev/f36062d04d165f6f6e781cf0633ffcbbebe6c273/toolkit/mozapps/update/updater/updater.cpp#2029</a>
[3] - <a rel="nofollow" href="https://wiki.mozilla.org/Installer:Command_Line_Arguments">https://wiki.mozilla.org/Installer:Command_Line_Arguments</a>

[4] - <a rel="nofollow" href="https://dxr.mozilla.org/mozilla-central/rev/f36062d04d165f6f6e781cf0633ffcbbebe6c273/toolkit/mozapps/update/updater/updater.cpp#2937">https://dxr.mozilla.org/mozilla-central/rev/f36062d04d165f6f6e781cf0633ffcbbebe6c273/toolkit/mozapps/update/updater/updater.cpp#2937</a>
[5] - <a rel="nofollow" href="https://dxr.mozilla.org/mozilla-central/rev/f36062d04d165f6f6e781cf0633ffcbbebe6c273/toolkit/mozapps/update/updater/updater.cpp#2958">https://dxr.mozilla.org/mozilla-central/rev/f36062d04d165f6f6e781cf0633ffcbbebe6c273/toolkit/mozapps/update/updater/updater.cpp#2958</a>
[6] - <a rel="nofollow" href="https://dxr.mozilla.org/mozilla-central/rev/f36062d04d165f6f6e781cf0633ffcbbebe6c273/toolkit/mozapps/update/updater/updater.cpp#2939">https://dxr.mozilla.org/mozilla-central/rev/f36062d04d165f6f6e781cf0633ffcbbebe6c273/toolkit/mozapps/update/updater/updater.cpp#2939</a>

[7] - <a rel="nofollow" href="https://dxr.mozilla.org/mozilla-central/rev/f36062d04d165f6f6e781cf0633ffcbbebe6c273/toolkit/mozapps/update/updater/updater.cpp#2005">https://dxr.mozilla.org/mozilla-central/rev/f36062d04d165f6f6e781cf0633ffcbbebe6c273/toolkit/mozapps/update/updater/updater.cpp#2005</a></pre></div><div class="change-set" id="a383119_1689"><div class="change" id="aa383119_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a383119_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a383119_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a383119_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a383119_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#a383119_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-02 10:44 PST" data-time="1488480263">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: needinfo?(robert.strong.bugs)</div><div class="change">Keywords: <a href="/buglist.cgi?keywords=csectype-priv-escalation&amp;resolution=---">csectype-priv-escalation</a>, 
          
            <a href="/buglist.cgi?keywords=sec-high&amp;resolution=---">sec-high</a></div></div></div><div class="change-set" id="c1"><div class="comment" data-id="12111068" data-no="1"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-1" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_451704" id="a383119_1689"><img src="https://secure.gravatar.com/avatar/6168ea97fda0cefa449331e59b24e8f7?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_451704" id="a383119_1689"><a class="email " href="/user_profile?user_id=451704" > <span class="fna">Liz Henry (:lizzard Please n-i to RyanVM, jcristau, or pascal)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-1"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-1" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c1">Comment 1</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-02 10:47 PST" data-time="1488480453">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-1">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-1" data-comment-id="12111068">Tracking for 54 for now though I'm not sure which branch we know is affected.</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox52&amp;o1=isnotempty">status-firefox52</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox52&amp;o1=equals&amp;v1=%3F">?</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox53&amp;o1=isnotempty">status-firefox53</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox53&amp;o1=equals&amp;v1=%3F">?</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox54&amp;o1=isnotempty">status-firefox54</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox54&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=isnotempty">status-firefox-esr45</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=equals&amp;v1=%3F">?</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr52&amp;o1=isnotempty">status-firefox-esr52</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr52&amp;o1=equals&amp;v1=%3F">?</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox54&amp;o1=isnotempty">tracking-firefox54</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox54&amp;o1=equals&amp;v1=%2B">+</a></div></div></div><div class="change-set" id="a879900_428608"><div class="change" id="aa879900_428608">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a879900_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_428608" id="a879900_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a879900_428608"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a879900_428608">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#a879900_428608">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-08 04:44 PST" data-time="1488977044">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Assignee: nobody &rarr; robert.strong.bugs</div></div></div><div class="change-set" id="a1023203_141755"><div class="change" id="aa1023203_141755">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_141755" id="a1023203_141755"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_141755" id="a1023203_141755"><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1023203_141755"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1023203_141755">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#a1023203_141755">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-09 20:32 PST" data-time="1489120347">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Status: NEW &rarr; ASSIGNED</div><div class="change">Flags: <span class="activity-deleted">needinfo?(robert.strong.bugs)</span></div></div></div><div class="change-set" id="a1527085_280903"><div class="change" id="aa1527085_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a1527085_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a1527085_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1527085_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1527085_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#a1527085_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-15 17:30 PDT" data-time="1489624229">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: sec-bounty?</div></div></div><div class="change-set" id="c2"><div class="comment" data-id="12166951" data-no="2"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-2" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a1527085_280903"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a1527085_280903"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-2"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-2" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c2">Comment 2</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-22 04:22 PDT" data-time="1490181721">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-2">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-2" data-comment-id="12166951">Robert, this bug has been reported almost 3 weeks ago and it's sec-high.
Can you move it up in your queue?</pre><div class="activity"><div class="change">Flags: needinfo?(robert.strong.bugs)</div></div></div><div class="change-set" id="c3"><div class="comment" data-id="12168632" data-no="3"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-3" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_141755" id="a1527085_280903"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_141755" id="a1527085_280903"><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-3"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-3" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c3">Comment 3</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-22 11:41 PDT" data-time="1490208114">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-3">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-3" data-comment-id="12168632">Will do.

dveditz, I've noticed that you haven't been giving sec-high for local exploits as of late. Should this be sec-high?</pre><div class="activity"><div class="change">Flags: needinfo?(robert.strong.bugs) &rarr; needinfo?(dveditz)</div></div></div><div class="change-set" id="c4"><div class="comment" data-id="12186082" data-no="4"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-4" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a1527085_280903"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a1527085_280903"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-4"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-4" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c4">Comment 4</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-28 15:26 PDT" data-time="1490739989">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-4">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-4" data-comment-id="12186082">I think so. Will check the others and see if I underrated them.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(dveditz)</span></div></div></div><div class="change-set" id="c5"><div class="comment" data-id="12194031" data-no="5"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-5" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_141755" id="a1527085_280903"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_141755" id="a1527085_280903"><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-5"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-5" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c5">Comment 5</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-31 00:30 PDT" data-time="1490945410">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-5">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-5" data-comment-id="12194031">Just an update for drivers, I'm close to being finished with this patch but I still need to finish up the tests. I hope to have this submitted for review by no later than EOD Monday.</pre></div><div class="change-set" id="c6"><div class="comment" data-id="12198717" data-no="6"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-6" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_141755" id="a1527085_280903"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_141755" id="a1527085_280903"><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-6"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-6" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c6">Comment 6</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-04-03 00:57 PDT" data-time="1491206270">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-6">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8853880"
         class="attachment patch obsolete"
         data-id="8853880" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1342742">
      <meta itemprop="contentSize" content="81454">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8853880">
          <a class="link" href="attachment.cgi?id=8853880&amp;action=diff">
        <span id="att-8853880-description" itemprop="description">Patch in progress</span></a> (obsolete)
        — <a href="attachment.cgi?id=8853880&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1342742&attachment=8853880">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-6" data-comment-id="12198717">Matt, I still have a couple of more things I want to add to this patch but I wanted to get your input on the current set of changes while I am adding them. Thanks!</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8853880&amp;action=edit"
           title="Patch in progress"
           class=""
        >Attachment #8853880</a> -
        Flags: feedback?(mhowell)</div></div></div><div class="change-set" id="c7"><div class="comment" data-id="12200138" data-no="7"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-7" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550257" id="a1527085_280903"><img src="https://secure.gravatar.com/avatar/3f97cf08c1ecf35bc10896cf363773e5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550257" id="a1527085_280903"><a class="email " href="/user_profile?user_id=550257" > <span class="fna">Molly Howell (she/her) [:mhowell] (PTO until Nov 1)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-7"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-7" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c7">Comment 7</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-04-03 10:07 PDT" data-time="1491239226">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-7">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-7" data-comment-id="12200138">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8853880" name="attach_8853880" title="Patch in progress">attachment 8853880</a> <a href="/attachment.cgi?id=8853880&amp;action=edit" title="Patch in progress">[details]</a> <a href="/attachment.cgi?id=8853880&amp;action=diff" title="Patch in progress">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1342742&amp;attachment=8853880'>[review]</a>
Patch in progress

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8853880" name="attach_8853880" title="Patch in progress">attachment 8853880</a> <a href="/attachment.cgi?id=8853880&amp;action=edit" title="Patch in progress">[details]</a> <a href="/attachment.cgi?id=8853880&amp;action=diff" title="Patch in progress">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1342742&amp;attachment=8853880'>[review]</a>:
-----------------------------------------------------------------

Didn't do a full review yet, but I do agree with the approach of just locking down _all_ the paths like this.

I'm a little worried about IsValidFullPath rejecting UNC paths; running off of a network share seems like a case we want to support (without requiring a drive mapping).

Also, this might be one of the things you're planning to add, but it's probably also a good idea to check the return code from GetTempFileName. Looks like it would have been returning 0 and setting last-error to 267 (directory name is invalid) while running this exploit.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8853880&amp;action=edit"
           title="Patch in progress"
           class=""
        >Attachment #8853880</a> -
        Flags: feedback?(mhowell) &rarr; feedback+</div></div></div><div class="change-set" id="c8"><div class="comment" data-id="12200167" data-no="8"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-8" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_141755" id="a1527085_280903"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_141755" id="a1527085_280903"><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-8"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-8" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c8">Comment 8</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-04-03 10:14 PDT" data-time="1491239655">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-8">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-8" data-comment-id="12200167">(In reply to Matt Howell [:mhowell] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Arbitrary code execution as SYSTEM using Updater to overwrite updater.ini"
   href="/show_bug.cgi?id=1342742#c7">comment #7</a>)
<span class="quote">&gt; Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8853880" name="attach_8853880" title="Patch in progress">attachment 8853880</a> <a href="/attachment.cgi?id=8853880&amp;action=edit" title="Patch in progress">[details]</a> <a href="/attachment.cgi?id=8853880&amp;action=diff" title="Patch in progress">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1342742&amp;attachment=8853880'>[review]</a>
&gt; Patch in progress
&gt; 
&gt; Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8853880" name="attach_8853880" title="Patch in progress">attachment 8853880</a> <a href="/attachment.cgi?id=8853880&amp;action=edit" title="Patch in progress">[details]</a> <a href="/attachment.cgi?id=8853880&amp;action=diff" title="Patch in progress">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1342742&amp;attachment=8853880'>[review]</a>:
&gt; -----------------------------------------------------------------
&gt; 
&gt; Didn't do a full review yet, but I do agree with the approach of just
&gt; locking down _all_ the paths like this.
&gt; 
&gt; I'm a little worried about IsValidFullPath rejecting UNC paths; running off
&gt; of a network share seems like a case we want to support (without requiring a
&gt; drive mapping).</span >
It allows UNC server shares but not other UNC paths. Are there other UNC paths you are concerned about?

<span class="quote">&gt;+  // Check if the path is a UNC server share.
&gt;+  if (origFullPath[0] == NS_T('\\')) {
&gt;+    if (!PathIsUNCServerShareW(origFullPath)) {
&gt;+      return false;
&gt;+    }</span ></pre><div class="activity"><div class="change">Flags: needinfo?(mhowell)</div></div></div><div class="change-set" id="c9"><div class="comment" data-id="12200283" data-no="9"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-9" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550257" id="a1527085_280903"><img src="https://secure.gravatar.com/avatar/3f97cf08c1ecf35bc10896cf363773e5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550257" id="a1527085_280903"><a class="email " href="/user_profile?user_id=550257" > <span class="fna">Molly Howell (she/her) [:mhowell] (PTO until Nov 1)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-9"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-9" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c9">Comment 9</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-04-03 10:53 PDT" data-time="1491242025">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-9">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-9" data-comment-id="12200283">(In reply to Robert Strong [:rstrong] (use needinfo to contact me) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Arbitrary code execution as SYSTEM using Updater to overwrite updater.ini"
   href="/show_bug.cgi?id=1342742#c8">comment #8</a>)
<span class="quote">&gt; It allows UNC server shares but not other UNC paths. Are there other UNC
&gt; paths you are concerned about?</span >

No, you're right, I was misinterpreting that code somehow. Please disregard.

But that did lead me to discover another issue with using PathIsUNCServerShare this way; it only returns true if the path is just to a share, and false for a directory within a share:
PathIsUNCServerShareW(L&quot;\\\\server\\share&quot;) == TRUE
PathIsUNCServerShareW(L&quot;\\\\server\\share\\dir&quot;) == FALSE

So that's not all that useful in this context.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(mhowell)</span></div></div></div><div class="change-set" id="c10"><div class="comment" data-id="12202900" data-no="10"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-10" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_141755" id="a1527085_280903"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_141755" id="a1527085_280903"><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-10"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-10" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c10">Comment 10</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-04-04 02:51 PDT" data-time="1491299508">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-10">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8854370"
         class="attachment patch obsolete"
         data-id="8854370" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1342742">
      <meta itemprop="contentSize" content="90603">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8854370">
          <a class="link" href="attachment.cgi?id=8854370&amp;action=diff">
        <span id="att-8854370-description" itemprop="description">patch in progress</span></a> (obsolete)
        — <a href="attachment.cgi?id=8854370&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1342742&attachment=8854370">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-10" data-comment-id="12202900">Thanks for checking that call and this latest patch should cover it. Still have a few more calls I need to verify but that was the main one. I added a test for the failure case. I'm not sure if it would be ok to add an in tree test using a valid UNC server share path since tests that access the network aren't allowed. Perhaps it would be ok if I used a server name that wouldn't be used since from what I recall the concern is that tests should pass without access to the network resource which this test would.

Added the GetTempFileName checks for the cases that are of concern. I still need to double check if there are other cases.

The main last thing I want to add is checking that the registry entry for the install directory exists from the maintenance service but there might be a few more as I examine the code.

Thanks for the feedback!</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8853880&amp;action=edit"
           title="Patch in progress"
           class=""
        >Attachment #8853880</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="c11"><div class="comment" data-id="12207479" data-no="11"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-11" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_141755" id="a1527085_280903"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_141755" id="a1527085_280903"><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-11"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-11" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c11">Comment 11</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-04-05 02:40 PDT" data-time="1491385215">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-11">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-11" data-comment-id="12207479">Drivers, keeping the existing tests running while adding the new restrictions is taking a little longer than I had thought it would. Another day or so and it should be ready to land on nightly.</pre></div><div class="change-set" id="c12"><div class="comment" data-id="12209671" data-no="12"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-12" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_141755" id="a1527085_280903"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_141755" id="a1527085_280903"><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-12"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-12" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c12">Comment 12</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-04-05 13:40 PDT" data-time="1491424811">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-12">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8855040"
         class="attachment patch obsolete"
         data-id="8855040" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1342742">
      <meta itemprop="contentSize" content="93211">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8855040">
          <a class="link" href="attachment.cgi?id=8855040&amp;action=diff">
        <span id="att-8855040-description" itemprop="description">Patch in progress</span></a> (obsolete)
        — <a href="attachment.cgi?id=8855040&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1342742&attachment=8855040">Splinter Review</a>
      </div>
    </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8854370&amp;action=edit"
           title="patch in progress"
           class=""
        >Attachment #8854370</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="c13"><div class="comment" data-id="12210227" data-no="13"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-13" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_141755" id="a1527085_280903"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_141755" id="a1527085_280903"><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-13"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-13" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c13">Comment 13</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-04-05 16:40 PDT" data-time="1491435653">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-13">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8855107"
         class="attachment patch obsolete"
         data-id="8855107" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1342742">
      <meta itemprop="contentSize" content="93211">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8855107">
          <a class="link" href="attachment.cgi?id=8855107&amp;action=diff">
        <span id="att-8855107-description" itemprop="description">patch rev1</span></a> (obsolete)
        — <a href="attachment.cgi?id=8855107&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1342742&attachment=8855107">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-13" data-comment-id="12210227">Pushed to try
<a rel="nofollow" href="https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=04910a382a4ff11e4991fac9aeba56cc0eaafd71">https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=04910a382a4ff11e4991fac9aeba56cc0eaafd71</a></pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8855040&amp;action=edit"
           title="Patch in progress"
           class=""
        >Attachment #8855040</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="c14"><div class="comment" data-id="12210309" data-no="14"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-14" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_141755" id="a1527085_280903"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_141755" id="a1527085_280903"><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-14"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-14" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c14">Comment 14</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-04-05 17:25 PDT" data-time="1491438332">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-14">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-14" data-comment-id="12210309">Without the patch I was able to reproduce and I get the following in the maintenanceservice.log

updater.exe was compared successfully to the installation directory updater.exe.
The updater.exe application contains the Mozilla updater identity.
The file &quot;C:\Program Files (x86)\Nightly\updater.exe&quot; is signed and the signature was verified.
Passed in path: 'C:\Program Files (x86)\Nightly\updater.exe'; Using this path for updating: 'C:\Program Files (x86)\Mozilla Maintenance Service\update\updater.exe'.
updater.exe was compared successfully to the installation directory updater.exe.
The updater.exe application contains the Mozilla updater identity.
The file &quot;C:\Program Files (x86)\Mozilla Maintenance Service\update\updater.exe&quot; is signed and the signature was verified.
Starting update process as the service in session 0.
Starting service with cmdline: &quot;C:\Program Files (x86)\Mozilla Maintenance Service\update\updater.exe&quot; C:\moz\170626\patch-dir &quot;C:\Program Files (x86)\Nightly&quot; &quot;C:\Program Files (x86)\Nightly\updated&quot; -1 . C:\moz\170626\setup-dir\ff_setup.ini
Process was started... waiting on result.
Process finished with return code 0.
updater.exe returned status: applied

updater.exe was launched and run successfully!
Service command software-update complete.
service command aaa complete with result: Success.

With the patch I get the following in the maintenanceservice.log

*** Warning: The patch directory path is not valid for this application.***</pre></div><div class="change-set" id="c15"><div class="comment" data-id="12210323" data-no="15"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-15" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_141755" id="a1527085_280903"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_141755" id="a1527085_280903"><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-15"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-15" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c15">Comment 15</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-04-05 17:31 PDT" data-time="1491438680">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-15">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8855119"
         class="attachment patch obsolete"
         data-id="8855119" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1342742">
      <meta itemprop="contentSize" content="93197">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8855119">
          <a class="link" href="attachment.cgi?id=8855119&amp;action=diff">
        <span id="att-8855119-description" itemprop="description">patch rev1</span></a> (obsolete)
        — <a href="attachment.cgi?id=8855119&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1342742&attachment=8855119">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-15" data-comment-id="12210323">Fixed a couple of things exposed by eslint

Pushed to try again
<a rel="nofollow" href="https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=b39a7e9212e9429a60d9e3249abf87ca7d28beb1">https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=b39a7e9212e9429a60d9e3249abf87ca7d28beb1</a></pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8855107&amp;action=edit"
           title="patch rev1"
           class=""
        >Attachment #8855107</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="c16"><div class="comment" data-id="12210329" data-no="16"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-16" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_141755" id="a1527085_280903"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_141755" id="a1527085_280903"><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-16"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-16" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c16">Comment 16</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-04-05 17:33 PDT" data-time="1491438838">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-16">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-16" data-comment-id="12210329">Seb, thanks for the bug report and for the precise details and instructions! It is really appreciated.</pre></div><div class="change-set" id="c17"><div class="comment" data-id="12210341" data-no="17"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-17" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_141755" id="a1527085_280903"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_141755" id="a1527085_280903"><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-17"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-17" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c17">Comment 17</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-04-05 17:40 PDT" data-time="1491439248">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-17">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-17" data-comment-id="12210341">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8855119" name="attach_8855119" title="patch rev1">attachment 8855119</a> <a href="/attachment.cgi?id=8855119&amp;action=edit" title="patch rev1">[details]</a> <a href="/attachment.cgi?id=8855119&amp;action=diff" title="patch rev1">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1342742&amp;attachment=8855119'>[review]</a>
patch rev1

I've run other versions of this patch through the try server so I am fairly certain it will pass so requesting review.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8855119&amp;action=edit"
           title="patch rev1"
           class=""
        >Attachment #8855119</a> -
        Flags: review?(mhowell)</div></div></div><div class="change-set" id="c18"><div class="comment" data-id="12210345" data-no="18"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-18" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_141755" id="a1527085_280903"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_141755" id="a1527085_280903"><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-18"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-18" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c18">Comment 18</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-04-05 17:44 PDT" data-time="1491439474">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-18">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-18" data-comment-id="12210345">I filed <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Grant write access to HKEY_LOCAL_MACHINE\SOFTWARE\Mozilla for the account running tests on Windows test systems"
   href="/show_bug.cgi?id=1353889">bug 1353889</a> which should make it possible to add tests for the one change that I didn't add a test for. I manually verified that change worked as expected. There are some other things that can be done to simplify the tests overall after the changes to TestAUSHelper but I don't want to do that in this bug.</pre></div><div class="change-set" id="c19"><div class="comment" data-id="12212528" data-no="19"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-19" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_465312" id="a1527085_280903"><img src="https://secure.gravatar.com/avatar/d6607825cb6a68be435e0fde66f25db5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_465312" id="a1527085_280903"><a class="email " href="/user_profile?user_id=465312" > <span class="fna">Seb Patane (he/him)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-19"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-19" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c19">Comment 19</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-04-06 09:47 PDT" data-time="1491497247">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-19">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-19" data-comment-id="12212528">No worries Robert - happy to help! Glad to see this fixed :)</pre></div><div class="change-set" id="c20"><div class="comment" data-id="12212790" data-no="20"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-20" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550257" id="a1527085_280903"><img src="https://secure.gravatar.com/avatar/3f97cf08c1ecf35bc10896cf363773e5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550257" id="a1527085_280903"><a class="email " href="/user_profile?user_id=550257" > <span class="fna">Molly Howell (she/her) [:mhowell] (PTO until Nov 1)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-20"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-20" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c20">Comment 20</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-04-06 11:00 PDT" data-time="1491501657">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-20">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-20" data-comment-id="12212790">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8855119" name="attach_8855119" title="patch rev1">attachment 8855119</a> <a href="/attachment.cgi?id=8855119&amp;action=edit" title="patch rev1">[details]</a> <a href="/attachment.cgi?id=8855119&amp;action=diff" title="patch rev1">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1342742&amp;attachment=8855119'>[review]</a>
patch rev1

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8855119" name="attach_8855119" title="patch rev1">attachment 8855119</a> <a href="/attachment.cgi?id=8855119&amp;action=edit" title="patch rev1">[details]</a> <a href="/attachment.cgi?id=8855119&amp;action=diff" title="patch rev1">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1342742&amp;attachment=8855119'>[review]</a>:
-----------------------------------------------------------------

r+ overall with a handful of comments. Thanks for getting this mess sorted out.

::: toolkit/mozapps/update/common/updatecommon.cpp
&#64;&#64; +192,5 &#64;&#64;
<span class="quote">&gt; +  }
&gt; +
&gt; +  if (origFullPath[0] == NS_T('\\')) {
&gt; +    // Only allow UNC server share paths.
&gt; +    if (!PathIsUNCServerShareW(testPath)) {</span >

Still need to fix this call; PathIsUNCServerShare rejects anything not of the precise form &quot;\\server\share&quot; (including &quot;\\server\share\&quot; it turns out), but we need to allow subdirectories of a share.

::: toolkit/mozapps/update/tests/data/xpcshellUtilsAUS.js
&#64;&#64; +2644,5 &#64;&#64;
<span class="quote">&gt; +
&gt; +  // Make sure the service from the previous test is already stopped.
&gt; +  waitForServiceStop(true);
&gt; +
&gt; +  // Prevent the cleanup function from begin run more than once</span >

Typo for &quot;being&quot;.

::: toolkit/mozapps/update/tests/unit_base_updater/invalidArgPatchDirPathTraversalFailure.js
&#64;&#64; +2,5 &#64;&#64;
<span class="quote">&gt; + * License, v. 2.0. If a copy of the MPL was not distributed with this
&gt; + * file, You can obtain one at <a rel="nofollow" href="http://mozilla.org/MPL/2.0/">http://mozilla.org/MPL/2.0/</a>.
&gt; + */
&gt; +
&gt; +/* Install directory path traversal failure test */</span >

This one is patch directory, not install directory.

::: toolkit/mozapps/update/tests/unit_base_updater/invalidArgWorkingDirPathLocalUNCFailure_win.js
&#64;&#64; +2,5 &#64;&#64;
<span class="quote">&gt; + * License, v. 2.0. If a copy of the MPL was not distributed with this
&gt; + * file, You can obtain one at <a rel="nofollow" href="http://mozilla.org/MPL/2.0/">http://mozilla.org/MPL/2.0/</a>.
&gt; + */
&gt; +
&gt; +/* Too long install directory path failure test */</span >

Working directory, not install directory, and UNC path, not overlong path.

::: toolkit/mozapps/update/tests/unit_service_updater/invalidArgWorkingDirPathLocalUNCFailureSvc_win.js
&#64;&#64; +2,5 &#64;&#64;
<span class="quote">&gt; + * License, v. 2.0. If a copy of the MPL was not distributed with this
&gt; + * file, You can obtain one at <a rel="nofollow" href="http://mozilla.org/MPL/2.0/">http://mozilla.org/MPL/2.0/</a>.
&gt; + */
&gt; +
&gt; +/* Too long install directory path failure test */</span >

Working directory, not install directory, and UNC path, not overlong path.

::: toolkit/mozapps/update/updater/updater.cpp
&#64;&#64; +2151,5 &#64;&#64;
<span class="quote">&gt;    NS_tchar filename[MAXPATHLEN] = {NS_T('\0')};
&gt;  #if defined(XP_WIN)
&gt;    // The temp file is not removed on failure since there is client code that
&gt;    // will remove it.
&gt; +  if (GetTempFileNameW(gPatchDirPath, L&quot;sta&quot;, 0, filename) == 0) {</span >

This may not quite work; GetTempFileName returns 0 and sets the last error to 267 (&quot;The directory name is invalid&quot;) when the first argument is a path that doesn't exist, even if it's a valid path. Might have to move the ensure_parent_dir call up here, or just check for that case.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8855119&amp;action=edit"
           title="patch rev1"
           class=""
        >Attachment #8855119</a> -
        Flags: review?(mhowell) &rarr; review+</div></div></div><div class="change-set" id="c21"><div class="comment" data-id="12212832" data-no="21"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-21" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550257" id="a1527085_280903"><img src="https://secure.gravatar.com/avatar/3f97cf08c1ecf35bc10896cf363773e5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550257" id="a1527085_280903"><a class="email " href="/user_profile?user_id=550257" > <span class="fna">Molly Howell (she/her) [:mhowell] (PTO until Nov 1)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-21"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-21" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c21">Comment 21</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-04-06 11:13 PDT" data-time="1491502394">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-21">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-21" data-comment-id="12212832">(In reply to Matt Howell [:mhowell] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Arbitrary code execution as SYSTEM using Updater to overwrite updater.ini"
   href="/show_bug.cgi?id=1342742#c20">comment #20</a>)
<span class="quote">&gt; ::: toolkit/mozapps/update/common/updatecommon.cpp
&gt; &#64;&#64; +192,5 &#64;&#64;
&gt; &gt; +  }
&gt; &gt; +
&gt; &gt; +  if (origFullPath[0] == NS_T('\\')) {
&gt; &gt; +    // Only allow UNC server share paths.
&gt; &gt; +    if (!PathIsUNCServerShareW(testPath)) {
&gt; 
&gt; Still need to fix this call; PathIsUNCServerShare rejects anything not of
&gt; the precise form &quot;\\server\share&quot; (including &quot;\\server\share\&quot; it turns
&gt; out), but we need to allow subdirectories of a share.</span >

Disregard this comment; I didn't notice we were calling PathIsUNCServerShare on the result of PathStripToRoot.</pre></div><div class="change-set" id="c22"><div class="comment" data-id="12215112" data-no="22"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-22" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_141755" id="a1527085_280903"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_141755" id="a1527085_280903"><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-22"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-22" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c22">Comment 22</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-04-07 00:58 PDT" data-time="1491551927">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-22">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8855689"
         class="attachment patch obsolete"
         data-id="8855689" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1342742">
      <meta itemprop="contentSize" content="93801">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8855689">
          <a class="link" href="attachment.cgi?id=8855689&amp;action=diff">
        <span id="att-8855689-description" itemprop="description">patch rev2</span></a> (obsolete)
        — <a href="attachment.cgi?id=8855689&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1342742&attachment=8855689">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-22" data-comment-id="12215112">Addressed comments except for the one noted in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Arbitrary code execution as SYSTEM using Updater to overwrite updater.ini"
   href="/show_bug.cgi?id=1342742#c21">comment #21</a> and
<span class="quote">&gt; ::: toolkit/mozapps/update/updater/updater.cpp
&gt; &#64;&#64; +2151,5 &#64;&#64;
&gt; &gt;    NS_tchar filename[MAXPATHLEN] = {NS_T('\0')};
&gt; &gt;  #if defined(XP_WIN)
&gt; &gt;    // The temp file is not removed on failure since there is client code that
&gt; &gt;    // will remove it.
&gt; &gt; +  if (GetTempFileNameW(gPatchDirPath, L&quot;sta&quot;, 0, filename) == 0) {
&gt; 
&gt; This may not quite work; GetTempFileName returns 0 and sets the last error
&gt; to 267 (&quot;The directory name is invalid&quot;) when the first argument is a path
&gt; that doesn't exist, even if it's a valid path. Might have to move the
&gt; ensure_parent_dir call up here, or just check for that case.</span >

This isn't needed since the file is written to the patch directory which must exist.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8855119&amp;action=edit"
           title="patch rev1"
           class=""
        >Attachment #8855119</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8855689&amp;action=edit"
           title="patch rev2"
           class=""
        >Attachment #8855689</a> -
        Flags: review+</div></div></div><div class="change-set" id="c23"><div class="comment" data-id="12215117" data-no="23"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-23" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_141755" id="a1527085_280903"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_141755" id="a1527085_280903"><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-23"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-23" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c23">Comment 23</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-04-07 01:04 PDT" data-time="1491552245">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-23">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-23" data-comment-id="12215117">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8855689" name="attach_8855689" title="patch rev2">attachment 8855689</a> <a href="/attachment.cgi?id=8855689&amp;action=edit" title="patch rev2">[details]</a> <a href="/attachment.cgi?id=8855689&amp;action=diff" title="patch rev2">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1342742&amp;attachment=8855689'>[review]</a>
patch rev2

[Security approval request comment]
How easily could an exploit be constructed based on the patch?
The steps to reproduce this are fairly complicated (see <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Arbitrary code execution as SYSTEM using Updater to overwrite updater.ini"
   href="/show_bug.cgi?id=1342742#c0">comment #0</a>) so in my opinion it wouldn't be that easy,

Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
I don't think it paints a bulls-eye on the security problem though the checks do give a starting point on what to go after.

Which older supported branches are affected by this flaw?
All

If not all supported branches, which bug introduced the flaw?
N/A

Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
It should be fairly simple and no more risky than this patch.

How likely is this patch to cause regressions; how much testing does it need?
As with all significant app update patches I definitely want this to bake on Nightly for a couple of days. Also, if it is ok with you I'd like to land this on the oak branch and test it before landing it on Nightly.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8855689&amp;action=edit"
           title="patch rev2"
           class=""
        >Attachment #8855689</a> -
        Flags: sec-approval?</div></div></div><div class="change-set" id="c24"><div class="comment" data-id="12215175" data-no="24"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-24" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a1527085_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_280903" id="a1527085_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-24"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-24" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c24">Comment 24</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-04-07 01:30 PDT" data-time="1491553808">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-24">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-24" data-comment-id="12215175">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8855689" name="attach_8855689" title="patch rev2">attachment 8855689</a> <a href="/attachment.cgi?id=8855689&amp;action=edit" title="patch rev2">[details]</a> <a href="/attachment.cgi?id=8855689&amp;action=diff" title="patch rev2">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1342742&amp;attachment=8855689'>[review]</a>
patch rev2

We're about to make release builds for 53. There is no way this can go in yet. I'm giving it sec-approval+ to land on *May 2*, two weeks into the next cycle, and not before then.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8855689&amp;action=edit"
           title="patch rev2"
           class=""
        >Attachment #8855689</a> -
        Flags: sec-approval? &rarr; sec-approval+</div></div></div><div class="change-set" id="a3456675_280903"><div class="change" id="aa3456675_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a3456675_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a3456675_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a3456675_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a3456675_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#a3456675_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-04-07 01:30 PDT" data-time="1491553819">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: [checkin on May 2]</div></div></div><div class="change-set" id="c25"><div class="comment" data-id="12215186" data-no="25"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-25" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_141755" id="a3456675_280903"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_141755" id="a3456675_280903"><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-25"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-25" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c25">Comment 25</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-04-07 01:34 PDT" data-time="1491554050">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-25">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-25" data-comment-id="12215186">Al, are you ok with my landing this on oak so I can test it there first and if so do you have a date constraint for my landing it. I won't reference this bug or give any details in the message used to land it there?

(In reply to Robert Strong [:rstrong] (use needinfo to contact me) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Arbitrary code execution as SYSTEM using Updater to overwrite updater.ini"
   href="/show_bug.cgi?id=1342742#c23">comment #23</a>)
&lt;snip&gt;
<span class="quote">&gt; As with all significant app update patches I definitely want this to bake on
&gt; Nightly for a couple of days. Also, if it is ok with you I'd like to land
&gt; this on the oak branch and test it before landing it on Nightly.</span ></pre><div class="activity"><div class="change">Flags: needinfo?(abillings)</div></div></div><div class="change-set" id="c26"><div class="comment" data-id="12215269" data-no="26"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-26" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a3456675_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_280903" id="a3456675_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-26"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-26" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c26">Comment 26</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-04-07 02:02 PDT" data-time="1491555742">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-26">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-26" data-comment-id="12215269">Yes, Rob, I think that would be ok and you more than have my trust on these things. :-)</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(abillings)</span></div></div></div><div class="change-set" id="c27"><div class="comment" data-id="12218002" data-no="27"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-27" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_141755" id="a3456675_280903"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_141755" id="a3456675_280903"><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-27"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-27" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c27">Comment 27</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-04-07 20:15 PDT" data-time="1491621352">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-27">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8856070"
         class="attachment patch obsolete"
         data-id="8856070" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1342742">
      <meta itemprop="contentSize" content="31477">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8856070">
          <a class="link" href="attachment.cgi?id=8856070&amp;action=diff">
        <span id="att-8856070-description" itemprop="description">patch for checkin - client code</span></a> (obsolete)
        — <a href="attachment.cgi?id=8856070&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1342742&attachment=8856070">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-27" data-comment-id="12218002">I'm separating the client code from the test code since I will be changing the test code before this bug can land.</pre></div><div class="change-set" id="c28"><div class="comment" data-id="12218004" data-no="28"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-28" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_141755" id="a3456675_280903"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_141755" id="a3456675_280903"><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-28"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-28" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c28">Comment 28</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-04-07 20:16 PDT" data-time="1491621381">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-28">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8856071"
         class="attachment patch obsolete"
         data-id="8856071" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1342742-tests">
      <meta itemprop="contentSize" content="61866">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8856071">
          <a class="link" href="attachment.cgi?id=8856071&amp;action=diff">
        <span id="att-8856071-description" itemprop="description">patch for checkin - test code</span></a> (obsolete)
        — <a href="attachment.cgi?id=8856071&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1342742&attachment=8856071">Splinter Review</a>
      </div>
    </div></div><div class="change-set" id="c29"><div class="comment" data-id="12231555" data-no="29"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-29" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_141755" id="a3456675_280903"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_141755" id="a3456675_280903"><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-29"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-29" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c29">Comment 29</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-04-12 22:29 PDT" data-time="1492061369">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-29">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8857761"
         class="attachment patch obsolete"
         data-id="8857761" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1342742">
      <meta itemprop="contentSize" content="30688">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8857761">
          <a class="link" href="attachment.cgi?id=8857761&amp;action=diff">
        <span id="att-8857761-description" itemprop="description">patch for m-c after bug 1156046</span></a> (obsolete)
        — <a href="attachment.cgi?id=8857761&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1342742&attachment=8857761">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-29" data-comment-id="12231555">Just removes gonk changes</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8857761&amp;action=edit"
           title="patch for m-c after bug 1156046"
           class=""
        >Attachment #8857761</a> -
        Flags: review+</div></div></div><div class="change-set" id="c30"><div class="comment" data-id="12231559" data-no="30"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-30" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_141755" id="a3456675_280903"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_141755" id="a3456675_280903"><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-30"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-30" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c30">Comment 30</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-04-12 22:31 PDT" data-time="1492061503">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-30">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8857762"
         class="attachment patch obsolete"
         data-id="8857762" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1342742-tests">
      <meta itemprop="contentSize" content="52893">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8857762">
          <a class="link" href="attachment.cgi?id=8857762&amp;action=diff">
        <span id="att-8857762-description" itemprop="description">test patch after bug 1354850</span></a> (obsolete)
        — <a href="attachment.cgi?id=8857762&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1342742&attachment=8857762">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-30" data-comment-id="12231559">Hi Matt, I'd like you to take another look at the test code changed quite a bit after <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Use updater to run general app update service tests and remove gonk test code"
   href="/show_bug.cgi?id=1354850">bug 1354850</a>.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8856071&amp;action=edit"
           title="patch for checkin - test code"
           class=""
        >Attachment #8856071</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8857762&amp;action=edit"
           title="test patch after bug 1354850"
           class=""
        >Attachment #8857762</a> -
        Flags: review?(mhowell)</div></div></div><div class="change-set" id="c31"><div class="comment" data-id="12231963" data-no="31"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-31" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_141755" id="a3456675_280903"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_141755" id="a3456675_280903"><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-31"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-31" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c31">Comment 31</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-04-13 01:13 PDT" data-time="1492071211">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-31">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-31" data-comment-id="12231963">New try push
<a rel="nofollow" href="https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=b328911803230005f7f1fe1d3cb879b05f06c355">https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=b328911803230005f7f1fe1d3cb879b05f06c355</a></pre></div><div class="change-set" id="c32"><div class="comment" data-id="12232072" data-no="32"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-32" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_141755" id="a3456675_280903"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_141755" id="a3456675_280903"><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-32"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-32" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c32">Comment 32</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-04-13 01:46 PDT" data-time="1492073192">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-32">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-32" data-comment-id="12232072">Previous push had errors unrelated to this bug... new try push
<a rel="nofollow" href="https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=b1c866057101c1b9e7c0ce62fe526fcf54acbd1d">https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=b1c866057101c1b9e7c0ce62fe526fcf54acbd1d</a></pre></div><div class="change-set" id="a4000053_550257"><div class="change" id="aa4000053_550257">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550257" id="a4000053_550257"><img src="https://secure.gravatar.com/avatar/3f97cf08c1ecf35bc10896cf363773e5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_550257" id="a4000053_550257"><a class="email " href="/user_profile?user_id=550257" > <span class="fna">Molly Howell (she/her) [:mhowell] (PTO until Nov 1)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a4000053_550257"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a4000053_550257">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#a4000053_550257">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-04-13 08:26 PDT" data-time="1492097197">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8857762&amp;action=edit"
           title="test patch after bug 1354850"
           class=""
        >Attachment #8857762</a> -
        Flags: review?(mhowell) &rarr; review+</div></div></div><div class="change-set" id="a4031535_141755"><div class="change" id="aa4031535_141755">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_141755" id="a4031535_141755"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_141755" id="a4031535_141755"><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a4031535_141755"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a4031535_141755">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#a4031535_141755">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-04-13 17:11 PDT" data-time="1492128679">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Blocks: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Arbitrary file &quot;deletion&quot; as SYSTEM with maintenance service"
   href="/show_bug.cgi?id=1336964">CVE-2017-7767</a></div></div></div><div class="change-set" id="c33"><div class="comment" data-id="12240968" data-no="33"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-33" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_141755" id="a4031535_141755"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_141755" id="a4031535_141755"><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-33"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-33" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c33">Comment 33</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-04-17 11:58 PDT" data-time="1492455485">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-33">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-33" data-comment-id="12240968">Per <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Arbitrary code execution as SYSTEM using Updater to overwrite updater.ini"
   href="/show_bug.cgi?id=1342742#c24">comment #24</a> this won't make it into 53</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox52&amp;o1=isnotempty">status-firefox52</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox52&amp;o1=equals&amp;v1=%3F">?</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox52&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox53&amp;o1=isnotempty">status-firefox53</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox53&amp;o1=equals&amp;v1=%3F">?</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox53&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox55&amp;o1=isnotempty">status-firefox55</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox55&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=isnotempty">status-firefox-esr45</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=equals&amp;v1=%3F">?</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr52&amp;o1=isnotempty">status-firefox-esr52</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox_esr52&amp;o1=equals&amp;v1=%3F">?</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr52&amp;o1=equals&amp;v1=affected">affected</a></div></div></div><div class="change-set" id="c34"><div class="comment" data-id="12253064" data-no="34"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-34" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_141755" id="a4031535_141755"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_141755" id="a4031535_141755"><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-34"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-34" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c34">Comment 34</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-04-20 16:46 PDT" data-time="1492731988">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-34">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-34" data-comment-id="12253064">Talked with abillings and I'll land this on June 28 so it can bake a few days before uplifing.</pre><div class="activity"><div class="change">Whiteboard: [checkin on May 2] &rarr; [checkin on June 28]</div></div></div><div class="change-set" id="c35"><div class="comment" data-id="12253071" data-no="35"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-35" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_141755" id="a4031535_141755"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_141755" id="a4031535_141755"><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-35"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-35" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c35">Comment 35</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-04-20 16:47 PDT" data-time="1492732079">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-35">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-35" data-comment-id="12253071">I meant 4/28</pre><div class="activity"><div class="change">Whiteboard: [checkin on June 28] &rarr; [checkin on 4/28]</div></div></div><div class="change-set" id="c36"><div class="comment" data-id="12257793" data-no="36"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-36" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_141755" id="a4031535_141755"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_141755" id="a4031535_141755"><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-36"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-36" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c36">Comment 36</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-04-23 14:00 PDT" data-time="1492981229">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-36">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8860766"
         class="attachment patch obsolete"
         data-id="8860766" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1342742">
      <meta itemprop="contentSize" content="31878">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8860766">
          <a class="link" href="attachment.cgi?id=8860766&amp;action=diff">
        <span id="att-8860766-description" itemprop="description">patch for m-c checkin - client code</span></a> (obsolete)
        — <a href="attachment.cgi?id=8860766&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1342742&attachment=8860766">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-36" data-comment-id="12257793">Forgot to cleanup the Mac command line when elevated.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8855689&amp;action=edit"
           title="patch rev2"
           class=""
        >Attachment #8855689</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8856070&amp;action=edit"
           title="patch for checkin - client code"
           class=""
        >Attachment #8856070</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8857761&amp;action=edit"
           title="patch for m-c after bug 1156046"
           class=""
        >Attachment #8857761</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8860766&amp;action=edit"
           title="patch for m-c checkin - client code"
           class=""
        >Attachment #8860766</a> -
        Flags: review?(mhowell)</div></div></div><div class="change-set" id="a4960573_550257"><div class="change" id="aa4960573_550257">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550257" id="a4960573_550257"><img src="https://secure.gravatar.com/avatar/3f97cf08c1ecf35bc10896cf363773e5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_550257" id="a4960573_550257"><a class="email " href="/user_profile?user_id=550257" > <span class="fna">Molly Howell (she/her) [:mhowell] (PTO until Nov 1)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a4960573_550257"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a4960573_550257">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#a4960573_550257">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-04-24 11:15 PDT" data-time="1493057717">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8860766&amp;action=edit"
           title="patch for m-c checkin - client code"
           class=""
        >Attachment #8860766</a> -
        Flags: review?(mhowell) &rarr; review+</div></div></div><div class="change-set" id="c37"><div class="comment" data-id="12276347" data-no="37"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-37" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_141755" id="a4960573_550257"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_141755" id="a4960573_550257"><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-37"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-37" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c37">Comment 37</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-04-28 16:42 PDT" data-time="1493422926">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-37">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8863067"
         class="attachment patch"
         data-id="8863067" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1342742">
      <meta itemprop="contentSize" content="31878">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8863067">
          <a class="link" href="attachment.cgi?id=8863067&amp;action=diff">
        <span id="att-8863067-description" itemprop="description">pushed client patch for m-c</span></a>
        — <a href="attachment.cgi?id=8863067&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1342742&attachment=8863067">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-37" data-comment-id="12276347"><a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/702bca2e601ff093c89c4e3d9deac35bf28d2550">https://hg.mozilla.org/integration/mozilla-inbound/rev/702bca2e601ff093c89c4e3d9deac35bf28d2550</a></pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8860766&amp;action=edit"
           title="patch for m-c checkin - client code"
           class=""
        >Attachment #8860766</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8863067&amp;action=edit"
           title="pushed client patch for m-c"
           class=""
        >Attachment #8863067</a> -
        Flags: review+</div></div></div><div class="change-set" id="c38"><div class="comment" data-id="12276350" data-no="38"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-38" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_141755" id="a4960573_550257"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_141755" id="a4960573_550257"><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-38"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-38" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c38">Comment 38</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-04-28 16:43 PDT" data-time="1493422992">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-38">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8863068"
         class="attachment patch"
         data-id="8863068" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1342742-tests">
      <meta itemprop="contentSize" content="53552">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8863068">
          <a class="link" href="attachment.cgi?id=8863068&amp;action=diff">
        <span id="att-8863068-description" itemprop="description">pushed test patch for m-c</span></a>
        — <a href="attachment.cgi?id=8863068&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1342742&attachment=8863068">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-38" data-comment-id="12276350">I have patches for beta and esr that I will attach soon.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8857762&amp;action=edit"
           title="test patch after bug 1354850"
           class=""
        >Attachment #8857762</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8863068&amp;action=edit"
           title="pushed test patch for m-c"
           class=""
        >Attachment #8863068</a> -
        Flags: review+</div></div></div><div class="change-set" id="a5325872_141755"><div class="change" id="aa5325872_141755">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_141755" id="a5325872_141755"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_141755" id="a5325872_141755"><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a5325872_141755"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a5325872_141755">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#a5325872_141755">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-04-28 16:43 PDT" data-time="1493423016">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: <span class="activity-deleted">[checkin on 4/28]</span></div></div></div><div class="change-set" id="c39"><div class="comment" data-id="12276352" data-no="39"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-39" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_141755" id="a5325872_141755"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_141755" id="a5325872_141755"><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-39"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-39" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c39">Comment 39</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-04-28 16:44 PDT" data-time="1493423069">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-39">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-39" data-comment-id="12276352">(In reply to Robert Strong [:rstrong] (use needinfo to contact me) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Arbitrary code execution as SYSTEM using Updater to overwrite updater.ini"
   href="/show_bug.cgi?id=1342742#c38">comment #38</a>)
<span class="quote">&gt; Created <span class=""><a href="/attachment.cgi?id=8863068" name="attach_8863068" title="pushed test patch for m-c">attachment 8863068</a> <a href="/attachment.cgi?id=8863068&amp;action=edit" title="pushed test patch for m-c">[details]</a> <a href="/attachment.cgi?id=8863068&amp;action=diff" title="pushed test patch for m-c">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1342742&amp;attachment=8863068'>[review]</a>
&gt; pushed test patch for m-c
&gt; 
&gt; I have patches for beta and esr that I will attach soon.</span >
Note: pushed both patches to mozilla-inbound
<a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/5b52d7c9212cfbf5266b0d1f0b8d35ba694a06a4">https://hg.mozilla.org/integration/mozilla-inbound/rev/5b52d7c9212cfbf5266b0d1f0b8d35ba694a06a4</a></pre></div><div class="change-set" id="c40"><div class="comment" data-id="12277158" data-no="40"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-40" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_141755" id="a5325872_141755"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_141755" id="a5325872_141755"><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-40"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-40" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c40">Comment 40</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-04-29 14:18 PDT" data-time="1493500712">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-40">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-40" data-comment-id="12277158">Merged to mozilla-central
<a rel="nofollow" href="https://hg.mozilla.org/mozilla-central/rev/702bca2e601f">https://hg.mozilla.org/mozilla-central/rev/702bca2e601f</a>
<a rel="nofollow" href="https://hg.mozilla.org/mozilla-central/rev/5b52d7c9212c">https://hg.mozilla.org/mozilla-central/rev/5b52d7c9212c</a>

I have patches for beta and esr that I will attach soon.</pre><div class="activity"><div class="change">Status: ASSIGNED &rarr; RESOLVED</div><div class="change">Closed: <span class="rel-time" title="2017-04-29 14:18 PDT" data-time="1493500712">5 years ago</span></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox55&amp;o1=isnotempty">status-firefox55</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox55&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox55&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">Flags: in-testsuite+</div><div class="change">Resolution: --- &rarr; FIXED</div><div class="change">Target Milestone: --- &rarr; mozilla55</div></div></div><div class="change-set" id="a5563396_1689"><div class="change" id="aa5563396_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a5563396_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a5563396_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a5563396_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a5563396_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#a5563396_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-05-01 10:42 PDT" data-time="1493660540">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: sec-bounty? &rarr; sec-bounty+</div></div></div><div class="change-set" id="c41"><div class="comment" data-id="12280481" data-no="41"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-41" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_141755" id="a5563396_1689"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_141755" id="a5563396_1689"><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-41"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-41" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c41">Comment 41</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-05-01 17:18 PDT" data-time="1493684304">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-41">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8863532"
         class="attachment patch"
         data-id="8863532" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1342742">
      <meta itemprop="contentSize" content="31879">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8863532">
          <a class="link" href="attachment.cgi?id=8863532&amp;action=diff">
        <span id="att-8863532-description" itemprop="description">client patch for beta</span></a>
        — <a href="attachment.cgi?id=8863532&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1342742&attachment=8863532">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-41" data-comment-id="12280481">Approval Request Comment
[Feature/Bug causing the regression]:
Original maintenance service implementation
[User impact if declined]:
They will continue to be vulnerable to this local exploit
[Is this code covered by automated tests?]: Yes
[Has the fix been verified in Nightly?]:
I have verified it on Nightly
[Needs manual test from QE? If yes, steps to reproduce]:
No
[List of other uplifts needed for the feature/fix]:
N/A
[Is the change risky?]:
No more so than any other similar change to app update.
[Why is the change risky/not risky?]:
It validates the command line arguments used with the updater are what should be sent by Firefox. It is possible though not likely that some system might somehow munge the arguments. 
[String changes made/needed]:
None</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8863532&amp;action=edit"
           title="client patch for beta"
           class=""
        >Attachment #8863532</a> -
        Flags: review+</div><div class="change">
        <a href="/attachment.cgi?id=8863532&amp;action=edit"
           title="client patch for beta"
           class=""
        >Attachment #8863532</a> -
        Flags: approval-mozilla-beta?</div></div></div><div class="change-set" id="c42"><div class="comment" data-id="12280483" data-no="42"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-42" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_141755" id="a5563396_1689"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_141755" id="a5563396_1689"><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-42"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-42" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c42">Comment 42</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-05-01 17:19 PDT" data-time="1493684366">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-42">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-42" data-comment-id="12280483">Forgot to mention that I have also built beta with this patch and all update tests pass.</pre></div><div class="change-set" id="c43"><div class="comment" data-id="12280492" data-no="43"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-43" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_141755" id="a5563396_1689"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_141755" id="a5563396_1689"><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-43"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-43" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c43">Comment 43</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-05-01 17:26 PDT" data-time="1493684790">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-43">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8863534"
         class="attachment patch"
         data-id="8863534" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1342742-tests">
      <meta itemprop="contentSize" content="68305">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8863534">
          <a class="link" href="attachment.cgi?id=8863534&amp;action=diff">
        <span id="att-8863534-description" itemprop="description">test patch for beta</span></a>
        — <a href="attachment.cgi?id=8863534&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1342742&attachment=8863534">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-43" data-comment-id="12280492">This also needs the test changes from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Use updater to run general app update service tests and remove gonk test code"
   href="/show_bug.cgi?id=1354850">bug 1354850</a></pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8863534&amp;action=edit"
           title="test patch for beta"
           class=""
        >Attachment #8863534</a> -
        Flags: review+</div></div></div><div class="change-set" id="c44"><div class="comment" data-id="12280500" data-no="44"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-44" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_141755" id="a5563396_1689"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_141755" id="a5563396_1689"><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-44"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-44" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c44">Comment 44</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-05-01 17:30 PDT" data-time="1493685052">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-44">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8863537"
         class="attachment patch"
         data-id="8863537" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1342742">
      <meta itemprop="contentSize" content="38952">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8863537">
          <a class="link" href="attachment.cgi?id=8863537&amp;action=diff">
        <span id="att-8863537-description" itemprop="description">client patch for esr52</span></a>
        — <a href="attachment.cgi?id=8863537&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1342742&attachment=8863537">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-44" data-comment-id="12280500">[Approval Request Comment]
If this is not a sec:{high,crit} bug, please state case for ESR consideration:
User impact if declined: 
They will continue to be vulnerable to this local exploit
Fix Landed on Version:
55
Risk to taking this patch (and alternatives if risky): 
No more so than any other similar change to app update. It validates the command line arguments used with the updater are what should be sent by Firefox. It is possible though not likely that some system might somehow munge the arguments. 
String or UUID changes made by this patch: 
None

I have also built esr52 with this patch and all update tests pass.

See <a rel="nofollow" href="https://wiki.mozilla.org/Release_Management/ESR_Landing_Process">https://wiki.mozilla.org/Release_Management/ESR_Landing_Process</a> for more info.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8863537&amp;action=edit"
           title="client patch for esr52"
           class=""
        >Attachment #8863537</a> -
        Flags: review+</div><div class="change">
        <a href="/attachment.cgi?id=8863537&amp;action=edit"
           title="client patch for esr52"
           class=""
        >Attachment #8863537</a> -
        Flags: approval-mozilla-esr52?</div></div></div><div class="change-set" id="c45"><div class="comment" data-id="12280504" data-no="45"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-45" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_141755" id="a5563396_1689"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_141755" id="a5563396_1689"><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-45"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-45" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c45">Comment 45</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-05-01 17:31 PDT" data-time="1493685112">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-45">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8863539"
         class="attachment patch"
         data-id="8863539" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1342742-tests">
      <meta itemprop="contentSize" content="60676">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8863539">
          <a class="link" href="attachment.cgi?id=8863539&amp;action=diff">
        <span id="att-8863539-description" itemprop="description">test patch for esr52</span></a>
        — <a href="attachment.cgi?id=8863539&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1342742&attachment=8863539">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-45" data-comment-id="12280504">This also needs the test changes from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Use updater to run general app update service tests and remove gonk test code"
   href="/show_bug.cgi?id=1354850">bug 1354850</a></pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8863539&amp;action=edit"
           title="test patch for esr52"
           class=""
        >Attachment #8863539</a> -
        Flags: review+</div></div></div><div class="change-set" id="c46"><div class="comment" data-id="12285316" data-no="46"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-46" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a5563396_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a5563396_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-46"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-46" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c46">Comment 46</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-05-02 16:39 PDT" data-time="1493768396">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-46">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-46" data-comment-id="12285316">A local privilege escalation like this is more relevant to enterprise users than typical home users, and thus appropriate for ESR.</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=isnotempty">status-firefox-esr45</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr52&amp;o1=isnotempty">tracking-firefox-esr52</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox_esr52&amp;o1=equals&amp;v1=54%2B">54+</a></div></div></div><div class="change-set" id="a5720130_1689"><div class="change" id="aa5720130_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a5720130_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a5720130_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a5720130_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a5720130_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#a5720130_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-05-03 06:14 PDT" data-time="1493817274">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: toolkit-core-security &rarr; core-security-release</div></div></div><div class="change-set" id="c47"><div class="comment" data-id="12290466" data-no="47"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-47" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_538805" id="a5720130_1689"><img src="https://secure.gravatar.com/avatar/9bd092443d615af36b31b04e81ad7806?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_538805" id="a5720130_1689"><a class="email disabled" href="/user_profile?user_id=538805" > <span class="fna">Ritu Kothari (:ritu) (Inactive, please n-i to RyanVM, jcristau, or pascal)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-47"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-47" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c47">Comment 47</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-05-03 13:49 PDT" data-time="1493844581">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-47">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-47" data-comment-id="12290466">Comment on <span class=""><a href="/attachment.cgi?id=8863532" name="attach_8863532" title="client patch for beta">attachment 8863532</a> <a href="/attachment.cgi?id=8863532&amp;action=edit" title="client patch for beta">[details]</a> <a href="/attachment.cgi?id=8863532&amp;action=diff" title="client patch for beta">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1342742&amp;attachment=8863532'>[review]</a>
client patch for beta

Sec-high, Beta54+</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8863532&amp;action=edit"
           title="client patch for beta"
           class=""
        >Attachment #8863532</a> -
        Flags: approval-mozilla-beta? &rarr; approval-mozilla-beta+</div></div></div><div class="change-set" id="c48"><div class="comment" data-id="12290469" data-no="48"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-48" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_538805" id="a5720130_1689"><img src="https://secure.gravatar.com/avatar/9bd092443d615af36b31b04e81ad7806?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_538805" id="a5720130_1689"><a class="email disabled" href="/user_profile?user_id=538805" > <span class="fna">Ritu Kothari (:ritu) (Inactive, please n-i to RyanVM, jcristau, or pascal)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-48"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-48" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c48">Comment 48</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-05-03 13:50 PDT" data-time="1493844602">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-48">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-48" data-comment-id="12290469">Comment on <span class=""><a href="/attachment.cgi?id=8863537" name="attach_8863537" title="client patch for esr52">attachment 8863537</a> <a href="/attachment.cgi?id=8863537&amp;action=edit" title="client patch for esr52">[details]</a> <a href="/attachment.cgi?id=8863537&amp;action=diff" title="client patch for esr52">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1342742&amp;attachment=8863537'>[review]</a>
client patch for esr52

Sec-high, ESR52.2+</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8863537&amp;action=edit"
           title="client patch for esr52"
           class=""
        >Attachment #8863537</a> -
        Flags: approval-mozilla-esr52? &rarr; approval-mozilla-esr52+</div></div></div><div class="change-set" id="c49"><div class="comment" data-id="12290867" data-no="49"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-49" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_141755" id="a5720130_1689"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_141755" id="a5720130_1689"><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-49"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-49" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c49">Comment 49</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-05-03 16:41 PDT" data-time="1493854862">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-49">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-49" data-comment-id="12290867">Pushed to mozilla-beta
<a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-beta/rev/f7d1810de3816ea87d58c3828640f9939862ee2e">https://hg.mozilla.org/releases/mozilla-beta/rev/f7d1810de3816ea87d58c3828640f9939862ee2e</a></pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox54&amp;o1=isnotempty">status-firefox54</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox54&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox54&amp;o1=equals&amp;v1=fixed">fixed</a></div></div></div><div class="change-set" id="c50"><div class="comment" data-id="12290869" data-no="50"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-50" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_141755" id="a5720130_1689"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_141755" id="a5720130_1689"><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-50"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-50" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c50">Comment 50</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-05-03 16:41 PDT" data-time="1493854892">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-50">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-50" data-comment-id="12290869">(In reply to Robert Strong [:rstrong] (use needinfo to contact me) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Arbitrary code execution as SYSTEM using Updater to overwrite updater.ini"
   href="/show_bug.cgi?id=1342742#c49">comment #49</a>)
<span class="quote">&gt; Pushed to mozilla-beta
&gt; <a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-beta/rev/">https://hg.mozilla.org/releases/mozilla-beta/rev/</a>
&gt; f7d1810de3816ea87d58c3828640f9939862ee2e</span >
Also, the test patch
<a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-beta/rev/bbcddab3288afe64402e5093cf7786fe152bb4e7">https://hg.mozilla.org/releases/mozilla-beta/rev/bbcddab3288afe64402e5093cf7786fe152bb4e7</a></pre></div><div class="change-set" id="c51"><div class="comment" data-id="12291286" data-no="51"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-51" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_141755" id="a5720130_1689"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_141755" id="a5720130_1689"><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-51"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-51" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c51">Comment 51</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-05-03 21:11 PDT" data-time="1493871101">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-51">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-51" data-comment-id="12291286">Pushed to mozilla-esr52
<a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-esr52/rev/61066f53c6e0234c2f55ae43329d4b8d2b7b3b57">https://hg.mozilla.org/releases/mozilla-esr52/rev/61066f53c6e0234c2f55ae43329d4b8d2b7b3b57</a>
<a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-esr52/rev/c15b2a5abf1ca5c4169ef6340be56a25b5ec4f45">https://hg.mozilla.org/releases/mozilla-esr52/rev/c15b2a5abf1ca5c4169ef6340be56a25b5ec4f45</a></pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr52&amp;o1=isnotempty">status-firefox-esr52</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox_esr52&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr52&amp;o1=equals&amp;v1=fixed">fixed</a></div></div></div><div class="change-set" id="c52"><div class="comment" data-id="12294656" data-no="52"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-52" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_488993" id="a5720130_1689"><img src="https://secure.gravatar.com/avatar/42f2a9436bbaefa7e0028e214f2b9350?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_488993" id="a5720130_1689"><a class="email " href="/user_profile?user_id=488993" > <span class="fna">Andrei Vaida [:avaida]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-52"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-52" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#c52">Comment 52</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-05-04 21:48 PDT" data-time="1493959726">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-52">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-52" data-comment-id="12294656">(In reply to Robert Strong PTO 5/5 [:rstrong] (use needinfo to contact me) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Arbitrary code execution as SYSTEM using Updater to overwrite updater.ini"
   href="/show_bug.cgi?id=1342742#c41">comment #41</a>)
<span class="quote">&gt; [Is this code covered by automated tests?]: Yes
&gt; [Has the fix been verified in Nightly?]:
&gt; I have verified it on Nightly
&gt; [Needs manual test from QE? If yes, steps to reproduce]:
&gt; No</span >

Setting qe-verify- based on Robert's assessment on manual testing needs and the fact that this fix has automated coverage.</pre><div class="activity"><div class="change">Flags: qe-verify-</div></div></div><div class="change-set" id="a8612322_280903"><div class="change" id="aa8612322_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a8612322_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a8612322_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a8612322_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a8612322_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#a8612322_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-06-05 17:37 PDT" data-time="1496709466">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: [adv-main54+][adv-esr52.2+]</div></div></div><div class="change-set" id="a8682935_280903"><div class="change" id="aa8682935_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a8682935_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a8682935_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a8682935_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a8682935_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#a8682935_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-06-06 13:14 PDT" data-time="1496780079">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Alias: CVE-2017-7766</div></div></div><div class="change-set" id="a20973683_1689"><div class="change" id="aa20973683_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a20973683_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a20973683_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a20973683_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a20973683_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#a20973683_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-10-26 19:20 PDT" data-time="1509070827">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: <span class="activity-deleted">core-security-release</span></div></div></div><div class="change-set" id="a99316154_456485"><div class="change" id="aa99316154_456485">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_456485" id="a99316154_456485"><img src="https://secure.gravatar.com/avatar/24794cf906e308aee53a5173f6f1ed09?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_456485" id="a99316154_456485"><a class="email " href="/user_profile?user_id=456485" > <span class="fna">Stephen A Pohl [:spohl]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a99316154_456485"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a99316154_456485">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1342742#a99316154_456485">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-04-20 13:08 PDT" data-time="1587413298">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Regressions: <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox bounces in Dock once and won't open"
   href="/show_bug.cgi?id=1574139">1574139</a></div></div></div><div id="new-comment-notice">
          You need to <a href="/show_bug.cgi?id=1342742&amp;GoAheadAndLogIn=1">log in</a>
          before you can comment on or make changes to this bug.
        </div>



<div id="bottom-actions">
  <div id="bottom-right-actions">
    <button type="button" id="top-btn" class="secondary" aria-label="Go to Page Top">Top &uarr;</button>
  </div>
</div></div> 
</main> 
</div> 


</body>
</html>