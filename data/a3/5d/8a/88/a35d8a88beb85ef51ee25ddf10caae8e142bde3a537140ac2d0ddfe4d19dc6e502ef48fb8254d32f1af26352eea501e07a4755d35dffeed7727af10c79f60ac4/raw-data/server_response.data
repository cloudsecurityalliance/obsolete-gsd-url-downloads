<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
  <title>datasette-auth-passwords - a plugin for Datasette</title>
  <link rel="stylesheet" type="text/css" href="/static/site.css">
<script defer data-domain="datasette.io" src="https://plausible.io/js/plausible.js"></script>


<style>
pre {
    white-space: pre-wrap;
}
.plugin {
    border: 1px solid #ccc;
    margin-bottom: 1em;
    border-radius: 10px;
    background-color: white;
    padding: 1em;
}
.plugin article h1:first-child {
    margin-top: 0;
}
.plugin-downloads-and-stars span {
    position: relative;
    top: 0.2em;
}
svg.octicon-link {
    margin-right: 0.3em;
    opacity: 0.8;
    height: 15px;
    width: 15px;
}
</style>
<script async defer src="https://buttons.github.io/buttons.js"></script>
<link rel="stylesheet" type="text/css" href="/static/github-light.css">

</head>
<body class="page ">
  <header>
    <nav>
      <a href="/"><img class="datasette-logo-small" src="/static/datasette-logo.svg" alt="Datasette"></a>
      <ul>
    <li><a href="/for">Uses</a></li>
    <li><a href="https://docs.datasette.io/en/stable/"><span class="hide-on-narrow">Documentation</span> <span class="show-on-narrow">Docs</span></a></li>
    <li><a href="/examples">Examples</a></li>
    <li><a href="/plugins">Plugins</a></li>
    <li><a href="/tools">Tools</a></li>
    <li><a href="/news">News</a></li>
</ul>
    </nav>
  </header>
  <main>
    <div class="content">
      

<p class="breadcrumbs"><a href="/plugins">Plugins</a> &gt; datasette-auth-passwords</p> 

<h1>datasette-auth-passwords <span class="by"> by simonw</span>
    <a href="https://github.com/simonw/datasette-auth-passwords">
        <svg xmlns="http://www.w3.org/2000/svg"
            aria-label="GitHub" role="img"
            style="width: 0.8em; margin-left: 0.5em;"
            viewBox="0 0 512 512"><rect
            width="512" height="512"
            rx="15%"
            fill="#1B1817"/>
        <path fill="#fff" d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/>
        </svg>
    </a>
</h1>

<p class="plugin-downloads-and-stars">
    123 downloads this week &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    <a class="github-button" href="https://github.com/simonw/datasette-auth-passwords" data-icon="octicon-star" data-show-count="true" aria-label="Star simonw/datasette-auth-passwords on GitHub">Star</a>
</p>




    <h2>README</h2>
    <div class="plugin">
    <div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><h1><a id="user-content-datasette-auth-passwords" class="anchor" aria-hidden="true" href="#user-content-datasette-auth-passwords"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>datasette-auth-passwords</h1>
<p><a href="https://pypi.org/project/datasette-auth-passwords/" rel="nofollow"><img src="https://camo.githubusercontent.com/6069887e91e8732eb602a4f9f0294b4fb71295c8f3fd82133d21bdb062694a96/68747470733a2f2f696d672e736869656c64732e696f2f707970692f762f6461746173657474652d617574682d70617373776f7264732e737667" alt="PyPI" data-canonical-src="https://img.shields.io/pypi/v/datasette-auth-passwords.svg" style="max-width:100%;"></a>
<a href="https://github.com/simonw/datasette-auth-passwords/releases"><img src="https://camo.githubusercontent.com/826bb037366364dfa68ab57355193eb9ded8ecb7d137c62e66d8b9502fe9039f/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f762f72656c656173652f73696d6f6e772f6461746173657474652d617574682d70617373776f7264733f6c6162656c3d6368616e67656c6f67" alt="Changelog" data-canonical-src="https://img.shields.io/github/v/release/simonw/datasette-auth-passwords?label=changelog" style="max-width:100%;"></a>
<a href="https://github.com/simonw/datasette-auth-passwords/blob/master/LICENSE"><img src="https://camo.githubusercontent.com/1698104e976c681143eb0841f9675c6f802bb7aa832afc0c7a4e719b1f3cf955/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6c6963656e73652d417061636865253230322e302d626c75652e737667" alt="License" data-canonical-src="https://img.shields.io/badge/license-Apache%202.0-blue.svg" style="max-width:100%;"></a></p>
<p>Datasette plugin for authenticating access using passwords</p>
<h2><a id="user-content-installation" class="anchor" aria-hidden="true" href="#user-content-installation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Installation</h2>
<p>Install this plugin in the same environment as Datasette.</p>
<div class="snippet-clipboard-content position-relative" data-snippet-clipboard-copy-content="$ pip install datasette-auth-passwords
"><pre><code>$ pip install datasette-auth-passwords
</code></pre></div>
<h2><a id="user-content-demo" class="anchor" aria-hidden="true" href="#user-content-demo"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Demo</h2>
<p>A demo of this plugin is running at <a href="https://datasette-auth-passwords-demo.datasette.io/" rel="nofollow">https://datasette-auth-passwords-demo.datasette.io/</a></p>
<p>The demo is configured to show the <code>public.db</code> database to everyone, but the <code>private.db</code> database only to logged in users.</p>
<p>You can log in at <a href="https://datasette-auth-passwords-demo.datasette.io/-/login" rel="nofollow">https://datasette-auth-passwords-demo.datasette.io/-/login</a> with username <code>root</code> and password <code>password!</code>.</p>
<h2><a id="user-content-usage" class="anchor" aria-hidden="true" href="#user-content-usage"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Usage</h2>
<p>This plugin works based on a list of username/password accounts that are hard-coded into the plugin configuration.</p>
<p>First, you'll need to create a password hash. You can do this using the tool located at <code>/-/password-tool</code> when the plugin is installed, or you can try use the hosted version of that tool at <a href="https://datasette-auth-passwords-demo.datasette.io/-/password-tool" rel="nofollow">https://datasette-auth-passwords-demo.datasette.io/-/password-tool</a></p>
<p>Now add the following to your <code>metadata.json</code>:</p>
<div class="highlight highlight-source-json position-relative" data-snippet-clipboard-copy-content="{
    &quot;plugins&quot;: {
        &quot;datasette-auth-passwords&quot;: {
            &quot;someusername_password_hash&quot;: {
                &quot;$env&quot;: &quot;PASSWORD_HASH_1&quot;
            }
        }
    }
}
"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>plugins<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>datasette-auth-passwords<span class="pl-pds">"</span></span>: {
            <span class="pl-s"><span class="pl-pds">"</span>someusername_password_hash<span class="pl-pds">"</span></span>: {
                <span class="pl-s"><span class="pl-pds">"</span>$env<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>PASSWORD_HASH_1<span class="pl-pds">"</span></span>
            }
        }
    }
}</pre></div>
<p>The password hash can now be specified in an environment variable when you run Datasette. You can do that like so:</p>
<div class="snippet-clipboard-content position-relative" data-snippet-clipboard-copy-content="PASSWORD_HASH_1='pbkdf2_sha256$...' \
    datasette -m metadata.json
"><pre><code>PASSWORD_HASH_1='pbkdf2_sha256$...' \
    datasette -m metadata.json
</code></pre></div>
<p>Be sure to use single quotes here otherwise the <code>$</code> symbols in the password hash may be incorrectly interpreted by your shell.</p>
<p>You will now be able to log in to your instance using the form at <code>/-/login</code> with <code>someusername</code> as the username and the password that you used to create your hash as the password.</p>
<p>You can include as many accounts as you like in the configuration, each with different usernames.</p>
<h3><a id="user-content-specifying-actors" class="anchor" aria-hidden="true" href="#user-content-specifying-actors"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Specifying actors</h3>
<p>By default, a logged in user will result in an <a href="https://datasette.readthedocs.io/en/stable/authentication.html#actors" rel="nofollow">actor block</a> that just contains their username:</p>
<div class="highlight highlight-source-json position-relative" data-snippet-clipboard-copy-content="{
    &quot;id&quot;: &quot;someusername&quot;
}
"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>id<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>someusername<span class="pl-pds">"</span></span>
}</pre></div>
<p>You can customize the actor that will be used for a username by including an <code>"actors"</code> configuration block, like this:</p>
<div class="highlight highlight-source-json position-relative" data-snippet-clipboard-copy-content="{
    &quot;plugins&quot;: {
        &quot;datasette-auth-passwords&quot;: {
            &quot;someusername_password_hash&quot;: {
                &quot;$env&quot;: &quot;PASSWORD_HASH_1&quot;
            },
            &quot;actors&quot;: {
                &quot;someusername&quot;: {
                    &quot;id&quot;: &quot;someusername&quot;,
                    &quot;name&quot;: &quot;Some user&quot;
                }
            }
        }
    }
}
"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>plugins<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>datasette-auth-passwords<span class="pl-pds">"</span></span>: {
            <span class="pl-s"><span class="pl-pds">"</span>someusername_password_hash<span class="pl-pds">"</span></span>: {
                <span class="pl-s"><span class="pl-pds">"</span>$env<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>PASSWORD_HASH_1<span class="pl-pds">"</span></span>
            },
            <span class="pl-s"><span class="pl-pds">"</span>actors<span class="pl-pds">"</span></span>: {
                <span class="pl-s"><span class="pl-pds">"</span>someusername<span class="pl-pds">"</span></span>: {
                    <span class="pl-s"><span class="pl-pds">"</span>id<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>someusername<span class="pl-pds">"</span></span>,
                    <span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>Some user<span class="pl-pds">"</span></span>
                }
            }
        }
    }
}</pre></div>
<h3><a id="user-content-http-basic-authentication-option" class="anchor" aria-hidden="true" href="#user-content-http-basic-authentication-option"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>HTTP Basic authentication option</h3>
<p>This plugin defaults to implementing login using an HTML form that sets a signed authentication cookie.</p>
<p>You can alternatively configure it to use <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Authentication#basic_authentication_scheme" rel="nofollow">HTTP Basic authentication</a> instead.</p>
<p>Do this by adding <code>"http_basic_auth": true</code> to the <code>datasette-auth-passwords</code> block in your plugin configuration.</p>
<p>This option introduces the following behaviour:</p>
<ul>
<li>Account usernames and passwords are configured in the same way as form-based authentication</li>
<li>Every page within Datasette - even pages that normally do not use authentication, such as static assets - will display a browser login prompt</li>
<li>Users will be unable to log out without closing their browser entirely</li>
</ul>
<p>There is a demo of this mode at <a href="https://datasette-auth-passwords-http-basic-demo.datasette.io/" rel="nofollow">https://datasette-auth-passwords-http-basic-demo.datasette.io/</a> - sign in with username <code>root</code> and password <code>password!</code></p>
<h3><a id="user-content-using-with-datasette-publish" class="anchor" aria-hidden="true" href="#user-content-using-with-datasette-publish"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Using with datasette publish</h3>
<p>If you are publishing data using a <a href="https://datasette.readthedocs.io/en/stable/publish.html#datasette-publish" rel="nofollow">datasette publish</a> command you can use the <code>--plugin-secret</code> option to securely configure your password hashes (see <a href="https://datasette.readthedocs.io/en/stable/plugins.html#secret-configuration-values" rel="nofollow">secret configuration values</a>).</p>
<p>You would run the command something like this:</p>
<div class="snippet-clipboard-content position-relative" data-snippet-clipboard-copy-content="datasette publish cloudrun mydatabase.db \
    --install datasette-auth-passwords \
    --plugin-secret datasette-auth-passwords root_password_hash 'pbkdf2_sha256$...' \
    --service datasette-auth-passwords-demo
"><pre><code>datasette publish cloudrun mydatabase.db \
    --install datasette-auth-passwords \
    --plugin-secret datasette-auth-passwords root_password_hash 'pbkdf2_sha256$...' \
    --service datasette-auth-passwords-demo
</code></pre></div>
<p>This will allow you to log in as username <code>root</code> using the password that you used to create the hash.</p>
<h2><a id="user-content-development" class="anchor" aria-hidden="true" href="#user-content-development"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Development</h2>
<p>To set up this plugin locally, first checkout the code. Then create a new virtual environment:</p>
<div class="snippet-clipboard-content position-relative" data-snippet-clipboard-copy-content="cd datasette-auth-passwords
python3 -mvenv venv
source venv/bin/activate
"><pre><code>cd datasette-auth-passwords
python3 -mvenv venv
source venv/bin/activate
</code></pre></div>
<p>Or if you are using <code>pipenv</code>:</p>
<div class="snippet-clipboard-content position-relative" data-snippet-clipboard-copy-content="pipenv shell
"><pre><code>pipenv shell
</code></pre></div>
<p>Now install the dependencies and tests:</p>
<div class="snippet-clipboard-content position-relative" data-snippet-clipboard-copy-content="pip install -e '.[test]'
"><pre><code>pip install -e '.[test]'
</code></pre></div>
<p>To run the tests:</p>
<div class="snippet-clipboard-content position-relative" data-snippet-clipboard-copy-content="pytest
"><pre><code>pytest
</code></pre></div>
</article></div>
    </div>



    </div>
  </main>
  <footer>Powered by <a href="https://datasette.io/" title="Datasette v">Datasette</a> &middot; <a href="https://github.com/simonw/datasette.io">How this site works</a></footer>
</body>
</html>