<!DOCTYPE html>
<html lang="en">
  <head>
    <title>702252 &ndash; (CVE-2019-19882) &lt;sys-apps/shadow-4.8-r3[pam] installs setuid binaries with permissive pam configuration allowing user/group management without authentication (CVE-2019-19882)</title>

      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<link href="data/assets/1dee87cdc229fb032852e53a39a3c8b5.css?1635279638" rel="stylesheet" type="text/css">



    
<script type="text/javascript" src="data/assets/a7c2f3a028f17a9aa60f56dc9d6e732d.js?1635279638"></script>

    <script type="text/javascript">
    <!--
        YAHOO.namespace('bugzilla');
        YAHOO.util.Event.addListener = function (el, sType, fn, obj, overrideContext) {
               if ( ("onpagehide" in window || YAHOO.env.ua.gecko) && sType === "unload") { sType = "pagehide"; };
               var capture = ((sType == "focusin" || sType == "focusout") && !YAHOO.env.ua.ie) ? true : false;
               return this._addListener(el, this._getType(sType), fn, obj, overrideContext, capture);
         };
        if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
            YAHOO.util.Event._simpleRemove(window, "unload", 
                                           YAHOO.util.Event._unload);
        }
        
        function unhide_language_selector() { 
            YAHOO.util.Dom.removeClass(
                'lang_links_container', 'bz_default_hidden'
            ); 
        } 
        YAHOO.util.Event.onDOMReady(unhide_language_selector);

        
        var BUGZILLA = {
            param: {
                cookiepath: '\/',
                maxusermatches: 1000
            },
            constant: {
                COMMENT_COLS: 80
            },
            string: {
                

                attach_desc_required:
                    "You must enter a Description for this attachment.",
                component_required:
                    "You must select a Component for this bug.",
                description_required:
                    "You must enter a Description for this bug.",
                short_desc_required:
                    "You must enter a Summary for this bug.",
                version_required:
                    "You must select a Version for this bug."
            }
              , api_token: ''
        };

    if (history && history.replaceState) {
      if(!document.location.href.match(/show_bug\.cgi/)) {
        history.replaceState( null,
                             "702252 – (CVE-2019-19882) \x3csys-apps\/shadow-4.8-r3[pam] installs setuid binaries with permissive pam configuration allowing user\/group management without authentication (CVE-2019-19882)",
                             "show_bug.cgi?id=702252" );
        document.title = "702252 – (CVE-2019-19882) \x3csys-apps\/shadow-4.8-r3[pam] installs setuid binaries with permissive pam configuration allowing user\/group management without authentication (CVE-2019-19882)";
      }
      if (document.location.href.match(/show_bug\.cgi\?.*list_id=/)) {
        var href = document.location.href;
        href = href.replace(/[\?&]+list_id=(\d+|cookie)/, '');
        history.replaceState(null, "702252 – (CVE-2019-19882) \x3csys-apps\/shadow-4.8-r3[pam] installs setuid binaries with permissive pam configuration allowing user\/group management without authentication (CVE-2019-19882)", href);
      }
    }
    YAHOO.util.Event.onDOMReady(function() {
      initDirtyFieldTracking();

    });
    // -->
    </script>
<script type="text/javascript" src="data/assets/daf5e0fb6826e6a35280e622913f0c4a.js?1635279638"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Gentoo's Bugzilla" href="./search_plugin.cgi">
    <link rel="shortcut icon" href="images/favicon.ico"><script language="JavaScript" src="extensions/Gentoo/web/gentoo.js"></script>
  </head>

  <body 
        class="bugs-gentoo-org
                 bz_bug
                 bz_status_RESOLVED
                 bz_product_Gentoo_Security
                 bz_component_Vulnerabilities
                 bz_bug_702252 yui-skin-sam">
<div id="gentoo-bar">
	<a href="/" title="Go to the Gentoo Bugzilla homepage" class="home-link">
		<img src="extensions/Gentoo/web/gentoo_org.png" alt="Gentoo Websites Logo" />
	</a>

	<div>
		Go to: 
		<a href="https://www.gentoo.org/">Gentoo Home</a>
		<a href="https://www.gentoo.org/support/documentation/">Documentation</a>
		<a href="https://forums.gentoo.org/">Forums</a>
		<a href="https://www.gentoo.org/get-involved/mailing-lists/">Lists</a>
		<a href="/" class="active">Bugs</a>
		<a href="https://planet.gentoo.org/">Planet</a>
		<a href="https://www.gentoo.org/inside-gentoo/stores/">Store</a>
		<a href="https://wiki.gentoo.org/">Wiki</a>
		<strong><a href="https://www.gentoo.org/downloads/">Get Gentoo!</a></strong>
	</div>
</div>

  <div id="header"><div id="banner">
  </div>

    <div id="titles">
      <span id="title">Gentoo's Bugzilla &ndash; Bug&nbsp;702252</span>

        <span id="subtitle" class="subheader">&lt;sys-apps/shadow-4.8-r3[pam] installs setuid binaries with permissive pam configuration allowing user/group management without authentication (CVE-2019-19882)</span>

        <span id="information" class="header_addl_info">Last modified: 2020-09-15 09:17:16 UTC node [gannet]</span>
    </div>


    <div id="common_links"><ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi?format=guided">New</a>&ndash;<a href="enter_bug.cgi">[Ex]</a></li>
  <li><span class="separator">| </span><a href="describecomponents.cgi">Browse</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>
  <li><span class="separator">| </span><a href="https://wiki.gentoo.org/wiki/Foundation:Privacy_Policy">Privacy Policy</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_top" name="no_redirect" value="0">
    <script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_top");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_top" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_top"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li>
      <span class="separator">| </span>
        <a href="request.cgi">Requests</a></li>


  <li>
        <span class="separator">| </span>
        <a href="https://bugzilla.readthedocs.org/en/5.0/using/understanding.html" target="_blank">Help</a>
      </li>
    
      <li id="new_account_container_top">
        <span class="separator">| </span>
        <a href="createaccount.cgi">New&nbsp;Account</a>
      </li>

    <li id="mini_login_container_top">
  <span class="separator">| </span>
  <a id="login_link_top" href="show_bug.cgi?id=702252&amp;GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('_top')">Log In</a>

  <form action="show_bug.cgi?id=702252" method="POST"
        class="mini_login bz_default_hidden"
        id="mini_login_top">
    <input id="Bugzilla_login_top" required
           name="Bugzilla_login" class="bz_login"
        type="email" placeholder="Email Address">
    <input class="bz_password" name="Bugzilla_password" type="password"
           id="Bugzilla_password_top" required
           placeholder="Password">
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
            id="log_in_top">
    <a href="#" onclick="return hide_mini_login_form('_top')">[x]</a>
  </form>
</li>


  <li id="forgot_container_top">
    <span class="separator">| </span>
    <a id="forgot_link_top" href="show_bug.cgi?id=702252&amp;GoAheadAndLogIn=1#forgot"
       onclick="return show_forgot_form('_top')">Forgot Password</a>
    <form action="token.cgi" method="post" id="forgot_form_top"
          class="mini_forgot bz_default_hidden">
      <label for="login_top">Login:</label>
      <input name="loginname" size="20" id="login_top" required
          type="email" placeholder="Your Email Address">
      <input id="forgot_button_top" value="Reset Password" type="submit">
      <input type="hidden" name="a" value="reqpw">
      <input type="hidden" id="token_top" name="token"
             value="1635619192-095rno0vxncNaatOtRvq5byqRjNxw2X_mNEke3T7PKU">
      <a href="#" onclick="return hide_forgot_form('_top')">[x]</a>
    </form>
  </li>
</ul>
    </div>
  </div>

  <div id="bugzilla-body"><!--<div style="border: 1px solid #ebccd1; background-color: #f2dede; color: #a94442; padding: 0.4em; margin-bottom: 0.4em;">critical goes here ...</div>-->
<!--<div id="message">
Bugzilla DB migration completed. Please report issues to Infra team via email via infra@gentoo.org or IRC
</div>-->


<script type="text/javascript">
<!--

//-->
</script>

<form name="changeform" id="changeform" method="post" action="process_bug.cgi">

  <input type="hidden" name="delta_ts" value="2020-09-15 09:17:16">
  <input type="hidden" name="id" value="702252">
  <input type="hidden" name="token" value="1635619192-UChMk9cKUEqRQuuBvLGJZBObNmESMbrXofVEZMZI204">
<div class="bz_short_desc_container edit_form">
     <a href="show_bug.cgi?id=702252"><b>Bug&nbsp;702252</b></a> <span id="summary_container" class="bz_default_hidden">
        (<span id="alias_nonedit_display">CVE-2019-19882</span>)
      - <span id="short_desc_nonedit_display">&lt;sys-apps/shadow-4.8-r3[pam] installs setuid binaries with permissive pam configuration allowing user/group management without authentication (CVE-2019-19882)</span>
     </span>

    <div id="summary_input"><span class="field_label "
    id="field_label_short_desc">


  <a 
      title="The bug summary is a short sentence which succinctly describes what the bug is about."
      class="field_help_link"
      href="page.cgi?id=fields.html#short_desc"
  >Summary:</a>

</span><span title="&lt;sys-apps/shadow-4.8-r3[pam] installs setuid binaries with permissive pam configuration allowing user/group management without authentication (CVE-2019-19882)">&lt;sys-apps/shadow-4.8-r3[pam] installs setuid binaries with permissive pam con...
        </span>
    </div>
  </div>
  <script type="text/javascript">
    hideEditableField('summary_container',
                      'summary_input',
                      'summary_edit_action',
                      'short_desc',
                      '\x3csys-apps\/shadow-4.8-r3[pam] installs setuid binaries with permissive pam configuration allowing user\/group management without authentication (CVE-2019-19882)' );
  </script>
  <table class="edit_form">
    <tr>
      
      <td id="bz_show_bug_column_1" class="bz_show_bug_column">     
        <table>
          <tr>
    <th class="field_label">
      <a href="page.cgi?id=fields.html#bug_status">Status</a>:
    </th>
    <td id="bz_field_status">
      <span id="static_bug_status">RESOLVED
          FIXED
      </span>
    </td>
  </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_alias">


  <a 
      title="A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla."
      class="field_help_link"
      href="page.cgi?id=fields.html#alias"
  >Alias:</a>

</th>
    <td>CVE-2019-19882
    </td>
  </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_product">


  <a 
      title="Bugs are categorised into Products and Components."
      class="field_help_link"
      href="describecomponents.cgi"
  >Product:</a>

</th>
  <td class="field_value "
      id="field_container_product" >Gentoo Security

</td>
    </tr>

    
    <tr class="bz_default_hidden"><th class="field_label "
    id="field_label_classification">


  <a 
      title="Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation."
      class="field_help_link"
      href="page.cgi?id=fields.html#classification"
  >Classification:</a>

</th>
  <td class="field_value "
      id="field_container_classification" >Unclassified

</td>
    </tr>
        
    
    
    <tr><th class="field_label "
    id="field_label_component">


  <a 
      title="Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list."
      class="field_help_link"
      href="describecomponents.cgi?product=Gentoo Security"
  >Component:</a>

</th>
  <td class="field_value "
      id="field_container_component" >Vulnerabilities

  (<a href="buglist.cgi?component=Vulnerabilities&amp;product=Gentoo%20Security&amp;bug_status=__open__"
      target="_blank">show other bugs</a>)
</td>
    </tr>
        
    
        
    <tr><th class="field_label "
    id="field_label_rep_platform">


  <a 
      title="The hardware platform the bug was observed on. Note: When searching, selecting the option &quot;All&quot; only finds bugs whose value for this field is literally the word &quot;All&quot;."
      class="field_help_link"
      href="page.cgi?id=fields.html#rep_platform"
  >Hardware:</a>

</th>
      <td class="field_value">All
        Linux
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          
          <tr>
      <th class="field_label">
        <label  accesskey="i">
          <a href="page.cgi?id=fields.html#importance"><u>I</u>mportance</a></label>:
      </th>
      <td>Normal
       normal<span id="votes_container">
    (<a href="page.cgi?id=voting/user.html&amp;bug_id=702252#vote_702252">vote</a>)
  </span>
      </td>
    </tr>
          
          <tr><th class="field_label "
    id="field_label_assigned_to">


  <a 
      title="The person in charge of resolving the bug."
      class="field_help_link"
      href="page.cgi?id=fields.html#assigned_to"
  >Assignee:</a>

</th>
      <td><span class="vcard"><span class="fn">Gentoo Security</span>
</span>
      </td>
    </tr>

    <script type="text/javascript">
      assignToDefaultOnChange(['product', 'component'],
        'security\x40gentoo.org',
        '');
    </script>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr><th class="field_label "
    id="field_label_bug_file_loc">


  <a 
      title="Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen."
      class="field_help_link"
      href="page.cgi?id=fields.html#bug_file_loc"
  >URL:</a>

</th>
    <td>
      <span id="bz_url_input_area">
      </span>
    </td>
  </tr>

    <tr><th class="field_label "
    id="field_label_status_whiteboard">


  <a 
      title="Each bug has a free-form single line text entry box for adding tags and status information."
      class="field_help_link"
      href="page.cgi?id=fields.html#status_whiteboard"
  >Whiteboard:</a>

</th><td>B2 [glsa+ cve]  
  </td>
    </tr>

    <tr><th class="field_label "
    id="field_label_keywords">


  <a 
      title="You can add keywords from a defined list to bugs, in order to easily identify and group them."
      class="field_help_link"
      href="describekeywords.cgi"
  >Keywords:</a>

</th>
  <td class="field_value "
      id="field_container_keywords" >

</td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>

          
<tr><th class="field_label "
    id="field_label_dependson">


  <a 
      title="The bugs listed here must be resolved before this bug can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#dependson"
  >Depends on:</a>

</th>

  <td>
    <span id="dependson_input_area">
    </span>

  </td>
  </tr>
  
  <tr><th class="field_label "
    id="field_label_blocked">


  <a 
      title="This bug must be resolved before the bugs listed in this field can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#blocked"
  >Blocks:</a>

</th>

  <td>
    <span id="blocked_input_area">
    </span>

  </td>
  </tr>
          
        </table>
      </td>
      <td>
        <div class="bz_column_spacer">&nbsp;</div>
      </td>
      
      <td id="bz_show_bug_column_2" class="bz_show_bug_column">
        <table>
        <tr>
    <th class="field_label">
      Reported:
    </th>
    <td>2019-12-07 17:37 UTC by <span class="vcard"><span class="fn">Michael Weiser</span>
</span>
    </td>
  </tr>
  
  <tr>
    <th class="field_label">
      Modified:
    </th>
    <td>2020-09-15 09:17 UTC
      (<a href="show_activity.cgi?id=702252">History</a>)
    </td>
  
  </tr>
<tr>
      <th class="field_label">
        <label  accesskey="a">
          CC List:
        </label>
      </th>
      <td>2 
          users
          <span id="cc_edit_area_showhide_container" class="bz_default_hidden">
            (<a href="#" id="cc_edit_area_showhide">show</a>)
          </span>
        <div id="cc_edit_area">
          <br>
            <select id="cc" multiple="multiple" size="5" >
                <option value="base-system">base-system</option>
                <option value="joakim.tjernlund">joakim.tjernlund</option>
            </select>
        </div>
          <script type="text/javascript">
            hideEditableField( 'cc_edit_area_showhide_container', 
                               'cc_edit_area', 
                               'cc_edit_area_showhide', 
                               '', 
                               '');  
          </script>
      </td>
    </tr>

<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_see_also">


  <a 
      title="This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields."
      class="field_help_link"
      href="page.cgi?id=fields.html#see_also"
  >See Also:</a>

</th>
  <td class="field_value "
      id="field_container_see_also" ><ul class="bug_urls">
          <li><a href="https://github.com/gentoo/gentoo/pull/14032">https://github.com/gentoo/gentoo/pull/14032</a>
          </li>
          <li><a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED FIXED - &gt;=sys-apps/shadow-4.8-r3: chpasswd: (user root) pam_chauthtok() failed, error:"
   href="show_bug.cgi?id=712372">712372</a>
          </li></ul>

</td>
    </tr> 
<tr>
      <th class="field_label "
    id="field_label_cf_stabilisation_atoms">


  <a 
      title="Contains a list of packages (and optionally, architectures) to keyword or stabilize. One fully qualified package per line, optionally followed by a space-delimited list of architectures for that package."
      class="field_help_link"
      href="page.cgi?id=fields.html#cf_stabilisation_atoms"
  >Package list:</a>

</th>
  <td class="field_value "
      id="field_container_cf_stabilisation_atoms" >
      <div class="uneditable_textarea">sys-apps/shadow-4.8-r4</div>

</td>
    </tr>
    <tr>
      <th class="field_label "
    id="field_label_cf_runtime_testing_required">


  <a 
      title="Indicate if runtime testing is required for this stabilisation request, or if it is sufficient to stabilised with a build/tests/qa test."
      class="field_help_link"
      href="page.cgi?id=fields.html#cf_runtime_testing_required"
  >Runtime testing required:</a>

</th>
  <td class="field_value "
      id="field_container_cf_runtime_testing_required" >---

</td>
    </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>

<tr>
      <th class="field_label">
        <label>Flags:</label>
      </th>
      <td><span title="NATTkA bot">nattka</span>:
      <span class="nowrap">sanity-check-</span><br>
      </td>
    </tr>

        </table>
      </td>
    </tr>
    <tr>
      <td colspan="3">
          <hr id="bz_top_half_spacer">
      </td>
    </tr>
  </table>

  <table id="bz_big_form_parts">
  <tr>
  <td>

    
<script type="text/javascript">
<!--
function toggle_display(link) {
    var table = document.getElementById("attachment_table");
    var view_all = document.getElementById("view_all");
    var hide_obsolete_url_parameter = "&hide_obsolete=1";
    // Store current height for scrolling later
    var originalHeight = table.offsetHeight;
    var rows = YAHOO.util.Dom.getElementsByClassName(
        'bz_tr_obsolete', 'tr', table);

    for (var i = 0; i < rows.length; i++) {
        bz_toggleClass(rows[i], 'bz_default_hidden');
    }

    if (YAHOO.util.Dom.hasClass(rows[0], 'bz_default_hidden')) {
        link.innerHTML = "Show Obsolete";
        view_all.href = view_all.href + hide_obsolete_url_parameter 
    }
    else {
        link.innerHTML = "Hide Obsolete";
        view_all.href = view_all.href.replace(hide_obsolete_url_parameter,"");
    }

    var newHeight = table.offsetHeight;
    // This scrolling makes the window appear to not move at all.
    window.scrollBy(0, newHeight - originalHeight);

    return false;
}
//-->
</script>

<br>
<table id="attachment_table">
  <tr id="a0">
    <th colspan="3" class="left">
      Attachments
    </th>
  </tr>



  <tr class="bz_attach_footer">
    <td colspan="3">
        <a href="attachment.cgi?bugid=702252&amp;action=enter">Add an attachment</a>
        (proposed patch, testcase, etc.)
    </td>
  </tr>
</table>
<br>
<div id="add_comment" class="bz_section_additional_comments">
      <table>
        <tr>
          <td>
            <fieldset>
              <legend>Note</legend>
              You need to
              <a href="show_bug.cgi?id=702252&amp;GoAheadAndLogIn=1">log in</a>
              before you can comment on or make changes to this bug.
            </fieldset>
          </td>
        </tr> 
      </table>
  </div>
  </td>
  <td>
  </td>
  </tr></table>

  
  <div id="comments"><script src="js/comments.js?1635279621" type="text/javascript">
</script>

<script type="text/javascript">
<!--
  /* Adds the reply text to the 'comment' textarea */
  function replyToComment(id, real_id, name) {
      var prefix = "(In reply to " + name + " from comment #" + id + ")\n";
      var replytext = "";
        /* pre id="comment_name_N" */
        var text_elem = document.getElementById('comment_text_'+id);
        var text = getText(text_elem);
        replytext = prefix + wrapReplyText(text);


      /* <textarea id="comment"> */
      var textarea = document.getElementById('comment');
      if (textarea.value != replytext) {
          textarea.value += replytext;
      }

      textarea.focus();
  } 
//-->
</script>


<!-- This auto-sizes the comments and positions the collapse/expand links 
     to the right. -->
<table class="bz_comment_table">
<tr>
<td>
<div id="c0" class="bz_comment bz_first_comment">

      <div class="bz_first_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c0">Description</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Michael Weiser</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2019-12-07 17:37:35 UTC
        </span>

      </div>




<pre class="bz_comment_text">Merging sys-apps/shadow-4.8-r1[pam] yields a number of setuid binaries in /usr/sbin:

 15518409     76 -rws--x--x   1 root     root        76840 Dec  7 17:56 /usr/sbin/groupdel
 15518431     88 -rws--x--x   1 root     root        89224 Dec  7 17:56 /usr/sbin/userdel
 15518154     60 -rws--x--x   1 root     root        59912 Dec  7 17:56 /usr/sbin/chgpasswd
 15518419     84 -rws--x--x   1 root     root        85160 Dec  7 17:56 /usr/sbin/groupmod
 15518411     84 -rws--x--x   1 root     root        85224 Dec  7 17:56 /usr/sbin/groupadd
 15518426     96 -rws--x--x   1 root     root        97416 Dec  7 17:56 /usr/sbin/newusers
 15518429    132 -rws--x--x   1 root     root       131312 Dec  7 17:56 /usr/sbin/useradd
 15518407     60 -rws--x--x   1 root     root        59976 Dec  7 17:56 /usr/sbin/chpasswd
 15518428    132 -rws--x--x   1 root     root       131088 Dec  7 17:56 /usr/sbin/usermod

It also installs respective pam.d configuration files which contain pam_permit for auth:

#%PAM-1.0 
  
auth       sufficient   pam_rootok.so
auth       required             pam_permit.so

account    include              system-auth

password   required             pam_permit.so

This effectively allows any system user to use these programs without any authentication to create, modify and delete any other system user or group:

[m&#64;n] id
uid=1000(m) gid=1000(m) groups=1000(m),10(wheel),78(kvm),103(power)
[m&#64;n] ls -lad /home/foo
ls: cannot access '/home/foo': No such file or directory
[m&#64;n] grep ^foo /etc/passwd
[m&#64;n] useradd -m foo
[m&#64;n] ls -lad /home/foo
drwxr-xr-x 3 foo foo 4096 Dec  7 18:02 /home/foo
[m&#64;n] grep ^foo /etc/passwd
foo:x:1001:1001::/home/foo:/bin/bash
[m&#64;n] 

As is to be expected, removing pam_permit disables that function:

[m&#64;n] ls -la /usr/sbin/useradd
-rws--x--x 1 root root 131312 Dec  7 17:56 /usr/sbin/useradd
[m&#64;n] grep permit /etc/pam.d/useradd
#auth       required		pam_permit.so
password   required		pam_permit.so
[m&#64;n] useradd -m bar
useradd: PAM: Permission denied

So does removing the setuid bit:

[m&#64;n] ls -la /usr/sbin/useradd
-rwx--x--x 1 root root 131312 Dec  7 17:56 /usr/sbin/useradd
[m&#64;n] grep permit /etc/pam.d/useradd
auth       required		pam_permit.so
password   required		pam_permit.so
[m&#64;n] useradd -m bar
useradd: Permission denied.
useradd: cannot lock /etc/passwd; try again later.

&lt;=sys-apps/shadow-4.7-r2 installs the same permissive pam configs but no setuid binaries. It seems, this was broken in the upstream package and fixed in 4.8 as told by the ChangeLog:

2019-12-01  Serge Hallyn &lt;<a href="mailto:serge&#64;hallyn.com">serge&#64;hallyn.com</a>&gt;
  
        * Release 4.8
[...]
        * Fix failing chmod calls for suidubins
[...]

1. Whether the binaries are installed setuid is governed by configure flag --enable-account-tools-setuid. It is not explicitly governed by the ebuild. Its default is derived from whether --with-libpam is on. The ebuild has a $(use_with pam libpam) for that. USE flag pam is enabled in the default/linux profile and AFAICT only masked for uclibc profiles, thus very likely hitting a large number of people:

/usr/portage/profiles/default/linux/make.defaults:USE=&quot;berkdb crypt ipv6 ncurses nls pam readline ssl tcpd zlib&quot;

A stop-gap measure is to disable USE flag pam for sys-apps/shadow, effectively reverting to the state of sys-apps/shadow-4.7-r2: permissive pam configs but no setuid binaries to expoit them.

IMO USE flag pam should be masked for sys-apps/shadow globally so users can consciously opt in to having setuid binaries and PAM functionality in this sensitive area of system management.

2. The ebuild's pam configuration is too permissive. pam_permit should be removed for auth or (more explicitly) replaced with pam_deny. pam_rootok will still permit use by root. Other directives to open it up can and must be added by the consenting admin who knows what they're doing. The upstream source contains configs that look about right:

[m&#64;n:~/shadow-4.8] cat etc/pam.d/useradd
#%PAM-1.0
auth		sufficient	pam_rootok.so
account		required	pam_permit.so
password	include		system-auth

Reproducible: Always




Portage 2.3.81 (python 3.6.9-final-0, default/linux/amd64/17.1/desktop, gcc-9.2.0, glibc-2.30-r3, 5.4.1-gentoo x86_64)
=================================================================
System uname: <a href="mailto:Linux-5.4.1-gentoo-x86_64-Intel-R-_Core-TM-_i7-8565U_CPU_&#64;_1.80GHz-with-gentoo-2.6">Linux-5.4.1-gentoo-x86_64-Intel-R-_Core-TM-_i7-8565U_CPU_&#64;_1.80GHz-with-gentoo-2.6</a>
KiB Mem:    16112256 total,   4869956 free
KiB Swap:    8388604 total,   8323836 free
Timestamp of repository gentoo: Fri, 06 Dec 2019 18:00:02 +0000
Head commit of repository gentoo: 52e20370c0d974fb1452c29d755b738b6a8b0523
sh bash 5.0_p11
ld GNU ld (Gentoo 2.33.1 p1) 2.33.1
app-shells/bash:          5.0_p11::gentoo
dev-java/java-config:     2.2.0-r4::gentoo
dev-lang/perl:            5.30.1::gentoo
dev-lang/python:          2.7.17::gentoo, 3.6.9::gentoo
dev-util/cmake:           3.16.0::gentoo
sys-apps/baselayout:      2.6-r1::gentoo
sys-apps/sandbox:         2.18::gentoo
sys-devel/autoconf:       2.13-r1::gentoo, 2.69-r5::gentoo
sys-devel/automake:       1.16.1-r2::gentoo
sys-devel/binutils:       2.33.1::gentoo
sys-devel/gcc:            9.2.0-r2::gentoo
sys-devel/gcc-config:     2.1::gentoo
sys-devel/libtool:        2.4.6-r5::gentoo
sys-devel/make:           4.2.1-r4::gentoo
sys-kernel/linux-headers: 5.3-r1::gentoo (virtual/os-headers)
sys-libs/glibc:           2.30-r3::gentoo
Repositories:

gentoo
    location: /usr/portage
    sync-type: rsync
    sync-uri: rsync://rsync.gentoo.org/gentoo-portage
    priority: -1000
    sync-rsync-extra-opts: 
    sync-rsync-verify-metamanifest: yes
    sync-rsync-verify-jobs: 1
    sync-rsync-verify-max-age: 24

local
    location: /usr/local/portage
    masters: gentoo

ACCEPT_KEYWORDS=&quot;amd64 ~amd64&quot;
ACCEPT_LICENSE=&quot;&#64;FREE no-source-code SmartLabs freedist ISSL Atmel vlgothic quake1-textures CC-SA-1.0 BitstreamVera BAEKMUK LDP-1a man-pages mplus-fonts myspell-en_CA-KevinAtkinson UbuntuFontLicense-1.0 Texinfo-manual LDP-1 man-pages-posix wxWinFDL-3 CC-PD CC-BY-SA-1.0 man-pages-posix-2013 Unicode_Fonts_for_Ancient_Scripts MaxMind2 GPL-2+ GPL-1+ IPAfont FDL-1.1+ FDL-1.1 GPL-2 CC-BY-SA-4.0 OFL CC-BY-SA-2.0 CC-BY-2.5 Arphic GPL-3+ FDL-1.2+ CC-BY-SA-3.0 FDL-1.3 OFL-1.1 CC-BY-SA-2.5 GPL-1 OPL FDL-1.3+ FreeArt CC-BY-2.0 FDL-1.2 CC-BY-4.0 GPL-3 CC-BY-3.0 nethack BSD-2 EUPL-1.1 LGPL-3+ EPL-1.0 GPL-2+ LGPL-2.1+ GPL-1+ AGPL-3 IPAfont ISC AFL-3.0 Sleepycat W3C Artistic APSL-2 LGPL-3 MPL-1.0 GPL-2 LPPL-1.3c PSF-2 AGPL-3+ ZLIB Apache-1.1 OSL-2.1 Apache-2.0 PHP-3.01 EPL-2.0 QPL IBM Ms-PL MPL-2.0 APL-1.0 CDDL Watcom-1.0 LGPL-2.1 GPL-3+ wxWinLL-3 HPND ZPL NOSA CNRI OFL-1.1 LGPL-2+ BSD CPL-1.0 PHP-3 Boost-1.0 POSTGRESQL ECL-2.0 CPAL-1.0 GPL-3 MIT Artistic-2 MPL-1.1 UoI-NCSA EUPL-1.1 openssl EPL-1.0 NPL-1.1 BSD-4 AFL-3.0 APSL-2 MPL-1.0 Apache-1.1 gnuplot OSL-2.1 PHP-3.01 BSD-2 PYTHON IJG LGPL-3+ GPL-2+ LGPL-2.1+ gcc-runtime-library-exception-3.1 GPL-1+ GPL-2-with-font-exception AGPL-3 Ruby FTL ISC Sleepycat W3C Nokia-Qt-LGPL-Exception-1.1 GPL-2-with-linking-exception LGPL-3 metapackage PSF-2.4 GPL-2 GPL-3+-with-cuda-exception PSF-2 ZLIB AGPL-3+ GPL-2-with-classpath-exception Clear-BSD GPL-3+-with-opencl-exception Apache-2.0 qwt Apache-2.0-with-LLVM-exceptions SGI-B-2.0 libstdc++ Clarified-Artistic GPL-3+-with-opencl-openssl-exception GPL-3-with-font-exception GPL-3-with-openssl-exception GPL-2-with-exceptions libgcc GPL-2-with-MySQL-FLOSS-exception MPL-2.0 Unlicense LGPL-2 wxWinLL-3.1 public-domain Ruby-BSD LGPL-2.1 GPL-3+ PSF-2.2 HPND GPL-3+-with-cuda-openssl-exception unicode CeCILL-2 GPL-2+-with-openssl-exception LGPL-2-with-linking-exception PSF-2.3 vim Transmission-OpenSSL-exception WTFPL-2 ZPL OPENLDAP GPL-1 LGPL-2+ BSD Boost-1.0 tanuki-community CC0-1.0 LGPL-2.1-with-linking-exception LGPL-3-with-linking-exception ECL-2.0 MIT GPL-3 Artistic-2 UPX-exception UoI-NCSA EPL-2.0 OSL-1.1 QPL IBM Ms-PL CDDL Apache-1.0 Zend-2.0 OSL-2.0 QPL-1.0 CNRI AFL-2.1 CPL-1.0 LPPL-1.2 CPAL-1.0 MPL-1.1 TeX SMAIL icu LPPL-1.3b Time-modules imagemagick Khronos-CLHPP Subversion LambdaMOO rwpng tcp_wrappers_license totd Info-ZIP LIBGLOSS freetts XC Mail-Sendmail docbook FLEX ipadic alternate ElementTree lsof JNIC xbatt minpack Interbase-1.0 w3m Snd mm openafs-krb5-a the-Click-license psutils bea.ri.jsr173 eGenixPublic-1.1 CPL-0.5 SVFL Xdebug Crypt-IDEA Sendmail-Open-Source Ispell Old-MIT BEER-WARE AMPAS tcltk CeCILL-C rc torque-2.5 Flashpix FVWM Openwall rdisc LLVM-Grant shrimp TeX-other-free htmlc xtrs CMake mpich2 ngrep Time-Format scanlogd CDDL-Schily HTML-Tidy tablelist pngcrush CNRI-QUIXOTE-2.4 dom4j SSLeay URT libmng CRACKLIB iASL otter Sendmail DUMB-0.9.3 flexmock VTK regexp-UofT matplotlib MIT-with-advertising x2x boehm-gc Emacs FLTK ipx-utils bufexplorer.vim PHP-2.02 netcat gsm FastCGI gd perforce tm-align photopc libpng buddy repoze BSD-with-attribution NEWLIB IDPL BZIP2 ZSH CAOSL BSD-1 xvt CDDL-1.1 libtiff File-MMagic ErlPL-1.1 xboing inner-net NCSA-HDF Toyoda Princeton RSA JOVE feh SNIA LPPL-1.3 DES Mini-XML Allegro symlinks AIFFWriter.m PCRE pngnq UCAR-Unidata canfep JDOM libpng2 ipw3945 ipw2100-fw qlogic-fibre-channel-firmware ipw2200-fw intel-ucode unRAR linux-fw-redistributable LSI-tw_cli shmux NVIDIA-r1 Broadcom MicroChip-SDCC JSON bh-luxi bonnie sun-jlfgr Amazon&quot;
CBUILD=&quot;x86_64-pc-linux-gnu&quot;
CFLAGS=&quot;-O2 -march=native -pipe -fomit-frame-pointer&quot;
CHOST=&quot;x86_64-pc-linux-gnu&quot;
CONFIG_PROTECT=&quot;/etc /usr/lib64/libreoffice/program/sofficerc /usr/share/gnupg/qualified.txt&quot;
CONFIG_PROTECT_MASK=&quot;/etc/ca-certificates.conf /etc/dconf /etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c&quot;
CXXFLAGS=&quot;-O2 -march=native -pipe -fomit-frame-pointer&quot;
DISTDIR=&quot;/usr/portage/distfiles&quot;
EMERGE_DEFAULT_OPTS=&quot;--jobs=4 --load-average=10&quot;
ENV_UNSET=&quot;DBUS_SESSION_BUS_ADDRESS DISPLAY GOBIN PERL5LIB PERL5OPT PERLPREFIX PERL_CORE PERL_MB_OPT PERL_MM_OPT XAUTHORITY XDG_CACHE_HOME XDG_CONFIG_HOME XDG_DATA_HOME XDG_RUNTIME_DIR&quot;
FCFLAGS=&quot;-O2 -march=native -pipe -fomit-frame-pointer&quot;
FEATURES=&quot;assume-digests binpkg-docompress binpkg-dostrip binpkg-logs collision-protect config-protect-if-modified distlocks ebuild-locks fixlafiles ipc-sandbox merge-sync multilib-strict network-sandbox news parallel-fetch pid-sandbox preserve-libs protect-owned sandbox sfperms strict unknown-features-warn unmerge-logs unmerge-orphans userfetch userpriv usersandbox usersync xattr&quot;
FFLAGS=&quot;-O2 -march=native -pipe -fomit-frame-pointer&quot;
GENTOO_MIRRORS=&quot;<a href="http://distfiles.gentoo.org">http://distfiles.gentoo.org</a>&quot;
LANG=&quot;en_GB.utf8&quot;
LDFLAGS=&quot;-Wl,-O1 -Wl,--as-needed&quot;
MAKEOPTS=&quot;-j8&quot;
PKGDIR=&quot;/usr/portage/packages&quot;
PORTAGE_CONFIGROOT=&quot;/&quot;
PORTAGE_RSYNC_OPTS=&quot;--recursive --links --safe-links --perms --times --omit-dir-times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages --exclude=/.git&quot;
PORTAGE_TMPDIR=&quot;/var/tmp&quot;
USE=&quot;X a52 aac acl acpi alsa amd64 berkdb bluetooth branding bzip2 cairo caps cdda cdr cli crypt cryptsetup cups cxx dbus dri dts dvd dvdr egl emboss encode exif fam filecaps flac fortran gdbm gif gles gles2 gtk iconv icu idn ipv6 jpeg lcms libnotify libtirpc mad mng mp3 mp4 mpeg multilib ncurses networkmanager nls nptl ogg opengl openmp pam pango pcre pdf pic plymouth png policykit ppds pulseaudio readline sdl seccomp spell split-usr ssl startup-notification svg systemd tcpd tiff truetype udev udisks unicode upower urandom usb user-session vaapi vorbis vulkan wayland wxwidgets x264 xattr xcb xcsecurity xml xv xvid xvmc zlib&quot; ABI_X86=&quot;64&quot; ADA_TARGET=&quot;gnat_2018&quot; ALSA_CARDS=&quot;ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci&quot; APACHE2_MODULES=&quot;authn_core authz_core socache_shmcb unixd actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias&quot; CALLIGRA_FEATURES=&quot;karbon sheets words&quot; COLLECTD_PLUGINS=&quot;df interface irq load memory rrdtool swap syslog&quot; CPU_FLAGS_X86=&quot;aes avx avx2 f16c fma3 mmx mmxext pclmul popcnt sse sse2 sse3 sse4_1 sse4_2 ssse3&quot; ELIBC=&quot;glibc&quot; GPSD_PROTOCOLS=&quot;ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock greis isync itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf skytraq superstar2 timing tsip tripmate tnt ublox ubx&quot; INPUT_DEVICES=&quot;libinput keyboard mouse&quot; KERNEL=&quot;linux&quot; LCD_DEVICES=&quot;bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text&quot; LIBREOFFICE_EXTENSIONS=&quot;presenter-console presenter-minimizer&quot; LLVM_TARGETS=&quot;X86&quot; NETBEANS_MODULES=&quot;apisupport cnd groovy gsf harness ide identity j2ee java mobility nb php profiler soa visualweb webcommon websvccommon xml&quot; OFFICE_IMPLEMENTATION=&quot;libreoffice&quot; PHP_TARGETS=&quot;php7-2&quot; POSTGRES_TARGETS=&quot;postgres10 postgres11&quot; PYTHON_SINGLE_TARGET=&quot;python3_6&quot; PYTHON_TARGETS=&quot;python2_7 python3_6&quot; QEMU_SOFTMMU_TARGETS=&quot;aarch64 arm i386 x86_64&quot; QEMU_USER_TARGETS=&quot;aarch64 aarch64_be arm armeb&quot; RUBY_TARGETS=&quot;ruby26&quot; USERLAND=&quot;GNU&quot; VIDEO_CARDS=&quot;intel i965&quot; XTABLES_ADDONS=&quot;quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account&quot;
Unset:  CC, CPPFLAGS, CTARGET, CXX, INSTALL_MASK, LC_ALL, LINGUAS, PORTAGE_BINHOST, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS</pre>
    </div>

    <div id="c1" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c1">Comment 1</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Michael Weiser</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2019-12-07 18:11:40 UTC
        </span>

      </div>




<pre class="bz_comment_text">-pam also kills PAM support in /bin/su, /bin/passwd and /bin/login. :-/

An explicit use_enable seems the way to go:

--- /usr/portage/sys-apps/shadow/files/pam.d-include/shadow	2015-08-09 02:38:18.000000000 +0200
+++ /usr/local/portage/sys-apps/shadow/files/pam.d-include/shadow	2019-12-07 18:59:56.920440259 +0100
&#64;&#64; -1,7 +1,7 &#64;&#64;
 #%PAM-1.0 
 
 auth       sufficient	pam_rootok.so
-auth       required		pam_permit.so
+auth       required		pam_deny.so
 
 account    include		system-auth
 
diff -ur /usr/portage/sys-apps/shadow/shadow-4.8-r1.ebuild /usr/local/portage/sys-apps/shadow/shadow-4.8-r1.ebuild
--- /usr/portage/sys-apps/shadow/shadow-4.8-r1.ebuild	2019-12-02 11:39:41.000000000 +0100
+++ /usr/local/portage/sys-apps/shadow/shadow-4.8-r1.ebuild	2019-12-07 18:59:43.413518749 +0100
&#64;&#64; -12,7 +12,7 &#64;&#64;
 LICENSE=&quot;BSD GPL-2&quot;
 SLOT=&quot;0&quot;
 KEYWORDS=&quot;~alpha ~amd64 ~arm ~arm64 ~hppa ~ia64 ~m68k ~mips ~ppc ~ppc64 ~riscv ~s390 ~sh ~sparc ~x86&quot;
-IUSE=&quot;acl audit bcrypt +cracklib nls pam selinux skey split-usr +su xattr&quot;
+IUSE=&quot;acl audit bcrypt +cracklib nls pam selinux skey split-usr +su xattr account-tools-setuid&quot;
 # Taken from the man/Makefile.am file.
 LANGS=( cs da de es fi fr hu id it ja ko pl pt_BR ru sv tr zh_CN zh_TW )
 
&#64;&#64; -68,6 +68,7 &#64;&#64;
 		$(use_with skey)
 		$(use_with su)
 		$(use_with xattr attr)
+		$(use_enable account-tools-setuid)
 	)
 	econf &quot;${myeconfargs[&#64;]}&quot;
 

Incidentally this not only disables setuid install of the binaries but PAM support in them while the other tools retain PAM support:

$ ldd /bin/login /usr/sbin/useradd 
/bin/login:
	linux-vdso.so.1 (0x00007ffd217fe000)
	libpam.so.0 =&gt; /lib64/libpam.so.0 (0x00007f7bd6023000)
	libpam_misc.so.0 =&gt; /lib64/libpam_misc.so.0 (0x00007f7bd601e000)
	libc.so.6 =&gt; /lib64/libc.so.6 (0x00007f7bd5e4c000)
	libdl.so.2 =&gt; /lib64/libdl.so.2 (0x00007f7bd5e46000)
	/lib64/ld-linux-x86-64.so.2 (0x00007f7bd607f000)
/usr/sbin/useradd:
	linux-vdso.so.1 (0x00007ffd08b68000)
	libacl.so.1 =&gt; /lib64/libacl.so.1 (0x00007f19c6602000)
	libattr.so.1 =&gt; /lib64/libattr.so.1 (0x00007f19c65fa000)
	libc.so.6 =&gt; /lib64/libc.so.6 (0x00007f19c6428000)
	/lib64/ld-linux-x86-64.so.2 (0x00007f19c666d000)

src/Makefile.am:
if ACCT_TOOLS_SETUID
suidusbins += chgpasswd chpasswd groupadd groupdel groupmod newusers useradd userdel usermod
endif
[...]
if ACCT_TOOLS_SETUID
LIBPAM_SUID  = $(LIBPAM)
else
LIBPAM_SUID  =
endif

src/useradd.c:
#ifdef ACCT_TOOLS_SETUID
#ifdef USE_PAM
[...]
        if (PAM_SUCCESS == retval) {
                retval = pam_authenticate (pamh, 0);
        }

        if (PAM_SUCCESS == retval) {
                retval = pam_acct_mgmt (pamh, 0);
        }
[...]
        (void) pam_end (pamh, retval);
#endif                          /* USE_PAM */
#endif                          /* ACCT_TOOLS_SETUID */

So install of the pam configs could be omitted in that case as well.</pre>
    </div>

    <div id="c2" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c2">Comment 2</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Lars Wendler (Polynomial-C)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
        </span>

        <span class="bz_comment_time">
          2019-12-08 12:22:02 UTC
        </span>

      </div>




<pre class="bz_comment_text">Would this change be a good mitigation?

&#64;&#64; -58,6 +59,7 &#64;&#64;
                --enable-shared=no
                --enable-static=yes
                $(use_enable nls)
+               $(use_enable !pam account-tools-setuid)
                $(use_with acl)
                $(use_with audit)
                $(use_with bcrypt)</pre>
    </div>

    <div id="c3" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c3">Comment 3</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Michael Weiser</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2019-12-08 12:58:33 UTC
        </span>

      </div>




<pre class="bz_comment_text">Do I understand correctly, that it is intended to:

a.) disable setuid account management tools if PAM support is enabled and
b.) enable setuid account management tools if PAM support is disabled?

What happens if someone wants c.) PAM support *and* setuid account management tools enabled?

Also, if someone disabled PAM support, wouldn't that leave them with setuid root user management binaries and no authentication whatsoever, again opening up arbitrary user management by any user on the system? I guess, the binaries could be chgrp'd to some acctmgmt group and set to mode 1710 to gain some control of that.

Configure --help reads:

  --enable-account-tools-setuid
                          Install the user and group management tools setuid
                          and authenticate the callers. This requires
                          --with-pam.

So I think, case b.) is not intended, supported nor tested. Actually, come to think of it and testing it, configure refuses that combination:

./configure --without-libpam --enable-account-tools-setuid
checking for a BSD-compatible install... /usr/bin/install -c
[...]
checking use login and su access checking if PAM not used... yes
configure: error: PAM support is required for --enable-account-tools-setuid

So I think, $(use_enable !pam account-tools-setuid) would break building with -pam.

Also, please don't forget that for case c.) (setuid + pam), the pam.d configs still need to be fixed not to leave user management open to anyone by default.</pre>
    </div>

    <div id="c4" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c4">Comment 4</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Larry the Git Cow</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
        </span>

        <span class="bz_comment_time">
          2019-12-17 07:50:55 UTC
        </span>

      </div>




<pre class="bz_comment_text">The bug has been referenced in the following commit(s):

<a href="https://gitweb.gentoo.org/repo/gentoo.git/commit/?id=f569e6070dea96b746db27eb5586f7a73c99916d">https://gitweb.gentoo.org/repo/gentoo.git/commit/?id=f569e6070dea96b746db27eb5586f7a73c99916d</a>

commit f569e6070dea96b746db27eb5586f7a73c99916d
Author:     Lars Wendler &lt;<a href="mailto:polynomial-c&#64;gentoo.org">polynomial-c&#64;gentoo.org</a>&gt;
AuthorDate: 2019-12-17 07:50:29 +0000
Commit:     Lars Wendler &lt;<a href="mailto:polynomial-c&#64;gentoo.org">polynomial-c&#64;gentoo.org</a>&gt;
CommitDate: 2019-12-17 07:50:49 +0000

    sys-apps/shadow: Revbump to no longer install binaries SUID-root
    
    Thanks-to: Michael Weiser &lt;<a href="mailto:michael&#64;weiser.dinsnail.net">michael&#64;weiser.dinsnail.net</a>&gt;
    Bug: <a href="https://bugs.gentoo.org/702252">https://bugs.gentoo.org/702252</a>
    Package-Manager: Portage-2.3.82, Repoman-2.3.20
    Signed-off-by: Lars Wendler &lt;<a href="mailto:polynomial-c&#64;gentoo.org">polynomial-c&#64;gentoo.org</a>&gt;

 sys-apps/shadow/{shadow-4.8-r1.ebuild =&gt; shadow-4.8-r2.ebuild} | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)</pre>
    </div>

    <div id="c5" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c5">Comment 5</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Lars Wendler (Polynomial-C)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
        </span>

        <span class="bz_comment_time">
          2019-12-17 07:52:59 UTC
        </span>

      </div>




<pre class="bz_comment_text">To be honest, I don't see a compelling reason to install these binaries SUID-root. If someone wants to enable users to use these binaries, one can still create corresponding sudo rules.</pre>
    </div>

    <div id="c6" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c6">Comment 6</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Michael Weiser</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2019-12-17 08:47:07 UTC
        </span>

      </div>




<pre class="bz_comment_text">Thanks! Should we drop the IMO broken PAM configs as well? I volunteer to do a PR on GitHub if helpful.</pre>
    </div>

    <div id="c7" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c7">Comment 7</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Lars Wendler (Polynomial-C)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
        </span>

        <span class="bz_comment_time">
          2019-12-17 09:29:16 UTC
        </span>

      </div>




<pre class="bz_comment_text">(In reply to Michael Weiser from <a href="show_bug.cgi?id=702252#c6">comment #6</a>)
<span class="quote">&gt; Thanks! Should we drop the IMO broken PAM configs as well? I volunteer to do
&gt; a PR on GitHub if helpful.</span >

That would be great. I am not really a pam expert so I'd like to have your forthcoming PR reviewed by some other Gentoo devs.</pre>
    </div>

    <div id="c8" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c8">Comment 8</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Michael Weiser</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2019-12-17 20:11:22 UTC
        </span>

      </div>




<pre class="bz_comment_text">BTW: Upstream is aware of us: <a href="https://github.com/shadow-maint/shadow/pull/199">https://github.com/shadow-maint/shadow/pull/199</a> and reconsidering the default of --enable-account-tools-setuid.</pre>
    </div>

    <div id="c9" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c9">Comment 9</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Michael Weiser</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2019-12-17 21:02:01 UTC
        </span>

      </div>




<pre class="bz_comment_text"><a href="https://github.com/gentoo/gentoo/pull/14032">https://github.com/gentoo/gentoo/pull/14032</a></pre>
    </div>

    <div id="c10" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c10">Comment 10</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Larry the Git Cow</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
        </span>

        <span class="bz_comment_time">
          2020-01-19 01:01:32 UTC
        </span>

      </div>




<pre class="bz_comment_text">The bug has been referenced in the following commit(s):

<a href="https://gitweb.gentoo.org/repo/gentoo.git/commit/?id=c7da130a443ab9811b242ae2cbf8259cb85d43b1">https://gitweb.gentoo.org/repo/gentoo.git/commit/?id=c7da130a443ab9811b242ae2cbf8259cb85d43b1</a>

commit c7da130a443ab9811b242ae2cbf8259cb85d43b1
Author:     Michael Weiser &lt;<a href="mailto:michael.weiser&#64;gmx.de">michael.weiser&#64;gmx.de</a>&gt;
AuthorDate: 2019-12-17 19:02:40 +0000
Commit:     Lars Wendler &lt;<a href="mailto:polynomial-c&#64;gentoo.org">polynomial-c&#64;gentoo.org</a>&gt;
CommitDate: 2020-01-19 01:00:17 +0000

    sys-apps/shadow: Revbump to fix up PAM configuration
    
    shadow includes a number of administrative account management binaries
    like useradd, chage and chpasswd, traditionally only useable by root.
    In shadow they can be compiled with PAM support and installed setuid.
    PAM configuration can then be used to delegate account management to
    users other than root.
    
    The previous config contained the pam_rootok module to provide default
    behaviour of allowing account management when called as root. But it
    also contained pam_permit which would allow everyone else to also do
    account management without any authentication.
    
    To close this loophole we remove pam_permit from the config. Also,
    chpasswd, chgpasswd and newusers are batch-mode mass-change tools meant
    for scripting. They only contain PAM support if configure flag
    --enable-account-tools-setuid is in effect and are then installed setuid
    root. They should use the same restrictive PAM configuration as their
    siblings.  But with setuid user management tools and PAM support within
    them disabled by commit f569e607 we can stop installing the
    configuration files as well.
    
    chfn and chsh are intended to be called by the user as self-service
    tools. For this reason they're always installed setuid root and contain
    PAM support. They should be allowed to work but maybe not without some
    prior authentication to avoid attacks such as someone finding an
    unlocked session and using chfn to redirect phone calls intended for the
    user to himself. The existing passwd config seems perfect for that and
    is aptly named in that both tools change user information normally
    stored in /etc/passwd.
    
    groupmems is another user self-service tool. It allows the user to add
    people to their user-private group, allowing them trusted access to
    normally private files. It is not installed setuid like chfn and chsh
    but always contains PAM support. Upstream installs a locked down PAM
    config by default.
    
    Since default shell profiles on Gentoo do not change umask to 0002 when
    a private user group is in use, impact will only be to allow read access
    to those additional users by default.
    
    Since the idea of adding more users to the user *private* group is
    questionable, go with upstream's default of locking the PAM config down
    so that an admin not only needs to make the binary suid but also adjust
    the PAM config, in the process hopefully considering what they're doing.
    
    Bug: <a href="https://bugs.gentoo.org/702252">https://bugs.gentoo.org/702252</a>
    Closes: <a href="https://github.com/gentoo/gentoo/pull/14032">https://github.com/gentoo/gentoo/pull/14032</a>
    Reviewed-by: Mikle Kolyada &lt;<a href="mailto:zlogene&#64;gentoo.org">zlogene&#64;gentoo.org</a>&gt;
    Signed-off-by: Lars Wendler &lt;<a href="mailto:polynomial-c&#64;gentoo.org">polynomial-c&#64;gentoo.org</a>&gt;

 sys-apps/shadow/files/pam.d-include/shadow-r1 |   7 +
 sys-apps/shadow/shadow-4.8-r3.ebuild          | 233 ++++++++++++++++++++++++++
 2 files changed, 240 insertions(+)</pre>
    </div>

    <div id="c11" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c11">Comment 11</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Mikle Kolyada</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-at.png"
                 alt="archtester"
                 title="archtester - Architecture Testers">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-infra.png"
                 alt="Gentoo Infrastructure"
                 title="Gentoo Infrastructure - Access to bugs in the Gentoo Infrastructure product">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-sec.png"
                 alt="Security"
                 title="Security - Gentoo Security">
        </span>

        <span class="bz_comment_time">
          2020-03-07 19:06:03 UTC
        </span>

      </div>




<pre class="bz_comment_text">Lets get this stable.</pre>
    </div>

    <div id="c12" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c12">Comment 12</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Agostino Sarubbo</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
        </span>

        <span class="bz_comment_time">
          2020-03-08 09:56:51 UTC
        </span>

      </div>




<pre class="bz_comment_text">s390 stable</pre>
    </div>

    <div id="c13" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c13">Comment 13</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Mikle Kolyada</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-at.png"
                 alt="archtester"
                 title="archtester - Architecture Testers">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-infra.png"
                 alt="Gentoo Infrastructure"
                 title="Gentoo Infrastructure - Access to bugs in the Gentoo Infrastructure product">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-sec.png"
                 alt="Security"
                 title="Security - Gentoo Security">
        </span>

        <span class="bz_comment_time">
          2020-03-08 10:21:30 UTC
        </span>

      </div>




<pre class="bz_comment_text">amd64 stable</pre>
    </div>

    <div id="c14" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c14">Comment 14</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Agostino Sarubbo</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
        </span>

        <span class="bz_comment_time">
          2020-03-08 10:24:04 UTC
        </span>

      </div>




<pre class="bz_comment_text">sparc stable</pre>
    </div>

    <div id="c15" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c15">Comment 15</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Agostino Sarubbo</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
        </span>

        <span class="bz_comment_time">
          2020-03-08 10:25:45 UTC
        </span>

      </div>




<pre class="bz_comment_text">arm stable</pre>
    </div>

    <div id="c16" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c16">Comment 16</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Agostino Sarubbo</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
        </span>

        <span class="bz_comment_time">
          2020-03-08 11:11:24 UTC
        </span>

      </div>




<pre class="bz_comment_text">ppc stable</pre>
    </div>

    <div id="c17" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c17">Comment 17</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Agostino Sarubbo</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
        </span>

        <span class="bz_comment_time">
          2020-03-08 12:13:04 UTC
        </span>

      </div>




<pre class="bz_comment_text">x86 stable</pre>
    </div>

    <div id="c18" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c18">Comment 18</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Agostino Sarubbo</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
        </span>

        <span class="bz_comment_time">
          2020-03-08 12:34:38 UTC
        </span>

      </div>




<pre class="bz_comment_text">ia64 stable</pre>
    </div>

    <div id="c19" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c19">Comment 19</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Agostino Sarubbo</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
        </span>

        <span class="bz_comment_time">
          2020-03-08 12:35:42 UTC
        </span>

      </div>




<pre class="bz_comment_text">ppc64 stable</pre>
    </div>

    <div id="c20" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c20">Comment 20</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Mart Raudsepp</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
        </span>

        <span class="bz_comment_time">
          2020-03-17 10:18:00 UTC
        </span>

      </div>




<pre class="bz_comment_text">arm64 stable</pre>
    </div>

    <div id="c21" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c21">Comment 21</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Rolf Eike Beer</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-at.png"
                 alt="archtester"
                 title="archtester - Architecture Testers">
        </span>

        <span class="bz_comment_time">
          2020-03-18 18:20:56 UTC
        </span>

      </div>




<pre class="bz_comment_text">hppa stable</pre>
    </div>

    <div id="c22" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c22">Comment 22</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Mikle Kolyada</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-at.png"
                 alt="archtester"
                 title="archtester - Architecture Testers">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-infra.png"
                 alt="Gentoo Infrastructure"
                 title="Gentoo Infrastructure - Access to bugs in the Gentoo Infrastructure product">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-sec.png"
                 alt="Security"
                 title="Security - Gentoo Security">
        </span>

        <span class="bz_comment_time">
          2020-03-26 14:07:38 UTC
        </span>

      </div>




<pre class="bz_comment_text">SuperH port disbanded.</pre>
    </div>

    <div id="c23" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c23">Comment 23</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Sergei Trofimovich (RETIRED)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
        </span>

        <span class="bz_comment_time">
          2020-04-21 07:48:34 UTC
        </span>

      </div>




<pre class="bz_comment_text">m68k dropped stable keywords</pre>
    </div>

    <div id="c24" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c24">Comment 24</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Sam James</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-at.png"
                 alt="archtester"
                 title="archtester - Architecture Testers">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-sec.png"
                 alt="Security"
                 title="Security - Gentoo Security">
        </span>

        <span class="bz_comment_time">
          2020-04-21 07:52:02 UTC
        </span>

      </div>




<pre class="bz_comment_text">&#64;maintainer(s), please cleanup</pre>
    </div>

    <div id="c25" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c25">Comment 25</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Larry the Git Cow</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
        </span>

        <span class="bz_comment_time">
          2020-04-21 08:24:46 UTC
        </span>

      </div>




<pre class="bz_comment_text">The bug has been referenced in the following commit(s):

<a href="https://gitweb.gentoo.org/repo/gentoo.git/commit/?id=56a1b1be9d9b3661cc4f2ab036312d47892c4118">https://gitweb.gentoo.org/repo/gentoo.git/commit/?id=56a1b1be9d9b3661cc4f2ab036312d47892c4118</a>

commit 56a1b1be9d9b3661cc4f2ab036312d47892c4118
Author:     Lars Wendler &lt;<a href="mailto:polynomial-c&#64;gentoo.org">polynomial-c&#64;gentoo.org</a>&gt;
AuthorDate: 2020-04-21 08:13:36 +0000
Commit:     Lars Wendler &lt;<a href="mailto:polynomial-c&#64;gentoo.org">polynomial-c&#64;gentoo.org</a>&gt;
CommitDate: 2020-04-21 08:24:39 +0000

    sys-apps/shadow: Security cleanup
    
    Bug: <a href="https://bugs.gentoo.org/702252">https://bugs.gentoo.org/702252</a>
    Package-Manager: Portage-2.3.99, Repoman-2.3.22
    Signed-off-by: Lars Wendler &lt;<a href="mailto:polynomial-c&#64;gentoo.org">polynomial-c&#64;gentoo.org</a>&gt;

 sys-apps/shadow/Manifest                           |   2 -
 sys-apps/shadow/files/shadow-4.7-optional_su.patch | 130 ------------
 sys-apps/shadow/shadow-4.6.ebuild                  | 214 -------------------
 sys-apps/shadow/shadow-4.7-r2.ebuild               | 236 ---------------------
 4 files changed, 582 deletions(-)</pre>
    </div>

    <div id="c26" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c26">Comment 26</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">NATTkA bot</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
        </span>

        <span class="bz_comment_time">
          2020-08-21 08:09:43 UTC
        </span>

      </div>




<pre class="bz_comment_text">Unable to check for sanity:

<span class="quote">&gt; no match for package: sys-apps/shadow-4.8-r4</span ></pre>
    </div>

    <div id="c27" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c27">Comment 27</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">GLSAMaker/CVETool Bot</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
        </span>

        <span class="bz_comment_time">
          2020-08-25 12:54:29 UTC
        </span>

      </div>




<pre class="bz_comment_text">This issue was resolved and addressed in
 GLSA 202008-09 at <a href="https://security.gentoo.org/glsa/202008-09">https://security.gentoo.org/glsa/202008-09</a>
by GLSA coordinator Sam James (sam_c).</pre>
    </div>

    <div id="c28" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c28">Comment 28</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Joakim Tjernlund</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2020-09-15 09:16:20 UTC
        </span>

      </div>




<pre class="bz_comment_text">We have an embedded ppc, 32 bits with sys-apps/shadow-4.6
USE=nls pam xattr -acl -audit -cracklib -selinux -skey
which has
ls -l /usr/sbin/{groupadd,groupdel,groupmod,useradd,userdel,usermod}
-rwxr-xr-x 1 root root  66396 Mar 28  2019 /usr/sbin/groupadd*
-rwxr-xr-x 1 root root  62212 Mar 28  2019 /usr/sbin/groupdel*
-rwxr-xr-x 1 root root  66368 Mar 28  2019 /usr/sbin/groupmod*
-rwxr-xr-x 1 root root 103748 Mar 28  2019 /usr/sbin/useradd*
-rwxr-xr-x 1 root root  70448 Mar 28  2019 /usr/sbin/userdel*
-rwxr-xr-x 1 root root  99580 Mar 28  2019 /usr/sbin/usermod*

So I suspect this version is not vulnerable ?</pre>
    </div>


  

</td>
<td>
</td>
</tr></table>
  </div>
        

</form>

<hr>
<ul class="related_actions">
    <li><a href="show_bug.cgi?format=multiple&amp;id=702252">Format For Printing</a></li>
    <li>&nbsp;-&nbsp;<a href="show_bug.cgi?ctype=xml&amp;id=702252">XML</a></li>
    <li>&nbsp;-&nbsp;<a href="enter_bug.cgi?cloned_bug_id=702252">Clone This Bug</a></li>
    <li>&nbsp;-&nbsp;<a href="enter_bug.cgi?cloned_bug_id=702252&product=Gentoo%20Security">Clone In The Same 
                        Product</a></li>
    
    <li>&nbsp;-&nbsp;<a href="#">Top of page </a></li>
    </ul>

<br>
</div>

    <div id="footer">
      <div class="intro"></div>
<ul id="useful-links">
  <li id="links-actions"><ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi?format=guided">New</a>&ndash;<a href="enter_bug.cgi">[Ex]</a></li>
  <li><span class="separator">| </span><a href="describecomponents.cgi">Browse</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>
  <li><span class="separator">| </span><a href="https://wiki.gentoo.org/wiki/Foundation:Privacy_Policy">Privacy Policy</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_bottom" name="no_redirect" value="0">
    <script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_bottom");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_bottom" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_bottom"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li>
      <span class="separator">| </span>
        <a href="request.cgi">Requests</a></li>


  <li>
        <span class="separator">| </span>
        <a href="https://bugzilla.readthedocs.org/en/5.0/using/understanding.html" target="_blank">Help</a>
      </li>
    
      <li id="new_account_container_bottom">
        <span class="separator">| </span>
        <a href="createaccount.cgi">New&nbsp;Account</a>
      </li>

    <li id="mini_login_container_bottom">
  <span class="separator">| </span>
  <a id="login_link_bottom" href="show_bug.cgi?id=702252&amp;GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('_bottom')">Log In</a>

  <form action="show_bug.cgi?id=702252" method="POST"
        class="mini_login bz_default_hidden"
        id="mini_login_bottom">
    <input id="Bugzilla_login_bottom" required
           name="Bugzilla_login" class="bz_login"
        type="email" placeholder="Email Address">
    <input class="bz_password" name="Bugzilla_password" type="password"
           id="Bugzilla_password_bottom" required
           placeholder="Password">
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
            id="log_in_bottom">
    <a href="#" onclick="return hide_mini_login_form('_bottom')">[x]</a>
  </form>
</li>


  <li id="forgot_container_bottom">
    <span class="separator">| </span>
    <a id="forgot_link_bottom" href="show_bug.cgi?id=702252&amp;GoAheadAndLogIn=1#forgot"
       onclick="return show_forgot_form('_bottom')">Forgot Password</a>
    <form action="token.cgi" method="post" id="forgot_form_bottom"
          class="mini_forgot bz_default_hidden">
      <label for="login_bottom">Login:</label>
      <input name="loginname" size="20" id="login_bottom" required
          type="email" placeholder="Your Email Address">
      <input id="forgot_button_bottom" value="Reset Password" type="submit">
      <input type="hidden" name="a" value="reqpw">
      <input type="hidden" id="token_bottom" name="token"
             value="1635619192-095rno0vxncNaatOtRvq5byqRjNxw2X_mNEke3T7PKU">
      <a href="#" onclick="return hide_forgot_form('_bottom')">[x]</a>
    </form>
  </li>
</ul>
  </li>

  




  
</ul>

      <div class="outro"></div>
    </div>

  </body>
</html>