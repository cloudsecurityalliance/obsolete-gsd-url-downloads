<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>ca8ac8acdad662230ae37998c6c4091bb39402b6 - platform/frameworks/minikin - Git at Google</title><link rel="stylesheet" type="text/css" href="/+static/base.css"><!-- default customHeadTagPart --></head><body class="Site"><header class="Site-header"><div class="Header"><a class="Header-image" href="/"><img src="//www.gstatic.com/images/branding/lockups/2x/lockup_git_color_108x24dp.png" width="108" height="24" alt="Google Git"></a><div class="Header-menu"> <a class="Header-menuItem" href="https://accounts.google.com/AccountChooser?service=gerritcodereview&amp;continue=https://android.googlesource.com/login/platform/frameworks/minikin/%2B/ca8ac8acdad662230ae37998c6c4091bb39402b6">Sign in</a> </div></div></header><div class="Site-content"><div class="Container "><div class="Breadcrumbs"><a class="Breadcrumbs-crumb" href="/?format=HTML">android</a> / <a class="Breadcrumbs-crumb" href="/platform/">platform</a> / <a class="Breadcrumbs-crumb" href="/platform/frameworks/">frameworks</a> / <a class="Breadcrumbs-crumb" href="/platform/frameworks/minikin/">minikin</a> / <span class="Breadcrumbs-crumb">ca8ac8acdad662230ae37998c6c4091bb39402b6</span></div><div class="u-monospace Metadata"><table><tr><th class="Metadata-title">commit</th><td>ca8ac8acdad662230ae37998c6c4091bb39402b6</td><td><span>[<a href="/platform/frameworks/minikin/+log/ca8ac8acdad662230ae37998c6c4091bb39402b6">log</a>]</span> <span>[<a href="/platform/frameworks/minikin/+archive/ca8ac8acdad662230ae37998c6c4091bb39402b6.tar.gz">tgz</a>]</span></td></tr><tr><th class="Metadata-title">author</th><td>Raph Levien &lt;raph@google.com&gt;</td><td>Wed Jan 06 14:31:23 2016 -0800</td></tr><tr><th class="Metadata-title">committer</th><td>Raph Levien &lt;raph@google.com&gt;</td><td>Thu Jan 07 21:39:25 2016 +0000</td></tr><tr><th class="Metadata-title">tree</th><td><a href="/platform/frameworks/minikin/+/ca8ac8acdad662230ae37998c6c4091bb39402b6/">f2142f959da7f25a1c70efcfea0db2a853d194bf</a></td></tr><tr><th class="Metadata-title">parent</th><td><a href="/platform/frameworks/minikin/+/ca8ac8acdad662230ae37998c6c4091bb39402b6%5E">6299a6ba13906c695f7a4f6748f7bc5856a110e5</a> <span>[<a href="/platform/frameworks/minikin/+/ca8ac8acdad662230ae37998c6c4091bb39402b6%5E%21/">diff</a>]</span></td></tr></table></div><pre class="u-pre u-monospace MetadataMessage">Reject fonts with invalid ranges in cmap

A corrupt or malicious font may have a negative size in its cmap
range, which in turn could lead to memory corruption. This patch
detects the case and rejects the font, and also includes an assertion
in the sparse bit set implementation if we missed any such case.

External issue:
<a href="https://code.google.com/p/android/issues/detail?id=192618">https://code.google.com/p/android/issues/detail?id=192618</a>

Bug: 26413177
Change-Id: <a href="https://android-review.googlesource.com/#/q/Icc0c80e4ef389abba0964495b89aa0fae3e9f4b2">Icc0c80e4ef389abba0964495b89aa0fae3e9f4b2</a>
</pre><ul class="DiffTree"><li><a href="/platform/frameworks/minikin/+/ca8ac8acdad662230ae37998c6c4091bb39402b6/libs/minikin/CmapCoverage.cpp">libs/minikin/CmapCoverage.cpp</a><span class="DiffTree-action DiffTree-action--modify">[<a href="/platform/frameworks/minikin/+/ca8ac8acdad662230ae37998c6c4091bb39402b6%5E%21/#F0">diff</a>]</span></li><li><a href="/platform/frameworks/minikin/+/ca8ac8acdad662230ae37998c6c4091bb39402b6/libs/minikin/SparseBitSet.cpp">libs/minikin/SparseBitSet.cpp</a><span class="DiffTree-action DiffTree-action--modify">[<a href="/platform/frameworks/minikin/+/ca8ac8acdad662230ae37998c6c4091bb39402b6%5E%21/#F1">diff</a>]</span></li></ul><div class="DiffSummary">2 files changed</div><div class="TreeDetail"><div class="u-sha1 u-monospace TreeDetail-sha1">tree: f2142f959da7f25a1c70efcfea0db2a853d194bf</div><ol class="FileList"><li class="FileList-item FileList-item--gitTree" title="Tree - include/"><a class="FileList-itemLink" href="/platform/frameworks/minikin/+/ca8ac8acdad662230ae37998c6c4091bb39402b6/include/">include/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - libs/"><a class="FileList-itemLink" href="/platform/frameworks/minikin/+/ca8ac8acdad662230ae37998c6c4091bb39402b6/libs/">libs/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - sample/"><a class="FileList-itemLink" href="/platform/frameworks/minikin/+/ca8ac8acdad662230ae37998c6c4091bb39402b6/sample/">sample/</a></li></ol></div></div> <!-- Container --></div> <!-- Site-content --><footer class="Site-footer"><div class="Footer"><span class="Footer-poweredBy">Powered by <a href="https://gerrit.googlesource.com/gitiles/">Gitiles</a>| <a href="https://policies.google.com/privacy">Privacy</a></span><span class="Footer-formats"><a class="u-monospace Footer-formatsItem" href="?format=TEXT">txt</a> <a class="u-monospace Footer-formatsItem" href="?format=JSON">json</a></span></div></footer></body></html>