<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
  <head>
<base href="https://bugs.launchpad.net/ubuntu/+source/apt/+bug/1899193/+index" />

    <meta charset="UTF-8" />
    <title>Bug #1899193 “local denial of service due to parsing bugs in arf...” : Bugs : apt package : Ubuntu</title>
    <link rel="shortcut icon" href="/@@/launchpad.png" />
    <link rel="canonical" href="https://bugs.launchpad.net/bugs/1899193" />
    
      <link rel="alternate" type="application/atom+xml" href="http://feeds.launchpad.net/bugs/1899193/bug.atom" title="Bug 1899193 Feed" />
    

    
  
  <link type="text/css" rel="stylesheet" media="screen, print" href="/+icing/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/combo.css" />


    

    
      <meta name="description" content="# GitHub Security Lab (GHSL) Vulnerability Report: `GHSL-2020-168`, `GHSL-2020-169`, `GHSL-2020-170`

The [GitHub Security Lab](https://securitylab.github.com) team has identified potential security vulnerabilities in aptd.

We are committed to working with you to help resolve these issues. In this report you will find everything you need to effectively coordinate a resolution of these issues with the GHSL team.

If at any point you have concerns or questions about this process, please do not..." />
      <meta property="og:description" content="# GitHub Security Lab (GHSL) Vulnerability Report: `GHSL-2020-168`, `GHSL-2020-169`, `GHSL-2020-170`

The [GitHub Security Lab](https://securitylab.github.com) team has identified potential security vulnerabilities in aptd.

We are committed to working with you to help resolve these issues. In this report you will find everything you need to effectively coordinate a resolution of these issues with the GHSL team.

If at any point you have concerns or questions about this process, please do not..." />
    

    
    
      <meta property="og:title" content="Bug #1899193 “local denial of service due to parsing bugs in arf...” : Bugs : apt package : Ubuntu" />
      <meta property="og:type" content="website" />
      <meta property="og:image" content="/@@/launchpad.png" />
      <meta property="og:url" content="https://bugs.launchpad.net/bugs/1899193" />
      <meta property="og:site_name" content="Launchpad" />
    

    

    
  

  
  
  <script type="text/javascript">
    var LP = {
        cache: {},
        links: {}
    };
  </script>

  

  <script type="text/javascript">var cookie_scope = '; Path=/; Secure; Domain=.launchpad.net';</script>

   <script type="text/javascript" src="/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?yui/yui/yui-min.js&amp;lp/meta.js&amp;yui/loader/loader-min.js"></script>
   <script type="text/javascript">
        var raw = null;
        if (LP.devmode) {
           raw = 'raw';
        }
        YUI.GlobalConfig = {
            combine: true,
            comboBase: '/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?',
            root: 'yui/',
            filter: raw,
            debug: false,
            fetchCSS: false,
            maxURLLength: 2000,
            groups: {
                lp: {
                    combine: true,
                    base: '/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?lp/',
                    comboBase: '/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?',
                    root: 'lp/',
                    // comes from including lp/meta.js
                    modules: LP_MODULES,
                    fetchCSS: false
                }
            }
        }</script>

  <script type="text/javascript">
      // we need this to create a single YUI instance all events and code
      // talks across. All instances of YUI().use should be based off of
      // LPJS instead.
      var LPJS = new YUI();
  </script>



    <script id="base-layout-load-scripts" type="text/javascript">
        //<![CDATA[
        LPJS.use('base', 'node', 'console', 'event',
            'oop', 'lp', 'lp.app.foldables','lp.app.sorttable',
            'lp.app.inlinehelp', 'lp.app.links',
            'lp.bugs.bugtask_index', 'lp.bugs.subscribers',
            'lp.app.ellipsis', 'lp.code.branchmergeproposal.diff',
            'lp.views.global',
             function(Y) {

            Y.on("domready", function () {
                var global_view = new Y.lp.views.Global();
                global_view.render();

                Y.lp.app.sorttable.SortTable.init();
                Y.lp.app.inlinehelp.init_help();
                Y.lp.activate_collapsibles();
                Y.lp.app.foldables.activate();
                Y.lp.app.links.check_valid_lp_links();
            });

            Y.on('lp:context:web_link:changed', function(e) {
                  window.location = e.new_value;
            });
        });
        //]]>
    </script>
    <script id="base-helper-functions" type="text/javascript">
         //<![CDATA[
        // This code is pulled from lp.js that needs to be available on every
        // request. Pulling here to get it outside the scope of the YUI block.
        function setFocusByName(name) {
            // Focus the first element matching the given name which can be focused.
            var nodes = document.getElementsByName(name);
            var i, node;
            for (i = 0; i < nodes.length; i++) {
                node = nodes[i];
                if (node.focus) {
                    try {
                        // Trying to focus a hidden element throws an error in IE8.
                        if (node.offsetHeight !== 0) {
                            node.focus();
                        }
                    } catch (e) {
                        LPJS.use('console', function(Y) {
                            Y.log('In setFocusByName(<' +
                                node.tagName + ' type=' + node.type + '>): ' + e);
                        });
                    }
                    break;
                }
            }
        }

        function selectWidget(widget_name, event) {
          if (event && (event.keyCode === 9 || event.keyCode === 13)) {
              // Avoid firing if user is tabbing through or simply pressing
              // enter to submit the form.
              return;
          }
          document.getElementById(widget_name).checked = true;
        }
        //]]>
    </script>

    
      
      <script type="text/javascript" id="available-official-tags-js">var available_official_tags = ["a11y", "appstream", "bionic", "bisect-done", "bitesize", "cherry-pick", "community-security", "desktop-file", "disco", "dist-upgrade", "focal", "ftbfs", "groovy", "hirsute", "hw-specific", "impish", "jammy", "kernel-bug", "manpage", "metabug", "multiarch", "needs-bisect", "needs-design", "needs-packaging", "needs-reassignment", "package-conflict", "packaging", "patch", "patch-accepted-debian", "patch-accepted-upstream", "patch-forwarded-debian", "patch-forwarded-upstream", "patch-needswork", "patch-rejected", "patch-rejected-debian", "patch-rejected-upstream", "performing-bisect", "py2-removal", "qt4-removal", "regression-proposed", "regression-release", "regression-update", "string-fix", "suspend-resume", "systemd-boot", "testcase", "touch", "unmetdeps", "upgrade-software-version", "verification-done-bionic", "verification-done-focal", "verification-done-groovy", "verification-done-hirsute", "verification-done-impish", "verification-done-xenial", "verification-failed-bionic", "verification-failed-groovy", "verification-failed-impish", "verification-failed-xenial", "verification-needed-bionic", "verification-needed-focal", "verification-needed-groovy", "verification-needed-hirsute", "verification-needed-impish", "verification-needed-trusty", "verification-needed-xenial", "wayland", "xenial"];</script>
      <script type="text/javascript">
        LPJS.use('base', 'node', 'oop', 'event', 'lp.bugs.bugtask_index',
                  'lp.bugs.subscribers', 'lp.code.branchmergeproposal.diff',
                  'lp.app.comment', 'lp.services.messages.edit', function(Y) {
            Y.on('domready', function() {
                Y.lp.code.branchmergeproposal.diff.connect_diff_links();
                Y.lp.bugs.bugtask_index.setup_bugtask_index();
                Y.lp.bugs.bugtask_index.setup_bugtask_table();
                LP.cache.comment_context = LP.cache.bug;
                var cl = new Y.lp.app.comment.CommentList();
                cl.render();
                var sl = new Y.lp.bugs.subscribers.createBugSubscribersLoader({
                    container_box: '#other-bug-subscribers',
                    subscribers_details_view:
                        '/+bug-portlet-subscribers-details',
                    subscribe_someone_else_link: '.menu-link-addsubscriber'
                }, window);

                Y.lp.services.messages.edit.setup();
            });
         });
      </script>
      <style type="text/css">
        /* Align the 'add comment' link to the right of the comment box. */
        #add-comment-form textarea { width: 100%; }
        #add-comment-form { max-width: 60em; padding-bottom: 4em; }
        #add-comment-form .actions {float: right;}
        .buglink-summary dd { font-size: 10px; }
        a#privacy-link:link:hover, a#privacy-link:visited:hover {text-decoration:none;}
      </style>
      <style type="text/css">
        .yui3-overlay .value label  {
          /* It normally makes sense for form labels to be bold, but since
          this form consists only of radio buttons, there's nothing but labels
          so we just get wall-to-wall bold. */
          font-weight: normal !important;
        }
      </style>
    
    
  </head>

  <body id="document" itemscope="" itemtype="http://schema.org/WebPage" class="tab-bugs
      main_side
      public
      yui3-skin-sam">
          
          
    <div class="yui-d0">
      <div id="locationbar" class="login-logout">
        

<div id="logincontrol"><a href="https://bugs.launchpad.net/ubuntu/+source/apt/+bug/1899193/+login">Log in / Register</a></div>



      </div><!--id="locationbar"-->

      <div id="watermark" class="watermark-apps-portlet">
        <div>
          <a href="https://launchpad.net/ubuntu"><img alt="" width="64" height="64" src="https://launchpadlibrarian.net/49558155/64_logo.png" /></a>
        </div>
        <div class="wide">
          <h2 id="watermark-heading"><a href="https://launchpad.net/ubuntu">Ubuntu</a><br /><a href="https://launchpad.net/ubuntu/+source/apt">apt package</a></h2>
        </div>
        
  <!-- Application Menu -->
  <ul class="facetmenu">
    
      
      <li class="overview"><a href="https://launchpad.net/ubuntu/+source/apt">Overview</a></li>
      
    
    
      
      <li class="branches"><a href="https://code.launchpad.net/ubuntu/+source/apt">Code</a></li>
      
    
    
      <li class="bugs active"><a href="https://bugs.launchpad.net/ubuntu/+source/apt">Bugs</a></li>
      
      
    
    
      
      
      <li class="specifications disabled-tab"><span>Blueprints</span></li>
    
    
      
      <li class="translations"><a href="https://translations.launchpad.net/ubuntu/+source/apt">Translations</a></li>
      
    
    
      
      <li class="answers"><a href="https://answers.launchpad.net/ubuntu/+source/apt">Answers</a></li>
      
    
  </ul>

      </div>

      <div class="yui-t4">
        <div id="maincontent" class="yui-main">
          <div class="yui-b" dir="ltr">
            <div class="context-publication">
              
      <h1 id="edit-title">
<span class="yui3-editable_text-text ellipsis" style="max-width: 95%;">
    local denial of service due to parsing bugs in arfile.cc
</span>
  
</h1>



    
              

              <div id="registration" class="registering">
                
      Bug #1899193 reported by
      <a href="https://launchpad.net/~kbackhouse2000" class="sprite person">kev</a>
      <time title="2020-10-09 16:29:17 UTC" datetime="2020-10-09T16:29:17.457962+00:00">on 2020-10-09</time>
    
              </div>
            </div>

            
            <div id="request-notifications">
              
            </div>

            
              <div>

      

      <div id="bug-is-duplicate">
          
      </div>
      

      <div style="float: right;">
        <span><a href="/+help-bugs/bug-heat.html" target="help" class="sprite flame">262</a></span>
      </div>

      


  
  
    <div class="actions">
      <span id="affectsmetoo" style="display: inline">This bug affects 1 person</span>
    </div>
  



    <table id="affected-software" class="listing">
      <thead>
        <tr>
          <th colspan="2">Affects</th>
          <th>Status</th>
          <th>Importance</th>
          <th>Assigned to</th>
          <th>Milestone</th>
        </tr>
      </thead>

      <tbody>
        
          
  <tr class="highlight" id="tasksummary2647493">
    <td>
      <a class="bugtask-expander" href="https://bugs.launchpad.net/ubuntu/+source/apt/+bug/1899193/+editstatus">
        &#8203;
      </a>
    </td>
    
    <td>
      <span id="bugtarget-picker-tasksummary2647493">
        <span class="yui3-activator-data-box">
            <a class="sprite package-source" href="https://bugs.launchpad.net/ubuntu/+source/apt" title="Latest release: 2.3.11, uploaded to main on 2021-10-21 16:26:39.578178+00:00 by APT Development Team (deity), maintained by APT Development Team (deity)">apt (Ubuntu)</a>
        </span>
        <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
          Edit
        </button>
        <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        
      </span>
    </td>

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/ubuntu/+source/apt/+bug/1899193/+editstatus" style="float: left" class="value statusFIXRELEASED">Fix Released</a>
          <a href="https://bugs.launchpad.net/ubuntu/+source/apt/+bug/1899193/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceUNDECIDED">Undecided</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary2647493">
          <span class="yui3-activator-data-box">
            
            
              Unassigned
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      <div class="milestone-content" style="width: 100%; float: left">
        
        <a class="value" href=""></a>
        
      </div>
    </td>

    
  </tr>

  
    <tr class="bugtask-collapsible-content hidden" id="task2647493">
     <td colspan="7"><form action="/ubuntu/+source/apt/+bug/1899193/+editstatus" method="post" enctype="multipart/form-data">
  

  <p class="error message">
    You need to log in to change this bug's status.
  </p>
  
  <table class="summary" style="float: right; margin-left: 1em;">
    <tr>
      <th>Affecting:</th>
      <td><a href="/ubuntu/+source/apt">apt (Ubuntu)</a></td>
    </tr>
    <tr>
      <th>Filed here by:</th>
      <td><a href="https://launchpad.net/~kbackhouse2000" class="sprite person">kev</a></td>
    </tr>
    <tr>
      <th>When:</th>
      <td>
        <time title="2020-10-09 16:29:17 UTC" datetime="2020-10-09T16:29:17.457962+00:00">2020-10-09</time>
      </td>
    </tr>
    <tr>
      <th>Confirmed:</th>
      <td>
        <time title="2020-10-10 00:29:11 UTC" datetime="2020-10-10T00:29:11.985392+00:00">2020-10-10</time>
      </td>
    </tr>
    
    <tr>
      <th>Started work:</th>
      <td>
        <time title="2020-12-09 16:24:59 UTC" datetime="2020-12-09T16:24:59.483109+00:00">2020-12-09</time>
      </td>
    </tr>
    <tr>
      <th>Completed:</th>
      <td>
        <time title="2020-12-09 16:24:59 UTC" datetime="2020-12-09T16:24:59.483109+00:00">2020-12-09</time>
      </td>
    </tr>
  </table>
  <div class="field">
    <table>
      <tr>
        <td>
          <label for="ubuntu_apt.target">Target</label>
        </td>
      </tr>
      <tr>
        <td>
          <table>
  <tr>
    <td>
      <label>
        <input class="radioType" checked="checked" id="ubuntu_apt.target.option.package" name="ubuntu_apt.target" type="radio" value="package" />
        Distribution
      </label>
    </td>
    <td>
      <select id="ubuntu_apt.target.distribution" name="ubuntu_apt.target.distribution" size="1" >
<option value="baltix">Baltix</option>
<option value="boss">BOSS</option>
<option value="charms">Juju Charms Collection</option>
<option value="elbuntu">Elbuntu</option>
<option value="guadalinex">Guadalinex</option>
<option value="guadalinexedu">Guadalinex Edu</option>
<option value="kiwilinux">Kiwi Linux</option>
<option value="nubuntu">nUbuntu</option>
<option value="pld-linux">PLD Linux</option>
<option value="tilix">Tilix</option>
<option value="tuxlab">tuXlab</option>
<option selected="selected" value="ubuntu">Ubuntu</option>
<option value="ubuntu-leb">Ubuntu Linaro Evaluation Build</option>
<option value="ubuntu-rtm">Ubuntu RTM</option>
</select>
<input name="ubuntu_apt.target.distribution-empty-marker" type="hidden" value="1" />
    </td>
  </tr>
  <tr>
    <td align="right">
      <label for="ubuntu_apt.target.option.package">
        Package
      </label>
    </td>
    <td>
      


    <input type="text" value="apt" id="ubuntu_apt.target.package"
                         name="ubuntu_apt.target.package" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;ubuntu_apt.target.option.package&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('ubuntu_apt.target.package');
              var select_menu = Y.DOM.byId('ubuntu_apt.target.package-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-ubuntu_apt-target-package" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"remove_person_text": "Remove person", "picker_type": "default", "extra_no_results_message": null, "header": "Select a package", "vocabulary_filters": [], "input_element": "ubuntu_apt.target.package", "show_remove_button": false, "show_assign_me_button": false, "step_title": "Search by name", "show_widget_id": "show-widget-ubuntu_apt-target-package", "selected_value": "apt", "selected_value_metadata": null, "remove_team_text": "Remove team", "assign_me_text": "Pick me", "show_create_team": false, "vocabulary_name": "DistributionPackage"};
        var show_widget_id = 'show-widget-ubuntu_apt-target-package';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>

  <tr>
    <td>
      <label>
        <input class="radioType" id="ubuntu_apt.target.option.product" name="ubuntu_apt.target" type="radio" value="product" />
       Project
      </label>
    </td>
    <td>
      


    <input type="text" value="" id="ubuntu_apt.target.product"
                         name="ubuntu_apt.target.product" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;ubuntu_apt.target.option.product&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('ubuntu_apt.target.product');
              var select_menu = Y.DOM.byId('ubuntu_apt.target.product-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-ubuntu_apt-target-product" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"remove_person_text": "Remove person", "picker_type": "default", "extra_no_results_message": null, "header": "Select a project", "vocabulary_filters": [], "input_element": "ubuntu_apt.target.product", "show_remove_button": false, "show_assign_me_button": false, "step_title": "Search", "show_widget_id": "show-widget-ubuntu_apt-target-product", "selected_value": null, "selected_value_metadata": null, "remove_team_text": "Remove team", "assign_me_text": "Pick me", "show_create_team": false, "vocabulary_name": "Product"};
        var show_widget_id = 'show-widget-ubuntu_apt-target-product';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>
</table>

          
        </td>
      </tr>
    </table>
    
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="ubuntu_apt.status">Status</label>
        </td>
        <td>
          <label style="font-weight: bold" for="ubuntu_apt.importance">Importance</label>
        </td>
        
      </tr>
      <tr>
        <td><div>
<div class="value">
<select id="ubuntu_apt.status" name="ubuntu_apt.status" size="1" >
<option selected="selected" value="Fix Released">Fix Released</option>
</select>
</div>
<input name="ubuntu_apt.status-empty-marker" type="hidden" value="1" />
</div></td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          <span class="importanceUNDECIDED">Undecided</span>
        </td>
        
      </tr>
    </table>
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="ubuntu_apt.assignee">Assigned to</label>
        </td>
      </tr>
      <tr>
        <td colspan="2" style="white-space: nowrap">

  <table>
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" checked="checked" id="ubuntu_apt.assignee.assign_to_nobody" name="ubuntu_apt.assignee.option" value="ubuntu_apt.assignee.assign_to_nobody" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="ubuntu_apt.assignee.assign_to_nobody">
          Nobody
        </label>
      </td>
    </tr>
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" id="ubuntu_apt.assignee.assign_to_me" name="ubuntu_apt.assignee.option" value="ubuntu_apt.assignee.assign_to_me" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="ubuntu_apt.assignee.assign_to_me">
          Me
        </label>
      </td>
    </tr>
    
    
  </table>


</td>
      </tr>
    </table>
    
  </div>
  <div class="field">
    <div>
      <label style="font-weight: bold" for="ubuntu_apt.comment_on_change">Comment on this change (optional)</label>
      <textarea cols="62" rows="4" id="ubuntu_apt.comment_on_change" name="ubuntu_apt.comment_on_change"></textarea>
    </div>
    <div>
      <label style="font-weight: normal">
        <input type="checkbox" name="subscribe" id="subscribe" value="Subscribe" />
        Email me about changes to this bug report
      </label>
    </div>
  </div>
  
</form>
</td>
    </tr>
  


        
        
          
  <tr id="tasksummary2661827">
    <td>
      <a class="bugtask-expander" href="https://bugs.launchpad.net/ubuntu/+source/aptdaemon/+bug/1899193/+editstatus">
        &#8203;
      </a>
    </td>
    
    <td>
      <span id="bugtarget-picker-tasksummary2661827">
        <span class="yui3-activator-data-box">
            <a class="sprite package-source" href="https://bugs.launchpad.net/ubuntu/+source/aptdaemon" title="Latest release: 1.1.1+bzr982-0ubuntu36, uploaded to main on 2020-12-11 15:00:09.770255+00:00 by Marc Deslauriers (mdeslaur), maintained by Ubuntu Developers (ubuntu-devel-discuss-lists)">aptdaemon (Ubuntu)</a>
        </span>
        <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
          Edit
        </button>
        <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        
      </span>
    </td>

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/ubuntu/+source/aptdaemon/+bug/1899193/+editstatus" style="float: left" class="value statusFIXRELEASED">Fix Released</a>
          <a href="https://bugs.launchpad.net/ubuntu/+source/aptdaemon/+bug/1899193/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceUNDECIDED">Undecided</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary2661827">
          <span class="yui3-activator-data-box">
            
            
              Unassigned
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      <div class="milestone-content" style="width: 100%; float: left">
        
        <a class="value" href=""></a>
        
      </div>
    </td>

    
  </tr>

  
    <tr class="bugtask-collapsible-content hidden" id="task2661827">
     <td colspan="7"><form action="/ubuntu/+source/aptdaemon/+bug/1899193/+editstatus" method="post" enctype="multipart/form-data">
  

  <p class="error message">
    You need to log in to change this bug's status.
  </p>
  
  <table class="summary" style="float: right; margin-left: 1em;">
    <tr>
      <th>Affecting:</th>
      <td><a href="/ubuntu/+source/aptdaemon">aptdaemon (Ubuntu)</a></td>
    </tr>
    <tr>
      <th>Filed here by:</th>
      <td><a href="https://launchpad.net/~juliank" class="sprite person">Julian Andres Klode</a></td>
    </tr>
    <tr>
      <th>When:</th>
      <td>
        <time title="2020-12-01 19:32:44 UTC" datetime="2020-12-01T19:32:44.096642+00:00">2020-12-01</time>
      </td>
    </tr>
    <tr>
      <th>Confirmed:</th>
      <td>
        <time title="2020-12-08 15:51:40 UTC" datetime="2020-12-08T15:51:40.158939+00:00">2020-12-08</time>
      </td>
    </tr>
    
    <tr>
      <th>Started work:</th>
      <td>
        <time title="2020-12-08 15:51:40 UTC" datetime="2020-12-08T15:51:40.158939+00:00">2020-12-08</time>
      </td>
    </tr>
    <tr>
      <th>Completed:</th>
      <td>
        <time title="2020-12-08 15:51:40 UTC" datetime="2020-12-08T15:51:40.158939+00:00">2020-12-08</time>
      </td>
    </tr>
  </table>
  <div class="field">
    <table>
      <tr>
        <td>
          <label for="ubuntu_aptdaemon.target">Target</label>
        </td>
      </tr>
      <tr>
        <td>
          <table>
  <tr>
    <td>
      <label>
        <input class="radioType" checked="checked" id="ubuntu_aptdaemon.target.option.package" name="ubuntu_aptdaemon.target" type="radio" value="package" />
        Distribution
      </label>
    </td>
    <td>
      <select id="ubuntu_aptdaemon.target.distribution" name="ubuntu_aptdaemon.target.distribution" size="1" >
<option value="baltix">Baltix</option>
<option value="boss">BOSS</option>
<option value="charms">Juju Charms Collection</option>
<option value="elbuntu">Elbuntu</option>
<option value="guadalinex">Guadalinex</option>
<option value="guadalinexedu">Guadalinex Edu</option>
<option value="kiwilinux">Kiwi Linux</option>
<option value="nubuntu">nUbuntu</option>
<option value="pld-linux">PLD Linux</option>
<option value="tilix">Tilix</option>
<option value="tuxlab">tuXlab</option>
<option selected="selected" value="ubuntu">Ubuntu</option>
<option value="ubuntu-leb">Ubuntu Linaro Evaluation Build</option>
<option value="ubuntu-rtm">Ubuntu RTM</option>
</select>
<input name="ubuntu_aptdaemon.target.distribution-empty-marker" type="hidden" value="1" />
    </td>
  </tr>
  <tr>
    <td align="right">
      <label for="ubuntu_aptdaemon.target.option.package">
        Package
      </label>
    </td>
    <td>
      


    <input type="text" value="aptdaemon" id="ubuntu_aptdaemon.target.package"
                         name="ubuntu_aptdaemon.target.package" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;ubuntu_aptdaemon.target.option.package&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('ubuntu_aptdaemon.target.package');
              var select_menu = Y.DOM.byId('ubuntu_aptdaemon.target.package-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-ubuntu_aptdaemon-target-package" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"remove_person_text": "Remove person", "picker_type": "default", "extra_no_results_message": null, "header": "Select a package", "vocabulary_filters": [], "input_element": "ubuntu_aptdaemon.target.package", "show_remove_button": false, "show_assign_me_button": false, "step_title": "Search by name", "show_widget_id": "show-widget-ubuntu_aptdaemon-target-package", "selected_value": "aptdaemon", "selected_value_metadata": null, "remove_team_text": "Remove team", "assign_me_text": "Pick me", "show_create_team": false, "vocabulary_name": "DistributionPackage"};
        var show_widget_id = 'show-widget-ubuntu_aptdaemon-target-package';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>

  <tr>
    <td>
      <label>
        <input class="radioType" id="ubuntu_aptdaemon.target.option.product" name="ubuntu_aptdaemon.target" type="radio" value="product" />
       Project
      </label>
    </td>
    <td>
      


    <input type="text" value="" id="ubuntu_aptdaemon.target.product"
                         name="ubuntu_aptdaemon.target.product" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;ubuntu_aptdaemon.target.option.product&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('ubuntu_aptdaemon.target.product');
              var select_menu = Y.DOM.byId('ubuntu_aptdaemon.target.product-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-ubuntu_aptdaemon-target-product" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"remove_person_text": "Remove person", "picker_type": "default", "extra_no_results_message": null, "header": "Select a project", "vocabulary_filters": [], "input_element": "ubuntu_aptdaemon.target.product", "show_remove_button": false, "show_assign_me_button": false, "step_title": "Search", "show_widget_id": "show-widget-ubuntu_aptdaemon-target-product", "selected_value": null, "selected_value_metadata": null, "remove_team_text": "Remove team", "assign_me_text": "Pick me", "show_create_team": false, "vocabulary_name": "Product"};
        var show_widget_id = 'show-widget-ubuntu_aptdaemon-target-product';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>
</table>

          
        </td>
      </tr>
    </table>
    
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="ubuntu_aptdaemon.status">Status</label>
        </td>
        <td>
          <label style="font-weight: bold" for="ubuntu_aptdaemon.importance">Importance</label>
        </td>
        
      </tr>
      <tr>
        <td><div>
<div class="value">
<select id="ubuntu_aptdaemon.status" name="ubuntu_aptdaemon.status" size="1" >
<option selected="selected" value="Fix Released">Fix Released</option>
</select>
</div>
<input name="ubuntu_aptdaemon.status-empty-marker" type="hidden" value="1" />
</div></td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          <span class="importanceUNDECIDED">Undecided</span>
        </td>
        
      </tr>
    </table>
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="ubuntu_aptdaemon.assignee">Assigned to</label>
        </td>
      </tr>
      <tr>
        <td colspan="2" style="white-space: nowrap">

  <table>
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" checked="checked" id="ubuntu_aptdaemon.assignee.assign_to_nobody" name="ubuntu_aptdaemon.assignee.option" value="ubuntu_aptdaemon.assignee.assign_to_nobody" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="ubuntu_aptdaemon.assignee.assign_to_nobody">
          Nobody
        </label>
      </td>
    </tr>
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" id="ubuntu_aptdaemon.assignee.assign_to_me" name="ubuntu_aptdaemon.assignee.option" value="ubuntu_aptdaemon.assignee.assign_to_me" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="ubuntu_aptdaemon.assignee.assign_to_me">
          Me
        </label>
      </td>
    </tr>
    
    
  </table>


</td>
      </tr>
    </table>
    
  </div>
  <div class="field">
    <div>
      <label style="font-weight: bold" for="ubuntu_aptdaemon.comment_on_change">Comment on this change (optional)</label>
      <textarea cols="62" rows="4" id="ubuntu_aptdaemon.comment_on_change" name="ubuntu_aptdaemon.comment_on_change"></textarea>
    </div>
    <div>
      <label style="font-weight: normal">
        <input type="checkbox" name="subscribe" id="subscribe" value="Subscribe" />
        Email me about changes to this bug report
      </label>
    </div>
  </div>
  
</form>
</td>
    </tr>
  


        
        
          
  <tr id="tasksummary2649608">
    <td>
      <a class="bugtask-expander" href="https://bugs.launchpad.net/ubuntu/+source/python-apt/+bug/1899193/+editstatus">
        &#8203;
      </a>
    </td>
    
    <td>
      <span id="bugtarget-picker-tasksummary2649608">
        <span class="yui3-activator-data-box">
            <a class="sprite package-source" href="https://bugs.launchpad.net/ubuntu/+source/python-apt" title="Latest release: 2.3.0, uploaded to main on 2021-10-22 16:43:07.706914+00:00 by APT Development Team (deity), maintained by APT Development Team (deity)">python-apt (Ubuntu)</a>
        </span>
        <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
          Edit
        </button>
        <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        
      </span>
    </td>

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/ubuntu/+source/python-apt/+bug/1899193/+editstatus" style="float: left" class="value statusFIXRELEASED">Fix Released</a>
          <a href="https://bugs.launchpad.net/ubuntu/+source/python-apt/+bug/1899193/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceUNDECIDED">Undecided</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary2649608">
          <span class="yui3-activator-data-box">
            
            
              Unassigned
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      <div class="milestone-content" style="width: 100%; float: left">
        
        <a class="value" href=""></a>
        
      </div>
    </td>

    
  </tr>

  
    <tr class="bugtask-collapsible-content hidden" id="task2649608">
     <td colspan="7"><form action="/ubuntu/+source/python-apt/+bug/1899193/+editstatus" method="post" enctype="multipart/form-data">
  

  <p class="error message">
    You need to log in to change this bug's status.
  </p>
  
  <table class="summary" style="float: right; margin-left: 1em;">
    <tr>
      <th>Affecting:</th>
      <td><a href="/ubuntu/+source/python-apt">python-apt (Ubuntu)</a></td>
    </tr>
    <tr>
      <th>Filed here by:</th>
      <td><a href="https://launchpad.net/~juliank" class="sprite person">Julian Andres Klode</a></td>
    </tr>
    <tr>
      <th>When:</th>
      <td>
        <time title="2020-10-19 11:29:31 UTC" datetime="2020-10-19T11:29:31.153011+00:00">2020-10-19</time>
      </td>
    </tr>
    <tr>
      <th>Confirmed:</th>
      <td>
        <time title="2020-10-19 11:33:13 UTC" datetime="2020-10-19T11:33:13.745609+00:00">2020-10-19</time>
      </td>
    </tr>
    
    <tr>
      <th>Started work:</th>
      <td>
        <time title="2020-12-09 16:32:37 UTC" datetime="2020-12-09T16:32:37.076201+00:00">2020-12-09</time>
      </td>
    </tr>
    <tr>
      <th>Completed:</th>
      <td>
        <time title="2020-12-09 16:32:37 UTC" datetime="2020-12-09T16:32:37.076201+00:00">2020-12-09</time>
      </td>
    </tr>
  </table>
  <div class="field">
    <table>
      <tr>
        <td>
          <label for="ubuntu_python-apt.target">Target</label>
        </td>
      </tr>
      <tr>
        <td>
          <table>
  <tr>
    <td>
      <label>
        <input class="radioType" checked="checked" id="ubuntu_python-apt.target.option.package" name="ubuntu_python-apt.target" type="radio" value="package" />
        Distribution
      </label>
    </td>
    <td>
      <select id="ubuntu_python-apt.target.distribution" name="ubuntu_python-apt.target.distribution" size="1" >
<option value="baltix">Baltix</option>
<option value="boss">BOSS</option>
<option value="charms">Juju Charms Collection</option>
<option value="elbuntu">Elbuntu</option>
<option value="guadalinex">Guadalinex</option>
<option value="guadalinexedu">Guadalinex Edu</option>
<option value="kiwilinux">Kiwi Linux</option>
<option value="nubuntu">nUbuntu</option>
<option value="pld-linux">PLD Linux</option>
<option value="tilix">Tilix</option>
<option value="tuxlab">tuXlab</option>
<option selected="selected" value="ubuntu">Ubuntu</option>
<option value="ubuntu-leb">Ubuntu Linaro Evaluation Build</option>
<option value="ubuntu-rtm">Ubuntu RTM</option>
</select>
<input name="ubuntu_python-apt.target.distribution-empty-marker" type="hidden" value="1" />
    </td>
  </tr>
  <tr>
    <td align="right">
      <label for="ubuntu_python-apt.target.option.package">
        Package
      </label>
    </td>
    <td>
      


    <input type="text" value="python-apt" id="ubuntu_python-apt.target.package"
                         name="ubuntu_python-apt.target.package" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;ubuntu_python-apt.target.option.package&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('ubuntu_python-apt.target.package');
              var select_menu = Y.DOM.byId('ubuntu_python-apt.target.package-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-ubuntu_python-apt-target-package" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"remove_person_text": "Remove person", "picker_type": "default", "extra_no_results_message": null, "header": "Select a package", "vocabulary_filters": [], "input_element": "ubuntu_python-apt.target.package", "show_remove_button": false, "show_assign_me_button": false, "step_title": "Search by name", "show_widget_id": "show-widget-ubuntu_python-apt-target-package", "selected_value": "python-apt", "selected_value_metadata": null, "remove_team_text": "Remove team", "assign_me_text": "Pick me", "show_create_team": false, "vocabulary_name": "DistributionPackage"};
        var show_widget_id = 'show-widget-ubuntu_python-apt-target-package';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>

  <tr>
    <td>
      <label>
        <input class="radioType" id="ubuntu_python-apt.target.option.product" name="ubuntu_python-apt.target" type="radio" value="product" />
       Project
      </label>
    </td>
    <td>
      


    <input type="text" value="" id="ubuntu_python-apt.target.product"
                         name="ubuntu_python-apt.target.product" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;ubuntu_python-apt.target.option.product&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('ubuntu_python-apt.target.product');
              var select_menu = Y.DOM.byId('ubuntu_python-apt.target.product-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-ubuntu_python-apt-target-product" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"remove_person_text": "Remove person", "picker_type": "default", "extra_no_results_message": null, "header": "Select a project", "vocabulary_filters": [], "input_element": "ubuntu_python-apt.target.product", "show_remove_button": false, "show_assign_me_button": false, "step_title": "Search", "show_widget_id": "show-widget-ubuntu_python-apt-target-product", "selected_value": null, "selected_value_metadata": null, "remove_team_text": "Remove team", "assign_me_text": "Pick me", "show_create_team": false, "vocabulary_name": "Product"};
        var show_widget_id = 'show-widget-ubuntu_python-apt-target-product';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>
</table>

          
        </td>
      </tr>
    </table>
    
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="ubuntu_python-apt.status">Status</label>
        </td>
        <td>
          <label style="font-weight: bold" for="ubuntu_python-apt.importance">Importance</label>
        </td>
        
      </tr>
      <tr>
        <td><div>
<div class="value">
<select id="ubuntu_python-apt.status" name="ubuntu_python-apt.status" size="1" >
<option selected="selected" value="Fix Released">Fix Released</option>
</select>
</div>
<input name="ubuntu_python-apt.status-empty-marker" type="hidden" value="1" />
</div></td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          <span class="importanceUNDECIDED">Undecided</span>
        </td>
        
      </tr>
    </table>
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="ubuntu_python-apt.assignee">Assigned to</label>
        </td>
      </tr>
      <tr>
        <td colspan="2" style="white-space: nowrap">

  <table>
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" checked="checked" id="ubuntu_python-apt.assignee.assign_to_nobody" name="ubuntu_python-apt.assignee.option" value="ubuntu_python-apt.assignee.assign_to_nobody" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="ubuntu_python-apt.assignee.assign_to_nobody">
          Nobody
        </label>
      </td>
    </tr>
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" id="ubuntu_python-apt.assignee.assign_to_me" name="ubuntu_python-apt.assignee.option" value="ubuntu_python-apt.assignee.assign_to_me" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="ubuntu_python-apt.assignee.assign_to_me">
          Me
        </label>
      </td>
    </tr>
    
    
  </table>


</td>
      </tr>
    </table>
    
  </div>
  <div class="field">
    <div>
      <label style="font-weight: bold" for="ubuntu_python-apt.comment_on_change">Comment on this change (optional)</label>
      <textarea cols="62" rows="4" id="ubuntu_python-apt.comment_on_change" name="ubuntu_python-apt.comment_on_change"></textarea>
    </div>
    <div>
      <label style="font-weight: normal">
        <input type="checkbox" name="subscribe" id="subscribe" value="Subscribe" />
        Email me about changes to this bug report
      </label>
    </div>
  </div>
  
</form>
</td>
    </tr>
  


        
      </tbody>

    </table>



<div class="actions">
  
    <span id="also-affects-product" class="">
    <a class="menu-link-addupstream sprite add" href="https://bugs.launchpad.net/ubuntu/+source/apt/+bug/1899193/+choose-affected-product">Also affects project</a>
        <a href="/+help-bugs/also-affects-project-help.html" target="help" class="sprite maybe action-icon">(?)</a>
    </span>
    <span id="also-affects-package" class="">
    <a class="menu-link-adddistro sprite add" href="https://bugs.launchpad.net/ubuntu/+source/apt/+bug/1899193/+distrotask">Also affects distribution/package</a>
    </span>
    <a class="menu-link-nominate sprite milestone" href="https://bugs.launchpad.net/ubuntu/+source/apt/+bug/1899193/+nominate">Nominate for series</a>
    
  

</div>




      <div id="maincontentsub">
        <div class="top-portlet">

      <div itemprop="mainContentOfPage" class="report">
        

        <div>
  <div class="lazr-multiline-edit" id="edit-description">
  <div class="clearfix">
    

    <h3>Bug Description</h3>
  </div>

  <div class="yui3-editable_text-text"><p># GitHub Security Lab (GHSL) Vulnerability Report: `GHSL-2020-168`, `GHSL-2020-169`, `GHSL-2020-170`</p>
<p>The [GitHub Security Lab](<a rel="nofollow" href="https://securitylab.github.com">https:/<wbr />/securitylab.<wbr />github.<wbr />com</a>) team has identified potential security vulnerabilities in aptd.</p>
<p>We are committed to working with you to help resolve these issues. In this report you will find everything you need to effectively coordinate a resolution of these issues with the GHSL team.</p>
<p>If at any point you have concerns or questions about this process, please do not hesitate to reach out to us at `&lt;email address hidden&gt;` (please include `GHSL-2020-168`, `GHSL-2020-169`, or `GHSL-2020-170` as a reference).</p>
<p>If you are _NOT_ the correct point of contact for this report, please let us know!</p>
<p>## Summary</p>
<p>The aptd daemon is a system service for installing and updating packages. It is accessible via [dbus](<a rel="nofollow" href="https://www.freedesktop.org/wiki/Software/dbus/">https:/<wbr />/www.freedeskto<wbr />p.org/wiki/<wbr />Software/<wbr />dbus/</a>) and has a method named &quot;InstallFile&quot; which is used for installing local `.deb` packages. Although polkit is used to prevent an unprivileged user from using &quot;InstallFile&quot; to install a malicious `.deb` package, it does not prevent aptd from parsing the contents of the `.deb` file. The parsing logic is provided by two packages, [libapt-pkg-dev](<a rel="nofollow" href="https://packages.ubuntu.com/focal/libapt-pkg-dev">https:/<wbr />/packages.<wbr />ubuntu.<wbr />com/focal/<wbr />libapt-<wbr />pkg-dev</a>) and [python-apt](<a rel="nofollow" href="https://packages.ubuntu.com/source/focal/python-apt">https:/<wbr />/packages.<wbr />ubuntu.<wbr />com/source/<wbr />focal/python-<wbr />apt</a>), and is implemented in C. These two packages contain several bugs, which an unprivileged user can exploit to trigger a local denial of service attack.</p>
<p>## Product</p>
<p>aptd</p>
<p>## Tested Version</p>
<p>* libapt-pkg-dev: version 2.0.2ubuntu0.1<br />
* python-apt: 2.0.0ubuntu0.<wbr />20.04.1<br />
* Tested on Ubuntu 20.04.1 LTS</p>
<p>## Details</p>
<p>### Issue 1: aptd crash due to integer overflow in arfile.cc (GHSL-2020-168)</p>
<p>A crafted `.deb` package can trigger a negative integer overflow at [arfile.cc, line 116](<a rel="nofollow" href="https://git.launchpad.net/ubuntu/+source/apt/tree/apt-pkg/contrib/arfile.cc?h=applied/ubuntu/focal-updates&amp;id=4c264e60b524855b211751e1632ba48526f6b44d#n116">https:/<wbr />/git.launchpad.<wbr />net/ubuntu/<wbr />+source/<wbr />apt/tree/<wbr />apt-pkg/<wbr />contrib/<wbr />arfile.<wbr />cc?h=applied/<wbr />ubuntu/<wbr />focal-updates&amp;<wbr />id=4c264e60b524<wbr />855b211751e1632<wbr />ba48526f6b44d#<wbr />n116</a>):</p>
<p>```c<br />
Memb-&gt;Size -= Len;<br />
```</p>
<p>Due to the integer overflow, the value of `Memb-&gt;Size` is `0xFFFFFFFFFFFF<wbr />FFFF`. This leads to an out-of-memory error at [arfile.cc, line 602](<a rel="nofollow" href="https://git.launchpad.net/ubuntu/+source/python-apt/tree/python/arfile.cc?h=applied/ubuntu/focal-updates&amp;id=0f7cc93acdb51d943114f1cd79002288c4ca4d24#n602">https:/<wbr />/git.launchpad.<wbr />net/ubuntu/<wbr />+source/<wbr />python-<wbr />apt/tree/<wbr />python/<wbr />arfile.<wbr />cc?h=applied/<wbr />ubuntu/<wbr />focal-updates&amp;<wbr />id=0f7cc93acdb5<wbr />1d943114f1cd790<wbr />02288c4ca4d24#<wbr />n602</a>):</p>
<p>```c<br />
char* value = new char[member-&gt;Size];<br />
```</p>
<p>The out-of-memory error causes aptd to crash.</p>
<p>Please note that the source locations above refer to two separate files, both named `arfile.cc`. The first is from the libapt-pkg-dev package and the second is from the python-apt package.</p>
<p>To trigger the crash, first use the attached source file named &quot;createdeb.c&quot; to generate the malicious `.deb` file:</p>
<p>```bash<br />
gcc createdeb.c -o createdeb<br />
./createdeb crash test.deb<br />
```</p>
<p>Now use `dbus-send` to send the malicious `.deb` file to aptd:</p>
<p>```bash<br />
$ dbus-send --system --type=<wbr />&quot;method_<wbr />call&quot; --print-reply --dest=<wbr />org.debian.<wbr />apt /org/debian/apt org.debian.<wbr />apt.InstallFile string:`realpath test.deb` boolean:true<br />
method return time=1602245339<wbr />.731762 sender=:1.287 -&gt; destination=:1.288 serial=8 reply_serial=2<br />
&nbsp;&nbsp;&nbsp;string &quot;/org/debian/<wbr />apt/transaction<wbr />/90f29de9308545<wbr />68964af1918f6ca<wbr />5eb&quot;<br />
$ dbus-send --system --type=<wbr />&quot;method_<wbr />call&quot; --print-reply --dest=<wbr />org.debian.<wbr />apt /org/debian/<wbr />apt/transaction<wbr />/90f29de9308545<wbr />68964af1918f6ca<wbr />5eb org.debian.<wbr />apt.transaction<wbr />.Run<br />
```</p>
<p>Note that you need to use the &quot;transaction id&quot; returned by the first `dbus-send` in the second `dbus-send` command.</p>
<p>#### Impact</p>
<p>This issue may lead to local denial of service.</p>
<p>#### Resources</p>
<p>I have attached `createdeb.c`, which can be used to generate the malicious `.deb` file.</p>
<p>### Issue 2: aptd infinite loop due to integer overflow in arfile.cc (GHSL-2020-169)</p>
<p>This issue is very similar to issue 1, but is caused by a different bug. This bug occurs during the call to `StrToNum` at [arfile.cc, line 92](<a rel="nofollow" href="https://git.launchpad.net/ubuntu/+source/apt/tree/apt-pkg/contrib/arfile.cc?h=applied/ubuntu/focal-updates&amp;id=4c264e60b524855b211751e1632ba48526f6b44d#n92">https:/<wbr />/git.launchpad.<wbr />net/ubuntu/<wbr />+source/<wbr />apt/tree/<wbr />apt-pkg/<wbr />contrib/<wbr />arfile.<wbr />cc?h=applied/<wbr />ubuntu/<wbr />focal-updates&amp;<wbr />id=4c264e60b524<wbr />855b211751e1632<wbr />ba48526f6b44d#<wbr />n92</a>):</p>
<p>```c<br />
StrToNum(<wbr />Head.Size,<wbr />Memb-&gt;Size,<wbr />sizeof(<wbr />Head.Size)<wbr />) == false)<br />
```</p>
<p>The bug is due to the use of `strtoul` in [StrToNum](<a rel="nofollow" href="https://git.launchpad.net/ubuntu/+source/apt/tree/apt-pkg/contrib/strutl.cc?h=applied/ubuntu/focal-updates&amp;id=4c264e60b524855b211751e1632ba48526f6b44d#n1169">https:/<wbr />/git.launchpad.<wbr />net/ubuntu/<wbr />+source/<wbr />apt/tree/<wbr />apt-pkg/<wbr />contrib/<wbr />strutl.<wbr />cc?h=applied/<wbr />ubuntu/<wbr />focal-updates&amp;<wbr />id=4c264e60b524<wbr />855b211751e1632<wbr />ba48526f6b44d#<wbr />n1169</a>):</p>
<p>```c<br />
// StrToNum - Convert a fixed length string to a number			/*{{{*/<br />
// -------<wbr />-------<wbr />-------<wbr />-------<wbr />-------<wbr />-------<wbr />-------<wbr />-------<wbr />-------<wbr />------<br />
/* This is used in decoding the crazy fixed length string headers in<br />
&nbsp;&nbsp;&nbsp;tar and ar files. */<br />
bool StrToNum(const char *Str,unsigned long &amp;Res,unsigned Len,unsigned Base)<br />
{<br />
&nbsp;&nbsp;&nbsp;char S[30];<br />
&nbsp;&nbsp;&nbsp;if (Len &gt;= sizeof(S))<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return false;<br />
&nbsp;&nbsp;&nbsp;memcpy(<wbr />S,Str,Len)<wbr />;<br />
&nbsp;&nbsp;&nbsp;S[Len] = 0;</p>
<p>&nbsp;&nbsp;&nbsp;// All spaces is a zero<br />
&nbsp;&nbsp;&nbsp;Res = 0;<br />
&nbsp;&nbsp;&nbsp;unsigned I;<br />
&nbsp;&nbsp;&nbsp;for (I = 0; S[I] == &#x27; &#x27;; I++);<br />
&nbsp;&nbsp;&nbsp;if (S[I] == 0)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return true;</p>
<p>&nbsp;&nbsp;&nbsp;char *End;<br />
&nbsp;&nbsp;&nbsp;Res = strtoul(<wbr />S,&amp;End,<wbr />Base);  &lt;====== negative numbers accepted<br />
&nbsp;&nbsp;&nbsp;if (End == S)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return false;</p>
<p>&nbsp;&nbsp;&nbsp;return true;<br />
}<br />
```</p>
<p>The bug is that `strtoul` allows the number to be negative. For example, it will accept the string &quot;-60&quot;. I have written a proof-of-concept exploit which uses this to put the parser into an infinite loop.</p>
<p>To run the proof-of-concept, first use the attached source file named &quot;createdeb.c&quot; to generate the malicious `.deb` file:</p>
<p>```bash<br />
gcc createdeb.c -o createdeb<br />
./createdeb loop test.deb<br />
```</p>
<p>Now use `dbus-send` to send the malicious `.deb` file to aptd:</p>
<p>```bash<br />
$ dbus-send --system --type=<wbr />&quot;method_<wbr />call&quot; --print-reply --dest=<wbr />org.debian.<wbr />apt /org/debian/apt org.debian.<wbr />apt.InstallFile string:`realpath test.deb` boolean:true<br />
method return time=1602245339<wbr />.731762 sender=:1.287 -&gt; destination=:1.288 serial=8 reply_serial=2<br />
&nbsp;&nbsp;&nbsp;string &quot;/org/debian/<wbr />apt/transaction<wbr />/90f29de9308545<wbr />68964af1918f6ca<wbr />5eb&quot;<br />
$ dbus-send --system --type=<wbr />&quot;method_<wbr />call&quot; --print-reply --dest=<wbr />org.debian.<wbr />apt /org/debian/<wbr />apt/transaction<wbr />/90f29de9308545<wbr />68964af1918f6ca<wbr />5eb org.debian.<wbr />apt.transaction<wbr />.Run<br />
```</p>
<p>Note that you need to use the &quot;transaction id&quot; returned by the first `dbus-send` in the second `dbus-send` command.</p>
<p>#### Impact</p>
<p>This issue may lead to local denial of service.</p>
<p>#### Resources</p>
<p>I have attached `createdeb.c`, which can be used to generate the malicious `.deb` file.</p>
<p>### Issue 3: aptd file descriptor leak (GHSL-2020-170)</p>
<p>There is a file descriptor leak in `debfile_new` at [arfile.cc, line 588](<a rel="nofollow" href="https://git.launchpad.net/ubuntu/+source/python-apt/tree/python/arfile.cc?h=applied/ubuntu/focal-updates&amp;id=0f7cc93acdb51d943114f1cd79002288c4ca4d24#n588">https:/<wbr />/git.launchpad.<wbr />net/ubuntu/<wbr />+source/<wbr />python-<wbr />apt/tree/<wbr />python/<wbr />arfile.<wbr />cc?h=applied/<wbr />ubuntu/<wbr />focal-updates&amp;<wbr />id=0f7cc93acdb5<wbr />1d943114f1cd790<wbr />02288c4ca4d24#<wbr />n588</a>):</p>
<p>```c<br />
static PyObject *debfile_<wbr />new(PyTypeObjec<wbr />t *type, PyObject *args, PyObject *kwds)<br />
{<br />
&nbsp;&nbsp;&nbsp;&nbsp;PyDebFileObject *self = (PyDebFileObjec<wbr />t*)ararchive_<wbr />new(type, args, kwds);<br />
&nbsp;&nbsp;&nbsp;&nbsp;if (self == NULL)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return NULL;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;// DebFile<br />
&nbsp;&nbsp;&nbsp;&nbsp;self-&gt;control = debfile_<wbr />get_tar(<wbr />self, &quot;control.tar&quot;);<br />
&nbsp;&nbsp;&nbsp;&nbsp;if (self-&gt;control == NULL)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return NULL;  &lt;===== self is not freed, so a file descriptor is leaked<br />
```</p>
<p>If the `.deb` file is invalid, then `debfile_new()` returns `NULL`, forgetting to free `self`. This means that the file descriptor for the `.deb` file is not closed. An attacker could use this to exhaust the system&#x27;s file descriptors, causing a local denial of service.</p>
<p>To run the proof-of-concept, first use the attached source file named &quot;createdeb.c&quot; to generate the malicious `.deb` file:</p>
<p>```bash<br />
gcc createdeb.c -o createdeb<br />
./createdeb leakfd test.deb<br />
```</p>
<p>Now use `dbus-send` to send the malicious `.deb` file to aptd:</p>
<p>```bash<br />
$ dbus-send --system --type=<wbr />&quot;method_<wbr />call&quot; --print-reply --dest=<wbr />org.debian.<wbr />apt /org/debian/apt org.debian.<wbr />apt.InstallFile string:`realpath test.deb` boolean:true<br />
method return time=1602245339<wbr />.731762 sender=:1.287 -&gt; destination=:1.288 serial=8 reply_serial=2<br />
&nbsp;&nbsp;&nbsp;string &quot;/org/debian/<wbr />apt/transaction<wbr />/90f29de9308545<wbr />68964af1918f6ca<wbr />5eb&quot;<br />
$ dbus-send --system --type=<wbr />&quot;method_<wbr />call&quot; --print-reply --dest=<wbr />org.debian.<wbr />apt /org/debian/<wbr />apt/transaction<wbr />/90f29de9308545<wbr />68964af1918f6ca<wbr />5eb org.debian.<wbr />apt.transaction<wbr />.Run<br />
```</p>
<p>Note that you need to use the &quot;transaction id&quot; returned by the first `dbus-send` in the second `dbus-send` command. Every time you run the PoC, aptd will open another file descriptor to the `.deb` file, which you can observe by running `lsof -p &lt;pid of aptd&gt;`.</p>
<p>#### Impact</p>
<p>This issue may lead to local denial of service.</p>
<p>#### Resources</p>
<p>I have attached `createdeb.c`, which can be used to generate the malicious `.deb` file.</p>
<p>## Credit</p>
<p>These issues were discovered and reported by GHSL team member [@kevinbackhouse (Kevin Backhouse)](<a rel="nofollow" href="https://github.com/kevinbackhouse">https:/<wbr />/github.<wbr />com/kevinbackho<wbr />use</a>).</p>
<p>## Contact</p>
<p>You can contact the GHSL team at `&lt;email address hidden&gt;`, please include a reference to `GHSL-2020-168`, `GHSL-2020-169`, or `GHSL-2020-170` in any communication regarding these issues.</p>
<p>## Disclosure Policy</p>
<p>This report is subject to our [coordinated disclosure policy](<a rel="nofollow" href="https://securitylab.github.com/disclosures#policy">https:/<wbr />/securitylab.<wbr />github.<wbr />com/disclosures<wbr />#policy</a>).</p></div>
  </div>

  
</div>


        <div style="margin:-10px 0 20px 5px" class="clearfix">
          
        </div>

        <div id="bug-tags">
          <span id="tags-heading">
            
          </span>
          <span id="tag-list">
          </span>
          <a href="+edit" title="Add tags" id="tags-trigger" class="sprite add">Add tags</a>
          
          <a href="/+help-bugs/tag-help.html" target="help" class="sprite maybe action-icon">Tag help</a>
        </div>

        <script type="text/javascript">
          LPJS.use('event', 'node', 'lp.bugs.tags_entry', function(Y) {
              Y.on('domready',
                   function(e) {
                       Y.lp.bugs.tags_entry.setup_tag_entry(
                           available_official_tags);
                   },
                   window);
          });
        </script>

        <div class="clearfix"></div>
      </div>

      <div id="branches-and-cves">
        <div id="bug-branches-container" style="float: left">
          
        </div><!-- bug-branch-container -->

        <div class="cves">
          <h2>CVE References</h2>
          <ul>
            <li class="sprite cve">
              <a href="/bugs/cve/2020-16128" title="The aptdaemon DBus interface disclose...">2020-16128</a>
            </li>
            <li class="sprite cve">
              <a href="/bugs/cve/2020-27349" title="Aptdaemon performed policykit checks ...">2020-27349</a>
            </li>
            <li class="sprite cve">
              <a href="/bugs/cve/2020-27350" title="APT had several integer overflows and...">2020-27350</a>
            </li>
            <li class="sprite cve">
              <a href="/bugs/cve/2020-27351" title="Various memory and file descriptor le...">2020-27351</a>
            </li>
          </ul>
        </div>

        <div class="clearfix"></div>
      </div> <!-- branches and CVEs -->

      </div>

      <div>
      
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/apt/+bug/1899193/comments/1" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~kbackhouse2000" class="sprite person">kev (kbackhouse2000)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-10-09T16:29:17.457962+00:00" title="2020-10-09 16:29:17 UTC">on 2020-10-09</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/apt/+bug/1899193/comments/1"> #1</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite download-icon" href="https://bugs.launchpad.net/ubuntu/+source/apt/+bug/1899193/+attachment/5420025/+files/createdeb.c">createdeb.c</a>
        <a class="sprite edit action-icon" href="/ubuntu/+source/apt/+bug/1899193/+attachment/5420025">Edit</a>
        (5.9 KiB,
        text/x-csrc)
      </li>
    </ul>

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10"></textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/apt/+bug/1899193/comments/2" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~seth-arnold" class="sprite person">Seth Arnold (seth-arnold)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-10-10T00:29:05.526288+00:00" title="2020-10-10 00:29:05 UTC">on 2020-10-10</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/apt/+bug/1899193/comments/2"> #2</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Hello Kevin, it&#x27;s good to hear from you again. Thanks for the excellent report and beautiful reproducer.</p>
<p>Julian, is this something you can look at?</p>
<p>Thanks</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Hello Kevin, it's good to hear from you again. Thanks for the excellent report and beautiful reproducer.

Julian, is this something you can look at?

Thanks</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in apt (Ubuntu): </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        New &#8594; Confirmed
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/apt/+bug/1899193/comments/3" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~juliank" class="sprite person">Julian Andres Klode (juliank)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-10-10T17:36:29.593125+00:00" title="2020-10-10 17:36:29 UTC">on 2020-10-10</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/apt/+bug/1899193/comments/3"> #3</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I don&#x27;t understand the focus on aptd here given that none of the bugs are in there, and I&#x27;ll have to see if I can come up with a reproducer to integrate with the tests, and see if it&#x27;s all fixable. This also affects package kit and apt itself, likely.</p>
<p>I don&#x27;t care all that much about denial of services, there are likely easier approaches than using these issues.</p>
<p>Also, shouldn&#x27;t they only be exploitable as root anyway? If not, we should really be worrying why we read deb files in the root daemon without having done policy kit checking.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I don't understand the focus on aptd here given that none of the bugs are in there, and I'll have to see if I can come up with a reproducer to integrate with the tests, and see if it's all fixable. This also affects package kit and apt itself, likely.

I don't care all that much about denial of services, there are likely easier approaches than using these issues. 

Also, shouldn't they only be exploitable as root anyway? If not, we should really be worrying why we read deb files in the root daemon without having done policy kit checking.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/apt/+bug/1899193/comments/4" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~kbackhouse2000" class="sprite person">kev (kbackhouse2000)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-10-12T12:22:03.666880+00:00" title="2020-10-12 12:22:03 UTC">on 2020-10-12</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/apt/+bug/1899193/comments/4"> #4</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Hi Julian,</p>
<p>I am sorry if reported this bug to the wrong package. I followed the &quot;bug reports&quot; link from this page: <a rel="nofollow" href="https://packages.ubuntu.com/focal/libapt-pkg-dev">https:/<wbr />/packages.<wbr />ubuntu.<wbr />com/focal/<wbr />libapt-<wbr />pkg-dev</a></p>
<p>These bugs do not require any privileges to trigger. As you say, I think part of the problem is that polkit checking is done too late. Although the main problem is, of course, the bugs in the C code.</p>
<p>Thanks,</p>
<p>Kev</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Hi Julian,

I am sorry if reported this bug to the wrong package. I followed the "bug reports" link from this page: https://packages.ubuntu.com/focal/libapt-pkg-dev

These bugs do not require any privileges to trigger. As you say, I think part of the problem is that polkit checking is done too late. Although the main problem is, of course, the bugs in the C code.

Thanks,

Kev</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/apt/+bug/1899193/comments/5" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~juliank" class="sprite person">Julian Andres Klode (juliank)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-10-12T16:58:40.470018+00:00" title="2020-10-12 16:58:40 UTC">on 2020-10-12</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/apt/+bug/1899193/comments/5"> #5</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Don&#x27;t worry, it&#x27;s in the right spot, I just thought it&#x27;s an aptdaemon bug from the messaging, but then it&#x27;s 3 (well 4) bugs spread all over apt, python-apt, and (policykit) aptdaemon.</p>
<p>Practically speaking, the main problem is the late policykit check, not the bugs in the C code, because once you passed that, you are in the trusted zone anyway. The package scripts run as root a few moments later anyway, and that gives me much better opportunities to do harm. Or you install setuid binaries.</p>
<p>In summary, the input to those daemons (and apt binaries) that run as root must be trusted. Now neither has (had for PK) appropriate checks at the right spot, so well, that&#x27;s bad. I wonder what QApt does.</p>
<p>Now, aptdaemon isn&#x27;t used much anymore past 16.04 - only for non-security updates, so the impact of DoS-ing aptdaemon is not the most critical out there, which is good. The rest installs via PackageKit or directly using apt (security updates). And I think aptdaemon does not acquire locks at the point where those issues happen, so security updates would still apply fine.</p>
<p>There is software where I think this is more critical, e.g. archive management like Launchpad and dak uses it to analyse packages, and you can then crash certain queues or hang them. Now Launchpad has some protection by running them separately, but I&#x27;m not sure how well it deals with those infinite loops - if one queue &quot;hangs&quot;. So basically, you can DoS whatever archive(s) you can upload too.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Don't worry, it's in the right spot, I just thought it's an aptdaemon bug from the messaging, but then it's 3 (well 4) bugs spread all over apt, python-apt, and (policykit) aptdaemon.

Practically speaking, the main problem is the late policykit check, not the bugs in the C code, because once you passed that, you are in the trusted zone anyway. The package scripts run as root a few moments later anyway, and that gives me much better opportunities to do harm. Or you install setuid binaries.

In summary, the input to those daemons (and apt binaries) that run as root must be trusted. Now neither has (had for PK) appropriate checks at the right spot, so well, that's bad. I wonder what QApt does.

Now, aptdaemon isn't used much anymore past 16.04 - only for non-security updates, so the impact of DoS-ing aptdaemon is not the most critical out there, which is good. The rest installs via PackageKit or directly using apt (security updates). And I think aptdaemon does not acquire locks at the point where those issues happen, so security updates would still apply fine.

There is software where I think this is more critical, e.g. archive management like Launchpad and dak uses it to analyse packages, and you can then crash certain queues or hang them. Now Launchpad has some protection by running them separately, but I'm not sure how well it deals with those infinite loops - if one queue "hangs". So basically, you can DoS whatever archive(s) you can upload too.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/apt/+bug/1899193/comments/6" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~juliank" class="sprite person">Julian Andres Klode (juliank)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-10-15T11:03:06.598045+00:00" title="2020-10-15 11:03:06 UTC">on 2020-10-15</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/apt/+bug/1899193/comments/6"> #6</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>#1 and #2 only require fixes in apt:</p>
<p>So #2. Is it really infinite, isn&#x27;t it basically too big? Similar to when you start reading the file, but the file is truncated.</p>
<p>Now, apparently we do require that we know the size of the arfile (which is stored in Left), so what we should do I guess is</p>
<p>if (Memb-&gt;Size &gt; Left) {<br />
&nbsp;&nbsp;&nbsp;&nbsp;delete Memb;<br />
&nbsp;&nbsp;&nbsp;&nbsp;return _error-<wbr />&gt;Error(<wbr />_(&quot;Invalid archive member header&quot;))<br />
}</p>
<p>which fixes the issue and also detects truncated files. Well, I guess the message could also say the archive is truncated, but everything else uses this message.</p>
<p>Now #1 we know that Memb-&gt;Size is as correct as it will get, so the step here seems to be to add</p>
<p>if (Len &gt; Memb-&gt;Size) {<br />
&nbsp;&nbsp;&nbsp;&nbsp;delete Memb;<br />
&nbsp;&nbsp;&nbsp;&nbsp;return _error-<wbr />&gt;Error(<wbr />_(&quot;Invalid archive member header&quot;))<br />
}</p>
<p>This ensures that the length we parse for the long name is shorter than the member, which is correct.</p>
<p>#3 needs wrapping object in a smart pointer so the fd is relased. This also needs similar changes in ararchive_new, and possibly a whole bunch of other code that opens files on its own. Further investigation is necessary.</p>
<p>The good thing is that we should be able to get unit tests for all of those. For FDs we count open fds before and after an erronous call, and #1#2 we can check that the malicious debs fail with an error :)</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">#1 and #2 only require fixes in apt:

So #2. Is it really infinite, isn't it basically too big? Similar to when you start reading the file, but the file is truncated.

Now, apparently we do require that we know the size of the arfile (which is stored in Left), so what we should do I guess is 

if (Memb-&gt;Size &gt; Left) {
    delete Memb;
    return _error-&gt;Error(_("Invalid archive member header"))
}

which fixes the issue and also detects truncated files. Well, I guess the message could also say the archive is truncated, but everything else uses this message.

Now #1 we know that Memb-&gt;Size is as correct as it will get, so the step here seems to be to add

if (Len &gt; Memb-&gt;Size) {
    delete Memb;
    return _error-&gt;Error(_("Invalid archive member header"))
}

This ensures that the length we parse for the long name is shorter than the member, which is correct.

#3 needs wrapping object in a smart pointer so the fd is relased. This also needs similar changes in ararchive_new, and possibly a whole bunch of other code that opens files on its own. Further investigation is necessary.

The good thing is that we should be able to get unit tests for all of those. For FDs we count open fds before and after an erronous call, and #1#2 we can check that the malicious debs fail with an error :)</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/apt/+bug/1899193/comments/7" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~juliank" class="sprite person">Julian Andres Klode (juliank)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-10-15T11:05:35.321283+00:00" title="2020-10-15 11:05:35 UTC">on 2020-10-15</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/apt/+bug/1899193/comments/7"> #7</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I&#x27;m now also looking into where aptd opens those files in the first place, and how we can move the PolicyKit check before that, as we really don&#x27;t want untrusted users to be able to parse/decompress random files in a root process, which happens if it&#x27;s reading the deb.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I'm now also looking into where aptd opens those files in the first place, and how we can move the PolicyKit check before that, as we really don't want untrusted users to be able to parse/decompress random files in a root process, which happens if it's reading the deb.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~juliank" class="sprite person">Julian Andres Klode (juliank)</a>
    
    <time title="2020-10-19 11:33:11 UTC" datetime="2020-10-19T11:33:11.699849+00:00">on 2020-10-19</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in apt (Ubuntu): </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Confirmed &#8594; Triaged
      </td>
    </tr>
  
  
    
      <tr>
        <td colspan="2">Changed in python-apt (Ubuntu): </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        New &#8594; Triaged
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/apt/+bug/1899193/comments/8" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~juliank" class="sprite person">Julian Andres Klode (juliank)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-10-19T11:39:58.218204+00:00" title="2020-10-19 11:39:58 UTC">on 2020-10-19</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/apt/+bug/1899193/comments/8"> #8</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/ubuntu/+source/apt/+bug/1899193/+attachment/5424168/+files/0001-arfile-Integer-overflow-in-parsing-GHSL-2020-168-GHS.patch">0001-arfile-Integer-overflow-in-parsing-GHSL-2020-168-GHS.patch</a>
        <a class="sprite edit action-icon" href="/ubuntu/+source/apt/+bug/1899193/+attachment/5424168">Edit</a>
        (10.6 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Attached patch for the first two issues, the ones in apt. I embedded the provided test creator code (reformatted), I assume it&#x27;s fine distributing this as GPL-2+ in apt?</p>
<p>The test case shows that the created debs are properly rejected.</p>
<p>This should apply to apt 1.3 and later, older versions (e.g. 1.2 in xenial) need an adjustment for the old buildsystem - replacing the CMakeLists bit with a makefile one (and I vaguely recall helper path lookup worked differently there, need to test)</p>
<p>Please give it a try! Four/six eyes see more than 2.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Attached patch for the first two issues, the ones in apt. I embedded the provided test creator code (reformatted), I assume it's fine distributing this as GPL-2+ in apt?

The test case shows that the created debs are properly rejected.

This should apply to apt 1.3 and later, older versions (e.g. 1.2 in xenial) need an adjustment for the old buildsystem - replacing the CMakeLists bit with a makefile one (and I vaguely recall helper path lookup worked differently there, need to test)

Please give it a try! Four/six eyes see more than 2.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/apt/+bug/1899193/comments/9" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~kbackhouse2000" class="sprite person">kev (kbackhouse2000)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-10-21T12:50:37.077890+00:00" title="2020-10-21 12:50:37 UTC">on 2020-10-21</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/apt/+bug/1899193/comments/9"> #9</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Patch for issues 1 and 2 looks good. Thanks!</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Patch for issues 1 and 2 looks good. Thanks!</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/apt/+bug/1899193/comments/10" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~juliank" class="sprite person">Julian Andres Klode (juliank)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-11-17T12:27:33.570507+00:00" title="2020-11-17 12:27:33 UTC">on 2020-11-17</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/apt/+bug/1899193/comments/10"> #10</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>### Issue 3: aptd file descriptor leak (GHSL-2020-170)</p>
<p>I also found out that if the function returns successfully, the runtime won&#x27;t immediately deallocate the object once it&#x27;s reference count reaches zero, so e.g.</p>
<p>def f():<br />
&nbsp;&nbsp;&nbsp;&nbsp;apt_<wbr />inst.DebFile(<wbr />&quot;../apt_<wbr />1.9.5_amd64.<wbr />deb&quot;)</p>
<p>f()</p>
<p>will cause an extra fd to be used, until the cyclic garbage collector ran. I think this is a problem I introduced years ago when I made them subclassable because that somehow required adding GC support or something - I don&#x27;t remember.</p>
<p>In any case, this means, that these need to become context managers or at least gain a close() method so that they can be closed when no longer needed.</p>
<p>arfile_new has the same issue FWIW, if there&#x27;s an error somewhere and the file was opened, it leaks it, as does tagfile_new; and both of them also have memory leaks as they never free those objects in these error cases.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">### Issue 3: aptd file descriptor leak (GHSL-2020-170)

I also found out that if the function returns successfully, the runtime won't immediately deallocate the object once it's reference count reaches zero, so e.g.

def f():
    apt_inst.DebFile("../apt_1.9.5_amd64.deb")

f()

will cause an extra fd to be used, until the cyclic garbage collector ran. I think this is a problem I introduced years ago when I made them subclassable because that somehow required adding GC support or something - I don't remember.

In any case, this means, that these need to become context managers or at least gain a close() method so that they can be closed when no longer needed.

arfile_new has the same issue FWIW, if there's an error somewhere and the file was opened, it leaks it, as does tagfile_new; and both of them also have memory leaks as they never free those objects in these error cases.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/apt/+bug/1899193/comments/11" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~juliank" class="sprite person">Julian Andres Klode (juliank)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-11-17T13:27:03.501011+00:00" title="2020-11-17 13:27:03 UTC">on 2020-11-17</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/apt/+bug/1899193/comments/11"> #11</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/ubuntu/+source/apt/+bug/1899193/+attachment/5435161/+files/0001-File-descriptor-leaks-in-ArArchive-DebFile-TagFile.patch">0001-File-descriptor-leaks-in-ArArchive-DebFile-TagFile.patch</a>
        <a class="sprite edit action-icon" href="/ubuntu/+source/apt/+bug/1899193/+attachment/5435161">Edit</a>
        (6.9 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Attached is a patch for the error cases in debfile_new (and ArArchive and TagFile). It works by decreasing the reference count of the object on error paths, and clearing the cycles, so that the object will be collected and the FD released once the function returns.</p>
<p>A test case will be added shortly, that will do os.listdir(<wbr />/proc/self/<wbr />fd) before and after calls to ensure that the number of file descriptors is the same.</p>
<p>Because the reason it needed a GC run before was: It turns out I do have cycles in both DebFile and TagFile:</p>
<p>DebFile contains references to data.tar and control.tar members, which in point hold references to the DebFile, so as to make sure that the file stays around while the data needs it.</p>
<p>TagFile links to a TagSection which links back to the TagFile, as the data is actually stored in the tagfile buffer. Oh dear.</p>
<p>I suppose I could fix them both correctly by removing the cycle, e.g. abstracting the File to a FileCommon that both File and Section/member reference, then existing code relying on reference counts will start behaving correctly.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Attached is a patch for the error cases in debfile_new (and ArArchive and TagFile). It works by decreasing the reference count of the object on error paths, and clearing the cycles, so that the object will be collected and the FD released once the function returns.

A test case will be added shortly, that will do os.listdir(/proc/self/fd) before and after calls to ensure that the number of file descriptors is the same.

Because the reason it needed a GC run before was: It turns out I do have cycles in both DebFile and TagFile:

DebFile contains references to data.tar and control.tar members, which in point hold references to the DebFile, so as to make sure that the file stays around while the data needs it.

TagFile links to a TagSection which links back to the TagFile, as the data is actually stored in the tagfile buffer. Oh dear.

I suppose I could fix them both correctly by removing the cycle, e.g. abstracting the File to a FileCommon that both File and Section/member reference, then existing code relying on reference counts will start behaving correctly.
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/apt/+bug/1899193/comments/12" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~seth-arnold" class="sprite person">Seth Arnold (seth-arnold)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-11-18T02:32:21.582614+00:00" title="2020-11-18 02:32:21 UTC">on 2020-11-18</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/apt/+bug/1899193/comments/12"> #12</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Hello Julian, the file descriptor leak patch has a section that I&#x27;m not sure about:</p>
<p>&nbsp;static PyObject *debfile_<wbr />new(PyTypeObjec<wbr />t *type, PyObject *args, PyObject *kwds)<br />
&nbsp;{<br />
-    PyDebFileObject *self = (PyDebFileObjec<wbr />t*)ararchive_<wbr />new(type, args, kwds);<br />
+    PyApt_UniqueObj<wbr />ect&lt;PyDebFileOb<wbr />ject&gt; self((PyDebFile<wbr />Object*<wbr />)ararchive_<wbr />new(type, args, kwds));<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (self == NULL)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return NULL;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// DebFile<br />
-    self-&gt;control = debfile_<wbr />get_tar(<wbr />self, &quot;control.tar&quot;);<br />
+    self-&gt;control = debfile_<wbr />get_tar(<wbr />self.get(<wbr />), &quot;control.tar&quot;);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (self-&gt;control == NULL)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return NULL;</p>
<p>-    self-&gt;data = debfile_<wbr />get_tar(<wbr />self, &quot;data.tar&quot;);<br />
+    self-&gt;data = debfile_<wbr />get_tar(<wbr />self.get(<wbr />), &quot;data.tar&quot;);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (self-&gt;data == NULL)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return NULL;</p>
<p>@@ -603,7 +603,7 @@ static PyObject *debfile_<wbr />new(PyTypeObjec<wbr />t *type, PyObject *args, PyObject *kwds)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self-<wbr />&gt;Fd.Read(<wbr />value, member-&gt;Size, true);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self-<wbr />&gt;debian_<wbr />binary = PyBytes_<wbr />FromStringAndSi<wbr />ze(value, member-&gt;Size);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete[] value;<br />
-    return self;<br />
+    return self.release();<br />
&nbsp;}</p>
<p>What happens with those return NULL cases if the data.tar or control.tar entries don&#x27;t exist? Is that a new leak? I expected a self.release() before those cases.</p>
<p>(Or, alternatively, I don&#x27;t understand the &#x27;return self.release()&#x27; idiom.)</p>
<p>There&#x27;s also a minor typo &quot;file descritor&quot; in the header. Do what you wish with this.</p>
<p>Thanks</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Hello Julian, the file descriptor leak patch has a section that I'm not sure about:

 static PyObject *debfile_new(PyTypeObject *type, PyObject *args, PyObject *kwds)
 {
-    PyDebFileObject *self = (PyDebFileObject*)ararchive_new(type, args, kwds);
+    PyApt_UniqueObject&lt;PyDebFileObject&gt; self((PyDebFileObject*)ararchive_new(type, args, kwds));
     if (self == NULL)
         return NULL;
 
     // DebFile
-    self-&gt;control = debfile_get_tar(self, "control.tar");
+    self-&gt;control = debfile_get_tar(self.get(), "control.tar");
     if (self-&gt;control == NULL)
         return NULL;
 
-    self-&gt;data = debfile_get_tar(self, "data.tar");
+    self-&gt;data = debfile_get_tar(self.get(), "data.tar");
     if (self-&gt;data == NULL)
         return NULL;
 
@@ -603,7 +603,7 @@ static PyObject *debfile_new(PyTypeObject *type, PyObject *args, PyObject *kwds)
     self-&gt;Fd.Read(value, member-&gt;Size, true);
     self-&gt;debian_binary = PyBytes_FromStringAndSize(value, member-&gt;Size);
     delete[] value;
-    return self;
+    return self.release();
 }


What happens with those return NULL cases if the data.tar or control.tar entries don't exist? Is that a new leak? I expected a self.release() before those cases.

(Or, alternatively, I don't understand the 'return self.release()' idiom.)

There's also a minor typo "file descritor" in the header. Do what you wish with this.

Thanks</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/apt/+bug/1899193/comments/13" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~seth-arnold" class="sprite person">Seth Arnold (seth-arnold)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-11-18T02:34:42.372110+00:00" title="2020-11-18 02:34:42 UTC">on 2020-11-18</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/apt/+bug/1899193/comments/13"> #13</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Cleaning up the integer overflows and filedescriptor leaks feels like a good idea; however I&#x27;m inclined to say there&#x27;s one CVE (or perhaps one per software package, if it&#x27;s truly scattered around correctly) for misplaced polkit checks -- does that sound correct?</p>
<p>Thanks</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Cleaning up the integer overflows and filedescriptor leaks feels like a good idea; however I'm inclined to say there's one CVE (or perhaps one per software package, if it's truly scattered around correctly) for misplaced polkit checks -- does that sound correct?

Thanks</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/apt/+bug/1899193/comments/14" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~juliank" class="sprite person">Julian Andres Klode (juliank)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-11-18T15:20:18.665139+00:00" title="2020-11-18 15:20:18 UTC">on 2020-11-18</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/apt/+bug/1899193/comments/14"> #14</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>We certainly want a CVE for moving the root check earlier I suppose, if that&#x27;s doable with the API - I&#x27;ve not looked at how that all interacts in practice.</p>
<p>I think we need one CVE for each of these things? The code was not meant for untrusted input, but archive tools like launchpad use it for such (albeit in one process per PPA or so, so you can like only DoS a PPA you have write access to).</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">We certainly want a CVE for moving the root check earlier I suppose, if that's doable with the API - I've not looked at how that all interacts in practice.

I think we need one CVE for each of these things? The code was not meant for untrusted input, but archive tools like launchpad use it for such (albeit in one process per PPA or so, so you can like only DoS a PPA you have write access to).</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/apt/+bug/1899193/comments/15" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~juliank" class="sprite person">Julian Andres Klode (juliank)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-11-18T15:22:21.835156+00:00" title="2020-11-18 15:22:21 UTC">on 2020-11-18</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/apt/+bug/1899193/comments/15"> #15</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p><span class="foldable-quoted">&gt; What happens with those return NULL cases if the data.tar or control.tar entries don&#x27;t exist? Is that a new leak? I expected a self.release() before those cases.
</span></p>
<p>OK, so release() releases ownership from the smart pointer to the caller (by setting the internal pointer to NULL and returning it).</p>
<p>Just returning NULL without calling release means the smart pointer object will decrement the reference count and hence deallocate it.</p>
<p>See <a rel="nofollow" href="https://en.cppreference.com/w/cpp/memory/unique_ptr/release">https:/<wbr />/en.cppreferenc<wbr />e.com/w/<wbr />cpp/memory/<wbr />unique_<wbr />ptr/release</a> for more information about the origin of the idiom.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">&gt; What happens with those return NULL cases if the data.tar or control.tar entries don't exist? Is that a new leak? I expected a self.release() before those cases.


OK, so release() releases ownership from the smart pointer to the caller (by setting the internal pointer to NULL and returning it).

Just returning NULL without calling release means the smart pointer object will decrement the reference count and hence deallocate it.

See https://en.cppreference.com/w/cpp/memory/unique_ptr/release for more information about the origin of the idiom.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/apt/+bug/1899193/comments/16" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~seth-arnold" class="sprite person">Seth Arnold (seth-arnold)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-11-20T03:36:36.580656+00:00" title="2020-11-20 03:36:36 UTC">on 2020-11-20</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/apt/+bug/1899193/comments/16"> #16</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Thanks for the descriptions; I always assumed there was a lot more magic to unique_ptr. I hadn&#x27;t expected a dozen-line implementation.</p>
<p>This one&#x27;s a little complicated:</p>
<p>CVE-2020-27349 (aptdaemon, LP: <a href="/bugs/1899193" class="bug-link">#1899193</a>) -- policykit checks are too late<br />
CVE-2020-27350 (apt, LP: <a href="/bugs/1899193" class="bug-link">#1899193</a>) -- apt-pkg/<wbr />contrib/<wbr />arfile.<wbr />cc missing comparisons GHSL-2020-168 GHSL-2020-169<br />
CVE-2020-27351 (python-apt, LP: <a href="/bugs/1899193" class="bug-link">#1899193</a>) -- python/arfile.cc, python/tag.cc, python/tarfile.cc -- various memory and file descriptor leaks GHSL-2020-170</p>
<p>I&#x27;m not 100% sure on lumping together memory leaks (missing free) and file descriptor leaks (missing close) but as they are both missing release of resource, and the same patch addresses both, I don&#x27;t see a benefit to another CVE in this case.</p>
<p>Thanks</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Thanks for the descriptions; I always assumed there was a lot more magic to unique_ptr. I hadn't expected a dozen-line implementation.

This one's a little complicated:

CVE-2020-27349 (aptdaemon, LP: #1899193) -- policykit checks are too late
CVE-2020-27350 (apt, LP: #1899193) -- apt-pkg/contrib/arfile.cc missing comparisons GHSL-2020-168 GHSL-2020-169
CVE-2020-27351 (python-apt, LP: #1899193) -- python/arfile.cc, python/tag.cc, python/tarfile.cc -- various memory and file descriptor leaks GHSL-2020-170

I'm not 100% sure on lumping together memory leaks (missing free) and file descriptor leaks (missing close) but as they are both missing release of resource, and the same patch addresses both, I don't see a benefit to another CVE in this case.

Thanks</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/apt/+bug/1899193/comments/17" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~juliank" class="sprite person">Julian Andres Klode (juliank)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-11-23T17:12:39.526067+00:00" title="2020-11-23 17:12:39 UTC">on 2020-11-23</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/apt/+bug/1899193/comments/17"> #17</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I still wonder if we also should try to fix aptdaemon to explictly close the files it opens, as we can&#x27;t rely on Python doing that automatically due to the reference cycles in DebFile, and if that needs a CVE as well - I have no idea if it&#x27;s practically exploitable.</p>
<p>You need to give it a deb that&#x27;s valid enough to open, aka has data.tar.xz and control.tar.xz and debian-binary members but then is being rejected by aptdaemon itself after the object is created (e.g. control.tar.xz contains nonsense).</p>
<p>Arguably if we fix the PolicyKit interaction, that&#x27;s enough to go on the aptdaemon side.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I still wonder if we also should try to fix aptdaemon to explictly close the files it opens, as we can't rely on Python doing that automatically due to the reference cycles in DebFile, and if that needs a CVE as well - I have no idea if it's practically exploitable.

You need to give it a deb that's valid enough to open, aka has data.tar.xz and control.tar.xz and debian-binary members but then is being rejected by aptdaemon itself after the object is created (e.g. control.tar.xz contains nonsense).

Arguably if we fix the PolicyKit interaction, that's enough to go on the aptdaemon side.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/apt/+bug/1899193/comments/18" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~juliank" class="sprite person">Julian Andres Klode (juliank)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-11-24T13:43:14.084336+00:00" title="2020-11-24 13:43:14 UTC">on 2020-11-24</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/apt/+bug/1899193/comments/18"> #18</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/ubuntu/+source/apt/+bug/1899193/+attachment/5437531/+files/0001-apt_inst.DebFile-Avoid-reference-cycle-with-control-.patch">0001-apt_inst.DebFile-Avoid-reference-cycle-with-control-.patch</a>
        <a class="sprite edit action-icon" href="/ubuntu/+source/apt/+bug/1899193/+attachment/5437531">Edit</a>
        (9.4 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Attached patch addresses the reference loop in apt_inst.DebFile, ensuring that no longer referencing the object will release it immediately, as opposed to when the cycle GC runs.</p>
<p>Subject: [PATCH] apt_inst.DebFile: Avoid reference cycle with control,data<br />
&nbsp;members</p>
<p>apt_inst.DebFile provides two members `data` and `control` for<br />
easy access to those tarballs. Each of those members stores a<br />
reference to the DebFile as its owner:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;v--<wbr />-------<wbr />-------<wbr />-\<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;control ----\        |<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />-&gt; deb -|<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data    ----/        |<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;^--<wbr />-------<wbr />-------<wbr />-/</p>
<p>This means that whenever a DebFile is successfully constructed,<br />
and no longer needed, it won&#x27;t be collected until the GC runs,<br />
which is bad, as the DebFile holds an open FileFd.</p>
<p>Introduce a __FileFd wrapper that holds the FileFd and becomes<br />
the owner of both control and data, and replaces the direct use<br />
of the FileFd in ArArchive/DebFile:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;v---<wbr />-------<wbr />-------<wbr />-------<wbr />-----\<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;control ----\                    \<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />-&gt; __FileFd &lt;- deb -|<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data    ----/                    /<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<wbr />&nbsp;&nbsp;&nbsp;^---<wbr />-------<wbr />-------<wbr />-------<wbr />-----/</p>
<p>This avoids the reference cycle, ensuring the memory and file<br />
descriptor are released by the reference counter as soon as<br />
the reference count drops to 0.</p>
<p>A future version should move `apt_inst.__FileFd` to `apt_pkg.FileFd`<br />
and expose all the methods, such that people can make use of FileFd&#x27;s<br />
extensive compression support.</p>
<p>We have a similar cycle in TagFile that we have yet to address,<br />
the problem there is arguably more frustrating, as the buffer<br />
I believe is stored inside the TagFile, and that&#x27;s really shared<br />
between the TagSection objects.</p>
<p>This is related to LP: <a href="/bugs/1899193" class="bug-link">#1899193</a> and CVE-2020-27351, but an additional<br />
hardening measure - the fix for those bugs was for more direct leaks.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Attached patch addresses the reference loop in apt_inst.DebFile, ensuring that no longer referencing the object will release it immediately, as opposed to when the cycle GC runs.

Subject: [PATCH] apt_inst.DebFile: Avoid reference cycle with control,data
 members

apt_inst.DebFile provides two members `data` and `control` for
easy access to those tarballs. Each of those members stores a
reference to the DebFile as its owner:

           v-----------------\
        control ----\        |
                     -&gt; deb -|
        data    ----/        |
           ^-----------------/

This means that whenever a DebFile is successfully constructed,
and no longer needed, it won't be collected until the GC runs,
which is bad, as the DebFile holds an open FileFd.

Introduce a __FileFd wrapper that holds the FileFd and becomes
the owner of both control and data, and replaces the direct use
of the FileFd in ArArchive/DebFile:

          v-----------------------------\
        control ----\                    \
                     -&gt; __FileFd &lt;- deb -|
        data    ----/                    /
          ^-----------------------------/

This avoids the reference cycle, ensuring the memory and file
descriptor are released by the reference counter as soon as
the reference count drops to 0.

A future version should move `apt_inst.__FileFd` to `apt_pkg.FileFd`
and expose all the methods, such that people can make use of FileFd's
extensive compression support.

We have a similar cycle in TagFile that we have yet to address,
the problem there is arguably more frustrating, as the buffer
I believe is stored inside the TagFile, and that's really shared
between the TagSection objects.

This is related to LP: #1899193 and CVE-2020-27351, but an additional
hardening measure - the fix for those bugs was for more direct leaks.
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/apt/+bug/1899193/comments/19" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~juliank" class="sprite person">Julian Andres Klode (juliank)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-12-01T11:32:26.339855+00:00" title="2020-12-01 11:32:26 UTC">on 2020-12-01</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/apt/+bug/1899193/comments/19"> #19</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/ubuntu/+source/apt/+bug/1899193/+attachment/5439980/+files/CVE-2020-27349.patch">CVE-2020-27349.patch</a>
        <a class="sprite edit action-icon" href="/ubuntu/+source/apt/+bug/1899193/+attachment/5439980">Edit</a>
        (1.0 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Here is the patch for aptdaemon, just add it to the debian/patches, works back to xenial</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Here is the patch for aptdaemon, just add it to the debian/patches, works back to xenial</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/apt/+bug/1899193/comments/20" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~juliank" class="sprite person">Julian Andres Klode (juliank)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-12-01T19:29:53.529181+00:00" title="2020-12-01 19:29:53 UTC">on 2020-12-01</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/apt/+bug/1899193/comments/20"> #20</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/ubuntu/+source/apt/+bug/1899193/+attachment/5440104/+files/python-apt-focal.diff">python-apt-focal.diff</a>
        <a class="sprite edit action-icon" href="/ubuntu/+source/apt/+bug/1899193/+attachment/5440104">Edit</a>
        (38.2 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>python-apt debdiff for focal.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">python-apt debdiff for focal.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/apt/+bug/1899193/comments/21" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~juliank" class="sprite person">Julian Andres Klode (juliank)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-12-01T19:31:18.560704+00:00" title="2020-12-01 19:31:18 UTC">on 2020-12-01</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/apt/+bug/1899193/comments/21"> #21</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/ubuntu/+source/apt/+bug/1899193/+attachment/5440105/+files/python-apt-bionic.diff">python-apt-bionic.diff</a>
        <a class="sprite edit action-icon" href="/ubuntu/+source/apt/+bug/1899193/+attachment/5440105">Edit</a>
        (41.5 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>python-apt bionic diff</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">python-apt bionic diff</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/apt/+bug/1899193/comments/22" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~juliank" class="sprite person">Julian Andres Klode (juliank)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-12-01T19:46:52.196195+00:00" title="2020-12-01 19:46:52 UTC">on 2020-12-01</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/apt/+bug/1899193/comments/22"> #22</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/ubuntu/+source/apt/+bug/1899193/+attachment/5440106/+files/python-apt-xenial.diff">python-apt-xenial.diff</a>
        <a class="sprite edit action-icon" href="/ubuntu/+source/apt/+bug/1899193/+attachment/5440106">Edit</a>
        (41.5 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>python-apt xenial debdiff</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">python-apt xenial debdiff</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/apt/+bug/1899193/comments/23" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~juliank" class="sprite person">Julian Andres Klode (juliank)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-12-01T19:48:00.096255+00:00" title="2020-12-01 19:48:00 UTC">on 2020-12-01</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/apt/+bug/1899193/comments/23"> #23</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/ubuntu/+source/apt/+bug/1899193/+attachment/5440107/+files/python-apt-groovy.diff">python-apt-groovy.diff</a>
        <a class="sprite edit action-icon" href="/ubuntu/+source/apt/+bug/1899193/+attachment/5440107">Edit</a>
        (49.4 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>python-apt groovy debdiff</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">python-apt groovy debdiff</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/apt/+bug/1899193/comments/24" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~juliank" class="sprite person">Julian Andres Klode (juliank)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-12-06T15:25:52.390839+00:00" title="2020-12-06 15:25:52 UTC">on 2020-12-06</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/apt/+bug/1899193/comments/24"> #24</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Also subscribing other upstream APT maintainer for visibility.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Also subscribing other upstream APT maintainer for visibility.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/apt/+bug/1899193/comments/25" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~juliank" class="sprite person">Julian Andres Klode (juliank)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-12-07T13:12:03.428832+00:00" title="2020-12-07 13:12:03 UTC">on 2020-12-07</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/apt/+bug/1899193/comments/25"> #25</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/ubuntu/+source/apt/+bug/1899193/+attachment/5441609/+files/apt-groovy.diff">apt-groovy.diff</a>
        <a class="sprite edit action-icon" href="/ubuntu/+source/apt/+bug/1899193/+attachment/5441609">Edit</a>
        (20.5 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10"></textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/apt/+bug/1899193/comments/26" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~juliank" class="sprite person">Julian Andres Klode (juliank)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-12-07T13:12:26.053948+00:00" title="2020-12-07 13:12:26 UTC">on 2020-12-07</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/apt/+bug/1899193/comments/26"> #26</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/ubuntu/+source/apt/+bug/1899193/+attachment/5441610/+files/apt-focal.diff">apt-focal.diff</a>
        <a class="sprite edit action-icon" href="/ubuntu/+source/apt/+bug/1899193/+attachment/5441610">Edit</a>
        (20.1 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10"></textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/apt/+bug/1899193/comments/27" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~juliank" class="sprite person">Julian Andres Klode (juliank)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-12-07T13:12:39.912494+00:00" title="2020-12-07 13:12:39 UTC">on 2020-12-07</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/apt/+bug/1899193/comments/27"> #27</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/ubuntu/+source/apt/+bug/1899193/+attachment/5441618/+files/apt-bionic.diff">apt-bionic.diff</a>
        <a class="sprite edit action-icon" href="/ubuntu/+source/apt/+bug/1899193/+attachment/5441618">Edit</a>
        (20.2 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10"></textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/apt/+bug/1899193/comments/28" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~juliank" class="sprite person">Julian Andres Klode (juliank)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-12-07T13:12:51.149797+00:00" title="2020-12-07 13:12:51 UTC">on 2020-12-07</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/apt/+bug/1899193/comments/28"> #28</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/ubuntu/+source/apt/+bug/1899193/+attachment/5441619/+files/apt-xenial.diff">apt-xenial.diff</a>
        <a class="sprite edit action-icon" href="/ubuntu/+source/apt/+bug/1899193/+attachment/5441619">Edit</a>
        (50.8 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10"></textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/apt/+bug/1899193/comments/29" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~juliank" class="sprite person">Julian Andres Klode (juliank)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-12-07T13:19:42.264840+00:00" title="2020-12-07 13:19:42 UTC">on 2020-12-07</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/apt/+bug/1899193/comments/29"> #29</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Release dates:</p>
<p>2020-12-08:<br />
- CVE-2020-27349 (aptdaemon, LP: <a href="/bugs/1899193" class="bug-link">#1899193</a>) -- policykit checks are too late</p>
<p>2020-12-09:<br />
- CVE-2020-27350 (apt, LP: <a href="/bugs/1899193" class="bug-link">#1899193</a>)<br />
- CVE-2020-27351 (python-apt, LP: <a href="/bugs/1899193" class="bug-link">#1899193</a>)</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Release dates:

2020-12-08:
- CVE-2020-27349 (aptdaemon, LP: #1899193) -- policykit checks are too late


2020-12-09:
- CVE-2020-27350 (apt, LP: #1899193) 
- CVE-2020-27351 (python-apt, LP: #1899193)</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/apt/+bug/1899193/comments/30" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~janitor" class="sprite person-inactive">Launchpad Janitor (janitor)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-12-08T15:51:36.901432+00:00" title="2020-12-08 15:51:36 UTC">on 2020-12-08</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/apt/+bug/1899193/comments/30"> #30</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>This bug was fixed in the package aptdaemon - 1.1.1+bzr982-<wbr />0ubuntu34.<wbr />1</p>
<p>---------------<br />
aptdaemon (1.1.1+<wbr />bzr982-<wbr />0ubuntu34.<wbr />1) groovy-security; urgency=medium</p>
<p>&nbsp;&nbsp;* SECURITY UPDATE: info disclosure via transaction properties<br />
&nbsp;&nbsp;&nbsp;&nbsp;(LP: <a href="/bugs/1899513" class="bug-link">#1899513</a>)<br />
&nbsp;&nbsp;&nbsp;&nbsp;- debian/<wbr />patches/<wbr />CVE-2020-<wbr />16128.patch: drop privileges when doing file<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;checks in aptdaemon/core.py, aptdaemon/<wbr />worker/<wbr />aptworker.<wbr />py,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aptdaemon<wbr />/utils.<wbr />py.<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2020-16128<br />
&nbsp;&nbsp;* SECURITY UPDATE: policykit checks are too late (LP: <a href="/bugs/1899193" class="bug-link">#1899193</a>)<br />
&nbsp;&nbsp;&nbsp;&nbsp;- debian/<wbr />patches/<wbr />CVE-2020-<wbr />27349.patch: check PolicyKit before<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;simulating local install in aptdaemon/core.py.<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2020-27349</p>
<p>&nbsp;-- Marc Deslauriers &lt;email address hidden&gt;  Tue, 01 Dec 2020 09:23:26 -0500</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">This bug was fixed in the package aptdaemon - 1.1.1+bzr982-0ubuntu34.1

---------------
aptdaemon (1.1.1+bzr982-0ubuntu34.1) groovy-security; urgency=medium

  * SECURITY UPDATE: info disclosure via transaction properties
    (LP: #1899513)
    - debian/patches/CVE-2020-16128.patch: drop privileges when doing file
      checks in aptdaemon/core.py, aptdaemon/worker/aptworker.py,
      aptdaemon/utils.py.
    - CVE-2020-16128
  * SECURITY UPDATE: policykit checks are too late (LP: #1899193)
    - debian/patches/CVE-2020-27349.patch: check PolicyKit before
      simulating local install in aptdaemon/core.py.
    - CVE-2020-27349

 -- Marc Deslauriers &lt;marc.deslauriers@ubuntu.com&gt;  Tue, 01 Dec 2020 09:23:26 -0500</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in aptdaemon (Ubuntu): </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        New &#8594; Fix Released
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/apt/+bug/1899193/comments/31" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~janitor" class="sprite person-inactive">Launchpad Janitor (janitor)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-12-08T15:51:37.770511+00:00" title="2020-12-08 15:51:37 UTC">on 2020-12-08</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/apt/+bug/1899193/comments/31"> #31</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>This bug was fixed in the package aptdaemon - 1.1.1+bzr982-<wbr />0ubuntu32.<wbr />3</p>
<p>---------------<br />
aptdaemon (1.1.1+<wbr />bzr982-<wbr />0ubuntu32.<wbr />3) focal-security; urgency=medium</p>
<p>&nbsp;&nbsp;* SECURITY UPDATE: info disclosure via transaction properties<br />
&nbsp;&nbsp;&nbsp;&nbsp;(LP: <a href="/bugs/1899513" class="bug-link">#1899513</a>)<br />
&nbsp;&nbsp;&nbsp;&nbsp;- debian/<wbr />patches/<wbr />CVE-2020-<wbr />16128.patch: drop privileges when doing file<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;checks in aptdaemon/core.py, aptdaemon/<wbr />worker/<wbr />aptworker.<wbr />py,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aptdaemon<wbr />/utils.<wbr />py.<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2020-16128<br />
&nbsp;&nbsp;* SECURITY UPDATE: policykit checks are too late (LP: <a href="/bugs/1899193" class="bug-link">#1899193</a>)<br />
&nbsp;&nbsp;&nbsp;&nbsp;- debian/<wbr />patches/<wbr />CVE-2020-<wbr />27349.patch: check PolicyKit before<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;simulating local install in aptdaemon/core.py.<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2020-27349</p>
<p>&nbsp;-- Marc Deslauriers &lt;email address hidden&gt;  Wed, 02 Dec 2020 07:42:52 -0500</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">This bug was fixed in the package aptdaemon - 1.1.1+bzr982-0ubuntu32.3

---------------
aptdaemon (1.1.1+bzr982-0ubuntu32.3) focal-security; urgency=medium

  * SECURITY UPDATE: info disclosure via transaction properties
    (LP: #1899513)
    - debian/patches/CVE-2020-16128.patch: drop privileges when doing file
      checks in aptdaemon/core.py, aptdaemon/worker/aptworker.py,
      aptdaemon/utils.py.
    - CVE-2020-16128
  * SECURITY UPDATE: policykit checks are too late (LP: #1899193)
    - debian/patches/CVE-2020-27349.patch: check PolicyKit before
      simulating local install in aptdaemon/core.py.
    - CVE-2020-27349

 -- Marc Deslauriers &lt;marc.deslauriers@ubuntu.com&gt;  Wed, 02 Dec 2020 07:42:52 -0500</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in aptdaemon (Ubuntu): </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        New &#8594; Fix Released
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/apt/+bug/1899193/comments/32" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~janitor" class="sprite person-inactive">Launchpad Janitor (janitor)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-12-08T15:51:38.844450+00:00" title="2020-12-08 15:51:38 UTC">on 2020-12-08</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/apt/+bug/1899193/comments/32"> #32</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>This bug was fixed in the package aptdaemon - 1.1.1+bzr982-<wbr />0ubuntu19.<wbr />5</p>
<p>---------------<br />
aptdaemon (1.1.1+<wbr />bzr982-<wbr />0ubuntu19.<wbr />5) bionic-security; urgency=medium</p>
<p>&nbsp;&nbsp;* SECURITY UPDATE: info disclosure via transaction properties<br />
&nbsp;&nbsp;&nbsp;&nbsp;(LP: <a href="/bugs/1899513" class="bug-link">#1899513</a>)<br />
&nbsp;&nbsp;&nbsp;&nbsp;- debian/<wbr />patches/<wbr />CVE-2020-<wbr />16128.patch: drop privileges when doing file<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;checks in aptdaemon/core.py, aptdaemon/<wbr />worker/<wbr />aptworker.<wbr />py,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aptdaemon<wbr />/utils.<wbr />py.<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2020-16128<br />
&nbsp;&nbsp;* SECURITY UPDATE: policykit checks are too late (LP: <a href="/bugs/1899193" class="bug-link">#1899193</a>)<br />
&nbsp;&nbsp;&nbsp;&nbsp;- debian/<wbr />patches/<wbr />CVE-2020-<wbr />27349.patch: check PolicyKit before<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;simulating local install in aptdaemon/core.py.<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2020-27349</p>
<p>&nbsp;-- Marc Deslauriers &lt;email address hidden&gt;  Wed, 02 Dec 2020 07:43:55 -0500</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">This bug was fixed in the package aptdaemon - 1.1.1+bzr982-0ubuntu19.5

---------------
aptdaemon (1.1.1+bzr982-0ubuntu19.5) bionic-security; urgency=medium

  * SECURITY UPDATE: info disclosure via transaction properties
    (LP: #1899513)
    - debian/patches/CVE-2020-16128.patch: drop privileges when doing file
      checks in aptdaemon/core.py, aptdaemon/worker/aptworker.py,
      aptdaemon/utils.py.
    - CVE-2020-16128
  * SECURITY UPDATE: policykit checks are too late (LP: #1899193)
    - debian/patches/CVE-2020-27349.patch: check PolicyKit before
      simulating local install in aptdaemon/core.py.
    - CVE-2020-27349

 -- Marc Deslauriers &lt;marc.deslauriers@ubuntu.com&gt;  Wed, 02 Dec 2020 07:43:55 -0500</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in aptdaemon (Ubuntu): </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        New &#8594; Fix Released
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/apt/+bug/1899193/comments/33" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~janitor" class="sprite person-inactive">Launchpad Janitor (janitor)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-12-09T16:24:54.496381+00:00" title="2020-12-09 16:24:54 UTC">on 2020-12-09</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/apt/+bug/1899193/comments/33"> #33</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>This bug was fixed in the package apt - 2.1.10ubuntu0.1</p>
<p>---------------<br />
apt (2.1.10ubuntu0.1) groovy-security; urgency=high</p>
<p>&nbsp;&nbsp;* SECURITY UPDATE: Integer overflow in parsing (LP: <a href="/bugs/1899193" class="bug-link">#1899193</a>)<br />
&nbsp;&nbsp;&nbsp;&nbsp;- apt-pkg/<wbr />contrib/<wbr />arfile.<wbr />cc: add extra checks.<br />
&nbsp;&nbsp;&nbsp;&nbsp;- apt-pkg/<wbr />contrib/<wbr />tarfile.<wbr />cc: limit tar item sizes to 128 GiB<br />
&nbsp;&nbsp;&nbsp;&nbsp;- apt-pkg/<wbr />deb/debfile.<wbr />cc: limit control file sizes to 64 MiB<br />
&nbsp;&nbsp;&nbsp;&nbsp;- test/*: add tests.<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2020-27350<br />
&nbsp;&nbsp;* Additional hardening:<br />
&nbsp;&nbsp;&nbsp;&nbsp;- apt-pkg/<wbr />contrib/<wbr />tarfile.<wbr />cc: Limit size of long names and links to 1 MiB<br />
&nbsp;&nbsp;* .gitlab-ci.yml: Test on groovy, not unstable</p>
<p>&nbsp;-- Julian Andres Klode &lt;email address hidden&gt;  Mon, 07 Dec 2020 12:02:40 +0100</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">This bug was fixed in the package apt - 2.1.10ubuntu0.1

---------------
apt (2.1.10ubuntu0.1) groovy-security; urgency=high

  * SECURITY UPDATE: Integer overflow in parsing (LP: #1899193)
    - apt-pkg/contrib/arfile.cc: add extra checks.
    - apt-pkg/contrib/tarfile.cc: limit tar item sizes to 128 GiB
    - apt-pkg/deb/debfile.cc: limit control file sizes to 64 MiB
    - test/*: add tests.
    - CVE-2020-27350
  * Additional hardening:
    - apt-pkg/contrib/tarfile.cc: Limit size of long names and links to 1 MiB
  * .gitlab-ci.yml: Test on groovy, not unstable

 -- Julian Andres Klode &lt;juliank@ubuntu.com&gt;  Mon, 07 Dec 2020 12:02:40 +0100</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in apt (Ubuntu): </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Triaged &#8594; Fix Released
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/apt/+bug/1899193/comments/34" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~janitor" class="sprite person-inactive">Launchpad Janitor (janitor)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-12-09T16:24:55.362363+00:00" title="2020-12-09 16:24:55 UTC">on 2020-12-09</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/apt/+bug/1899193/comments/34"> #34</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>This bug was fixed in the package apt - 2.0.2ubuntu0.2</p>
<p>---------------<br />
apt (2.0.2ubuntu0.2) focal-security; urgency=high</p>
<p>&nbsp;&nbsp;* SECURITY UPDATE: Integer overflow in parsing (LP: <a href="/bugs/1899193" class="bug-link">#1899193</a>)<br />
&nbsp;&nbsp;&nbsp;&nbsp;- apt-pkg/<wbr />contrib/<wbr />arfile.<wbr />cc: add extra checks.<br />
&nbsp;&nbsp;&nbsp;&nbsp;- apt-pkg/<wbr />contrib/<wbr />tarfile.<wbr />cc: limit tar item sizes to 128 GiB<br />
&nbsp;&nbsp;&nbsp;&nbsp;- apt-pkg/<wbr />deb/debfile.<wbr />cc: limit control file sizes to 64 MiB<br />
&nbsp;&nbsp;&nbsp;&nbsp;- test/*: add tests.<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2020-27350<br />
&nbsp;&nbsp;* Additional hardening:<br />
&nbsp;&nbsp;&nbsp;&nbsp;- apt-pkg/<wbr />contrib/<wbr />tarfile.<wbr />cc: Limit size of long names and links to 1 MiB<br />
&nbsp;&nbsp;* .gitlab-ci.yml: Test on focal, not unstable</p>
<p>&nbsp;-- Julian Andres Klode &lt;email address hidden&gt;  Mon, 07 Dec 2020 12:08:43 +0100</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">This bug was fixed in the package apt - 2.0.2ubuntu0.2

---------------
apt (2.0.2ubuntu0.2) focal-security; urgency=high

  * SECURITY UPDATE: Integer overflow in parsing (LP: #1899193)
    - apt-pkg/contrib/arfile.cc: add extra checks.
    - apt-pkg/contrib/tarfile.cc: limit tar item sizes to 128 GiB
    - apt-pkg/deb/debfile.cc: limit control file sizes to 64 MiB
    - test/*: add tests.
    - CVE-2020-27350
  * Additional hardening:
    - apt-pkg/contrib/tarfile.cc: Limit size of long names and links to 1 MiB
  * .gitlab-ci.yml: Test on focal, not unstable

 -- Julian Andres Klode &lt;juliank@ubuntu.com&gt;  Mon, 07 Dec 2020 12:08:43 +0100</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in apt (Ubuntu): </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Triaged &#8594; Fix Released
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/apt/+bug/1899193/comments/35" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~janitor" class="sprite person-inactive">Launchpad Janitor (janitor)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-12-09T16:24:57.378063+00:00" title="2020-12-09 16:24:57 UTC">on 2020-12-09</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/apt/+bug/1899193/comments/35"> #35</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>This bug was fixed in the package apt - 1.6.12ubuntu0.2</p>
<p>---------------<br />
apt (1.6.12ubuntu0.2) bionic-security; urgency=high</p>
<p>&nbsp;&nbsp;* SECURITY UPDATE: Integer overflow in parsing (LP: <a href="/bugs/1899193" class="bug-link">#1899193</a>)<br />
&nbsp;&nbsp;&nbsp;&nbsp;- apt-pkg/<wbr />contrib/<wbr />arfile.<wbr />cc: add extra checks.<br />
&nbsp;&nbsp;&nbsp;&nbsp;- apt-pkg/<wbr />contrib/<wbr />tarfile.<wbr />cc: limit tar item sizes to 128 GiB<br />
&nbsp;&nbsp;&nbsp;&nbsp;- apt-pkg/<wbr />deb/debfile.<wbr />cc: limit control file sizes to 64 MiB<br />
&nbsp;&nbsp;&nbsp;&nbsp;- test/*: add tests.<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2020-27350<br />
&nbsp;&nbsp;* Additional hardening:<br />
&nbsp;&nbsp;&nbsp;&nbsp;- apt-pkg/<wbr />contrib/<wbr />tarfile.<wbr />cc: Limit size of long names and links to 1 MiB</p>
<p>&nbsp;-- Julian Andres Klode &lt;email address hidden&gt;  Mon, 07 Dec 2020 12:13:36 +0100</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">This bug was fixed in the package apt - 1.6.12ubuntu0.2

---------------
apt (1.6.12ubuntu0.2) bionic-security; urgency=high

  * SECURITY UPDATE: Integer overflow in parsing (LP: #1899193)
    - apt-pkg/contrib/arfile.cc: add extra checks.
    - apt-pkg/contrib/tarfile.cc: limit tar item sizes to 128 GiB
    - apt-pkg/deb/debfile.cc: limit control file sizes to 64 MiB
    - test/*: add tests.
    - CVE-2020-27350
  * Additional hardening:
    - apt-pkg/contrib/tarfile.cc: Limit size of long names and links to 1 MiB

 -- Julian Andres Klode &lt;juliank@ubuntu.com&gt;  Mon, 07 Dec 2020 12:13:36 +0100</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in apt (Ubuntu): </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Triaged &#8594; Fix Released
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/apt/+bug/1899193/comments/36" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~janitor" class="sprite person-inactive">Launchpad Janitor (janitor)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-12-09T16:32:32.295889+00:00" title="2020-12-09 16:32:32 UTC">on 2020-12-09</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/apt/+bug/1899193/comments/36"> #36</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>This bug was fixed in the package python-apt - 2.1.3ubuntu1.1</p>
<p>---------------<br />
python-apt (2.1.3ubuntu1.1) groovy-security; urgency=high</p>
<p>&nbsp;&nbsp;* SECURITY UPDATE: various memory and file descriptor leaks (LP: <a href="/bugs/1899193" class="bug-link">#1899193</a>)<br />
&nbsp;&nbsp;&nbsp;&nbsp;- python/arfile.cc, python/generic.h, python/tag.cc, python/tarfile.cc:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fix file descriptor and memory leaks<br />
&nbsp;&nbsp;&nbsp;&nbsp;- python/<wbr />apt_instmodule.<wbr />cc, python/<wbr />apt_instmodule.<wbr />h, python/arfile.h:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Avoid reference cycle with control,data members in apt_inst.DebFile<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;objects<br />
&nbsp;&nbsp;&nbsp;&nbsp;- tests/test_<wbr />cve_2020_<wbr />27351.py: Test cases for DebFile (others not easily<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;testable)<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2020-27351<br />
&nbsp;&nbsp;* .gitlab-ci.yml: Fix mypy and Ubuntu version for CI<br />
&nbsp;&nbsp;* data/templates: Update mirror lists</p>
<p>&nbsp;-- Julian Andres Klode &lt;email address hidden&gt;  Tue, 01 Dec 2020 20:25:56 +0100</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">This bug was fixed in the package python-apt - 2.1.3ubuntu1.1

---------------
python-apt (2.1.3ubuntu1.1) groovy-security; urgency=high

  * SECURITY UPDATE: various memory and file descriptor leaks (LP: #1899193)
    - python/arfile.cc, python/generic.h, python/tag.cc, python/tarfile.cc:
      fix file descriptor and memory leaks
    - python/apt_instmodule.cc, python/apt_instmodule.h, python/arfile.h:
      Avoid reference cycle with control,data members in apt_inst.DebFile
      objects
    - tests/test_cve_2020_27351.py: Test cases for DebFile (others not easily
      testable)
    - CVE-2020-27351
  * .gitlab-ci.yml: Fix mypy and Ubuntu version for CI
  * data/templates: Update mirror lists

 -- Julian Andres Klode &lt;juliank@ubuntu.com&gt;  Tue, 01 Dec 2020 20:25:56 +0100</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in python-apt (Ubuntu): </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Triaged &#8594; Fix Released
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/apt/+bug/1899193/comments/37" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~janitor" class="sprite person-inactive">Launchpad Janitor (janitor)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-12-09T16:32:34.062587+00:00" title="2020-12-09 16:32:34 UTC">on 2020-12-09</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/apt/+bug/1899193/comments/37"> #37</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>This bug was fixed in the package python-apt - 2.0.0ubuntu0.<wbr />20.04.2</p>
<p>---------------<br />
python-apt (2.0.0ubuntu0.<wbr />20.04.2) focal-security; urgency=high</p>
<p>&nbsp;&nbsp;* SECURITY UPDATE: various memory and file descriptor leaks (LP: <a href="/bugs/1899193" class="bug-link">#1899193</a>)<br />
&nbsp;&nbsp;&nbsp;&nbsp;- python/arfile.cc, python/generic.h, python/tag.cc, python/tarfile.cc:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fix file descriptor and memory leaks<br />
&nbsp;&nbsp;&nbsp;&nbsp;- python/<wbr />apt_instmodule.<wbr />cc, python/<wbr />apt_instmodule.<wbr />h, python/arfile.h:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Avoid reference cycle with control,data members in apt_inst.DebFile<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;objects<br />
&nbsp;&nbsp;&nbsp;&nbsp;- tests/test_<wbr />cve_2020_<wbr />27351.py: Test cases for DebFile (others not easily<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;testable)<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2020-27351<br />
&nbsp;&nbsp;* .gitlab-ci.yml: Fix mypy version for CI<br />
&nbsp;&nbsp;* data/templates: Update mirror lists</p>
<p>&nbsp;-- Julian Andres Klode &lt;email address hidden&gt;  Tue, 01 Dec 2020 17:15:01 +0100</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">This bug was fixed in the package python-apt - 2.0.0ubuntu0.20.04.2

---------------
python-apt (2.0.0ubuntu0.20.04.2) focal-security; urgency=high

  * SECURITY UPDATE: various memory and file descriptor leaks (LP: #1899193)
    - python/arfile.cc, python/generic.h, python/tag.cc, python/tarfile.cc:
      fix file descriptor and memory leaks
    - python/apt_instmodule.cc, python/apt_instmodule.h, python/arfile.h:
      Avoid reference cycle with control,data members in apt_inst.DebFile
      objects
    - tests/test_cve_2020_27351.py: Test cases for DebFile (others not easily
      testable)
    - CVE-2020-27351
  * .gitlab-ci.yml: Fix mypy version for CI
  * data/templates: Update mirror lists

 -- Julian Andres Klode &lt;juliank@ubuntu.com&gt;  Tue, 01 Dec 2020 17:15:01 +0100</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in python-apt (Ubuntu): </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Triaged &#8594; Fix Released
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/apt/+bug/1899193/comments/38" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~janitor" class="sprite person-inactive">Launchpad Janitor (janitor)</a>
            wrote
            <time itemprop="commentTime" datetime="2020-12-09T16:32:35.654937+00:00" title="2020-12-09 16:32:35 UTC">on 2020-12-09</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/apt/+bug/1899193/comments/38"> #38</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>This bug was fixed in the package python-apt - 1.6.5ubuntu0.4</p>
<p>---------------<br />
python-apt (1.6.5ubuntu0.4) bionic-security; urgency=high</p>
<p>&nbsp;&nbsp;* SECURITY UPDATE: various memory and file descriptor leaks (LP: <a href="/bugs/1899193" class="bug-link">#1899193</a>)<br />
&nbsp;&nbsp;&nbsp;&nbsp;- python/arfile.cc, python/generic.h, python/tag.cc, python/tarfile.cc:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fix file descriptor and memory leaks<br />
&nbsp;&nbsp;&nbsp;&nbsp;- python/<wbr />apt_instmodule.<wbr />cc, python/<wbr />apt_instmodule.<wbr />h, python/arfile.h:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Avoid reference cycle with control,data members in apt_inst.DebFile<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;objects<br />
&nbsp;&nbsp;&nbsp;&nbsp;- tests/test_<wbr />cve_2020_<wbr />27351.py: Test cases for DebFile (others not easily<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;testable)<br />
&nbsp;&nbsp;&nbsp;&nbsp;- CVE-2020-27351<br />
&nbsp;&nbsp;* data/templates: Update mirror lists</p>
<p>&nbsp;-- Julian Andres Klode &lt;email address hidden&gt;  Tue, 01 Dec 2020 20:16:11 +0100</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">This bug was fixed in the package python-apt - 1.6.5ubuntu0.4

---------------
python-apt (1.6.5ubuntu0.4) bionic-security; urgency=high

  * SECURITY UPDATE: various memory and file descriptor leaks (LP: #1899193)
    - python/arfile.cc, python/generic.h, python/tag.cc, python/tarfile.cc:
      fix file descriptor and memory leaks
    - python/apt_instmodule.cc, python/apt_instmodule.h, python/arfile.h:
      Avoid reference cycle with control,data members in apt_inst.DebFile
      objects
    - tests/test_cve_2020_27351.py: Test cases for DebFile (others not easily
      testable)
    - CVE-2020-27351
  * data/templates: Update mirror lists

 -- Julian Andres Klode &lt;juliank@ubuntu.com&gt;  Tue, 01 Dec 2020 20:16:11 +0100</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in python-apt (Ubuntu): </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Triaged &#8594; Fix Released
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~seth-arnold" class="sprite person">Seth Arnold (seth-arnold)</a>
    
    <time title="2021-02-27 01:57:44 UTC" datetime="2021-02-27T01:57:44.393269+00:00">on 2021-02-27</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>information type</b>:
      </td>
      <td>
        Private Security &#8594; Public Security
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/ubuntu/+source/apt/+bug/1899193/comments/39" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~shaggy183" class="sprite person">shaun (shaggy183)</a>
            wrote
            <time itemprop="commentTime" datetime="2021-06-21T09:23:53.239942+00:00" title="2021-06-21 09:23:53 UTC">on 2021-06-21</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/ubuntu/+source/apt/+bug/1899193/comments/39"> #39</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>its laging and not adding my pakadges or exepting my passwords</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">its laging and not adding my pakadges or exepting my passwords</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        <div style="float: right;">
          <a class="menu-link-activitylog" href="https://bugs.launchpad.net/ubuntu/+source/apt/+bug/1899193/+activity">See full activity log</a>
        </div>
        <div class="clearfix"></div>

        
          

          
            <div align="center" id="add-comment-login-first">
              To post a comment you must <a href="+login?comments=all">log in</a>.
            </div>
          
        
        
      

      </div><!-- class="top-portlet" -->
      </div><!--- id="maincontentsub"-->
      <div>
        <div id="duplicate-form-container"></div>
        <div id="privacy-form-container"></div>
      </div>
    </div>
            
            
          </div><!-- yui-b -->
        </div><!-- yui-main -->

        
          <div id="side-portlets" class="yui-b side">
            
      <div id="involvement" class="portlet">
        <ul class="involvement">
          <li class="single">
            <a class="sprite bugs" href="/ubuntu/+source/apt/+filebug">
              Report a bug
            </a>
          </li>
        </ul>
      </div>
      <div id="privacy" class="first portlet public">
  <div id="privacy-text">
     <span id="information-type-summary" class="sprite public">This report contains
         <strong id="information-type">Public Security</strong>
         information
     </span>&nbsp;<a class="sprite edit action-icon" id="privacy-link" href="/ubuntu/+source/apt/+bug/1899193/+secrecy">Edit</a>

     <div id="information-type-description" style="padding-top: 5px">Everyone can see this security related information.
</div>
  </div>
</div>

      <div id="portlet-actions" class="portlet vertical">
  <ul id="duplicate-actions">
    <li class="sprite bug-dupe">
    <span id="mark-duplicate-text">
    <a class="menu-link-mark-dupe" href="/ubuntu/+source/apt/+bug/1899193/+duplicate">Mark as duplicate</a>
    </span>
    </li>
    
    <li><a class="menu-link-createquestion sprite add" href="https://bugs.launchpad.net/ubuntu/+source/apt/+bug/1899193/+create-question">Convert to a question</a></li>
    
    <li><a class="menu-link-addbranch sprite add" href="https://bugs.launchpad.net/ubuntu/+source/apt/+bug/1899193/+addbranch">Link a related branch</a></li>
    <li><a class="menu-link-linktocve sprite add" href="https://bugs.launchpad.net/ubuntu/+source/apt/+bug/1899193/+linkcve">Link to <abbr title="Common Vulnerabilities and Exposures Index">CVE</abbr></a></li>
    <li><a class="menu-link-unlinkcve sprite modify remove" href="https://bugs.launchpad.net/ubuntu/+source/apt/+bug/1899193/+unlinkcve">Remove CVE link</a></li>
  </ul>
</div>

      

      <div class="portlet vertical" id="portlet-subscription">
  <div class="section">
    <div id="current_user_subscription" class="False">
      
        <span>You are</span>
        
        <a class="menu-link-subscription sprite modify edit" href="/ubuntu/+source/apt/+bug/1899193/+subscribe">
           
           
           
           not directly subscribed to this bug's notifications.
        </a>
      
      
    </div>
    <div id="sub-unsub-spinner">Subscribing...</div>
    <ul>
      
      <li><a class="menu-link-editsubscriptions sprite modify edit" href="https://bugs.launchpad.net/ubuntu/+source/apt/+bug/1899193/+subscriptions" title="View and change your subscriptions to this bug">Edit bug mail</a></li>
    </ul>
  </div>
  <script type="text/javascript">
    LPJS.use('io-base', 'node',
            'lp.bugs.bugtask_index.portlets.subscription', function(Y) {
        Y.on('domready', function() {
            Y.lp.bugs.bugtask_index.portlets.subscription.initialize();
        });
    });
  </script>
</div>

      <div class="portlet vertical" id="portlet-subscribers">
  <h2>Other bug subscribers</h2>
  <div>
    <div><a class="menu-link-addsubscriber sprite add" href="https://bugs.launchpad.net/ubuntu/+source/apt/+bug/1899193/+addsubscriber" title="Launchpad will email that person whenever this bugs changes">Subscribe someone else</a></div>
  </div>
  <div id="other-bug-subscribers"></div>
</div>

      

      

      
  <div class="portlet" id="portlet-patches">
    <h2>Patches</h2>
    <ul>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/ubuntu/+source/apt/+bug/1899193/+attachment/5424168/+files/0001-arfile-Integer-overflow-in-parsing-GHSL-2020-168-GHS.patch">0001-arfile-Integer-overflow-in-parsing-GHSL-2020-168-GHS.patch</a>
        <small>
          (<a href="/ubuntu/+source/apt/+bug/1899193/+attachment/5424168">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/ubuntu/+source/apt/+bug/1899193/+attachment/5435161/+files/0001-File-descriptor-leaks-in-ArArchive-DebFile-TagFile.patch">0001-File-descriptor-leaks-in-ArArchive-DebFile-TagFile.patch</a>
        <small>
          (<a href="/ubuntu/+source/apt/+bug/1899193/+attachment/5435161">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/ubuntu/+source/apt/+bug/1899193/+attachment/5437531/+files/0001-apt_inst.DebFile-Avoid-reference-cycle-with-control-.patch">0001-apt_inst.DebFile-Avoid-reference-cycle-with-control-.patch</a>
        <small>
          (<a href="/ubuntu/+source/apt/+bug/1899193/+attachment/5437531">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/ubuntu/+source/apt/+bug/1899193/+attachment/5439980/+files/CVE-2020-27349.patch">CVE-2020-27349.patch</a>
        <small>
          (<a href="/ubuntu/+source/apt/+bug/1899193/+attachment/5439980">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/ubuntu/+source/apt/+bug/1899193/+attachment/5440104/+files/python-apt-focal.diff">python-apt-focal.diff</a>
        <small>
          (<a href="/ubuntu/+source/apt/+bug/1899193/+attachment/5440104">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/ubuntu/+source/apt/+bug/1899193/+attachment/5440105/+files/python-apt-bionic.diff">python-apt-bionic.diff</a>
        <small>
          (<a href="/ubuntu/+source/apt/+bug/1899193/+attachment/5440105">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/ubuntu/+source/apt/+bug/1899193/+attachment/5440106/+files/python-apt-xenial.diff">python-apt-xenial.diff</a>
        <small>
          (<a href="/ubuntu/+source/apt/+bug/1899193/+attachment/5440106">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/ubuntu/+source/apt/+bug/1899193/+attachment/5440107/+files/python-apt-groovy.diff">python-apt-groovy.diff</a>
        <small>
          (<a href="/ubuntu/+source/apt/+bug/1899193/+attachment/5440107">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/ubuntu/+source/apt/+bug/1899193/+attachment/5441609/+files/apt-groovy.diff">apt-groovy.diff</a>
        <small>
          (<a href="/ubuntu/+source/apt/+bug/1899193/+attachment/5441609">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/ubuntu/+source/apt/+bug/1899193/+attachment/5441610/+files/apt-focal.diff">apt-focal.diff</a>
        <small>
          (<a href="/ubuntu/+source/apt/+bug/1899193/+attachment/5441610">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/ubuntu/+source/apt/+bug/1899193/+attachment/5441618/+files/apt-bionic.diff">apt-bionic.diff</a>
        <small>
          (<a href="/ubuntu/+source/apt/+bug/1899193/+attachment/5441618">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/ubuntu/+source/apt/+bug/1899193/+attachment/5441619/+files/apt-xenial.diff">apt-xenial.diff</a>
        <small>
          (<a href="/ubuntu/+source/apt/+bug/1899193/+attachment/5441619">edit</a>)
        </small>
      </li>
    </ul>
    <ul>
      <li>
        <a class="sprite add" href="/ubuntu/+source/apt/+bug/1899193/+addcomment?field.patch=on">Add patch</a>
      </li>
    </ul>
  </div>
  <div class="portlet" id="portlet-attachments">
    <h2>Bug attachments</h2>
    <ul>
      <li class="download-attachment">
        <a class="sprite download-icon" href="https://bugs.launchpad.net/ubuntu/+source/apt/+bug/1899193/+attachment/5420025/+files/createdeb.c">createdeb.c</a>
        <small>
          (<a href="/ubuntu/+source/apt/+bug/1899193/+attachment/5420025">edit</a>)
        </small>
      </li>
    </ul>
    <ul>
      <li>
        <a class="sprite add" href="/ubuntu/+source/apt/+bug/1899193/+addcomment">Add attachment</a>
      </li>
    </ul>
  </div>


      

    
          </div><!-- yui-b side -->
        
      </div><!-- yui-t4 -->

      
  <div id="footer" class="footer">
    <div class="lp-arcana">
        <div class="lp-branding">
          <a href="https://launchpad.net/"><img src="/@@/launchpad-logo-and-name-hierarchy.png" alt="Launchpad" /></a>
          &nbsp;&bull;&nbsp;
          <a href="https://launchpad.net/+tour">Take the tour</a>
          &nbsp;&bull;&nbsp;
          <a href="https://help.launchpad.net/">Read the guide</a>
          &nbsp;
          <form id="globalsearch" method="get" accept-charset="UTF-8" action="https://launchpad.net/+search">
            <input type="search" id="search-text" name="field.text" />
            <input type="image" src="/@@/search" style="vertical-align:5%" alt="Search Launchpad" />
          </form>
        </div>
        
  

    </div>

    <div class="colophon">
      &copy; 2004-2021
      <a href="http://canonical.com/">Canonical&nbsp;Ltd.</a>
      &nbsp;&bull;&nbsp;
      <a href="https://launchpad.net/legal">Terms of use</a>
      &nbsp;&bull;&nbsp;
      <a href="https://www.ubuntu.com/legal/dataprivacy">Data privacy</a>
      &nbsp;&bull;&nbsp;
      <a href="/feedback">Contact Launchpad Support</a>
      
      &nbsp;&bull;&nbsp;
      <a href="http://blog.launchpad.net/">Blog</a>
      
	&nbsp;&bull;&nbsp;
	<a href="https://canonical.com/careers">Careers</a>
      
      &nbsp;&bull;&nbsp;
      <a href="https://twitter.com/launchpadstatus">System status</a>
      <span id="lp-version">
      &nbsp;&bull;&nbsp;
        r0d8de2b
        
        
        (<a href="https://dev.launchpad.net/">Get the code!</a>)
      </span>
    </div>
  </div>

    </div><!-- yui-d0-->

    
  
  
  <script id="json-cache-script">LP.cache = {"bug_is_private": false, "information_type_data": {"PUBLICSECURITY": {"name": "Public Security", "description_css_class": "choice-description", "is_private": false, "value": "PUBLICSECURITY", "description": "Everyone can see this security related information.\n", "order": 1}, "PRIVATESECURITY": {"name": "Private Security", "description_css_class": "choice-description", "is_private": true, "value": "PRIVATESECURITY", "description": "Only the security group can see this information.\n ", "order": 2}, "PUBLIC": {"name": "Public", "description_css_class": "choice-description", "is_private": false, "value": "PUBLIC", "description": "Everyone can see this information.\n", "order": 0}, "USERDATA": {"name": "Private", "description_css_class": "choice-description", "is_private": true, "value": "USERDATA", "description": "Only shared with users permitted to see private user information.\n", "order": 3}}, "initial_comment_batch_offset": 41, "subscribers_portlet_url_data": {"web_link": "https://bugs.launchpad.net/bugs/1899193", "self_link": "https://bugs.launchpad.net/api/devel/bugs/1899193"}, "first visible_recent_comment": -1, "bug": {"self_link": "https://bugs.launchpad.net/api/devel/bugs/1899193", "web_link": "https://bugs.launchpad.net/bugs/1899193", "resource_type_link": "https://bugs.launchpad.net/api/devel/#bug", "id": 1899193, "private": false, "information_type": "Public Security", "name": null, "title": "local denial of service due to parsing bugs in arfile.cc", "description": "# GitHub Security Lab (GHSL) Vulnerability Report: `GHSL-2020-168`, `GHSL-2020-169`, `GHSL-2020-170`\n\nThe [GitHub Security Lab](https://securitylab.github.com) team has identified potential security vulnerabilities in aptd.\n\nWe are committed to working with you to help resolve these issues. In this report you will find everything you need to effectively coordinate a resolution of these issues with the GHSL team.\n\nIf at any point you have concerns or questions about this process, please do not hesitate to reach out to us at `\u003cemail address hidden\u003e` (please include `GHSL-2020-168`, `GHSL-2020-169`, or `GHSL-2020-170` as a reference).\n\nIf you are _NOT_ the correct point of contact for this report, please let us know!\n\n## Summary\n\nThe aptd daemon is a system service for installing and updating packages. It is accessible via [dbus](https://www.freedesktop.org/wiki/Software/dbus/) and has a method named \"InstallFile\" which is used for installing local `.deb` packages. Although polkit is used to prevent an unprivileged user from using \"InstallFile\" to install a malicious `.deb` package, it does not prevent aptd from parsing the contents of the `.deb` file. The parsing logic is provided by two packages, [libapt-pkg-dev](https://packages.ubuntu.com/focal/libapt-pkg-dev) and [python-apt](https://packages.ubuntu.com/source/focal/python-apt), and is implemented in C. These two packages contain several bugs, which an unprivileged user can exploit to trigger a local denial of service attack.\n\n## Product\n\naptd\n\n## Tested Version\n\n* libapt-pkg-dev: version 2.0.2ubuntu0.1\n* python-apt: 2.0.0ubuntu0.20.04.1\n* Tested on Ubuntu 20.04.1 LTS\n\n## Details\n\n### Issue 1: aptd crash due to integer overflow in arfile.cc (GHSL-2020-168)\n\nA crafted `.deb` package can trigger a negative integer overflow at [arfile.cc, line 116](https://git.launchpad.net/ubuntu/+source/apt/tree/apt-pkg/contrib/arfile.cc?h=applied/ubuntu/focal-updates\u0026id=4c264e60b524855b211751e1632ba48526f6b44d#n116):\n\n```c\nMemb-\u003eSize -= Len;\n```\n\nDue to the integer overflow, the value of `Memb-\u003eSize` is `0xFFFFFFFFFFFFFFFF`. This leads to an out-of-memory error at [arfile.cc, line 602](https://git.launchpad.net/ubuntu/+source/python-apt/tree/python/arfile.cc?h=applied/ubuntu/focal-updates\u0026id=0f7cc93acdb51d943114f1cd79002288c4ca4d24#n602):\n\n```c\nchar* value = new char[member-\u003eSize];\n```\n\nThe out-of-memory error causes aptd to crash.\n\nPlease note that the source locations above refer to two separate files, both named `arfile.cc`. The first is from the libapt-pkg-dev package and the second is from the python-apt package.\n\nTo trigger the crash, first use the attached source file named \"createdeb.c\" to generate the malicious `.deb` file:\n\n```bash\ngcc createdeb.c -o createdeb\n./createdeb crash test.deb\n```\n\nNow use `dbus-send` to send the malicious `.deb` file to aptd:\n\n```bash\n$ dbus-send --system --type=\"method_call\" --print-reply --dest=org.debian.apt /org/debian/apt org.debian.apt.InstallFile string:`realpath test.deb` boolean:true\nmethod return time=1602245339.731762 sender=:1.287 -\u003e destination=:1.288 serial=8 reply_serial=2\n   string \"/org/debian/apt/transaction/90f29de930854568964af1918f6ca5eb\"\n$ dbus-send --system --type=\"method_call\" --print-reply --dest=org.debian.apt /org/debian/apt/transaction/90f29de930854568964af1918f6ca5eb org.debian.apt.transaction.Run\n```\n\nNote that you need to use the \"transaction id\" returned by the first `dbus-send` in the second `dbus-send` command.\n\n#### Impact\n\nThis issue may lead to local denial of service.\n\n#### Resources\n\nI have attached `createdeb.c`, which can be used to generate the malicious `.deb` file.\n\n### Issue 2: aptd infinite loop due to integer overflow in arfile.cc (GHSL-2020-169)\n\nThis issue is very similar to issue 1, but is caused by a different bug. This bug occurs during the call to `StrToNum` at [arfile.cc, line 92](https://git.launchpad.net/ubuntu/+source/apt/tree/apt-pkg/contrib/arfile.cc?h=applied/ubuntu/focal-updates\u0026id=4c264e60b524855b211751e1632ba48526f6b44d#n92):\n\n```c\nStrToNum(Head.Size,Memb-\u003eSize,sizeof(Head.Size)) == false)\n```\n\nThe bug is due to the use of `strtoul` in [StrToNum](https://git.launchpad.net/ubuntu/+source/apt/tree/apt-pkg/contrib/strutl.cc?h=applied/ubuntu/focal-updates\u0026id=4c264e60b524855b211751e1632ba48526f6b44d#n1169):\n\n```c\n// StrToNum - Convert a fixed length string to a number\t\t\t/*{{{*/\n// ---------------------------------------------------------------------\n/* This is used in decoding the crazy fixed length string headers in\n   tar and ar files. */\nbool StrToNum(const char *Str,unsigned long \u0026Res,unsigned Len,unsigned Base)\n{\n   char S[30];\n   if (Len \u003e= sizeof(S))\n      return false;\n   memcpy(S,Str,Len);\n   S[Len] = 0;\n\n   // All spaces is a zero\n   Res = 0;\n   unsigned I;\n   for (I = 0; S[I] == ' '; I++);\n   if (S[I] == 0)\n      return true;\n\n   char *End;\n   Res = strtoul(S,\u0026End,Base);  \u003c====== negative numbers accepted\n   if (End == S)\n      return false;\n\n   return true;\n}\n```\n\nThe bug is that `strtoul` allows the number to be negative. For example, it will accept the string \"-60\". I have written a proof-of-concept exploit which uses this to put the parser into an infinite loop.\n\nTo run the proof-of-concept, first use the attached source file named \"createdeb.c\" to generate the malicious `.deb` file:\n\n```bash\ngcc createdeb.c -o createdeb\n./createdeb loop test.deb\n```\n\nNow use `dbus-send` to send the malicious `.deb` file to aptd:\n\n```bash\n$ dbus-send --system --type=\"method_call\" --print-reply --dest=org.debian.apt /org/debian/apt org.debian.apt.InstallFile string:`realpath test.deb` boolean:true\nmethod return time=1602245339.731762 sender=:1.287 -\u003e destination=:1.288 serial=8 reply_serial=2\n   string \"/org/debian/apt/transaction/90f29de930854568964af1918f6ca5eb\"\n$ dbus-send --system --type=\"method_call\" --print-reply --dest=org.debian.apt /org/debian/apt/transaction/90f29de930854568964af1918f6ca5eb org.debian.apt.transaction.Run\n```\n\nNote that you need to use the \"transaction id\" returned by the first `dbus-send` in the second `dbus-send` command.\n\n#### Impact\n\nThis issue may lead to local denial of service.\n\n#### Resources\n\nI have attached `createdeb.c`, which can be used to generate the malicious `.deb` file.\n\n### Issue 3: aptd file descriptor leak (GHSL-2020-170)\n\nThere is a file descriptor leak in `debfile_new` at [arfile.cc, line 588](https://git.launchpad.net/ubuntu/+source/python-apt/tree/python/arfile.cc?h=applied/ubuntu/focal-updates\u0026id=0f7cc93acdb51d943114f1cd79002288c4ca4d24#n588):\n\n```c\nstatic PyObject *debfile_new(PyTypeObject *type, PyObject *args, PyObject *kwds)\n{\n    PyDebFileObject *self = (PyDebFileObject*)ararchive_new(type, args, kwds);\n    if (self == NULL)\n        return NULL;\n\n    // DebFile\n    self-\u003econtrol = debfile_get_tar(self, \"control.tar\");\n    if (self-\u003econtrol == NULL)\n        return NULL;  \u003c===== self is not freed, so a file descriptor is leaked\n```\n\nIf the `.deb` file is invalid, then `debfile_new()` returns `NULL`, forgetting to free `self`. This means that the file descriptor for the `.deb` file is not closed. An attacker could use this to exhaust the system's file descriptors, causing a local denial of service.\n\nTo run the proof-of-concept, first use the attached source file named \"createdeb.c\" to generate the malicious `.deb` file:\n\n```bash\ngcc createdeb.c -o createdeb\n./createdeb leakfd test.deb\n```\n\nNow use `dbus-send` to send the malicious `.deb` file to aptd:\n\n```bash\n$ dbus-send --system --type=\"method_call\" --print-reply --dest=org.debian.apt /org/debian/apt org.debian.apt.InstallFile string:`realpath test.deb` boolean:true\nmethod return time=1602245339.731762 sender=:1.287 -\u003e destination=:1.288 serial=8 reply_serial=2\n   string \"/org/debian/apt/transaction/90f29de930854568964af1918f6ca5eb\"\n$ dbus-send --system --type=\"method_call\" --print-reply --dest=org.debian.apt /org/debian/apt/transaction/90f29de930854568964af1918f6ca5eb org.debian.apt.transaction.Run\n```\n\nNote that you need to use the \"transaction id\" returned by the first `dbus-send` in the second `dbus-send` command. Every time you run the PoC, aptd will open another file descriptor to the `.deb` file, which you can observe by running `lsof -p \u003cpid of aptd\u003e`.\n\n#### Impact\n\nThis issue may lead to local denial of service.\n\n#### Resources\n\nI have attached `createdeb.c`, which can be used to generate the malicious `.deb` file.\n\n## Credit\n\nThese issues were discovered and reported by GHSL team member [@kevinbackhouse (Kevin Backhouse)](https://github.com/kevinbackhouse).\n\n## Contact\n\nYou can contact the GHSL team at `\u003cemail address hidden\u003e`, please include a reference to `GHSL-2020-168`, `GHSL-2020-169`, or `GHSL-2020-170` in any communication regarding these issues.\n\n## Disclosure Policy\n\nThis report is subject to our [coordinated disclosure policy](https://securitylab.github.com/disclosures#policy).", "owner_link": "https://bugs.launchpad.net/api/devel/~kbackhouse2000", "bug_tasks_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1899193/bug_tasks", "duplicate_of_link": null, "date_created": "2020-10-09T16:29:17.457962+00:00", "activity_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1899193/activity", "subscriptions_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1899193/subscriptions", "date_last_updated": "2021-06-21T09:23:54.126457+00:00", "who_made_private_link": null, "date_made_private": null, "heat": 262, "bug_watches_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1899193/bug_watches", "cves_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1899193/cves", "duplicates_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1899193/duplicates", "attachments_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1899193/attachments", "security_related": true, "latest_patch_uploaded": "2020-12-07T13:12:51.149797+00:00", "tags": [], "date_last_message": "2021-06-21T09:23:53.239942+00:00", "number_of_duplicates": 0, "message_count": 40, "users_affected_count": 1, "users_unaffected_count": 0, "users_affected_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1899193/users_affected", "users_unaffected_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1899193/users_unaffected", "users_affected_count_with_dupes": 1, "other_users_affected_count_with_dupes": 1, "users_affected_with_dupes_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1899193/users_affected_with_dupes", "messages_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1899193/messages", "linked_branches_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1899193/linked_branches", "linked_merge_proposals_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1899193/linked_merge_proposals", "http_etag": "\"16c73e24bafaf1aa1730078eef21322bc1ed9ebd-d0be538a974aca7969422fb4b635867ab894bf22\""}, "total_comments_and_activity": 73, "related_features": {}, "context": {"self_link": "https://bugs.launchpad.net/api/devel/ubuntu/+source/apt/+bug/1899193", "web_link": "https://bugs.launchpad.net/ubuntu/+source/apt/+bug/1899193", "resource_type_link": "https://bugs.launchpad.net/api/devel/#bug_task", "bug_link": "https://bugs.launchpad.net/api/devel/bugs/1899193", "milestone_link": null, "status": "Fix Released", "importance": "Undecided", "assignee_link": null, "bug_target_display_name": "apt (Ubuntu)", "bug_target_name": "apt (Ubuntu)", "bug_watch_link": null, "date_assigned": null, "date_created": "2020-10-09T16:29:17.457962+00:00", "date_confirmed": "2020-10-10T00:29:11.985392+00:00", "date_incomplete": null, "date_in_progress": "2020-12-09T16:24:59.483109+00:00", "date_closed": "2020-12-09T16:24:59.483109+00:00", "date_left_new": "2020-10-10T00:29:11.985392+00:00", "date_triaged": "2020-10-19T11:33:11.993547+00:00", "date_fix_committed": "2020-12-09T16:24:59.483109+00:00", "date_fix_released": "2020-12-09T16:24:59.483109+00:00", "date_left_closed": null, "owner_link": "https://bugs.launchpad.net/api/devel/~kbackhouse2000", "target_link": "https://bugs.launchpad.net/api/devel/ubuntu/+source/apt", "title": "Bug #1899193 in apt (Ubuntu): \"local denial of service due to parsing bugs in arfile.cc\"", "related_tasks_collection_link": "https://bugs.launchpad.net/api/devel/ubuntu/+source/apt/+bug/1899193/related_tasks", "is_complete": true, "http_etag": "\"6e51c608a0d8803815af1f8771c9cd97920a8696-618e748c6a4f699f7ad380527c4b3c9da5c55ade\""}, "bugtask_data": {"2649608": {"bugtask_path": "/ubuntu/+source/python-apt/+bug/1899193", "bug_title": "local denial of service due to parsing bugs in arfile.cc", "user_can_delete": false, "milestone_value": null, "milestone_widget_items": "[]", "importance_widget_items": "[]", "assignee_vocabulary": "AllUserTeamsParticipation", "user_can_edit_assignee": false, "targetname": "python-apt (Ubuntu)", "hide_assignee_team_selection": true, "assignee_is_team": null, "status_widget_items": "[]", "delete_link": "https://bugs.launchpad.net/ubuntu/+source/python-apt/+bug/1899193/+delete", "row_id": "tasksummary2649608", "target_is_product": false, "id": 2649608, "form_row_id": "task2649608", "assignee_vocabulary_filters": [], "prefix": "ubuntu_python-apt", "importance_value": "Undecided", "status_value": "Fix Released", "assignee_value": null, "user_can_edit_milestone": false, "user_can_unassign": false, "user_can_edit_status": true, "user_can_edit_importance": false}, "2661827": {"bugtask_path": "/ubuntu/+source/aptdaemon/+bug/1899193", "bug_title": "local denial of service due to parsing bugs in arfile.cc", "user_can_delete": false, "milestone_value": null, "milestone_widget_items": "[]", "importance_widget_items": "[]", "assignee_vocabulary": "AllUserTeamsParticipation", "user_can_edit_assignee": false, "targetname": "aptdaemon (Ubuntu)", "hide_assignee_team_selection": true, "assignee_is_team": null, "status_widget_items": "[]", "delete_link": "https://bugs.launchpad.net/ubuntu/+source/aptdaemon/+bug/1899193/+delete", "row_id": "tasksummary2661827", "target_is_product": false, "id": 2661827, "form_row_id": "task2661827", "assignee_vocabulary_filters": [], "prefix": "ubuntu_aptdaemon", "importance_value": "Undecided", "status_value": "Fix Released", "assignee_value": null, "user_can_edit_milestone": false, "user_can_unassign": false, "user_can_edit_status": true, "user_can_edit_importance": false}, "2647493": {"bugtask_path": "/ubuntu/+source/apt/+bug/1899193", "bug_title": "local denial of service due to parsing bugs in arfile.cc", "user_can_delete": false, "milestone_value": null, "milestone_widget_items": "[]", "importance_widget_items": "[]", "assignee_vocabulary": "AllUserTeamsParticipation", "user_can_edit_assignee": false, "targetname": "apt (Ubuntu)", "hide_assignee_team_selection": true, "assignee_is_team": null, "status_widget_items": "[]", "delete_link": "https://bugs.launchpad.net/ubuntu/+source/apt/+bug/1899193/+delete", "row_id": "tasksummary2647493", "target_is_product": false, "id": 2647493, "form_row_id": "task2647493", "assignee_vocabulary_filters": [], "prefix": "ubuntu_apt", "importance_value": "Undecided", "status_value": "Fix Released", "assignee_value": null, "user_can_edit_milestone": false, "user_can_unassign": false, "user_can_edit_status": true, "user_can_edit_importance": false}}};</script>

    
  

    
  </body>


  <!--
    Facet name: bugs
    Page type: main_side
    Has global search: True
    Has application tabs: True
    Has side portlets: True

    At least 66 queries/external actions issued in 0.87 seconds

    Features: {'app.mainsite_only.canonical_url': None, 'disclosure.dsp_picker.enabled': 'on', 'bugs.affected_count_includes_dupes.disabled': None, 'baselayout.careers_link.disabled': None, 'js.yui_version': None, 'profiling.enabled': None, 'visible_render_time': None, 'hard_timeout': '9000', 'bugs.nominations.bug_supervisors_can_target': 'on', 'app.maintenance_message': None}

    r0d8de2b

    -->

</html>

