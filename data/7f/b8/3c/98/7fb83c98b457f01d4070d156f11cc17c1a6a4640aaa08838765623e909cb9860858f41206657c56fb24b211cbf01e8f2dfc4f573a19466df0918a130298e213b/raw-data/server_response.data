<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="UTF-8">

      <meta name="referrer" content="origin">
<script type="text/javascript" src="page.cgi?1635595599&amp;id=bayotbase/fielddefs.js"></script>




<script type="text/javascript">var BB_CONFIG = ({"user":{"enterable_products":[],"groups":[],"logged_in":false},"defaults":{"platform":"Unspecified","bugentry_fields":["summary","product","component","rh_sub_components","severity","priority","comment"],"priority":"Unspecified","severity":"Unspecified","op_sys":"Unspecified"}});</script><script type="text/javascript">
var classifications = '[ { "name": "Red Hat", "description": "Red Hat Products"},{ "name": "Workflows", "description": "User driven workflows"},{ "name": "JBoss", "description": "JBoss Products"},{ "name": "CentOS", "description": "CentOS Projects"},{ "name": "Fedora", "description": "Fedora Products"},{ "name": "Community", "description": "Community Projects"},{ "name": "oVirt", "description": "oVirt Virtualization Management Projects"},{ "name": "Internal", "description": "Internal Projects."},{ "name": "Other", "description": "Other Miscellaneous Products"},{ "name": "Unclassified", "description": "Not assigned to any classification"},{ "name": "Retired", "description": "Products that have reached end of life, or were never released."} ]';
var c_optgroups = JSON.parse(classifications);
</script>
    <title>1178263 &ndash; wpa_supplicant: add support for non-substring server identity check [rhel-7]</title>

      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<link href="js/yui/assets/skins/sam/autocomplete.css" rel="stylesheet" type="text/css"><link href="js/yui/assets/skins/sam/calendar.css" rel="stylesheet" type="text/css"><link href="skins/standard/global.css" rel="stylesheet" type="text/css"><link href="extensions/BayotBase/web/css/base.css" rel="stylesheet" type="text/css"><link href="extensions/BayotBase/web/jquery-ui-1.12.1.custom/jquery-ui.min.css" rel="stylesheet" type="text/css"><link href="skins/standard/bug.css" rel="stylesheet" type="text/css"><link href="extensions/Voting/web/style.css" rel="stylesheet" type="text/css"><link href="extensions/ExternalBugs/web/css/global.css" rel="stylesheet" type="text/css"><link href="extensions/FontAwesome/web/css/all.min.css" rel="stylesheet" type="text/css"><link href="extensions/RedHat/web/css/redhat.css" rel="stylesheet" type="text/css"><link href="extensions/RedHat/web/DataTables/datatables.min.css" rel="stylesheet" type="text/css"><link href="extensions/RedHat/web/alertify/css/alertify.min.css" rel="stylesheet" type="text/css"><link href="extensions/RedHat/web/alertify/css/themes/bootstrap.min.css" rel="stylesheet" type="text/css"><link href="extensions/SelectizeJS/web/css/selectize.bootstrap3.css" rel="stylesheet" type="text/css"><link href="extensions/SelectizeJS/web/css/SelectizeJS.css" rel="stylesheet" type="text/css">



    
<script type="text/javascript" src="js/yui/yahoo-dom-event/yahoo-dom-event.js"></script><script type="text/javascript" src="js/yui/cookie/cookie-min.js"></script><script type="text/javascript" src="extensions/BayotBase/web/js/jquery-3.6.0.min.js"></script><script type="text/javascript" src="extensions/BayotBase/web/jquery-ui-1.12.1.custom/jquery-ui.min.js"></script><script type="text/javascript" src="extensions/BayotBase/web/js/jquery.cookie.js"></script><script type="text/javascript" src="extensions/BayotBase/web/js/jquery.jsonrpc.js"></script><script type="text/javascript" src="extensions/BayotBase/web/js/Base.js"></script><script type="text/javascript" src="extensions/BayotBase/web/js/bayot.util.js"></script><script type="text/javascript" src="js/yui/datasource/datasource-min.js"></script><script type="text/javascript" src="js/yui/connection/connection-min.js"></script><script type="text/javascript" src="js/yui/json/json-min.js"></script><script type="text/javascript" src="js/yui/autocomplete/autocomplete-min.js"></script><script type="text/javascript" src="js/yui/calendar/calendar-min.js"></script><script type="text/javascript" src="js/global.js"></script>

    <script type="text/javascript">
    <!--
        YAHOO.namespace('bugzilla');
        YAHOO.util.Event.addListener = function (el, sType, fn, obj, overrideContext) {
               if ( ("onpagehide" in window || YAHOO.env.ua.gecko) && sType === "unload") { sType = "pagehide"; };
               var capture = ((sType == "focusin" || sType == "focusout") && !YAHOO.env.ua.ie) ? true : false;
               return this._addListener(el, this._getType(sType), fn, obj, overrideContext, capture);
         };
        if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
            YAHOO.util.Event._simpleRemove(window, "unload", 
                                           YAHOO.util.Event._unload);
        }
        
        function unhide_language_selector() { 
            YAHOO.util.Dom.removeClass(
                'lang_links_container', 'bz_default_hidden'
            ); 
        } 
        YAHOO.util.Event.onDOMReady(unhide_language_selector);

        
        var BUGZILLA = {
            param: {
                cookiepath: '\/',
                maxusermatches: 5,
                maxattachmentsize: 20000
            },
            constant: {
                COMMENT_COLS: 80
            },
            string: {
                

                attach_desc_required:
                    "You must enter a Description for this attachment.",
                component_required:
                    "You must select a Component for this bug.",
                description_required:
                    "You must enter a Description for this bug.",
                short_desc_required:
                    "You must enter a Summary for this bug.",
                version_required:
                    "You must select a Version for this bug.",
                group_required:
                    "You must select at least one group for bugs in this product."
            }
            
              , api_token: ''
            
        };

    if (history && history.replaceState) {
      if(!document.location.href.match(/show_bug\.cgi/)) {
        history.replaceState( null,
                             "1178263 – wpa_supplicant: add support for non-substring server identity check [rhel-7]",
                             "show_bug.cgi?id=1178263" );
        document.title = "1178263 – wpa_supplicant: add support for non-substring server identity check [rhel-7]";
      }
      if (document.location.href.match(/show_bug\.cgi\?.*list_id=/)) {
        var href = document.location.href;
        href = href.replace(/[\?&]+list_id=(\d+|cookie)/, '');
        history.replaceState(null, "1178263 – wpa_supplicant: add support for non-substring server identity check [rhel-7]", href);
      }
    }
    YAHOO.util.Event.onDOMReady(function() {
      initDirtyFieldTracking();

    });
    // -->
    </script>
<script type="text/javascript" src="js/util.js"></script><script type="text/javascript" src="js/field.js"></script><script type="text/javascript" src="extensions/ExternalBugs/web/js/external_bugs.js"></script><script type="text/javascript" src="extensions/RedHat/web/DataTables/datatables.min.js"></script><script type="text/javascript" src="extensions/RedHat/web/alertify/alertify.min.js"></script><script type="text/javascript" src="extensions/RedHat/web/colResize/dataTables.colResize.js"></script><script type="text/javascript" src="extensions/RedHat/web/js/redhat.js"></script><script type="text/javascript" src="extensions/SelectizeJS/web/js/standalone/selectize.min.js"></script><script type="text/javascript" src="extensions/SelectizeJS/web/js/SelectizeJS.js"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Red Hat Bugzilla" href="./search_plugin.cgi">
    <link rel="shortcut icon" href="/extensions/RedHat/web/css/favicons/production.ico?v=0">
  </head>

  <body 
        class="bugzilla-redhat-com status_colours_pastel
                 bz_bug
                 bz_status_CLOSED
                 bz_product_Red_Hat_Enterprise_Linux_7
                 bz_component_wpa_supplicant
                 bz_bug_1178263 yui-skin-sam">

  <div id="header"><div id="banner">
   <ul id="loginin_launcher"><a href="#" onclick="$('#loginin_launcher').addClass('bz_default_hidden');$('#login_container').removeClass('bz_default_hidden');"><i class="fa fa-user" aria-hidden="true"></i>&nbsp;&nbsp;Login</a></ul>
   <ul id="login_container" class="bz_default_hidden">
    <a href="#" id="hide_mini_login" onclick="$('#login_container').addClass('bz_default_hidden');$('#loginin_launcher').removeClass('bz_default_hidden');">[x]</a>
     
    <li id="mini_login_container"><div id="saml2_container">
    Log in using an account from:
  <div id="saml2auth_login_Fedora Account System">
    <a href="saml2_login.cgi?idp=Fedora%20Account%20System&amp;target=show_bug.cgi%3Fid%3D1178263"><i class="fa fa-cogs" aria-hidden="true"></i>&nbsp;&nbsp;Fedora Account System</a>
  </div>
  <div id="saml2auth_login_Red Hat Associate">
    <a href="saml2_login.cgi?idp=Red%20Hat%20Associate&amp;target=show_bug.cgi%3Fid%3D1178263"><i class="fa fa-user-secret" aria-hidden="true"></i>&nbsp;&nbsp;Red Hat Associate</a>
  </div>
  <div id="saml2auth_login_Red Hat Customer">
    <a href="saml2_login.cgi?idp=Red%20Hat%20Customer&amp;target=show_bug.cgi%3Fid%3D1178263"><i class="fa fa-user" aria-hidden="true"></i>&nbsp;&nbsp;Red Hat Customer</a>
  </div>
  Or login using a Red Hat Bugzilla account
  <div>

  <form action="show_bug.cgi?id=1178263" method="POST"
        class="mini_login "
        id="mini_login">
    <input id="Bugzilla_login" required
           name="Bugzilla_login" class="bz_login"
        type="email" placeholder="Email Address">
    <input class="bz_password" name="Bugzilla_password" type="password"
           id="Bugzilla_password" required
           placeholder="Password">
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
            id="log_in">
  </form>
</li>
<li id="forgot_container">
  <a id="forgot_link" href="#forgot"
     onclick="return show_forgot_form('')"><i class="fa fa-exclamation-triangle" aria-hidden="true"></i>&nbsp;&nbsp;Forgot&nbsp;Password</a>
  <form action="token.cgi" method="post" id="forgot_form"
        class="mini_forgot bz_default_hidden">
    <label for="login">Login:</label>
    <input name="loginname" size="20" id="login" required
        type="email" placeholder="Your Email Address">
    <input id="forgot_button" value="Reset Password" 
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <input type="hidden" id="token" name="token"
           value="1635624810-EKeSwLYZ0WWTwSEfpoz4HapyoBhE9L-Gan9NP1MDN9Q">
    <p>
    <a href="#" onclick="return hide_forgot_form('')"><i class="fa fa-exclamation-triangle" aria-hidden="true"></i>&nbsp;&nbsp;Hide Forgot</a>
  </form>
</li>
<li>
  <a href="createaccount.cgi"><span><i class="fas fa-plus" aria-hidden="true"></i>&nbsp;&nbsp;Create an Account</span></a>
</li>
    
   </ul>
  </div>

    <div id="titles">
      <span id="title">Red Hat Bugzilla &ndash; Bug&nbsp;1178263</span>


    </div>


    <div id="common_links"><ul class="links">
  <li class="form">
    
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_top" name="no_redirect" value="0">
    <script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_top");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_top" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_top"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>
  <li><a href="./" title="Home"><i class="fas fa-home"></i></a></li>
  <li><a href="enter_bug.cgi">New</a></li>
  <li class="submenu">
    <a href="#" title="Search"><i class="fas fa-search"></i> <span class="fa fa-caret-down"></span></a>
    <div>
      <ul>
        <li><a href="query.cgi?format=specific">Simple Search</a></li>
        <li><a href="query.cgi?format=advanced">Advanced Search</a></li>
      </ul>
    </div>
  </li>
  <li class="submenu">
   <a href="#">My Links <span class="fa fa-caret-down"></span></a>
   <div>
    <ul>
      <li><a href="describecomponents.cgi">Browse</a></li>
      <li>
            <a href="request.cgi">Requests</a></li>
      <li class="submenu">
        <a  href="report.cgi">Reports <span class="fa fa-caret-right"></span></a>
        <div>
          <ul>
            </li>
            <li class="submenu">
              <a  href="#">Current State <span class="fa fa-caret-right"></span></a>
              <div>
                <ul>
                  <li id="report_search">
                    <a href="query.cgi">Search</a>
                  </li>
                  <li id="report_tabular">
                      <a href="query.cgi?format=report-table">Tabular reports</a>
                  </li>
                    <li id="report_graphical">
                        <a href="query.cgi?format=report-graph">Graphical reports</a>
                    </li>
                  <li id="report_duplicates">
                    <a href="duplicates.cgi">Duplicates</a>
                  </li>
                </ul>
              </div>
            </li>
            <li class="submenu">
              <a  href="#">Other Reports <span class="fa fa-caret-right"></span></a>
              <div>
                <ul>
                  <li>
                      <a href="https://bugzilla.redhat.com/page.cgi?id=user_activity.html">User Changes</a>
                  </li>
                </ul>
              </div>
            </li>
            <li class="submenu">
              <a  href="#">Plotly Reports <span class="fa fa-caret-right"></span></a>
              <div>
                <ul>
                  <li>
                      <a href="https://bugzilla.redhat.com/page.cgi?id=bug_status.html">Bug Status</a>
                  </li>
                  <li>
                      <a href="https://bugzilla.redhat.com/page.cgi?id=bug_severity.html">Bug Severity</a>
                  </li>
                  <li>
                      <a href="https://bugzilla.redhat.com/page.cgi?id=non_defaults.html">Non-Defaults</a>
                  </li>
                </ul>
              </div>
            </li>
          </ul>
        </div>
      </li><li><span class="separator"> | </span><a href="page.cgi?id=productdashboard.html">Product Dashboard</a></li>
    </ul>
   </div>
  </li>

  <li class="submenu">
   <a href="#">Help <span class="fa fa-caret-down"></span></a>
   <div>
    <ul><li><a href="docs/en/html/using/understanding.html" >Page Help!</a></li>
      <li><a href="page.cgi?id=bug-writing.html">Bug Writing Guidelines</a></li> 
      <li><a href="page.cgi?id=whats-new.html">What's new</a></li>
      <li><a href="https://access.redhat.com/help/browsers">Browser Support Policy</a></li>
      <li><a href="page.cgi?id=release-notes.html">5.0.4.rh64 Release notes</a></li>
      <li><a href="page.cgi?id=faq.html">FAQ</a></li>
      <li><a href="docs/en/html/index.html">Guides index</a></li>
      <li><a href="docs/en/html/using/index.html">User guide</a></li>
      <li><a href="docs/en/html/integrating/api/Bugzilla/WebService/Bug.html">Web Services</a></li>
      <li><a href="page.cgi?id=redhat/contact.html" >Contact</a></li> 
      <li><a href="page.cgi?id=terms-conditions.html" >Legal</a></li> 
    </ul>
   </div>
  </li>



</ul>
    </div>
  </div>


  <div id="bugzilla-body">



<noscript>
      <div id="no-js-message">This site requires JavaScript to be enabled to function correctly, please enable it.</div>
</noscript>

<ul class="related_actions">
    <li><a href="show_bug.cgi?format=multiple&amp;id=1178263" title="Format For Printing"><i class="fa fa-print"></i></a></li>
    <li><a href="show_bug.cgi?ctype=xml&amp;id=1178263" title="Export as XML"><i class="far fa-file-excel"></i></a></li>
    <li><a href="enter_bug.cgi?cloned_bug_id=1178263" title="Clone This Bug"><i class="fa fa-clone"></i></a></li>
    <li>
      <a href="enter_bug.cgi?cloned_bug_id=1178263&lite=1" title="Copy is a lite weight clone that only copies the summary &amp; description">
       <i class="far fa-clone"></i>
      </a>
    </li>


          
    <li>
      <a href="#c45" title="Last Comment">
         <i class="fas fa-arrow-down" aria-hidden="true"></i>
      </a>
    </li><li>
  <a href="buglist.cgi?bug_id=1178263&amp;bug_id_type=anddependson&amp;format=tvp" title="TreeView+">
    <i class="fa fa-tree"></i>
  </a>
</li>
    </ul>
<script type="text/javascript">
<!--

//-->
</script>




<form name="changeform" id="changeform" method="post" action="process_bug.cgi">





  <input type="hidden" name="delta_ts" value="2015-06-11 17:48:42">
  <input type="hidden" name="id" value="1178263">
  <input type="hidden" name="token" value="1635624810-oB8nbP0C0og0UmUEW3-tfoym4iIXM-hcfg81fRL8chs">
<div class="bz_short_desc_container edit_form">
    
    

     <a href="show_bug.cgi?id=1178263"><b>Bug&nbsp;1178263</b></a> <span id="summary_container" class="bz_default_hidden">
      - <span id="short_desc_nonedit_display">wpa_supplicant: add support for non-substring server identity check [rhel-7]</span>
     </span>

    
    

    <div id="summary_input"><span class="field_label "
    id="field_label_short_desc">


  <a 
      title="The bug summary is a short sentence which succinctly describes what the bug is about."
      class="field_help_link"
      href="page.cgi?id=fields.html#short_desc"
  >Summary:</a>

  
  
</span>wpa_supplicant: add support for non-substring server identity check [rhel-7]
    </div>
  </div>
  <script type="text/javascript">
    hideEditableField('summary_container',
                      'summary_input',
                      'summary_edit_action',
                      'short_desc',
                      'wpa_supplicant: add support for non-substring server identity check [rhel-7]' );
  </script>
  <table class="edit_form">
    <tr>
      
      <td id="bz_show_bug_column_1" class="bz_show_bug_column">     
        <table>
          <tr>
      <th class="field_label">
        <a href="describekeywords.cgi">Keywords</a>:
      </th>
      <td>
        <div class="keywords_select">
          <select id="keywords" name="keywords"  disabled="disabled" multiple="multiple">
              <option value="Security"
                      title="Bugs with the &quot;Security&quot; keyword are those that relate to a security vulnerability with a Red Hat product or service. For further information on how to report a security vulnerability to Red Hat please see the &quot;Security Contacts and Procedures&quot; page at http://www.redhat.com/security/team/contact/"
                      selected="selected"
              >Security
              </option>
          </select>
        </div>
      </td>
    </tr>

  <tr>
    <th class="field_label">
      <a href="page.cgi?id=fields.html#bug_status">Status</a>:
    </th>
    <td id="bz_field_status">
      <span id="static_bug_status">CLOSED
          ERRATA
      </span>
    </td>
  </tr>

<tr><th class="field_label "
    id="field_label_alias">


  <a 
      title="A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla."
      class="field_help_link"
      href="page.cgi?id=fields.html#alias"
  >Alias:</a>

  
  
</th>
    <td>
        None
    </td>
  </tr>

<tr>

<th class="field_label "
    id="field_label_product">


  <a 
      title="Bugs are categorised into Products and Components. Select a Classification to narrow down this list."
      class="field_help_link"
      href="describecomponents.cgi"
  >Product:</a>

  
  
</th>
  <td class="field_value "
      id="field_container_product" >Red Hat Enterprise Linux 7

</td>


    </tr>

    
    <tr class="bz_default_hidden"><th class="field_label "
    id="field_label_classification">


  <a 
      title="Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation."
      class="field_help_link"
      href="page.cgi?id=fields.html#classification"
  >Classification:</a>

  
  
</th>
  <td class="field_value "
      id="field_container_classification" >Red Hat

</td>
    </tr>
        
    
    
    <tr><th class="field_label "
    id="field_label_component">


  <a 
      title="Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list."
      class="field_help_link"
      href="describecomponents.cgi?product=Red Hat Enterprise Linux 7"
  >Component:</a>

  
  
</th>
      <td>
        

            <input type="hidden" id="component" name="component" value="wpa_supplicant">wpa_supplicant
        
        
        <span class="show_others">
          <a href="buglist.cgi?component=wpa_supplicant&amp;product=Red%20Hat%20Enterprise%20Linux%207"
            title="Show other bugs for this component"><i class="fas fa-th-list"></i></a>
        
        
          <a href="enter_bug.cgi?component=wpa_supplicant&amp;product=Red%20Hat%20Enterprise%20Linux%207&amp;version=7.1"
            title="Create a new bug for this component"><i class="fas fa-plus-circle"></i></a>
        
        </span>
      </td>
    </tr>
    <tr>
        <th id="bz_rh_sub_component_input_th"
            class="field_label bz_default_hidden">
          <label for="rh_sub_component">
            <a class="field_help_link" href="page.cgi?id=fields.html#rh_sub_components" title="The sub component of a specific component">Sub Component:</a>
          </label>
        </th>
        <td id="bz_rh_sub_component_input_td" class="bz_default_hidden">
          <input type="hidden" name="defined_rh_sub_component" id="defined_rh_sub_component" value="0">
          <select name="rh_sub_component" id="rh_sub_component"  disabled="disabled" onchange="assign_to_default();" >
            <option value="">---</option>
          </select>
          <script>
            $(document).ready(function () {
              init_sub_components();
            });
          </script>
        
          <span class="show_others">
            <a href="buglist.cgi?component=wpa_supplicant&amp;product=Red%20Hat%20Enterprise%20Linux%207" title="Show other bugs for this sub-component"><i class="fas fa-th-list"></i></a>
          
          </span>
        </td>
      </tr>

<script>
  function rh_check_sub_components () {
    var ret = '';
      var sub_comp_obj = document.getElementById('rh_sub_component');
        if ($('#defined_rh_sub_component').val() == 1 && !$("#rh_sub_component").selectize()[0].selectize.getValue()) {
          if (!ret) ret = sub_comp_obj;
          _sub_comps_errorFor(
            sub_comp_obj,
            "You must specify the sub component"
          );
      }

    return ret;
  }

  function _sub_comps_errorFor(field, error_text) {
      var new_node = document.createElement('div');
      YAHOO.util.Dom.addClass(new_node, 'validation_error_text');
      new_node.innerHTML = error_text;
      YAHOO.util.Dom.insertAfter(new_node, field);
      YAHOO.util.Dom.addClass(field, 'validation_error_field');
      new_node.scrollIntoView();
  }
</script>
    <tr><th class="field_label "
    id="field_label_version">


  <a 
      title="The version field defines the version of the software the bug was found in."
      class="field_help_link"
      href="page.cgi?id=fields.html#version"
  >Version:</a>

  
  
</th>
<td>
      <span id="version">7.1
      </span></td>
    </tr>
        
    
        
    <tr><th class="field_label "
    id="field_label_rep_platform">


  <a 
      title="The hardware platform the bug was observed on. Note: When searching, selecting the option &quot;All&quot; only finds bugs whose value for this field is literally the word &quot;All&quot;."
      class="field_help_link"
      href="page.cgi?id=fields.html#rep_platform"
  >Hardware:</a>

  
  
</th>
      <td class="field_value">All
      </td>
    </tr>
    <tr><th class="field_label "
    id="field_label_op_sys">


  <a 
      title="The operating system the bug was observed on. Note: When searching, selecting the option &quot;All&quot; only finds bugs whose value for this field is literally the word &quot;All&quot;."
      class="field_help_link"
      href="page.cgi?id=fields.html#op_sys"
  >OS:</a>

  
  
</th>
      <td class="field_value">
        Linux
      </td>
    </tr>
          
          
          <tr>
      <th class="field_label">
        <label  accesskey="i">
          <a href="page.cgi?id=fields.html#priority">Priority:</a></label>
      </th>
      <td>urgent
      </td>
    </tr>
    <tr>
      <th class="field_label">
        <label ><a href="page.cgi?id=fields.html#bug_severity">Severity:</a>
        </label>
      </th>
      <td>
       urgent
      </td>
    </tr>

      <tr><th class="field_label "
    id="field_label_target_milestone">


  <a 
      title="The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it."
      class="field_help_link"
      href="page.cgi?id=fields.html#target_milestone"
  >Target Milestone:</a>

  
  
</th><td>
      <span id="target_milestone">rc
      </span></td>
      </tr>
      <tr>
        <td class="field_label">
          <label for="target_release">
              <a href="page.cgi?id=fields.html#target_release">
            Target&nbsp;Release</a></label>:
        </td><td>
      <span id="target_release">7.2
      </span></td>
        
        
      </tr>
          
          <tr><th class="field_label "
    id="field_label_assigned_to">


  <a 
      title="The person in charge of resolving the bug."
      class="field_help_link"
      href="page.cgi?id=fields.html#assigned_to"
  >Assignee:</a>

  
  
</th>
      <td><span class="vcard redhat_user"><span class="fn">Dan Winship</span>
</span>
      </td>
    </tr>

    <tr><th class="field_label "
    id="field_label_qa_contact">


  <a 
      title="The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#qa_contact"
  >QA Contact:</a>

  
  
</th>
      <td><span class="vcard redhat_user"><span class="fn">Ken Benoit</span>
</span>
      </td>
    </tr>
    
    <tr><th class="field_label "
    id="field_label_docs_contact">

    <label for="docs_contact" accesskey="q">

  <a 
      title="The person responsible for documenting once the bug has been resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#docs_contact"
  >Docs Contact:</a>
</label>
  
  
</th>
      <td><span class="vcard ">
</span>
      </td>
    </tr>
    
    <script type="text/javascript">
      assignToDefaultOnChange(['product', 'component'],
        'sukulkar\x40redhat.com',
        'kernel-qe-hw\x40redhat.com',
        '');
    </script>
          
          
          <tr><th class="field_label "
    id="field_label_bug_file_loc">


  <a 
      title="Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen."
      class="field_help_link"
      href="page.cgi?id=fields.html#bug_file_loc"
  >URL:</a>

  
  
</th>
    <td>
      <span id="bz_url_input_area">
      </span>
    </td>
  </tr>

    <tr><th class="field_label "
    id="field_label_status_whiteboard">


  <a 
      title="Each bug has a free-form single line text entry box for adding tags and status information."
      class="field_help_link"
      href="page.cgi?id=fields.html#status_whiteboard"
  >Whiteboard:</a>

  
  
</th><td>  
  </td>
    </tr>
          

          
<tr><th class="field_label "
    id="field_label_dependson">


  <a 
      title="The bugs listed here must be resolved before this bug can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#dependson"
  >Depends On:</a>

  
  
</th>

  <td>
    <span id="dependson_input_area">
    </span>

  </td>
  </tr>
  
  <tr><th class="field_label "
    id="field_label_blocked">


  <a 
      title="This bug must be resolved before the bugs listed in this field can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#blocked"
  >Blocks:</a>

  
  
</th>

  <td>
    <span id="blocked_input_area">
    </span>
<a class="bz_bug_link
          
          bz_status_CLOSED  bz_closed
                              
    "
   title="CLOSED NOTABUG - CVE-2015-0210 wpa_supplicant: broken certificate subject check"
   href="show_bug.cgi?id=1178921">CVE-2015-0210</a> 
  </td>
  </tr>

          <tr>
    <th class="field_label">TreeView+</th>
    <td>
        <a href="buglist.cgi?bug_id=1178263&amp;bug_id_type=anddependson&amp;format=tvp">
        depends on</a> /
        <a href="buglist.cgi?bug_id=1178263&amp;bug_id_type=andblocked&amp;format=tvp&amp;tvp_dir=blocked">
        blocked</a>
    </td>
    <td></td>
</tr>
          
          
        </table>
      </td>
      <td>
        <div class="bz_column_spacer">&nbsp;</div>
      </td>
      
      <td id="bz_show_bug_column_2" class="bz_show_bug_column">
        <table>
        <tr>
    <th class="field_label">
      <a href="page.cgi?id=fields.html#reporter">Reported:</a>
    </th>
    <td>2015-01-03 12:38 UTC by <span class="vcard "><span class="fn">Wilco Baan Hofman</span>
</span>
    </td>
  </tr>
  
  <tr>
    <th class="field_label">
      <a href="page.cgi?id=fields.html#modified">Modified:</a>
    </th>
    <td>2015-06-11 17:48 UTC
      (<a href="show_activity.cgi?id=1178263">History</a>)
    </td>
  
  </tr>
<tr>
      <th class="field_label">
        <label  accesskey="a">
          <a href="page.cgi?id=fields.html#cclist">CC List:</a>
        </label>
      </th>
      <td>11 
          users
          <span id="cc_edit_area_showhide_container" class="bz_default_hidden">
            (<a href="#" id="cc_edit_area_showhide">show</a>)
          </span>
        <div id="cc_edit_area">
          <br>
            <select id="cc" multiple="multiple" size="5" >
                <option value="danw">danw</option>
                <option value="dcbw">dcbw</option>
                <option value="emcnabb">emcnabb</option>
                <option value="jklimes">jklimes</option>
                <option value="j">j</option>
                <option value="lrintel">lrintel</option>
                <option value="rkhan">rkhan</option>
                <option value="security-response-team">security-response-team</option>
                <option value="thaller">thaller</option>
                <option value="thijs">thijs</option>
                <option value="vkaigoro">vkaigoro</option>
            </select>
        </div>
          <script type="text/javascript">
            hideEditableField( 'cc_edit_area_showhide_container', 
                               'cc_edit_area', 
                               'cc_edit_area_showhide', 
                               '', 
                               '');  
          </script>
      </td>
    </tr>


 
<tr>
      <th class="field_label "
    id="field_label_cf_fixed_in">


  <a 
      title="The full package version. PGM uses to check if brew ..."
  >Fixed In Version:</a>

  
  
</th>
  <td class="field_value "
      id="field_container_cf_fixed_in"  colspan="2">wpa_supplicant-2.0-16.el7_1

</td>
    </tr>
    
    

    <tr>
      <th class="field_label "
    id="field_label_cf_doc_type">


  <a 
      title="Click the information icon to the right to see the description"
  >Doc Type:</a>

  
  <i class="fas fa-info-circle pop-text" onclick="alertify.alert('Doc Type', BB_FIELDS['cf_doc_type'].long_desc)" title="Click to see full description"></i>

  
</th>
  <td class="field_value "
      id="field_container_cf_doc_type"  colspan="2">Bug Fix

<span id="cf_doc_warn"></span></td>
    </tr>
    
    

    <tr>
      <th class="field_label "
    id="field_label_cf_release_notes">


  <a 
      title="Click the information icon to the right to see the description"
  >Doc Text:</a>

  
  <i class="fas fa-info-circle pop-text" onclick="alertify.alert('Doc Text', BB_FIELDS['cf_release_notes'].long_desc)" title="Click to see full description"></i>

  
</th>
  <td class="field_value "
      id="field_container_cf_release_notes"  colspan="2">
      <div class="uneditable_textarea"></div>

</td>
    </tr>
    
    

    
    

    <tr>
      <th class="field_label "
    id="field_label_cf_clone_of">


  <a 
      title="The bug listed here was the bug cloned to create thi..."
  >Clone Of:</a>

  
  
</th>
  <td class="field_value "
      id="field_container_cf_clone_of"  colspan="2">

</td>
  </tr>
  <tr>
    <th class="field_label">
      <label for="clones">Clones</label>:
    </th>
    <td class="field_value" colspan="2">
      <span id="clones"><a class="bz_bug_link
          bz_secure
    "
   title=""
   href="show_bug.cgi?id=1186806">1186806</a> <a class="bz_bug_link
          bz_secure
    "
   title=""
   href="show_bug.cgi?id=1215892">1215892</a> 
      </span>
      (<a href="buglist.cgi?bug_id=1215892,1186806">view as bug list</a>)</td>
    </tr>
    
    

    <tr>
      <th class="field_label "
    id="field_label_cf_environment">


  <a 
      title="This field is used for unformatted text that helps t..."
  >Environment:</a>

  
  
</th>
  <td class="field_value "
      id="field_container_cf_environment"  colspan="2">
      <div class="uneditable_textarea"></div>

</td>
    </tr>
    
    

    <tr>
      <th class="field_label "
    id="field_label_cf_last_closed">


  <a 
      title="When this bug was last marked as closed. Used for st..."
  >Last Closed:</a>

  
  
</th>
  <td class="field_value "
      id="field_container_cf_last_closed"  colspan="2">2015-06-11 17:48:42 UTC
    

</td>
    </tr>
    
    

    
    

    
    

    
    

    
    

    
    

    
    

    
    

    
    

    
    

    
    

    <tr>
      <th class="field_label "
    id="field_label_cf_target_upstream_version">


  <a 
      title="Click the information icon to the right to see the description"
  >Target Upstream Version:</a>

  
  <i class="fas fa-info-circle pop-text" onclick="alertify.alert('Target Upstream Version', BB_FIELDS['cf_target_upstream_version'].long_desc)" title="Click to see full description"></i>

  
</th>
  <td class="field_value "
      id="field_container_cf_target_upstream_version"  colspan="2">

</td>
    </tr>




        </table>
      </td>
    </tr>
    <tr>
      <td colspan="3">
          <hr id="bz_top_half_spacer">
      </td>
    </tr>
  </table>

  <table id="bz_big_form_parts">
  <tr>
  <td>

    
<script type="text/javascript">
<!--
function toggle_display(link) {
    var table = document.getElementById("attachment_table");
    var view_all = document.getElementById("view_all");
    var hide_obsolete_url_parameter = "&hide_obsolete=1";
    // Store current height for scrolling later
    var originalHeight = table.offsetHeight;
    var rows = YAHOO.util.Dom.getElementsByClassName(
        'bz_tr_obsolete', 'tr', table);

    for (var i = 0; i < rows.length; i++) {
        bz_toggleClass(rows[i], 'bz_default_hidden');
    }

    if (YAHOO.util.Dom.hasClass(rows[0], 'bz_default_hidden')) {
        link.innerHTML = "Show Obsolete";
        view_all.href = view_all.href + hide_obsolete_url_parameter 
    }
    else {
        link.innerHTML = "Hide Obsolete";
        view_all.href = view_all.href.replace(hide_obsolete_url_parameter,"");
    }

    var newHeight = table.offsetHeight;
    // This scrolling makes the window appear to not move at all.
    window.scrollBy(0, newHeight - originalHeight);

    return false;
}
//-->
</script>

<br>
<table id="attachment_table">
  <tr id="a0">
    
    <th align="left">
      Attachments
    </th>
    <th colspan="2" align="right">
      <a href="page.cgi?id=terms-conditions.html">(Terms of Use)</a>
    </th>
    
  </tr>


      <tr id="a1" class="bz_contenttype_text_plain bz_patch">
        <td>
            <a href="attachment.cgi?id=983551"
               title="View the content of the attachment">
          <b>patch to dist-git with the backported fix</b></a>

          <span class="bz_attach_extra_info">
              (22.00 KB,
                patch)

            <br>
            <a href="#attach_983551"
               title="Go to the comment associated with the attachment">2015-01-23 20:53 UTC</a>,

            <span class="vcard redhat_user"><span class="fn">Dan Winship</span>
</span>
          </span>
        </td>

          <td class="bz_attach_flags">
              <i>no flags</i>
          </td>

        <td>
          <a href="attachment.cgi?id=983551&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=983551&amp;action=diff">Diff</a>
        </td>
      </tr>

  <tr class="bz_attach_footer">
    <td colspan="3">
        <span class="bz_attach_view_hide">
            <a id="view_all" href="attachment.cgi?bugid=1178263&amp;action=viewall">View All</a>
        </span>
        <a href="attachment.cgi?bugid=1178263&amp;action=enter">Add an attachment</a>
        (proposed patch, testcase, etc.)
    </td>
  </tr>
</table>
<br>

    

    <script>
  YAHOO.ExternalBugs.sUrlYUI = 'https://bugzilla.redhat.com/jsonrpc.cgi';
  YAHOO.ExternalBugs.sUrlRPC = 'https://bugzilla.redhat.com/xmlrpc.cgi';
  YAHOO.ExternalBugs.extRefreshList = [];
function _extbz_errorFor(field, error_text) {
    var new_node = document.createElement('div');
    YAHOO.util.Dom.addClass(new_node, 'validation_error_text');
    new_node.innerHTML = error_text;
    YAHOO.util.Dom.insertAfter(new_node, field);
    YAHOO.util.Dom.addClass(field, 'validation_error_field');
    return new_node;
}

function check_external_bugs (f) {
    var focus_me;
    var external_bugs = YAHOO.util.Dom.getElementsByClassName(
        'external_bug_id', null, f);
    for (var i = 0; i < external_bugs.length; i++) {
        var bug_id_key   = external_bugs[i].name;
        var bug_type_key = 'external_' + bug_id_key.substr(13);
        if($('#' + bug_id_key).length > 0) {
            var bug_id       = document.getElementById(bug_id_key).value;
            var bug_type     = document.getElementById(bug_type_key).value;
            if ((bug_type == '' || bug_type == '0') && bug_id != '') {
                focus_me = _extbz_errorFor(
                    document.getElementById(bug_type_key),
                    'You specified the external tracker id, but not the type'
                );
            }
            else if (bug_type != '' && bug_type != '0' && bug_id == '') {
                focus_me = _extbz_errorFor(
                    external_bugs[i],
                    'You specified the external tracker type, but not the id'
                );
            }
            else if (bug_type != '' && bug_id != '') {
            }
        }
    }

    return focus_me;
}

var bz_no_validate_enter_bug = false;
function validateChangeBug(changeform) {
    // This is for the "bookmarkable templates" button.
    if (bz_no_validate_enter_bug) {
        // Set it back to false for people who hit the "back" button
        bz_no_validate_enter_bug = false;
        return true;
    }

    var current_errors = YAHOO.util.Dom.getElementsByClassName(
        'validation_error_text', null, changeform);
    for (var i = 0; i < current_errors.length; i++) {
        current_errors[i].parentNode.removeChild(current_errors[i]);
    }
    var current_error_fields = YAHOO.util.Dom.getElementsByClassName(
        'validation_error_field', null, changeform);
    for (var i = 0; i < current_error_fields.length; i++) {
        var field = current_error_fields[i];
        YAHOO.util.Dom.removeClass(field, 'validation_error_field');
    }

    var focus_me;

    // REDHAT EXTENSION 1000743
    focus_me = check_external_bugs(changeform);

    if (focus_me) {
        focus_me.scrollIntoView(false);
        return false;
    }

    return true;
}

changeform.onsubmit = function() { return validateChangeBug(changeform)};
</script>

<br>
<table id="external_bugs_table" cellspacing="0" cellpadding="4">
  <caption name="et0" id="et0">Links</caption>
    <tr>
      <th>System</th>
      <th>ID</th>
      <th>Private</th>
      <th>Priority</th>
      <th>Status</th>
      <th>Summary</th>
      <th>Last Updated</th>
    </tr>

    
    <tr id="ext_row_780128" >
      <td>Red Hat Product Errata
      </td>
      <td>
        <a href="https://access.redhat.com/errata/RHSA-2015:1090">RHSA-2015:1090</a>
      </td>
      <td>
        <span id="ext_is_private_780128">0
        </span>
      </td>
      <td>
        <span id="ext_priority_780128">normal
        </span>
      </td>
      <td>
        <span id="ext_status_780128">SHIPPED_LIVE
        </span>
      </td>
      <td>
        <span id="ext_description_780128"
              title="Important: wpa_supplicant security and enhancement update">Important: wpa_supplicant security and enhancement update
        </span>
      </td>
      <td>
        <span id="ext_last_updated_780128">2015-06-11 21:47:52 UTC
        </span>
      </td>
    </tr>

</table>

<br>
    

  </td>

  <td class="groups">
  </td>
  </tr></table>

  
  <div id="comments"><script type="text/javascript">
<!--
  /* Adds the reply text to the 'comment' textarea */
  function replyToComment(id, real_id, name) {
      var prefix = "(In reply to " + name + " from comment #" + id + ")\n";
      var replytext = "";
        /* pre id="comment_name_N" */
        var text_elem = document.getElementById('comment_text_'+id);
        var text = getText(text_elem);
        replytext = prefix + wrapReplyText(text);


      /* <textarea id="comment"> */
      var textarea = document.getElementById('comment');
      if (textarea.value != replytext) {
          textarea.value += replytext;
      }

      textarea.focus();
  } 
//-->
</script>






<!-- This auto-sizes the comments and positions the collapse/expand links 
     to the right. -->
<table class="bz_comment_table">
<tr>
<td>
<div id="c0" class="bz_comment bz_first_comment
            "
    >

      <div class="bz_first_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1178263#c0">Description</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard "><span class="fn">Wilco Baan Hofman</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-01-03 12:38:32 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">Description of problem:
wpa_supplicant, linked against openssl performs this check:

    if (depth == 0 &amp;&amp; match &amp;&amp; os_strstr(buf, match) == NULL) {
        wpa_printf(MSG_WARNING, &quot;TLS: Subject '%s' did not &quot;
               &quot;match with '%s'&quot;, buf, match);
        preverify_ok = 0;
        openssl_tls_fail_event(conn, err_cert, err, depth, buf,
                       &quot;Subject mismatch&quot;,
                       TLS_FAIL_SUBJECT_MISMATCH);
    }

strstr() is vulnerable to extension attack, for instance, one would like to
match on /CN=wireless.nikhef.nl, but explicitly not match on
wireless.nikhef.nl.honestachmed.tr. There is no way to implement a secure
EAP-TTLS/PEAP configuration using public certificates this way.

When linked against GnuTLS, the problem is even worse:

      if (i == 0) {
            /* TODO: validate subject_match and altsubject_match */
        }

Now, it is current best practice to run EAP-TTLS/PEAP with public certificates,
because on Windows, this automatically pins the CN and CA from the certificate.

On OS X and IOS, the certificate is always pinned, but can't be replaced without
generating warnings for the user.

With wpa_supplicant, any such configuration is insecure. With SSL, always check
the subject of the certificate, expiry date and signature.

Please coordinate with other linux distributions so that this issue gets a CVE.

-- Wilco Baan Hofman

</pre>
    </div>

    <div id="c2" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1178263#c2">Comment 2</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard "><span class="fn">Vasyl Kaigorodov</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-01-05 16:34:53 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">Hello Wilco,

Thanks for reporting this to Red Hat.
We assigned <a href="https://access.redhat.com/security/cve/CVE-2015-0210">CVE-2015-0210</a> to this issue.
This report will assessed by Red Hat Product Security team, you might watch the flaw bug for the progress: <a class="bz_bug_link
          
          bz_status_CLOSED  bz_closed
                              
    "
   title="CLOSED NOTABUG - CVE-2015-0210 wpa_supplicant: broken certificate subject check"
   href="show_bug.cgi?id=1178921">https://bugzilla.redhat.com/show_bug.cgi?id=1178921</a> .

Please let us know when did you plan to make this issue public, and if you contacted other vendors/distributions about this already?

</pre>
    </div>

    <div id="c3" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1178263#c3">Comment 3</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard redhat_user"><span class="fn">Tomas Hoger</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-01-05 19:31:10 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">(In reply to Vasyl Kaigorodov from <a href="show_bug.cgi?id=1178263#c2">comment #2</a>)
<span class="quote">&gt; Please let us know when did you plan to make this issue public, and if you
&gt; contacted other vendors/distributions about this already?</span >

This issue should be considered public, see e.g.:

<a href="https://bugzilla.gnome.org/show_bug.cgi?id=341323#c19">https://bugzilla.gnome.org/show_bug.cgi?id=341323#c19</a>

However, it does not seem wpa_supplicant upstream bugzilla instance is still accessible to see what was included in the upstream report and what the upstream response was.

</pre>
    </div>

    <div id="c4" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1178263#c4">Comment 4</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard "><span class="fn">Wilco Baan Hofman</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-01-05 21:34:50 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">Well, the issue is mostly known by attackers already and exploited in the wild.. it needs to be fixed soon though.

I do plan on presenting this issue to a wider audience in April/May.

A couple of things need to be fixed:
1. subject_match needs to be replaced with either an exact CN match or an exact subject match, matching on a substring of a host name is not very useful.
2. 

-- Wilco

</pre>
    </div>

    <div id="c5" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1178263#c5">Comment 5</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard "><span class="fn">Wilco Baan Hofman</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-01-05 21:39:51 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">Cont'd:

2. the GNOME interface needs to expose this field, because right now the user can only choose a secure set up by going into configuration files and setting subject_match (assuming 1 is fixed)

3. It would be best if at first connect, the CA + CN of the certificate are pinned if the CA is in the trust store and the user does not configure anything. This way the user has a secure configuration without even knowing the details.


... But I'd settle for 1 and 2 fixed, because this is exploited in the wild on eduroam, spacenet and any WPA2 enterprise setup that has RHEL connecting to it is vulnerable.

-- Wilco

</pre>
    </div>

    <div id="c6" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1178263#c6">Comment 6</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard "><span class="fn">Thijs Kinkhorst</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-01-06 08:34:10 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">In any case 1 should be fixed in the short term so people doing 'the right thing' are at least protected.

Wouldn't a CVE-2013-XXXX need to be assigned rather than a CVE-2015-XXXX?

Are you already in contact with upstream? It seems their bug reporting venue is a public mailing list, so perhaps contact the author directly. Although the issue was indeed already publically reported in 2013, it may be fair to give him a heads-up before we publicize it explicitly.

</pre>
    </div>

    <div id="c7" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1178263#c7">Comment 7</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard redhat_user"><span class="fn">Dan Winship</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-01-06 21:12:07 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">(In reply to Thijs Kinkhorst from <a href="show_bug.cgi?id=1178263#c6">comment #6</a>)
<span class="quote">&gt; Are you already in contact with upstream? It seems their bug reporting venue
&gt; is a public mailing list, so perhaps contact the author directly. Although
&gt; the issue was indeed already publically reported in 2013, it may be fair to
&gt; give him a heads-up before we publicize it explicitly.</span >

And so we can fix it in the same way that upstream does (full subject match, full CN match, suffix match rather than substring match, etc).

</pre>
    </div>

    <div id="c8" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1178263#c8">Comment 8</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard "><span class="fn">Wilco Baan Hofman</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-01-07 09:24:57 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">I will contact Jouni Malinen and cc this bug.

</pre>
    </div>

    <div id="c9" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1178263#c9">Comment 9</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard "><span class="fn">Wilco Baan Hofman</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-01-07 09:33:26 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">I added Jouni to the cc of this bug and sent him this:

--- 

Hi Jouni,

Debian and Red Hat have assigned <a href="https://access.redhat.com/security/cve/CVE-2015-0210">CVE-2015-0210</a> to wpa_supplicant for a broken subject_match check. I have added you to the bug cc list, so that you can view it.

This is the content of the bug report:

wpa_supplicant, linked against openssl performs this check:

    if (depth == 0 &amp;&amp; match &amp;&amp; os_strstr(buf, match) == NULL) {
        wpa_printf(MSG_WARNING, &quot;TLS: Subject '%s' did not &quot;
               &quot;match with '%s'&quot;, buf, match);
        preverify_ok = 0;
        openssl_tls_fail_event(conn, err_cert, err, depth, buf,
                       &quot;Subject mismatch&quot;,
                       TLS_FAIL_SUBJECT_MISMATCH);
    }

strstr() is vulnerable to extension attack, for instance, one would like to
match on /CN=wireless.nikhef.nl, but explicitly not match on
wireless.nikhef.nl.honestachmed.tr. There is no way to implement a secure
EAP-TTLS/PEAP configuration using public certificates this way.

When linked against GnuTLS, the problem is even worse:

      if (i == 0) {
            /* TODO: validate subject_match and altsubject_match */
        }

Now, it is current best practice to run EAP-TTLS/PEAP with public certificates,
because on Windows, this automatically pins the CN and CA from the certificate.

On OS X and IOS, the certificate is always pinned, but can't be replaced without
generating warnings for the user.

With wpa_supplicant, any such configuration is insecure. With SSL, always check
the subject of the certificate, expiry date and signature.


I advise the following actions:
1. Change subject_match to an exact CN match (full hostname on the certificate)
2. Automatically PIN the CA and CN if the CA is in the trust store, so that users have a safe default if a trusted CA is used. For self-signed certificates, pin the fingerprint.
For CA-signed certificates, do not PIN the fingerprint, so not to bother the user with a security message if the certificate gets replaced by a fresh valid one.
3. Add an API for interaction with Network Manager for the user interaction of trust messages.


-- Wilco

</pre>
    </div>

    <div id="c10" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1178263#c10">Comment 10</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard "><span class="fn">Jouni Malinen</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-01-07 14:03:11 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">It looks like subject_match is being used for something it was never designed for. It is documented to be a &quot;substring match aganst the subject&quot; in the format that OpenSSL X509_NAME_oneline() returns (/C=US/ST=CA/L=San Francisco/CN=Test AS/<a href="mailto:emailAddress=as&#64;example.com">emailAddress=as&#64;example.com</a>) which itself is a legacy, human readable format that is not really useful for the purpose that case seems to be describing.

If you want to do a suffix match on a domain, domain_suffix_match should be used instead if the certificates includes dNSName elemetn in the SubjectAltName. If you really want to do such matching against the CN (which CN? there can be multiple) in the subject name, that would require new functionality to be added.

However, the use case you seem to describe here does not sound like something that should be using any kind of (alt)subject name matching in the first place. If you want to require a specific server certificate to be used, you should use ca_cert=&quot;hash://server/sha256/&lt;cert hash&gt;&quot; configuration.

</pre>
    </div>

    <div id="c11" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1178263#c11">Comment 11</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard "><span class="fn">Jouni Malinen</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-01-07 14:07:48 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">Regarding use of GnuTLS: subject_match is against that legacy OpenSSL human readable format and it does not make much sense to extend that for anything new. tls_gnutls.c could be modified to reject any configuration with such match strings included to make it less likely to result in unexpected behavior.

I would also point out that there is a reason for making OpenSSL the default option for wpa_supplicant builds. GnuTLS interface has received significantly less testing and may lack significant functionality. If any distro is using that with wpa_supplicant, I would recommend them to consider moving to OpenSSL or being prepared to go through significant testing effort. There has been very limited interest in the GnuTLS interface over the years from the upstream wpa_supplicant project view point and as such, not much justification for using effort to work on it.

</pre>
    </div>

    <div id="c12" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1178263#c12">Comment 12</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard "><span class="fn">Wilco Baan Hofman</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-01-07 15:33:43 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">Hi Jouni,

Matching against a hostname and subjectAltNames would work, though this should still be pinned.

Certificate pinning on the fingerprint is a huge burden when replacing certificates (Imagine replacing configuration files for all your users on the same day, without network connectivity), what should be used is a subjectAltName/CN + CA.

This is what many people are currently using subject_match for, but an exact match to a hostname/CN would be better. I recommend dropping support for subject_match, since it gives the feeling of security, while in fact it adds very little. 

Pinning should mostly always be done on CN + CA, so that the certificate can be replaced when it expires. Certificate hash pinning should only be done for self-signed certificates.

-- Wilco

</pre>
    </div>

    <div id="c13" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1178263#c13">Comment 13</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard redhat_user"><span class="fn">Dan Williams</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-01-07 15:39:01 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">Note that in Fedora/RHEL we link wpa_supplicant against OpenSSL only.

</pre>
    </div>

    <div id="c14" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1178263#c14">Comment 14</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard "><span class="fn">Jouni Malinen</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-01-07 15:49:32 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">I'm not sure I've understood what exactly you mean with &quot;pinning&quot; in this context if that is different from specifying a specific server certificate. It sounds like you do not want to select a single certificate (i.e., want to allow the server certificate to be renewed). Could you describe what certificate field(s) you think should be matched against? Please note that a certificate may have zero, one, or multiple CNs in the subject name. If you are saying &quot;CN&quot;, that is unclear since the exact rules would need to be specified for the case of no CN (that sounds clear, reject) and multiple CNs (is it enough for any of them to match?).

In general, I'd recommend using domain_suffix_match (i.e., matching against SubjectAltName dNSName element(s)). If there is a reason to do something else, those exact rules for desired matching needs to be clearly specified first.

Another way of pinning a certificate could use issues + serial number (assuming same serial number is used when renewing, but that is likely not guaranteed).

I agree that subject_match should not be further extended taken into account its unreliability for tasks it can potentially be used. I'm not sure I would remove it, though, since that could break existing configurations and prevent wpa_supplicant from even starting. In other words, the configuration field itself will need to be parsed. Whether a network with that field with a non-empty value should be disabled is another question and I'm not sure I would go even that far. Anyway, any new rule will use a different field and what to do with existing subject_match, altsubject_math, subject_match2, and altsubject_match2 is a completely independent item.

</pre>
    </div>

    <div id="c15" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1178263#c15">Comment 15</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard "><span class="fn">Wilco Baan Hofman</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-01-07 16:41:25 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">With pinning in this context I mean that wpa_supplicant should remember these settings at first connect to provide a usable default.

But if domain_suffix_match should be used in this case, almost everybody is using wpa_supplicant incorrectly (See for instance the Android Java wpa_supplicant bindings: <a href="https://developer.android.com/reference/android/net/wifi/WifiEnterpriseConfig.html">https://developer.android.com/reference/android/net/wifi/WifiEnterpriseConfig.html</a>). 

Typically, with any TLS session one should verify: 
1. Does the certificate belong to the person I want to connect to (Usually CN + SubjectAltName dNSNames)
2. Is the certificate still valid?
3. Does it have a valid trusted signature (CA-signed)

For RADIUS it is not much different, except the dNSName can't be automatically verified, so this should be explicitly configured or pinned to the profile.


Breaking existing configurations if they are insecure would be acceptable (in my view). It may break, but it should break loudly and tell the user what to do.

-- Wilco

</pre>
    </div>

    <div id="c16" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1178263#c16">Comment 16</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard "><span class="fn">Jouni Malinen</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-01-08 18:27:18 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">I'm not sure I'd agree with wpa_supplicant being the component deciding when and how to remember some criteria from a server certificate used for the first connection for a network porfile. Especially for cases when used with NetworkManager, the network profile is stored externally anyway. Sure, wpa_supplicant should provide means for the upper layer component to get enough information from the server certificate and configuration parameters in the network profile to allow those to be matches against.

Use of subject name CN for this type of purposes has been deprecated long ago even for HTTPS. As such, I'd much rather use dNSName. Anyway, I can add a new network profile configuration parameter to allow matching against any CN in the subject name (i.e., if any CN matches, the certificate is considered acceptable from this subject name filtering view point). However, even for that, there would need to be clear rules defined. Would this be suffix match? And case insensitive? Or full match as a binary comparison? Or something else?

I'd assume there could be RADIUS server setups where multiple servers are used for load balancing or high availability purposes. Those servers should be allowed to have their own, unique certificates (e.g., with CNs server1.example.com and server2.example.com). Something would need to be able to determine whether to limit future connection only to the exact same CN or to a suffix match like example.com in this specific case.

Android does not provide UI component to set any kind of matching for the server certificate (well, other than trust root). That setSubjectMatch() is documented as &quot;substring&quot; and as such, not really suitable for the purpose discussed in this bugzilla case.

</pre>
    </div>

    <div id="c17" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1178263#c17">Comment 17</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard "><span class="fn">Wilco Baan Hofman</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-01-08 19:44:10 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">As with DNS, this would have to be an full string match to provide proper security benefit. DNS is not case sensitive and I don't think this check has to be either.

This is what it looks like for Microsoft: <a href="http://www.mcmaster.ca/uts/connections/network/macconnect/wireless/images/vista_wpa6.png">http://www.mcmaster.ca/uts/connections/network/macconnect/wireless/images/vista_wpa6.png</a>.

<a href="http://support.microsoft.com/kb/814394">http://support.microsoft.com/kb/814394</a>
&quot;The name in the Subject line of the server certificate matches the name that is configured on the client for the connection.&quot;

This is, in my view, correct behaviour, albeit deprecated. dNSName can also be used, but can only be automatically pinned if there is only one dNSName on the certificate, and from the CAs that I know of, this still matches the CN in the subject.

If a user manually configures a server host name to connect to, multiple dNSNames on the certificate can be used. 


However, to resolve this bug, the pinning behaviour can be done either in Network Manager or wpa_supplicant.. but the subject_match functionality has to be deprecated by wpa_supplicant and at least dNSName matching has to be fixed.

If the pinning behaviour is to be done in Network Manager, wpa_supplicant needs to have an API that allows Network Manager to get the necessary information.

This is implemented in KDE plasma network-manager like this: (<a href="http://i.imgur.com/hNC50.png">http://i.imgur.com/hNC50.png</a>)
         &lt;item&gt;
          &lt;widget class=&quot;KLineEdit&quot; name=&quot;subjectMatch&quot;&gt;
           &lt;property name=&quot;whatsThis&quot;&gt;
            &lt;string&gt;Connect only to servers whose certificate matches the given subject. Example: /CN=myvpn.company.com&lt;/string&gt;
           &lt;/property&gt;
          &lt;/widget&gt;
         &lt;/item&gt;

In android: 
<a href="https://developer.android.com/reference/android/net/wifi/WifiEnterpriseConfig.html">https://developer.android.com/reference/android/net/wifi/WifiEnterpriseConfig.html</a>
Indeed not in the UI, but used in WifiEnterprise configuration applications, such as the large vendor provisioning tools, as the Android UI does not allow *ANY* kind of secure connection to WPA2 enterprise networks.


Android, KDE NM and others (even including me with an Android application) implemented subject_match with the specific intent of connecting to only your organisations SPECIFIC own radius server, not ANY radius server that has a valid certificate.

</pre>
    </div>

    <div id="c18" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1178263#c18">Comment 18</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard "><span class="fn">Jouni Malinen</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-01-10 22:24:50 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">In general, I'd prefer to use suffix match and that is exactly what the existing domain_suffix_match does. It does actually cover CN as well in case dNSName is not present. This was documented in the header files and deverlopers' documentation, but wpa_supplicant.conf notes did not include the details. I'm adding these there:

# domain_suffix_match: Constraint for server domain name. If set, this FQDN is
#	used as a suffix match requirement for the AAAserver certificate in
#	SubjectAltName dNSName element(s). If a matching dNSName is found, this
#	constraint is met. If no dNSName values are present, this constraint is
#	matched against SubjectName CN using same suffix match comparison.
#
#	Suffix match here means that the host/domain name is compared one label
#	at a time starting from the top-level domain and all the labels in
#	domain_suffix_match shall be included in the certificate. The
#	certificate may include additional sub-level labels in addition to the
#	required labels.
#
#	For example, domain_suffix_match=example.com would match
#	test.example.com but would not match test-example.com.


I'm not sure what you are referring to with &quot;dNSName matching has to be fixed&quot;. altsubject_match is a full match against the specified string, e.g., altsubject_match=&quot;DNS:example.com&quot; will require the server certificate to have at least one dNSName with &quot;example.com&quot; as the value. This won't match with &quot;test-example.com&quot; or even &quot;test.example.com&quot;. domain_suffix_match is a suffix match that requires full label to match, i.e., domain_suffix_match=&quot;test.example.com&quot; will match test.example.com, server1.test.example.com, but won't match example.com or foo-test.example.com.

I do not know how exactly KDE plansma network-manager works in this area (the version of NM and/or that I happen to have on this system does not have the &quot;Connect to these Servers&quot; item). Anyway, if that subjectMatch entry in the dialog is mapped into subject_match in wpa_supplicant network profile, that should be replaced with mapping to domain_suffix_match. IMHO, that is sufficient and better way of matching the RADIUS server as a suffix match (with full label match required). If there is a reasonable use case for which such suffix match is not sufficient, I can add a separate parameter for a full domain name match, but I'd rather not add extra complexity here unless there is a real need for it.

</pre>
    </div>

    <div id="c19" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1178263#c19">Comment 19</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard "><span class="fn">Wilco Baan Hofman</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-01-12 07:49:00 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">altsubject_match seems to have correct behaviour, but in many cases suffix match won't do.

For example, we have a certificate wireless.nikhef.nl for all wireless authentication, on all RADIUS servers. This is what clients need to verify against. This certificate is replaced annually. We also have some devices, aruba.wireless,nikhef,nl and airwave.wireless.nikhef.nl. Matching against the latter two would be incorrect behaviour.

I do agree that in terms of code, both options have valid use cases, though I  would advise network manager, android, etc to use altsubject_match over a suffix match.

This only leaves
1. Deprecating subject_match (I vote we do remove this, to avoid misleading people)
2. API that allows pinning behaviour in Network Manager, Firefox OS and Android. Thus, making dNSNames, CA and certificate hash available. Maybe the whole certificate chain, if wpa_supplicant does not know about the trust store, though this is less friendly to program against
3. GUI changes for plasma-nm and network-manager-gnome, though this is not for wpa_supplicant.

</pre>
    </div>

    <div id="c20" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1178263#c20">Comment 20</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard redhat_user"><span class="fn">Dan Williams</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-01-13 20:20:48 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">So a summary of the existing conversation is that:

1) there is no code bug in wpa_supplicant

2) there was a mis-understanding of how the various certificate verification options were used

3) wpa_supplicant documentation for domain_suffix_match was inadequate, but has been corrected upstream

4) subject_match should generally not be used except in legacy configurations

5) GUIs should allow setting altsubject_match to specify exact (eg, non-substring) matches on dNSNames, but use domain_suffix_match for substring matches on dNSNames *or* CN names

Is this a reasonable/correct summary of this bug so far?

</pre>
    </div>

    <div id="c21" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1178263#c21">Comment 21</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard "><span class="fn">Wilco Baan Hofman</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-01-13 20:29:38 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">I would say, yes, that is accurate, though I don't think subject_match should ever be used, even in legacy configurations. I cannot think of a valid use case where matching a substring in the subject would do any good, security-wise.

This misunderstanding has also spread to android, firefox OS, some GUI components and a quite significant user base. Deprecating subject_match would be advised.

</pre>
    </div>

    <div id="c22" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1178263#c22">Comment 22</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard "><span class="fn">Jouni Malinen</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-01-13 23:09:02 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">Is altsubject_match=&quot;DNS:&lt;FQDN&gt;&quot; (i.e., matching only against dNSName) sufficient or are there still cases where fallback to CN is needed?

I added support for domain_suffix_match with GnuTLS, but at least for now, by using the GnuTLS implementation in gnutls_x509_crt_check_hostname() which behaves a bit differently (not suffix-only, but wildcards allowed in the certificate). It is a bit unfortunate that the behavior is not identical with the comparison used with OpenSSL, but at least this should be pretty close. Anyway, that did get me thinking more about adding another parameter that would disable wildcards in GnuTLS matching and would require full match with OpenSSL, i.e., would hopefully have more or less identical behavior regardless of which of these TLS libraries is used.

</pre>
    </div>

    <div id="c23" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1178263#c23">Comment 23</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard "><span class="fn">Wilco Baan Hofman</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-01-14 07:22:46 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">Nice! Good to hear the other SSL libraries are also getting similar behaviour. :-)

Personally, I don't think it is absolutely necessary to have a CN fallback in most cases.. but according to Stefan Winter of the .lu NREN, which operates the luxembourg eduroam, there are some institutions that do this, and is technically valid (albeit deprecated). This would be the most complete solution, that would be valid in nearly all cases.

Regarding the pinning behaviour:
What would the API look like that would allow altsubject_name/CA pinning (with maybe a fingerprint fallback)? Is something like this already in place?

</pre>
    </div>

    <div id="c24" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1178263#c24">Comment 24</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard "><span class="fn">Jouni Malinen</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-01-14 14:05:48 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">I added domain_match parameter which can be used to force a full case-insensitive match against dNSName, if any is included, and if not include, against any CN.

In the released wpa_supplicant versions, server certificate subject name is provided through both the ctrl_iface and D-Bus interface during authentication.
As an example, D-Bus 'Certification' signal would include subject parameter with '/C=FI/O=w1.fi/CN=server.w1.fi' format (the exact format depends on the TLS library). This signal is provided for each certificate in the server certificate chain, so the one with depth=0 would be used for this purpose.

Alternatively, special server certificate probing connection with ca_cert=&quot;probe://&quot; could be used to get the full server certificate ('cert' parameter in that 'Certification' signal) to allow upper layer parsing and determination of what field to match against. With such information, the network profile parameters altsubject_match or domain_suffix_match could be configured to require all future connections to meet the specified matching requirements. This certificate probing mechanism would also provide certificate hash value ('cert_hash' in that D-Bus signal) that could be used to set ca_cert=&quot;hash://server/sha256/&lt;hash&gt;&quot; to require that exact server certificate to be used.


In future releases (i.e., added today to hostap.git), this gets somewhat easier with following additions:

- full certificate and certificate hash are included by default even without the special certificate probe connection (i.e., you can configure normal profile and on first connection ask whether user is fine with the server certificate and then configure a suitable constraint on future connections)

- domain_match can now be used for full match against dNSName with fallback to CN

- parsed version of dNSName (and email and URI, for that matter) in SubjectAltName is provided (e.g., in D-Bus signal as 'altsubject' parameter that is an array of strings in &quot;DNS/EMAIL/URI:&lt;value&gt;&quot; format), so that upper layer software does not have to parse the certificate on its own. This is currently supported only with OpenSSL, but I guess this gets extended for GnuTLS eventually (at the same time when altsubject_match gets added; for now, GnuTLS-based build will reject any network with that parameter set)


The dbus_connect_eap test case in <a href="http://w1.fi/cgit/hostap/plain/tests/hwsim/test_dbus.py">http://w1.fi/cgit/hostap/plain/tests/hwsim/test_dbus.py</a> shows an example sequence that adds an EAP-TTLS/PAP profile to wpa_supplicant without a password, uses Certification signals to get the dNSName, configures dNSName constraint on the network block, and uses password request signal to provide the password when needed.

</pre>
    </div>

    <div id="c25" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1178263#c25">Comment 25</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard redhat_user"><span class="fn">Tomas Hoger</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-01-14 14:30:38 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">(In reply to Jouni Malinen from <a href="show_bug.cgi?id=1178263#c24">comment #24</a>)
<span class="quote">&gt; I added domain_match parameter which can be used to force a full
&gt; case-insensitive match against dNSName, if any is included, and if not
&gt; include, against any CN.</span >

Noting commit links for posterity:

<a href="http://w1.fi/cgit/hostap/commit/?id=cebee30f3170b5104a41bd27ac5f98615ed57656">http://w1.fi/cgit/hostap/commit/?id=cebee30f3170b5104a41bd27ac5f98615ed57656</a>
<a href="http://w1.fi/cgit/hostap/commit/?id=061cbb258fced68b127f66bdd35c55f77928b720">http://w1.fi/cgit/hostap/commit/?id=061cbb258fced68b127f66bdd35c55f77928b720</a>

<span class="quote">&gt; - parsed version of dNSName (and email and URI, for that matter) in
&gt; SubjectAltName is provided (e.g., in D-Bus signal as 'altsubject' parameter
&gt; that is an array of strings in &quot;DNS/EMAIL/URI:&lt;value&gt;&quot; format), so that
&gt; upper layer software does not have to parse the certificate on its own. This
&gt; is currently supported only with OpenSSL, but I guess this gets extended for
&gt; GnuTLS eventually (at the same time when altsubject_match gets added; for
&gt; now, GnuTLS-based build will reject any network with that parameter set)</span >

<a href="http://w1.fi/cgit/hostap/commit/?id=d07d3fbda2466d1778ecdf36e2986c5d9b3c1a53">http://w1.fi/cgit/hostap/commit/?id=d07d3fbda2466d1778ecdf36e2986c5d9b3c1a53</a>
<a href="http://w1.fi/cgit/hostap/commit/?id=2099fed400bd5cd95a3e3085e16e061e466bb8c1">http://w1.fi/cgit/hostap/commit/?id=2099fed400bd5cd95a3e3085e16e061e466bb8c1</a>

</pre>
    </div>

    <div id="c26" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1178263#c26">Comment 26</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard redhat_user"><span class="fn">Dan Winship</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-01-14 21:37:37 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">OK, I've backported domain_match to wpa_supplicant-2.0. It seems like that is the only wpa_supplicant change we want? (Any further work seems like it would be in NetworkManager.)

</pre>
    </div>

    <div id="c27" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1178263#c27">Comment 27</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard "><span class="fn">Jouni Malinen</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-01-14 21:42:55 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">You'd probably need to add <a href="http://w1.fi/cgit/hostap/commit/?id=483dd6a5e0069d0646505c26a5194eda15472858">http://w1.fi/cgit/hostap/commit/?id=483dd6a5e0069d0646505c26a5194eda15472858</a> ('Include peer certificate always in EAP events') to make it easier for NM to figure out which certificate was used in the initial connection. <a href="http://w1.fi/cgit/hostap/commit/?id=d07d3fbda2466d1778ecdf36e2986c5d9b3c1a53">http://w1.fi/cgit/hostap/commit/?id=d07d3fbda2466d1778ecdf36e2986c5d9b3c1a53</a> ('Add peer certificate alt subject name information to EAP events') could also be helpful, or alternatively, parse the certificate in NM which may be useful anyway if you want to make more verbose information about the server certificate (+ chain) available to the user.

</pre>
    </div>

    <div id="c28" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1178263#c28">Comment 28</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard "><span class="fn">Wilco Baan Hofman</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-01-20 16:04:57 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">I think it would be a good idea to backport the other two commits as well, so that network manager can be properly fixed as well. 

Right now, network manager is the remaining vulnerable component.

</pre>
    </div>

    <div id="c29" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1178263#c29">Comment 29</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard redhat_user"><span class="fn">Dan Williams</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-01-20 23:16:07 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">(In reply to Dan Winship from <a href="show_bug.cgi?id=1178263#c26">comment #26</a>)
<span class="quote">&gt; OK, I've backported domain_match to wpa_supplicant-2.0. It seems like that
&gt; is the only wpa_supplicant change we want? (Any further work seems like it
&gt; would be in NetworkManager.)</span >

Yeah, I think that's all we need from the supplicant.  We can track the NM parts in the upstream bug (<a href="https://bugzilla.gnome.org/show_bug.cgi?id=341323">https://bugzilla.gnome.org/show_bug.cgi?id=341323</a>).

</pre>
    </div>

    <div id="c30" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1178263#c30">Comment 30</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard redhat_user"><span class="fn">Dan Williams</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-01-20 23:16:37 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">But yeah, the other two commits should be backported too.

</pre>
    </div>

    <div id="c31" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1178263#c31">Comment 31</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard redhat_user"><span class="fn">Dan Winship</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-01-23 20:53:05 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">Created <span class=""><a href="attachment.cgi?id=983551&amp;action=diff" name="attach_983551" title="patch to dist-git with the backported fix">attachment 983551</a> <a href="attachment.cgi?id=983551&amp;action=edit" title="patch to dist-git with the backported fix">[details]</a></span>
patch to dist-git with the backported fix

Patch to dist-git backporting the domain_match and cert_in_cb changes.

I've tested that this does result in wpa_supplicant emitting D-Bus signals containing the certificate info:

    NetworkManager[21601]: &lt;info&gt;  Certificate signal: depth=1, subject='/C=FR/ST=Radius/L=Somewhere/O=Example Inc./<a href="mailto:emailAddress=admin&#64;example.com">emailAddress=admin&#64;example.com</a>/CN=Example Certificate Authority', altsubject='(null)', cert_hash='8a93b5e07470d6c96b284d5107f05d2bbf937366443c1e680763e4e9ede9e3e7'
    NetworkManager[21601]: &lt;info&gt;  Certificate signal: depth=0, subject='/C=FR/ST=Radius/O=Example Inc./CN=Example Server Certificate/<a href="mailto:emailAddress=admin&#64;example.com">emailAddress=admin&#64;example.com</a>', altsubject='(null)', cert_hash='2b362debf54f31bbe948e9a925fc5d0ab0743a6f738892ee84cd625cd0b2ac5d'

The backports were relatively painless; they didn't apply completely cleanly because of other, not backported, config changes between 2.0 and master, but the fixups were simple.


I am currently considering the NetworkManager changes to NOT be part of this CVE. Since NetworkManager does not make use of subject_match, it is not vulnerable to the extension attack which this bug was initially about, and the fact that it also does not use domain_match or anything else is an existing known limitation. (Which isn't to say that we don't plan on fixing that soon, just that I don't think it counts as part of this bug.)

</pre>
    </div>

    <div id="c32" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1178263#c32">Comment 32</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard "><span class="fn">Wilco Baan Hofman</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-01-24 10:38:23 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">The part about network manager is not entirely accurate,

Network manager does support subject_match, though not via the GUI, but in the /etc/NetworkManager/system-connections profiles.

The GUI has a bigger issue.. it does not allow to check *any* kind of remote identity, other than the CA.. which clearly is not enough, because all the CA does is sign certificates.. for anyone.

If NetworkManager is not part of this CVE, we should get a new CVE for network manager..

</pre>
    </div>

    <div id="c33" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1178263#c33">Comment 33</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard redhat_user"><span class="fn">Tomas Hoger</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-01-26 09:44:18 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">(In reply to Wilco Baan Hofman from <a href="show_bug.cgi?id=1178263#c32">comment #32</a>)
<span class="quote">&gt; If NetworkManager is not part of this CVE, we should get a new CVE for
&gt; network manager..</span >

This CVE was assigned to &quot;wpa_supplicant subject_match incorrectly uses substring match&quot;.  However, <a href="show_bug.cgi?id=1178263#c10">comment 10</a> explains this behavior is intended and documented, making the CVE assignment invalid.  This is not to say that domain_match is undesired, only to mention that this is problematic from the CVE assignment point of view.

There is an older <a href="https://access.redhat.com/security/cve/CVE-2006-7246">CVE-2006-7246</a>, which is for NetworkManager not doing certificate check.  AFAICS, this issue was addressed in NM upstream by making it possible to configured subject_match and alt_subject_match in profile configuration files, but never exposed that setting in GUI.  Relevant upstream bug is the one linked in <a href="show_bug.cgi?id=1178263#c29">comment 29</a>.  As it has not been closed, I assume those fixes were not considered complete.

Dan, what is the plan for NM upstream?  Should GUI changes be expected soon, or a config-only fix similar to existing *subject_match support today is expected first?

</pre>
    </div>

    <div id="c34" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1178263#c34">Comment 34</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard redhat_user"><span class="fn">Tomas Hoger</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-01-26 10:20:47 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">It seems OpenSUSE has been carrying some nm-applet GUI patch for some time:

<a href="https://build.opensuse.org/package/view_file/openSUSE:11.4:Update/NetworkManager-gnome.import5373/nma-wpa-eap-probe-ca-cert.patch">https://build.opensuse.org/package/view_file/openSUSE:11.4:Update/NetworkManager-gnome.import5373/nma-wpa-eap-probe-ca-cert.patch</a>
<a href="https://build.opensuse.org/package/view_file/openSUSE:Factory/NetworkManager-gnome/nm-applet-probe-radius-server-cert.patch">https://build.opensuse.org/package/view_file/openSUSE:Factory/NetworkManager-gnome/nm-applet-probe-radius-server-cert.patch</a>

</pre>
    </div>

    <div id="c35" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1178263#c35">Comment 35</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard redhat_user"><span class="fn">Tomas Hoger</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-01-28 12:15:14 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">I'm making this bug public.  It notes the useful discussion of what led to introduction of the domain_match parameter.  Issues arising from the substring based comparison performed by subject_match are already public, e.g. via the linked NetworkManager bug in Gnome bugzilla.

</pre>
    </div>

    <div id="c36" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1178263#c36">Comment 36</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard redhat_user"><span class="fn">Dan Williams</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-01-30 23:08:40 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">The plan is to add a more flexible configuration option for NetworkManager than the existing things, and use that in the GUI instead of exposing *three* fields that all do about the same exact thing (altsubject_match, subject_match, and domain_suffix_match).

</pre>
    </div>

    <div id="c37" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1178263#c37">Comment 37</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard "><span class="fn">Wilco Baan Hofman</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-01-31 15:28:13 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">Dan Williams,

Can you elaborate a bit on what you plan to implement in Network Manager?
Because altsubject_match, subject_match, domain_suffix_match do *not* do the same thing, but I'll admit that they have the same goal in mind (identity verification from the certificate).

More flexibility in the GUI is good, as long as it defaults to a safe configuration (Which in all cases means that the dNSName/CN should be checked).

</pre>
    </div>

    <div id="c43" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1178263#c43">Comment 43</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard redhat_user"><span class="fn">Ken Benoit</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-06-04 18:11:32 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">Manually verified domain_match is currently supported in wpa_supplicant. Also performed automated connection testing against wpa_supplicant-2.0-17.el7_1. Verified 0013-rh1178263-domain_match.patch and 0014-rh1178263-cert_in_cb.patch are in the source rpm and performed a rebuild to ensure the patches are applied.

</pre>
    </div>

    <div id="c45" class="bz_comment
            "
    >

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1178263#c45">Comment 45</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard redhat_user"><span class="fn">errata-xmlrpc</span>
</span>
        </span>

        
        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-06-11 17:48:42 UTC
        </span>

      </div>

      


      
      



<pre class="bz_comment_text">Since the problem described in this bug report should be
resolved in a recent advisory, it has been closed with a
resolution of ERRATA.

For information on the advisory, and where to find the updated
files, follow the link below.

If the solution does not work for you, open a new bug report.

<a href="https://rhn.redhat.com/errata/RHSA-2015-1090.html">https://rhn.redhat.com/errata/RHSA-2015-1090.html</a>

</pre>
    </div>


  <script>
$(document).ready(function() {
  var mysel = document.getElementsByClassName('flag_type-415')[0];
  var relnotes = document.getElementById('cf_release_notes');
  if ( mysel && relnotes &&
      relnotes.value != '' &&
      relnotes.value != cf_doc_type_text[document.getElementById('cf_doc_type').value] &&
      mysel.options[mysel.selectedIndex].value != '+'
    )
      document.getElementById('cf_doc_warn').innerHTML = '<div class="warning "><b>Warning: Doc Text is not yet verified as correct</b></div>';
});
</script>

</td>
<td>
</td>
</tr></table>
  </div>

    <hr><div id="add_comment" class="bz_section_additional_comments">
      <table>
        <tr>
          <td>
            <fieldset>
              <legend>Note</legend>
              You need to
              <a href="show_bug.cgi?id=1178263&amp;GoAheadAndLogIn=1">log in</a>
              before you can comment on or make changes to this bug.
            </fieldset>
          </td>
        </tr> 
      </table>
  </div>        

</form>

<hr>
<ul class="related_actions">
    <li><a href="show_bug.cgi?format=multiple&amp;id=1178263" title="Format For Printing"><i class="fa fa-print"></i></a></li>
    <li><a href="show_bug.cgi?ctype=xml&amp;id=1178263" title="Export as XML"><i class="far fa-file-excel"></i></a></li>
    <li><a href="enter_bug.cgi?cloned_bug_id=1178263" title="Clone This Bug"><i class="fa fa-clone"></i></a></li>
    <li>
      <a href="enter_bug.cgi?cloned_bug_id=1178263&lite=1" title="Copy is a lite weight clone that only copies the summary &amp; description">
       <i class="far fa-clone"></i>
      </a>
    </li><li>
  <a href="buglist.cgi?bug_id=1178263&amp;bug_id_type=anddependson&amp;format=tvp" title="TreeView+">
    <i class="fa fa-tree"></i>
  </a>
</li>
    <li>
      <a href="#" title="Top of page">
        <i class="fa fa-arrow-up" aria-hidden="true"></i>
      </a>
    </li>
    </ul>

<br>
</div>

    <div id="footer">
      <div class="intro"></div>
<ul id="useful-links">
  <li id="links-actions"><ul class="links">
  <li class="form">
    
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_bottom" name="no_redirect" value="0">
    <script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_bottom");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_bottom" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_bottom"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>

</ul>
  </li>

  




  
</ul>

      <div class="outro"></div>
    </div>
<script type="text/javascript">
function dt_submit() {
  var tables = $.fn.dataTable.tables( { visible: true, api: true } );
  $.each(tables.context, function() {
    var $myform = this.nTable.closest('form');

    // Checked checkboxes
    $.each(this.oInstance.$('input:checked'), function() {
      add_hidden(this.name, this.value, $myform)
    });

    // Inputs in selected rows
    $.each(this.oInstance.$('tr.selected'), function() {
      $(this).find('input').each( function() {
        add_hidden(this.name, this.value, $myform)
      });
    });

    // select boxes
    $.each(this.oInstance.$('select'), function() {
      if(($(this).val()!=="") && ($(this).val() !== 0)) {
        add_hidden(this.name, this.value, $myform);
      }
    });
  });
}

function add_hidden(nm, val, $frm) {
        $('<input />').attr('type', 'hidden')
          .attr('name', nm)
          .attr('value', val)
          .appendTo($frm);
}

$(document).ready(function() {
    $('form').submit(function( event ) {
        dt_submit();
        if( $(this).attr('id') === 'changeform') {
          return(validateEnterBug(this));
        }
    });
});

if (window.self !== window.top) {
    $('#header').addClass('bz_default_hidden');
    $('#footer').addClass('bz_default_hidden');
    $('.navigation').addClass('bz_default_hidden');
    $('body').css('background-image', 'none');
}
</script><script type="text/javascript">
$(document).ready(function() {
    $('select').not('.custom_search_condition select, #member_template select, #available_columns, #p2_component, #select_user_verify_class, #inclusion_to_remove, #exclusion_to_remove, #cc, #hide, #ack_col_edit #show, .noselectize, #j_top').each(function() {
        if(! $(this).hasClass('selectized')) {
            $(this).selectize({
                plugins: ['remove_button', 'minimum_search_length', 'extra_keys_control', 'related_fields', 'load_from_js'],
                selectOnTab: true,
                maxOptions: 'nolimit',
                minimum_search_length: 2,
                render: {
                    option: function(item, escape) {
                        var classes = "option";
                        var selected = this.items.indexOf(item.value) !== -1;
                        if(item.disabled) {
                            classes = classes + " bz_default_hidden" ;
                        }

                        return '<div class="' +  classes  + '" title="' + escape(item.title) + '" id="' + escape(item.id) + '" data-value="' + escape(item.value) + '">' +
                                    '<span>' + escape(item.text) + '</span>' +
                                '</div>';
                    }
                },
            });
        }
    });
});
</script>
  </body>
</html>