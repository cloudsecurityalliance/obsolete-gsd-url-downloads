<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="UTF-8">
<meta property="og:type" content="website">
<meta property="og:title" content="1415644 - (CVE-2018-5152) Should extensions get access to accounts.firefox.com">
<meta property="og:url" content="https://bugzilla.mozilla.org/show_bug.cgi?id=1415644">
<meta property="og:description"
      content="RESOLVED (kmaglione+bmo) in WebExtensions - General. Last updated 2020-09-11.">
<meta name="twitter:label1" value="Type">
<meta name="twitter:data1" value="enhancement">
<meta name="twitter:label2" value="Priority">
<meta name="twitter:data2" value="P2">

    <meta name="viewport" content="width=1024">
    <meta name="color-scheme" content="dark light">
    <meta name="generator" content="Bugzilla 20211025.1">
    <meta name="bugzilla-global" content="dummy"
        id="bugzilla-global" data-bugzilla="{&quot;api_token&quot;:&quot;&quot;,&quot;config&quot;:{&quot;basepath&quot;:&quot;\/&quot;},&quot;constant&quot;:{&quot;COMMENT_COLS&quot;:80},&quot;param&quot;:{&quot;maxattachmentsize&quot;:&quot;10240&quot;,&quot;maxusermatches&quot;:&quot;50&quot;,&quot;splinter_base&quot;:&quot;\/page.cgi?id=splinter.html&amp;ignore=\/&quot;},&quot;string&quot;:{&quot;bug_type_required&quot;:&quot;You must select a Type for this bug&quot;,&quot;component_required&quot;:&quot;You must select a Component for this bug&quot;,&quot;description_required&quot;:&quot;You must enter a Description for this bug&quot;,&quot;short_desc_required&quot;:&quot;You must enter a Summary for this bug&quot;,&quot;version_required&quot;:&quot;You must select a Version for this bug&quot;},&quot;user&quot;:{&quot;is_new&quot;:1,&quot;login&quot;:&quot;&quot;}}">
    <title>1415644 - (CVE-2018-5152) Should extensions get access to accounts.firefox.com</title>

<link rel="Top" href="/">

  


  
    <link rel="Show" title="Dependency Tree"
          href="/showdependencytree.cgi?id=1415644&amp;hide_resolved=1">
      <link rel="Show" title="Dependency Graph"
            href="/showdependencygraph.cgi?id=1415644">

      <link rel="Show" title="Bug Activity"
            href="/show_activity.cgi?id=1415644">

<link href="/static/v20211025.1/skins/yui.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/standard/global.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BugModal/web/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BMO/web/styles/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/EditComments/web/styles/inline-editor.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-structure-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-theme-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/lib/prism.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Needinfo/web/styles/needinfo.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Review/web/styles/badge.css" rel="stylesheet" type="text/css">



    
<script nonce="IIM86OxCgGnNMjoRhTQ5eynQWMs37kbTF3cErcYznFij1a3w" src="/static/v20211025.1/js/jquery/jquery-min.js"></script><script nonce="IIM86OxCgGnNMjoRhTQ5eynQWMs37kbTF3cErcYznFij1a3w" src="/static/v20211025.1/js/jquery/ui/jquery-ui-min.js"></script><script nonce="IIM86OxCgGnNMjoRhTQ5eynQWMs37kbTF3cErcYznFij1a3w" src="/static/v20211025.1/js/yui.js"></script><script nonce="IIM86OxCgGnNMjoRhTQ5eynQWMs37kbTF3cErcYznFij1a3w" src="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu-min.js"></script><script nonce="IIM86OxCgGnNMjoRhTQ5eynQWMs37kbTF3cErcYznFij1a3w" src="/static/v20211025.1/js/jquery/plugins/devbridgeAutocomplete/devbridgeAutocomplete-min.js"></script><script nonce="IIM86OxCgGnNMjoRhTQ5eynQWMs37kbTF3cErcYznFij1a3w" src="/static/v20211025.1/js/global.js"></script><script nonce="IIM86OxCgGnNMjoRhTQ5eynQWMs37kbTF3cErcYznFij1a3w" src="/static/v20211025.1/js/util.js"></script><script nonce="IIM86OxCgGnNMjoRhTQ5eynQWMs37kbTF3cErcYznFij1a3w" src="/static/v20211025.1/js/dropdown.js"></script>

      <script nonce="IIM86OxCgGnNMjoRhTQ5eynQWMs37kbTF3cErcYznFij1a3w">
          YAHOO.namespace('bugzilla');
          if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
              YAHOO.util.Event._simpleRemove(window, "unload",
                                             YAHOO.util.Event._unload);
          }BUGZILLA.value_descs = JSON.parse('{\"bug_status\":{},\"resolution\":{\"\":\"---\"}}');

  
    var tracking_flags_str = "{\"flags\":{\"blocking\":{\"cf_blocking_webextensions\":\"---\"},\"project\":{\"cf_webcompat_priority\":\"---\",\"cf_tracking_firefox_sumo\":\"---\",\"cf_a11y_review_project_flag\":\"---\",\"cf_root_cause\":\"---\",\"cf_fission_milestone\":\"---\"},\"tracking\":{\"cf_tracking_thunderbird_esr78\":\"---\",\"cf_status_thunderbird_esr91\":\"---\",\"cf_status_firefox94\":\"---\",\"cf_status_firefox93\":\"---\",\"cf_tracking_firefox_relnote\":\"---\",\"cf_tracking_firefox_esr91\":\"---\",\"cf_status_firefox95\":\"---\",\"cf_status_firefox_esr78\":\"---\",\"cf_tracking_thunderbird_esr91\":\"---\",\"cf_status_firefox59\":\"wontfix\",\"cf_status_firefox60\":\"fixed\",\"cf_tracking_firefox94\":\"---\",\"cf_tracking_firefox95\":\"---\",\"cf_status_thunderbird_esr78\":\"---\",\"cf_tracking_firefox93\":\"---\",\"cf_status_firefox_esr91\":\"---\",\"cf_tracking_firefox60\":\"+\",\"cf_status_firefox_esr52\":\"wontfix\",\"cf_tracking_firefox_esr78\":\"---\"}},\"comments\":{\"cf_tracking_firefox_relnote\":{\"?\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox_sumo\":{\"none-needed\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox94\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_a11y_review_project_flag\":{\"requested\":\"Description:\\nPlease provide an explanation of the feature or change. Include a description of the user scenario in which it would be used and how the user would complete the task(s).\\nScreenshots and visual UI specs are welcome, but please include sufficient accompanying explanation so that blind members of the accessibility team are able to understand the feature\/change.\\n\\nHow do we test this?\\nIf there is an implementation to test, please provide instructions for testing it; e.g. setting preferences, other preparation, how to trigger the UI, etc.\\n\\nWhen will this ship?\\nTracking bug\/issue:\\nDesign documents (e.g. Product Requirements Document, UI spec):\\nEngineering lead:\\nProduct manager:\\n\\nThe accessibility team has developed the Mozilla Accessibility Release Guidelines which outline what is needed to make user interfaces accessible:\\nhttps:\/\/wiki.mozilla.org\/Accessibility\/Guidelines\\nPlease describe the accessibility guidelines you considered and what steps you\'ve taken to address them:\\n\\nDescribe any areas of concern to which you want the accessibility team to give special attention:\"},\"cf_tracking_firefox93\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr91\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox60\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr78\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox95\":{\"?\":\"[Tracking Requested - why for this release]:\"}},\"types\":[\"blocking\",\"tracking\"]}";
    var TrackingFlags = $.parseJSON(tracking_flags_str);

  

  
  BUGZILLA.bug_id = 1415644;
  BUGZILLA.bug_title = '1415644 - (CVE-2018-5152) Should extensions get access to accounts.firefox.com';
  BUGZILLA.bug_summary = 'Should extensions get access to accounts.firefox.com';
  BUGZILLA.bug_url = 'https:\/\/bugzilla.mozilla.org\/show_bug.cgi?id=1415644';
  BUGZILLA.bug_keywords = 'csectype-priv-escalation, sec-moderate',
  BUGZILLA.user = {
    id: 0,
    login: '',
    is_insider: false,
    is_timetracker: false,
    can_tag: false,
    timezone: 'America\/Los_Angeles',
    settings: {
      quote_replies: 'quoted_reply',
      zoom_textareas: true,
      remember_collapsed: true,
      inline_attachments: true,
      autosize_comments: false
    }
  };

  BUGZILLA.bug_secure = false;
      </script>
<script nonce="IIM86OxCgGnNMjoRhTQ5eynQWMs37kbTF3cErcYznFij1a3w" src="/static/v20211025.1/extensions/BugModal/web/autosize.min.js"></script><script nonce="IIM86OxCgGnNMjoRhTQ5eynQWMs37kbTF3cErcYznFij1a3w" src="/static/v20211025.1/extensions/ProdCompSearch/web/js/prod_comp_search.js"></script><script nonce="IIM86OxCgGnNMjoRhTQ5eynQWMs37kbTF3cErcYznFij1a3w" src="/static/v20211025.1/extensions/BugModal/web/bug_modal.js"></script><script nonce="IIM86OxCgGnNMjoRhTQ5eynQWMs37kbTF3cErcYznFij1a3w" src="/static/v20211025.1/extensions/BugModal/web/comments.js"></script><script nonce="IIM86OxCgGnNMjoRhTQ5eynQWMs37kbTF3cErcYznFij1a3w" src="/static/v20211025.1/extensions/ComponentWatching/web/js/overlay.js"></script><script nonce="IIM86OxCgGnNMjoRhTQ5eynQWMs37kbTF3cErcYznFij1a3w" src="/static/v20211025.1/js/bugzilla-readable-status-min.js"></script><script nonce="IIM86OxCgGnNMjoRhTQ5eynQWMs37kbTF3cErcYznFij1a3w" src="/static/v20211025.1/js/field.js"></script><script nonce="IIM86OxCgGnNMjoRhTQ5eynQWMs37kbTF3cErcYznFij1a3w" src="/static/v20211025.1/js/comments.js"></script><script nonce="IIM86OxCgGnNMjoRhTQ5eynQWMs37kbTF3cErcYznFij1a3w" src="/static/v20211025.1/extensions/TrackingFlags/web/js/flags.js"></script><script nonce="IIM86OxCgGnNMjoRhTQ5eynQWMs37kbTF3cErcYznFij1a3w" src="/static/v20211025.1/extensions/BMO/web/js/firefox-crash-table.js"></script><script nonce="IIM86OxCgGnNMjoRhTQ5eynQWMs37kbTF3cErcYznFij1a3w" src="/static/v20211025.1/extensions/MozChangeField/web/js/severity-s1-priority-p1.js"></script><script nonce="IIM86OxCgGnNMjoRhTQ5eynQWMs37kbTF3cErcYznFij1a3w" src="/static/v20211025.1/extensions/MozChangeField/web/js/clear-tracking-priority-s1.js"></script><script nonce="IIM86OxCgGnNMjoRhTQ5eynQWMs37kbTF3cErcYznFij1a3w" src="/static/v20211025.1/extensions/MozChangeField/web/js/set-tracking-severity-s1.js"></script><script nonce="IIM86OxCgGnNMjoRhTQ5eynQWMs37kbTF3cErcYznFij1a3w" src="/static/v20211025.1/js/lib/prism.js"></script><script nonce="IIM86OxCgGnNMjoRhTQ5eynQWMs37kbTF3cErcYznFij1a3w" src="/static/v20211025.1/extensions/GoogleAnalytics/web/js/analytics.js"></script><script nonce="IIM86OxCgGnNMjoRhTQ5eynQWMs37kbTF3cErcYznFij1a3w" src="/static/v20211025.1/js/lib/md5.min.js"></script><script nonce="IIM86OxCgGnNMjoRhTQ5eynQWMs37kbTF3cErcYznFij1a3w" src="/static/v20211025.1/extensions/Review/web/js/badge.js"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla@Mozilla" href="/search_plugin.cgi"><link rel="shortcut icon" href="/extensions/BMO/web/images/favicon.ico">
<link rel="canonical" href="https://bugzilla.mozilla.org/show_bug.cgi?id=1415644">
<link rel="shorturl" href="https://bugzilla.mozilla.org/1415644"><meta name="google-analytics" content="UA-36116321-3" data-location="https://bugzilla.mozilla.org/bug/show-modal" data-title="1415644 - (CVE-2018-5152) Should extensions get access to accounts.firefox.com">
<script async src="https://www.google-analytics.com/analytics.js"></script><meta name="robots" content="noarchive">
  </head>



  <body
        class="bugzilla-mozilla-org
               skin-standard bug_modal yui-skin-sam">



<div id="wrapper">

<header id="header" role="banner">
  <div class="inner">
    <h1 id="header-title" class="title"><a href="https://bugzilla.mozilla.org/home" title="Go to home page">Bugzilla</a></h1>
    <form role="search" id="header-search" class="quicksearch" action="/buglist.cgi" data-no-csrf>
      <section class="searchbox-outer dropdown" role="combobox" aria-expanded="false" aria-haspopup="listbox"
               aria-labelledby="header-search-label" aria-owns="header-search-dropdown">
        <h2 id="header-search-label">Quick Search</h2>
        <span class="icon" aria-hidden="true"></span>
        <input role="searchbox" id="quicksearch_top" class="dropdown-button" name="quicksearch" autocomplete="off"
               value="" placeholder="Search Bugs"
               title="Enter a bug number or some search terms" aria-controls="header-search-dropdown"
               aria-label="Quick Search"><div id="header-search-dropdown" class="dropdown-content right" role="listbox" style="display: none;">
  <div id="header-search-dropdown-wrapper">
  </div>
</div>
      </section>
    </form>
    <nav id="header-nav">
      <ul class="links">
        <li class="link-browse">
          <a href="/describecomponents.cgi" title="Browse bugs by component">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Browse</span>
          </a>
        </li>
        <li class="link-search">
          <a href="/query.cgi?format=advanced" title="Search bugs using various criteria">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Advanced Search</span>
          </a>
        </li>
      </ul>
      <div class="dropdown">
        <button type="button" id="header-tools-menu-button" class="dropdown-button minor" title="More tools…"
                aria-label="More tools…" aria-expanded="false" aria-haspopup="true" aria-controls="header-tools-menu">
          <span class="icon" aria-hidden="true"></span>
        </button>
        <ul class="dropdown-content left" id="header-tools-menu" role="menu" style="display:none;">
          <li role="presentation">
            <a href="/report.cgi" role="menuitem" tabindex="-1">Reports</a>
          </li>
            <li role="separator"></li>
            <li role="presentation">
              <a href="https://bmo.readthedocs.io/en/latest/" role="menuitem" tabindex="-1">Documentation</a>
            </li>
        </ul>
      </div>
    </nav>
      <ul id="header-login" class="links">
          <li id="moz_new_account_container_top"><a href="/createaccount.cgi">New Account</a></li><li id="mini_login_container_top">
  <a id="login_link_top" href="/index.cgi?GoAheadAndLogIn=1"
     class='show_mini_login_form' data-qs-suffix="_top">Log In</a>

  <div id="mini_login_top" class="mini-popup mini_login bz_default_hidden"><span id="github_mini_login_top" class="mini_login_top">
    <form method="post" action="/github.cgi">
      <input type="hidden" name="github_secret" value="zr8DBFeXiAWyLity3muXbbCg6eIxHclCQ01ivvCmjDVEWcL7w8c71vQj5CcUbEhnWYO8kYcgFNBhBYe7Ihge8nOjPEUb5GrTaeZCuFiNDw5LRJoRmfwsCcadiDefRANqhdQyCaj08yhp0kSIocQ1qa9ByW3ByJyaCRyHVyGa1FXHsdtsrGjhurEe8c00RsA45soktsAjKnxii7sDI8SnUdQthJrddH5YLPHCqRSnkmNOi5IQe6nXxAR5hIna0aFM">
      <input type="hidden" name="target_uri" value="https://bugzilla.mozilla.org/show_bug.cgi">
      <input type="image" src="/extensions/GitHubAuth/web/images/sign_in.png" height="22" width="75" align="absmiddle"
             alt="Sign in with GitHub"
             title="Sign in with GitHub"> or
    </form>
  </span>

  <form action="/show_bug.cgi?id=1415644" method="POST"
        data-qs-suffix="_top">

    <input id="Bugzilla_login_top"
           class="bz_login"
           name="Bugzilla_login"
           title="Login"
           placeholder="Email"
           aria-label="Email"
           type="email"
           required
    >
    <input class="bz_password"
           id="Bugzilla_password_top"
           name="Bugzilla_password"
           type="password"
           title="Password"
           placeholder="Password"
           aria-label="Password"
           required
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text"
           id="Bugzilla_password_dummy_top" value="password"
           title="Password"
    >
      <input type="checkbox" id="Bugzilla_remember_top"
             name="Bugzilla_remember" value="on" class="bz_remember"
                 checked>
      <label for="Bugzilla_remember_top">Remember</label>
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
           class="check_mini_login_fields"
            id="log_in_top">
    <a href="#" id="hide_mini_login_top" aria-label="Close"
       class="close-button hide_mini_login_form" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
<li id="forgot_container_top">
  <a id="forgot_link_top" href="/index.cgi?GoAheadAndLogIn=1#forgot"
     class='show_forgot_form'
     data-qs-suffix="_top">Forgot Password</a>
  <div id="forgot_form_top" class="mini-popup mini_forgot bz_default_hidden">
  <form action="/token.cgi" method="post">
    <input type="email" name="loginname" size="20" placeholder="Email" aria-label="Email" required>
    <input id="forgot_button_top" value="Reset Password"
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <input type="hidden" id="token_top" name="token" value="1635623251-2pjXKmfD6ck0d3CVZeKWVTsQH9pW9JnzyAvqlaz1Hhg">
    <a href="#" class="close-button hide_forgot_form" aria-label="Close" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
      </ul><div id="header-external-links" class="dropdown first">
  <button type="button" id="header-external-menu-button" class="dropdown-button minor" title="Mozilla"
          aria-label="Mozilla" aria-expanded="false" aria-haspopup="true" aria-controls="header-external-menu">
    <img src="/static/v20211025.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg" width="32" height="32" alt="">
  </button>
  <ul class="dropdown-content right" id="header-external-menu" role="menu" style="display:none;">
    <li role="presentation">
      <a href="https://www.mozilla.org/" role="menuitem" tabindex="-1">Mozilla Home</a>
    </li>
    <li role="separator"></li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/" role="menuitem" tabindex="-1">Privacy</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/#cookies" role="menuitem" tabindex="-1">Cookies</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/about/legal/" role="menuitem" tabindex="-1">Legal</a>
    </li>
  </ul>
</div>
  </div>
</header> 


<main id="bugzilla-body" tabindex="-1">

<aside id="message-container" role="complementary">
  <noscript>
    <div class="noscript">
      <div class="inner">
        <p>Please enable JavaScript in your browser to use all the features on this site.</p>
      </div>
    </div>
  </noscript>
</aside>

<div id="main-inner">




<div role="toolbar" id="page-toolbar">
  <div role="group" class="buttons">
    <button type="button" id="copy-summary" class="secondary"
      title="Copy bug number and summary to your clipboard">Copy Summary</button>
    <div id="clip-container" style="display:none"><input type="text" id="clip"></div>
    <div class="dropdown">
      <button type="button" id="action-menu-btn" aria-haspopup="true" aria-label="View"
        aria-expanded="false" aria-controls="action-menu" class="dropdown-button secondary">View &#9662;</button>
      <ul class="dropdown-content left" id="action-menu" role="menu" style="display:none;">
        <li role="presentation">
          <a id="action-reset" role="menuitem" tabindex="-1">Reset Sections</a>
        </li>
        <li role="presentation">
          <a id="action-expand-all" role="menuitem" tabindex="-1">Expand All Sections</a>
        </li>
        <li role="presentation">
          <a id="action-collapse-all" role="menuitem" tabindex="-1">Collapse All Sections</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a id="action-history" role="menuitem" tabindex="-1">History</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a href="/rest/bug/1415644" role="menuitem" tabindex="-1">JSON</a>
        </li>
        <li role="presentation">
          <a href="/show_bug.cgi?ctype=xml&amp;id=1415644" role="menuitem" tabindex="-1">XML</a>
        </li>
      </ul>
    </div>
  </div>
</div>



<div role="status" id="io-error" style="display:none"></div>
<div role="status" id="floating-message" style="display:none">
  <div id="floating-message-text"></div>
</div>
<section class="module"
>
  <div class="module-content"
  >
  <div id="summary-container">
    <div class="field indent" id="field-status_summary"
>


  
    <div class=" container">
        <span id="field-value-status_summary">
      <span class="bug-status-label text" data-status="closed">Closed</span>
      <span id="field-value-bug_id">
        <a href="/show_bug.cgi?id=1415644">Bug 1415644</a>
          <span class="edit-hide">(CVE-2018-5152)</span>
      </span>
      <span>
        <span class="bug-time-label">Opened <span class="rel-time" title="2017-11-08 10:54 PST" data-time="1510167292">4 years ago</span></span>
          <span class="bug-time-label">Closed <span class="rel-time" title="2018-03-10 02:06 PST" data-time="1520676399">4 years ago</span></span>
      </span>
        </span>
    </div>

  
</div>
<div class="field indent edit-hide"
>


  
    <div class=" container">
      

      <h1 id="field-value-short_desc">Should extensions get access to accounts<wbr>.firefox<wbr>.com</h1>
    </div>

  
</div>

    <div class="field edit-show" id="field-short_desc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc" id="short_desc-help-link" class="help">Summary:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-short_desc">
            Should extensions get access to accounts.firefox.com

        </span>
    </div>

  
</div>
  </div>
  </div>
</section>


<section class="module" id="module-categories"
>
    <header id="module-categories-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Categories section"
           data-label-collapsed="Expand Categories section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-categories-content"
             aria-expanded="true"
             aria-labeledby="module-categories-title"
             aria-describedby="module-categories-subtitle"></div>
        <h2 class="module-title" id="module-categories-title">Categories</h2>
          <h3 class="module-subtitle" id="module-categories-subtitle">
            (WebExtensions :: General, enhancement, P2)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-categories-content"
  ><div class="fields-lhs">

    <div class="field" id="field-product"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=WebExtensions" id="product-help-link" class="help">Product:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-product">
      <div class="name-info-outer dropdown">
        <span id="product-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="product-info">WebExtensions
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="product-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Product description and actions">
          <header>
            <div class="title">WebExtensions</div>
            <div class="description">File feature requests and bugs related to the WebExtension add-on API.</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=WebExtensions&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Product</a></div>
            <div><a href="/enter_bug.cgi?product=WebExtensions"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Product</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="WebExtensions"
                         data-label-watch="Watch This Product" data-label-unwatch="Unwatch This Product"
                         data-source="BugModal">Watch This Product</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-component"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=WebExtensions&component=General#General" id="component-help-link" class="help">Component:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-component">
      <div class="name-info-outer dropdown">
        <span id="component-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="component-info">General
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="component-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Component description and actions">
          <header>
            <div class="title">WebExtensions :: General</div>
            <div class="description">All other bugs about WebExtensions</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=WebExtensions&amp;component=General&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Component</a></div>
            <div><a href="/buglist.cgi?product=WebExtensions&amp;component=General&amp;chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__"
                    target="_blank" role="menuitem" tabindex="-1">Recently Fixed Bugs in This Component</a></div>
            <div><a href="/enter_bug.cgi?product=WebExtensions&amp;component=General"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Component</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="WebExtensions" data-component="General"
                         data-label-watch="Watch This Component" data-label-unwatch="Unwatch This Component"
                         data-source="BugModal">Watch This Component</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-version" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#version" id="version-help-link" class="help">Version:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-version">
            unspecified

        </span>
    </div>

  
</div>

    <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform" id="-help-link" class="help">Platform:
        </a>
    </div>


  
    <div class=" container"><div class="field inline" id="field-rep_platform"
>


  
    <div class="value">
        <span id="field-value-rep_platform">
            Unspecified

        </span>
    </div>

  
</div><div class="field indent inline" id="field-op_sys"
>


  
    <div class="value">
        <span id="field-value-op_sys">
            Unspecified

        </span>
    </div>

  
</div><div class="field indent inline"
>


  
    <div class=" container">
    </div>

  
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field contains-buttons" id="field-bug_type"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type" id="bug_type-help-link" class="help">Type:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_type">
      <span class="bug-type-label iconic-text" data-type="enhancement">
        <span class="icon" aria-hidden="true"></span>enhancement</span>
        </span>
    </div>

  
</div>

    <div class="field" id="field-importance"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority" id="importance-help-link" class="help">Priority:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-importance"><div class="field inline" id="field-priority"
>


  
    <div class="value">
        <span id="field-value-priority">P2
        </span>
    </div>

  
</div><div class="field inline" id="field-bug_severity"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity" id="bug_severity-help-link" class="help">Severity:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_severity">
            normal

        </span>
    </div>

  
</div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-cf_fx_points" style="display:none"
>
    <div class="name">Points:
    </div>


  
    <div class="value">
        <span id="field-value-cf_fx_points">
            ---

        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-tracking"
>
    <header id="module-tracking-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Tracking section"
           data-label-collapsed="Expand Tracking section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-tracking-content"
             aria-expanded="true"
             aria-labeledby="module-tracking-title"
             aria-describedby="module-tracking-subtitle"></div>
        <h2 class="module-title" id="module-tracking-title">Tracking</h2>
          <h3 class="module-subtitle" id="module-tracking-subtitle">
            (firefox-esr52 wontfix, firefox59 wontfix, firefox60+ fixed)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-tracking-content"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-status-view"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-view-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-view">RESOLVED
        FIXED
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-status-edit" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-edit-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-edit"><div class="field inline" id="field-bug_status"
>


  
    <div class="value">
        <span id="field-value-bug_status">
            RESOLVED

        </span>
    </div>

  
</div><div class="field indent inline" id="field-resolution"
>


  
    <div class="value">
        <span id="field-value-resolution">
            FIXED

        </span>
    </div>

  
</div>
  <div id="status-action-buttons">
      <div id="assigned-container" style="display:none">
        <button type="button" class="secondary" id="mark-as-assigned-btn">
          Mark as Assigned
        </button>
      </div>
  </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-target_milestone"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone" id="target_milestone-help-link" class="help">Milestone:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-target_milestone">
            mozilla60

        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-cf_fx_iteration" style="display:none"
>
    <div class="name">Iteration:
    </div>


  
    <div class="value">
        <span id="field-value-cf_fx_iteration">
            ---

        </span>
    </div>

  
</div>


      <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Project Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <td class="tracking-flag-name">a11y-review</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_a11y_review_project_flag-dirty">
  <select id="cf_a11y_review_project_flag" name="cf_a11y_review_project_flag">
        <option value="---"
          id="v4876_cf_a11y_review_project_flag" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Root Cause</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_root_cause-dirty">
  <select id="cf_root_cause" name="cf_root_cause">
        <option value="---"
          id="v4701_cf_root_cause" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Webcompat Priority</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_webcompat_priority-dirty">
  <select id="cf_webcompat_priority" name="cf_webcompat_priority">
        <option value="---"
          id="v4274_cf_webcompat_priority" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">user-doc-firefox</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_sumo-dirty">
  <select id="cf_tracking_firefox_sumo" name="cf_tracking_firefox_sumo">
        <option value="---"
          id="v4660_cf_tracking_firefox_sumo" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Fission Milestone</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_fission_milestone-dirty">
  <select id="cf_fission_milestone" name="cf_fission_milestone">
        <option value="---"
          id="v4222_cf_fission_milestone" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

      <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Tracking Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-hide">
    <table class="layout-table tracking-flags">
        <tr>
          <th></th>
          <th>Tracking</th>
          <th>Status</th>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox-esr52</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox_esr52&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox59</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox59&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox60</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox60&amp;o1=equals&amp;v1=%2B">+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox60&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
    </table>
  </div>


<div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <th></th>
        <th>Tracking</th>
        <th>Status</th>
      </tr>
      <tr>
        <td class="tracking-flag-name">relnote-firefox</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_relnote-dirty">
  <select id="cf_tracking_firefox_relnote" name="cf_tracking_firefox_relnote">
        <option value="---"
          id="v539_cf_tracking_firefox_relnote" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr78-dirty">
  <select id="cf_tracking_thunderbird_esr78" name="cf_tracking_thunderbird_esr78">
        <option value="---"
          id="v4823_cf_tracking_thunderbird_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr78-dirty">
  <select id="cf_status_thunderbird_esr78" name="cf_status_thunderbird_esr78">
        <option value="---"
          id="v4829_cf_status_thunderbird_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr91-dirty">
  <select id="cf_tracking_thunderbird_esr91" name="cf_tracking_thunderbird_esr91">
        <option value="---"
          id="v5236_cf_tracking_thunderbird_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr91-dirty">
  <select id="cf_status_thunderbird_esr91" name="cf_status_thunderbird_esr91">
        <option value="---"
          id="v5242_cf_status_thunderbird_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr52</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr52-dirty">
  <select id="cf_status_firefox_esr52" name="cf_status_firefox_esr52">
        <option value="wontfix"
          id="v3142_cf_status_firefox_esr52" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr78-dirty">
  <select id="cf_tracking_firefox_esr78" name="cf_tracking_firefox_esr78">
        <option value="---"
          id="v4808_cf_tracking_firefox_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr78-dirty">
  <select id="cf_status_firefox_esr78" name="cf_status_firefox_esr78">
        <option value="---"
          id="v4813_cf_status_firefox_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr91-dirty">
  <select id="cf_tracking_firefox_esr91" name="cf_tracking_firefox_esr91">
        <option value="---"
          id="v5194_cf_tracking_firefox_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr91-dirty">
  <select id="cf_status_firefox_esr91" name="cf_status_firefox_esr91">
        <option value="---"
          id="v5199_cf_status_firefox_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox59</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox59-dirty">
  <select id="cf_status_firefox59" name="cf_status_firefox59">
        <option value="wontfix"
          id="v3511_cf_status_firefox59" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox60</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox60-dirty">
  <select id="cf_tracking_firefox60" name="cf_tracking_firefox60">
        <option value="+"
          id="v3558_cf_tracking_firefox60" selected
        >+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox60-dirty">
  <select id="cf_status_firefox60" name="cf_status_firefox60">
        <option value="fixed"
          id="v3566_cf_status_firefox60" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox93</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox93-dirty">
  <select id="cf_tracking_firefox93" name="cf_tracking_firefox93">
        <option value="---"
          id="v5266_cf_tracking_firefox93" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox93-dirty">
  <select id="cf_status_firefox93" name="cf_status_firefox93">
        <option value="---"
          id="v5271_cf_status_firefox93" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox94</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox94-dirty">
  <select id="cf_tracking_firefox94" name="cf_tracking_firefox94">
        <option value="---"
          id="v5284_cf_tracking_firefox94" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox94-dirty">
  <select id="cf_status_firefox94" name="cf_status_firefox94">
        <option value="---"
          id="v5289_cf_status_firefox94" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox95</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox95-dirty">
  <select id="cf_tracking_firefox95" name="cf_tracking_firefox95">
        <option value="---"
          id="v5311_cf_tracking_firefox95" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox95-dirty">
  <select id="cf_status_firefox95" name="cf_status_firefox95">
        <option value="---"
          id="v5316_cf_status_firefox95" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>

      <div class="field edit-show" style="display:none"
>
    <div class="name">Blocking Flags:
    </div>


  
    <div class=" container"><div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <td class="tracking-flag-name">webextensions</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_blocking_webextensions-dirty">
  <select id="cf_blocking_webextensions" name="cf_blocking_webextensions">
        <option value="---"
          id="v2817_cf_blocking_webextensions" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>
</div>
  </div>
</section>



<section class="module" id="module-people"
>
    <header id="module-people-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse People section"
           data-label-collapsed="Expand People section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-people-content"
             aria-expanded="false"
             aria-labeledby="module-people-title"
             aria-describedby="module-people-subtitle"></div>
        <h2 class="module-title" id="module-people-title">People</h2>
          <h3 class="module-subtitle" id="module-people-subtitle">
            (Reporter: andy+bugzilla, Assigned: kmag)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-people-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-assigned_to"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to"><div class="vcard vcard_106098" ><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=106098" > <span class="fna">kmag</span></a>
</div>
        </span>
    </div>

  
</div><div class="field edit-show" id="field-assigned_to" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-assignee" name="set_default_assignee" class="set-default"
          value="1" data-for="assigned_to">
        <label for="set-default-assignee">Reset Assignee to default</label>
      </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-bug_mentors" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor" id="bug_mentors-help-link" class="help">Mentors:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_mentors">---
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-qa_contact" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact" id="qa_contact-help-link" class="help">QA Contact:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-qa_contact">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-qa-contact" name="set_default_qa_contact" class="set-default"
          value="1" data-for="qa_contact">
        <label for="set-default-qa-contact">Reset QA Contact to default</label>
      </div>
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-reporter"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter" id="reporter-help-link" class="help">Reporter:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-reporter">
            <div class="vcard vcard_397635" ><img src="https://secure.gravatar.com/avatar/4ae11454315077053052b613d6d77241?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=397635" > <span class="fna">andy+bugzilla</span></a>
</div>

        </span>
    </div>

  
</div>

    <div class="field" id="field-triage_owner"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner" id="triage_owner-help-link" class="help">Triage Owner:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-triage_owner">
            <div class="vcard vcard_372685" ><img src="https://secure.gravatar.com/avatar/b2fec98200b3938bef69471c7005458c?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=372685" > <span class="fna">mixedpuppy</span></a>
</div>

        </span>
    </div>

  
</div>

    

    <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc" id="-help-link" class="help">CC:
        </a>
    </div>


  
    <div class=" container">


        <span aria-owns="cc-summary cc-latch">
          <span role="button" tabindex="0" id="cc-summary" data-count="33">33 people
          </span>
        </span>


        <div id="cc-list" style="display:none"></div>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-references"
>
    <header id="module-references-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse References section"
           data-label-collapsed="Expand References section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-references-content"
             aria-expanded="false"
             aria-labeledby="module-references-title"
             aria-describedby="module-references-subtitle"></div>
        <h2 class="module-title" id="module-references-title">References</h2>
      </div>
    </header>
  <div class="module-content" id="module-references-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field bug-list" id="field-dependson"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson" id="dependson-help-link" class="help">Depends on:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-dependson">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE - Clippings extension no longer functional on support.mozilla.org"
   href="/show_bug.cgi?id=1445714">1445714</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED WONTFIX - Extension cannot fetch data from addons.mozilla.org because the host permissions are not applied"
   href="/show_bug.cgi?id=1450649">1450649</a>, <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - proxy.onRequest not honored for addon updates"
   href="/show_bug.cgi?id=1476570">1476570</a>
      </div>

        </span>
    </div>

  
</div><div class="field bug-list" id="field-blocked"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks" id="blocked-help-link" class="help">Blocks:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-blocked">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - browser.devtools.inspectedWindow.eval isn't blocked on addons.mozilla.org"
   href="/show_bug.cgi?id=1425197">1425197</a>
      </div>
      <div class="bug-list">
        <span class="bug-type-label iconic" title="enhancement"
              aria-label="enhancement" data-type="enhancement">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED INVALID - Security review of logins API"
   href="/show_bug.cgi?id=1357856">1357856</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED INVALID - extensions can inject script into addons.mozilla.org by modifying requests to www.google-analytics.com"
   href="/show_bug.cgi?id=1443073">1443073</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED INVALID - Extensions shouldn't get access to topsites.services.mozilla.com"
   href="/show_bug.cgi?id=1664513">1664513</a>
      </div>

        </span>
    </div>

  
</div><div class="field" id="field-dependencytree"
>
    <div class="name">
    </div>


  
    <div class=" container">
        <span id="field-value-dependencytree">
        Dependency <a href="/showdependencytree.cgi?id=1415644&amp;hide_resolved=1">tree</a>
        / <a href="/showdependencygraph.cgi?id=1415644">graph</a>
        </span>
    </div>

  
</div>

    <div class="field bug-list edit-show" id="field-regresses" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses" id="regresses-help-link" class="help">Regressions:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regresses">
        ---
        </span>
    </div>

  
</div><div class="field bug-list edit-show" id="field-regressed_by" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by" id="regressed_by-help-link" class="help">Regressed by:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regressed_by">
        ---
        </span>
    </div>

  
</div>

    <div class="field bug-list"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates" id="-help-link" class="help">Duplicates:
        </a>
    </div>


  
    <div class="value">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE"
   href="/show_bug.cgi?id=1435937">1435937</a>
      </div>

    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field edit-show" id="field-bug_file_loc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc" id="bug_file_loc-help-link" class="help">URL:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_file_loc"><div class="link">
    <a href="" target="_blank"
      rel="noreferrer" title=""
      class="bug-url" data-safe="0"></a>
  </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-see_also"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also" id="see_also-help-link" class="help">See Also:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-see_also">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Crash in mozilla::extensions::URLInfo::Host"
   href="/show_bug.cgi?id=1470746">1470746</a>, <a class="bz_bug_link
          bz_status_UNCONFIRMED"
   title="UNCONFIRMED - Web Extensions cannot manage saved logins for accounts.firefox.com"
   href="/show_bug.cgi?id=1476755">1476755</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE - lastpass disabled on firefox sync signin page"
   href="/show_bug.cgi?id=1617184">1617184</a>
      </div>
      <div class="bug-list">
        <span class="bug-type-label iconic" title="enhancement"
              aria-label="enhancement" data-type="enhancement">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Consider preventing Web Extensions interacting with privileged Firefox web URLs"
   href="/show_bug.cgi?id=1361953">1361953</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED WONTFIX - NoScript may fail to operate on Mozilla domains in Tor Browser"
   href="/show_bug.cgi?id=1453988">1453988</a>, <a class="bz_bug_link
          bz_status_NEW"
   title="NEW - Consider removing domain restrictions for fetch/XMLHttpRequest"
   href="/show_bug.cgi?id=1465094">1465094</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED WONTFIX"
   href="/show_bug.cgi?id=1468748">1468748</a>
      </div>

        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-details"
>
    <header id="module-details-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Details section"
           data-label-collapsed="Expand Details section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-details-content"
             aria-expanded="false"
             aria-labeledby="module-details-title"
             aria-describedby="module-details-subtitle"></div>
        <h2 class="module-title" id="module-details-title">Details</h2>
          <h3 class="module-subtitle" id="module-details-subtitle">
            (Keywords: csectype-priv-escalation, sec-moderate, Whiteboard: [adv-main60+][post-critsmash-triage])
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-details-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-show" id="field-alias" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias" id="alias-help-link" class="help">Alias:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-alias">
            CVE-2018-5152

        </span>
    </div>

  
</div>

    <div class="field" id="field-keywords"
>
    <div class="name">
        <a href="/describekeywords.cgi" id="keywords-help-link" class="help">Keywords:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-keywords">
          <a href="/buglist.cgi?keywords=csectype-priv-escalation&amp;resolution=---">csectype-priv-escalation</a>, 
          <a href="/buglist.cgi?keywords=sec-moderate&amp;resolution=---">sec-moderate</a>
        </span>
    </div>

  
</div>

    <div class="field" id="field-status_whiteboard"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/Whiteboard" id="status_whiteboard-help-link" class="help">Whiteboard:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-status_whiteboard">[adv-main60+][post-critsmash-triage]
        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_qa_whiteboard" style="display:none"
>
    <div class="name">QA Whiteboard:
    </div>


  
    <div class="value">
        <span id="field-value-cf_qa_whiteboard">
        ---
        </span>
    </div>

  
</div>

    

    <div class="field edit-show" id="field-cf_has_regression_range" style="display:none"
>
    <div class="name">Has Regression Range:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_regression_range">
            ---

        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_has_str" style="display:none"
>
    <div class="name">Has STR:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_str">
            ---

        </span>
    </div>

  
</div>

    <div class="field" id="field-votes"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes" id="votes-help-link" class="help">Votes:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-votes">0
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-bug_flags"
>
    <div class="name">Bug Flags:
    </div>


  
    <div class=" container">
        <span id="field-value-bug_flags"><div id="bug-flags" class="flags">
  <table class="layout-table">
          <tbody class="edit-hide"><tr>
    <td class="flag-setter"><div class="vcard vcard_488993" ><a class="email " href="/user_profile?user_id=488993" > <span class="fna">avaida</span></a>
</div>
    </td>

    <td class="flag-name">
        <a href="#a22876120_488993"
            class="rel-time-title activity-ref"
            title="4 years ago"
        data-time="1525270759"
      >qe-verify</a>
    </td>

    <td class="flag-value">-
    </td>

  </tr>
          </tbody>
          <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter"><div class="vcard vcard_488993" ><a class="email " href="/user_profile?user_id=488993" > <span class="fna">avaida</span></a>
</div>
    </td>

    <td class="flag-name">
      <label title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually" for="flag-1751655">qe-verify</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag-1751655-dirty">
      <select id="flag-1751655" name="flag-1751655"
        title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually"
          disabled
        class="bug-flag">
            <option value="-" selected>-</option>
      </select>
    </td>


  </tr>
          </tbody>
    <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?" for="flag_type-930">behind-pref</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-930-dirty">
      <select id="flag_type-930" name="flag_type-930"
        title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?"
        class="bug-flag">
          <option value="X"></option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag tracking inclusion in the desktop Firefox product backlog." for="flag_type-846">firefox-backlog</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-846-dirty">
      <select id="flag_type-846" name="flag_type-846"
        title="Flag tracking inclusion in the desktop Firefox product backlog."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug." for="flag_type-803">sec-bounty</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-803-dirty">
      <select id="flag_type-803" name="flag_type-803"
        title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame." for="flag_type-913">sec-bounty-hof</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-913-dirty">
      <select id="flag_type-913" name="flag_type-913"
        title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-787">in-qa-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-787-dirty">
      <select id="flag_type-787" name="flag_type-787"
        title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>

      <td class="flag-requestee">
        <div id="requestee_type-787-container" style="display:none"><input
    name="requestee_type-787"
    value="" class="requestee bz_autocomplete_user"  id="requestee_type-787" 
  >
        </div>
      <td>

  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-37">in-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-37-dirty">
      <select id="flag_type-37" name="flag_type-37"
        title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr>
    </tbody>
  </table>
</div>
        </span>
    </div>

  
</div>
</div>

  
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-crash-data"
>
    <header id="module-crash-data-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Crash Data section"
           data-label-collapsed="Expand Crash Data section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-crash-data-content"
             aria-expanded="false"
             aria-labeledby="module-crash-data-title"
             aria-describedby="module-crash-data-subtitle"></div>
        <h2 class="module-title" id="module-crash-data-title">Crash Data</h2>
      </div>
    </header>
  <div class="module-content" id="module-crash-data-content" style="display:none"
  ><div class="field edit-show" id="field-cf_crash_signature" style="display:none"
>
    <div class="name">Signature:
    </div>


  
    <div class="value">
        <span id="field-value-cf_crash_signature">
        </span>
    </div>

  
</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-security"
>
    <header id="module-security-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Security section"
           data-label-collapsed="Expand Security section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-security-content"
             aria-expanded="false"
             aria-labeledby="module-security-title"
             aria-describedby="module-security-subtitle"></div>
        <h2 class="module-title" id="module-security-title">Security</h2>
          <h3 class="module-subtitle" id="module-security-subtitle">
            (public)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-security-content" style="display:none"
  ><div class="groups edit-hide">
    This bug is publicly visible.
</div>

<div class="groups edit-show" style="display:none">


</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-user-story" data-non-stick="1"
>
    <header id="module-user-story-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse User Story section"
           data-label-collapsed="Expand User Story section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-user-story-content"
             aria-expanded="false"
             aria-labeledby="module-user-story-title"
             aria-describedby="module-user-story-subtitle"></div>
        <h2 class="module-title" id="module-user-story-title">User Story</h2>
      </div>
    </header>
  <div class="module-content" id="module-user-story-content" style="display:none"
  >
    <pre id="user-story"></pre>
  </div>
</section>







<section class="module" id="module-attachments"
>
    <header id="module-attachments-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Attachments section"
           data-label-collapsed="Expand Attachments section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-attachments-content"
             aria-expanded="true"
             aria-labeledby="module-attachments-title"
             aria-describedby="module-attachments-subtitle"></div>
        <h2 class="module-title" id="module-attachments-title">Attachments</h2>
          <h3 class="module-subtitle" id="module-attachments-subtitle">
            (2 files, 4 obsolete files)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-attachments-content"
  ><table role="table" class="layout-table" id="attachments">
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8931902">WIP patch covering WebRequest and ContentScripts</a>
        </div>
        <div>
            <a href="#c22" class="attach-time activity-ref"><span class="rel-time" title="2017-11-25 18:39 PST" data-time="1511663983">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_563455" ><a class="email " href="/user_profile?user_id=563455" > <span class="fna">Jonathan Kingston [:jkt] he/him</span></a>
</div></span>
        </div>
        <div class="attach-info">3.33 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8931902&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8931902&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1415644&attachment=8931902">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8949037">bug-1415644.patch</a>
        </div>
        <div>
            <a href="#c27" class="attach-time activity-ref"><span class="rel-time" title="2018-02-07 07:54 PST" data-time="1518018878">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_563455" ><a class="email " href="/user_profile?user_id=563455" > <span class="fna">Jonathan Kingston [:jkt] he/him</span></a>
</div></span>
        </div>
        <div class="attach-info">5.59 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8949037&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8949037&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1415644&attachment=8949037">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8951578">bug-1415644-b.patch</a>
        </div>
        <div>
            <a href="#c35" class="attach-time activity-ref"><span class="rel-time" title="2018-02-16 06:00 PST" data-time="1518789640">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_563455" ><a class="email " href="/user_profile?user_id=563455" > <span class="fna">Jonathan Kingston [:jkt] he/him</span></a>
</div></span>
        </div>
        <div class="attach-info">8.51 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8951578&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8951578&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1415644&attachment=8951578">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8955841">Create a list of restricted domains</a>
        </div>
        <div>
            <a href="#c40" class="attach-time activity-ref"><span class="rel-time" title="2018-03-03 16:30 PST" data-time="1520123414">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_106098" ><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div></span>
        </div>
        <div class="attach-info">14.45 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8955841&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8955841&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1415644&attachment=8955841">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8955844">Create a list of restricted domains</a>
        </div>
        <div>
            <a href="#c41" class="attach-time activity-ref"><span class="rel-time" title="2018-03-03 17:58 PST" data-time="1520128694">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_106098" ><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div></span>
        </div>
        <div class="attach-info">15.12 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_561655" ><span class="fn">aswan</span>
</div>:
              <a href="#c44"
                  class="flag-name-status rel-time-title activity-ref"
                  title="4 years ago"
              data-time="1520128694"
            >
              review-</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8955844&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8955844&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1415644&attachment=8955844">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8956152">Create a list of restricted domains</a>
        </div>
        <div>
            <a href="#c47" class="attach-time activity-ref"><span class="rel-time" title="2018-03-05 10:30 PST" data-time="1520274649">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_106098" ><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div></span>
        </div>
        <div class="attach-info">15.13 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_561655" ><span class="fn">aswan</span>
</div>:
              <a href="#c54"
                  class="flag-name-status rel-time-title activity-ref"
                  title="4 years ago"
              data-time="1520274649"
            >
              review+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_372685" ><span class="fn">mixedpuppy</span>
</div>:
              <a href="#c53"
                  class="flag-name-status rel-time-title activity-ref"
                  title="4 years ago"
              data-time="1520274649"
            >
              review+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_280903" ><span class="fn">abillings</span>
</div>:
              <a href="#c57"
                  class="flag-name-status rel-time-title activity-ref"
                  title="4 years ago"
              data-time="1520384572"
            >
              sec-approval+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8956152&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8956152&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1415644&attachment=8956152">Splinter Review</a>
    </tr>
</table>

<footer id="attachments-footer">
  <div id="attachments-actions">
      <button type="button" id="attachments-obsolete-btn" class="secondary">Show Obsolete</button>
  </div>
  
</footer>
  </div>
</section>



<script nonce="IIM86OxCgGnNMjoRhTQ5eynQWMs37kbTF3cErcYznFij1a3w">
  init_module_visibility();
</script>



<meta name="firefox-versions" content="{&quot;FIREFOX_AURORA&quot;:&quot;&quot;,&quot;FIREFOX_DEVEDITION&quot;:&quot;94.0b9&quot;,&quot;FIREFOX_ESR&quot;:&quot;78.15.0esr&quot;,&quot;FIREFOX_ESR_NEXT&quot;:&quot;91.2.0esr&quot;,&quot;FIREFOX_NIGHTLY&quot;:&quot;95.0a1&quot;,&quot;FIREFOX_PINEBUILD&quot;:&quot;&quot;,&quot;LAST_MERGE_DATE&quot;:&quot;2021-10-04&quot;,&quot;LAST_RELEASE_DATE&quot;:&quot;2021-10-05&quot;,&quot;LAST_SOFTFREEZE_DATE&quot;:&quot;2021-09-30&quot;,&quot;LATEST_FIREFOX_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_OLDER_VERSION&quot;:&quot;3.6.28&quot;,&quot;LATEST_FIREFOX_RELEASED_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_VERSION&quot;:&quot;93.0&quot;,&quot;NEXT_MERGE_DATE&quot;:&quot;2021-11-01&quot;,&quot;NEXT_RELEASE_DATE&quot;:&quot;2021-11-02&quot;,&quot;NEXT_SOFTFREEZE_DATE&quot;:&quot;2021-10-28&quot;}">


<div id="comment-actions">
    <button type="button" id="bottom-btn" class="secondary" aria-label="Go to Page Bottom">Bottom &darr;</button>
  <div class="dropdown">
    <button type="button" id="comment-tags-btn" aria-haspopup="true" aria-label="Tags"
      aria-expanded="false" aria-controls="comment-tags-menu" class="dropdown-button minor">Tags &#9662;</button>
    <ul id="comment-tags-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a role="menuitem" tabindex="-1" data-comment-tag="">Reset</a>
      </li>
    </ul>
  </div>
  <div class="dropdown">
    <button type="button" id="view-menu-btn" aria-haspopup="true" aria-label="Timeline"
      aria-expanded="false" aria-controls="view-menu" class="dropdown-button minor">Timeline &#9662;</button>
    <ul id="view-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a id="view-reset" role="menuitem" tabindex="-1">Reset</a>
      </li>
      <li role="separator"></li>
      <li role="presentation">
        <a id="view-collapse-all" role="menuitem" tabindex="-1">Collapse All</a>
      </li>
      <li role="presentation">
        <a id="view-expand-all" role="menuitem" tabindex="-1">Expand All</a>
      </li>
      <li role="presentation">
        <a id="view-comments-only" role="menuitem" tabindex="-1">Comments Only</a>
      </li>
    </ul>
   </div>
</div>
<div class="change-set" id="c0"><div class="comment" data-id="12828402" data-no="0"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-0" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_397635" ><img src="https://secure.gravatar.com/avatar/4ae11454315077053052b613d6d77241?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_397635" ><a class="email " href="/user_profile?user_id=397635" > <span class="fna">Andy McKay</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-0"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-0" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c0">Description</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-08 10:54 PST" data-time="1510167292">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-0">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-0" data-comment-id="12828402">Currently WebExtensions can attach content scripts to accounts.firefox.com and listen to traffic using the webRequest API. That means an extension could intercept your user name and password for that site.

If an extension did that, then the argument is that then the extension would have access to all the data stored in the sync backend. That might be your complete browsing history, for example.

To do this an extension needs to ask for permission to accounts.firefox.com specifically, or &lt;all_urls&gt;. We are potentially asking the user to make the leap that access to &lt;all_urls&gt; might mean &quot;all my browsing history&quot; I've synced.

The developer could get access to this by asking for the history API, for example, but that warns the user (hopefully clearly) that they've asked for this.

This assumes that getting access to accounts.firefox.com means that a malicious extension can get access to the browsing history... so cc'ing rkelly for that. Pinging jkt for the security view of this.</pre></div><div class="change-set" id="c1"><div class="comment" data-id="12828542" data-no="1"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-1" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_424102" ><img src="https://secure.gravatar.com/avatar/7ad57e27678b3a70d05e9c3fb1af123e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_424102" ><a class="email " href="/user_profile?user_id=424102" > <span class="fna">Ryan Kelly [:rfkelly]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-1"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-1" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c1">Comment 1</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-08 11:34 PST" data-time="1510169652">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-1">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-1" data-comment-id="12828542"><span class="quote">&gt; listen to traffic using the webRequest API [...] intercept your user name and password for that site</span >

To be clear, the password doesn't transit the wire in plaintext, they'd have to get it directly out of the password field in the DOM.</pre></div><div class="change-set" id="c2"><div class="comment" data-id="12828569" data-no="2"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-2" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_458547" ><img src="https://secure.gravatar.com/avatar/5f78e966c62b36f255bd667054fa7be3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_458547" ><a class="email " href="/user_profile?user_id=458547" > <span class="fna">Chris Karlof [:ckarlof]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-2"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-2" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c2">Comment 2</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-08 11:44 PST" data-time="1510170253">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-2">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-2" data-comment-id="12828569">(In reply to Ryan Kelly [:rfkelly] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Should extensions get access to accounts.firefox.com"
   href="/show_bug.cgi?id=1415644#c1">comment #1</a>)
<span class="quote">&gt; &gt; listen to traffic using the webRequest API [...] intercept your user name and password for that site
&gt; 
&gt; To be clear, the password doesn't transit the wire in plaintext, they'd have
&gt; to get it directly out of the password field in the DOM.</span >

But intercepting what's on the wire is sufficient to login to the user's account and run cracking attacks if they've chosen a weak password.</pre></div><div class="change-set" id="c3"><div class="comment" data-id="12828597" data-no="3"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-3" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_458547" ><img src="https://secure.gravatar.com/avatar/5f78e966c62b36f255bd667054fa7be3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_458547" ><a class="email " href="/user_profile?user_id=458547" > <span class="fna">Chris Karlof [:ckarlof]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-3"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-3" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c3">Comment 3</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-08 11:48 PST" data-time="1510170511">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-3">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-3" data-comment-id="12828597">Wennie, it would be helpful to have some input from you or someone on your team to provide a product security POV on this concern. 

Dan, I'm curious about your thoughts as well.</pre><div class="activity"><div class="change">Flags: needinfo?(wleung)</div><div class="change">Flags: needinfo?(dveditz)</div></div></div><div class="change-set" id="a4125_424102"><div class="change" id="aa4125_424102">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_424102" id="a4125_424102"><img src="https://secure.gravatar.com/avatar/7ad57e27678b3a70d05e9c3fb1af123e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_424102" id="a4125_424102"><a class="email " href="/user_profile?user_id=424102" > <span class="fna">Ryan Kelly [:rfkelly]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a4125_424102"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a4125_424102">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#a4125_424102">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-08 12:03 PST" data-time="1510171417">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">See Also:  &rarr; <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Consider preventing Web Extensions interacting with privileged Firefox web URLs"
   href="/show_bug.cgi?id=1361953">1361953</a></div></div></div><div class="change-set" id="c4"><div class="comment" data-id="12828656" data-no="4"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-4" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_561655" id="a4125_424102"><img src="https://secure.gravatar.com/avatar/2826368a4269673211a6539a73e9a056?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_561655" id="a4125_424102"><a class="email " href="/user_profile?user_id=561655" > <span class="fna">Andrew Swan [:aswan]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-4"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-4" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c4">Comment 4</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-08 12:04 PST" data-time="1510171492">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-4">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-4" data-comment-id="12828656">Note that extensions aren't the same as packet sniffers, they can use requestBody to get the unencrypted payload of a POST.
But ... an extension can do the same on google.com or facebook.com or whatever to swipe other valuable credentials.  I don't think we should treat something differently just because we operate it unless we have a really specific and compelling reason to do so.</pre></div><div class="change-set" id="c5"><div class="comment" data-id="12828771" data-no="5"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-5" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_397635" id="a4125_424102"><img src="https://secure.gravatar.com/avatar/4ae11454315077053052b613d6d77241?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_397635" id="a4125_424102"><a class="email " href="/user_profile?user_id=397635" > <span class="fna">Andy McKay</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-5"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-5" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c5">Comment 5</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-08 13:02 PST" data-time="1510174928">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-5">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-5" data-comment-id="12828771">Just to check, I found I couldn't examine the requests made by the sync process to the server using webRequest. We specifically made the decision that system requests are not examinable by webRequest in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - chrome.webRequest events have not occur with service request, but it is not documented"
   href="/show_bug.cgi?id=1279371">bug 1279371</a> and others. However if I open a tab to accounts.firefox.com, or go to about:preferences#sync and sign in, the traffic is observable in webRequest.

The argument here, is that the storing of all your history and bookmarks on a Mozilla server is a feature of Firefox. And hence different from Google or Facebook.</pre></div><div class="change-set" id="c6"><div class="comment" data-id="12829091" data-no="6"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-6" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_424102" id="a4125_424102"><img src="https://secure.gravatar.com/avatar/7ad57e27678b3a70d05e9c3fb1af123e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_424102" id="a4125_424102"><a class="email " href="/user_profile?user_id=424102" > <span class="fna">Ryan Kelly [:rfkelly]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-6"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-6" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c6">Comment 6</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-08 14:52 PST" data-time="1510181558">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-6">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-6" data-comment-id="12829091">I feel like we had an older bug where some of this stuff was discussed; :vladikoff do you recall?

The counterpoint is that users might reasonably expect e.g. a password-manager addon to work correctly on accounts.firefox.com, and I don't know whether we can enumerate a set of &quot;safe&quot; capabilities to expose that would allow this, without allowing more general access.</pre><div class="activity"><div class="change">Flags: needinfo?(vlad)</div></div></div><div class="change-set" id="c7"><div class="comment" data-id="12829413" data-no="7"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-7" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_563455" id="a4125_424102"><img src="https://secure.gravatar.com/avatar/b098cf1c5ba7a0c3bc3e85e979be4a2e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_563455" id="a4125_424102"><a class="email " href="/user_profile?user_id=563455" > <span class="fna">Jonathan Kingston [:jkt] he/him</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-7"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-7" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c7">Comment 7</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-08 17:06 PST" data-time="1510189572">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-7">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-7" data-comment-id="12829413">I don't know all the capabilities of accounts.firefox.com but here is what I know:

It has the following I do know of:
- Info:
 - Username, password
 - Other info: picture etc
 - Devices linked
- Delete account

Which aren't problematic really other than annoying if exploited.

However given an extension could sniff credentials, then use these to modify what extensions a user has installed on sync. This would be considered an escape hatch on the current permission model.

I would personally suggest this should be restricted unless we have a clear use-case for not.
Even then I would suggest having a new keyword for restricted urls like: &lt;possibly_insecure&gt; which initially could be used internally by Mozilla signed extensions.

<span class="quote">&gt; I don't know whether we can enumerate a set of &quot;safe&quot; capabilities to expose that would allow this, without allowing more general access.</span >

I don't think there is an alternative here either.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(wleung)</span></div></div></div><div class="change-set" id="c8"><div class="comment" data-id="12829454" data-no="8"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-8" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_424102" id="a4125_424102"><img src="https://secure.gravatar.com/avatar/7ad57e27678b3a70d05e9c3fb1af123e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_424102" id="a4125_424102"><a class="email " href="/user_profile?user_id=424102" > <span class="fna">Ryan Kelly [:rfkelly]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-8"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-8" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c8">Comment 8</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-08 17:33 PST" data-time="1510191218">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-8">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-8" data-comment-id="12829454"><span class="quote">&gt; However given an extension could sniff credentials, then use these to modify what extensions a user has installed on sync.</span >

Oh yes, this is a really good point that I frequently forget about: if you can write data into sync for a user, you can change their list of synced addons, causing new webextensions to be installed.</pre></div><div class="change-set" id="c9"><div class="comment" data-id="12832397" data-no="9"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-9" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_397635" id="a4125_424102"><img src="https://secure.gravatar.com/avatar/4ae11454315077053052b613d6d77241?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_397635" id="a4125_424102"><a class="email " href="/user_profile?user_id=397635" > <span class="fna">Andy McKay</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-9"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-9" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c9">Comment 9</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-09 14:33 PST" data-time="1510266808">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-9">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-9" data-comment-id="12832397">Installing potentially malicious addon X to force an install of potentially malicious addon Y isn't that useful. Do the malicious work in addon X instead. 

If I had access to your sync data, I'd look for the bookmark that points to your bank and rewrite it to my phishing site instead.</pre></div><div class="change-set" id="a99527_397635"><div class="change" id="aa99527_397635">
    <table class="layout-table change-head reporter" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_397635" id="a99527_397635"><img src="https://secure.gravatar.com/avatar/4ae11454315077053052b613d6d77241?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_397635" id="a99527_397635"><a class="email " href="/user_profile?user_id=397635" > <span class="fna">Andy McKay</span></a>
</div>
            <span class="user-role">Reporter</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a99527_397635"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a99527_397635">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#a99527_397635">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-09 14:33 PST" data-time="1510266819">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox57&amp;o1=isnotempty">status-firefox57</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox57&amp;o1=equals&amp;v1=wontfix">wontfix</a></div></div></div><div class="change-set" id="c10"><div class="comment" data-id="12832486" data-no="10"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-10" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_563455" id="a99527_397635"><img src="https://secure.gravatar.com/avatar/b098cf1c5ba7a0c3bc3e85e979be4a2e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_563455" id="a99527_397635"><a class="email " href="/user_profile?user_id=563455" > <span class="fna">Jonathan Kingston [:jkt] he/him</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-10"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-10" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c10">Comment 10</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-09 15:12 PST" data-time="1510269153">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-10">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-10" data-comment-id="12832486"><span class="quote">&gt; Installing potentially malicious addon X to force an install of potentially malicious addon Y isn't that useful. Do the malicious work in addon X instead. </span >

- I could ask for only *.firefox.com and gain any permission without ever asking for it
  - Native messaging, &lt;all_urls&gt;, proxy are the areas I was thinking of
  - I could replace existing extensions with fake ones too
- I suspect this exploit could be done with just active tab too

<span class="quote">&gt; bookmark that points to your bank and rewrite it to my phishing site instead.</span >

Arguably, if we don't trust users are checking permissions then an extension could do this also with &quot;bookmarks&quot; and &quot;history&quot; too.</pre></div><div class="change-set" id="c11"><div class="comment" data-id="12832568" data-no="11"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-11" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_397635" id="a99527_397635"><img src="https://secure.gravatar.com/avatar/4ae11454315077053052b613d6d77241?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_397635" id="a99527_397635"><a class="email " href="/user_profile?user_id=397635" > <span class="fna">Andy McKay</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-11"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-11" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c11">Comment 11</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-09 15:49 PST" data-time="1510271392">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-11">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-11" data-comment-id="12832568"><span class="quote">&gt; Arguably, if we don't trust users are checking permissions then an extension
&gt; could do this also with &quot;bookmarks&quot; and &quot;history&quot; too.</span >

Let's not make the assumption that users aren't reading the permissions because then everything is moot and we can all just go home, or to the pub.</pre></div><div class="change-set" id="c12"><div class="comment" data-id="12832689" data-no="12"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-12" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_563455" id="a99527_397635"><img src="https://secure.gravatar.com/avatar/b098cf1c5ba7a0c3bc3e85e979be4a2e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_563455" id="a99527_397635"><a class="email " href="/user_profile?user_id=563455" > <span class="fna">Jonathan Kingston [:jkt] he/him</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-12"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-12" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c12">Comment 12</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-09 17:00 PST" data-time="1510275636">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-12">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-12" data-comment-id="12832689"><span class="quote">&gt; Let's not make the assumption that users aren't reading the permissions because then everything is moot</span >

I agree, I was inferring this from your previous statement:

<span class="quote">&gt; Installing potentially malicious addon X to force an install of potentially malicious addon Y isn't that useful. Do the malicious work in addon X instead. </span >

If a user is checking the permissions they would see &quot;active tab&quot; permissions requested which results in their whole history/bookmarks/addons compromised.

I think we are in agreement here that this should be blocked.</pre></div><div class="change-set" id="c13"><div class="comment" data-id="12833508" data-no="13"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-13" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_434339" id="a99527_397635"><img src="https://secure.gravatar.com/avatar/9a0a16bc1cb5b0144e373deb8e357804?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_434339" id="a99527_397635"><a class="email disabled" href="/user_profile?user_id=434339" > <span class="fna">Paul Theriault [:pauljt] (no longer reading bugmail)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-13"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-13" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c13">Comment 13</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-10 01:43 PST" data-time="1510307029">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-13">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-13" data-comment-id="12833508">In hindsight, I really should have made <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Consider preventing Web Extensions interacting with privileged Firefox web URLs"
   href="/show_bug.cgi?id=1361953">bug 1361953</a> a higher risk or chased this more -  I was very surprised that it was still open, I thought we had found a clear resolution there. But on reflection, this isn't an easy problem to solve.

We need to do something here and it needs to be holistic. I've been doing some testing of accounts.ifirefox.com with an extensions with the &lt;all_urls&gt;, webRequest &amp; webRequestBlocking permissions. With these three, a malicious extension can (for example):

* remove the CSP for accounts.ifirefox.com
* use location: to redirect resources (this would allow redirection of script resources, were it not for SRI)
* read the Authorization header on API requests (and thus spoof sync API requests)
* set fake CORS header so that accounts can be scraped (don't think that gives much in this case)

I'm worried we are just going to end up playing whack-a-mole here though. For example, consider all of the following which can be intercepted currently:
sync.services.mozilla.com
addons.cdn.mozilla.net
accounts-static.cdn.mozilla.net
api.accounts.firefox.com
oauth.accounts.firefox.com
profile.accounts.firefox.com
... etc

This seems like a problem waiting to happen. I at a bit of a loss on how to approach this, since I am not aware of a canonical list of subdomains and services that we need to protect here. And then what about services added in the future? I'm going to continue testing, and also talk to the folks (ekr and ckershb) who are looking at rationalise the privileges in Firefox front-end. 

But if anyone can add more information here, i'm all ears.</pre><div class="activity"><div class="change">Flags: needinfo?(ptheriault)</div></div></div><div class="change-set" id="c14"><div class="comment" data-id="12834295" data-no="14"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-14" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_481559" id="a99527_397635"><img src="https://secure.gravatar.com/avatar/13b097b3a9dfacddbda2dff787593452?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_481559" id="a99527_397635"><a class="email " href="/user_profile?user_id=481559" > <span class="fna">Vlad Filippov (:vladikoff)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-14"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-14" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c14">Comment 14</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-10 07:12 PST" data-time="1510326743">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-14">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-14" data-comment-id="12834295">(In reply to Ryan Kelly [:rfkelly] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Should extensions get access to accounts.firefox.com"
   href="/show_bug.cgi?id=1415644#c6">comment #6</a>)
<span class="quote">&gt; I feel like we had an older bug where some of this stuff was discussed;
&gt; :vladikoff do you recall?
&gt; 
&gt; The counterpoint is that users might reasonably expect e.g. a
&gt; password-manager addon to work correctly on accounts.firefox.com, and I
&gt; don't know whether we can enumerate a set of &quot;safe&quot; capabilities to expose
&gt; that would allow this, without allowing more general access.</span >

Maybe this: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - ff fails to remember login for accounts.firefox.com"
   href="/show_bug.cgi?id=1258135">https://bugzilla.mozilla.org/show_bug.cgi?id=1258135</a> but there could more. 

There was a related bug to this about content scripts also: `chrome:// scripts can be injected into accounts.firefox.com and are ignored by CSP rules` AKA <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED"
   href="/show_bug.cgi?id=1345210">https://bugzilla.mozilla.org/show_bug.cgi?id=1345210</a></pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(vlad)</span></div></div></div><div class="change-set" id="c15"><div class="comment" data-id="12835713" data-no="15"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-15" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a99527_397635"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a99527_397635"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-15"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-15" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c15">Comment 15</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-10 20:42 PST" data-time="1510375333">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-15">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-15" data-comment-id="12835713">(In reply to Chris Karlof [:ckarlof] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Should extensions get access to accounts.firefox.com"
   href="/show_bug.cgi?id=1415644#c3">comment #3</a>)
<span class="quote">&gt; Dan, I'm curious about your thoughts as well.</span >

This is one of the downsides of using website UI rather than building it into the client (even if the implementation does an XHR/fetch and builds the UI client-side). We can protect special pages like about: from web extensions (but not from legacy add-ons, of course). See <a class="bz_bug_link
          bz_status_NEW"
   title="NEW - New Sync should have an option to encrypt data with a secret that's not used for anything else and never entered into a Web page"
   href="/show_bug.cgi?id=1034526">bug 1034526</a> and bugs duped to it.

We have the same problem with AMO. On the one had it's a website and it looks bad to prevent extensions from &quot;enhancing&quot; it like any other site (&quot;favoritism!!&quot;). On the other hand the original favoritism sin was giving that site extra powers in the first place, so that extensions abusing it were much worse than abusing a regular web page. We've really got to stop giving our own web pages magic powers.

Two bad choices: prevent legit extensions from doing helpful stuff on that site, or live with normal extensions (asking to modify all pages is common) having much more actual power than they realize. Given the choice I'd block extensions from mucking with FxA pages. When enough people complain that it's worth rewriting that functionality to have less power then we can unblock it.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(dveditz)</span></div></div></div><div class="change-set" id="c16"><div class="comment" data-id="12835737" data-no="16"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-16" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_561655" id="a99527_397635"><img src="https://secure.gravatar.com/avatar/2826368a4269673211a6539a73e9a056?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_561655" id="a99527_397635"><a class="email " href="/user_profile?user_id=561655" > <span class="fna">Andrew Swan [:aswan]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-16"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-16" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c16">Comment 16</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-10 21:24 PST" data-time="1510377890">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-16">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-16" data-comment-id="12835737">(In reply to Daniel Veditz [:dveditz] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Should extensions get access to accounts.firefox.com"
   href="/show_bug.cgi?id=1415644#c15">comment #15</a>)
<span class="quote">&gt; We've really got to stop
&gt; giving our own web pages magic powers.</span >

accounts.firefox.com does have access to webChannels but note that the main &quot;attack&quot; described in this bug is stealing credentials from the login page on accounts.firefox.com, which would be an issue even if webChannels were stripped away.</pre></div><div class="change-set" id="c17"><div class="comment" data-id="12836836" data-no="17"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-17" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_424102" id="a99527_397635"><img src="https://secure.gravatar.com/avatar/7ad57e27678b3a70d05e9c3fb1af123e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_424102" id="a99527_397635"><a class="email " href="/user_profile?user_id=424102" > <span class="fna">Ryan Kelly [:rfkelly]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-17"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-17" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c17">Comment 17</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-12 16:43 PST" data-time="1510533816">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-17">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-17" data-comment-id="12836836"><span class="quote">&gt; accounts.firefox.com does have access to webChannels but note that the main &quot;attack&quot; described
&gt; in this bug is stealing credentials from the login page on accounts.firefox.com, which would
&gt; be an issue even if webChannels were stripped away.</span >

The inverse attack is also possible, a kind of login fixation: a malicious addon could inject scripts into accounts.firefox.com, fire some webchannel messages to sign the browser in to sync with an account under the attacker's control, and then snoop on whatever data the victim's browser syncs to that account.</pre></div><div class="change-set" id="c18"><div class="comment" data-id="12836845" data-no="18"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-18" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_424102" id="a99527_397635"><img src="https://secure.gravatar.com/avatar/7ad57e27678b3a70d05e9c3fb1af123e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_424102" id="a99527_397635"><a class="email " href="/user_profile?user_id=424102" > <span class="fna">Ryan Kelly [:rfkelly]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-18"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-18" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c18">Comment 18</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-12 16:57 PST" data-time="1510534627">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-18">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-18" data-comment-id="12836845">It's also worth considering explicitly: what measures, if any, does Google take to prevent a Chrome extension from stealing your Google account password?  I wasn't able to find any explicit information on this topic from a bit of searching around.</pre></div><div class="change-set" id="c19"><div class="comment" data-id="12840757" data-no="19"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-19" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_458547" id="a99527_397635"><img src="https://secure.gravatar.com/avatar/5f78e966c62b36f255bd667054fa7be3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_458547" id="a99527_397635"><a class="email " href="/user_profile?user_id=458547" > <span class="fna">Chris Karlof [:ckarlof]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-19"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-19" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c19">Comment 19</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-13 14:12 PST" data-time="1510611128">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-19">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-19" data-comment-id="12840757">In the past they haven't, but I haven't checked recently. One consequence of preventing add-on access to accounts.firefox.com is that third-party password managers would not be able to automatically capture and fill on accounts.firefox.com. 

My motivator for originally raising this with Andy was this update: <a rel="nofollow" href="https://dev.chromium.org/Home/chromium-security/quarterly-updates">https://dev.chromium.org/Home/chromium-security/quarterly-updates</a>

Site Isolation
&quot;Running an experiment in M63 to give process isolation to accounts.google.com, to improve Chrome Signin security.&quot;

Granted, it's not this issue exactly, but it made me think about what isolation we maybe should be providing in Firefox for Firefox Accounts that we're currently not.</pre></div><div class="change-set" id="c20"><div class="comment" data-id="12849940" data-no="20"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-20" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_397635" id="a99527_397635"><img src="https://secure.gravatar.com/avatar/4ae11454315077053052b613d6d77241?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_397635" id="a99527_397635"><a class="email " href="/user_profile?user_id=397635" > <span class="fna">Andy McKay</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-20"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-20" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c20">Comment 20</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-16 11:58 PST" data-time="1510862309">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-20">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-20" data-comment-id="12849940">It sounds like the main loss here is losing the ability for password managers to help with the Firefox Account login. At this point I think that's probably worth the loss in functionality for the possible security problems that could result. Marking as a P2 and we'll aim to get this done in the 59 or 60 cycle (more likely 60 at this point). If anyone has any concerns that about, please let me know.</pre><div class="activity"><div class="change">Priority: -- &rarr; P2</div></div></div><div class="change-set" id="c21"><div class="comment" data-id="12851343" data-no="21"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-21" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_434339" id="a99527_397635"><img src="https://secure.gravatar.com/avatar/9a0a16bc1cb5b0144e373deb8e357804?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_434339" id="a99527_397635"><a class="email disabled" href="/user_profile?user_id=434339" > <span class="fna">Paul Theriault [:pauljt] (no longer reading bugmail)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-21"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-21" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c21">Comment 21</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-16 23:08 PST" data-time="1510902487">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-21">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-21" data-comment-id="12851343">So what are you explicitly planning to do here? Note that just blocking accounts.mozilla.com is not enough to mitigate risk here - we need to prevent access to all the domains I mentioned in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Should extensions get access to accounts.firefox.com"
   href="/show_bug.cgi?id=1415644#c13">comment 13</a>, and probably others. If nothing else, the authorization header sent to sync.services.mozilla.com almost as sensitive as the user's password.

I don't have a canonical list currently, but I am working on a project with Christoph Kerschbaumer to try to enumerate all the semi-privileged origins in Firefox (included all the web pages with access to chrome features via various event/message passing APIs). Needinfo'ing myself to follow-up once we have that list.

I'm also wondering if WebRequest is the only threat here (cookies API? Others?)</pre></div><div class="change-set" id="c22"><div class="comment" data-id="12873011" data-no="22"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-22" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_563455" id="a99527_397635"><img src="https://secure.gravatar.com/avatar/b098cf1c5ba7a0c3bc3e85e979be4a2e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_563455" id="a99527_397635"><a class="email " href="/user_profile?user_id=563455" > <span class="fna">Jonathan Kingston [:jkt] he/him</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-22"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-22" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c22">Comment 22</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-25 18:39 PST" data-time="1511663983">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-22">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8931902"
         class="attachment patch obsolete"
         data-id="8931902" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug-1415644.patch">
      <meta itemprop="contentSize" content="3412">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8931902">
          <a class="link" href="attachment.cgi?id=8931902&amp;action=diff">
        <span id="att-8931902-description" itemprop="description">WIP patch covering WebRequest and ContentScripts</span></a> (obsolete)
        — <a href="attachment.cgi?id=8931902&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1415644&attachment=8931902">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-22" data-comment-id="12873011">The patch submitted creates a new list provided from these conversations however I think the controls of these functionality should be moved to:

<a rel="nofollow" href="https://dxr.mozilla.org/mozilla-central/source/browser/app/permissions">https://dxr.mozilla.org/mozilla-central/source/browser/app/permissions</a>

The problem being is some of these issues are just because they accept password input which doesn't have restricted APIs. This poses an issue in itself as we need to maintain this list somewhere as Paul mentioned.

Also this bug fixes an issue where &quot;privacy.resistFingerprinting.block_mozAddonManager&quot; actually allows content scripts on addons.mozilla.org due to the removal of the addon manager API.</pre></div><div class="change-set" id="c23"><div class="comment" data-id="12873020" data-no="23"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-23" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_563455" id="a99527_397635"><img src="https://secure.gravatar.com/avatar/b098cf1c5ba7a0c3bc3e85e979be4a2e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_563455" id="a99527_397635"><a class="email " href="/user_profile?user_id=563455" > <span class="fna">Jonathan Kingston [:jkt] he/him</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-23"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-23" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c23">Comment 23</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-11-25 18:59 PST" data-time="1511665167">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-23">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-23" data-comment-id="12873020"><span class="quote">&gt; I don't have a canonical list currently, but I am working on a project with Christoph Kerschbaumer to try to enumerate all the semi-privileged origins in Firefox (included all the web pages with access to chrome features via various event/message passing APIs). Needinfo'ing myself to follow-up once we have that list.</span >

It would be nice if we could unify this in the code somehow. The biggest problem I have with the patch above is it's a list that will get out of date easily.

If you have the ability to test some of the exploits you are worried about with that patch or provide some STRs this would be super helpful.

Do we also care about crash reporting being a vector here?</pre></div><div class="change-set" id="a2539646_434339"><div class="change" id="aa2539646_434339">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_434339" id="a2539646_434339"><img src="https://secure.gravatar.com/avatar/9a0a16bc1cb5b0144e373deb8e357804?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_434339" id="a2539646_434339"><a class="email disabled" href="/user_profile?user_id=434339" > <span class="fna">Paul Theriault [:pauljt] (no longer reading bugmail)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a2539646_434339"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a2539646_434339">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#a2539646_434339">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-12-07 20:22 PST" data-time="1512706938">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(ptheriault)</span></div></div></div><div class="change-set" id="c24"><div class="comment" data-id="12919487" data-no="24"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-24" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_434339" id="a2539646_434339"><img src="https://secure.gravatar.com/avatar/9a0a16bc1cb5b0144e373deb8e357804?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_434339" id="a2539646_434339"><a class="email disabled" href="/user_profile?user_id=434339" > <span class="fna">Paul Theriault [:pauljt] (no longer reading bugmail)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-24"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-24" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c24">Comment 24</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-12-14 17:12 PST" data-time="1513300331">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-24">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-24" data-comment-id="12919487">(In reply to Jonathan Kingston [:jkt] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Should extensions get access to accounts.firefox.com"
   href="/show_bug.cgi?id=1415644#c23">comment #23</a>)
<span class="quote">&gt; &gt; I don't have a canonical list currently, but I am working on a project with Christoph Kerschbaumer to try to enumerate all the semi-privileged origins in Firefox (included all the web pages with access to chrome features via various event/message passing APIs). Needinfo'ing myself to follow-up once we have that list.</span >

Re-adding this need-info

<span class="quote">&gt; 
&gt; It would be nice if we could unify this in the code somehow. The biggest
&gt; problem I have with the patch above is it's a list that will get out of date
&gt; easily.</span >

At a minimum we need a something configurable - I think the list of domains you have here should be a pref, that so we can maintain it without changing code. 

<span class="quote">&gt; 
&gt; If you have the ability to test some of the exploits you are worried about
&gt; with that patch or provide some STRs this would be super helpful.</span >

Well its not really exploits. It's just using the APIs as they are intended but on sensitive domains. The testing I have done so far has just been writing my own addons. But we really need automated tests to make sure we don't regress this. If you are asking  &quot;what are all the things we need to block?&quot; I will post that as an attachment, since I have a list but I dont think its complete yet (basically just from the security model: <a rel="nofollow" href="https://docs.google.com/document/d/1u3IoSbMlMts_dZYkbQEXYY2VNOewTinpXtFCeEYdboo/edit">https://docs.google.com/document/d/1u3IoSbMlMts_dZYkbQEXYY2VNOewTinpXtFCeEYdboo/edit</a>#) 

<span class="quote">&gt; 
&gt; Do we also care about crash reporting being a vector here?</span >

I don't know how this is related ? Oh you mean should we stop extensions messing with crash reports? Yes we should, but I think we already do. Im not sure what the terminology is but I believe all network request initiated from chrome bypass the WebRequest API. (I've heard these called 'system requests'</pre><div class="activity"><div class="change">Blocks: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - browser.devtools.inspectedWindow.eval isn't blocked on addons.mozilla.org"
   href="/show_bug.cgi?id=1425197">1425197</a></div><div class="change">Flags: needinfo?(ptheriault)</div></div></div><div class="change-set" id="c25"><div class="comment" data-id="12919500" data-no="25"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-25" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_434339" id="a2539646_434339"><img src="https://secure.gravatar.com/avatar/9a0a16bc1cb5b0144e373deb8e357804?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_434339" id="a2539646_434339"><a class="email disabled" href="/user_profile?user_id=434339" > <span class="fna">Paul Theriault [:pauljt] (no longer reading bugmail)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-25"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-25" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c25">Comment 25</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-12-14 17:37 PST" data-time="1513301865">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-25">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-25" data-comment-id="12919500">So as for a proposal I think we need a preference which contains a blacklist of semi-privileged domains which we want to forbid extensions to have access to. And then we need a consistent approach for forbid access. The APIs and features that I am aware that need to take these semi-privileged domains into account. ( Andrew, Kris, others, please review this, this is best effort from my understanding of the code that I have reviewed).

1. Manifest Attributes
 - Host Permissions
    - must no be able to request a URL that matches the blacklist [1]
    - &lt;all_urls&gt; must not include the blacklist

 - &quot;matches&quot; parameter of content_scripts manifest key must follow the same behavior as host permission 

2. APIs which respect host permissions (ie should not be allowed on blacklisted domain)
tabs.executeScript 
contentScripts.register 
WebRequest &amp; WebRequestBlocking 
cookies 
activeTab MUST NOT grant access on semi-privileged domains

3. Sensitive APIs which are currently an issue
Proxy API - this basically does the same thing as web request, but its not origin bound. 
Devtools - this currently can interact in a variety of ways including injecting script (see <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - browser.devtools.inspectedWindow.eval isn't blocked on addons.mozilla.org"
   href="/show_bug.cgi?id=1425197">bug 1425197</a>)





Devtools 


[1] Does installation reject an addon that requests a blacklisted domain, or just silently not grant permission?</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(ptheriault)</span></div></div></div><div class="change-set" id="a6746964_397635"><div class="change" id="aa6746964_397635">
    <table class="layout-table change-head reporter" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_397635" id="a6746964_397635"><img src="https://secure.gravatar.com/avatar/4ae11454315077053052b613d6d77241?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_397635" id="a6746964_397635"><a class="email " href="/user_profile?user_id=397635" > <span class="fna">Andy McKay</span></a>
</div>
            <span class="user-role">Reporter</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a6746964_397635"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a6746964_397635">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#a6746964_397635">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-25 13:04 PST" data-time="1516914256">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Assignee: nobody &rarr; jkt</div></div></div><div class="change-set" id="c26"><div class="comment" data-id="13024611" data-no="26"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-26" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_563455" id="a6746964_397635"><img src="https://secure.gravatar.com/avatar/b098cf1c5ba7a0c3bc3e85e979be4a2e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_563455" id="a6746964_397635"><a class="email " href="/user_profile?user_id=563455" > <span class="fna">Jonathan Kingston [:jkt] he/him</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-26"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-26" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c26">Comment 26</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-07 07:53 PST" data-time="1518018795">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-26">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-26" data-comment-id="13024611"><span class="quote">&gt; [1] Does installation reject an addon that requests a blacklisted domain, or just silently not grant permission?</span >

I think at least for now silently failing is fine. Especially as assume we decide mozilla.org or newsite.pocket.com is banned for extension compat, just breaking the script rather than breaking install is likely better.

I still have much more testing to do, we likely will want a test for each of these scenarios highlighted by Paul in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Should extensions get access to accounts.firefox.com"
   href="/show_bug.cgi?id=1415644#c25">Comment 25</a>.</pre></div><div class="change-set" id="c27"><div class="comment" data-id="13024617" data-no="27"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-27" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_563455" id="a6746964_397635"><img src="https://secure.gravatar.com/avatar/b098cf1c5ba7a0c3bc3e85e979be4a2e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_563455" id="a6746964_397635"><a class="email " href="/user_profile?user_id=563455" > <span class="fna">Jonathan Kingston [:jkt] he/him</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-27"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-27" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c27">Comment 27</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-07 07:54 PST" data-time="1518018878">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-27">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8949037"
         class="attachment patch obsolete"
         data-id="8949037" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug-1415644.patch">
      <meta itemprop="contentSize" content="5720">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8949037">
          <a class="link" href="attachment.cgi?id=8949037&amp;action=diff">
        <span id="att-8949037-description" itemprop="description">bug-1415644.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8949037&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1415644&attachment=8949037">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-27" data-comment-id="13024617">Uses a pref, needs more testing though.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8931902&amp;action=edit"
           title="WIP patch covering WebRequest and ContentScripts"
           class=""
        >Attachment #8931902</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="c28"><div class="comment" data-id="13025064" data-no="28"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-28" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_339062" id="a6746964_397635"><img src="https://secure.gravatar.com/avatar/cb15f57474d95eb43c5d903ae3fa34ae?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_339062" id="a6746964_397635"><a class="email " href="/user_profile?user_id=339062" > <span class="fna">Luca Greco [:rpl] [:luca] [:lgreco]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-28"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-28" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c28">Comment 28</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-07 09:46 PST" data-time="1518025581">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-28">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-28" data-comment-id="13025064">Hi Jonathan, for another bugzilla issue (which is listed in the ones blocked on this one) we going to introduce a similar check from privileged js code, do you mind to expose the new WebExtensionPolicy::IsRestrictedSite method also from the WebExtensionPolicy.webidl?
(as a side effect it would also allow to write unit tests for the WebExtensionPolicy::IsRestrictedSite method itself as an xpcshell test)</pre><div class="activity"><div class="change">Flags: needinfo?(jkt)</div></div></div><div class="change-set" id="c29"><div class="comment" data-id="13025327" data-no="29"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-29" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_563455" id="a6746964_397635"><img src="https://secure.gravatar.com/avatar/b098cf1c5ba7a0c3bc3e85e979be4a2e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_563455" id="a6746964_397635"><a class="email " href="/user_profile?user_id=563455" > <span class="fna">Jonathan Kingston [:jkt] he/him</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-29"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-29" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c29">Comment 29</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-07 10:40 PST" data-time="1518028806">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-29">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-29" data-comment-id="13025327">Sure will do that thanks, are you able to cc me to the blocking bugs too?</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(jkt)</span></div></div></div><div class="change-set" id="c30"><div class="comment" data-id="13027769" data-no="30"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-30" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_563455" id="a6746964_397635"><img src="https://secure.gravatar.com/avatar/b098cf1c5ba7a0c3bc3e85e979be4a2e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_563455" id="a6746964_397635"><a class="email " href="/user_profile?user_id=563455" > <span class="fna">Jonathan Kingston [:jkt] he/him</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-30"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-30" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c30">Comment 30</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-08 07:34 PST" data-time="1518104045">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-30">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-30" data-comment-id="13027769">Could I get access to those bugs too please? Thanks</pre><div class="activity"><div class="change">Flags: needinfo?(lgreco)</div></div></div><div class="change-set" id="c31"><div class="comment" data-id="13027784" data-no="31"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-31" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_339062" id="a6746964_397635"><img src="https://secure.gravatar.com/avatar/cb15f57474d95eb43c5d903ae3fa34ae?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_339062" id="a6746964_397635"><a class="email " href="/user_profile?user_id=339062" > <span class="fna">Luca Greco [:rpl] [:luca] [:lgreco]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-31"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-31" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c31">Comment 31</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-08 07:39 PST" data-time="1518104387">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-31">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-31" data-comment-id="13027784">Sure, I just added you in CC on both.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(lgreco)</span></div></div></div><div class="change-set" id="a7948328_1689"><div class="change" id="aa7948328_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a7948328_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a7948328_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a7948328_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a7948328_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#a7948328_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-08 10:47 PST" data-time="1518115620">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Keywords: <a href="/buglist.cgi?keywords=csectype-priv-escalation&amp;resolution=---">csectype-priv-escalation</a>, 
          
            <a href="/buglist.cgi?keywords=sec-high&amp;resolution=---">sec-high</a></div></div></div><div class="change-set" id="a7948487_1689"><div class="change" id="aa7948487_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a7948487_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a7948487_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a7948487_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a7948487_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#a7948487_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-08 10:49 PST" data-time="1518115779">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Duplicate of this bug: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE"
   href="/show_bug.cgi?id=1435937">1435937</a></div></div></div><div class="change-set" id="c33"><div class="comment" data-id="13028740" data-no="33"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-33" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_609840" id="a7948487_1689"><img src="https://secure.gravatar.com/avatar/db6a64cc30c2f86ed9e27fac09780a0f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_609840" id="a7948487_1689"><a class="email " href="/user_profile?user_id=609840" > <span class="fna">FLR</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-33"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-33" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c33">Comment 33</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-08 12:16 PST" data-time="1518120994">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-33">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-33" data-comment-id="13028740">Reviewing :jkt patch (<a rel="nofollow" href="https://bugzilla.mozilla.org/attachment.cgi?id=8949037&amp;action=diff">https://bugzilla.mozilla.org/attachment.cgi?id=8949037&amp;action=diff</a>) I could tell that it will not cover every cases. 

The problem is not limited to semi-privileged related to mozilla URL. It is related to any Firefox feature running in privileged mode that is performing actions based on the informations exchanged with a remote server. For example, one could set up its own Firefox Account Server. Applying the proposed patch will obviously no prevent an extension to eavesdrop or spoofing sync data with a privately owned server.

In short term it could do it to minimize risk but in the end another solution should be put inplace.

A solution that I could think of for long term is having a &quot;firefox privileged url&quot; type for preferences. Then extension limitations should be applied to every URL flagged as &quot;firefox privileged url&quot;. To enable this, one would have to go though all url used by privileged components to flag them as such.

Note: 
 - On a side note, considering introducing other types for preferences could be a good thng form a security perspective. For example, preference that are meant to have JSON in it could not be set to invalid JSON so that an attacker could exploit an error mishandling.</pre></div><div class="change-set" id="c34"><div class="comment" data-id="13029455" data-no="34"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-34" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_563455" id="a7948487_1689"><img src="https://secure.gravatar.com/avatar/b098cf1c5ba7a0c3bc3e85e979be4a2e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_563455" id="a7948487_1689"><a class="email " href="/user_profile?user_id=563455" > <span class="fna">Jonathan Kingston [:jkt] he/him</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-34"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-34" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c34">Comment 34</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-08 17:47 PST" data-time="1518140835">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-34">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-34" data-comment-id="13029455">FLR: That seems out of scope here, we aren't trying to catch all internal browser calls to third party URLs. Granted we might want to consider that for a different bug especially for Tor users wishing to ensure the browser can't be intercepted to other calls. My understanding is Browser context calls are restricted from extensions in most cases anyway.

The scope of this bug actually is more about non privileged calls from content pages to URLs that have more permissions within the browser via other means. So accounts.firefox.com can allow the extension to modify the users sync account and escalate privileges etc. Given we are now using the pref, if there is a way for a user to sync to a different URL, we could edit the pref within the browser too.</pre></div><div class="change-set" id="c35"><div class="comment" data-id="13047488" data-no="35"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-35" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_563455" id="a7948487_1689"><img src="https://secure.gravatar.com/avatar/b098cf1c5ba7a0c3bc3e85e979be4a2e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_563455" id="a7948487_1689"><a class="email " href="/user_profile?user_id=563455" > <span class="fna">Jonathan Kingston [:jkt] he/him</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-35"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-35" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c35">Comment 35</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-16 06:00 PST" data-time="1518789640">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-35">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8951578"
         class="attachment patch"
         data-id="8951578" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug-1415644-b.patch">
      <meta itemprop="contentSize" content="8714">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8951578">
          <a class="link" href="attachment.cgi?id=8951578&amp;action=diff">
        <span id="att-8951578-description" itemprop="description">bug-1415644-b.patch</span></a>
        — <a href="attachment.cgi?id=8951578&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1415644&attachment=8951578">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-35" data-comment-id="13047488">Hey so unfortunately I won't be able to continue to work on this, I wrapped up the patch so that I think it could be continued to work on or just merge as is.

There isn't as many tests as I would like here but it feels pretty urgent to cover all the cases that Paul highlighted.

I hit some road bumps that really slowed me down here:
- xpcshell tests I couldn't get to work with a different hostname (mozilla.org), I added a new identity but it didn't proxy locally as I would have expected elsewhere.
- The pref isn't live which perhaps isn't a problem in product, however it makes testing pretty hard.

I need to move onto something else but I want to ensure this doesn't bitrot. Even if this doesn't cover all cases I think the patch is worth dropping in given the risks here.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8949037&amp;action=edit"
           title="bug-1415644.patch"
           class=""
        >Attachment #8949037</a> -
        Attachment is obsolete: true</div><div class="change">Flags: needinfo?(wleung)</div><div class="change">
        <a href="/attachment.cgi?id=8951578&amp;action=edit"
           title="bug-1415644-b.patch"
           class=""
        >Attachment #8951578</a> -
        Flags: review?(lgreco)</div><div class="change">
        <a href="/attachment.cgi?id=8951578&amp;action=edit"
           title="bug-1415644-b.patch"
           class=""
        >Attachment #8951578</a> -
        Flags: review?(gijskruitbosch+bugs)</div></div></div><div class="change-set" id="c36"><div class="comment" data-id="13047797" data-no="36"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-36" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a7948487_1689"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a7948487_1689"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-36"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-36" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c36">Comment 36</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-16 07:29 PST" data-time="1518794946">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-36">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-36" data-comment-id="13047797">Comment on <span class=""><a href="/attachment.cgi?id=8951578" name="attach_8951578" title="bug-1415644-b.patch">attachment 8951578</a> <a href="/attachment.cgi?id=8951578&amp;action=edit" title="bug-1415644-b.patch">[details]</a> <a href="/attachment.cgi?id=8951578&amp;action=diff" title="bug-1415644-b.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1415644&amp;attachment=8951578'>[review]</a>
bug-1415644-b.patch

Review of <span class=""><a href="/attachment.cgi?id=8951578" name="attach_8951578" title="bug-1415644-b.patch">attachment 8951578</a> <a href="/attachment.cgi?id=8951578&amp;action=edit" title="bug-1415644-b.patch">[details]</a> <a href="/attachment.cgi?id=8951578&amp;action=diff" title="bug-1415644-b.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1415644&amp;attachment=8951578'>[review]</a>:
-----------------------------------------------------------------

I'm not a great reviewer for this, nor do I have cycles to drive this, unfortunately.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8951578&amp;action=edit"
           title="bug-1415644-b.patch"
           class=""
        >Attachment #8951578</a> -
        Flags: <span class="activity-deleted">review?(gijskruitbosch+bugs)</span></div></div></div><div class="change-set" id="a9458324_434339"><div class="change" id="aa9458324_434339">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_434339" id="a9458324_434339"><img src="https://secure.gravatar.com/avatar/9a0a16bc1cb5b0144e373deb8e357804?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_434339" id="a9458324_434339"><a class="email disabled" href="/user_profile?user_id=434339" > <span class="fna">Paul Theriault [:pauljt] (no longer reading bugmail)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a9458324_434339"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a9458324_434339">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#a9458324_434339">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-25 22:13 PST" data-time="1519625616">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Blocks: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED INVALID - Security review of logins API"
   href="/show_bug.cgi?id=1357856">1357856</a></div></div></div><div class="change-set" id="c37"><div class="comment" data-id="13076785" data-no="37"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-37" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_590996" id="a9458324_434339"><img src="https://secure.gravatar.com/avatar/a946517a395e2ca8571f711dfcae4134?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_590996" id="a9458324_434339"><a class="email " href="/user_profile?user_id=590996" > <span class="fna">Wennie</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-37"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-37" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c37">Comment 37</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-28 10:34 PST" data-time="1519842862">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-37">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-37" data-comment-id="13076785">Unfortunately, I don't have anyone who has the cycle to work on this.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(wleung)</span></div></div></div><div class="change-set" id="c38"><div class="comment" data-id="13077073" data-no="38"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-38" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_563455" id="a9458324_434339"><img src="https://secure.gravatar.com/avatar/b098cf1c5ba7a0c3bc3e85e979be4a2e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_563455" id="a9458324_434339"><a class="email " href="/user_profile?user_id=563455" > <span class="fna">Jonathan Kingston [:jkt] he/him</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-38"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-38" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c38">Comment 38</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-28 10:38 PST" data-time="1519843083">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-38">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-38" data-comment-id="13077073">Luca are you or someone from your team able to review this, I don't think there will be many nits with it.
It would have been good to get this into ESR given the risks here.

Thanks.</pre><div class="activity"><div class="change">Flags: needinfo?(lgreco)</div></div></div><div class="change-set" id="c39"><div class="comment" data-id="13077160" data-no="39"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-39" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_339062" id="a9458324_434339"><img src="https://secure.gravatar.com/avatar/cb15f57474d95eb43c5d903ae3fa34ae?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_339062" id="a9458324_434339"><a class="email " href="/user_profile?user_id=339062" > <span class="fna">Luca Greco [:rpl] [:luca] [:lgreco]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-39"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-39" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c39">Comment 39</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-28 10:54 PST" data-time="1519844054">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-39">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-39" data-comment-id="13077160">Comment on <span class=""><a href="/attachment.cgi?id=8951578" name="attach_8951578" title="bug-1415644-b.patch">attachment 8951578</a> <a href="/attachment.cgi?id=8951578&amp;action=edit" title="bug-1415644-b.patch">[details]</a> <a href="/attachment.cgi?id=8951578&amp;action=diff" title="bug-1415644-b.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1415644&amp;attachment=8951578'>[review]</a>
bug-1415644-b.patch

Kris is a great pick to review this patch, especially given that most of the changes are applied on WebExtensionPolicy and ChannelWrapper.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(lgreco)</span></div><div class="change">
        <a href="/attachment.cgi?id=8951578&amp;action=edit"
           title="bug-1415644-b.patch"
           class=""
        >Attachment #8951578</a> -
        Flags: review?(lgreco) &rarr; review?(kmaglione+bmo)</div></div></div><div class="change-set" id="c40"><div class="comment" data-id="13100834" data-no="40"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-40" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" id="a9458324_434339"><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_106098" id="a9458324_434339"><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-40"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-40" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c40">Comment 40</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-03-03 16:30 PST" data-time="1520123414">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-40">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8955841"
         class="attachment patch obsolete"
         data-id="8955841" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="base-b0b57f692ce2">
      <meta itemprop="contentSize" content="14792">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8955841">
          <a class="link" href="attachment.cgi?id=8955841&amp;action=diff">
        <span id="att-8955841-description" itemprop="description">Create a list of restricted domains</span></a> (obsolete)
        — <a href="attachment.cgi?id=8955841&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1415644&attachment=8955841">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-40" data-comment-id="13100834">MozReview-Commit-ID: A0AkaBG33In</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8955841&amp;action=edit"
           title="Create a list of restricted domains"
           class=""
        >Attachment #8955841</a> -
        Flags: review?(aswan)</div></div></div><div class="change-set" id="a9956125_106098"><div class="change" id="aa9956125_106098">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" id="a9956125_106098"><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_106098" id="a9956125_106098"><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a9956125_106098"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a9956125_106098">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#a9956125_106098">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-03-03 16:30 PST" data-time="1520123417">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Assignee: jkt &rarr; kmaglione+bmo</div><div class="change">Status: NEW &rarr; ASSIGNED</div></div></div><div class="change-set" id="c41"><div class="comment" data-id="13100892" data-no="41"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-41" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" id="a9956125_106098"><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_106098" id="a9956125_106098"><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-41"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-41" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c41">Comment 41</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-03-03 17:58 PST" data-time="1520128694">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-41">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8955844"
         class="attachment patch obsolete"
         data-id="8955844" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="base-b0b57f692ce2">
      <meta itemprop="contentSize" content="15484">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8955844">
          <a class="link" href="attachment.cgi?id=8955844&amp;action=diff">
        <span id="att-8955844-description" itemprop="description">Create a list of restricted domains</span></a> (obsolete)
        — <a href="attachment.cgi?id=8955844&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1415644&attachment=8955844">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-41" data-comment-id="13100892">MozReview-Commit-ID: A0AkaBG33In</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8955844&amp;action=edit"
           title="Create a list of restricted domains"
           class=""
        >Attachment #8955844</a> -
        Flags: review?(aswan)</div></div></div><div class="change-set" id="a9961411_106098"><div class="change" id="aa9961411_106098">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" id="a9961411_106098"><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_106098" id="a9961411_106098"><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a9961411_106098"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a9961411_106098">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#a9961411_106098">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-03-03 17:58 PST" data-time="1520128703">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8955841&amp;action=edit"
           title="Create a list of restricted domains"
           class=""
        >Attachment #8955841</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8955841&amp;action=edit"
           title="Create a list of restricted domains"
           class=""
        >Attachment #8955841</a> -
        Flags: <span class="activity-deleted">review?(aswan)</span></div></div></div><div class="change-set" id="a10064670_434339"><div class="change" id="aa10064670_434339">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_434339" id="a10064670_434339"><img src="https://secure.gravatar.com/avatar/9a0a16bc1cb5b0144e373deb8e357804?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_434339" id="a10064670_434339"><a class="email disabled" href="/user_profile?user_id=434339" > <span class="fna">Paul Theriault [:pauljt] (no longer reading bugmail)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a10064670_434339"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a10064670_434339">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#a10064670_434339">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-03-04 22:39 PST" data-time="1520231962">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Blocks: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED INVALID - extensions can inject script into addons.mozilla.org by modifying requests to www.google-analytics.com"
   href="/show_bug.cgi?id=1443073">1443073</a></div></div></div><div class="change-set" id="c42"><div class="comment" data-id="13103078" data-no="42"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-42" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_434339" id="a10064670_434339"><img src="https://secure.gravatar.com/avatar/9a0a16bc1cb5b0144e373deb8e357804?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_434339" id="a10064670_434339"><a class="email disabled" href="/user_profile?user_id=434339" > <span class="fna">Paul Theriault [:pauljt] (no longer reading bugmail)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-42"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-42" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c42">Comment 42</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-03-04 22:49 PST" data-time="1520232550">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-42">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-42" data-comment-id="13103078">See also 1443073 - we need to do something about google analytics, too right? No idea what though.</pre></div><div class="change-set" id="c43"><div class="comment" data-id="13103092" data-no="43"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-43" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" id="a10064670_434339"><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_106098" id="a10064670_434339"><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-43"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-43" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c43">Comment 43</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-03-04 23:01 PST" data-time="1520233307">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-43">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-43" data-comment-id="13103092">(In reply to Paul Theriault [:pauljt] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Should extensions get access to accounts.firefox.com"
   href="/show_bug.cgi?id=1415644#c42">comment #42</a>)
<span class="quote">&gt; See also 1443073 - we need to do something about google analytics, too
&gt; right? No idea what though.</span >

Do we?</pre></div><div class="change-set" id="c44"><div class="comment" data-id="13105475" data-no="44"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-44" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_561655" id="a10064670_434339"><img src="https://secure.gravatar.com/avatar/2826368a4269673211a6539a73e9a056?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_561655" id="a10064670_434339"><a class="email " href="/user_profile?user_id=561655" > <span class="fna">Andrew Swan [:aswan]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-44"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-44" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c44">Comment 44</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-03-05 10:00 PST" data-time="1520272828">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-44">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-44" data-comment-id="13105475">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8955844" name="attach_8955844" title="Create a list of restricted domains">attachment 8955844</a> <a href="/attachment.cgi?id=8955844&amp;action=edit" title="Create a list of restricted domains">[details]</a> <a href="/attachment.cgi?id=8955844&amp;action=diff" title="Create a list of restricted domains">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1415644&amp;attachment=8955844'>[review]</a>
Create a list of restricted domains

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8955844" name="attach_8955844" title="Create a list of restricted domains">attachment 8955844</a> <a href="/attachment.cgi?id=8955844&amp;action=edit" title="Create a list of restricted domains">[details]</a> <a href="/attachment.cgi?id=8955844&amp;action=diff" title="Create a list of restricted domains">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1415644&amp;attachment=8955844'>[review]</a>:
-----------------------------------------------------------------

Sorry for redirection but Shane should probably take a look at the webrequest bits.
This could use a test, as it is complete broken right now due to typo in the pref name...

Much more importantly though, is this really maintainable?  How are we going to keep this list updated?  Do new services that use Firefox accounts have to get a change to this pref shipped before they can be deployed?

::: toolkit/components/extensions/WebExtensionPolicy.cpp
&#64;&#64; +35,5 &#64;&#64;
<span class="quote">&gt;    &lt;body&gt;\n\
&gt;  &lt;/html&gt;&quot;;
&gt;  
&gt; +static const char kRestrictedDomainPref[] =
&gt; +  &quot;extensions.webextensions.identity.redirectDomain&quot;;</span >

redirectDomain -&gt; restrictedDomains</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8955844&amp;action=edit"
           title="Create a list of restricted domains"
           class=""
        >Attachment #8955844</a> -
        Flags: review?(aswan) &rarr; review-</div></div></div><div class="change-set" id="c45"><div class="comment" data-id="13105495" data-no="45"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-45" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" id="a10064670_434339"><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_106098" id="a10064670_434339"><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-45"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-45" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c45">Comment 45</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-03-05 10:06 PST" data-time="1520273217">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-45">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-45" data-comment-id="13105495">(In reply to Andrew Swan [:aswan] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Should extensions get access to accounts.firefox.com"
   href="/show_bug.cgi?id=1415644#c44">comment #44</a>)
<span class="quote">&gt; This could use a test, as it is complete broken right now due to typo in the
&gt; pref name...</span >

No tests for security bugs until they ship.

<span class="quote">&gt; Much more importantly though, is this really maintainable?  How are we going
&gt; to keep this list updated?  Do new services that use Firefox accounts have
&gt; to get a change to this pref shipped before they can be deployed?</span >

No idea.

<span class="quote">&gt; ::: toolkit/components/extensions/WebExtensionPolicy.cpp
&gt; &#64;&#64; +35,5 &#64;&#64;
&gt; &gt;    &lt;body&gt;\n\
&gt; &gt;  &lt;/html&gt;&quot;;
&gt; &gt;  
&gt; &gt; +static const char kRestrictedDomainPref[] =
&gt; &gt; +  &quot;extensions.webextensions.identity.redirectDomain&quot;;
&gt; 
&gt; redirectDomain -&gt; restrictedDomains</span >

wat... I have no idea how that got changed. It was definitely the right pref when I tested.</pre></div><div class="change-set" id="c46"><div class="comment" data-id="13105601" data-no="46"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-46" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_538805" id="a10064670_434339"><img src="https://secure.gravatar.com/avatar/9bd092443d615af36b31b04e81ad7806?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_538805" id="a10064670_434339"><a class="email disabled" href="/user_profile?user_id=538805" > <span class="fna">Ritu Kothari (:ritu) (Inactive, please n-i to RyanVM, jcristau, or pascal)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-46"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-46" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c46">Comment 46</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-03-05 10:25 PST" data-time="1520274300">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-46">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-46" data-comment-id="13105601">DDurst pinged me about this one. They'd like to see this fix land in ESR60. Adding a 60+ tracking flag to ensure it gets closer monitoring by relman team.</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox60&amp;o1=isnotempty">status-firefox60</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox60&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox60&amp;o1=isnotempty">tracking-firefox60</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox60&amp;o1=equals&amp;v1=%2B">+</a></div></div></div><div class="change-set" id="c47"><div class="comment" data-id="13105626" data-no="47"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-47" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" id="a10064670_434339"><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_106098" id="a10064670_434339"><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-47"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-47" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c47">Comment 47</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-03-05 10:30 PST" data-time="1520274649">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-47">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8956152"
         class="attachment patch"
         data-id="8956152" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="base-b0b57f692ce2">
      <meta itemprop="contentSize" content="15491">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8956152">
          <a class="link" href="attachment.cgi?id=8956152&amp;action=diff">
        <span id="att-8956152-description" itemprop="description">Create a list of restricted domains</span></a>
        — <a href="attachment.cgi?id=8956152&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1415644&attachment=8956152">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-47" data-comment-id="13105626">MozReview-Commit-ID: A0AkaBG33In</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8956152&amp;action=edit"
           title="Create a list of restricted domains"
           class=""
        >Attachment #8956152</a> -
        Flags: review?(mixedpuppy)</div><div class="change">
        <a href="/attachment.cgi?id=8956152&amp;action=edit"
           title="Create a list of restricted domains"
           class=""
        >Attachment #8956152</a> -
        Flags: review?(aswan)</div></div></div><div class="change-set" id="a10107363_106098"><div class="change" id="aa10107363_106098">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" id="a10107363_106098"><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_106098" id="a10107363_106098"><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a10107363_106098"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a10107363_106098">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#a10107363_106098">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-03-05 10:30 PST" data-time="1520274655">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8955844&amp;action=edit"
           title="Create a list of restricted domains"
           class=""
        >Attachment #8955844</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="c48"><div class="comment" data-id="13106076" data-no="48"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-48" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a10107363_106098"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a10107363_106098"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-48"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-48" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c48">Comment 48</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-03-05 12:19 PST" data-time="1520281166">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-48">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-48" data-comment-id="13106076">(In reply to Andrew Swan [:aswan] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Should extensions get access to accounts.firefox.com"
   href="/show_bug.cgi?id=1415644#c44">comment #44</a>)
<span class="quote">&gt; Much more importantly though, is this really maintainable?  How are we going
&gt; to keep this list updated?  Do new services that use Firefox accounts have
&gt; to get a change to this pref shipped before they can be deployed?</span >

Perhaps we can try (post-release) to tie the list to the intercepted requests / preffed-to-localhost domains in test prefs?</pre></div><div class="change-set" id="c49"><div class="comment" data-id="13106254" data-no="49"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-49" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_305228" id="a10107363_106098"><img src="https://secure.gravatar.com/avatar/8c3bddad3fd0f45662210771f8f0ad15?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_305228" id="a10107363_106098"><a class="email " href="/user_profile?user_id=305228" > <span class="fna">Matthew N. [:MattN]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-49"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-49" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c49">Comment 49</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-03-05 13:10 PST" data-time="1520284253">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-49">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-49" data-comment-id="13106254">Comparing to the default permissions in <a rel="nofollow" href="https://dxr.mozilla.org/mozilla-central/source/browser/app/permissions">https://dxr.mozilla.org/mozilla-central/source/browser/app/permissions</a> would also be helpful to catch new privileged origins.</pre></div><div class="change-set" id="c50"><div class="comment" data-id="13106531" data-no="50"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-50" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_561655" id="a10107363_106098"><img src="https://secure.gravatar.com/avatar/2826368a4269673211a6539a73e9a056?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_561655" id="a10107363_106098"><a class="email " href="/user_profile?user_id=561655" > <span class="fna">Andrew Swan [:aswan]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-50"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-50" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c50">Comment 50</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-03-05 14:32 PST" data-time="1520289121">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-50">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-50" data-comment-id="13106531">(In reply to :Gijs (under the weather; responses will be slow) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Should extensions get access to accounts.firefox.com"
   href="/show_bug.cgi?id=1415644#c48">comment #48</a>)
<span class="quote">&gt; Perhaps we can try (post-release) to tie the list to the intercepted
&gt; requests / preffed-to-localhost domains in test prefs?</span >

Assuming you're talking about build/pgo/server-locations.txt I'm not seeing a connection, there's not much overlap between the list of hosts in the attached patch and the contents of that file...

(In reply to Matthew N. [:MattN] (PM if requests are blocking you) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Should extensions get access to accounts.firefox.com"
   href="/show_bug.cgi?id=1415644#c49">comment #49</a>)
<span class="quote">&gt; Comparing to the default permissions in
&gt; <a rel="nofollow" href="https://dxr.mozilla.org/mozilla-central/source/browser/app/permissions">https://dxr.mozilla.org/mozilla-central/source/browser/app/permissions</a> would
&gt; also be helpful to catch new privileged origins.</span >

Yeah, this would help us catch (some) sites to which the browser grants extra privileges but my understanding is that the patch attached here tries to enumerate all the domains that use Firefox accounts.  Most of those sites don't have any special access to browser features, they just happen to use fxa for authentication.  Relying on the browser having a complete and up-to-date list of such sites sounds like something almost guaranteed to fail.</pre></div><div class="change-set" id="c51"><div class="comment" data-id="13106570" data-no="51"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-51" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_372685" id="a10107363_106098"><img src="https://secure.gravatar.com/avatar/b2fec98200b3938bef69471c7005458c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_372685" id="a10107363_106098"><a class="email " href="/user_profile?user_id=372685" > <span class="fna">Shane Caraveo (:mixedpuppy)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-51"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-51" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c51">Comment 51</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-03-05 14:45 PST" data-time="1520289927">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-51">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-51" data-comment-id="13106570">(In reply to Kris Maglione [:kmag] (long backlog; ping on IRC if you're blocked) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Should extensions get access to accounts.firefox.com"
   href="/show_bug.cgi?id=1415644#c45">comment #45</a>)
<span class="quote">&gt; (In reply to Andrew Swan [:aswan] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Should extensions get access to accounts.firefox.com"
   href="/show_bug.cgi?id=1415644#c44">comment #44</a>)
&gt; &gt; This could use a test, as it is complete broken right now due to typo in the
&gt; &gt; pref name...
&gt; 
&gt; No tests for security bugs until they ship.</span >

Should still be a separate test patch.</pre></div><div class="change-set" id="c52"><div class="comment" data-id="13106616" data-no="52"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-52" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_372685" id="a10107363_106098"><img src="https://secure.gravatar.com/avatar/b2fec98200b3938bef69471c7005458c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_372685" id="a10107363_106098"><a class="email " href="/user_profile?user_id=372685" > <span class="fna">Shane Caraveo (:mixedpuppy)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-52"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-52" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c52">Comment 52</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-03-05 14:58 PST" data-time="1520290725">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-52">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-52" data-comment-id="13106616">FWIW this bug is strange, I'm not really clear what we're protecting here, feels like a bug in search of a problem.</pre></div><div class="change-set" id="c53"><div class="comment" data-id="13106633" data-no="53"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-53" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_372685" id="a10107363_106098"><img src="https://secure.gravatar.com/avatar/b2fec98200b3938bef69471c7005458c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_372685" id="a10107363_106098"><a class="email " href="/user_profile?user_id=372685" > <span class="fna">Shane Caraveo (:mixedpuppy)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-53"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-53" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c53">Comment 53</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-03-05 15:03 PST" data-time="1520291028">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-53">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-53" data-comment-id="13106633">Comment on <span class=""><a href="/attachment.cgi?id=8956152" name="attach_8956152" title="Create a list of restricted domains">attachment 8956152</a> <a href="/attachment.cgi?id=8956152&amp;action=edit" title="Create a list of restricted domains">[details]</a> <a href="/attachment.cgi?id=8956152&amp;action=diff" title="Create a list of restricted domains">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1415644&amp;attachment=8956152'>[review]</a>
Create a list of restricted domains

Looks reasonable for what its doing.  While existing tests should cover most of this, I'd still like to see the test patch ready before landing since there are some differences (e.g. pref change support, lack of requestBody for our special flavour of website).  I kind of question the pref observer...do we expect the restrictedDomains list to be modified at runtime, if so how is that happening (ie. do we intend to do hotfixes to update this or something)?</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8956152&amp;action=edit"
           title="Create a list of restricted domains"
           class=""
        >Attachment #8956152</a> -
        Flags: review?(mixedpuppy) &rarr; review+</div></div></div><div class="change-set" id="c54"><div class="comment" data-id="13108952" data-no="54"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-54" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_561655" id="a10107363_106098"><img src="https://secure.gravatar.com/avatar/2826368a4269673211a6539a73e9a056?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_561655" id="a10107363_106098"><a class="email " href="/user_profile?user_id=561655" > <span class="fna">Andrew Swan [:aswan]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-54"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-54" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c54">Comment 54</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-03-06 10:58 PST" data-time="1520362722">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-54">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-54" data-comment-id="13108952">Comment on <span class=""><a href="/attachment.cgi?id=8956152" name="attach_8956152" title="Create a list of restricted domains">attachment 8956152</a> <a href="/attachment.cgi?id=8956152&amp;action=edit" title="Create a list of restricted domains">[details]</a> <a href="/attachment.cgi?id=8956152&amp;action=diff" title="Create a list of restricted domains">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1415644&amp;attachment=8956152'>[review]</a>
Create a list of restricted domains

Review of <span class=""><a href="/attachment.cgi?id=8956152" name="attach_8956152" title="Create a list of restricted domains">attachment 8956152</a> <a href="/attachment.cgi?id=8956152&amp;action=edit" title="Create a list of restricted domains">[details]</a> <a href="/attachment.cgi?id=8956152&amp;action=diff" title="Create a list of restricted domains">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1415644&amp;attachment=8956152'>[review]</a>:
-----------------------------------------------------------------

This is a fine implementation of this concept, I'm just really wary that this whole approach isn't really going to work.

::: toolkit/components/extensions/WebExtensionPolicy.cpp
&#64;&#64; +292,5 &#64;&#64;
<span class="quote">&gt; +    const AtomSet&amp; Get() const;
&gt; +
&gt; +    bool Contains(const nsAtom* aAtom) const
&gt; +    {
&gt; +      return Get().Contains(aAtom);</span >

Maybe its best to have somebody with stronger c++ chops take a look at this, but doesn't this keep referencing (but never unrefing) the underlying AtomSet?</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8956152&amp;action=edit"
           title="Create a list of restricted domains"
           class=""
        >Attachment #8956152</a> -
        Flags: review?(aswan) &rarr; review+</div></div></div><div class="change-set" id="c55"><div class="comment" data-id="13108972" data-no="55"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-55" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" id="a10107363_106098"><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_106098" id="a10107363_106098"><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-55"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-55" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c55">Comment 55</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-03-06 11:04 PST" data-time="1520363054">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-55">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-55" data-comment-id="13108972">(In reply to Andrew Swan [:aswan] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Should extensions get access to accounts.firefox.com"
   href="/show_bug.cgi?id=1415644#c54">comment #54</a>)
<span class="quote">&gt; Maybe its best to have somebody with stronger c++ chops take a look at this,
&gt; but doesn't this keep referencing (but never unrefing) the underlying
&gt; AtomSet?</span >

If you mean AddRefing, no, AtomSet is not refcounted. Get() returns a reference to the instance that is owned by the AtomSetPref.</pre></div><div class="change-set" id="a10204923_106098"><div class="change" id="aa10204923_106098">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" id="a10204923_106098"><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_106098" id="a10204923_106098"><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a10204923_106098"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a10204923_106098">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#a10204923_106098">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-03-06 13:36 PST" data-time="1520372215">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8951578&amp;action=edit"
           title="bug-1415644-b.patch"
           class=""
        >Attachment #8951578</a> -
        Flags: <span class="activity-deleted">review?(kmaglione+bmo)</span></div></div></div><div class="change-set" id="c56"><div class="comment" data-id="13109917" data-no="56"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-56" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" id="a10204923_106098"><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_106098" id="a10204923_106098"><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-56"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-56" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c56">Comment 56</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-03-06 17:02 PST" data-time="1520384572">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-56">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-56" data-comment-id="13109917">Comment on <span class=""><a href="/attachment.cgi?id=8956152" name="attach_8956152" title="Create a list of restricted domains">attachment 8956152</a> <a href="/attachment.cgi?id=8956152&amp;action=edit" title="Create a list of restricted domains">[details]</a> <a href="/attachment.cgi?id=8956152&amp;action=diff" title="Create a list of restricted domains">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1415644&amp;attachment=8956152'>[review]</a>
Create a list of restricted domains

[Security approval request comment]
How easily could an exploit be constructed based on the patch?

Not terribly easily. It contains a list of interesting domains that a malicious extension might try to extract Mozilla services API/auth tokens from, but it doesn't suggest any particular reason that accessing those domains might be interesting.

Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?

No.

Which older supported branches are affected by this flaw?

All.

Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?

No. It would not be hard to backport to 59 release, but it also would not be worth the risk.

How likely is this patch to cause regressions; how much testing does it need?

Not very likely. It should only affect extensions which access certain internal Mozilla domains, most of which are CDNs or API endpoints. Several of them already have restricted access, so the likelihood of this breaking legitimate production extensions is fairly low.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8956152&amp;action=edit"
           title="Create a list of restricted domains"
           class=""
        >Attachment #8956152</a> -
        Flags: sec-approval?</div></div></div><div class="change-set" id="c57"><div class="comment" data-id="13110253" data-no="57"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-57" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a10204923_106098"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_280903" id="a10204923_106098"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-57"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-57" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c57">Comment 57</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-03-06 22:25 PST" data-time="1520403941">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-57">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-57" data-comment-id="13110253">Comment on <span class=""><a href="/attachment.cgi?id=8956152" name="attach_8956152" title="Create a list of restricted domains">attachment 8956152</a> <a href="/attachment.cgi?id=8956152&amp;action=edit" title="Create a list of restricted domains">[details]</a> <a href="/attachment.cgi?id=8956152&amp;action=diff" title="Create a list of restricted domains">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1415644&amp;attachment=8956152'>[review]</a>
Create a list of restricted domains

sec-approval+. I agree that we don't need to backport this.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8956152&amp;action=edit"
           title="Create a list of restricted domains"
           class=""
        >Attachment #8956152</a> -
        Flags: sec-approval? &rarr; sec-approval+</div></div></div><div class="change-set" id="c58"><div class="comment" data-id="13115134" data-no="58"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-58" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_609840" id="a10204923_106098"><img src="https://secure.gravatar.com/avatar/db6a64cc30c2f86ed9e27fac09780a0f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_609840" id="a10204923_106098"><a class="email " href="/user_profile?user_id=609840" > <span class="fna">FLR</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-58"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-58" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c58">Comment 58</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-03-08 12:46 PST" data-time="1520542015">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-58">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-58" data-comment-id="13115134">Comment on <span class=""><a href="/attachment.cgi?id=8956152" name="attach_8956152" title="Create a list of restricted domains">attachment 8956152</a> <a href="/attachment.cgi?id=8956152&amp;action=edit" title="Create a list of restricted domains">[details]</a> <a href="/attachment.cgi?id=8956152&amp;action=diff" title="Create a list of restricted domains">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1415644&amp;attachment=8956152'>[review]</a>

Just wondering, wouldn't it be better if sub domains of the restricted domain list were also considered as restricted ?</pre></div><div class="change-set" id="c59"><div class="comment" data-id="13118243" data-no="59"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-59" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" id="a10204923_106098"><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_106098" id="a10204923_106098"><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-59"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-59" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c59">Comment 59</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-03-09 14:42 PST" data-time="1520635346">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-59">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-59" data-comment-id="13118243">(In reply to FLR from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Should extensions get access to accounts.firefox.com"
   href="/show_bug.cgi?id=1415644#c58">comment #58</a>)
<span class="quote">&gt; Comment on <span class=""><a href="/attachment.cgi?id=8956152" name="attach_8956152" title="Create a list of restricted domains">attachment 8956152</a> <a href="/attachment.cgi?id=8956152&amp;action=edit" title="Create a list of restricted domains">[details]</a> <a href="/attachment.cgi?id=8956152&amp;action=diff" title="Create a list of restricted domains">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1415644&amp;attachment=8956152'>[review]</a>
&gt; 
&gt; Just wondering, wouldn't it be better if sub domains of the restricted
&gt; domain list were also considered as restricted ?</span >

Perhaps, but that check would be much more expensive.</pre></div><div class="change-set" id="c60"><div class="comment" data-id="13118302" data-no="60"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-60" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" id="a10204923_106098"><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_106098" id="a10204923_106098"><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-60"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-60" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c60">Comment 60</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-03-09 15:03 PST" data-time="1520636606">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-60">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-60" data-comment-id="13118302"><a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/39e131181d442409a5df2ed945c02aca2b9baca2">https://hg.mozilla.org/integration/mozilla-inbound/rev/39e131181d442409a5df2ed945c02aca2b9baca2</a>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Should extensions get access to accounts.firefox.com"
   href="/show_bug.cgi?id=1415644">Bug 1415644</a>: Create a list of restricted domains. r=aswan,mixedpuppy</pre></div><div class="change-set" id="c61"><div class="comment" data-id="13118321" data-no="61"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-61" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" id="a10204923_106098"><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_106098" id="a10204923_106098"><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-61"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-61" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c61">Comment 61</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-03-09 15:14 PST" data-time="1520637287">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-61">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-61" data-comment-id="13118321"><a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/270f423f416617ed31f2ee448c73af100941a6d3">https://hg.mozilla.org/integration/mozilla-inbound/rev/270f423f416617ed31f2ee448c73af100941a6d3</a>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Should extensions get access to accounts.firefox.com"
   href="/show_bug.cgi?id=1415644">Bug 1415644</a>: Follow-up: Fix static analysis build bustage. r=bustage</pre></div><div class="change-set" id="c62"><div class="comment" data-id="13118400" data-no="62"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-62" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" id="a10204923_106098"><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_106098" id="a10204923_106098"><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-62"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-62" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c62">Comment 62</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-03-09 16:16 PST" data-time="1520640995">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-62">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-62" data-comment-id="13118400"><a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/d36983c749994d5ed2f1bd67e16bbf72236fef63">https://hg.mozilla.org/integration/mozilla-inbound/rev/d36983c749994d5ed2f1bd67e16bbf72236fef63</a>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Should extensions get access to accounts.firefox.com"
   href="/show_bug.cgi?id=1415644">Bug 1415644</a>: Follow-up: Fix assertion in debug builds. r=bustage CLOSED TREE</pre></div><div class="change-set" id="c63"><div class="comment" data-id="13118717" data-no="63"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-63" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_258347" id="a10204923_106098"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_258347" id="a10204923_106098"><a class="email " href="/user_profile?user_id=258347" > <span class="fna">Sebastian Hengst [:aryx] (needinfo on intermittent or backout)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-63"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-63" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c63">Comment 63</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-03-10 02:06 PST" data-time="1520676399">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-63">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-63" data-comment-id="13118717"><a rel="nofollow" href="https://hg.mozilla.org/mozilla-central/rev/39e131181d44">https://hg.mozilla.org/mozilla-central/rev/39e131181d44</a>
<a rel="nofollow" href="https://hg.mozilla.org/mozilla-central/rev/270f423f4166">https://hg.mozilla.org/mozilla-central/rev/270f423f4166</a>
<a rel="nofollow" href="https://hg.mozilla.org/mozilla-central/rev/d36983c74999">https://hg.mozilla.org/mozilla-central/rev/d36983c74999</a></pre><div class="activity"><div class="change">Status: ASSIGNED &rarr; RESOLVED</div><div class="change">Closed: <span class="rel-time" title="2018-03-10 02:06 PST" data-time="1520676399">4 years ago</span></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox60&amp;o1=isnotempty">status-firefox60</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox60&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox60&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">Resolution: --- &rarr; FIXED</div><div class="change">Target Milestone: --- &rarr; mozilla60</div></div></div><div class="change-set" id="a10694381_75935"><div class="change" id="aa10694381_75935">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a10694381_75935"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_75935" id="a10694381_75935"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a10694381_75935"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a10694381_75935">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#a10694381_75935">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-03-12 06:34 PDT" data-time="1520861673">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox58&amp;o1=isnotempty">status-firefox58</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox58&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox59&amp;o1=isnotempty">status-firefox59</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox59&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr52&amp;o1=isnotempty">status-firefox-esr52</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr52&amp;o1=equals&amp;v1=wontfix">wontfix</a></div></div></div><div class="change-set" id="a10758569_1689"><div class="change" id="aa10758569_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a10758569_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a10758569_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a10758569_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a10758569_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#a10758569_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-03-13 00:24 PDT" data-time="1520925861">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: toolkit-core-security &rarr; core-security-release</div></div></div><div class="change-set" id="a10883984_209011"><div class="change" id="aa10883984_209011">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_209011" id="a10883984_209011"><img src="https://secure.gravatar.com/avatar/3c7706fb156c53ce5f3aabc0ca897079?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_209011" id="a10883984_209011"><a class="email " href="/user_profile?user_id=209011" > <span class="fna">[:philipp]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a10883984_209011"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a10883984_209011">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#a10883984_209011">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-03-14 11:14 PDT" data-time="1521051276">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE - Clippings extension no longer functional on support.mozilla.org"
   href="/show_bug.cgi?id=1445714">1445714</a></div></div></div><div class="change-set" id="c64"><div class="comment" data-id="13141585" data-no="64"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-64" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_434339" id="a10883984_209011"><img src="https://secure.gravatar.com/avatar/9a0a16bc1cb5b0144e373deb8e357804?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_434339" id="a10883984_209011"><a class="email disabled" href="/user_profile?user_id=434339" > <span class="fna">Paul Theriault [:pauljt] (no longer reading bugmail)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-64"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-64" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c64">Comment 64</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-03-19 20:20 PDT" data-time="1521516006">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-64">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-64" data-comment-id="13141585">(In reply to Kris Maglione [:kmag] (long backlog; ping on IRC if you're blocked) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Should extensions get access to accounts.firefox.com"
   href="/show_bug.cgi?id=1415644#c43">comment #43</a>)
<span class="quote">&gt; (In reply to Paul Theriault [:pauljt] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Should extensions get access to accounts.firefox.com"
   href="/show_bug.cgi?id=1415644#c42">comment #42</a>)
&gt; &gt; See also 1443073 - we need to do something about google analytics, too
&gt; &gt; right? No idea what though.
&gt; 
&gt; Do we?</span >

I didn't understand the nature of the mechanism you added. The attack I was thinking of was intercepting the loading of a script that is included on AMO. I assumed that for WebRequest, the blocking would be done on the request's URL, and thus intercepting google analytics on AMO would still be allowed (since it isn't on the blacklist). But I see from testing the check is on the URL of the document which triggered the request (is that correct?).  

I was also concerned that if you intercepted google analytics on a different domain, you could poison the cache for AMO. But as far as I can from testing, modifications made by filterResponseData are not stored in the cache (as far as I can tell, only the original response is cached, not the modified one? Is that correct?). 

So from what I can tell, any domain in this restricted list:
 - can not have a content script injected into it (via manifest, contentScripts.register() or tabs.executeScript()) 
 - webRequest events will not be sent for tabs with a document that matches one of the blocked domains
 -  can not use Devtools API to inject script (browser.devtools.inspectedWindow.eval)

Is my understanding correct? I've added this to the security model document [1]. Please let me know if Ive misunderstood anything here.

Note that one API that lives outside these restrictions is the Proxy API. This make sense I think: Proxy can already be used to intercept any URL, including system requests (like update requests etc)-  which makes sense, otherwise it would break the usefulness of being able to set the network proxy. But our add-on review team should probably be aware of the sensitive nature of the Proxy permission. 

[1] <a rel="nofollow" href="https://docs.google.com/document/d/1u3IoSbMlMts_dZYkbQEXYY2VNOewTinpXtFCeEYdboo/edit">https://docs.google.com/document/d/1u3IoSbMlMts_dZYkbQEXYY2VNOewTinpXtFCeEYdboo/edit</a>#</pre></div><div class="change-set" id="c65"><div class="comment" data-id="13141680" data-no="65"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-65" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" id="a10883984_209011"><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_106098" id="a10883984_209011"><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-65"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-65" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c65">Comment 65</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-03-19 21:58 PDT" data-time="1521521928">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-65">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-65" data-comment-id="13141680">(In reply to Paul Theriault [:pauljt] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Should extensions get access to accounts.firefox.com"
   href="/show_bug.cgi?id=1415644#c64">comment #64</a>)
<span class="quote">&gt; (In reply to Kris Maglione [:kmag] (long backlog; ping on IRC if you're
&gt; blocked) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Should extensions get access to accounts.firefox.com"
   href="/show_bug.cgi?id=1415644#c43">comment #43</a>)
&gt; So from what I can tell, any domain in this restricted list:
&gt;  - can not have a content script injected into it (via manifest,
&gt; contentScripts.register() or tabs.executeScript()) 
&gt;  - webRequest events will not be sent for tabs with a document that matches
&gt; one of the blocked domains
&gt;  -  can not use Devtools API to inject script
&gt; (browser.devtools.inspectedWindow.eval)
&gt; 
&gt; Is my understanding correct? I've added this to the security model document
&gt; [1]. Please let me know if Ive misunderstood anything here.</span >

So, there are a few different sets of restrictions here:

- Extensions cannot see requests unless they have permissions for the domains of
both the requested URL and for the document requesting the URL. As of this bug,
that check also takes into account the restricted domains list.

- Extensions cannot modify requests if they don't have permission to see them,
per the above, or if the document the request belongs to has access to the
mozAddonManager API. As of this bug, this restriction also applies to the
StreamFilter API.

- Extensions cannot load content scripts into any domain that they do not have
host permissions for, any site that has access to the mozAddonManager API, or,
as of this bug, any domain on the restricted domains list.

- Extensions cannot make non-CORS requests to any domain they do not have host
permissions for or, as of this bug, any domain on the restricted domains list.
They can still make requests to domains with mozAddonManager access as long as
they are not also on the restricted domains list (which I believe they all are).
The behavior introduced by this bug is less lenient, since one of the concerns
was the possibility of getting access to Firefox Accounts tokens. We didn't have
that concern when restricting access to the mozAddonManager API.

<span class="quote">&gt; Note that one API that lives outside these restrictions is the Proxy API.
&gt; This make sense I think: Proxy can already be used to intercept any URL,
&gt; including system requests (like update requests etc)-  which makes sense,
&gt; otherwise it would break the usefulness of being able to set the network
&gt; proxy. But our add-on review team should probably be aware of the sensitive
&gt; nature of the Proxy permission.</span >

I'm not especially concerned about the proxy API here. The sites that we're
restricting access to here, and all of the resources they load, should only be
accessible over HTTPS. Unless the proxy they're being forwarded to has a trusted
certificate for those sites, they shouldn't be able to cause any problems beyond
DOS. If they do have access to trusted certificates for those sites, we have
bigger problems.</pre></div><div class="change-set" id="a13465549_578488"><div class="change" id="aa13465549_578488">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_578488" id="a13465549_578488"><img src="https://secure.gravatar.com/avatar/6822db445808be789b12cfae22d118dc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_578488" id="a13465549_578488"><a class="email " href="/user_profile?user_id=578488" > <span class="fna">Tom Ritter [:tjr] (ni? for response to CVE/sec-approval/advisories/etc)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a13465549_578488"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a13465549_578488">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#a13465549_578488">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-04-13 08:20 PDT" data-time="1523632841">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">See Also:  &rarr; <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED WONTFIX - NoScript may fail to operate on Mozilla domains in Tor Browser"
   href="/show_bug.cgi?id=1453988">1453988</a></div></div></div><div class="change-set" id="a14617326_280903"><div class="change" id="aa14617326_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a14617326_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a14617326_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a14617326_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a14617326_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#a14617326_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-04-26 16:16 PDT" data-time="1524784618">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: [adv-main60+]</div></div></div><div class="change-set" id="a14973425_280903"><div class="change" id="aa14973425_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a14973425_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a14973425_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a14973425_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a14973425_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#a14973425_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-04-30 19:11 PDT" data-time="1525140717">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Alias: CVE-2018-5152</div></div></div><div class="change-set" id="c66"><div class="comment" data-id="13248729" data-no="66"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-66" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_488993" id="a14973425_280903"><img src="https://secure.gravatar.com/avatar/42f2a9436bbaefa7e0028e214f2b9350?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_488993" id="a14973425_280903"><a class="email " href="/user_profile?user_id=488993" > <span class="fna">Andrei Vaida [:avaida]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-66"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-66" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c66">Comment 66</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-05-02 07:19 PDT" data-time="1525270759">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-66">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-66" data-comment-id="13248729">Kris, would this benefit from manual testing? If that's a yes, is there a straightforward way we could reproduce the bug?</pre><div class="activity"><div class="change">Flags: qe-verify?</div><div class="change">Flags: needinfo?(kmaglione+bmo)</div></div></div><div class="change-set" id="a15154449_488993"><div class="change" id="aa15154449_488993">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_488993" id="a15154449_488993"><img src="https://secure.gravatar.com/avatar/42f2a9436bbaefa7e0028e214f2b9350?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_488993" id="a15154449_488993"><a class="email " href="/user_profile?user_id=488993" > <span class="fna">Andrei Vaida [:avaida]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a15154449_488993"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a15154449_488993">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#a15154449_488993">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-05-02 21:29 PDT" data-time="1525321741">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: [adv-main60+] &rarr; [adv-main60+][post-critsmash-triage]</div></div></div><div class="change-set" id="c67"><div class="comment" data-id="13255496" data-no="67"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-67" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a15154449_488993"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a15154449_488993"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-67"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-67" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c67">Comment 67</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-05-04 12:00 PDT" data-time="1525460411">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-67">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-67" data-comment-id="13255496">Since this requires installing an extension in the first place this should have been limited to sec-moderate.</pre><div class="activity"><div class="change">Keywords: <a href="/buglist.cgi?keywords=sec-high&amp;resolution=---">sec-high</a> &rarr; <a href="/buglist.cgi?keywords=sec-moderate&amp;resolution=---">sec-moderate</a></div></div></div><div class="change-set" id="a17437430_447061"><div class="change" id="aa17437430_447061">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_447061" id="a17437430_447061"><img src="https://secure.gravatar.com/avatar/30e26944b9b786ea16fce8b18394c6e4?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_447061" id="a17437430_447061"><a class="email " href="/user_profile?user_id=447061" > <span class="fna">Rob Wu [:robwu]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a17437430_447061"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a17437430_447061">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#a17437430_447061">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-05-29 07:38 PDT" data-time="1527604722">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">See Also:  &rarr; <a class="bz_bug_link
          bz_status_NEW"
   title="NEW - Consider removing domain restrictions for fetch/XMLHttpRequest"
   href="/show_bug.cgi?id=1465094">1465094</a></div></div></div><div class="change-set" id="c68"><div class="comment" data-id="13372654" data-no="68"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-68" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a17437430_447061"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a17437430_447061"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-68"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-68" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#c68">Comment 68</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-05-29 14:50 PDT" data-time="1527630601">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-68">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-68" data-comment-id="13372654">Unhiding this now that 60 has shipped so that people who run into this new restriction can understand what's going on.</pre><div class="activity"><div class="change">Group: <span class="activity-deleted">core-security-release</span></div></div></div><div class="change-set" id="a18138773_372685"><div class="change" id="aa18138773_372685">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_372685" id="a18138773_372685"><img src="https://secure.gravatar.com/avatar/b2fec98200b3938bef69471c7005458c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_372685" id="a18138773_372685"><a class="email " href="/user_profile?user_id=372685" > <span class="fna">Shane Caraveo (:mixedpuppy)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a18138773_372685"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a18138773_372685">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#a18138773_372685">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-06 10:27 PDT" data-time="1528306065">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED WONTFIX - Extension cannot fetch data from addons.mozilla.org because the host permissions are not applied"
   href="/show_bug.cgi?id=1450649">1450649</a></div></div></div><div class="change-set" id="a18825555_552376"><div class="change" id="aa18825555_552376">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_552376" id="a18825555_552376"><img src="https://secure.gravatar.com/avatar/d9554dd0cb7bf455ce8b4100b3210178?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_552376" id="a18825555_552376"><a class="email " href="/user_profile?user_id=552376" > <span class="fna">Jonathan Claudius [:claudijd] (use NEEDINFO)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a18825555_552376"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a18825555_552376">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#a18825555_552376">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-14 09:14 PDT" data-time="1528992847">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">See Also:  &rarr; <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED WONTFIX"
   href="/show_bug.cgi?id=1468748">1468748</a></div></div></div><div class="change-set" id="a19271362_546015"><div class="change" id="aa19271362_546015">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_546015" id="a19271362_546015"><img src="https://secure.gravatar.com/avatar/d0465b8931b44330f542efbeeae855da?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_546015" id="a19271362_546015"><a class="email " href="/user_profile?user_id=546015" > <span class="fna">BMO Automation</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a19271362_546015"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a19271362_546015">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#a19271362_546015">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-19 13:04 PDT" data-time="1529438654">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Product: Toolkit &rarr; WebExtensions</div></div></div><div class="change-set" id="a19541216_472632"><div class="change" id="aa19541216_472632">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_472632" id="a19541216_472632"><img src="https://secure.gravatar.com/avatar/57097c3f3e45dff76854d7fb52fdf6a0?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_472632" id="a19541216_472632"><a class="email " href="/user_profile?user_id=472632" > <span class="fna">gwarser</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a19541216_472632"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a19541216_472632">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#a19541216_472632">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-22 16:01 PDT" data-time="1529708508">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox57&amp;o1=isnotempty">status-firefox57</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox57&amp;o1=equals&amp;v1=wontfix">wontfix</a> &rarr; ---</div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox58&amp;o1=isnotempty">status-firefox58</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox58&amp;o1=equals&amp;v1=wontfix">wontfix</a> &rarr; ---</div></div></div><div class="change-set" id="a19678331_209011"><div class="change" id="aa19678331_209011">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_209011" id="a19678331_209011"><img src="https://secure.gravatar.com/avatar/3c7706fb156c53ce5f3aabc0ca897079?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_209011" id="a19678331_209011"><a class="email " href="/user_profile?user_id=209011" > <span class="fna">[:philipp]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a19678331_209011"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a19678331_209011">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#a19678331_209011">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-24 06:07 PDT" data-time="1529845623">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">See Also:  &rarr; <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Crash in mozilla::extensions::URLInfo::Host"
   href="/show_bug.cgi?id=1470746">1470746</a></div></div></div><div class="change-set" id="a21868571_424102"><div class="change" id="aa21868571_424102">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_424102" id="a21868571_424102"><img src="https://secure.gravatar.com/avatar/7ad57e27678b3a70d05e9c3fb1af123e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_424102" id="a21868571_424102"><a class="email " href="/user_profile?user_id=424102" > <span class="fna">Ryan Kelly [:rfkelly]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a21868571_424102"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a21868571_424102">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#a21868571_424102">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-07-19 14:31 PDT" data-time="1532035863">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">See Also:  &rarr; <a class="bz_bug_link
          bz_status_UNCONFIRMED"
   title="UNCONFIRMED - Web Extensions cannot manage saved logins for accounts.firefox.com"
   href="/show_bug.cgi?id=1476755">1476755</a></div></div></div><div class="change-set" id="a22876120_488993"><div class="change" id="aa22876120_488993">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_488993" id="a22876120_488993"><img src="https://secure.gravatar.com/avatar/42f2a9436bbaefa7e0028e214f2b9350?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_488993" id="a22876120_488993"><a class="email " href="/user_profile?user_id=488993" > <span class="fna">Andrei Vaida [:avaida]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a22876120_488993"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a22876120_488993">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#a22876120_488993">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-07-31 06:23 PDT" data-time="1533043412">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: qe-verify? &rarr; qe-verify-</div></div></div><div class="change-set" id="a24949952_372685"><div class="change" id="aa24949952_372685">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_372685" id="a24949952_372685"><img src="https://secure.gravatar.com/avatar/b2fec98200b3938bef69471c7005458c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_372685" id="a24949952_372685"><a class="email " href="/user_profile?user_id=372685" > <span class="fna">Shane Caraveo (:mixedpuppy)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a24949952_372685"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a24949952_372685">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#a24949952_372685">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-08-24 06:27 PDT" data-time="1535117244">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - proxy.onRequest not honored for addon updates"
   href="/show_bug.cgi?id=1476570">1476570</a></div></div></div><div class="change-set" id="a26635953_106098"><div class="change" id="aa26635953_106098">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" id="a26635953_106098"><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_106098" id="a26635953_106098"><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a26635953_106098"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a26635953_106098">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#a26635953_106098">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-09-12 18:47 PDT" data-time="1536803245">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(kmaglione+bmo)</span></div></div></div><div class="change-set" id="a72131134_209011"><div class="change" id="aa72131134_209011">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_209011" id="a72131134_209011"><img src="https://secure.gravatar.com/avatar/3c7706fb156c53ce5f3aabc0ca897079?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_209011" id="a72131134_209011"><a class="email " href="/user_profile?user_id=209011" > <span class="fna">[:philipp]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a72131134_209011"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a72131134_209011">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#a72131134_209011">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-02-21 07:20 PST" data-time="1582298426">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">See Also:  &rarr; <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE - lastpass disabled on firefox sync signin page"
   href="/show_bug.cgi?id=1617184">1617184</a></div></div></div><div class="change-set" id="a89675248_463945"><div class="change" id="aa89675248_463945">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_463945" id="a89675248_463945"><img src="https://secure.gravatar.com/avatar/712789485bd1a1e5447ed6b7bcf8db9b?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_463945" id="a89675248_463945"><a class="email disabled" href="/user_profile?user_id=463945" > <span class="fna">Mike de Boer [:mikedeboer]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a89675248_463945"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a89675248_463945">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1415644#a89675248_463945">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-09-11 09:42 PDT" data-time="1599842540">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Blocks: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED INVALID - Extensions shouldn't get access to topsites.services.mozilla.com"
   href="/show_bug.cgi?id=1664513">1664513</a></div></div></div><div id="new-comment-notice">
          You need to <a href="/show_bug.cgi?id=1415644&amp;GoAheadAndLogIn=1">log in</a>
          before you can comment on or make changes to this bug.
        </div>



<div id="bottom-actions">
  <div id="bottom-right-actions">
    <button type="button" id="top-btn" class="secondary" aria-label="Go to Page Top">Top &uarr;</button>
  </div>
</div></div> 
</main> 
</div> 


</body>
</html>