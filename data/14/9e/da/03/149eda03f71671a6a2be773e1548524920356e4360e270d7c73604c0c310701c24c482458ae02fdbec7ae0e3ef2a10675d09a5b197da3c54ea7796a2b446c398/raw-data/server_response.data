<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Elasticsearch 7.13.4 Security Update - Security Announcements - Discuss the Elastic Stack</title>
    <meta name="description" content="Elasticsearch memory disclosure issue (ESA-2021-16) 
A memory disclosure vulnerability was identified in Elasticsearch’s error reporting. A user with the ability to submit arbitrary queries to Elasticsearch could submit &amp;hellip;">
    <meta name="generator" content="Discourse 2.8.0.beta7 - https://github.com/discourse/discourse version 436edbb51a15c634e65c0d7cdccdb4ce9aecd8f1">
<link rel="icon" type="image/png" href="https://aws1.discourse-cdn.com/elastic/optimized/3X/5/d/5ded4d26a9eb0b035f2650d43025d92144c19f9c_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="https://aws1.discourse-cdn.com/elastic/optimized/3X/b/e/be7f366b9210b4959de9e84ea1f93ea746631491_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="https://discuss.elastic.co/t/elasticsearch-7-13-4-security-update/279177" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://discuss.elastic.co","potentialAction":{"@type":"SearchAction","target":"https://discuss.elastic.co/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="https://discuss.elastic.co/opensearch.xml" title="Discuss the Elastic Stack Search">

      <link href="https://sea2.discourse-cdn.com/elastic/stylesheets/desktop_30475bec156c2db4fc0eed5672900bd58f9e48a4.css?__ws=discuss.elastic.co" media="all" rel="stylesheet" data-target="desktop"  />
      <link href="https://sea2.discourse-cdn.com/elastic/stylesheets/desktop_theme_24_b919e3de1838296d0a853ef2a32c366b47362ded.css?__ws=discuss.elastic.co" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="24" data-theme-name="discourse-tag-sidebar"/>
<link href="https://sea2.discourse-cdn.com/elastic/stylesheets/desktop_theme_19_d9f830a66faa3d29ef78bbc207171773e9ebd0bb.css?__ws=discuss.elastic.co" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="19" data-theme-name="elastic suggester"/>
<link href="https://sea2.discourse-cdn.com/elastic/stylesheets/desktop_theme_17_268cd07054cdb38ea7e9f1c5313a5dcc900123eb.css?__ws=discuss.elastic.co" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="17" data-theme-name="icon header links"/>
<link href="https://sea2.discourse-cdn.com/elastic/stylesheets/desktop_theme_20_7574547e27de64ed16659f56bef7cf0d43bbbd7b.css?__ws=discuss.elastic.co" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="20" data-theme-name="unformatted code detector"/>
<link href="https://sea2.discourse-cdn.com/elastic/stylesheets/desktop_theme_6_c94b2b9c45b1d832b27fd0e09114653ab0736b39.css?__ws=discuss.elastic.co" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="6" data-theme-name="house ads"/>
<link href="https://sea2.discourse-cdn.com/elastic/stylesheets/desktop_theme_2_6c4fc70b8f8842114a858f51741a58b764ae1290.css?__ws=discuss.elastic.co" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2" data-theme-name="elastic"/>
    <script type="application/ld+json">
	{
		"@context": "http://schema.org",
		"@type": "Organization",
		"name": "Elastic",
		"url": "https://www.elastic.co/",
		"logo": "https://www.elastic.co/static/img/logo-elastic.png",
		"sameAs": ["https://www.facebook.com/elastic.co",
			"https://twitter.com/elastic",
			"https://plus.google.com/105178019064686397293",
			"https://www.youtube.com/user/elasticsearch",
			"https://www.linkedin.com/company/elasticsearch"
		]
	}
</script>
<meta name="google-site-verification" content="DomjkVg_vXHmIOm6fe3rZEhQ5tCXZl9fb-H-SNkCKaY">
<meta name="google-site-verification" content="ifAAE_mkvVVDx_RVqNrCqZMXKqZKxdt_XZIYL33pjtE">

<script type="text/javascript" src="//cdn.iubenda.com/cs/iubenda_cs.js" charset="UTF-8" async=""></script><script src="https://sea2.discourse-cdn.com/elastic/theme-javascripts/d741a84477ff74dead88fe5447f0de9e5421cb4c.js?__ws=discuss.elastic.co"></script>
    
        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Elasticsearch 7.13.4 Security Update&#39;" href="https://discuss.elastic.co/t/elasticsearch-7-13-4-security-update/279177.rss" />
    <meta property="og:site_name" content="Discuss the Elastic Stack" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://aws1.discourse-cdn.com/elastic/original/3X/5/4/5461df8fd2fe783981b0180332821184b729980e.png" />
<meta property="og:image" content="https://aws1.discourse-cdn.com/elastic/original/3X/5/4/5461df8fd2fe783981b0180332821184b729980e.png" />
<meta property="og:url" content="https://discuss.elastic.co/t/elasticsearch-7-13-4-security-update/279177" />
<meta name="twitter:url" content="https://discuss.elastic.co/t/elasticsearch-7-13-4-security-update/279177" />
<meta property="og:title" content="Elasticsearch 7.13.4 Security Update" />
<meta name="twitter:title" content="Elasticsearch 7.13.4 Security Update" />
<meta property="og:description" content="Elasticsearch memory disclosure issue (ESA-2021-16)  A memory disclosure vulnerability was identified in Elasticsearch’s error reporting. A user with the ability to submit arbitrary queries to Elasticsearch could submit a malformed query that would result in an error message returned containing previously used portions of a data buffer. This buffer could contain sensitive information such as Elasticsearch documents or authentication details.  Thanks to Eric Howard (Bell Canada) for reporting thi..." />
<meta name="twitter:description" content="Elasticsearch memory disclosure issue (ESA-2021-16)  A memory disclosure vulnerability was identified in Elasticsearch’s error reporting. A user with the ability to submit arbitrary queries to Elasticsearch could submit a malformed query that would result in an error message returned containing previously used portions of a data buffer. This buffer could contain sensitive information such as Elasticsearch documents or authentication details.  Thanks to Eric Howard (Bell Canada) for reporting thi..." />
<meta property="article:published_time" content="2021-07-20T15:14:29+00:00" />
<meta property="og:ignore_canonical" content="true" />


    <script type="application/ld+json">{"@context":"http://schema.org","@type":"QAPage","name":"Elasticsearch 7.13.4 Security Update","mainEntity":{"@type":"Question","name":"Elasticsearch 7.13.4 Security Update","text":"Elasticsearch memory disclosure issue (ESA-2021-16)\n\nA memory disclosure vulnerability was identified in Elasticsearch’s error reporting. A user with the ability to submit arbitrary queries to Elasticsearch could submit a malformed query that would result in an error message returned containing prev&hellip;","upvoteCount":0,"answerCount":0,"dateCreated":"2021-07-20T15:14:29.300Z","author":{"@type":"Person","name":"Douglas Day"}}}</script>
  </head>
  <body class="crawler">
    

<script src="https://sea2.discourse-cdn.com/elastic/theme-javascripts/bdc1b1e37d244d4763213dab881ad9e09713c98e.js?__ws=discuss.elastic.co"></script>
<link rel="apple-touch-icon" sizes="57x57" href="https://www.elastic.co/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="https://www.elastic.co/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="https://www.elastic.co/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="https://www.elastic.co/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="https://www.elastic.co/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="https://www.elastic.co/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="https://www.elastic.co/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="https://www.elastic.co/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="https://www.elastic.co/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192" href="https://www.elastic.co/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://www.elastic.co/favicon-32x32.png?v=2">
<link rel="icon" type="image/png" sizes="96x96" href="https://www.elastic.co/favicon-96x96.png?v=2">
<link rel="icon" type="image/png" sizes="16x16" href="https://www.elastic.co/favicon-16x16.png?v=2">
<link rel="manifest" href="https://www.elastic.co/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="https://www.elastic.co/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">



<script src="https://sea2.discourse-cdn.com/elastic/theme-javascripts/964f12d361c19ec0d18738f29bf05e70411deabf.js?__ws=discuss.elastic.co"></script>
    <header>
      <a href="/">
          <img src="https://aws1.discourse-cdn.com/elastic/original/3X/1/8/18a14d80f0e626d44a1b531df11869baea5c9cf4.png" alt="Discuss the Elastic Stack" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="/t/elasticsearch-7-13-4-security-update/279177">Elasticsearch 7.13.4 Security Update</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://discuss.elastic.co/c/announcements/5" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #AB9364'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Announcements</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://discuss.elastic.co/c/announcements/security-announcements/31" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #BF1E2E'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Security Announcements</span>
              </span>
            </a>
            <meta itemprop="position" content="2" />
          </span>
      </div>

  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='Elastic'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://aws1.discourse-cdn.com/elastic/original/3X/1/8/18a14d80f0e626d44a1b531df11869baea5c9cf4.png'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://discuss.elastic.co/u/douglasday'><span itemprop='name'>douglasday</span></a>
            (Douglas Day)
          </span>

          <link itemprop="mainEntityOfPage" href="https://discuss.elastic.co/t/elasticsearch-7-13-4-security-update/279177">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2021-07-20T15:14:29Z' class='post-time'>
                July 20, 2021,  3:14pm
              </time>
              <meta itemprop='dateModified' content='2021-09-14T16:59:01Z'>
          <span itemprop='position'>#1</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p><strong>Elasticsearch memory disclosure issue (ESA-2021-16)</strong></p>
<p>A memory disclosure vulnerability was identified in Elasticsearch’s error reporting. A user with the ability to submit arbitrary queries to Elasticsearch could submit a malformed query that would result in an error message returned containing previously used portions of a data buffer. This buffer could contain sensitive information such as Elasticsearch documents or authentication details.</p>
<p>Thanks to Eric Howard (Bell Canada) for reporting this issue.</p>
<p><strong>Affected Versions:</strong></p>
<p>Elasticsearch versions 7.10.0 to 7.13.3</p>
<p><strong>Solutions and Mitigations:</strong></p>
<p>Affected users should update their version of Elasticsearch to 7.13.4. There is no known workaround for this issue.</p>
<p><strong>ECE Users:</strong></p>
<p><strong>Aug 2 Update:</strong> Within the context of some versions of ECE, this vulnerability can additionally be exploited by ECE users to escalate their own permissions. Follow the below instructions to determine the best steps to take for your ECE version.</p>
<p>For ECE versions 1.0.0 - 2.6.2:</p>
<ol>
<li>Upgrade non-system clusters of versions between 7.10.0 and 7.13.3 (inclusive) to 7.13.4+</li>
<li>Do nothing on system clusters</li>
</ol>
<p>For ECE versions 2.7.0 - 2.9.2:</p>
<ol>
<li>
<p>Upgrade non-system clusters of versions between 7.10.0 and 7.13.3 (inclusive) to 7.13.4+</p>
</li>
<li>
<p>Reinstall the <a href="https://www.elastic.co/guide/en/cloud-enterprise/current/ece-manage-elastic-stack.html#ece_most_recent_elastic_stack_packs">most recent stack pack</a> on the system clusters to remediate <a href="https://discuss.elastic.co/t/elastic-cloud-enterprise-security-update/279180">ESA-2021-17</a> and restart</p>
</li>
<li>
<p>If you have added non-admin users to your AdminConsole or Logging+Monitoring system clusters, you should revoke these users’ access.</p>
</li>
<li>
<p>For the Security system cluster, perform one of the following:</p>
</li>
<li>
<p>Upgrade ECE to 2.10+ and upgrade the system clusters to 7.13.4+</p>
</li>
<li>
<p>Add a "block all" <a href="https://www.elastic.co/guide/en/cloud-enterprise/current/ece-traffic-filtering-ip.html">IP filter</a> for “0.0.0.0” and apply that to the security cluster, which blocks access except via the Admin console</p>
</li>
<li>
<p>Do nothing on system clusters.</p>
</li>
</ol>
<p>For ECE versions 2.10.0 - 2.10.1:</p>
<ol>
<li>Upgrade non-system clusters of versions between 7.10.0 and 7.13.3 (inclusive) to 7.13.4+</li>
<li>Reinstall the <a href="https://www.elastic.co/guide/en/cloud-enterprise/current/ece-manage-elastic-stack.html#ece_most_recent_elastic_stack_packs">most recent stack pack</a>
</li>
<li>For each system cluster, go to the Advanced Editor &gt; Elasticsearch Cluster data, and set "system_owned = false" and save</li>
<li>Upgrade each system cluster to 7.13.4+</li>
<li>For each system cluster, go to the Advanced Editor &gt; Elasticsearch Cluster data, and set "system_owned = true" and save</li>
</ol>
<p>For ECE versions 2.10.2+:</p>
<ol>
<li>Upgrade non-system clusters of versions 7.10 - 7.13.3 to 7.13.4+</li>
<li>Reinstall the <a href="https://www.elastic.co/guide/en/cloud-enterprise/current/ece-manage-elastic-stack.html#ece_most_recent_elastic_stack_packs">most recent stack pack</a>
</li>
</ol>
<p><strong>CVSSv3:</strong> 8.0 - AV:A/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H</p>
<p><strong>CVE ID:</strong> CVE-2021-22145</p>
<p><strong>CWE:</strong> CWE-125: Out-of-bounds Read</p>
        </div>

        <meta itemprop='headline' content='Elasticsearch 7.13.4 Security Update'>
          <meta itemprop='keywords' content=''>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='/' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='/categories' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='/guidelines' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    <div id="copyright">
	<p>
		© 2020. All Rights Reserved - Elasticsearch
	</p>
	<ul class="links">
		<li>Elasticsearch is a trademark of Elasticsearch BV, registered in the U.S. and in other countries</li>
		<li><a href="https://www.elastic.co/legal/trademarks" id="footer_trademarks">Trademarks</a></li>
		<li><a href="https://www.elastic.co/legal/terms-of-use" id="footer_terms">Terms</a></li>
		<li><a href="https://www.elastic.co/legal/privacy-policy" id="footer_privacy">Privacy</a></li>
		<li><a href="https://www.elastic.co/brand" id="footer_brand">Brand</a></li>
		<li><a href="https://www.elastic.co/community/codeofconduct" id="codeofconduct">Code of Conduct</a></li>
	</ul>
	<p>
		Apache, Apache Lucene, Apache Hadoop, Hadoop, HDFS and the yellow elephant logo are trademarks of the <a href="http://www.apache.org/" target="_blank">Apache Software Foundation</a> in the United States and/or other&nbsp;countries.
	</p>
</div>

<div id="socialmedia-wrapper">
		<section id="socialmedia" class="container">
			<!-- social icons -->
			<div id="social">
				<ul class="links">
					
						<li class="facebook grayscale"><a id="footer_facebook" target="_blank" href="http://www.facebook.com/elastic.co"></a></li>
					
						<li class="twitter grayscale"><a id="footer_twitter" target="_blank" href="https://www.twitter.com/elastic"></a></li>
					
						<li class="linkedin grayscale"><a id="footer_linkedin" target="_blank" href="https://www.linkedin.com/company/elastic-co"></a></li>
						
						<li class="xing grayscale"><a id="footer_xing" target="_blank" href="https://www.xing.com/companies/elastic.co"></a></li>
					    <li class="youtube grayscale"><a id="footer_youtube" target="_blank" href="https://www.youtube.com/user/elasticsearch"></a></li>
						
				</ul>
			</div>
		</section>
	</div>
    
  </body>
  
</html>
