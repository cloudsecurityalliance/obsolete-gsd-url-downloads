<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                      "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">
  <head>
    <title>Bug 964548 &ndash; VUL-1: KDE lockscreen bypass by switching display off and on</title>

      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">


<link rel="Top" href="http://bugzilla.opensuse.org/">

  


  
    <link rel="Show" title="Dependency Tree"
          href="showdependencytree.cgi?id=964548&amp;hide_resolved=1">
      <link rel="Show" title="Dependency Graph"
            href="showdependencygraph.cgi?id=964548">

      <link rel="Show" title="Bug Activity"
            href="show_activity.cgi?id=964548">
      <link rel="Show" title="Printer-Friendly Version"
            href="show_bug.cgi?format=multiple&amp;id=964548">



    
    <link href="skins/standard/global.css?1411227340"
          rel="alternate stylesheet" 
          title="Classic"><link href="js/yui/assets/skins/sam/autocomplete.css?1411227331" rel="stylesheet"
            type="text/css" ><link href="js/yui/assets/skins/sam/calendar.css?1411227331" rel="stylesheet"
            type="text/css" ><link href="skins/standard/global.css?1411227340" rel="stylesheet"
            type="text/css" ><link href="skins/standard/show_bug.css?1416528352" rel="stylesheet"
            type="text/css" ><link href="extensions/Voting/web/style.css?1411227348" rel="stylesheet"
            type="text/css" ><!--[if lte IE 7]>
      


      <link href="skins/standard/IE-fixes.css?1411227340" rel="stylesheet"
            type="text/css" >
<![endif]-->

    <link href="skins/contrib/openSUSE/global.css?1411227340" rel="stylesheet"
            type="text/css" 
          title="SUSE">

    

    

    
<script type="text/javascript" src="js/yui/yahoo-dom-event/yahoo-dom-event.js?1411227335"></script><script type="text/javascript" src="js/yui/cookie/cookie-min.js?1411227333"></script><script type="text/javascript" src="js/yui/datasource/datasource-min.js?1411227329"></script><script type="text/javascript" src="js/yui/connection/connection-min.js?1411227329"></script><script type="text/javascript" src="js/yui/json/json-min.js?1411227333"></script><script type="text/javascript" src="js/yui/autocomplete/autocomplete-min.js?1411227334"></script><script type="text/javascript" src="js/yui/calendar/calendar-min.js?1411227335"></script><script type="text/javascript" src="js/global.js?1411227336"></script>

    <script type="text/javascript">
    <!--
        YAHOO.namespace('bugzilla');
        YAHOO.util.Event.addListener = function (el, sType, fn, obj, overrideContext) {
               if ( ("onpagehide" in window || YAHOO.env.ua.gecko) && sType === "unload") { sType = "pagehide"; };
               var capture = ((sType == "focusin" || sType == "focusout") && !YAHOO.env.ua.ie) ? true : false;
               return this._addListener(el, this._getType(sType), fn, obj, overrideContext, capture);
         };
        if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
            YAHOO.util.Event._simpleRemove(window, "unload", 
                                           YAHOO.util.Event._unload);
        }
        
        function unhide_language_selector() { 
            YAHOO.util.Dom.removeClass(
                'lang_links_container', 'bz_default_hidden'
            ); 
        } 
        YAHOO.util.Event.onDOMReady(unhide_language_selector);

        
        var BUGZILLA = {
            param: {
                cookiepath: '\/',
                maxusermatches: 1
            },
            constant: {
                COMMENT_COLS: 80
            },
            string: {
                

                attach_desc_required:
                    'You must enter a Description for this attachment.',
                component_required:
                    'You must select a Component for this bug.',
                description_required:
                    'You must enter a Description for this bug.',
                short_desc_required:
                    'You must enter a Summary for this bug.',
                version_required:
                    'You must select a Version for this bug.'
            }
        };

    if (history && history.replaceState) {
      if(!document.location.href.match(/show_bug\.cgi/)) {
        history.replaceState( null, 
                             "Bug 964548 – VUL-1: KDE lockscreen bypass by switching display off and on",  
                             "show_bug.cgi?id=964548" );
        document.title = "Bug 964548 – VUL-1: KDE lockscreen bypass by switching display off and on";
      }
      if (document.location.href.match(/show_bug\.cgi\?.*list_id=/)) {
        var href = document.location.href;
        href = href.replace(/[\?&]+list_id=(\d+|cookie)/, '');
        history.replaceState(null, "Bug 964548 – VUL-1: KDE lockscreen bypass by switching display off and on", href);
      }
    }
    YAHOO.util.Event.onDOMReady(function() {
      initDirtyFieldTracking();
    });
    // -->
    </script>
<script type="text/javascript" src="js/util.js?1411227336"></script><script type="text/javascript" src="js/field.js?1414105521"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla" href="./search_plugin.cgi">
    <link rel="shortcut icon" href="images/favicon.ico" ><link href="extensions/Testopia/css/testopia.css" rel="stylesheet" type="text/css">
    <link href="extensions/Testopia/extjs/examples/ux/css/RowEditor.css" rel="stylesheet" type="text/css"  />
    <script type="text/javascript">
        Testopia_user = {login: "", id: 0};
        DEFAULT_CASE_STATUS = 'CONFIRMED';
    </script>
  </head>



  <body onload=""
        class="bugzilla-opensuse-org bz_bug bz_status_RESOLVED bz_product_openSUSE_Distribution bz_component_KDE_Workspace_&#X28;Plasma&#X29; bz_bug_964548 yui-skin-sam">



<div id="header">
<div id="banner">
  </div>

<!--div id="tmp_warning_wnd" style="
    position:fixed; 
    color:red; 
    font-size:20px; 
    top:50px; 
    left:10%; 
    right:10%; 
    padding:1em;
    background-color:#ffffff;
    border:3px solid red;
    z-index:9999;
    text-align:center;">
  This Bugzilla is for TESTING ONLY. All new bugs and comments WILL BE LOST. Use <a href="https://bugzilla.suse.com">bugzilla.suse.com</a> instead.
  <button style="
      background:none;
      border:0;
      box-shadow:none;
      color:red;
      text-shadow:none;
      position:absolute;
      right:0;
      top:0;" onclick="document.getElementById('tmp_warning_wnd').style.display='none';">[X]</button>
</div-->

<table border="0" cellspacing="0" cellpadding="0" id="titles">
<tr>
    <td id="title">
      <p>Bugzilla &ndash; Bug&nbsp;964548</p>
    </td>

    <td id="subtitle">
      <p class="subheader">VUL-1: KDE lockscreen bypass by switching display off and on</p>
    </td>

    <td id="information">
      <p class="header_addl_info">Last modified: 2016-05-03 19:01:15 UTC</p>
    </td>
</tr>
</table>

<table id="lang_links_container" cellpadding="0" cellspacing="0"
       class="bz_default_hidden"><tr><td>
</td></tr></table>
<ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi?classification=openSUSE">New</a></li>
  <li><span class="separator">| </span><a href="describecomponents.cgi">Browse</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_top" name="no_redirect" value="0">
    <script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_top");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_top" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_top"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li>
      <span class="separator">| </span>
        <a href="request.cgi">Requests</a></li>

  <li>
        <span class="separator">| </span>
        <a href="docs/en/html/bug_page.html" target="_blank">Help</a>
      </li>
    

    <li id="mini_login_container_top">
  <span class="separator">| </span>
  <!--a id="login_link_top" href="show_bug.cgi?id=964548&amp;GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('_top')">Log In</a-->
  <a id="login_link_top" href="show_bug.cgi?id=964548&amp;GoAheadAndLogIn=1">Log In</a>


  <form action="show_bug.cgi?id=964548" method="POST" 
        class="mini_login bz_default_hidden"
        id="mini_login_top"
        onsubmit="return check_mini_login_fields( '_top' );"
  >
    <input id="Bugzilla_login_top" 
           class="bz_login"
           name="Bugzilla_login"
           title="Login"
           onfocus="mini_login_on_focus('_top')"
    >
    <input class="bz_password" 
           id="Bugzilla_password_top" 
           name="Bugzilla_password"
           type="password"
           title="Password"
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text" 
           id="Bugzilla_password_dummy_top" value="password"
           title="Password"
           onfocus="mini_login_on_focus('_top')"
    >
    <input type="submit" name="GoAheadAndLogIn" value="Log in" 
            id="log_in_top">
    <script type="text/javascript">
      mini_login_constants = {
          "login" : "login",
          "warning" : "You must set the login and password before logging in."
      };
      
      if (YAHOO.env.ua.gecko || YAHOO.env.ua.ie || YAHOO.env.ua.opera) {
          YAHOO.util.Event.onDOMReady(function() {
              init_mini_login_form('_top');
          });
      }
      else {
          YAHOO.util.Event.on(window, 'load', function () {
              window.setTimeout(function() {
                  init_mini_login_form('_top');
              }, 200);
          });
    }
    </script>
    <a href="#" onclick="return hide_mini_login_form('_top')">[x]</a>
  </form>
</li>
<li id="forgot_container_top">
  <span class="separator">| </span>
  <a id="forgot_link_top" href="https://idp-portal.suse.com/univention/self-service/#page=passwordreset">Forgot Password</a>
</li>
</ul>
</div> 

<div id="bugzilla-body">

<div class="navigation">
  
  <i><font color="#777777">First</font></i>
  <i><font color="#777777">Last</font></i>
  <i><font color="#777777">Prev</font></i>
  <i><font color="#777777">Next</font></i>
  &nbsp;&nbsp;
  <i><font color="#777777">This bug is not in your last
    search results.</font></i>
</div>
<script type="text/javascript">
<!--

//-->
</script>

<form name="changeform" id="changeform" method="post" action="process_bug.cgi">

  <input type="hidden" name="delta_ts" value="2016-05-03 19:01:15">
  <input type="hidden" name="longdesclength" value="44">
  <input type="hidden" name="id" value="964548">
  <input type="hidden" name="token" value="1635624127-8vCQgwp8ECr1f2u1YAlh3dbFoCZlBMZxKB46qY6CKyo">
<div class="bz_alias_short_desc_container edit_form">
        <strike>
     <a href="show_bug.cgi?id=964548"><b>Bug&nbsp;964548</b></a> -<span id="summary_alias_container" class="bz_default_hidden">
        (<span id="alias_nonedit_display">CVE-2016-2312</span>) 
      <span id="short_desc_nonedit_display">VUL-1: KDE lockscreen bypass by switching display off and on</span></strike>
     </span>  
       
    <div id="summary_alias_input">
      <table id="summary"> 
        <tr>
            <td colspan="2">(CVE-2016-2312)
          </td>
        </tr>
        
        <tr><th class="field_label "
    id="field_label_short_desc">

    <label for="short_desc" accesskey="s">

  <a 
      title="The bug summary is a short sentence which succinctly describes what the bug is about."
      class="field_help_link"
      href="page.cgi?id=glossary.html#short_desc"
  >Summary:</a>
</label>
</th>
          <td>VUL-1: KDE lockscreen bypass by switching display off and on
          </td>
        </tr>
      </table>
    </div>
  </div>
  <script type="text/javascript">
    hideAliasAndSummary('VUL-1: KDE lockscreen bypass by switching display off and on', 'CVE-2016-2312');
  </script>
  <table class="edit_form">
    <tr>
      
      <td id="bz_show_bug_column_1" class="bz_show_bug_column">     
        <table>
          <tr>
    <th class="field_label">
      <a href="page.cgi?id=status_resolution_matrix.html">Status</a>:
    </th>
    <td id="bz_field_status">
      <span id="static_bug_status">RESOLVED
          FIXED
      </span>
    </td>
  </tr>

          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr><th class="field_label "
    id="field_label_classification">


  <a 
      title="Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation."
      class="field_help_link"
      href="page.cgi?id=glossary.html#classification"
  >Classification:</a>

</th>
  <td class="field_value "
      id="field_container_classification" >openSUSE</td>
      </tr>

    
    
    
    <tr><th class="field_label "
    id="field_label_product">


  <a 
      title="Bugs are categorised into Products and Components. Select a Classification to narrow down this list."
      class="field_help_link"
      href="describecomponents.cgi"
  >Product:</a>

</th>
  <td class="field_value "
      id="field_container_product" >openSUSE Distribution</td>
    </tr>

    
    <tr class="bz_default_hidden"><th class="field_label "
    id="field_label_classification">


  <a 
      title="Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation."
      class="field_help_link"
      href="page.cgi?id=glossary.html#classification"
  >Classification:</a>

</th>
  <td class="field_value "
      id="field_container_classification" >openSUSE</td>
    </tr>
        
    
    
    <tr><th class="field_label "
    id="field_label_component">


  <a 
      title="Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list."
      class="field_help_link"
      href="describecomponents.cgi?product=openSUSE Distribution"
  >Component:</a>

</th>
  <td class="field_value "
      id="field_container_component" >KDE Workspace (Plasma)</td>
    </tr>
    <tr><th class="field_label "
    id="field_label_version">

    <label for="version">

  <a 
      title="The version field defines the version of the software the bug was found in."
      class="field_help_link"
      href="page.cgi?id=glossary.html#version"
  >Version:</a>
</label>
</th>
        <td>Leap 42.1
  </td>
    </tr>
        
    
        
    <tr><th class="field_label "
    id="field_label_rep_platform">

    <label for="rep_platform" accesskey="h">

  <a 
      title="The hardware platform the bug was observed on. Note: When searching, selecting the option &quot;All&quot; only finds bugs whose value for this field is literally the word &quot;All&quot;."
      class="field_help_link"
      href="page.cgi?id=glossary.html#rep_platform"
  >Hardware:</a>
</label>
</th>
      <td class="field_value">x86-64
       openSUSE 42.1
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          
          <tr>
      <th class="field_label">
        <label for="priority">
          <a href="page.cgi?id=glossary.html#priority">Priority</a></label>:
      </th>
      <td>P4 - Low
        <label for="severity">
          <b>Severity</b></label>:
       Major<span id="votes_container">
      with
      <a href="page.cgi?id=voting/bug.html&amp;bug_id=964548">1 
            vote</a>
    (<a href="page.cgi?id=voting/user.html&amp;bug_id=964548#vote_964548">vote</a>)
  </span>
      </td>
    </tr>

      <tr>
        <th class="field_label">
          <label for="target_milestone">
            <a href="page.cgi?id=glossary.html#target_milestone">
            Target&nbsp;Milestone</a></label>:
        </th><td>---
  </td>
      </tr>            
          
          <tr>
      <th class="field_label">
        <a href="page.cgi?id=glossary.html#assigned_to">Assigned To</a>:
      </th>
      <td><span class="vcard"><span class="fn">E-Mail List</span>
</span>
      </td>
    </tr>

    <tr><th class="field_label "
    id="field_label_qa_contact">

    <label for="qa_contact" accesskey="q">

  <a 
      title="The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved."
      class="field_help_link"
      href="page.cgi?id=glossary.html#qa_contact"
  >QA Contact:</a>
</label>
</th>
      <td><span class="vcard"><span class="fn">E-mail List</span>
</span>
      </td>
    </tr>
    <script type="text/javascript">
      assignToDefaultOnChange(['product', 'component'],
        'opensuse-kde-bugs\x40opensuse.org',
        'qa-bugs\x40suse.de');
    </script>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr><th class="field_label "
    id="field_label_bug_file_loc">

    <label for="bug_file_loc" accesskey="u">

  <a 
      title="Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen."
      class="field_help_link"
      href="page.cgi?id=glossary.html#bug_file_loc"
  >URL:</a>
</label>
</th>
    <td>
      <span id="bz_url_input_area">
      </span>
    </td>
  </tr>
  
    <tr><th class="field_label "
    id="field_label_status_whiteboard">

    <label for="status_whiteboard" accesskey="w">

  <a 
      title="Each bug has a free-form single line text entry box for adding tags and status information."
      class="field_help_link"
      href="page.cgi?id=glossary.html#status_whiteboard"
  >Whiteboard:</a>
</label>
</th><td colspan="2">  
  </td>
    </tr>
  
    <tr>
      <th class="field_label">
        <label for="keywords" accesskey="k">
          <a href="describekeywords.cgi"><u>K</u>eywords</a></label>:
      </th>
      <td class="field_value" colspan="2">
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>

          
<tr><th class="field_label "
    id="field_label_dependson">


  <a 
      title="The bugs listed here must be resolved before this bug can be resolved."
      class="field_help_link"
      href="page.cgi?id=glossary.html#dependson"
  >Depends on:</a>

</th>

  <td>
    <span id="dependson_input_area">
    </span>
    
  </td>
  </tr>
  
  <tr><th class="field_label "
    id="field_label_blocked">


  <a 
      title="This bug must be resolved before the bugs listed in this field can be resolved."
      class="field_help_link"
      href="page.cgi?id=glossary.html#blocked"
  >Blocks:</a>

</th>

  <td>
    <span id="blocked_input_area">
    </span>
    
  </td>
  </tr>
  
  <tr>
    <th>&nbsp;</th>
  
    <td colspan="2" align="left" id="show_dependency_tree_or_graph">
      Show dependency <a href="showdependencytree.cgi?id=964548&amp;hide_resolved=1">tree</a>
  
        /&nbsp;<a href="showdependencygraph.cgi?id=964548">graph</a>
    </td>
  </tr>
          
        </table>
      </td>
      <td>
        <div class="bz_column_spacer">&nbsp;</div>
      </td>
      
      <td id="bz_show_bug_column_2" class="bz_show_bug_column">
        <table cellpadding="3" cellspacing="1">
        <tr>
    <th class="field_label">
      Reported:
    </th>
    <td>2016-02-01 19:30 UTC by <span class="vcard"><span class="fn">Dirk Weber</span>
</span>
    </td>
  </tr>
  
  <tr>
    <th class="field_label">
      Modified:
    </th>
    <td>2016-05-03 19:01 UTC 
      (<a href="show_activity.cgi?id=964548">History</a>)
    </td>
  
  </tr>
         <tr>
      <th class="field_label">
        <label for="newcc" accesskey="a">CC List:</label>
      </th>
      <td>12 
          users
          <span id="cc_edit_area_showhide_container" class="bz_default_hidden">
            (<a href="#" id="cc_edit_area_showhide">show</a>)
          </span>
        <div id="cc_edit_area">
          <br>
            <select id="cc" multiple="multiple" size="5">
                <option value="alarrosa">alarrosa</option>
                <option value="astieger">astieger</option>
                <option value="bshah">bshah</option>
                <option value="d_werner">d_werner</option>
                <option value="jkt">jkt</option>
                <option value="kde">kde</option>
                <option value="krahmer">krahmer</option>
                <option value="lorenzodes">lorenzodes</option>
                <option value="nevion">nevion</option>
                <option value="opensuse-kde-bugs">opensuse-kde-bugs</option>
                <option value="security-team">security-team</option>
                <option value="tittiatcoke">tittiatcoke</option>
            </select>
        </div>
          <script type="text/javascript">
            hideEditableField( 'cc_edit_area_showhide_container', 
                               'cc_edit_area', 
                               'cc_edit_area_showhide', 
                               '', 
                               '');  
          </script>
      </td>
    </tr>
         <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_see_also">


  <a 
      title="This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields."
      class="field_help_link"
      href="page.cgi?id=glossary.html#see_also"
  >See Also:</a>

</th>
  <td class="field_value "
      id="field_container_see_also" ></td>
    </tr> 
         <tr><th class="field_label "
    id="field_label_cf_foundby">


  <a 
      title="A custom Drop Down field in this installation of Bugzilla."
      class="field_help_link"
      href="page.cgi?id=glossary.html#cf_foundby"
  >Found By:</a>

</th>
  <td class="field_value "
      id="field_container_cf_foundby"  colspan="2">---</td>
    </tr>
    <tr><th class="field_label "
    id="field_label_cf_nts_priority">


  <a 
      title="A custom Free Text field in this installation of Bugzilla."
      class="field_help_link"
      href="page.cgi?id=glossary.html#cf_nts_priority"
  >Services Priority:</a>

</th>
  <td class="field_value "
      id="field_container_cf_nts_priority"  colspan="2"></td>
    </tr>
    <tr><th class="field_label "
    id="field_label_cf_biz_priority">


  <a 
      title="A custom Free Text field in this installation of Bugzilla."
      class="field_help_link"
      href="page.cgi?id=glossary.html#cf_biz_priority"
  >Business Priority:</a>

</th>
  <td class="field_value "
      id="field_container_cf_biz_priority"  colspan="2"></td>
    </tr>
    <tr><th class="field_label "
    id="field_label_cf_blocker">


  <a 
      title="A custom Drop Down field in this installation of Bugzilla."
      class="field_help_link"
      href="page.cgi?id=glossary.html#cf_blocker"
  >Blocker:</a>

</th>
  <td class="field_value "
      id="field_container_cf_blocker"  colspan="2">---</td>
    </tr>
    <tr><th class="field_label  bz_hidden_field"
    id="field_label_cf_marketing_qa_status">


  <a 
      title="A custom Drop Down field in this installation of Bugzilla."
      class="field_help_link"
      href="page.cgi?id=glossary.html#cf_marketing_qa_status"
  >Marketing QA Status:</a>

</th>
  <td class="field_value  bz_hidden_field"
      id="field_container_cf_marketing_qa_status"  colspan="2">---</td>
    </tr>
    <tr><th class="field_label  bz_hidden_field"
    id="field_label_cf_it_deployment">


  <a 
      title="A custom Drop Down field in this installation of Bugzilla."
      class="field_help_link"
      href="page.cgi?id=glossary.html#cf_it_deployment"
  >IT Deployment:</a>

</th>
  <td class="field_value  bz_hidden_field"
      id="field_container_cf_it_deployment"  colspan="2">---</td>
    </tr>
         <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
         <ul>
    <li><a href="tr_new_case.cgi?product=openSUSE%20Distribution&bug=964548">Create test case</a></li>
</ul><ul>
  <li><a href="enter_bug.cgi?cloned_bug_id=964548">Clone This Bug</a></li>
</ul>
                

        </table>
      </td>
    </tr>
    <tr>
      <td colspan="3">
          <hr id="bz_top_half_spacer">
      </td>
    </tr>
  </table>

  <table id="bz_big_form_parts" cellspacing="0" cellpadding="0"><tr>
  <td>

    
<script type="text/javascript">
<!--
function toggle_display(link) {
    var table = document.getElementById("attachment_table");
    var view_all = document.getElementById("view_all");
    var hide_obsolete_url_parameter = "&hide_obsolete=1";
    // Store current height for scrolling later
    var originalHeight = table.offsetHeight;
    var rows = YAHOO.util.Dom.getElementsByClassName(
        'bz_tr_obsolete', 'tr', table);

    for (var i = 0; i < rows.length; i++) {
        bz_toggleClass(rows[i], 'bz_default_hidden');
    }

    if (YAHOO.util.Dom.hasClass(rows[0], 'bz_default_hidden')) {
        link.innerHTML = "Show Obsolete";
        view_all.href = view_all.href + hide_obsolete_url_parameter 
    }
    else {
        link.innerHTML = "Hide Obsolete";
        view_all.href = view_all.href.replace(hide_obsolete_url_parameter,"");
    }

    var newHeight = table.offsetHeight;
    // This scrolling makes the window appear to not move at all.
    window.scrollBy(0, newHeight - originalHeight);

    return false;
}
//-->
</script>

<br>
<table id="attachment_table" cellspacing="0" cellpadding="4">
  <tr id="a0">
    <th colspan="2" align="left">
      Attachments
    </th>
  </tr>


      <tr id="a1" class="bz_contenttype_text_plain">
        <td valign="top">
            <a href="attachment.cgi?id=664062"
               title="View the content of the attachment">
          <b>.xsession-errors-:0 covering periode before diplay power off until after power on</b></a>

          <span class="bz_attach_extra_info">
              (96.05 KB,
                text/plain)

            <br>
            <a href="#attach_664062"
               title="Go to the comment associated with the attachment">2016-02-01 19:30 UTC</a>,

            <span class="vcard"><span class="fn">Dirk Weber</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=664062&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a2" class="bz_contenttype_text_plain">
        <td valign="top">
            <a href="attachment.cgi?id=664478"
               title="View the content of the attachment">
          <b>output of kscreenlocker_greet --testing; .xsession-errors-:0</b></a>

          <span class="bz_attach_extra_info">
              (12.22 KB,
                text/plain)

            <br>
            <a href="#attach_664478"
               title="Go to the comment associated with the attachment">2016-02-04 16:30 UTC</a>,

            <span class="vcard"><span class="fn">Dirk Weber</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=664478&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a3" class="bz_contenttype_text_plain bz_patch">
        <td valign="top">
            <a href="attachment.cgi?id=664559"
               title="View the content of the attachment">
          <b>Possible patch</b></a>

          <span class="bz_attach_extra_info">
              (1.51 KB,
                patch)

            <br>
            <a href="#attach_664559"
               title="Go to the comment associated with the attachment">2016-02-05 09:50 UTC</a>,

            <span class="vcard"><span class="fn">Martin Gräßlin</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=664559&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=664559&amp;action=diff">Diff</a>
        </td>
      </tr>
      <tr id="a4" class="bz_contenttype_text_plain">
        <td valign="top">
            <a href="attachment.cgi?id=664611"
               title="View the content of the attachment">
          <b>output of /usr/lib64/libexec/kscreenlocker_greet --testing with the patched version #c16</b></a>

          <span class="bz_attach_extra_info">
              (2.83 KB,
                text/plain)

            <br>
            <a href="#attach_664611"
               title="Go to the comment associated with the attachment">2016-02-05 15:11 UTC</a>,

            <span class="vcard"><span class="fn">Dirk Weber</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=664611&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a5" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td valign="top">
            <a href="attachment.cgi?id=665550"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">When the last windows gets closed, reset a few things and objects in kscreenlocker</span></b></a>

          <span class="bz_attach_extra_info">
              (964 bytes,
                patch)

            <br>
            <a href="#attach_665550"
               title="Go to the comment associated with the attachment">2016-02-14 22:55 UTC</a>,

            <span class="vcard"><span class="fn">Lorenzo Desole</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=665550&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=665550&amp;action=diff">Diff</a>
        </td>
      </tr>
      <tr id="a6" class="bz_contenttype_text_plain bz_patch">
        <td valign="top">
            <a href="attachment.cgi?id=666317"
               title="View the content of the attachment">
          <b>This should resolve the remaining issues</b></a>

          <span class="bz_attach_extra_info">
              (5.54 KB,
                patch)

            <br>
            <a href="#attach_666317"
               title="Go to the comment associated with the attachment">2016-02-20 17:39 UTC</a>,

            <span class="vcard"><span class="fn">Lorenzo Desole</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=666317&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=666317&amp;action=diff">Diff</a>
        </td>
      </tr>

  <tr class="bz_attach_footer">
    <td colspan="2">
        <span class="bz_attach_view_hide">
            <a href="#a0" onclick="return toggle_display(this);">Show
              Obsolete</a> (1)
            <a id="view_all" href="attachment.cgi?bugid=964548&amp;action=viewall&amp;hide_obsolete=1">View All</a>
        </span>
        <a href="attachment.cgi?bugid=964548&amp;action=enter">Add an attachment</a>
        (proposed patch, testcase, etc.)
    </td>
  </tr>
</table>
<br>
<div id="add_comment" class="bz_section_additional_comments">
      <table>
        <tr>
          <td>
            <fieldset>
              <legend>Note</legend>
              You need to
              <a href="show_bug.cgi?id=964548&amp;GoAheadAndLogIn=1">log in</a>
              before you can comment on or make changes to this bug.
            </fieldset>
          </td>
        </tr> 
      </table>
  </div>
  </td>
  <td>
  </td>
  </tr></table>

  
  <div id="comments"><script src="js/comments.js?1411227336" type="text/javascript">
</script>

<script type="text/javascript">
<!--
  /* Adds the reply text to the `comment' textarea */
  function replyToComment(id, real_id, name) {
      var prefix = "(In reply to " + name + " from comment #" + id + ")\n";
      var replytext = "";
        /* pre id="comment_name_N" */
        var text_elem = document.getElementById('comment_text_'+id);
        var text = getText(text_elem);
        replytext = prefix + wrapReplyText(text);


      /* <textarea id="comment"> */
      var textarea = document.getElementById('comment');
      if (textarea.value != replytext) {
          textarea.value += replytext;
      }

      textarea.focus();
  } 
//-->
</script>




<!-- This auto-sizes the comments and positions the collapse/expand links 
     to the right. -->
<table class="bz_comment_table" cellpadding="0" cellspacing="0"><tr>
<td>
<div id="c0" class="bz_comment bz_first_comment">

      <div class="bz_first_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=964548#c0">Description</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Dirk Weber</span>
</span>
        </span>

        <span class="bz_comment_time">
          2016-02-01 19:30:23 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class=""><a href="attachment.cgi?id=664062" name="attach_664062" title=".xsession-errors-:0 covering periode before diplay power off until after power on">attachment 664062</a> <a href="attachment.cgi?id=664062&amp;action=edit" title=".xsession-errors-:0 covering periode before diplay power off until after power on">[details]</a></span>
.xsession-errors-:0 covering periode before diplay power off until after power on

On one system with fully updated Leap 42.1 with KDE I observe that the
locked screen can be unlocked by switching the display off and on.

I do not observe this on another system which has a very similar SW setup
but different HW.

The error does not happen when the display enters and leaves powersave mode.

Affected system:
Intel GPU: Integrated Graphics Chipset: Intel(R) HD Graphics 4600
Display Port connection (DP1)

Not affected system:
Radeon GPU
DVI-I connection

Both: Leap 42.1, packages from the distribution and the update repos

It seems no other applications are affected by this power cycling the display, only the kscreenlocker_greet vanishes on the Intel/Display port system.

Attached: .xsession-errors-:0 starting before powering off the screen until after powering it back on.</pre>
    </div><div id="c1" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=964548#c1">Comment 1</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Sebastian Krahmer</span>
</span>
        </span>

        <span class="bz_comment_time">
          2016-02-02 10:54:45 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Opened the bug so upstream can access it.</pre>
    </div><div id="c2" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=964548#c2">Comment 2</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Raymond Wooninck</span>
</span>
        </span>

        <span class="bz_comment_time">
          2016-02-02 11:12:14 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Dirk, 

Could you describe your hardware setup a little more ?  Is this a desktop system with just a single monitor and the other systems have the same setup ? So that we are not comparing a desktop system with a single monitor to a laptop with an external display. 

What I understand from the original message is that you are locking the screen and then when you switch off and on the display, the lock screen is gone and the desktop is visible ?</pre>
    </div><div id="c3" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=964548#c3">Comment 3</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Dirk Weber</span>
</span>
        </span>

        <span class="bz_comment_time">
          2016-02-02 16:53:38 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to Raymond Wooninck from <a href="show_bug.cgi?id=964548#c2">comment #2</a>)
<span class="quote">&gt; Dirk, 
&gt; 
&gt; Could you describe your hardware setup a little more ?  Is this a desktop
&gt; system with just a single monitor and the other systems have the same setup
&gt; ? So that we are not comparing a desktop system with a single monitor to a
&gt; laptop with an external display. </span >
both mentioned systems are desktop systems, both have a single monitor.

The affected system is a less than 2 years old HP Elitedesk 800 G1 TWR, I would consider it quite a &quot;standard&quot; system.

On two laptops (one of them with AMD video chip and the other one with Intel chip) I did not observe this, but I also can't really switch off the monitor :-)

For me the suspicious distinction between the two is the cable (DP vs. DVI) between PC and monitor.

<span class="quote">&gt; What I understand from the original message is that you are locking the
&gt; screen and then when you switch off and on the display, the lock screen is
&gt; gone and the desktop is visible ?</span >
exactly.

steps to reproduce on the affected system:
when some applications are in use (konsole, Firefox, ...)  - I did not try with &quot;blank&quot; desktop

lock the screen (CTRL+Alt+L) and make sure it is locked
switch of the monitor
wait &quot;some&quot; (~5) seconds - I did not try very short power off time
switch on the monitor
the desktop is not locked, the arrangement of windows on the virtual desktops (or nowadays called activities?) are unchanged
there is no sign of some crash of the lock screen (no drkonqui), it is just gone as if the screen had not been locked at all.</pre>
    </div><div id="c4" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=964548#c4">Comment 4</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Swamp Workflow Management</span>
</span>
        </span>

        <span class="bz_comment_time">
          2016-02-02 23:00:16 UTC
        </span>
      </div>



<pre class="bz_comment_text" >bugbot adjusting priority</pre>
    </div><div id="c5" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=964548#c5">Comment 5</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Martin Gräßlin</span>
</span>
        </span>

        <span class="bz_comment_time">
          2016-02-03 07:01:05 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Upstream maintainer speaking.

From the xsession output it looks like the lockscreen successfully exited. It prints &quot;Grab Released&quot; which is in method

void KSldApp::doUnlock()

which is called from three places:
1) If the kscreenlocker_greet failed to start. This would print an error message &quot;Greeter Process not available&quot; which is not in the log
2) If logind send the Unlock dbus signal
3) If kscreenlocker_greet exits with exit code 0. This can happen after grace time (given description not the case), after logind Unlock or - the normal case - after the password was accepted successfully.

Given the information in the bug report I can exclude case 1), consider case 2) unlikely and am sure that the condition grace time of number 3) is not the case.

So I assume we found a new way to exit kscreenlocker_greet successfully. My gut feeling tells me it's related to Qt's utterly broken multi screen handling including crashes when screens are turned off (see &quot;requesting unexisting screen 0&quot; in log). But to figure that out we would need the debug output of kscreenlocker_greet which is only available since <a href="http://commits.kde.org/kscreenlocker/a68dda3dd2a8a60e7f03beb5f0e652ef10fedbaa">http://commits.kde.org/kscreenlocker/a68dda3dd2a8a60e7f03beb5f0e652ef10fedbaa</a>

So we need to manually try that.

&#64;Dirk: can you please try to run:
1) run &quot;kscreenlocker_greet --testing&quot; from a konsole
2) turn off the display

Afterwards please tell us whether the application exited or not. If it did, please add the debug output from the konsole.

Please note that kscreenlocker_greet is installed into the libexec directory and is not in $PATH. Unfortunately I do not know where openSUSE installs that file.</pre>
    </div><div id="c6" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=964548#c6">Comment 6</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Antonio Larrosa</span>
</span>
        </span>

        <span class="bz_comment_time">
          2016-02-03 08:54:42 UTC
        </span>
      </div>



<pre class="bz_comment_text" >That would be at /usr/lib64/libexec/kscreenlocker_greet

Running /usr/lib64/libexec/kscreenlocker_greet --testing works right away. But just in case that commit Martin mentioned would be helpful, I backported it to plasma5-workspace 5.4.3. This patched version is available at <a href="https://build.opensuse.org/package/binaries/home:alarrosa:branches:bnc964548/plasma5-workspace?repository=standard">https://build.opensuse.org/package/binaries/home:alarrosa:branches:bnc964548/plasma5-workspace?repository=standard</a> . Dirk, maybe it would be nice if you could install it.</pre>
    </div><div id="c7" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=964548#c7">Comment 7</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Dirk Weber</span>
</span>
        </span>

        <span class="bz_comment_time">
          2016-02-03 21:43:55 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Thanks for the instructions, I will try to provide the logs tomorrow evening.</pre>
    </div><div id="c8" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=964548#c8">Comment 8</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Dirk Weber</span>
</span>
        </span>

        <span class="bz_comment_time">
          2016-02-04 16:27:12 UTC
        </span>
      </div>



<pre class="bz_comment_text" ><span class="quote">&gt; &#64;Dirk: can you please try to run:
&gt; 1) run &quot;kscreenlocker_greet --testing&quot; from a konsole
&gt; 2) turn off the display
&gt; 
&gt; Afterwards please tell us whether the application exited or not. If it did,
&gt; please add the debug output from the konsole.</span >

I followed the procedure.
after switching the monitor on again the kscreenlocker_greet was gone.

I attach the output of &quot;kscreenlocker_greet --testing&quot; and appended to it the content of .xsession-errors-:0

Also some check for the files which can not be opened according to the output of kscreenlocker_greet.</pre>
    </div><div id="c9" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=964548#c9">Comment 9</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Dirk Weber</span>
</span>
        </span>

        <span class="bz_comment_time">
          2016-02-04 16:30:28 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class=""><a href="attachment.cgi?id=664478" name="attach_664478" title="output of kscreenlocker_greet --testing; .xsession-errors-:0">attachment 664478</a> <a href="attachment.cgi?id=664478&amp;action=edit" title="output of kscreenlocker_greet --testing; .xsession-errors-:0">[details]</a></span>
output of kscreenlocker_greet --testing; .xsession-errors-:0

requested output of /usr/lib64/libexec/kscreenlocker_greet --testing</pre>
    </div><div id="c10" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=964548#c10">Comment 10</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Dirk Weber</span>
</span>
        </span>

        <span class="bz_comment_time">
          2016-02-04 17:58:31 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to Dirk Weber from <a href="show_bug.cgi?id=964548#c9">comment #9</a>)
<span class="quote">&gt; Created <span class=""><a href="attachment.cgi?id=664478" name="attach_664478" title="output of kscreenlocker_greet --testing; .xsession-errors-:0">attachment 664478</a> <a href="attachment.cgi?id=664478&amp;action=edit" title="output of kscreenlocker_greet --testing; .xsession-errors-:0">[details]</a></span>
&gt; output of kscreenlocker_greet --testing; .xsession-errors-:0
&gt; 
&gt; requested output of /usr/lib64/libexec/kscreenlocker_greet --testing</span >

additional observation: the output of kscreenlocker_greet --testing looks identical (except for the timestamp) on the affected system and on the not affected system.

The big difference is that on the not affected system the kscreenlocker_greet is still running after switching the monitor off and on.</pre>
    </div><div id="c11" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=964548#c11">Comment 11</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Martin Gräßlin</span>
</span>
        </span>

        <span class="bz_comment_time">
          2016-02-05 07:06:57 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Thank you. Interestingly I don't see anything odd in the output, but this gave me an idea. I'll try to verify with a test case.</pre>
    </div><div id="c12" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=964548#c12">Comment 12</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Martin Gräßlin</span>
</span>
        </span>

        <span class="bz_comment_time">
          2016-02-05 09:48:16 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Unfortunately I was not able to create a test case for the situation. X11 makes it difficult to test with dynamic XRandR screens (neither Xephyr nor Xvfb support XRandr, XWayland is broken), thus I decided to create the test case with Wayland.

Works fine, just that Qt makes kscreenlocker_greet crash in the situation and crashes are handled correctly, the screen stays locked.

The good part of that is that we can be quite certain that not many systems are affected as Qt used to crash on X11 as well.</pre>
    </div><div id="c13" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=964548#c13">Comment 13</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Martin Gräßlin</span>
</span>
        </span>

        <span class="bz_comment_time">
          2016-02-05 09:50:35 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class=""><a href="attachment.cgi?id=664559&amp;action=diff" name="attach_664559" title="Possible patch">attachment 664559</a> <a href="attachment.cgi?id=664559&amp;action=edit" title="Possible patch">[details]</a></span>
Possible patch

This is a possible patch against kscreenlocker to not exit when the last window closed. It compiles but I haven't tested it yet as I cannot reproduce the situation.

kscreenlocker used to be in plasma-workspace back in 5.4 release, but should apply nevertheless.

It would be awesome if this patch could be tested. If it works I'm going to contact KDE's security team about the issue.</pre>
    </div><div id="c14" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=964548#c14">Comment 14</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Jan Kundrát</span>
</span>
        </span>

        <span class="bz_comment_time">
          2016-02-05 11:36:01 UTC
        </span>
      </div>



<pre class="bz_comment_text" >I can reproduce the problem on a Gentoo box with Qt 5.6 from git (couple months old) and KF5/plasma from git (day or two old). My Plasma session was started on LVDS1, xrandr-ed to DP2, screen locked, and if I power-cycle my DP2 screen, the locker is gone.

After applying the patch, the locker bypass is gone, but there's a regression, another screen locker pops up immediately (but with a nice animation) after I unlock the older one. This only happens when there was a power cycle of the screen, and I can get back to my session after I've unlocked the second screenlocker.</pre>
    </div><div id="c15" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=964548#c15">Comment 15</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Antonio Larrosa</span>
</span>
        </span>

        <span class="bz_comment_time">
          2016-02-05 11:42:25 UTC
        </span>
      </div>



<pre class="bz_comment_text" >I added the patch from #c13 to the packages at:

<a href="https://build.opensuse.org/package/show/home:alarrosa:branches:bnc964548/plasma5-workspace">https://build.opensuse.org/package/show/home:alarrosa:branches:bnc964548/plasma5-workspace</a>

Btw, Dirk, if you tried to download them before, please try again, I forgot to enable the &quot;publish&quot; flag, but it should be working now.

If you don't want to add a new repository ( <a href="http://download.opensuse.org/repositories/home:/alarrosa:/branches:/bnc964548/standard/">http://download.opensuse.org/repositories/home:/alarrosa:/branches:/bnc964548/standard/</a> ) then you can install individual packages. In that case, I think just installing plasma5-workspace-5.4.3-10.1.x86_64.rpm and plasma5-workspace-libs-5.4.3-10.1.x86_64.rpm from <a href="https://build.opensuse.org/package/binaries/home:alarrosa:branches:bnc964548/plasma5-workspace?repository=standard">https://build.opensuse.org/package/binaries/home:alarrosa:branches:bnc964548/plasma5-workspace?repository=standard</a> should be enough.</pre>
    </div><div id="c16" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=964548#c16">Comment 16</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Dirk Weber</span>
</span>
        </span>

        <span class="bz_comment_time">
          2016-02-05 15:03:23 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to Antonio Larrosa from <a href="show_bug.cgi?id=964548#c15">comment #15</a>)
<span class="quote">&gt; I added the patch from #c13 to the packages at:
&gt; 
&gt; <a href="https://build.opensuse.org/package/show/home:alarrosa:branches:bnc964548/">https://build.opensuse.org/package/show/home:alarrosa:branches:bnc964548/</a>
&gt; plasma5-workspace
&gt; 
&gt; Btw, Dirk, if you tried to download them before, please try again, I forgot
&gt; to enable the &quot;publish&quot; flag, but it should be working now.</span >
today I was able to download them.
 
<span class="quote">&gt; ... just installing plasma5-workspace-5.4.3-10.1.x86_64.rpm and
&gt; plasma5-workspace-libs-5.4.3-10.1.x86_64.rpm from
&gt; <a href="https://build.opensuse.org/package/binaries/home:alarrosa:branches:bnc964548/">https://build.opensuse.org/package/binaries/home:alarrosa:branches:bnc964548/</a>
&gt; plasma5-workspace?repository=standard should be enough.</span >
I installed 
plasma5-workspace-libs-5.4.3-10.1.x86_64.rpm
plasma5-workspace-5.4.3-10.1.x86_64.rpm

With these I have the same behavior as described in #c14:
after switching the monitor off and back on the screen is locked.
After unlocking it it gets immediately locked again. 
After unlocking the second time the desktop is accessible.

This happens when the screen is locked by CTRL-Alt-L and as well as when started by
/usr/lib64/libexec/kscreenlocker_greet --testing</pre>
    </div><div id="c17" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=964548#c17">Comment 17</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Dirk Weber</span>
</span>
        </span>

        <span class="bz_comment_time">
          2016-02-05 15:11:00 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class=""><a href="attachment.cgi?id=664611" name="attach_664611" title="output of /usr/lib64/libexec/kscreenlocker_greet --testing with the patched version #c16">attachment 664611</a> <a href="attachment.cgi?id=664611&amp;action=edit" title="output of /usr/lib64/libexec/kscreenlocker_greet --testing with the patched version #c16">[details]</a></span>
output of /usr/lib64/libexec/kscreenlocker_greet --testing with the patched version #c16

output when using the packages with the patch from #c15
description of the result see #c16</pre>
    </div><div id="c18" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=964548#c18">Comment 18</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Lorenzo Desole</span>
</span>
        </span>

        <span class="bz_comment_time">
          2016-02-07 21:59:22 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Would it make sense, when there are no more screens, to exit kscreenlocker_greet with exit value == 1, to notify that a valid log-in didn't take place?</pre>
    </div><div id="c19" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=964548#c19">Comment 19</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Martin Gräßlin</span>
</span>
        </span>

        <span class="bz_comment_time">
          2016-02-08 07:18:45 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to Lorenzo Desole from <a href="show_bug.cgi?id=964548#c18">comment #18</a>)
<span class="quote">&gt; Would it make sense, when there are no more screens, to exit
&gt; kscreenlocker_greet with exit value == 1, to notify that a valid log-in
&gt; didn't take place?</span >

No, that's kind of a useless information in that case. Assuming we would do so, it would result in KSlD restarting the greeter which would exit again with 1, because there are no screens. Resulting in either a restart loop or in the emergency window being shown.</pre>
    </div><div id="c20" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=964548#c20">Comment 20</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Lorenzo Desole</span>
</span>
        </span>

        <span class="bz_comment_time">
          2016-02-08 08:30:45 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to Martin Gräßlin from <a href="show_bug.cgi?id=964548#c19">comment #19</a>)
<span class="quote">&gt; (In reply to Lorenzo Desole from <a href="show_bug.cgi?id=964548#c18">comment #18</a>)
&gt; &gt; Would it make sense, when there are no more screens, to exit
&gt; &gt; kscreenlocker_greet with exit value == 1, to notify that a valid log-in
&gt; &gt; didn't take place?
&gt; 
&gt; No, that's kind of a useless information in that case. Assuming we would do
&gt; so, it would result in KSlD restarting the greeter which would exit again
&gt; with 1, because there are no screens. Resulting in either a restart loop or
&gt; in the emergency window being shown.</span >

Not if the pre-condition is &quot;there was a screen, now it's been removed, there are no screens left&quot;. I am currently testing a patch, so far so good. If it behaves, later I can submit it here for you to check.</pre>
    </div><div id="c21" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=964548#c21">Comment 21</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Martin Gräßlin</span>
</span>
        </span>

        <span class="bz_comment_time">
          2016-02-08 09:00:39 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to Lorenzo Desole from <a href="show_bug.cgi?id=964548#c20">comment #20</a>)
<span class="quote">&gt; (In reply to Martin Gräßlin from <a href="show_bug.cgi?id=964548#c19">comment #19</a>)
&gt; &gt; (In reply to Lorenzo Desole from <a href="show_bug.cgi?id=964548#c18">comment #18</a>)
&gt; &gt; &gt; Would it make sense, when there are no more screens, to exit
&gt; &gt; &gt; kscreenlocker_greet with exit value == 1, to notify that a valid log-in
&gt; &gt; &gt; didn't take place?
&gt; &gt; 
&gt; &gt; No, that's kind of a useless information in that case. Assuming we would do
&gt; &gt; so, it would result in KSlD restarting the greeter which would exit again
&gt; &gt; with 1, because there are no screens. Resulting in either a restart loop or
&gt; &gt; in the emergency window being shown.
&gt; 
&gt; Not if the pre-condition is &quot;there was a screen, now it's been removed,
&gt; there are no screens left&quot;.</span >

sorry, but that's totally useless information for KSld. It doesn't need to know about it and it's also a not needed information in future. With Qt 5.6 we will get proper dummy QScreens in case there is no screen and on Wayland, well KWin is not so stupid as to remove the last screen ;-)

Anyway concerning the issue: upstream security team is involved now.</pre>
    </div><div id="c22" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=964548#c22">Comment 22</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Lorenzo Desole</span>
</span>
        </span>

        <span class="bz_comment_time">
          2016-02-08 11:25:55 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to Martin Gräßlin from <a href="show_bug.cgi?id=964548#c21">comment #21</a>)
<span class="quote">&gt; (In reply to Lorenzo Desole from <a href="show_bug.cgi?id=964548#c20">comment #20</a>)
&gt; &gt; (In reply to Martin Gräßlin from <a href="show_bug.cgi?id=964548#c19">comment #19</a>)
&gt; &gt; &gt; (In reply to Lorenzo Desole from <a href="show_bug.cgi?id=964548#c18">comment #18</a>)
&gt; &gt; &gt; &gt; Would it make sense, when there are no more screens, to exit
&gt; &gt; &gt; &gt; kscreenlocker_greet with exit value == 1, to notify that a valid log-in
&gt; &gt; &gt; &gt; didn't take place?
&gt; &gt; &gt; 
&gt; &gt; &gt; No, that's kind of a useless information in that case. Assuming we would do
&gt; &gt; &gt; so, it would result in KSlD restarting the greeter which would exit again
&gt; &gt; &gt; with 1, because there are no screens. Resulting in either a restart loop or
&gt; &gt; &gt; in the emergency window being shown.
&gt; &gt; 
&gt; &gt; Not if the pre-condition is &quot;there was a screen, now it's been removed,
&gt; &gt; there are no screens left&quot;.
&gt; 
&gt; sorry, but that's totally useless information for KSld. It doesn't need to
&gt; know about it and it's also a not needed information in future. With Qt 5.6
&gt; we will get proper dummy QScreens in case there is no screen and on Wayland,
&gt; well KWin is not so stupid as to remove the last screen ;-)
&gt; 
&gt; Anyway concerning the issue: upstream security team is involved now.</span >


Not even as a temporary fix? Because simply adding setQuitOnLastWindowClosed(false) leaves the screen locked but causes kscreenlocker_greet to crash. Which forces KSlD to take action and to respawn it. A clean exit would also force KSlD to respawn kscreenlocker_greet, but at least that happens at the proper time (i.e. when the last screen has been removed) hence you don't have to enter the password twice.

At least this is what happens in my test environment.</pre>
    </div><div id="c23" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=964548#c23">Comment 23</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Martin Gräßlin</span>
</span>
        </span>

        <span class="bz_comment_time">
          2016-02-08 12:38:08 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to Lorenzo Desole from <a href="show_bug.cgi?id=964548#c22">comment #22</a>)
<span class="quote">&gt; Not even as a temporary fix? Because simply adding
&gt; setQuitOnLastWindowClosed(false) leaves the screen locked but causes
&gt; kscreenlocker_greet to crash.</span >

No way, we don't work around crashes, we fix them!</pre>
    </div><div id="c24" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=964548#c24">Comment 24</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Bernhard Wiedemann</span>
</span>
        </span>

        <span class="bz_comment_time">
          2016-02-09 17:00:11 UTC
        </span>
      </div>



<pre class="bz_comment_text" >This is an autogenerated message for OBS integration:
This bug (964548) was mentioned in
<a href="https://build.opensuse.org/request/show/358584">https://build.opensuse.org/request/show/358584</a> Factory / kscreenlocker</pre>
    </div><div id="c25" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=964548#c25">Comment 25</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Sebastian Krahmer</span>
</span>
        </span>

        <span class="bz_comment_time">
          2016-02-10 09:31:14 UTC
        </span>
      </div>



<pre class="bz_comment_text" >CVE-2016-2312</pre>
    </div><div id="c26" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=964548#c26">Comment 26</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Lorenzo Desole</span>
</span>
        </span>

        <span class="bz_comment_time">
          2016-02-13 15:22:48 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to Martin Gräßlin from <a href="show_bug.cgi?id=964548#c23">comment #23</a>)
<span class="quote">&gt; (In reply to Lorenzo Desole from <a href="show_bug.cgi?id=964548#c22">comment #22</a>)
&gt; &gt; Not even as a temporary fix? Because simply adding
&gt; &gt; setQuitOnLastWindowClosed(false) leaves the screen locked but causes
&gt; &gt; kscreenlocker_greet to crash.
&gt; 
&gt; No way, we don't work around crashes, we fix them!</span >

OpenSuse has updated kscreenlocker with the proposed patch. As a result kscreenlocker doesn't exit when the monitor is switched off, but switching the monitor off still breaks something, because entering the password doesn't unlock it.

Everything is fine if I don't switch the monitor off.

$ /usr/lib64/libexec/kscreenlocker_greet --testing
Locked at 1455376791
file:///usr/share/plasma/look-and-feel/org.openSUSE.desktop/contents/components/InfoPane.qml:52:22: Unable to assign [undefined] to int
file:///usr/share/plasma/look-and-feel/org.openSUSE.desktop/contents/components/UserPasswordPrompt.qml:25: ReferenceError: userModel is not defined
file:///usr/share/plasma/look-and-feel/org.openSUSE.desktop/contents/components/UserDelegate.qml:82:9: QML Image: Cannot open: file:///usr/share/plasma/look-and-feel/org.openSUSE.desktop/contents/components/user-identity
file:///usr/share/plasma/look-and-feel/org.openSUSE.desktop/contents/components/UserDelegate.qml:82:9: QML Image: Cannot open: file:///usr/share/plasma/look-and-feel/org.openSUSE.desktop/contents/components/system-log-out
file:///usr/share/plasma/look-and-feel/org.openSUSE.desktop/contents/components/UserDelegate.qml:82:9: QML Image: Cannot open: file:///usr/share/plasma/look-and-feel/org.openSUSE.desktop/contents/components/system-switch-user
org.kde.keyboardLayout: Layouts list changed:  (&quot;it&quot;)
QXcbConnection: XCB error: 3 (BadWindow), sequence: 766, resource id: 0, major code: 21 (ListProperties), minor code: 0
file:///usr/share/plasma/look-and-feel/org.openSUSE.desktop/contents/components/InfoPane.qml:52:22: Unable to assign [undefined] to int
file:///usr/share/plasma/look-and-feel/org.openSUSE.desktop/contents/components/UserPasswordPrompt.qml:25: ReferenceError: userModel is not defined
file:///usr/share/plasma/look-and-feel/org.openSUSE.desktop/contents/components/UserDelegate.qml:82:9: QML Image: Cannot open: file:///usr/share/plasma/look-and-feel/org.openSUSE.desktop/contents/components/user-identity
file:///usr/share/plasma/look-and-feel/org.openSUSE.desktop/contents/components/UserDelegate.qml:82:9: QML Image: Cannot open: file:///usr/share/plasma/look-and-feel/org.openSUSE.desktop/contents/components/system-log-out
file:///usr/share/plasma/look-and-feel/org.openSUSE.desktop/contents/components/UserDelegate.qml:82:9: QML Image: Cannot open: file:///usr/share/plasma/look-and-feel/org.openSUSE.desktop/contents/components/system-switch-user
org.kde.keyboardLayout: Layouts list changed:  (&quot;it&quot;)
file:///usr/share/plasma/look-and-feel/org.openSUSE.desktop/contents/lockscreen/MainBlock.qml:85: TypeError: Property 'tryUnlock' of object function() { [code] } is not a function

The last line is printed out each time the password is entered.</pre>
    </div><div id="c27" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=964548#c27">Comment 27</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Lorenzo Desole</span>
</span>
        </span>

        <span class="bz_comment_time">
          2016-02-13 22:27:12 UTC
        </span>
      </div>



<pre class="bz_comment_text" >I don't know if this can be of some use nor do I know if it is a peculiarity of my setup.

I assumed that switching the monitor off is what causes kscreenlocker () to exit. That is incorrect. When the monitor is switched off, the screen  is not removed.  It is also worth noting that kscreenlocker (still without patch) works perfectly fine if it is executed when the monitor is off. It's when I switch it back on that the screen is removed and, after a split second, a new one is added. This causes all sorts of troubles to kscreenlocker.

I have modified UnlockApp::desktopResized() to printout the number of screen available and launched kscreenlocker in a loop:

$ while : ; do echo -e &quot;\n\n\n*** starting at $(date)***&quot;; echo &quot;Monitor is $(cat /sys/class/drm/card0-DP-2/status)&quot; ; greeter/kscreenlocker_greet --testing ; done

As soon as the login screen was shown, I switched off the monitor and waited for about a minute. This is the output I got:

*** starting at sab 13 feb 2016, 22.58.35, CET***
Monitor is connected
UnlockApp::desktopResized() - Screen count: 1
Locked at 1455400716
file:///usr/share/plasma/look-and-feel/org.openSUSE.desktop/contents/components/InfoPane.qml:52:22: Unable to assign [undefined] to int
file:///usr/share/plasma/look-and-feel/org.openSUSE.desktop/contents/components/UserPasswordPrompt.qml:25: ReferenceError: userModel is not defined
file:///usr/share/plasma/look-and-feel/org.openSUSE.desktop/contents/components/UserDelegate.qml:82:9: QML Image: Cannot open: file:///usr/share/plasma/look-and-feel/org.openSUSE.desktop/contents/components/user-identity
file:///usr/share/plasma/look-and-feel/org.openSUSE.desktop/contents/components/UserDelegate.qml:82:9: QML Image: Cannot open: file:///usr/share/plasma/look-and-feel/org.openSUSE.desktop/contents/components/system-log-out
file:///usr/share/plasma/look-and-feel/org.openSUSE.desktop/contents/components/UserDelegate.qml:82:9: QML Image: Cannot open: file:///usr/share/plasma/look-and-feel/org.openSUSE.desktop/contents/components/system-switch-user
org.kde.keyboardLayout: Layouts list changed:  (&quot;it&quot;)
UnlockApp::desktopResized() - Screen count: 0



*** starting at sab 13 feb 2016, 22.59.32, CET***
Monitor is disconnected
UnlockApp::desktopResized() - Screen count: 1
Locked at 1455400772
QXcbConnection: XCB error: 148 (Unknown), sequence: 170, resource id: 0, major code: 140 (Unknown), minor code: 20
UnlockApp::desktopResized() - Screen count: 2
file:///usr/share/plasma/look-and-feel/org.openSUSE.desktop/contents/components/InfoPane.qml:52:22: Unable to assign [undefined] to int
file:///usr/share/plasma/look-and-feel/org.openSUSE.desktop/contents/components/UserPasswordPrompt.qml:25: ReferenceError: userModel is not defined
file:///usr/share/plasma/look-and-feel/org.openSUSE.desktop/contents/components/UserDelegate.qml:82:9: QML Image: Cannot open: file:///usr/share/plasma/look-and-feel/org.openSUSE.desktop/contents/components/user-identity
file:///usr/share/plasma/look-and-feel/org.openSUSE.desktop/contents/components/UserDelegate.qml:82:9: QML Image: Cannot open: file:///usr/share/plasma/look-and-feel/org.openSUSE.desktop/contents/components/system-log-out
file:///usr/share/plasma/look-and-feel/org.openSUSE.desktop/contents/components/UserDelegate.qml:82:9: QML Image: Cannot open: file:///usr/share/plasma/look-and-feel/org.openSUSE.desktop/contents/components/system-switch-user
org.kde.keyboardLayout: Layouts list changed:  (&quot;it&quot;)
file:///usr/share/plasma/look-and-feel/org.openSUSE.desktop/contents/components/InfoPane.qml:52:22: Unable to assign [undefined] to int
file:///usr/share/plasma/look-and-feel/org.openSUSE.desktop/contents/components/UserPasswordPrompt.qml:25: ReferenceError: userModel is not defined
file:///usr/share/plasma/look-and-feel/org.openSUSE.desktop/contents/components/UserDelegate.qml:82:9: QML Image: Cannot open: file:///usr/share/plasma/look-and-feel/org.openSUSE.desktop/contents/components/user-identity
file:///usr/share/plasma/look-and-feel/org.openSUSE.desktop/contents/components/UserDelegate.qml:82:9: QML Image: Cannot open: file:///usr/share/plasma/look-and-feel/org.openSUSE.desktop/contents/components/system-log-out
file:///usr/share/plasma/look-and-feel/org.openSUSE.desktop/contents/components/UserDelegate.qml:82:9: QML Image: Cannot open: file:///usr/share/plasma/look-and-feel/org.openSUSE.desktop/contents/components/system-switch-user
org.kde.keyboardLayout: Layouts list changed:  (&quot;it&quot;)

My deductions are:

1) kscreenlocker exited as soon I switched the monitor back on, not when I had previously switched it off.
2) the while/do loop immediately launched a new instance of kscreenlocker, but the monitor was still being reported off by Xrandr; UnlockApp::desktopResized() reports one screen though
3) there's a strange QXcbConnection: XCB error
4) A new (the real one) screen is added and UnlockApp::desktopResized() reports TWO screens, the fake/virtual/whatever one is not removed).
5) At that point kscreenlocker showed *two* password windows

If I add a &quot;sleep 1&quot; into the middle of the loop, the &quot;QXcbConnection: XCB error doesn't happen&quot;, only one screen is reported by UnlockApp::desktopResized() and only one password window is shown.</pre>
    </div><div id="c28" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=964548#c28">Comment 28</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Lorenzo Desole</span>
</span>
        </span>

        <span class="bz_comment_time">
          2016-02-14 22:55:01 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class="bz_obsolete"><a href="attachment.cgi?id=665550&amp;action=diff" name="attach_665550" title="When the last windows gets closed, reset a few things and objects in kscreenlocker">attachment 665550</a> <a href="attachment.cgi?id=665550&amp;action=edit" title="When the last windows gets closed, reset a few things and objects in kscreenlocker">[details]</a></span>
When the last windows gets closed, reset a few things and objects in kscreenlocker

app.setQuitOnLastWindowClosed(false) solves the security issue, but causes a regression: power cycling the monitor breaks kscreenlocker which, after that, refuses to accept the correct password.

The proposed patch resets a few internal things in kscreenlocker when a lastWindowClosed event is received.

It fixes the regression for me.

QT is not my cup of tea, I basically know nothing about the KDE internals, so I could have missed something or broken other stuff. But, still, it works for me.</pre>
    </div><div id="c29" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=964548#c29">Comment 29</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Martin Gräßlin</span>
</span>
        </span>

        <span class="bz_comment_time">
          2016-02-15 06:36:04 UTC
        </span>
      </div>



<pre class="bz_comment_text" >The only real new code is the deletion of the Authenticator and the recreation of it. Everything else should already be done.

So the question is: why does the Authenticator needs to be recreated?

Personally I'm not really motivated in investigating it as with Qt 5.6 this should auto-resolve itself.

Otherwise I recommend to create a new bug report for the new issue (this one is about the vulnerability) and also to move it upstream (bugs.kde.org).</pre>
    </div><div id="c30" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=964548#c30">Comment 30</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andreas Stieger</span>
</span>
        </span>

        <span class="bz_comment_time">
          2016-02-20 08:35:51 UTC
        </span>
      </div>



<pre class="bz_comment_text" >releasing for 42.1</pre>
    </div><div id="c31" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=964548#c31">Comment 31</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Lorenzo Desole</span>
</span>
        </span>

        <span class="bz_comment_time">
          2016-02-20 09:47:40 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to Andreas Stieger from <a href="show_bug.cgi?id=964548#c30">comment #30</a>)
<span class="quote">&gt; releasing for 42.1</span >

I urge you to reconsider that.

Depending on the lockscreen theme in use, in case of monitor (un)plugging, you get:

1) a crash after entering the password; this will cause kscreenlocker to be respawned. It's a minor annoyance because you can re-enter the password and everything is fine

or

2) kscreenlocker can't be unlocked at all, i.e. you are locked out of your PC. This is a severe regression.

I get #1 with the internal fallback lockscreen.

I get #2 with the opensuse lockscreen.

Apparently this can't be fixed and upstream doesn't like the proposed workarounds.</pre>
    </div><div id="c32" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=964548#c32">Comment 32</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Swamp Workflow Management</span>
</span>
        </span>

        <span class="bz_comment_time">
          2016-02-20 12:12:33 UTC
        </span>
      </div>



<pre class="bz_comment_text" >openSUSE-RU-2016:0522-1: An update that solves one vulnerability and has one errata is now available.

Category: recommended (moderate)
Bug References: 954623,964548
CVE References: CVE-2016-2312
Sources used:
openSUSE Leap 42.1 (src):    bluedevil5-5.5.4-6.1, breeze-5.5.4-7.1, breeze4-style-5.5.4-7.1, kcm_sddm-5.5.4-7.1, kde-cli-tools5-5.5.4-6.1, kde-gtk-config5-5.5.4-6.1, kde-user-manager-5.5.4-6.1, kgamma5-5.5.4-6.1, khelpcenter5-5.5.4-6.2, khotkeys5-5.5.4-6.2, kinfocenter5-5.5.4-6.1, kmenuedit5-5.5.3-6.5, kscreen5-5.5.4-7.1, kscreenlocker-5.5.4-4.1, ksshaskpass5-5.5.4-6.1, ksysguard5-5.5.4-8.2, kwayland-5.5.4-9.1, kwayland-integration-5.5.4-6.1, kwin5-5.5.4-9.3, kwrited5-5.5.4-6.1, libkdecoration2-5.5.4-6.1, libkscreen2-5.5.4-6.1, libksysguard5-5.5.4-6.1, milou5-5.5.4-6.1, oxygen5-5.5.4-6.1, plasma-nm5-5.5.4-6.3, plasma5-addons-5.5.4-6.1, plasma5-desktop-5.5.4-9.2, plasma5-mediacenter-5.5.4-6.1, plasma5-openSUSE-13.3-29.1, plasma5-pa-5.5.4-6.1, plasma5-sdk-5.5.4-6.1, plasma5-session-5.5.4-6.1, plasma5-workspace-5.5.4-9.1, plasma5-workspace-wallpapers-5.5.4-6.1, polkit-kde-agent-5-5.5.4-6.1, powerdevil5-5.5.4-6.1, systemsettings5-5.5.4-6.1</pre>
    </div><div id="c33" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=964548#c33">Comment 33</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Lorenzo Desole</span>
</span>
        </span>

        <span class="bz_comment_time">
          2016-02-20 17:39:58 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class=""><a href="attachment.cgi?id=666317&amp;action=diff" name="attach_666317" title="This should resolve the remaining issues">attachment 666317</a> <a href="attachment.cgi?id=666317&amp;action=edit" title="This should resolve the remaining issues">[details]</a></span>
This should resolve the remaining issues

If anyone's interested, this patch should resolve the issues caused by patch 664559 till QT 5.6 comes out.
It also takes into account Martin's objection to my previous idea, i.e. &quot;KSld doesn't need to know about [monitor unplugged] and it's also a not needed information in future&quot;.
It's a workaround at best, but at least it gives me a usable screenlocker.

What it does:

1) it catches the lastWindowClosed signal and executes QCoreApplication::exit() with retcode = 123
2) &quot;main()&quot; in main.cpp checks the return code after app.exec(). If it is 123, it re-creates the UnlockApp class and re-executes it, otherwise it exits.

Crashes are gone and so is the &quot;ignore the correct password&quot; problem.</pre>
    </div><div id="c34" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=964548#c34">Comment 34</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Jason Newton</span>
</span>
        </span>

        <span class="bz_comment_time">
          2016-04-29 23:21:49 UTC
        </span>
      </div>



<pre class="bz_comment_text" >can we get the proper fix to this in updates?

I too am affected by this and it's pretty embarrassing to deal with it - in a way that hurts OpenSUSE's reputation.</pre>
    </div><div id="c35" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=964548#c35">Comment 35</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andreas Stieger</span>
</span>
        </span>

        <span class="bz_comment_time">
          2016-05-03 08:00:28 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to Jason Newton from <a href="show_bug.cgi?id=964548#c34">comment #34</a>)
<span class="quote">&gt; can we get the proper fix to this in updates?</span >

Redirecting this question tho the KDE maintainers?</pre>
    </div><div id="c36" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=964548#c36">Comment 36</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Martin Gräßlin</span>
</span>
        </span>

        <span class="bz_comment_time">
          2016-05-03 12:18:44 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to Andreas Stieger from <a href="show_bug.cgi?id=964548#c35">comment #35</a>)
<span class="quote">&gt; (In reply to Jason Newton from <a href="show_bug.cgi?id=964548#c34">comment #34</a>)
&gt; &gt; can we get the proper fix to this in updates?
&gt; 
&gt; Redirecting this question tho the KDE maintainers?</span >

Please report any remaining issues on bugs.kde.org. Sorry, but I cannot monitor distribution bugtrackers in addition to bugs.kde.org - there are just too many distributions.</pre>
    </div><div id="c37" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=964548#c37">Comment 37</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Andreas Stieger</span>
</span>
        </span>

        <span class="bz_comment_time">
          2016-05-03 12:29:16 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to Martin Gräßlin from <a href="show_bug.cgi?id=964548#c36">comment #36</a>)
<span class="quote">&gt; Please report any remaining issues on bugs.kde.org. Sorry, but I cannot
&gt; monitor distribution bugtrackers in addition to bugs.kde.org - there are
&gt; just too many distributions.</span >

Thanks and agree, restoring previous state.</pre>
    </div><div id="c38" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=964548#c38">Comment 38</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Jason Newton</span>
</span>
        </span>

        <span class="bz_comment_time">
          2016-05-03 14:22:48 UTC
        </span>
      </div>



<pre class="bz_comment_text" >&#64;Andreas , &#64;Martin - let me clarify, I'm having the issue brought up by the patch that Lorenzo reports,

With &quot;file:///usr/share/plasma/look-and-feel/org.openSUSE.desktop/contents/lockscreen/MainBlock.qml:85: TypeError: Property 'tryUnlock' of object function() { [code] } is not a function&quot;

I note that it takes a little while after the monitor is turned off - and by turned off, I mean monitor suspend makes it happen.

If you still wish for me to file the bug at bugs.kde.org, will do so but I just wanted to make sure we weren't too suse specific since there's this patch mentioned in this thread.</pre>
    </div><div id="c39" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=964548#c39">Comment 39</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Martin Gräßlin</span>
</span>
        </span>

        <span class="bz_comment_time">
          2016-05-03 14:25:18 UTC
        </span>
      </div>



<pre class="bz_comment_text" >well no, I'm not interested in bug reports about patched software :-)</pre>
    </div><div id="c40" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=964548#c40">Comment 40</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Lorenzo Desole</span>
</span>
        </span>

        <span class="bz_comment_time">
          2016-05-03 14:39:48 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to Martin Gräßlin from <a href="show_bug.cgi?id=964548#c39">comment #39</a>)
<span class="quote">&gt; well no, I'm not interested in bug reports about patched software :-)</span >


I agree. There's however a tiny detail: it is your patch that causes it, mine was merely intended to print more debug stuff to help investigate the problem.

See <a href="show_bug.cgi?id=964548#c26">comment #26</a>.</pre>
    </div><div id="c41" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=964548#c41">Comment 41</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Lorenzo Desole</span>
</span>
        </span>

        <span class="bz_comment_time">
          2016-05-03 15:23:41 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to Lorenzo Desole from <a href="show_bug.cgi?id=964548#c40">comment #40</a>)
<span class="quote">&gt; (In reply to Martin Gräßlin from <a href="show_bug.cgi?id=964548#c39">comment #39</a>)
&gt; &gt; well no, I'm not interested in bug reports about patched software :-)
&gt; 
&gt; 
&gt; I agree. There's however a tiny detail: it is your patch that causes it,
&gt; mine was merely intended to print more debug stuff to help investigate the
&gt; problem.
&gt; 
&gt; See <a href="show_bug.cgi?id=964548#c26">comment #26</a>.</span >

To clear the issue: OpenSuse is now shipping kscreenlocker with the &quot;setQuitOnLastWindowClosed(false)&quot; patch. I.e. your patch. That same patch triggers a regression that manifests itself either with a crash (in which case kscreenlocker gets relaunched and eventually the user can log in) or with some obscure error that prevents the user from logging in.</pre>
    </div><div id="c42" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=964548#c42">Comment 42</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Jason Newton</span>
</span>
        </span>

        <span class="bz_comment_time">
          2016-05-03 18:25:16 UTC
        </span>
      </div>



<pre class="bz_comment_text" >so we're back to what is to be done here? I don't want to put expectations but it sounds like a pretty bad bug to ship with and have no resolution other than maybe what I'm trying...

I *may* get by with a qt 5.6 update / kde update by adding KDE:Frameworks5 and KDE:Qt5 repos - but I really wish I didn't have to and generally I don't like moving off base system Qt because applications may suffer...

Should we leave this as resolved as to my eyes it seems like it should be left open until a proper course of action is taken or work around listed.</pre>
    </div><div id="c43" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=964548#c43">Comment 43</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Lorenzo Desole</span>
</span>
        </span>

        <span class="bz_comment_time">
          2016-05-03 19:01:15 UTC
        </span>
      </div>



<pre class="bz_comment_text" >If you have a chance, please test this patch I made:
<a href="https://bugzilla.opensuse.org/attachment.cgi?id=666317">https://bugzilla.opensuse.org/attachment.cgi?id=666317</a>

Let me know if it fixes it for you like it does for me.

Regarding the status of this bug report, I agree that &quot;Fixed&quot; is not appropriate, kscreenlocker is still badly broken. More suitable would be &quot;Reopened&quot; or &quot;Resolved -&gt; WONTIFIX&quot;. The latter if the powers that be decide that the purpose of a screenlocker is actually lock you out of your PC.</pre>
    </div>


  

</td>
<td>
</td>
</tr></table>
  </div>
        

</form>

<hr>
<ul class="related_actions">
    <li><a href="show_bug.cgi?format=multiple&amp;id=964548">Format For Printing</a></li>
    <li>&nbsp;-&nbsp;<a href="show_bug.cgi?ctype=xml&amp;id=964548">XML</a></li>
    <li>&nbsp;-&nbsp;<a href="enter_bug.cgi?cloned_bug_id=964548">Clone This Bug</a></li>
    
    <li>&nbsp;-&nbsp;<a href="#">Top of page </a></li>
    </ul>        


<div class="navigation">
  
  <i><font color="#777777">First</font></i>
  <i><font color="#777777">Last</font></i>
  <i><font color="#777777">Prev</font></i>
  <i><font color="#777777">Next</font></i>
  &nbsp;&nbsp;
  <i><font color="#777777">This bug is not in your last
    search results.</font></i>
</div>

<br>
</div>



<div id="footer">
  <div class="intro"></div>




<ul id="useful-links">
  <li id="links-actions"><ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi?classification=openSUSE">New</a></li>
  <li><span class="separator">| </span><a href="describecomponents.cgi">Browse</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_bottom" name="no_redirect" value="0">
    <script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_bottom");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_bottom" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_bottom"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li>
      <span class="separator">| </span>
        <a href="request.cgi">Requests</a></li>

  <li>
        <span class="separator">| </span>
        <a href="docs/en/html/bug_page.html" target="_blank">Help</a>
      </li>
    

    <li id="mini_login_container_bottom">
  <span class="separator">| </span>
  <!--a id="login_link_bottom" href="show_bug.cgi?id=964548&amp;GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('_bottom')">Log In</a-->
  <a id="login_link_bottom" href="show_bug.cgi?id=964548&amp;GoAheadAndLogIn=1">Log In</a>


  <form action="show_bug.cgi?id=964548" method="POST" 
        class="mini_login bz_default_hidden"
        id="mini_login_bottom"
        onsubmit="return check_mini_login_fields( '_bottom' );"
  >
    <input id="Bugzilla_login_bottom" 
           class="bz_login"
           name="Bugzilla_login"
           title="Login"
           onfocus="mini_login_on_focus('_bottom')"
    >
    <input class="bz_password" 
           id="Bugzilla_password_bottom" 
           name="Bugzilla_password"
           type="password"
           title="Password"
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text" 
           id="Bugzilla_password_dummy_bottom" value="password"
           title="Password"
           onfocus="mini_login_on_focus('_bottom')"
    >
    <input type="submit" name="GoAheadAndLogIn" value="Log in" 
            id="log_in_bottom">
    <script type="text/javascript">
      mini_login_constants = {
          "login" : "login",
          "warning" : "You must set the login and password before logging in."
      };
      
      if (YAHOO.env.ua.gecko || YAHOO.env.ua.ie || YAHOO.env.ua.opera) {
          YAHOO.util.Event.onDOMReady(function() {
              init_mini_login_form('_bottom');
          });
      }
      else {
          YAHOO.util.Event.on(window, 'load', function () {
              window.setTimeout(function() {
                  init_mini_login_form('_bottom');
              }, 200);
          });
    }
    </script>
    <a href="#" onclick="return hide_mini_login_form('_bottom')">[x]</a>
  </form>
</li>
<li id="forgot_container_bottom">
  <span class="separator">| </span>
  <a id="forgot_link_bottom" href="https://idp-portal.suse.com/univention/self-service/#page=passwordreset">Forgot Password</a>
</li>
</ul>
  </li>

  
    


  <form id="testopia_helper_frm"></form><ul class="links">
    <li>Legal: </li>
    <li><a href="http://en.opensuse.org/Terms_of_site">openSUSE</a></li>
    <li><a href="https://www.suse.com/company/legal/">SUSE</a></li>
  </ul>
</ul>

  <div class="outro"></div>
</div>


</body>
</html>