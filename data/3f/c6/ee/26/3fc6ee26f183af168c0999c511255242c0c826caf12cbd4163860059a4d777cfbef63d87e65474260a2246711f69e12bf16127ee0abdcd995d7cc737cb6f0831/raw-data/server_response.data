<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
          "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
  <meta http-equiv="Content-Type" ccontent="text/html; charset=UTF-8" />
  <link rel="stylesheet" type="text/css" href="../basic.css" />
  <title>GreaseKit (and Creammonkey) GM APIs Vulnerability</title>
</head>

<body>

<div id="header">
  <h1>GreaseKit (and Creammonkey) GM APIs Vulnerability</h1>
  <p>Published: 2007-12-26</p>
</div>
<div id="content">
  <p><a href="20071226-ja.html">Japanese version</a> is also available.</p>
  <h2>Summary</h2>
  <p>
    The security vulnerability discovered in GreaseKit and Creammonkey,
    which can be exploited by malicious people to
    send a (cross-site) HTTP request, or read/write configuration values.
    Please upgrade to GreaseKit 1.4.
  </p>

  <h2>Affected Software Versions</h2>
  <ul>
    <li>GreaseKit 1.2 - 1.3</li>
    <li>Creammonkey 0.9 - 1.1</li>
  </ul>

  <p>To verify the version number,</p>

  <h3>Creammonkey</h3>
  <p>
    Launch Safari and from the &quot;:)&quot; menu,
    choose &quot;About Creammonkey&quot;.
  </p>

  <h3>GreaseKit</h3>
  <p>
    Launch Safari (or GreaseKit-enabled application) and
    from the &quot;GreaseKit&quot; or &quot;:)&quot; menu,
    choose &quot;About GreaseKit&quot;.
  </p>

  <h2>Solution</h2>
  <p>
    The vulnerability has been fixed in GreaseKit 1.4 by reducing the functionality.
  </p>

  <h2>Details</h2>
  <p>
    GreaseKit provides 6 functions
    (GM_addStyle, GM_log, GM_openInTab, GM_setValue, GM_getValue and GM_xmlhttpRequest)
    for userscript.
    For security reason, these functions are not callable from a web page.
  </p>
  <p>
    However, the vulnerability could allow an attacker
    to execute these functions from a web page.
    Successful exploitation requires that a userscript is
    configured to run on the malicious web page.
  </p>

  <h2>Contact</h2>
  <p>
    KATO Kazuyoshi &lt;kzys@8-p.info&gt;
  </p>
</body>
</html>
