<!DOCTYPE html>
<html lang="en">
<head>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-92665328-1"></script>
<script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        
        gtag('config', 'UA-92665328-1');
    </script>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
<title>[CVE-2017-5947] OnePlus EDL triggering through ADB or Hardware Key Combination</title>
<meta name="name" content="CVE-2017-5947">
<meta name="description" content="OnePlus EDL triggering through ADB or Hardware Key Combination">
<meta name="image" content="https://alephsecurity.com/assets/img/logo-black.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@alephsecurity">
<meta name="twitter:creator" content="@alephsecurity">
<meta name="twitter:title" content="CVE-2017-5947">
<meta name="twitter:url" content="https://alephsecurity.com/vulns/aleph-2017007">
<meta name="twitter:description" content="OnePlus EDL triggering through ADB or Hardware Key Combination">
<meta name="twitter:image:src" content="https://alephsecurity.com/assets/img/logo-black.png">
<meta property="og:site_name" content="">
<meta property="og:title" content="CVE-2017-5947">
<meta property="og:type" content="article">
<meta property="og:description" content="OnePlus EDL triggering through ADB or Hardware Key Combination">
<meta property="og:url" content="https://alephsecurity.com/vulns/aleph-2017007">
<meta property="article:published_time" content="2018-01-22T00:00:00+00:00">
<meta property="article:author" content="https://alephsecurity.com">
<meta property="og:image" content="https://alephsecurity.com/assets/img/logo-black.png">
<link rel="icon" href="/favicon.png">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inconsolata:400,700">
<link rel="stylesheet" type="text/css" href="/assets/css/main.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css" integrity="sha384-wITovz90syo1dJWVh32uuETPVEtGigN07tkttEqPv+uR2SE/mbQcG7ATL28aI9H0" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.js" integrity="sha384-/y1Nn9+QQAipbNQWU65krzJralCnuOasHncUFXGkdwntGeSvQicrYkiUBwsgUqc1" crossorigin="anonymous"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      messageStyle: "none",
      tex2jax: {preview: "none"},
      CommonHTML: { linebreaks: { automatic: true } },
      "HTML-CSS": { linebreaks: { automatic: true } },
      SVG: { linebreaks: { automatic: true } }
    });
    </script>
<script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
</head>
<body>
<div class="wrapper">
<div class="page__back">
<a href="/">&lt;-- <span class="smallogo">א</span></a>
</div>
<div class="page">
<div class="advisory">
<div class="advisory__title">
<h1>OnePlus EDL triggering through ADB or Hardware Key Combination</h1>
</div>
<div class="advisory__subtitle">
Aleph Research Advisory
</div>
<div class="advisory__meta">
<p></p>
</div>
<h2>Identifier</h2>
<div class="cve-high"><span class="" title="OnePlus EDL triggering through ADB or Hardware Key Combination"><a href="/vulns/aleph-2017007">CVE-2017-5947</a></span></div>
<h2>Severity</h2>
High
<h2>Products</h2>
<div class="numberedlistnoalternative">
<ol>
<li><p>OnePlus One</p>
</li>
<li><p>OnePlus X</p>
</li>
<li><p>OnePlus 2</p>
</li>
<li><p>OnePlus 3</p>
</li>
<li><p>OnePlus 3T</p>
</li>
<li><p>OnePlus 5</p>
</li>
</ol>
</div>
<h2>Vulnerable Version</h2>
<p>OxygenOS 5.0 and below</p>
<h2>Technical Details</h2>
<div class="advisory__content" ?>
<p>OxygenOS running in OnePlus devices allows rebooting into the Qualcomm Emergency Download (EDL) Mode through ADB, by issuing the <code class="language-plaintext highlighter-rouge">adb reboot edl</code> command, or by using a hardware key (Volume-UP) when the device is connected to USB.
Since Firehose programmers of various OnePlus devices have been leaked, one could exploit them in order to downgrade critical partitions such as the Android Bootloader, which enables exploitation of old vulnerabilities.</p>
<table>
<thead>
<tr>
<th>Device</th>
<th>SoC</th>
<th>Programmer</th>
<th>Tested</th>
<th>SHA256</th>
</tr>
</thead>
<tbody>
<tr>
<td>OnePlus 5 (cheeseburger)</td>
<td>MSM8998</td>
<td>&lt;embedded in an archive&gt;</td>
<td>yes</td>
<td>02ffdaa49cf25f7ff287cab82da0e4f943cabf6e6a4bfe31c3198d1c2cfa1185</td>
</tr>
<tr>
<td>OnePlus 3T</td>
<td>MSM8996</td>
<td>prog_ufs_firehose_8996_lite.elf</td>
<td>yes</td>
<td>eef93d29e4edda26cce493b859e22161853439de7b2151a47dafe3068ee43abe</td>
</tr>
<tr>
<td> </td>
<td> </td>
<td>prog_ufs_firehose_8996_ddr.elf</td>
<td>yes</td>
<td>a1b7eb81c61525d6819916847e02e9ae5031bf163d246895780bd0e3f786c7ee</td>
</tr>
<tr>
<td>OnePlus 3</td>
<td>MSM8996</td>
<td>prog_ufs_firehose_8996_lite.elf</td>
<td>yes</td>
<td>97eff4d4111dd90523f6182e05650298b7ae803f0ec36f69a643c031399d8d13</td>
</tr>
<tr>
<td> </td>
<td> </td>
<td>prog_ufs_firehose_8996_ddr.elf</td>
<td>yes</td>
<td>c34ec1fddfac05d8f63eed3ee90c8e6983fe2b0e4b2837b30d8619a29633649c</td>
</tr>
<tr>
<td>OnePlus 2</td>
<td>MSM8994</td>
<td>prog_emmc_firehose_8994_lite.mbn</td>
<td>yes</td>
<td>63a47e46a664ccd1244a36535d10ca0b97b50b510bd481252f786177197c3c44</td>
</tr>
<tr>
<td>OnePlus X</td>
<td>MSM8974</td>
<td>prog_emmc_firehose_8974.mbn</td>
<td>yes</td>
<td>964b5c486b200aa6462733a682f9cead3ebfad555ce2ff3622fea8b279b006ee</td>
</tr>
<tr>
<td>OnePlus One</td>
<td>MSM8974</td>
<td>prog_emmc_firehose_8974.mbn</td>
<td>no</td>
<td>71c4f97535893ba7a3177320143ac94db4c6584544c01b61860aca80a477d4c9</td>
</tr>
</tbody>
</table>
</div>
<h2>Timeline</h2>
<div class="list"><ul><li><div class="list__date"><span>22-Jan-18<span></div>: Public disclosure.</li><li><div class="list__date"><span>01-Mar-17<span></div>: Added as <span class="cve-high" title="OnePlus EDL triggering through ADB or Hardware Key Combination"><a href="/vulns/aleph-2017007">ALEPH-2017007</a></span>.</li><li><div class="list__date"><span>10-Feb-17<span></div>: <span class="cve-high" title="OnePlus EDL triggering through ADB or Hardware Key Combination"><a href="/vulns/aleph-2017007">CVE-2017-5947</a></span> assigned.</li><li><div class="list__date"><span>09-Feb-17<span></div>: CVE ID requested.</li><li><div class="list__date"><span>19-Jan-17<span></div>: Reported.</li></ul></div>
<h2>Posts</h2>
<div class="pagelist__narrow"><ul>  <li onclick="javscript:document.location.href='/2018/01/22/qualcomm-edl-5/'"> <a href="/2018/01/22/qualcomm-edl-5/">Exploiting Qualcomm EDL Programmers (5): Breaking Nokia 6's Secure Boot </a> <div class="pagelist__subtitle">By <a href="/authors/roeeh">Roee Hay</a> & <a href="/authors/noamh">Noam Hadad</a>, <div class="pagelist__date"><span>22-Jan 2018</span></div></div></li> <li onclick="javscript:document.location.href='/2018/01/22/qualcomm-edl-4/'"> <a href="/2018/01/22/qualcomm-edl-4/">Exploiting Qualcomm EDL Programmers (4): Runtime Debugger </a> <div class="pagelist__subtitle">By <a href="/authors/roeeh">Roee Hay</a> & <a href="/authors/noamh">Noam Hadad</a>, <div class="pagelist__date"><span>22-Jan 2018</span></div></div></li> <li onclick="javscript:document.location.href='/2018/01/22/qualcomm-edl-3/'"> <a href="/2018/01/22/qualcomm-edl-3/">Exploiting Qualcomm EDL Programmers (3): Memory-based Attacks & PBL Extraction </a> <div class="pagelist__subtitle">By <a href="/authors/roeeh">Roee Hay</a> & <a href="/authors/noamh">Noam Hadad</a>, <div class="pagelist__date"><span>22-Jan 2018</span></div></div></li> <li onclick="javscript:document.location.href='/2018/01/22/qualcomm-edl-2/'"> <a href="/2018/01/22/qualcomm-edl-2/">Exploiting Qualcomm EDL Programmers (2): Storage-based Attacks & Rooting </a> <div class="pagelist__subtitle">By <a href="/authors/roeeh">Roee Hay</a> & <a href="/authors/noamh">Noam Hadad</a>, <div class="pagelist__date"><span>22-Jan 2018</span></div></div></li> <li onclick="javscript:document.location.href='/2018/01/22/qualcomm-edl-1/'"> <a href="/2018/01/22/qualcomm-edl-1/">Exploiting Qualcomm EDL Programmers (1): Gaining Access & PBL Internals </a> <div class="pagelist__subtitle">By <a href="/authors/roeeh">Roee Hay</a> & <a href="/authors/noamh">Noam Hadad</a>, <div class="pagelist__date"><span>22-Jan 2018</span></div></div></li> </ul></div>
<h2>Credit</h2>
<div class="list">
<ul>
<li>
<a href="/authors/roeeh">Roee Hay</a> (<a href="https://twitter.com/roeehay">@roeehay</a>) of Aleph Research, HCL Technologies
</li>
</ul>
</div>
</div>
</div>
</div>
</body>
</html>
