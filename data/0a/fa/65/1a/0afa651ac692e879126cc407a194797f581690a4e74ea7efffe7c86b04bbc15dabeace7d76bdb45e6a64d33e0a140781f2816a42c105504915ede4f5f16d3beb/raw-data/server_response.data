<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
<link rel="icon" href="/favicon.png">
<title>#600130 - Insecure temporary file and stack buffer overflow - Debian Bug report logs</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="/css/bugs.css" type="text/css">

<link rel="canonical" href="&lt;a href=&quot;bugreport.cgi?bug=600130&quot;&gt;600130&lt;/a&gt;">
<script type="text/javascript">
<!--
function toggle_infmessages()
{
        allDivs=document.getElementsByTagName("div");
        for (var i = 0 ; i < allDivs.length ; i++ )
        {
                if (allDivs[i].className == "infmessage")
                {
                        allDivs[i].style.display=(allDivs[i].style.display == 'none' | allDivs[i].style.display == '') ? 'block' : 'none';
                }
        }
}
-->
</script>
</head>
<body>
<h1>Debian Bug report logs - 
<a href="mailto:600130@bugs.debian.org">#600130</a><br>
Insecure temporary file and stack buffer overflow</h1>
<div class="versiongraph"><a href="version.cgi?collapse=1;info=1;package=ettercap;absolute=0;found=ettercap%2F1%3A0.7.3-2;fixed=ettercap%2F1%3A0.7.4-1"><img alt="version graph" src="version.cgi?fixed=ettercap%2F1%3A0.7.4-1;found=ettercap%2F1%3A0.7.3-2;absolute=0;width=2;package=ettercap;height=2;collapse=1"></a></div>
<div class="pkginfo">
  <p>Package:
     <a class="submitter" href="pkgreport.cgi?package=ettercap">ettercap</a>;
Maintainer for <a href="pkgreport.cgi?package=ettercap">ettercap</a> is <a href="pkgreport.cgi?maint=team%2Bpkg-security%40tracker.debian.org">Debian Security Tools &lt;team+pkg-security@tracker.debian.org&gt;</a>; </p>

</div>

<div class="buginfo">
  <p>Reported by: <a href="pkgreport.cgi?submitter=kees%40debian.org">Kees Cook &lt;kees@debian.org&gt;</a></p>
  <p>Date: Wed, 13 Oct 2010 20:39:02 UTC</p>

<p>Severity: normal</p>
<p>Tags: security</p>

<p>Found in version ettercap/1:0.7.3-2</p>
<p>Fixed in version ettercap/1:0.7.4-1</p>

<p><strong>Done:</strong> &quot;Barak A. Pearlmutter&quot; &lt;barak@cs.nuim.ie&gt;</p>

<p>Bug is archived. No further changes may be made.<p></div>

<p><a href="javascript:toggle_infmessages();">Toggle useless messages</a></p><div class="msgreceived"><p>View this report as an <a href="bugreport.cgi?bug=600130;mbox=yes">mbox folder</a>, <a href="bugreport.cgi?bug=600130;mbox=yes;mboxstatus=yes">status mbox</a>, <a href="bugreport.cgi?bug=600130;mbox=yes;mboxmaint=yes">maintainer mbox</a></p></div>

<div class="infmessage"><hr><p>
<a name="1"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Murat Demirten &lt;murat@debian.org&gt; -->
<!-- time:1287002344 -->
<strong>Report forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Murat Demirten &lt;murat@debian.org&gt;</code>:<br>
<code>Bug#600130</code>; Package <code>ettercap</code>.
 (Wed, 13 Oct 2010 20:39:04 GMT) (<a href="bugreport.cgi?bug=600130;msg=2">full text</a>, <a href="bugreport.cgi?bug=600130;mbox=yes;msg=2">mbox</a>, <a href="#1">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="3"></a>
<!-- request_addr: Kees Cook &lt;kees@debian.org&gt; -->
<!-- time:1287002345 -->
<strong>Acknowledgement sent</strong>
to <code>Kees Cook &lt;kees@debian.org&gt;</code>:<br>
New Bug report received and forwarded.  Copy sent to <code>Murat Demirten &lt;murat@debian.org&gt;</code>.
 (Wed, 13 Oct 2010 20:39:05 GMT) (<a href="bugreport.cgi?bug=600130;msg=4">full text</a>, <a href="bugreport.cgi?bug=600130;mbox=yes;msg=4">mbox</a>, <a href="#3">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="5"></a><a name="msg5"></a><a href="#5">Message #5</a> received at submit@bugs.debian.org (<a href="bugreport.cgi?bug=600130;msg=5">full text</a>, <a href="bugreport.cgi?bug=600130;mbox=yes;msg=5">mbox</a>, <a href="mailto:600130@bugs.debian.org?body=On%20Wed%2C%2013%20Oct%202010%2013%3A37%3A01%20-0700%20Kees%20Cook%20%3Ckees%40debian.org%3E%20wrote%3A%0A%3E%20Package%3A%20ettercap%0A%3E%20Version%3A%201%3A0.7.3-2%0A%3E%20Severity%3A%20normal%0A%3E%20Tags%3A%20security%0A%3E%20User%3A%20ubuntu-devel%40lists.ubuntu.com%0A%3E%20Usertags%3A%20origin-ubuntu%20maverick%0A%3E%20%0A%3E%20This%20bug%20report%20was%20also%20filed%20in%20Ubuntu%20and%20can%20be%20found%20at%20http%3A%2F%2Flaunchpad.net%2Fbugs%2F656347.%0A%3E%20Its%20description%2C%20from%20Dan%20Rosenberg%2C%20follows%3A%0A%3E%20%0A%3E%20The%20GTK%20version%20of%20ettercap%20uses%20a%20global%20settings%20file%0A%3E%20at%20%2Ftmp%2F.ettercap_gtk%20and%20does%20not%20verify%20ownership%20of%20this%0A%3E%20file.%20%20When%20parsing%20this%20file%20for%20settings%20in%20gtkui_conf_read%28%29%0A%3E%20%28src%2Finterfaces%2Fgtk%2Fec_gtk_conf.c%29%2C%20an%20unchecked%20sscanf%28%29%20call%20allows%20a%0A%3E%20maliciously%20placed%20settings%20file%20to%20overflow%20a%20statically-sized%20buffer%0A%3E%20on%20the%20stack.%20%20Stack-smashing%20protection%20catches%20it%2C%20but%20it%20still%20should%0A%3E%20be%20fixed.%0A%3E%20%0A%3E%20Verify%20with%3A%0A%3E%20%24%20perl%20-e%20%27print%20%22A%22x500%27%20%3E%20%2Ftmp%2F.ettercap_gtk%20%26%26%20ettercap%20-G%0A%3E%20%0A%3E%20Firstly%2C%20the%20settings%20file%20should%20not%20be%20globally%20accessible%20without%0A%3E%20checking%20ownership%2C%20which%20still%20gets%20hairy%20because%20an%20attacker%20could%0A%3E%20create%20a%20symlink%20or%20hard%20link%20to%20a%20victim-controlled%20file%20%28unless%20you%27re%0A%3E%20using%20YAMA%20%3Ap%29.%20%20The%20best%20thing%20would%20probably%20be%20to%20keep%20this%20file%20in%0A%3E%20the%20user%27s%20home%20directory%20instead.%0A%3E%20%0A%3E%20Secondly%2C%20parsing%20configuration%20files%20should%20be%20robust%20against%20malformed%0A%3E%20input%20and%20not%20susceptible%20to%20trivial%20buffer%20overflows.%0A%3E%20%0A%3E%20--%20System%20Information%3A%0A%3E%20Debian%20Release%3A%20squeeze%2Fsid%0A%3E%20%20%20APT%20prefers%20maverick%0A%3E%20%20%20APT%20policy%3A%20%28500%2C%20%27maverick%27%29%2C%20%28500%2C%20%27lucid-updates%27%29%2C%20%28500%2C%20%27lucid-security%27%29%0A%3E%20Architecture%3A%20amd64%20%28x86_64%29%0A%3E%20%0A%3E%20Kernel%3A%20Linux%202.6.35-23-generic%20%28SMP%20w%2F4%20CPU%20cores%29%0A%3E%20Locale%3A%20LANG%3Den_US.utf8%2C%20LC_CTYPE%3Den_US.utf8%20%28charmap%3DUTF-8%29%0A%3E%20Shell%3A%20%2Fbin%2Fsh%20linked%20to%20%2Fbin%2Fdash%0A%3E%20%0A%3E%20--%20%0A%3E%20Kees%20Cook%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%40debian.org%0A%3E%20%0A%3E%20%0A%3E%20%0A&amp;subject=Re%3A%20Insecure%20temporary%20file%20and%20stack%20buffer%20overflow&amp;In-Reply-To=%3C20101013203701.GG4934%40outflux.net%3E&amp;References=%3C20101013203701.GG4934%40outflux.net%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=kees%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Kees Cook &lt;kees@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> Debian Bugs &lt;submit@bugs.debian.org&gt;</div>
<div class="header"><span class="headerfield">Subject:</span> Insecure temporary file and stack buffer overflow</div>
<div class="header"><span class="headerfield">Date:</span> Wed, 13 Oct 2010 13:37:01 -0700</div>
</div>
<pre class="message">Package: ettercap
Version: 1:0.7.3-2
Severity: normal
Tags: security
User: ubuntu-devel@lists.ubuntu.com
Usertags: origin-ubuntu maverick

This bug report was also filed in Ubuntu and can be found at <a href="http://launchpad.net/bugs/656347">http://launchpad.net/bugs/656347</a>.
Its description, from Dan Rosenberg, follows:

The GTK version of ettercap uses a global settings file
at /tmp/.ettercap_gtk and does not verify ownership of this
file.  When parsing this file for settings in gtkui_conf_read()
(src/interfaces/gtk/ec_gtk_conf.c), an unchecked sscanf() call allows a
maliciously placed settings file to overflow a statically-sized buffer
on the stack.  Stack-smashing protection catches it, but it still should
be fixed.

Verify with:
$ perl -e &#39;print &quot;A&quot;x500&#39; &gt; /tmp/.ettercap_gtk &amp;&amp; ettercap -G

Firstly, the settings file should not be globally accessible without
checking ownership, which still gets hairy because an attacker could
create a symlink or hard link to a victim-controlled file (unless you&#39;re
using YAMA :p).  The best thing would probably be to keep this file in
the user&#39;s home directory instead.

Secondly, parsing configuration files should be robust against malformed
input and not susceptible to trivial buffer overflows.

-- System Information:
Debian Release: squeeze/sid
  APT prefers maverick
  APT policy: (500, &#39;maverick&#39;), (500, &#39;lucid-updates&#39;), (500, &#39;lucid-security&#39;)
Architecture: amd64 (x86_64)

Kernel: Linux 2.6.35-23-generic (SMP w/4 CPU cores)
Locale: LANG=en_US.utf8, LC_CTYPE=en_US.utf8 (charmap=UTF-8)
Shell: /bin/sh linked to /bin/dash

-- 
Kees Cook                                            @debian.org



</pre>

<div class="msgreceived"><hr><p>
<a name="6"></a>
<!-- request_addr: barak@cs.nuim.ie -->
<!-- time:1313272265 -->
<strong>Reply sent</strong>
to <code>barak@cs.nuim.ie</code>:<br>
You have taken responsibility.
 (Sat, 13 Aug 2011 21:51:05 GMT) (<a href="bugreport.cgi?bug=600130;msg=7">full text</a>, <a href="bugreport.cgi?bug=600130;mbox=yes;msg=7">mbox</a>, <a href="#6">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="8"></a>
<!-- request_addr: Kees Cook &lt;kees@debian.org&gt; -->
<!-- time:1313272265 -->
<strong>Notification sent</strong>
to <code>Kees Cook &lt;kees@debian.org&gt;</code>:<br>
Bug acknowledged by developer.
 (Sat, 13 Aug 2011 21:51:05 GMT) (<a href="bugreport.cgi?bug=600130;msg=9">full text</a>, <a href="bugreport.cgi?bug=600130;mbox=yes;msg=9">mbox</a>, <a href="#8">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="10"></a><a name="msg10"></a><a href="#10">Message #10</a> received at 600130-done@bugs.debian.org (<a href="bugreport.cgi?bug=600130;msg=10">full text</a>, <a href="bugreport.cgi?bug=600130;mbox=yes;msg=10">mbox</a>, <a href="mailto:600130@bugs.debian.org?References=%3CE1QsM55-0007Hw-JO%40port-kdr.hamilton.local%3E&amp;In-Reply-To=%3CE1QsM55-0007Hw-JO%40port-kdr.hamilton.local%3E&amp;subject=Re%3A%20fixed%20in%20upstream%20release&amp;body=On%20Sat%2C%2013%20Aug%202011%2022%3A49%3A23%20%2B0100%20%22Barak%20A.%20Pearlmutter%22%20%3Cbarak%40cs.nuim.ie%3E%20wrote%3A%0A%3E%20Package%3A%20ettercap%0A%3E%20Version%3A%201%3A0.7.4-1%0A%3E%20%0A%3E%20I%20believe%20The%20code%20has%20been%20changed%20upstream%20so%20the%20file%20lives%20in%20the%0A%3E%20user%27s%20home%20directory%20instead%20of%20in%20%2Ftmp%2F.%20%20That%20means%20this%20should%20be%0A%3E%20fixed%20in%20the%20latest%20Debian%20version.%0A%3E%20--%0A%3E%20Barak%20A.%20Pearlmutter%0A%3E%20%20Hamilton%20Institute%20%26%20Dept%20Comp%20Sci%2C%20NUI%20Maynooth%2C%20Co.%20Kildare%2C%20Ireland%0A%3E%20%20http%3A%2F%2Fwww.bcl.hamilton.ie%2F~barak%2F%0A%3E%20%0A%3E%20%0A%3E%20%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=barak%40cs.nuim.ie" alt="">
<div class="header"><span class="headerfield">From:</span> &quot;Barak A. Pearlmutter&quot; &lt;barak@cs.nuim.ie&gt;</div>
<div class="header"><span class="headerfield">To:</span> 600130-done@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> fixed in upstream release</div>
<div class="header"><span class="headerfield">Date:</span> Sat, 13 Aug 2011 22:49:23 +0100</div>
</div>
<pre class="message">Package: ettercap
Version: 1:0.7.4-1

I believe The code has been changed upstream so the file lives in the
user&#39;s home directory instead of in /tmp/.  That means this should be
fixed in the latest Debian version.
--
Barak A. Pearlmutter
 Hamilton Institute &amp; Dept Comp Sci, NUI Maynooth, Co. Kildare, Ireland
 <a href="http://www.bcl.hamilton.ie/~barak/">http://www.bcl.hamilton.ie/~barak/</a>



</pre>

<div class="msgreceived"><hr><p>
<a name="11"></a>
<!-- command:archive -->
<!-- requester: Debbugs Internal Request &lt;owner@bugs.debian.org&gt; -->
<!-- request_addr: internal_control@bugs.debian.org -->
<!-- time:1318318402 -->
<!-- new_data:
$new_data = {};
-->
<!-- old_data:
$old_data = {};
-->
<strong>Bug archived.</strong>
Request was from <code>Debbugs Internal Request &lt;owner@bugs.debian.org&gt;</code>
to <code>internal_control@bugs.debian.org</code>.
 (Tue, 11 Oct 2011 07:33:22 GMT) (<a href="bugreport.cgi?bug=600130;msg=12">full text</a>, <a href="bugreport.cgi?bug=600130;mbox=yes;msg=12">mbox</a>, <a href="#11">link</a>).</p></p></div>

<hr>
<p class="msgreceived">Send a report that <a href="https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=600130">this bug log contains spam</a>.</p>
<hr>
<ADDRESS>Debian bug tracking system administrator &lt;<A HREF="mailto:owner@bugs.debian.org">owner@bugs.debian.org</A>&gt;.
Last modified:
<!--timestamp-->Sat Oct 30 18:25:07 2021<!--end timestamp-->; 
Machine Name:
<!--machinename-->bembo<!--machinename-->
<P>
<A HREF="https://www.debian.org/Bugs/">Debian Bug tracking system</A>
</p>
<p>
  Debbugs is free software and licensed under the terms of the GNU
  Public License version 2. The current version can be obtained
  from <a href="https://bugs.debian.org/debbugs-source/">https://bugs.debian.org/debbugs-source/</a>.
</p>
<p>
Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.
</p>
</ADDRESS>

</body>
</html>
