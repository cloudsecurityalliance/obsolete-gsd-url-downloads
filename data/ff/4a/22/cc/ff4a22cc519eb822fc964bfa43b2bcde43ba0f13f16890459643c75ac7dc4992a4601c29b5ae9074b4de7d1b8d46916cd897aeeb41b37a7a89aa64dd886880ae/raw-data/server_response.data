<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
  <head>
<base href="https://bugs.launchpad.net/python-keystoneclient/+bug/1282865/+index" />

    <meta charset="UTF-8" />
    <title>Bug #1282865 “[OSSA 2014-007] Keystone middleware may confuse co...” : Bugs : python-keystoneclient</title>
    <link rel="shortcut icon" href="/@@/launchpad.png" />
    <link rel="canonical" href="https://bugs.launchpad.net/bugs/1282865" />
    
      <link rel="alternate" type="application/atom+xml" href="http://feeds.launchpad.net/bugs/1282865/bug.atom" title="Bug 1282865 Feed" />
    

    
  
  <link type="text/css" rel="stylesheet" media="screen, print" href="/+icing/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/combo.css" />


    

    
      <meta name="description" content="tl;dr: Occasionally a request from a regular user appears to Glance-registry as an admin user:


We have a server with 12 glance-registry processes running, with auth_token middleware handling authentication.


If I run a python script that sets up Glanceclient:

glance = glanceclient.Client('1', token=xxx)

and makes the following call over and over:

glance.images.get(&lt;private_image_id_from_another_tenant&gt;)

Most calls 404 because the calling tenant doesn't have access to the image. Eventua..." />
      <meta property="og:description" content="tl;dr: Occasionally a request from a regular user appears to Glance-registry as an admin user:


We have a server with 12 glance-registry processes running, with auth_token middleware handling authentication.


If I run a python script that sets up Glanceclient:

glance = glanceclient.Client('1', token=xxx)

and makes the following call over and over:

glance.images.get(&lt;private_image_id_from_another_tenant&gt;)

Most calls 404 because the calling tenant doesn't have access to the image. Eventua..." />
    

    
    
      <meta property="og:title" content="Bug #1282865 “[OSSA 2014-007] Keystone middleware may confuse co...” : Bugs : python-keystoneclient" />
      <meta property="og:type" content="website" />
      <meta property="og:image" content="/@@/launchpad.png" />
      <meta property="og:url" content="https://bugs.launchpad.net/bugs/1282865" />
      <meta property="og:site_name" content="Launchpad" />
    

    

    
  

  
  
  <script type="text/javascript">
    var LP = {
        cache: {},
        links: {}
    };
  </script>

  

  <script type="text/javascript">var cookie_scope = '; Path=/; Secure; Domain=.launchpad.net';</script>

   <script type="text/javascript" src="/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?yui/yui/yui-min.js&amp;lp/meta.js&amp;yui/loader/loader-min.js"></script>
   <script type="text/javascript">
        var raw = null;
        if (LP.devmode) {
           raw = 'raw';
        }
        YUI.GlobalConfig = {
            combine: true,
            comboBase: '/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?',
            root: 'yui/',
            filter: raw,
            debug: false,
            fetchCSS: false,
            maxURLLength: 2000,
            groups: {
                lp: {
                    combine: true,
                    base: '/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?lp/',
                    comboBase: '/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?',
                    root: 'lp/',
                    // comes from including lp/meta.js
                    modules: LP_MODULES,
                    fetchCSS: false
                }
            }
        }</script>

  <script type="text/javascript">
      // we need this to create a single YUI instance all events and code
      // talks across. All instances of YUI().use should be based off of
      // LPJS instead.
      var LPJS = new YUI();
  </script>



    <script id="base-layout-load-scripts" type="text/javascript">
        //<![CDATA[
        LPJS.use('base', 'node', 'console', 'event',
            'oop', 'lp', 'lp.app.foldables','lp.app.sorttable',
            'lp.app.inlinehelp', 'lp.app.links',
            'lp.bugs.bugtask_index', 'lp.bugs.subscribers',
            'lp.app.ellipsis', 'lp.code.branchmergeproposal.diff',
            'lp.views.global',
             function(Y) {

            Y.on("domready", function () {
                var global_view = new Y.lp.views.Global();
                global_view.render();

                Y.lp.app.sorttable.SortTable.init();
                Y.lp.app.inlinehelp.init_help();
                Y.lp.activate_collapsibles();
                Y.lp.app.foldables.activate();
                Y.lp.app.links.check_valid_lp_links();
            });

            Y.on('lp:context:web_link:changed', function(e) {
                  window.location = e.new_value;
            });
        });
        //]]>
    </script>
    <script id="base-helper-functions" type="text/javascript">
         //<![CDATA[
        // This code is pulled from lp.js that needs to be available on every
        // request. Pulling here to get it outside the scope of the YUI block.
        function setFocusByName(name) {
            // Focus the first element matching the given name which can be focused.
            var nodes = document.getElementsByName(name);
            var i, node;
            for (i = 0; i < nodes.length; i++) {
                node = nodes[i];
                if (node.focus) {
                    try {
                        // Trying to focus a hidden element throws an error in IE8.
                        if (node.offsetHeight !== 0) {
                            node.focus();
                        }
                    } catch (e) {
                        LPJS.use('console', function(Y) {
                            Y.log('In setFocusByName(<' +
                                node.tagName + ' type=' + node.type + '>): ' + e);
                        });
                    }
                    break;
                }
            }
        }

        function selectWidget(widget_name, event) {
          if (event && (event.keyCode === 9 || event.keyCode === 13)) {
              // Avoid firing if user is tabbing through or simply pressing
              // enter to submit the form.
              return;
          }
          document.getElementById(widget_name).checked = true;
        }
        //]]>
    </script>

    
      
      <script type="text/javascript" id="available-official-tags-js">var available_official_tags = ["documentation", "federation", "low-hanging-fruit", "pki", "security", "test-improvement", "user-experience"];</script>
      <script type="text/javascript">
        LPJS.use('base', 'node', 'oop', 'event', 'lp.bugs.bugtask_index',
                  'lp.bugs.subscribers', 'lp.code.branchmergeproposal.diff',
                  'lp.app.comment', 'lp.services.messages.edit', function(Y) {
            Y.on('domready', function() {
                Y.lp.code.branchmergeproposal.diff.connect_diff_links();
                Y.lp.bugs.bugtask_index.setup_bugtask_index();
                Y.lp.bugs.bugtask_index.setup_bugtask_table();
                LP.cache.comment_context = LP.cache.bug;
                var cl = new Y.lp.app.comment.CommentList();
                cl.render();
                var sl = new Y.lp.bugs.subscribers.createBugSubscribersLoader({
                    container_box: '#other-bug-subscribers',
                    subscribers_details_view:
                        '/+bug-portlet-subscribers-details',
                    subscribe_someone_else_link: '.menu-link-addsubscriber'
                }, window);

                Y.lp.services.messages.edit.setup();
            });
         });
      </script>
      <style type="text/css">
        /* Align the 'add comment' link to the right of the comment box. */
        #add-comment-form textarea { width: 100%; }
        #add-comment-form { max-width: 60em; padding-bottom: 4em; }
        #add-comment-form .actions {float: right;}
        .buglink-summary dd { font-size: 10px; }
        a#privacy-link:link:hover, a#privacy-link:visited:hover {text-decoration:none;}
      </style>
      <style type="text/css">
        .yui3-overlay .value label  {
          /* It normally makes sense for form labels to be bold, but since
          this form consists only of radio buttons, there's nothing but labels
          so we just get wall-to-wall bold. */
          font-weight: normal !important;
        }
      </style>
    
    
  </head>

  <body id="document" itemscope="" itemtype="http://schema.org/WebPage" class="tab-bugs
      main_side
      public
      yui3-skin-sam">
          
          
    <div class="yui-d0">
      <div id="locationbar" class="login-logout">
        

<div id="logincontrol"><a href="https://bugs.launchpad.net/python-keystoneclient/+bug/1282865/+login">Log in / Register</a></div>



      </div><!--id="locationbar"-->

      <div id="watermark" class="watermark-apps-portlet">
        <div>
          <a href="https://launchpad.net/python-keystoneclient"><img alt="" width="64" height="64" src="https://launchpadlibrarian.net/109253197/os64.png" /></a>
        </div>
        <div class="wide">
          <h2 id="watermark-heading"><a href="https://launchpad.net/python-keystoneclient">python-keystoneclient</a></h2>
        </div>
        
  <!-- Application Menu -->
  <ul class="facetmenu">
    
      
      <li class="overview"><a href="https://launchpad.net/python-keystoneclient">Overview</a></li>
      
    
    
      
      <li class="branches"><a href="https://code.launchpad.net/python-keystoneclient">Code</a></li>
      
    
    
      <li class="bugs active"><a href="https://bugs.launchpad.net/python-keystoneclient">Bugs</a></li>
      
      
    
    
      
      <li class="specifications"><a href="https://blueprints.launchpad.net/python-keystoneclient">Blueprints</a></li>
      
    
    
      
      <li class="translations"><a href="https://translations.launchpad.net/python-keystoneclient">Translations</a></li>
      
    
    
      
      <li class="answers"><a href="https://answers.launchpad.net/python-keystoneclient">Answers</a></li>
      
    
  </ul>

      </div>

      <div class="yui-t4">
        <div id="maincontent" class="yui-main">
          <div class="yui-b" dir="ltr">
            <div class="context-publication">
              
      <h1 id="edit-title">
<span class="yui3-editable_text-text ellipsis" style="max-width: 95%;">
    [OSSA 2014-007] Keystone middleware may confuse contexts (CVE-2014-0105)
</span>
  
</h1>



    
              

              <div id="registration" class="registering">
                
      Bug #1282865 reported by
      <a href="https://launchpad.net/~kspear" class="sprite person">Kieran Spear</a>
      <time title="2014-02-21 03:30:25 UTC" datetime="2014-02-21T03:30:25.614470+00:00">on 2014-02-21</time>
    
              </div>
            </div>

            
            <div id="request-notifications">
              
            </div>

            
              <div>

      

      <div id="bug-is-duplicate">
          
      </div>
      

      <div style="float: right;">
        <span><a href="/+help-bugs/bug-heat.html" target="help" class="sprite flame">274</a></span>
      </div>

      


  
  
    <div class="actions">
      <span id="affectsmetoo" style="display: inline">This bug affects 1 person</span>
    </div>
  



    <table id="affected-software" class="listing">
      <thead>
        <tr>
          <th colspan="2">Affects</th>
          <th>Status</th>
          <th>Importance</th>
          <th>Assigned to</th>
          <th>Milestone</th>
        </tr>
      </thead>

      <tbody>
        
          
  <tr id="tasksummary1554474">
    <td>
      <a class="bugtask-expander" href="https://bugs.launchpad.net/ossa/+bug/1282865/+editstatus">
        &#8203;
      </a>
    </td>
    
    <td>
      <span id="bugtarget-picker-tasksummary1554474">
        <span class="yui3-activator-data-box">
            <a class="sprite product" href="https://bugs.launchpad.net/ossa">OpenStack Security Advisory</a>
        </span>
        <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
          Edit
        </button>
        <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        
      </span>
    </td>

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/ossa/+bug/1282865/+editstatus" style="float: left" class="value statusFIXRELEASED">Fix Released</a>
          <a href="https://bugs.launchpad.net/ossa/+bug/1282865/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceCRITICAL">Critical</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary1554474">
          <span class="yui3-activator-data-box">
            <a class="sprite person" href="https://launchpad.net/~tristan-cacqueray">Tristan Cacqueray</a>
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      
    </td>

    
  </tr>

  
    <tr class="bugtask-collapsible-content hidden" id="task1554474">
     <td colspan="7"><form action="/ossa/+bug/1282865/+editstatus" method="post" enctype="multipart/form-data">
  

  <p class="error message">
    You need to log in to change this bug's status.
  </p>
  
  <table class="summary" style="float: right; margin-left: 1em;">
    <tr>
      <th>Affecting:</th>
      <td><a href="/ossa">OpenStack Security Advisory</a></td>
    </tr>
    <tr>
      <th>Filed here by:</th>
      <td><a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez</a></td>
    </tr>
    <tr>
      <th>When:</th>
      <td>
        <time title="2014-02-21 09:16:27 UTC" datetime="2014-02-21T09:16:27.203269+00:00">2014-02-21</time>
      </td>
    </tr>
    <tr>
      <th>Confirmed:</th>
      <td>
        <time title="2014-02-24 15:17:07 UTC" datetime="2014-02-24T15:17:07.033006+00:00">2014-02-24</time>
      </td>
    </tr>
    <tr>
      <th>Assigned:</th>
      <td>
        <time title="2014-02-25 15:05:15 UTC" datetime="2014-02-25T15:05:15.301078+00:00">2014-02-25</time>
      </td>
    </tr>
    <tr>
      <th>Started work:</th>
      <td>
        <time title="2014-03-19 14:00:28 UTC" datetime="2014-03-19T14:00:28.118740+00:00">2014-03-19</time>
      </td>
    </tr>
    <tr>
      <th>Completed:</th>
      <td>
        <time title="2014-03-27 15:13:29 UTC" datetime="2014-03-27T15:13:29.873682+00:00">2014-03-27</time>
      </td>
    </tr>
  </table>
  <div class="field">
    <table>
      <tr>
        <td>
          <label for="ossa.target">Target</label>
        </td>
      </tr>
      <tr>
        <td>
          <table>
  <tr>
    <td>
      <label>
        <input class="radioType" id="ossa.target.option.package" name="ossa.target" type="radio" value="package" />
        Distribution
      </label>
    </td>
    <td>
      <select id="ossa.target.distribution" name="ossa.target.distribution" size="1" >
<option value="baltix">Baltix</option>
<option value="boss">BOSS</option>
<option value="charms">Juju Charms Collection</option>
<option value="elbuntu">Elbuntu</option>
<option value="guadalinex">Guadalinex</option>
<option value="guadalinexedu">Guadalinex Edu</option>
<option value="kiwilinux">Kiwi Linux</option>
<option value="nubuntu">nUbuntu</option>
<option value="pld-linux">PLD Linux</option>
<option value="tilix">Tilix</option>
<option value="tuxlab">tuXlab</option>
<option selected="selected" value="ubuntu">Ubuntu</option>
<option value="ubuntu-leb">Ubuntu Linaro Evaluation Build</option>
<option value="ubuntu-rtm">Ubuntu RTM</option>
</select>
<input name="ossa.target.distribution-empty-marker" type="hidden" value="1" />
    </td>
  </tr>
  <tr>
    <td align="right">
      <label for="ossa.target.option.package">
        Package
      </label>
    </td>
    <td>
      


    <input type="text" value="" id="ossa.target.package"
                         name="ossa.target.package" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;ossa.target.option.package&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('ossa.target.package');
              var select_menu = Y.DOM.byId('ossa.target.package-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-ossa-target-package" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"show_remove_button": false, "header": "Select a package", "vocabulary_filters": [], "remove_team_text": "Remove team", "remove_person_text": "Remove person", "selected_value_metadata": null, "show_create_team": false, "picker_type": "default", "vocabulary_name": "DistributionPackage", "extra_no_results_message": null, "selected_value": null, "show_assign_me_button": false, "show_widget_id": "show-widget-ossa-target-package", "step_title": "Search by name", "assign_me_text": "Pick me", "input_element": "ossa.target.package"};
        var show_widget_id = 'show-widget-ossa-target-package';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>

  <tr>
    <td>
      <label>
        <input class="radioType" checked="checked" id="ossa.target.option.product" name="ossa.target" type="radio" value="product" />
       Project
      </label>
    </td>
    <td>
      


    <input type="text" value="ossa" id="ossa.target.product"
                         name="ossa.target.product" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;ossa.target.option.product&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('ossa.target.product');
              var select_menu = Y.DOM.byId('ossa.target.product-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-ossa-target-product" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"show_remove_button": false, "header": "Select a project", "vocabulary_filters": [], "remove_team_text": "Remove team", "remove_person_text": "Remove person", "selected_value_metadata": null, "show_create_team": false, "picker_type": "default", "vocabulary_name": "Product", "extra_no_results_message": null, "selected_value": "ossa", "show_assign_me_button": false, "show_widget_id": "show-widget-ossa-target-product", "step_title": "Search", "assign_me_text": "Pick me", "input_element": "ossa.target.product"};
        var show_widget_id = 'show-widget-ossa-target-product';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>
</table>

          
        </td>
      </tr>
    </table>
    
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="ossa.status">Status</label>
        </td>
        <td>
          <label style="font-weight: bold" for="ossa.importance">Importance</label>
        </td>
        
      </tr>
      <tr>
        <td><div>
<div class="value">
<select id="ossa.status" name="ossa.status" size="1" >
<option selected="selected" value="Fix Released">Fix Released</option>
</select>
</div>
<input name="ossa.status-empty-marker" type="hidden" value="1" />
</div></td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          <span class="importanceCRITICAL">Critical</span>
        </td>
        
      </tr>
    </table>
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="ossa.assignee">Assigned to</label>
        </td>
      </tr>
      <tr>
        <td colspan="2" style="white-space: nowrap">

  <table>
    
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" id="ossa.assignee.assign_to_me" name="ossa.assignee.option" value="ossa.assignee.assign_to_me" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="ossa.assignee.assign_to_me">
          Me
        </label>
      </td>
    </tr>
    
      
        <tr>
          <td style="padding: 0 2px 2px 0">
              <input type="radio" checked="checked" id="ossa.assignee.assigned_to" name="ossa.assignee.option" value="ossa.assignee.assigned_to" />
          </td>
          <td style="padding: 0">
            <label style="font-weight: normal" for="ossa.assignee.assigned_to">
              Tristan Cacqueray (tristan-cacqueray)
            </label>
          </td>
        </tr>
      
    
    
  </table>


</td>
      </tr>
    </table>
    
  </div>
  <div class="field">
    <div>
      <label style="font-weight: bold" for="ossa.comment_on_change">Comment on this change (optional)</label>
      <textarea cols="62" rows="4" id="ossa.comment_on_change" name="ossa.comment_on_change"></textarea>
    </div>
    <div>
      <label style="font-weight: normal">
        <input type="checkbox" name="subscribe" id="subscribe" value="Subscribe" />
        Email me about changes to this bug report
      </label>
    </div>
  </div>
  
</form>
</td>
    </tr>
  


        
        
          
  <tr class="highlight" id="tasksummary1554376">
    <td>
      <a class="bugtask-expander" href="https://bugs.launchpad.net/python-keystoneclient/+bug/1282865/+editstatus">
        &#8203;
      </a>
    </td>
    
    <td>
      <span id="bugtarget-picker-tasksummary1554376">
        <span class="yui3-activator-data-box">
            <a class="sprite product" href="https://bugs.launchpad.net/python-keystoneclient">python-keystoneclient</a>
        </span>
        <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
          Edit
        </button>
        <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        
      </span>
    </td>

    

    
    <td style="width: 20%; vertical-align: middle">
      <div class="status-content" style="width: 100%; float: left">
        
        
          <a href="https://bugs.launchpad.net/python-keystoneclient/+bug/1282865/+editstatus" style="float: left" class="value statusFIXRELEASED">Fix Released</a>
          <a href="https://bugs.launchpad.net/python-keystoneclient/+bug/1282865/+editstatus" style="margin-left: 3px">
            <img class="editicon" src="/@@/edit" />
          </a>
        
      </div>
    </td>

    
    <td style="width: 15em; vertical-align: middle">
      <div class="importance-content" style="width: 100%; float: left">
        <span style="float: left" class="value importanceCRITICAL">Critical</span>
      </div>
    </td>

    <td style="width:20%; margin: 0; padding: 0;
               vertical-align: middle; padding-left: 0.5em">
      

      
        <span id="assignee-picker-tasksummary1554376">
          <span class="yui3-activator-data-box">
            <a class="sprite person" href="https://launchpad.net/~dolph">Dolph Mathews</a>
            
          </span>
          
          <button class="lazr-btn yui3-activator-act yui3-activator-hidden">
            Edit
          </button>
          <div class="yui3-activator-message-box yui3-activator-hidden"></div>
        </span>
      
    </td>

    <td style="width: 20%; vertical-align: middle">
      <div class="milestone-content" style="width: 100%; float: left">
        
        <a class="value" href="https://launchpad.net/python-keystoneclient/+milestone/0.7.0">python-keystoneclient 0.7.0</a>
        
      </div>
    </td>

    
  </tr>

  
    <tr class="bugtask-collapsible-content hidden" id="task1554376">
     <td colspan="7"><form action="/python-keystoneclient/+bug/1282865/+editstatus" method="post" enctype="multipart/form-data">
  

  <p class="error message">
    You need to log in to change this bug's status.
  </p>
  
  <table class="summary" style="float: right; margin-left: 1em;">
    <tr>
      <th>Affecting:</th>
      <td><a href="/python-keystoneclient">python-keystoneclient</a></td>
    </tr>
    <tr>
      <th>Filed here by:</th>
      <td><a href="https://launchpad.net/~kspear" class="sprite person">Kieran Spear</a></td>
    </tr>
    <tr>
      <th>When:</th>
      <td>
        <time title="2014-02-21 03:30:25 UTC" datetime="2014-02-21T03:30:25.614470+00:00">2014-02-21</time>
      </td>
    </tr>
    <tr>
      <th>Confirmed:</th>
      <td>
        <time title="2014-02-21 23:34:26 UTC" datetime="2014-02-21T23:34:26.794450+00:00">2014-02-21</time>
      </td>
    </tr>
    <tr>
      <th>Assigned:</th>
      <td>
        <time title="2014-02-22 00:12:19 UTC" datetime="2014-02-22T00:12:19.911306+00:00">2014-02-22</time>
      </td>
    </tr>
    <tr>
      <th>Started work:</th>
      <td>
        <time title="2014-03-19 13:58:59 UTC" datetime="2014-03-19T13:58:59.800615+00:00">2014-03-19</time>
      </td>
    </tr>
    <tr>
      <th>Completed:</th>
      <td>
        <time title="2014-03-26 11:58:46 UTC" datetime="2014-03-26T11:58:46.580169+00:00">2014-03-26</time>
      </td>
    </tr>
  </table>
  <div class="field">
    <table>
      <tr>
        <td>
          <label for="python-keystoneclient.target">Target</label>
        </td>
      </tr>
      <tr>
        <td>
          <table>
  <tr>
    <td>
      <label>
        <input class="radioType" id="python-keystoneclient.target.option.package" name="python-keystoneclient.target" type="radio" value="package" />
        Distribution
      </label>
    </td>
    <td>
      <select id="python-keystoneclient.target.distribution" name="python-keystoneclient.target.distribution" size="1" >
<option value="baltix">Baltix</option>
<option value="boss">BOSS</option>
<option value="charms">Juju Charms Collection</option>
<option value="elbuntu">Elbuntu</option>
<option value="guadalinex">Guadalinex</option>
<option value="guadalinexedu">Guadalinex Edu</option>
<option value="kiwilinux">Kiwi Linux</option>
<option value="nubuntu">nUbuntu</option>
<option value="pld-linux">PLD Linux</option>
<option value="tilix">Tilix</option>
<option value="tuxlab">tuXlab</option>
<option selected="selected" value="ubuntu">Ubuntu</option>
<option value="ubuntu-leb">Ubuntu Linaro Evaluation Build</option>
<option value="ubuntu-rtm">Ubuntu RTM</option>
</select>
<input name="python-keystoneclient.target.distribution-empty-marker" type="hidden" value="1" />
    </td>
  </tr>
  <tr>
    <td align="right">
      <label for="python-keystoneclient.target.option.package">
        Package
      </label>
    </td>
    <td>
      


    <input type="text" value="" id="python-keystoneclient.target.package"
                         name="python-keystoneclient.target.package" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;python-keystoneclient.target.option.package&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('python-keystoneclient.target.package');
              var select_menu = Y.DOM.byId('python-keystoneclient.target.package-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-python-keystoneclient-target-package" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"show_remove_button": false, "header": "Select a package", "vocabulary_filters": [], "remove_team_text": "Remove team", "remove_person_text": "Remove person", "selected_value_metadata": null, "show_create_team": false, "picker_type": "default", "vocabulary_name": "DistributionPackage", "extra_no_results_message": null, "selected_value": null, "show_assign_me_button": false, "show_widget_id": "show-widget-python-keystoneclient-target-package", "step_title": "Search by name", "assign_me_text": "Pick me", "input_element": "python-keystoneclient.target.package"};
        var show_widget_id = 'show-widget-python-keystoneclient-target-package';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>

  <tr>
    <td>
      <label>
        <input class="radioType" checked="checked" id="python-keystoneclient.target.option.product" name="python-keystoneclient.target" type="radio" value="product" />
       Project
      </label>
    </td>
    <td>
      


    <input type="text" value="python-keystoneclient" id="python-keystoneclient.target.product"
                         name="python-keystoneclient.target.product" size="20"
                         maxlength=""
                         onKeyPress="selectWidget(&#x27;python-keystoneclient.target.option.product&#x27;, event)" style=""
                         class="" />

    
      
      <script type="text/javascript">
          LPJS.use('node', 'lp.app.picker', function(Y) {
              var text_input = Y.DOM.byId('python-keystoneclient.target.product');
              var select_menu = Y.DOM.byId('python-keystoneclient.target.product-suggestions');
              Y.lp.app.picker.connect_select_menu(
                  select_menu, text_input);
          });</script>
    

    <span class="hidden">(<a id="show-widget-python-keystoneclient-target-product" href="#">Find&hellip;</a>)</span>
    <script>
    LPJS.use('node', 'lp.app.picker', function(Y) {
        var config = {"show_remove_button": false, "header": "Select a project", "vocabulary_filters": [], "remove_team_text": "Remove team", "remove_person_text": "Remove person", "selected_value_metadata": null, "show_create_team": false, "picker_type": "default", "vocabulary_name": "Product", "extra_no_results_message": null, "selected_value": "python-keystoneclient", "show_assign_me_button": false, "show_widget_id": "show-widget-python-keystoneclient-target-product", "step_title": "Search", "assign_me_text": "Pick me", "input_element": "python-keystoneclient.target.product"};
        var show_widget_id = 'show-widget-python-keystoneclient-target-product';
        Y.lp.app.picker.addPicker(config, show_widget_id);
    });
    </script>
  



    </td>
  </tr>
</table>

          
        </td>
      </tr>
    </table>
    
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="python-keystoneclient.status">Status</label>
        </td>
        <td>
          <label style="font-weight: bold" for="python-keystoneclient.importance">Importance</label>
        </td>
        <td>
          <label style="font-weight: bold" for="python-keystoneclient.milestone">Milestone</label>
        </td>
      </tr>
      <tr>
        <td><div>
<div class="value">
<select id="python-keystoneclient.status" name="python-keystoneclient.status" size="1" >
<option selected="selected" value="Fix Released">Fix Released</option>
</select>
</div>
<input name="python-keystoneclient.status-empty-marker" type="hidden" value="1" />
</div></td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          <span class="importanceCRITICAL">Critical</span>
        </td>
        <td title="Changeable only by a project maintainer or bug supervisor">
          <span class="sprite read-only"></span>
          python-keystoneclient 0.7.0
        </td>
      </tr>
    </table>
    <table>
      <tr>
        <td>
          <label style="font-weight: bold" for="python-keystoneclient.assignee">Assigned to</label>
        </td>
      </tr>
      <tr>
        <td colspan="2" style="white-space: nowrap">

  <table>
    
    <tr>
      <td style="padding: 0 2px 2px 0">
        <input type="radio" id="python-keystoneclient.assignee.assign_to_me" name="python-keystoneclient.assignee.option" value="python-keystoneclient.assignee.assign_to_me" />
      </td>
      <td style="padding: 0">
        <label style="font-weight: normal" for="python-keystoneclient.assignee.assign_to_me">
          Me
        </label>
      </td>
    </tr>
    
      
        <tr>
          <td style="padding: 0 2px 2px 0">
              <input type="radio" checked="checked" id="python-keystoneclient.assignee.assigned_to" name="python-keystoneclient.assignee.option" value="python-keystoneclient.assignee.assigned_to" />
          </td>
          <td style="padding: 0">
            <label style="font-weight: normal" for="python-keystoneclient.assignee.assigned_to">
              Dolph Mathews (dolph)
            </label>
          </td>
        </tr>
      
    
    
  </table>


</td>
      </tr>
    </table>
    
  </div>
  <div class="field">
    <div>
      <label style="font-weight: bold" for="python-keystoneclient.comment_on_change">Comment on this change (optional)</label>
      <textarea cols="62" rows="4" id="python-keystoneclient.comment_on_change" name="python-keystoneclient.comment_on_change"></textarea>
    </div>
    <div>
      <label style="font-weight: normal">
        <input type="checkbox" name="subscribe" id="subscribe" value="Subscribe" />
        Email me about changes to this bug report
      </label>
    </div>
  </div>
  
</form>
</td>
    </tr>
  


        
      </tbody>

    </table>



<div class="actions">
  
    <span id="also-affects-product" class="">
    <a class="menu-link-addupstream sprite add" href="https://bugs.launchpad.net/python-keystoneclient/+bug/1282865/+choose-affected-product">Also affects project</a>
        <a href="/+help-bugs/also-affects-project-help.html" target="help" class="sprite maybe action-icon">(?)</a>
    </span>
    <span id="also-affects-package" class="">
    <a class="menu-link-adddistro sprite add" href="https://bugs.launchpad.net/python-keystoneclient/+bug/1282865/+distrotask">Also affects distribution/package</a>
    </span>
    <a class="menu-link-nominate sprite milestone" href="https://bugs.launchpad.net/python-keystoneclient/+bug/1282865/+nominate">Nominate for series</a>
    
  

</div>




      <div id="maincontentsub">
        <div class="top-portlet">

      <div itemprop="mainContentOfPage" class="report">
        

        <div>
  <div class="lazr-multiline-edit" id="edit-description">
  <div class="clearfix">
    

    <h3>Bug Description</h3>
  </div>

  <div class="yui3-editable_text-text"><p>tl;dr: Occasionally a request from a regular user appears to Glance-registry as an admin user:</p>
<p>We have a server with 12 glance-registry processes running, with auth_token middleware handling authentication.</p>
<p>If I run a python script that sets up Glanceclient:</p>
<p>glance = glanceclient.<wbr />Client(<wbr />&#x27;1&#x27;, token=xxx)</p>
<p>and makes the following call over and over:</p>
<p>glance.<wbr />images.<wbr />get(&lt;private_<wbr />image_id_<wbr />from_another_<wbr />tenant&gt;<wbr />)</p>
<p>Most calls 404 because the calling tenant doesn&#x27;t have access to the image. Eventually though, an image get request will succeed.</p>
<p>When this happens, glance-registry logs something like:</p>
<p>INFO glance.<wbr />registry.<wbr />api.v1.<wbr />images [9b88678e-<wbr />f606-4016-<wbr />a39a-bb1ac150c0<wbr />29 2d474f5d54e24a5<wbr />6978c0332df1c36<wbr />d6 e183df4e2bd045f<wbr />7a9cbdb37a99929<wbr />a5] Successfully retrieved image 32101b45-<wbr />461e-452c-<wbr />b065-4e07391c80<wbr />6e</p>
<p>User 2d474f5d54e24a5<wbr />6978c0332df1c36<wbr />d6 and tenant e183df4e2bd045f<wbr />7a9cbdb37a99929<wbr />a5 are completely unrelated to the user&#x27;s credentials in the python script I&#x27;m running. They&#x27;re actually the user/tenant of our ceilometer admin user. Ceilometer is doing a few image GET requests per second.</p>
<p>The reverse of this also happens. Occasionally a request from ceilometer will assume the identity of the user in my script. Glance-registry logs the request as if it had come from my user, and denies the image GET because my user does not have the appropriate permission for the image ceilometer was trying to query.</p>
<p>If I comment out the &quot;memcached_servers&quot; line from our log file, the problem goes away. This makes me suspect that something is going on in auth_token middleware. When I watch the memcache entry for the token used by my script, the token data never appears to change.</p>
<p>What on earth is going on here? :)</p></div>
  </div>

  
</div>


        <div style="margin:-10px 0 20px 5px" class="clearfix">
          
        </div>

        <div id="bug-tags">
          <span id="tags-heading">
            
          </span>
          <span id="tag-list">
          </span>
          <a href="+edit" title="Add tags" id="tags-trigger" class="sprite add">Add tags</a>
          
          <a href="/+help-bugs/tag-help.html" target="help" class="sprite maybe action-icon">Tag help</a>
        </div>

        <script type="text/javascript">
          LPJS.use('event', 'node', 'lp.bugs.tags_entry', function(Y) {
              Y.on('domready',
                   function(e) {
                       Y.lp.bugs.tags_entry.setup_tag_entry(
                           available_official_tags);
                   },
                   window);
          });
        </script>

        <div class="clearfix"></div>
      </div>

      <div id="branches-and-cves">
        <div id="bug-branches-container" style="float: left">
          
        </div><!-- bug-branch-container -->

        <div class="cves">
          <h2>CVE References</h2>
          <ul>
            <li class="sprite cve">
              <a href="/bugs/cve/2014-0105" title="The auth_token middleware in the Open...">2014-0105</a>
            </li>
          </ul>
        </div>

        <div class="clearfix"></div>
      </div> <!-- branches and CVEs -->

      </div>

      <div>
      
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/1" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~kspear" class="sprite person">Kieran Spear (kspear)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-02-21T05:55:19.469817+00:00" title="2014-02-21 05:55:19 UTC">on 2014-02-21</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/1"> #1</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>auth_token middleware thinks it is retrieving the user&#x27;s token from memcache, but ends up returning the token data for the admin user:</p>
<p>2014-02-21 16:41:56.868 28193 DEBUG keystoneclient.<wbr />middleware.<wbr />auth_token [-] Returning cached token 46b4e15e0bf1bef<wbr />6655dbee7338679<wbr />72. Token data:<br />
{u&#x27;access&#x27;: {u&#x27;token&#x27;: {u&#x27;issued_at&#x27;: u&#x27;2014-<wbr />02-21T05:<wbr />41:51.816330&#x27;<wbr />, u&#x27;expires&#x27;: u&#x27;2014-<wbr />02-21T11:<wbr />41:51Z&#x27;<wbr />, u&#x27;id&#x27;: u&#x27;placeholder&#x27;, u&#x27;tenant&#x27;: {u&#x27;id&#x27;: u&#x27;e4eee8dbc16a4<wbr />9dcbc76edac9667<wbr />4e96&#x27;, u&#x27;enabled&#x27;: True, u&#x27;description&#x27;: None, u&#x27;name&#x27;: u&#x27;admin&#x27;}}</p>
<p>46b4e15e0bf1bef<wbr />6655dbee7338679<wbr />72 is the hash of the user&#x27;s PKI token. But the token data is from another user&#x27;s token!</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">auth_token middleware thinks it is retrieving the user's token from memcache, but ends up returning the token data for the admin user:

2014-02-21 16:41:56.868 28193 DEBUG keystoneclient.middleware.auth_token [-] Returning cached token 46b4e15e0bf1bef6655dbee733867972. Token data: 
{u'access': {u'token': {u'issued_at': u'2014-02-21T05:41:51.816330', u'expires': u'2014-02-21T11:41:51Z', u'id': u'placeholder', u'tenant': {u'id': u'e4eee8dbc16a49dcbc76edac96674e96', u'enabled': True, u'description': None, u'name': u'admin'}}

46b4e15e0bf1bef6655dbee733867972 is the hash of the user's PKI token. But the token data is from another user's token!</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>affects</b>:
      </td>
      <td>
        glance &#8594; python-keystoneclient
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/2" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~kspear" class="sprite person">Kieran Spear (kspear)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-02-21T06:55:10.269029+00:00" title="2014-02-21 06:55:10 UTC">on 2014-02-21</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/2"> #2</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Looks like eventlet doesn&#x27;t play nicely with python-memcache. Monkey patching &#x27;thread&#x27; in cmd/registry.py fixes this.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Looks like eventlet doesn't play nicely with python-memcache. Monkey patching 'thread' in cmd/registry.py fixes this.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/3" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-02-21T09:17:04.036468+00:00" title="2014-02-21 09:17:04 UTC">on 2014-02-21</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/python-keystoneclient/+bug/1282865/comments/3">
                <strong>Re: Keystone middleware may confuse contexts</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/3"> #3</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Looks like it&#x27;s not Glance-specific at all.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Looks like it's not Glance-specific at all.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>summary</b>:
      </td>
      <td>
        - Glance-registry context leak<br />+ Keystone middleware may confuse contexts
      </td>
    </tr>
  
  
    
      <tr>
        <td colspan="2">Changed in glance: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        New &#8594; Invalid
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/4" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-02-21T09:17:34.718515+00:00" title="2014-02-21 09:17:34 UTC">on 2014-02-21</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/4"> #4</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>It&#x27;s a bit random as an attack vector, but I suspect you can still trigger it using load, so probably needs an OSSA</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">It's a bit random as an attack vector, but I suspect you can still trigger it using load, so probably needs an OSSA</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        New &#8594; Incomplete
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~dolph" class="sprite person">Dolph Mathews (dolph)</a>
    
    <time title="2014-02-21 16:05:28 UTC" datetime="2014-02-21T16:05:28.395816+00:00">on 2014-02-21</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in python-keystoneclient: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>importance</b>:
      </td>
      <td>
        Undecided &#8594; Critical
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/5" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~dolph" class="sprite person">Dolph Mathews (dolph)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-02-21T23:33:49.018857+00:00" title="2014-02-21 23:33:49 UTC">on 2014-02-21</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/5"> #5</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I&#x27;m able to reproduce this consistently, and it does appear to be entirely dependent on eventlet monkey patching &quot;thread&quot;. In my test, 100,000 requests through auth_token split between two users with different authorization, their authorization gets swapped about 0.2% of the time.</p>
<p>With sufficient load, python-memcached enabled in auth_token, and an unpatched thread module, eventlet produces this failure:</p>
<p>Traceback (most recent call last):<br />
&nbsp;&nbsp;File &quot;.../lib/<wbr />python2.<wbr />7/site-<wbr />packages/<wbr />eventlet/<wbr />wsgi.py&quot;<wbr />, line 414, in handle_one_response<br />
&nbsp;&nbsp;&nbsp;&nbsp;write(&#x27;&#x27;)<br />
&nbsp;&nbsp;File &quot;.../lib/<wbr />python2.<wbr />7/site-<wbr />packages/<wbr />eventlet/<wbr />wsgi.py&quot;<wbr />, line 354, in write<br />
&nbsp;&nbsp;&nbsp;&nbsp;_writelines<wbr />(towrite)<br />
&nbsp;&nbsp;File &quot;.../python/<wbr />2.7.6/Framework<wbr />s/Python.<wbr />framework/<wbr />Versions/<wbr />2.7/lib/<wbr />python2.<wbr />7/socket.<wbr />py&quot;, line 334, in writelines<br />
&nbsp;&nbsp;&nbsp;&nbsp;self.flush()<br />
&nbsp;&nbsp;File &quot;.../python/<wbr />2.7.6/Framework<wbr />s/Python.<wbr />framework/<wbr />Versions/<wbr />2.7/lib/<wbr />python2.<wbr />7/socket.<wbr />py&quot;, line 303, in flush<br />
&nbsp;&nbsp;&nbsp;&nbsp;self.<wbr />_sock.sendall(<wbr />view[write_<wbr />offset:<wbr />write_offset+<wbr />buffer_<wbr />size])<br />
&nbsp;&nbsp;File &quot;.../lib/<wbr />python2.<wbr />7/site-<wbr />packages/<wbr />eventlet/<wbr />greenio.<wbr />py&quot;, line 309, in sendall<br />
&nbsp;&nbsp;&nbsp;&nbsp;tail = self.send(data, flags)<br />
&nbsp;&nbsp;File &quot;.../lib/<wbr />python2.<wbr />7/site-<wbr />packages/<wbr />eventlet/<wbr />greenio.<wbr />py&quot;, line 295, in send<br />
&nbsp;&nbsp;&nbsp;&nbsp;total_sent += fd.send(<wbr />data[total_<wbr />sent:], flags)<br />
error: [Errno 32] Broken pipe</p>
<p>And python-memcached warns about unexpected responses from memcached:</p>
<p>&nbsp;&nbsp;MemCached: while expecting &#x27;STORED&#x27;, got unexpected response &#x27;VALUE tokens/<wbr />acfaaff23f1576c<wbr />b8485a797beb60f<wbr />f4 0 1282&#x27;<br />
&nbsp;&nbsp;MemCached: while expecting &#x27;STORED&#x27;, got unexpected response &#x27;END&#x27;</p>
<p>Given that auth_token does not depend on eventlet itself, but instead can be run by eventlet in another service, then all services depending on eventlet and relying on auth_token should be the ones to monkeypatch thread. That said, monkeypatching thread in keystoneclient/<wbr />openstack/<wbr />common/<wbr />memorycache.<wbr />py appears to resolve the problem as well.</p>
<p>Glance stable/havana appears to be affected:</p>
<p>&nbsp;&nbsp;<a rel="nofollow" href="https://github.com/openstack/glance/blob/stable/havana/glance/cmd/registry.py#L30">https:/<wbr />/github.<wbr />com/openstack/<wbr />glance/<wbr />blob/stable/<wbr />havana/<wbr />glance/<wbr />cmd/registry.<wbr />py#L30</a></p>
<p>Glance master does not appear to be affected:</p>
<p>&nbsp;&nbsp;<a rel="nofollow" href="https://github.com/openstack/glance/blob/master/glance/cmd/registry.py#L29">https:/<wbr />/github.<wbr />com/openstack/<wbr />glance/<wbr />blob/master/<wbr />glance/<wbr />cmd/registry.<wbr />py#L29</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I'm able to reproduce this consistently, and it does appear to be entirely dependent on eventlet monkey patching "thread". In my test, 100,000 requests through auth_token split between two users with different authorization, their authorization gets swapped about 0.2% of the time.

With sufficient load, python-memcached enabled in auth_token, and an unpatched thread module, eventlet produces this failure:

Traceback (most recent call last):
  File ".../lib/python2.7/site-packages/eventlet/wsgi.py", line 414, in handle_one_response
    write('')
  File ".../lib/python2.7/site-packages/eventlet/wsgi.py", line 354, in write
    _writelines(towrite)
  File ".../python/2.7.6/Frameworks/Python.framework/Versions/2.7/lib/python2.7/socket.py", line 334, in writelines
    self.flush()
  File ".../python/2.7.6/Frameworks/Python.framework/Versions/2.7/lib/python2.7/socket.py", line 303, in flush
    self._sock.sendall(view[write_offset:write_offset+buffer_size])
  File ".../lib/python2.7/site-packages/eventlet/greenio.py", line 309, in sendall
    tail = self.send(data, flags)
  File ".../lib/python2.7/site-packages/eventlet/greenio.py", line 295, in send
    total_sent += fd.send(data[total_sent:], flags)
error: [Errno 32] Broken pipe

And python-memcached warns about unexpected responses from memcached:

  MemCached: while expecting 'STORED', got unexpected response 'VALUE tokens/acfaaff23f1576cb8485a797beb60ff4 0 1282'
  MemCached: while expecting 'STORED', got unexpected response 'END'

Given that auth_token does not depend on eventlet itself, but instead can be run by eventlet in another service, then all services depending on eventlet and relying on auth_token should be the ones to monkeypatch thread. That said, monkeypatching thread in keystoneclient/openstack/common/memorycache.py appears to resolve the problem as well.

Glance stable/havana appears to be affected:

  https://github.com/openstack/glance/blob/stable/havana/glance/cmd/registry.py#L30

Glance master does not appear to be affected:

  https://github.com/openstack/glance/blob/master/glance/cmd/registry.py#L29</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in python-keystoneclient: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        New &#8594; Confirmed
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/6" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~dolph" class="sprite person">Dolph Mathews (dolph)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-02-21T23:43:04.354162+00:00" title="2014-02-21 23:43:04 UTC">on 2014-02-21</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/6"> #6</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/python-keystoneclient/+bug/1282865/+attachment/3990345/+files/keystoneclient-repro-bug-1282865.diff">keystoneclient-repro-bug-1282865.diff</a>
        <a class="sprite edit action-icon" href="/python-keystoneclient/+bug/1282865/+attachment/3990345">Edit</a>
        (1.1 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>To reproduce the issue in isolation, I wrote a simple echo service to run behind auth_token which can inform the client if the service&#x27;s perceived tenancy does not reflect the user&#x27;s expectation. <a rel="nofollow" href="https://review.openstack.org/#/c/75529/">https:/<wbr />/review.<wbr />openstack.<wbr />org/#/c/<wbr />75529/</a></p>
<p>Patchset 1 of the above review depends on wsgiref from stdlib instead of eventlet. `keystoneclient<wbr />-repro-<a href="/bugs/1282865" class="bug-link">bug-1282865</a>.diff` modifies that patchset to use eventlet, and monkeypatches with eventlet similarly to how glance stable/havana does (without also monkeypatching thread).</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">To reproduce the issue in isolation, I wrote a simple echo service to run behind auth_token which can inform the client if the service's perceived tenancy does not reflect the user's expectation. https://review.openstack.org/#/c/75529/

Patchset 1 of the above review depends on wsgiref from stdlib instead of eventlet. `keystoneclient-repro-bug-1282865.diff` modifies that patchset to use eventlet, and monkeypatches with eventlet similarly to how glance stable/havana does (without also monkeypatching thread).</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/7" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~dolph" class="sprite person">Dolph Mathews (dolph)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-02-22T00:03:53.641993+00:00" title="2014-02-22 00:03:53 UTC">on 2014-02-22</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/7"> #7</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite download-icon" href="https://bugs.launchpad.net/python-keystoneclient/+bug/1282865/+attachment/3990374/+files/repro_bug_1282865.py">repro_bug_1282865.py</a>
        <a class="sprite edit action-icon" href="/python-keystoneclient/+bug/1282865/+attachment/3990374">Edit</a>
        (3.6 KiB,
        text/x-python)
      </li>
    </ul>

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>This attachment demonstrates the issue by acting as a API client to bootstrap some data in keystone, generate valid tokens and produce load against a service protected by auth_token.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">This attachment demonstrates the issue by acting as a API client to bootstrap some data in keystone, generate valid tokens and produce load against a service protected by auth_token.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/8" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~dolph" class="sprite person">Dolph Mathews (dolph)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-02-22T00:06:45.116134+00:00" title="2014-02-22 00:06:45 UTC">on 2014-02-22</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/8"> #8</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/python-keystoneclient/+bug/1282865/+attachment/3990378/+files/keystoneclient-fix-bug-1282865.diff">keystoneclient-fix-bug-1282865.diff</a>
        <a class="sprite edit action-icon" href="/python-keystoneclient/+bug/1282865/+attachment/3990378">Edit</a>
        (982 bytes,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>This avoids the issue in keystoneclient by patching keystoneclient.<wbr />openstack.<wbr />common.<wbr />memorycache (oslo)</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">This avoids the issue in keystoneclient by patching keystoneclient.openstack.common.memorycache (oslo)</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~dolph" class="sprite person">Dolph Mathews (dolph)</a>
    
    <time title="2014-02-22 00:12:19 UTC" datetime="2014-02-22T00:12:19.503622+00:00">on 2014-02-22</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in python-keystoneclient: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>assignee</b>:
      </td>
      <td>
        nobody &#8594; Dolph Mathews (dolph)
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/9" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-02-24T09:13:50.659868+00:00" title="2014-02-24 09:13:50 UTC">on 2014-02-24</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/9"> #9</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>@Dolph: nice work. I wa</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">@Dolph: nice work. I wa</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/10" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-02-24T09:16:00.333530+00:00" title="2014-02-24 09:16:00 UTC">on 2014-02-24</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/10"> #10</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>(damn LP)<br />
...s wondering if that could not explain the two reports we had in the past of context confusion (&quot;Tenant A is seeing the VNC Consoles of Tenant B!&quot;)</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">(damn LP)
...s wondering if that could not explain the two reports we had in the past of context confusion ("Tenant A is seeing the VNC Consoles of Tenant B!")</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/11" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-02-24T09:21:30.912032+00:00" title="2014-02-24 09:21:30 UTC">on 2014-02-24</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/11"> #11</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I am a bit confused as to the extent of the issue.</p>
<p>IIUC fixing it in python-<wbr />keystoneclient is enough to cover all cases -- and then *some* middleware consumers that already patched eventlet.thread might be safe already (like Glance master).</p>
<p>Kieran: are you running Glance master or havana ?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I am a bit confused as to the extent of the issue.

IIUC fixing it in python-keystoneclient is enough to cover all cases -- and then *some* middleware consumers that already patched eventlet.thread might be safe already (like Glance master).

Kieran: are you running Glance master or havana ?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/12" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~dolph" class="sprite person">Dolph Mathews (dolph)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-02-24T14:43:01.959603+00:00" title="2014-02-24 14:43:01 UTC">on 2014-02-24</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/12"> #12</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>A single fix in python-<wbr />keystoneclient would be sufficient to protect any deployments carrying the patch, but I&#x27;m not familiar enough with the vulnerability management &amp; packaging process for clients to make a recommendation against patching any affected services as well.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">A single fix in python-keystoneclient would be sufficient to protect any deployments carrying the patch, but I'm not familiar enough with the vulnerability management &amp; packaging process for clients to make a recommendation against patching any affected services as well.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
    
    <time title="2014-02-24 15:17:06 UTC" datetime="2014-02-24T15:17:06.585497+00:00">on 2014-02-24</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Incomplete &#8594; Confirmed
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/13" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-02-24T17:48:14.042670+00:00" title="2014-02-24 17:48:14 UTC">on 2014-02-24</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/13"> #13</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I assumed any authenticated requests could results in context swap.<br />
Memcached_server appeared in 0.2.3 (git grep memcached_servers 0.2.2 0.2.3).</p>
<p>@Kieran: Please correct me if I&#x27;m wrong about the University of Melbourne credit.</p>
<p>Draft impact description #1 -</p>
<p>Title: Privilege escalation in auth_token middleware<br />
Reporter: Kieran Spear (University of Melbourne)<br />
Products: python-<wbr />keystoneclient<br />
Versions: 0.2.3 version up to 0.6.0</p>
<p>Description:<br />
Kieran Spear from the University of Melbourne reported a vulnerability in python-<wbr />keystoneclient auth_token middleware. By doing repeated authenticated requests, with sufficient load on the target system, an authenticated user can inherit another authenticated user&#x27;s role resulting in a privilege escalation. Note that it is related to a bad interaction between auth_token and eventlet that is fixed if the process used eventlet thread monkey patching. Only setups using auth_token with memcache are vulnerable.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I assumed any authenticated requests could results in context swap.
Memcached_server appeared in 0.2.3 (git grep memcached_servers 0.2.2 0.2.3).

@Kieran: Please correct me if I'm wrong about the University of Melbourne credit.

Draft impact description #1 -

Title: Privilege escalation in auth_token middleware
Reporter: Kieran Spear (University of Melbourne)
Products: python-keystoneclient
Versions: 0.2.3 version up to 0.6.0

Description:
Kieran Spear from the University of Melbourne reported a vulnerability in python-keystoneclient auth_token middleware. By doing repeated authenticated requests, with sufficient load on the target system, an authenticated user can inherit another authenticated user's role resulting in a privilege escalation. Note that it is related to a bad interaction between auth_token and eventlet that is fixed if the process used eventlet thread monkey patching. Only setups using auth_token with memcache are vulnerable.
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/14" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~kspear" class="sprite person">Kieran Spear (kspear)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-02-25T02:54:37.000668+00:00" title="2014-02-25 02:54:37 UTC">on 2014-02-25</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/14"> #14</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>@Dolph: Thanks for the great analysis. I suspect you&#x27;d find a higher failure rate if you change the ratio of requests. When I tested using the clients I used 1 endlessly looping user client and 5 admin clients, and saw the bug a few times per second.</p>
<p>@Thierry: I&#x27;m running Havana. I always forget to mention that...</p>
<p>@Tristan<br />
I think this has been an issue since 0.2.0 (and before that the code was in Keystone itself):<br />
<a rel="nofollow" href="https://github.com/openstack/python-keystoneclient/commit/7920899af119d1697c333d202ca3272f167c19b0">https:/<wbr />/github.<wbr />com/openstack/<wbr />python-<wbr />keystoneclient/<wbr />commit/<wbr />7920899af119d16<wbr />97c333d202ca327<wbr />2f167c19b0</a></p>
<p>I would list the OpenStack services/versions affected too. Most of the other projects except Ceilometer [1] seem to be patching thread already (at least on master). We don&#x27;t have memcache enabled for Ceilometer so I can&#x27;t check whether it is vulnerable in practice.</p>
<p>[1] <a rel="nofollow" href="https://github.com/openstack/ceilometer/search?q=monkey_patch&amp;type=Code">https:/<wbr />/github.<wbr />com/openstack/<wbr />ceilometer/<wbr />search?<wbr />q=monkey_<wbr />patch&amp;type=<wbr />Code</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">@Dolph: Thanks for the great analysis. I suspect you'd find a higher failure rate if you change the ratio of requests. When I tested using the clients I used 1 endlessly looping user client and 5 admin clients, and saw the bug a few times per second.

@Thierry: I'm running Havana. I always forget to mention that...

@Tristan
I think this has been an issue since 0.2.0 (and before that the code was in Keystone itself):
https://github.com/openstack/python-keystoneclient/commit/7920899af119d1697c333d202ca3272f167c19b0

I would list the OpenStack services/versions affected too. Most of the other projects except Ceilometer [1] seem to be patching thread already (at least on master). We don't have memcache enabled for Ceilometer so I can't check whether it is vulnerable in practice.

[1] https://github.com/openstack/ceilometer/search?q=monkey_patch&amp;type=Code
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/15" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~dolph" class="sprite person">Dolph Mathews (dolph)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-02-25T04:34:15.777327+00:00" title="2014-02-25 04:34:15 UTC">on 2014-02-25</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/15"> #15</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Suggested revisions to impact description:</p>
<p>&quot;Note that it is related to a bad interaction between auth_token and eventlet that is fixed if the process used eventlet thread monkey patching.&quot; -&gt; &quot;Note that it is related to a bad interaction between eventlet and python-memcached that is fixed if the process uses eventlet to monkey patch &#x27;thread&#x27;.&quot;</p>
<p>- it&#x27;s really an issue between the python-memcached and eventlet; auth_token just happens to optionally consume python-memcached while being (typically) served by eventlet (**this may affect any other service using memcached + eventlet**)<br />
- thread is worth putting in quotes IMO, because it actually results in 3 modules being patched (thread, threading and Queue) [1]</p>
<p>&quot;inherit another authenticated user&#x27;s role resulting in a privilege escalation&quot; -&gt; &quot;assume another authenticated user&#x27;s complete identity and multi-tenant authorization, potentially resulting in a privilege escalation&quot;</p>
<p>- &quot;role&quot; is a little too narrow if I&#x27;m being pedantic -- it&#x27;s not just role confusion, or authorization confusion, but completely picking up another user&#x27;s authentication + authorization<br />
- &quot;inherit&quot; seems to imply that it&#x27;s added on to the existing (valid) authn + authz, when it fact it just replaces it<br />
- &quot;resulting in privilege escalation&quot; is just a potential / likelihood, but it&#x27;s not a guaranteed outcome, i suppose</p>
<p>[1] <a rel="nofollow" href="http://eventlet.net/doc/patching.html#monkeypatching-the-standard-library">http://<wbr />eventlet.<wbr />net/doc/<wbr />patching.<wbr />html#monkeypatc<wbr />hing-the-<wbr />standard-<wbr />library</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Suggested revisions to impact description:

"Note that it is related to a bad interaction between auth_token and eventlet that is fixed if the process used eventlet thread monkey patching." -&gt; "Note that it is related to a bad interaction between eventlet and python-memcached that is fixed if the process uses eventlet to monkey patch 'thread'."

- it's really an issue between the python-memcached and eventlet; auth_token just happens to optionally consume python-memcached while being (typically) served by eventlet (**this may affect any other service using memcached + eventlet**)
- thread is worth putting in quotes IMO, because it actually results in 3 modules being patched (thread, threading and Queue) [1]


"inherit another authenticated user's role resulting in a privilege escalation" -&gt; "assume another authenticated user's complete identity and multi-tenant authorization, potentially resulting in a privilege escalation"

- "role" is a little too narrow if I'm being pedantic -- it's not just role confusion, or authorization confusion, but completely picking up another user's authentication + authorization
- "inherit" seems to imply that it's added on to the existing (valid) authn + authz, when it fact it just replaces it
- "resulting in privilege escalation" is just a potential / likelihood, but it's not a guaranteed outcome, i suppose

[1] http://eventlet.net/doc/patching.html#monkeypatching-the-standard-library</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/16" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-02-25T08:36:58.858061+00:00" title="2014-02-25 08:36:58 UTC">on 2014-02-25</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/16"> #16</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I would use &quot;Potential context confusion in Keystone middleware&quot; as the title.</p>
<p>Also : &quot;...that is fixed if the process used eventlet...&quot; -&gt; &quot;...that is avoided if the calling process already used eventlet...&quot;</p>
<p>-&gt; the issue is not fixed if the process already monkey-patched &#x27;thread&#x27;, it is not vulnerable in the first place<br />
-&gt; &quot;calling&quot; process makes it IMHO clearer that we are talking about the server project using the middleware.</p>
<p>If we precisely analyze the grizzly/havana affected server software, we could end with something like: &quot;In Grizzly and Havana, only Glance and Ceilometer were found to be affected. Also note that only keystone middleware setups using auth_token with memcache are vulnerable.&quot;</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I would use "Potential context confusion in Keystone middleware" as the title.

Also : "...that is fixed if the process used eventlet..." -&gt; "...that is avoided if the calling process already used eventlet..."

-&gt; the issue is not fixed if the process already monkey-patched 'thread', it is not vulnerable in the first place
-&gt; "calling" process makes it IMHO clearer that we are talking about the server project using the middleware.

If we precisely analyze the grizzly/havana affected server software, we could end with something like: "In Grizzly and Havana, only Glance and Ceilometer were found to be affected. Also note that only keystone middleware setups using auth_token with memcache are vulnerable."</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/17" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-02-25T10:25:38.928587+00:00" title="2014-02-25 10:25:38 UTC">on 2014-02-25</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/17"> #17</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Many thanks for your suggestions guys!</p>
<p>This is the revised draft, I did not include the comprehensive affected services list because it might be overkill here and a bit risky if we miss something...<br />
For example Nova have three differents strategies to cope with eventlet monkey patching:<br />
* In grizzly, some services are not monkey patched at all (like the novncproxy that Thierry mentioned)<br />
* In havanna, all services are monkey patched by default<br />
* In icehouse, if &quot;--remote-debug&quot; switches are used, then &quot;thread&quot; is not monkey patched...</p>
<p>What do you think if we just say that &quot;Only keystone middleware setups using auth_token with memcache are vulnerable&quot; ?</p>
<p>@Dolph: do you know if the fix (comment #8) need to be backported for grizzly and havanna or will it works as-is ?</p>
<p>Draft impact description #2 -</p>
<p>Title: Potential context confusion in Keystone middleware<br />
Reporter: Kieran Spear (University of Melbourne)<br />
Products: python-<wbr />keystoneclient<br />
Versions: 0.2.0 version up to 0.6.0</p>
<p>Description:<br />
Kieran Spear from the University of Melbourne reported a vulnerability in python-<wbr />keystoneclient auth_token middleware. By doing repeated authenticated requests, with sufficient load on the target system, an authenticated user can assume another authenticated user&#x27;s complete identity and multi-tenant authorizations, potentially resulting in a privilege escalation. Note that it is related to a bad interaction between eventlet and python-memcached that may be avoided if the calling process already uses eventlet to monkey patch &quot;thread&quot;. Only keystone middleware setups using auth_token with memcache are vulnerable.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Many thanks for your suggestions guys!

This is the revised draft, I did not include the comprehensive affected services list because it might be overkill here and a bit risky if we miss something...
For example Nova have three differents strategies to cope with eventlet monkey patching:
* In grizzly, some services are not monkey patched at all (like the novncproxy that Thierry mentioned)
* In havanna, all services are monkey patched by default
* In icehouse, if "--remote-debug" switches are used, then "thread" is not monkey patched...

What do you think if we just say that "Only keystone middleware setups using auth_token with memcache are vulnerable" ?

@Dolph: do you know if the fix (comment #8) need to be backported for grizzly and havanna or will it works as-is ?

Draft impact description #2 -

Title: Potential context confusion in Keystone middleware
Reporter: Kieran Spear (University of Melbourne)
Products: python-keystoneclient
Versions: 0.2.0 version up to 0.6.0

Description:
Kieran Spear from the University of Melbourne reported a vulnerability in python-keystoneclient auth_token middleware. By doing repeated authenticated requests, with sufficient load on the target system, an authenticated user can assume another authenticated user's complete identity and multi-tenant authorizations, potentially resulting in a privilege escalation. Note that it is related to a bad interaction between eventlet and python-memcached that may be avoided if the calling process already uses eventlet to monkey patch "thread". Only keystone middleware setups using auth_token with memcache are vulnerable.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/18" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-02-25T11:12:50.741362+00:00" title="2014-02-25 11:12:50 UTC">on 2014-02-25</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/18"> #18</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>A few suggestions:</p>
<p>&#x27;vulnerability in python-<wbr />keystoneclient auth_token middleware&#x27; -&gt; &#x27;vulnerability in Keystone auth_token middleware (shipped in python-<wbr />keystoneclient)<wbr />&#x27;</p>
<p>&#x27;can&#x27; -&gt; &#x27;may in certain situations&#x27;</p>
<p>&#x27;already uses eventlet to monkey patch &quot;thread&quot;&#x27; -&gt; &#x27;already monkey-patches &quot;thread&quot; to use eventlet&#x27;</p>
<p>Versions: I would say &quot;all versions up to 0.6.0&quot; -- the middleware was shipped within Keystone before, so the issue didn&#x27;t start with 0.2.0.</p>
<p>Note that there is no need to backport the patch at all, since there is only one branch in python-<wbr />keystoneclient. We may have to play tricks if we pinned python-<wbr />keystoneclient to a certain version in the grizzly gate, though (a bit like the recent python-swiftclient debacle).</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">A few suggestions:

'vulnerability in python-keystoneclient auth_token middleware' -&gt; 'vulnerability in Keystone auth_token middleware (shipped in python-keystoneclient)'

'can' -&gt; 'may in certain situations'

'already uses eventlet to monkey patch "thread"' -&gt; 'already monkey-patches "thread" to use eventlet'

Versions: I would say "all versions up to 0.6.0" -- the middleware was shipped within Keystone before, so the issue didn't start with 0.2.0.

Note that there is no need to backport the patch at all, since there is only one branch in python-keystoneclient. We may have to play tricks if we pinned python-keystoneclient to a certain version in the grizzly gate, though (a bit like the recent python-swiftclient debacle).</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>importance</b>:
      </td>
      <td>
        Undecided &#8594; Critical
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/19" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-02-25T12:40:12.610555+00:00" title="2014-02-25 12:40:12 UTC">on 2014-02-25</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/19"> #19</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>With latests suggestions:</p>
<p>Draft impact description #3 -</p>
<p>Title: Potential context confusion in Keystone middleware<br />
Reporter: Kieran Spear (University of Melbourne)<br />
Products: python-<wbr />keystoneclient<br />
Versions: all version up to 0.6.0</p>
<p>Description:<br />
Kieran Spear from the University of Melbourne reported a vulnerability in Keystone auth_token middleware (shipped in python-<wbr />keystoneclient)<wbr />. By doing repeated authenticated requests, with sufficient load on the target system, an authenticated user may in certain situations assume another authenticated user&#x27;s complete identity and multi-tenant authorizations, potentially resulting in a privilege escalation. Note that it is related to a bad interaction between eventlet and python-memcached that may be avoided if the calling process already monkey-patches &quot;thread&quot; to use eventlet. Only keystone middleware setups using auth_token with memcache are vulnerable.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">With latests suggestions:

Draft impact description #3 -

Title: Potential context confusion in Keystone middleware
Reporter: Kieran Spear (University of Melbourne)
Products: python-keystoneclient
Versions: all version up to 0.6.0

Description:
Kieran Spear from the University of Melbourne reported a vulnerability in Keystone auth_token middleware (shipped in python-keystoneclient). By doing repeated authenticated requests, with sufficient load on the target system, an authenticated user may in certain situations assume another authenticated user's complete identity and multi-tenant authorizations, potentially resulting in a privilege escalation. Note that it is related to a bad interaction between eventlet and python-memcached that may be avoided if the calling process already monkey-patches "thread" to use eventlet. Only keystone middleware setups using auth_token with memcache are vulnerable.
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/20" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-02-25T14:34:32.965656+00:00" title="2014-02-25 14:34:32 UTC">on 2014-02-25</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/20"> #20</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Last-minute nitpicking (but we need to get this one right, as it&#x27;s pretty massive):</p>
<p>all version -&gt; All versions</p>
<p>By doing repeated authenticated requests -&gt; By doing repeated requests<br />
(we already mention that the user is authenticated later in the same sentence)</p>
<p>may be avoided -&gt; should be avoided<br />
(conveys slightly more certainty that thread-<wbr />monkey-<wbr />patching consumers are safe)</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Last-minute nitpicking (but we need to get this one right, as it's pretty massive):

all version -&gt; All versions

By doing repeated authenticated requests -&gt; By doing repeated requests 
(we already mention that the user is authenticated later in the same sentence)

may be avoided -&gt; should be avoided
(conveys slightly more certainty that thread-monkey-patching consumers are safe)</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/21" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-02-25T15:05:06.801909+00:00" title="2014-02-25 15:05:06 UTC">on 2014-02-25</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/21"> #21</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Agree, this bug deserve much attention!</p>
<p>Draft impact description #4 -</p>
<p>Title: Potential context confusion in Keystone middleware<br />
Reporter: Kieran Spear (University of Melbourne)<br />
Products: python-<wbr />keystoneclient<br />
Versions: All versions up to 0.6.0</p>
<p>Description:<br />
Kieran Spear from the University of Melbourne reported a vulnerability in Keystone auth_token middleware (shipped in python-<wbr />keystoneclient)<wbr />. By doing repeated requests, with sufficient load on the target system, an authenticated user may in certain situations assume another authenticated user&#x27;s complete identity and multi-tenant authorizations, potentially resulting in a privilege escalation. Note that it is related to a bad interaction between eventlet and python-memcached that should be avoided if the calling process already monkey-patches &quot;thread&quot; to use eventlet. Only keystone middleware setups using auth_token with memcache are vulnerable.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Agree, this bug deserve much attention!

Draft impact description #4 -

Title: Potential context confusion in Keystone middleware
Reporter: Kieran Spear (University of Melbourne)
Products: python-keystoneclient
Versions: All versions up to 0.6.0

Description:
Kieran Spear from the University of Melbourne reported a vulnerability in Keystone auth_token middleware (shipped in python-keystoneclient). By doing repeated requests, with sufficient load on the target system, an authenticated user may in certain situations assume another authenticated user's complete identity and multi-tenant authorizations, potentially resulting in a privilege escalation. Note that it is related to a bad interaction between eventlet and python-memcached that should be avoided if the calling process already monkey-patches "thread" to use eventlet. Only keystone middleware setups using auth_token with memcache are vulnerable.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>assignee</b>:
      </td>
      <td>
        nobody &#8594; Tristan Cacqueray (tristan-cacqueray)
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/22" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-02-25T16:07:45.011683+00:00" title="2014-02-25 16:07:45 UTC">on 2014-02-25</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/22"> #22</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>+1 on version 4 of impact description, great work!</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">+1 on version 4 of impact description, great work!</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/23" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~dolph" class="sprite person">Dolph Mathews (dolph)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-02-25T18:52:04.603202+00:00" title="2014-02-25 18:52:04 UTC">on 2014-02-25</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/23"> #23</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>+1 for impact description</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">+1 for impact description</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/24" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-02-26T12:56:13.434096+00:00" title="2014-02-26 12:56:13 UTC">on 2014-02-26</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/24"> #24</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>@Dolph: could you round up some keystone-core reviews of your proposed patch ?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">@Dolph: could you round up some keystone-core reviews of your proposed patch ?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/25" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~blk-u" class="sprite person">Brant Knudson (blk-u)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-02-28T17:07:35.453678+00:00" title="2014-02-28 17:07:35 UTC">on 2014-02-28</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/25"> #25</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>@Dolph: looking at the patch in comment #8 -- it looks like the code is assuming that auth_token is running in eventlet if it can import eventlet.patcher... but won&#x27;t the work even if the server isn&#x27;t running in eventlet, if eventlet is installed somewhere that it can be found?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">@Dolph: looking at the patch in comment #8 -- it looks like the code is assuming that auth_token is running in eventlet if it can import eventlet.patcher... but won't the work even if the server isn't running in eventlet, if eventlet is installed somewhere that it can be found?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/26" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~blk-u" class="sprite person">Brant Knudson (blk-u)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-02-28T17:17:37.386692+00:00" title="2014-02-28 17:17:37 UTC">on 2014-02-28</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/26"> #26</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Another concern is that this is going to monkeypatch threads in the middle of handling a request... isn&#x27;t that supposed to happen early on in the application, like before any threads are started?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Another concern is that this is going to monkeypatch threads in the middle of handling a request... isn't that supposed to happen early on in the application, like before any threads are started?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/27" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~blk-u" class="sprite person">Brant Knudson (blk-u)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-02-28T17:18:41.218423+00:00" title="2014-02-28 17:18:41 UTC">on 2014-02-28</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/27"> #27</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I would rather that we said that if an application is using auth_token middleware in eventlet then the application needs to monkeypatch threads.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I would rather that we said that if an application is using auth_token middleware in eventlet then the application needs to monkeypatch threads.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/28" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~blk-u" class="sprite person">Brant Knudson (blk-u)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-02-28T17:30:41.378439+00:00" title="2014-02-28 17:30:41 UTC">on 2014-02-28</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/28"> #28</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Here&#x27;s from the eventlet documentation[1]: &quot;It is important to call monkey_patch() as early in the lifetime of the application as possible. Try to do it as one of the first lines in the main module.&quot; So I don&#x27;t think it&#x27;s safe to wait until an incoming request is received to do the monkey-patching.</p>
<p>[1] <a rel="nofollow" href="http://eventlet.net/doc/patching.html#monkeypatching-the-standard-library">http://<wbr />eventlet.<wbr />net/doc/<wbr />patching.<wbr />html#monkeypatc<wbr />hing-the-<wbr />standard-<wbr />library</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Here's from the eventlet documentation[1]: "It is important to call monkey_patch() as early in the lifetime of the application as possible. Try to do it as one of the first lines in the main module." So I don't think it's safe to wait until an incoming request is received to do the monkey-patching.

[1] http://eventlet.net/doc/patching.html#monkeypatching-the-standard-library
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/29" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~dolph" class="sprite person">Dolph Mathews (dolph)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-02-28T20:31:36.337515+00:00" title="2014-02-28 20:31:36 UTC">on 2014-02-28</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/29"> #29</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Brant: I agree with all your concerns, and my patch is making the assumption that nothing needs to load thread / threading / Queue before python-memcached does (in which case, the monkey patch will work correctly, as happens in my test).</p>
<p>The only other alternative I can think of is for auth_token to completely bail on using touching memcached if the required monkey patching hasn&#x27;t already taken place? (and emit a warning)</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Brant: I agree with all your concerns, and my patch is making the assumption that nothing needs to load thread / threading / Queue before python-memcached does (in which case, the monkey patch will work correctly, as happens in my test).

The only other alternative I can think of is for auth_token to completely bail on using touching memcached if the required monkey patching hasn't already taken place? (and emit a warning)</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/30" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~blk-u" class="sprite person">Brant Knudson (blk-u)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-02-28T21:05:46.610702+00:00" title="2014-02-28 21:05:46 UTC">on 2014-02-28</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/30"> #30</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Dolph - A patch for keystoneclient that verifies that thread was monkey patched as required in eventlet would be a good one to have. Maybe keystoneclient could use is_monkey_patched to see if anything else was monkeypatched and if so require that thread is monkeypatched? I don&#x27;t know if you can tell that the application is running under eventlet?</p>
<p>The other projects that use eventlet would have to change to do the thread monkeypatching.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Dolph - A patch for keystoneclient that verifies that thread was monkey patched as required in eventlet would be a good one to have. Maybe keystoneclient could use is_monkey_patched to see if anything else was monkeypatched and if so require that thread is monkeypatched? I don't know if you can tell that the application is running under eventlet?

The other projects that use eventlet would have to change to do the thread monkeypatching.
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/31" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~blk-u" class="sprite person">Brant Knudson (blk-u)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-02-28T21:45:48.321691+00:00" title="2014-02-28 21:45:48 UTC">on 2014-02-28</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/31"> #31</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Looks like auth_token could check if any eventlet modules have been imported already, by looking at sys.modules...</p>
<p>&nbsp;import sys<br />
&nbsp;any(mod_name for mod_name in sys.modules.keys() if mod_name.<wbr />startswith(<wbr />&#x27;eventlet.<wbr />&#x27;))</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Looks like auth_token could check if any eventlet modules have been imported already, by looking at sys.modules... 

 import sys
 any(mod_name for mod_name in sys.modules.keys() if mod_name.startswith('eventlet.'))
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/32" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~jamielennox" class="sprite person">Jamie Lennox (jamielennox)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-02-28T21:49:54.734982+00:00" title="2014-02-28 21:49:54 UTC">on 2014-02-28</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/32"> #32</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Sorry, this is the first i&#x27;ve seen this bug. I agree with brant here that i don&#x27;t want to assume that auth_token is always running under eventlet. It&#x27;s definetly not always the case.</p>
<p>I&#x27;d prefer to put the change in at top of  openstack.<wbr />common.<wbr />memorycache that says:</p>
<p>if eventlet.<wbr />already_<wbr />patched and not patcher.<wbr />is_monkey_<wbr />patched(<wbr />&#x27;thread&#x27;<wbr />):<br />
&nbsp;&nbsp;&nbsp;&nbsp;raise ConfigError(&quot;You have incorrectly configured eventlet&quot;)</p>
<p>This should inform all servers of the problems of mixing eventlet and memcache - i&#x27;m getting kind of sick of eventlet&#x27;s magic and would just prefer to raise the error. If not the same auto-patch that you proposed above for keystoneclient but in the memorycache module should be ok.</p>
<p>The main problem i see with that is is it possible for a server to load auth_token middleware prior to having called the monkey patch function? In keystone and others that have a bin/keystone-all that manages the paste file internally it should be fine, however anyone that wanted to use a more pure paste deployment would load auth_token first - is this a situation that happens in any servers?  Does it need to be like a on first memcache get check thread patched and then flag it as done?</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Sorry, this is the first i've seen this bug. I agree with brant here that i don't want to assume that auth_token is always running under eventlet. It's definetly not always the case. 

I'd prefer to put the change in at top of  openstack.common.memorycache that says: 

if eventlet.already_patched and not patcher.is_monkey_patched('thread'):
    raise ConfigError("You have incorrectly configured eventlet") 

This should inform all servers of the problems of mixing eventlet and memcache - i'm getting kind of sick of eventlet's magic and would just prefer to raise the error. If not the same auto-patch that you proposed above for keystoneclient but in the memorycache module should be ok.

The main problem i see with that is is it possible for a server to load auth_token middleware prior to having called the monkey patch function? In keystone and others that have a bin/keystone-all that manages the paste file internally it should be fine, however anyone that wanted to use a more pure paste deployment would load auth_token first - is this a situation that happens in any servers?  Does it need to be like a on first memcache get check thread patched and then flag it as done?</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/33" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~jamielennox" class="sprite person">Jamie Lennox (jamielennox)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-02-28T21:54:51.492110+00:00" title="2014-02-28 21:54:51 UTC">on 2014-02-28</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/33"> #33</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Ah skimmed throught that quickly and didn&#x27;t realize that  keystoneclient-fix-<a href="/bugs/1282865" class="bug-link">bug-1282865</a>.diff  was against memoryclient.</p>
<p>I think i prefer the ConfigError, but see that it may break existing servers so i&#x27;m happy with that.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Ah skimmed throught that quickly and didn't realize that  keystoneclient-fix-bug-1282865.diff  was against memoryclient. 

I think i prefer the ConfigError, but see that it may break existing servers so i'm happy with that.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
    
    <time title="2014-03-03 09:41:42 UTC" datetime="2014-03-03T09:41:42.497538+00:00">on 2014-03-03</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>summary</b>:
      </td>
      <td>
        - Keystone middleware may confuse contexts<br />+ Keystone middleware may confuse contexts (CVE-2014-0105)
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/34" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~blk-u" class="sprite person">Brant Knudson (blk-u)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-03-03T14:10:47.771527+00:00" title="2014-03-03 14:10:47 UTC">on 2014-03-03</time><span class="editable-message-last-edit-date">:
              </span>
              <a href="/python-keystoneclient/+bug/1282865/comments/34">
                <strong>Re: Keystone middleware may confuse contexts (CVE-2014-0105)</strong>
              </a>
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/34"> #34</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I think we need to come to an agreement on the approach to take, and then we can implement it. I think the approach to take is to both:</p>
<p>a) change auth_token to fail if it&#x27;s configured for memcached and it&#x27;s running in eventlet and &#x27;thread&#x27; isn&#x27;t monkey-patched.<br />
b) eventlet servers that use auth_token are changed to monkey-patch eventlet &#x27;thread&#x27; in addition to their other monkey-patching.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I think we need to come to an agreement on the approach to take, and then we can implement it. I think the approach to take is to both:

a) change auth_token to fail if it's configured for memcached and it's running in eventlet and 'thread' isn't monkey-patched.
b) eventlet servers that use auth_token are changed to monkey-patch eventlet 'thread' in addition to their other monkey-patching.
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/35" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-03-03T15:18:49.568449+00:00" title="2014-03-03 15:18:49 UTC">on 2014-03-03</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/35"> #35</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>@Brant: we should first estimate what services are actually impacted, see how easy it will be to fix server-side as a security patch.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">@Brant: we should first estimate what services are actually impacted, see how easy it will be to fix server-side as a security patch.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/36" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-03-04T11:03:20.569134+00:00" title="2014-03-04 11:03:20 UTC">on 2014-03-04</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/36"> #36</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>My tests[1] found those services using auth_token without &quot;thread&quot; patched:<br />
* Havana:<br />
&nbsp;&nbsp;glance-registry  ({&#x27;socket&#x27;: True, &#x27;time&#x27;: True})</p>
<p>* Icehouse<br />
&nbsp;&nbsp;ceilometer-api ({&#x27;socket&#x27;: True})<br />
&nbsp;&nbsp;swift</p>
<p>Nova in master is also vulnerable when &quot;--remote_debug&quot; switches are used: &quot;# turn off thread patching to enable the remote debugger&quot;</p>
<p>[1]: <a rel="nofollow" href="http://paste.openstack.org/show/72103/">http://<wbr />paste.openstack<wbr />.org/show/<wbr />72103/</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">My tests[1] found those services using auth_token without "thread" patched:
* Havana:
  glance-registry  ({'socket': True, 'time': True})
  
* Icehouse
  ceilometer-api ({'socket': True})
  swift

Nova in master is also vulnerable when "--remote_debug" switches are used: "# turn off thread patching to enable the remote debugger"


[1]: http://paste.openstack.org/show/72103/</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/37" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-03-04T13:29:26.840449+00:00" title="2014-03-04 13:29:26 UTC">on 2014-03-04</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/37"> #37</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/python-keystoneclient/+bug/1282865/+attachment/4006636/+files/0001-Fix-glance-registry-eventlet-monkey-patchs.patch">Havana fix for glance</a>
        <a class="sprite edit action-icon" href="/python-keystoneclient/+bug/1282865/+attachment/4006636">Edit</a>
        (850 bytes,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>While I&#x27;m not sure my tests are comprehensive (ie shouldn&#x27;t the nova vncproxy also use the auth_token middleware ?), here is an attempt at fixing glance-registry in Havana.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">While I'm not sure my tests are comprehensive (ie shouldn't the nova vncproxy also use the auth_token middleware ?), here is an attempt at fixing glance-registry in Havana.
</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/38" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-03-04T13:46:29.937348+00:00" title="2014-03-04 13:46:29 UTC">on 2014-03-04</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/38"> #38</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/python-keystoneclient/+bug/1282865/+attachment/4006653/+files/0001-Fix-ceilometer-eventlet-monkey-patchs.patch">Icehouse fix for ceilometer</a>
        <a class="sprite edit action-icon" href="/python-keystoneclient/+bug/1282865/+attachment/4006653">Edit</a>
        (920 bytes,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10"></textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/39" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-03-04T13:53:17.353006+00:00" title="2014-03-04 13:53:17 UTC">on 2014-03-04</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/39"> #39</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/python-keystoneclient/+bug/1282865/+attachment/4006654/+files/0001-Fix-swift-eventlet-monkey-patchs.patch">Icehouse fix for swift</a>
        <a class="sprite edit action-icon" href="/python-keystoneclient/+bug/1282865/+attachment/4006654">Edit</a>
        (962 bytes,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10"></textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
    
    <time title="2014-03-04 16:39:04 UTC" datetime="2014-03-04T16:39:04.180847+00:00">on 2014-03-04</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in glance: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Invalid &#8594; Confirmed
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/40" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~dolph" class="sprite person">Dolph Mathews (dolph)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-03-10T20:31:53.625050+00:00" title="2014-03-10 20:31:53 UTC">on 2014-03-10</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/40"> #40</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>The same underlying issue was independently and publicly reported against python-<wbr />keystoneclient in <a href="/bugs/1289074" class="bug-link">bug 1289074</a>.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">The same underlying issue was independently and publicly reported against python-keystoneclient in bug 1289074.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/41" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-03-12T13:56:00.887355+00:00" title="2014-03-12 13:56:00 UTC">on 2014-03-12</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/41"> #41</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I think a security-minded read of <a href="/bugs/1289074" class="bug-link">bug 1289074</a> (ie: Garbage in tokens&#x27; cache) would lead to this issue.</p>
<p>So if you guys agree, I propose to open this bug and mark 1289074 as a duplicate of this one. This should also help having a fix more quickly.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I think a security-minded read of bug 1289074 (ie: Garbage in tokens' cache) would lead to this issue.

So if you guys agree, I propose to open this bug and mark 1289074 as a duplicate of this one. This should also help having a fix more quickly. </textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/42" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~dolph" class="sprite person">Dolph Mathews (dolph)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-03-13T04:01:37.101714+00:00" title="2014-03-13 04:01:37 UTC">on 2014-03-13</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/42"> #42</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p><a rel="nofollow" href="https://bugs.launchpad.net/python-keystoneclient/+bug/1289074/comments/3">https:/<wbr />/bugs.launchpad<wbr />.net/python-<wbr />keystoneclient/<wbr />+bug/1289074/<wbr />comments/<wbr />3</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">https://bugs.launchpad.net/python-keystoneclient/+bug/1289074/comments/3</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/43" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~chungg" class="sprite person">gordon chung (chungg)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-03-14T14:20:57.916060+00:00" title="2014-03-14 14:20:57 UTC">on 2014-03-14</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/43"> #43</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>haven&#x27;t verified this bug in Ceilometer yet but regarding monkey_patching  eventlets... that solution won&#x27;t work in Ceilometer as it causes issues (see Julien&#x27;s comment in <a rel="nofollow" href="https://bugs.launchpad.net/ceilometer/+bug/1291054">https:/<wbr />/bugs.launchpad<wbr />.net/ceilometer<wbr />/+bug/1291054</a>)</p>
<p>if monkey_patching eventlets is the solution, we&#x27;ll need to do something differently in Ceilometer.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">haven't verified this bug in Ceilometer yet but regarding monkey_patching  eventlets... that solution won't work in Ceilometer as it causes issues (see Julien's comment in https://bugs.launchpad.net/ceilometer/+bug/1291054)

if monkey_patching eventlets is the solution, we'll need to do something differently in Ceilometer.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/44" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-03-17T15:53:53.174838+00:00" title="2014-03-17 15:53:53 UTC">on 2014-03-17</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/44"> #44</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>OK, if the patch proposed in <a href="/bugs/1289074" class="bug-link">bug 1289074</a> fixes this issue, we should push it in ASAP and issue an OSSA about it. We can keep this bug private (since it gives a lot more detail on exploitability) until the ossa is out.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">OK, if the patch proposed in bug 1289074 fixes this issue, we should push it in ASAP and issue an OSSA about it. We can keep this bug private (since it gives a lot more detail on exploitability) until the ossa is out.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/45" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-03-19T13:50:25.003619+00:00" title="2014-03-19 13:50:25 UTC">on 2014-03-19</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/45"> #45</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Cleanroom implementation of patch at <a rel="nofollow" href="https://review.openstack.org/#/c/81078/">https:/<wbr />/review.<wbr />openstack.<wbr />org/#/c/<wbr />81078/</a></p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Cleanroom implementation of patch at https://review.openstack.org/#/c/81078/</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Confirmed &#8594; Triaged
      </td>
    </tr>
  
  
    
      <tr>
        <td colspan="2">Changed in python-keystoneclient: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Confirmed &#8594; In Progress
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
    
    <time title="2014-03-19 13:58:33 UTC" datetime="2014-03-19T13:58:33.910554+00:00">on 2014-03-19</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>no longer affects</b>:
      </td>
      <td>
        ceilometer
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>no longer affects</b>:
      </td>
      <td>
        glance
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>no longer affects</b>:
      </td>
      <td>
        swift
      </td>
    </tr>
  
  
    
      <tr>
        <td colspan="2">Changed in python-keystoneclient: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        In Progress &#8594; Triaged
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Triaged &#8594; In Progress
      </td>
    </tr>
  
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Triaged &#8594; In Progress
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/46" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~dolph" class="sprite person">Dolph Mathews (dolph)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-03-23T15:37:00.495931+00:00" title="2014-03-23 15:37:00 UTC">on 2014-03-23</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/46"> #46</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Reviewed: <a rel="nofollow" href="https://review.openstack.org/81078">https:/<wbr />/review.<wbr />openstack.<wbr />org/81078</a><br />
Committed: <a rel="nofollow" href="https://git.openstack.org/cgit/openstack/python-keystoneclient/commit/?id=d11553a72ee8febc26e4a76ba900984d1b778f59">https:/<wbr />/git.openstack.<wbr />org/cgit/<wbr />openstack/<wbr />python-<wbr />keystoneclient/<wbr />commit/<wbr />?id=d11553a72ee<wbr />8febc26e4a76ba9<wbr />00984d1b778f59</a><br />
Submitter: Jenkins<br />
Branch: master</p>
<p>commit d11553a72ee8feb<wbr />c26e4a76ba90098<wbr />4d1b778f59<br />
Author: Dolph Mathews &lt;email address hidden&gt;<br />
Date: Mon Mar 17 15:56:28 2014 -0500</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;add pooling for cache references</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Change-Id: Iffb1d1bff5dc44<wbr />37544a5aefef3bc<wbr />a0e5b17cc81<br />
&nbsp;&nbsp;&nbsp;&nbsp;Closes-Bug: 1289074</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Reviewed: https://review.openstack.org/81078
Committed: https://git.openstack.org/cgit/openstack/python-keystoneclient/commit/?id=d11553a72ee8febc26e4a76ba900984d1b778f59
Submitter: Jenkins
Branch: master

commit d11553a72ee8febc26e4a76ba900984d1b778f59
Author: Dolph Mathews &lt;dolph.mathews@gmail.com&gt;
Date: Mon Mar 17 15:56:28 2014 -0500

    add pooling for cache references

    Change-Id: Iffb1d1bff5dc4437544a5aefef3bca0e5b17cc81
    Closes-Bug: 1289074</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in python-keystoneclient: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        In Progress &#8594; Fix Committed
      </td>
    </tr>
    <tr>
      <td style="text-align: right;">
        <b>milestone</b>:
      </td>
      <td>
        none &#8594; 0.7.0
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/47" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~tristan-cacqueray" class="sprite person">Tristan Cacqueray (tristan-cacqueray)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-03-24T17:36:42.811796+00:00" title="2014-03-24 17:36:42 UTC">on 2014-03-24</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/47"> #47</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Thank you dolph for such a quick fix!<br />
We are still issuing a pre-OSSA before opening this bug.</p>
<p>Proposed public disclosure date/time:<br />
2014-03-27 15:00 UTC</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Thank you dolph for such a quick fix!
We are still issuing a pre-OSSA before opening this bug.

Proposed public disclosure date/time:
2014-03-27 15:00 UTC</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        In Progress &#8594; Fix Committed
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~dolph" class="sprite person">Dolph Mathews (dolph)</a>
    
    <time title="2014-03-26 11:58:46 UTC" datetime="2014-03-26T11:58:46.017049+00:00">on 2014-03-26</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      <tr>
        <td colspan="2">Changed in python-keystoneclient: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Fix Committed &#8594; Fix Released
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          

          
              <div class="boardComment">
  <div class="boardCommentDetails">
    
      <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
    
    <time title="2014-03-27 15:00:49 UTC" datetime="2014-03-27T15:00:49.057361+00:00">on 2014-03-27</time>
  </div>
  <div class="boardCommentActivity">
    <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>information type</b>:
      </td>
      <td>
        Private Security &#8594; Public Security
      </td>
    </tr>
  
</table>
  </div>
</div>
          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/48" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-03-27T15:13:21.645791+00:00" title="2014-03-27 15:13:21 UTC">on 2014-03-27</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/48"> #48</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>[OSSA 2014-007]</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">[OSSA 2014-007]</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  <div class="boardCommentActivity">
    
      <table class="bug-activity">
  
    
      
    
    <tr>
      <td style="text-align: right;">
        <b>summary</b>:
      </td>
      <td>
        - Keystone middleware may confuse contexts (CVE-2014-0105)<br />+ [OSSA 2014-007] Keystone middleware may confuse contexts (CVE-2014-0105)
      </td>
    </tr>
  
  
    
      <tr>
        <td colspan="2">Changed in ossa: </td>
      </tr>
    
    <tr>
      <td style="text-align: right;">
        <b>status</b>:
      </td>
      <td>
        Fix Committed &#8594; Fix Released
      </td>
    </tr>
  
</table>
    
    
  </div>
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/49" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~prometheanfire" class="sprite person">Matthew Thode (prometheanfire)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-03-27T22:02:19.369710+00:00" title="2014-03-27 22:02:19 UTC">on 2014-03-27</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/49"> #49</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Please release a patchset that matches the requirements that keystone imposes on keystoneclient</p>
<p><a rel="nofollow" href="https://github.com/openstack/keystone/blob/2013.1.5/tools/pip-requires">https:/<wbr />/github.<wbr />com/openstack/<wbr />keystone/<wbr />blob/2013.<wbr />1.5/tools/<wbr />pip-requires</a></p>
<p>python-<wbr />keystoneclient&gt;<wbr />=0.2.1,<wbr />&lt;0.3</p>
<p>At this time I see no patch that fixes this issue for keystoneclient 0.2.5</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Please release a patchset that matches the requirements that keystone imposes on keystoneclient

https://github.com/openstack/keystone/blob/2013.1.5/tools/pip-requires

python-keystoneclient&gt;=0.2.1,&lt;0.3

At this time I see no patch that fixes this issue for keystoneclient 0.2.5</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/50" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~ttx" class="sprite person">Thierry Carrez (ttx)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-03-28T08:21:24.623748+00:00" title="2014-03-28 08:21:24 UTC">on 2014-03-28</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/50"> #50</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>We only provide one release channel for client libraries (no stable branches). Furthermore grizzly is now unsupported.</p>
<p>That said, that dep capping is a bit weird, since it prevents you from actually following that release channel. I&#x27;ll see if (1) that capping is abusive and (2) the patch could be backported to the 0.2.x series</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">We only provide one release channel for client libraries (no stable branches). Furthermore grizzly is now unsupported.

That said, that dep capping is a bit weird, since it prevents you from actually following that release channel. I'll see if (1) that capping is abusive and (2) the patch could be backported to the 0.2.x series</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/51" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~dolph" class="sprite person">Dolph Mathews (dolph)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-03-28T14:56:11.389135+00:00" title="2014-03-28 14:56:11 UTC">on 2014-03-28</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/51"> #51</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>I believe the pin was just a cautionary convention, and not strictly necessary.</p>
<p>python-<wbr />keystoneclient 0.3.0 didn&#x27;t even exist (released Sun Jun 23 16:20:39 2013) when the pin was created (Sat Nov 17 14:45:18 2012) in pip requires:</p>
<p>&nbsp;&nbsp;<a rel="nofollow" href="https://github.com/openstack/keystone/commit/e59360da677c4cd3f6a6391cfebb973c11e2ee47">https:/<wbr />/github.<wbr />com/openstack/<wbr />keystone/<wbr />commit/<wbr />e59360da677c4cd<wbr />3f6a6391cfebb97<wbr />3c11e2ee47</a></p>
<p>Backporting to 0.2.5 looks to be fairly ugly, but I&#x27;m playing around with it now.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">I believe the pin was just a cautionary convention, and not strictly necessary.

python-keystoneclient 0.3.0 didn't even exist (released Sun Jun 23 16:20:39 2013) when the pin was created (Sat Nov 17 14:45:18 2012) in pip requires:

  https://github.com/openstack/keystone/commit/e59360da677c4cd3f6a6391cfebb973c11e2ee47

Backporting to 0.2.5 looks to be fairly ugly, but I'm playing around with it now.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/52" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~dolph" class="sprite person">Dolph Mathews (dolph)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-03-28T15:37:06.143396+00:00" title="2014-03-28 15:37:06 UTC">on 2014-03-28</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/52"> #52</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Even better news, I&#x27;m unable to reproduce against 0.2.5! 0.3.0 appears to be the first release that is vulnerable.</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Even better news, I'm unable to reproduce against 0.2.5! 0.3.0 appears to be the first release that is vulnerable.</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        
          
            <div xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message
                  " data-baseurl="/python-keystoneclient/+bug/1282865/comments/53" data-i-can-edit="False">
  <div class="boardCommentDetails">
    <div class="message-revision-container">
      <div class="message-revision-container-header">
        <span>Revision history for this message</span>
        <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
      </div>
      <script type="text/template">
        <div class='message-revision-item'>
          <div class='message-revision-title'>
              <a class="sprite remove action-icon message-revision-del-btn">
                  Remove
              </a>
              <a class="js-action">
                  Revision #{revision}, created at {date_created_display}
              </a>
          </div>
          <div class='message-revision-body'>{content}</div>
        </div>
      </script>
      <div class="message-revision-list"></div>
    </div>

    <table>
      <tbody>
        <tr>
          <td>
            <a href="https://launchpad.net/~dolph" class="sprite person">Dolph Mathews (dolph)</a>
            wrote
            <time itemprop="commentTime" datetime="2014-03-28T17:37:04.753448+00:00" title="2014-03-28 17:37:04 UTC">on 2014-03-28</time><span class="editable-message-last-edit-date">:
              </span>
              
          </td>
          

          <td>
            
          </td>
          <td>
            
          </td>
          <td class="bug-comment-index">
          <a itemprop="url" href="/python-keystoneclient/+bug/1282865/comments/53"> #53</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="boardCommentBody">
    

    <ul style="margin-bottom: 1em">
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/python-keystoneclient/+bug/1282865/+attachment/4049114/+files/bug-1282865-0.2.5-backport.diff">bug-1282865-0.2.5-backport.diff</a>
        <a class="sprite edit action-icon" href="/python-keystoneclient/+bug/1282865/+attachment/4049114">Edit</a>
        (6.9 KiB,
        text/plain)
      </li>
    </ul>

    

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>CORRECTION: I&#x27;m able to reproduce in 0.2.5</p>
<p>As it turns out, I was backporting my configuration for auth_token which did not have the desired effect of enabling memcached in 0.2.5) due to memcache_servers being renamed to memcached_servers in 0.3.0 (I was setting memcached_servers for testing).</p>
<p>This patch appears to fix 0.2.5 but I haven&#x27;t done any integration testing, so I can&#x27;t recommend it&#x27;s use over 0.7.x</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">CORRECTION: I'm able to reproduce in 0.2.5

As it turns out, I was backporting my configuration for auth_token which did not have the desired effect of enabling memcached in 0.2.5) due to memcache_servers being renamed to memcached_servers in 0.3.0 (I was setting memcached_servers for testing).

This patch appears to fix 0.2.5 but I haven't done any integration testing, so I can't recommend it's use over 0.7.x</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>


  </div>

  
  
</div>

          

          

          

        
        <div style="float: right;">
          <a class="menu-link-activitylog" href="https://bugs.launchpad.net/python-keystoneclient/+bug/1282865/+activity">See full activity log</a>
        </div>
        <div class="clearfix"></div>

        
          

          
            <div align="center" id="add-comment-login-first">
              To post a comment you must <a href="+login?comments=all">log in</a>.
            </div>
          
        
        
      

      </div><!-- class="top-portlet" -->
      </div><!--- id="maincontentsub"-->
      <div>
        <div id="duplicate-form-container"></div>
        <div id="privacy-form-container"></div>
      </div>
    </div>
            
            
          </div><!-- yui-b -->
        </div><!-- yui-main -->

        
          <div id="side-portlets" class="yui-b side">
            
      <div id="involvement" class="portlet">
        <ul class="involvement">
          <li class="single">
            <a class="sprite bugs" href="/python-keystoneclient/+filebug">
              Report a bug
            </a>
          </li>
        </ul>
      </div>
      <div id="privacy" class="first portlet public">
  <div id="privacy-text">
     <span id="information-type-summary" class="sprite public">This report contains
         <strong id="information-type">Public Security</strong>
         information
     </span>&nbsp;<a class="sprite edit action-icon" id="privacy-link" href="/python-keystoneclient/+bug/1282865/+secrecy">Edit</a>

     <div id="information-type-description" style="padding-top: 5px">Everyone can see this security related information.
</div>
  </div>
</div>

      <div id="portlet-actions" class="portlet vertical">
  <ul id="duplicate-actions">
    <li class="sprite bug-dupe">
    <span id="mark-duplicate-text">
    <a class="menu-link-mark-dupe" href="/python-keystoneclient/+bug/1282865/+duplicate">Mark as duplicate</a>
    </span>
    </li>
    
    <li><a class="menu-link-createquestion sprite add" href="https://bugs.launchpad.net/python-keystoneclient/+bug/1282865/+create-question">Convert to a question</a></li>
    
    <li><a class="menu-link-addbranch sprite add" href="https://bugs.launchpad.net/python-keystoneclient/+bug/1282865/+addbranch">Link a related branch</a></li>
    <li><a class="menu-link-linktocve sprite add" href="https://bugs.launchpad.net/python-keystoneclient/+bug/1282865/+linkcve">Link to <abbr title="Common Vulnerabilities and Exposures Index">CVE</abbr></a></li>
    <li><a class="menu-link-unlinkcve sprite modify remove" href="https://bugs.launchpad.net/python-keystoneclient/+bug/1282865/+unlinkcve">Remove CVE link</a></li>
  </ul>
</div>

      

      <div class="portlet vertical" id="portlet-subscription">
  <div class="section">
    <div id="current_user_subscription" class="False">
      
        <span>You are</span>
        
        <a class="menu-link-subscription sprite modify edit" href="/python-keystoneclient/+bug/1282865/+subscribe">
           
           
           
           not directly subscribed to this bug's notifications.
        </a>
      
      
    </div>
    <div id="sub-unsub-spinner">Subscribing...</div>
    <ul>
      
      <li><a class="menu-link-editsubscriptions sprite modify edit" href="https://bugs.launchpad.net/python-keystoneclient/+bug/1282865/+subscriptions" title="View and change your subscriptions to this bug">Edit bug mail</a></li>
    </ul>
  </div>
  <script type="text/javascript">
    LPJS.use('io-base', 'node',
            'lp.bugs.bugtask_index.portlets.subscription', function(Y) {
        Y.on('domready', function() {
            Y.lp.bugs.bugtask_index.portlets.subscription.initialize();
        });
    });
  </script>
</div>

      <div class="portlet vertical" id="portlet-subscribers">
  <h2>Other bug subscribers</h2>
  <div>
    <div><a class="menu-link-addsubscriber sprite add" href="https://bugs.launchpad.net/python-keystoneclient/+bug/1282865/+addsubscriber" title="Launchpad will email that person whenever this bugs changes">Subscribe someone else</a></div>
  </div>
  <div id="other-bug-subscribers"></div>
</div>

      

      

      
  <div class="portlet" id="portlet-patches">
    <h2>Patches</h2>
    <ul>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/python-keystoneclient/+bug/1282865/+attachment/3990345/+files/keystoneclient-repro-bug-1282865.diff">keystoneclient-repro-bug-1282865.diff</a>
        <small>
          (<a href="/python-keystoneclient/+bug/1282865/+attachment/3990345">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/python-keystoneclient/+bug/1282865/+attachment/3990378/+files/keystoneclient-fix-bug-1282865.diff">keystoneclient-fix-bug-1282865.diff</a>
        <small>
          (<a href="/python-keystoneclient/+bug/1282865/+attachment/3990378">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/python-keystoneclient/+bug/1282865/+attachment/4006636/+files/0001-Fix-glance-registry-eventlet-monkey-patchs.patch">Havana fix for glance</a>
        <small>
          (<a href="/python-keystoneclient/+bug/1282865/+attachment/4006636">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/python-keystoneclient/+bug/1282865/+attachment/4006653/+files/0001-Fix-ceilometer-eventlet-monkey-patchs.patch">Icehouse fix for ceilometer</a>
        <small>
          (<a href="/python-keystoneclient/+bug/1282865/+attachment/4006653">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/python-keystoneclient/+bug/1282865/+attachment/4006654/+files/0001-Fix-swift-eventlet-monkey-patchs.patch">Icehouse fix for swift</a>
        <small>
          (<a href="/python-keystoneclient/+bug/1282865/+attachment/4006654">edit</a>)
        </small>
      </li>
      <li class="download-attachment">
        <a class="sprite haspatch-icon" href="https://bugs.launchpad.net/python-keystoneclient/+bug/1282865/+attachment/4049114/+files/bug-1282865-0.2.5-backport.diff">bug-1282865-0.2.5-backport.diff</a>
        <small>
          (<a href="/python-keystoneclient/+bug/1282865/+attachment/4049114">edit</a>)
        </small>
      </li>
    </ul>
    <ul>
      <li>
        <a class="sprite add" href="/python-keystoneclient/+bug/1282865/+addcomment?field.patch=on">Add patch</a>
      </li>
    </ul>
  </div>
  <div class="portlet" id="portlet-attachments">
    <h2>Bug attachments</h2>
    <ul>
      <li class="download-attachment">
        <a class="sprite download-icon" href="https://bugs.launchpad.net/python-keystoneclient/+bug/1282865/+attachment/3990374/+files/repro_bug_1282865.py">repro_bug_1282865.py</a>
        <small>
          (<a href="/python-keystoneclient/+bug/1282865/+attachment/3990374">edit</a>)
        </small>
      </li>
    </ul>
    <ul>
      <li>
        <a class="sprite add" href="/python-keystoneclient/+bug/1282865/+addcomment">Add attachment</a>
      </li>
    </ul>
  </div>


      

    
          </div><!-- yui-b side -->
        
      </div><!-- yui-t4 -->

      
  <div id="footer" class="footer">
    <div class="lp-arcana">
        <div class="lp-branding">
          <a href="https://launchpad.net/"><img src="/@@/launchpad-logo-and-name-hierarchy.png" alt="Launchpad" /></a>
          &nbsp;&bull;&nbsp;
          <a href="https://launchpad.net/+tour">Take the tour</a>
          &nbsp;&bull;&nbsp;
          <a href="https://help.launchpad.net/">Read the guide</a>
          &nbsp;
          <form id="globalsearch" method="get" accept-charset="UTF-8" action="https://launchpad.net/+search">
            <input type="search" id="search-text" name="field.text" />
            <input type="image" src="/@@/search" style="vertical-align:5%" alt="Search Launchpad" />
          </form>
        </div>
        
  

    </div>

    <div class="colophon">
      &copy; 2004-2021
      <a href="http://canonical.com/">Canonical&nbsp;Ltd.</a>
      &nbsp;&bull;&nbsp;
      <a href="https://launchpad.net/legal">Terms of use</a>
      &nbsp;&bull;&nbsp;
      <a href="https://www.ubuntu.com/legal/dataprivacy">Data privacy</a>
      &nbsp;&bull;&nbsp;
      <a href="/feedback">Contact Launchpad Support</a>
      
      &nbsp;&bull;&nbsp;
      <a href="http://blog.launchpad.net/">Blog</a>
      
	&nbsp;&bull;&nbsp;
	<a href="https://canonical.com/careers">Careers</a>
      
      &nbsp;&bull;&nbsp;
      <a href="https://twitter.com/launchpadstatus">System status</a>
      <span id="lp-version">
      &nbsp;&bull;&nbsp;
        r0d8de2b
        
        
        (<a href="https://dev.launchpad.net/">Get the code!</a>)
      </span>
    </div>
  </div>

    </div><!-- yui-d0-->

    
  
  
  <script id="json-cache-script">LP.cache = {"bug_is_private": false, "bug": {"self_link": "https://bugs.launchpad.net/api/devel/bugs/1282865", "web_link": "https://bugs.launchpad.net/bugs/1282865", "resource_type_link": "https://bugs.launchpad.net/api/devel/#bug", "id": 1282865, "private": false, "information_type": "Public Security", "name": null, "title": "[OSSA 2014-007] Keystone middleware may confuse contexts (CVE-2014-0105)", "description": "tl;dr: Occasionally a request from a regular user appears to Glance-registry as an admin user:\n\n\nWe have a server with 12 glance-registry processes running, with auth_token middleware handling authentication.\n\n\nIf I run a python script that sets up Glanceclient:\n\nglance = glanceclient.Client('1', token=xxx)\n\nand makes the following call over and over:\n\nglance.images.get(\u003cprivate_image_id_from_another_tenant\u003e)\n\nMost calls 404 because the calling tenant doesn't have access to the image. Eventually though, an image get request will succeed. \n\n\nWhen this happens, glance-registry logs something like:\n\nINFO glance.registry.api.v1.images [9b88678e-f606-4016-a39a-bb1ac150c029 2d474f5d54e24a56978c0332df1c36d6 e183df4e2bd045f7a9cbdb37a99929a5] Successfully retrieved image 32101b45-461e-452c-b065-4e07391c806e\n\nUser 2d474f5d54e24a56978c0332df1c36d6 and tenant e183df4e2bd045f7a9cbdb37a99929a5 are completely unrelated to the user's credentials in the python script I'm running. They're actually the user/tenant of our ceilometer admin user. Ceilometer is doing a few image GET requests per second.\n\nThe reverse of this also happens. Occasionally a request from ceilometer will assume the identity of the user in my script. Glance-registry logs the request as if it had come from my user, and denies the image GET because my user does not have the appropriate permission for the image ceilometer was trying to query.\n\n\nIf I comment out the \"memcached_servers\" line from our log file, the problem goes away. This makes me suspect that something is going on in auth_token middleware. When I watch the memcache entry for the token used by my script, the token data never appears to change.\n\n\nWhat on earth is going on here? :)", "owner_link": "https://bugs.launchpad.net/api/devel/~kspear", "bug_tasks_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1282865/bug_tasks", "duplicate_of_link": null, "date_created": "2014-02-21T03:30:25.614470+00:00", "activity_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1282865/activity", "subscriptions_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1282865/subscriptions", "date_last_updated": "2014-03-28T17:37:05.954496+00:00", "who_made_private_link": null, "date_made_private": null, "heat": 274, "bug_watches_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1282865/bug_watches", "cves_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1282865/cves", "duplicates_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1282865/duplicates", "attachments_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1282865/attachments", "security_related": true, "latest_patch_uploaded": "2014-03-28T17:37:04.753448+00:00", "tags": [], "date_last_message": "2014-03-28T17:37:04.753448+00:00", "number_of_duplicates": 0, "message_count": 54, "users_affected_count": 1, "users_unaffected_count": 0, "users_affected_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1282865/users_affected", "users_unaffected_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1282865/users_unaffected", "users_affected_count_with_dupes": 1, "other_users_affected_count_with_dupes": 1, "users_affected_with_dupes_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1282865/users_affected_with_dupes", "messages_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1282865/messages", "linked_branches_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1282865/linked_branches", "linked_merge_proposals_collection_link": "https://bugs.launchpad.net/api/devel/bugs/1282865/linked_merge_proposals", "http_etag": "\"0ae32a07d87530c4c89a4467774c9e74d40fa0f9-dd936983d848f7466c39d5b32b0b9e85e3b5d5e4\""}, "total_comments_and_activity": 101, "related_features": {}, "information_type_data": {"PUBLIC": {"is_private": false, "name": "Public", "order": 0, "description": "Everyone can see this information.\n", "value": "PUBLIC", "description_css_class": "choice-description"}, "PRIVATESECURITY": {"is_private": true, "name": "Private Security", "order": 2, "description": "Only the security group can see this information.\n ", "value": "PRIVATESECURITY", "description_css_class": "choice-description"}, "PUBLICSECURITY": {"is_private": false, "name": "Public Security", "order": 1, "description": "Everyone can see this security related information.\n", "value": "PUBLICSECURITY", "description_css_class": "choice-description"}, "USERDATA": {"is_private": true, "name": "Private", "order": 3, "description": "Only shared with users permitted to see private user information.\n", "value": "USERDATA", "description_css_class": "choice-description"}}, "context": {"self_link": "https://bugs.launchpad.net/api/devel/python-keystoneclient/+bug/1282865", "web_link": "https://bugs.launchpad.net/python-keystoneclient/+bug/1282865", "resource_type_link": "https://bugs.launchpad.net/api/devel/#bug_task", "bug_link": "https://bugs.launchpad.net/api/devel/bugs/1282865", "milestone_link": "https://bugs.launchpad.net/api/devel/python-keystoneclient/+milestone/0.7.0", "status": "Fix Released", "importance": "Critical", "assignee_link": "https://bugs.launchpad.net/api/devel/~dolph", "bug_target_display_name": "python-keystoneclient", "bug_target_name": "python-keystoneclient", "bug_watch_link": null, "date_assigned": "2014-02-22T00:12:19.911306+00:00", "date_created": "2014-02-21T03:30:25.614470+00:00", "date_confirmed": "2014-02-21T23:34:26.794450+00:00", "date_incomplete": null, "date_in_progress": "2014-03-19T13:58:59.800615+00:00", "date_closed": "2014-03-26T11:58:46.580169+00:00", "date_left_new": "2014-02-21T23:34:26.794450+00:00", "date_triaged": "2014-03-19T13:50:38.737075+00:00", "date_fix_committed": "2014-03-23T15:36:00.230060+00:00", "date_fix_released": "2014-03-26T11:58:46.580169+00:00", "date_left_closed": null, "owner_link": "https://bugs.launchpad.net/api/devel/~kspear", "target_link": "https://bugs.launchpad.net/api/devel/python-keystoneclient", "title": "Bug #1282865 in python-keystoneclient: \"[OSSA 2014-007] Keystone middleware may confuse contexts (CVE-2014-0105)\"", "related_tasks_collection_link": "https://bugs.launchpad.net/api/devel/python-keystoneclient/+bug/1282865/related_tasks", "is_complete": true, "http_etag": "\"817a98783acfd607b383caab11fdc19810f533e6-d71a6164db10fa754175ea70b62397811975a4ca\""}, "bugtask_data": {"1554376": {"delete_link": "https://bugs.launchpad.net/python-keystoneclient/+bug/1282865/+delete", "bug_title": "[OSSA 2014-007] Keystone middleware may confuse contexts (CVE-2014-0105)", "user_can_unassign": false, "importance_value": "Critical", "user_can_edit_importance": false, "assignee_vocabulary": "AllUserTeamsParticipation", "hide_assignee_team_selection": true, "user_can_edit_status": true, "user_can_delete": false, "row_id": "tasksummary1554376", "target_is_product": true, "user_can_edit_milestone": false, "prefix": "python-keystoneclient", "bugtask_path": "/python-keystoneclient/+bug/1282865", "id": 1554376, "milestone_value": "https://bugs.launchpad.net/api/devel/python-keystoneclient/+milestone/0.7.0", "status_widget_items": "[]", "milestone_widget_items": "[]", "form_row_id": "task1554376", "targetname": "python-keystoneclient", "assignee_is_team": false, "assignee_vocabulary_filters": [], "user_can_edit_assignee": false, "importance_widget_items": "[]", "assignee_value": "dolph", "status_value": "Fix Released"}, "1554474": {"delete_link": "https://bugs.launchpad.net/ossa/+bug/1282865/+delete", "bug_title": "[OSSA 2014-007] Keystone middleware may confuse contexts (CVE-2014-0105)", "user_can_unassign": false, "importance_value": "Critical", "user_can_edit_importance": false, "assignee_vocabulary": "AllUserTeamsParticipation", "hide_assignee_team_selection": true, "user_can_edit_status": true, "user_can_delete": false, "row_id": "tasksummary1554474", "target_is_product": true, "user_can_edit_milestone": false, "prefix": "ossa", "bugtask_path": "/ossa/+bug/1282865", "id": 1554474, "milestone_value": null, "status_widget_items": "[]", "milestone_widget_items": "[]", "form_row_id": "task1554474", "targetname": "OpenStack Security Advisory", "assignee_is_team": false, "assignee_vocabulary_filters": [], "user_can_edit_assignee": false, "importance_widget_items": "[]", "assignee_value": "tristan-cacqueray", "status_value": "Fix Released"}}, "subscribers_portlet_url_data": {"self_link": "https://bugs.launchpad.net/api/devel/bugs/1282865", "web_link": "https://bugs.launchpad.net/bugs/1282865"}, "initial_comment_batch_offset": 41, "first visible_recent_comment": 13};</script>

    
  

    
  </body>


  <!--
    Facet name: bugs
    Page type: main_side
    Has global search: True
    Has application tabs: True
    Has side portlets: True

    At least 59 queries/external actions issued in 1.00 seconds

    Features: {'app.maintenance_message': None, 'hard_timeout': '9000', 'js.yui_version': None, 'app.mainsite_only.canonical_url': None, 'disclosure.dsp_picker.enabled': 'on', 'baselayout.careers_link.disabled': None, 'bugs.affected_count_includes_dupes.disabled': None, 'visible_render_time': None, 'profiling.enabled': None, 'bugs.nominations.bug_supervisors_can_target': 'on'}

    r0d8de2b

    -->

</html>

