<!doctype html><html lang=en itemscope itemtype=http://schema.org/WebPage>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<title>Security Issues in Perl IP Address distros - House Absolute(ly Pointless)</title>
<meta name=renderer content="webkit">
<meta name=viewport content="width=device-width,initial-scale=1,user-scalable=yes">
<meta name=MobileOptimized content="width">
<meta name=HandheldFriendly content="true">
<meta name=applicable-device content="pc,mobile">
<meta name=theme-color content="#f8f5ec">
<meta name=msapplication-navbutton-color content="#f8f5ec">
<meta name=apple-mobile-web-app-capable content="yes">
<meta name=apple-mobile-web-app-status-bar-style content="#f8f5ec">
<meta name=mobile-web-app-capable content="yes">
<meta name=author content="Dave Rolsky">
<meta name=description content="Edit on 2021-03-29 21:40(ish) UTC: Added Net-Subnet (appears unaffected) and reordered the details to match the list at the top of the post.
Edit on 2021-03-30 14:50(ish) UTC: Added Net-Works (appears unaffected).
Edit on 2021-03-30 15:40(ish) UTC: Added Net-CIDR (some functions are affected).
Edit on 2021-03-31 01:05(ish) UTC: Added Net-IPv4Addr (affected).
Edit on 2021-04-05 01:21(ish) UTC: Net-CIDR-Lite 0.22 contains a remediation.
Edit on 2021-04-05 19:30(ish) UTC: Net-IPAddress-Util 5.000 contains a remediation.">
<meta name=generator content="Hugo 0.88.1">
<link rel=canonical href=https://blog.urth.org/2021/03/29/security-issues-in-perl-ip-address-distros/>
<link rel=icon href=/favicon.ico>
<link rel=stylesheet href=/sass/jane.min.c9ec61542a8979b0bb2f0d382663e3c872def9991d110d68b4ec8f300976d657.css integrity="sha256-yexhVCqJebC7Lw04JmPjyHLe+ZkdEQ1otOyPMAl21lc=" media=screen crossorigin=anonymous>
<meta property="og:title" content="Security Issues in Perl IP Address distros">
<meta property="og:description" content="Edit on 2021-03-29 21:40(ish) UTC: Added Net-Subnet (appears unaffected) and reordered the details to match the list at the top of the post.
Edit on 2021-03-30 14:50(ish) UTC: Added Net-Works (appears unaffected).
Edit on 2021-03-30 15:40(ish) UTC: Added Net-CIDR (some functions are affected).
Edit on 2021-03-31 01:05(ish) UTC: Added Net-IPv4Addr (affected).
Edit on 2021-04-05 01:21(ish) UTC: Net-CIDR-Lite 0.22 contains a remediation.
Edit on 2021-04-05 19:30(ish) UTC: Net-IPAddress-Util 5.000 contains a remediation.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://blog.urth.org/2021/03/29/security-issues-in-perl-ip-address-distros/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2021-03-29T13:33:39-05:00">
<meta property="article:modified_time" content="2021-09-21T14:04:31-05:00">
<meta itemprop=name content="Security Issues in Perl IP Address distros">
<meta itemprop=description content="Edit on 2021-03-29 21:40(ish) UTC: Added Net-Subnet (appears unaffected) and reordered the details to match the list at the top of the post.
Edit on 2021-03-30 14:50(ish) UTC: Added Net-Works (appears unaffected).
Edit on 2021-03-30 15:40(ish) UTC: Added Net-CIDR (some functions are affected).
Edit on 2021-03-31 01:05(ish) UTC: Added Net-IPv4Addr (affected).
Edit on 2021-04-05 01:21(ish) UTC: Net-CIDR-Lite 0.22 contains a remediation.
Edit on 2021-04-05 19:30(ish) UTC: Net-IPAddress-Util 5.000 contains a remediation."><meta itemprop=datePublished content="2021-03-29T13:33:39-05:00">
<meta itemprop=dateModified content="2021-09-21T14:04:31-05:00">
<meta itemprop=wordCount content="1422">
<meta itemprop=keywords content><meta name=twitter:card content="summary">
<meta name=twitter:title content="Security Issues in Perl IP Address distros">
<meta name=twitter:description content="Edit on 2021-03-29 21:40(ish) UTC: Added Net-Subnet (appears unaffected) and reordered the details to match the list at the top of the post.
Edit on 2021-03-30 14:50(ish) UTC: Added Net-Works (appears unaffected).
Edit on 2021-03-30 15:40(ish) UTC: Added Net-CIDR (some functions are affected).
Edit on 2021-03-31 01:05(ish) UTC: Added Net-IPv4Addr (affected).
Edit on 2021-04-05 01:21(ish) UTC: Net-CIDR-Lite 0.22 contains a remediation.
Edit on 2021-04-05 19:30(ish) UTC: Net-IPAddress-Util 5.000 contains a remediation."><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script>
<script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]-->
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-1805706-3','auto'),ga('set','anonymizeIp',!0),ga('send','pageview'))</script>
<script async src=https://www.google-analytics.com/analytics.js></script>
</head>
<body>
<div id=mobile-navbar class=mobile-navbar>
<div class=mobile-header-logo>
<a href=/ class=logo>House Absolute(ly Pointless)</a>
</div>
<div class=mobile-navbar-icon>
<span></span>
<span></span>
<span></span>
</div>
</div>
<nav id=mobile-menu class="mobile-menu slideout-menu">
<ul class=mobile-menu-list>
<li class=mobile-menu-item>
<a class=menu-item-link href=https://blog.urth.org/>Home</a>
</li><li class=mobile-menu-item>
<a class=menu-item-link href=https://blog.urth.org/posts/>Archives</a>
</li><li class=mobile-menu-item>
<a class=menu-item-link href=https://blog.urth.org/about>About</a>
</li>
<li class=mobile-menu-item>
<a id=openSearchMobile class="mobile-menu-item-link menu-item-search" href=#>
<i class=iconfont><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="18" height="18" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M973.81454219 973.81454219a91.78207815 91.78207815.0 01-129.80999631.0L682.0297247 811.83972101a425.48527711 425.48527711.0 01-230.35931791 68.16531768 428.3346319 428.3346319.0 11428.3346319-428.3346319A425.48527711 425.48527711.0 01811.83972101 682.0297247l162.02961656 161.97482118a91.83687354 91.83687354.0 01-.05479538 129.80999631zm-522.1441354-828.1209266a305.97679241 305.97679241.0 100 611.95358361 305.97679241 305.97679241.0 000-611.95358361z"/></svg>
</i>
</a>
</li>
</ul>
</nav>
<div class=modal-dialog>
<div class=modal-content>
<div id=closeSearch title=Close class=close>X</div>
<div class=modal-header>
<div class=modal-title>Search</div>
</div>
<div class=modal-body>
<script>(function(){var c='dfe133801d52b4a71',a=document.createElement('script'),b;a.type='text/javascript',a.async=!0,a.src=(document.location.protocol=='https:'?'https:':'http:')+'//cse.google.com/cse.js?cx='+c,b=document.getElementsByTagName('script')[0],b.parentNode.insertBefore(a,b)})()</script>
<gcse:search></gcse:search>
</div>
</div>
</div>
<header id=header class="header container">
<div class=logo-wrapper>
<a href=/ class=logo>
House Absolute(ly Pointless)
</a>
</div>
<nav class=site-navbar>
<ul id=menu class=menu>
<li class=menu-item>
<a class=menu-item-link href=/>Home</a>
</li>
<li class=menu-item>
<a class=menu-item-link href=/posts/>Archives</a>
</li>
<li class=menu-item>
<a class=menu-item-link href=/about>About</a>
</li>
<li class=menu-item>
<a id=openSearch class="menu-item-link menu-item-search" href=#>
<i class=iconfont><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="18" height="18" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M973.81454219 973.81454219a91.78207815 91.78207815.0 01-129.80999631.0L682.0297247 811.83972101a425.48527711 425.48527711.0 01-230.35931791 68.16531768 428.3346319 428.3346319.0 11428.3346319-428.3346319A425.48527711 425.48527711.0 01811.83972101 682.0297247l162.02961656 161.97482118a91.83687354 91.83687354.0 01-.05479538 129.80999631zm-522.1441354-828.1209266a305.97679241 305.97679241.0 100 611.95358361 305.97679241 305.97679241.0 000-611.95358361z"/></svg>
</i>
</a>
</li>
</ul>
</nav>
</header>
<div id=mobile-panel>
<main id=main class="main bg-llight">
<div class=content-wrapper>
<div id=content class="content container">
<article class="post bg-white">
<header class=post-header>
<h1 class=post-title>Security Issues in Perl IP Address distros</h1>
<div class=post-meta>
<time datetime=2021-03-29 class=post-time>
2021-03-29
</time>
</div>
</header>
<div class=post-content>
<p><em>Edit on 2021-03-29 21:40(ish) UTC:</em> Added Net-Subnet (appears unaffected) and
reordered the details to match the list at the top of the post.</p>
<p><em>Edit on 2021-03-30 14:50(ish) UTC:</em> Added Net-Works (appears unaffected).</p>
<p><em>Edit on 2021-03-30 15:40(ish) UTC:</em> Added Net-CIDR (some functions are
affected).</p>
<p><em>Edit on 2021-03-31 01:05(ish) UTC:</em> Added Net-IPv4Addr (affected).</p>
<p><em>Edit on 2021-04-05 01:21(ish) UTC:</em> Net-CIDR-Lite 0.22 contains a
remediation.</p>
<p><em>Edit on 2021-04-05 19:30(ish) UTC:</em> Net-IPAddress-Util 5.000 contains a
remediation.</p>
<div class="shortcode-notice warning">
<div class="shortcode-notice-title warning">
warning</div>
<div class=notice-content><p><strong>TLDR: Some Perl modules for working with IP addresses and netmasks have bugs
with potential security applications.</strong> See below for more details on the bug
and which modules are affected.</p>
<ul>
<li>Net-IPv4Addr: Affected.</li>
<li>Net-CIDR-Lite: Vulnerable before the 0.22 release. Upgrade now.</li>
<li>Net-Netmask: Vulnerable before the 2.00000 release. Upgrade now.</li>
<li>Net-IPAddress-Util: Vulnerable before the 5.000 release. Upgrade now.</li>
<li>Data-Validate-IP: Depends on exactly how it&rsquo;s used. See below for details.</li>
<li>Net-CIDR: Depends on exactly how it&rsquo;s used. See below for details.</li>
<li>Socket: Appears unaffected.</li>
<li>Net-DNS: Appears unaffected.</li>
<li>NetAddr-IP: Appears unaffected.</li>
<li>Net-Works: Appears unaffected.</li>
<li>Net-Subnet: Appears unaffected.</li>
<li>Net-Patricia: Appears unaffected.</li>
</ul>
</div>
</div>
<p>Yesterday, <a href=https://sick.codes/universal-netmask-npm-package-used-by-270000-projects-vulnerable-to-octal-input-data-server-side-request-forgery-remote-file-inclusion-local-file-inclusion-and-more-cve-2021-28918/>a security issue with the NPM package <code>netmask</code> was
published</a><sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>.</p>
<p>The issue itself is pretty straightforward. Your OS will allow an IP address
like <code>010.0.0.1</code> or a netmask like <code>010.0.0.0/8</code>. That <code>010</code> is treated <strong>as
an octal number, not a base-10 number with a leading zero!</strong> That means that
<code>010.0.0.1</code> is actually <code>8.0.0.1</code>. We can confirm this with <code>ping</code>:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>ping 010.0.0.1
PING 010.0.0.1 (8.0.0.1) 56(84) bytes of data.
</code></pre></td></tr></table>
</div>
</div><p>But the NPM <code>netmask</code> package would treat this as <code>10.0.0.1</code>. This confusion
means that an application could be tricked into thinking a public IP -
<code>8.0.0.1</code> - was part of a private subnet - <code>10.0.0.0/8</code>. And conversely, you
could trick it into thinking a private IP - <code>10.0.0.1</code> written as
<code>012.0.0.1</code> - was part of a public subnet - <code>12.0.0.1</code>.</p>
<p>This has security implications for any application that is trying to
distinguish between public and private IP addresses or networks for access
control, firewalling, etc.</p>
<p>As I was reading about this I checked out <a href=https://github.com/rs/node-netmask>the Git repo for the <code>netmask</code>
package</a>. Its README says &ldquo;This module is
highly inspired by Perl
<a href=http://search.cpan.org/dist/Net-Netmask/>Net::Netmask</a> module.&rdquo;</p>
<p>And at that point I realized that it was quite possible that this affected
Perl code as well! So I started digging into this by looking at various CPAN
modules for working with IP addresses, networks, and netmasks.</p>
<p>Here&rsquo;s the current state of CPAN modules, ordered roughly by their position in
<a href=https://neilb.org/2015/04/20/river-of-cpan.html>The River of CPAN</a> (which
basically means how many modules depend on them).</p>
<h2 id=net-ipv4addrhttpsmetacpanorgreleasenet-ipv4addr><a href=https://metacpan.org/release/Net-IPv4Addr><code>Net-IPv4Addr</code></a></h2>
<div class="shortcode-notice warning">
<div class="shortcode-notice-title warning">
warning</div>
<div class=notice-content><strong>This distribution is affected by this issue. In addition, this module is
almost certainly no longer being maintained. Emails to the author bounce.</strong></div>
</div>
<p>This distribution has 4 direct dependents and 12 total dependents.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>perl -MNet::IPv4Addr=:all -E &#39;say $_ for ipv4_network(&#34;010.0.0.1&#34;)&#39;
10.0.0.0
8
</code></pre></td></tr></table>
</div>
</div><h2 id=net-cidr-litehttpsmetacpanorgreleasenet-cidr-lite><a href=https://metacpan.org/release/Net-CIDR-Lite><code>Net-CIDR-Lite</code></a></h2>
<div class="shortcode-notice info">
<div class="shortcode-notice-title info">
info</div>
<div class=notice-content><strong>This distribution was vulnerable prior to its 0.22 release made on
2021-04-04. Thanks to Stig Palmquist for taking this distro over and releasing
a fix!</strong></div>
</div>
<p>This distribution has 24 direct dependents and 36 total dependents.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>perl -MNet::CIDR::Lite -E &#39;my $c = Net::CIDR::Lite-&gt;new; $c-&gt;add(&#34;010.0.0.0/8&#34;); say $_ for $c-&gt;list_range&#39;
Can&#39;t determine ip format at /home/autarch/.perlbrew/libs/perl-5.30.1@dev/lib/perl5/Net/CIDR/Lite.pm line 38.
	Net::CIDR::Lite::add(Net::CIDR::Lite=HASH(0x55fe55ade740), &#34;010.0.0.0/8&#34;) called at -e line 1
</code></pre></td></tr></table>
</div>
</div><h2 id=net-netmaskhttpsmetacpanorgreleasenet-netmask><a href=https://metacpan.org/release/Net-Netmask><code>Net-Netmask</code></a></h2>
<div class="shortcode-notice info">
<div class="shortcode-notice-title info">
info</div>
<div class=notice-content><strong>This distribution was vulnerable prior to its 2.0000 release earlier
today. Great job on the quick response, Joelle Maslak!</strong></div>
</div>
<p>This distribution has 22 direct dependents and 30 total dependents.</p>
<p>So for versions before 2.0000 we see this:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>perl -MNet::Netmask -E &#39;say defined Net::Netmask-&gt;new2(q{010.0.0.0/8}) ? 1 : 0&#39;
0
</code></pre></td></tr></table>
</div>
</div><p>Note the use of the <code>new2</code> constructor. The old <code>new</code> constructor cannot be
changed to return <code>undef</code> for backwards compatibility reasons. Fortunately,
it&rsquo;s probably not vulnerable in any exploitable way, as it returns a 0-length
subnet:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>perl -MNet::Netmask -E &#39;say Net::Netmask-&gt;new(q{010.0.0.0/8})&#39;
0.0.0.0/0
</code></pre></td></tr></table>
</div>
</div><h2 id=net-ipaddress-utilhttpsmetacpanorgreleasenet-ipaddress-util><a href=https://metacpan.org/release/Net-IPAddress-Util><code>Net-IPAddress-Util</code></a></h2>
<div class="shortcode-notice info">
<div class="shortcode-notice-title info">
info</div>
<div class=notice-content><strong>This distribution was vulnerable prior to its 5.000 release made on
2021-04-04. Thanks to Paul W Bennett for the fix!</strong></div>
</div>
<p>This distribution has no dependents.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>perl -MNet::IPAddress::Util=IP -E &#39;say IP(q{010.0.0.1})&#39;
8.0.0.1
</code></pre></td></tr></table>
</div>
</div><h2 id=data-validate-iphttpsmetacpanorgreleasedata-validate-ip><a href=https://metacpan.org/release/Data-Validate-IP><code>Data-Validate-IP</code></a></h2>
<div class="shortcode-notice info">
<div class="shortcode-notice-title info">
info</div>
<div class=notice-content><strong>This distribution doesn&rsquo;t misparse octal numbers, but you could be affected
depending on exactly how your code uses this distro. See below for details.</strong></div>
</div>
<p>This distribution has 21 direct dependents and 60 total dependents.</p>
<p>This distribution returns false for any <code>is_*_ipv4</code> method that includes an octal
number. So both <code>is_private_ipv4('010.0.0.1')</code> and
<code>is_public_ipv4('010.0.0.1')</code> return false. <strong>Depending on how you&rsquo;re using this
module, it&rsquo;s <em>possible</em> that this could lead to bugs, including bugs with
security implications.</strong></p>
<p>I <a href=https://metacpan.org/pod/Data::Validate::IP#USAGE-AND-SECURITY-RECOMMENDATIONS>updated the
documentation</a>
to explicitly recommend that you <strong>always call <code>is_ipv4()</code> in addition to
calling a method like <code>is_private_ipv4()</code></strong>. The <code>is_ipv4()</code> method will
always return false for IP addresses with octal numbers.</p>
<p>While this isn&rsquo;t strictly POSIX-correct, this seems like the safest behavior
for a module like this. It&rsquo;s better to be too strict if this eliminates a
potential footgun.</p>
<p><strong>If you are using this distribution, I highly encourage you to audit your use
of it in a security context!</strong></p>
<h2 id=net-cidrhttpsmetacpanorgreleasenet-cidr><a href=https://metacpan.org/release/Net-CIDR><code>Net-CIDR</code></a></h2>
<div class="shortcode-notice info">
<div class="shortcode-notice-title info">
info</div>
<div class=notice-content><strong>This distribution is affected, but it has a function to validate CIDR
strings that you should use before calling any other functions.</strong></div>
</div>
<p>This distribution has 17 direct dependents and 25 total dependents.</p>
<p>The distribution provides a number of functions for working with networks and
IP addresses. Most of these are not affected. However, two are:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>perl -MNet::CIDR -E &#39;say for Net::CIDR::addr2cidr(&#34;010.0.0.1&#34;)&#39;
010.0.0.1/32
010.0.0.0/31
...
010.0.0.0/8
10.0.0.0/7
8.0.0.0/6
...

perl -MNet::CIDR -E &#39;say Net::CIDR::cidrlookup(&#34;10.0.0.1&#34;, &#34;010.0.0.0/8&#34;)&#39;
1
</code></pre></td></tr></table>
</div>
</div><p>However, this distribution also contains a <code>cidrvalidate</code> function that will
return false for any CIDR string with a leading 0 in an octet. The
documentation explicitly tells you to use this before passing the data to
other functions.</p>
<p><strong>If you are using this distribution, I highly encourage you to audit your use
of it in a security context!</strong></p>
<h2 id=sockethttpsmetacpanorgreleasesocket><a href=https://metacpan.org/release/Socket><code>Socket</code></a></h2>
<div class="shortcode-notice note">
<div class="shortcode-notice-title note">
note</div>
<div class=notice-content><strong>This distribution appears to be unaffected by this issue.</strong></div>
</div>
<p>This distribution has 275 direct dependents and 9,936 total dependents.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>perl -MSocket -E &#39;say inet_ntoa(inet_aton(q{010.0.0.1}))&#39;
8.0.0.1

perl -MSocket=inet_pton,inet_ntop,AF_INET -E &#39;say inet_ntop(AF_INET, inet_pton(AF_INET, q{010.0.0.1}))&#39;
Bad address length for Socket::inet_ntop on AF_INET; got 0, should be 4 at -e line 1.
</code></pre></td></tr></table>
</div>
</div><p>The <code>inet_pton()</code> function is just returning <code>undef</code> for this octal-formatted
address.</p>
<h2 id=net-dnshttpsmetacpanorgreleasenet-dns><a href=https://metacpan.org/release/Net-DNS><code>Net-DNS</code></a></h2>
<div class="shortcode-notice note">
<div class="shortcode-notice-title note">
note</div>
<div class=notice-content><strong>This distribution appears to be unaffected by this issue.</strong></div>
</div>
<p>This distribution has 104 direct dependents and 561 total dependents.</p>
<p>If you try to resolve an IP address, it turns this into a reverse lookup, but
it treats the IP as text:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>perl ./demo/perldig 010.0.0.1
;; Response received from 127.0.0.53 (40 octets)
;; HEADER SECTION
;;	id = 6342
;;	qr = 1	aa = 0	tc = 0	rd = 1	opcode = QUERY
;;	ra = 1	z  = 0	ad = 0	cd = 0	rcode  = NXDOMAIN
;;	qdcount = 1	ancount = 0	nscount = 0	arcount = 0
;;	do = 0

;; QUESTION SECTION (1 record)
;; 1.0.0.010.in-addr.arpa.	IN	A
</code></pre></td></tr></table>
</div>
</div><p>So it&rsquo;s not a useful answer, but it&rsquo;s not looking up the <em>wrong</em> address.</p>
<h2 id=netaddr-iphttpsmetacpanorgreleasenetaddr-ip><a href=https://metacpan.org/release/NetAddr-IP><code>NetAddr-IP</code></a></h2>
<div class="shortcode-notice note">
<div class="shortcode-notice-title note">
note</div>
<div class=notice-content><strong>This distribution appears to be unaffected by this issue.</strong></div>
</div>
<p>This distribution has 36 direct dependents and 110 total dependents.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>perl -MNetAddr::IP -E &#39;say NetAddr::IP-&gt;new(q{010.0.0.024})&#39;
8.0.0.20/32
</code></pre></td></tr></table>
</div>
</div><h2 id=net-workshttpsmetacpanorgreleasenet-works><a href=https://metacpan.org/release/Net-Works><code>Net-Works</code></a></h2>
<div class="shortcode-notice note">
<div class="shortcode-notice-title note">
note</div>
<div class=notice-content><strong>This distribution appears to be unaffected by this issue.</strong></div>
</div>
<p>This distribution has 3 direct dependents and 7 total dependents.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>perl -MNet::Works::Network -E &#39;say Net::Works::Network-&gt;new_from_string(string =&gt; q{010.0.0.1/8})&#39;
010.0.0.1/8 is not a valid IP network at /home/autarch/.perlbrew/libs/perl-5.30.1@dev/lib/perl5/Net/Works/Network.pm line 120.
	Net::Works::Network::new_from_string(&#34;Net::Works::Network&#34;, &#34;string&#34;, &#34;010.0.0.1/8&#34;) called at -e line 1

perl -MNet::Works::Address -E &#39;say Net::Works::Address-&gt;new_from_string(string =&gt; q{010.0.0.1})&#39;
010.0.0.1 is not a valid IPv6 address at /home/autarch/.perlbrew/libs/perl-5.30.1@dev/lib/perl5/Net/Works/Util.pm line 70.
	Net::Works::Util::_validate_ip_string(&#34;010.0.0.1&#34;, 6) called at /home/autarch/.perlbrew/libs/perl-5.30.1@dev/lib/perl5/Net/Works/Address.pm line 74
	Net::Works::Address::new_from_string(&#34;Net::Works::Address&#34;, &#34;string&#34;, &#34;010.0.0.1&#34;) called at -e line 1
</code></pre></td></tr></table>
</div>
</div><p>Thanks to Stig Palmquist for checking this one and letting me know.</p>
<h2 id=net-subnethttpsmetacpanorgreleasenet-subnet><a href=https://metacpan.org/release/Net-Subnet><code>Net-Subnet</code></a></h2>
<div class="shortcode-notice note">
<div class="shortcode-notice-title note">
note</div>
<div class=notice-content><strong>This distribution appears to be unaffected by this issue.</strong></div>
</div>
<p>This distribution has 3 direct dependents and 7 total dependents.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>perl -MNet::Subnet -E &#39;my $m = subnet_matcher(q{10.0.0.0/8}); say $m-&gt;(q{012.0.0.1}) ? 1 : 0&#39;
1

perl -MNet::Subnet -E &#39;my $m = subnet_matcher(q{012.0.0.0/8}); say $m-&gt;(q{10.0.0.1}) ? 1 : 0&#39;
1
</code></pre></td></tr></table>
</div>
</div><h2 id=net-patriciahttpsmetacpanorgreleasenet-patricia><a href=https://metacpan.org/release/Net-Patricia><code>Net-Patricia</code></a></h2>
<div class="shortcode-notice note">
<div class="shortcode-notice-title note">
note</div>
<div class=notice-content><strong>This distribution appears to be unaffected by this issue.</strong></div>
</div>
<p>This distribution has 1 direct dependent and 1 total dependent.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>perl -MNet::Patricia -E &#39;my $p = Net::Patricia-&gt;new; $p-&gt;add_string(&#34;010.0.0.0/8&#34;); say $p-&gt;match_string(&#34;8.0.0.1&#34;) ? 1 : 0&#39;
1

perl -MNet::Patricia -E &#39;my $p = Net::Patricia-&gt;new; $p-&gt;add_string(&#34;8.0.0.0/8&#34;); say $p-&gt;match_string(&#34;010.0.0.1&#34;) ? 1 : 0&#39;
1
</code></pre></td></tr></table>
</div>
</div><section class=footnotes role=doc-endnotes>
<hr>
<ol>
<li id=fn:1 role=doc-endnote>
<p>One of the most ridiculous URL paths I&rsquo;ve ever seen.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p>
</li>
</ol>
</section>
</div>
<footer class=post-footer>
<nav class=post-nav>
<a class=prev href=/2021/04/03/api-design-and-the-recent-ip-address-module-issues/>
<i class=iconfont><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="18" height="18"><path d="M691.908486 949.511495l75.369571-89.491197c10.963703-12.998035 10.285251-32.864502-1.499144-44.378743L479.499795 515.267417l277.93508-310.326815c11.338233-12.190647 11.035334-32.285311-.638543-44.850487l-80.46666-86.564541c-11.680017-12.583596-30.356378-12.893658-41.662889-.716314L257.233596 494.235404c-11.332093 12.183484-11.041474 32.266891.657986 44.844348l80.46666 86.564541c1.772366 1.910513 3.706415 3.533476 5.750981 4.877077l306.620399 321.703933C662.505829 963.726242 680.945807 962.528973 691.908486 949.511495z"/></svg>
</i>
<span class="prev-text nav-default">API Design and the Recent IP Address Module Issues</span>
<span class="prev-text nav-mobile">Prev</span>
</a>
<a class=next href=/2021/03/27/down-the-golang-nil-rabbit-hole/>
<span class="next-text nav-default">Down the Golang nil Rabbit Hole</span>
<span class="prev-text nav-mobile">Next</span>
<i class=iconfont><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="18" height="18"><path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697c-11.777231-11.500939-30.216186-10.304694-41.178865 2.712784z"/></svg>
</i>
</a>
</nav>
<hr>
<div class=copyright>
<p class=post-content>
<small>
Found a typo? Fix it by <a class=hexo-link href=https://github.com/autarch/blog.urth.org/edit/master/content/posts/2021-03-29-security-issues-in-perl-ip-address-distros.md>editing this page on GitHub</a>.
</small>
</p>
</div>
<div class=post-comments>
<div class=post-content>
<small>
Comments?
<p>
Discuss this post on:
</p>
<ul>
<li>
<a href=https://www.reddit.com/r/perl/comments/mfzxuh/security_issues_in_perl_ip_address_distros/>/r/perl</a>
</li>
<li>
<a href=https://www.reddit.com/r/programming/comments/mg0s73/security_issues_in_perl_ip_address_distros/>/r/programming</a>
</li>
<li>
<a href="https://news.ycombinator.com/item?id=26628827">Hacker News</a>
</li>
</ul>
<p>
You can
also <a href=mailto:autarch@urth.org>email me directly</a>.
</p>
</small>
</div>
</div>
</footer>
</article>
</div>
</div>
</main>
<footer id=footer class=footer>
<div class=icon-links>
<a href=mailto:autarch@urth.org rel="me noopener" class=iconfont title=email><svg class="icon" viewBox="0 0 1451 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="36" height="36"><path d="M664.781909 681.472759.0 97.881301C0 3.997201 71.046997.0 71.046997.0H474.477909 961.649408h399.992405s71.046998 3.997201 71.046998 97.881301L771.345323 681.472759S764.482731 685.154773 753.594283 688.65053V688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858V688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759zm53.281707 130.131124C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633.0 212.052267.0 212.052267V942.809523S0 1024 83.726336 1024H682.532949 753.579947h595.368192C1432.688811 1024 1432.688811 942.809523 1432.688811 942.809523V212.052267S893.138176 701.759633 817.019477 767.734955c-39.771477 34.470494-74.671786 43.295855-98.955861 43.868928z"/></svg>
</a>
<a href=https://github.com/houseabsolute rel="me noopener" class=iconfont title=github target=_blank><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="36" height="36"><path d="M512 12.672c-282.88.0-512 229.248-512 512 0 226.261333 146.688 418.133333 350.08 485.76 25.6 4.821333 34.986667-11.008 34.986667-24.618667.0-12.16-.426667-44.373333-.64-87.04C242.005334 929.664 211.968 830.08 211.968 830.08 188.672 770.986667 155.008 755.2 155.008 755.2c-46.378667-31.744 3.584-31.104 3.584-31.104 51.413333 3.584 78.421333 52.736 78.421333 52.736 45.653333 78.293333 119.850667 55.68 149.12 42.581333 4.608-33.109333 17.792-55.68 32.426667-68.48-113.706667-12.8-233.216-56.832-233.216-253.013333.0-55.893333 19.84-101.546667 52.693333-137.386667-5.76-12.928-23.04-64.981333 4.48-135.509333.0.0 42.88-13.738667 140.8 52.48 40.96-11.392 84.48-17.024 128-17.28 43.52.256 87.04 5.888 128 17.28 97.28-66.218667 140.16-52.48 140.16-52.48 27.52 70.528 10.24 122.581333 5.12 135.509333 32.64 35.84 52.48 81.493333 52.48 137.386667.0 196.693333-119.68 240-233.6 252.586667 17.92 15.36 34.56 46.762667 34.56 94.72.0 68.522667-.64 123.562667-.64 140.202666.0 13.44 8.96 29.44 35.2 24.32C877.44 942.592 1024 750.592 1024 524.672c0-282.752-229.248-512-512-512"/></svg>
</a>
<a href=https://blog.urth.org/index.xml rel="noopener alternate" type=application/rss+xml class=iconfont title=rss target=_blank><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="30" height="30"><path d="M819.157333 1024C819.157333 574.592 449.408 204.8.0 204.8V0c561.706667.0 1024 462.293333 1024 1024H819.157333zM140.416 743.04a140.8 140.8.0 01140.501333 140.586667A140.928 140.928.0 01140.074667 1024C62.72 1024 0 961.109333.0 883.626667S62.933333 743.082667 140.416 743.04zM678.784 1024h-199.04c0-263.210667-216.533333-479.786667-479.744-479.786667v-199.04c372.352.0 678.784 306.517333 678.784 678.826667z"/></svg>
</a>
</div>
<div class=copyright>
<span class=power-by>
Powered by <a class=hexo-link href=https://gohugo.io>Hugo</a>
</span>
<span class=division>|</span>
<span class=theme-info>
Theme - <a class=theme-link href=https://github.com/xianmin/hugo-theme-jane>Jane</a>
</span>
<span class=copyright-year>
&copy;
2007 -
2021
<span class=heart>
<i class=iconfont><svg class="icon" viewBox="0 0 1025 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14"><path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7.0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1.0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2.0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3.1-42.5-8-83.6-24-122.2z" fill="#8a8a8a"/></svg>
</i>
</span><span class=author>
Dave Rolsky
</span></span>
<span>
<br><a rel=license href=http://creativecommons.org/licenses/by-sa/4.0/><img alt="Creative Commons License" style=margin-top:.5em src=https://i.creativecommons.org/l/by-sa/4.0/88x31.png></a><br>This work is licensed under a <a rel=license href=http://creativecommons.org/licenses/by-sa/4.0/>Creative Commons Attribution-ShareAlike 4.0 International License</a>.
</span>
</div>
</footer>
<div class=back-to-top id=back-to-top>
<i class=iconfont><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="35" height="35"><path d="M510.866688 227.694839 95.449397 629.218702h235.761562L329.15309 958.01517h362.40389L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777h894.052392v131.813095H63.840492V63.962777zm0 0"/></svg>
</i>
</div>
</div>
<script src=https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin=anonymous></script>
<script type=text/javascript src=/js/main.46092e6b0887b5dca53a0fe72090c8674c270652585c1bfe3cb5d0045a70c6bd.js integrity="sha256-RgkuawiHtdylOg/nIJDIZ0wnBlJYXBv+PLXQBFpwxr0=" crossorigin=anonymous></script>
<script>$("#openSearch, #openSearchMobile").click(function(){$(".modal-dialog").addClass("visible")}),$("#closeSearch").click(function(){$(".modal-dialog").removeClass("visible")}),$(document).click(function(a){$(a.target).closest(".modal-content, #openSearch, #openSearchMobile").length||$("body").find(".modal-dialog").removeClass("visible")})</script>
</body>
</html>