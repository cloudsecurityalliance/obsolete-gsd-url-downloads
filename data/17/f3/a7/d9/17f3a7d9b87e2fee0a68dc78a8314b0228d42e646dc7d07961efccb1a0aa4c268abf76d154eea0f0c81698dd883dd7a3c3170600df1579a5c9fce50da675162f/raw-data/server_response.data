<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
<link rel="icon" href="/favicon.png">
<title>#583435 - CVE-2010-2061 rpcbind: Insecure handling of state files - Debian Bug report logs</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="/css/bugs.css" type="text/css">

<link rel="canonical" href="&lt;a href=&quot;bugreport.cgi?bug=583435&quot;&gt;583435&lt;/a&gt;">
<script type="text/javascript">
<!--
function toggle_infmessages()
{
        allDivs=document.getElementsByTagName("div");
        for (var i = 0 ; i < allDivs.length ; i++ )
        {
                if (allDivs[i].className == "infmessage")
                {
                        allDivs[i].style.display=(allDivs[i].style.display == 'none' | allDivs[i].style.display == '') ? 'block' : 'none';
                }
        }
}
-->
</script>
</head>
<body>
<h1>Debian Bug report logs - 
<a href="mailto:583435@bugs.debian.org">#583435</a><br>
CVE-2010-2061 rpcbind: Insecure handling of state files</h1>
<div class="versiongraph"><a href="version.cgi?package=rpcbind;fixed=rpcbind%2F0.2.0-4.1;absolute=0;info=1;collapse=1;found=rpcbind%2F0.2.0-4"><img alt="version graph" src="version.cgi?absolute=0;collapse=1;found=rpcbind%2F0.2.0-4;height=2;package=rpcbind;fixed=rpcbind%2F0.2.0-4.1;width=2"></a></div>
<div class="pkginfo">
  <p>Package:
     <a class="submitter" href="pkgreport.cgi?package=rpcbind">rpcbind</a>;
Maintainer for <a href="pkgreport.cgi?package=rpcbind">rpcbind</a> is <a href="pkgreport.cgi?maint=josue%40debian.org">Josue Ortega &lt;josue@debian.org&gt;</a>; Source for <a href="pkgreport.cgi?package=rpcbind">rpcbind</a> is <a href="pkgreport.cgi?src=rpcbind">src:rpcbind</a> (<a href="https://tracker.debian.org/pkg/rpcbind">PTS</a>, <a href="https://buildd.debian.org/rpcbind">buildd</a>, <a href="https://qa.debian.org/popcon.php?package=rpcbind">popcon</a>). </p>

</div>

<div class="buginfo">
  <p>Reported by: <a href="pkgreport.cgi?submitter=guillem%40debian.org">Guillem Jover &lt;guillem@debian.org&gt;</a></p>
  <p>Date: Thu, 27 May 2010 17:12:02 UTC</p>

<p>Severity: <em class="severity">serious</em></p>
<p>Tags: security</p>

<p>Found in version rpcbind/0.2.0-4</p>
<p>Fixed in version rpcbind/0.2.0-4.1</p>

<p><strong>Done:</strong> Stefan Fritsch &lt;sf@debian.org&gt;</p>

<p>Bug is archived. No further changes may be made.<p></div>

<p><a href="javascript:toggle_infmessages();">Toggle useless messages</a></p><div class="msgreceived"><p>View this report as an <a href="bugreport.cgi?bug=583435;mbox=yes">mbox folder</a>, <a href="bugreport.cgi?bug=583435;mbox=yes;mboxstatus=yes">status mbox</a>, <a href="bugreport.cgi?bug=583435;mbox=yes;mboxmaint=yes">maintainer mbox</a></p></div>

<div class="infmessage"><hr><p>
<a name="1"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Anibal Monsalve Salazar &lt;anibal@debian.org&gt; -->
<!-- time:1274980324 -->
<strong>Report forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Anibal Monsalve Salazar &lt;anibal@debian.org&gt;</code>:<br>
<code>Bug#583435</code>; Package <code>rpcbind</code>.
 (Thu, 27 May 2010 17:12:04 GMT) (<a href="bugreport.cgi?bug=583435;msg=2">full text</a>, <a href="bugreport.cgi?bug=583435;mbox=yes;msg=2">mbox</a>, <a href="#1">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="3"></a>
<!-- request_addr: Guillem Jover &lt;guillem@debian.org&gt; -->
<!-- time:1274980324 -->
<strong>Acknowledgement sent</strong>
to <code>Guillem Jover &lt;guillem@debian.org&gt;</code>:<br>
New Bug report received and forwarded.  Copy sent to <code>Anibal Monsalve Salazar &lt;anibal@debian.org&gt;</code>.
 (Thu, 27 May 2010 17:12:04 GMT) (<a href="bugreport.cgi?bug=583435;msg=4">full text</a>, <a href="bugreport.cgi?bug=583435;mbox=yes;msg=4">mbox</a>, <a href="#3">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="5"></a><a name="msg5"></a><a href="#5">Message #5</a> received at submit@bugs.debian.org (<a href="bugreport.cgi?bug=583435;msg=5">full text</a>, <a href="bugreport.cgi?bug=583435;mbox=yes;msg=5">mbox</a>, <a href="mailto:583435@bugs.debian.org?body=On%20Thu%2C%2027%20May%202010%2019%3A09%3A08%20%2B0200%20Guillem%20Jover%20%3Cguillem%40debian.org%3E%20wrote%3A%0A%3E%20Package%3A%20rpcbind%0A%3E%20Version%3A%200.2.0-4%0A%3E%20Severity%3A%20serious%0A%3E%20Tags%3A%20security%0A%3E%20%0A%3E%20Hi%21%0A%3E%20%0A%3E%20The%20rpcbind%20daemon%2C%20which%20runs%20as%20root%2C%20uses%20%2Ftmp%2Fportmap.xdr%20and%0A%3E%20%2Ftmp%2Frpcbind.xdr%20for%20doing%20warm%20starts%20as%20what%20seems%20to%20be%20a%20way%20to%0A%3E%20preserve%20state%20between%20invokations.%20It%20parses%20%28through%20libtirpc%29%20and%0A%3E%20removes%20them%20on%20start.%20It%20creates%20them%20before%20exiting.%0A%3E%20%0A%3E%20So%20first%20off%2C%20%2Aany%2A%20user%20can%20craft%20those%20two%20files%20before%20the%20daemon%0A%3E%20has%20started%20for%20the%20first%20time%2C%20which%20the%20daemon%20will%20parse.%20This%20might%0A%3E%20be%20ok%2C%20depending%20on%20the%20checks%20done%20on%20parse%2C%20I%27d%20still%20be%20very%20wary%20of%0A%3E%20letting%20a%20user%20be%20able%20to%20craft%20such%20files%20at%20will.%0A%3E%20%0A%3E%20The%20second%20problem%20is%20that%20those%20files%20get%20created%20by%20the%20daemon%20on%0A%3E%20shutdown%2C%20and%20they%20%2Ado%2A%20follow%20symlinks.%20So%20a%20user%20can%20drop%20two%20symlinks%0A%3E%20there%20while%20the%20daemon%20is%20running%20and%20overwrite%20any%20file%20on%20the%20file%0A%3E%20system%20on%20shutdown.%0A%3E%20%0A%3E%20The%20fix%20would%20consist%20of%20passing%20to%20configure%20something%20like%0A%3E%20%E2%80%9C--with-statedir%3D%2Fvar%2Fcache%2Frpcbind%E2%80%9D%2C%20and%20make%20sure%20the%20daemon%20creates%0A%3E%20such%20directory%20if%20missing%20on%20exit%20in%20src%2Fwarmstart.c%3Awrite_struct%28%29%2C%0A%3E%20which%20it%20does%20not%20seem%20to%20be%20doing%20currently.%0A%3E%20%0A%3E%20In%20addition%20it%20would%20be%20wise%20to%20notify%20upstream%20to%20change%20the%20default%0A%3E%20statedir%20to%20something%20else%20than%20%2Ftmp.%0A%3E%20%0A%3E%20thanks%2C%0A%3E%20guillem%0A%3E%20%0A%3E%20%0A%3E%20%0A&amp;subject=Re%3A%20rpcbind%3A%20Insecure%20handling%20of%20state%20files&amp;In-Reply-To=%3C20100527170908.GA14298%40gaara.hadrons.org%3E&amp;References=%3C20100527170908.GA14298%40gaara.hadrons.org%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=guillem%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Guillem Jover &lt;guillem@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> submit@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> rpcbind: Insecure handling of state files</div>
<div class="header"><span class="headerfield">Date:</span> Thu, 27 May 2010 19:09:08 +0200</div>
</div>
<pre class="message">Package: rpcbind
Version: 0.2.0-4
Severity: serious
Tags: security

Hi!

The rpcbind daemon, which runs as root, uses /tmp/portmap.xdr and
/tmp/rpcbind.xdr for doing warm starts as what seems to be a way to
preserve state between invokations. It parses (through libtirpc) and
removes them on start. It creates them before exiting.

So first off, *any* user can craft those two files before the daemon
has started for the first time, which the daemon will parse. This might
be ok, depending on the checks done on parse, I&#39;d still be very wary of
letting a user be able to craft such files at will.

The second problem is that those files get created by the daemon on
shutdown, and they *do* follow symlinks. So a user can drop two symlinks
there while the daemon is running and overwrite any file on the file
system on shutdown.

The fix would consist of passing to configure something like
“--with-statedir=/var/cache/rpcbind”, and make sure the daemon creates
such directory if missing on exit in src/warmstart.c:write_struct(),
which it does not seem to be doing currently.

In addition it would be wise to notify upstream to change the default
statedir to something else than /tmp.

thanks,
guillem



</pre>

<div class="infmessage"><hr><p>
<a name="6"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Anibal Monsalve Salazar &lt;anibal@debian.org&gt; -->
<!-- time:1275394683 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Anibal Monsalve Salazar &lt;anibal@debian.org&gt;</code>:<br>
<code>Bug#583435</code>; Package <code>rpcbind</code>.
 (Tue, 01 Jun 2010 12:18:03 GMT) (<a href="bugreport.cgi?bug=583435;msg=7">full text</a>, <a href="bugreport.cgi?bug=583435;mbox=yes;msg=7">mbox</a>, <a href="#6">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="8"></a>
<!-- request_addr: Guillem Jover &lt;guillem@debian.org&gt; -->
<!-- time:1275394683 -->
<strong>Acknowledgement sent</strong>
to <code>Guillem Jover &lt;guillem@debian.org&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Anibal Monsalve Salazar &lt;anibal@debian.org&gt;</code>.
 (Tue, 01 Jun 2010 12:18:03 GMT) (<a href="bugreport.cgi?bug=583435;msg=9">full text</a>, <a href="bugreport.cgi?bug=583435;mbox=yes;msg=9">mbox</a>, <a href="#8">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="10"></a><a name="msg10"></a><a href="#10">Message #10</a> received at 583435@bugs.debian.org (<a href="bugreport.cgi?bug=583435;msg=10">full text</a>, <a href="bugreport.cgi?bug=583435;mbox=yes;msg=10">mbox</a>, <a href="mailto:583435@bugs.debian.org?body=On%20Tue%2C%201%20Jun%202010%2014%3A09%3A07%20%2B0200%20Guillem%20Jover%20%3Cguillem%40debian.org%3E%20wrote%3A%0A%3E%20Hi%21%0A%3E%20%0A%3E%20On%20Thu%2C%202010-05-27%20at%2019%3A09%3A08%20%2B0200%2C%20Guillem%20Jover%20wrote%3A%0A%3E%20%3E%20Package%3A%20rpcbind%0A%3E%20%3E%20Version%3A%200.2.0-4%0A%3E%20%3E%20Severity%3A%20serious%0A%3E%20%3E%20Tags%3A%20security%0A%3E%20%0A%3E%20%3E%20The%20rpcbind%20daemon%2C%20which%20runs%20as%20root%2C%20uses%20%2Ftmp%2Fportmap.xdr%20and%0A%3E%20%3E%20%2Ftmp%2Frpcbind.xdr%20for%20doing%20warm%20starts%20as%20what%20seems%20to%20be%20a%20way%20to%0A%3E%20%3E%20preserve%20state%20between%20invokations.%20It%20parses%20%28through%20libtirpc%29%20and%0A%3E%20%3E%20removes%20them%20on%20start.%20It%20creates%20them%20before%20exiting.%0A%3E%20%3E%20%0A%3E%20%3E%20So%20first%20off%2C%20%2Aany%2A%20user%20can%20craft%20those%20two%20files%20before%20the%20daemon%0A%3E%20%3E%20has%20started%20for%20the%20first%20time%2C%20which%20the%20daemon%20will%20parse.%20This%20might%0A%3E%20%3E%20be%20ok%2C%20depending%20on%20the%20checks%20done%20on%20parse%2C%20I%27d%20still%20be%20very%20wary%20of%0A%3E%20%3E%20letting%20a%20user%20be%20able%20to%20craft%20such%20files%20at%20will.%0A%3E%20%0A%3E%20It%20seems%20to%20be%20doing%20no%20checks%20whatsoever.%20A%20simple%20test%20I%20performed%20at%0A%3E%20the%20time%20of%20filing%20this%20report%2C%20but%20didn%27t%20seem%20to%20have%20any%20obvious%0A%3E%20consequence%2C%20shows%20this%20which%20I%20noticed%20later%20on%3A%0A%3E%20%0A%3E%20%2C---%0A%3E%20gaara%3A~%23%20%2Fetc%2Finit.d%2Frpcbind%20start%0A%3E%20Starting%20rpcbind%20daemon....%0A%3E%20gaara%3A~%23%20ps%20axuOp%7Cegrep%20%27%28%5EUSER%7C%5Br%5Dpcbind%29%27%0A%3E%20USER%20%20%20%20%20%20%20PID%20%25CPU%20%25MEM%20%20%20%20VSZ%20%20%20RSS%20TTY%20%20%20%20%20%20STAT%20START%20%20%20TIME%20COMMAND%0A%3E%20root%20%20%20%20%2023424%20%200.0%20%200.0%20%2018768%20%20%20704%20%3F%20%20%20%20%20%20%20%20Ss%20%20%2013%3A53%20%20%200%3A00%20%2Fsbin%2Frpcbind%20-w%0A%3E%20gaara%3A~%23%20%2Fetc%2Finit.d%2Frpcbind%20stop%0A%3E%20Stopping%20rpcbind%20daemon....%0A%3E%20gaara%3A~%23%20dd%20if%3D%2Fdev%2Furandom%20of%3D%2Ftmp%2Frpcbind.xdr%20bs%3D1024%20count%3D1%0A%3E%201%2B0%20records%20in%0A%3E%201%2B0%20records%20out%0A%3E%201024%20bytes%20%281%2C0%20kB%29%20copied%2C%200%2C000861307%20s%2C%201%2C2%20MB%2Fs%0A%3E%20gaara%3A~%23%20%2Fetc%2Finit.d%2Frpcbind%20start%0A%3E%20Starting%20rpcbind%20daemon....%0A%3E%20gaara%3A~%23%20ps%20axuOp%7Cegrep%20%27%28%5EUSER%7C%5Br%5Dpcbind%29%27%0A%3E%20USER%20%20%20%20%20%20%20PID%20%25CPU%20%25MEM%20%20%20%20VSZ%20%20%20RSS%20TTY%20%20%20%20%20%20STAT%20START%20%20%20TIME%20COMMAND%0A%3E%20root%20%20%20%20%2023440%20%200.0%20%200.0%204008972%20%20772%20%3F%20%20%20%20%20%20%20%20Ss%20%20%2013%3A54%20%20%200%3A00%20%2Fsbin%2Frpcbind%20-w%0A%3E%20%60---%0A%3E%20%0A%3E%20The%20first%20start%20is%20a%20normal%20clean%20invokation%2C%20the%20second%20one%20is%20using%0A%3E%20the%20crafted%20file.%20See%20how%20it%20has%20allocated%20almost%204%20GiB.%20Disregard%20though%2C%0A%3E%20me%20running%20all%20this%20as%20root%2C%20a%20user%20would%20be%20able%20to%20craft%20those%20files%20as%0A%3E%20long%20as%20they%20were%20not%20already%20in%20%2Ftmp.%0A%3E%20%0A%3E%20thanks%2C%0A%3E%20guillem%0A%3E%20%0A%3E%20%0A%3E%20%0A&amp;References=%3C20100527170908.GA14298%40gaara.hadrons.org%3E%0A%20%3C20100601120907.GA23357%40gaara.hadrons.org%3E&amp;In-Reply-To=%3C20100601120907.GA23357%40gaara.hadrons.org%3E&amp;subject=Re%3A%20Bug%23583435%3A%20rpcbind%3A%20Insecure%20handling%20of%20state%20files">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=guillem%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Guillem Jover &lt;guillem@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> 583435@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#583435: rpcbind: Insecure handling of state files</div>
<div class="header"><span class="headerfield">Date:</span> Tue, 1 Jun 2010 14:09:07 +0200</div>
</div>
<pre class="message">Hi!

On Thu, 2010-05-27 at 19:09:08 +0200, Guillem Jover wrote:
&gt; Package: rpcbind
&gt; Version: 0.2.0-4
&gt; Severity: serious
&gt; Tags: security

&gt; The rpcbind daemon, which runs as root, uses /tmp/portmap.xdr and
&gt; /tmp/rpcbind.xdr for doing warm starts as what seems to be a way to
&gt; preserve state between invokations. It parses (through libtirpc) and
&gt; removes them on start. It creates them before exiting.
&gt; 
&gt; So first off, *any* user can craft those two files before the daemon
&gt; has started for the first time, which the daemon will parse. This might
&gt; be ok, depending on the checks done on parse, I&#39;d still be very wary of
&gt; letting a user be able to craft such files at will.

It seems to be doing no checks whatsoever. A simple test I performed at
the time of filing this report, but didn&#39;t seem to have any obvious
consequence, shows this which I noticed later on:

,---
gaara:~# /etc/init.d/rpcbind start
Starting rpcbind daemon....
gaara:~# ps axuOp|egrep &#39;(^USER|[r]pcbind)&#39;
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
root     23424  0.0  0.0  18768   704 ?        Ss   13:53   0:00 /sbin/rpcbind -w
gaara:~# /etc/init.d/rpcbind stop
Stopping rpcbind daemon....
gaara:~# dd if=/dev/urandom of=/tmp/rpcbind.xdr bs=1024 count=1
1+0 records in
1+0 records out
1024 bytes (1,0 kB) copied, 0,000861307 s, 1,2 MB/s
gaara:~# /etc/init.d/rpcbind start
Starting rpcbind daemon....
gaara:~# ps axuOp|egrep &#39;(^USER|[r]pcbind)&#39;
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
root     23440  0.0  0.0 4008972  772 ?        Ss   13:54   0:00 /sbin/rpcbind -w
`---

The first start is a normal clean invokation, the second one is using
the crafted file. See how it has allocated almost 4 GiB. Disregard though,
me running all this as root, a user would be able to craft those files as
long as they were not already in /tmp.

thanks,
guillem



</pre>

<div class="infmessage"><hr><p>
<a name="11"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Anibal Monsalve Salazar &lt;anibal@debian.org&gt; -->
<!-- time:1275478023 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Anibal Monsalve Salazar &lt;anibal@debian.org&gt;</code>:<br>
<code>Bug#583435</code>; Package <code>rpcbind</code>.
 (Wed, 02 Jun 2010 11:27:03 GMT) (<a href="bugreport.cgi?bug=583435;msg=12">full text</a>, <a href="bugreport.cgi?bug=583435;mbox=yes;msg=12">mbox</a>, <a href="#11">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="13"></a>
<!-- request_addr: Aníbal Monsalve Salazar &lt;anibal@debian.org&gt; -->
<!-- time:1275478023 -->
<strong>Acknowledgement sent</strong>
to <code>Aníbal Monsalve Salazar &lt;anibal@debian.org&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Anibal Monsalve Salazar &lt;anibal@debian.org&gt;</code>.
 (Wed, 02 Jun 2010 11:27:03 GMT) (<a href="bugreport.cgi?bug=583435;msg=14">full text</a>, <a href="bugreport.cgi?bug=583435;mbox=yes;msg=14">mbox</a>, <a href="#13">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="15"></a><a name="msg15"></a><a href="#15">Message #15</a> received at 583435@bugs.debian.org (<a href="bugreport.cgi?bug=583435;msg=15">full text</a>, <a href="bugreport.cgi?bug=583435;mbox=yes;msg=15">mbox</a>, <a href="mailto:583435@bugs.debian.org?body=On%20Wed%2C%202%20Jun%202010%2021%3A25%3A21%20%2B1000%20%3D%3Fiso-8859-1%3FQ%3FAn%3DEDbal%3F%3D%20Monsalve%20Salazar%20%3Canibal%40debian.org%3E%20wrote%3A%0A%3E%20On%20Tue%2C%20Jun%2001%2C%202010%20at%2002%3A09%3A07PM%20%2B0200%2C%20Guillem%20Jover%20wrote%3A%0A%3E%20%3EHi%21%0A%3E%20%3E%0A%3E%20%3EOn%20Thu%2C%202010-05-27%20at%2019%3A09%3A08%20%2B0200%2C%20Guillem%20Jover%20wrote%3A%0A%3E%20%3E%3EPackage%3A%20rpcbind%0A%3E%20%3E%3EVersion%3A%200.2.0-4%0A%3E%20%3E%3ESeverity%3A%20serious%0A%3E%20%3E%3ETags%3A%20security%0A%3E%20%3E%0A%3E%20%3E%3EThe%20rpcbind%20daemon%2C%20which%20runs%20as%20root%2C%20uses%20%2Ftmp%2Fportmap.xdr%20and%0A%3E%20%3E%3E%2Ftmp%2Frpcbind.xdr%20for%20doing%20warm%20starts%20as%20what%20seems%20to%20be%20a%20way%20to%0A%3E%20%3E%3Epreserve%20state%20between%20invokations.%20It%20parses%20%28through%20libtirpc%29%20and%0A%3E%20%3E%3Eremoves%20them%20on%20start.%20It%20creates%20them%20before%20exiting.%0A%3E%20%3E%3E%0A%3E%20%3E%3ESo%20first%20off%2C%20%2Aany%2A%20user%20can%20craft%20those%20two%20files%20before%20the%20daemon%0A%3E%20%3E%3Ehas%20started%20for%20the%20first%20time%2C%20which%20the%20daemon%20will%20parse.%20This%0A%3E%20%3E%3Emight%20be%20ok%2C%20depending%20on%20the%20checks%20done%20on%20parse%2C%20I%27d%20still%20be%20very%0A%3E%20%3E%3Ewary%20of%20letting%20a%20user%20be%20able%20to%20craft%20such%20files%20at%20will.%0A%3E%20%3E%0A%3E%20%3EIt%20seems%20to%20be%20doing%20no%20checks%20whatsoever.%20A%20simple%20test%20I%20performed%20at%0A%3E%20%3Ethe%20time%20of%20filing%20this%20report%2C%20but%20didn%27t%20seem%20to%20have%20any%20obvious%0A%3E%20%3Econsequence%2C%20shows%20this%20which%20I%20noticed%20later%20on%3A%0A%3E%20%3E%0A%3E%20%3E%2C---%0A%3E%20%3Egaara%3A~%23%20%2Fetc%2Finit.d%2Frpcbind%20start%0A%3E%20%3EStarting%20rpcbind%20daemon....%0A%3E%20%3Egaara%3A~%23%20ps%20axuOp%7Cegrep%20%27%28%5EUSER%7C%5Br%5Dpcbind%29%27%0A%3E%20%3EUSER%20%20%20%20%20%20%20PID%20%25CPU%20%25MEM%20%20%20%20VSZ%20%20%20RSS%20TTY%20%20%20%20%20%20STAT%20START%20%20%20TIME%20COMMAND%0A%3E%20%3Eroot%20%20%20%20%2023424%20%200.0%20%200.0%20%2018768%20%20%20704%20%3F%20%20%20%20%20%20%20%20Ss%20%20%2013%3A53%20%20%200%3A00%20%2Fsbin%2Frpcbind%20-w%0A%3E%20%3Egaara%3A~%23%20%2Fetc%2Finit.d%2Frpcbind%20stop%0A%3E%20%3EStopping%20rpcbind%20daemon....%0A%3E%20%3Egaara%3A~%23%20dd%20if%3D%2Fdev%2Furandom%20of%3D%2Ftmp%2Frpcbind.xdr%20bs%3D1024%20count%3D1%0A%3E%20%3E1%2B0%20records%20in%0A%3E%20%3E1%2B0%20records%20out%0A%3E%20%3E1024%20bytes%20%281%2C0%20kB%29%20copied%2C%200%2C000861307%20s%2C%201%2C2%20MB%2Fs%0A%3E%20%3Egaara%3A~%23%20%2Fetc%2Finit.d%2Frpcbind%20start%0A%3E%20%3EStarting%20rpcbind%20daemon....%0A%3E%20%3Egaara%3A~%23%20ps%20axuOp%7Cegrep%20%27%28%5EUSER%7C%5Br%5Dpcbind%29%27%0A%3E%20%3EUSER%20%20%20%20%20%20%20PID%20%25CPU%20%25MEM%20%20%20%20VSZ%20%20%20RSS%20TTY%20%20%20%20%20%20STAT%20START%20%20%20TIME%20COMMAND%0A%3E%20%3Eroot%20%20%20%20%2023440%20%200.0%20%200.0%204008972%20%20772%20%3F%20%20%20%20%20%20%20%20Ss%20%20%2013%3A54%20%20%200%3A00%20%2Fsbin%2Frpcbind%20-w%0A%3E%20%3E%60---%0A%3E%20%3E%0A%3E%20%3EThe%20first%20start%20is%20a%20normal%20clean%20invokation%2C%20the%20second%20one%20is%20using%0A%3E%20%3Ethe%20crafted%20file.%20See%20how%20it%20has%20allocated%20almost%204%20GiB.%20Disregard%20though%2C%0A%3E%20%3Eme%20running%20all%20this%20as%20root%2C%20a%20user%20would%20be%20able%20to%20craft%20those%20files%20as%0A%3E%20%3Elong%20as%20they%20were%20not%20already%20in%20%2Ftmp.%0A%3E%20%3E%0A%3E%20%3Ethanks%2C%0A%3E%20%3Eguillem%0A%3E%20%0A%3E%20I%27m%20sending%20this%20bug%20report%20to%20the%20linux-nfs%20mailing%20list.%0A%3E%20%0A%3E%20The%20original%20bug%20report%20is%20at%20http%3A%2F%2Fbugs.debian.org%2F583435%0A%3E%20%0A%3E%20Thank%20you.%0A%3E%20%0A%3E%20%0A%3E%20%0A&amp;References=%3C20100527170908.GA14298%40gaara.hadrons.org%3E%0A%20%3C20100601120907.GA23357%40gaara.hadrons.org%3E%0A%20%3C20100602112520.GA22639%40master.debian.org%3E&amp;In-Reply-To=%3C20100602112520.GA22639%40master.debian.org%3E&amp;subject=Re%3A%20Bug%23583435%3A%20rpcbind%3A%20Insecure%20handling%20of%20state%20files">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=anibal%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Aníbal Monsalve Salazar &lt;anibal@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> linux-nfs@vger.kernel.org</div>
<div class="header"><span class="headerfield">Cc:</span> Guillem Jover &lt;guillem@debian.org&gt;, 583435@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#583435: rpcbind: Insecure handling of state files</div>
<div class="header"><span class="headerfield">Date:</span> Wed, 2 Jun 2010 21:25:21 +1000</div>
</div>
<pre class="message">On Tue, Jun 01, 2010 at 02:09:07PM +0200, Guillem Jover wrote:
&gt;Hi!
&gt;
&gt;On Thu, 2010-05-27 at 19:09:08 +0200, Guillem Jover wrote:
&gt;&gt;Package: rpcbind
&gt;&gt;Version: 0.2.0-4
&gt;&gt;Severity: serious
&gt;&gt;Tags: security
&gt;
&gt;&gt;The rpcbind daemon, which runs as root, uses /tmp/portmap.xdr and
&gt;&gt;/tmp/rpcbind.xdr for doing warm starts as what seems to be a way to
&gt;&gt;preserve state between invokations. It parses (through libtirpc) and
&gt;&gt;removes them on start. It creates them before exiting.
&gt;&gt;
&gt;&gt;So first off, *any* user can craft those two files before the daemon
&gt;&gt;has started for the first time, which the daemon will parse. This
&gt;&gt;might be ok, depending on the checks done on parse, I&#39;d still be very
&gt;&gt;wary of letting a user be able to craft such files at will.
&gt;
&gt;It seems to be doing no checks whatsoever. A simple test I performed at
&gt;the time of filing this report, but didn&#39;t seem to have any obvious
&gt;consequence, shows this which I noticed later on:
&gt;
&gt;,---
&gt;gaara:~# /etc/init.d/rpcbind start
&gt;Starting rpcbind daemon....
&gt;gaara:~# ps axuOp|egrep &#39;(^USER|[r]pcbind)&#39;
&gt;USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
&gt;root     23424  0.0  0.0  18768   704 ?        Ss   13:53   0:00 /sbin/rpcbind -w
&gt;gaara:~# /etc/init.d/rpcbind stop
&gt;Stopping rpcbind daemon....
&gt;gaara:~# dd if=/dev/urandom of=/tmp/rpcbind.xdr bs=1024 count=1
&gt;1+0 records in
&gt;1+0 records out
&gt;1024 bytes (1,0 kB) copied, 0,000861307 s, 1,2 MB/s
&gt;gaara:~# /etc/init.d/rpcbind start
&gt;Starting rpcbind daemon....
&gt;gaara:~# ps axuOp|egrep &#39;(^USER|[r]pcbind)&#39;
&gt;USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
&gt;root     23440  0.0  0.0 4008972  772 ?        Ss   13:54   0:00 /sbin/rpcbind -w
&gt;`---
&gt;
&gt;The first start is a normal clean invokation, the second one is using
&gt;the crafted file. See how it has allocated almost 4 GiB. Disregard though,
&gt;me running all this as root, a user would be able to craft those files as
&gt;long as they were not already in /tmp.
&gt;
&gt;thanks,
&gt;guillem

I&#39;m sending this bug report to the linux-nfs mailing list.

The original bug report is at <a href="http://bugs.debian.org/583435">http://bugs.debian.org/583435</a>

Thank you.



</pre>

<div class="infmessage"><hr><p>
<a name="16"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Anibal Monsalve Salazar &lt;anibal@debian.org&gt; -->
<!-- time:1275597007 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Anibal Monsalve Salazar &lt;anibal@debian.org&gt;</code>:<br>
<code>Bug#583435</code>; Package <code>rpcbind</code>.
 (Thu, 03 Jun 2010 20:30:07 GMT) (<a href="bugreport.cgi?bug=583435;msg=17">full text</a>, <a href="bugreport.cgi?bug=583435;mbox=yes;msg=17">mbox</a>, <a href="#16">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="18"></a>
<!-- request_addr: Guillem Jover &lt;guillem@debian.org&gt; -->
<!-- time:1275597007 -->
<strong>Acknowledgement sent</strong>
to <code>Guillem Jover &lt;guillem@debian.org&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Anibal Monsalve Salazar &lt;anibal@debian.org&gt;</code>.
 (Thu, 03 Jun 2010 20:30:07 GMT) (<a href="bugreport.cgi?bug=583435;msg=19">full text</a>, <a href="bugreport.cgi?bug=583435;mbox=yes;msg=19">mbox</a>, <a href="#18">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="20"></a><a name="msg20"></a><a href="#20">Message #20</a> received at 583435@bugs.debian.org (<a href="bugreport.cgi?bug=583435;msg=20">full text</a>, <a href="bugreport.cgi?bug=583435;mbox=yes;msg=20">mbox</a>, <a href="mailto:583435@bugs.debian.org?body=On%20Thu%2C%203%20Jun%202010%2022%3A27%3A43%20%2B0200%20Guillem%20Jover%20%3Cguillem%40debian.org%3E%20wrote%3A%0A%3E%20Hi%21%0A%3E%20%0A%3E%20On%20Thu%2C%202010-06-03%20at%2016%3A07%3A50%20-0400%2C%20Chuck%20Lever%20wrote%3A%0A%3E%20%3E%20On%2006%2F%202%2F10%2007%3A25%20AM%2C%20An%C3%ADbal%20Monsalve%20Salazar%20wrote%3A%0A%3E%20%3E%20%3E%20On%20Tue%2C%20Jun%2001%2C%202010%20at%2002%3A09%3A07PM%20%2B0200%2C%20Guillem%20Jover%20wrote%3A%0A%3E%20%3E%20%3E%20%3E%20On%20Thu%2C%202010-05-27%20at%2019%3A09%3A08%20%2B0200%2C%20Guillem%20Jover%20wrote%3A%0A%3E%20%3E%20%3E%20%3E%20%3E%20Package%3A%20rpcbind%0A%3E%20%3E%20%3E%20%3E%20%3E%20Version%3A%200.2.0-4%0A%3E%20%3E%20%3E%20%3E%20%3E%20Severity%3A%20serious%0A%3E%20%3E%20%3E%20%3E%20%3E%20Tags%3A%20security%0A%3E%20%3E%20%3E%20%3E%0A%3E%20%3E%20%3E%20%3E%20%3E%20The%20rpcbind%20daemon%2C%20which%20runs%20as%20root%2C%20uses%20%2Ftmp%2Fportmap.xdr%20and%0A%3E%20%3E%20%3E%20%3E%20%3E%20%2Ftmp%2Frpcbind.xdr%20for%20doing%20warm%20starts%20as%20what%20seems%20to%20be%20a%20way%20to%0A%3E%20%3E%20%3E%20%3E%20%3E%20preserve%20state%20between%20invokations.%20It%20parses%20%28through%20libtirpc%29%20and%0A%3E%20%3E%20%3E%20%3E%20%3E%20removes%20them%20on%20start.%20It%20creates%20them%20before%20exiting.%0A%3E%20%3E%20%3E%20%3E%20%3E%0A%3E%20%3E%20%3E%20%3E%20%3E%20So%20first%20off%2C%20%2Aany%2A%20user%20can%20craft%20those%20two%20files%20before%20the%20daemon%0A%3E%20%3E%20%3E%20%3E%20%3E%20has%20started%20for%20the%20first%20time%2C%20which%20the%20daemon%20will%20parse.%20This%0A%3E%20%3E%20%3E%20%3E%20%3E%20might%20be%20ok%2C%20depending%20on%20the%20checks%20done%20on%20parse%2C%20I%27d%20still%20be%20very%0A%3E%20%3E%20%3E%20%3E%20%3E%20wary%20of%20letting%20a%20user%20be%20able%20to%20craft%20such%20files%20at%20will.%0A%3E%20%3E%20%3E%20%3E%0A%3E%20%3E%20%3E%20%3E%20It%20seems%20to%20be%20doing%20no%20checks%20whatsoever.%20A%20simple%20test%20I%20performed%20at%0A%3E%20%3E%20%3E%20%3E%20the%20time%20of%20filing%20this%20report%2C%20but%20didn%27t%20seem%20to%20have%20any%20obvious%0A%3E%20%3E%20%3E%20%3E%20consequence%2C%20shows%20this%20which%20I%20noticed%20later%20on%3A%0A%3E%20%0A%3E%20%3E%20%3E%20The%20original%20bug%20report%20is%20at%20http%3A%2F%2Fbugs.debian.org%2F583435%0A%3E%20%0A%3E%20I%27m%20adding%20here%20part%20of%20the%20initial%20mail%20that%20I%20trimmed%20when%20replying%0A%3E%20to%20myself%3A%0A%3E%20%0A%3E%20%2C---%0A%3E%20The%20second%20problem%20is%20that%20those%20files%20get%20created%20by%20the%20daemon%20on%0A%3E%20shutdown%2C%20and%20they%20%2Ado%2A%20follow%20symlinks.%20So%20a%20user%20can%20drop%20two%0A%3E%20symlinks%0A%3E%20there%20while%20the%20daemon%20is%20running%20and%20overwrite%20any%20file%20on%20the%20file%0A%3E%20system%20on%20shutdown.%0A%3E%20%0A%3E%20The%20fix%20would%20consist%20of%20passing%20to%20configure%20something%20like%0A%3E%20%E2%80%9C--with-statedir%3D%2Fvar%2Fcache%2Frpcbind%E2%80%9D%2C%20and%20make%20sure%20the%20daemon%20creates%0A%3E%20such%20directory%20if%20missing%20on%20exit%20in%20src%2Fwarmstart.c%3Awrite_struct%28%29%2C%0A%3E%20which%20it%20does%20not%20seem%20to%20be%20doing%20currently.%0A%3E%20%0A%3E%20In%20addition%20it%20would%20be%20wise%20to%20notify%20upstream%20to%20change%20the%20default%0A%3E%20statedir%20to%20something%20else%20than%20%2Ftmp.%0A%3E%20%60---%0A%3E%20%0A%3E%20%3E%20Would%20%2Fvar%2Frun%20%28or%20a%20subdirectory%20of%20it%29%20be%20a%20better%20choice%20than%20%2Ftmp%20%3F%0A%3E%20%0A%3E%20%2Fvar%2Frun%20might%20not%20be%20preserved%20across%20reboots%2C%20but%20regardless%20of%20that%20I%0A%3E%20think%20%2Fvar%2Fcache%20is%20a%20better%20fit%2C%20it%27s%20internal%20state%2C%20but%20it%27s%20used%0A%3E%20to%20speed%20up%20start%20up%20time%2C%20and%20can%20be%20removed%20w%2Fo%20ill%20effects.%0A%3E%20%0A%3E%20regards%2C%0A%3E%20guillem%0A%3E%20%0A%3E%20%0A%3E%20%0A&amp;In-Reply-To=%3C20100603202743.GA6643%40gaara.hadrons.org%3E&amp;subject=Re%3A%20Bug%23583435%3A%20rpcbind%3A%20Insecure%20handling%20of%20state%20files&amp;References=%3C20100527170908.GA14298%40gaara.hadrons.org%3E%0A%20%3C20100601120907.GA23357%40gaara.hadrons.org%3E%0A%20%3C20100602112520.GA22639%40master.debian.org%3E%0A%20%3C4C080B96.1030707%40oracle.com%3E%0A%20%3C20100603202743.GA6643%40gaara.hadrons.org%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=guillem%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Guillem Jover &lt;guillem@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> Chuck Lever &lt;chuck.lever@oracle.com&gt;</div>
<div class="header"><span class="headerfield">Cc:</span> linux-nfs@vger.kernel.org, 583435@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#583435: rpcbind: Insecure handling of state files</div>
<div class="header"><span class="headerfield">Date:</span> Thu, 3 Jun 2010 22:27:43 +0200</div>
</div>
<pre class="message">Hi!

On Thu, 2010-06-03 at 16:07:50 -0400, Chuck Lever wrote:
&gt; On 06/ 2/10 07:25 AM, Aníbal Monsalve Salazar wrote:
&gt; &gt; On Tue, Jun 01, 2010 at 02:09:07PM +0200, Guillem Jover wrote:
&gt; &gt; &gt; On Thu, 2010-05-27 at 19:09:08 +0200, Guillem Jover wrote:
&gt; &gt; &gt; &gt; Package: rpcbind
&gt; &gt; &gt; &gt; Version: 0.2.0-4
&gt; &gt; &gt; &gt; Severity: serious
&gt; &gt; &gt; &gt; Tags: security
&gt; &gt; &gt;
&gt; &gt; &gt; &gt; The rpcbind daemon, which runs as root, uses /tmp/portmap.xdr and
&gt; &gt; &gt; &gt; /tmp/rpcbind.xdr for doing warm starts as what seems to be a way to
&gt; &gt; &gt; &gt; preserve state between invokations. It parses (through libtirpc) and
&gt; &gt; &gt; &gt; removes them on start. It creates them before exiting.
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; So first off, *any* user can craft those two files before the daemon
&gt; &gt; &gt; &gt; has started for the first time, which the daemon will parse. This
&gt; &gt; &gt; &gt; might be ok, depending on the checks done on parse, I&#39;d still be very
&gt; &gt; &gt; &gt; wary of letting a user be able to craft such files at will.
&gt; &gt; &gt;
&gt; &gt; &gt; It seems to be doing no checks whatsoever. A simple test I performed at
&gt; &gt; &gt; the time of filing this report, but didn&#39;t seem to have any obvious
&gt; &gt; &gt; consequence, shows this which I noticed later on:

&gt; &gt; The original bug report is at <a href="http://bugs.debian.org/583435">http://bugs.debian.org/583435</a>

I&#39;m adding here part of the initial mail that I trimmed when replying
to myself:

,---
The second problem is that those files get created by the daemon on
shutdown, and they *do* follow symlinks. So a user can drop two
symlinks
there while the daemon is running and overwrite any file on the file
system on shutdown.

The fix would consist of passing to configure something like
“--with-statedir=/var/cache/rpcbind”, and make sure the daemon creates
such directory if missing on exit in src/warmstart.c:write_struct(),
which it does not seem to be doing currently.

In addition it would be wise to notify upstream to change the default
statedir to something else than /tmp.
`---

&gt; Would /var/run (or a subdirectory of it) be a better choice than /tmp ?

/var/run might not be preserved across reboots, but regardless of that I
think /var/cache is a better fit, it&#39;s internal state, but it&#39;s used
to speed up start up time, and can be removed w/o ill effects.

regards,
guillem



</pre>

<div class="infmessage"><hr><p>
<a name="21"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Anibal Monsalve Salazar &lt;anibal@debian.org&gt; -->
<!-- time:1275597548 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Anibal Monsalve Salazar &lt;anibal@debian.org&gt;</code>:<br>
<code>Bug#583435</code>; Package <code>rpcbind</code>.
 (Thu, 03 Jun 2010 20:39:08 GMT) (<a href="bugreport.cgi?bug=583435;msg=22">full text</a>, <a href="bugreport.cgi?bug=583435;mbox=yes;msg=22">mbox</a>, <a href="#21">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="23"></a>
<!-- request_addr: Chuck Lever &lt;chuck.lever@oracle.com&gt; -->
<!-- time:1275597548 -->
<strong>Acknowledgement sent</strong>
to <code>Chuck Lever &lt;chuck.lever@oracle.com&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Anibal Monsalve Salazar &lt;anibal@debian.org&gt;</code>.
 (Thu, 03 Jun 2010 20:39:08 GMT) (<a href="bugreport.cgi?bug=583435;msg=24">full text</a>, <a href="bugreport.cgi?bug=583435;mbox=yes;msg=24">mbox</a>, <a href="#23">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="25"></a><a name="msg25"></a><a href="#25">Message #25</a> received at 583435@bugs.debian.org (<a href="bugreport.cgi?bug=583435;msg=25">full text</a>, <a href="bugreport.cgi?bug=583435;mbox=yes;msg=25">mbox</a>, <a href="mailto:583435@bugs.debian.org?References=%3C20100527170908.GA14298%40gaara.hadrons.org%3E%20%3C20100601120907.GA23357%40gaara.hadrons.org%3E%20%3C20100602112520.GA22639%40master.debian.org%3E%20%3C4C080B96.1030707%40oracle.com%3E%20%3C20100603202743.GA6643%40gaara.hadrons.org%3E%0A%20%3C4C0811B9.3060809%40oracle.com%3E&amp;subject=Re%3A%20Bug%23583435%3A%20rpcbind%3A%20Insecure%20handling%20of%20state%20files&amp;In-Reply-To=%3C4C0811B9.3060809%40oracle.com%3E&amp;body=On%20Thu%2C%2003%20Jun%202010%2016%3A34%3A01%20-0400%20Chuck%20Lever%20%3Cchuck.lever%40oracle.com%3E%20wrote%3A%0A%3E%20On%2006%2F%203%2F10%2004%3A27%20PM%2C%20Guillem%20Jover%20wrote%3A%0A%3E%20%3E%20Hi%21%0A%3E%20%3E%0A%3E%20%3E%20On%20Thu%2C%202010-06-03%20at%2016%3A07%3A50%20-0400%2C%20Chuck%20Lever%20wrote%3A%0A%3E%20%3E%3E%20On%2006%2F%202%2F10%2007%3A25%20AM%2C%20An%C3%ADbal%20Monsalve%20Salazar%20wrote%3A%0A%3E%20%3E%3E%3E%20On%20Tue%2C%20Jun%2001%2C%202010%20at%2002%3A09%3A07PM%20%2B0200%2C%20Guillem%20Jover%20wrote%3A%0A%3E%20%3E%3E%3E%3E%20On%20Thu%2C%202010-05-27%20at%2019%3A09%3A08%20%2B0200%2C%20Guillem%20Jover%20wrote%3A%0A%3E%20%3E%3E%3E%3E%3E%20Package%3A%20rpcbind%0A%3E%20%3E%3E%3E%3E%3E%20Version%3A%200.2.0-4%0A%3E%20%3E%3E%3E%3E%3E%20Severity%3A%20serious%0A%3E%20%3E%3E%3E%3E%3E%20Tags%3A%20security%0A%3E%20%3E%3E%3E%3E%0A%3E%20%3E%3E%3E%3E%3E%20The%20rpcbind%20daemon%2C%20which%20runs%20as%20root%2C%20uses%20%2Ftmp%2Fportmap.xdr%20and%0A%3E%20%3E%3E%3E%3E%3E%20%2Ftmp%2Frpcbind.xdr%20for%20doing%20warm%20starts%20as%20what%20seems%20to%20be%20a%20way%20to%0A%3E%20%3E%3E%3E%3E%3E%20preserve%20state%20between%20invokations.%20It%20parses%20%28through%20libtirpc%29%20and%0A%3E%20%3E%3E%3E%3E%3E%20removes%20them%20on%20start.%20It%20creates%20them%20before%20exiting.%0A%3E%20%3E%3E%3E%3E%3E%0A%3E%20%3E%3E%3E%3E%3E%20So%20first%20off%2C%20%2Aany%2A%20user%20can%20craft%20those%20two%20files%20before%20the%20daemon%0A%3E%20%3E%3E%3E%3E%3E%20has%20started%20for%20the%20first%20time%2C%20which%20the%20daemon%20will%20parse.%20This%0A%3E%20%3E%3E%3E%3E%3E%20might%20be%20ok%2C%20depending%20on%20the%20checks%20done%20on%20parse%2C%20I%27d%20still%20be%20very%0A%3E%20%3E%3E%3E%3E%3E%20wary%20of%20letting%20a%20user%20be%20able%20to%20craft%20such%20files%20at%20will.%0A%3E%20%3E%3E%3E%3E%0A%3E%20%3E%3E%3E%3E%20It%20seems%20to%20be%20doing%20no%20checks%20whatsoever.%20A%20simple%20test%20I%20performed%20at%0A%3E%20%3E%3E%3E%3E%20the%20time%20of%20filing%20this%20report%2C%20but%20didn%27t%20seem%20to%20have%20any%20obvious%0A%3E%20%3E%3E%3E%3E%20consequence%2C%20shows%20this%20which%20I%20noticed%20later%20on%3A%0A%3E%20%3E%0A%3E%20%3E%3E%3E%20The%20original%20bug%20report%20is%20at%20http%3A%2F%2Fbugs.debian.org%2F583435%0A%3E%20%3E%0A%3E%20%3E%20I%27m%20adding%20here%20part%20of%20the%20initial%20mail%20that%20I%20trimmed%20when%20replying%0A%3E%20%3E%20to%20myself%3A%0A%3E%20%3E%0A%3E%20%3E%20%2C---%0A%3E%20%3E%20The%20second%20problem%20is%20that%20those%20files%20get%20created%20by%20the%20daemon%20on%0A%3E%20%3E%20shutdown%2C%20and%20they%20%2Ado%2A%20follow%20symlinks.%20So%20a%20user%20can%20drop%20two%0A%3E%20%3E%20symlinks%0A%3E%20%3E%20there%20while%20the%20daemon%20is%20running%20and%20overwrite%20any%20file%20on%20the%20file%0A%3E%20%3E%20system%20on%20shutdown.%0A%3E%20%3E%0A%3E%20%3E%20The%20fix%20would%20consist%20of%20passing%20to%20configure%20something%20like%0A%3E%20%3E%20%E2%80%9C--with-statedir%3D%2Fvar%2Fcache%2Frpcbind%E2%80%9D%2C%20and%20make%20sure%20the%20daemon%20creates%0A%3E%20%3E%20such%20directory%20if%20missing%20on%20exit%20in%20src%2Fwarmstart.c%3Awrite_struct%28%29%2C%0A%3E%20%3E%20which%20it%20does%20not%20seem%20to%20be%20doing%20currently.%0A%3E%20%3E%0A%3E%20%3E%20In%20addition%20it%20would%20be%20wise%20to%20notify%20upstream%20to%20change%20the%20default%0A%3E%20%3E%20statedir%20to%20something%20else%20than%20%2Ftmp.%0A%3E%20%3E%20%60---%0A%3E%20%0A%3E%20Agree%20changing%20the%20upstream%20default%20is%20a%20good%20idea.%0A%3E%20%0A%3E%20Generally%2C%20that%20kind%20of%20directory%20is%20created%20as%20part%20of%20installation%20%0A%3E%20%28like%2C%20by%20rpm%20--install%29%20rather%20than%20by%20the%20daemon%20itself.%0A%3E%20%0A%3E%20%3E%3E%20Would%20%2Fvar%2Frun%20%28or%20a%20subdirectory%20of%20it%29%20be%20a%20better%20choice%20than%20%2Ftmp%20%3F%0A%3E%20%3E%0A%3E%20%3E%20%2Fvar%2Frun%20might%20not%20be%20preserved%20across%20reboots%2C%20but%20regardless%20of%20that%20I%0A%3E%20%3E%20think%20%2Fvar%2Fcache%20is%20a%20better%20fit%2C%20it%27s%20internal%20state%2C%20but%20it%27s%20used%0A%3E%20%3E%20to%20speed%20up%20start%20up%20time%2C%20and%20can%20be%20removed%20w%2Fo%20ill%20effects.%0A%3E%20%0A%3E%20No%2C%20it%27s%20not%20intended%20to%20speed%20start%20up.%0A%3E%20%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=chuck.lever%40oracle.com" alt="">
<div class="header"><span class="headerfield">From:</span> Chuck Lever &lt;chuck.lever@oracle.com&gt;</div>
<div class="header"><span class="headerfield">To:</span> Guillem Jover &lt;guillem@debian.org&gt;</div>
<div class="header"><span class="headerfield">Cc:</span> linux-nfs@vger.kernel.org, 583435@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#583435: rpcbind: Insecure handling of state files</div>
<div class="header"><span class="headerfield">Date:</span> Thu, 03 Jun 2010 16:34:01 -0400</div>
</div>
<pre class="message flowed">On 06/ 3/10 04:27 PM, Guillem Jover wrote:
&gt; Hi!
&gt;
&gt; On Thu, 2010-06-03 at 16:07:50 -0400, Chuck Lever wrote:
&gt;&gt; On 06/ 2/10 07:25 AM, Aníbal Monsalve Salazar wrote:
&gt;&gt;&gt; On Tue, Jun 01, 2010 at 02:09:07PM +0200, Guillem Jover wrote:
&gt;&gt;&gt;&gt; On Thu, 2010-05-27 at 19:09:08 +0200, Guillem Jover wrote:
&gt;&gt;&gt;&gt;&gt; Package: rpcbind
&gt;&gt;&gt;&gt;&gt; Version: 0.2.0-4
&gt;&gt;&gt;&gt;&gt; Severity: serious
&gt;&gt;&gt;&gt;&gt; Tags: security
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; The rpcbind daemon, which runs as root, uses /tmp/portmap.xdr and
&gt;&gt;&gt;&gt;&gt; /tmp/rpcbind.xdr for doing warm starts as what seems to be a way to
&gt;&gt;&gt;&gt;&gt; preserve state between invokations. It parses (through libtirpc) and
&gt;&gt;&gt;&gt;&gt; removes them on start. It creates them before exiting.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; So first off, *any* user can craft those two files before the daemon
&gt;&gt;&gt;&gt;&gt; has started for the first time, which the daemon will parse. This
&gt;&gt;&gt;&gt;&gt; might be ok, depending on the checks done on parse, I&#39;d still be very
&gt;&gt;&gt;&gt;&gt; wary of letting a user be able to craft such files at will.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; It seems to be doing no checks whatsoever. A simple test I performed at
&gt;&gt;&gt;&gt; the time of filing this report, but didn&#39;t seem to have any obvious
&gt;&gt;&gt;&gt; consequence, shows this which I noticed later on:
&gt;
&gt;&gt;&gt; The original bug report is at <a href="http://bugs.debian.org/583435">http://bugs.debian.org/583435</a>
&gt;
&gt; I&#39;m adding here part of the initial mail that I trimmed when replying
&gt; to myself:
&gt;
&gt; ,---
&gt; The second problem is that those files get created by the daemon on
&gt; shutdown, and they *do* follow symlinks. So a user can drop two
&gt; symlinks
&gt; there while the daemon is running and overwrite any file on the file
&gt; system on shutdown.
&gt;
&gt; The fix would consist of passing to configure something like
&gt; “--with-statedir=/var/cache/rpcbind”, and make sure the daemon creates
&gt; such directory if missing on exit in src/warmstart.c:write_struct(),
&gt; which it does not seem to be doing currently.
&gt;
&gt; In addition it would be wise to notify upstream to change the default
&gt; statedir to something else than /tmp.
&gt; `---

Agree changing the upstream default is a good idea.

Generally, that kind of directory is created as part of installation 
(like, by rpm --install) rather than by the daemon itself.

&gt;&gt; Would /var/run (or a subdirectory of it) be a better choice than /tmp ?
&gt;
&gt; /var/run might not be preserved across reboots, but regardless of that I
&gt; think /var/cache is a better fit, it&#39;s internal state, but it&#39;s used
&gt; to speed up start up time, and can be removed w/o ill effects.

No, it&#39;s not intended to speed start up.

The cache files aren&#39;t really supposed to be retained over a reboot. 
After a system restart, all of the RPC services will restart and 
register themselves again.  If just rpcbind restarts, all that 
registration state is lost, so that&#39;s the point of saving it in a file.

I don&#39;t have a preference wrt /var/run or /var/cache.



</pre>

<div class="infmessage"><hr><p>
<a name="26"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Anibal Monsalve Salazar &lt;anibal@debian.org&gt; -->
<!-- time:1275599343 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Anibal Monsalve Salazar &lt;anibal@debian.org&gt;</code>:<br>
<code>Bug#583435</code>; Package <code>rpcbind</code>.
 (Thu, 03 Jun 2010 21:09:03 GMT) (<a href="bugreport.cgi?bug=583435;msg=27">full text</a>, <a href="bugreport.cgi?bug=583435;mbox=yes;msg=27">mbox</a>, <a href="#26">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="28"></a>
<!-- request_addr: Guillem Jover &lt;guillem@debian.org&gt; -->
<!-- time:1275599343 -->
<strong>Acknowledgement sent</strong>
to <code>Guillem Jover &lt;guillem@debian.org&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Anibal Monsalve Salazar &lt;anibal@debian.org&gt;</code>.
 (Thu, 03 Jun 2010 21:09:03 GMT) (<a href="bugreport.cgi?bug=583435;msg=29">full text</a>, <a href="bugreport.cgi?bug=583435;mbox=yes;msg=29">mbox</a>, <a href="#28">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="30"></a><a name="msg30"></a><a href="#30">Message #30</a> received at 583435@bugs.debian.org (<a href="bugreport.cgi?bug=583435;msg=30">full text</a>, <a href="bugreport.cgi?bug=583435;mbox=yes;msg=30">mbox</a>, <a href="mailto:583435@bugs.debian.org?body=On%20Thu%2C%203%20Jun%202010%2023%3A07%3A07%20%2B0200%20Guillem%20Jover%20%3Cguillem%40debian.org%3E%20wrote%3A%0A%3E%20On%20Thu%2C%202010-06-03%20at%2016%3A34%3A01%20-0400%2C%20Chuck%20Lever%20wrote%3A%0A%3E%20%3E%20On%2006%2F%203%2F10%2004%3A27%20PM%2C%20Guillem%20Jover%20wrote%3A%0A%3E%20%3E%20%3EThe%20second%20problem%20is%20that%20those%20files%20get%20created%20by%20the%20daemon%20on%0A%3E%20%3E%20%3Eshutdown%2C%20and%20they%20%2Ado%2A%20follow%20symlinks.%20So%20a%20user%20can%20drop%20two%0A%3E%20%3E%20%3Esymlinks%0A%3E%20%3E%20%3Ethere%20while%20the%20daemon%20is%20running%20and%20overwrite%20any%20file%20on%20the%20file%0A%3E%20%3E%20%3Esystem%20on%20shutdown.%0A%3E%20%3E%20%3E%0A%3E%20%3E%20%3EThe%20fix%20would%20consist%20of%20passing%20to%20configure%20something%20like%0A%3E%20%3E%20%3E%E2%80%9C--with-statedir%3D%2Fvar%2Fcache%2Frpcbind%E2%80%9D%2C%20and%20make%20sure%20the%20daemon%20creates%0A%3E%20%3E%20%3Esuch%20directory%20if%20missing%20on%20exit%20in%20src%2Fwarmstart.c%3Awrite_struct%28%29%2C%0A%3E%20%3E%20%3Ewhich%20it%20does%20not%20seem%20to%20be%20doing%20currently.%0A%3E%20%3E%20%3E%0A%3E%20%3E%20%3EIn%20addition%20it%20would%20be%20wise%20to%20notify%20upstream%20to%20change%20the%20default%0A%3E%20%3E%20%3Estatedir%20to%20something%20else%20than%20%2Ftmp.%0A%3E%20%3E%20%0A%3E%20%3E%20Agree%20changing%20the%20upstream%20default%20is%20a%20good%20idea.%0A%3E%20%3E%20%0A%3E%20%3E%20Generally%2C%20that%20kind%20of%20directory%20is%20created%20as%20part%20of%20installation%0A%3E%20%3E%20%28like%2C%20by%20rpm%20--install%29%20rather%20than%20by%20the%20daemon%20itself.%0A%3E%20%0A%3E%20At%20least%20for%20%2Fvar%2Frun%20I%20think%20it%27s%20common%20for%20systems%20to%20mount%20it%0A%3E%20as%20tmpfs%2C%20so%20the%20directories%20might%20not%20be%20there%20on%20boot.%20But%20those%20can%0A%3E%20always%20be%20created%20by%20the%20init%20script%20%28or%20equivalent%29%2C%20it%20might%20be%20a%0A%3E%20problem%20if%20run%20from%20inetd%20though.%0A%3E%20%0A%3E%20%3E%20%3E%3EWould%20%2Fvar%2Frun%20%28or%20a%20subdirectory%20of%20it%29%20be%20a%20better%20choice%20than%20%2Ftmp%20%3F%0A%3E%20%3E%20%3E%0A%3E%20%3E%20%3E%2Fvar%2Frun%20might%20not%20be%20preserved%20across%20reboots%2C%20but%20regardless%20of%20that%20I%0A%3E%20%3E%20%3Ethink%20%2Fvar%2Fcache%20is%20a%20better%20fit%2C%20it%27s%20internal%20state%2C%20but%20it%27s%20used%0A%3E%20%3E%20%3Eto%20speed%20up%20start%20up%20time%2C%20and%20can%20be%20removed%20w%2Fo%20ill%20effects.%0A%3E%20%3E%20%0A%3E%20%3E%20No%2C%20it%27s%20not%20intended%20to%20speed%20start%20up.%0A%3E%20%3E%20%0A%3E%20%3E%20The%20cache%20files%20aren%27t%20really%20supposed%20to%20be%20retained%20over%20a%20reboot.%0A%3E%20%3E%20After%20a%20system%20restart%2C%20all%20of%20the%20RPC%20services%20will%20restart%20and%0A%3E%20%3E%20register%20themselves%20again.%20%20If%20just%20rpcbind%20restarts%2C%20all%20that%0A%3E%20%3E%20registration%20state%20is%20lost%2C%20so%20that%27s%20the%20point%20of%20saving%20it%20in%20a%0A%3E%20%3E%20file.%0A%3E%20%0A%3E%20Ah%2C%20yeah%20that%20makes%20more%20sense%21%20More%20so%20given%20the%20configure%20option%2C%20I%0A%3E%20should%20have%20written%20%22AFAIS%22%20or%20something%20like%20that.%20%3A%29%0A%3E%20%0A%3E%20%3E%20I%20don%27t%20have%20a%20preference%20wrt%20%2Fvar%2Frun%20or%20%2Fvar%2Fcache.%0A%3E%20%0A%3E%20So%20given%20that%20this%20is%20actually%20run%20time%20state%2C%20%2Fvar%2Frun%20seems%20more%0A%3E%20appropriate%2C%20indeed.%0A%3E%20%0A%3E%20regards%2C%0A%3E%20guillem%0A%3E%20%0A%3E%20%0A%3E%20%0A&amp;References=%3C20100527170908.GA14298%40gaara.hadrons.org%3E%0A%20%3C20100601120907.GA23357%40gaara.hadrons.org%3E%0A%20%3C20100602112520.GA22639%40master.debian.org%3E%0A%20%3C4C080B96.1030707%40oracle.com%3E%0A%20%3C20100603202743.GA6643%40gaara.hadrons.org%3E%0A%20%3C4C0811B9.3060809%40oracle.com%3E%0A%20%3C20100603210707.GA7377%40gaara.hadrons.org%3E&amp;subject=Re%3A%20Bug%23583435%3A%20rpcbind%3A%20Insecure%20handling%20of%20state%20files&amp;In-Reply-To=%3C20100603210707.GA7377%40gaara.hadrons.org%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=guillem%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Guillem Jover &lt;guillem@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> Chuck Lever &lt;chuck.lever@oracle.com&gt;</div>
<div class="header"><span class="headerfield">Cc:</span> linux-nfs@vger.kernel.org, 583435@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#583435: rpcbind: Insecure handling of state files</div>
<div class="header"><span class="headerfield">Date:</span> Thu, 3 Jun 2010 23:07:07 +0200</div>
</div>
<pre class="message">On Thu, 2010-06-03 at 16:34:01 -0400, Chuck Lever wrote:
&gt; On 06/ 3/10 04:27 PM, Guillem Jover wrote:
&gt; &gt;The second problem is that those files get created by the daemon on
&gt; &gt;shutdown, and they *do* follow symlinks. So a user can drop two
&gt; &gt;symlinks
&gt; &gt;there while the daemon is running and overwrite any file on the file
&gt; &gt;system on shutdown.
&gt; &gt;
&gt; &gt;The fix would consist of passing to configure something like
&gt; &gt;“--with-statedir=/var/cache/rpcbind”, and make sure the daemon creates
&gt; &gt;such directory if missing on exit in src/warmstart.c:write_struct(),
&gt; &gt;which it does not seem to be doing currently.
&gt; &gt;
&gt; &gt;In addition it would be wise to notify upstream to change the default
&gt; &gt;statedir to something else than /tmp.
&gt; 
&gt; Agree changing the upstream default is a good idea.
&gt; 
&gt; Generally, that kind of directory is created as part of installation
&gt; (like, by rpm --install) rather than by the daemon itself.

At least for /var/run I think it&#39;s common for systems to mount it
as tmpfs, so the directories might not be there on boot. But those can
always be created by the init script (or equivalent), it might be a
problem if run from inetd though.

&gt; &gt;&gt;Would /var/run (or a subdirectory of it) be a better choice than /tmp ?
&gt; &gt;
&gt; &gt;/var/run might not be preserved across reboots, but regardless of that I
&gt; &gt;think /var/cache is a better fit, it&#39;s internal state, but it&#39;s used
&gt; &gt;to speed up start up time, and can be removed w/o ill effects.
&gt; 
&gt; No, it&#39;s not intended to speed start up.
&gt; 
&gt; The cache files aren&#39;t really supposed to be retained over a reboot.
&gt; After a system restart, all of the RPC services will restart and
&gt; register themselves again.  If just rpcbind restarts, all that
&gt; registration state is lost, so that&#39;s the point of saving it in a
&gt; file.

Ah, yeah that makes more sense! More so given the configure option, I
should have written &quot;AFAIS&quot; or something like that. :)

&gt; I don&#39;t have a preference wrt /var/run or /var/cache.

So given that this is actually run time state, /var/run seems more
appropriate, indeed.

regards,
guillem



</pre>

<div class="infmessage"><hr><p>
<a name="31"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Anibal Monsalve Salazar &lt;anibal@debian.org&gt; -->
<!-- time:1275599702 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Anibal Monsalve Salazar &lt;anibal@debian.org&gt;</code>:<br>
<code>Bug#583435</code>; Package <code>rpcbind</code>.
 (Thu, 03 Jun 2010 21:15:02 GMT) (<a href="bugreport.cgi?bug=583435;msg=32">full text</a>, <a href="bugreport.cgi?bug=583435;mbox=yes;msg=32">mbox</a>, <a href="#31">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="33"></a>
<!-- request_addr: Chuck Lever &lt;chuck.lever@oracle.com&gt; -->
<!-- time:1275599702 -->
<strong>Acknowledgement sent</strong>
to <code>Chuck Lever &lt;chuck.lever@oracle.com&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Anibal Monsalve Salazar &lt;anibal@debian.org&gt;</code>.
 (Thu, 03 Jun 2010 21:15:02 GMT) (<a href="bugreport.cgi?bug=583435;msg=34">full text</a>, <a href="bugreport.cgi?bug=583435;mbox=yes;msg=34">mbox</a>, <a href="#33">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="35"></a><a name="msg35"></a><a href="#35">Message #35</a> received at 583435@bugs.debian.org (<a href="bugreport.cgi?bug=583435;msg=35">full text</a>, <a href="bugreport.cgi?bug=583435;mbox=yes;msg=35">mbox</a>, <a href="mailto:583435@bugs.debian.org?References=%3C20100527170908.GA14298%40gaara.hadrons.org%3E%20%3C20100601120907.GA23357%40gaara.hadrons.org%3E%20%3C20100602112520.GA22639%40master.debian.org%3E%20%3C4C080B96.1030707%40oracle.com%3E%20%3C20100603202743.GA6643%40gaara.hadrons.org%3E%20%3C4C0811B9.3060809%40oracle.com%3E%20%3C20100603210707.GA7377%40gaara.hadrons.org%3E%0A%20%3C4C081A6E.5020406%40oracle.com%3E&amp;subject=Re%3A%20Bug%23583435%3A%20rpcbind%3A%20Insecure%20handling%20of%20state%20files&amp;In-Reply-To=%3C4C081A6E.5020406%40oracle.com%3E&amp;body=On%20Thu%2C%2003%20Jun%202010%2017%3A11%3A10%20-0400%20Chuck%20Lever%20%3Cchuck.lever%40oracle.com%3E%20wrote%3A%0A%3E%20On%2006%2F%203%2F10%2005%3A07%20PM%2C%20Guillem%20Jover%20wrote%3A%0A%3E%20%3E%20On%20Thu%2C%202010-06-03%20at%2016%3A34%3A01%20-0400%2C%20Chuck%20Lever%20wrote%3A%0A%3E%20%3E%3E%20On%2006%2F%203%2F10%2004%3A27%20PM%2C%20Guillem%20Jover%20wrote%3A%0A%3E%20%3E%3E%3E%20The%20second%20problem%20is%20that%20those%20files%20get%20created%20by%20the%20daemon%20on%0A%3E%20%3E%3E%3E%20shutdown%2C%20and%20they%20%2Ado%2A%20follow%20symlinks.%20So%20a%20user%20can%20drop%20two%0A%3E%20%3E%3E%3E%20symlinks%0A%3E%20%3E%3E%3E%20there%20while%20the%20daemon%20is%20running%20and%20overwrite%20any%20file%20on%20the%20file%0A%3E%20%3E%3E%3E%20system%20on%20shutdown.%0A%3E%20%3E%3E%3E%0A%3E%20%3E%3E%3E%20The%20fix%20would%20consist%20of%20passing%20to%20configure%20something%20like%0A%3E%20%3E%3E%3E%20%E2%80%9C--with-statedir%3D%2Fvar%2Fcache%2Frpcbind%E2%80%9D%2C%20and%20make%20sure%20the%20daemon%20creates%0A%3E%20%3E%3E%3E%20such%20directory%20if%20missing%20on%20exit%20in%20src%2Fwarmstart.c%3Awrite_struct%28%29%2C%0A%3E%20%3E%3E%3E%20which%20it%20does%20not%20seem%20to%20be%20doing%20currently.%0A%3E%20%3E%3E%3E%0A%3E%20%3E%3E%3E%20In%20addition%20it%20would%20be%20wise%20to%20notify%20upstream%20to%20change%20the%20default%0A%3E%20%3E%3E%3E%20statedir%20to%20something%20else%20than%20%2Ftmp.%0A%3E%20%3E%3E%0A%3E%20%3E%3E%20Agree%20changing%20the%20upstream%20default%20is%20a%20good%20idea.%0A%3E%20%3E%3E%0A%3E%20%3E%3E%20Generally%2C%20that%20kind%20of%20directory%20is%20created%20as%20part%20of%20installation%0A%3E%20%3E%3E%20%28like%2C%20by%20rpm%20--install%29%20rather%20than%20by%20the%20daemon%20itself.%0A%3E%20%3E%0A%3E%20%3E%20At%20least%20for%20%2Fvar%2Frun%20I%20think%20it%27s%20common%20for%20systems%20to%20mount%20it%0A%3E%20%3E%20as%20tmpfs%2C%20so%20the%20directories%20might%20not%20be%20there%20on%20boot.%20But%20those%20can%0A%3E%20%3E%20always%20be%20created%20by%20the%20init%20script%20%28or%20equivalent%29%2C%20it%20might%20be%20a%0A%3E%20%3E%20problem%20if%20run%20from%20inetd%20though.%0A%3E%20%0A%3E%20Sure%2C%20that%20makes%20sense.%20%20Having%20the%20daemon%20create%20the%20directory%20also%20%0A%3E%20means%20there%20are%20fewer%20ways%20distributors%20can%20get%20this%20wrong.%0A%3E%20%0A%3E%20%3E%3E%3E%3E%20Would%20%2Fvar%2Frun%20%28or%20a%20subdirectory%20of%20it%29%20be%20a%20better%20choice%20than%20%2Ftmp%20%3F%0A%3E%20%3E%3E%3E%0A%3E%20%3E%3E%3E%20%2Fvar%2Frun%20might%20not%20be%20preserved%20across%20reboots%2C%20but%20regardless%20of%20that%20I%0A%3E%20%3E%3E%3E%20think%20%2Fvar%2Fcache%20is%20a%20better%20fit%2C%20it%27s%20internal%20state%2C%20but%20it%27s%20used%0A%3E%20%3E%3E%3E%20to%20speed%20up%20start%20up%20time%2C%20and%20can%20be%20removed%20w%2Fo%20ill%20effects.%0A%3E%20%3E%3E%0A%3E%20%3E%3E%20No%2C%20it%27s%20not%20intended%20to%20speed%20start%20up.%0A%3E%20%3E%3E%0A%3E%20%3E%3E%20The%20cache%20files%20aren%27t%20really%20supposed%20to%20be%20retained%20over%20a%20reboot.%0A%3E%20%3E%3E%20After%20a%20system%20restart%2C%20all%20of%20the%20RPC%20services%20will%20restart%20and%0A%3E%20%3E%3E%20register%20themselves%20again.%20%20If%20just%20rpcbind%20restarts%2C%20all%20that%0A%3E%20%3E%3E%20registration%20state%20is%20lost%2C%20so%20that%27s%20the%20point%20of%20saving%20it%20in%20a%0A%3E%20%3E%3E%20file.%0A%3E%20%3E%0A%3E%20%3E%20Ah%2C%20yeah%20that%20makes%20more%20sense%21%20More%20so%20given%20the%20configure%20option%2C%20I%0A%3E%20%3E%20should%20have%20written%20%22AFAIS%22%20or%20something%20like%20that.%20%3A%29%0A%3E%20%3E%0A%3E%20%3E%3E%20I%20don%27t%20have%20a%20preference%20wrt%20%2Fvar%2Frun%20or%20%2Fvar%2Fcache.%0A%3E%20%3E%0A%3E%20%3E%20So%20given%20that%20this%20is%20actually%20run%20time%20state%2C%20%2Fvar%2Frun%20seems%20more%0A%3E%20%3E%20appropriate%2C%20indeed.%0A%3E%20%0A%3E%20%0A%3E%20%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=chuck.lever%40oracle.com" alt="">
<div class="header"><span class="headerfield">From:</span> Chuck Lever &lt;chuck.lever@oracle.com&gt;</div>
<div class="header"><span class="headerfield">To:</span> Guillem Jover &lt;guillem@debian.org&gt;</div>
<div class="header"><span class="headerfield">Cc:</span> linux-nfs@vger.kernel.org, 583435@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#583435: rpcbind: Insecure handling of state files</div>
<div class="header"><span class="headerfield">Date:</span> Thu, 03 Jun 2010 17:11:10 -0400</div>
</div>
<pre class="message flowed">On 06/ 3/10 05:07 PM, Guillem Jover wrote:
&gt; On Thu, 2010-06-03 at 16:34:01 -0400, Chuck Lever wrote:
&gt;&gt; On 06/ 3/10 04:27 PM, Guillem Jover wrote:
&gt;&gt;&gt; The second problem is that those files get created by the daemon on
&gt;&gt;&gt; shutdown, and they *do* follow symlinks. So a user can drop two
&gt;&gt;&gt; symlinks
&gt;&gt;&gt; there while the daemon is running and overwrite any file on the file
&gt;&gt;&gt; system on shutdown.
&gt;&gt;&gt;
&gt;&gt;&gt; The fix would consist of passing to configure something like
&gt;&gt;&gt; “--with-statedir=/var/cache/rpcbind”, and make sure the daemon creates
&gt;&gt;&gt; such directory if missing on exit in src/warmstart.c:write_struct(),
&gt;&gt;&gt; which it does not seem to be doing currently.
&gt;&gt;&gt;
&gt;&gt;&gt; In addition it would be wise to notify upstream to change the default
&gt;&gt;&gt; statedir to something else than /tmp.
&gt;&gt;
&gt;&gt; Agree changing the upstream default is a good idea.
&gt;&gt;
&gt;&gt; Generally, that kind of directory is created as part of installation
&gt;&gt; (like, by rpm --install) rather than by the daemon itself.
&gt;
&gt; At least for /var/run I think it&#39;s common for systems to mount it
&gt; as tmpfs, so the directories might not be there on boot. But those can
&gt; always be created by the init script (or equivalent), it might be a
&gt; problem if run from inetd though.

Sure, that makes sense.  Having the daemon create the directory also 
means there are fewer ways distributors can get this wrong.

&gt;&gt;&gt;&gt; Would /var/run (or a subdirectory of it) be a better choice than /tmp ?
&gt;&gt;&gt;
&gt;&gt;&gt; /var/run might not be preserved across reboots, but regardless of that I
&gt;&gt;&gt; think /var/cache is a better fit, it&#39;s internal state, but it&#39;s used
&gt;&gt;&gt; to speed up start up time, and can be removed w/o ill effects.
&gt;&gt;
&gt;&gt; No, it&#39;s not intended to speed start up.
&gt;&gt;
&gt;&gt; The cache files aren&#39;t really supposed to be retained over a reboot.
&gt;&gt; After a system restart, all of the RPC services will restart and
&gt;&gt; register themselves again.  If just rpcbind restarts, all that
&gt;&gt; registration state is lost, so that&#39;s the point of saving it in a
&gt;&gt; file.
&gt;
&gt; Ah, yeah that makes more sense! More so given the configure option, I
&gt; should have written &quot;AFAIS&quot; or something like that. :)
&gt;
&gt;&gt; I don&#39;t have a preference wrt /var/run or /var/cache.
&gt;
&gt; So given that this is actually run time state, /var/run seems more
&gt; appropriate, indeed.



</pre>

<div class="infmessage"><hr><p>
<a name="36"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Anibal Monsalve Salazar &lt;anibal@debian.org&gt; -->
<!-- time:1275600602 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Anibal Monsalve Salazar &lt;anibal@debian.org&gt;</code>:<br>
<code>Bug#583435</code>; Package <code>rpcbind</code>.
 (Thu, 03 Jun 2010 21:30:02 GMT) (<a href="bugreport.cgi?bug=583435;msg=37">full text</a>, <a href="bugreport.cgi?bug=583435;mbox=yes;msg=37">mbox</a>, <a href="#36">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="38"></a>
<!-- request_addr: Chuck Lever &lt;chuck.lever@oracle.com&gt; -->
<!-- time:1275600603 -->
<strong>Acknowledgement sent</strong>
to <code>Chuck Lever &lt;chuck.lever@oracle.com&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Anibal Monsalve Salazar &lt;anibal@debian.org&gt;</code>.
 (Thu, 03 Jun 2010 21:30:03 GMT) (<a href="bugreport.cgi?bug=583435;msg=39">full text</a>, <a href="bugreport.cgi?bug=583435;mbox=yes;msg=39">mbox</a>, <a href="#38">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="40"></a><a name="msg40"></a><a href="#40">Message #40</a> received at 583435@bugs.debian.org (<a href="bugreport.cgi?bug=583435;msg=40">full text</a>, <a href="bugreport.cgi?bug=583435;mbox=yes;msg=40">mbox</a>, <a href="mailto:583435@bugs.debian.org?In-Reply-To=%3C4C080B96.1030707%40oracle.com%3E&amp;subject=Re%3A%20Bug%23583435%3A%20rpcbind%3A%20Insecure%20handling%20of%20state%20files&amp;References=%3C20100527170908.GA14298%40gaara.hadrons.org%3E%20%3C20100601120907.GA23357%40gaara.hadrons.org%3E%20%3C20100602112520.GA22639%40master.debian.org%3E%0A%20%3C4C080B96.1030707%40oracle.com%3E&amp;body=On%20Thu%2C%2003%20Jun%202010%2016%3A07%3A50%20-0400%20Chuck%20Lever%20%3Cchuck.lever%40oracle.com%3E%20wrote%3A%0A%3E%20On%2006%2F%202%2F10%2007%3A25%20AM%2C%20An%C3%ADbal%20Monsalve%20Salazar%20wrote%3A%0A%3E%20%3E%20On%20Tue%2C%20Jun%2001%2C%202010%20at%2002%3A09%3A07PM%20%2B0200%2C%20Guillem%20Jover%20wrote%3A%0A%3E%20%3E%3E%20Hi%21%0A%3E%20%3E%3E%0A%3E%20%3E%3E%20On%20Thu%2C%202010-05-27%20at%2019%3A09%3A08%20%2B0200%2C%20Guillem%20Jover%20wrote%3A%0A%3E%20%3E%3E%3E%20Package%3A%20rpcbind%0A%3E%20%3E%3E%3E%20Version%3A%200.2.0-4%0A%3E%20%3E%3E%3E%20Severity%3A%20serious%0A%3E%20%3E%3E%3E%20Tags%3A%20security%0A%3E%20%3E%3E%0A%3E%20%3E%3E%3E%20The%20rpcbind%20daemon%2C%20which%20runs%20as%20root%2C%20uses%20%2Ftmp%2Fportmap.xdr%20and%0A%3E%20%3E%3E%3E%20%2Ftmp%2Frpcbind.xdr%20for%20doing%20warm%20starts%20as%20what%20seems%20to%20be%20a%20way%20to%0A%3E%20%3E%3E%3E%20preserve%20state%20between%20invokations.%20It%20parses%20%28through%20libtirpc%29%20and%0A%3E%20%3E%3E%3E%20removes%20them%20on%20start.%20It%20creates%20them%20before%20exiting.%0A%3E%20%3E%3E%3E%0A%3E%20%3E%3E%3E%20So%20first%20off%2C%20%2Aany%2A%20user%20can%20craft%20those%20two%20files%20before%20the%20daemon%0A%3E%20%3E%3E%3E%20has%20started%20for%20the%20first%20time%2C%20which%20the%20daemon%20will%20parse.%20This%0A%3E%20%3E%3E%3E%20might%20be%20ok%2C%20depending%20on%20the%20checks%20done%20on%20parse%2C%20I%27d%20still%20be%20very%0A%3E%20%3E%3E%3E%20wary%20of%20letting%20a%20user%20be%20able%20to%20craft%20such%20files%20at%20will.%0A%3E%20%3E%3E%0A%3E%20%3E%3E%20It%20seems%20to%20be%20doing%20no%20checks%20whatsoever.%20A%20simple%20test%20I%20performed%20at%0A%3E%20%3E%3E%20the%20time%20of%20filing%20this%20report%2C%20but%20didn%27t%20seem%20to%20have%20any%20obvious%0A%3E%20%3E%3E%20consequence%2C%20shows%20this%20which%20I%20noticed%20later%20on%3A%0A%3E%20%3E%3E%0A%3E%20%3E%3E%20%2C---%0A%3E%20%3E%3E%20gaara%3A~%23%20%2Fetc%2Finit.d%2Frpcbind%20start%0A%3E%20%3E%3E%20Starting%20rpcbind%20daemon....%0A%3E%20%3E%3E%20gaara%3A~%23%20ps%20axuOp%7Cegrep%20%27%28%5EUSER%7C%5Br%5Dpcbind%29%27%0A%3E%20%3E%3E%20USER%20%20%20%20%20%20%20PID%20%25CPU%20%25MEM%20%20%20%20VSZ%20%20%20RSS%20TTY%20%20%20%20%20%20STAT%20START%20%20%20TIME%20COMMAND%0A%3E%20%3E%3E%20root%20%20%20%20%2023424%20%200.0%20%200.0%20%2018768%20%20%20704%20%3F%20%20%20%20%20%20%20%20Ss%20%20%2013%3A53%20%20%200%3A00%20%2Fsbin%2Frpcbind%20-w%0A%3E%20%3E%3E%20gaara%3A~%23%20%2Fetc%2Finit.d%2Frpcbind%20stop%0A%3E%20%3E%3E%20Stopping%20rpcbind%20daemon....%0A%3E%20%3E%3E%20gaara%3A~%23%20dd%20if%3D%2Fdev%2Furandom%20of%3D%2Ftmp%2Frpcbind.xdr%20bs%3D1024%20count%3D1%0A%3E%20%3E%3E%201%2B0%20records%20in%0A%3E%20%3E%3E%201%2B0%20records%20out%0A%3E%20%3E%3E%201024%20bytes%20%281%2C0%20kB%29%20copied%2C%200%2C000861307%20s%2C%201%2C2%20MB%2Fs%0A%3E%20%3E%3E%20gaara%3A~%23%20%2Fetc%2Finit.d%2Frpcbind%20start%0A%3E%20%3E%3E%20Starting%20rpcbind%20daemon....%0A%3E%20%3E%3E%20gaara%3A~%23%20ps%20axuOp%7Cegrep%20%27%28%5EUSER%7C%5Br%5Dpcbind%29%27%0A%3E%20%3E%3E%20USER%20%20%20%20%20%20%20PID%20%25CPU%20%25MEM%20%20%20%20VSZ%20%20%20RSS%20TTY%20%20%20%20%20%20STAT%20START%20%20%20TIME%20COMMAND%0A%3E%20%3E%3E%20root%20%20%20%20%2023440%20%200.0%20%200.0%204008972%20%20772%20%3F%20%20%20%20%20%20%20%20Ss%20%20%2013%3A54%20%20%200%3A00%20%2Fsbin%2Frpcbind%20-w%0A%3E%20%3E%3E%20%60---%0A%3E%20%3E%3E%0A%3E%20%3E%3E%20The%20first%20start%20is%20a%20normal%20clean%20invokation%2C%20the%20second%20one%20is%20using%0A%3E%20%3E%3E%20the%20crafted%20file.%20See%20how%20it%20has%20allocated%20almost%204%20GiB.%20Disregard%20though%2C%0A%3E%20%3E%3E%20me%20running%20all%20this%20as%20root%2C%20a%20user%20would%20be%20able%20to%20craft%20those%20files%20as%0A%3E%20%3E%3E%20long%20as%20they%20were%20not%20already%20in%20%2Ftmp.%0A%3E%20%3E%3E%0A%3E%20%3E%3E%20thanks%2C%0A%3E%20%3E%3E%20guillem%0A%3E%20%3E%0A%3E%20%3E%20I%27m%20sending%20this%20bug%20report%20to%20the%20linux-nfs%20mailing%20list.%0A%3E%20%3E%0A%3E%20%3E%20The%20original%20bug%20report%20is%20at%20http%3A%2F%2Fbugs.debian.org%2F583435%0A%3E%20%0A%3E%20Would%20%2Fvar%2Frun%20%28or%20a%20subdirectory%20of%20it%29%20be%20a%20better%20choice%20than%20%2Ftmp%20%3F%0A%3E%20%0A%3E%20%0A%3E%20%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=chuck.lever%40oracle.com" alt="">
<div class="header"><span class="headerfield">From:</span> Chuck Lever &lt;chuck.lever@oracle.com&gt;</div>
<div class="header"><span class="headerfield">To:</span> linux-nfs@vger.kernel.org, Guillem Jover &lt;guillem@debian.org&gt;,
        583435@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#583435: rpcbind: Insecure handling of state files</div>
<div class="header"><span class="headerfield">Date:</span> Thu, 03 Jun 2010 16:07:50 -0400</div>
</div>
<pre class="message flowed">On 06/ 2/10 07:25 AM, Aníbal Monsalve Salazar wrote:
&gt; On Tue, Jun 01, 2010 at 02:09:07PM +0200, Guillem Jover wrote:
&gt;&gt; Hi!
&gt;&gt;
&gt;&gt; On Thu, 2010-05-27 at 19:09:08 +0200, Guillem Jover wrote:
&gt;&gt;&gt; Package: rpcbind
&gt;&gt;&gt; Version: 0.2.0-4
&gt;&gt;&gt; Severity: serious
&gt;&gt;&gt; Tags: security
&gt;&gt;
&gt;&gt;&gt; The rpcbind daemon, which runs as root, uses /tmp/portmap.xdr and
&gt;&gt;&gt; /tmp/rpcbind.xdr for doing warm starts as what seems to be a way to
&gt;&gt;&gt; preserve state between invokations. It parses (through libtirpc) and
&gt;&gt;&gt; removes them on start. It creates them before exiting.
&gt;&gt;&gt;
&gt;&gt;&gt; So first off, *any* user can craft those two files before the daemon
&gt;&gt;&gt; has started for the first time, which the daemon will parse. This
&gt;&gt;&gt; might be ok, depending on the checks done on parse, I&#39;d still be very
&gt;&gt;&gt; wary of letting a user be able to craft such files at will.
&gt;&gt;
&gt;&gt; It seems to be doing no checks whatsoever. A simple test I performed at
&gt;&gt; the time of filing this report, but didn&#39;t seem to have any obvious
&gt;&gt; consequence, shows this which I noticed later on:
&gt;&gt;
&gt;&gt; ,---
&gt;&gt; gaara:~# /etc/init.d/rpcbind start
&gt;&gt; Starting rpcbind daemon....
&gt;&gt; gaara:~# ps axuOp|egrep &#39;(^USER|[r]pcbind)&#39;
&gt;&gt; USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
&gt;&gt; root     23424  0.0  0.0  18768   704 ?        Ss   13:53   0:00 /sbin/rpcbind -w
&gt;&gt; gaara:~# /etc/init.d/rpcbind stop
&gt;&gt; Stopping rpcbind daemon....
&gt;&gt; gaara:~# dd if=/dev/urandom of=/tmp/rpcbind.xdr bs=1024 count=1
&gt;&gt; 1+0 records in
&gt;&gt; 1+0 records out
&gt;&gt; 1024 bytes (1,0 kB) copied, 0,000861307 s, 1,2 MB/s
&gt;&gt; gaara:~# /etc/init.d/rpcbind start
&gt;&gt; Starting rpcbind daemon....
&gt;&gt; gaara:~# ps axuOp|egrep &#39;(^USER|[r]pcbind)&#39;
&gt;&gt; USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
&gt;&gt; root     23440  0.0  0.0 4008972  772 ?        Ss   13:54   0:00 /sbin/rpcbind -w
&gt;&gt; `---
&gt;&gt;
&gt;&gt; The first start is a normal clean invokation, the second one is using
&gt;&gt; the crafted file. See how it has allocated almost 4 GiB. Disregard though,
&gt;&gt; me running all this as root, a user would be able to craft those files as
&gt;&gt; long as they were not already in /tmp.
&gt;&gt;
&gt;&gt; thanks,
&gt;&gt; guillem
&gt;
&gt; I&#39;m sending this bug report to the linux-nfs mailing list.
&gt;
&gt; The original bug report is at <a href="http://bugs.debian.org/583435">http://bugs.debian.org/583435</a>

Would /var/run (or a subdirectory of it) be a better choice than /tmp ?



</pre>

<div class="infmessage"><hr><p>
<a name="41"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Anibal Monsalve Salazar &lt;anibal@debian.org&gt; -->
<!-- time:1275879603 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Anibal Monsalve Salazar &lt;anibal@debian.org&gt;</code>:<br>
<code>Bug#583435</code>; Package <code>rpcbind</code>.
 (Mon, 07 Jun 2010 03:00:03 GMT) (<a href="bugreport.cgi?bug=583435;msg=42">full text</a>, <a href="bugreport.cgi?bug=583435;mbox=yes;msg=42">mbox</a>, <a href="#41">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="43"></a>
<!-- request_addr: Josh Bressers &lt;bressers@redhat.com&gt; -->
<!-- time:1275879603 -->
<strong>Acknowledgement sent</strong>
to <code>Josh Bressers &lt;bressers@redhat.com&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Anibal Monsalve Salazar &lt;anibal@debian.org&gt;</code>.
 (Mon, 07 Jun 2010 03:00:03 GMT) (<a href="bugreport.cgi?bug=583435;msg=44">full text</a>, <a href="bugreport.cgi?bug=583435;mbox=yes;msg=44">mbox</a>, <a href="#43">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="45"></a><a name="msg45"></a><a href="#45">Message #45</a> received at 583435@bugs.debian.org (<a href="bugreport.cgi?bug=583435;msg=45">full text</a>, <a href="bugreport.cgi?bug=583435;mbox=yes;msg=45">mbox</a>, <a href="mailto:583435@bugs.debian.org?body=On%20Fri%2C%204%20Jun%202010%2015%3A39%3A57%20-0400%20%28EDT%29%20Josh%20Bressers%20%3Cbressers%40redhat.com%3E%20wrote%3A%0A%3E%20Please%20use%20CVE-2010-2061%20for%20this.%0A%3E%20%0A%3E%20Thanks.%0A%3E%20%0A%3E%20--%20%0A%3E%20%20%20%20%20JB%0A%3E%20%0A%3E%20%0A%3E%20-----%20%22Jan%20Lieskovsky%22%20%3Cjlieskov%40redhat.com%3E%20wrote%3A%0A%3E%20%0A%3E%20%3E%20Hi%20Steve%2C%20vendors%2C%0A%3E%20%3E%20%0A%3E%20%3E%20%20%20%20Guillem%20Jover%20pointed%20out%3A%0A%3E%20%3E%20%20%20%20%5B1%5D%20http%3A%2F%2Fbugs.debian.org%2Fcgi-bin%2Fbugreport.cgi%3Fbug%3D583435%235%0A%3E%20%3E%20%0A%3E%20%3E%20a%20deficiency%20in%20the%20way%20rpcbind%20gathered%20%2F%20saved%20registrations%20from%20%2F%0A%3E%20%3E%20to%0A%3E%20%3E%20dumped%20file%28s%29.%20A%20local%20attacker%20could%20use%20this%20flaw%20to%20conduct%0A%3E%20%3E%20symbolic%0A%3E%20%3E%20link%20attacks%2C%20leading%20to%20un-authorized%20disclosure%20of%20sensitive%0A%3E%20%3E%20information%0A%3E%20%3E%20and%20%2F%20or%20to%20important%20system%20files%20data%20integrity%20corruption.%0A%3E%20%3E%20%0A%3E%20%3E%20References%3A%0A%3E%20%3E%20%20%20%20%5B2%5D%20https%3A%2F%2Fbugzilla.redhat.com%2Fshow_bug.cgi%3Fid%3D599697%0A%3E%20%3E%20%20%20%20%5B3%5D%20http%3A%2F%2Fbugs.debian.org%2Fcgi-bin%2Fbugreport.cgi%3Fbug%3D583435%2315%0A%3E%20%3E%20%0A%3E%20%3E%20Could%20you%20allocate%20CVE%20id%20for%20this%3F%0A%3E%20%3E%20%0A%3E%20%3E%20Thanks%20%26%26%20Regards%2C%20Jan.%0A%3E%20%3E%20--%0A%3E%20%3E%20Jan%20iankko%20Lieskovsky%20%2F%20Red%20Hat%20Security%20Response%20Team%0A%3E%20%0A%3E%20%0A%3E%20%0A&amp;References=%3C1635693818.1200701275680397128.JavaMail.root%40zmail01.collab.prod.int.phx2.redhat.com%3E&amp;subject=Re%3A%20%5Boss-security%5D%20CVE%20Request%20--%20rpcbind%20--%20Insecure%20%28predictable%29%0A%20temporary%20file%20use&amp;In-Reply-To=%3C1635693818.1200701275680397128.JavaMail.root%40zmail01.collab.prod.int.phx2.redhat.com%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=bressers%40redhat.com" alt="">
<div class="header"><span class="headerfield">From:</span> Josh Bressers &lt;bressers@redhat.com&gt;</div>
<div class="header"><span class="headerfield">To:</span> oss-security@lists.openwall.com</div>
<div class="header"><span class="headerfield">Cc:</span> Guillem Jover &lt;guillem@debian.org&gt;,
        Aníbal Monsalve Salazar &lt;anibal@debian.org&gt;,
        &quot;Steven M. Christey&quot; &lt;coley@linus.mitre.org&gt;</div>
<div class="header"><span class="headerfield">Subject:</span> Re: [oss-security] CVE Request -- rpcbind -- Insecure (predictable)
 temporary file use</div>
<div class="header"><span class="headerfield">Date:</span> Fri, 4 Jun 2010 15:39:57 -0400 (EDT)</div>
</div>
<pre class="message wrapping">Please use <a href="https://security-tracker.debian.org/tracker/CVE-2010-2061">CVE-2010-2061</a> for this.

Thanks.

-- 
    JB


----- &quot;Jan Lieskovsky&quot; &lt;jlieskov@redhat.com&gt; wrote:

&gt; Hi Steve, vendors,
&gt; 
&gt;    Guillem Jover pointed out:
&gt;    [1] <a href="http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=583435#5">http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=583435#5</a>
&gt; 
&gt; a deficiency in the way rpcbind gathered / saved registrations from /
&gt; to
&gt; dumped file(s). A local attacker could use this flaw to conduct
&gt; symbolic
&gt; link attacks, leading to un-authorized disclosure of sensitive
&gt; information
&gt; and / or to important system files data integrity corruption.
&gt; 
&gt; References:
&gt;    [2] <a href="https://bugzilla.redhat.com/show_bug.cgi?id=599697">https://bugzilla.redhat.com/show_bug.cgi?id=599697</a>
&gt;    [3] <a href="http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=583435#15">http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=583435#15</a>
&gt; 
&gt; Could you allocate CVE id for this?
&gt; 
&gt; Thanks &amp;&amp; Regards, Jan.
&gt; --
&gt; Jan iankko Lieskovsky / Red Hat Security Response Team



</pre>

<div class="infmessage"><hr><p>
<a name="46"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Anibal Monsalve Salazar &lt;anibal@debian.org&gt; -->
<!-- time:1275879605 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Anibal Monsalve Salazar &lt;anibal@debian.org&gt;</code>:<br>
<code>Bug#583435</code>; Package <code>rpcbind</code>.
 (Mon, 07 Jun 2010 03:00:05 GMT) (<a href="bugreport.cgi?bug=583435;msg=47">full text</a>, <a href="bugreport.cgi?bug=583435;mbox=yes;msg=47">mbox</a>, <a href="#46">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="48"></a>
<!-- request_addr: oss-security &lt;oss-security@lists.openwall.com&gt; -->
<!-- time:1275879605 -->
<strong>Acknowledgement sent</strong>
to <code>oss-security &lt;oss-security@lists.openwall.com&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Anibal Monsalve Salazar &lt;anibal@debian.org&gt;</code>.
 (Mon, 07 Jun 2010 03:00:05 GMT) (<a href="bugreport.cgi?bug=583435;msg=49">full text</a>, <a href="bugreport.cgi?bug=583435;mbox=yes;msg=49">mbox</a>, <a href="#48">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="50"></a><a name="msg50"></a><a href="#50">Message #50</a> received at 583435@bugs.debian.org (<a href="bugreport.cgi?bug=583435;msg=50">full text</a>, <a href="bugreport.cgi?bug=583435;mbox=yes;msg=50">mbox</a>, <a href="mailto:583435@bugs.debian.org?References=%3C4C07FE2A.3050906%40redhat.com%3E&amp;subject=Re%3A%20CVE%20Request%20--%20rpcbind%20--%20Insecure%20%28predictable%29%20temporary%20file%20use&amp;In-Reply-To=%3C4C07FE2A.3050906%40redhat.com%3E&amp;body=On%20Thu%2C%2003%20Jun%202010%2021%3A10%3A34%20%2B0200%20Jan%20Lieskovsky%20%3Cjlieskov%40redhat.com%3E%20wrote%3A%0A%3E%20Hi%20Steve%2C%20vendors%2C%0A%3E%20%0A%3E%20%20%20%20Guillem%20Jover%20pointed%20out%3A%0A%3E%20%20%20%20%5B1%5D%20http%3A%2F%2Fbugs.debian.org%2Fcgi-bin%2Fbugreport.cgi%3Fbug%3D583435%235%0A%3E%20%0A%3E%20a%20deficiency%20in%20the%20way%20rpcbind%20gathered%20%2F%20saved%20registrations%20from%20%2F%20to%0A%3E%20dumped%20file%28s%29.%20A%20local%20attacker%20could%20use%20this%20flaw%20to%20conduct%20symbolic%0A%3E%20link%20attacks%2C%20leading%20to%20un-authorized%20disclosure%20of%20sensitive%20information%0A%3E%20and%20%2F%20or%20to%20important%20system%20files%20data%20integrity%20corruption.%0A%3E%20%0A%3E%20References%3A%0A%3E%20%20%20%20%5B2%5D%20https%3A%2F%2Fbugzilla.redhat.com%2Fshow_bug.cgi%3Fid%3D599697%0A%3E%20%20%20%20%5B3%5D%20http%3A%2F%2Fbugs.debian.org%2Fcgi-bin%2Fbugreport.cgi%3Fbug%3D583435%2315%0A%3E%20%0A%3E%20Could%20you%20allocate%20CVE%20id%20for%20this%3F%0A%3E%20%0A%3E%20Thanks%20%26%26%20Regards%2C%20Jan.%0A%3E%20--%0A%3E%20Jan%20iankko%20Lieskovsky%20%2F%20Red%20Hat%20Security%20Response%20Team%0A%3E%20%0A%3E%20%0A%3E%20%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=jlieskov%40redhat.com" alt="">
<div class="header"><span class="headerfield">From:</span> Jan Lieskovsky &lt;jlieskov@redhat.com&gt;</div>
<div class="header"><span class="headerfield">To:</span> &quot;Steven M. Christey&quot; &lt;coley@linus.mitre.org&gt;,
        oss-security &lt;oss-security@lists.openwall.com&gt;</div>
<div class="header"><span class="headerfield">Cc:</span> Guillem Jover &lt;guillem@debian.org&gt;,
        Aníbal Monsalve Salazar &lt;anibal@debian.org&gt;</div>
<div class="header"><span class="headerfield">Subject:</span> CVE Request -- rpcbind -- Insecure (predictable) temporary file use</div>
<div class="header"><span class="headerfield">Date:</span> Thu, 03 Jun 2010 21:10:34 +0200</div>
</div>
<pre class="message flowed">Hi Steve, vendors,

  Guillem Jover pointed out:
  [1] <a href="http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=583435#5">http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=583435#5</a>

a deficiency in the way rpcbind gathered / saved registrations from / to
dumped file(s). A local attacker could use this flaw to conduct symbolic
link attacks, leading to un-authorized disclosure of sensitive information
and / or to important system files data integrity corruption.

References:
  [2] <a href="https://bugzilla.redhat.com/show_bug.cgi?id=599697">https://bugzilla.redhat.com/show_bug.cgi?id=599697</a>
  [3] <a href="http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=583435#15">http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=583435#15</a>

Could you allocate CVE id for this?

Thanks &amp;&amp; Regards, Jan.
--
Jan iankko Lieskovsky / Red Hat Security Response Team



</pre>

<div class="infmessage"><hr><p>
<a name="51"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Anibal Monsalve Salazar &lt;anibal@debian.org&gt; -->
<!-- time:1275879782 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Anibal Monsalve Salazar &lt;anibal@debian.org&gt;</code>:<br>
<code>Bug#583435</code>; Package <code>rpcbind</code>.
 (Mon, 07 Jun 2010 03:03:02 GMT) (<a href="bugreport.cgi?bug=583435;msg=52">full text</a>, <a href="bugreport.cgi?bug=583435;mbox=yes;msg=52">mbox</a>, <a href="#51">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="53"></a>
<!-- request_addr: oss-security &lt;oss-security@lists.openwall.com&gt; -->
<!-- time:1275879783 -->
<strong>Acknowledgement sent</strong>
to <code>oss-security &lt;oss-security@lists.openwall.com&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Anibal Monsalve Salazar &lt;anibal@debian.org&gt;</code>.
 (Mon, 07 Jun 2010 03:03:03 GMT) (<a href="bugreport.cgi?bug=583435;msg=54">full text</a>, <a href="bugreport.cgi?bug=583435;mbox=yes;msg=54">mbox</a>, <a href="#53">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="56"></a>
<!-- command:title -->
<!-- requester: Aníbal Monsalve Salazar &lt;anibal@debian.org&gt; -->
<!-- request_addr: control@bugs.debian.org -->
<!-- time:1275880146 -->
<!-- new_data:
$new_data = {
              &#39;subject&#39; =&gt; &#39;CVE-2010-2061 rpcbind: Insecure handling of state files&#39;
            };
-->
<!-- old_data:
$old_data = {
              &#39;subject&#39; =&gt; &#39;rpcbind: Insecure handling of state files&#39;
            };
-->
<strong>Changed Bug title to &#39;CVE-2010-2061 rpcbind: Insecure handling of state files&#39; from &#39;rpcbind: Insecure handling of state files&#39;</strong>
Request was from <code>Aníbal Monsalve Salazar &lt;anibal@debian.org&gt;</code>
to <code>control@bugs.debian.org</code>.
 (Mon, 07 Jun 2010 03:09:06 GMT) (<a href="bugreport.cgi?bug=583435;msg=57">full text</a>, <a href="bugreport.cgi?bug=583435;mbox=yes;msg=57">mbox</a>, <a href="#56">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="58"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Anibal Monsalve Salazar &lt;anibal@debian.org&gt; -->
<!-- time:1279398426 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Anibal Monsalve Salazar &lt;anibal@debian.org&gt;</code>:<br>
<code>Bug#583435</code>; Package <code>rpcbind</code>.
 (Sat, 17 Jul 2010 20:27:06 GMT) (<a href="bugreport.cgi?bug=583435;msg=59">full text</a>, <a href="bugreport.cgi?bug=583435;mbox=yes;msg=59">mbox</a>, <a href="#58">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="60"></a>
<!-- request_addr: Stefan Fritsch &lt;sf@sfritsch.de&gt; -->
<!-- time:1279398426 -->
<strong>Acknowledgement sent</strong>
to <code>Stefan Fritsch &lt;sf@sfritsch.de&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Anibal Monsalve Salazar &lt;anibal@debian.org&gt;</code>.
 (Sat, 17 Jul 2010 20:27:06 GMT) (<a href="bugreport.cgi?bug=583435;msg=61">full text</a>, <a href="bugreport.cgi?bug=583435;mbox=yes;msg=61">mbox</a>, <a href="#60">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="62"></a><a name="msg62"></a><a href="#62">Message #62</a> received at 583435@bugs.debian.org (<a href="bugreport.cgi?bug=583435;msg=62">full text</a>, <a href="bugreport.cgi?bug=583435;mbox=yes;msg=62">mbox</a>, <a href="mailto:583435@bugs.debian.org?subject=Re%3A%20NMU%20diff&amp;In-Reply-To=%3Calpine.DEB.1.10.1007172223190.9287%40eru.sfritsch.de%3E&amp;References=%3Calpine.DEB.1.10.1007172223190.9287%40eru.sfritsch.de%3E&amp;body=On%20Sat%2C%2017%20Jul%202010%2022%3A24%3A40%20%2B0200%20%28CEST%29%20Stefan%20Fritsch%20%3Csf%40sfritsch.de%3E%20wrote%3A%0A%3E%20Hi%2C%0A%3E%20%0A%3E%20I%20have%20uploaded%20an%20NMU%20that%20changes%20the%20state%20file%20dir%20to%20%0A%3E%20%2Fvar%2Frun%2Frpcbind.%20Diff%20is%20attached.%0A%3E%20%0A%3E%20Cheers%2C%0A%3E%20Stefan">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=sf%40sfritsch.de" alt="">
<div class="header"><span class="headerfield">From:</span> Stefan Fritsch &lt;sf@sfritsch.de&gt;</div>
<div class="header"><span class="headerfield">To:</span> 583435@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> NMU diff</div>
<div class="header"><span class="headerfield">Date:</span> Sat, 17 Jul 2010 22:24:40 +0200 (CEST)</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=0;bug=583435;msg=62">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message flowed">Hi,

I have uploaded an NMU that changes the state file dir to 
/var/run/rpcbind. Diff is attached.

Cheers,
Stefan</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=583435;filename=rpcbind_0.2.0-4.1.debdiff;msg=62">rpcbind_0.2.0-4.1.debdiff</a> (text/plain, attachment)]</pre>

<div class="msgreceived"><hr><p>
<a name="63"></a>
<!-- request_addr: Stefan Fritsch &lt;sf@debian.org&gt; -->
<!-- time:1279399878 -->
<strong>Reply sent</strong>
to <code>Stefan Fritsch &lt;sf@debian.org&gt;</code>:<br>
You have taken responsibility.
 (Sat, 17 Jul 2010 20:51:18 GMT) (<a href="bugreport.cgi?bug=583435;msg=64">full text</a>, <a href="bugreport.cgi?bug=583435;mbox=yes;msg=64">mbox</a>, <a href="#63">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="65"></a>
<!-- request_addr: Guillem Jover &lt;guillem@debian.org&gt; -->
<!-- time:1279399878 -->
<strong>Notification sent</strong>
to <code>Guillem Jover &lt;guillem@debian.org&gt;</code>:<br>
Bug acknowledged by developer.
 (Sat, 17 Jul 2010 20:51:18 GMT) (<a href="bugreport.cgi?bug=583435;msg=66">full text</a>, <a href="bugreport.cgi?bug=583435;mbox=yes;msg=66">mbox</a>, <a href="#65">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="67"></a><a name="msg67"></a><a href="#67">Message #67</a> received at 583435-close@bugs.debian.org (<a href="bugreport.cgi?bug=583435;msg=67">full text</a>, <a href="bugreport.cgi?bug=583435;mbox=yes;msg=67">mbox</a>, <a href="mailto:583435@bugs.debian.org?subject=Re%3A%20Bug%23583435%3A%20fixed%20in%20rpcbind%200.2.0-4.1&amp;In-Reply-To=%3CE1OaEIn-0002PS-07%40franck.debian.org%3E&amp;References=%3CE1OaEIn-0002PS-07%40franck.debian.org%3E&amp;body=On%20Sat%2C%2017%20Jul%202010%2020%3A48%3A05%20%2B0000%20Stefan%20Fritsch%20%3Csf%40debian.org%3E%20wrote%3A%0A%3E%20Source%3A%20rpcbind%0A%3E%20Source-Version%3A%200.2.0-4.1%0A%3E%20%0A%3E%20We%20believe%20that%20the%20bug%20you%20reported%20is%20fixed%20in%20the%20latest%20version%20of%0A%3E%20rpcbind%2C%20which%20is%20due%20to%20be%20installed%20in%20the%20Debian%20FTP%20archive%3A%0A%3E%20%0A%3E%20rpcbind_0.2.0-4.1.debian.tar.bz2%0A%3E%20%20%20to%20main%2Fr%2Frpcbind%2Frpcbind_0.2.0-4.1.debian.tar.bz2%0A%3E%20rpcbind_0.2.0-4.1.dsc%0A%3E%20%20%20to%20main%2Fr%2Frpcbind%2Frpcbind_0.2.0-4.1.dsc%0A%3E%20rpcbind_0.2.0-4.1_i386.deb%0A%3E%20%20%20to%20main%2Fr%2Frpcbind%2Frpcbind_0.2.0-4.1_i386.deb%0A%3E%20%0A%3E%20%0A%3E%20%0A%3E%20A%20summary%20of%20the%20changes%20between%20this%20version%20and%20the%20previous%20one%20is%0A%3E%20attached.%0A%3E%20%0A%3E%20Thank%20you%20for%20reporting%20the%20bug%2C%20which%20will%20now%20be%20closed.%20%20If%20you%0A%3E%20have%20further%20comments%20please%20address%20them%20to%20583435%40bugs.debian.org%2C%0A%3E%20and%20the%20maintainer%20will%20reopen%20the%20bug%20report%20if%20appropriate.%0A%3E%20%0A%3E%20Debian%20distribution%20maintenance%20software%0A%3E%20pp.%0A%3E%20Stefan%20Fritsch%20%3Csf%40debian.org%3E%20%28supplier%20of%20updated%20rpcbind%20package%29%0A%3E%20%0A%3E%20%28This%20message%20was%20generated%20automatically%20at%20their%20request%3B%20if%20you%0A%3E%20believe%20that%20there%20is%20a%20problem%20with%20it%20please%20contact%20the%20archive%0A%3E%20administrators%20by%20mailing%20ftpmaster%40debian.org%29%0A%3E%20%0A%3E%20%0A%3E%20-----BEGIN%20PGP%20SIGNED%20MESSAGE-----%0A%3E%20Hash%3A%20SHA1%0A%3E%20%0A%3E%20Format%3A%201.8%0A%3E%20Date%3A%20Sat%2C%2017%20Jul%202010%2021%3A47%3A56%20%2B0200%0A%3E%20Source%3A%20rpcbind%0A%3E%20Binary%3A%20rpcbind%0A%3E%20Architecture%3A%20source%20i386%0A%3E%20Version%3A%200.2.0-4.1%0A%3E%20Distribution%3A%20unstable%0A%3E%20Urgency%3A%20high%0A%3E%20Maintainer%3A%20Anibal%20Monsalve%20Salazar%20%3Canibal%40debian.org%3E%0A%3E%20Changed-By%3A%20Stefan%20Fritsch%20%3Csf%40debian.org%3E%0A%3E%20Description%3A%20%0A%3E%20%20rpcbind%20%20%20%20-%20converts%20RPC%20program%20numbers%20into%20universal%20addresses%0A%3E%20Closes%3A%20583435%0A%3E%20Changes%3A%20%0A%3E%20%20rpcbind%20%280.2.0-4.1%29%20unstable%3B%20urgency%3Dhigh%0A%3E%20%20.%0A%3E%20%20%20%20%2A%20Non-maintainer%20upload%20by%20the%20security%20team.%0A%3E%20%20%20%20%2A%20CVE-2010-2061%3A%20Store%20state%20files%20in%20%2Fvar%2Frun%2Frpcbind%20instead%20of%20%2Ftmp.%0A%3E%20%20%20%20%20%20Closes%3A%20%23583435%0A%3E%20Checksums-Sha1%3A%20%0A%3E%20%203632c80e3ff10921fb83136650f6720afcc7ad37%201077%20rpcbind_0.2.0-4.1.dsc%0A%3E%20%2010f1e09f3e18275d2e2b2b08ef65b23ecbce7cc5%208612%20rpcbind_0.2.0-4.1.debian.tar.bz2%0A%3E%20%2034d263b3ba92fa1ab8f16733a6784c14fff92965%2041204%20rpcbind_0.2.0-4.1_i386.deb%0A%3E%20Checksums-Sha256%3A%20%0A%3E%20%204d28bd0e9dbbf8ff76f2bd2902cfd2824f1578e988c4187cd284bc37f239de0f%201077%20rpcbind_0.2.0-4.1.dsc%0A%3E%20%20a95b1c375420a559c3feaf422b43e80b6d435dd12460e8063ae27ac1ed04fb21%208612%20rpcbind_0.2.0-4.1.debian.tar.bz2%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=sf%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Stefan Fritsch &lt;sf@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> 583435-close@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Bug#583435: fixed in rpcbind 0.2.0-4.1</div>
<div class="header"><span class="headerfield">Date:</span> Sat, 17 Jul 2010 20:48:05 +0000</div>
</div>
<pre class="message">Source: rpcbind
Source-Version: 0.2.0-4.1

We believe that the bug you reported is fixed in the latest version of
rpcbind, which is due to be installed in the Debian FTP archive:

rpcbind_0.2.0-4.1.debian.tar.bz2
  to main/r/rpcbind/rpcbind_0.2.0-4.1.debian.tar.bz2
rpcbind_0.2.0-4.1.dsc
  to main/r/rpcbind/rpcbind_0.2.0-4.1.dsc
rpcbind_0.2.0-4.1_i386.deb
  to main/r/rpcbind/rpcbind_0.2.0-4.1_i386.deb



A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 583435@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Stefan Fritsch &lt;sf@debian.org&gt; (supplier of updated rpcbind package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.8
Date: Sat, 17 Jul 2010 21:47:56 +0200
Source: rpcbind
Binary: rpcbind
Architecture: source i386
Version: 0.2.0-4.1
Distribution: unstable
Urgency: high
Maintainer: Anibal Monsalve Salazar &lt;anibal@debian.org&gt;
Changed-By: Stefan Fritsch &lt;sf@debian.org&gt;
Description: 
 rpcbind    - converts RPC program numbers into universal addresses
Closes: <a href="bugreport.cgi?bug=583435">583435</a>
Changes: 
 rpcbind (0.2.0-4.1) unstable; urgency=high
 .
   * Non-maintainer upload by the security team.
   * <a href="https://security-tracker.debian.org/tracker/CVE-2010-2061">CVE-2010-2061</a>: Store state files in /var/run/rpcbind instead of /tmp.
     Closes: #<a href="bugreport.cgi?bug=583435">583435</a>
Checksums-Sha1: 
 3632c80e3ff10921fb83136650f6720afcc7ad37 1077 rpcbind_0.2.0-4.1.dsc
 10f1e09f3e18275d2e2b2b08ef65b23ecbce7cc5 8612 rpcbind_0.2.0-4.1.debian.tar.bz2
 34d263b3ba92fa1ab8f16733a6784c14fff92965 41204 rpcbind_0.2.0-4.1_i386.deb
Checksums-Sha256: 
 4d28bd0e9dbbf8ff76f2bd2902cfd2824f1578e988c4187cd284bc37f239de0f 1077 rpcbind_0.2.0-4.1.dsc
 a95b1c375420a559c3feaf422b43e80b6d435dd12460e8063ae27ac1ed04fb21 8612 rpcbind_0.2.0-4.1.debian.tar.bz2
 a3d0c41a951ce52bb31324e249105e3e4ae42cdec1f84b5ca401f8ae029bfc98 41204 rpcbind_0.2.0-4.1_i386.deb
Files: 
 1ae5c21e40cbcc92237df34f66b1776c 1077 net standard rpcbind_0.2.0-4.1.dsc
 dc83366af01c63fcfe6495a50a16f13f 8612 net standard rpcbind_0.2.0-4.1.debian.tar.bz2
 8a543851a81fcb6c913e4e6587aa468a 41204 net standard rpcbind_0.2.0-4.1_i386.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)

iD8DBQFMQhDhbxelr8HyTqQRAh/xAJ4g8SDQ++z2olVYzAT8mzWaHsueXwCfaidv
V3khWtQ/z1mOOXBnOiydmxI=
=q3Ew
-----END PGP SIGNATURE-----




</pre>

<div class="msgreceived"><hr><p>
<a name="68"></a>
<!-- command:archive -->
<!-- requester: Debbugs Internal Request &lt;owner@bugs.debian.org&gt; -->
<!-- request_addr: internal_control@bugs.debian.org -->
<!-- time:1282116886 -->
<!-- new_data:
$new_data = {};
-->
<!-- old_data:
$old_data = {};
-->
<strong>Bug archived.</strong>
Request was from <code>Debbugs Internal Request &lt;owner@bugs.debian.org&gt;</code>
to <code>internal_control@bugs.debian.org</code>.
 (Wed, 18 Aug 2010 07:34:46 GMT) (<a href="bugreport.cgi?bug=583435;msg=69">full text</a>, <a href="bugreport.cgi?bug=583435;mbox=yes;msg=69">mbox</a>, <a href="#68">link</a>).</p></p></div>

<hr>
<p class="msgreceived">Send a report that <a href="https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=583435">this bug log contains spam</a>.</p>
<hr>
<ADDRESS>Debian bug tracking system administrator &lt;<A HREF="mailto:owner@bugs.debian.org">owner@bugs.debian.org</A>&gt;.
Last modified:
<!--timestamp-->Sat Oct 30 18:24:03 2021<!--end timestamp-->; 
Machine Name:
<!--machinename-->bembo<!--machinename-->
<P>
<A HREF="https://www.debian.org/Bugs/">Debian Bug tracking system</A>
</p>
<p>
  Debbugs is free software and licensed under the terms of the GNU
  Public License version 2. The current version can be obtained
  from <a href="https://bugs.debian.org/debbugs-source/">https://bugs.debian.org/debbugs-source/</a>.
</p>
<p>
Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.
</p>
</ADDRESS>

</body>
</html>
