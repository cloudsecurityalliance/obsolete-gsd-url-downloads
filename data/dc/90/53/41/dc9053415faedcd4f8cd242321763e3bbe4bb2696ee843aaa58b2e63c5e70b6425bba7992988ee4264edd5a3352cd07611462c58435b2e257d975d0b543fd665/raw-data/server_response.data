<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
<link rel="icon" href="/favicon.png">
<title>#749795 - apt: CVE-2014-0478: no authentication checks for source packages - Debian Bug report logs</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="/css/bugs.css" type="text/css">

<link rel="canonical" href="&lt;a href=&quot;bugreport.cgi?bug=749795&quot;&gt;749795&lt;/a&gt;">
<script type="text/javascript">
<!--
function toggle_infmessages()
{
        allDivs=document.getElementsByTagName("div");
        for (var i = 0 ; i < allDivs.length ; i++ )
        {
                if (allDivs[i].className == "infmessage")
                {
                        allDivs[i].style.display=(allDivs[i].style.display == 'none' | allDivs[i].style.display == '') ? 'block' : 'none';
                }
        }
}
-->
</script>
</head>
<body>
<h1>Debian Bug report logs - 
<a href="mailto:749795@bugs.debian.org">#749795</a><br>
apt: CVE-2014-0478: no authentication checks for source packages</h1>
<div class="versiongraph"><a href="version.cgi?found=apt%2F0.9.7.9%2Bdeb7u1;found=apt%2F1.0.3;package=apt;collapse=1;fixed=apt%2F1.0.4;fixed=apt%2F0.8.10.3%2Bsqueeze2;fixed=apt%2F0.9.7.9%2Bdeb7u2;info=1;absolute=0"><img alt="version graph" src="version.cgi?fixed=apt%2F1.0.4;fixed=apt%2F0.8.10.3%2Bsqueeze2;fixed=apt%2F0.9.7.9%2Bdeb7u2;absolute=0;width=2;height=2;package=apt;found=apt%2F0.9.7.9%2Bdeb7u1;found=apt%2F1.0.3;collapse=1"></a></div>
<div class="pkginfo">
  <p>Package:
     <a class="submitter" href="pkgreport.cgi?package=apt">apt</a>;
Maintainer for <a href="pkgreport.cgi?package=apt">apt</a> is <a href="pkgreport.cgi?maint=deity%40lists.debian.org">APT Development Team &lt;deity@lists.debian.org&gt;</a>; Source for <a href="pkgreport.cgi?package=apt">apt</a> is <a href="pkgreport.cgi?src=apt">src:apt</a> (<a href="https://tracker.debian.org/pkg/apt">PTS</a>, <a href="https://buildd.debian.org/apt">buildd</a>, <a href="https://qa.debian.org/popcon.php?package=apt">popcon</a>). </p>

</div>

<div class="buginfo">
  <p>Reported by: <a href="pkgreport.cgi?submitter=jwilk%40debian.org">Jakub Wilk &lt;jwilk@debian.org&gt;</a></p>
  <p>Date: Thu, 29 May 2014 21:09:02 UTC</p>

<p>Severity: <em class="severity">grave</em></p>
<p>Tags: security</p>

<p>Found in versions apt/0.9.7.9+deb7u1, apt/1.0.3</p>
<p>Fixed in versions apt/1.0.4, apt/0.8.10.3+squeeze2, apt/0.9.7.9+deb7u2</p>

<p><strong>Done:</strong> Michael Vogt &lt;mvo@debian.org&gt;</p>

<p>Bug is archived. No further changes may be made.<p></div>

<p><a href="javascript:toggle_infmessages();">Toggle useless messages</a></p><div class="msgreceived"><p>View this report as an <a href="bugreport.cgi?bug=749795;mbox=yes">mbox folder</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;mboxstatus=yes">status mbox</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;mboxmaint=yes">maintainer mbox</a></p></div>

<div class="infmessage"><hr><p>
<a name="1"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, jwilk@debian.org, APT Development Team &lt;deity@lists.debian.org&gt; -->
<!-- time:1401397746 -->
<strong>Report forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, jwilk@debian.org, APT Development Team &lt;deity@lists.debian.org&gt;</code>:<br>
<code>Bug#749795</code>; Package <code>apt</code>.
 (Thu, 29 May 2014 21:09:06 GMT) (<a href="bugreport.cgi?bug=749795;msg=2">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=2">mbox</a>, <a href="#1">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="3"></a><a name="msg3"></a><a href="#3">Message #3</a> received at submit@bugs.debian.org (<a href="bugreport.cgi?bug=749795;msg=3">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=3">mbox</a>, <a href="mailto:749795@bugs.debian.org?References=%3C20140529210434.GA3935%40jwilk.net%3E&amp;subject=Re%3A%20apt%3A%20no%20authentication%20checks%20for%20source%20packages&amp;In-Reply-To=%3C20140529210434.GA3935%40jwilk.net%3E&amp;body=On%20Thu%2C%2029%20May%202014%2023%3A04%3A35%20%2B0200%20Jakub%20Wilk%20%3Cjwilk%40debian.org%3E%20wrote%3A%0A%3E%20Package%3A%20apt%0A%3E%20Version%3A%201.0.3%0A%3E%20Severity%3A%20grave%0A%3E%20Tags%3A%20security%0A%3E%20%0A%3E%20I%27ve%20been%20investigating%20how%20apt%20behaves%20when%20the%20repository%20doesn%27t%20%0A%3E%20contain%20any%20Release%20signatures%20%28possibly%20because%20they%20were%20stripped%20off%20%0A%3E%20by%20a%20man-in-the-middle%20attacker%29.%0A%3E%20%0A%3E%20This%20is%20what%20I%20found%20out%3A%0A%3E%20%0A%3E%20%7C%20%23%20cat%20%2Fetc%2Fapt%2Fsources.list%0A%3E%20%7C%20deb%20http%3A%2F%2Fftp.debian.org%2Fdebian%2F%20unstable%20main%0A%3E%20%7C%20deb-src%20http%3A%2F%2Fftp.debian.org%2Fdebian%2F%20unstable%20main%0A%3E%20%7C%0A%3E%20%7C%20%23%20apt-get%20update%0A%3E%20%7C%20Ign%20http%3A%2F%2Fftp.debian.org%20unstable%20InRelease%0A%3E%20%7C%20Ign%20http%3A%2F%2Fftp.debian.org%20unstable%20Release.gpg%0A%3E%20%7C%20Get%3A1%20http%3A%2F%2Fftp.debian.org%20unstable%20Release%20%5B205%20kB%5D%0A%3E%20%7C%20Get%3A2%20http%3A%2F%2Fftp.debian.org%20unstable%2Fmain%20Sources%20%5B7249%20kB%5D%0A%3E%20%7C%20Get%3A3%20http%3A%2F%2Fftp.debian.org%20unstable%2Fmain%20amd64%20Packages%20%5B6758%20kB%5D%0A%3E%20%7C%20Fetched%2014.2%20MB%20in%2029s%20%28479%20kB%2Fs%29%0A%3E%20%7C%20Reading%20package%20lists...%20Done%0A%3E%20%7C%0A%3E%20%7C%20%23%20echo%20%24%3F%0A%3E%20%7C%200%0A%3E%20%0A%3E%20Hmm.%20There%20is%20no%20warning%20suggesting%20that%20anything%20fishy%20is%20going%20on%2C%20and%20%0A%3E%20the%20exit%20code%20indicates%20success.%20%28Perhaps%20the%20%22Ign%22s%20could%20raise%20%0A%3E%20suspicion%20of%20an%20observant%20sysadmin.%20But%20who%20knows%20what%20%22Ign%22%20exactly%20%0A%3E%20means%3F%20At%20least%20the%20apt-get%281%29%20manpage%20doesn%27t%20know.%29%0A%3E%20%0A%3E%20Fortunately%2C%20apt-get%20won%27t%20let%20you%20install%20anything%3A%0A%3E%20%0A%3E%20%7C%20%23%20apt-get%20install%20-qq%20nyancat%0A%3E%20%7C%20WARNING%3A%20The%20following%20packages%20cannot%20be%20authenticated%21%0A%3E%20%7C%20%20%20nyancat%0A%3E%20%7C%20E%3A%20There%20are%20problems%20and%20-y%20was%20used%20without%20--force-yes%0A%3E%20%0A%3E%20And%20it%20won%27t%20let%20you%20even%20download%20binary%20packages%3A%0A%3E%20%0A%3E%20%7C%20%24%20apt-get%20download%20nyancat%0A%3E%20%7C%20WARNING%3A%20The%20following%20packages%20cannot%20be%20authenticated%21%0A%3E%20%7C%20%20%20nyancat%0A%3E%20%7C%20E%3A%20Some%20packages%20could%20not%20be%20authenticated%0A%3E%20%0A%3E%20So%20far%2C%20so%20good.%20However%2C%20apt-get%20happily%20downloads%20unauthenticated%20%0A%3E%20source%20packages%2C%20with%20no%20warning%3A%0A%3E%20%0A%3E%20%7C%20%24%20apt-get%20source%20-d%20nyancat%0A%3E%20%7C%20Reading%20package%20lists...%20Done%0A%3E%20%7C%20Building%20dependency%20tree%0A%3E%20%7C%20Reading%20state%20information...%20Done%0A%3E%20%7C%20Selected%20version%20%271.2.2-1%27%20%28unstable%29%20for%20nyancat%0A%3E%20%7C%20Need%20to%20get%2020.6%20kB%20of%20source%20archives.%0A%3E%20%7C%20Get%3A1%20http%3A%2F%2Fftp.debian.org%2Fdebian%2F%20unstable%2Fmain%20nyancat%201.2.2-1%20%28dsc%29%20%5B1782%20B%5D%0A%3E%20%7C%20Get%3A2%20http%3A%2F%2Fftp.debian.org%2Fdebian%2F%20unstable%2Fmain%20nyancat%201.2.2-1%20%28tar%29%20%5B14.1%20kB%5D%0A%3E%20%7C%20Get%3A3%20http%3A%2F%2Fftp.debian.org%2Fdebian%2F%20unstable%2Fmain%20nyancat%201.2.2-1%20%28diff%29%20%5B4748%20B%5D%0A%3E%20%7C%20Fetched%2020.6%20kB%20in%200s%20%281838%20kB%2Fs%29%0A%3E%20%7C%20Download%20complete%20and%20in%20download%20only%20mode%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=jwilk%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Jakub Wilk &lt;jwilk@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> Debian Bug Tracking System &lt;submit@bugs.debian.org&gt;</div>
<div class="header"><span class="headerfield">Subject:</span> apt: no authentication checks for source packages</div>
<div class="header"><span class="headerfield">Date:</span> Thu, 29 May 2014 23:04:35 +0200</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=0;bug=749795;msg=3">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message flowed">Package: apt
Version: 1.0.3
Severity: grave
Tags: security

I&#39;ve been investigating how apt behaves when the repository doesn&#39;t 
contain any Release signatures (possibly because they were stripped off 
by a man-in-the-middle attacker).

This is what I found out:

| # cat /etc/apt/sources.list
| deb <a href="http://ftp.debian.org/debian/">http://ftp.debian.org/debian/</a> unstable main
| deb-src <a href="http://ftp.debian.org/debian/">http://ftp.debian.org/debian/</a> unstable main
|
| # apt-get update
| Ign <a href="http://ftp.debian.org">http://ftp.debian.org</a> unstable InRelease
| Ign <a href="http://ftp.debian.org">http://ftp.debian.org</a> unstable Release.gpg
| Get:1 <a href="http://ftp.debian.org">http://ftp.debian.org</a> unstable Release [205 kB]
| Get:2 <a href="http://ftp.debian.org">http://ftp.debian.org</a> unstable/main Sources [7249 kB]
| Get:3 <a href="http://ftp.debian.org">http://ftp.debian.org</a> unstable/main amd64 Packages [6758 kB]
| Fetched 14.2 MB in 29s (479 kB/s)
| Reading package lists... Done
|
| # echo $?
| 0

Hmm. There is no warning suggesting that anything fishy is going on, and 
the exit code indicates success. (Perhaps the &quot;Ign&quot;s could raise 
suspicion of an observant sysadmin. But who knows what &quot;Ign&quot; exactly 
means? At least the apt-get(1) manpage doesn&#39;t know.)

Fortunately, apt-get won&#39;t let you install anything:

| # apt-get install -qq nyancat
| WARNING: The following packages cannot be authenticated!
|   nyancat
| E: There are problems and -y was used without --force-yes

And it won&#39;t let you even download binary packages:

| $ apt-get download nyancat
| WARNING: The following packages cannot be authenticated!
|   nyancat
| E: Some packages could not be authenticated

So far, so good. However, apt-get happily downloads unauthenticated 
source packages, with no warning:

| $ apt-get source -d nyancat
| Reading package lists... Done
| Building dependency tree
| Reading state information... Done
| Selected version &#39;1.2.2-1&#39; (unstable) for nyancat
| Need to get 20.6 kB of source archives.
| Get:1 <a href="http://ftp.debian.org/debian/">http://ftp.debian.org/debian/</a> unstable/main nyancat 1.2.2-1 (dsc) [1782 B]
| Get:2 <a href="http://ftp.debian.org/debian/">http://ftp.debian.org/debian/</a> unstable/main nyancat 1.2.2-1 (tar) [14.1 kB]
| Get:3 <a href="http://ftp.debian.org/debian/">http://ftp.debian.org/debian/</a> unstable/main nyancat 1.2.2-1 (diff) [4748 B]
| Fetched 20.6 kB in 0s (1838 kB/s)
| Download complete and in download only mode
|
| $ echo $?
| 0

It is equally happy to unpack them:

| $ apt-get source nyancat
| Reading package lists... Done
| Building dependency tree
| Reading state information... Done
| Selected version &#39;1.2.2-1&#39; (unstable) for nyancat
| Need to get 20.6 kB of source archives.
| Get:1 <a href="http://ftp.debian.org/debian/">http://ftp.debian.org/debian/</a> unstable/main nyancat 1.2.2-1 (dsc) [1782 B]
| Get:2 <a href="http://ftp.debian.org/debian/">http://ftp.debian.org/debian/</a> unstable/main nyancat 1.2.2-1 (tar) [14.1 kB]
| Get:3 <a href="http://ftp.debian.org/debian/">http://ftp.debian.org/debian/</a> unstable/main nyancat 1.2.2-1 (diff) [4748 B]
| Fetched 20.6 kB in 0s (1637 kB/s)
| gpgv: keyblock resource `/home/jwilk/.gnupg/trustedkeys.gpg&#39;: file open error
| gpgv: Signature made Fri Dec 13 23:42:11 2013 CET using RSA key ID 37AD3296
| gpgv: Can&#39;t check signature: public key not found
| dpkg-source: warning: failed to verify signature on ./nyancat_1.2.2-1.dsc
| dpkg-source: info: extracting nyancat in nyancat-1.2.2
| dpkg-source: info: unpacking nyancat_1.2.2.orig.tar.gz
| dpkg-source: info: unpacking nyancat_1.2.2-1.debian.tar.gz
| dpkg-source: info: applying 01-nyancat-debhelper.patch
|
| $ echo $?
| 0

And it will even let you build them:

| $ apt-get source -b nyancat
| Reading package lists... Done
| Building dependency tree
| Reading state information... Done
| Selected version &#39;1.2.2-1&#39; (unstable) for nyancat
| Need to get 20.6 kB of source archives.
| Get:1 <a href="http://ftp.debian.org/debian/">http://ftp.debian.org/debian/</a> unstable/main nyancat 1.2.2-1 (dsc) [1782 B]
| Get:2 <a href="http://ftp.debian.org/debian/">http://ftp.debian.org/debian/</a> unstable/main nyancat 1.2.2-1 (tar) [14.1 kB]
| Get:3 <a href="http://ftp.debian.org/debian/">http://ftp.debian.org/debian/</a> unstable/main nyancat 1.2.2-1 (diff) [4748 B]
| Fetched 20.6 kB in 0s (1757 kB/s)
| gpgv: keyblock resource `/home/jwilk/.gnupg/trustedkeys.gpg&#39;: file open error
| gpgv: Signature made Fri Dec 13 23:42:11 2013 CET using RSA key ID 37AD3296
| gpgv: Can&#39;t check signature: public key not found
| dpkg-source: warning: failed to verify signature on ./nyancat_1.2.2-1.dsc
| dpkg-source: info: extracting nyancat in nyancat-1.2.2
| dpkg-source: info: unpacking nyancat_1.2.2.orig.tar.gz
| dpkg-source: info: unpacking nyancat_1.2.2-1.debian.tar.gz
| dpkg-source: info: applying 01-nyancat-debhelper.patch
| dpkg-buildpackage: source package nyancat
| dpkg-buildpackage: source version 1.2.2-1
| dpkg-buildpackage: source distribution unstable
| dpkg-buildpackage: source changed by Jonathan McCrohan &lt;jmccrohan@gmail.com&gt;
| dpkg-buildpackage: host architecture amd64
|  dpkg-source --before-build nyancat-1.2.2
|  fakeroot debian/rules clean
[...]

The mitmproxy script I used for testing is attached.

-- System Information:
Debian Release: jessie/sid
 APT prefers unstable
 APT policy: (990, &#39;unstable&#39;)
Architecture: amd64 (x86_64)

Kernel: Linux 3.14-1-amd64 (SMP w/1 CPU core)
Locale: LANG=C, LC_CTYPE=C (charmap=ANSI_X3.4-1968)
Shell: /bin/sh linked to /bin/dash

Versions of packages apt depends on:
ii  debian-archive-keyring  2012.4
ii  gnupg                   1.4.16-1.1
ii  libapt-pkg4.12          1.0.3
ii  libc6                   2.18-7
ii  libgcc1                 1:4.9.0-5
ii  libstdc++6              4.9.0-5

-- 
Jakub Wilk
</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=749795;filename=nosigs.py;msg=3">nosigs.py</a> (text/x-python, attachment)]</pre>

<div class="infmessage"><hr><p>
<a name="4"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, APT Development Team &lt;deity@lists.debian.org&gt; -->
<!-- time:1401405849 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, APT Development Team &lt;deity@lists.debian.org&gt;</code>:<br>
<code>Bug#749795</code>; Package <code>apt</code>.
 (Thu, 29 May 2014 23:24:09 GMT) (<a href="bugreport.cgi?bug=749795;msg=5">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=5">mbox</a>, <a href="#4">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="6"></a>
<!-- request_addr: David Kalnischkies &lt;david@kalnischkies.de&gt; -->
<!-- time:1401405849 -->
<strong>Acknowledgement sent</strong>
to <code>David Kalnischkies &lt;david@kalnischkies.de&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>APT Development Team &lt;deity@lists.debian.org&gt;</code>.
 (Thu, 29 May 2014 23:24:09 GMT) (<a href="bugreport.cgi?bug=749795;msg=7">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=7">mbox</a>, <a href="#6">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="8"></a><a name="msg8"></a><a href="#8">Message #8</a> received at 749795@bugs.debian.org (<a href="bugreport.cgi?bug=749795;msg=8">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=8">mbox</a>, <a href="mailto:749795@bugs.debian.org?subject=Re%3A%20Bug%23749795%3A%20apt%3A%20no%20authentication%20checks%20for%20source%20packages&amp;References=%3C20140529210434.GA3935%40jwilk.net%3E%0A%20%3C20140529232053.GA12694%40crossbow%3E&amp;body=On%20Fri%2C%2030%20May%202014%2001%3A20%3A53%20%2B0200%20David%20Kalnischkies%20%3Cdavid%40kalnischkies.de%3E%20wrote%3A%0A%3E%20On%20Thu%2C%20May%2029%2C%202014%20at%2011%3A04%3A35PM%20%2B0200%2C%20Jakub%20Wilk%20wrote%3A%0A%3E%20%3E%20Package%3A%20apt%0A%3E%20%3E%20Version%3A%201.0.3%0A%3E%20%3E%20Severity%3A%20grave%0A%3E%20%3E%20Tags%3A%20security%0A%3E%20%0A%3E%20%28personally%2C%20this%20feels%20a%20bit%20high.%20Mostly%20as%20deb-src%20isn%27t%20even%20part%20of%0A%3E%20%20many%20default%20configurations%20in%20which%20apt%20is%20found.%20And%20in%20those%20where%0A%3E%20%20you%20find%20it%2C%20you%20probably%20find%20also%20vcs%20checkouts%20and%20%22wget%20%7C%20sh%22%20%E2%80%A6%0A%3E%20%20Anyway%20tl%3Bdr%3A%20I%20wouldn%27t%20like%20to%20release%20jessie%20with%20it%2C%20so%20I%20leave%20it%20at%0A%3E%20%20that%20and%20we%20should%20ask%20the%20relevant%20security%20teams%20what%20they%20want%2C%20but%0A%3E%20%20I%20am%20too%20dreamy%20now%20to%20figure%20out%20a%20patch%2Fall%20the%20mail%20addresses%E2%80%A6%29%0A%3E%20%0A%3E%20%0A%3E%20%3E%20I%27ve%20been%20investigating%20how%20apt%20behaves%20when%20the%20repository%20doesn%27t%20contain%0A%3E%20%3E%20any%20Release%20signatures%20%28possibly%20because%20they%20were%20stripped%20off%20by%20a%0A%3E%20%3E%20man-in-the-middle%20attacker%29.%0A%3E%20%0A%3E%20Thanks%21%20Not%20many%20do%2C%20so%20such%20things%20usually%20never%20get%20reported%E2%80%A6%0A%3E%20The%20pain%20of%20being%20even%20less%20sexy%20than%20OpenSSL%E2%80%A6%0A%3E%20%0A%3E%20%28may%20I%20ask%20to%20push%20security%20bugs%20through%20the%20security%20teams%20first%0A%3E%20%20though%2C%20so%20that%20they%20can%20coordinate%20properly%20as%20%27apt%27%20and%20%27security%27%0A%3E%20%20tends%20to%20make%20people%20super%20nervous%20as%20recovery%20tends%20to%20be%20painful%29%0A%3E%20%0A%3E%20%0A%3E%20%3E%20This%20is%20what%20I%20found%20out%3A%0A%3E%20%3E%20%0A%3E%20%3E%20%7C%20%23%20cat%20%2Fetc%2Fapt%2Fsources.list%0A%3E%20%3E%20%7C%20deb%20http%3A%2F%2Fftp.debian.org%2Fdebian%2F%20unstable%20main%0A%3E%20%3E%20%7C%20deb-src%20http%3A%2F%2Fftp.debian.org%2Fdebian%2F%20unstable%20main%0A%3E%20%3E%20%7C%0A%3E%20%3E%20%7C%20%23%20apt-get%20update%0A%3E%20%3E%20%7C%20Ign%20http%3A%2F%2Fftp.debian.org%20unstable%20InRelease%0A%3E%20%3E%20%7C%20Ign%20http%3A%2F%2Fftp.debian.org%20unstable%20Release.gpg%0A%3E%20%3E%20%7C%20Get%3A1%20http%3A%2F%2Fftp.debian.org%20unstable%20Release%20%5B205%20kB%5D%0A%3E%20%3E%20%7C%20Get%3A2%20http%3A%2F%2Fftp.debian.org%20unstable%2Fmain%20Sources%20%5B7249%20kB%5D%0A%3E%20%3E%20%7C%20Get%3A3%20http%3A%2F%2Fftp.debian.org%20unstable%2Fmain%20amd64%20Packages%20%5B6758%20kB%5D%0A%3E%20%3E%20%7C%20Fetched%2014.2%20MB%20in%2029s%20%28479%20kB%2Fs%29%0A%3E%20%3E%20%7C%20Reading%20package%20lists...%20Done%0A%3E%20%3E%20%7C%0A%3E%20%3E%20%7C%20%23%20echo%20%24%3F%0A%3E%20%3E%20%7C%200%0A%3E%20%3E%20%0A%3E%20%3E%20Hmm.%20There%20is%20no%20warning%20suggesting%20that%20anything%20fishy%20is%20going%20on%2C%20and%20the%0A%3E%20%3E%20exit%20code%20indicates%20success.%20%28Perhaps%20the%20%22Ign%22s%20could%20raise%20suspicion%20of%20an%0A%3E%20%3E%20observant%20sysadmin.%20But%20who%20knows%20what%20%22Ign%22%20exactly%20means%3F%20At%20least%20the%0A%3E%20%3E%20apt-get%281%29%20manpage%20doesn%27t%20know.%29%0A%3E%20%0A%3E%20Well%2C%20%22Ign%22%20isn%27t%20%22Get%22%20-%20and%20it%20stands%20for%20%22Ignore%22%2C%20but%20that%20is%20surely%0A%3E%20not%20your%20point%20here.%0A%3E%20%0A%3E%20The%20%22problem%22%20is%20that%20apt%20supports%20unsigned%20repositories%20as%20too%20many%0A%3E%20people%20would%20bitch%20too%20much%20if%20it%20would%20require%20a%20signature%20%E2%80%93%20it%20used%0A%3E%20to%20work%20before%20apt%200.6%2C%20it%20has%20to%20work%20forever%2C%20man%20%E2%80%93%20FOR%20EVER%21%0A%3E%20%0A%3E%20So%20not%20getting%20a%20signature%20isn%27t%20an%20error%20and%20not%20even%20fishy.%0A%3E%20It%27s%20absolutely%20fine%E2%80%A6%0A%3E%20%0A%3E%20%0A&amp;In-Reply-To=%3C20140529232053.GA12694%40crossbow%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=david%40kalnischkies.de" alt="">
<div class="header"><span class="headerfield">From:</span> David Kalnischkies &lt;david@kalnischkies.de&gt;</div>
<div class="header"><span class="headerfield">To:</span> Jakub Wilk &lt;jwilk@debian.org&gt;, 749795@bugs.debian.org</div>
<div class="header"><span class="headerfield">Cc:</span> Michael Vogt &lt;mvo@debian.org&gt;</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#749795: apt: no authentication checks for source packages</div>
<div class="header"><span class="headerfield">Date:</span> Fri, 30 May 2014 01:20:53 +0200</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=0;bug=749795;msg=8">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message">On Thu, May 29, 2014 at 11:04:35PM +0200, Jakub Wilk wrote:
&gt; Package: apt
&gt; Version: 1.0.3
&gt; Severity: grave
&gt; Tags: security

(personally, this feels a bit high. Mostly as deb-src isn&#39;t even part of
 many default configurations in which apt is found. And in those where
 you find it, you probably find also vcs checkouts and &quot;wget | sh&quot; …
 Anyway tl;dr: I wouldn&#39;t like to release jessie with it, so I leave it at
 that and we should ask the relevant security teams what they want, but
 I am too dreamy now to figure out a patch/all the mail addresses…)


&gt; I&#39;ve been investigating how apt behaves when the repository doesn&#39;t contain
&gt; any Release signatures (possibly because they were stripped off by a
&gt; man-in-the-middle attacker).

Thanks! Not many do, so such things usually never get reported…
The pain of being even less sexy than OpenSSL…

(may I ask to push security bugs through the security teams first
 though, so that they can coordinate properly as &#39;apt&#39; and &#39;security&#39;
 tends to make people super nervous as recovery tends to be painful)


&gt; This is what I found out:
&gt; 
&gt; | # cat /etc/apt/sources.list
&gt; | deb <a href="http://ftp.debian.org/debian/">http://ftp.debian.org/debian/</a> unstable main
&gt; | deb-src <a href="http://ftp.debian.org/debian/">http://ftp.debian.org/debian/</a> unstable main
&gt; |
&gt; | # apt-get update
&gt; | Ign <a href="http://ftp.debian.org">http://ftp.debian.org</a> unstable InRelease
&gt; | Ign <a href="http://ftp.debian.org">http://ftp.debian.org</a> unstable Release.gpg
&gt; | Get:1 <a href="http://ftp.debian.org">http://ftp.debian.org</a> unstable Release [205 kB]
&gt; | Get:2 <a href="http://ftp.debian.org">http://ftp.debian.org</a> unstable/main Sources [7249 kB]
&gt; | Get:3 <a href="http://ftp.debian.org">http://ftp.debian.org</a> unstable/main amd64 Packages [6758 kB]
&gt; | Fetched 14.2 MB in 29s (479 kB/s)
&gt; | Reading package lists... Done
&gt; |
&gt; | # echo $?
&gt; | 0
&gt; 
&gt; Hmm. There is no warning suggesting that anything fishy is going on, and the
&gt; exit code indicates success. (Perhaps the &quot;Ign&quot;s could raise suspicion of an
&gt; observant sysadmin. But who knows what &quot;Ign&quot; exactly means? At least the
&gt; apt-get(1) manpage doesn&#39;t know.)

Well, &quot;Ign&quot; isn&#39;t &quot;Get&quot; - and it stands for &quot;Ignore&quot;, but that is surely
not your point here.

The &quot;problem&quot; is that apt supports unsigned repositories as too many
people would bitch too much if it would require a signature – it used
to work before apt 0.6, it has to work forever, man – FOR EVER!

So not getting a signature isn&#39;t an error and not even fishy.
It&#39;s absolutely fine…


Maybe we could be &quot;evil&quot; and enforce the usage of the flag on update, too?


&gt; Fortunately, apt-get won&#39;t let you install anything:
&gt; 
&gt; | # apt-get install -qq nyancat
&gt; | WARNING: The following packages cannot be authenticated!
&gt; |   nyancat
&gt; | E: There are problems and -y was used without --force-yes
&gt; 
&gt; And it won&#39;t let you even download binary packages:
&gt; 
&gt; | $ apt-get download nyancat
&gt; | WARNING: The following packages cannot be authenticated!
&gt; |   nyancat
&gt; | E: Some packages could not be authenticated

JFTR: --allow-unauthenticated is the flag littered all over the place to
let this error disappear. Similar to wget --no-check-certificate | sh.


&gt; So far, so good. However, apt-get happily downloads unauthenticated source
&gt; packages, with no warning:
&gt; 
&gt; | $ apt-get source -d nyancat
&gt; | Reading package lists... Done
&gt; | Building dependency tree
&gt; | Reading state information... Done
&gt; | Selected version &#39;1.2.2-1&#39; (unstable) for nyancat
&gt; | Need to get 20.6 kB of source archives.
&gt; | Get:1 <a href="http://ftp.debian.org/debian/">http://ftp.debian.org/debian/</a> unstable/main nyancat 1.2.2-1 (dsc) [1782 B]
&gt; | Get:2 <a href="http://ftp.debian.org/debian/">http://ftp.debian.org/debian/</a> unstable/main nyancat 1.2.2-1 (tar) [14.1 kB]
&gt; | Get:3 <a href="http://ftp.debian.org/debian/">http://ftp.debian.org/debian/</a> unstable/main nyancat 1.2.2-1 (diff) [4748 B]
&gt; | Fetched 20.6 kB in 0s (1838 kB/s)
&gt; | Download complete and in download only mode
&gt; |
&gt; | $ echo $?
&gt; | 0

Snipping the rest as if it downloads, everything else is just a follow
up. You see btw that dpkg-source (which does the unpack/build) would
check signatures on the dsc if it had them available. I think installing
debian-keyring would help (at least for packages from debian).

You will also notice that the check for the hashsum in the Sources, as
well as the check for the hashsum of Sources in Release is done, you
&quot;just&quot; don&#39;t get this lovely warning &amp; error message for missing
signatures (aka: the MITM has to be a bit more active in modifying these
files as well to get away with sneaking bad files on your system).


The source (is this a pun now?) has no indication of ever wanting to
check this. Easy to add, for sure (CheckAuth method exists in various
versions in various places). Hardest part will be deciding if
a) sources should be interactive (needs a new string) OR
b) not just like e.g. &#39;download&#39;.


I guess the later makes more sense (similar to download) and is more
backward compatible (not suddenly interactive), would therefore not
require a new string and should be simple(r) to backport if needed.
As this will surely find at least a few complainers for stable I will
repeat it though: This breaks (obviously) compatibility with unsigned
archives. Workaround for those buggers would be the flag from above.


Haven&#39;t written patch/testcase yet though, as I should be in dreamland
for a while now, so I could be horribly wrong about all this of course.

Not a lot of time tomorrow^Wtoday (and I can&#39;t upload anyway), so,
Michael, could you please have a look and talk to the security teams?


Best regards

David Kalnischkies
</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=749795;filename=signature.asc;msg=8">signature.asc</a> (application/pgp-signature, inline)]</pre>

<div class="infmessage"><hr><p>
<a name="9"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, APT Development Team &lt;deity@lists.debian.org&gt; -->
<!-- time:1401456244 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, APT Development Team &lt;deity@lists.debian.org&gt;</code>:<br>
<code>Bug#749795</code>; Package <code>apt</code>.
 (Fri, 30 May 2014 13:24:04 GMT) (<a href="bugreport.cgi?bug=749795;msg=10">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=10">mbox</a>, <a href="#9">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="11"></a>
<!-- request_addr: Michael Vogt &lt;mvo@ubuntu.com&gt; -->
<!-- time:1401456244 -->
<strong>Acknowledgement sent</strong>
to <code>Michael Vogt &lt;mvo@ubuntu.com&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>APT Development Team &lt;deity@lists.debian.org&gt;</code>.
 (Fri, 30 May 2014 13:24:04 GMT) (<a href="bugreport.cgi?bug=749795;msg=12">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=12">mbox</a>, <a href="#11">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="13"></a><a name="msg13"></a><a href="#13">Message #13</a> received at submit@bugs.debian.org (<a href="bugreport.cgi?bug=749795;msg=13">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=13">mbox</a>, <a href="mailto:749795@bugs.debian.org?subject=Re%3A%20Bug%23749795%3A%20apt%3A%20no%20authentication%20checks%20for%20source%20packages&amp;References=%3C20140529210434.GA3935%40jwilk.net%3E%0A%20%3C20140530132120.GA9713%40bod%3E&amp;In-Reply-To=%3C20140530132120.GA9713%40bod%3E&amp;body=On%20Fri%2C%2030%20May%202014%2015%3A21%3A20%20%2B0200%20Michael%20Vogt%20%3Cmvo%40ubuntu.com%3E%20wrote%3A%0A%3E%20On%20Thu%2C%20May%2029%2C%202014%20at%2011%3A04%3A35PM%20%2B0200%2C%20Jakub%20Wilk%20wrote%3A%0A%3E%20%3E%20Package%3A%20apt%0A%3E%20%3E%20Version%3A%201.0.3%0A%3E%20%3E%20Severity%3A%20grave%0A%3E%20%3E%20Tags%3A%20security%0A%3E%20%0A%3E%20Thanks%20for%20your%20bugreport.%20You%20raise%20a%20important%20issue%2C%20but%20I%20agree%0A%3E%20with%20David%20that%20its%20best%20if%20this%20goes%20through%20the%20security%20team%20for%0A%3E%20coordination.%0A%3E%20%20%0A%3E%20%3E%20I%27ve%20been%20investigating%20how%20apt%20behaves%20when%20the%20repository%20doesn%27t%0A%3E%20%3E%20contain%20any%20Release%20signatures%20%28possibly%20because%20they%20were%20stripped%0A%3E%20%3E%20off%20by%20a%20man-in-the-middle%20attacker%29.%0A%3E%20%3E%20%0A%3E%20%3E%20This%20is%20what%20I%20found%20out%3A%0A%3E%20%3E%20%0A%3E%20%3E%20%7C%20%23%20cat%20%2Fetc%2Fapt%2Fsources.list%0A%3E%20%3E%20%7C%20deb%20http%3A%2F%2Fftp.debian.org%2Fdebian%2F%20unstable%20main%0A%3E%20%3E%20%7C%20deb-src%20http%3A%2F%2Fftp.debian.org%2Fdebian%2F%20unstable%20main%0A%3E%20%3E%20%7C%0A%3E%20%3E%20%7C%20%23%20apt-get%20update%0A%3E%20%3E%20%7C%20Ign%20http%3A%2F%2Fftp.debian.org%20unstable%20InRelease%0A%3E%20%3E%20%7C%20Ign%20http%3A%2F%2Fftp.debian.org%20unstable%20Release.gpg%0A%3E%20%3E%20%7C%20Get%3A1%20http%3A%2F%2Fftp.debian.org%20unstable%20Release%20%5B205%20kB%5D%0A%3E%20%3E%20%7C%20Get%3A2%20http%3A%2F%2Fftp.debian.org%20unstable%2Fmain%20Sources%20%5B7249%20kB%5D%0A%3E%20%3E%20%7C%20Get%3A3%20http%3A%2F%2Fftp.debian.org%20unstable%2Fmain%20amd64%20Packages%20%5B6758%20kB%5D%0A%3E%20%3E%20%7C%20Fetched%2014.2%20MB%20in%2029s%20%28479%20kB%2Fs%29%0A%3E%20%3E%20%7C%20Reading%20package%20lists...%20Done%0A%3E%20%3E%20%7C%0A%3E%20%3E%20%7C%20%23%20echo%20%24%3F%0A%3E%20%3E%20%7C%200%0A%3E%20%3E%20%0A%3E%20%3E%20Hmm.%20There%20is%20no%20warning%20suggesting%20that%20anything%20fishy%20is%20going%20on%2C%0A%3E%20%3E%20and%20the%20exit%20code%20indicates%20success.%20%28Perhaps%20the%20%22Ign%22s%20could%20raise%0A%3E%20%3E%20suspicion%20of%20an%20observant%20sysadmin.%20But%20who%20knows%20what%20%22Ign%22%20exactly%0A%3E%20%3E%20means%3F%20At%20least%20the%20apt-get%281%29%20manpage%20doesn%27t%20know.%29%0A%3E%20%0A%3E%20Right%2C%20I%20think%20apt%20should%20show%20a%20more%20prominent%20warning%20here.%20I%20will%0A%3E%20look%20into%20this%20next.%0A%3E%20%20%0A%3E%20%5B..%5D%0A%3E%20%3E%20So%20far%2C%20so%20good.%20However%2C%20apt-get%20happily%20downloads%20unauthenticated%0A%3E%20%3E%20source%20packages%2C%20with%20no%20warning%3A%0A%3E%20%3E%20%0A%3E%20%3E%20%7C%20%24%20apt-get%20source%20-d%20nyancat%0A%3E%20%3E%20%7C%20Reading%20package%20lists...%20Done%0A%3E%20%3E%20%7C%20Building%20dependency%20tree%0A%3E%20%3E%20%7C%20Reading%20state%20information...%20Done%0A%3E%20%3E%20%7C%20Selected%20version%20%271.2.2-1%27%20%28unstable%29%20for%20nyancat%0A%3E%20%3E%20%7C%20Need%20to%20get%2020.6%20kB%20of%20source%20archives.%0A%3E%20%3E%20%7C%20Get%3A1%20http%3A%2F%2Fftp.debian.org%2Fdebian%2F%20unstable%2Fmain%20nyancat%201.2.2-1%20%28dsc%29%20%5B1782%20B%5D%0A%3E%20%3E%20%7C%20Get%3A2%20http%3A%2F%2Fftp.debian.org%2Fdebian%2F%20unstable%2Fmain%20nyancat%201.2.2-1%20%28tar%29%20%5B14.1%20kB%5D%0A%3E%20%3E%20%7C%20Get%3A3%20http%3A%2F%2Fftp.debian.org%2Fdebian%2F%20unstable%2Fmain%20nyancat%201.2.2-1%20%28diff%29%20%5B4748%20B%5D%0A%3E%20%3E%20%7C%20Fetched%2020.6%20kB%20in%200s%20%281838%20kB%2Fs%29%0A%3E%20%3E%20%7C%20Download%20complete%20and%20in%20download%20only%20mode%0A%3E%20%5B..%5D%0A%3E%20%0A%3E%20Indeed%2C%20this%20is%20a%20problem%20that%20needs%20fixing.%20Attached%20is%20a%20patch%20that%0A%3E%20addresses%20the%20issue.%0A%3E%20%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=mvo%40ubuntu.com" alt="">
<div class="header"><span class="headerfield">From:</span> Michael Vogt &lt;mvo@ubuntu.com&gt;</div>
<div class="header"><span class="headerfield">To:</span> Jakub Wilk &lt;jwilk@debian.org&gt;, 749795@bugs.debian.org</div>
<div class="header"><span class="headerfield">Cc:</span> Debian Bug Tracking System &lt;submit@bugs.debian.org&gt;</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#749795: apt: no authentication checks for source packages</div>
<div class="header"><span class="headerfield">Date:</span> Fri, 30 May 2014 15:21:20 +0200</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=0;bug=749795;msg=13">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message">On Thu, May 29, 2014 at 11:04:35PM +0200, Jakub Wilk wrote:
&gt; Package: apt
&gt; Version: 1.0.3
&gt; Severity: grave
&gt; Tags: security

Thanks for your bugreport. You raise a important issue, but I agree
with David that its best if this goes through the security team for
coordination.
 
&gt; I&#39;ve been investigating how apt behaves when the repository doesn&#39;t
&gt; contain any Release signatures (possibly because they were stripped
&gt; off by a man-in-the-middle attacker).
&gt; 
&gt; This is what I found out:
&gt; 
&gt; | # cat /etc/apt/sources.list
&gt; | deb <a href="http://ftp.debian.org/debian/">http://ftp.debian.org/debian/</a> unstable main
&gt; | deb-src <a href="http://ftp.debian.org/debian/">http://ftp.debian.org/debian/</a> unstable main
&gt; |
&gt; | # apt-get update
&gt; | Ign <a href="http://ftp.debian.org">http://ftp.debian.org</a> unstable InRelease
&gt; | Ign <a href="http://ftp.debian.org">http://ftp.debian.org</a> unstable Release.gpg
&gt; | Get:1 <a href="http://ftp.debian.org">http://ftp.debian.org</a> unstable Release [205 kB]
&gt; | Get:2 <a href="http://ftp.debian.org">http://ftp.debian.org</a> unstable/main Sources [7249 kB]
&gt; | Get:3 <a href="http://ftp.debian.org">http://ftp.debian.org</a> unstable/main amd64 Packages [6758 kB]
&gt; | Fetched 14.2 MB in 29s (479 kB/s)
&gt; | Reading package lists... Done
&gt; |
&gt; | # echo $?
&gt; | 0
&gt; 
&gt; Hmm. There is no warning suggesting that anything fishy is going on,
&gt; and the exit code indicates success. (Perhaps the &quot;Ign&quot;s could raise
&gt; suspicion of an observant sysadmin. But who knows what &quot;Ign&quot; exactly
&gt; means? At least the apt-get(1) manpage doesn&#39;t know.)

Right, I think apt should show a more prominent warning here. I will
look into this next.
 
[..]
&gt; So far, so good. However, apt-get happily downloads unauthenticated
&gt; source packages, with no warning:
&gt; 
&gt; | $ apt-get source -d nyancat
&gt; | Reading package lists... Done
&gt; | Building dependency tree
&gt; | Reading state information... Done
&gt; | Selected version &#39;1.2.2-1&#39; (unstable) for nyancat
&gt; | Need to get 20.6 kB of source archives.
&gt; | Get:1 <a href="http://ftp.debian.org/debian/">http://ftp.debian.org/debian/</a> unstable/main nyancat 1.2.2-1 (dsc) [1782 B]
&gt; | Get:2 <a href="http://ftp.debian.org/debian/">http://ftp.debian.org/debian/</a> unstable/main nyancat 1.2.2-1 (tar) [14.1 kB]
&gt; | Get:3 <a href="http://ftp.debian.org/debian/">http://ftp.debian.org/debian/</a> unstable/main nyancat 1.2.2-1 (diff) [4748 B]
&gt; | Fetched 20.6 kB in 0s (1838 kB/s)
&gt; | Download complete and in download only mode
[..]

Indeed, this is a problem that needs fixing. Attached is a patch that
addresses the issue.

Cheers,
 Michael
</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=749795;filename=0001-Show-unauthenticated-warning-for-source-packages-as-.patch;msg=13">0001-Show-unauthenticated-warning-for-source-packages-as-.patch</a> (text/x-diff, attachment)]</pre>

<div class="infmessage"><hr><p>
<a name="14"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, APT Development Team &lt;deity@lists.debian.org&gt; -->
<!-- time:1401456256 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, APT Development Team &lt;deity@lists.debian.org&gt;</code>:<br>
<code>Bug#749795</code>; Package <code>apt</code>.
 (Fri, 30 May 2014 13:24:16 GMT) (<a href="bugreport.cgi?bug=749795;msg=15">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=15">mbox</a>, <a href="#14">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="16"></a>
<!-- request_addr: Michael Vogt &lt;mvo@ubuntu.com&gt; -->
<!-- time:1401456256 -->
<strong>Acknowledgement sent</strong>
to <code>Michael Vogt &lt;mvo@ubuntu.com&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>APT Development Team &lt;deity@lists.debian.org&gt;</code>.
 (Fri, 30 May 2014 13:24:16 GMT) (<a href="bugreport.cgi?bug=749795;msg=17">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=17">mbox</a>, <a href="#16">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="19"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, APT Development Team &lt;deity@lists.debian.org&gt; -->
<!-- time:1401487927 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, APT Development Team &lt;deity@lists.debian.org&gt;</code>:<br>
<code>Bug#749795</code>; Package <code>apt</code>.
 (Fri, 30 May 2014 22:12:07 GMT) (<a href="bugreport.cgi?bug=749795;msg=20">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=20">mbox</a>, <a href="#19">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="21"></a>
<!-- request_addr: David Kalnischkies &lt;david@kalnischkies.de&gt; -->
<!-- time:1401487928 -->
<strong>Acknowledgement sent</strong>
to <code>David Kalnischkies &lt;david@kalnischkies.de&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>APT Development Team &lt;deity@lists.debian.org&gt;</code>.
 (Fri, 30 May 2014 22:12:08 GMT) (<a href="bugreport.cgi?bug=749795;msg=22">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=22">mbox</a>, <a href="#21">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="23"></a><a name="msg23"></a><a href="#23">Message #23</a> received at 749795@bugs.debian.org (<a href="bugreport.cgi?bug=749795;msg=23">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=23">mbox</a>, <a href="mailto:749795@bugs.debian.org?subject=Re%3A%20Bug%23749795%3A%20apt%3A%20no%20authentication%20checks%20for%20source%20packages&amp;References=%3C20140529210434.GA3935%40jwilk.net%3E%0A%20%3C20140530132120.GA9713%40bod%3E%0A%20%3C20140530220748.GA27520%40crossbow%3E&amp;body=On%20Sat%2C%2031%20May%202014%2000%3A07%3A48%20%2B0200%20David%20Kalnischkies%20%3Cdavid%40kalnischkies.de%3E%20wrote%3A%0A%3E%20On%20Fri%2C%20May%2030%2C%202014%20at%2003%3A21%3A20PM%20%2B0200%2C%20Michael%20Vogt%20wrote%3A%0A%3E%20%3E%20%3EFrom%20b7f501b5cc8583f61467f0c7a0282acbb88e4b29%20Mon%20Sep%2017%2000%3A00%3A00%202001%0A%3E%20%3E%20From%3A%20Michael%20Vogt%20%3Cmvo%40debian.org%3E%0A%3E%20%3E%20Date%3A%20Fri%2C%2030%20May%202014%2014%3A47%3A56%20%2B0200%0A%3E%20%3E%20Subject%3A%20%5BPATCH%5D%20Show%20unauthenticated%20warning%20for%20source%20packages%20as%20well%0A%3E%20%3E%20%0A%3E%20%3E%20This%20will%20show%20the%20same%20unauthenticated%20warning%20for%20source%20packages%0A%3E%20%3E%20as%20for%20binary%20packages%20and%20will%20not%20download%20a%20source%20package%20if%0A%3E%20%3E%20it%20is%20unauthenticated.%20This%20can%20be%20overriden%20with%0A%3E%20%0A%3E%20typo%3A%20overridden%0A%3E%20%0A%3E%20%3E%20%2B%20%20%20%2F%2F%20check%20authentication%20status%20of%20the%20source%20as%20well%0A%3E%20%3E%20%2B%20%20%20if%20%28UntrustedList%20%21%3D%20%22%22%20%26%26%20%21AuthPrompt%28UntrustedList%2C%20true%29%29%0A%3E%20%3E%20%2B%20%20%20%20%20%20return%20false%3B%0A%3E%20%0A%3E%20As%20said%2C%20I%20don%27t%20think%20%27apt-get%20source%27%20should%20be%20interactive%2C%20so%20this%0A%3E%20true%20should%20be%20a%20false%2C%20right%3F%0A%3E%20%0A%3E%20Reasons%20%28as%20a%20repeat%29%3A%0A%3E%20-%20it%20was%20not%20interactive%20before%0A%3E%20-%20the%20error%20message%20on%20%27no%27%20talks%20about%20install%2C%20so%20we%20would%20need%20a%20new%0A%3E%20%20%20string%0A%3E%20-%20%27apt-get%20download%27%20isn%27t%20interactive%20either%0A%3E%20%28-%20it%20is%20more%20in%20line%20with%20your%20own%20commit%20summary%29%0A%3E%20%0A%3E%20Counter%20arguments%3F%0A%3E%20%0A%3E%20%0A%3E%20Best%20regards%0A%3E%20%0A%3E%20David%20Kalnischkies%0A&amp;In-Reply-To=%3C20140530220748.GA27520%40crossbow%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=david%40kalnischkies.de" alt="">
<div class="header"><span class="headerfield">From:</span> David Kalnischkies &lt;david@kalnischkies.de&gt;</div>
<div class="header"><span class="headerfield">To:</span> Michael Vogt &lt;mvo@ubuntu.com&gt;, 749795@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#749795: apt: no authentication checks for source packages</div>
<div class="header"><span class="headerfield">Date:</span> Sat, 31 May 2014 00:07:48 +0200</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=0;bug=749795;msg=23">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message">On Fri, May 30, 2014 at 03:21:20PM +0200, Michael Vogt wrote:
&gt; &gt;From b7f501b5cc8583f61467f0c7a0282acbb88e4b29 Mon Sep 17 00:00:00 2001
&gt; From: Michael Vogt &lt;mvo@debian.org&gt;
&gt; Date: Fri, 30 May 2014 14:47:56 +0200
&gt; Subject: [PATCH] Show unauthenticated warning for source packages as well
&gt; 
&gt; This will show the same unauthenticated warning for source packages
&gt; as for binary packages and will not download a source package if
&gt; it is unauthenticated. This can be overriden with

typo: overridden

&gt; +   // check authentication status of the source as well
&gt; +   if (UntrustedList != &quot;&quot; &amp;&amp; !AuthPrompt(UntrustedList, true))
&gt; +      return false;

As said, I don&#39;t think &#39;apt-get source&#39; should be interactive, so this
true should be a false, right?

Reasons (as a repeat):
- it was not interactive before
- the error message on &#39;no&#39; talks about install, so we would need a new
  string
- &#39;apt-get download&#39; isn&#39;t interactive either
(- it is more in line with your own commit summary)

Counter arguments?


Best regards

David Kalnischkies
</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=749795;filename=signature.asc;msg=23">signature.asc</a> (application/pgp-signature, inline)]</pre>

<div class="infmessage"><hr><p>
<a name="24"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, APT Development Team &lt;deity@lists.debian.org&gt; -->
<!-- time:1401691864 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, APT Development Team &lt;deity@lists.debian.org&gt;</code>:<br>
<code>Bug#749795</code>; Package <code>apt</code>.
 (Mon, 02 Jun 2014 06:51:04 GMT) (<a href="bugreport.cgi?bug=749795;msg=25">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=25">mbox</a>, <a href="#24">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="26"></a>
<!-- request_addr: Michael Vogt &lt;mvo@ubuntu.com&gt; -->
<!-- time:1401691864 -->
<strong>Acknowledgement sent</strong>
to <code>Michael Vogt &lt;mvo@ubuntu.com&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>APT Development Team &lt;deity@lists.debian.org&gt;</code>.
 (Mon, 02 Jun 2014 06:51:04 GMT) (<a href="bugreport.cgi?bug=749795;msg=27">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=27">mbox</a>, <a href="#26">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="28"></a><a name="msg28"></a><a href="#28">Message #28</a> received at 749795@bugs.debian.org (<a href="bugreport.cgi?bug=749795;msg=28">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=28">mbox</a>, <a href="mailto:749795@bugs.debian.org?subject=Re%3A%20Bug%23749795%3A%20apt%3A%20no%20authentication%20checks%20for%20source%20packages&amp;References=%3C20140529210434.GA3935%40jwilk.net%3E%0A%20%3C20140530132120.GA9713%40bod%3E%0A%20%3C20140530220748.GA27520%40crossbow%3E%0A%20%3C20140602064911.GC3942%40bod%3E&amp;In-Reply-To=%3C20140602064911.GC3942%40bod%3E&amp;body=On%20Mon%2C%202%20Jun%202014%2008%3A49%3A11%20%2B0200%20Michael%20Vogt%20%3Cmvo%40ubuntu.com%3E%20wrote%3A%0A%3E%20On%20Sat%2C%20May%2031%2C%202014%20at%2012%3A07%3A48AM%20%2B0200%2C%20David%20Kalnischkies%20wrote%3A%0A%3E%20%3E%20On%20Fri%2C%20May%2030%2C%202014%20at%2003%3A21%3A20PM%20%2B0200%2C%20Michael%20Vogt%20wrote%3A%0A%3E%20%3E%20%3E%20%3EFrom%20b7f501b5cc8583f61467f0c7a0282acbb88e4b29%20Mon%20Sep%2017%2000%3A00%3A00%202001%0A%3E%20%3E%20%3E%20From%3A%20Michael%20Vogt%20%3Cmvo%40debian.org%3E%0A%3E%20%3E%20%3E%20Date%3A%20Fri%2C%2030%20May%202014%2014%3A47%3A56%20%2B0200%0A%3E%20%3E%20%3E%20Subject%3A%20%5BPATCH%5D%20Show%20unauthenticated%20warning%20for%20source%20packages%20as%20well%0A%3E%20%3E%20%3E%20%0A%3E%20%3E%20%3E%20This%20will%20show%20the%20same%20unauthenticated%20warning%20for%20source%20packages%0A%3E%20%3E%20%3E%20as%20for%20binary%20packages%20and%20will%20not%20download%20a%20source%20package%20if%0A%3E%20%3E%20%3E%20it%20is%20unauthenticated.%20This%20can%20be%20overriden%20with%0A%3E%20%3E%20%0A%3E%20%3E%20typo%3A%20overridden%0A%3E%20%0A%3E%20Thanks%2C%20fixed.%0A%3E%20%20%0A%3E%20%3E%20%3E%20%2B%20%20%20%2F%2F%20check%20authentication%20status%20of%20the%20source%20as%20well%0A%3E%20%3E%20%3E%20%2B%20%20%20if%20%28UntrustedList%20%21%3D%20%22%22%20%26%26%20%21AuthPrompt%28UntrustedList%2C%20true%29%29%0A%3E%20%3E%20%3E%20%2B%20%20%20%20%20%20return%20false%3B%0A%3E%20%3E%20%0A%3E%20%3E%20As%20said%2C%20I%20don%27t%20think%20%27apt-get%20source%27%20should%20be%20interactive%2C%20so%20this%0A%3E%20%3E%20true%20should%20be%20a%20false%2C%20right%3F%0A%3E%20%3E%20%0A%3E%20%3E%20Reasons%20%28as%20a%20repeat%29%3A%0A%3E%20%3E%20-%20it%20was%20not%20interactive%20before%0A%3E%20%3E%20-%20the%20error%20message%20on%20%27no%27%20talks%20about%20install%2C%20so%20we%20would%20need%20a%20new%0A%3E%20%3E%20%20%20string%0A%3E%20%3E%20-%20%27apt-get%20download%27%20isn%27t%20interactive%20either%0A%3E%20%3E%20%28-%20it%20is%20more%20in%20line%20with%20your%20own%20commit%20summary%29%0A%3E%20%3E%20%0A%3E%20%3E%20Counter%20arguments%3F%0A%3E%20%5B..%5D%0A%3E%20%0A%3E%20Good%20point%21%20No%20counter%20arguments%2C%20the%20risk%20of%20breaking%20script%20by%0A%3E%20prompting%20is%20indeed%20a%20good%20reason%20not%20to%20show%20the%20prompt%20%28and%20we%20do%0A%3E%20the%20same%20for%20download%29.%0A%3E%20%0A%3E%20I%20changed%20it%20to%20non-interactive%20now.%0A%3E%20%0A%3E%20Cheers%2C%0A%3E%20%20Michael%0A%3E%20%0A%3E%20%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=mvo%40ubuntu.com" alt="">
<div class="header"><span class="headerfield">From:</span> Michael Vogt &lt;mvo@ubuntu.com&gt;</div>
<div class="header"><span class="headerfield">To:</span> David Kalnischkies &lt;david@kalnischkies.de&gt;</div>
<div class="header"><span class="headerfield">Cc:</span> 749795@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#749795: apt: no authentication checks for source packages</div>
<div class="header"><span class="headerfield">Date:</span> Mon, 2 Jun 2014 08:49:11 +0200</div>
</div>
<pre class="message">On Sat, May 31, 2014 at 12:07:48AM +0200, David Kalnischkies wrote:
&gt; On Fri, May 30, 2014 at 03:21:20PM +0200, Michael Vogt wrote:
&gt; &gt; &gt;From b7f501b5cc8583f61467f0c7a0282acbb88e4b29 Mon Sep 17 00:00:00 2001
&gt; &gt; From: Michael Vogt &lt;mvo@debian.org&gt;
&gt; &gt; Date: Fri, 30 May 2014 14:47:56 +0200
&gt; &gt; Subject: [PATCH] Show unauthenticated warning for source packages as well
&gt; &gt; 
&gt; &gt; This will show the same unauthenticated warning for source packages
&gt; &gt; as for binary packages and will not download a source package if
&gt; &gt; it is unauthenticated. This can be overriden with
&gt; 
&gt; typo: overridden

Thanks, fixed.
 
&gt; &gt; +   // check authentication status of the source as well
&gt; &gt; +   if (UntrustedList != &quot;&quot; &amp;&amp; !AuthPrompt(UntrustedList, true))
&gt; &gt; +      return false;
&gt; 
&gt; As said, I don&#39;t think &#39;apt-get source&#39; should be interactive, so this
&gt; true should be a false, right?
&gt; 
&gt; Reasons (as a repeat):
&gt; - it was not interactive before
&gt; - the error message on &#39;no&#39; talks about install, so we would need a new
&gt;   string
&gt; - &#39;apt-get download&#39; isn&#39;t interactive either
&gt; (- it is more in line with your own commit summary)
&gt; 
&gt; Counter arguments?
[..]

Good point! No counter arguments, the risk of breaking script by
prompting is indeed a good reason not to show the prompt (and we do
the same for download).

I changed it to non-interactive now.

Cheers,
 Michael


</pre>

<div class="msgreceived"><hr><p>
<a name="29"></a>
<!-- request_addr: Michael Vogt &lt;mvo@debian.org&gt; -->
<!-- time:1402415486 -->
<strong>Reply sent</strong>
to <code>Michael Vogt &lt;mvo@debian.org&gt;</code>:<br>
You have taken responsibility.
 (Tue, 10 Jun 2014 15:51:26 GMT) (<a href="bugreport.cgi?bug=749795;msg=30">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=30">mbox</a>, <a href="#29">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="31"></a>
<!-- request_addr: Jakub Wilk &lt;jwilk@debian.org&gt; -->
<!-- time:1402415486 -->
<strong>Notification sent</strong>
to <code>Jakub Wilk &lt;jwilk@debian.org&gt;</code>:<br>
Bug acknowledged by developer.
 (Tue, 10 Jun 2014 15:51:26 GMT) (<a href="bugreport.cgi?bug=749795;msg=32">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=32">mbox</a>, <a href="#31">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="33"></a><a name="msg33"></a><a href="#33">Message #33</a> received at 749795-close@bugs.debian.org (<a href="bugreport.cgi?bug=749795;msg=33">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=33">mbox</a>, <a href="mailto:749795@bugs.debian.org?subject=Re%3A%20Bug%23749795%3A%20fixed%20in%20apt%201.0.4&amp;References=%3CE1WuOIz-0000kT-NJ%40franck.debian.org%3E&amp;body=On%20Tue%2C%2010%20Jun%202014%2015%3A49%3A45%20%2B0000%20Michael%20Vogt%20%3Cmvo%40debian.org%3E%20wrote%3A%0A%3E%20Source%3A%20apt%0A%3E%20Source-Version%3A%201.0.4%0A%3E%20%0A%3E%20We%20believe%20that%20the%20bug%20you%20reported%20is%20fixed%20in%20the%20latest%20version%20of%0A%3E%20apt%2C%20which%20is%20due%20to%20be%20installed%20in%20the%20Debian%20FTP%20archive.%0A%3E%20%0A%3E%20A%20summary%20of%20the%20changes%20between%20this%20version%20and%20the%20previous%20one%20is%0A%3E%20attached.%0A%3E%20%0A%3E%20Thank%20you%20for%20reporting%20the%20bug%2C%20which%20will%20now%20be%20closed.%20%20If%20you%0A%3E%20have%20further%20comments%20please%20address%20them%20to%20749795%40bugs.debian.org%2C%0A%3E%20and%20the%20maintainer%20will%20reopen%20the%20bug%20report%20if%20appropriate.%0A%3E%20%0A%3E%20Debian%20distribution%20maintenance%20software%0A%3E%20pp.%0A%3E%20Michael%20Vogt%20%3Cmvo%40debian.org%3E%20%28supplier%20of%20updated%20apt%20package%29%0A%3E%20%0A%3E%20%28This%20message%20was%20generated%20automatically%20at%20their%20request%3B%20if%20you%0A%3E%20believe%20that%20there%20is%20a%20problem%20with%20it%20please%20contact%20the%20archive%0A%3E%20administrators%20by%20mailing%20ftpmaster%40ftp-master.debian.org%29%0A%3E%20%0A%3E%20%0A%3E%20-----BEGIN%20PGP%20SIGNED%20MESSAGE-----%0A%3E%20Hash%3A%20SHA1%0A%3E%20%0A%3E%20Format%3A%201.8%0A%3E%20Date%3A%20Tue%2C%2010%20Jun%202014%2014%3A55%3A05%20%2B0200%0A%3E%20Source%3A%20apt%0A%3E%20Binary%3A%20apt%20libapt-pkg4.12%20libapt-inst1.5%20apt-doc%20libapt-pkg-dev%20libapt-pkg-doc%20apt-utils%20apt-transport-https%0A%3E%20Architecture%3A%20source%20all%20amd64%0A%3E%20Version%3A%201.0.4%0A%3E%20Distribution%3A%20unstable%0A%3E%20Urgency%3A%20low%0A%3E%20Maintainer%3A%20APT%20Development%20Team%20%3Cdeity%40lists.debian.org%3E%0A%3E%20Changed-By%3A%20Michael%20Vogt%20%3Cmvo%40debian.org%3E%0A%3E%20Description%3A%0A%3E%20%20apt%20%20%20%20%20%20%20%20-%20commandline%20package%20manager%0A%3E%20%20apt-doc%20%20%20%20-%20documentation%20for%20APT%0A%3E%20%20apt-transport-https%20-%20https%20download%20transport%20for%20APT%0A%3E%20%20apt-utils%20%20-%20package%20management%20related%20utility%20programs%0A%3E%20%20libapt-inst1.5%20-%20deb%20package%20format%20runtime%20library%0A%3E%20%20libapt-pkg-dev%20-%20development%20files%20for%20APT%27s%20libapt-pkg%20and%20libapt-inst%0A%3E%20%20libapt-pkg-doc%20-%20documentation%20for%20APT%20development%0A%3E%20%20libapt-pkg4.12%20-%20package%20management%20runtime%20library%0A%3E%20Closes%3A%20742835%20745046%20747942%20748389%20748430%20749795%20750009%0A%3E%20Changes%3A%0A%3E%20%20apt%20%281.0.4%29%20unstable%3B%20urgency%3Dlow%0A%3E%20%20.%0A%3E%20%20%20%20%5B%20Michael%20Vogt%20%5D%0A%3E%20%20%20%20%2A%20Implement%20CacheDB%20for%20source%20packages%20in%20apt-ftparchive%0A%3E%20%20%20%20%2A%20apt-private%2Facqprogress.cc%3A%20reset%20color%20in%20apt%20update%0A%3E%20%20%20%20%2A%20Show%20progress%20in%20run-tests%0A%3E%20%20%20%20%2A%20Never%20parse%20Version%2FArchitecture%20tags%20in%20a%20Translation-%24lang%20file%0A%3E%20%20%20%20%2A%20Show%20upgradable%20packages%20after%20apt%20update%20%28Closes%3A%20748389%29%0A%3E%20%20%20%20%2A%20Fix%20various%20errors%20found%20by%20clang%20-fsanitize%3Daddress%0A%3E%20%20%20%20%2A%20Fix%20various%20errors%20foudn%20by%20clang%20scan-build%0A%3E%20%20%20%20%2A%20Show%20unauthenticated%20warning%20for%20source%20packages%20as%20well%20%28Closes%3A%20%23749795%29%0A%3E%20%20%20%20%2A%20Add%20compat%20mode%20for%20old%20%2832bit%20FileSize%29%20CacheDB%20%28LP%3A%20%231274466%29%0A%3E%20%20%20%20%2A%20cmdline%2Fapt-helper.cc%3A%20use%20less%20generic%20description%2Fshort-description%0A%3E%20%20%20%20%20%20in%20apt-helper%20download%0A&amp;In-Reply-To=%3CE1WuOIz-0000kT-NJ%40franck.debian.org%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=mvo%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Michael Vogt &lt;mvo@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> 749795-close@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Bug#749795: fixed in apt 1.0.4</div>
<div class="header"><span class="headerfield">Date:</span> Tue, 10 Jun 2014 15:49:45 +0000</div>
</div>
<pre class="message">Source: apt
Source-Version: 1.0.4

We believe that the bug you reported is fixed in the latest version of
apt, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 749795@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Michael Vogt &lt;mvo@debian.org&gt; (supplier of updated apt package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.8
Date: Tue, 10 Jun 2014 14:55:05 +0200
Source: apt
Binary: apt libapt-pkg4.12 libapt-inst1.5 apt-doc libapt-pkg-dev libapt-pkg-doc apt-utils apt-transport-https
Architecture: source all amd64
Version: 1.0.4
Distribution: unstable
Urgency: low
Maintainer: APT Development Team &lt;deity@lists.debian.org&gt;
Changed-By: Michael Vogt &lt;mvo@debian.org&gt;
Description:
 apt        - commandline package manager
 apt-doc    - documentation for APT
 apt-transport-https - https download transport for APT
 apt-utils  - package management related utility programs
 libapt-inst1.5 - deb package format runtime library
 libapt-pkg-dev - development files for APT&#39;s libapt-pkg and libapt-inst
 libapt-pkg-doc - documentation for APT development
 libapt-pkg4.12 - package management runtime library
Closes: <a href="bugreport.cgi?bug=742835">742835</a> <a href="bugreport.cgi?bug=745046">745046</a> <a href="bugreport.cgi?bug=747942">747942</a> <a href="bugreport.cgi?bug=748389">748389</a> <a href="bugreport.cgi?bug=748430">748430</a> <a href="bugreport.cgi?bug=749795">749795</a> <a href="bugreport.cgi?bug=750009">750009</a>
Changes:
 apt (1.0.4) unstable; urgency=low
 .
   [ Michael Vogt ]
   * Implement CacheDB for source packages in apt-ftparchive
   * apt-private/acqprogress.cc: reset color in apt update
   * Show progress in run-tests
   * Never parse Version/Architecture tags in a Translation-$lang file
   * Show upgradable packages after apt update (Closes: <a href="bugreport.cgi?bug=748389">748389</a>)
   * Fix various errors found by clang -fsanitize=address
   * Fix various errors foudn by clang scan-build
   * Show unauthenticated warning for source packages as well (Closes: #<a href="bugreport.cgi?bug=749795">749795</a>)
   * Add compat mode for old (32bit FileSize) CacheDB (LP: #1274466)
   * cmdline/apt-helper.cc: use less generic description/short-description
     in apt-helper download
   * add pkgSrcRecords::Step() to step through all the pkgSrcRecords
     (thanks to Helmut Grohne)
 .
   [ David Kalnischkies ]
   * initialize Verify in second pkgAcqIndex constructor
   * consistently fail if Smart* packagemanager actions fail
   * fix tight loop detection and temporary removes
   * if Resolver fails, do not continue even if not broken
   * check exit status of external solvers
   * do not revert candidate for protected packages (Closes: <a href="bugreport.cgi?bug=745046">745046</a>)
   * support Acquire::GzipIndexes in dumpavail (Closes: <a href="bugreport.cgi?bug=742835">742835</a>)
 .
   [ Stefano Zacchiroli ]
   * EDSP doc: fix typo in Request stanza description
   * EDSP: bump protocol version to 0.5
   * EDSP: add Architecture(s) multi-arch fields to the Request stanza
   * EDSP: add Source field to Package stanzas
   * EDSP: add APT-Release field to Package stanzas
 .
   [ Sebastian Schmidt ]
   * fix screen width detection for apt/apt-get lists (Closes: <a href="bugreport.cgi?bug=748430">748430</a>, <a href="bugreport.cgi?bug=747942">747942</a>)
 .
   [ Milo Casagrande ]
   * Italian program translation update (Closes: <a href="bugreport.cgi?bug=750009">750009</a>)
Checksums-Sha1:
 5012b3eedb72a72ca69ffabbdbeb1085fafa5579 1716 apt_1.0.4.dsc
 e0c1cb8cb6f6a861285ea0bf2c676a3e418f6b2d 1776932 apt_1.0.4.tar.xz
 ab36a1e23185e32843c256dc6041a389c116b658 271722 apt-doc_1.0.4_all.deb
 bb5d2f932b02b6931df0faae8c514e25643ff103 770516 libapt-pkg-doc_1.0.4_all.deb
 1fc3f3a79460a1340c74c6cb3a24a99b27a28470 749480 libapt-pkg4.12_1.0.4_amd64.deb
 dfab4ae6117a23fe31aadb1250af3fa845078529 164442 libapt-inst1.5_1.0.4_amd64.deb
 ae398139586d0c54a859062c469bea4878cfa276 1062828 apt_1.0.4_amd64.deb
 d0c1e3112ae6a1722697725ff7831ce1eeeacf0b 189120 libapt-pkg-dev_1.0.4_amd64.deb
 eba44caba84d5925aaa1aaac28f0b5d61dbbd526 355048 apt-utils_1.0.4_amd64.deb
 2cd4430d01c7a6540319518786ad72b8f4989009 131300 apt-transport-https_1.0.4_amd64.deb
Checksums-Sha256:
 fcf12c38d105e0c4bde1761ba4ccaeec687f99e52ef2ef57898502aba78f9bf9 1716 apt_1.0.4.dsc
 bc1ae079f4608f5d60963bf0646a899329ba2fd54b2a34a5a57bcd1a29f95c7e 1776932 apt_1.0.4.tar.xz
 c39908954314bc4d2255e797dd5c1277e238b899175f979b305511a522cde2b3 271722 apt-doc_1.0.4_all.deb
 071510242264073073900600e3d49e53ca7bc70e4b6cd8856b7e5004ab5ce8f2 770516 libapt-pkg-doc_1.0.4_all.deb
 d044473e47d7c43cce4e5fe411fd9e0a8136f12de793d67333f27bfe49592940 749480 libapt-pkg4.12_1.0.4_amd64.deb
 dd501debd8f3cf26487b31acf122d4707a91dce8c5fe4394622fc66ceffd3ff2 164442 libapt-inst1.5_1.0.4_amd64.deb
 9133b9e1c43a6dd36c485875fe01b56aadc1d896da1396f7b848b8935f89eae3 1062828 apt_1.0.4_amd64.deb
 1c8d0c6b09f54f7ffd38da0b7d6ffbfbaf0b201b07f10e28dd3a7e41dd29cf76 189120 libapt-pkg-dev_1.0.4_amd64.deb
 32b8e05637e666960329b8088120a0b3e101c0b6446a4d81c2fa4eed7f0a3f97 355048 apt-utils_1.0.4_amd64.deb
 8ae733c28411984a63b4c53a93b0842d06fc925ac913a3fc78129070b7c8ea4b 131300 apt-transport-https_1.0.4_amd64.deb
Files:
 0788362911f30214667b49eca5bbdc4a 271722 doc optional apt-doc_1.0.4_all.deb
 080b8e6bb21fc37ba55358c852a92a11 770516 doc optional libapt-pkg-doc_1.0.4_all.deb
 0d7c7739ad82da0b3307691ec6547ee0 749480 libs important libapt-pkg4.12_1.0.4_amd64.deb
 db9a0fb1408646e59f12d66e0e968952 164442 libs important libapt-inst1.5_1.0.4_amd64.deb
 838d4d1f9276022b2cf607ce1144f69f 1062828 admin important apt_1.0.4_amd64.deb
 aa1c9f8f2f1014bc881eb005e7b80473 189120 libdevel optional libapt-pkg-dev_1.0.4_amd64.deb
 dc0d7ffeefb9c2d4e258dca8bebfec8f 355048 admin important apt-utils_1.0.4_amd64.deb
 447f3686b24ec1277ab99b972dc20eef 131300 admin optional apt-transport-https_1.0.4_amd64.deb
 39b9a5cdda52d708f827a85a0a0f353a 1716 admin important apt_1.0.4.dsc
 164852d9b08178b8212fa78daa08e6f2 1776932 admin important apt_1.0.4.tar.xz

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iEYEARECAAYFAlOXEQ8ACgkQliSD4VZixzSVNACfeq5v8DBcV0aBoY/mJLIbli38
fO8Ani++44JL+oC7GYGh5iZh18nzu8i5
=ke43
-----END PGP SIGNATURE-----



</pre>

<div class="infmessage"><hr><p>
<a name="34"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, APT Development Team &lt;deity@lists.debian.org&gt; -->
<!-- time:1402528144 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, APT Development Team &lt;deity@lists.debian.org&gt;</code>:<br>
<code>Bug#749795</code>; Package <code>apt</code>.
 (Wed, 11 Jun 2014 23:09:04 GMT) (<a href="bugreport.cgi?bug=749795;msg=35">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=35">mbox</a>, <a href="#34">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="36"></a>
<!-- request_addr: Christoph Anton Mitterer &lt;calestyo@scientia.net&gt; -->
<!-- time:1402528144 -->
<strong>Acknowledgement sent</strong>
to <code>Christoph Anton Mitterer &lt;calestyo@scientia.net&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>APT Development Team &lt;deity@lists.debian.org&gt;</code>.
 (Wed, 11 Jun 2014 23:09:04 GMT) (<a href="bugreport.cgi?bug=749795;msg=37">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=37">mbox</a>, <a href="#36">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="38"></a><a name="msg38"></a><a href="#38">Message #38</a> received at 749795@bugs.debian.org (<a href="bugreport.cgi?bug=749795;msg=38">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=38">mbox</a>, <a href="mailto:749795@bugs.debian.org?subject=Re%3A%20holes%20in%20secure%20apt&amp;References=%3C1402527988.4739.34.camel%40heisenberg.scientia.net%3E&amp;In-Reply-To=%3C1402527988.4739.34.camel%40heisenberg.scientia.net%3E&amp;body=On%20Thu%2C%2012%20Jun%202014%2001%3A06%3A28%20%2B0200%20Christoph%20Anton%20Mitterer%20%3Ccalestyo%40scientia.net%3E%20wrote%3A%0A%3E%20reopen%20749795%0A%3E%20stop%0A%3E%20%0A%3E%20Hi.%0A%3E%20%0A%3E%20I%27m%20reopening%20this%20for%20now%2C%20even%20if%20the%20issue%20is%20solved%20from%20a%20technical%0A%3E%20point%20of%20view%20%28see%20below%20why%29.%0A%3E%20%0A%3E%20%0A%3E%20In%20my%20opinion%20this%20is%20really%20some%20horrible%20bug...%20probably%20it%20could%20have%0A%3E%20been%20very%20easily%20found%20by%20others%2C%20and%20we%20have%20no%20idea%20whether%20it%20was%0A%3E%20exploited%20already%20or%20not.%0A%3E%20%0A%3E%20Anyone%20who%20believed%20in%20getting%20trusted%20sources%20might%20have%20been%20attacked%0A%3E%20with%20forged%20packages%2C%20and%20even%20the%20plain%20build%20of%20such%20package%20might%0A%3E%20have%20undermined%20users%27%20security%20integrity.%0A%3E%20%0A%3E%20The%20same%20is%20the%20case%20with%20all%20debian%20build%20systems%20which%20probably%20rely%0A%3E%20on%20secure%20APT.%0A%3E%20%0A%3E%20%0A%3E%20So%20IMHO%20this%20bug%20definitely%20deserves%20a%20CVE%20and%20a%20DSA%2C...%20so%20that%20people%0A%3E%20are%20informed%20that%20there%20systems%20might%20have%20been%20compromised%20%28i.e.%20if%20an%0A%3E%20attacker%20tricked%20them%20into%20using%20forged%20sources%29...%20which%20is%20also%20why%20I%0A%3E%20reopen%20it.%0A%3E%20%0A%3E%20And%20do%20we%20need%20an%20investigation%20whether%20Debian%20an%20the%20Debian%20archives%0A%3E%20themselves%20might%20have%20been%20intruded%20that%20way%3F%0A%3E%20%0A%3E%20%0A%3E%20It%27s%20really%20saddening%20to%20see%20that%20such%20an%20issue%20could%20slip%20through%2C%0A%3E%20especially%20when%20I%27ve%20personally%20started%20already%20a%20few%20threads%20on%0A%3E%20debian-devel%20about%20the%20security%20of%20secure%20APT.%0A%3E%20The%20most%20recent%20one%20was%20IIRC%3A%0A%3E%20https%3A%2F%2Flists.debian.org%2Fdebian-devel%2F2012%2F03%2Fmsg00549.html%0A%3E%20but%20I%27ve%20had%20one%20before%2C%20I%20think.%0A%3E%20%0A%3E%20%0A%3E%20I%20think%20such%20bug%20shows%20that%20we%20can%27t%20just%20move%20on%20as%20we%20did%20till%20now...%0A%3E%20%0A%3E%20From%20the%20APT%20perspective%3A%0A%3E%20%0A%3E%20-%20Do%20we%20have%20unit%20checks%20now%20in%20APT%2C%20which%20basically%20test%20all%20commands%0A%3E%20with%20unsigned%20repos%2C%20repos%20with%20invalid%20signature%2C%20packages%20where%20the%0A%3E%20sums%20don%27t%20match%20the%20valid%20repo%20signatures%2C%20etc.%3F%0A%3E%20We%20really%20should%20have%20this%2C..%20and%20also%20check%20for%20things%20like%20expiry%0A%3E%20dates.%0A%3E%20%0A%3E%20-%20I%20also%20think%20that%20there%20should%20be%20one%20place%20of%20code%20that%20handles%20all%0A%3E%20downloads%20of%20packages%2C%20so%20that%20we%20have%20some%20rock%20solid%20functions%2C%20which%0A%3E%20do%20all%20the%20checks%20and%20verifications.%0A%3E%20%0A%3E%20-%20I%20think%20per%20default%20APT%20should%20refuse%20to%20work%20with%20unsigned%0A%3E%20repos%2Fpackages.%20One%20should%20really%20need%20some%20configuration%20switch%20or%0A%3E%20option%20that%20allows%20this.%0A%3E%20I%20don%27t%20think%20it%27s%20a%20big%20issue%2C%20since%20all%20the%20major%20repos%20are%20signed%20and%0A%3E%20even%20the%20%22end-user%22%20tools%20to%20make%20own%20repos%20%28like%20debarchiver%29%20support%0A%3E%20signing.%0A%3E%20People%20should%20simply%20be%20taught%20to%20not%20use%20unsigned%20repos...%0A%3E%20%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=calestyo%40scientia.net" alt="">
<div class="header"><span class="headerfield">From:</span> Christoph Anton Mitterer &lt;calestyo@scientia.net&gt;</div>
<div class="header"><span class="headerfield">To:</span> 749795@bugs.debian.org, debian-devel@lists.debian.org</div>
<div class="header"><span class="headerfield">Cc:</span> control@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> holes in secure apt</div>
<div class="header"><span class="headerfield">Date:</span> Thu, 12 Jun 2014 01:06:28 +0200</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=0;bug=749795;msg=38">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message">reopen 749795
stop

Hi.

I&#39;m reopening this for now, even if the issue is solved from a technical
point of view (see below why).


In my opinion this is really some horrible bug... probably it could have
been very easily found by others, and we have no idea whether it was
exploited already or not.

Anyone who believed in getting trusted sources might have been attacked
with forged packages, and even the plain build of such package might
have undermined users&#39; security integrity.

The same is the case with all debian build systems which probably rely
on secure APT.


So IMHO this bug definitely deserves a CVE and a DSA,... so that people
are informed that there systems might have been compromised (i.e. if an
attacker tricked them into using forged sources)... which is also why I
reopen it.

And do we need an investigation whether Debian an the Debian archives
themselves might have been intruded that way?


It&#39;s really saddening to see that such an issue could slip through,
especially when I&#39;ve personally started already a few threads on
debian-devel about the security of secure APT.
The most recent one was IIRC:
<a href="https://lists.debian.org/debian-devel/2012/03/msg00549.html">https://lists.debian.org/debian-devel/2012/03/msg00549.html</a>
but I&#39;ve had one before, I think.


I think such bug shows that we can&#39;t just move on as we did till now...

From the APT perspective:

- Do we have unit checks now in APT, which basically test all commands
with unsigned repos, repos with invalid signature, packages where the
sums don&#39;t match the valid repo signatures, etc.?
We really should have this,.. and also check for things like expiry
dates.

- I also think that there should be one place of code that handles all
downloads of packages, so that we have some rock solid functions, which
do all the checks and verifications.

- I think per default APT should refuse to work with unsigned
repos/packages. One should really need some configuration switch or
option that allows this.
I don&#39;t think it&#39;s a big issue, since all the major repos are signed and
even the &quot;end-user&quot; tools to make own repos (like debarchiver) support
signing.
People should simply be taught to not use unsigned repos...

- That being said,... APT should always delete all cached files (repo
lists, signature files, Package and Source lists as well as downloaded
packages) as soon as a single verification error occurred at some place.
And since 3rd party programs or users may manually take stuff from
places like /var/lib/apt/lists or /var/cache/apt/archives... these
directories should contain a subdir like &quot;unsecured/&quot; where APT
downloads stuff to and only moves it out from there once all checks have
been passed.

- In case any even just remotely possible security issue occurs... apt
should exit with a non-zero status and not just a warning wich shell
scripts from users usually won&#39;t check for.


What about 3rd party programs and Debian in general:
There are still probably many programs which download stuff without any
verification,... or just warn which may be easily overseen:
- [c]debootstrap
I think they both default now to verify signatures (which is a good
thing)... but IIRC, debootstrap also defaults to not verify anything...
if the keyrings aren&#39;t installed - admittedly this is unlikely... but
possible... I&#39;ve already had a discussion at the respective bug with
upstream, but nothing happened... I think such choices make it easily
happen for security critical situations to occur... completely
unnecessary.

- not really secure APT related: apt-listbugs
Not sure whether it uses https for getting bug infos... but since Debian
nowadays uses certs from GANDI, which we generally cannot trust,... this
is probably moot anyway.
Securely showing bugs, may be important for users, since they want to
now about bugs like &quot;big security hole in package XYZ - don&#39;t install&quot;

- apt-listchanges
Guess that uses local files an is therefore secure.

- apt-file
Last time I checked, the bug about not verifying the sums of the
Contents-* files was still open


- what about our build daemons and building tools like piuparts,
pbuilder, pbuilder-uml, debian-builder or qemubuilder
Do they use secure APT in ALL places? Is this constantly checked by some
unit tests?
Or are they easily tricked into using possibly insecure files, by
depending on exit statuses which are perhaps not != 0 in case of
security problems ... or by using files which were downloaded but not
removed when it was found out that they&#39;re insecure.

I think a package like e.g. pbuilder might easily operate insecurely...
it depends on [c]debootstrap for building... if debootstrap is used, but
debian-archive-keyring is not installed, then (IIRC) no signature
checking is done... in that case forged stuff may be downloaded,
chrooted into... and *bam* - already lost the game... and you don&#39;t even
need a hole like APT not checking files it gets with apt-get source.



Cheers,
Chris.
</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=749795;filename=smime.p7s;msg=38">smime.p7s</a> (application/x-pkcs7-signature, attachment)]</pre>

<div class="msgreceived"><hr><p>
<a name="39"></a>
<!-- command:done -->
<!-- requester: Christoph Anton Mitterer &lt;calestyo@scientia.net&gt; -->
<!-- request_addr: control@bugs.debian.org -->
<!-- time:1402528148 -->
<!-- new_data:
$new_data = {
              &#39;done&#39; =&gt; &#39;&#39;
            };
-->
<!-- old_data:
$old_data = {
              &#39;done&#39; =&gt; &#39;Michael Vogt &lt;mvo@debian.org&gt;&#39;
            };
-->
<strong>Bug reopened</strong>
Request was from <code>Christoph Anton Mitterer &lt;calestyo@scientia.net&gt;</code>
to <code>control@bugs.debian.org</code>.
 (Wed, 11 Jun 2014 23:09:08 GMT) (<a href="bugreport.cgi?bug=749795;msg=40">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=40">mbox</a>, <a href="#39">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="41"></a>
<!-- command:fixed -->
<!-- requester: Christoph Anton Mitterer &lt;calestyo@scientia.net&gt; -->
<!-- request_addr: control@bugs.debian.org -->
<!-- time:1402528149 -->
<!-- new_data:
$new_data = {
              &#39;fixed_versions&#39; =&gt; []
            };
-->
<!-- old_data:
$old_data = {
              &#39;fixed_versions&#39; =&gt; [
                                    &#39;apt/1.0.4&#39;
                                  ]
            };
-->
<strong>No longer marked as fixed in versions apt/1.0.4.</strong>
Request was from <code>Christoph Anton Mitterer &lt;calestyo@scientia.net&gt;</code>
to <code>control@bugs.debian.org</code>.
 (Wed, 11 Jun 2014 23:09:09 GMT) (<a href="bugreport.cgi?bug=749795;msg=42">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=42">mbox</a>, <a href="#41">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="43"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, APT Development Team &lt;deity@lists.debian.org&gt; -->
<!-- time:1402546144 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, APT Development Team &lt;deity@lists.debian.org&gt;</code>:<br>
<code>Bug#749795</code>; Package <code>apt</code>.
 (Thu, 12 Jun 2014 04:09:04 GMT) (<a href="bugreport.cgi?bug=749795;msg=44">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=44">mbox</a>, <a href="#43">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="45"></a>
<!-- request_addr: Joey Hess &lt;joeyh@debian.org&gt; -->
<!-- time:1402546144 -->
<strong>Acknowledgement sent</strong>
to <code>Joey Hess &lt;joeyh@debian.org&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>APT Development Team &lt;deity@lists.debian.org&gt;</code>.
 (Thu, 12 Jun 2014 04:09:04 GMT) (<a href="bugreport.cgi?bug=749795;msg=46">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=46">mbox</a>, <a href="#45">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="47"></a><a name="msg47"></a><a href="#47">Message #47</a> received at 749795@bugs.debian.org (<a href="bugreport.cgi?bug=749795;msg=47">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=47">mbox</a>, <a href="mailto:749795@bugs.debian.org?body=On%20Thu%2C%2012%20Jun%202014%2000%3A07%3A38%20-0400%20Joey%20Hess%20%3Cjoeyh%40debian.org%3E%20wrote%3A%0A%3E%20Christoph%20Anton%20Mitterer%20wrote%3A%0A%3E%20%3E%20reopen%20749795%0A%3E%20%3E%20I%27m%20reopening%20this%20for%20now%2C%20even%20if%20the%20issue%20is%20solved%20from%20a%20technical%0A%3E%20%3E%20point%20of%20view%20%28see%20below%20why%29.%0A%3E%20%0A%3E%20AAICS%2C%20%23749795%20talked%20about%20bringing%20this%20to%20the%20security%20team%27s%0A%3E%20attention%2C%20but%20they%20never%20seem%20to%20have%20been%20CCed.%0A%3E%20%0A%3E%20So%20the%20security%20team%20may%20not%20be%20aware%20that%20a%20security%20hole%20in%20apt%20was%0A%3E%20recently%20fixed%2C%20that%20caused%20apt-get%20source%20to%20not%20give%20any%20indication%0A%3E%20when%20the%20Release%20file%20was%20lacking%20a%20signature.%0A%3E%20%0A%3E%20Whether%20it%27s%20closed%20in%20unstable%20or%20not%2C%20this%20bug%20is%20open%20still%20in%0A%3E%20stable%2C%20and%20needs%20to%20get%20a%20CVE%20assigned%2C%20and%20a%20DSA%20issued.%0A%3E%20%0A%3E%20--%20%0A%3E%20see%20shy%20jo%0A%3E%20%0A%3E%20%0A&amp;In-Reply-To=%3C20140612040738.GA20494%40kitenet.net%3E&amp;subject=Re%3A%20holes%20in%20secure%20apt&amp;References=%3C1402527988.4739.34.camel%40heisenberg.scientia.net%3E%0A%20%3C20140612040738.GA20494%40kitenet.net%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=joeyh%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Joey Hess &lt;joeyh@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> Christoph Anton Mitterer &lt;calestyo@scientia.net&gt;</div>
<div class="header"><span class="headerfield">Cc:</span> 749795@bugs.debian.org, debian-devel@lists.debian.org,
	team@security.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: holes in secure apt</div>
<div class="header"><span class="headerfield">Date:</span> Thu, 12 Jun 2014 00:07:38 -0400</div>
</div>
<pre class="message">Christoph Anton Mitterer wrote:
&gt; reopen 749795
&gt; I&#39;m reopening this for now, even if the issue is solved from a technical
&gt; point of view (see below why).

AAICS, #749795 talked about bringing this to the security team&#39;s
attention, but they never seem to have been CCed.

So the security team may not be aware that a security hole in apt was
recently fixed, that caused apt-get source to not give any indication
when the Release file was lacking a signature.

Whether it&#39;s closed in unstable or not, this bug is open still in
stable, and needs to get a CVE assigned, and a DSA issued.

-- 
see shy jo


</pre>

<div class="msgreceived"><hr><p>
<a name="48"></a>
<!-- command:found -->
<!-- requester: Thijs Kinkhorst &lt;thijs@debian.org&gt; -->
<!-- request_addr: control@bugs.debian.org -->
<!-- time:1402556948 -->
<!-- new_data:
$new_data = {
              &#39;found_versions&#39; =&gt; [
                                    &#39;apt/0.9.7.9+deb7u1&#39;,
                                    &#39;apt/1.0.3&#39;
                                  ]
            };
-->
<!-- old_data:
$old_data = {
              &#39;found_versions&#39; =&gt; [
                                    &#39;apt/1.0.3&#39;
                                  ]
            };
-->
<strong>Marked as found in versions apt/0.9.7.9+deb7u1.</strong>
Request was from <code>Thijs Kinkhorst &lt;thijs@debian.org&gt;</code>
to <code>control@bugs.debian.org</code>.
 (Thu, 12 Jun 2014 07:09:08 GMT) (<a href="bugreport.cgi?bug=749795;msg=49">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=49">mbox</a>, <a href="#48">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="50"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, APT Development Team &lt;deity@lists.debian.org&gt; -->
<!-- time:1402561984 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, APT Development Team &lt;deity@lists.debian.org&gt;</code>:<br>
<code>Bug#749795</code>; Package <code>apt</code>.
 (Thu, 12 Jun 2014 08:33:04 GMT) (<a href="bugreport.cgi?bug=749795;msg=51">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=51">mbox</a>, <a href="#50">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="52"></a>
<!-- request_addr: Thorsten Glaser &lt;t.glaser@tarent.de&gt; -->
<!-- time:1402561984 -->
<strong>Acknowledgement sent</strong>
to <code>Thorsten Glaser &lt;t.glaser@tarent.de&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>APT Development Team &lt;deity@lists.debian.org&gt;</code>.
 (Thu, 12 Jun 2014 08:33:04 GMT) (<a href="bugreport.cgi?bug=749795;msg=53">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=53">mbox</a>, <a href="#52">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="54"></a><a name="msg54"></a><a href="#54">Message #54</a> received at 749795@bugs.debian.org (<a href="bugreport.cgi?bug=749795;msg=54">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=54">mbox</a>, <a href="mailto:749795@bugs.debian.org?body=On%20Thu%2C%2012%20Jun%202014%2010%3A30%3A48%20%2B0200%20%28CEST%29%20Thorsten%20Glaser%20%3Ct.glaser%40tarent.de%3E%20wrote%3A%0A%3E%20On%20Thu%2C%2012%20Jun%202014%2C%20Christoph%20Anton%20Mitterer%20wrote%3A%0A%3E%20%0A%3E%20%3E%20Anyone%20who%20believed%20in%20getting%20trusted%20sources%20might%20have%20been%20attacked%0A%3E%20%3E%20with%20forged%20packages%2C%20and%20even%20the%20plain%20build%20of%20such%20package%20might%0A%3E%20%3E%20have%20undermined%20users%27%20security%20integrity.%0A%3E%20%0A%3E%20Then%20I%20believe%20Debian%20itself%20may%20be%20undermined.%0A%3E%20%0A%3E%20%3E%20The%20same%20is%20the%20case%20with%20all%20debian%20build%20systems%20which%20probably%20rely%0A%3E%20%3E%20on%20secure%20APT.%0A%3E%20%0A%3E%20A%20buildd%20%28sbuild%29%20or%20cowbuilder%20is%20set%20up%20using%20the%20normal%20debootstrap%0A%3E%20process%20with%20--variant%3Dbuildd%20using%20the%20Debian%20archive%20keyring%20of%20the%0A%3E%20host%20system%20to%20validate.%20%28This%20works.%29%20Then%2C%20%2Fetc%2Fapt%2Fsources.list%20is%0A%3E%20written%2C%20and%20APT%20defaults%20to%20secure.%20The%20debian-archive-keyring%20package%0A%3E%20is%20Essential%2C%20so%20this%20is%20always%20installed%20during%20the%20bootstrap.%20Porters%0A%3E%20add%20debian-ports-archive-keyring%20%28debootstrap%20can%20do%20that%29.%0A%3E%20%0A%3E%20The%20buildd-related%20software%20%28and%20most%20people%20when%20doing%20manual%20builds%0A%3E%20with%20cowbuilder%29%20uses%20%E2%80%9Capt-get%20source%20foo%E2%80%9D%20to%20download%20the%20file%2C%20fully%0A%3E%20assuming%20that%20apt-get%20ensures%20validation%2C%20so%20no%20%E2%80%9Cdscverify%E2%80%9D%20is%20run%20on%0A%3E%20the%20sources%20downloaded%20by%20apt.%20%28If%20someone%20uses%20dget%2C%20either%20dget%20is%0A%3E%20new%20enough%20to%20call%20dscverify%2C%20or%20they%20had%20better%20be%20doing%20that%20by%20hand.%29%0A%3E%20%0A%3E%20The%20build%20process%20inside%20the%20chroot%20of%20cowbuilder%20also%20calls%20dscverify%2C%0A%3E%20but%20as%20debian-keyring%20%28distinct%20from%20debian-archive-keyring%29%20is%20never%0A%3E%20installed%2C%20it%20errors%20out%20always%2C%20which%20is%20just%20ignored.%20%28That%20being%0A%3E%20said%2C%20when%20I%20was%20doing%20porter%20builds%2Fuploads%20with%20cowbuilder%20and%20used%0A%3E%20dget%2Bdscverify%20to%20retrieve%20the%20source%2C%20even%20the%20debian-keyring%20package%0A%3E%20in%20sid%20was%20sometimes%20not%20up-to-date%20enough%20to%20have%20the%20new%20keys%20the%0A%3E%20maintainers%20used%20to%20sign%20their%20packages%20in%20it.%20Since%20the%20proper%20buildd%0A%3E%20infrastructure%20does%20not%20use%20this%20but%20relies%20on%20SecureAPT%20to%20validate%0A%3E%20the%20files%20it%20downloads%2C%20this%20is%20understandable.%29%0A%3E%20%0A%3E%20This%20means%20that%2C%20if%20there%20was%20ever%20a%20chance%20that%20%27apt-get%20source%20foo%27%0A%3E%20would%20not%20check%20the%20integrity%20of%20the%20files%20it%20downloaded%20against%0A%3E%20Sources.gz%20%2B%20Release%7B%2C.gpg%7D%20we%E2%80%99re%20in%20pretty%20deep%20shit.%20%28Well%2C%20there%0A%3E%20was%2C%20before%20SecureAPT%20was%20enacted%2C%20but%20that%E2%80%99s%20outside%20of%20the%20scope%0A%3E%20of%20this.%29%0A%3E%20%0A%3E%20bye%2C%0A%3E%20%2F%2Fmirabilos%0A%3E%20--%20%0A%3E%20%E2%80%9Cah%20that%20reminds%20me%2C%20thanks%20for%20the%20stellar%20entertainment%20that%20you%20and%20certain%0A%3E%20other%20people%20provide%20on%20the%20Debian%20mailing%20lists%20%E2%94%82%20sole%20reason%20I%20subscribed%20to%0A%3E%20them%20%28I%27m%20not%20using%20Debian%20anywhere%29%20is%20the%20entertainment%20factor%20%E2%94%82%20Debian%20does%0A%3E%20not%20strike%20me%20as%20a%20place%20for%20good%20humour%2C%20much%20less%20German%20admin-style%20humour%E2%80%9D%0A%3E%20%0A%3E%20%0A&amp;In-Reply-To=%3Calpine.DEB.2.10.1406121024050.17794%40tglase.lan.tarent.de%3E&amp;References=%3C1402527988.4739.34.camel%40heisenberg.scientia.net%3E%0A%20%3Calpine.DEB.2.10.1406121024050.17794%40tglase.lan.tarent.de%3E&amp;subject=Re%3A%20holes%20in%20secure%20apt">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=t.glaser%40tarent.de" alt="">
<div class="header"><span class="headerfield">From:</span> Thorsten Glaser &lt;t.glaser@tarent.de&gt;</div>
<div class="header"><span class="headerfield">Cc:</span> 749795@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: holes in secure apt</div>
<div class="header"><span class="headerfield">Date:</span> Thu, 12 Jun 2014 10:30:48 +0200 (CEST)</div>
</div>
<pre class="message">On Thu, 12 Jun 2014, Christoph Anton Mitterer wrote:

&gt; Anyone who believed in getting trusted sources might have been attacked
&gt; with forged packages, and even the plain build of such package might
&gt; have undermined users&#39; security integrity.

Then I believe Debian itself may be undermined.

&gt; The same is the case with all debian build systems which probably rely
&gt; on secure APT.

A buildd (sbuild) or cowbuilder is set up using the normal debootstrap
process with --variant=buildd using the Debian archive keyring of the
host system to validate. (This works.) Then, /etc/apt/sources.list is
written, and APT defaults to secure. The debian-archive-keyring package
is Essential, so this is always installed during the bootstrap. Porters
add debian-ports-archive-keyring (debootstrap can do that).

The buildd-related software (and most people when doing manual builds
with cowbuilder) uses “apt-get source foo” to download the file, fully
assuming that apt-get ensures validation, so no “dscverify” is run on
the sources downloaded by apt. (If someone uses dget, either dget is
new enough to call dscverify, or they had better be doing that by hand.)

The build process inside the chroot of cowbuilder also calls dscverify,
but as debian-keyring (distinct from debian-archive-keyring) is never
installed, it errors out always, which is just ignored. (That being
said, when I was doing porter builds/uploads with cowbuilder and used
dget+dscverify to retrieve the source, even the debian-keyring package
in sid was sometimes not up-to-date enough to have the new keys the
maintainers used to sign their packages in it. Since the proper buildd
infrastructure does not use this but relies on SecureAPT to validate
the files it downloads, this is understandable.)

This means that, if there was ever a chance that &#39;apt-get source foo&#39;
would not check the integrity of the files it downloaded against
Sources.gz + Release{,.gpg} we’re in pretty deep shit. (Well, there
was, before SecureAPT was enacted, but that’s outside of the scope
of this.)

bye,
//mirabilos
-- 
“ah that reminds me, thanks for the stellar entertainment that you and certain
other people provide on the Debian mailing lists │ sole reason I subscribed to
them (I&#39;m not using Debian anywhere) is the entertainment factor │ Debian does
not strike me as a place for good humour, much less German admin-style humour”


</pre>

<div class="msgreceived"><hr><p>
<a name="55"></a>
<!-- command:fixed -->
<!-- requester: Thijs Kinkhorst &lt;thijs@debian.org&gt; -->
<!-- request_addr: control@bugs.debian.org -->
<!-- time:1402565948 -->
<!-- new_data:
$new_data = {
              &#39;fixed_versions&#39; =&gt; [
                                    &#39;apt/1.0.4&#39;
                                  ]
            };
-->
<!-- old_data:
$old_data = {
              &#39;fixed_versions&#39; =&gt; []
            };
-->
<strong>Marked as fixed in versions apt/1.0.4.</strong>
Request was from <code>Thijs Kinkhorst &lt;thijs@debian.org&gt;</code>
to <code>control@bugs.debian.org</code>.
 (Thu, 12 Jun 2014 09:39:08 GMT) (<a href="bugreport.cgi?bug=749795;msg=56">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=56">mbox</a>, <a href="#55">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="57"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, APT Development Team &lt;deity@lists.debian.org&gt; -->
<!-- time:1402566488 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, APT Development Team &lt;deity@lists.debian.org&gt;</code>:<br>
<code>Bug#749795</code>; Package <code>apt</code>.
 (Thu, 12 Jun 2014 09:48:08 GMT) (<a href="bugreport.cgi?bug=749795;msg=58">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=58">mbox</a>, <a href="#57">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="59"></a>
<!-- request_addr: &quot;Thijs Kinkhorst&quot; &lt;thijs@debian.org&gt; -->
<!-- time:1402566488 -->
<strong>Acknowledgement sent</strong>
to <code>&quot;Thijs Kinkhorst&quot; &lt;thijs@debian.org&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>APT Development Team &lt;deity@lists.debian.org&gt;</code>.
 (Thu, 12 Jun 2014 09:48:08 GMT) (<a href="bugreport.cgi?bug=749795;msg=60">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=60">mbox</a>, <a href="#59">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="61"></a><a name="msg61"></a><a href="#61">Message #61</a> received at 749795@bugs.debian.org (<a href="bugreport.cgi?bug=749795;msg=61">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=61">mbox</a>, <a href="mailto:749795@bugs.debian.org?In-Reply-To=%3Cb79b6b6e647131dbb459cc36a9e6f92e.squirrel%40aphrodite.kinkhorst.nl%3E&amp;body=On%20Thu%2C%2012%20Jun%202014%2011%3A44%3A20%20%2B0200%20%22Thijs%20Kinkhorst%22%20%3Cthijs%40debian.org%3E%20wrote%3A%0A%3E%20Hi%2C%0A%3E%20%0A%3E%20%3E%20apt%3A%20no%20authentication%20checks%20for%20source%20packages%0A%3E%20%0A%3E%20The%20Debian%20security%20team%20has%20assigned%20CVE-2014-0478%20to%20this%20issue.%0A%3E%20%0A%3E%20APT%20developers%3A%20we%20should%20fix%20this%20in%20wheezy.%20Are%20you%20able%20to%20provide%20an%0A%3E%20update%20for%20wheezy%20for%20this%20issue%3F%0A%3E%20%0A%3E%20As%20for%20squeeze%2C%20if%20it%27s%20not%20too%20much%20extra%20work%20it%20would%20be%20great%20if%20an%0A%3E%20update%20for%20squeeze%20was%20also%20possible.%20Perhaps%20it%20could%20also%20even%20include%0A%3E%20the%20fix%20for%20https%3A%2F%2Fsecurity-tracker.debian.org%2Ftracker%2FCVE-2011-3634%3F%0A%3E%20%0A%3E%20Let%20us%20know.%0A%3E%20%0A%3E%20Thanks%2C%0A%3E%20Thijs%0A%3E%20%0A%3E%20%0A&amp;subject=Re%3A%20apt%3A%20no%20authentication%20checks%20for%20source%20packages&amp;References=%3Cb79b6b6e647131dbb459cc36a9e6f92e.squirrel%40aphrodite.kinkhorst.nl%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=thijs%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> &quot;Thijs Kinkhorst&quot; &lt;thijs@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> 749795@bugs.debian.org</div>
<div class="header"><span class="headerfield">Cc:</span> cve-assign@mitre.org, team@security.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: apt: no authentication checks for source packages</div>
<div class="header"><span class="headerfield">Date:</span> Thu, 12 Jun 2014 11:44:20 +0200</div>
</div>
<pre class="message">Hi,

&gt; apt: no authentication checks for source packages

The Debian security team has assigned <a href="https://security-tracker.debian.org/tracker/CVE-2014-0478">CVE-2014-0478</a> to this issue.

APT developers: we should fix this in wheezy. Are you able to provide an
update for wheezy for this issue?

As for squeeze, if it&#39;s not too much extra work it would be great if an
update for squeeze was also possible. Perhaps it could also even include
the fix for <a href="https://security-tracker.debian.org/tracker/CVE-2011-3634?">https://security-tracker.debian.org/tracker/CVE-2011-3634?</a>

Let us know.

Thanks,
Thijs


</pre>

<div class="infmessage"><hr><p>
<a name="62"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, APT Development Team &lt;deity@lists.debian.org&gt; -->
<!-- time:1402568831 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, APT Development Team &lt;deity@lists.debian.org&gt;</code>:<br>
<code>Bug#749795</code>; Package <code>apt</code>.
 (Thu, 12 Jun 2014 10:27:11 GMT) (<a href="bugreport.cgi?bug=749795;msg=63">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=63">mbox</a>, <a href="#62">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="64"></a>
<!-- request_addr: Michael Vogt &lt;mvo@debian.org&gt; -->
<!-- time:1402568831 -->
<strong>Acknowledgement sent</strong>
to <code>Michael Vogt &lt;mvo@debian.org&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>APT Development Team &lt;deity@lists.debian.org&gt;</code>.
 (Thu, 12 Jun 2014 10:27:11 GMT) (<a href="bugreport.cgi?bug=749795;msg=65">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=65">mbox</a>, <a href="#64">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="66"></a><a name="msg66"></a><a href="#66">Message #66</a> received at 749795@bugs.debian.org (<a href="bugreport.cgi?bug=749795;msg=66">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=66">mbox</a>, <a href="mailto:749795@bugs.debian.org?subject=Re%3A%20Bug%23749795%3A%20apt%3A%20no%20authentication%20checks%20for%20source%20packages&amp;References=%3Cb79b6b6e647131dbb459cc36a9e6f92e.squirrel%40aphrodite.kinkhorst.nl%3E%0A%20%3C20140612102541.GD9577%40bod%3E&amp;body=On%20Thu%2C%2012%20Jun%202014%2012%3A25%3A41%20%2B0200%20Michael%20Vogt%20%3Cmvo%40debian.org%3E%20wrote%3A%0A%3E%20On%20Thu%2C%20Jun%2012%2C%202014%20at%2011%3A44%3A20AM%20%2B0200%2C%20Thijs%20Kinkhorst%20wrote%3A%0A%3E%20%3E%20Hi%2C%0A%3E%20%3E%20%0A%3E%20%3E%20%3E%20apt%3A%20no%20authentication%20checks%20for%20source%20packages%0A%3E%20%3E%20%0A%3E%20%3E%20The%20Debian%20security%20team%20has%20assigned%20CVE-2014-0478%20to%20this%20issue.%0A%3E%20%3E%20%0A%3E%20%3E%20APT%20developers%3A%20we%20should%20fix%20this%20in%20wheezy.%20Are%20you%20able%20to%20provide%20an%0A%3E%20%3E%20update%20for%20wheezy%20for%20this%20issue%3F%0A%3E%20%0A%3E%20Yes%2C%20I%20will%20work%20on%20a%20backport%20for%20this%20today.%0A%3E%20%0A%3E%20%3E%20As%20for%20squeeze%2C%20if%20it%27s%20not%20too%20much%20extra%20work%20it%20would%20be%20great%20if%20an%0A%3E%20%3E%20update%20for%20squeeze%20was%20also%20possible.%20Perhaps%20it%20could%20also%20even%20include%0A%3E%20%3E%20the%20fix%20for%20https%3A%2F%2Fsecurity-tracker.debian.org%2Ftracker%2FCVE-2011-3634%3F%0A%3E%20%0A%3E%20I%20look%20into%20this%20too%2C%20I%20don%27t%20know%20yet%20how%20much%20extra%20work%20it%20is.%0A%3E%20%0A%3E%20Cheers%2C%0A%3E%20%20Michael%0A%3E%20%0A%3E%20%0A&amp;In-Reply-To=%3C20140612102541.GD9577%40bod%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=mvo%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Michael Vogt &lt;mvo@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> Thijs Kinkhorst &lt;thijs@debian.org&gt;, 749795@bugs.debian.org,
	team@security.debian.org</div>
<div class="header"><span class="headerfield">Cc:</span> cve-assign@mitre.org, team@security.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#749795: apt: no authentication checks for source packages</div>
<div class="header"><span class="headerfield">Date:</span> Thu, 12 Jun 2014 12:25:41 +0200</div>
</div>
<pre class="message">On Thu, Jun 12, 2014 at 11:44:20AM +0200, Thijs Kinkhorst wrote:
&gt; Hi,
&gt; 
&gt; &gt; apt: no authentication checks for source packages
&gt; 
&gt; The Debian security team has assigned <a href="https://security-tracker.debian.org/tracker/CVE-2014-0478">CVE-2014-0478</a> to this issue.
&gt; 
&gt; APT developers: we should fix this in wheezy. Are you able to provide an
&gt; update for wheezy for this issue?

Yes, I will work on a backport for this today.

&gt; As for squeeze, if it&#39;s not too much extra work it would be great if an
&gt; update for squeeze was also possible. Perhaps it could also even include
&gt; the fix for <a href="https://security-tracker.debian.org/tracker/CVE-2011-3634?">https://security-tracker.debian.org/tracker/CVE-2011-3634?</a>

I look into this too, I don&#39;t know yet how much extra work it is.

Cheers,
 Michael


</pre>

<div class="msgreceived"><hr><p>
<a name="67"></a>
<!-- command:title -->
<!-- requester: Salvatore Bonaccorso &lt;carnil@debian.org&gt; -->
<!-- request_addr: control@bugs.debian.org -->
<!-- time:1402569194 -->
<!-- new_data:
$new_data = {
              &#39;subject&#39; =&gt; &#39;apt: CVE-2014-0478: no authentication checks for source packages&#39;
            };
-->
<!-- old_data:
$old_data = {
              &#39;subject&#39; =&gt; &#39;apt: no authentication checks for source packages&#39;
            };
-->
<strong>Changed Bug title to &#39;apt: CVE-2014-0478: no authentication checks for source packages&#39; from &#39;apt: no authentication checks for source packages&#39;</strong>
Request was from <code>Salvatore Bonaccorso &lt;carnil@debian.org&gt;</code>
to <code>control@bugs.debian.org</code>.
 (Thu, 12 Jun 2014 10:33:14 GMT) (<a href="bugreport.cgi?bug=749795;msg=68">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=68">mbox</a>, <a href="#67">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="69"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, APT Development Team &lt;deity@lists.debian.org&gt; -->
<!-- time:1402574229 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, APT Development Team &lt;deity@lists.debian.org&gt;</code>:<br>
<code>Bug#749795</code>; Package <code>apt</code>.
 (Thu, 12 Jun 2014 11:57:09 GMT) (<a href="bugreport.cgi?bug=749795;msg=70">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=70">mbox</a>, <a href="#69">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="71"></a>
<!-- request_addr: Michael Vogt &lt;mvo@debian.org&gt; -->
<!-- time:1402574229 -->
<strong>Acknowledgement sent</strong>
to <code>Michael Vogt &lt;mvo@debian.org&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>APT Development Team &lt;deity@lists.debian.org&gt;</code>.
 (Thu, 12 Jun 2014 11:57:09 GMT) (<a href="bugreport.cgi?bug=749795;msg=72">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=72">mbox</a>, <a href="#71">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="73"></a><a name="msg73"></a><a href="#73">Message #73</a> received at 749795@bugs.debian.org (<a href="bugreport.cgi?bug=749795;msg=73">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=73">mbox</a>, <a href="mailto:749795@bugs.debian.org?body=On%20Thu%2C%2012%20Jun%202014%2013%3A52%3A13%20%2B0200%20Michael%20Vogt%20%3Cmvo%40debian.org%3E%20wrote%3A%0A%3E%20On%20Thu%2C%20Jun%2012%2C%202014%20at%2011%3A44%3A20AM%20%2B0200%2C%20Thijs%20Kinkhorst%20wrote%3A%0A%3E%20%3E%20%3E%20apt%3A%20no%20authentication%20checks%20for%20source%20packages%0A%3E%20%3E%20%0A%3E%20%3E%20The%20Debian%20security%20team%20has%20assigned%20CVE-2014-0478%20to%20this%20issue.%0A%3E%20%3E%20%0A%3E%20%3E%20APT%20developers%3A%20we%20should%20fix%20this%20in%20wheezy.%20Are%20you%20able%20to%20provide%20an%0A%3E%20%3E%20update%20for%20wheezy%20for%20this%20issue%3F%0A%3E%20%5B..%5D%0A%3E%20%0A%3E%20Attached%20is%20the%20fix%20for%20wheezy%20with%20a%20regression%20test%2C%20a%20additional%0A%3E%20test%20run%20is%20very%20welcome%20%28works%20in%20my%20wheezy%20container%20both%20the%0A%3E%20testcase%20and%20a%20manual%20test%20when%20removing%20%2Fvar%2Flib%2Fapt%2Flists%2F%2ARelease%2A%29.%0A%3E%20%0A%3E%20Cheers%2C%0A%3E%20%20Michael%0A&amp;In-Reply-To=%3C20140612115213.GE9577%40bod%3E&amp;References=%3Cb79b6b6e647131dbb459cc36a9e6f92e.squirrel%40aphrodite.kinkhorst.nl%3E%0A%20%3C20140612115213.GE9577%40bod%3E&amp;subject=Re%3A%20Bug%23749795%3A%20apt%3A%20no%20authentication%20checks%20for%20source%20packages">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=mvo%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Michael Vogt &lt;mvo@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> Thijs Kinkhorst &lt;thijs@debian.org&gt;, 749795@bugs.debian.org</div>
<div class="header"><span class="headerfield">Cc:</span> team@security.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#749795: apt: no authentication checks for source packages</div>
<div class="header"><span class="headerfield">Date:</span> Thu, 12 Jun 2014 13:52:13 +0200</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=0;bug=749795;msg=73">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message">On Thu, Jun 12, 2014 at 11:44:20AM +0200, Thijs Kinkhorst wrote:
&gt; &gt; apt: no authentication checks for source packages
&gt; 
&gt; The Debian security team has assigned <a href="https://security-tracker.debian.org/tracker/CVE-2014-0478">CVE-2014-0478</a> to this issue.
&gt; 
&gt; APT developers: we should fix this in wheezy. Are you able to provide an
&gt; update for wheezy for this issue?
[..]

Attached is the fix for wheezy with a regression test, a additional
test run is very welcome (works in my wheezy container both the
testcase and a manual test when removing /var/lib/apt/lists/*Release*).

Cheers,
 Michael
</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=749795;filename=apt_0.9.7.9%2Bdeb7u2.debdiff;msg=73">apt_0.9.7.9+deb7u2.debdiff</a> (text/plain, attachment)]</pre>

<div class="infmessage"><hr><p>
<a name="74"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, APT Development Team &lt;deity@lists.debian.org&gt; -->
<!-- time:1402576745 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, APT Development Team &lt;deity@lists.debian.org&gt;</code>:<br>
<code>Bug#749795</code>; Package <code>apt</code>.
 (Thu, 12 Jun 2014 12:39:05 GMT) (<a href="bugreport.cgi?bug=749795;msg=75">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=75">mbox</a>, <a href="#74">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="76"></a>
<!-- request_addr: &quot;Thijs Kinkhorst&quot; &lt;thijs@debian.org&gt; -->
<!-- time:1402576745 -->
<strong>Acknowledgement sent</strong>
to <code>&quot;Thijs Kinkhorst&quot; &lt;thijs@debian.org&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>APT Development Team &lt;deity@lists.debian.org&gt;</code>.
 (Thu, 12 Jun 2014 12:39:05 GMT) (<a href="bugreport.cgi?bug=749795;msg=77">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=77">mbox</a>, <a href="#76">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="78"></a><a name="msg78"></a><a href="#78">Message #78</a> received at 749795@bugs.debian.org (<a href="bugreport.cgi?bug=749795;msg=78">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=78">mbox</a>, <a href="mailto:749795@bugs.debian.org?subject=Re%3A%20Bug%23749795%3A%20apt%3A%20no%20authentication%20checks%20for%20source%20packages&amp;References=%3Cb79b6b6e647131dbb459cc36a9e6f92e.squirrel%40aphrodite.kinkhorst.nl%3E%0A%20%20%20%20%3C20140612115213.GE9577%40bod%3E%0A%20%3Cf67f4f85ac77dc631b39ff3edaadcb54.squirrel%40aphrodite.kinkhorst.nl%3E&amp;In-Reply-To=%3Cf67f4f85ac77dc631b39ff3edaadcb54.squirrel%40aphrodite.kinkhorst.nl%3E&amp;body=On%20Thu%2C%2012%20Jun%202014%2014%3A37%3A28%20%2B0200%20%22Thijs%20Kinkhorst%22%20%3Cthijs%40debian.org%3E%20wrote%3A%0A%3E%20Hi%20Michael%2C%0A%3E%20%0A%3E%20On%20Thu%2C%20June%2012%2C%202014%2013%3A52%2C%20Michael%20Vogt%20wrote%3A%0A%3E%20%3E%20On%20Thu%2C%20Jun%2012%2C%202014%20at%2011%3A44%3A20AM%20%2B0200%2C%20Thijs%20Kinkhorst%20wrote%3A%0A%3E%20%3E%3E%20%3E%20apt%3A%20no%20authentication%20checks%20for%20source%20packages%0A%3E%20%3E%3E%0A%3E%20%3E%3E%20The%20Debian%20security%20team%20has%20assigned%20CVE-2014-0478%20to%20this%20issue.%0A%3E%20%3E%3E%0A%3E%20%3E%3E%20APT%20developers%3A%20we%20should%20fix%20this%20in%20wheezy.%20Are%20you%20able%20to%20provide%20an%0A%3E%20%3E%3E%20update%20for%20wheezy%20for%20this%20issue%3F%0A%3E%20%3E%20%5B..%5D%0A%3E%20%3E%0A%3E%20%3E%20Attached%20is%20the%20fix%20for%20wheezy%20with%20a%20regression%20test%2C%20a%20additional%0A%3E%20%3E%20test%20run%20is%20very%20welcome%20%28works%20in%20my%20wheezy%20container%20both%20the%0A%3E%20%3E%20testcase%20and%20a%20manual%20test%20when%20removing%20%2Fvar%2Flib%2Fapt%2Flists%2F%2ARelease%2A%29.%0A%3E%20%0A%3E%20Thanks%21%20I%27ve%20built%20it%20and%20verified%20that%20it%20works%20for%20me%20aswell%20%28and%20solves%0A%3E%20the%20issue%29.%20For%20the%20changelog%3A%20you%20need%20to%20target%20%22wheezy-security%22%2C%20and%0A%3E%20may%20want%20to%20add%20%22closes%3A%20%23749795%22%20and%20urgency%3Dhigh.%20With%20these%20changes%20you%0A%3E%20can%20upload%20to%20security-master.debian.org.%20Make%20sure%20to%20build%20with%20full%0A%3E%20source%20%28%22-sa%22%29%20as%20wheezy-security%20doesn%27t%20yet%20have%20the%20orig%20tarball.%0A%3E%20%0A%3E%20The%20patch%20seems%20to%20apply%20rather%20cleanly%20to%20squeeze%2C%20so%20an%20update%20for%20that%0A%3E%20would%20be%20nice%20if%20possible.%20Fixing%20CVE-2011-3634%20aswell%20would%20be%20nice%20if%0A%3E%20simple%20to%20do%20but%20not%20essential.%0A%3E%20%0A%3E%20%0A%3E%20Cheers%2C%0A%3E%20Thijs%0A%3E%20%0A%3E%20%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=thijs%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> &quot;Thijs Kinkhorst&quot; &lt;thijs@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> &quot;Michael Vogt&quot; &lt;mvo@debian.org&gt;</div>
<div class="header"><span class="headerfield">Cc:</span> 749795@bugs.debian.org, team@security.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#749795: apt: no authentication checks for source packages</div>
<div class="header"><span class="headerfield">Date:</span> Thu, 12 Jun 2014 14:37:28 +0200</div>
</div>
<pre class="message">Hi Michael,

On Thu, June 12, 2014 13:52, Michael Vogt wrote:
&gt; On Thu, Jun 12, 2014 at 11:44:20AM +0200, Thijs Kinkhorst wrote:
&gt;&gt; &gt; apt: no authentication checks for source packages
&gt;&gt;
&gt;&gt; The Debian security team has assigned <a href="https://security-tracker.debian.org/tracker/CVE-2014-0478">CVE-2014-0478</a> to this issue.
&gt;&gt;
&gt;&gt; APT developers: we should fix this in wheezy. Are you able to provide an
&gt;&gt; update for wheezy for this issue?
&gt; [..]
&gt;
&gt; Attached is the fix for wheezy with a regression test, a additional
&gt; test run is very welcome (works in my wheezy container both the
&gt; testcase and a manual test when removing /var/lib/apt/lists/*Release*).

Thanks! I&#39;ve built it and verified that it works for me aswell (and solves
the issue). For the changelog: you need to target &quot;wheezy-security&quot;, and
may want to add &quot;closes: #749795&quot; and urgency=high. With these changes you
can upload to security-master.debian.org. Make sure to build with full
source (&quot;-sa&quot;) as wheezy-security doesn&#39;t yet have the orig tarball.

The patch seems to apply rather cleanly to squeeze, so an update for that
would be nice if possible. Fixing <a href="https://security-tracker.debian.org/tracker/CVE-2011-3634">CVE-2011-3634</a> aswell would be nice if
simple to do but not essential.


Cheers,
Thijs


</pre>

<div class="infmessage"><hr><p>
<a name="79"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, APT Development Team &lt;deity@lists.debian.org&gt; -->
<!-- time:1402579087 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, APT Development Team &lt;deity@lists.debian.org&gt;</code>:<br>
<code>Bug#749795</code>; Package <code>apt</code>.
 (Thu, 12 Jun 2014 13:18:07 GMT) (<a href="bugreport.cgi?bug=749795;msg=80">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=80">mbox</a>, <a href="#79">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="81"></a>
<!-- request_addr: Michael Vogt &lt;mvo@debian.org&gt; -->
<!-- time:1402579087 -->
<strong>Acknowledgement sent</strong>
to <code>Michael Vogt &lt;mvo@debian.org&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>APT Development Team &lt;deity@lists.debian.org&gt;</code>.
 (Thu, 12 Jun 2014 13:18:07 GMT) (<a href="bugreport.cgi?bug=749795;msg=82">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=82">mbox</a>, <a href="#81">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="83"></a><a name="msg83"></a><a href="#83">Message #83</a> received at 749795@bugs.debian.org (<a href="bugreport.cgi?bug=749795;msg=83">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=83">mbox</a>, <a href="mailto:749795@bugs.debian.org?In-Reply-To=%3C20140612131401.GF9577%40bod%3E&amp;body=On%20Thu%2C%2012%20Jun%202014%2015%3A14%3A01%20%2B0200%20Michael%20Vogt%20%3Cmvo%40debian.org%3E%20wrote%3A%0A%3E%20On%20Thu%2C%20Jun%2012%2C%202014%20at%2011%3A44%3A20AM%20%2B0200%2C%20Thijs%20Kinkhorst%20wrote%3A%0A%3E%20%5B..%5D%0A%3E%20%3E%20%3E%20apt%3A%20no%20authentication%20checks%20for%20source%20packages%0A%3E%20%3E%20%0A%3E%20%3E%20The%20Debian%20security%20team%20has%20assigned%20CVE-2014-0478%20to%20this%20issue.%0A%3E%20%5B..%5D%0A%3E%20%3E%20As%20for%20squeeze%2C%20if%20it%27s%20not%20too%20much%20extra%20work%20it%20would%20be%20great%20if%20an%0A%3E%20%3E%20update%20for%20squeeze%20was%20also%20possible.%20Perhaps%20it%20could%20also%20even%20include%0A%3E%20%3E%20the%20fix%20for%20https%3A%2F%2Fsecurity-tracker.debian.org%2Ftracker%2FCVE-2011-3634%3F%0A%3E%20%0A%3E%20Attached%20is%20the%20debdiff%20for%20squeeze.%20Additional%20testing%20welcome%20%28work%0A%3E%20in%20my%20debian-squeeze%20environment%29.%0A%3E%20%0A%3E%20Cheers%2C%0A%3E%20%20Michael%0A&amp;References=%3Cb79b6b6e647131dbb459cc36a9e6f92e.squirrel%40aphrodite.kinkhorst.nl%3E%0A%20%3C20140612131401.GF9577%40bod%3E&amp;subject=Re%3A%20Bug%23749795%3A%20apt%3A%20no%20authentication%20checks%20for%20source%20packages">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=mvo%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Michael Vogt &lt;mvo@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> Thijs Kinkhorst &lt;thijs@debian.org&gt;, 749795@bugs.debian.org</div>
<div class="header"><span class="headerfield">Cc:</span> cve-assign@mitre.org, team@security.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#749795: apt: no authentication checks for source packages</div>
<div class="header"><span class="headerfield">Date:</span> Thu, 12 Jun 2014 15:14:01 +0200</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=0;bug=749795;msg=83">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message">On Thu, Jun 12, 2014 at 11:44:20AM +0200, Thijs Kinkhorst wrote:
[..]
&gt; &gt; apt: no authentication checks for source packages
&gt; 
&gt; The Debian security team has assigned <a href="https://security-tracker.debian.org/tracker/CVE-2014-0478">CVE-2014-0478</a> to this issue.
[..]
&gt; As for squeeze, if it&#39;s not too much extra work it would be great if an
&gt; update for squeeze was also possible. Perhaps it could also even include
&gt; the fix for <a href="https://security-tracker.debian.org/tracker/CVE-2011-3634?">https://security-tracker.debian.org/tracker/CVE-2011-3634?</a>

Attached is the debdiff for squeeze. Additional testing welcome (work
in my debian-squeeze environment).

Cheers,
 Michael
</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=749795;filename=apt_0.8.10.3%2Bsqueeze2.debdiff;msg=83">apt_0.8.10.3+squeeze2.debdiff</a> (text/plain, attachment)]</pre>

<div class="infmessage"><hr><p>
<a name="84"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, APT Development Team &lt;deity@lists.debian.org&gt; -->
<!-- time:1402587013 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, APT Development Team &lt;deity@lists.debian.org&gt;</code>:<br>
<code>Bug#749795</code>; Package <code>apt</code>.
 (Thu, 12 Jun 2014 15:30:13 GMT) (<a href="bugreport.cgi?bug=749795;msg=85">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=85">mbox</a>, <a href="#84">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="86"></a>
<!-- request_addr: debian-devel@lists.debian.org -->
<!-- time:1402587013 -->
<strong>Acknowledgement sent</strong>
to <code>debian-devel@lists.debian.org</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>APT Development Team &lt;deity@lists.debian.org&gt;</code>.
 (Thu, 12 Jun 2014 15:30:13 GMT) (<a href="bugreport.cgi?bug=749795;msg=87">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=87">mbox</a>, <a href="#86">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="88"></a><a name="msg88"></a><a href="#88">Message #88</a> received at 749795@bugs.debian.org (<a href="bugreport.cgi?bug=749795;msg=88">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=88">mbox</a>, <a href="mailto:749795@bugs.debian.org?In-Reply-To=%3C20140612152550.GA27001%40crossbow%3E&amp;body=On%20Thu%2C%2012%20Jun%202014%2017%3A25%3A51%20%2B0200%20David%20Kalnischkies%20%3Cdavid%40kalnischkies.de%3E%20wrote%3A%0A%3E%20On%20Thu%2C%20Jun%2012%2C%202014%20at%2001%3A06%3A28AM%20%2B0200%2C%20Christoph%20Anton%20Mitterer%20wrote%3A%0A%3E%20%3E%20In%20my%20opinion%20this%20is%20really%20some%20horrible%20bug...%20probably%20it%20could%20have%0A%3E%20%3E%20been%20very%20easily%20found%20by%20others%2C%20and%20we%20have%20no%20idea%20whether%20it%20was%0A%3E%20%3E%20exploited%20already%20or%20not.%0A%3E%20%0A%3E%20Probably%20yes.%20Someone%20in%20the%20last%20~11%20years%20could%20have%2C%20but%20that%20nobody%0A%3E%20did%20tells%20you%20a%20lot%20about%20how%20many%20people%20actively%20work%20on%20what%20so%20many%0A%3E%20people%20seem%20to%20assume%20just%20has%20to%20work%20and%20complain%20loudly%20if%20it%0A%3E%20doesn%27t%20in%20the%20way%20it%20always%20was%20%28assumed%20to%20be%29%E2%80%A6%20so%2C%20to%20get%20anything%0A%3E%20useful%20out%20of%20this%3A%20Should%20we%20do%20a%20kickstarter%20now%20or%20wait%20for%0A%3E%20a%20libreapt%20fork%3F%0A%3E%20%0A%3E%20%0A%3E%20%3E%20Anyone%20who%20believed%20in%20getting%20trusted%20sources%20might%20have%20been%20attacked%0A%3E%20%3E%20with%20forged%20packages%2C%20and%20even%20the%20plain%20build%20of%20such%20package%20might%0A%3E%20%3E%20have%20undermined%20users%27%20security%20integrity.%0A%3E%20%0A%3E%20Worst%20case.%20In%20practice%20you%20will%20have%20installed%20build-dependencies%0A%3E%20before%20which%20has%20resulted%20in%20a%20error%20for%20those%2C%20which%20should%20have%20been%0A%3E%20enough%20for%20you%20to%20recognise%20that%20something%20fishy%20goes%20on.%20It%20is%20at%20least%0A%3E%20what%20all%20automatic%20builders%20will%20run%20into.%20Assuming%20of%20course%20you%20don%27t%0A%3E%20ignore%20such%20errors%20which%20many%20users%2Fscripts%20happily%20do%E2%80%A6%0A%3E%20%0A%3E%20%0A%3E%20Also%2C%20keep%20in%20mind%20that%20the%20chain%20is%20broken%20at%20the%20Release%20-%3E%20Sources%0A%3E%20level%2C%20not%20at%20the%20Sources%20-%3E%20tarball%20level%2C%20so%20if%20you%20ship%20modified%0A%3E%20tarballs%20to%20your%20target%20you%20have%20to%20also%20ship%20a%20modified%20Sources%20file.%0A%3E%20%0A%3E%20For%20your%20attack%20to%20be%20%28always%29%20successful%2C%20you%20need%20a%20full-sources%0A%3E%20mirror%20on%20which%20you%20modify%20all%20tarballs%2C%20so%20that%20you%20can%20build%20a%20valid%0A%3E%20Sources%20file.%20You%20can%27t%20just%20build%20your%20attack%20tarball%20on%20demand%20as%20the%0A%3E%20hash%20%28and%20filesize%29%20isn%27t%20going%20to%20match%20with%20what%20Sources%20declares.%0A%3E%20%28assuming%20you%20aren%27t%20good%20at%20pre-imaging%2C%20but%20then%2C%20why%20do%20you%20bother%0A%3E%20with%20this%20one%20here%3F%29%20Combine%20that%20with%20the%20problems%20of%20being%20a%20good%20MITM%0A%3E%20in%20general%20and%20you%20might%20understand%20why%20my%20heart%20isn%27t%20bleeding%20that%0A%3E%20much%20about%20this%20particular%20bug.%20We%20had%20worse%20and%20nobody%20really%20cared%E2%80%A6%0A%3E%20%0A%3E%20%0A%3E%20%3E%20It%27s%20really%20saddening%20to%20see%20that%20such%20an%20issue%20could%20slip%20through%2C%0A%3E%20%3E%20especially%20when%20I%27ve%20personally%20started%20already%20a%20few%20threads%20on%0A%3E%20%3E%20debian-devel%20about%20the%20security%20of%20secure%20APT.%0A%3E%20%3E%20The%20most%20recent%20one%20was%20IIRC%3A%0A%3E%20%3E%20https%3A%2F%2Flists.debian.org%2Fdebian-devel%2F2012%2F03%2Fmsg00549.html%0A%3E%20%3E%20but%20I%27ve%20had%20one%20before%2C%20I%20think.%0A%3E%20%0A%3E%20What%20is%20really%20sad%20is%20that%20many%20people%20keep%20talking%20about%20how%20much%20more%0A%3E%20secure%20everything%20should%20be%20but%20don%27t%20do%20the%20smallest%20bit%20of%20work%0A%3E%20to%20make%20it%20happen%20or%20even%20do%20a%20basic%20level%20of%20research%20themselves.%0A%3E%20%0A%3E%20So%20instead%20of%20answering%20all%20your%20questions%2C%20I%20will%20instead%20leave%20them%0A%3E%20unanswered%20and%20say%3A%20Go%20on%20and%20check%20for%20yourself%21%20You%20shouldn%27t%20trust%0A%3E%20a%20random%20guy%20like%20me%20anyway%20and%20if%20that%20leads%20to%20even%20one%20person%0A%3E%20contributing%20to%20apt%20%28or%20the%20security%20team%20or%20anything%20else%20really%29%20in%0A%3E%20this%20area%2C%20we%20have%20a%20phenomenal%20massive%20increase%20in%20manpower%20%E2%80%A6%0A%3E%20%28for%20apt%20in%20the%2050%25%20ballpark%21%29%0A%3E%20%0A%3E%20%0A%3E%20%3E%20-%20I%20think%20per%20default%20APT%20should%20refuse%20to%20work%20with%20unsigned%0A%3E%20%3E%20repos%2Fpackages.%20One%20should%20really%20need%20some%20configuration%20switch%20or%0A%3E%20%3E%20option%20that%20allows%20this.%0A&amp;subject=Re%3A%20holes%20in%20secure%20apt&amp;References=%3C1402527988.4739.34.camel%40heisenberg.scientia.net%3E%0A%20%3C20140612152550.GA27001%40crossbow%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=david%40kalnischkies.de" alt="">
<div class="header"><span class="headerfield">From:</span> David Kalnischkies &lt;david@kalnischkies.de&gt;</div>
<div class="header"><span class="headerfield">To:</span> debian-devel@lists.debian.org</div>
<div class="header"><span class="headerfield">Cc:</span> 749795@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: holes in secure apt</div>
<div class="header"><span class="headerfield">Date:</span> Thu, 12 Jun 2014 17:25:51 +0200</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=0;bug=749795;msg=88">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message">On Thu, Jun 12, 2014 at 01:06:28AM +0200, Christoph Anton Mitterer wrote:
&gt; In my opinion this is really some horrible bug... probably it could have
&gt; been very easily found by others, and we have no idea whether it was
&gt; exploited already or not.

Probably yes. Someone in the last ~11 years could have, but that nobody
did tells you a lot about how many people actively work on what so many
people seem to assume just has to work and complain loudly if it
doesn&#39;t in the way it always was (assumed to be)… so, to get anything
useful out of this: Should we do a kickstarter now or wait for
a libreapt fork?


&gt; Anyone who believed in getting trusted sources might have been attacked
&gt; with forged packages, and even the plain build of such package might
&gt; have undermined users&#39; security integrity.

Worst case. In practice you will have installed build-dependencies
before which has resulted in a error for those, which should have been
enough for you to recognise that something fishy goes on. It is at least
what all automatic builders will run into. Assuming of course you don&#39;t
ignore such errors which many users/scripts happily do…


Also, keep in mind that the chain is broken at the Release -&gt; Sources
level, not at the Sources -&gt; tarball level, so if you ship modified
tarballs to your target you have to also ship a modified Sources file.

For your attack to be (always) successful, you need a full-sources
mirror on which you modify all tarballs, so that you can build a valid
Sources file. You can&#39;t just build your attack tarball on demand as the
hash (and filesize) isn&#39;t going to match with what Sources declares.
(assuming you aren&#39;t good at pre-imaging, but then, why do you bother
with this one here?) Combine that with the problems of being a good MITM
in general and you might understand why my heart isn&#39;t bleeding that
much about this particular bug. We had worse and nobody really cared…


&gt; It&#39;s really saddening to see that such an issue could slip through,
&gt; especially when I&#39;ve personally started already a few threads on
&gt; debian-devel about the security of secure APT.
&gt; The most recent one was IIRC:
&gt; <a href="https://lists.debian.org/debian-devel/2012/03/msg00549.html">https://lists.debian.org/debian-devel/2012/03/msg00549.html</a>
&gt; but I&#39;ve had one before, I think.

What is really sad is that many people keep talking about how much more
secure everything should be but don&#39;t do the smallest bit of work
to make it happen or even do a basic level of research themselves.

So instead of answering all your questions, I will instead leave them
unanswered and say: Go on and check for yourself! You shouldn&#39;t trust
a random guy like me anyway and if that leads to even one person
contributing to apt (or the security team or anything else really) in
this area, we have a phenomenal massive increase in manpower …
(for apt in the 50% ballpark!)


&gt; - I think per default APT should refuse to work with unsigned
&gt; repos/packages. One should really need some configuration switch or
&gt; option that allows this.

I will comment this one though: Michael wanted to look into this for
a while now. The plan I was suggesting was something like jessie:
support-unauth=true by default, jessie+1: support-unauth=false by
default, jessie+2: gone. We will see if this can be implemented at all.
Contributions welcome as always.


&gt; I don&#39;t think it&#39;s a big issue, since all the major repos are signed and
&gt; even the &quot;end-user&quot; tools to make own repos (like debarchiver) support
&gt; signing.

Think again. People do it all the time. It is the default mode of
operation for plugging in repos into builders for example. If you are
bored, just search for the usage of --allow-unauthenticated.


I half-jokingly mentioned with the plan last time that a bunker is
nearby, so I would be safe; half-jokingly as at least I got murder
threats for far less. I doubt it will be any different with this &quot;not
big issue&quot;. So be careful with what you assume to be simple and
uncontroversial. See also xkcd#1172.


Some usecases can be transitioned to [trusted=yes] probably, but I am
not sure we really gain that much this way (as it makes things actually
worse from a security standpoint) so we really shouldn&#39;t press the
&quot;security: don&#39;t care&quot; crowd in this direction. Hence the slow ride-plan.


&gt; People should simply be taught to not use unsigned repos...

Yeah. I will try my luck with world peace first though. Might be easier…
But I am a naive kid. 5 years ago I wondered why a small bug – which
even I could provide a patch for – wasn&#39;t fixed. Now I wonder how the
&quot;team&quot; manages to keep up with reading bugs at all; but its the same for
many other &quot;Debian: native&quot; packages. aka: It took me a while to
understand what &quot;no upstream&quot; really means …


Best regards

David Kalnischkies

P.S.: Dropping security@, bug@ and everyone else in Reply-To as this
chit-chat thread is just noise for them. Please don&#39;t pick up cc&#39;s at
random … If you want to /work/ on anything you could move to deity@ as
already suggested. Otherwise lets just talk here… (and no, you don&#39;t
have to cc me either)
</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=749795;filename=signature.asc;msg=88">signature.asc</a> (application/pgp-signature, inline)]</pre>

<div class="msgreceived"><hr><p>
<a name="89"></a>
<!-- request_addr: Michael Vogt &lt;mvo@debian.org&gt; -->
<!-- time:1402595478 -->
<strong>Reply sent</strong>
to <code>Michael Vogt &lt;mvo@debian.org&gt;</code>:<br>
You have taken responsibility.
 (Thu, 12 Jun 2014 17:51:18 GMT) (<a href="bugreport.cgi?bug=749795;msg=90">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=90">mbox</a>, <a href="#89">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="91"></a>
<!-- request_addr: Jakub Wilk &lt;jwilk@debian.org&gt; -->
<!-- time:1402595478 -->
<strong>Notification sent</strong>
to <code>Jakub Wilk &lt;jwilk@debian.org&gt;</code>:<br>
Bug acknowledged by developer.
 (Thu, 12 Jun 2014 17:51:18 GMT) (<a href="bugreport.cgi?bug=749795;msg=92">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=92">mbox</a>, <a href="#91">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="93"></a><a name="msg93"></a><a href="#93">Message #93</a> received at 749795-close@bugs.debian.org (<a href="bugreport.cgi?bug=749795;msg=93">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=93">mbox</a>, <a href="mailto:749795@bugs.debian.org?References=%3CE1Wv97E-0006tv-Ai%40franck.debian.org%3E&amp;subject=Re%3A%20Bug%23749795%3A%20fixed%20in%20apt%200.8.10.3%2Bsqueeze2&amp;body=On%20Thu%2C%2012%20Jun%202014%2017%3A48%3A44%20%2B0000%20Michael%20Vogt%20%3Cmvo%40debian.org%3E%20wrote%3A%0A%3E%20Source%3A%20apt%0A%3E%20Source-Version%3A%200.8.10.3%2Bsqueeze2%0A%3E%20%0A%3E%20We%20believe%20that%20the%20bug%20you%20reported%20is%20fixed%20in%20the%20latest%20version%20of%0A%3E%20apt%2C%20which%20is%20due%20to%20be%20installed%20in%20the%20Debian%20FTP%20archive.%0A%3E%20%0A%3E%20A%20summary%20of%20the%20changes%20between%20this%20version%20and%20the%20previous%20one%20is%0A%3E%20attached.%0A%3E%20%0A%3E%20Thank%20you%20for%20reporting%20the%20bug%2C%20which%20will%20now%20be%20closed.%20%20If%20you%0A%3E%20have%20further%20comments%20please%20address%20them%20to%20749795%40bugs.debian.org%2C%0A%3E%20and%20the%20maintainer%20will%20reopen%20the%20bug%20report%20if%20appropriate.%0A%3E%20%0A%3E%20Debian%20distribution%20maintenance%20software%0A%3E%20pp.%0A%3E%20Michael%20Vogt%20%3Cmvo%40debian.org%3E%20%28supplier%20of%20updated%20apt%20package%29%0A%3E%20%0A%3E%20%28This%20message%20was%20generated%20automatically%20at%20their%20request%3B%20if%20you%0A%3E%20believe%20that%20there%20is%20a%20problem%20with%20it%20please%20contact%20the%20archive%0A%3E%20administrators%20by%20mailing%20ftpmaster%40ftp-master.debian.org%29%0A%3E%20%0A%3E%20%0A%3E%20-----BEGIN%20PGP%20SIGNED%20MESSAGE-----%0A%3E%20Hash%3A%20SHA1%0A%3E%20%0A%3E%20Format%3A%201.8%0A%3E%20Date%3A%20Thu%2C%2012%20Jun%202014%2014%3A30%3A59%20%2B0200%0A%3E%20Source%3A%20apt%0A%3E%20Binary%3A%20apt%20apt-doc%20libapt-pkg-dev%20libapt-pkg-doc%20apt-utils%20apt-transport-https%0A%3E%20Architecture%3A%20source%20all%20amd64%0A%3E%20Version%3A%200.8.10.3%2Bsqueeze2%0A%3E%20Distribution%3A%20squeeze-lts%0A%3E%20Urgency%3A%20high%0A%3E%20Maintainer%3A%20APT%20Development%20Team%20%3Cdeity%40lists.debian.org%3E%0A%3E%20Changed-By%3A%20Michael%20Vogt%20%3Cmvo%40debian.org%3E%0A%3E%20Description%3A%20%0A%3E%20%20apt%20%20%20%20%20%20%20%20-%20Advanced%20front-end%20for%20dpkg%0A%3E%20%20apt-doc%20%20%20%20-%20Documentation%20for%20APT%0A%3E%20%20apt-transport-https%20-%20APT%20https%20transport%0A%3E%20%20apt-utils%20%20-%20APT%20utility%20programs%0A%3E%20%20libapt-pkg-dev%20-%20Development%20files%20for%20APT%27s%20libapt-pkg%20and%20libapt-inst%0A%3E%20%20libapt-pkg-doc%20-%20Documentation%20for%20APT%20development%0A%3E%20Closes%3A%20749795%0A%3E%20Changes%3A%20%0A%3E%20%20apt%20%280.8.10.3%2Bsqueeze2%29%20squeeze-lts%3B%20urgency%3Dhigh%0A%3E%20%20.%0A%3E%20%20%20%20%2A%20SECURITY%20UPDATE%3A%20apt-get%20source%20validation%20%28closes%3A%20%23749795%29%0A%3E%20%20%20%20%20%20-%20CVE-2014-0478%0A%3E%20%20%20%20%2A%20SECURITY%20UPDATE%3A%20sensitive%20information%20disclosure%20via%20incorrect%0A%3E%20%20%20%20%20%20hostname%20validation%20%28LP%3A%20%23868353%29%0A%3E%20%20%20%20%20%20-%20methods%2Fhttps.cc%3A%20properly%20set%20CURLOPT_SSL_VERIFYHOST.%0A%3E%20%20%20%20%20%20-%20CVE-2011-3634%0A%3E%20Checksums-Sha1%3A%20%0A%3E%20%20eac6d7afdc9913e918c226c484f32450b8bf1125%201643%20apt_0.8.10.3%2Bsqueeze2.dsc%0A%3E%20%20b08a7fde701111f12c4c93065ae1ea83627e24c2%203148430%20apt_0.8.10.3%2Bsqueeze2.tar.gz%0A%3E%20%205d1a4c81d0b2c54227952e73ae9248e052a26e16%20235592%20apt-doc_0.8.10.3%2Bsqueeze2_all.deb%0A%3E%20%20fb86248e760cf453658988237b454a9d8b745ba2%20694130%20libapt-pkg-doc_0.8.10.3%2Bsqueeze2_all.deb%0A%3E%20%208f875323dd04ae2dca2db521490b24a60d7cdc5d%202183396%20apt_0.8.10.3%2Bsqueeze2_amd64.deb%0A%3E%20%208162afbed8d101c9538aff8d6892d6e9b6d92882%20151120%20libapt-pkg-dev_0.8.10.3%2Bsqueeze2_amd64.deb%0A%3E%20%208c1218aadb87860d36507d5b305229e5a9adeb36%20274288%20apt-utils_0.8.10.3%2Bsqueeze2_amd64.deb%0A&amp;In-Reply-To=%3CE1Wv97E-0006tv-Ai%40franck.debian.org%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=mvo%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Michael Vogt &lt;mvo@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> 749795-close@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Bug#749795: fixed in apt 0.8.10.3+squeeze2</div>
<div class="header"><span class="headerfield">Date:</span> Thu, 12 Jun 2014 17:48:44 +0000</div>
</div>
<pre class="message">Source: apt
Source-Version: 0.8.10.3+squeeze2

We believe that the bug you reported is fixed in the latest version of
apt, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 749795@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Michael Vogt &lt;mvo@debian.org&gt; (supplier of updated apt package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.8
Date: Thu, 12 Jun 2014 14:30:59 +0200
Source: apt
Binary: apt apt-doc libapt-pkg-dev libapt-pkg-doc apt-utils apt-transport-https
Architecture: source all amd64
Version: 0.8.10.3+squeeze2
Distribution: squeeze-lts
Urgency: high
Maintainer: APT Development Team &lt;deity@lists.debian.org&gt;
Changed-By: Michael Vogt &lt;mvo@debian.org&gt;
Description: 
 apt        - Advanced front-end for dpkg
 apt-doc    - Documentation for APT
 apt-transport-https - APT https transport
 apt-utils  - APT utility programs
 libapt-pkg-dev - Development files for APT&#39;s libapt-pkg and libapt-inst
 libapt-pkg-doc - Documentation for APT development
Closes: <a href="bugreport.cgi?bug=749795">749795</a>
Changes: 
 apt (0.8.10.3+squeeze2) squeeze-lts; urgency=high
 .
   * SECURITY UPDATE: apt-get source validation (closes: #<a href="bugreport.cgi?bug=749795">749795</a>)
     - <a href="https://security-tracker.debian.org/tracker/CVE-2014-0478">CVE-2014-0478</a>
   * SECURITY UPDATE: sensitive information disclosure via incorrect
     hostname validation (LP: #868353)
     - methods/https.cc: properly set CURLOPT_SSL_VERIFYHOST.
     - <a href="https://security-tracker.debian.org/tracker/CVE-2011-3634">CVE-2011-3634</a>
Checksums-Sha1: 
 eac6d7afdc9913e918c226c484f32450b8bf1125 1643 apt_0.8.10.3+squeeze2.dsc
 b08a7fde701111f12c4c93065ae1ea83627e24c2 3148430 apt_0.8.10.3+squeeze2.tar.gz
 5d1a4c81d0b2c54227952e73ae9248e052a26e16 235592 apt-doc_0.8.10.3+squeeze2_all.deb
 fb86248e760cf453658988237b454a9d8b745ba2 694130 libapt-pkg-doc_0.8.10.3+squeeze2_all.deb
 8f875323dd04ae2dca2db521490b24a60d7cdc5d 2183396 apt_0.8.10.3+squeeze2_amd64.deb
 8162afbed8d101c9538aff8d6892d6e9b6d92882 151120 libapt-pkg-dev_0.8.10.3+squeeze2_amd64.deb
 8c1218aadb87860d36507d5b305229e5a9adeb36 274288 apt-utils_0.8.10.3+squeeze2_amd64.deb
 ca73c4732c0a75ae41509357b6c55e708cf507b8 84058 apt-transport-https_0.8.10.3+squeeze2_amd64.deb
Checksums-Sha256: 
 3ec6e2f8b406bb87c766f758f5526c6d97d229d85fa980799ebca03e823fb355 1643 apt_0.8.10.3+squeeze2.dsc
 5049e40a7b9ddd8caab7860a99d4eb0688f8629bd19896c5a8e453961d14c375 3148430 apt_0.8.10.3+squeeze2.tar.gz
 685188746b24906f09a78ec6fdcef7c5770fc0255260682101815f1bdad0d742 235592 apt-doc_0.8.10.3+squeeze2_all.deb
 408539d9d8362da9d9acd8ab14411ee6d5328b0becc49cd57d642c83c925f442 694130 libapt-pkg-doc_0.8.10.3+squeeze2_all.deb
 9d97c6af65cb587509b34caf7e3cfa21fb32de107b829751be4c9a043ef7448f 2183396 apt_0.8.10.3+squeeze2_amd64.deb
 0151206e844f0a6d41d6ae99fca91b533d20852c888a4252f366f919275c7a34 151120 libapt-pkg-dev_0.8.10.3+squeeze2_amd64.deb
 6d3449b1bd787dc58a9145f07fa2787d64eb31122996e92b6844034063e9f8bf 274288 apt-utils_0.8.10.3+squeeze2_amd64.deb
 b7952017066021c5900ee2cb928f10844de54fe9b092cad68d7cbfcc12f2a3d8 84058 apt-transport-https_0.8.10.3+squeeze2_amd64.deb
Files: 
 8950d696fac7fba2d6ec5d2e4ee6ab3c 1643 admin important apt_0.8.10.3+squeeze2.dsc
 9035eeeb42a5ad4a7d0ca191b62c0b15 3148430 admin important apt_0.8.10.3+squeeze2.tar.gz
 a078195dfc1a586f869ad610c991040f 235592 doc optional apt-doc_0.8.10.3+squeeze2_all.deb
 0d7be19fe7a5a2489c53f2681c8be837 694130 doc optional libapt-pkg-doc_0.8.10.3+squeeze2_all.deb
 1390d6e23202117a5af409851a457e41 2183396 admin important apt_0.8.10.3+squeeze2_amd64.deb
 1495f46f4be1db85d89b36ae39f55400 151120 libdevel optional libapt-pkg-dev_0.8.10.3+squeeze2_amd64.deb
 83dc1cf2c8550a91445a4a9cba81dced 274288 admin important apt-utils_0.8.10.3+squeeze2_amd64.deb
 5fb8ce76ac8426e3bd41fe02246061f8 84058 admin optional apt-transport-https_0.8.10.3+squeeze2_amd64.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)

iQEcBAEBAgAGBQJTmed2AAoJEFb2GnlAHawEELkH/AnEU0JlKTJGAouq3ZcE2o9o
BCrHt4iw85YxKWiiRGcZDJv585TdWxVQCafZo9F4jn555xr6ZQq+MaUYHXmE1m+e
LHxpsa3UbbMg6GddGv9g3ZJL4YEHJ4+4Ipw0BU5y/KwlCq1RB74SftbFHWmRe+Sy
pprl9IiS1n9clccpoCSxRji8IpndDPyP/+kaF0bCl6L6NAqGVYtNrMawctOfLebg
4mm2rZc2/4BPpDPOnN8UqOYqobXOL5NOhtjxop/VFC+ZdSDAnTBIWB6lB+wuXLu9
T43x+5iYTxiNyzLHOrGVMVF93/5Cg9zGqNqN3ERbEKwO6tJHyTajwsTxMT2kreA=
=dBKb
-----END PGP SIGNATURE-----



</pre>

<div class="msgreceived"><hr><p>
<a name="94"></a>
<!-- request_addr: Michael Vogt &lt;mvo@debian.org&gt; -->
<!-- time:1402868195 -->
<strong>Reply sent</strong>
to <code>Michael Vogt &lt;mvo@debian.org&gt;</code>:<br>
You have taken responsibility.
 (Sun, 15 Jun 2014 21:36:35 GMT) (<a href="bugreport.cgi?bug=749795;msg=95">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=95">mbox</a>, <a href="#94">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="96"></a>
<!-- request_addr: Jakub Wilk &lt;jwilk@debian.org&gt; -->
<!-- time:1402868195 -->
<strong>Notification sent</strong>
to <code>Jakub Wilk &lt;jwilk@debian.org&gt;</code>:<br>
Bug acknowledged by developer.
 (Sun, 15 Jun 2014 21:36:35 GMT) (<a href="bugreport.cgi?bug=749795;msg=97">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=97">mbox</a>, <a href="#96">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="98"></a><a name="msg98"></a><a href="#98">Message #98</a> received at 749795-close@bugs.debian.org (<a href="bugreport.cgi?bug=749795;msg=98">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=98">mbox</a>, <a href="mailto:749795@bugs.debian.org?In-Reply-To=%3CE1WwI25-0004il-FS%40franck.debian.org%3E&amp;body=On%20Sun%2C%2015%20Jun%202014%2021%3A32%3A09%20%2B0000%20Michael%20Vogt%20%3Cmvo%40debian.org%3E%20wrote%3A%0A%3E%20Source%3A%20apt%0A%3E%20Source-Version%3A%200.9.7.9%2Bdeb7u2%0A%3E%20%0A%3E%20We%20believe%20that%20the%20bug%20you%20reported%20is%20fixed%20in%20the%20latest%20version%20of%0A%3E%20apt%2C%20which%20is%20due%20to%20be%20installed%20in%20the%20Debian%20FTP%20archive.%0A%3E%20%0A%3E%20A%20summary%20of%20the%20changes%20between%20this%20version%20and%20the%20previous%20one%20is%0A%3E%20attached.%0A%3E%20%0A%3E%20Thank%20you%20for%20reporting%20the%20bug%2C%20which%20will%20now%20be%20closed.%20%20If%20you%0A%3E%20have%20further%20comments%20please%20address%20them%20to%20749795%40bugs.debian.org%2C%0A%3E%20and%20the%20maintainer%20will%20reopen%20the%20bug%20report%20if%20appropriate.%0A%3E%20%0A%3E%20Debian%20distribution%20maintenance%20software%0A%3E%20pp.%0A%3E%20Michael%20Vogt%20%3Cmvo%40debian.org%3E%20%28supplier%20of%20updated%20apt%20package%29%0A%3E%20%0A%3E%20%28This%20message%20was%20generated%20automatically%20at%20their%20request%3B%20if%20you%0A%3E%20believe%20that%20there%20is%20a%20problem%20with%20it%20please%20contact%20the%20archive%0A%3E%20administrators%20by%20mailing%20ftpmaster%40ftp-master.debian.org%29%0A%3E%20%0A%3E%20%0A%3E%20-----BEGIN%20PGP%20SIGNED%20MESSAGE-----%0A%3E%20Hash%3A%20SHA1%0A%3E%20%0A%3E%20Format%3A%201.8%0A%3E%20Date%3A%20Thu%2C%2012%20Jun%202014%2012%3A47%3A25%20%2B0200%0A%3E%20Source%3A%20apt%0A%3E%20Binary%3A%20apt%20libapt-pkg4.12%20libapt-inst1.5%20apt-doc%20libapt-pkg-dev%20libapt-pkg-doc%20apt-utils%20apt-transport-https%0A%3E%20Architecture%3A%20source%20all%20amd64%0A%3E%20Version%3A%200.9.7.9%2Bdeb7u2%0A%3E%20Distribution%3A%20wheezy-security%0A%3E%20Urgency%3A%20high%0A%3E%20Maintainer%3A%20APT%20Development%20Team%20%3Cdeity%40lists.debian.org%3E%0A%3E%20Changed-By%3A%20Michael%20Vogt%20%3Cmvo%40debian.org%3E%0A%3E%20Description%3A%20%0A%3E%20%20apt%20%20%20%20%20%20%20%20-%20commandline%20package%20manager%0A%3E%20%20apt-doc%20%20%20%20-%20documentation%20for%20APT%0A%3E%20%20apt-transport-https%20-%20https%20download%20transport%20for%20APT%0A%3E%20%20apt-utils%20%20-%20package%20managment%20related%20utility%20programs%0A%3E%20%20libapt-inst1.5%20-%20deb%20package%20format%20runtime%20library%0A%3E%20%20libapt-pkg-dev%20-%20development%20files%20for%20APT%27s%20libapt-pkg%20and%20libapt-inst%0A%3E%20%20libapt-pkg-doc%20-%20documentation%20for%20APT%20development%0A%3E%20%20libapt-pkg4.12%20-%20package%20managment%20runtime%20library%0A%3E%20Closes%3A%20749795%0A%3E%20Changes%3A%20%0A%3E%20%20apt%20%280.9.7.9%2Bdeb7u2%29%20wheezy-security%3B%20urgency%3Dhigh%0A%3E%20%20.%0A%3E%20%20%20%20%2A%20SECURITY%20UPDATE%3A%20apt-get%20source%20validation%20%28closes%3A%20%23749795%29%0A%3E%20%20%20%20%20%20-%20CVE-2014-0478%0A%3E%20Checksums-Sha1%3A%20%0A%3E%20%20cb8ceff4ac6843de5712f13597ce33eb3360ce3e%201707%20apt_0.9.7.9%2Bdeb7u2.dsc%0A%3E%20%20bb1d29fa2b799868a909c822e250c14be055f763%203399785%20apt_0.9.7.9%2Bdeb7u2.tar.gz%0A%3E%20%2056c78ce70c079a9d55996bcf40ddb94074e38b00%20261440%20apt-doc_0.9.7.9%2Bdeb7u2_all.deb%0A%3E%20%20b8ad0e3aab1f19b41bae9f402f75d5c8369ff89c%20959170%20libapt-pkg-doc_0.9.7.9%2Bdeb7u2_all.deb%0A%3E%20%206606ac96a7bd3c15fe3138f3ef76bfdfcf7a107d%20889796%20libapt-pkg4.12_0.9.7.9%2Bdeb7u2_amd64.deb%0A%3E%20%204d4fa4aba36e2a229e90c179e21c8039d0d4ef40%20166658%20libapt-inst1.5_0.9.7.9%2Bdeb7u2_amd64.deb%0A%3E%20%20f4129fda11b109122ebe300213d88c92cf2b45a7%201261084%20apt_0.9.7.9%2Bdeb7u2_amd64.deb%0A%3E%20%209ec988fcc8761c2de1b92343b87266e79ed97963%20187028%20libapt-pkg-dev_0.9.7.9%2Bdeb7u2_amd64.deb%0A%3E%20%2044f8ece956dbfe3f2218dead396b8890bc00cd09%20377536%20apt-utils_0.9.7.9%2Bdeb7u2_amd64.deb%0A&amp;References=%3CE1WwI25-0004il-FS%40franck.debian.org%3E&amp;subject=Re%3A%20Bug%23749795%3A%20fixed%20in%20apt%200.9.7.9%2Bdeb7u2">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=mvo%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Michael Vogt &lt;mvo@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> 749795-close@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Bug#749795: fixed in apt 0.9.7.9+deb7u2</div>
<div class="header"><span class="headerfield">Date:</span> Sun, 15 Jun 2014 21:32:09 +0000</div>
</div>
<pre class="message">Source: apt
Source-Version: 0.9.7.9+deb7u2

We believe that the bug you reported is fixed in the latest version of
apt, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 749795@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Michael Vogt &lt;mvo@debian.org&gt; (supplier of updated apt package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.8
Date: Thu, 12 Jun 2014 12:47:25 +0200
Source: apt
Binary: apt libapt-pkg4.12 libapt-inst1.5 apt-doc libapt-pkg-dev libapt-pkg-doc apt-utils apt-transport-https
Architecture: source all amd64
Version: 0.9.7.9+deb7u2
Distribution: wheezy-security
Urgency: high
Maintainer: APT Development Team &lt;deity@lists.debian.org&gt;
Changed-By: Michael Vogt &lt;mvo@debian.org&gt;
Description: 
 apt        - commandline package manager
 apt-doc    - documentation for APT
 apt-transport-https - https download transport for APT
 apt-utils  - package managment related utility programs
 libapt-inst1.5 - deb package format runtime library
 libapt-pkg-dev - development files for APT&#39;s libapt-pkg and libapt-inst
 libapt-pkg-doc - documentation for APT development
 libapt-pkg4.12 - package managment runtime library
Closes: <a href="bugreport.cgi?bug=749795">749795</a>
Changes: 
 apt (0.9.7.9+deb7u2) wheezy-security; urgency=high
 .
   * SECURITY UPDATE: apt-get source validation (closes: #<a href="bugreport.cgi?bug=749795">749795</a>)
     - <a href="https://security-tracker.debian.org/tracker/CVE-2014-0478">CVE-2014-0478</a>
Checksums-Sha1: 
 cb8ceff4ac6843de5712f13597ce33eb3360ce3e 1707 apt_0.9.7.9+deb7u2.dsc
 bb1d29fa2b799868a909c822e250c14be055f763 3399785 apt_0.9.7.9+deb7u2.tar.gz
 56c78ce70c079a9d55996bcf40ddb94074e38b00 261440 apt-doc_0.9.7.9+deb7u2_all.deb
 b8ad0e3aab1f19b41bae9f402f75d5c8369ff89c 959170 libapt-pkg-doc_0.9.7.9+deb7u2_all.deb
 6606ac96a7bd3c15fe3138f3ef76bfdfcf7a107d 889796 libapt-pkg4.12_0.9.7.9+deb7u2_amd64.deb
 4d4fa4aba36e2a229e90c179e21c8039d0d4ef40 166658 libapt-inst1.5_0.9.7.9+deb7u2_amd64.deb
 f4129fda11b109122ebe300213d88c92cf2b45a7 1261084 apt_0.9.7.9+deb7u2_amd64.deb
 9ec988fcc8761c2de1b92343b87266e79ed97963 187028 libapt-pkg-dev_0.9.7.9+deb7u2_amd64.deb
 44f8ece956dbfe3f2218dead396b8890bc00cd09 377536 apt-utils_0.9.7.9+deb7u2_amd64.deb
 9a7a37335f0e9a9b010016b346a21875833f0af4 108850 apt-transport-https_0.9.7.9+deb7u2_amd64.deb
Checksums-Sha256: 
 3175904abac4645d07662035cfa97718321f6a3cf78dfa2849b34977bb24c565 1707 apt_0.9.7.9+deb7u2.dsc
 3f665cb0e1304681212a292a25fe27f8555ee344c110b7ed6dbdd636c19e8686 3399785 apt_0.9.7.9+deb7u2.tar.gz
 8b089afe469223c7b6672f266590006ff6d79ffc4f83af1f8c15b596a9aa3125 261440 apt-doc_0.9.7.9+deb7u2_all.deb
 03117d4102bc510a4f1a6efac8dead97d3827588107ba6c1e979e998f4214c44 959170 libapt-pkg-doc_0.9.7.9+deb7u2_all.deb
 89b7e28d8fef6551646760fc85e586fa3f0d5b802fd44b1168da7448acc84e8e 889796 libapt-pkg4.12_0.9.7.9+deb7u2_amd64.deb
 a57680fc959c7e25097bb70398860506e4c8c8d1fbc5b8bb5c637855cb7d8978 166658 libapt-inst1.5_0.9.7.9+deb7u2_amd64.deb
 36997b52ad31ae481ba9be17d592b6737d29cb11b1357e2061ce5fd57b2635fe 1261084 apt_0.9.7.9+deb7u2_amd64.deb
 23af5f2a03a08350538660586c97f29b986ff629b298d7ecfe7a42c2a01d9902 187028 libapt-pkg-dev_0.9.7.9+deb7u2_amd64.deb
 6c33e95f587e9a28d61fb7bf1375ec9a427636702b0cce3f7f3f030ff1193da9 377536 apt-utils_0.9.7.9+deb7u2_amd64.deb
 e7bcd8c319e71b06cdfe3ab2b6e67378b935194d2d3556dce383aa163a5dcd59 108850 apt-transport-https_0.9.7.9+deb7u2_amd64.deb
Files: 
 794d53bb8bc41c625fe3837a11fd5d17 1707 admin important apt_0.9.7.9+deb7u2.dsc
 11742f10404fca4c56669f2804af3764 3399785 admin important apt_0.9.7.9+deb7u2.tar.gz
 0cbe517179118a12386f256575a8356b 261440 doc optional apt-doc_0.9.7.9+deb7u2_all.deb
 d0b8099d4f9c5e19528d7fc655724b82 959170 doc optional libapt-pkg-doc_0.9.7.9+deb7u2_all.deb
 9437e9e1d864ece245263eca3e1cd9fd 889796 libs important libapt-pkg4.12_0.9.7.9+deb7u2_amd64.deb
 782fcd67201a92589be12b474d12c086 166658 libs important libapt-inst1.5_0.9.7.9+deb7u2_amd64.deb
 7603385c4f7f8e2bd098bd9a79878403 1261084 admin important apt_0.9.7.9+deb7u2_amd64.deb
 94278e43c53af971d570c9544792237d 187028 libdevel optional libapt-pkg-dev_0.9.7.9+deb7u2_amd64.deb
 dd8bc29f4b17c55a878b824568449a3e 377536 admin important apt-utils_0.9.7.9+deb7u2_amd64.deb
 3075898eaff96911425df6afd11c8631 108850 admin optional apt-transport-https_0.9.7.9+deb7u2_amd64.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iEYEARECAAYFAlOZybMACgkQliSD4VZixzQrOgCfe5CYzF8guEbiq/b2WhGpN7ZH
l14An3upZfD/1SZKFEjZELI9OSL4j1U8
=3WbZ
-----END PGP SIGNATURE-----



</pre>

<div class="infmessage"><hr><p>
<a name="99"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, APT Development Team &lt;deity@lists.debian.org&gt; -->
<!-- time:1402904182 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, APT Development Team &lt;deity@lists.debian.org&gt;</code>:<br>
<code>Bug#749795</code>; Package <code>apt</code>.
 (Mon, 16 Jun 2014 07:36:22 GMT) (<a href="bugreport.cgi?bug=749795;msg=100">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=100">mbox</a>, <a href="#99">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="101"></a>
<!-- request_addr: Michael Vogt &lt;mvo@debian.org&gt; -->
<!-- time:1402904182 -->
<strong>Acknowledgement sent</strong>
to <code>Michael Vogt &lt;mvo@debian.org&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>APT Development Team &lt;deity@lists.debian.org&gt;</code>.
 (Mon, 16 Jun 2014 07:36:22 GMT) (<a href="bugreport.cgi?bug=749795;msg=102">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=102">mbox</a>, <a href="#101">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="103"></a><a name="msg103"></a><a href="#103">Message #103</a> received at submit@bugs.debian.org (<a href="bugreport.cgi?bug=749795;msg=103">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=103">mbox</a>, <a href="mailto:749795@bugs.debian.org?body=On%20Mon%2C%2016%20Jun%202014%2009%3A35%3A06%20%2B0200%20Michael%20Vogt%20%3Cmvo%40debian.org%3E%20wrote%3A%0A%3E%20On%20Fri%2C%20May%2030%2C%202014%20at%2003%3A21%3A20PM%20%2B0200%2C%20Michael%20Vogt%20wrote%3A%0A%3E%20%5B..%5D%0A%3E%20%3E%20%3E%20Hmm.%20There%20is%20no%20warning%20suggesting%20that%20anything%20fishy%20is%20going%20on%2C%0A%3E%20%3E%20%3E%20and%20the%20exit%20code%20indicates%20success.%20%28Perhaps%20the%20%22Ign%22s%20could%20raise%0A%3E%20%3E%20%3E%20suspicion%20of%20an%20observant%20sysadmin.%20But%20who%20knows%20what%20%22Ign%22%20exactly%0A%3E%20%3E%20%3E%20means%3F%20At%20least%20the%20apt-get%281%29%20manpage%20doesn%27t%20know.%29%0A%3E%20%3E%20%0A%3E%20%3E%20Right%2C%20I%20think%20apt%20should%20show%20a%20more%20prominent%20warning%20here.%20I%20will%0A%3E%20%3E%20look%20into%20this%20next.%0A%3E%20%5B..%5D%0A%3E%20%0A%3E%20I%20create%20a%20git%20branch%20that%20shows%20a%20warning%20if%20it%20comes%20accross%20a%0A%3E%20unauthenticated%20repository%3A%0A%3E%20%22%22%22%0A%3E%20%2B%20%20%20_error-%3EWarning%28_%28%22The%20data%20from%20%27%25s%27%20is%20not%20signed.%20All%20packages%20from%20%22%0A%3E%20%2B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22that%20repository%20can%20not%20be%20authenticated.%22%29%2C%0A%3E%20%2B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20MetaIndexURIDesc.c_str%28%29%29%3B%0A%3E%20%22%22%22%0A%3E%20%0A%3E%20I%20think%20for%20the%20future%20we%20actually%20should%20not%20allow%20a%20apt-get%20update%0A%3E%20of%20untrusted%20repos%20without%20--allow-unauthenticated%20%20or%0A%3E%20%5Btrusted%3Dno%5D.%20But%20this%20will%20probably%20break%20some%20setups%20so%20we%20need%20to%0A%3E%20be%20careful%20and%20not%20rush%20it.%0A%3E%20%0A%3E%20%0A%3E%20%0A%3E%20Cheers%2C%0A%3E%20%20Michael%0A%3E%20%0A%3E%20%0A&amp;In-Reply-To=%3C20140616073506.GG9577%40bod%3E&amp;subject=Re%3A%20Bug%23749795%3A%20apt%3A%20no%20authentication%20checks%20for%20source%20packages&amp;References=%3C20140529210434.GA3935%40jwilk.net%3E%0A%20%3C20140530132120.GA9713%40bod%3E%0A%20%3C20140616073506.GG9577%40bod%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=mvo%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Michael Vogt &lt;mvo@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> Jakub Wilk &lt;jwilk@debian.org&gt;, 749795@bugs.debian.org</div>
<div class="header"><span class="headerfield">Cc:</span> Debian Bug Tracking System &lt;submit@bugs.debian.org&gt;</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#749795: apt: no authentication checks for source packages</div>
<div class="header"><span class="headerfield">Date:</span> Mon, 16 Jun 2014 09:35:06 +0200</div>
</div>
<pre class="message">On Fri, May 30, 2014 at 03:21:20PM +0200, Michael Vogt wrote:
[..]
&gt; &gt; Hmm. There is no warning suggesting that anything fishy is going on,
&gt; &gt; and the exit code indicates success. (Perhaps the &quot;Ign&quot;s could raise
&gt; &gt; suspicion of an observant sysadmin. But who knows what &quot;Ign&quot; exactly
&gt; &gt; means? At least the apt-get(1) manpage doesn&#39;t know.)
&gt; 
&gt; Right, I think apt should show a more prominent warning here. I will
&gt; look into this next.
[..]

I create a git branch that shows a warning if it comes accross a
unauthenticated repository:
&quot;&quot;&quot;
+   _error-&gt;Warning(_(&quot;The data from &#39;%s&#39; is not signed. All packages from &quot;
+                     &quot;that repository can not be authenticated.&quot;),
+                   MetaIndexURIDesc.c_str());
&quot;&quot;&quot;

I think for the future we actually should not allow a apt-get update
of untrusted repos without --allow-unauthenticated  or
[trusted=no]. But this will probably break some setups so we need to
be careful and not rush it.



Cheers,
 Michael


</pre>

<div class="infmessage"><hr><p>
<a name="104"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, APT Development Team &lt;deity@lists.debian.org&gt; -->
<!-- time:1402904186 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, APT Development Team &lt;deity@lists.debian.org&gt;</code>:<br>
<code>Bug#749795</code>; Package <code>apt</code>.
 (Mon, 16 Jun 2014 07:36:26 GMT) (<a href="bugreport.cgi?bug=749795;msg=105">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=105">mbox</a>, <a href="#104">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="106"></a>
<!-- request_addr: Michael Vogt &lt;mvo@debian.org&gt; -->
<!-- time:1402904186 -->
<strong>Acknowledgement sent</strong>
to <code>Michael Vogt &lt;mvo@debian.org&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>APT Development Team &lt;deity@lists.debian.org&gt;</code>.
 (Mon, 16 Jun 2014 07:36:26 GMT) (<a href="bugreport.cgi?bug=749795;msg=107">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=107">mbox</a>, <a href="#106">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="109"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, APT Development Team &lt;deity@lists.debian.org&gt; -->
<!-- time:1402910467 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, APT Development Team &lt;deity@lists.debian.org&gt;</code>:<br>
<code>Bug#749795</code>; Package <code>apt</code>.
 (Mon, 16 Jun 2014 09:21:07 GMT) (<a href="bugreport.cgi?bug=749795;msg=110">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=110">mbox</a>, <a href="#109">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="111"></a><a name="msg111"></a><a href="#111">Message #111</a> received at 749795@bugs.debian.org (<a href="bugreport.cgi?bug=749795;msg=111">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=111">mbox</a>, <a href="mailto:749795@bugs.debian.org?body=On%20Mon%2C%2016%20Jun%202014%2011%3A18%3A27%20%2B0200%20Jakub%20Wilk%20%3Cjwilk%40debian.org%3E%20wrote%3A%0A%3E%20%2A%20Michael%20Vogt%20%3Cmvo%40debian.org%3E%2C%202014-06-16%2C%2009%3A35%3A%0A%3E%20%3E%2B%20%20%20_error-%3EWarning%28_%28%22The%20data%20from%20%27%25s%27%20is%20not%20signed.%20All%20packages%20from%20%22%0A%3E%20%3E%2B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22that%20repository%20can%20not%20be%20authenticated.%22%29%2C%0A%3E%20%0A%3E%20s%2Fcan%20not%2Fcannot%2F%0A%3E%20%0A%3E%20Also%2C%20%22All%22%20with%20a%20negated%20verb%20sounds%20awkward%20to%20me%20%28but%20that%20may%20be%20%0A%3E%20due%20to%20my%20non-native-englishness%29.%20How%20about%3A%0A%3E%20%0A%3E%20%22No%20packages%20from%20that%20repository%20can%20be%20authenticated.%22%0A%3E%20%0A%3E%20or%20simply%0A%3E%20%0A%3E%20%22Packages%20from%20that%20repository%20cannot%20be%20authenticated.%22%0A%3E%20%0A%3E%20%3F%0A%3E%20%0A%3E%20--%20%0A%3E%20Jakub%20Wilk%0A%3E%20%0A%3E%20%0A&amp;In-Reply-To=%3C20140616091826.GA7070%40jwilk.net%3E&amp;References=%3C20140529210434.GA3935%40jwilk.net%3E%0A%20%3C20140530132120.GA9713%40bod%3E%0A%20%3C20140616073506.GG9577%40bod%3E%0A%20%3C20140616091826.GA7070%40jwilk.net%3E&amp;subject=Re%3A%20Bug%23749795%3A%20apt%3A%20no%20authentication%20checks%20for%20source%20packages">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=jwilk%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Jakub Wilk &lt;jwilk@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> 749795@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#749795: apt: no authentication checks for source packages</div>
<div class="header"><span class="headerfield">Date:</span> Mon, 16 Jun 2014 11:18:27 +0200</div>
</div>
<pre class="message flowed">* Michael Vogt &lt;mvo@debian.org&gt;, 2014-06-16, 09:35:
&gt;+   _error-&gt;Warning(_(&quot;The data from &#39;%s&#39; is not signed. All packages from &quot;
&gt;+                     &quot;that repository can not be authenticated.&quot;),

s/can not/cannot/

Also, &quot;All&quot; with a negated verb sounds awkward to me (but that may be 
due to my non-native-englishness). How about:

&quot;No packages from that repository can be authenticated.&quot;

or simply

&quot;Packages from that repository cannot be authenticated.&quot;

?

-- 
Jakub Wilk


</pre>

<div class="infmessage"><hr><p>
<a name="112"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, APT Development Team &lt;deity@lists.debian.org&gt; -->
<!-- time:1402913349 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, APT Development Team &lt;deity@lists.debian.org&gt;</code>:<br>
<code>Bug#749795</code>; Package <code>apt</code>.
 (Mon, 16 Jun 2014 10:09:09 GMT) (<a href="bugreport.cgi?bug=749795;msg=113">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=113">mbox</a>, <a href="#112">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="114"></a>
<!-- request_addr: Thorsten Glaser &lt;t.glaser@tarent.de&gt; -->
<!-- time:1402913349 -->
<strong>Acknowledgement sent</strong>
to <code>Thorsten Glaser &lt;t.glaser@tarent.de&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>APT Development Team &lt;deity@lists.debian.org&gt;</code>.
 (Mon, 16 Jun 2014 10:09:09 GMT) (<a href="bugreport.cgi?bug=749795;msg=115">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=115">mbox</a>, <a href="#114">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="116"></a><a name="msg116"></a><a href="#116">Message #116</a> received at 749795@bugs.debian.org (<a href="bugreport.cgi?bug=749795;msg=116">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=116">mbox</a>, <a href="mailto:749795@bugs.debian.org?body=On%20Mon%2C%2016%20Jun%202014%2012%3A04%3A51%20%2B0200%20%28CEST%29%20Thorsten%20Glaser%20%3Ct.glaser%40tarent.de%3E%20wrote%3A%0A%3E%20On%20Thu%2C%2012%20Jun%202014%2C%20David%20Kalnischkies%20wrote%3A%0A%3E%20%0A%3E%20%3E%20For%20your%20attack%20to%20be%20%28always%29%20successful%2C%20you%20need%20a%20full-sources%0A%3E%20%3E%20mirror%20on%20which%20you%20modify%20all%20tarballs%2C%20so%20that%20you%20can%20build%20a%20valid%0A%3E%20%3E%20Sources%20file.%20You%20can%27t%20just%20build%20your%20attack%20tarball%20on%20demand%20as%20the%0A%3E%20%0A%3E%20Erm%2C%20no%3F%20You%20can%20just%20cache%20a%20working%20Sources%20file%20and%20exchange%0A%3E%20the%20paragraph%20you%20are%20interested%20in.%20That%E2%80%99s%20something%20that%20would%0A%3E%20be%20easy%20in%20a%20CGI%20written%20in%20shell%2C%20%2Aand%2A%20perform%20well.%20Trivial.%0A%3E%20%0A%3E%20bye%2C%0A%3E%20%2F%2Fmirabilos%0A%3E%20--%20%0A%3E%20tarent%20solutions%20GmbH%0A%3E%20Rochusstra%C3%9Fe%202-4%2C%20D-53123%20Bonn%20%E2%80%A2%20http%3A%2F%2Fwww.tarent.de%2F%0A%3E%20Tel%3A%20%2B49%20228%2054881-393%20%E2%80%A2%20Fax%3A%20%2B49%20228%2054881-235%0A%3E%20HRB%205168%20%28AG%20Bonn%29%20%E2%80%A2%20USt-ID%20%28VAT%29%3A%20DE122264941%0A%3E%20Gesch%C3%A4ftsf%C3%BChrer%3A%20Dr.%20Stefan%20Barth%2C%20Kai%20Ebenrett%2C%20Boris%20Esser%2C%20Alexander%20Steeg%0A%3E%20%0A%3E%20%0A&amp;In-Reply-To=%3Calpine.DEB.2.10.1406161203450.26902%40tglase.lan.tarent.de%3E&amp;References=%3C1402527988.4739.34.camel%40heisenberg.scientia.net%3E%20%3C20140612152550.GA27001%40crossbow%3E%0A%20%3Calpine.DEB.2.10.1406161203450.26902%40tglase.lan.tarent.de%3E&amp;subject=Re%3A%20holes%20in%20secure%20apt">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=t.glaser%40tarent.de" alt="">
<div class="header"><span class="headerfield">From:</span> Thorsten Glaser &lt;t.glaser@tarent.de&gt;</div>
<div class="header"><span class="headerfield">To:</span> debian-devel@lists.debian.org</div>
<div class="header"><span class="headerfield">Cc:</span> 749795@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: holes in secure apt</div>
<div class="header"><span class="headerfield">Date:</span> Mon, 16 Jun 2014 12:04:51 +0200 (CEST)</div>
</div>
<pre class="message">On Thu, 12 Jun 2014, David Kalnischkies wrote:

&gt; For your attack to be (always) successful, you need a full-sources
&gt; mirror on which you modify all tarballs, so that you can build a valid
&gt; Sources file. You can&#39;t just build your attack tarball on demand as the

Erm, no? You can just cache a working Sources file and exchange
the paragraph you are interested in. That’s something that would
be easy in a CGI written in shell, *and* perform well. Trivial.

bye,
//mirabilos
-- 
tarent solutions GmbH
Rochusstraße 2-4, D-53123 Bonn • <a href="http://www.tarent.de/">http://www.tarent.de/</a>
Tel: +49 228 54881-393 • Fax: +49 228 54881-235
HRB 5168 (AG Bonn) • USt-ID (VAT): DE122264941
Geschäftsführer: Dr. Stefan Barth, Kai Ebenrett, Boris Esser, Alexander Steeg


</pre>

<div class="infmessage"><hr><p>
<a name="117"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, APT Development Team &lt;deity@lists.debian.org&gt; -->
<!-- time:1402923785 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, APT Development Team &lt;deity@lists.debian.org&gt;</code>:<br>
<code>Bug#749795</code>; Package <code>apt</code>.
 (Mon, 16 Jun 2014 13:03:05 GMT) (<a href="bugreport.cgi?bug=749795;msg=118">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=118">mbox</a>, <a href="#117">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="119"></a>
<!-- request_addr: Christoph Anton Mitterer &lt;calestyo@gmail.com&gt; -->
<!-- time:1402923785 -->
<strong>Acknowledgement sent</strong>
to <code>Christoph Anton Mitterer &lt;calestyo@gmail.com&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>APT Development Team &lt;deity@lists.debian.org&gt;</code>.
 (Mon, 16 Jun 2014 13:03:05 GMT) (<a href="bugreport.cgi?bug=749795;msg=120">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=120">mbox</a>, <a href="#119">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="121"></a><a name="msg121"></a><a href="#121">Message #121</a> received at 749795@bugs.debian.org (<a href="bugreport.cgi?bug=749795;msg=121">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=121">mbox</a>, <a href="mailto:749795@bugs.debian.org?body=On%20Mon%2C%2016%20Jun%202014%2014%3A58%3A28%20%2B0200%20Christoph%20Anton%20Mitterer%20%3Ccalestyo%40gmail.com%3E%20wrote%3A%0A%3E%20On%20Mon%2C%202014-06-16%20at%2009%3A35%20%2B0200%2C%20Michael%20Vogt%20wrote%3A%20%0A%3E%20%3E%20I%20think%20for%20the%20future%20we%20actually%20should%20not%20allow%20a%20apt-get%20update%0A%3E%20%3E%20of%20untrusted%20repos%20without%20--allow-unauthenticated%20%20or%0A%3E%20%3E%20%5Btrusted%3Dno%5D.%20But%20this%20will%20probably%20break%20some%20setups%20so%20we%20need%20to%0A%3E%20%3E%20be%20careful%20and%20not%20rush%20it.%0A%3E%20%0A%3E%20And%20what%20about%20the%20setups%2C%20which%20assume%20secure%20data%20to%20be%20retrieved%20%28as%0A%3E%20far%20as%20I%20can%20see%20the%20whole%20build%20stack%20of%20Debian%29%2C%20which%20is%20already%0A%3E%20broken%20now%3F%0A%3E%20%0A%3E%20Security%20is%20much%20more%20critical%20here%20then%20things%20continuing%20to%20work...%20if%0A%3E%20someone%27s%20setup%20really%20depend%20on%20not%20verifying%20integrity...%20he%20will%0A%3E%20immediately%20notice%20%28and%20can%20add%20the%20flag%29%2C...%20but%20no%20one%20notices%20if%20his%0A%3E%20security%20is%20compromised%20by%20MitMs...%20%3A-%28%0A%3E%20%0A%3E%20%0A%3E%20So%20I%20see%20not%20much%20of%20a%20reason%20to%20not%20implement%20that%20right%20away.%0A%3E%20%0A%3E%20%0A%3E%20Cheers%2C%0A%3E%20Chris.%0A%3E%20%0A%3E%20%0A%3E%20%0A&amp;In-Reply-To=%3C1402923508.4787.3.camel%40heisenberg.scientia.net%3E&amp;subject=Re%3A%20Bug%23749795%3A%20apt%3A%20no%20authentication%20checks%20for%20source%20packages&amp;References=%3C20140529210434.GA3935%40jwilk.net%3E%20%3C20140530132120.GA9713%40bod%3E%0A%09%20%3C20140616073506.GG9577%40bod%3E%0A%20%3C1402923508.4787.3.camel%40heisenberg.scientia.net%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=calestyo%40gmail.com" alt="">
<div class="header"><span class="headerfield">From:</span> Christoph Anton Mitterer &lt;calestyo@gmail.com&gt;</div>
<div class="header"><span class="headerfield">To:</span> 749795@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#749795: apt: no authentication checks for source packages</div>
<div class="header"><span class="headerfield">Date:</span> Mon, 16 Jun 2014 14:58:28 +0200</div>
</div>
<pre class="message">On Mon, 2014-06-16 at 09:35 +0200, Michael Vogt wrote: 
&gt; I think for the future we actually should not allow a apt-get update
&gt; of untrusted repos without --allow-unauthenticated  or
&gt; [trusted=no]. But this will probably break some setups so we need to
&gt; be careful and not rush it.

And what about the setups, which assume secure data to be retrieved (as
far as I can see the whole build stack of Debian), which is already
broken now?

Security is much more critical here then things continuing to work... if
someone&#39;s setup really depend on not verifying integrity... he will
immediately notice (and can add the flag),... but no one notices if his
security is compromised by MitMs... :-(


So I see not much of a reason to not implement that right away.


Cheers,
Chris.



</pre>

<div class="infmessage"><hr><p>
<a name="122"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, APT Development Team &lt;deity@lists.debian.org&gt; -->
<!-- time:1402937108 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, APT Development Team &lt;deity@lists.debian.org&gt;</code>:<br>
<code>Bug#749795</code>; Package <code>apt</code>.
 (Mon, 16 Jun 2014 16:45:08 GMT) (<a href="bugreport.cgi?bug=749795;msg=123">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=123">mbox</a>, <a href="#122">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="124"></a>
<!-- request_addr: Michael Vogt &lt;mvo@debian.org&gt; -->
<!-- time:1402937108 -->
<strong>Acknowledgement sent</strong>
to <code>Michael Vogt &lt;mvo@debian.org&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>APT Development Team &lt;deity@lists.debian.org&gt;</code>.
 (Mon, 16 Jun 2014 16:45:08 GMT) (<a href="bugreport.cgi?bug=749795;msg=125">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=125">mbox</a>, <a href="#124">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="126"></a><a name="msg126"></a><a href="#126">Message #126</a> received at 749795@bugs.debian.org (<a href="bugreport.cgi?bug=749795;msg=126">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=126">mbox</a>, <a href="mailto:749795@bugs.debian.org?subject=Re%3A%20Bug%23749795%3A%20apt%3A%20no%20authentication%20checks%20for%20source%20packages&amp;References=%3C20140529210434.GA3935%40jwilk.net%3E%0A%20%3C20140530132120.GA9713%40bod%3E%0A%20%3C20140616073506.GG9577%40bod%3E%0A%20%3C1402923508.4787.3.camel%40heisenberg.scientia.net%3E%0A%20%3C20140616164051.GH9577%40bod%3E&amp;body=On%20Mon%2C%2016%20Jun%202014%2018%3A40%3A51%20%2B0200%20Michael%20Vogt%20%3Cmvo%40debian.org%3E%20wrote%3A%0A%3E%20On%20Mon%2C%20Jun%2016%2C%202014%20at%2002%3A58%3A28PM%20%2B0200%2C%20Christoph%20Anton%20Mitterer%20wrote%3A%0A%3E%20%3E%20On%20Mon%2C%202014-06-16%20at%2009%3A35%20%2B0200%2C%20Michael%20Vogt%20wrote%3A%20%0A%3E%20%3E%20%3E%20I%20think%20for%20the%20future%20we%20actually%20should%20not%20allow%20a%20apt-get%20update%0A%3E%20%3E%20%3E%20of%20untrusted%20repos%20without%20--allow-unauthenticated%20%20or%0A%3E%20%3E%20%3E%20%5Btrusted%3Dno%5D.%20But%20this%20will%20probably%20break%20some%20setups%20so%20we%20need%20to%0A%3E%20%3E%20%3E%20be%20careful%20and%20not%20rush%20it.%0A%3E%20%3E%20%0A%3E%20%3E%20And%20what%20about%20the%20setups%2C%20which%20assume%20secure%20data%20to%20be%20retrieved%20%28as%0A%3E%20%3E%20far%20as%20I%20can%20see%20the%20whole%20build%20stack%20of%20Debian%29%2C%20which%20is%20already%0A%3E%20%3E%20broken%20now%3F%0A%3E%20%3E%20%0A%3E%20%3E%20Security%20is%20much%20more%20critical%20here%20then%20things%20continuing%20to%20work...%20if%0A%3E%20%3E%20someone%27s%20setup%20really%20depend%20on%20not%20verifying%20integrity...%20he%20will%0A%3E%20%3E%20immediately%20notice%20%28and%20can%20add%20the%20flag%29%2C...%20but%20no%20one%20notices%20if%20his%0A%3E%20%3E%20security%20is%20compromised%20by%20MitMs...%20%3A-%28%0A%3E%20%3E%0A%3E%20%3E%20So%20I%20see%20not%20much%20of%20a%20reason%20to%20not%20implement%20that%20right%20away.%0A%3E%20%0A%3E%20Absolutely%2C%20security%20is%20%28much%21%29%20more%20important.%0A%3E%20%0A%3E%20However%20with%20the%20fix%20that%20recently%20went%20into%20-security%20%22apt-get%20source%0A%3E%20foo%22%20will%20fail%20if%20foo%20comes%20from%20a%20not-authenticated%20source.%20What%20I%0A%3E%20wrote%20above%20is%20about%20not%20allowing%20%22apt-get%20update%22%20at%20all%20for%20unsigned%0A%3E%20repositories%20%28unless%20--allow-unauthenticated%20is%20used%29.%20But%20maybe%20you%0A%3E%20are%20right%20and%20the%20warning%20that%20I%20added%20to%20git%20should%20be%20a%20error%20that%0A%3E%20tells%20the%20user%20to%20use%20--allow-unauthenticated%20if%20he%2Fshe%20really%20wants%0A%3E%20to%20use%20a%20repository%20that%20we%20can%20not%20authenticate.%0A%3E%20%0A%3E%20Cheers%2C%0A%3E%20%20Michael%0A%3E%20%20%0A%3E%20%0A%3E%20%0A&amp;In-Reply-To=%3C20140616164051.GH9577%40bod%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=mvo%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Michael Vogt &lt;mvo@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> Christoph Anton Mitterer &lt;calestyo@gmail.com&gt;, 749795@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#749795: apt: no authentication checks for source packages</div>
<div class="header"><span class="headerfield">Date:</span> Mon, 16 Jun 2014 18:40:51 +0200</div>
</div>
<pre class="message">On Mon, Jun 16, 2014 at 02:58:28PM +0200, Christoph Anton Mitterer wrote:
&gt; On Mon, 2014-06-16 at 09:35 +0200, Michael Vogt wrote: 
&gt; &gt; I think for the future we actually should not allow a apt-get update
&gt; &gt; of untrusted repos without --allow-unauthenticated  or
&gt; &gt; [trusted=no]. But this will probably break some setups so we need to
&gt; &gt; be careful and not rush it.
&gt; 
&gt; And what about the setups, which assume secure data to be retrieved (as
&gt; far as I can see the whole build stack of Debian), which is already
&gt; broken now?
&gt; 
&gt; Security is much more critical here then things continuing to work... if
&gt; someone&#39;s setup really depend on not verifying integrity... he will
&gt; immediately notice (and can add the flag),... but no one notices if his
&gt; security is compromised by MitMs... :-(
&gt;
&gt; So I see not much of a reason to not implement that right away.

Absolutely, security is (much!) more important.

However with the fix that recently went into -security &quot;apt-get source
foo&quot; will fail if foo comes from a not-authenticated source. What I
wrote above is about not allowing &quot;apt-get update&quot; at all for unsigned
repositories (unless --allow-unauthenticated is used). But maybe you
are right and the warning that I added to git should be a error that
tells the user to use --allow-unauthenticated if he/she really wants
to use a repository that we can not authenticate.

Cheers,
 Michael
 


</pre>

<div class="infmessage"><hr><p>
<a name="127"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, APT Development Team &lt;deity@lists.debian.org&gt; -->
<!-- time:1402995064 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, APT Development Team &lt;deity@lists.debian.org&gt;</code>:<br>
<code>Bug#749795</code>; Package <code>apt</code>.
 (Tue, 17 Jun 2014 08:51:04 GMT) (<a href="bugreport.cgi?bug=749795;msg=128">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=128">mbox</a>, <a href="#127">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="129"></a>
<!-- request_addr: David Kalnischkies &lt;david@kalnischkies.de&gt; -->
<!-- time:1402995064 -->
<strong>Acknowledgement sent</strong>
to <code>David Kalnischkies &lt;david@kalnischkies.de&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>APT Development Team &lt;deity@lists.debian.org&gt;</code>.
 (Tue, 17 Jun 2014 08:51:04 GMT) (<a href="bugreport.cgi?bug=749795;msg=130">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=130">mbox</a>, <a href="#129">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="131"></a><a name="msg131"></a><a href="#131">Message #131</a> received at 749795@bugs.debian.org (<a href="bugreport.cgi?bug=749795;msg=131">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=131">mbox</a>, <a href="mailto:749795@bugs.debian.org?subject=Re%3A%20holes%20in%20secure%20apt&amp;References=%3C1402527988.4739.34.camel%40heisenberg.scientia.net%3E%0A%20%3C20140612152550.GA27001%40crossbow%3E%0A%20%3Calpine.DEB.2.10.1406161203450.26902%40tglase.lan.tarent.de%3E%0A%20%3C20140617084818.GA2605%40crossbow%3E&amp;In-Reply-To=%3C20140617084818.GA2605%40crossbow%3E&amp;body=On%20Tue%2C%2017%20Jun%202014%2010%3A48%3A18%20%2B0200%20David%20Kalnischkies%20%3Cdavid%40kalnischkies.de%3E%20wrote%3A%0A%3E%20On%20Mon%2C%20Jun%2016%2C%202014%20at%2012%3A04%3A51PM%20%2B0200%2C%20Thorsten%20Glaser%20wrote%3A%0A%3E%20%3E%20On%20Thu%2C%2012%20Jun%202014%2C%20David%20Kalnischkies%20wrote%3A%0A%3E%20%3E%20%3E%20For%20your%20attack%20to%20be%20%28always%29%20successful%2C%20you%20need%20a%20full-sources%0A%3E%20%3E%20%3E%20mirror%20on%20which%20you%20modify%20all%20tarballs%2C%20so%20that%20you%20can%20build%20a%20valid%0A%3E%20%3E%20%3E%20Sources%20file.%20You%20can%27t%20just%20build%20your%20attack%20tarball%20on%20demand%20as%20the%0A%3E%20%3E%20%0A%3E%20%3E%20Erm%2C%20no%3F%20You%20can%20just%20cache%20a%20working%20Sources%20file%20and%20exchange%0A%3E%20%3E%20the%20paragraph%20you%20are%20interested%20in.%20That%E2%80%99s%20something%20that%20would%0A%3E%20%3E%20be%20easy%20in%20a%20CGI%20written%20in%20shell%2C%20%2Aand%2A%20perform%20well.%20Trivial.%0A%3E%20%0A%3E%20The%20%22always%22%20refers%20to%20the%20small%20problem%20that%20a%20MITM%20isn%27t%20in%20control%20of%0A%3E%20what%20source%20package%20is%20acquired%20by%20the%20user%20later%20on.%20Modifying%20the%0A%3E%20Source%20file%20is%20of%20course%20trivial%2C%20the%20hard%20part%20is%20making%20the%0A%3E%20modification%20count%20given%20that%20at%20the%20time%20the%20request%20for%20the%20Sources%0A%3E%20file%20is%20made%20you%20have%20no%20idea%20what%20%28if%20any%29%20source%20package%20the%20user%20will%0A%3E%20request%20in%2010%20seconds%2Fdays%20following%20this%20%27apt-get%20update%27%20%28or%0A%3E%20equivalent%29%20%E2%80%93%20if%20the%20user%20isn%27t%20on%20to%20you%20given%20that%20you%20have%20thrown%0A%3E%20away%20the%20signatures%20for%20binary%20packages%2C%20too%2C%20so%20that%20he%20can%27t%20even%20get%0A%3E%20his%20build-dependencies%20without%20saying%20yes%20to%20a%20%28default%3A%20no%29%20warning.%0A%3E%20%0A%3E%20From%20a%20theoretical%20standpoint%2C%20this%20is%20of%20course%20all%20negligible%2C%20but%20in%0A%3E%20practice%20it%27s%20so%20annoying%2Ffragile%20that%20way%20better%20alternatives%20exist.%0A%3E%20%28Me%20messing%20up%20InRelease%20parsing%20%5Btwice%5D%20for%20example%20with%20ironically%20far%0A%3E%20less%20coverage%20-%20its%20all%20about%20catchy%20titles%20I%20guess%29%0A%3E%20%0A%3E%20%0A%3E%20Best%20regards%0A%3E%20%0A%3E%20David%20Kalnischkies%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=david%40kalnischkies.de" alt="">
<div class="header"><span class="headerfield">From:</span> David Kalnischkies &lt;david@kalnischkies.de&gt;</div>
<div class="header"><span class="headerfield">To:</span> debian-devel@lists.debian.org, 749795@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: holes in secure apt</div>
<div class="header"><span class="headerfield">Date:</span> Tue, 17 Jun 2014 10:48:18 +0200</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=0;bug=749795;msg=131">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message">On Mon, Jun 16, 2014 at 12:04:51PM +0200, Thorsten Glaser wrote:
&gt; On Thu, 12 Jun 2014, David Kalnischkies wrote:
&gt; &gt; For your attack to be (always) successful, you need a full-sources
&gt; &gt; mirror on which you modify all tarballs, so that you can build a valid
&gt; &gt; Sources file. You can&#39;t just build your attack tarball on demand as the
&gt; 
&gt; Erm, no? You can just cache a working Sources file and exchange
&gt; the paragraph you are interested in. That’s something that would
&gt; be easy in a CGI written in shell, *and* perform well. Trivial.

The &quot;always&quot; refers to the small problem that a MITM isn&#39;t in control of
what source package is acquired by the user later on. Modifying the
Source file is of course trivial, the hard part is making the
modification count given that at the time the request for the Sources
file is made you have no idea what (if any) source package the user will
request in 10 seconds/days following this &#39;apt-get update&#39; (or
equivalent) – if the user isn&#39;t on to you given that you have thrown
away the signatures for binary packages, too, so that he can&#39;t even get
his build-dependencies without saying yes to a (default: no) warning.

From a theoretical standpoint, this is of course all negligible, but in
practice it&#39;s so annoying/fragile that way better alternatives exist.
(Me messing up InRelease parsing [twice] for example with ironically far
less coverage - its all about catchy titles I guess)


Best regards

David Kalnischkies
</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=749795;filename=signature.asc;msg=131">signature.asc</a> (application/pgp-signature, inline)]</pre>

<div class="infmessage"><hr><p>
<a name="132"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, APT Development Team &lt;deity@lists.debian.org&gt; -->
<!-- time:1403072468 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, APT Development Team &lt;deity@lists.debian.org&gt;</code>:<br>
<code>Bug#749795</code>; Package <code>apt</code>.
 (Wed, 18 Jun 2014 06:21:08 GMT) (<a href="bugreport.cgi?bug=749795;msg=133">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=133">mbox</a>, <a href="#132">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="134"></a>
<!-- request_addr: Michael Vogt &lt;mvo@debian.org&gt; -->
<!-- time:1403072468 -->
<strong>Acknowledgement sent</strong>
to <code>Michael Vogt &lt;mvo@debian.org&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>APT Development Team &lt;deity@lists.debian.org&gt;</code>.
 (Wed, 18 Jun 2014 06:21:08 GMT) (<a href="bugreport.cgi?bug=749795;msg=135">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=135">mbox</a>, <a href="#134">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="136"></a><a name="msg136"></a><a href="#136">Message #136</a> received at 749795@bugs.debian.org (<a href="bugreport.cgi?bug=749795;msg=136">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=136">mbox</a>, <a href="mailto:749795@bugs.debian.org?body=On%20Wed%2C%2018%20Jun%202014%2008%3A17%3A42%20%2B0200%20Michael%20Vogt%20%3Cmvo%40debian.org%3E%20wrote%3A%0A%3E%20On%20Mon%2C%20Jun%2016%2C%202014%20at%2011%3A18%3A27AM%20%2B0200%2C%20Jakub%20Wilk%20wrote%3A%0A%3E%20%3E%20%2A%20Michael%20Vogt%20%3Cmvo%40debian.org%3E%2C%202014-06-16%2C%2009%3A35%3A%0A%3E%20%3E%20%3E%2B%20%20%20_error-%3EWarning%28_%28%22The%20data%20from%20%27%25s%27%20is%20not%20signed.%20All%20packages%20from%20%22%0A%3E%20%3E%20%3E%2B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22that%20repository%20can%20not%20be%20authenticated.%22%29%2C%0A%3E%20%3E%20%0A%3E%20%3E%20s%2Fcan%20not%2Fcannot%2F%0A%3E%20%3E%20%0A%3E%20%3E%20Also%2C%20%22All%22%20with%20a%20negated%20verb%20sounds%20awkward%20to%20me%20%28but%20that%20may%0A%3E%20%3E%20be%20due%20to%20my%20non-native-englishness%29.%20How%20about%3A%0A%3E%20%3E%20%0A%3E%20%3E%20%22No%20packages%20from%20that%20repository%20can%20be%20authenticated.%22%0A%3E%20%3E%20%0A%3E%20%3E%20or%20simply%0A%3E%20%3E%20%0A%3E%20%3E%20%22Packages%20from%20that%20repository%20cannot%20be%20authenticated.%22%0A%3E%20%3E%20%0A%3E%20%3E%20%3F%0A%3E%20%0A%3E%20I%20like%20the%20second%20string%2C%20I%20updated%20my%20branch.%20Thanks%21%0A%3E%20%0A%3E%20Cheers%2C%0A%3E%20%20Michael%0A%3E%20%0A%3E%20%0A&amp;In-Reply-To=%3C20140618061742.GJ9577%40bod%3E&amp;References=%3C20140529210434.GA3935%40jwilk.net%3E%0A%20%3C20140530132120.GA9713%40bod%3E%0A%20%3C20140616073506.GG9577%40bod%3E%0A%20%3C20140616091826.GA7070%40jwilk.net%3E%0A%20%3C20140618061742.GJ9577%40bod%3E&amp;subject=Re%3A%20Bug%23749795%3A%20apt%3A%20no%20authentication%20checks%20for%20source%20packages">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=mvo%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Michael Vogt &lt;mvo@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> Jakub Wilk &lt;jwilk@debian.org&gt;, 749795@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#749795: apt: no authentication checks for source packages</div>
<div class="header"><span class="headerfield">Date:</span> Wed, 18 Jun 2014 08:17:42 +0200</div>
</div>
<pre class="message">On Mon, Jun 16, 2014 at 11:18:27AM +0200, Jakub Wilk wrote:
&gt; * Michael Vogt &lt;mvo@debian.org&gt;, 2014-06-16, 09:35:
&gt; &gt;+   _error-&gt;Warning(_(&quot;The data from &#39;%s&#39; is not signed. All packages from &quot;
&gt; &gt;+                     &quot;that repository can not be authenticated.&quot;),
&gt; 
&gt; s/can not/cannot/
&gt; 
&gt; Also, &quot;All&quot; with a negated verb sounds awkward to me (but that may
&gt; be due to my non-native-englishness). How about:
&gt; 
&gt; &quot;No packages from that repository can be authenticated.&quot;
&gt; 
&gt; or simply
&gt; 
&gt; &quot;Packages from that repository cannot be authenticated.&quot;
&gt; 
&gt; ?

I like the second string, I updated my branch. Thanks!

Cheers,
 Michael


</pre>

<div class="msgreceived"><hr><p>
<a name="137"></a>
<!-- command:archive -->
<!-- requester: Debbugs Internal Request &lt;owner@bugs.debian.org&gt; -->
<!-- request_addr: internal_control@bugs.debian.org -->
<!-- time:1405496113 -->
<!-- new_data:
$new_data = {};
-->
<!-- old_data:
$old_data = {};
-->
<strong>Bug archived.</strong>
Request was from <code>Debbugs Internal Request &lt;owner@bugs.debian.org&gt;</code>
to <code>internal_control@bugs.debian.org</code>.
 (Wed, 16 Jul 2014 07:35:13 GMT) (<a href="bugreport.cgi?bug=749795;msg=138">full text</a>, <a href="bugreport.cgi?bug=749795;mbox=yes;msg=138">mbox</a>, <a href="#137">link</a>).</p></p></div>

<hr>
<p class="msgreceived">Send a report that <a href="https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=749795">this bug log contains spam</a>.</p>
<hr>
<ADDRESS>Debian bug tracking system administrator &lt;<A HREF="mailto:owner@bugs.debian.org">owner@bugs.debian.org</A>&gt;.
Last modified:
<!--timestamp-->Sat Oct 30 18:29:27 2021<!--end timestamp-->; 
Machine Name:
<!--machinename-->buxtehude<!--machinename-->
<P>
<A HREF="https://www.debian.org/Bugs/">Debian Bug tracking system</A>
</p>
<p>
  Debbugs is free software and licensed under the terms of the GNU
  Public License version 2. The current version can be obtained
  from <a href="https://bugs.debian.org/debbugs-source/">https://bugs.debian.org/debbugs-source/</a>.
</p>
<p>
Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.
</p>
</ADDRESS>

</body>
</html>
