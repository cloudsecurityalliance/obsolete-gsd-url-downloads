<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
<link rel="icon" href="/favicon.png">
<title>#544232 - fail2ban: Insecure creating/writing to tmpfile - Debian Bug report logs</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="/css/bugs.css" type="text/css">

<link rel="canonical" href="&lt;a href=&quot;bugreport.cgi?bug=544232&quot;&gt;544232&lt;/a&gt;">
<script type="text/javascript">
<!--
function toggle_infmessages()
{
        allDivs=document.getElementsByTagName("div");
        for (var i = 0 ; i < allDivs.length ; i++ )
        {
                if (allDivs[i].className == "infmessage")
                {
                        allDivs[i].style.display=(allDivs[i].style.display == 'none' | allDivs[i].style.display == '') ? 'block' : 'none';
                }
        }
}
-->
</script>
</head>
<body>
<h1>Debian Bug report logs - 
<a href="mailto:544232@bugs.debian.org">#544232</a><br>
fail2ban: Insecure creating/writing to tmpfile</h1>
<div class="versiongraph"><a href="version.cgi?collapse=1;info=1;found=fail2ban%2F0.8.4-3;found=fail2ban%2F0.8.3-2sid1;package=fail2ban;fixed=fail2ban%2F0.8.4%2Bsvn20110323-1;absolute=0"><img alt="version graph" src="version.cgi?collapse=1;package=fail2ban;found=fail2ban%2F0.8.4-3;found=fail2ban%2F0.8.3-2sid1;width=2;absolute=0;height=2;fixed=fail2ban%2F0.8.4%2Bsvn20110323-1"></a></div>
<div class="pkginfo">
  <p>Package:
     <a class="submitter" href="pkgreport.cgi?package=fail2ban">fail2ban</a>;
Maintainer for <a href="pkgreport.cgi?package=fail2ban">fail2ban</a> is <a href="pkgreport.cgi?maint=team%2Bpython%40tracker.debian.org">Debian Python Team &lt;team+python@tracker.debian.org&gt;</a>; Source for <a href="pkgreport.cgi?package=fail2ban">fail2ban</a> is <a href="pkgreport.cgi?src=fail2ban">src:fail2ban</a> (<a href="https://tracker.debian.org/pkg/fail2ban">PTS</a>, <a href="https://buildd.debian.org/fail2ban">buildd</a>, <a href="https://qa.debian.org/popcon.php?package=fail2ban">popcon</a>). </p>

</div>

<div class="buginfo">
  <p>Reported by: <a href="pkgreport.cgi?submitter=tomek%40lodz.tpsa.pl">Tomasz Papszun &lt;tomek@lodz.tpsa.pl&gt;</a></p>
  <p>Date: Sat, 29 Aug 2009 21:09:01 UTC</p>

<p>Severity: important</p>
<p>Tags: lenny, security, squeeze</p>

<p>Found in versions fail2ban/0.8.4-3, fail2ban/0.8.3-2sid1</p>
<p>Fixed in version fail2ban/0.8.4+svn20110323-1</p>

<p><strong>Done:</strong> Yaroslav Halchenko &lt;debian@onerussian.com&gt;</p>

<p>Bug is archived. No further changes may be made.<p><p>Forwarded to Cyril Jaquier &lt;cyril.jaquier@fail2ban.org&gt;</p>
</div>

<p><a href="javascript:toggle_infmessages();">Toggle useless messages</a></p><div class="msgreceived"><p>View this report as an <a href="bugreport.cgi?bug=544232;mbox=yes">mbox folder</a>, <a href="bugreport.cgi?bug=544232;mbox=yes;mboxstatus=yes">status mbox</a>, <a href="bugreport.cgi?bug=544232;mbox=yes;mboxmaint=yes">maintainer mbox</a></p></div>

<div class="infmessage"><hr><p>
<a name="1"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Yaroslav Halchenko &lt;debian@onerussian.com&gt; -->
<!-- time:1251580145 -->
<strong>Report forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Yaroslav Halchenko &lt;debian@onerussian.com&gt;</code>:<br>
<code>Bug#544232</code>; Package <code>fail2ban</code>.
 (Sat, 29 Aug 2009 21:09:05 GMT) (<a href="bugreport.cgi?bug=544232;msg=2">full text</a>, <a href="bugreport.cgi?bug=544232;mbox=yes;msg=2">mbox</a>, <a href="#1">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="3"></a>
<!-- request_addr: Tomasz Papszun &lt;tomek@lodz.tpsa.pl&gt; -->
<!-- time:1251580145 -->
<strong>Acknowledgement sent</strong>
to <code>Tomasz Papszun &lt;tomek@lodz.tpsa.pl&gt;</code>:<br>
New Bug report received and forwarded.  Copy sent to <code>Yaroslav Halchenko &lt;debian@onerussian.com&gt;</code>.
 (Sat, 29 Aug 2009 21:09:05 GMT) (<a href="bugreport.cgi?bug=544232;msg=4">full text</a>, <a href="bugreport.cgi?bug=544232;mbox=yes;msg=4">mbox</a>, <a href="#3">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="5"></a><a name="msg5"></a><a href="#5">Message #5</a> received at submit@bugs.debian.org (<a href="bugreport.cgi?bug=544232;msg=5">full text</a>, <a href="bugreport.cgi?bug=544232;mbox=yes;msg=5">mbox</a>, <a href="mailto:544232@bugs.debian.org?subject=Re%3A%20fail2ban%3A%20Insecure%20creating%2Fwriting%20to%20tmpfile&amp;References=%3C20090829210750.22121.11561.reportbug%40kiezmar.lodz.tpsa.pl%3E&amp;In-Reply-To=%3C20090829210750.22121.11561.reportbug%40kiezmar.lodz.tpsa.pl%3E&amp;body=On%20Sat%2C%2029%20Aug%202009%2023%3A07%3A50%20%2B0200%20Tomasz%20Papszun%20%3Ctomek%40lodz.tpsa.pl%3E%20wrote%3A%0A%3E%20Package%3A%20fail2ban%0A%3E%20Version%3A%200.8.3-2sid1%0A%3E%20Severity%3A%20important%0A%3E%20%0A%3E%20The%20files%20%20%2Fetc%2Ffail2ban%2Faction.d%2Fmail-buffered.conf%20%20and%20%0A%3E%20%2Fetc%2Ffail2ban%2Faction.d%2Fsendmail-buffered.conf%0A%3E%20use%20file%20in%20the%20writable-for-all%20directory%20for%20appending%20text%2C%20i.e.%0A%3E%20%0A%3E%20printf%20%25%25b%20%22%60date%60%3A%20%3Cip%3E%20%28%3Cfailures%3E%20failures%29%5Cn%22%20%3E%3E%20%3Ctmpfile%3E%0A%3E%20%0A%3E%20where%20%20tmpfile%20%3D%20%2Ftmp%2Ffail2ban-mail.txt%0A%3E%20%0A%3E%20Instead%20of%20that%20tmpfile%20definition%2C%20a%20unique%20filename%20should%20be%20used%2C%20%0A%3E%20e.g.%20by%20means%20of%20mktemp%281%29%2C%20like%3A%0A%3E%20%0A%3E%20tmpfile%3D%60mktemp%20%2Ftmp%2Ff2ban-mail.txt.XXXXXXXXXX%60%0A%3E%20%0A%3E%20which%20will%20safely%20create%20a%20file%20named%20like%20%20%0A%3E%20%2Ftmp%2Ff2ban-mail.txt.SsUtdRJQAg%0A%3E%20%0A%3E%20Currently%2C%20tmpfile%20is%20defined%20just%20once%20-%20at%20the%20starting%20of%20the%20script%2C%20%0A%3E%20if%20I%20understand%20the%20section%20%5BInit%5D%20correctly.%20As%20at%20the%20end%20of%20each%20%0A%3E%20execution%20of%20actionban%20the%20tmpfile%20is%20removed%2C%20simple%20replacing%20tmpfile%20%0A%3E%20definition%20with%20mktemp%281%29%20in%20%5BInit%5D%20section%20won%27t%20do%20because%20now%20the%20%0A%3E%20filename%20is%20known%20and%20the%20attacker%20can%20create%20it.%0A%3E%20So%20probably%2C%20mktemp%281%29%20should%20be%20used%20in%20the%20very%20definition%20of%20%0A%3E%20actionban%2C%20but%20as%20I%20don%27t%20know%20Python%2C%20I%27m%20not%20trying%20to%20prepare%20the%20%0A%3E%20patch%20myself%2C%20sorry%20%3A-%29.%0A%3E%20%0A%3E%20--%20System%20Information%3A%0A%3E%20Debian%20Release%3A%205.0.2%0A%3E%20%20%20APT%20prefers%20stable%0A%3E%20%20%20APT%20policy%3A%20%28500%2C%20%27stable%27%29%0A%3E%20Architecture%3A%20i386%20%28i686%29%0A%3E%20%0A%3E%20Kernel%3A%20Linux%202.6.26-2-686%20%28SMP%20w%2F1%20CPU%20core%29%0A%3E%20Locale%3A%20LANG%3DC%2C%20LC_CTYPE%3Dpl_PL.iso-8859-2%20%28charmap%3DISO-8859-2%29%0A%3E%20Shell%3A%20%2Fbin%2Fsh%20linked%20to%20%2Fbin%2Fbash%0A%3E%20%0A%3E%20Versions%20of%20packages%20fail2ban%20depends%20on%3A%0A%3E%20ii%20%20lsb-base%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%203.2-20%20%20%20%20%20Linux%20Standard%20Base%203.2%20init%20scrip%0A%3E%20ii%20%20python%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%202.5.2-3%20%20%20%20An%20interactive%20high-level%20object-o%0A%3E%20ii%20%20python-central%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%200.6.8%20%20%20%20%20%20register%20and%20build%20utility%20for%20Pyt%0A%3E%20%0A%3E%20Versions%20of%20packages%20fail2ban%20recommends%3A%0A%3E%20ii%20%20iptables%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%201.4.2-6%20%20%20%20administration%20tools%20for%20packet%20fi%0A%3E%20ii%20%20whois%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%204.7.30%20%20%20%20%20an%20intelligent%20whois%20client%0A%3E%20%0A%3E%20Versions%20of%20packages%20fail2ban%20suggests%3A%0A%3E%20ii%20%20bsd-mailx%20%5Bmailx%5D%20%208.1.2-0.20071201cvs-3%20A%20simple%20mail%20user%20agent%0A%3E%20ii%20%20mailx%20%20%20%20%20%20%20%20%20%20%20%20%20%201%3A20071201-3%20%20%20%20%20%20%20%20%20%20Transitional%20package%20for%20mailx%20ren%0A%3E%20pn%20%20python-gamin%20%20%20%20%20%20%20%3Cnone%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%28no%20description%20available%29%0A%3E%20%0A%3E%20--%20no%20debconf%20information%0A%3E%20%0A%3E%20%0A%3E%20%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=tomek%40lodz.tpsa.pl" alt="">
<div class="header"><span class="headerfield">From:</span> Tomasz Papszun &lt;tomek@lodz.tpsa.pl&gt;</div>
<div class="header"><span class="headerfield">To:</span> Debian Bug Tracking System &lt;submit@bugs.debian.org&gt;</div>
<div class="header"><span class="headerfield">Subject:</span> fail2ban: Insecure creating/writing to tmpfile</div>
<div class="header"><span class="headerfield">Date:</span> Sat, 29 Aug 2009 23:07:50 +0200</div>
</div>
<pre class="message">Package: fail2ban
Version: 0.8.3-2sid1
Severity: important

The files  /etc/fail2ban/action.d/mail-buffered.conf  and 
/etc/fail2ban/action.d/sendmail-buffered.conf
use file in the writable-for-all directory for appending text, i.e.

printf %%b &quot;`date`: &lt;ip&gt; (&lt;failures&gt; failures)\n&quot; &gt;&gt; &lt;tmpfile&gt;

where  tmpfile = /tmp/fail2ban-mail.txt

Instead of that tmpfile definition, a unique filename should be used, 
e.g. by means of mktemp(1), like:

tmpfile=`mktemp /tmp/f2ban-mail.txt.XXXXXXXXXX`

which will safely create a file named like  
/tmp/f2ban-mail.txt.SsUtdRJQAg

Currently, tmpfile is defined just once - at the starting of the script, 
if I understand the section [Init] correctly. As at the end of each 
execution of actionban the tmpfile is removed, simple replacing tmpfile 
definition with mktemp(1) in [Init] section won&#39;t do because now the 
filename is known and the attacker can create it.
So probably, mktemp(1) should be used in the very definition of 
actionban, but as I don&#39;t know Python, I&#39;m not trying to prepare the 
patch myself, sorry :-).

-- System Information:
Debian Release: 5.0.2
  APT prefers stable
  APT policy: (500, &#39;stable&#39;)
Architecture: i386 (i686)

Kernel: Linux 2.6.26-2-686 (SMP w/1 CPU core)
Locale: LANG=C, LC_CTYPE=pl_PL.iso-8859-2 (charmap=ISO-8859-2)
Shell: /bin/sh linked to /bin/bash

Versions of packages fail2ban depends on:
ii  lsb-base                      3.2-20     Linux Standard Base 3.2 init scrip
ii  python                        2.5.2-3    An interactive high-level object-o
ii  python-central                0.6.8      register and build utility for Pyt

Versions of packages fail2ban recommends:
ii  iptables                      1.4.2-6    administration tools for packet fi
ii  whois                         4.7.30     an intelligent whois client

Versions of packages fail2ban suggests:
ii  bsd-mailx [mailx]  8.1.2-0.20071201cvs-3 A simple mail user agent
ii  mailx              1:20071201-3          Transitional package for mailx ren
pn  python-gamin       &lt;none&gt;                (no description available)

-- no debconf information



</pre>

<div class="infmessage"><hr><p>
<a name="6"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org -->
<!-- time:1251586804 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org</code>:<br>
<code>Bug#544232</code>; Package <code>fail2ban</code>.
 (Sat, 29 Aug 2009 23:00:04 GMT) (<a href="bugreport.cgi?bug=544232;msg=7">full text</a>, <a href="bugreport.cgi?bug=544232;mbox=yes;msg=7">mbox</a>, <a href="#6">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="8"></a>
<!-- request_addr: Yaroslav Halchenko &lt;debian@onerussian.com&gt; -->
<!-- time:1251586804 -->
<strong>Acknowledgement sent</strong>
to <code>Yaroslav Halchenko &lt;debian@onerussian.com&gt;</code>:<br>
Extra info received and forwarded to list.
 (Sat, 29 Aug 2009 23:00:04 GMT) (<a href="bugreport.cgi?bug=544232;msg=9">full text</a>, <a href="bugreport.cgi?bug=544232;mbox=yes;msg=9">mbox</a>, <a href="#8">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="10"></a><a name="msg10"></a><a href="#10">Message #10</a> received at 544232@bugs.debian.org (<a href="bugreport.cgi?bug=544232;msg=10">full text</a>, <a href="bugreport.cgi?bug=544232;mbox=yes;msg=10">mbox</a>, <a href="mailto:544232@bugs.debian.org?body=On%20Sat%2C%2029%20Aug%202009%2018%3A50%3A08%20-0400%20Yaroslav%20Halchenko%20%3Cdebian%40onerussian.com%3E%20wrote%3A%0A%3E%20could%20you%20elaborate%20on%20what%20security%20implications%20%28since%20you%20are%20talking%0A%3E%20about%20attacks%29%20this%20bug%20would%20result%20in%3F%20to%20me%20--%20none%20%28besides%0A%3E%20%27misinformation%29%2C%20since%20that%20file%20to%20accumulate%20the%20body%20of%20the%20email%0A%3E%20which%20is%20to%20be%20sent%20upon%20actionstop.%0A%3E%20%0A%3E%20if%20I%20am%20right%2C%20and%20there%20is%20no%20security%20implications%2C%20then%20I%20would%20like%0A%3E%20to%20reduce%20severity%20to%20normal%20at%20most%0A%3E%20%0A%3E%20On%20Sat%2C%2029%20Aug%202009%2C%20Tomasz%20Papszun%20wrote%3A%0A%3E%20%0A%3E%20%3E%20Package%3A%20fail2ban%0A%3E%20%3E%20Version%3A%200.8.3-2sid1%0A%3E%20%3E%20Severity%3A%20important%0A%3E%20%0A%3E%20%3E%20The%20files%20%20%2Fetc%2Ffail2ban%2Faction.d%2Fmail-buffered.conf%20%20and%20%0A%3E%20%3E%20%2Fetc%2Ffail2ban%2Faction.d%2Fsendmail-buffered.conf%0A%3E%20%3E%20use%20file%20in%20the%20writable-for-all%20directory%20for%20appending%20text%2C%20i.e.%0A%3E%20--%20%0A%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.-.%0A%3E%20%3D------------------------------%20%20%20%2Fv%5C%20%20----------------------------%3D%0A%3E%20Keep%20in%20touch%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%5C%5C%20%20%20%20%20%28yoh%40%7Cwww.%29onerussian.com%0A%3E%20Yaroslav%20Halchenko%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%28%20%20%20%29%5C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ICQ%23%3A%2060653192%0A%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Linux%20User%20%20%20%20%5E%5E-%5E%5E%20%20%20%20%5B175555%5D%0A%3E%20%0A%3E%20%0A%3E%20%0A%3E%20%0A%3E%20%0A&amp;In-Reply-To=%3C20090829225008.GQ24090%40onerussian.com%3E&amp;subject=Re%3A%20Bug%23544232%3A%20fail2ban%3A%20Insecure%20creating%2Fwriting%20to%20tmpfile&amp;References=%3C20090829210750.22121.11561.reportbug%40kiezmar.lodz.tpsa.pl%3E%0A%20%3C20090829225008.GQ24090%40onerussian.com%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=debian%40onerussian.com" alt="">
<div class="header"><span class="headerfield">From:</span> Yaroslav Halchenko &lt;debian@onerussian.com&gt;</div>
<div class="header"><span class="headerfield">To:</span> Tomasz Papszun &lt;tomek@lodz.tpsa.pl&gt;, 544232@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#544232: fail2ban: Insecure creating/writing to tmpfile</div>
<div class="header"><span class="headerfield">Date:</span> Sat, 29 Aug 2009 18:50:08 -0400</div>
</div>
<pre class="message">could you elaborate on what security implications (since you are talking
about attacks) this bug would result in? to me -- none (besides
&#39;misinformation), since that file to accumulate the body of the email
which is to be sent upon actionstop.

if I am right, and there is no security implications, then I would like
to reduce severity to normal at most

On Sat, 29 Aug 2009, Tomasz Papszun wrote:

&gt; Package: fail2ban
&gt; Version: 0.8.3-2sid1
&gt; Severity: important

&gt; The files  /etc/fail2ban/action.d/mail-buffered.conf  and 
&gt; /etc/fail2ban/action.d/sendmail-buffered.conf
&gt; use file in the writable-for-all directory for appending text, i.e.
-- 
                                  .-.
=------------------------------   /v\  ----------------------------=
Keep in touch                    // \\     (yoh@|www.)onerussian.com
Yaroslav Halchenko              /(   )\               ICQ#: 60653192
                   Linux User    ^^-^^    [175555]





</pre>

<div class="infmessage"><hr><p>
<a name="11"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Yaroslav Halchenko &lt;debian@onerussian.com&gt; -->
<!-- time:1251590946 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Yaroslav Halchenko &lt;debian@onerussian.com&gt;</code>:<br>
<code>Bug#544232</code>; Package <code>fail2ban</code>.
 (Sun, 30 Aug 2009 00:09:06 GMT) (<a href="bugreport.cgi?bug=544232;msg=12">full text</a>, <a href="bugreport.cgi?bug=544232;mbox=yes;msg=12">mbox</a>, <a href="#11">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="13"></a>
<!-- request_addr: Tomasz Papszun &lt;tomek@lodz.tpsa.pl&gt; -->
<!-- time:1251590946 -->
<strong>Acknowledgement sent</strong>
to <code>Tomasz Papszun &lt;tomek@lodz.tpsa.pl&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Yaroslav Halchenko &lt;debian@onerussian.com&gt;</code>.
 (Sun, 30 Aug 2009 00:09:06 GMT) (<a href="bugreport.cgi?bug=544232;msg=14">full text</a>, <a href="bugreport.cgi?bug=544232;mbox=yes;msg=14">mbox</a>, <a href="#13">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="15"></a><a name="msg15"></a><a href="#15">Message #15</a> received at 544232@bugs.debian.org (<a href="bugreport.cgi?bug=544232;msg=15">full text</a>, <a href="bugreport.cgi?bug=544232;mbox=yes;msg=15">mbox</a>, <a href="mailto:544232@bugs.debian.org?subject=Re%3A%20Bug%23544232%3A%20fail2ban%3A%20Insecure%20creating%2Fwriting%20to%20tmpfile&amp;References=%3C20090829210750.22121.11561.reportbug%40kiezmar.lodz.tpsa.pl%3E%20%3C20090829225008.GQ24090%40onerussian.com%3E%0A%20%3C20090829235802.GE4713%40lodz.tpsa.pl%3E&amp;body=On%20Sun%2C%2030%20Aug%202009%2001%3A58%3A02%20%2B0200%20Tomasz%20Papszun%20%3Ctomek%40lodz.tpsa.pl%3E%20wrote%3A%0A%3E%20On%20Sat%2C%2029%20Aug%202009%20at%2018%3A50%3A08%20-0400%2C%20Yaroslav%20Halchenko%20wrote%3A%0A%3E%20%3E%20could%20you%20elaborate%20on%20what%20security%20implications%20%28since%20you%20are%20talking%0A%3E%20%3E%20about%20attacks%29%20this%20bug%20would%20result%20in%3F%20to%20me%20--%20none%20%28besides%0A%3E%20%3E%20%27misinformation%29%2C%20since%20that%20file%20to%20accumulate%20the%20body%20of%20the%20email%0A%3E%20%3E%20which%20is%20to%20be%20sent%20upon%20actionstop.%0A%3E%20%0A%3E%20You%27re%20welcome%21%0A%3E%20As%20the%20filename%20is%20predictable%2C%20and%20the%20directory%20is%20writable%20for%20%0A%3E%20everybody%2C%20an%20attacker%20can%20create%20a%20symlink%20leading%20to%20any%20file%2C%20also%20to%0A%3E%20files%20writable%20only%20for%20root.%20Then%20fail2ban%20%28which%20runs%20as%20root%29%20will%20%0A%3E%20damage%20the%20target%20file%20while%20writing%20to%20the%20tmpfile.%20Well%2C%20at%20least%20the%20%0A%3E%20most%20spectacular%20%3B-%28%20target%20%28%2Fetc%2Fshadow%29%20won%27t%20be%20overwritten%2C%20because%2C%20%0A%3E%20AFAICS%2C%20the%20script%20appends%20%28%3E%3E%29%2C%20not%20overwrites%20%28%3E%29.%20But%20some%20%0A%3E%20important%20file%20%28e.g.%20a%20binary%29%20can%20be%20damaged%20by%20appending%20some%20data%20to%20%0A%3E%20it.%0A%3E%20%0A%3E%20HTH%0A%3E%20%0A%3E%20%3E%20if%20I%20am%20right%2C%20and%20there%20is%20no%20security%20implications%2C%20then%20I%20would%20like%0A%3E%20%3E%20to%20reduce%20severity%20to%20normal%20at%20most%0A%3E%20%3E%20%0A%3E%20%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.-.%0A%3E%20%3E%20%3D------------------------------%20%20%20%2Fv%5C%20%20----------------------------%3D%0A%3E%20%3E%20Keep%20in%20touch%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%5C%5C%20%20%20%20%20%28yoh%40%7Cwww.%29onerussian.com%0A%3E%20%3E%20Yaroslav%20Halchenko%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%28%20%20%20%29%5C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ICQ%23%3A%2060653192%0A%3E%20%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Linux%20User%20%20%20%20%5E%5E-%5E%5E%20%20%20%20%5B175555%5D%0A%3E%20%3E%20%0A%3E%20%0A%3E%20--%20%0A%3E%20%20Tomasz%20Papszun%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20And%20it%27s%20only%0A%3E%20%20tomek%20at%20lodz.tpsa.pl%20http%3A%2F%2Fwww.lodz.tpsa.pl%2Fiso%2F%20%7C%20ones%20and%20zeros.%0A%3E%20%20tomek%20at%20clamav.net%20%20%20http%3A%2F%2Fwww.ClamAV.net%2F%20%20%20A%20GPL%20virus%20scanner%0A%3E%20%0A%3E%20%0A%3E%20%0A&amp;In-Reply-To=%3C20090829235802.GE4713%40lodz.tpsa.pl%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=tomek%40lodz.tpsa.pl" alt="">
<div class="header"><span class="headerfield">From:</span> Tomasz Papszun &lt;tomek@lodz.tpsa.pl&gt;</div>
<div class="header"><span class="headerfield">To:</span> Yaroslav Halchenko &lt;debian@onerussian.com&gt;</div>
<div class="header"><span class="headerfield">Cc:</span> 544232@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#544232: fail2ban: Insecure creating/writing to tmpfile</div>
<div class="header"><span class="headerfield">Date:</span> Sun, 30 Aug 2009 01:58:02 +0200</div>
</div>
<pre class="message">On Sat, 29 Aug 2009 at 18:50:08 -0400, Yaroslav Halchenko wrote:
&gt; could you elaborate on what security implications (since you are talking
&gt; about attacks) this bug would result in? to me -- none (besides
&gt; &#39;misinformation), since that file to accumulate the body of the email
&gt; which is to be sent upon actionstop.

You&#39;re welcome!
As the filename is predictable, and the directory is writable for 
everybody, an attacker can create a symlink leading to any file, also to
files writable only for root. Then fail2ban (which runs as root) will 
damage the target file while writing to the tmpfile. Well, at least the 
most spectacular ;-( target (/etc/shadow) won&#39;t be overwritten, because, 
AFAICS, the script appends (&gt;&gt;), not overwrites (&gt;). But some 
important file (e.g. a binary) can be damaged by appending some data to 
it.

HTH

&gt; if I am right, and there is no security implications, then I would like
&gt; to reduce severity to normal at most
&gt; 
&gt;                                   .-.
&gt; =------------------------------   /v\  ----------------------------=
&gt; Keep in touch                    // \\     (yoh@|www.)onerussian.com
&gt; Yaroslav Halchenko              /(   )\               ICQ#: 60653192
&gt;                    Linux User    ^^-^^    [175555]
&gt; 

-- 
 Tomasz Papszun                                     | And it&#39;s only
 tomek at lodz.tpsa.pl <a href="http://www.lodz.tpsa.pl/iso/">http://www.lodz.tpsa.pl/iso/</a> | ones and zeros.
 tomek at clamav.net   <a href="http://www.ClamAV.net/">http://www.ClamAV.net/</a>   A GPL virus scanner



</pre>

<div class="msgreceived"><hr><p>
<a name="16"></a>
<!-- request_addr: Yaroslav Halchenko &lt;debian@onerussian.com&gt; -->
<!-- time:1251612556 -->
<strong>Reply sent</strong>
to <code>Yaroslav Halchenko &lt;debian@onerussian.com&gt;</code>:<br>
You have marked Bug as forwarded.
 (Sun, 30 Aug 2009 06:09:16 GMT) (<a href="bugreport.cgi?bug=544232;msg=17">full text</a>, <a href="bugreport.cgi?bug=544232;mbox=yes;msg=17">mbox</a>, <a href="#16">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="18"></a><a name="msg18"></a><a href="#18">Message #18</a> received at 544232-forwarded@bugs.debian.org (<a href="bugreport.cgi?bug=544232;msg=18">full text</a>, <a href="bugreport.cgi?bug=544232;mbox=yes;msg=18">mbox</a>, <a href="mailto:544232@bugs.debian.org?body=On%20Sun%2C%2030%20Aug%202009%2002%3A04%3A03%20-0400%20Yaroslav%20Halchenko%20%3Cdebian%40onerussian.com%3E%20wrote%3A%0A%3E%20%0A%3E%20%0A%3E%20On%20Sun%2C%2030%20Aug%202009%2C%20Tomasz%20Papszun%20wrote%3A%0A%3E%20%3E%20everybody%2C%20an%20attacker%20can%20create%20a%20symlink%20leading%20to%20any%20file%2C%20also%20to%0A%3E%20%3E%20files%20writable%20only%20for%20root.%20Then%20fail2ban%20%28which%20runs%20as%20root%29%20will%20%0A%3E%20ah%2C%20right%20--%20I%20was%20silly...%20forwarding%20upstream%20for%20now%0A%3E%20%0A%3E%20Cyril%2C%20could%20you%20please%20have%20a%20look%20at%20http%3A%2F%2Fbugs.debian.org%2F544232%0A%3E%20%0A%3E%20quite%20a%20few%20actions%20are%20prone%20to%20such%20a%20problem%0A%3E%20%24%3E%20git%20grep%20%20-l%20tmpfile%0A%3E%20action.d%2Fdshield.conf%0A%3E%20action.d%2Fmail-buffered.conf%0A%3E%20action.d%2Fmynetwatchman.conf%0A%3E%20action.d%2Fsendmail-buffered.conf%0A%3E%20%0A%3E%20none%20of%20these%20actions%20is%20enabled%20by%20default%20in%20any%20jail%20afaik%20but%20still%0A%3E%20--%20it%20would%20be%20better%20to%20work%20it%20out%20in%20a%20sane%20fashion%0A%3E%20%0A%3E%20--%20%0A%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.-.%0A%3E%20%3D------------------------------%20%20%20%2Fv%5C%20%20----------------------------%3D%0A%3E%20Keep%20in%20touch%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%5C%5C%20%20%20%20%20%28yoh%40%7Cwww.%29onerussian.com%0A%3E%20Yaroslav%20Halchenko%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%28%20%20%20%29%5C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ICQ%23%3A%2060653192%0A%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Linux%20User%20%20%20%20%5E%5E-%5E%5E%20%20%20%20%5B175555%5D%0A%3E%20%0A%3E%20%0A&amp;In-Reply-To=%3C20090830060403.GS24090%40onerussian.com%3E&amp;References=%3C20090829210750.22121.11561.reportbug%40kiezmar.lodz.tpsa.pl%3E%0A%20%3C20090829225008.GQ24090%40onerussian.com%3E%0A%20%3C20090829235802.GE4713%40lodz.tpsa.pl%3E%0A%20%3C20090830060403.GS24090%40onerussian.com%3E&amp;subject=Re%3A%20Bug%23544232%3A%20fail2ban%3A%20Insecure%20creating%2Fwriting%20to%20tmpfile">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=debian%40onerussian.com" alt="">
<div class="header"><span class="headerfield">From:</span> Yaroslav Halchenko &lt;debian@onerussian.com&gt;</div>
<div class="header"><span class="headerfield">To:</span> Cyril Jaquier &lt;cyril.jaquier@fail2ban.org&gt;</div>
<div class="header"><span class="headerfield">Cc:</span> Tomasz Papszun &lt;tomek@lodz.tpsa.pl&gt;, 544232-forwarded@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#544232: fail2ban: Insecure creating/writing to tmpfile</div>
<div class="header"><span class="headerfield">Date:</span> Sun, 30 Aug 2009 02:04:03 -0400</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=0;bug=544232;msg=18">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message">

On Sun, 30 Aug 2009, Tomasz Papszun wrote:
&gt; everybody, an attacker can create a symlink leading to any file, also to
&gt; files writable only for root. Then fail2ban (which runs as root) will 
ah, right -- I was silly... forwarding upstream for now

Cyril, could you please have a look at <a href="http://bugs.debian.org/544232">http://bugs.debian.org/544232</a>

quite a few actions are prone to such a problem
$&gt; git grep  -l tmpfile
action.d/dshield.conf
action.d/mail-buffered.conf
action.d/mynetwatchman.conf
action.d/sendmail-buffered.conf

none of these actions is enabled by default in any jail afaik but still
-- it would be better to work it out in a sane fashion

-- 
                                  .-.
=------------------------------   /v\  ----------------------------=
Keep in touch                    // \\     (yoh@|www.)onerussian.com
Yaroslav Halchenko              /(   )\               ICQ#: 60653192
                   Linux User    ^^-^^    [175555]


</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=544232;filename=signature.asc;msg=18">signature.asc</a> (application/pgp-signature, inline)]</pre>

<div class="infmessage"><hr><p>
<a name="19"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Yaroslav Halchenko &lt;debian@onerussian.com&gt; -->
<!-- time:1288560243 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Yaroslav Halchenko &lt;debian@onerussian.com&gt;</code>:<br>
<code>Bug#544232</code>; Package <code>fail2ban</code>.
 (Sun, 31 Oct 2010 21:24:03 GMT) (<a href="bugreport.cgi?bug=544232;msg=20">full text</a>, <a href="bugreport.cgi?bug=544232;mbox=yes;msg=20">mbox</a>, <a href="#19">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="21"></a>
<!-- request_addr: Zbyszek Jędrzejewski-Szmek &lt;zbyszek@in.waw.pl&gt; -->
<!-- time:1288560243 -->
<strong>Acknowledgement sent</strong>
to <code>Zbyszek Jędrzejewski-Szmek &lt;zbyszek@in.waw.pl&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Yaroslav Halchenko &lt;debian@onerussian.com&gt;</code>.
 (Sun, 31 Oct 2010 21:24:03 GMT) (<a href="bugreport.cgi?bug=544232;msg=22">full text</a>, <a href="bugreport.cgi?bug=544232;mbox=yes;msg=22">mbox</a>, <a href="#21">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="23"></a><a name="msg23"></a><a href="#23">Message #23</a> received at 544232@bugs.debian.org (<a href="bugreport.cgi?bug=544232;msg=23">full text</a>, <a href="bugreport.cgi?bug=544232;mbox=yes;msg=23">mbox</a>, <a href="mailto:544232@bugs.debian.org?body=On%20Sun%2C%2031%20Oct%202010%2022%3A11%3A10%20%2B0100%20Zbyszek%20%3D%3Futf-8%3FQ%3FJ%3DC4%3D99drzejewski-Szmek%3F%3D%20%3Czbyszek%40in.waw.pl%3E%20wrote%3A%0A%3E%20Using%20a%20directory%20is%20fine%2C%20as%20long%20as%20it%20is%20used%20only%20once%3A%20because%0A%3E%20mktemp%20verifies%20that%20the%20directory%20didn%27t%20exists%20before%20when%20creating%0A%3E%20it%2C%20the%20same%20temporary%20directory%20name%20cannot%20be%20safely%20used%20after%0A%3E%20removing%20it.%20But%20actionstop%20which%20removes%20the%20temporary%20directory%0A%3E%20should%20be%20run%20only%20once%20when%20closing%20fail2ban.%20If%20the%20configuration%20is%0A%3E%20reloaded%2C%20a%20new%20temporary%20directory%20will%20be%20created%2C%20which%20is%20good.%0A%3E%20%0A%3E%20Patch%20untested%20%3A%28%0A%3E%20---%0A%3E%20%20config%2Faction.d%2Fdshield.conf%20%20%20%20%20%20%20%20%20%20%20%7C%20%20%20%205%20%2B%2B%2B--%0A%3E%20%20config%2Faction.d%2Fmail-buffered.conf%20%20%20%20%20%7C%20%20%20%204%20%2B%2B%2B-%0A%3E%20%20config%2Faction.d%2Fmynetwatchman.conf%20%20%20%20%20%7C%20%20%20%209%20%2B%2B-------%0A%3E%20%20config%2Faction.d%2Fsendmail-buffered.conf%20%7C%20%20%20%205%20%2B%2B%2B--%0A%3E%20%204%20files%20changed%2C%2011%20insertions%28%2B%29%2C%2012%20deletions%28-%29%0A%3E%20%0A%3E%20diff%20--git%20a%2Fconfig%2Faction.d%2Fdshield.conf%20b%2Fconfig%2Faction.d%2Fdshield.conf%0A%3E%20index%20b80698b..8dba15f%20100644%0A%3E%20---%20a%2Fconfig%2Faction.d%2Fdshield.conf%0A%3E%20%2B%2B%2B%20b%2Fconfig%2Faction.d%2Fdshield.conf%0A%3E%20%40%40%20-44%2C6%20%2B44%2C7%20%40%40%20actionstop%20%3D%20if%20%5B%20-f%20%3Ctmpfile%3E.buffer%20%5D%3B%20then%0A%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20date%20%2B%25%25s%20%3E%20%3Ctmpfile%3E.lastsent%0A%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20fi%0A%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20rm%20-f%20%3Ctmpfile%3E.buffer%20%3Ctmpfile%3E.first%0A%3E%20%2B%20%20%20%20%20%20%20%20%20%20%20%20%20rmdir%20%3Ctmpdir%3E%0A%3E%20%20%0A%3E%20%20%23%20Option%3A%20%20actioncheck%0A%3E%20%20%23%20Notes.%3A%20%20command%20executed%20once%20before%20each%20actionban%20command%0A%3E%20%40%40%20-206%2C5%20%2B207%2C5%20%40%40%20dest%20%3D%20reports%40dshield.org%0A%3E%20%20%23%20Notes.%3A%20%20Base%20name%20of%20temporary%20files%20used%20for%20buffering%0A%3E%20%20%23%20Values%3A%20%20%5B%20STRING%20%5D%20%20Default%3A%20%2Ftmp%2Ffail2ban-dshield%0A%3E%20%20%23%0A%3E%20-tmpfile%20%3D%20%2Ftmp%2Ffail2ban-dshield%0A%3E%20-%0A%3E%20%2Btmpdir%20%3D%20%60mktemp%20--directory%20--suffix%3D-f2ban-dshield%60%0A%3E%20%2Btmpfile%20%3D%20%3Ctmpdir%3E%2Fdshield%0A%3E%20diff%20--git%20a%2Fconfig%2Faction.d%2Fmail-buffered.conf%20b%2Fconfig%2Faction.d%2Fmail-buffered.conf%0A%3E%20index%208a33d0e..00b734f%20100644%0A%3E%20---%20a%2Fconfig%2Faction.d%2Fmail-buffered.conf%0A%3E%20%2B%2B%2B%20b%2Fconfig%2Faction.d%2Fmail-buffered.conf%0A%3E%20%40%40%20-29%2C6%20%2B29%2C7%20%40%40%20actionstop%20%3D%20if%20%5B%20-f%20%3Ctmpfile%3E%20%5D%3B%20then%0A%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Fail2Ban%22%7Cmail%20-s%20%22%5BFail2Ban%5D%20%3Cname%3E%3A%20Summary%22%20%3Cdest%3E%0A%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20rm%20%3Ctmpfile%3E%0A%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20fi%0A%3E%20%2B%20%20%20%20%20%20%20%20%20%20%20%20%20rmdir%20%3Ctmpdir%3E%0A%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20printf%20%25%25b%20%22Hi%2C%5Cn%0A%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20The%20jail%20%3Cname%3E%20has%20been%20stopped.%5Cn%0A%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Regards%2C%5Cn%0A%3E%20%40%40%20-81%2C7%20%2B82%2C8%20%40%40%20lines%20%3D%205%0A%3E%20%20%0A%3E%20%20%23%20Default%20temporary%20file%0A%3E%20%20%23%0A%3E%20-tmpfile%20%3D%20%2Ftmp%2Ffail2ban-mail.txt%0A%3E%20%2Btmpdir%20%3D%20%60mktemp%20--directory%20--suffix%3D-f2ban-mail%60%0A%3E%20%2Btmpfile%20%3D%20%3Ctmpdir%3E%2Fbuffer.txt%0A%3E%20%20%0A%3E%20%20%23%20Destination%2FAddressee%20of%20the%20mail%0A%3E%20%20%23%0A%3E%20diff%20--git%20a%2Fconfig%2Faction.d%2Fmynetwatchman.conf%20b%2Fconfig%2Faction.d%2Fmynetwatchman.conf%0A%3E%20index%2015b91b1..9a1600f%20100644%0A%3E%20---%20a%2Fconfig%2Faction.d%2Fmynetwatchman.conf%0A&amp;In-Reply-To=%3C20101031211110.GH6756%40in.waw.pl%3E&amp;References=%3C20101031211110.GH6756%40in.waw.pl%3E&amp;subject=Re%3A%20tentative%20%5BPATCH%5D%20issue5178%3A%20use%20a%20temporary%20directory%20or%20file%0A%09created%20with%20mktemp">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=zbyszek%40in.waw.pl" alt="">
<div class="header"><span class="headerfield">From:</span> Zbyszek Jędrzejewski-Szmek &lt;zbyszek@in.waw.pl&gt;</div>
<div class="header"><span class="headerfield">To:</span> 544232@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> tentative [PATCH] issue5178: use a temporary directory or file
	created with mktemp</div>
<div class="header"><span class="headerfield">Date:</span> Sun, 31 Oct 2010 22:11:10 +0100</div>
</div>
<pre class="message">Using a directory is fine, as long as it is used only once: because
mktemp verifies that the directory didn&#39;t exists before when creating
it, the same temporary directory name cannot be safely used after
removing it. But actionstop which removes the temporary directory
should be run only once when closing fail2ban. If the configuration is
reloaded, a new temporary directory will be created, which is good.

Patch untested :(
---
 config/action.d/dshield.conf           |    5 +++--
 config/action.d/mail-buffered.conf     |    4 +++-
 config/action.d/mynetwatchman.conf     |    9 ++-------
 config/action.d/sendmail-buffered.conf |    5 +++--
 4 files changed, 11 insertions(+), 12 deletions(-)

diff --git a/config/action.d/dshield.conf b/config/action.d/dshield.conf
index b80698b..8dba15f 100644
--- a/config/action.d/dshield.conf
+++ b/config/action.d/dshield.conf
@@ -44,6 +44,7 @@ actionstop = if [ -f &lt;tmpfile&gt;.buffer ]; then
                  date +%%s &gt; &lt;tmpfile&gt;.lastsent
              fi
              rm -f &lt;tmpfile&gt;.buffer &lt;tmpfile&gt;.first
+             rmdir &lt;tmpdir&gt;
 
 # Option:  actioncheck
 # Notes.:  command executed once before each actionban command
@@ -206,5 +207,5 @@ dest = reports@dshield.org
 # Notes.:  Base name of temporary files used for buffering
 # Values:  [ STRING ]  Default: /tmp/fail2ban-dshield
 #
-tmpfile = /tmp/fail2ban-dshield
-
+tmpdir = `mktemp --directory --suffix=-f2ban-dshield`
+tmpfile = &lt;tmpdir&gt;/dshield
diff --git a/config/action.d/mail-buffered.conf b/config/action.d/mail-buffered.conf
index 8a33d0e..00b734f 100644
--- a/config/action.d/mail-buffered.conf
+++ b/config/action.d/mail-buffered.conf
@@ -29,6 +29,7 @@ actionstop = if [ -f &lt;tmpfile&gt; ]; then
                  Fail2Ban&quot;|mail -s &quot;[Fail2Ban] &lt;name&gt;: Summary&quot; &lt;dest&gt;
                  rm &lt;tmpfile&gt;
              fi
+             rmdir &lt;tmpdir&gt;
              printf %%b &quot;Hi,\n
              The jail &lt;name&gt; has been stopped.\n
              Regards,\n
@@ -81,7 +82,8 @@ lines = 5
 
 # Default temporary file
 #
-tmpfile = /tmp/fail2ban-mail.txt
+tmpdir = `mktemp --directory --suffix=-f2ban-mail`
+tmpfile = &lt;tmpdir&gt;/buffer.txt
 
 # Destination/Addressee of the mail
 #
diff --git a/config/action.d/mynetwatchman.conf b/config/action.d/mynetwatchman.conf
index 15b91b1..9a1600f 100644
--- a/config/action.d/mynetwatchman.conf
+++ b/config/action.d/mynetwatchman.conf
@@ -66,7 +66,8 @@ actionban = MNWLOGIN=`perl -e &#39;$s=shift;$s=~s/([\W])/&quot;%%&quot;.uc(sprintf(&quot;%%2.2x&quot;,or
 	    PROTOCOL=`awk &#39;{IGNORECASE=1;if($1==&quot;&lt;protocol&gt;&quot;){print $2;exit}}&#39; /etc/protocols`
 	    if [ -z &quot;$PROTOCOL&quot; ]; then PROTOCOL=&lt;protocol&gt;; fi
 	    DATETIME=`perl -e &#39;@t=gmtime(&lt;time&gt;);printf &quot;%%4d-%%02d-%%02d+%%02d:%%02d:%%02d&quot;,1900+$t[5],$t[4]+1,$t[3],$t[2],$t[1],$t[0]&#39;`
-            &lt;getcmd&gt; &quot;&lt;mnwurl&gt;?AT=2&amp;AV=0&amp;AgentEmail=$MNWLOGIN&amp;AgentPassword=$MNWPASS&amp;AttackerIP=&lt;ip&gt;&amp;SrcPort=&lt;srcport&gt;&amp;ProtocolID=$PROTOCOL&amp;DestPort=&lt;port&gt;&amp;AttackCount=&lt;failures&gt;&amp;VictimIP=&lt;myip&gt;&amp;AttackDateTime=$DATETIME&quot; 2&gt;&amp;1 &gt;&gt; &lt;tmpfile&gt;.out &amp;&amp; grep -q &#39;Attack Report Insert Successful&#39; &lt;tmpfile&gt;.out &amp;&amp; rm -f &lt;tmpfile&gt;.out
+            TMPFILE=`mktemp --suffix -f2ban-mynetwatchman.out`
+            &lt;getcmd&gt; &quot;&lt;mnwurl&gt;?AT=2&amp;AV=0&amp;AgentEmail=$MNWLOGIN&amp;AgentPassword=$MNWPASS&amp;AttackerIP=&lt;ip&gt;&amp;SrcPort=&lt;srcport&gt;&amp;ProtocolID=$PROTOCOL&amp;DestPort=&lt;port&gt;&amp;AttackCount=&lt;failures&gt;&amp;VictimIP=&lt;myip&gt;&amp;AttackDateTime=$DATETIME&quot; 2&gt;&amp;1 &gt;&gt; &quot;$TMPFILE&quot; &amp;&amp; grep -q &#39;Attack Report Insert Successful&#39; &quot;$TMPFILE&quot; &amp;&amp; rm -f &quot;$TMPFILE&quot;
 
 # Option:  actionunban
 # Notes.:  command executed when unbanning an IP. Take care that the
@@ -136,9 +137,3 @@ srcport = 0
 # Values:  STRING  Default: <a href="http://mynetwatchman.com/insertwebreport.asp">http://mynetwatchman.com/insertwebreport.asp</a>
 #
 mnwurl = <a href="http://mynetwatchman.com/insertwebreport.asp">http://mynetwatchman.com/insertwebreport.asp</a>
-
-# Option:  tmpfile
-# Notes.:  Base name of temporary files
-# Values:  [ STRING ]  Default: /tmp/fail2ban-mynetwatchman
-#
-tmpfile = /tmp/fail2ban-mynetwatchman
diff --git a/config/action.d/sendmail-buffered.conf b/config/action.d/sendmail-buffered.conf
index de8166a..3a4e950 100644
--- a/config/action.d/sendmail-buffered.conf
+++ b/config/action.d/sendmail-buffered.conf
@@ -35,6 +35,7 @@ actionstop = if [ -f &lt;tmpfile&gt; ]; then
                  Fail2Ban&quot; | /usr/sbin/sendmail -f &lt;sender&gt; &lt;dest&gt;
                  rm &lt;tmpfile&gt;
              fi
+             rmdir &lt;tmpdir&gt;
              printf %%b &quot;Subject: [Fail2Ban] &lt;name&gt;: stopped
              From: Fail2Ban &lt;&lt;sender&gt;&gt;
              To: &lt;dest&gt;\n
@@ -101,5 +102,5 @@ lines = 5
 
 # Default temporary file
 #
-tmpfile = /tmp/fail2ban-mail.txt
-
+tmpdir = `mktemp --directory --suffix=-f2ban-mail`
+tmpfile = &lt;tmpdir&gt;/buffer.txt
-- 
1.6.4.124.g27bb1




</pre>

<div class="infmessage"><hr><p>
<a name="24"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org -->
<!-- time:1288571583 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org</code>:<br>
<code>Bug#544232</code>; Package <code>fail2ban</code>.
 (Mon, 01 Nov 2010 00:33:03 GMT) (<a href="bugreport.cgi?bug=544232;msg=25">full text</a>, <a href="bugreport.cgi?bug=544232;mbox=yes;msg=25">mbox</a>, <a href="#24">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="26"></a>
<!-- request_addr: Yaroslav Halchenko &lt;debian@onerussian.com&gt; -->
<!-- time:1288571583 -->
<strong>Acknowledgement sent</strong>
to <code>Yaroslav Halchenko &lt;debian@onerussian.com&gt;</code>:<br>
Extra info received and forwarded to list.
 (Mon, 01 Nov 2010 00:33:03 GMT) (<a href="bugreport.cgi?bug=544232;msg=27">full text</a>, <a href="bugreport.cgi?bug=544232;mbox=yes;msg=27">mbox</a>, <a href="#26">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="28"></a><a name="msg28"></a><a href="#28">Message #28</a> received at 544232@bugs.debian.org (<a href="bugreport.cgi?bug=544232;msg=28">full text</a>, <a href="bugreport.cgi?bug=544232;mbox=yes;msg=28">mbox</a>, <a href="mailto:544232@bugs.debian.org?References=%3C20101031211110.GH6756%40in.waw.pl%3E%0A%20%3C20101101003023.GF12312%40onerussian.com%3E&amp;subject=Re%3A%20Bug%23544232%3A%20tentative%20%5BPATCH%5D%20issue5178%3A%20use%20a%20temporary%0A%20directory%20or%20file%20created%20with%20mktemp&amp;In-Reply-To=%3C20101101003023.GF12312%40onerussian.com%3E&amp;body=On%20Sun%2C%2031%20Oct%202010%2020%3A30%3A23%20-0400%20Yaroslav%20Halchenko%20%3Cdebian%40onerussian.com%3E%20wrote%3A%0A%3E%20Hi%20Zbyszek%2C%0A%3E%20%0A%3E%20thanks%20for%20looking%20into%20it%20...%0A%3E%20%0A%3E%20action.d%2Fmynetwatchman.conf%20%20changes%20--%20should%20be%20ok%0A%3E%20action.d%2Fmail-buffered.conf%20--%20I%20don%27t%20think%20it%20would%20work...%0A%3E%20%0A%3E%20%3E%20%2Btmpdir%20%3D%20%60mktemp%20--directory%20--suffix%3D-f2ban-dshield%60%0A%3E%20%3E%20%2Btmpfile%20%3D%20%3Ctmpdir%3E%2Fdshield%0A%3E%20%0A%3E%20since%20this%20is%20just%20a%20Python%20config%20file%2C%20it%20would%20simply%20substitute%0A%3E%20%60mktemp%20--directory%20--suffix%3D-f2ban-dshield%60%2Fdshield%0A%3E%20for%20every%20occurrence%20of%20%3Ctmpfile%3E%20which%20would%20be%20not%20what%20is%20desired...%0A%3E%20am%20I%20correct%3F%0A%3E%20%0A%3E%20%0A%3E%20as%20a%20generic%20and%20simple%20resolution%2C%20I%20think%2C%20tmpfiles%20should%20simply%20be%0A%3E%20created%20under%20%2Fvar%2Frun%2Ffail2ban%20which%20belongs%20to%20root.%20%20I%20think%20there%0A%3E%20was%20some%20discussion%20in%20some%20other%20bugreport...%20or%20it%20is%20deja%20vu%0A%3E%20%0A%3E%20agreed%3F%0A%3E%20%0A%3E%20--%20%0A%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.-.%0A%3E%20%3D------------------------------%20%20%20%2Fv%5C%20%20----------------------------%3D%0A%3E%20Keep%20in%20touch%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%5C%5C%20%20%20%20%20%28yoh%40%7Cwww.%29onerussian.com%0A%3E%20Yaroslav%20Halchenko%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%28%20%20%20%29%5C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ICQ%23%3A%2060653192%0A%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Linux%20User%20%20%20%20%5E%5E-%5E%5E%20%20%20%20%5B175555%5D%0A%3E%20%0A%3E%20%0A%3E%20%0A%3E%20%0A%3E%20%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=debian%40onerussian.com" alt="">
<div class="header"><span class="headerfield">From:</span> Yaroslav Halchenko &lt;debian@onerussian.com&gt;</div>
<div class="header"><span class="headerfield">To:</span> Zbyszek Jędrzejewski-Szmek &lt;zbyszek@in.waw.pl&gt;,
	544232@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#544232: tentative [PATCH] issue5178: use a temporary
 directory or file created with mktemp</div>
<div class="header"><span class="headerfield">Date:</span> Sun, 31 Oct 2010 20:30:23 -0400</div>
</div>
<pre class="message">Hi Zbyszek,

thanks for looking into it ...

action.d/mynetwatchman.conf  changes -- should be ok
action.d/mail-buffered.conf -- I don&#39;t think it would work...

&gt; +tmpdir = `mktemp --directory --suffix=-f2ban-dshield`
&gt; +tmpfile = &lt;tmpdir&gt;/dshield

since this is just a Python config file, it would simply substitute
`mktemp --directory --suffix=-f2ban-dshield`/dshield
for every occurrence of &lt;tmpfile&gt; which would be not what is desired...
am I correct?


as a generic and simple resolution, I think, tmpfiles should simply be
created under /var/run/fail2ban which belongs to root.  I think there
was some discussion in some other bugreport... or it is deja vu

agreed?

-- 
                                  .-.
=------------------------------   /v\  ----------------------------=
Keep in touch                    // \\     (yoh@|www.)onerussian.com
Yaroslav Halchenko              /(   )\               ICQ#: 60653192
                   Linux User    ^^-^^    [175555]





</pre>

<div class="infmessage"><hr><p>
<a name="29"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Yaroslav Halchenko &lt;debian@onerussian.com&gt; -->
<!-- time:1288598763 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Yaroslav Halchenko &lt;debian@onerussian.com&gt;</code>:<br>
<code>Bug#544232</code>; Package <code>fail2ban</code>.
 (Mon, 01 Nov 2010 08:06:03 GMT) (<a href="bugreport.cgi?bug=544232;msg=30">full text</a>, <a href="bugreport.cgi?bug=544232;mbox=yes;msg=30">mbox</a>, <a href="#29">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="31"></a>
<!-- request_addr: Zbyszek Szmek &lt;zbyszek@in.waw.pl&gt; -->
<!-- time:1288598763 -->
<strong>Acknowledgement sent</strong>
to <code>Zbyszek Szmek &lt;zbyszek@in.waw.pl&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Yaroslav Halchenko &lt;debian@onerussian.com&gt;</code>.
 (Mon, 01 Nov 2010 08:06:03 GMT) (<a href="bugreport.cgi?bug=544232;msg=32">full text</a>, <a href="bugreport.cgi?bug=544232;mbox=yes;msg=32">mbox</a>, <a href="#31">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="33"></a><a name="msg33"></a><a href="#33">Message #33</a> received at 544232@bugs.debian.org (<a href="bugreport.cgi?bug=544232;msg=33">full text</a>, <a href="bugreport.cgi?bug=544232;mbox=yes;msg=33">mbox</a>, <a href="mailto:544232@bugs.debian.org?In-Reply-To=%3C20101101080316.GI6756%40in.waw.pl%3E&amp;body=On%20Mon%2C%201%20Nov%202010%2009%3A03%3A16%20%2B0100%20Zbyszek%20Szmek%20%3Czbyszek%40in.waw.pl%3E%20wrote%3A%0A%3E%20On%20Sun%2C%20Oct%2031%2C%202010%20at%2008%3A30%3A23PM%20-0400%2C%20Yaroslav%20Halchenko%20wrote%3A%0A%3E%20Hi%20Yaroslav%2C%0A%3E%20%0A%3E%20%3E%20Hi%20Zbyszek%2C%0A%3E%20%3E%20%0A%3E%20%3E%20thanks%20for%20looking%20into%20it%20...%0A%3E%20Thanks%20for%20the%20quick%20reply%20%3A%29%0A%3E%20%0A%3E%20%3E%20action.d%2Fmynetwatchman.conf%20%20changes%20--%20should%20be%20ok%0A%3E%20This%20parts%20is%20still%20valid...%0A%3E%20%0A%3E%20%3E%20action.d%2Fmail-buffered.conf%20--%20I%20don%27t%20think%20it%20would%20work...%0A%3E%20...but%20the%20other%20three%20won%27t%20work%20indeed.%20%28I%20had%20some%20strange%0A%3E%20notion%20that%20the%20mktemp%20would%20get%20executed%20tmpdir%20variable%20initialization%2C%0A%3E%20but%20it%20just%20gets%20substituted%20into%20the%20final%20command%20like%20you%20said.%0A%3E%20%0A%3E%20%3E%20%0A%3E%20%3E%20%3E%20%2Btmpdir%20%3D%20%60mktemp%20--directory%20--suffix%3D-f2ban-dshield%60%0A%3E%20%3E%20%3E%20%2Btmpfile%20%3D%20%3Ctmpdir%3E%2Fdshield%0A%3E%20%3E%20%0A%3E%20%3E%20since%20this%20is%20just%20a%20Python%20config%20file%2C%20it%20would%20simply%20substitute%0A%3E%20%3E%20%60mktemp%20--directory%20--suffix%3D-f2ban-dshield%60%2Fdshield%0A%3E%20%3E%20for%20every%20occurrence%20of%20%3Ctmpfile%3E%20which%20would%20be%20not%20what%20is%20desired...%0A%3E%20%3E%20am%20I%20correct%3F%0A%3E%20%3E%20%0A%3E%20%3E%20%0A%3E%20%3E%20as%20a%20generic%20and%20simple%20resolution%2C%20I%20think%2C%20tmpfiles%20should%20simply%20be%0A%3E%20%3E%20created%20under%20%2Fvar%2Frun%2Ffail2ban%20which%20belongs%20to%20root.%20%20I%20think%20there%0A%3E%20%3E%20was%20some%20discussion%20in%20some%20other%20bugreport...%20or%20it%20is%20deja%20vu%0A%3E%20Yes%2C%20this%20is%20a%20much%20better%20solution%21%20Is%20the%20%2Fvar%2Frun%2Ffail2ban%2F%0A%3E%20directory%20exported%20as%20a%20variable%20so%20it%20can%20be%20used%20in%20action%20rules%0A%3E%20without%20hardcoding%20the%20path%3F%0A%3E%20%0A%3E%20%3E%20agreed%3F%0A%3E%20Yeah%2C%20sorry%20for%20posting%20a%20complete%20untested%20patch%20%3B%28%0A%3E%20%0A%3E%20%0A%3E%20%0A&amp;References=%3C20101031211110.GH6756%40in.waw.pl%3E%20%3C20101101003023.GF12312%40onerussian.com%3E%0A%20%3C20101101080316.GI6756%40in.waw.pl%3E&amp;subject=Re%3A%20Bug%23544232%3A%20tentative%20%5BPATCH%5D%20issue5178%3A%20use%20a%20temporary%0A%09directory%20or%20file%20created%20with%20mktemp">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=zbyszek%40in.waw.pl" alt="">
<div class="header"><span class="headerfield">From:</span> Zbyszek Szmek &lt;zbyszek@in.waw.pl&gt;</div>
<div class="header"><span class="headerfield">To:</span> Yaroslav Halchenko &lt;debian@onerussian.com&gt;</div>
<div class="header"><span class="headerfield">Cc:</span> 544232@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#544232: tentative [PATCH] issue5178: use a temporary
	directory or file created with mktemp</div>
<div class="header"><span class="headerfield">Date:</span> Mon, 1 Nov 2010 09:03:16 +0100</div>
</div>
<pre class="message">On Sun, Oct 31, 2010 at 08:30:23PM -0400, Yaroslav Halchenko wrote:
Hi Yaroslav,

&gt; Hi Zbyszek,
&gt; 
&gt; thanks for looking into it ...
Thanks for the quick reply :)

&gt; action.d/mynetwatchman.conf  changes -- should be ok
This parts is still valid...

&gt; action.d/mail-buffered.conf -- I don&#39;t think it would work...
...but the other three won&#39;t work indeed. (I had some strange
notion that the mktemp would get executed tmpdir variable initialization,
but it just gets substituted into the final command like you said.

&gt; 
&gt; &gt; +tmpdir = `mktemp --directory --suffix=-f2ban-dshield`
&gt; &gt; +tmpfile = &lt;tmpdir&gt;/dshield
&gt; 
&gt; since this is just a Python config file, it would simply substitute
&gt; `mktemp --directory --suffix=-f2ban-dshield`/dshield
&gt; for every occurrence of &lt;tmpfile&gt; which would be not what is desired...
&gt; am I correct?
&gt; 
&gt; 
&gt; as a generic and simple resolution, I think, tmpfiles should simply be
&gt; created under /var/run/fail2ban which belongs to root.  I think there
&gt; was some discussion in some other bugreport... or it is deja vu
Yes, this is a much better solution! Is the /var/run/fail2ban/
directory exported as a variable so it can be used in action rules
without hardcoding the path?

&gt; agreed?
Yeah, sorry for posting a complete untested patch ;(



</pre>

<div class="msgreceived"><hr><p>
<a name="34"></a>
<!-- request_addr: Yaroslav Halchenko &lt;debian@onerussian.com&gt; -->
<!-- time:1300949825 -->
<strong>Reply sent</strong>
to <code>Yaroslav Halchenko &lt;debian@onerussian.com&gt;</code>:<br>
You have taken responsibility.
 (Thu, 24 Mar 2011 06:57:05 GMT) (<a href="bugreport.cgi?bug=544232;msg=35">full text</a>, <a href="bugreport.cgi?bug=544232;mbox=yes;msg=35">mbox</a>, <a href="#34">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="36"></a>
<!-- request_addr: Tomasz Papszun &lt;tomek@lodz.tpsa.pl&gt; -->
<!-- time:1300949826 -->
<strong>Notification sent</strong>
to <code>Tomasz Papszun &lt;tomek@lodz.tpsa.pl&gt;</code>:<br>
Bug acknowledged by developer.
 (Thu, 24 Mar 2011 06:57:06 GMT) (<a href="bugreport.cgi?bug=544232;msg=37">full text</a>, <a href="bugreport.cgi?bug=544232;mbox=yes;msg=37">mbox</a>, <a href="#36">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="38"></a><a name="msg38"></a><a href="#38">Message #38</a> received at 544232-close@bugs.debian.org (<a href="bugreport.cgi?bug=544232;msg=38">full text</a>, <a href="bugreport.cgi?bug=544232;mbox=yes;msg=38">mbox</a>, <a href="mailto:544232@bugs.debian.org?References=%3CE1Q2eSY-0002Ti-IW%40franck.debian.org%3E&amp;subject=Re%3A%20Bug%23544232%3A%20fixed%20in%20fail2ban%200.8.4%2Bsvn20110323-1&amp;body=On%20Thu%2C%2024%20Mar%202011%2006%3A55%3A54%20%2B0000%20Yaroslav%20Halchenko%20%3Cdebian%40onerussian.com%3E%20wrote%3A%0A%3E%20Source%3A%20fail2ban%0A%3E%20Source-Version%3A%200.8.4%2Bsvn20110323-1%0A%3E%20%0A%3E%20We%20believe%20that%20the%20bug%20you%20reported%20is%20fixed%20in%20the%20latest%20version%20of%0A%3E%20fail2ban%2C%20which%20is%20due%20to%20be%20installed%20in%20the%20Debian%20FTP%20archive%3A%0A%3E%20%0A%3E%20fail2ban_0.8.4%2Bsvn20110323-1.diff.gz%0A%3E%20%20%20to%20main%2Ff%2Ffail2ban%2Ffail2ban_0.8.4%2Bsvn20110323-1.diff.gz%0A%3E%20fail2ban_0.8.4%2Bsvn20110323-1.dsc%0A%3E%20%20%20to%20main%2Ff%2Ffail2ban%2Ffail2ban_0.8.4%2Bsvn20110323-1.dsc%0A%3E%20fail2ban_0.8.4%2Bsvn20110323-1_all.deb%0A%3E%20%20%20to%20main%2Ff%2Ffail2ban%2Ffail2ban_0.8.4%2Bsvn20110323-1_all.deb%0A%3E%20fail2ban_0.8.4%2Bsvn20110323.orig.tar.gz%0A%3E%20%20%20to%20main%2Ff%2Ffail2ban%2Ffail2ban_0.8.4%2Bsvn20110323.orig.tar.gz%0A%3E%20%0A%3E%20%0A%3E%20%0A%3E%20A%20summary%20of%20the%20changes%20between%20this%20version%20and%20the%20previous%20one%20is%0A%3E%20attached.%0A%3E%20%0A%3E%20Thank%20you%20for%20reporting%20the%20bug%2C%20which%20will%20now%20be%20closed.%20%20If%20you%0A%3E%20have%20further%20comments%20please%20address%20them%20to%20544232%40bugs.debian.org%2C%0A%3E%20and%20the%20maintainer%20will%20reopen%20the%20bug%20report%20if%20appropriate.%0A%3E%20%0A%3E%20Debian%20distribution%20maintenance%20software%0A%3E%20pp.%0A%3E%20Yaroslav%20Halchenko%20%3Cdebian%40onerussian.com%3E%20%28supplier%20of%20updated%20fail2ban%20package%29%0A%3E%20%0A%3E%20%28This%20message%20was%20generated%20automatically%20at%20their%20request%3B%20if%20you%0A%3E%20believe%20that%20there%20is%20a%20problem%20with%20it%20please%20contact%20the%20archive%0A%3E%20administrators%20by%20mailing%20ftpmaster%40debian.org%29%0A%3E%20%0A%3E%20%0A%3E%20-----BEGIN%20PGP%20SIGNED%20MESSAGE-----%0A%3E%20Hash%3A%20SHA1%0A%3E%20%0A%3E%20Format%3A%201.8%0A%3E%20Date%3A%20Wed%2C%2023%20Mar%202011%2017%3A04%3A56%20-0400%0A%3E%20Source%3A%20fail2ban%0A%3E%20Binary%3A%20fail2ban%0A%3E%20Architecture%3A%20source%20all%0A%3E%20Version%3A%200.8.4%2Bsvn20110323-1%0A%3E%20Distribution%3A%20unstable%0A%3E%20Urgency%3A%20low%0A%3E%20Maintainer%3A%20Yaroslav%20Halchenko%20%3Cdebian%40onerussian.com%3E%0A%3E%20Changed-By%3A%20Yaroslav%20Halchenko%20%3Cdebian%40onerussian.com%3E%0A%3E%20Description%3A%20%0A%3E%20%20fail2ban%20%20%20-%20ban%20hosts%20that%20cause%20multiple%20authentication%20errors%0A%3E%20Closes%3A%20515599%20544232%20546913%20573314%20574182%20588176%20598200%20598206%20615952%0A%3E%20Changes%3A%20%0A%3E%20%20fail2ban%20%280.8.4%2Bsvn20110323-1%29%20unstable%3B%20urgency%3Dlow%0A%3E%20%20.%0A%3E%20%20%20%20%2A%20Fresh%20upstream%20snapshot%20which%20absorbed%20some%20of%20the%20patches%20from%20Debian%0A%3E%20%20%20%20%20%20and%0A%3E%20%20%20%20%20%20-%20%5Bc6d64e9%5D%20debug%20entry%20for%20lines%20ignored%20due%20to%20falling%20below%0A%3E%20%20%20%20%20%20%20%20findtime%20%28v2%29%0A%3E%20%20%20%20%20%20-%20%5Bfc20f12%5D%20Tai64N%20stores%20time%20in%20GMT%2C%20we%20need%20to%20convert%20to%0A%3E%20%20%20%20%20%20%20%20local%20time%20before%20returning%0A%3E%20%20%20%20%20%20-%20%5Bb0331bb%5D%20default%20ignoreip%20to%20ignore%20entire%20loopback%20zone%20%28%2F8%29%0A%3E%20%20%20%20%20%20%20%20%28Closes%3A%20%23598200%29%0A&amp;In-Reply-To=%3CE1Q2eSY-0002Ti-IW%40franck.debian.org%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=debian%40onerussian.com" alt="">
<div class="header"><span class="headerfield">From:</span> Yaroslav Halchenko &lt;debian@onerussian.com&gt;</div>
<div class="header"><span class="headerfield">To:</span> 544232-close@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Bug#544232: fixed in fail2ban 0.8.4+svn20110323-1</div>
<div class="header"><span class="headerfield">Date:</span> Thu, 24 Mar 2011 06:55:54 +0000</div>
</div>
<pre class="message">Source: fail2ban
Source-Version: 0.8.4+svn20110323-1

We believe that the bug you reported is fixed in the latest version of
fail2ban, which is due to be installed in the Debian FTP archive:

fail2ban_0.8.4+svn20110323-1.diff.gz
  to main/f/fail2ban/fail2ban_0.8.4+svn20110323-1.diff.gz
fail2ban_0.8.4+svn20110323-1.dsc
  to main/f/fail2ban/fail2ban_0.8.4+svn20110323-1.dsc
fail2ban_0.8.4+svn20110323-1_all.deb
  to main/f/fail2ban/fail2ban_0.8.4+svn20110323-1_all.deb
fail2ban_0.8.4+svn20110323.orig.tar.gz
  to main/f/fail2ban/fail2ban_0.8.4+svn20110323.orig.tar.gz



A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 544232@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Yaroslav Halchenko &lt;debian@onerussian.com&gt; (supplier of updated fail2ban package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.8
Date: Wed, 23 Mar 2011 17:04:56 -0400
Source: fail2ban
Binary: fail2ban
Architecture: source all
Version: 0.8.4+svn20110323-1
Distribution: unstable
Urgency: low
Maintainer: Yaroslav Halchenko &lt;debian@onerussian.com&gt;
Changed-By: Yaroslav Halchenko &lt;debian@onerussian.com&gt;
Description: 
 fail2ban   - ban hosts that cause multiple authentication errors
Closes: <a href="bugreport.cgi?bug=515599">515599</a> <a href="bugreport.cgi?bug=544232">544232</a> <a href="bugreport.cgi?bug=546913">546913</a> <a href="bugreport.cgi?bug=573314">573314</a> <a href="bugreport.cgi?bug=574182">574182</a> <a href="bugreport.cgi?bug=588176">588176</a> <a href="bugreport.cgi?bug=598200">598200</a> <a href="bugreport.cgi?bug=598206">598206</a> <a href="bugreport.cgi?bug=615952">615952</a>
Changes: 
 fail2ban (0.8.4+svn20110323-1) unstable; urgency=low
 .
   * Fresh upstream snapshot which absorbed some of the patches from Debian
     and
     - [c6d64e9] debug entry for lines ignored due to falling below
       findtime (v2)
     - [fc20f12] Tai64N stores time in GMT, we need to convert to
       local time before returning
     - [b0331bb] default ignoreip to ignore entire loopback zone (/8)
       (Closes: #<a href="bugreport.cgi?bug=598200">598200</a>)
     - [b9f15f6] ENH: dovecot filter
     - [69165b1] ENH: add &lt;chain&gt; to action.d/iptables*. Thanks
       Matthijs Kooijman
     - [8330a20] ENH: make filter.d/apache-overflows.conf catch more
       (Closes: #<a href="bugreport.cgi?bug=574182">574182</a>)
     - [66cc6cb] BF: allow space in the trailing of failregex for sasl.conf
       (Closes: #<a href="bugreport.cgi?bug=573314">573314</a>)
     - [2714019] ENH: dropbear filter (Closes: #<a href="bugreport.cgi?bug=546913">546913</a>)
     - [ea7d352] BF: Use /var/run/fail2ban instead of /tmp for temp files in
       actions (Closes: #<a href="bugreport.cgi?bug=544232">544232</a>)
   * debian/jail.conf:
     - [bc8e22d] spellcheck (Closes: #<a href="bugreport.cgi?bug=598206">598206</a>). Thanks Christoph Anton Mitterer
     - [d7f3e23] adjusted description for sasl jail (Closes: #<a href="bugreport.cgi?bug=615952">615952</a>)
     - [92fb484] debian/jail.conf: closing &quot; for protocol specification
     - [f828c31] debian/jail.conf: got &#39;chain&#39; parameter to be specified for
       iptables actions (Closes: #<a href="bugreport.cgi?bug=515599">515599</a>)
   * debian/control:
     - [858af30] slight rewordings of the long description (Closes: #<a href="bugreport.cgi?bug=588176">588176</a>)
     - [167dfd4] Boosted policy compliance version to 3.9.1 (no changes seems
       to be due)
   * [4e1e845] debian/copyright: updated copyright years
Checksums-Sha1: 
 c816a57d19f9adbbf71eb2525a4068a88dac01db 1295 fail2ban_0.8.4+svn20110323-1.dsc
 b8d5e30c49f91c9326b58d56f03e90675b95c381 84726 fail2ban_0.8.4+svn20110323.orig.tar.gz
 fd8e842182240957e8bf2d9e03fc9963be013d90 30101 fail2ban_0.8.4+svn20110323-1.diff.gz
 9a84cd18747b5b471a64e13dba90495dfb9c3f31 97716 fail2ban_0.8.4+svn20110323-1_all.deb
Checksums-Sha256: 
 d39fceaadb80445b00606c596b5a074a7a67b3e0ee7ae186a5f972293825a974 1295 fail2ban_0.8.4+svn20110323-1.dsc
 1aa7eec3e60043098664c3fd16139b4e5bd5faeb0117ba0c189f0ede48b1cad7 84726 fail2ban_0.8.4+svn20110323.orig.tar.gz
 6b637ba6a423d6cb777186cc2188c8676cd493cb4d4f391a509212e3c516f047 30101 fail2ban_0.8.4+svn20110323-1.diff.gz
 6b03d9c1a505e43df4fdec8662ebce0c9b7fbae65c8806ab300f369d7dcfeb6e 97716 fail2ban_0.8.4+svn20110323-1_all.deb
Files: 
 4bc9e43afb40c7e6140448331c1ff92a 1295 net optional fail2ban_0.8.4+svn20110323-1.dsc
 1d0a94394d2bb5c616212839f3552b06 84726 net optional fail2ban_0.8.4+svn20110323.orig.tar.gz
 10ec0cd9c25815782398507053a104bd 30101 net optional fail2ban_0.8.4+svn20110323-1.diff.gz
 4119833765fa7de7ed57c7f055646b6b 97716 net optional fail2ban_0.8.4+svn20110323-1_all.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.10 (GNU/Linux)

iEYEARECAAYFAk2KbLwACgkQjRFFY3XAJMhTEQCgoWfJbSIx2te2zcp+yGmUB1CA
bhAAoJORjFxwyF6FR1d6pp8n2+h1YlxV
=Er13
-----END PGP SIGNATURE-----




</pre>

<div class="msgreceived"><hr><p>
<a name="39"></a>
<!-- command:tag -->
<!-- requester: Salvatore Bonaccorso &lt;carnil@debian.org&gt; -->
<!-- request_addr: control@bugs.debian.org -->
<!-- time:1303237984 -->
<!-- new_data:
$new_data = {
              &#39;keywords&#39; =&gt; &#39;security&#39;
            };
-->
<!-- old_data:
$old_data = {
              &#39;keywords&#39; =&gt; &#39;&#39;
            };
-->
<strong>Added tag(s) security.</strong>
Request was from <code>Salvatore Bonaccorso &lt;carnil@debian.org&gt;</code>
to <code>control@bugs.debian.org</code>.
 (Tue, 19 Apr 2011 18:33:04 GMT) (<a href="bugreport.cgi?bug=544232;msg=40">full text</a>, <a href="bugreport.cgi?bug=544232;mbox=yes;msg=40">mbox</a>, <a href="#39">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="41"></a>
<!-- command:archive -->
<!-- requester: Debbugs Internal Request &lt;owner@bugs.debian.org&gt; -->
<!-- request_addr: internal_control@bugs.debian.org -->
<!-- time:1305704174 -->
<!-- new_data:
$new_data = {};
-->
<!-- old_data:
$old_data = {};
-->
<strong>Bug archived.</strong>
Request was from <code>Debbugs Internal Request &lt;owner@bugs.debian.org&gt;</code>
to <code>internal_control@bugs.debian.org</code>.
 (Wed, 18 May 2011 07:36:14 GMT) (<a href="bugreport.cgi?bug=544232;msg=42">full text</a>, <a href="bugreport.cgi?bug=544232;mbox=yes;msg=42">mbox</a>, <a href="#41">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="43"></a>
<!-- command:unarchive -->
<!-- requester: Jonathan Wiltshire &lt;jmw@debian.org&gt; -->
<!-- request_addr: control@bugs.debian.org -->
<!-- time:1309811763 -->
<!-- new_data:
$new_data = {
              &#39;unarchived&#39; =&gt; 1309811763
            };
-->
<!-- old_data:
$old_data = {
              &#39;unarchived&#39; =&gt; &#39;&#39;
            };
-->
<strong>Bug unarchived.</strong>
Request was from <code>Jonathan Wiltshire &lt;jmw@debian.org&gt;</code>
to <code>control@bugs.debian.org</code>.
 (Mon, 04 Jul 2011 20:36:03 GMT) (<a href="bugreport.cgi?bug=544232;msg=44">full text</a>, <a href="bugreport.cgi?bug=544232;mbox=yes;msg=44">mbox</a>, <a href="#43">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="45"></a>
<!-- command:found -->
<!-- requester: Jonathan Wiltshire &lt;jmw@debian.org&gt; -->
<!-- request_addr: control@bugs.debian.org -->
<!-- time:1309811765 -->
<!-- new_data:
$new_data = {
              &#39;found_versions&#39; =&gt; [
                                    &#39;fail2ban/0.8.4-3&#39;,
                                    &#39;fail2ban/0.8.3-2sid1&#39;
                                  ]
            };
-->
<!-- old_data:
$old_data = {
              &#39;found_versions&#39; =&gt; [
                                    &#39;fail2ban/0.8.3-2sid1&#39;
                                  ]
            };
-->
<strong>Bug Marked as found in versions fail2ban/0.8.4-3.</strong>
Request was from <code>Jonathan Wiltshire &lt;jmw@debian.org&gt;</code>
to <code>control@bugs.debian.org</code>.
 (Mon, 04 Jul 2011 20:36:05 GMT) (<a href="bugreport.cgi?bug=544232;msg=46">full text</a>, <a href="bugreport.cgi?bug=544232;mbox=yes;msg=46">mbox</a>, <a href="#45">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="47"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Yaroslav Halchenko &lt;debian@onerussian.com&gt; -->
<!-- time:1309811943 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Yaroslav Halchenko &lt;debian@onerussian.com&gt;</code>:<br>
<code>Bug#544232</code>; Package <code>fail2ban</code>.
 (Mon, 04 Jul 2011 20:39:03 GMT) (<a href="bugreport.cgi?bug=544232;msg=48">full text</a>, <a href="bugreport.cgi?bug=544232;mbox=yes;msg=48">mbox</a>, <a href="#47">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="49"></a>
<!-- request_addr: Jonathan Wiltshire &lt;jmw@debian.org&gt; -->
<!-- time:1309811943 -->
<strong>Acknowledgement sent</strong>
to <code>Jonathan Wiltshire &lt;jmw@debian.org&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Yaroslav Halchenko &lt;debian@onerussian.com&gt;</code>.
 (Mon, 04 Jul 2011 20:39:03 GMT) (<a href="bugreport.cgi?bug=544232;msg=50">full text</a>, <a href="bugreport.cgi?bug=544232;mbox=yes;msg=50">mbox</a>, <a href="#49">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="51"></a><a name="msg51"></a><a href="#51">Message #51</a> received at 544232@bugs.debian.org (<a href="bugreport.cgi?bug=544232;msg=51">full text</a>, <a href="bugreport.cgi?bug=544232;mbox=yes;msg=51">mbox</a>, <a href="mailto:544232@bugs.debian.org?References=%3C20090829210750.22121.11561.reportbug%40kiezmar.lodz.tpsa.pl%3E%0A%20%3C20090829225008.GQ24090%40onerussian.com%3E%0A%20%3C20110704203738.GA14478%40lupin.home.powdarrmonkey.net%3E&amp;subject=Re%3A%20%28PRSC%29%20Bug%23544232%3A%20fail2ban%3A%20Insecure%20creating%2Fwriting%20to%20tmpfile&amp;body=On%20Mon%2C%204%20Jul%202011%2021%3A37%3A38%20%2B0100%20Jonathan%20Wiltshire%20%3Cjmw%40debian.org%3E%20wrote%3A%0A%3E%20Dear%20maintainer%2C%0A%3E%20%0A%3E%20Recently%20you%20fixed%20one%20or%20more%20security%20problems%20and%20as%20a%20result%20you%20closed%0A%3E%20this%20bug.%20These%20problems%20were%20not%20serious%20enough%20for%20a%20Debian%20Security%0A%3E%20Advisory%2C%20so%20they%20are%20now%20on%20my%20radar%20for%20fixing%20in%20the%20following%20suites%0A%3E%20through%20point%20releases%3A%0A%3E%20%0A%3E%20lenny%20%285.0.9%29%0A%3E%20squeeze%20%286.0.2%29%0A%3E%20%0A%3E%20Please%20prepare%20a%20minimal-changes%20upload%20targetting%20each%20of%20these%20suites%2C%0A%3E%20and%20submit%20a%20debdiff%20to%20the%20Release%20Team%20%5B0%5D%20for%20consideration.%20They%20will%0A%3E%20offer%20additional%20guidance%20or%20instruct%20you%20to%20upload%20your%20package.%0A%3E%20%0A%3E%20I%20will%20happily%20assist%20you%20at%20any%20stage%20if%20the%20patch%20is%20straightforward%20and%0A%3E%20you%20need%20help%20or%20lack%20time.%20Please%20keep%20me%20in%20CC%20at%20all%20times%20so%20I%20can%0A%3E%20track%20the%20progress%20of%20this%20request.%0A%3E%20%0A%3E%20For%20details%20of%20this%20process%20and%20the%20rationale%2C%20please%20see%20the%20original%0A%3E%20announcement%20%5B1%5D%20and%20my%20blog%20post%20%5B2%5D.%0A%3E%20%0A%3E%200%3A%20debian-release%40lists.debian.org%0A%3E%201%3A%20%3C201101232332.11736.thijs%40debian.org%3E%0A%3E%202%3A%20http%3A%2F%2Fdeb.li%2Fprsc%0A%3E%20%0A%3E%20Thanks%2C%0A%3E%20%0A%3E%20with%20his%20security%20hat%20on%3A%0A%3E%20--%20%0A%3E%20Jonathan%20Wiltshire%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20jmw%40debian.org%0A%3E%20Debian%20Developer%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20http%3A%2F%2Fpeople.debian.org%2F~jmw%0A%3E%20%0A%3E%204096R%3A%200xD3524C51%20%2F%200A55%20B7C5%201223%203942%2086EC%20%2074C3%205394%20479D%20D352%204C51%0A&amp;In-Reply-To=%3C20110704203738.GA14478%40lupin.home.powdarrmonkey.net%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=jmw%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Jonathan Wiltshire &lt;jmw@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> Yaroslav Halchenko &lt;debian@onerussian.com&gt;, 544232@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> (PRSC) Bug#544232: fail2ban: Insecure creating/writing to tmpfile</div>
<div class="header"><span class="headerfield">Date:</span> Mon, 4 Jul 2011 21:37:38 +0100</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=0;bug=544232;msg=51">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message">Dear maintainer,

Recently you fixed one or more security problems and as a result you closed
this bug. These problems were not serious enough for a Debian Security
Advisory, so they are now on my radar for fixing in the following suites
through point releases:

lenny (5.0.9)
squeeze (6.0.2)

Please prepare a minimal-changes upload targetting each of these suites,
and submit a debdiff to the Release Team [0] for consideration. They will
offer additional guidance or instruct you to upload your package.

I will happily assist you at any stage if the patch is straightforward and
you need help or lack time. Please keep me in CC at all times so I can
track the progress of this request.

For details of this process and the rationale, please see the original
announcement [1] and my blog post [2].

0: debian-release@lists.debian.org
1: &lt;201101232332.11736.thijs@debian.org&gt;
2: <a href="http://deb.li/prsc">http://deb.li/prsc</a>

Thanks,

with his security hat on:
-- 
Jonathan Wiltshire                                      jmw@debian.org
Debian Developer                         <a href="http://people.debian.org/~jmw">http://people.debian.org/~jmw</a>

4096R: 0xD3524C51 / 0A55 B7C5 1223 3942 86EC  74C3 5394 479D D352 4C51
</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=544232;filename=signature.asc;msg=51">signature.asc</a> (application/pgp-signature, inline)]</pre>

<div class="msgreceived"><hr><p>
<a name="52"></a>
<!-- command:archive -->
<!-- requester: Debbugs Internal Request &lt;owner@bugs.debian.org&gt; -->
<!-- request_addr: internal_control@bugs.debian.org -->
<!-- time:1312270377 -->
<!-- new_data:
$new_data = {};
-->
<!-- old_data:
$old_data = {};
-->
<strong>Bug archived.</strong>
Request was from <code>Debbugs Internal Request &lt;owner@bugs.debian.org&gt;</code>
to <code>internal_control@bugs.debian.org</code>.
 (Tue, 02 Aug 2011 07:32:57 GMT) (<a href="bugreport.cgi?bug=544232;msg=53">full text</a>, <a href="bugreport.cgi?bug=544232;mbox=yes;msg=53">mbox</a>, <a href="#52">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="54"></a>
<!-- command:unarchive -->
<!-- requester: Jonathan Wiltshire &lt;jmw@debian.org&gt; -->
<!-- request_addr: control@bugs.debian.org -->
<!-- time:1314003062 -->
<!-- new_data:
$new_data = {
              &#39;unarchived&#39; =&gt; 1314003062
            };
-->
<!-- old_data:
$old_data = {
              &#39;unarchived&#39; =&gt; &#39;1309811763&#39;
            };
-->
<strong>Bug unarchived.</strong>
Request was from <code>Jonathan Wiltshire &lt;jmw@debian.org&gt;</code>
to <code>control@bugs.debian.org</code>.
 (Mon, 22 Aug 2011 08:51:02 GMT) (<a href="bugreport.cgi?bug=544232;msg=55">full text</a>, <a href="bugreport.cgi?bug=544232;mbox=yes;msg=55">mbox</a>, <a href="#54">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="56"></a>
<!-- command:tag -->
<!-- requester: Jonathan Wiltshire &lt;jmw@debian.org&gt; -->
<!-- request_addr: control@bugs.debian.org -->
<!-- time:1314003063 -->
<!-- new_data:
$new_data = {
              &#39;keywords&#39; =&gt; &#39;squeeze security lenny&#39;
            };
-->
<!-- old_data:
$old_data = {
              &#39;keywords&#39; =&gt; &#39;security&#39;
            };
-->
<strong>Added tag(s) squeeze and lenny.</strong>
Request was from <code>Jonathan Wiltshire &lt;jmw@debian.org&gt;</code>
to <code>control@bugs.debian.org</code>.
 (Mon, 22 Aug 2011 08:51:03 GMT) (<a href="bugreport.cgi?bug=544232;msg=57">full text</a>, <a href="bugreport.cgi?bug=544232;mbox=yes;msg=57">mbox</a>, <a href="#56">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="58"></a>
<!-- command:archive -->
<!-- requester: Debbugs Internal Request &lt;owner@bugs.debian.org&gt; -->
<!-- request_addr: internal_control@bugs.debian.org -->
<!-- time:1316504450 -->
<!-- new_data:
$new_data = {};
-->
<!-- old_data:
$old_data = {};
-->
<strong>Bug archived.</strong>
Request was from <code>Debbugs Internal Request &lt;owner@bugs.debian.org&gt;</code>
to <code>internal_control@bugs.debian.org</code>.
 (Tue, 20 Sep 2011 07:40:50 GMT) (<a href="bugreport.cgi?bug=544232;msg=59">full text</a>, <a href="bugreport.cgi?bug=544232;mbox=yes;msg=59">mbox</a>, <a href="#58">link</a>).</p></p></div>

<hr>
<p class="msgreceived">Send a report that <a href="https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=544232">this bug log contains spam</a>.</p>
<hr>
<ADDRESS>Debian bug tracking system administrator &lt;<A HREF="mailto:owner@bugs.debian.org">owner@bugs.debian.org</A>&gt;.
Last modified:
<!--timestamp-->Sat Oct 30 18:23:37 2021<!--end timestamp-->; 
Machine Name:
<!--machinename-->bembo<!--machinename-->
<P>
<A HREF="https://www.debian.org/Bugs/">Debian Bug tracking system</A>
</p>
<p>
  Debbugs is free software and licensed under the terms of the GNU
  Public License version 2. The current version can be obtained
  from <a href="https://bugs.debian.org/debbugs-source/">https://bugs.debian.org/debbugs-source/</a>.
</p>
<p>
Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.
</p>
</ADDRESS>

</body>
</html>
