<!doctype html><html lang=en-us><head><title>Much ado about Juniper - Adam Caudill</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Adam Caudill: Security Engineer, Researcher, & Developer"><meta name=author content="Adam Caudill"><meta property="og:title" content="Much ado about Juniper"><meta property="og:description" content="Since this was published, more detailed information has become available: analysis of the SSH backdoor, the VPN backdoor, and the cryptography of the VPN backdoor. If you want a more detailed understanding of what was done, please take a moment to read these pages.
The news is tearing through the information security community – Juniper seems to be on the lips of everyone now, let&rsquo;s take a quick look at the information available:"><meta property="og:type" content="article"><meta property="og:url" content="https://adamcaudill.com/2015/12/17/much-ado-about-juniper/"><meta property="og:image" content="https://adamcaudill.com/files/nsa-ant-feedthrough.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2015-12-18T01:12:21+00:00"><meta property="article:modified_time" content="2021-10-22T23:31:04-04:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://adamcaudill.com/files/nsa-ant-feedthrough.jpg"><meta name=twitter:title content="Much ado about Juniper"><meta name=twitter:description content="Since this was published, more detailed information has become available: analysis of the SSH backdoor, the VPN backdoor, and the cryptography of the VPN backdoor. If you want a more detailed understanding of what was done, please take a moment to read these pages.
The news is tearing through the information security community – Juniper seems to be on the lips of everyone now, let&rsquo;s take a quick look at the information available:"><meta name=twitter:site content="@adamcaudill"><meta name=twitter:creator content="@adamcaudill"><meta name=gitLastUpdated content="2021-10-22 23:31:04 -0400 -0400"><meta name=gitRevision content="5af35878cf0769a3377e309d3bcda097720af7eb"><link rel=preconnect href=https://fonts.gstatic.com/><link rel=stylesheet type=text/css href=https://adamcaudill.com/css/bundle.min.fe6d11c0d67a12f344f8e52d0f810cfcd29d51f5f0ce78618772e5c5238f1540.css><link rel=apple-touch-icon sizes=180x180 href=https://adamcaudill.com/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://adamcaudill.com/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://adamcaudill.com/favicon-16x16.png></head><body><div id=container><header><h1><a href=https://adamcaudill.com/>Adam Caudill</a></h1><ul id=social-media><li><a href=https://adamcaudill.com/rss/ title="RSS Feed"><i class="fas fa-rss-square fa-lg"></i></a></li><li><a href=https://github.com/adamcaudill title=GitHub><i class="fab fa-github fa-lg"></i></a></li><li><a href=https://twitter.com/adamcaudill title=Twitter><i class="fab fa-twitter fa-lg"></i></a></li><li><a href=https://linkedin.com/in/adamcaudill title=LinkedIn><i class="fab fa-linkedin fa-lg"></i></a></li><li><a href=https://500px.com/adamcaudill title=500px><i class="fab fa-500px fa-lg"></i></a></li></ul><p><em>Security Engineer, Researcher, & Developer</em></p></header><nav><ul><li><a href=https://adamcaudill.com/><i class="fa-li fa fa-lg"></i><span>Home</span></a></li><li><a href=https://adamcaudill.com/blog/><i class="fa-li fa fa-lg"></i><span>Blog</span></a></li><li><a href=https://adamcaudill.com/research/><i class="fa-li fa fa-lg"></i><span>Research</span></a></li><li><a href=https://adamcaudill.com/speaking/><i class="fa-li fa fa-lg"></i><span>Speaking</span></a></li><li><a href=https://adamcaudill.com/photo/><i class="fa-li fa fa-lg"></i><span>Photography</span></a></li><li><a href=https://adamcaudill.com/writing/><i class="fa-li fa fa-lg"></i><span>Writing</span></a></li><li><a href=https://adamcaudill.com/about/><i class="fa-li fa fa-lg"></i><span>About</span></a></li></ul></nav><div class=main-row><div id=main class=main-column><main><article><h1>Much ado about Juniper</h1><aside><ul><p><time class=post-date datetime=2015-12-18T01:12:21Z>December 18, 2015</time>
|
4 minute read
|
<a href=https://adamcaudill.com/categories/news>News</a></p></ul></aside><div class=article-content><p><em>Since this was published, more detailed information has become available: analysis of the <a href=https://community.rapid7.com/community/infosec/blog/2015/12/20/cve-2015-7755-juniper-screenos-authentication-backdoor>SSH backdoor</a>, the <a href=https://rpw.sh/blog/2015/12/21/the-backdoored-backdoor/>VPN backdoor</a>, and the <a href=https://blog.cryptographyengineering.com/2015/12/on-juniper-backdoor.html>cryptography of the VPN backdoor</a>. If you want a more detailed understanding of what was done, please take a moment to read these pages.</em></p><p>The news is tearing through the information security community – Juniper seems to be on the lips of everyone now, let&rsquo;s take a quick look at the information available:</p><blockquote class=twitter-tweet lang=en><p lang=en dir=ltr>Woah! Juniper discovers a backdoor to decrypt VPN traffic (and remote admin) has been inserted into their OS source <a href=https://t.co/vAywOclxLt>https://t.co/vAywOclxLt</a></p><p>&mdash; the grugq (@thegrugq) <a href=https://twitter.com/thegrugq/status/677611480041127936>December 17, 2015</a></p></blockquote><p>This morning, Juniper Networks <a href=https://forums.juniper.net/t5/Security-Incident-Response/Important-Announcement-about-ScreenOS/ba-p/285554>announced</a> an out-of-cycle update for their ScreenOS firewall operating system (<a href=https://twitter.com/llorenzin/status/677663294132457472>not the newer Junos</a>) to patch two unrelated issues (both identified as <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-7755">CVE-2015-7755</a>):</p><ul><li>Unauthorized remote administrative access</li><li>VPN traffic decryption</li></ul><p>The meat of the announcement is this one paragraph:</p><blockquote><p>During a recent internal code review, Juniper <em>discovered unauthorized code</em> in ScreenOS that could allow a knowledgeable attacker to gain administrative access to NetScreen® devices and to decrypt VPN connections. Once we identified these vulnerabilities, we launched an investigation into the matter, and worked to develop and issue patched releases for the latest versions of ScreenOS.</p></blockquote><p>I added emphasis to the most important part: code that wasn&rsquo;t authorized was first released in September 2012, and only now discovered.</p><p>They provided very limited <a href="https://kb.juniper.net/InfoCenter/index?page=content&id=JSA10713&cat=SIRT_1&actp=LIST">technical information</a>; there is some detail on the unauthorized remote administrative access – the log, <em>if not altered</em>, will reveal that the backdoor has been used, as it will log that <code>system</code> connected over SSH instead of an actual user name.</p><p>This is the kind of log entry that you would expect in the case of a backdoor that was intentionally hidden – it could easily be looked over, it doesn&rsquo;t immediately stand out. When designing a backdoor, keeping it subtle is key.</p><p>The second issue, decryption of VPN traffic, has no useful information – other than an attacker needs the ability to monitor the encrypted VPN traffic. What this means is that it would only be useful to an attacker that was able to monitor networks – so it would be of most value to nation-state level attackers.</p><p>For both vulnerabilities, they state that a <em>knowledgeable attacker</em> could do this – to me, that smacks of NOBUS, or nobody but us, a key strategy for NSA and similar attackers. Attacks that require the knowledge of some secret that couldn&rsquo;t be easily learned, allowing them to take advantage of it, while keeping risks of others exploiting it as low as possible.</p><p>Some are speculating that this could be <a href=https://www.spiegel.de/international/world/catalog-reveals-nsa-has-back-doors-for-numerous-devices-a-940994.html>FEEDTHROUGH</a>:</p><blockquote><p>In the case of Juniper, the name of this particular digital lock pick is &ldquo;FEEDTROUGH.&rdquo; This malware burrows into Juniper firewalls and makes it possible to smuggle other NSA programs into mainframe computers. Thanks to FEEDTROUGH, these implants can, by design, even survive &ldquo;across reboots and software upgrades.&rdquo; In this way, US government spies can secure themselves a permanent presence in computer networks. The catalog states that FEEDTROUGH &ldquo;has been deployed on many target platforms.&rdquo;</p></blockquote><p><img loading=lazy src=https://adamcaudill.com/files/nsa-ant-feedthrough.jpg alt=nsa-ant-feedthrough width=800 height=1035 class="alignnone size-full wp-image-695" srcset="https://adamcaudill.com/files/nsa-ant-feedthrough.jpg 800w, https://adamcaudill.com/files/nsa-ant-feedthrough-232x300.jpg 232w, https://adamcaudill.com/files/nsa-ant-feedthrough-791x1024.jpg 791w" sizes="(max-width: 800px) 100vw, 800px"></p><p>Is this FEEDTHROUGH? Is this a backdoor to make it easier to install FEEDTHROUGH (<a href=https://arstechnica.com/tech-policy/2014/05/photos-of-an-nsa-upgrade-factory-show-cisco-router-getting-implant/>interdiction</a> can&rsquo;t be cheap)? It&rsquo;s hard to say – as is the case with many of the <a href=https://en.wikipedia.org/wiki/NSA_ANT_catalog>ANT</a> documents, there simply isn&rsquo;t enough details to tell if they are connected.</p><p>My hope when the story broke was that it was debugging code that was inserted into a production release, or something of that nature – at this point I&rsquo;m losing hope. It&rsquo;s exactly what an intentional backdoor would look like. We shouldn&rsquo;t speculate too much, but this doesn&rsquo;t look good.</p><p><em>While writing this, <a href=https://twitter.com/dangoodin001>Dan Goodin</a> published <a href=https://arstechnica.com/security/2015/12/unauthorized-code-in-juniper-firewalls-decrypts-encrypted-vpn-traffic/>his article</a> on this – go read it.</em></p><hr><p><em><strong>Update:</strong></em> <a href=https://twitter.com/hdmoore>HD Moore</a> posted a list of the <a href=https://gist.github.com/hdm/0fbaf7408a6c7e0566c5>modified strings</a>; a change caught my eye, and was <a href=https://twitter.com/chort0/status/677708218206957568>pointed out</a> soon after HD posted it. In the version where the backdoors were introduced, a constant was changed:</p><pre><code>-2c55e5e45edf713dc43475effe8813a60326a64d9ba3d2e39cb639b0f3b0ad10
+9585320EEAF81044F20D55030A035B11BECE81C785E6C933E4A8A131F6578107
</code></pre><p>This changed was <a href=https://gist.github.com/hdm/107614ea292e856faa81>reverted</a> in the fixed version, making it clear that this plays some role in the backdoor – as researched progressed, it was suggested that it was a custom <code>y</code> coordinate, or perhaps a public key.</p><p>At this point, it appears to be <a href=https://en.wikipedia.org/wiki/Dual_EC_DRBG>Dual EC DRBG</a>, which has a documented history of being vulnerable to backdooring – at this point, it seems that may be what happened here. The patch by Juniper didn&rsquo;t remove Dual EC DRBG, but revert the change to it. This makes a lot of sense, as this is a NOBUS backdoor – it requires knowledge of a secret to be able to exploit, which fits with the description that Juniper provided.</p><p>Research is still ongoing.</p></div><div class=signature><p>Adam Caudill</p></div><hr><h2>Related Posts</h2><small><ul><li><h3><a href=https://adamcaudill.com/2015/12/22/juniper-backdoors-and-code-reviews/ title="Juniper, Backdoors, and Code Reviews">Juniper, Backdoors, and Code Reviews</a></h3><p>Researchers are still working to understand the impact of the Juniper incident – the details of how the VPN traffic decryption backdoor are still not fully understood. That such devastating backdoors could make it in to such a security-critical product, and remain for years undetected has shocked many (and pushed many others deeper into their cynicism).
There are though, some questions that are far more important in the long run:</p></li><li><h3><a href=https://adamcaudill.com/2015/04/13/crypto-front-door-everyone-welcome/ title="Crypto Front Door: Everyone Welcome!">Crypto Front Door: Everyone Welcome!</a></h3><p>For decades, the US Government has fought — sometimes with itself — to prevent the use of secure cryptography. During the first crypto war, they allowed strong cryptography within the US, but other countries were limited to small keys — making brute force attacks practical. But what about those pesky US citizens? They didn’t really want them to have strong crypto either — enter key escrow.
What is key escrow? According to Wikipedia:</p></li><li><h3><a href=https://adamcaudill.com/2016/03/12/crypto-crisis-fear-over-freedom/ title="Crypto Crisis: Fear over Freedom">Crypto Crisis: Fear over Freedom</a></h3><p>Yesterday, President Obama spoke at SXSW on topics including the oft-discussed fight between Apple and the FBI – what he called for, while more thoughtful than some of the other comments that we have been hearing from Washington, was still tragically misinformed. He repeated the call for a compromise, and by compromise, he meant backdoors.
Here, I feel I must paraphrase one of my favorite authors to properly express the magnitude of what&rsquo;s being discussed here:</p></li><li><h3><a href=https://adamcaudill.com/2014/12/20/irrational-attribution-apt3-dot-14159/ title="Irrational Attribution: APT3.14159">Irrational Attribution: APT3.14159</a></h3><p>Note: This is satire / fiction; well, more or less – probably more more than less. Any resemblance to real companies, living or dead, is purely coincidental.
WASHINGTON, D.C — Unnamed White House officials that spoke on the condition of anonymity, have stated that a major American company has been hacked, and the attackers are threatening to release terabytes of proprietary information. The name of the company has not been released at this time.</p></li><li><h3><a href=https://adamcaudill.com/2013/09/07/crypto-the-nsa-and-broken-trust/ title="Crypto, the NSA, and Broken Trust">Crypto, the NSA, and Broken Trust</a></h3><p>Even as a child I was fascinated by cryptography – and often left the local librarians with puzzled looks thanks to the books I would check out. It&rsquo;s so elegantly simple, and yet massively complex. There is one very unusual property of crypto though – it&rsquo;s not about math or modes, it&rsquo;s about trust.
Cryptography, especially as used today, has the most wonderful dichotomy of trust; on one hand crypto, by its very nature, is used in situations lacking trust.</p></li></ul></small></article><section class=post-nav><ul><li><a href=https://adamcaudill.com/2015/12/16/the-manifesto/><i class="fa fa-chevron-circle-left"></i> The Manifesto</a></li><li><a href=https://adamcaudill.com/2015/12/18/dovestones-software-ad-self-password-reset-cve-2015-8267/>Dovestones Software AD Self Password Reset (CVE-2015-8267) <i class="fa fa-chevron-circle-right"></i></a></li></ul></section></main></div><div id=sidebar class=main-column><h4>About Me</h4><p><img id=portrait src="https://1.gravatar.com/avatar/49e14cf9f67c48aad082dec4f106f19a?size=500" loading=lazy></p><p>Director of Security at <a href=https://1password.com/>1Password</a>, researcher and software developer with more than 20 years of experience.</p><p>I primarily focus on application security, secure communications, and cryptography, though often research new areas if I get too bored. I write about my research and security in general, development and software design, and whatever hobby has my attention at the moment.</p><p><a href=https://adamcaudill.com/pgp/>Contact</a></p></div></div><footer><div class=footer-row><div class=footer-column><h5>Disclaimer</h5><p>Opinions expressed here are solely those of Adam Caudill, and do not represent the views of his employer, or any other person or entity.</p></div><div class=footer-column><h5>Contact & Media</h5><p>If you have any questions, please feel free to <a href=https://adamcaudill.com/pgp/>contact me</a>, I will try to respond as quickly as possible.</p></div><div class=footer-column><h5>Copyright</h5><p>Copyright &copy; 2003 – 2021 Adam Caudill. Fair use is respected; though please provide proper attribution.</p></div></div></footer></div><script src=https://adamcaudill.com/js/scripts.js></script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-106942-2','auto'),ga('send','pageview'))</script><script async src=https://www.google-analytics.com/analytics.js></script><script defer src='https://static.cloudflareinsights.com/beacon.min.js' data-cf-beacon='{"token": "b7c021ad68ff4c9bba9e8508a4c6017b"}'></script><script defer src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon='{"rayId":"6a62489dbcc81376","version":"2021.10.0","r":1,"token":"8567dd3b3f684008b874879a0b6aa1c6","si":100}'></script>
</body></html>