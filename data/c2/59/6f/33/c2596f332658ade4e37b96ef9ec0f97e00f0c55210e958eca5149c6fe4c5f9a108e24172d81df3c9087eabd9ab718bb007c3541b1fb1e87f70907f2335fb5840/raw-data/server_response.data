<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>HCSEC-2021-28 - Vault&#39;s Google Cloud Secrets Engine Policies With Globs May Provide Additional Privileges in Vault 1.8.0 Onwards - Security - HashiCorp Discuss</title>
    <meta name="description" content="Bulletin ID: HCSEC-2021-28 
Affected Products / Versions: Vault and Vault Enterprise since 1.8.0. 
Publication Date: October 7, 2021 
Summary 
The Google Cloud secrets engine in Vault or Vault Enterprise (“Vault”) 1.8.0 &amp;hellip;">
    <meta name="generator" content="Discourse 2.8.0.beta7 - https://github.com/discourse/discourse version 436edbb51a15c634e65c0d7cdccdb4ce9aecd8f1">
<link rel="icon" type="image/png" href="https://aws1.discourse-cdn.com/hashicorp/optimized/1X/768b0c508ad4facc44cabe5a30aff4d7f8afa863_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="https://aws1.discourse-cdn.com/hashicorp/optimized/1X/154331ed085112b536f7a0c4c5355c17a57e53c1_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="https://discuss.hashicorp.com/t/hcsec-2021-28-vaults-google-cloud-secrets-engine-policies-with-globs-may-provide-additional-privileges-in-vault-1-8-0-onwards/30422" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://discuss.hashicorp.com","potentialAction":{"@type":"SearchAction","target":"https://discuss.hashicorp.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="https://discuss.hashicorp.com/opensearch.xml" title="HashiCorp Discuss Search">

      <link href="https://sea2.discourse-cdn.com/hashicorp/stylesheets/desktop_3efd433df85c59aaefb5500dd3bf1fda39cbdf6b.css?__ws=discuss.hashicorp.com" media="all" rel="stylesheet" data-target="desktop"  />
      <link href="https://sea2.discourse-cdn.com/hashicorp/stylesheets/desktop_theme_19_b1232ab7e1a63dce3d47ad01483d60057495aa70.css?__ws=discuss.hashicorp.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="19" data-theme-name="discourse-hashicorp-theme"/>
    


<script src="https://sea2.discourse-cdn.com/hashicorp/theme-javascripts/d50ac3dedd3ea76578c300e5e62bc17c5b4f01d2.js?__ws=discuss.hashicorp.com"></script>
    <meta id="data-ga-universal-analytics" data-tracking-code="UA-36299135-17" data-json="{&quot;cookieDomain&quot;:&quot;auto&quot;}" data-auto-link-domains="">

  <link rel="preload" href="https://aws1.discourse-cdn.com/hashicorp/assets/google-universal-analytics-v3-706f1d28f0a97f67a47515c96189277240ec4940d968955042066d7873fd1fe8.gz.js" as="script">
<script src="https://aws1.discourse-cdn.com/hashicorp/assets/google-universal-analytics-v3-706f1d28f0a97f67a47515c96189277240ec4940d968955042066d7873fd1fe8.gz.js"></script>


        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;HCSEC-2021-28 - Vault&#39;s Google Cloud Secrets Engine Policies With Globs May Provide Additional Privileges in Vault 1.8.0 Onwards&#39;" href="https://discuss.hashicorp.com/t/hcsec-2021-28-vaults-google-cloud-secrets-engine-policies-with-globs-may-provide-additional-privileges-in-vault-1-8-0-onwards/30422.rss" />
    <meta property="og:site_name" content="HashiCorp Discuss" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://aws1.discourse-cdn.com/hashicorp/original/1X/154331ed085112b536f7a0c4c5355c17a57e53c1.png" />
<meta property="og:image" content="https://aws1.discourse-cdn.com/hashicorp/original/1X/154331ed085112b536f7a0c4c5355c17a57e53c1.png" />
<meta property="og:url" content="https://discuss.hashicorp.com/t/hcsec-2021-28-vaults-google-cloud-secrets-engine-policies-with-globs-may-provide-additional-privileges-in-vault-1-8-0-onwards/30422" />
<meta name="twitter:url" content="https://discuss.hashicorp.com/t/hcsec-2021-28-vaults-google-cloud-secrets-engine-policies-with-globs-may-provide-additional-privileges-in-vault-1-8-0-onwards/30422" />
<meta property="og:title" content="HCSEC-2021-28 - Vault&#39;s Google Cloud Secrets Engine Policies With Globs May Provide Additional Privileges in Vault 1.8.0 Onwards" />
<meta name="twitter:title" content="HCSEC-2021-28 - Vault&#39;s Google Cloud Secrets Engine Policies With Globs May Provide Additional Privileges in Vault 1.8.0 Onwards" />
<meta property="og:description" content="Bulletin ID: HCSEC-2021-28  Affected Products / Versions: Vault and Vault Enterprise since 1.8.0.  Publication Date: October 7, 2021  Summary  The Google Cloud secrets engine in Vault or Vault Enterprise (“Vault”) 1.8.0 and above may provide users, under specific conditions, with more privileges than in prior versions. Due to changes in the underlying functionality of the Google Cloud secrets engine, policies that use globs (*) may provide more privileges in Vault versions 1.8.0 onwards. This po..." />
<meta name="twitter:description" content="Bulletin ID: HCSEC-2021-28  Affected Products / Versions: Vault and Vault Enterprise since 1.8.0.  Publication Date: October 7, 2021  Summary  The Google Cloud secrets engine in Vault or Vault Enterprise (“Vault”) 1.8.0 and above may provide users, under specific conditions, with more privileges than in prior versions. Due to changes in the underlying functionality of the Google Cloud secrets engine, policies that use globs (*) may provide more privileges in Vault versions 1.8.0 onwards. This po..." />
<meta property="article:published_time" content="2021-10-07T20:55:59+00:00" />
<meta property="og:ignore_canonical" content="true" />


    
  </head>
  <body class="crawler">
    <!-- Replace icons -->






<script src="https://sea2.discourse-cdn.com/hashicorp/theme-javascripts/350479ec786d3192eb5f22fc034f23a6abba1c60.js?__ws=discuss.hashicorp.com"></script>
    <header>
      <a href="/">
          <img src="https://aws1.discourse-cdn.com/hashicorp/original/1X/668e19cbc79e3eaa176133c3679dc30aa57ba474.svg" alt="HashiCorp Discuss" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="/t/hcsec-2021-28-vaults-google-cloud-secrets-engine-policies-with-globs-may-provide-additional-privileges-in-vault-1-8-0-onwards/30422">HCSEC-2021-28 - Vault&#39;s Google Cloud Secrets Engine Policies With Globs May Provide Additional Privileges in Vault 1.8.0 Onwards</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://discuss.hashicorp.com/c/security/52" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #0088CC'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Security</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

      <div class="topic-category">
        <div class='discourse-tags list-tags'>
            <a href='https://discuss.hashicorp.com/tag/security-vault' class='discourse-tag' rel="tag">security-vault</a>
        </div>
      </div>
  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='HashiCorp'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://aws1.discourse-cdn.com/hashicorp/original/1X/668e19cbc79e3eaa176133c3679dc30aa57ba474.svg'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://discuss.hashicorp.com/u/jfinnigan'><span itemprop='name'>jfinnigan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="https://discuss.hashicorp.com/t/hcsec-2021-28-vaults-google-cloud-secrets-engine-policies-with-globs-may-provide-additional-privileges-in-vault-1-8-0-onwards/30422">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2021-10-07T20:55:59Z' class='post-time'>
                October 7, 2021,  8:55pm
              </time>
              <meta itemprop='dateModified' content='2021-10-15T17:14:51Z'>
          <span itemprop='position'>#1</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p><strong>Bulletin ID:</strong> HCSEC-2021-28<br>
<strong>Affected Products / Versions:</strong> Vault and Vault Enterprise since 1.8.0.<br>
<strong>Publication Date:</strong> October 7, 2021</p>
<p><strong>Summary</strong><br>
The Google Cloud secrets engine in Vault or Vault Enterprise (“Vault”) 1.8.0 and above may provide users, under specific conditions, with more privileges than in prior versions. Due to changes in the underlying functionality of the Google Cloud secrets engine, policies that use globs (<code>*</code>) may provide more privileges in Vault versions 1.8.0 onwards. This possible configuration weakness has been assigned CVE-2021-42135.</p>
<p><strong>Background</strong><br>
<a href="https://www.vaultproject.io/docs/secrets/gcp">Vault’s Google Cloud secrets engine</a> allows Vault to interact with Google Cloud and create scoped credentials or service accounts on the cloud platform. <a href="https://www.vaultproject.io/docs/concepts/policies#policy-syntax">Vault’s policy syntax</a> describes what actions a user can perform on a given path, and provides fine-grained access controls to help enforce the principle of least privilege to secrets stored in Vault.</p>
<p><strong>Details</strong><br>
An external party reported that, starting with Vault 1.8.0, it was possible for permissive policies that use a glob (<code>*</code>) to grant them further permissions. The introduction of roleset-specific endpoints (noted in the 1.8.0 <a href="https://github.com/hashicorp/vault/blob/main/CHANGELOG.md#180">changelog</a>) would allow a user with “read” permissions to the <code>/gcp/roleset/*</code> path to issue Google Cloud service account credentials.</p>
<p>If the Google Cloud secret engine policies do not contain a glob (<code>*</code>) or are otherwise sufficiently restrictive, the behavior remains unchanged.</p>
<p><strong>Remediation</strong><br>
Vault’s Google Cloud secrets engine documentation has been updated to provide additional guidance regarding <a href="https://www.vaultproject.io/docs/secrets/gcp#roleset-policy-considerations">roleset-related policy definition</a>.</p>
<p>Vault operators using the Google Cloud secrets engine, particularly running Vault 1.8.0 and above, should review their Vault policies to ensure they meet their requirements and adhere to the principle of least privilege. They should specifically look for policy with endpoints and glob usage as noted above and consider moving to a wildcard.</p>
<p><strong>Acknowledgement</strong><br>
This issue was identified by <a href="https://github.com/mdgreenfield">mdgreenfield</a> who reported it to HashiCorp.</p>
<p><em>We deeply appreciate any effort to coordinate disclosure of security vulnerabilities. For information about security at HashiCorp and the reporting of security vulnerabilities, please see <a href="https://hashicorp.com/security" class="inline-onebox">Security at HashiCorp</a>.</em></p>
        </div>

        <meta itemprop='headline' content='HCSEC-2021-28 - Vault&#39;s Google Cloud Secrets Engine Policies With Globs May Provide Additional Privileges in Vault 1.8.0 Onwards'>
          <meta itemprop='keywords' content='security-vault'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='/' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='/categories' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='/guidelines' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
    
  </body>
  
</html>
