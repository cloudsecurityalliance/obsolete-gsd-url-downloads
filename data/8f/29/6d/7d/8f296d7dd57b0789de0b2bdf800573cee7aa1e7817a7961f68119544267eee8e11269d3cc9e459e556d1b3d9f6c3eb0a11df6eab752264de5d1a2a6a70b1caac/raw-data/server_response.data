<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
  "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>
    
    
      
    
    
      Issue 2009453002: service worker: Don&#39;t control a subframe of an insecure context -
    
    Code Review
  </title>
  <link rel="icon" href="/static/favicon.ico" />
  <link type="text/css" rel="stylesheet"
  href="/static/styles.css?v=408576698
" />
  <script type="text/javascript" src="/static/autocomplete/lib/jquery.js"></script>
  <script type="text/javascript"
    src="/static/script.js?v=408576698
"></script>
   <!-- head block to insert js/css for forms processing -->
   
   <!-- /head -->
</head>
<body onunload="M_unloadPage();">

<!-- Begin help window -->
<script type="text/javascript"><!--
var xsrfToken = '9f83c617d0480e265dd7db3ca63d1103';
var helpDisplayed = false;
document.onclick = M_clickCommon;
var media_url = "/static/";
var base_url = "/";
// -->
</script>
<div id="help" style="display: none;">

<div style="font-size: medium; text-align: center;">Keyboard Shortcuts</div>
<hr />
<table class="shortcuts">
  <tr valign="top">
    <td>
      <table>
        <tr>
          <td></td><th>File</th>
        </tr>
        <tr>
          <td><span>u</span> <b>:</b></td><td>up to issue</td>
        </tr>
        <tr>
          <td><span>j</span> / <span>k</span> <b>:</b></td><td>jump to file after / before current file</td>
        </tr>
        <tr>
          <td><span>J</span> / <span>K</span> <b>:</b></td><td>jump to next file with a comment after / before current file</td>
        </tr>
        <tr>
          <td></td><th>Side-by-side diff</th>
        </tr>
        <tr>
          <td><span>i</span> <b>:</b></td><td>toggle intra-line diffs</td>
        </tr>
        <tr>
          <td><span>e</span> <b>:</b></td><td>expand all comments</td>
        </tr>
        <tr>
          <td><span>c</span> <b>:</b></td><td>collapse all comments</td>
        </tr>
        <tr>
          <td><span>s</span> <b>:</b></td><td>toggle showing all comments</td>
        </tr>
        <tr>
          <td><span>n</span> / <span>p</span> <b>:</b></td><td>next / previous diff chunk or comment</td>
        </tr>
        <tr>
          <td><span>N</span> / <span>P</span> <b>:</b></td><td>next / previous comment</td>
        </tr>
        <tr>
          <td><span>&lt;Up&gt;</span> / <span>&lt;Down&gt;</span> <b>:</b></td><td>next / previous line</td>
        </tr>
      </table>
    </td>
    <td>
      <table>
        <tr>
          <td></td><th>Issue</th>
        </tr>
        <tr>
          <td><span>u</span> <b>:</b></td><td>up to list of issues</td>
        </tr>
        <tr>
          <td><span>j</span> / <span>k</span> <b>:</b></td><td>jump to patch after / before current patch</td>
        </tr>
        <tr>
          <td><span>o</span> / <span>&lt;Enter&gt;</span> <b>:</b></td><td>open current patch in side-by-side view</td>
        </tr>
        <tr>
          <td><span>i</span> <b>:</b></td><td>open current patch in unified diff view</td>
        </tr>
        <tr><td>&nbsp;</td></tr>
          <tr><td></td><th>Issue List</th></tr>
        <tr>
          <td><span>j</span> / <span>k</span> <b>:</b></td><td>jump to issue after / before current issue</td>
        </tr>
        <tr>
          <td><span>o</span> / <span>&lt;Enter&gt;</span> <b>:</b></td><td>open current issue</td>
        </tr>
      </table>
    </td>
  </tr>

</table>
</div>
<!-- End help window -->

<div align="right">

<div style="float:left; font-size:x-large"><img style="vertical-align:middle" src="/static/chromium-24.png" /> Chromium Code Reviews</div>




<b>chromiumcodereview-hr@appspot.gserviceaccount.com (chromiumcodereview-hr)</b>
|

<span style="color:red">Please choose your nickname with</span>
<a class="novisit" href="/settings">Settings</a>
|


<a class="novisit" target="_blank"
   href="http://code.google.com/p/rietveld/wiki/CodeReviewHelp">Help</a>

|
<a class="novisit" href="http://www.chromium.org/">Chromium Project</a>
|
<a class="novisit" href="https://chromium-review.googlesource.com/dashboard/self?polygerrit=1">Gerrit Changes</a>
|

<a class="novisit" href="https://codereview.chromium.org/_ah/logout?continue=https://accounts.google.com/Logout%3Fcontinue%3Dhttps://uc.appengine.google.com/_ah/logout%253Fcontinue%253Dhttps://google.com/url%25253Fsa%25253DD%252526q%25253Dhttps://codereview.chromium.org/2009453002%252526ust%25253D1608687577398644%252526usg%25253DAFQjCNFt6Kh--FdNrONLEn58gVjqPelgrQ%26service%3Dah">Sign out</a>

</div>
<div class="counter">(99)</div>
<br />
<div class="mainmenu">
  
  <a href="/" class="active">Issues</a>
  <a href="/search">Search</a>

</div>
<div class="mainmenu2">
  
  
    &nbsp;&nbsp;&nbsp;
    <a href="/mine">My Issues</a>
    |
    <a href="/starred">Starred</a>
    &nbsp;&nbsp;&nbsp;
    <a href="/all?closed=0">Open</a>
    |
    <a href="/all?closed=1">Closed</a>
    |
    <a href="/all">All</a>
  

</div>

<div>

  <h2>
    <span id="issue-star-2009453002">
  
    
      <img src="/static/star-dark.gif" width="15" height="15" border="0">
    
  
</span>

    Issue <a href="/2009453002/"
               onmouseover="M_showPopUp(this, 'popup-issue');">
            2009453002</a>:
    service worker: Don&#39;t control a subframe of an insecure context  (Closed) 
  </h2>

  <table class="issue-details" border="0" width="100%">
    <tr valign="top">

      <td class="meta" width="20%">
        <div class="issue_details_sidebar">
          <div><b>Created:</b><br/>
            4 years, 7 months ago by <a href="/user/falken" onMouseOver="M_showUserInfoPopup(this)">falken</a>
          </div>
          <div><b>Modified:</b><br/>
            4 years, 6 months ago
          </div>
          <div><b>Reviewers:</b><br/>
            <span class='approval'><a href="/user/Devlin" onMouseOver="M_showUserInfoPopup(this)">Devlin</a></span>, <span class='approval'><a href="/user/dcheng" onMouseOver="M_showUserInfoPopup(this)">dcheng</a></span>, <span class='approval'><a href="/user/kinuko" onMouseOver="M_showUserInfoPopup(this)">kinuko</a></span>, <a href="/user/lazyboy" onMouseOver="M_showUserInfoPopup(this)">lazyboy</a>, <span class='approval'><a href="/user/alexmos" onMouseOver="M_showUserInfoPopup(this)">alexmos</a></span>, <span class='approval'><a href="/user/horo" onMouseOver="M_showUserInfoPopup(this)">horo</a></span>, <span class='approval'><a href="/user/jww" onMouseOver="M_showUserInfoPopup(this)">jww</a></span>, <span class='approval'><a href="/user/clamy" onMouseOver="M_showUserInfoPopup(this)">clamy</a></span>
          </div>
          
          <div><b>CC:</b><br/>
            blink-reviews, blink-worker-reviews_chromium.org, chromium-reviews, Charlie Reis, creis+watch_chromium.org, darin-cc_chromium.org, estark, horo+watch_chromium.org, jam, jsbell+serviceworker_chromium.org, kenjibaheux+watch_chromium.org, kinuko+watch, kinuko+serviceworker, michaeln, mkwst+moarreviews-renderer_chromium.org, mlamouri+watch-content_chromium.org, nasko+codewatch_chromium.org, nhiroki, raymes, serviceworker-reviews, site-isolation-reviews_chromium.org, timwillis, Tom Sepez, tzik
          </div>
          
          
          <div><b>Base URL:</b><br/>
            
            https://chromium.googlesource.com/chromium/src.git@master
            
          </div>
          
          
          <div><b>Target Ref:</b><br/>
            refs/pending/heads/master
          </div>
          
          
          <div><b>Project:</b><br/>
            <a href="/search?project=chromium">
              chromium
            </a>
          </div>
          
          <div><b>Visibility:</b><br/>
            
                Public.
            
          </div>
          
          <div><a title="Find reviews for the same repository ID - c14d891d44f0afff64e56ed7c9702df1d807b1ee"
               href="/search?repo_guid=c14d891d44f0afff64e56ed7c9702df1d807b1ee">
            <b>More Reviews</b></a>
          </div>
          
        </div>
      </td>

      <td style="padding-left: .8em; padding-right: .8em;" width="80%">
        




  <h3><a id="issue-description-pointer"
     href="javascript:M_toggleSection('issue-description')"
     class="toggled-section opentriangle">
    Description</a></h3>
  <div id="issue-description">service worker: Don't control a subframe of an insecure context

We must check isSecureContext when creating the network provider to
adhere to <a href="https://w3c.github.io/webappsec/specs/powerfulfeatures/#settings-privileged">https://w3c.github.io/webappsec/specs/powerfulfeatures/#settings-privileged</a>.

We already did this for getRegistration(), register(), unregister() but must
also do this when deciding whether to control an in-scope document.

BUG=<a href="https://bugs.chromium.org/p/chromium/issues/detail?id=607543">607543</a>
CQ_INCLUDE_TRYBOTS=tryserver.chromium.linux:linux_site_isolation

Committed: <a href="https://crrev.com/59a2e54eeb0e61971a0c27c44c54dd0c30b5d06d">https://crrev.com/59a2e54eeb0e61971a0c27c44c54dd0c30b5d06d</a>
Cr-Commit-Position: refs/heads/master@{#398229}
  </div>




  <h3>
    <a id="ps-1-pointer"
       href="/2009453002/#ps1"
       onclick="M_toggleSectionForPS('2009453002', '1')"
       class="toggled-section ">
      Patch Set 1
      
      <span class="anchor">#</span>
    </a>
  </h3>

  
    <div>
      <i>Total comments:</i> 4
      
    </div>
  

  <div id="ps-1"
  
       style="display:none">
  
  </div>
  

  <h3>
    <a id="ps-20001-pointer"
       href="/2009453002/#ps20001"
       onclick="M_toggleSectionForPS('2009453002', '20001')"
       class="toggled-section ">
      Patch Set 2
      : getSecurityOrigin
      <span class="anchor">#</span>
    </a>
  </h3>

  
    <div>
      <i>Total comments:</i> 16
      
    </div>
  

  <div id="ps-20001"
  
       style="display:none">
  
  </div>
  

  <h3>
    <a id="ps-60001-pointer"
       href="/2009453002/#ps60001"
       onclick="M_toggleSectionForPS('2009453002', '60001')"
       class="toggled-section ">
      Patch Set 3
      : refactor the walk
      <span class="anchor">#</span>
    </a>
  </h3>

  

  <div id="ps-60001"
  
       style="display:none">
  
  </div>
  

  <h3>
    <a id="ps-80001-pointer"
       href="/2009453002/#ps80001"
       onclick="M_toggleSectionForPS('2009453002', '80001')"
       class="toggled-section ">
      Patch Set 4
      : add comments
      <span class="anchor">#</span>
    </a>
  </h3>

  

  <div id="ps-80001"
  
       style="display:none">
  
  </div>
  

  <h3>
    <a id="ps-100001-pointer"
       href="/2009453002/#ps100001"
       onclick="M_toggleSectionForPS('2009453002', '100001')"
       class="toggled-section ">
      Patch Set 5
      : fix site isolation
      <span class="anchor">#</span>
    </a>
  </h3>

  

  <div id="ps-100001"
  
       style="display:none">
  
  </div>
  

  <h3>
    <a id="ps-120001-pointer"
       href="/2009453002/#ps120001"
       onclick="M_toggleSectionForPS('2009453002', '120001')"
       class="toggled-section ">
      Patch Set 6
      : cover plznavigation case too
      <span class="anchor">#</span>
    </a>
  </h3>

  
    <div>
      <i>Total comments:</i> 8
      
    </div>
  

  <div id="ps-120001"
  
       style="display:none">
  
  </div>
  

  <h3>
    <a id="ps-140001-pointer"
       href="/2009453002/#ps140001"
       onclick="M_toggleSectionForPS('2009453002', '140001')"
       class="toggled-section ">
      Patch Set 7
      : is_parent_frame_secure
      <span class="anchor">#</span>
    </a>
  </h3>

  

  <div id="ps-140001"
  
       style="display:none">
  
  </div>
  

  <h3>
    <a id="ps-160001-pointer"
       href="/2009453002/#ps160001"
       onclick="M_toggleSectionForPS('2009453002', '160001')"
       class="toggled-section ">
      Patch Set 8
      : rebase
      <span class="anchor">#</span>
    </a>
  </h3>

  

  <div id="ps-160001"
  
       style="display:none">
  
  </div>
  

  <h3>
    <a id="ps-180001-pointer"
       href="/2009453002/#ps180001"
       onclick="M_toggleSectionForPS('2009453002', '180001')"
       class="toggled-section ">
      Patch Set 9
      : rebase
      <span class="anchor">#</span>
    </a>
  </h3>

  

  <div id="ps-180001"
  
       style="display:none">
  
  </div>
  

  <h3>
    <a id="ps-200001-pointer"
       href="/2009453002/#ps200001"
       onclick="M_toggleSectionForPS('2009453002', '200001')"
       class="toggled-section ">
      Patch Set 10
      : add tests, refine
      <span class="anchor">#</span>
    </a>
  </h3>

  

  <div id="ps-200001"
  
       style="display:none">
  
  </div>
  

  <h3>
    <a id="ps-220001-pointer"
       href="/2009453002/#ps220001"
       onclick="M_toggleSectionForPS('2009453002', '220001')"
       class="toggled-section ">
      Patch Set 11
      : selfreview
      <span class="anchor">#</span>
    </a>
  </h3>

  
    <div>
      <i>Total comments:</i> 10
      
    </div>
  

  <div id="ps-220001"
  
       style="display:none">
  
  </div>
  

  <h3>
    <a id="ps-240001-pointer"
       href="/2009453002/#ps240001"
       onclick="M_toggleSectionForPS('2009453002', '240001')"
       class="toggled-section ">
      Patch Set 12
      : rebase
      <span class="anchor">#</span>
    </a>
  </h3>

  

  <div id="ps-240001"
  
       style="display:none">
  
  </div>
  

  <h3>
    <a id="ps-260001-pointer"
       href="/2009453002/#ps260001"
       onclick="M_toggleSectionForPS('2009453002', '260001')"
       class="toggled-section ">
      Patch Set 13
      : rebase past build break
      <span class="anchor">#</span>
    </a>
  </h3>

  

  <div id="ps-260001"
  
       style="display:none">
  
  </div>
  

  <h3>
    <a id="ps-280001-pointer"
       href="/2009453002/#ps280001"
       onclick="M_toggleSectionForPS('2009453002', '280001')"
       class="toggled-section ">
      Patch Set 14
      : review comments
      <span class="anchor">#</span>
    </a>
  </h3>

  
    <div>
      <i>Total comments:</i> 10
      
    </div>
  

  <div id="ps-280001"
  
       style="display:none">
  
  </div>
  

  <h3>
    <a id="ps-300001-pointer"
       href="/2009453002/#ps300001"
       onclick="M_toggleSectionForPS('2009453002', '300001')"
       class="toggled-section ">
      Patch Set 15
      : horo comments
      <span class="anchor">#</span>
    </a>
  </h3>

  
    <div>
      <i>Total comments:</i> 3
      
    </div>
  

  <div id="ps-300001"
  
       style="display:none">
  
  </div>
  

  <h3>
    <a id="ps-320001-pointer"
       href="/2009453002/#ps320001"
       onclick="M_toggleSectionForPS('2009453002', '320001')"
       class="toggled-section ">
      Patch Set 16
      : rebase
      <span class="anchor">#</span>
    </a>
  </h3>

  

  <div id="ps-320001"
  
       style="display:none">
  
  </div>
  

  <h3>
    <a id="ps-360001-pointer"
       href="/2009453002/#ps360001"
       onclick="M_toggleSectionForPS('2009453002', '360001')"
       class="toggled-section ">
      Patch Set 17
      : consolidate tests
      <span class="anchor">#</span>
    </a>
  </h3>

  
    <div>
      <i>Total comments:</i> 5
      
    </div>
  

  <div id="ps-360001"
  
       style="display:none">
  
  </div>
  

  <h3>
    <a id="ps-380001-pointer"
       href="/2009453002/#ps380001"
       onclick="M_toggleSectionForPS('2009453002', '380001')"
       class="toggled-section ">
      Patch Set 18
      : kinuko comments
      <span class="anchor">#</span>
    </a>
  </h3>

  
    <div>
      <i>Total comments:</i> 3
      
    </div>
  

  <div id="ps-380001"
  
       style="display:none">
  
  </div>
  

  <h3>
    <a id="ps-400001-pointer"
       href="/2009453002/#ps400001"
       onclick="M_toggleSectionForPS('2009453002', '400001')"
       class="toggled-section ">
      Patch Set 19
      : rebase
      <span class="anchor">#</span>
    </a>
  </h3>

  

  <div id="ps-400001"
  
       style="display:none">
  
  </div>
  

  <h3>
    <a id="ps-420001-pointer"
       href="/2009453002/#ps420001"
       onclick="M_toggleSectionForPS('2009453002', '420001')"
       class="toggled-section ">
      Patch Set 20
      : expand comment for apitest
      <span class="anchor">#</span>
    </a>
  </h3>

  
    <div>
      <i>Total comments:</i> 2
      
    </div>
  

  <div id="ps-420001"
  
       style="display:none">
  
  </div>
  

  <h3>
    <a id="ps-440001-pointer"
       href="/2009453002/#ps440001"
       onclick="M_toggleSectionForPS('2009453002', '440001')"
       class="toggled-section opentriangle">
      Patch Set 21
      : refactor errorMessage
      <span class="anchor">#</span>
    </a>
  </h3>

  

  <div id="ps-440001"
  
       style="">
    
<div class="issue-list">

  <div class="pagination">
    <div style="float: left;">
      <i>Created:</i> 4 years, 6 months ago
    </div>
    <div style="float: right;">
      
        Download
          <a href="/download/issue2009453002_440001.diff"
            title="Patchset in text format">[raw]</a>
          <a href="/tarball/2009453002/440001"
            title="Tarball containing the original and patched files">[tar.bz2]</a>
      
    </div>
    <div style="clear:both;"></div>
  </div>

  <table id="queues" style="clear:both;">
    <tr align="left">
      <th colspan="2"></th>
      <th>Unified diffs</th>
      <th>Side-by-side diffs</th>
      <th>Delta from patch set</th>
      <th colspan="3">Stats <font style='font-weight: normal'>(<i>+491 lines, -141 lines</i>)</font></th>
      <th>Patch</th>
    </tr>

    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2009453002/patch/440001/450002">
            chrome/browser/chrome_content_browser_client.h
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2009453002/diff/440001/chrome/browser/chrome_content_browser_client.h">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/2009453002/diff2/1:440001/chrome/browser/chrome_content_browser_client.h"
             title="Delta from patch set 1">1</a>
        
          <a href="/2009453002/diff2/20001:440001/chrome/browser/chrome_content_browser_client.h"
             title="Delta from patch set 2">2</a>
        
          <a href="/2009453002/diff2/60001:440001/chrome/browser/chrome_content_browser_client.h"
             title="Delta from patch set 3">3</a>
        
          <a href="/2009453002/diff2/80001:440001/chrome/browser/chrome_content_browser_client.h"
             title="Delta from patch set 4">4</a>
        
          <a href="/2009453002/diff2/100001:440001/chrome/browser/chrome_content_browser_client.h"
             title="Delta from patch set 5">5</a>
        
          <a href="/2009453002/diff2/120001:440001/chrome/browser/chrome_content_browser_client.h"
             title="Delta from patch set 6">6</a>
        
          <a href="/2009453002/diff2/180001:440001/chrome/browser/chrome_content_browser_client.h"
             title="Delta from patch set 9">9</a>
        
          <a href="/2009453002/diff2/200001:440001/chrome/browser/chrome_content_browser_client.h"
             title="Delta from patch set 10">10</a>
        
          <a href="/2009453002/diff2/220001:440001/chrome/browser/chrome_content_browser_client.h"
             title="Delta from patch set 11">11</a>
        
        </td>
        
          <td style="white-space: nowrap">1 chunk</td>
          <td style="white-space: nowrap">+2 lines, -0 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2009453002_440001_450002.diff"
             title="Download patch for chrome/browser/chrome_content_browser_client.h">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2009453002/patch/440001/450001">
            chrome/browser/chrome_content_browser_client.cc
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2009453002/diff/440001/chrome/browser/chrome_content_browser_client.cc">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/2009453002/diff2/1:440001/chrome/browser/chrome_content_browser_client.cc"
             title="Delta from patch set 1">1</a>
        
          <a href="/2009453002/diff2/20001:440001/chrome/browser/chrome_content_browser_client.cc"
             title="Delta from patch set 2">2</a>
        
          <a href="/2009453002/diff2/60001:440001/chrome/browser/chrome_content_browser_client.cc"
             title="Delta from patch set 3">3</a>
        
          <a href="/2009453002/diff2/80001:440001/chrome/browser/chrome_content_browser_client.cc"
             title="Delta from patch set 4">4</a>
        
          <a href="/2009453002/diff2/100001:440001/chrome/browser/chrome_content_browser_client.cc"
             title="Delta from patch set 5">5</a>
        
          <a href="/2009453002/diff2/120001:440001/chrome/browser/chrome_content_browser_client.cc"
             title="Delta from patch set 6">6</a>
        
          <a href="/2009453002/diff2/140001:440001/chrome/browser/chrome_content_browser_client.cc"
             title="Delta from patch set 7">7</a>
        
          <a href="/2009453002/diff2/160001:440001/chrome/browser/chrome_content_browser_client.cc"
             title="Delta from patch set 8">8</a>
        
          <a href="/2009453002/diff2/180001:440001/chrome/browser/chrome_content_browser_client.cc"
             title="Delta from patch set 9">9</a>
        
          <a href="/2009453002/diff2/200001:440001/chrome/browser/chrome_content_browser_client.cc"
             title="Delta from patch set 10">10</a>
        
          <a href="/2009453002/diff2/220001:440001/chrome/browser/chrome_content_browser_client.cc"
             title="Delta from patch set 11">11</a>
        
          <a href="/2009453002/diff2/240001:440001/chrome/browser/chrome_content_browser_client.cc"
             title="Delta from patch set 12">12</a>
        
          <a href="/2009453002/diff2/260001:440001/chrome/browser/chrome_content_browser_client.cc"
             title="Delta from patch set 13">13</a>
        
          <a href="/2009453002/diff2/280001:440001/chrome/browser/chrome_content_browser_client.cc"
             title="Delta from patch set 14">14</a>
        
          <a href="/2009453002/diff2/300001:440001/chrome/browser/chrome_content_browser_client.cc"
             title="Delta from patch set 15">15</a>
        
        </td>
        
          <td style="white-space: nowrap">2 chunks</td>
          <td style="white-space: nowrap">+6 lines, -0 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2009453002_440001_450001.diff"
             title="Download patch for chrome/browser/chrome_content_browser_client.cc">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2009453002/patch/440001/450003">
            chrome/browser/extensions/service_worker_apitest.cc
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2009453002/diff/440001/chrome/browser/extensions/service_worker_apitest.cc">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/2009453002/diff2/1:440001/chrome/browser/extensions/service_worker_apitest.cc"
             title="Delta from patch set 1">1</a>
        
          <a href="/2009453002/diff2/20001:440001/chrome/browser/extensions/service_worker_apitest.cc"
             title="Delta from patch set 2">2</a>
        
          <a href="/2009453002/diff2/60001:440001/chrome/browser/extensions/service_worker_apitest.cc"
             title="Delta from patch set 3">3</a>
        
          <a href="/2009453002/diff2/80001:440001/chrome/browser/extensions/service_worker_apitest.cc"
             title="Delta from patch set 4">4</a>
        
          <a href="/2009453002/diff2/100001:440001/chrome/browser/extensions/service_worker_apitest.cc"
             title="Delta from patch set 5">5</a>
        
          <a href="/2009453002/diff2/120001:440001/chrome/browser/extensions/service_worker_apitest.cc"
             title="Delta from patch set 6">6</a>
        
          <a href="/2009453002/diff2/140001:440001/chrome/browser/extensions/service_worker_apitest.cc"
             title="Delta from patch set 7">7</a>
        
          <a href="/2009453002/diff2/160001:440001/chrome/browser/extensions/service_worker_apitest.cc"
             title="Delta from patch set 8">8</a>
        
          <a href="/2009453002/diff2/180001:440001/chrome/browser/extensions/service_worker_apitest.cc"
             title="Delta from patch set 9">9</a>
        
          <a href="/2009453002/diff2/200001:440001/chrome/browser/extensions/service_worker_apitest.cc"
             title="Delta from patch set 10">10</a>
        
          <a href="/2009453002/diff2/220001:440001/chrome/browser/extensions/service_worker_apitest.cc"
             title="Delta from patch set 11">11</a>
        
          <a href="/2009453002/diff2/240001:440001/chrome/browser/extensions/service_worker_apitest.cc"
             title="Delta from patch set 12">12</a>
        
          <a href="/2009453002/diff2/260001:440001/chrome/browser/extensions/service_worker_apitest.cc"
             title="Delta from patch set 13">13</a>
        
          <a href="/2009453002/diff2/280001:440001/chrome/browser/extensions/service_worker_apitest.cc"
             title="Delta from patch set 14">14</a>
        
          <a href="/2009453002/diff2/300001:440001/chrome/browser/extensions/service_worker_apitest.cc"
             title="Delta from patch set 15">15</a>
        
          <a href="/2009453002/diff2/320001:440001/chrome/browser/extensions/service_worker_apitest.cc"
             title="Delta from patch set 16">16</a>
        
          <a href="/2009453002/diff2/360001:440001/chrome/browser/extensions/service_worker_apitest.cc"
             title="Delta from patch set 17">17</a>
        
          <a href="/2009453002/diff2/380001:440001/chrome/browser/extensions/service_worker_apitest.cc"
             title="Delta from patch set 18">18</a>
        
          <a href="/2009453002/diff2/400001:440001/chrome/browser/extensions/service_worker_apitest.cc"
             title="Delta from patch set 19">19</a>
        
        </td>
        
          <td style="white-space: nowrap">3 chunks</td>
          <td style="white-space: nowrap">+20 lines, -3 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2009453002_440001_450003.diff"
             title="Download patch for chrome/browser/extensions/service_worker_apitest.cc">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2009453002/patch/440001/450004">
            content/browser/service_worker/service_worker_browsertest.cc
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2009453002/diff/440001/content/browser/service_worker/service_worker_browsertest.cc">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/2009453002/diff2/1:440001/content/browser/service_worker/service_worker_browsertest.cc"
             title="Delta from patch set 1">1</a>
        
          <a href="/2009453002/diff2/20001:440001/content/browser/service_worker/service_worker_browsertest.cc"
             title="Delta from patch set 2">2</a>
        
          <a href="/2009453002/diff2/60001:440001/content/browser/service_worker/service_worker_browsertest.cc"
             title="Delta from patch set 3">3</a>
        
          <a href="/2009453002/diff2/80001:440001/content/browser/service_worker/service_worker_browsertest.cc"
             title="Delta from patch set 4">4</a>
        
          <a href="/2009453002/diff2/100001:440001/content/browser/service_worker/service_worker_browsertest.cc"
             title="Delta from patch set 5">5</a>
        
          <a href="/2009453002/diff2/120001:440001/content/browser/service_worker/service_worker_browsertest.cc"
             title="Delta from patch set 6">6</a>
        
          <a href="/2009453002/diff2/140001:440001/content/browser/service_worker/service_worker_browsertest.cc"
             title="Delta from patch set 7">7</a>
        
          <a href="/2009453002/diff2/160001:440001/content/browser/service_worker/service_worker_browsertest.cc"
             title="Delta from patch set 8">8</a>
        
          <a href="/2009453002/diff2/180001:440001/content/browser/service_worker/service_worker_browsertest.cc"
             title="Delta from patch set 9">9</a>
        
          <a href="/2009453002/diff2/200001:440001/content/browser/service_worker/service_worker_browsertest.cc"
             title="Delta from patch set 10">10</a>
        
          <a href="/2009453002/diff2/220001:440001/content/browser/service_worker/service_worker_browsertest.cc"
             title="Delta from patch set 11">11</a>
        
          <a href="/2009453002/diff2/240001:440001/content/browser/service_worker/service_worker_browsertest.cc"
             title="Delta from patch set 12">12</a>
        
          <a href="/2009453002/diff2/260001:440001/content/browser/service_worker/service_worker_browsertest.cc"
             title="Delta from patch set 13">13</a>
        
          <a href="/2009453002/diff2/280001:440001/content/browser/service_worker/service_worker_browsertest.cc"
             title="Delta from patch set 14">14</a>
        
        </td>
        
          <td style="white-space: nowrap">1 chunk</td>
          <td style="white-space: nowrap">+6 lines, -5 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2009453002_440001_450004.diff"
             title="Download patch for content/browser/service_worker/service_worker_browsertest.cc">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2009453002/patch/440001/450005">
            content/browser/service_worker/service_worker_context_core.cc
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2009453002/diff/440001/content/browser/service_worker/service_worker_context_core.cc">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/2009453002/diff2/1:440001/content/browser/service_worker/service_worker_context_core.cc"
             title="Delta from patch set 1">1</a>
        
          <a href="/2009453002/diff2/20001:440001/content/browser/service_worker/service_worker_context_core.cc"
             title="Delta from patch set 2">2</a>
        
          <a href="/2009453002/diff2/60001:440001/content/browser/service_worker/service_worker_context_core.cc"
             title="Delta from patch set 3">3</a>
        
          <a href="/2009453002/diff2/80001:440001/content/browser/service_worker/service_worker_context_core.cc"
             title="Delta from patch set 4">4</a>
        
          <a href="/2009453002/diff2/100001:440001/content/browser/service_worker/service_worker_context_core.cc"
             title="Delta from patch set 5">5</a>
        
          <a href="/2009453002/diff2/120001:440001/content/browser/service_worker/service_worker_context_core.cc"
             title="Delta from patch set 6">6</a>
        
          <a href="/2009453002/diff2/140001:440001/content/browser/service_worker/service_worker_context_core.cc"
             title="Delta from patch set 7">7</a>
        
          <a href="/2009453002/diff2/160001:440001/content/browser/service_worker/service_worker_context_core.cc"
             title="Delta from patch set 8">8</a>
        
          <a href="/2009453002/diff2/180001:440001/content/browser/service_worker/service_worker_context_core.cc"
             title="Delta from patch set 9">9</a>
        
          <a href="/2009453002/diff2/200001:440001/content/browser/service_worker/service_worker_context_core.cc"
             title="Delta from patch set 10">10</a>
        
          <a href="/2009453002/diff2/220001:440001/content/browser/service_worker/service_worker_context_core.cc"
             title="Delta from patch set 11">11</a>
        
          <a href="/2009453002/diff2/240001:440001/content/browser/service_worker/service_worker_context_core.cc"
             title="Delta from patch set 12">12</a>
        
          <a href="/2009453002/diff2/260001:440001/content/browser/service_worker/service_worker_context_core.cc"
             title="Delta from patch set 13">13</a>
        
          <a href="/2009453002/diff2/280001:440001/content/browser/service_worker/service_worker_context_core.cc"
             title="Delta from patch set 14">14</a>
        
        </td>
        
          <td style="white-space: nowrap">1 chunk</td>
          <td style="white-space: nowrap">+7 lines, -7 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2009453002_440001_450005.diff"
             title="Download patch for content/browser/service_worker/service_worker_context_core.cc">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2009453002/patch/440001/450006">
            content/browser/service_worker/service_worker_context_request_handler_unittest.cc
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2009453002/diff/440001/content/browser/service_worker/service_worker_context_request_handler_unittest.cc">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/2009453002/diff2/1:440001/content/browser/service_worker/service_worker_context_request_handler_unittest.cc"
             title="Delta from patch set 1">1</a>
        
          <a href="/2009453002/diff2/20001:440001/content/browser/service_worker/service_worker_context_request_handler_unittest.cc"
             title="Delta from patch set 2">2</a>
        
          <a href="/2009453002/diff2/60001:440001/content/browser/service_worker/service_worker_context_request_handler_unittest.cc"
             title="Delta from patch set 3">3</a>
        
          <a href="/2009453002/diff2/80001:440001/content/browser/service_worker/service_worker_context_request_handler_unittest.cc"
             title="Delta from patch set 4">4</a>
        
          <a href="/2009453002/diff2/100001:440001/content/browser/service_worker/service_worker_context_request_handler_unittest.cc"
             title="Delta from patch set 5">5</a>
        
          <a href="/2009453002/diff2/120001:440001/content/browser/service_worker/service_worker_context_request_handler_unittest.cc"
             title="Delta from patch set 6">6</a>
        
          <a href="/2009453002/diff2/140001:440001/content/browser/service_worker/service_worker_context_request_handler_unittest.cc"
             title="Delta from patch set 7">7</a>
        
          <a href="/2009453002/diff2/160001:440001/content/browser/service_worker/service_worker_context_request_handler_unittest.cc"
             title="Delta from patch set 8">8</a>
        
          <a href="/2009453002/diff2/180001:440001/content/browser/service_worker/service_worker_context_request_handler_unittest.cc"
             title="Delta from patch set 9">9</a>
        
          <a href="/2009453002/diff2/200001:440001/content/browser/service_worker/service_worker_context_request_handler_unittest.cc"
             title="Delta from patch set 10">10</a>
        
          <a href="/2009453002/diff2/220001:440001/content/browser/service_worker/service_worker_context_request_handler_unittest.cc"
             title="Delta from patch set 11">11</a>
        
          <a href="/2009453002/diff2/240001:440001/content/browser/service_worker/service_worker_context_request_handler_unittest.cc"
             title="Delta from patch set 12">12</a>
        
          <a href="/2009453002/diff2/260001:440001/content/browser/service_worker/service_worker_context_request_handler_unittest.cc"
             title="Delta from patch set 13">13</a>
        
          <a href="/2009453002/diff2/280001:440001/content/browser/service_worker/service_worker_context_request_handler_unittest.cc"
             title="Delta from patch set 14">14</a>
        
        </td>
        
          <td style="white-space: nowrap">1 chunk</td>
          <td style="white-space: nowrap">+6 lines, -5 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2009453002_440001_450006.diff"
             title="Download patch for content/browser/service_worker/service_worker_context_request_handler_unittest.cc">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2009453002/patch/440001/450007">
            content/browser/service_worker/service_worker_context_unittest.cc
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2009453002/diff/440001/content/browser/service_worker/service_worker_context_unittest.cc">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/2009453002/diff2/1:440001/content/browser/service_worker/service_worker_context_unittest.cc"
             title="Delta from patch set 1">1</a>
        
          <a href="/2009453002/diff2/20001:440001/content/browser/service_worker/service_worker_context_unittest.cc"
             title="Delta from patch set 2">2</a>
        
          <a href="/2009453002/diff2/60001:440001/content/browser/service_worker/service_worker_context_unittest.cc"
             title="Delta from patch set 3">3</a>
        
          <a href="/2009453002/diff2/80001:440001/content/browser/service_worker/service_worker_context_unittest.cc"
             title="Delta from patch set 4">4</a>
        
          <a href="/2009453002/diff2/100001:440001/content/browser/service_worker/service_worker_context_unittest.cc"
             title="Delta from patch set 5">5</a>
        
          <a href="/2009453002/diff2/120001:440001/content/browser/service_worker/service_worker_context_unittest.cc"
             title="Delta from patch set 6">6</a>
        
          <a href="/2009453002/diff2/140001:440001/content/browser/service_worker/service_worker_context_unittest.cc"
             title="Delta from patch set 7">7</a>
        
          <a href="/2009453002/diff2/160001:440001/content/browser/service_worker/service_worker_context_unittest.cc"
             title="Delta from patch set 8">8</a>
        
          <a href="/2009453002/diff2/180001:440001/content/browser/service_worker/service_worker_context_unittest.cc"
             title="Delta from patch set 9">9</a>
        
          <a href="/2009453002/diff2/200001:440001/content/browser/service_worker/service_worker_context_unittest.cc"
             title="Delta from patch set 10">10</a>
        
          <a href="/2009453002/diff2/220001:440001/content/browser/service_worker/service_worker_context_unittest.cc"
             title="Delta from patch set 11">11</a>
        
          <a href="/2009453002/diff2/240001:440001/content/browser/service_worker/service_worker_context_unittest.cc"
             title="Delta from patch set 12">12</a>
        
          <a href="/2009453002/diff2/260001:440001/content/browser/service_worker/service_worker_context_unittest.cc"
             title="Delta from patch set 13">13</a>
        
          <a href="/2009453002/diff2/280001:440001/content/browser/service_worker/service_worker_context_unittest.cc"
             title="Delta from patch set 14">14</a>
        
        </td>
        
          <td style="white-space: nowrap">1 chunk</td>
          <td style="white-space: nowrap">+12 lines, -4 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2009453002_440001_450007.diff"
             title="Download patch for content/browser/service_worker/service_worker_context_unittest.cc">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2009453002/patch/440001/450008">
            content/browser/service_worker/service_worker_controllee_request_handler.cc
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2009453002/diff/440001/content/browser/service_worker/service_worker_controllee_request_handler.cc">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/2009453002/diff2/1:440001/content/browser/service_worker/service_worker_controllee_request_handler.cc"
             title="Delta from patch set 1">1</a>
        
          <a href="/2009453002/diff2/20001:440001/content/browser/service_worker/service_worker_controllee_request_handler.cc"
             title="Delta from patch set 2">2</a>
        
          <a href="/2009453002/diff2/60001:440001/content/browser/service_worker/service_worker_controllee_request_handler.cc"
             title="Delta from patch set 3">3</a>
        
          <a href="/2009453002/diff2/80001:440001/content/browser/service_worker/service_worker_controllee_request_handler.cc"
             title="Delta from patch set 4">4</a>
        
          <a href="/2009453002/diff2/100001:440001/content/browser/service_worker/service_worker_controllee_request_handler.cc"
             title="Delta from patch set 5">5</a>
        
          <a href="/2009453002/diff2/120001:440001/content/browser/service_worker/service_worker_controllee_request_handler.cc"
             title="Delta from patch set 6">6</a>
        
          <a href="/2009453002/diff2/140001:440001/content/browser/service_worker/service_worker_controllee_request_handler.cc"
             title="Delta from patch set 7">7</a>
        
          <a href="/2009453002/diff2/160001:440001/content/browser/service_worker/service_worker_controllee_request_handler.cc"
             title="Delta from patch set 8">8</a>
        
          <a href="/2009453002/diff2/180001:440001/content/browser/service_worker/service_worker_controllee_request_handler.cc"
             title="Delta from patch set 9">9</a>
        
          <a href="/2009453002/diff2/200001:440001/content/browser/service_worker/service_worker_controllee_request_handler.cc"
             title="Delta from patch set 10">10</a>
        
          <a href="/2009453002/diff2/220001:440001/content/browser/service_worker/service_worker_controllee_request_handler.cc"
             title="Delta from patch set 11">11</a>
        
          <a href="/2009453002/diff2/240001:440001/content/browser/service_worker/service_worker_controllee_request_handler.cc"
             title="Delta from patch set 12">12</a>
        
          <a href="/2009453002/diff2/260001:440001/content/browser/service_worker/service_worker_controllee_request_handler.cc"
             title="Delta from patch set 13">13</a>
        
        </td>
        
          <td style="white-space: nowrap">2 chunks</td>
          <td style="white-space: nowrap">+12 lines, -0 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2009453002_440001_450008.diff"
             title="Download patch for content/browser/service_worker/service_worker_controllee_request_handler.cc">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2009453002/patch/440001/450009">
            content/browser/service_worker/service_worker_controllee_request_handler_unittest.cc
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2009453002/diff/440001/content/browser/service_worker/service_worker_controllee_request_handler_unittest.cc">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/2009453002/diff2/1:440001/content/browser/service_worker/service_worker_controllee_request_handler_unittest.cc"
             title="Delta from patch set 1">1</a>
        
          <a href="/2009453002/diff2/20001:440001/content/browser/service_worker/service_worker_controllee_request_handler_unittest.cc"
             title="Delta from patch set 2">2</a>
        
          <a href="/2009453002/diff2/60001:440001/content/browser/service_worker/service_worker_controllee_request_handler_unittest.cc"
             title="Delta from patch set 3">3</a>
        
          <a href="/2009453002/diff2/80001:440001/content/browser/service_worker/service_worker_controllee_request_handler_unittest.cc"
             title="Delta from patch set 4">4</a>
        
          <a href="/2009453002/diff2/100001:440001/content/browser/service_worker/service_worker_controllee_request_handler_unittest.cc"
             title="Delta from patch set 5">5</a>
        
          <a href="/2009453002/diff2/120001:440001/content/browser/service_worker/service_worker_controllee_request_handler_unittest.cc"
             title="Delta from patch set 6">6</a>
        
          <a href="/2009453002/diff2/140001:440001/content/browser/service_worker/service_worker_controllee_request_handler_unittest.cc"
             title="Delta from patch set 7">7</a>
        
          <a href="/2009453002/diff2/160001:440001/content/browser/service_worker/service_worker_controllee_request_handler_unittest.cc"
             title="Delta from patch set 8">8</a>
        
          <a href="/2009453002/diff2/180001:440001/content/browser/service_worker/service_worker_controllee_request_handler_unittest.cc"
             title="Delta from patch set 9">9</a>
        
          <a href="/2009453002/diff2/200001:440001/content/browser/service_worker/service_worker_controllee_request_handler_unittest.cc"
             title="Delta from patch set 10">10</a>
        
          <a href="/2009453002/diff2/220001:440001/content/browser/service_worker/service_worker_controllee_request_handler_unittest.cc"
             title="Delta from patch set 11">11</a>
        
          <a href="/2009453002/diff2/240001:440001/content/browser/service_worker/service_worker_controllee_request_handler_unittest.cc"
             title="Delta from patch set 12">12</a>
        
          <a href="/2009453002/diff2/260001:440001/content/browser/service_worker/service_worker_controllee_request_handler_unittest.cc"
             title="Delta from patch set 13">13</a>
        
          <a href="/2009453002/diff2/280001:440001/content/browser/service_worker/service_worker_controllee_request_handler_unittest.cc"
             title="Delta from patch set 14">14</a>
        
        </td>
        
          <td style="white-space: nowrap">8 chunks</td>
          <td style="white-space: nowrap">+13 lines, -12 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2009453002_440001_450009.diff"
             title="Download patch for content/browser/service_worker/service_worker_controllee_request_handler_unittest.cc">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2009453002/patch/440001/450011">
            content/browser/service_worker/service_worker_dispatcher_host.h
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2009453002/diff/440001/content/browser/service_worker/service_worker_dispatcher_host.h">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/2009453002/diff2/1:440001/content/browser/service_worker/service_worker_dispatcher_host.h"
             title="Delta from patch set 1">1</a>
        
          <a href="/2009453002/diff2/20001:440001/content/browser/service_worker/service_worker_dispatcher_host.h"
             title="Delta from patch set 2">2</a>
        
          <a href="/2009453002/diff2/60001:440001/content/browser/service_worker/service_worker_dispatcher_host.h"
             title="Delta from patch set 3">3</a>
        
          <a href="/2009453002/diff2/80001:440001/content/browser/service_worker/service_worker_dispatcher_host.h"
             title="Delta from patch set 4">4</a>
        
          <a href="/2009453002/diff2/100001:440001/content/browser/service_worker/service_worker_dispatcher_host.h"
             title="Delta from patch set 5">5</a>
        
          <a href="/2009453002/diff2/120001:440001/content/browser/service_worker/service_worker_dispatcher_host.h"
             title="Delta from patch set 6">6</a>
        
        </td>
        
          <td style="white-space: nowrap">1 chunk</td>
          <td style="white-space: nowrap">+2 lines, -1 line</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2009453002_440001_450011.diff"
             title="Download patch for content/browser/service_worker/service_worker_dispatcher_host.h">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2009453002/patch/440001/450010">
            content/browser/service_worker/service_worker_dispatcher_host.cc
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2009453002/diff/440001/content/browser/service_worker/service_worker_dispatcher_host.cc">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/2009453002/diff2/1:440001/content/browser/service_worker/service_worker_dispatcher_host.cc"
             title="Delta from patch set 1">1</a>
        
          <a href="/2009453002/diff2/20001:440001/content/browser/service_worker/service_worker_dispatcher_host.cc"
             title="Delta from patch set 2">2</a>
        
          <a href="/2009453002/diff2/60001:440001/content/browser/service_worker/service_worker_dispatcher_host.cc"
             title="Delta from patch set 3">3</a>
        
          <a href="/2009453002/diff2/80001:440001/content/browser/service_worker/service_worker_dispatcher_host.cc"
             title="Delta from patch set 4">4</a>
        
          <a href="/2009453002/diff2/100001:440001/content/browser/service_worker/service_worker_dispatcher_host.cc"
             title="Delta from patch set 5">5</a>
        
          <a href="/2009453002/diff2/120001:440001/content/browser/service_worker/service_worker_dispatcher_host.cc"
             title="Delta from patch set 6">6</a>
        
          <a href="/2009453002/diff2/140001:440001/content/browser/service_worker/service_worker_dispatcher_host.cc"
             title="Delta from patch set 7">7</a>
        
          <a href="/2009453002/diff2/160001:440001/content/browser/service_worker/service_worker_dispatcher_host.cc"
             title="Delta from patch set 8">8</a>
        
          <a href="/2009453002/diff2/180001:440001/content/browser/service_worker/service_worker_dispatcher_host.cc"
             title="Delta from patch set 9">9</a>
        
          <a href="/2009453002/diff2/200001:440001/content/browser/service_worker/service_worker_dispatcher_host.cc"
             title="Delta from patch set 10">10</a>
        
          <a href="/2009453002/diff2/220001:440001/content/browser/service_worker/service_worker_dispatcher_host.cc"
             title="Delta from patch set 11">11</a>
        
          <a href="/2009453002/diff2/240001:440001/content/browser/service_worker/service_worker_dispatcher_host.cc"
             title="Delta from patch set 12">12</a>
        
          <a href="/2009453002/diff2/260001:440001/content/browser/service_worker/service_worker_dispatcher_host.cc"
             title="Delta from patch set 13">13</a>
        
          <a href="/2009453002/diff2/280001:440001/content/browser/service_worker/service_worker_dispatcher_host.cc"
             title="Delta from patch set 14">14</a>
        
        </td>
        
          <td style="white-space: nowrap">3 chunks</td>
          <td style="white-space: nowrap">+12 lines, -5 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2009453002_440001_450010.diff"
             title="Download patch for content/browser/service_worker/service_worker_dispatcher_host.cc">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2009453002/patch/440001/450012">
            content/browser/service_worker/service_worker_dispatcher_host_unittest.cc
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2009453002/diff/440001/content/browser/service_worker/service_worker_dispatcher_host_unittest.cc">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/2009453002/diff2/1:440001/content/browser/service_worker/service_worker_dispatcher_host_unittest.cc"
             title="Delta from patch set 1">1</a>
        
          <a href="/2009453002/diff2/20001:440001/content/browser/service_worker/service_worker_dispatcher_host_unittest.cc"
             title="Delta from patch set 2">2</a>
        
          <a href="/2009453002/diff2/60001:440001/content/browser/service_worker/service_worker_dispatcher_host_unittest.cc"
             title="Delta from patch set 3">3</a>
        
          <a href="/2009453002/diff2/80001:440001/content/browser/service_worker/service_worker_dispatcher_host_unittest.cc"
             title="Delta from patch set 4">4</a>
        
          <a href="/2009453002/diff2/100001:440001/content/browser/service_worker/service_worker_dispatcher_host_unittest.cc"
             title="Delta from patch set 5">5</a>
        
          <a href="/2009453002/diff2/120001:440001/content/browser/service_worker/service_worker_dispatcher_host_unittest.cc"
             title="Delta from patch set 6">6</a>
        
          <a href="/2009453002/diff2/140001:440001/content/browser/service_worker/service_worker_dispatcher_host_unittest.cc"
             title="Delta from patch set 7">7</a>
        
          <a href="/2009453002/diff2/160001:440001/content/browser/service_worker/service_worker_dispatcher_host_unittest.cc"
             title="Delta from patch set 8">8</a>
        
          <a href="/2009453002/diff2/180001:440001/content/browser/service_worker/service_worker_dispatcher_host_unittest.cc"
             title="Delta from patch set 9">9</a>
        
          <a href="/2009453002/diff2/200001:440001/content/browser/service_worker/service_worker_dispatcher_host_unittest.cc"
             title="Delta from patch set 10">10</a>
        
          <a href="/2009453002/diff2/220001:440001/content/browser/service_worker/service_worker_dispatcher_host_unittest.cc"
             title="Delta from patch set 11">11</a>
        
          <a href="/2009453002/diff2/240001:440001/content/browser/service_worker/service_worker_dispatcher_host_unittest.cc"
             title="Delta from patch set 12">12</a>
        
          <a href="/2009453002/diff2/260001:440001/content/browser/service_worker/service_worker_dispatcher_host_unittest.cc"
             title="Delta from patch set 13">13</a>
        
          <a href="/2009453002/diff2/280001:440001/content/browser/service_worker/service_worker_dispatcher_host_unittest.cc"
             title="Delta from patch set 14">14</a>
        
        </td>
        
          <td style="white-space: nowrap">5 chunks</td>
          <td style="white-space: nowrap">+13 lines, -7 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2009453002_440001_450012.diff"
             title="Download patch for content/browser/service_worker/service_worker_dispatcher_host_unittest.cc">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2009453002/patch/440001/450013">
            content/browser/service_worker/service_worker_handle_unittest.cc
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2009453002/diff/440001/content/browser/service_worker/service_worker_handle_unittest.cc">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/2009453002/diff2/1:440001/content/browser/service_worker/service_worker_handle_unittest.cc"
             title="Delta from patch set 1">1</a>
        
          <a href="/2009453002/diff2/20001:440001/content/browser/service_worker/service_worker_handle_unittest.cc"
             title="Delta from patch set 2">2</a>
        
          <a href="/2009453002/diff2/60001:440001/content/browser/service_worker/service_worker_handle_unittest.cc"
             title="Delta from patch set 3">3</a>
        
          <a href="/2009453002/diff2/80001:440001/content/browser/service_worker/service_worker_handle_unittest.cc"
             title="Delta from patch set 4">4</a>
        
          <a href="/2009453002/diff2/100001:440001/content/browser/service_worker/service_worker_handle_unittest.cc"
             title="Delta from patch set 5">5</a>
        
          <a href="/2009453002/diff2/120001:440001/content/browser/service_worker/service_worker_handle_unittest.cc"
             title="Delta from patch set 6">6</a>
        
          <a href="/2009453002/diff2/140001:440001/content/browser/service_worker/service_worker_handle_unittest.cc"
             title="Delta from patch set 7">7</a>
        
          <a href="/2009453002/diff2/160001:440001/content/browser/service_worker/service_worker_handle_unittest.cc"
             title="Delta from patch set 8">8</a>
        
          <a href="/2009453002/diff2/180001:440001/content/browser/service_worker/service_worker_handle_unittest.cc"
             title="Delta from patch set 9">9</a>
        
          <a href="/2009453002/diff2/200001:440001/content/browser/service_worker/service_worker_handle_unittest.cc"
             title="Delta from patch set 10">10</a>
        
          <a href="/2009453002/diff2/220001:440001/content/browser/service_worker/service_worker_handle_unittest.cc"
             title="Delta from patch set 11">11</a>
        
          <a href="/2009453002/diff2/240001:440001/content/browser/service_worker/service_worker_handle_unittest.cc"
             title="Delta from patch set 12">12</a>
        
          <a href="/2009453002/diff2/260001:440001/content/browser/service_worker/service_worker_handle_unittest.cc"
             title="Delta from patch set 13">13</a>
        
          <a href="/2009453002/diff2/280001:440001/content/browser/service_worker/service_worker_handle_unittest.cc"
             title="Delta from patch set 14">14</a>
        
          <a href="/2009453002/diff2/300001:440001/content/browser/service_worker/service_worker_handle_unittest.cc"
             title="Delta from patch set 15">15</a>
        
        </td>
        
          <td style="white-space: nowrap">1 chunk</td>
          <td style="white-space: nowrap">+3 lines, -2 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2009453002_440001_450013.diff"
             title="Download patch for content/browser/service_worker/service_worker_handle_unittest.cc">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2009453002/patch/440001/450014">
            content/browser/service_worker/service_worker_job_unittest.cc
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2009453002/diff/440001/content/browser/service_worker/service_worker_job_unittest.cc">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/2009453002/diff2/1:440001/content/browser/service_worker/service_worker_job_unittest.cc"
             title="Delta from patch set 1">1</a>
        
          <a href="/2009453002/diff2/20001:440001/content/browser/service_worker/service_worker_job_unittest.cc"
             title="Delta from patch set 2">2</a>
        
          <a href="/2009453002/diff2/60001:440001/content/browser/service_worker/service_worker_job_unittest.cc"
             title="Delta from patch set 3">3</a>
        
          <a href="/2009453002/diff2/80001:440001/content/browser/service_worker/service_worker_job_unittest.cc"
             title="Delta from patch set 4">4</a>
        
          <a href="/2009453002/diff2/100001:440001/content/browser/service_worker/service_worker_job_unittest.cc"
             title="Delta from patch set 5">5</a>
        
          <a href="/2009453002/diff2/120001:440001/content/browser/service_worker/service_worker_job_unittest.cc"
             title="Delta from patch set 6">6</a>
        
          <a href="/2009453002/diff2/140001:440001/content/browser/service_worker/service_worker_job_unittest.cc"
             title="Delta from patch set 7">7</a>
        
          <a href="/2009453002/diff2/160001:440001/content/browser/service_worker/service_worker_job_unittest.cc"
             title="Delta from patch set 8">8</a>
        
          <a href="/2009453002/diff2/180001:440001/content/browser/service_worker/service_worker_job_unittest.cc"
             title="Delta from patch set 9">9</a>
        
          <a href="/2009453002/diff2/200001:440001/content/browser/service_worker/service_worker_job_unittest.cc"
             title="Delta from patch set 10">10</a>
        
          <a href="/2009453002/diff2/220001:440001/content/browser/service_worker/service_worker_job_unittest.cc"
             title="Delta from patch set 11">11</a>
        
          <a href="/2009453002/diff2/240001:440001/content/browser/service_worker/service_worker_job_unittest.cc"
             title="Delta from patch set 12">12</a>
        
          <a href="/2009453002/diff2/260001:440001/content/browser/service_worker/service_worker_job_unittest.cc"
             title="Delta from patch set 13">13</a>
        
          <a href="/2009453002/diff2/280001:440001/content/browser/service_worker/service_worker_job_unittest.cc"
             title="Delta from patch set 14">14</a>
        
          <a href="/2009453002/diff2/300001:440001/content/browser/service_worker/service_worker_job_unittest.cc"
             title="Delta from patch set 15">15</a>
        
        </td>
        
          <td style="white-space: nowrap">1 chunk</td>
          <td style="white-space: nowrap">+6 lines, -5 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2009453002_440001_450014.diff"
             title="Download patch for content/browser/service_worker/service_worker_job_unittest.cc">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2009453002/patch/440001/450016">
            content/browser/service_worker/service_worker_provider_host.h
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2009453002/diff/440001/content/browser/service_worker/service_worker_provider_host.h">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/2009453002/diff2/1:440001/content/browser/service_worker/service_worker_provider_host.h"
             title="Delta from patch set 1">1</a>
        
          <a href="/2009453002/diff2/20001:440001/content/browser/service_worker/service_worker_provider_host.h"
             title="Delta from patch set 2">2</a>
        
          <a href="/2009453002/diff2/60001:440001/content/browser/service_worker/service_worker_provider_host.h"
             title="Delta from patch set 3">3</a>
        
          <a href="/2009453002/diff2/80001:440001/content/browser/service_worker/service_worker_provider_host.h"
             title="Delta from patch set 4">4</a>
        
          <a href="/2009453002/diff2/100001:440001/content/browser/service_worker/service_worker_provider_host.h"
             title="Delta from patch set 5">5</a>
        
          <a href="/2009453002/diff2/120001:440001/content/browser/service_worker/service_worker_provider_host.h"
             title="Delta from patch set 6">6</a>
        
          <a href="/2009453002/diff2/140001:440001/content/browser/service_worker/service_worker_provider_host.h"
             title="Delta from patch set 7">7</a>
        
          <a href="/2009453002/diff2/160001:440001/content/browser/service_worker/service_worker_provider_host.h"
             title="Delta from patch set 8">8</a>
        
          <a href="/2009453002/diff2/180001:440001/content/browser/service_worker/service_worker_provider_host.h"
             title="Delta from patch set 9">9</a>
        
          <a href="/2009453002/diff2/200001:440001/content/browser/service_worker/service_worker_provider_host.h"
             title="Delta from patch set 10">10</a>
        
          <a href="/2009453002/diff2/220001:440001/content/browser/service_worker/service_worker_provider_host.h"
             title="Delta from patch set 11">11</a>
        
          <a href="/2009453002/diff2/240001:440001/content/browser/service_worker/service_worker_provider_host.h"
             title="Delta from patch set 12">12</a>
        
          <a href="/2009453002/diff2/260001:440001/content/browser/service_worker/service_worker_provider_host.h"
             title="Delta from patch set 13">13</a>
        
          <a href="/2009453002/diff2/280001:440001/content/browser/service_worker/service_worker_provider_host.h"
             title="Delta from patch set 14">14</a>
        
        </td>
        
          <td style="white-space: nowrap">5 chunks</td>
          <td style="white-space: nowrap">+25 lines, -0 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2009453002_440001_450016.diff"
             title="Download patch for content/browser/service_worker/service_worker_provider_host.h">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2009453002/patch/440001/450015">
            content/browser/service_worker/service_worker_provider_host.cc
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2009453002/diff/440001/content/browser/service_worker/service_worker_provider_host.cc">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/2009453002/diff2/1:440001/content/browser/service_worker/service_worker_provider_host.cc"
             title="Delta from patch set 1">1</a>
        
          <a href="/2009453002/diff2/20001:440001/content/browser/service_worker/service_worker_provider_host.cc"
             title="Delta from patch set 2">2</a>
        
          <a href="/2009453002/diff2/60001:440001/content/browser/service_worker/service_worker_provider_host.cc"
             title="Delta from patch set 3">3</a>
        
          <a href="/2009453002/diff2/80001:440001/content/browser/service_worker/service_worker_provider_host.cc"
             title="Delta from patch set 4">4</a>
        
          <a href="/2009453002/diff2/100001:440001/content/browser/service_worker/service_worker_provider_host.cc"
             title="Delta from patch set 5">5</a>
        
          <a href="/2009453002/diff2/120001:440001/content/browser/service_worker/service_worker_provider_host.cc"
             title="Delta from patch set 6">6</a>
        
          <a href="/2009453002/diff2/140001:440001/content/browser/service_worker/service_worker_provider_host.cc"
             title="Delta from patch set 7">7</a>
        
          <a href="/2009453002/diff2/160001:440001/content/browser/service_worker/service_worker_provider_host.cc"
             title="Delta from patch set 8">8</a>
        
          <a href="/2009453002/diff2/180001:440001/content/browser/service_worker/service_worker_provider_host.cc"
             title="Delta from patch set 9">9</a>
        
          <a href="/2009453002/diff2/200001:440001/content/browser/service_worker/service_worker_provider_host.cc"
             title="Delta from patch set 10">10</a>
        
          <a href="/2009453002/diff2/220001:440001/content/browser/service_worker/service_worker_provider_host.cc"
             title="Delta from patch set 11">11</a>
        
          <a href="/2009453002/diff2/240001:440001/content/browser/service_worker/service_worker_provider_host.cc"
             title="Delta from patch set 12">12</a>
        
          <a href="/2009453002/diff2/260001:440001/content/browser/service_worker/service_worker_provider_host.cc"
             title="Delta from patch set 13">13</a>
        
          <a href="/2009453002/diff2/280001:440001/content/browser/service_worker/service_worker_provider_host.cc"
             title="Delta from patch set 14">14</a>
        
        </td>
        
          <td style="white-space: nowrap">6 chunks</td>
          <td style="white-space: nowrap">+22 lines, -1 line</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2009453002_440001_450015.diff"
             title="Download patch for content/browser/service_worker/service_worker_provider_host.cc">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2009453002/patch/440001/450017">
            content/browser/service_worker/service_worker_provider_host_unittest.cc
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2009453002/diff/440001/content/browser/service_worker/service_worker_provider_host_unittest.cc">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/2009453002/diff2/1:440001/content/browser/service_worker/service_worker_provider_host_unittest.cc"
             title="Delta from patch set 1">1</a>
        
          <a href="/2009453002/diff2/20001:440001/content/browser/service_worker/service_worker_provider_host_unittest.cc"
             title="Delta from patch set 2">2</a>
        
          <a href="/2009453002/diff2/60001:440001/content/browser/service_worker/service_worker_provider_host_unittest.cc"
             title="Delta from patch set 3">3</a>
        
          <a href="/2009453002/diff2/80001:440001/content/browser/service_worker/service_worker_provider_host_unittest.cc"
             title="Delta from patch set 4">4</a>
        
          <a href="/2009453002/diff2/100001:440001/content/browser/service_worker/service_worker_provider_host_unittest.cc"
             title="Delta from patch set 5">5</a>
        
          <a href="/2009453002/diff2/120001:440001/content/browser/service_worker/service_worker_provider_host_unittest.cc"
             title="Delta from patch set 6">6</a>
        
          <a href="/2009453002/diff2/140001:440001/content/browser/service_worker/service_worker_provider_host_unittest.cc"
             title="Delta from patch set 7">7</a>
        
          <a href="/2009453002/diff2/160001:440001/content/browser/service_worker/service_worker_provider_host_unittest.cc"
             title="Delta from patch set 8">8</a>
        
          <a href="/2009453002/diff2/180001:440001/content/browser/service_worker/service_worker_provider_host_unittest.cc"
             title="Delta from patch set 9">9</a>
        
          <a href="/2009453002/diff2/200001:440001/content/browser/service_worker/service_worker_provider_host_unittest.cc"
             title="Delta from patch set 10">10</a>
        
          <a href="/2009453002/diff2/220001:440001/content/browser/service_worker/service_worker_provider_host_unittest.cc"
             title="Delta from patch set 11">11</a>
        
          <a href="/2009453002/diff2/240001:440001/content/browser/service_worker/service_worker_provider_host_unittest.cc"
             title="Delta from patch set 12">12</a>
        
          <a href="/2009453002/diff2/260001:440001/content/browser/service_worker/service_worker_provider_host_unittest.cc"
             title="Delta from patch set 13">13</a>
        
          <a href="/2009453002/diff2/280001:440001/content/browser/service_worker/service_worker_provider_host_unittest.cc"
             title="Delta from patch set 14">14</a>
        
        </td>
        
          <td style="white-space: nowrap">5 chunks</td>
          <td style="white-space: nowrap">+64 lines, -9 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2009453002_440001_450017.diff"
             title="Download patch for content/browser/service_worker/service_worker_provider_host_unittest.cc">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2009453002/patch/440001/450018">
            content/browser/service_worker/service_worker_request_handler_unittest.cc
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2009453002/diff/440001/content/browser/service_worker/service_worker_request_handler_unittest.cc">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/2009453002/diff2/1:440001/content/browser/service_worker/service_worker_request_handler_unittest.cc"
             title="Delta from patch set 1">1</a>
        
          <a href="/2009453002/diff2/20001:440001/content/browser/service_worker/service_worker_request_handler_unittest.cc"
             title="Delta from patch set 2">2</a>
        
          <a href="/2009453002/diff2/60001:440001/content/browser/service_worker/service_worker_request_handler_unittest.cc"
             title="Delta from patch set 3">3</a>
        
          <a href="/2009453002/diff2/80001:440001/content/browser/service_worker/service_worker_request_handler_unittest.cc"
             title="Delta from patch set 4">4</a>
        
          <a href="/2009453002/diff2/100001:440001/content/browser/service_worker/service_worker_request_handler_unittest.cc"
             title="Delta from patch set 5">5</a>
        
          <a href="/2009453002/diff2/120001:440001/content/browser/service_worker/service_worker_request_handler_unittest.cc"
             title="Delta from patch set 6">6</a>
        
          <a href="/2009453002/diff2/140001:440001/content/browser/service_worker/service_worker_request_handler_unittest.cc"
             title="Delta from patch set 7">7</a>
        
          <a href="/2009453002/diff2/160001:440001/content/browser/service_worker/service_worker_request_handler_unittest.cc"
             title="Delta from patch set 8">8</a>
        
          <a href="/2009453002/diff2/180001:440001/content/browser/service_worker/service_worker_request_handler_unittest.cc"
             title="Delta from patch set 9">9</a>
        
          <a href="/2009453002/diff2/200001:440001/content/browser/service_worker/service_worker_request_handler_unittest.cc"
             title="Delta from patch set 10">10</a>
        
          <a href="/2009453002/diff2/220001:440001/content/browser/service_worker/service_worker_request_handler_unittest.cc"
             title="Delta from patch set 11">11</a>
        
          <a href="/2009453002/diff2/240001:440001/content/browser/service_worker/service_worker_request_handler_unittest.cc"
             title="Delta from patch set 12">12</a>
        
          <a href="/2009453002/diff2/260001:440001/content/browser/service_worker/service_worker_request_handler_unittest.cc"
             title="Delta from patch set 13">13</a>
        
          <a href="/2009453002/diff2/280001:440001/content/browser/service_worker/service_worker_request_handler_unittest.cc"
             title="Delta from patch set 14">14</a>
        
        </td>
        
          <td style="white-space: nowrap">1 chunk</td>
          <td style="white-space: nowrap">+9 lines, -9 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2009453002_440001_450018.diff"
             title="Download patch for content/browser/service_worker/service_worker_request_handler_unittest.cc">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2009453002/patch/440001/450019">
            content/browser/service_worker/service_worker_storage_unittest.cc
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2009453002/diff/440001/content/browser/service_worker/service_worker_storage_unittest.cc">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/2009453002/diff2/1:440001/content/browser/service_worker/service_worker_storage_unittest.cc"
             title="Delta from patch set 1">1</a>
        
          <a href="/2009453002/diff2/20001:440001/content/browser/service_worker/service_worker_storage_unittest.cc"
             title="Delta from patch set 2">2</a>
        
          <a href="/2009453002/diff2/60001:440001/content/browser/service_worker/service_worker_storage_unittest.cc"
             title="Delta from patch set 3">3</a>
        
          <a href="/2009453002/diff2/80001:440001/content/browser/service_worker/service_worker_storage_unittest.cc"
             title="Delta from patch set 4">4</a>
        
          <a href="/2009453002/diff2/100001:440001/content/browser/service_worker/service_worker_storage_unittest.cc"
             title="Delta from patch set 5">5</a>
        
          <a href="/2009453002/diff2/120001:440001/content/browser/service_worker/service_worker_storage_unittest.cc"
             title="Delta from patch set 6">6</a>
        
          <a href="/2009453002/diff2/140001:440001/content/browser/service_worker/service_worker_storage_unittest.cc"
             title="Delta from patch set 7">7</a>
        
          <a href="/2009453002/diff2/160001:440001/content/browser/service_worker/service_worker_storage_unittest.cc"
             title="Delta from patch set 8">8</a>
        
          <a href="/2009453002/diff2/180001:440001/content/browser/service_worker/service_worker_storage_unittest.cc"
             title="Delta from patch set 9">9</a>
        
          <a href="/2009453002/diff2/200001:440001/content/browser/service_worker/service_worker_storage_unittest.cc"
             title="Delta from patch set 10">10</a>
        
          <a href="/2009453002/diff2/220001:440001/content/browser/service_worker/service_worker_storage_unittest.cc"
             title="Delta from patch set 11">11</a>
        
          <a href="/2009453002/diff2/240001:440001/content/browser/service_worker/service_worker_storage_unittest.cc"
             title="Delta from patch set 12">12</a>
        
          <a href="/2009453002/diff2/260001:440001/content/browser/service_worker/service_worker_storage_unittest.cc"
             title="Delta from patch set 13">13</a>
        
          <a href="/2009453002/diff2/280001:440001/content/browser/service_worker/service_worker_storage_unittest.cc"
             title="Delta from patch set 14">14</a>
        
        </td>
        
          <td style="white-space: nowrap">3 chunks</td>
          <td style="white-space: nowrap">+3 lines, -0 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2009453002_440001_450019.diff"
             title="Download patch for content/browser/service_worker/service_worker_storage_unittest.cc">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2009453002/patch/440001/450020">
            content/browser/service_worker/service_worker_url_request_job_unittest.cc
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2009453002/diff/440001/content/browser/service_worker/service_worker_url_request_job_unittest.cc">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/2009453002/diff2/1:440001/content/browser/service_worker/service_worker_url_request_job_unittest.cc"
             title="Delta from patch set 1">1</a>
        
          <a href="/2009453002/diff2/20001:440001/content/browser/service_worker/service_worker_url_request_job_unittest.cc"
             title="Delta from patch set 2">2</a>
        
          <a href="/2009453002/diff2/60001:440001/content/browser/service_worker/service_worker_url_request_job_unittest.cc"
             title="Delta from patch set 3">3</a>
        
          <a href="/2009453002/diff2/80001:440001/content/browser/service_worker/service_worker_url_request_job_unittest.cc"
             title="Delta from patch set 4">4</a>
        
          <a href="/2009453002/diff2/100001:440001/content/browser/service_worker/service_worker_url_request_job_unittest.cc"
             title="Delta from patch set 5">5</a>
        
          <a href="/2009453002/diff2/120001:440001/content/browser/service_worker/service_worker_url_request_job_unittest.cc"
             title="Delta from patch set 6">6</a>
        
          <a href="/2009453002/diff2/140001:440001/content/browser/service_worker/service_worker_url_request_job_unittest.cc"
             title="Delta from patch set 7">7</a>
        
          <a href="/2009453002/diff2/160001:440001/content/browser/service_worker/service_worker_url_request_job_unittest.cc"
             title="Delta from patch set 8">8</a>
        
          <a href="/2009453002/diff2/180001:440001/content/browser/service_worker/service_worker_url_request_job_unittest.cc"
             title="Delta from patch set 9">9</a>
        
          <a href="/2009453002/diff2/200001:440001/content/browser/service_worker/service_worker_url_request_job_unittest.cc"
             title="Delta from patch set 10">10</a>
        
          <a href="/2009453002/diff2/220001:440001/content/browser/service_worker/service_worker_url_request_job_unittest.cc"
             title="Delta from patch set 11">11</a>
        
          <a href="/2009453002/diff2/240001:440001/content/browser/service_worker/service_worker_url_request_job_unittest.cc"
             title="Delta from patch set 12">12</a>
        
          <a href="/2009453002/diff2/260001:440001/content/browser/service_worker/service_worker_url_request_job_unittest.cc"
             title="Delta from patch set 13">13</a>
        
          <a href="/2009453002/diff2/280001:440001/content/browser/service_worker/service_worker_url_request_job_unittest.cc"
             title="Delta from patch set 14">14</a>
        
        </td>
        
          <td style="white-space: nowrap">13 chunks</td>
          <td style="white-space: nowrap">+17 lines, -20 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2009453002_440001_450020.diff"
             title="Download patch for content/browser/service_worker/service_worker_url_request_job_unittest.cc">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2009453002/patch/440001/450021">
            content/browser/service_worker/service_worker_version_unittest.cc
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2009453002/diff/440001/content/browser/service_worker/service_worker_version_unittest.cc">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/2009453002/diff2/1:440001/content/browser/service_worker/service_worker_version_unittest.cc"
             title="Delta from patch set 1">1</a>
        
          <a href="/2009453002/diff2/20001:440001/content/browser/service_worker/service_worker_version_unittest.cc"
             title="Delta from patch set 2">2</a>
        
          <a href="/2009453002/diff2/60001:440001/content/browser/service_worker/service_worker_version_unittest.cc"
             title="Delta from patch set 3">3</a>
        
          <a href="/2009453002/diff2/80001:440001/content/browser/service_worker/service_worker_version_unittest.cc"
             title="Delta from patch set 4">4</a>
        
          <a href="/2009453002/diff2/100001:440001/content/browser/service_worker/service_worker_version_unittest.cc"
             title="Delta from patch set 5">5</a>
        
          <a href="/2009453002/diff2/120001:440001/content/browser/service_worker/service_worker_version_unittest.cc"
             title="Delta from patch set 6">6</a>
        
          <a href="/2009453002/diff2/140001:440001/content/browser/service_worker/service_worker_version_unittest.cc"
             title="Delta from patch set 7">7</a>
        
          <a href="/2009453002/diff2/160001:440001/content/browser/service_worker/service_worker_version_unittest.cc"
             title="Delta from patch set 8">8</a>
        
          <a href="/2009453002/diff2/180001:440001/content/browser/service_worker/service_worker_version_unittest.cc"
             title="Delta from patch set 9">9</a>
        
          <a href="/2009453002/diff2/200001:440001/content/browser/service_worker/service_worker_version_unittest.cc"
             title="Delta from patch set 10">10</a>
        
          <a href="/2009453002/diff2/220001:440001/content/browser/service_worker/service_worker_version_unittest.cc"
             title="Delta from patch set 11">11</a>
        
          <a href="/2009453002/diff2/240001:440001/content/browser/service_worker/service_worker_version_unittest.cc"
             title="Delta from patch set 12">12</a>
        
          <a href="/2009453002/diff2/260001:440001/content/browser/service_worker/service_worker_version_unittest.cc"
             title="Delta from patch set 13">13</a>
        
          <a href="/2009453002/diff2/280001:440001/content/browser/service_worker/service_worker_version_unittest.cc"
             title="Delta from patch set 14">14</a>
        
          <a href="/2009453002/diff2/300001:440001/content/browser/service_worker/service_worker_version_unittest.cc"
             title="Delta from patch set 15">15</a>
        
        </td>
        
          <td style="white-space: nowrap">1 chunk</td>
          <td style="white-space: nowrap">+1 line, -0 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2009453002_440001_450021.diff"
             title="Download patch for content/browser/service_worker/service_worker_version_unittest.cc">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2009453002/patch/440001/450022">
            content/browser/service_worker/service_worker_write_to_cache_job_unittest.cc
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2009453002/diff/440001/content/browser/service_worker/service_worker_write_to_cache_job_unittest.cc">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/2009453002/diff2/1:440001/content/browser/service_worker/service_worker_write_to_cache_job_unittest.cc"
             title="Delta from patch set 1">1</a>
        
          <a href="/2009453002/diff2/20001:440001/content/browser/service_worker/service_worker_write_to_cache_job_unittest.cc"
             title="Delta from patch set 2">2</a>
        
          <a href="/2009453002/diff2/60001:440001/content/browser/service_worker/service_worker_write_to_cache_job_unittest.cc"
             title="Delta from patch set 3">3</a>
        
          <a href="/2009453002/diff2/80001:440001/content/browser/service_worker/service_worker_write_to_cache_job_unittest.cc"
             title="Delta from patch set 4">4</a>
        
          <a href="/2009453002/diff2/100001:440001/content/browser/service_worker/service_worker_write_to_cache_job_unittest.cc"
             title="Delta from patch set 5">5</a>
        
          <a href="/2009453002/diff2/120001:440001/content/browser/service_worker/service_worker_write_to_cache_job_unittest.cc"
             title="Delta from patch set 6">6</a>
        
          <a href="/2009453002/diff2/140001:440001/content/browser/service_worker/service_worker_write_to_cache_job_unittest.cc"
             title="Delta from patch set 7">7</a>
        
          <a href="/2009453002/diff2/160001:440001/content/browser/service_worker/service_worker_write_to_cache_job_unittest.cc"
             title="Delta from patch set 8">8</a>
        
          <a href="/2009453002/diff2/180001:440001/content/browser/service_worker/service_worker_write_to_cache_job_unittest.cc"
             title="Delta from patch set 9">9</a>
        
          <a href="/2009453002/diff2/200001:440001/content/browser/service_worker/service_worker_write_to_cache_job_unittest.cc"
             title="Delta from patch set 10">10</a>
        
          <a href="/2009453002/diff2/220001:440001/content/browser/service_worker/service_worker_write_to_cache_job_unittest.cc"
             title="Delta from patch set 11">11</a>
        
          <a href="/2009453002/diff2/240001:440001/content/browser/service_worker/service_worker_write_to_cache_job_unittest.cc"
             title="Delta from patch set 12">12</a>
        
          <a href="/2009453002/diff2/260001:440001/content/browser/service_worker/service_worker_write_to_cache_job_unittest.cc"
             title="Delta from patch set 13">13</a>
        
          <a href="/2009453002/diff2/280001:440001/content/browser/service_worker/service_worker_write_to_cache_job_unittest.cc"
             title="Delta from patch set 14">14</a>
        
        </td>
        
          <td style="white-space: nowrap">1 chunk</td>
          <td style="white-space: nowrap">+5 lines, -3 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2009453002_440001_450022.diff"
             title="Download patch for content/browser/service_worker/service_worker_write_to_cache_job_unittest.cc">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2009453002/patch/440001/450024">
            content/child/service_worker/service_worker_network_provider.h
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2009453002/diff/440001/content/child/service_worker/service_worker_network_provider.h">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/2009453002/diff2/1:440001/content/child/service_worker/service_worker_network_provider.h"
             title="Delta from patch set 1">1</a>
        
          <a href="/2009453002/diff2/20001:440001/content/child/service_worker/service_worker_network_provider.h"
             title="Delta from patch set 2">2</a>
        
          <a href="/2009453002/diff2/60001:440001/content/child/service_worker/service_worker_network_provider.h"
             title="Delta from patch set 3">3</a>
        
          <a href="/2009453002/diff2/80001:440001/content/child/service_worker/service_worker_network_provider.h"
             title="Delta from patch set 4">4</a>
        
          <a href="/2009453002/diff2/100001:440001/content/child/service_worker/service_worker_network_provider.h"
             title="Delta from patch set 5">5</a>
        
          <a href="/2009453002/diff2/120001:440001/content/child/service_worker/service_worker_network_provider.h"
             title="Delta from patch set 6">6</a>
        
          <a href="/2009453002/diff2/140001:440001/content/child/service_worker/service_worker_network_provider.h"
             title="Delta from patch set 7">7</a>
        
          <a href="/2009453002/diff2/160001:440001/content/child/service_worker/service_worker_network_provider.h"
             title="Delta from patch set 8">8</a>
        
          <a href="/2009453002/diff2/180001:440001/content/child/service_worker/service_worker_network_provider.h"
             title="Delta from patch set 9">9</a>
        
          <a href="/2009453002/diff2/200001:440001/content/child/service_worker/service_worker_network_provider.h"
             title="Delta from patch set 10">10</a>
        
          <a href="/2009453002/diff2/220001:440001/content/child/service_worker/service_worker_network_provider.h"
             title="Delta from patch set 11">11</a>
        
          <a href="/2009453002/diff2/240001:440001/content/child/service_worker/service_worker_network_provider.h"
             title="Delta from patch set 12">12</a>
        
          <a href="/2009453002/diff2/260001:440001/content/child/service_worker/service_worker_network_provider.h"
             title="Delta from patch set 13">13</a>
        
          <a href="/2009453002/diff2/280001:440001/content/child/service_worker/service_worker_network_provider.h"
             title="Delta from patch set 14">14</a>
        
          <a href="/2009453002/diff2/300001:440001/content/child/service_worker/service_worker_network_provider.h"
             title="Delta from patch set 15">15</a>
        
          <a href="/2009453002/diff2/320001:440001/content/child/service_worker/service_worker_network_provider.h"
             title="Delta from patch set 16">16</a>
        
        </td>
        
          <td style="white-space: nowrap">2 chunks</td>
          <td style="white-space: nowrap">+11 lines, -4 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2009453002_440001_450024.diff"
             title="Download patch for content/child/service_worker/service_worker_network_provider.h">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2009453002/patch/440001/450023">
            content/child/service_worker/service_worker_network_provider.cc
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2009453002/diff/440001/content/child/service_worker/service_worker_network_provider.cc">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/2009453002/diff2/1:440001/content/child/service_worker/service_worker_network_provider.cc"
             title="Delta from patch set 1">1</a>
        
          <a href="/2009453002/diff2/20001:440001/content/child/service_worker/service_worker_network_provider.cc"
             title="Delta from patch set 2">2</a>
        
          <a href="/2009453002/diff2/60001:440001/content/child/service_worker/service_worker_network_provider.cc"
             title="Delta from patch set 3">3</a>
        
          <a href="/2009453002/diff2/80001:440001/content/child/service_worker/service_worker_network_provider.cc"
             title="Delta from patch set 4">4</a>
        
          <a href="/2009453002/diff2/100001:440001/content/child/service_worker/service_worker_network_provider.cc"
             title="Delta from patch set 5">5</a>
        
          <a href="/2009453002/diff2/120001:440001/content/child/service_worker/service_worker_network_provider.cc"
             title="Delta from patch set 6">6</a>
        
          <a href="/2009453002/diff2/140001:440001/content/child/service_worker/service_worker_network_provider.cc"
             title="Delta from patch set 7">7</a>
        
          <a href="/2009453002/diff2/160001:440001/content/child/service_worker/service_worker_network_provider.cc"
             title="Delta from patch set 8">8</a>
        
          <a href="/2009453002/diff2/180001:440001/content/child/service_worker/service_worker_network_provider.cc"
             title="Delta from patch set 9">9</a>
        
          <a href="/2009453002/diff2/200001:440001/content/child/service_worker/service_worker_network_provider.cc"
             title="Delta from patch set 10">10</a>
        
        </td>
        
          <td style="white-space: nowrap">5 chunks</td>
          <td style="white-space: nowrap">+25 lines, -11 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2009453002_440001_450023.diff"
             title="Download patch for content/child/service_worker/service_worker_network_provider.cc">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2009453002/patch/440001/450025">
            content/common/service_worker/service_worker_messages.h
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2009453002/diff/440001/content/common/service_worker/service_worker_messages.h">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/2009453002/diff2/1:440001/content/common/service_worker/service_worker_messages.h"
             title="Delta from patch set 1">1</a>
        
          <a href="/2009453002/diff2/20001:440001/content/common/service_worker/service_worker_messages.h"
             title="Delta from patch set 2">2</a>
        
          <a href="/2009453002/diff2/60001:440001/content/common/service_worker/service_worker_messages.h"
             title="Delta from patch set 3">3</a>
        
          <a href="/2009453002/diff2/80001:440001/content/common/service_worker/service_worker_messages.h"
             title="Delta from patch set 4">4</a>
        
          <a href="/2009453002/diff2/100001:440001/content/common/service_worker/service_worker_messages.h"
             title="Delta from patch set 5">5</a>
        
          <a href="/2009453002/diff2/120001:440001/content/common/service_worker/service_worker_messages.h"
             title="Delta from patch set 6">6</a>
        
          <a href="/2009453002/diff2/140001:440001/content/common/service_worker/service_worker_messages.h"
             title="Delta from patch set 7">7</a>
        
          <a href="/2009453002/diff2/160001:440001/content/common/service_worker/service_worker_messages.h"
             title="Delta from patch set 8">8</a>
        
          <a href="/2009453002/diff2/180001:440001/content/common/service_worker/service_worker_messages.h"
             title="Delta from patch set 9">9</a>
        
          <a href="/2009453002/diff2/200001:440001/content/common/service_worker/service_worker_messages.h"
             title="Delta from patch set 10">10</a>
        
          <a href="/2009453002/diff2/220001:440001/content/common/service_worker/service_worker_messages.h"
             title="Delta from patch set 11">11</a>
        
          <a href="/2009453002/diff2/240001:440001/content/common/service_worker/service_worker_messages.h"
             title="Delta from patch set 12">12</a>
        
          <a href="/2009453002/diff2/260001:440001/content/common/service_worker/service_worker_messages.h"
             title="Delta from patch set 13">13</a>
        
        </td>
        
          <td style="white-space: nowrap">1 chunk</td>
          <td style="white-space: nowrap">+13 lines, -2 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2009453002_440001_450025.diff"
             title="Download patch for content/common/service_worker/service_worker_messages.h">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2009453002/patch/440001/450026">
            content/public/browser/content_browser_client.h
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2009453002/diff/440001/content/public/browser/content_browser_client.h">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/2009453002/diff2/1:440001/content/public/browser/content_browser_client.h"
             title="Delta from patch set 1">1</a>
        
          <a href="/2009453002/diff2/20001:440001/content/public/browser/content_browser_client.h"
             title="Delta from patch set 2">2</a>
        
          <a href="/2009453002/diff2/60001:440001/content/public/browser/content_browser_client.h"
             title="Delta from patch set 3">3</a>
        
          <a href="/2009453002/diff2/80001:440001/content/public/browser/content_browser_client.h"
             title="Delta from patch set 4">4</a>
        
          <a href="/2009453002/diff2/100001:440001/content/public/browser/content_browser_client.h"
             title="Delta from patch set 5">5</a>
        
          <a href="/2009453002/diff2/120001:440001/content/public/browser/content_browser_client.h"
             title="Delta from patch set 6">6</a>
        
          <a href="/2009453002/diff2/140001:440001/content/public/browser/content_browser_client.h"
             title="Delta from patch set 7">7</a>
        
          <a href="/2009453002/diff2/160001:440001/content/public/browser/content_browser_client.h"
             title="Delta from patch set 8">8</a>
        
          <a href="/2009453002/diff2/180001:440001/content/public/browser/content_browser_client.h"
             title="Delta from patch set 9">9</a>
        
          <a href="/2009453002/diff2/200001:440001/content/public/browser/content_browser_client.h"
             title="Delta from patch set 10">10</a>
        
          <a href="/2009453002/diff2/220001:440001/content/public/browser/content_browser_client.h"
             title="Delta from patch set 11">11</a>
        
          <a href="/2009453002/diff2/240001:440001/content/public/browser/content_browser_client.h"
             title="Delta from patch set 12">12</a>
        
          <a href="/2009453002/diff2/260001:440001/content/public/browser/content_browser_client.h"
             title="Delta from patch set 13">13</a>
        
          <a href="/2009453002/diff2/280001:440001/content/public/browser/content_browser_client.h"
             title="Delta from patch set 14">14</a>
        
        </td>
        
          <td style="white-space: nowrap">1 chunk</td>
          <td style="white-space: nowrap">+6 lines, -0 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2009453002_440001_450026.diff"
             title="Download patch for content/public/browser/content_browser_client.h">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2009453002/patch/440001/450027">
            content/renderer/render_frame_impl.cc
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2009453002/diff/440001/content/renderer/render_frame_impl.cc">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/2009453002/diff2/1:440001/content/renderer/render_frame_impl.cc"
             title="Delta from patch set 1">1</a>
        
          <a href="/2009453002/diff2/20001:440001/content/renderer/render_frame_impl.cc"
             title="Delta from patch set 2">2</a>
        
          <a href="/2009453002/diff2/60001:440001/content/renderer/render_frame_impl.cc"
             title="Delta from patch set 3">3</a>
        
          <a href="/2009453002/diff2/80001:440001/content/renderer/render_frame_impl.cc"
             title="Delta from patch set 4">4</a>
        
          <a href="/2009453002/diff2/100001:440001/content/renderer/render_frame_impl.cc"
             title="Delta from patch set 5">5</a>
        
          <a href="/2009453002/diff2/120001:440001/content/renderer/render_frame_impl.cc"
             title="Delta from patch set 6">6</a>
        
          <a href="/2009453002/diff2/140001:440001/content/renderer/render_frame_impl.cc"
             title="Delta from patch set 7">7</a>
        
          <a href="/2009453002/diff2/160001:440001/content/renderer/render_frame_impl.cc"
             title="Delta from patch set 8">8</a>
        
          <a href="/2009453002/diff2/180001:440001/content/renderer/render_frame_impl.cc"
             title="Delta from patch set 9">9</a>
        
          <a href="/2009453002/diff2/200001:440001/content/renderer/render_frame_impl.cc"
             title="Delta from patch set 10">10</a>
        
          <a href="/2009453002/diff2/220001:440001/content/renderer/render_frame_impl.cc"
             title="Delta from patch set 11">11</a>
        
          <a href="/2009453002/diff2/240001:440001/content/renderer/render_frame_impl.cc"
             title="Delta from patch set 12">12</a>
        
          <a href="/2009453002/diff2/260001:440001/content/renderer/render_frame_impl.cc"
             title="Delta from patch set 13">13</a>
        
          <a href="/2009453002/diff2/280001:440001/content/renderer/render_frame_impl.cc"
             title="Delta from patch set 14">14</a>
        
          <a href="/2009453002/diff2/300001:440001/content/renderer/render_frame_impl.cc"
             title="Delta from patch set 15">15</a>
        
          <a href="/2009453002/diff2/320001:440001/content/renderer/render_frame_impl.cc"
             title="Delta from patch set 16">16</a>
        
          <a href="/2009453002/diff2/360001:440001/content/renderer/render_frame_impl.cc"
             title="Delta from patch set 17">17</a>
        
          <a href="/2009453002/diff2/380001:440001/content/renderer/render_frame_impl.cc"
             title="Delta from patch set 18">18</a>
        
        </td>
        
          <td style="white-space: nowrap">1 chunk</td>
          <td style="white-space: nowrap">+2 lines, -2 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2009453002_440001_450027.diff"
             title="Download patch for content/renderer/render_frame_impl.cc">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2009453002/patch/440001/450028">
            content/renderer/service_worker/service_worker_context_client.cc
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2009453002/diff/440001/content/renderer/service_worker/service_worker_context_client.cc">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/2009453002/diff2/1:440001/content/renderer/service_worker/service_worker_context_client.cc"
             title="Delta from patch set 1">1</a>
        
          <a href="/2009453002/diff2/20001:440001/content/renderer/service_worker/service_worker_context_client.cc"
             title="Delta from patch set 2">2</a>
        
          <a href="/2009453002/diff2/60001:440001/content/renderer/service_worker/service_worker_context_client.cc"
             title="Delta from patch set 3">3</a>
        
          <a href="/2009453002/diff2/80001:440001/content/renderer/service_worker/service_worker_context_client.cc"
             title="Delta from patch set 4">4</a>
        
          <a href="/2009453002/diff2/100001:440001/content/renderer/service_worker/service_worker_context_client.cc"
             title="Delta from patch set 5">5</a>
        
          <a href="/2009453002/diff2/120001:440001/content/renderer/service_worker/service_worker_context_client.cc"
             title="Delta from patch set 6">6</a>
        
        </td>
        
          <td style="white-space: nowrap">1 chunk</td>
          <td style="white-space: nowrap">+2 lines, -1 line</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2009453002_440001_450028.diff"
             title="Download patch for content/renderer/service_worker/service_worker_context_client.cc">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2009453002/patch/440001/450029">
            content/renderer/shared_worker/embedded_shared_worker_stub.cc
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2009453002/diff/440001/content/renderer/shared_worker/embedded_shared_worker_stub.cc">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/2009453002/diff2/1:440001/content/renderer/shared_worker/embedded_shared_worker_stub.cc"
             title="Delta from patch set 1">1</a>
        
          <a href="/2009453002/diff2/20001:440001/content/renderer/shared_worker/embedded_shared_worker_stub.cc"
             title="Delta from patch set 2">2</a>
        
          <a href="/2009453002/diff2/60001:440001/content/renderer/shared_worker/embedded_shared_worker_stub.cc"
             title="Delta from patch set 3">3</a>
        
          <a href="/2009453002/diff2/80001:440001/content/renderer/shared_worker/embedded_shared_worker_stub.cc"
             title="Delta from patch set 4">4</a>
        
          <a href="/2009453002/diff2/100001:440001/content/renderer/shared_worker/embedded_shared_worker_stub.cc"
             title="Delta from patch set 5">5</a>
        
          <a href="/2009453002/diff2/120001:440001/content/renderer/shared_worker/embedded_shared_worker_stub.cc"
             title="Delta from patch set 6">6</a>
        
        </td>
        
          <td style="white-space: nowrap">1 chunk</td>
          <td style="white-space: nowrap">+2 lines, -1 line</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2009453002_440001_450029.diff"
             title="Download patch for content/renderer/shared_worker/embedded_shared_worker_stub.cc">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">A</td>
        <td>
          <a class="noul"
             href="/2009453002/patch/440001/450030">
            third_party/WebKit/LayoutTests/http/tests/serviceworker/insecure-parent-frame.html
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2009453002/diff/440001/third_party/WebKit/LayoutTests/http/tests/serviceworker/insecure-parent-frame.html">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/2009453002/diff2/1:440001/third_party/WebKit/LayoutTests/http/tests/serviceworker/insecure-parent-frame.html"
             title="Delta from patch set 1">1</a>
        
          <a href="/2009453002/diff2/20001:440001/third_party/WebKit/LayoutTests/http/tests/serviceworker/insecure-parent-frame.html"
             title="Delta from patch set 2">2</a>
        
          <a href="/2009453002/diff2/60001:440001/third_party/WebKit/LayoutTests/http/tests/serviceworker/insecure-parent-frame.html"
             title="Delta from patch set 3">3</a>
        
          <a href="/2009453002/diff2/80001:440001/third_party/WebKit/LayoutTests/http/tests/serviceworker/insecure-parent-frame.html"
             title="Delta from patch set 4">4</a>
        
          <a href="/2009453002/diff2/100001:440001/third_party/WebKit/LayoutTests/http/tests/serviceworker/insecure-parent-frame.html"
             title="Delta from patch set 5">5</a>
        
          <a href="/2009453002/diff2/120001:440001/third_party/WebKit/LayoutTests/http/tests/serviceworker/insecure-parent-frame.html"
             title="Delta from patch set 6">6</a>
        
          <a href="/2009453002/diff2/140001:440001/third_party/WebKit/LayoutTests/http/tests/serviceworker/insecure-parent-frame.html"
             title="Delta from patch set 7">7</a>
        
          <a href="/2009453002/diff2/160001:440001/third_party/WebKit/LayoutTests/http/tests/serviceworker/insecure-parent-frame.html"
             title="Delta from patch set 8">8</a>
        
          <a href="/2009453002/diff2/180001:440001/third_party/WebKit/LayoutTests/http/tests/serviceworker/insecure-parent-frame.html"
             title="Delta from patch set 9">9</a>
        
          <a href="/2009453002/diff2/200001:440001/third_party/WebKit/LayoutTests/http/tests/serviceworker/insecure-parent-frame.html"
             title="Delta from patch set 10">10</a>
        
        </td>
        
          <td style="white-space: nowrap">1 chunk</td>
          <td style="white-space: nowrap">+35 lines, -0 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2009453002_440001_450030.diff"
             title="Download patch for third_party/WebKit/LayoutTests/http/tests/serviceworker/insecure-parent-frame.html">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">A</td>
        <td>
          <a class="noul"
             href="/2009453002/patch/440001/450031">
            third_party/WebKit/LayoutTests/http/tests/serviceworker/resources/insecure-inscope.html
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2009453002/diff/440001/third_party/WebKit/LayoutTests/http/tests/serviceworker/resources/insecure-inscope.html">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
        </td>
        
          <td style="white-space: nowrap">1 chunk</td>
          <td style="white-space: nowrap">+9 lines, -0 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2009453002_440001_450031.diff"
             title="Download patch for third_party/WebKit/LayoutTests/http/tests/serviceworker/resources/insecure-inscope.html">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">A</td>
        <td>
          <a class="noul"
             href="/2009453002/patch/440001/450032">
            third_party/WebKit/LayoutTests/http/tests/serviceworker/resources/insecure-parent.html
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2009453002/diff/440001/third_party/WebKit/LayoutTests/http/tests/serviceworker/resources/insecure-parent.html">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
        </td>
        
          <td style="white-space: nowrap">1 chunk</td>
          <td style="white-space: nowrap">+16 lines, -0 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2009453002_440001_450032.diff"
             title="Download patch for third_party/WebKit/LayoutTests/http/tests/serviceworker/resources/insecure-parent.html">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2009453002/patch/440001/450034">
            third_party/WebKit/Source/core/dom/Document.h
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2009453002/diff/440001/third_party/WebKit/Source/core/dom/Document.h">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/2009453002/diff2/1:440001/third_party/WebKit/Source/core/dom/Document.h"
             title="Delta from patch set 1">1</a>
        
          <a href="/2009453002/diff2/20001:440001/third_party/WebKit/Source/core/dom/Document.h"
             title="Delta from patch set 2">2</a>
        
          <a href="/2009453002/diff2/60001:440001/third_party/WebKit/Source/core/dom/Document.h"
             title="Delta from patch set 3">3</a>
        
          <a href="/2009453002/diff2/80001:440001/third_party/WebKit/Source/core/dom/Document.h"
             title="Delta from patch set 4">4</a>
        
          <a href="/2009453002/diff2/100001:440001/third_party/WebKit/Source/core/dom/Document.h"
             title="Delta from patch set 5">5</a>
        
          <a href="/2009453002/diff2/120001:440001/third_party/WebKit/Source/core/dom/Document.h"
             title="Delta from patch set 6">6</a>
        
          <a href="/2009453002/diff2/140001:440001/third_party/WebKit/Source/core/dom/Document.h"
             title="Delta from patch set 7">7</a>
        
          <a href="/2009453002/diff2/160001:440001/third_party/WebKit/Source/core/dom/Document.h"
             title="Delta from patch set 8">8</a>
        
          <a href="/2009453002/diff2/180001:440001/third_party/WebKit/Source/core/dom/Document.h"
             title="Delta from patch set 9">9</a>
        
          <a href="/2009453002/diff2/200001:440001/third_party/WebKit/Source/core/dom/Document.h"
             title="Delta from patch set 10">10</a>
        
          <a href="/2009453002/diff2/220001:440001/third_party/WebKit/Source/core/dom/Document.h"
             title="Delta from patch set 11">11</a>
        
          <a href="/2009453002/diff2/240001:440001/third_party/WebKit/Source/core/dom/Document.h"
             title="Delta from patch set 12">12</a>
        
          <a href="/2009453002/diff2/260001:440001/third_party/WebKit/Source/core/dom/Document.h"
             title="Delta from patch set 13">13</a>
        
          <a href="/2009453002/diff2/280001:440001/third_party/WebKit/Source/core/dom/Document.h"
             title="Delta from patch set 14">14</a>
        
          <a href="/2009453002/diff2/300001:440001/third_party/WebKit/Source/core/dom/Document.h"
             title="Delta from patch set 15">15</a>
        
          <a href="/2009453002/diff2/320001:440001/third_party/WebKit/Source/core/dom/Document.h"
             title="Delta from patch set 16">16</a>
        
          <a href="/2009453002/diff2/360001:440001/third_party/WebKit/Source/core/dom/Document.h"
             title="Delta from patch set 17">17</a>
        
          <a href="/2009453002/diff2/380001:440001/third_party/WebKit/Source/core/dom/Document.h"
             title="Delta from patch set 18">18</a>
        
          <a href="/2009453002/diff2/400001:440001/third_party/WebKit/Source/core/dom/Document.h"
             title="Delta from patch set 19">19</a>
        
          <a href="/2009453002/diff2/420001:440001/third_party/WebKit/Source/core/dom/Document.h"
             title="Delta from patch set 20">20</a>
        
        </td>
        
          <td style="white-space: nowrap">1 chunk</td>
          <td style="white-space: nowrap">+1 line, -1 line</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2009453002_440001_450034.diff"
             title="Download patch for third_party/WebKit/Source/core/dom/Document.h">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2009453002/patch/440001/450033">
            third_party/WebKit/Source/core/dom/Document.cpp
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2009453002/diff/440001/third_party/WebKit/Source/core/dom/Document.cpp">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/2009453002/diff2/1:440001/third_party/WebKit/Source/core/dom/Document.cpp"
             title="Delta from patch set 1">1</a>
        
          <a href="/2009453002/diff2/20001:440001/third_party/WebKit/Source/core/dom/Document.cpp"
             title="Delta from patch set 2">2</a>
        
          <a href="/2009453002/diff2/60001:440001/third_party/WebKit/Source/core/dom/Document.cpp"
             title="Delta from patch set 3">3</a>
        
          <a href="/2009453002/diff2/80001:440001/third_party/WebKit/Source/core/dom/Document.cpp"
             title="Delta from patch set 4">4</a>
        
          <a href="/2009453002/diff2/100001:440001/third_party/WebKit/Source/core/dom/Document.cpp"
             title="Delta from patch set 5">5</a>
        
          <a href="/2009453002/diff2/120001:440001/third_party/WebKit/Source/core/dom/Document.cpp"
             title="Delta from patch set 6">6</a>
        
          <a href="/2009453002/diff2/140001:440001/third_party/WebKit/Source/core/dom/Document.cpp"
             title="Delta from patch set 7">7</a>
        
          <a href="/2009453002/diff2/160001:440001/third_party/WebKit/Source/core/dom/Document.cpp"
             title="Delta from patch set 8">8</a>
        
          <a href="/2009453002/diff2/180001:440001/third_party/WebKit/Source/core/dom/Document.cpp"
             title="Delta from patch set 9">9</a>
        
          <a href="/2009453002/diff2/200001:440001/third_party/WebKit/Source/core/dom/Document.cpp"
             title="Delta from patch set 10">10</a>
        
          <a href="/2009453002/diff2/220001:440001/third_party/WebKit/Source/core/dom/Document.cpp"
             title="Delta from patch set 11">11</a>
        
          <a href="/2009453002/diff2/240001:440001/third_party/WebKit/Source/core/dom/Document.cpp"
             title="Delta from patch set 12">12</a>
        
          <a href="/2009453002/diff2/260001:440001/third_party/WebKit/Source/core/dom/Document.cpp"
             title="Delta from patch set 13">13</a>
        
          <a href="/2009453002/diff2/280001:440001/third_party/WebKit/Source/core/dom/Document.cpp"
             title="Delta from patch set 14">14</a>
        
          <a href="/2009453002/diff2/300001:440001/third_party/WebKit/Source/core/dom/Document.cpp"
             title="Delta from patch set 15">15</a>
        
          <a href="/2009453002/diff2/320001:440001/third_party/WebKit/Source/core/dom/Document.cpp"
             title="Delta from patch set 16">16</a>
        
          <a href="/2009453002/diff2/360001:440001/third_party/WebKit/Source/core/dom/Document.cpp"
             title="Delta from patch set 17">17</a>
        
          <a href="/2009453002/diff2/380001:440001/third_party/WebKit/Source/core/dom/Document.cpp"
             title="Delta from patch set 18">18</a>
        
          <a href="/2009453002/diff2/400001:440001/third_party/WebKit/Source/core/dom/Document.cpp"
             title="Delta from patch set 19">19</a>
        
          <a href="/2009453002/diff2/420001:440001/third_party/WebKit/Source/core/dom/Document.cpp"
             title="Delta from patch set 20">20</a>
        
        </td>
        
          <td style="white-space: nowrap">4 chunks</td>
          <td style="white-space: nowrap">+10 lines, -21 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2009453002_440001_450033.diff"
             title="Download patch for third_party/WebKit/Source/core/dom/Document.cpp">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2009453002/patch/440001/450036">
            third_party/WebKit/Source/core/frame/Frame.h
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2009453002/diff/440001/third_party/WebKit/Source/core/frame/Frame.h">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/2009453002/diff2/1:440001/third_party/WebKit/Source/core/frame/Frame.h"
             title="Delta from patch set 1">1</a>
        
          <a href="/2009453002/diff2/20001:440001/third_party/WebKit/Source/core/frame/Frame.h"
             title="Delta from patch set 2">2</a>
        
          <a href="/2009453002/diff2/60001:440001/third_party/WebKit/Source/core/frame/Frame.h"
             title="Delta from patch set 3">3</a>
        
          <a href="/2009453002/diff2/80001:440001/third_party/WebKit/Source/core/frame/Frame.h"
             title="Delta from patch set 4">4</a>
        
          <a href="/2009453002/diff2/100001:440001/third_party/WebKit/Source/core/frame/Frame.h"
             title="Delta from patch set 5">5</a>
        
          <a href="/2009453002/diff2/120001:440001/third_party/WebKit/Source/core/frame/Frame.h"
             title="Delta from patch set 6">6</a>
        
          <a href="/2009453002/diff2/140001:440001/third_party/WebKit/Source/core/frame/Frame.h"
             title="Delta from patch set 7">7</a>
        
          <a href="/2009453002/diff2/160001:440001/third_party/WebKit/Source/core/frame/Frame.h"
             title="Delta from patch set 8">8</a>
        
          <a href="/2009453002/diff2/180001:440001/third_party/WebKit/Source/core/frame/Frame.h"
             title="Delta from patch set 9">9</a>
        
          <a href="/2009453002/diff2/200001:440001/third_party/WebKit/Source/core/frame/Frame.h"
             title="Delta from patch set 10">10</a>
        
          <a href="/2009453002/diff2/220001:440001/third_party/WebKit/Source/core/frame/Frame.h"
             title="Delta from patch set 11">11</a>
        
          <a href="/2009453002/diff2/240001:440001/third_party/WebKit/Source/core/frame/Frame.h"
             title="Delta from patch set 12">12</a>
        
          <a href="/2009453002/diff2/260001:440001/third_party/WebKit/Source/core/frame/Frame.h"
             title="Delta from patch set 13">13</a>
        
          <a href="/2009453002/diff2/280001:440001/third_party/WebKit/Source/core/frame/Frame.h"
             title="Delta from patch set 14">14</a>
        
          <a href="/2009453002/diff2/300001:440001/third_party/WebKit/Source/core/frame/Frame.h"
             title="Delta from patch set 15">15</a>
        
          <a href="/2009453002/diff2/320001:440001/third_party/WebKit/Source/core/frame/Frame.h"
             title="Delta from patch set 16">16</a>
        
          <a href="/2009453002/diff2/360001:440001/third_party/WebKit/Source/core/frame/Frame.h"
             title="Delta from patch set 17">17</a>
        
        </td>
        
          <td style="white-space: nowrap">1 chunk</td>
          <td style="white-space: nowrap">+9 lines, -0 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2009453002_440001_450036.diff"
             title="Download patch for third_party/WebKit/Source/core/frame/Frame.h">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2009453002/patch/440001/450035">
            third_party/WebKit/Source/core/frame/Frame.cpp
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2009453002/diff/440001/third_party/WebKit/Source/core/frame/Frame.cpp">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/2009453002/diff2/1:440001/third_party/WebKit/Source/core/frame/Frame.cpp"
             title="Delta from patch set 1">1</a>
        
          <a href="/2009453002/diff2/20001:440001/third_party/WebKit/Source/core/frame/Frame.cpp"
             title="Delta from patch set 2">2</a>
        
          <a href="/2009453002/diff2/60001:440001/third_party/WebKit/Source/core/frame/Frame.cpp"
             title="Delta from patch set 3">3</a>
        
          <a href="/2009453002/diff2/80001:440001/third_party/WebKit/Source/core/frame/Frame.cpp"
             title="Delta from patch set 4">4</a>
        
          <a href="/2009453002/diff2/100001:440001/third_party/WebKit/Source/core/frame/Frame.cpp"
             title="Delta from patch set 5">5</a>
        
          <a href="/2009453002/diff2/120001:440001/third_party/WebKit/Source/core/frame/Frame.cpp"
             title="Delta from patch set 6">6</a>
        
          <a href="/2009453002/diff2/140001:440001/third_party/WebKit/Source/core/frame/Frame.cpp"
             title="Delta from patch set 7">7</a>
        
          <a href="/2009453002/diff2/160001:440001/third_party/WebKit/Source/core/frame/Frame.cpp"
             title="Delta from patch set 8">8</a>
        
          <a href="/2009453002/diff2/180001:440001/third_party/WebKit/Source/core/frame/Frame.cpp"
             title="Delta from patch set 9">9</a>
        
          <a href="/2009453002/diff2/200001:440001/third_party/WebKit/Source/core/frame/Frame.cpp"
             title="Delta from patch set 10">10</a>
        
          <a href="/2009453002/diff2/220001:440001/third_party/WebKit/Source/core/frame/Frame.cpp"
             title="Delta from patch set 11">11</a>
        
          <a href="/2009453002/diff2/240001:440001/third_party/WebKit/Source/core/frame/Frame.cpp"
             title="Delta from patch set 12">12</a>
        
          <a href="/2009453002/diff2/260001:440001/third_party/WebKit/Source/core/frame/Frame.cpp"
             title="Delta from patch set 13">13</a>
        
          <a href="/2009453002/diff2/280001:440001/third_party/WebKit/Source/core/frame/Frame.cpp"
             title="Delta from patch set 14">14</a>
        
          <a href="/2009453002/diff2/300001:440001/third_party/WebKit/Source/core/frame/Frame.cpp"
             title="Delta from patch set 15">15</a>
        
          <a href="/2009453002/diff2/320001:440001/third_party/WebKit/Source/core/frame/Frame.cpp"
             title="Delta from patch set 16">16</a>
        
        </td>
        
          <td style="white-space: nowrap">1 chunk</td>
          <td style="white-space: nowrap">+9 lines, -0 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2009453002_440001_450035.diff"
             title="Download patch for third_party/WebKit/Source/core/frame/Frame.cpp">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2009453002/patch/440001/450037">
            third_party/WebKit/Source/web/WebFrame.cpp
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2009453002/diff/440001/third_party/WebKit/Source/web/WebFrame.cpp">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/2009453002/diff2/1:440001/third_party/WebKit/Source/web/WebFrame.cpp"
             title="Delta from patch set 1">1</a>
        
          <a href="/2009453002/diff2/20001:440001/third_party/WebKit/Source/web/WebFrame.cpp"
             title="Delta from patch set 2">2</a>
        
          <a href="/2009453002/diff2/60001:440001/third_party/WebKit/Source/web/WebFrame.cpp"
             title="Delta from patch set 3">3</a>
        
          <a href="/2009453002/diff2/80001:440001/third_party/WebKit/Source/web/WebFrame.cpp"
             title="Delta from patch set 4">4</a>
        
          <a href="/2009453002/diff2/100001:440001/third_party/WebKit/Source/web/WebFrame.cpp"
             title="Delta from patch set 5">5</a>
        
          <a href="/2009453002/diff2/120001:440001/third_party/WebKit/Source/web/WebFrame.cpp"
             title="Delta from patch set 6">6</a>
        
          <a href="/2009453002/diff2/140001:440001/third_party/WebKit/Source/web/WebFrame.cpp"
             title="Delta from patch set 7">7</a>
        
          <a href="/2009453002/diff2/160001:440001/third_party/WebKit/Source/web/WebFrame.cpp"
             title="Delta from patch set 8">8</a>
        
          <a href="/2009453002/diff2/180001:440001/third_party/WebKit/Source/web/WebFrame.cpp"
             title="Delta from patch set 9">9</a>
        
          <a href="/2009453002/diff2/200001:440001/third_party/WebKit/Source/web/WebFrame.cpp"
             title="Delta from patch set 10">10</a>
        
          <a href="/2009453002/diff2/220001:440001/third_party/WebKit/Source/web/WebFrame.cpp"
             title="Delta from patch set 11">11</a>
        
          <a href="/2009453002/diff2/240001:440001/third_party/WebKit/Source/web/WebFrame.cpp"
             title="Delta from patch set 12">12</a>
        
          <a href="/2009453002/diff2/260001:440001/third_party/WebKit/Source/web/WebFrame.cpp"
             title="Delta from patch set 13">13</a>
        
          <a href="/2009453002/diff2/280001:440001/third_party/WebKit/Source/web/WebFrame.cpp"
             title="Delta from patch set 14">14</a>
        
          <a href="/2009453002/diff2/300001:440001/third_party/WebKit/Source/web/WebFrame.cpp"
             title="Delta from patch set 15">15</a>
        
          <a href="/2009453002/diff2/320001:440001/third_party/WebKit/Source/web/WebFrame.cpp"
             title="Delta from patch set 16">16</a>
        
        </td>
        
          <td style="white-space: nowrap">1 chunk</td>
          <td style="white-space: nowrap">+8 lines, -0 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2009453002_440001_450037.diff"
             title="Download patch for third_party/WebKit/Source/web/WebFrame.cpp">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2009453002/patch/440001/450038">
            third_party/WebKit/Source/web/tests/WebFrameTest.cpp
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2009453002/diff/440001/third_party/WebKit/Source/web/tests/WebFrameTest.cpp">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/2009453002/diff2/1:440001/third_party/WebKit/Source/web/tests/WebFrameTest.cpp"
             title="Delta from patch set 1">1</a>
        
          <a href="/2009453002/diff2/20001:440001/third_party/WebKit/Source/web/tests/WebFrameTest.cpp"
             title="Delta from patch set 2">2</a>
        
          <a href="/2009453002/diff2/60001:440001/third_party/WebKit/Source/web/tests/WebFrameTest.cpp"
             title="Delta from patch set 3">3</a>
        
          <a href="/2009453002/diff2/80001:440001/third_party/WebKit/Source/web/tests/WebFrameTest.cpp"
             title="Delta from patch set 4">4</a>
        
          <a href="/2009453002/diff2/100001:440001/third_party/WebKit/Source/web/tests/WebFrameTest.cpp"
             title="Delta from patch set 5">5</a>
        
          <a href="/2009453002/diff2/120001:440001/third_party/WebKit/Source/web/tests/WebFrameTest.cpp"
             title="Delta from patch set 6">6</a>
        
          <a href="/2009453002/diff2/140001:440001/third_party/WebKit/Source/web/tests/WebFrameTest.cpp"
             title="Delta from patch set 7">7</a>
        
          <a href="/2009453002/diff2/160001:440001/third_party/WebKit/Source/web/tests/WebFrameTest.cpp"
             title="Delta from patch set 8">8</a>
        
          <a href="/2009453002/diff2/180001:440001/third_party/WebKit/Source/web/tests/WebFrameTest.cpp"
             title="Delta from patch set 9">9</a>
        
          <a href="/2009453002/diff2/200001:440001/third_party/WebKit/Source/web/tests/WebFrameTest.cpp"
             title="Delta from patch set 10">10</a>
        
          <a href="/2009453002/diff2/220001:440001/third_party/WebKit/Source/web/tests/WebFrameTest.cpp"
             title="Delta from patch set 11">11</a>
        
          <a href="/2009453002/diff2/240001:440001/third_party/WebKit/Source/web/tests/WebFrameTest.cpp"
             title="Delta from patch set 12">12</a>
        
          <a href="/2009453002/diff2/260001:440001/third_party/WebKit/Source/web/tests/WebFrameTest.cpp"
             title="Delta from patch set 13">13</a>
        
          <a href="/2009453002/diff2/280001:440001/third_party/WebKit/Source/web/tests/WebFrameTest.cpp"
             title="Delta from patch set 14">14</a>
        
        </td>
        
          <td style="white-space: nowrap">1 chunk</td>
          <td style="white-space: nowrap">+58 lines, -0 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2009453002_440001_450038.diff"
             title="Download patch for third_party/WebKit/Source/web/tests/WebFrameTest.cpp">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2009453002/patch/440001/450039">
            third_party/WebKit/public/web/WebFrame.h
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2009453002/diff/440001/third_party/WebKit/public/web/WebFrame.h">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/2009453002/diff2/1:440001/third_party/WebKit/public/web/WebFrame.h"
             title="Delta from patch set 1">1</a>
        
          <a href="/2009453002/diff2/20001:440001/third_party/WebKit/public/web/WebFrame.h"
             title="Delta from patch set 2">2</a>
        
          <a href="/2009453002/diff2/60001:440001/third_party/WebKit/public/web/WebFrame.h"
             title="Delta from patch set 3">3</a>
        
          <a href="/2009453002/diff2/80001:440001/third_party/WebKit/public/web/WebFrame.h"
             title="Delta from patch set 4">4</a>
        
          <a href="/2009453002/diff2/100001:440001/third_party/WebKit/public/web/WebFrame.h"
             title="Delta from patch set 5">5</a>
        
          <a href="/2009453002/diff2/120001:440001/third_party/WebKit/public/web/WebFrame.h"
             title="Delta from patch set 6">6</a>
        
          <a href="/2009453002/diff2/140001:440001/third_party/WebKit/public/web/WebFrame.h"
             title="Delta from patch set 7">7</a>
        
          <a href="/2009453002/diff2/160001:440001/third_party/WebKit/public/web/WebFrame.h"
             title="Delta from patch set 8">8</a>
        
          <a href="/2009453002/diff2/180001:440001/third_party/WebKit/public/web/WebFrame.h"
             title="Delta from patch set 9">9</a>
        
          <a href="/2009453002/diff2/200001:440001/third_party/WebKit/public/web/WebFrame.h"
             title="Delta from patch set 10">10</a>
        
          <a href="/2009453002/diff2/220001:440001/third_party/WebKit/public/web/WebFrame.h"
             title="Delta from patch set 11">11</a>
        
          <a href="/2009453002/diff2/240001:440001/third_party/WebKit/public/web/WebFrame.h"
             title="Delta from patch set 12">12</a>
        
          <a href="/2009453002/diff2/260001:440001/third_party/WebKit/public/web/WebFrame.h"
             title="Delta from patch set 13">13</a>
        
          <a href="/2009453002/diff2/280001:440001/third_party/WebKit/public/web/WebFrame.h"
             title="Delta from patch set 14">14</a>
        
          <a href="/2009453002/diff2/300001:440001/third_party/WebKit/public/web/WebFrame.h"
             title="Delta from patch set 15">15</a>
        
          <a href="/2009453002/diff2/320001:440001/third_party/WebKit/public/web/WebFrame.h"
             title="Delta from patch set 16">16</a>
        
          <a href="/2009453002/diff2/360001:440001/third_party/WebKit/public/web/WebFrame.h"
             title="Delta from patch set 17">17</a>
        
        </td>
        
          <td style="white-space: nowrap">1 chunk</td>
          <td style="white-space: nowrap">+9 lines, -0 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2009453002_440001_450039.diff"
             title="Download patch for third_party/WebKit/public/web/WebFrame.h">
            Download
          </a>
        </td>
      </tr>
    
  </table>

  
  
</div>

  
  </div>
  
    <script language="JavaScript" type="text/javascript">
         <!--
         var lastPSId = 440001;
         // -->
       </script>
  




  <h3>
    <a id="messages-pointer"
       href="javascript:M_toggleSection('messages')"
       class="toggled-section opentriangle">
      Messages
    </a>
  </h3>

  
    <div><i>
    Total messages: 72 (16 generated)
    </i></div>
  

  <div id="messages">
    <div style="margin-bottom: .5em;">
      <a href="javascript:M_expandAllVisibleComments('cl', 72)">
        Expand Messages</a>
      |
      <a href="javascript:M_collapseAllVisibleComments('cl', 72)">
        Collapse Messages</a>
      
      |
      <a href="javascript:M_showGeneratedComments(72)">
        Show Generated Messages</a>
      |
      <a href="javascript:M_hideGeneratedComments(72)">
        Hide Generated Messages</a>
      
    </div>

    
      <div class="message    generated"
           style="display: none"
           id="generated-msg1"
           name="0">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(0)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>falken</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-0">
                          Description was changed from ========== service worker: Don&#39;t control a subframe of an insecure context ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 7 months ago
		(2016-05-24 09:18:36 UTC)
                <a href="#msg1">#1</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-0"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-0"
            >Description was changed from

==========
service worker: Don&#39;t control a subframe of an insecure context

We must check isSecureContext when creating the network provider to
adhere to
<a href="https://w3c.github.io/webappsec/specs/powerfulfeatures/#settings-privileged" rel="nofollow">https://w3c.github.io/webappsec/specs/powerfulfeatures/#settings-privileged</a>.

We already did this for getRegistration(), register(), unregister() but must
also do this when deciding whether to control an in-scope document.

BUG=607543
==========

to

==========
service worker: Don&#39;t control a subframe of an insecure context

We must check isSecureContext when creating the network provider to
adhere to
<a href="https://w3c.github.io/webappsec/specs/powerfulfeatures/#settings-privileged" rel="nofollow">https://w3c.github.io/webappsec/specs/powerfulfeatures/#settings-privileged</a>.

We already did this for getRegistration(), register(), unregister() but must
also do this when deciding whether to control an in-scope document.

BUG=607543
CQ_INCLUDE_TRYBOTS=tryserver.chromium.linux:linux_site_isolation
==========</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    generated"
           style="display: none"
           id="generated-msg2"
           name="1">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(1)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>falken</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-1">
                          falken@chromium.org changed reviewers: + clamy@chromium.org, horo@chromium.org, jww@chromium.org, kinuko@chromium.org
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 7 months ago
		(2016-05-24 09:31:02 UTC)
                <a href="#msg2">#2</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-1"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-1"
            ><a href="mailto:falken@chromium.org">falken@chromium.org</a> changed reviewers:
+ <a href="mailto:clamy@chromium.org">clamy@chromium.org</a>, <a href="mailto:horo@chromium.org">horo@chromium.org</a>, <a href="mailto:jww@chromium.org">jww@chromium.org</a>, <a href="mailto:kinuko@chromium.org">kinuko@chromium.org</a></pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg3"
           name="2">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(2)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>falken</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-2">
                          PTAL horo: everything kinuko: content/renderer clamy: frame_host jww: security review
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 7 months ago
		(2016-05-24 09:31:03 UTC)
                <a href="#msg3">#3</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-2"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-2"
            >PTAL
horo: everything
kinuko: content/renderer
clamy: frame_host
jww: security review</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    generated"
           style="display: none"
           id="generated-msg4"
           name="3">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(3)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>falken</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-3">
                          falken@chromium.org changed reviewers: + creis@chromium.org
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 7 months ago
		(2016-05-24 11:29:58 UTC)
                <a href="#msg4">#4</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-3"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-3"
            ><a href="mailto:falken@chromium.org">falken@chromium.org</a> changed reviewers:
+ <a href="mailto:creis@chromium.org">creis@chromium.org</a></pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg5"
           name="4">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(4)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>falken</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-4">
                          +creis for OOPIF question https://codereview.chromium.org/2009453002/diff/1/content/child/service_worker/service_worker_network_provider.cc File content/child/service_worker/service_worker_network_provider.cc (right): https://codereview.chromium.org/2009453002/diff/1/content/child/service_worker/service_worker_network_provider.cc#newcode89 content/child/service_worker/service_worker_network_provider.cc:89: if (parent &amp;&amp; !parent-&gt;document().isSecureContext(errorMessage)) Some ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 7 months ago
		(2016-05-24 11:29:58 UTC)
                <a href="#msg5">#5</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-4"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-4"
            >+creis for OOPIF question

<a href="https://codereview.chromium.org/2009453002/diff/1/content/child/service_worker/service_worker_network_provider.cc" rel="nofollow">https://codereview.chromium.org/2009453002/diff/1/content/child/service_worke...</a>
File content/child/service_worker/service_worker_network_provider.cc (right):

<a href="https://codereview.chromium.org/2009453002/diff/1/content/child/service_worker/service_worker_network_provider.cc#newcode89" rel="nofollow">https://codereview.chromium.org/2009453002/diff/1/content/child/service_worke...</a>
content/child/service_worker/service_worker_network_provider.cc:89: if (parent
&amp;&amp; !parent-&gt;document().isSecureContext(errorMessage))
Some tests fail. It looks like this can&#39;t be done because parent can be &quot;remote&quot;
(out of process iframe), in which case parent-&gt;document() fails.

Is there a way to check security context of a WebFrame including remote frames?</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message  approval  "
           
           id="msg6"
           name="5">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(5)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>clamy</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-5">
                          content/browser/frame_host lgtm.
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 7 months ago
		(2016-05-24 11:54:14 UTC)
                <a href="#msg6">#6</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-5"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-5"
            >content/browser/frame_host lgtm.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg7"
           name="6">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(6)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>falken</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-6">
                          https://codereview.chromium.org/2009453002/diff/1/content/child/service_worker/service_worker_network_provider.cc File content/child/service_worker/service_worker_network_provider.cc (right): https://codereview.chromium.org/2009453002/diff/1/content/child/service_worker/service_worker_network_provider.cc#newcode89 content/child/service_worker/service_worker_network_provider.cc:89: if (parent &amp;&amp; !parent-&gt;document().isSecureContext(errorMessage)) On 2016/05/24 11:29:58, falken wrote: ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 7 months ago
		(2016-05-24 13:16:38 UTC)
                <a href="#msg7">#7</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-6"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-6"
            ><a href="https://codereview.chromium.org/2009453002/diff/1/content/child/service_worker/service_worker_network_provider.cc" rel="nofollow">https://codereview.chromium.org/2009453002/diff/1/content/child/service_worke...</a>
File content/child/service_worker/service_worker_network_provider.cc (right):

<a href="https://codereview.chromium.org/2009453002/diff/1/content/child/service_worker/service_worker_network_provider.cc#newcode89" rel="nofollow">https://codereview.chromium.org/2009453002/diff/1/content/child/service_worke...</a>
content/child/service_worker/service_worker_network_provider.cc:89: if (parent
&amp;&amp; !parent-&gt;document().isSecureContext(errorMessage))
On 2016/05/24 11:29:58, falken wrote:
&gt; Some tests fail. It looks like this can&#39;t be done because parent can be
&quot;remote&quot;
&gt; (out of process iframe), in which case parent-&gt;document() fails.
&gt; 
&gt; Is there a way to check security context of a WebFrame including remote
frames?

I see now, there is WebSecurityOrigin. Updated the patch.

<a href="https://codereview.chromium.org/2009453002/diff/20001/content/child/service_worker/service_worker_network_provider.cc" rel="nofollow">https://codereview.chromium.org/2009453002/diff/20001/content/child/service_w...</a>
File content/child/service_worker/service_worker_network_provider.cc (right):

<a href="https://codereview.chromium.org/2009453002/diff/20001/content/child/service_worker/service_worker_network_provider.cc#newcode86" rel="nofollow">https://codereview.chromium.org/2009453002/diff/20001/content/child/service_w...</a>
content/child/service_worker/service_worker_network_provider.cc:86: while
(parent &amp;&amp; should_create_provider_for_window) {
This ancestor walk should probably be some utility function like
Document::isSecureContext(). One subtle difference is we shouldn&#39;t check for
scheme exceptions like Document does, since those shouldn&#39;t be applied to child
frames, which is what we care about here.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg8"
           name="7">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(7)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Marijn Kruisselbrink</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-7">
                          drive-by comment https://codereview.chromium.org/2009453002/diff/20001/content/child/service_worker/service_worker_network_provider.cc File content/child/service_worker/service_worker_network_provider.cc (right): https://codereview.chromium.org/2009453002/diff/20001/content/child/service_worker/service_worker_network_provider.cc#newcode86 content/child/service_worker/service_worker_network_provider.cc:86: while (parent &amp;&amp; should_create_provider_for_window) { On 2016/05/24 ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 7 months ago
		(2016-05-24 17:03:35 UTC)
                <a href="#msg8">#8</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-7"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-7"
            >drive-by comment

<a href="https://codereview.chromium.org/2009453002/diff/20001/content/child/service_worker/service_worker_network_provider.cc" rel="nofollow">https://codereview.chromium.org/2009453002/diff/20001/content/child/service_w...</a>
File content/child/service_worker/service_worker_network_provider.cc (right):

<a href="https://codereview.chromium.org/2009453002/diff/20001/content/child/service_worker/service_worker_network_provider.cc#newcode86" rel="nofollow">https://codereview.chromium.org/2009453002/diff/20001/content/child/service_w...</a>
content/child/service_worker/service_worker_network_provider.cc:86: while
(parent &amp;&amp; should_create_provider_for_window) {
On 2016/05/24 at 13:16:37, falken wrote:
&gt; This ancestor walk should probably be some utility function like
Document::isSecureContext(). One subtle difference is we shouldn&#39;t check for
scheme exceptions like Document does, since those shouldn&#39;t be applied to child
frames, which is what we care about here.

Also keep in mind that to truly match what is specified in
<a href="https://w3c.github.io/webappsec-secure-contexts/#settings-object" rel="nofollow">https://w3c.github.io/webappsec-secure-contexts/#settings-object</a> you need to not
only exclude iframes inside insecure contexts, but also top-level windows opened
by insecure contexts without no-opener.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    generated"
           style="display: none"
           id="generated-msg9"
           name="8">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(8)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Charlie Reis</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-8">
                          creis@chromium.org changed reviewers: + alexmos@chromium.org - creis@chromium.org
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 7 months ago
		(2016-05-24 17:21:59 UTC)
                <a href="#msg9">#9</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-8"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-8"
            ><a href="mailto:creis@chromium.org">creis@chromium.org</a> changed reviewers:
+ <a href="mailto:alexmos@chromium.org">alexmos@chromium.org</a>
- <a href="mailto:creis@chromium.org">creis@chromium.org</a></pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg10"
           name="9">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(9)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Charlie Reis</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-9">
                          https://codereview.chromium.org/2009453002/diff/1/content/child/service_worker/service_worker_network_provider.cc File content/child/service_worker/service_worker_network_provider.cc (right): https://codereview.chromium.org/2009453002/diff/1/content/child/service_worker/service_worker_network_provider.cc#newcode89 content/child/service_worker/service_worker_network_provider.cc:89: if (parent &amp;&amp; !parent-&gt;document().isSecureContext(errorMessage)) On 2016/05/24 13:16:37, falken wrote: ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 7 months ago
		(2016-05-24 17:22:00 UTC)
                <a href="#msg10">#10</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-9"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-9"
            ><a href="https://codereview.chromium.org/2009453002/diff/1/content/child/service_worker/service_worker_network_provider.cc" rel="nofollow">https://codereview.chromium.org/2009453002/diff/1/content/child/service_worke...</a>
File content/child/service_worker/service_worker_network_provider.cc (right):

<a href="https://codereview.chromium.org/2009453002/diff/1/content/child/service_worker/service_worker_network_provider.cc#newcode89" rel="nofollow">https://codereview.chromium.org/2009453002/diff/1/content/child/service_worke...</a>
content/child/service_worker/service_worker_network_provider.cc:89: if (parent
&amp;&amp; !parent-&gt;document().isSecureContext(errorMessage))
On 2016/05/24 13:16:37, falken wrote:
&gt; On 2016/05/24 11:29:58, falken wrote:
&gt; &gt; Some tests fail. It looks like this can&#39;t be done because parent can be
&gt; &quot;remote&quot;
&gt; &gt; (out of process iframe), in which case parent-&gt;document() fails.
&gt; &gt; 
&gt; &gt; Is there a way to check security context of a WebFrame including remote
&gt; frames?
&gt; 
&gt; I see now, there is WebSecurityOrigin. Updated the patch.

Yep, that&#39;s the right way.  +alexmos to verify it&#39;s used correctly here.  (See
also mek@&#39;s comment.)</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    generated"
           style="display: none"
           id="generated-msg11"
           name="10">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(10)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Charlie Reis</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-10">
                          Description was changed from ========== service worker: Don&#39;t control a subframe of an insecure context ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 7 months ago
		(2016-05-24 17:22:19 UTC)
                <a href="#msg11">#11</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-10"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-10"
            >Description was changed from

==========
service worker: Don&#39;t control a subframe of an insecure context

We must check isSecureContext when creating the network provider to
adhere to
<a href="https://w3c.github.io/webappsec/specs/powerfulfeatures/#settings-privileged" rel="nofollow">https://w3c.github.io/webappsec/specs/powerfulfeatures/#settings-privileged</a>.

We already did this for getRegistration(), register(), unregister() but must
also do this when deciding whether to control an in-scope document.

BUG=607543
CQ_INCLUDE_TRYBOTS=tryserver.chromium.linux:linux_site_isolation
==========

to

==========
service worker: Don&#39;t control a subframe of an insecure context

We must check isSecureContext when creating the network provider to
adhere to
<a href="https://w3c.github.io/webappsec/specs/powerfulfeatures/#settings-privileged" rel="nofollow">https://w3c.github.io/webappsec/specs/powerfulfeatures/#settings-privileged</a>.

We already did this for getRegistration(), register(), unregister() but must
also do this when deciding whether to control an in-scope document.

BUG=607543
CQ_INCLUDE_TRYBOTS=tryserver.chromium.linux:linux_site_isolation
==========</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg12"
           name="11">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(11)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>jww</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-11">
                          https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_host/navigation_request.cc File content/browser/frame_host/navigation_request.cc (right): https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_host/navigation_request.cc#newcode304 content/browser/frame_host/navigation_request.cc:304: // TODO(falken): This should do an isSecureContext check too. ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 7 months ago
		(2016-05-24 18:06:04 UTC)
                <a href="#msg12">#12</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-11"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-11"
            ><a href="https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_host/navigation_request.cc" rel="nofollow">https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_h...</a>
File content/browser/frame_host/navigation_request.cc (right):

<a href="https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_host/navigation_request.cc#newcode304" rel="nofollow">https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_h...</a>
content/browser/frame_host/navigation_request.cc:304: // TODO(falken): This
should do an isSecureContext check too.
To ask a dumb question, why not add that check right now?

<a href="https://codereview.chromium.org/2009453002/diff/20001/content/child/service_worker/service_worker_network_provider.cc" rel="nofollow">https://codereview.chromium.org/2009453002/diff/20001/content/child/service_w...</a>
File content/child/service_worker/service_worker_network_provider.cc (right):

<a href="https://codereview.chromium.org/2009453002/diff/20001/content/child/service_worker/service_worker_network_provider.cc#newcode86" rel="nofollow">https://codereview.chromium.org/2009453002/diff/20001/content/child/service_w...</a>
content/child/service_worker/service_worker_network_provider.cc:86: while
(parent &amp;&amp; should_create_provider_for_window) {
On 2016/05/24 17:03:35, Marijn Kruisselbrink wrote:
&gt; On 2016/05/24 at 13:16:37, falken wrote:
&gt; &gt; This ancestor walk should probably be some utility function like
&gt; Document::isSecureContext(). One subtle difference is we shouldn&#39;t check for
&gt; scheme exceptions like Document does, since those shouldn&#39;t be applied to
child
&gt; frames, which is what we care about here.
&gt; 
&gt; Also keep in mind that to truly match what is specified in
&gt; <a href="https://w3c.github.io/webappsec-secure-contexts/#settings-object" rel="nofollow">https://w3c.github.io/webappsec-secure-contexts/#settings-object</a> you need to
not
&gt; only exclude iframes inside insecure contexts, but also top-level windows
opened
&gt; by insecure contexts without no-opener.

I have a strong preference to factor this out into a shared utility function
that Document and this both use. It will be much easier to track changes, and
even to just track that this check exists at all. This would also probably give
you a helpful error message to use, no?

Also, why don&#39;t you check if the current origin is potentially trustworthy? That
is, you only start checking the child frames. I think this is related to mek&#39;s
comment.

<a href="https://codereview.chromium.org/2009453002/diff/20001/content/child/service_worker/service_worker_network_provider.h" rel="nofollow">https://codereview.chromium.org/2009453002/diff/20001/content/child/service_w...</a>
File content/child/service_worker/service_worker_network_provider.h (right):

<a href="https://codereview.chromium.org/2009453002/diff/20001/content/child/service_worker/service_worker_network_provider.h#newcode21" rel="nofollow">https://codereview.chromium.org/2009453002/diff/20001/content/child/service_w...</a>
content/child/service_worker/service_worker_network_provider.h:21: }
nit: &quot;  // namespace blink&quot;</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg13"
           name="12">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(12)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>alexmos</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-12">
                          https://codereview.chromium.org/2009453002/diff/1/content/child/service_worker/service_worker_network_provider.cc File content/child/service_worker/service_worker_network_provider.cc (right): https://codereview.chromium.org/2009453002/diff/1/content/child/service_worker/service_worker_network_provider.cc#newcode89 content/child/service_worker/service_worker_network_provider.cc:89: if (parent &amp;&amp; !parent-&gt;document().isSecureContext(errorMessage)) On 2016/05/24 17:22:00, Charlie Reis ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 7 months ago
		(2016-05-24 18:51:55 UTC)
                <a href="#msg13">#13</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-12"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-12"
            ><a href="https://codereview.chromium.org/2009453002/diff/1/content/child/service_worker/service_worker_network_provider.cc" rel="nofollow">https://codereview.chromium.org/2009453002/diff/1/content/child/service_worke...</a>
File content/child/service_worker/service_worker_network_provider.cc (right):

<a href="https://codereview.chromium.org/2009453002/diff/1/content/child/service_worker/service_worker_network_provider.cc#newcode89" rel="nofollow">https://codereview.chromium.org/2009453002/diff/1/content/child/service_worke...</a>
content/child/service_worker/service_worker_network_provider.cc:89: if (parent
&amp;&amp; !parent-&gt;document().isSecureContext(errorMessage))
On 2016/05/24 17:22:00, Charlie Reis (slow to reply) wrote:
&gt; On 2016/05/24 13:16:37, falken wrote:
&gt; &gt; On 2016/05/24 11:29:58, falken wrote:
&gt; &gt; &gt; Some tests fail. It looks like this can&#39;t be done because parent can be
&gt; &gt; &quot;remote&quot;
&gt; &gt; &gt; (out of process iframe), in which case parent-&gt;document() fails.
&gt; &gt; &gt; 
&gt; &gt; &gt; Is there a way to check security context of a WebFrame including remote
&gt; &gt; frames?
&gt; &gt; 
&gt; &gt; I see now, there is WebSecurityOrigin. Updated the patch.
&gt; 
&gt; Yep, that&#39;s the right way.  +alexmos to verify it&#39;s used correctly here.  (See
&gt; also mek@&#39;s comment.)

Yes, remote frames should have correct SecurityOrigins (which we replicate from
the corresponding local frame).  We&#39;ve also recently refactored
SecurityOrigin::isPotentiallyTrustworthy and Document::isSecureContext to work
correctly with remote frames (see issue 571079).  Ideally you&#39;d just call
WebDocument::isSecureContext on the |frame|&#39;s document, so it&#39;s too bad that it
isn&#39;t created yet.

+1 to jww@&#39;s suggestion to unify this walk with the one in
Document::isSecureContext if possible.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg14"
           name="13">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(13)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>falken</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-13">
                          https://codereview.chromium.org/2009453002/diff/20001/content/child/service_worker/service_worker_network_provider.cc File content/child/service_worker/service_worker_network_provider.cc (right): https://codereview.chromium.org/2009453002/diff/20001/content/child/service_worker/service_worker_network_provider.cc#newcode86 content/child/service_worker/service_worker_network_provider.cc:86: while (parent &amp;&amp; should_create_provider_for_window) { On 2016/05/24 18:06:03, jww ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 7 months ago
		(2016-05-25 01:33:34 UTC)
                <a href="#msg14">#14</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-13"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-13"
            ><a href="https://codereview.chromium.org/2009453002/diff/20001/content/child/service_worker/service_worker_network_provider.cc" rel="nofollow">https://codereview.chromium.org/2009453002/diff/20001/content/child/service_w...</a>
File content/child/service_worker/service_worker_network_provider.cc (right):

<a href="https://codereview.chromium.org/2009453002/diff/20001/content/child/service_worker/service_worker_network_provider.cc#newcode86" rel="nofollow">https://codereview.chromium.org/2009453002/diff/20001/content/child/service_w...</a>
content/child/service_worker/service_worker_network_provider.cc:86: while
(parent &amp;&amp; should_create_provider_for_window) {
On 2016/05/24 18:06:03, jww wrote:
&gt; On 2016/05/24 17:03:35, Marijn Kruisselbrink wrote:
&gt; &gt; On 2016/05/24 at 13:16:37, falken wrote:
&gt; &gt; &gt; This ancestor walk should probably be some utility function like
&gt; &gt; Document::isSecureContext(). One subtle difference is we shouldn&#39;t check for
&gt; &gt; scheme exceptions like Document does, since those shouldn&#39;t be applied to
&gt; child
&gt; &gt; frames, which is what we care about here.
&gt; &gt; 
&gt; &gt; Also keep in mind that to truly match what is specified in
&gt; &gt; <a href="https://w3c.github.io/webappsec-secure-contexts/#settings-object" rel="nofollow">https://w3c.github.io/webappsec-secure-contexts/#settings-object</a> you need to
&gt; not
&gt; &gt; only exclude iframes inside insecure contexts, but also top-level windows
&gt; opened
&gt; &gt; by insecure contexts without no-opener.
&gt; 
&gt; I have a strong preference to factor this out into a shared utility function
&gt; that Document and this both use. It will be much easier to track changes, and
&gt; even to just track that this check exists at all. This would also probably
give
&gt; you a helpful error message to use, no?
&gt; 
&gt; Also, why don&#39;t you check if the current origin is potentially trustworthy?
That
&gt; is, you only start checking the child frames. I think this is related to mek&#39;s
&gt; comment.

I can&#39;t start with the current frame because document is not yet created.
getSecurityOrigin() calls frame()-&gt;securityContext()-&gt;getSecurityOrigin(), but
securityContext() is just document(), so it blows up.

I probably do need to check the current frame to address mek&#39;s point. Ideas?</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg15"
           name="14">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(14)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>falken</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-14">
                          https://codereview.chromium.org/2009453002/diff/20001/content/child/service_worker/service_worker_network_provider.cc File content/child/service_worker/service_worker_network_provider.cc (right): https://codereview.chromium.org/2009453002/diff/20001/content/child/service_worker/service_worker_network_provider.cc#newcode86 content/child/service_worker/service_worker_network_provider.cc:86: while (parent &amp;&amp; should_create_provider_for_window) { On 2016/05/25 01:33:34, falken ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 7 months ago
		(2016-05-25 04:09:45 UTC)
                <a href="#msg15">#15</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-14"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-14"
            ><a href="https://codereview.chromium.org/2009453002/diff/20001/content/child/service_worker/service_worker_network_provider.cc" rel="nofollow">https://codereview.chromium.org/2009453002/diff/20001/content/child/service_w...</a>
File content/child/service_worker/service_worker_network_provider.cc (right):

<a href="https://codereview.chromium.org/2009453002/diff/20001/content/child/service_worker/service_worker_network_provider.cc#newcode86" rel="nofollow">https://codereview.chromium.org/2009453002/diff/20001/content/child/service_w...</a>
content/child/service_worker/service_worker_network_provider.cc:86: while
(parent &amp;&amp; should_create_provider_for_window) {
On 2016/05/25 01:33:34, falken wrote:
&gt; On 2016/05/24 18:06:03, jww wrote:
&gt; &gt; On 2016/05/24 17:03:35, Marijn Kruisselbrink wrote:
&gt; &gt; &gt; On 2016/05/24 at 13:16:37, falken wrote:
&gt; &gt; &gt; &gt; This ancestor walk should probably be some utility function like
&gt; &gt; &gt; Document::isSecureContext(). One subtle difference is we shouldn&#39;t check
for
&gt; &gt; &gt; scheme exceptions like Document does, since those shouldn&#39;t be applied to
&gt; &gt; child
&gt; &gt; &gt; frames, which is what we care about here.
&gt; &gt; &gt; 
&gt; &gt; &gt; Also keep in mind that to truly match what is specified in
&gt; &gt; &gt; <a href="https://w3c.github.io/webappsec-secure-contexts/#settings-object" rel="nofollow">https://w3c.github.io/webappsec-secure-contexts/#settings-object</a> you need
to
&gt; &gt; not
&gt; &gt; &gt; only exclude iframes inside insecure contexts, but also top-level windows
&gt; &gt; opened
&gt; &gt; &gt; by insecure contexts without no-opener.
&gt; &gt; 
&gt; &gt; I have a strong preference to factor this out into a shared utility function
&gt; &gt; that Document and this both use. It will be much easier to track changes,
and
&gt; &gt; even to just track that this check exists at all. This would also probably
&gt; give
&gt; &gt; you a helpful error message to use, no?
&gt; &gt; 
&gt; &gt; Also, why don&#39;t you check if the current origin is potentially trustworthy?
&gt; That
&gt; &gt; is, you only start checking the child frames. I think this is related to
mek&#39;s
&gt; &gt; comment.
&gt; 
&gt; I can&#39;t start with the current frame because document is not yet created.
&gt; getSecurityOrigin() calls frame()-&gt;securityContext()-&gt;getSecurityOrigin(), but
&gt; securityContext() is just document(), so it blows up.
&gt; 
&gt; I probably do need to check the current frame to address mek&#39;s point. Ideas?

Does Chrome currently check for insecure opener when deciding whether a context
is secure? It looks like Document::isSecureContext() doesn&#39;t check it. If I do
window.open from an http page to an https page, I can register a service worker
from the opened page.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    generated"
           style="display: none"
           id="generated-msg16"
           name="15">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(15)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>falken</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-15">
                          Patchset #3 (id:40001) has been deleted
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 7 months ago
		(2016-05-25 08:53:26 UTC)
                <a href="#msg16">#16</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-15"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-15"
            >Patchset #3 (id:40001) has been deleted</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg17"
           name="16">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(16)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>falken</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-16">
                          I&#39;ve refactored out the parent walk. Please take another look. No check is added for ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 7 months ago
		(2016-05-25 09:19:58 UTC)
                <a href="#msg17">#17</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-16"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-16"
            >I&#39;ve refactored out the parent walk. Please take another look.

No check is added for opener since it looks like Chrome doesn&#39;t check that
currently for isSecureContext().

This is failing some tests with --site-per-process enabled. I can reproduce the
failed content_browsertest, but wasn&#39;t able to debug. It looks like it crashes.
The output is just:
[ RUN      ]
NavigationControllerBrowserTest.FrameNavigationEntry_SlowNestedAutoSubframe
[0525/181736:ERROR:kill_posix.cc(82)] Unable to terminate process group 11836:
No such process
[1/1]
NavigationControllerBrowserTest.FrameNavigationEntry_SlowNestedAutoSubframe
(1570 ms)
1 test failed:

No luck with running in gdb/no-sandbox. The test appears to be creating a nested
frame in an not-yet-loaded frame, so maybe it&#39;s incorrect to assume that
frame-&gt;parent() has a security context after all?

<a href="https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_host/navigation_request.cc" rel="nofollow">https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_h...</a>
File content/browser/frame_host/navigation_request.cc (right):

<a href="https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_host/navigation_request.cc#newcode304" rel="nofollow">https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_h...</a>
content/browser/frame_host/navigation_request.cc:304: // TODO(falken): This
should do an isSecureContext check too.
On 2016/05/24 18:06:03, jww wrote:
&gt; To ask a dumb question, why not add that check right now?

I didn&#39;t look too hard, but there&#39;s no WebFrame here. clamy, how hard would it
be to add a check here like the one in service_worker_navigation_provider?

<a href="https://codereview.chromium.org/2009453002/diff/20001/content/child/service_worker/service_worker_network_provider.h" rel="nofollow">https://codereview.chromium.org/2009453002/diff/20001/content/child/service_w...</a>
File content/child/service_worker/service_worker_network_provider.h (right):

<a href="https://codereview.chromium.org/2009453002/diff/20001/content/child/service_worker/service_worker_network_provider.h#newcode21" rel="nofollow">https://codereview.chromium.org/2009453002/diff/20001/content/child/service_w...</a>
content/child/service_worker/service_worker_network_provider.h:21: }
On 2016/05/24 18:06:03, jww wrote:
&gt; nit: &quot;  // namespace blink&quot;

Done.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg18"
           name="17">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(17)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>clamy</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-17">
                          https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_host/navigation_request.cc File content/browser/frame_host/navigation_request.cc (right): https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_host/navigation_request.cc#newcode304 content/browser/frame_host/navigation_request.cc:304: // TODO(falken): This should do an isSecureContext check too. ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 7 months ago
		(2016-05-25 11:21:46 UTC)
                <a href="#msg18">#18</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-17"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-17"
            ><a href="https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_host/navigation_request.cc" rel="nofollow">https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_h...</a>
File content/browser/frame_host/navigation_request.cc (right):

<a href="https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_host/navigation_request.cc#newcode304" rel="nofollow">https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_h...</a>
content/browser/frame_host/navigation_request.cc:304: // TODO(falken): This
should do an isSecureContext check too.
On 2016/05/25 09:19:58, falken wrote:
&gt; On 2016/05/24 18:06:03, jww wrote:
&gt; &gt; To ask a dumb question, why not add that check right now?
&gt; 
&gt; I didn&#39;t look too hard, but there&#39;s no WebFrame here. clamy, how hard would it
&gt; be to add a check here like the one in service_worker_navigation_provider?

If you&#39;re checking for the sandbox flags, you can get them from the
FrameTreeNode that NavigationRequest keeps a pointer to.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg19"
           name="18">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(18)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>falken</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-18">
                          I fixed the site isolation error. alexmos, jww: Can you review this again? https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_host/navigation_request.cc File ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 7 months ago
		(2016-05-26 02:09:49 UTC)
                <a href="#msg19">#19</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-18"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-18"
            >I fixed the site isolation error.

alexmos, jww: Can you review this again?

<a href="https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_host/navigation_request.cc" rel="nofollow">https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_h...</a>
File content/browser/frame_host/navigation_request.cc (right):

<a href="https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_host/navigation_request.cc#newcode304" rel="nofollow">https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_h...</a>
content/browser/frame_host/navigation_request.cc:304: // TODO(falken): This
should do an isSecureContext check too.
On 2016/05/25 11:21:46, clamy wrote:
&gt; On 2016/05/25 09:19:58, falken wrote:
&gt; &gt; On 2016/05/24 18:06:03, jww wrote:
&gt; &gt; &gt; To ask a dumb question, why not add that check right now?
&gt; &gt; 
&gt; &gt; I didn&#39;t look too hard, but there&#39;s no WebFrame here. clamy, how hard would
it
&gt; &gt; be to add a check here like the one in service_worker_navigation_provider?
&gt; 
&gt; If you&#39;re checking for the sandbox flags, you can get them from the
&gt; FrameTreeNode that NavigationRequest keeps a pointer to.

I want to do an ancestor walk over the frame tree, checking their security (I
think FrameTreeNode doesn&#39;t have that info). But I think the latest patch
changed this so service_worker_network_provider can handle the PlzNavigate case
well.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg20"
           name="19">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(19)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>clamy</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-19">
                          https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_host/navigation_request.cc File content/browser/frame_host/navigation_request.cc (right): https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_host/navigation_request.cc#newcode304 content/browser/frame_host/navigation_request.cc:304: // TODO(falken): This should do an isSecureContext check too. ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 7 months ago
		(2016-05-26 15:45:31 UTC)
                <a href="#msg20">#20</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-19"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-19"
            ><a href="https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_host/navigation_request.cc" rel="nofollow">https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_h...</a>
File content/browser/frame_host/navigation_request.cc (right):

<a href="https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_host/navigation_request.cc#newcode304" rel="nofollow">https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_h...</a>
content/browser/frame_host/navigation_request.cc:304: // TODO(falken): This
should do an isSecureContext check too.
On 2016/05/26 02:09:49, falken wrote:
&gt; On 2016/05/25 11:21:46, clamy wrote:
&gt; &gt; On 2016/05/25 09:19:58, falken wrote:
&gt; &gt; &gt; On 2016/05/24 18:06:03, jww wrote:
&gt; &gt; &gt; &gt; To ask a dumb question, why not add that check right now?
&gt; &gt; &gt; 
&gt; &gt; &gt; I didn&#39;t look too hard, but there&#39;s no WebFrame here. clamy, how hard
would
&gt; it
&gt; &gt; &gt; be to add a check here like the one in service_worker_navigation_provider?
&gt; &gt; 
&gt; &gt; If you&#39;re checking for the sandbox flags, you can get them from the
&gt; &gt; FrameTreeNode that NavigationRequest keeps a pointer to.
&gt; 
&gt; I want to do an ancestor walk over the frame tree, checking their security (I
&gt; think FrameTreeNode doesn&#39;t have that info). But I think the latest patch
&gt; changed this so service_worker_network_provider can handle the PlzNavigate
case
&gt; well.

FrameTreeNodes do allow you to walk over the FrameTree. Each of them has a
FrameTreeNodeReplicationState that has some security info, including the origin
(and whether it&#39;s potentially trustworthy). The only thing missing to do a check
that matches the one in RenderFrame is the list of whitelisted urls. I&#39;m not
sure where you&#39;d find that in the renderer.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg21"
           name="20">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(20)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Marijn Kruisselbrink</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-20">
                          drive-by nit https://codereview.chromium.org/2009453002/diff/120001/content/browser/service_worker/service_worker_request_handler.cc File content/browser/service_worker/service_worker_request_handler.cc (right): https://codereview.chromium.org/2009453002/diff/120001/content/browser/service_worker/service_worker_request_handler.cc#newcode219 content/browser/service_worker/service_worker_request_handler.cc:219: if (new_provider_id == kInvalidServiceWorkerVersionId) Shouldn&#39;t this be ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 7 months ago
		(2016-05-26 20:37:11 UTC)
                <a href="#msg21">#21</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-20"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-20"
            >drive-by nit

<a href="https://codereview.chromium.org/2009453002/diff/120001/content/browser/service_worker/service_worker_request_handler.cc" rel="nofollow">https://codereview.chromium.org/2009453002/diff/120001/content/browser/servic...</a>
File content/browser/service_worker/service_worker_request_handler.cc (right):

<a href="https://codereview.chromium.org/2009453002/diff/120001/content/browser/service_worker/service_worker_request_handler.cc#newcode219" rel="nofollow">https://codereview.chromium.org/2009453002/diff/120001/content/browser/servic...</a>
content/browser/service_worker/service_worker_request_handler.cc:219: if
(new_provider_id == kInvalidServiceWorkerVersionId)
Shouldn&#39;t this be kInvalidServiceWorkerProviderId rather than VersionId? I know
they&#39;re all -1, but the types are different.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg22"
           name="21">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(21)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>alexmos</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-21">
                          https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_host/navigation_request.cc File content/browser/frame_host/navigation_request.cc (right): https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_host/navigation_request.cc#newcode304 content/browser/frame_host/navigation_request.cc:304: // TODO(falken): This should do an isSecureContext check too. ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 7 months ago
		(2016-05-26 22:13:35 UTC)
                <a href="#msg22">#22</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-21"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-21"
            ><a href="https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_host/navigation_request.cc" rel="nofollow">https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_h...</a>
File content/browser/frame_host/navigation_request.cc (right):

<a href="https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_host/navigation_request.cc#newcode304" rel="nofollow">https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_h...</a>
content/browser/frame_host/navigation_request.cc:304: // TODO(falken): This
should do an isSecureContext check too.
On 2016/05/26 15:45:31, clamy wrote:
&gt; On 2016/05/26 02:09:49, falken wrote:
&gt; &gt; On 2016/05/25 11:21:46, clamy wrote:
&gt; &gt; &gt; On 2016/05/25 09:19:58, falken wrote:
&gt; &gt; &gt; &gt; On 2016/05/24 18:06:03, jww wrote:
&gt; &gt; &gt; &gt; &gt; To ask a dumb question, why not add that check right now?
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; I didn&#39;t look too hard, but there&#39;s no WebFrame here. clamy, how hard
&gt; would
&gt; &gt; it
&gt; &gt; &gt; &gt; be to add a check here like the one in
service_worker_navigation_provider?
&gt; &gt; &gt; 
&gt; &gt; &gt; If you&#39;re checking for the sandbox flags, you can get them from the
&gt; &gt; &gt; FrameTreeNode that NavigationRequest keeps a pointer to.
&gt; &gt; 
&gt; &gt; I want to do an ancestor walk over the frame tree, checking their security
(I
&gt; &gt; think FrameTreeNode doesn&#39;t have that info). But I think the latest patch
&gt; &gt; changed this so service_worker_network_provider can handle the PlzNavigate
&gt; case
&gt; &gt; well.
&gt; 
&gt; FrameTreeNodes do allow you to walk over the FrameTree. Each of them has a
&gt; FrameTreeNodeReplicationState that has some security info, including the
origin
&gt; (and whether it&#39;s potentially trustworthy). The only thing missing to do a
check
&gt; that matches the one in RenderFrame is the list of whitelisted urls. I&#39;m not
&gt; sure where you&#39;d find that in the renderer.

Yeah, you should be able to follow the FrameTreeNode::parent() chain and do the
check on FrameTreeNode::current_origin().  You&#39;d need to do some additional work
to get isSecureContext&#39;s scheme whitelist here, but seems like
secureContextBypassingSchemes() ultimately comes from 
GetSchemesBypassingSecureContextCheckWhitelist(), which is in chrome/common, so
available in the browser process.  So it&#39;s actually isn&#39;t that bad, but you&#39;d
need some extra delegate plumbing to get to it from content/.

What seems harder is that the origin we have on FrameTreeNodes is a url::Origin,
which doesn&#39;t have all the information from a SecurityOrigin.  We do have a
trustworthiness bit in FrameTreeNode::current_replication_state(),
has_potentially_trustworthy_unique_origin, but it isn&#39;t actually equivalent to
SecurityOrigin::isPotentiallyTrustworthy.  It&#39;s only meaningful for unique
origins (i.e., it indicates potential trustworthiness for a sandboxed iframe),
and you&#39;d still need to either do all the other work in
SecurityOrigin::isPotentiallyTrustworthy() in the browser process, or replicate
the full value of isPotentiallyTrustworthy() from the renderer.  Overall, all
this seems non-trivial and I&#39;d vote for doing it in a separate CL.

CC-ing estark@, who&#39;s worked on isSecureContext plumbing recently and may have
more thoughts on getting it to work from the browser process.

<a href="https://codereview.chromium.org/2009453002/diff/120001/third_party/WebKit/public/web/WebFrame.h" rel="nofollow">https://codereview.chromium.org/2009453002/diff/120001/third_party/WebKit/pub...</a>
File third_party/WebKit/public/web/WebFrame.h (right):

<a href="https://codereview.chromium.org/2009453002/diff/120001/third_party/WebKit/public/web/WebFrame.h#newcode555" rel="nofollow">https://codereview.chromium.org/2009453002/diff/120001/third_party/WebKit/pub...</a>
third_party/WebKit/public/web/WebFrame.h:555: BLINK_EXPORT bool
canHaveSecureChild(WebString&amp; errorMessage) const;
Do we need both this and WebDocument::isSecureContext in the public API?  Seems
WebDocument::isSecureContext is only used in plugins, where it&#39;s called on the
plugin container frame.  Could that just use canHaveSecureChild?

Also, since both uses don&#39;t care about the error message, maybe we don&#39;t need it
in the public API either?</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    generated"
           style="display: none"
           id="generated-msg23"
           name="22">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(22)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>falken</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-22">
                          falken@chromium.org changed reviewers: + raymes@chromium.org
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-05-27 05:47:03 UTC)
                <a href="#msg23">#23</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-22"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-22"
            ><a href="mailto:falken@chromium.org">falken@chromium.org</a> changed reviewers:
+ <a href="mailto:raymes@chromium.org">raymes@chromium.org</a></pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg24"
           name="23">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(23)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>falken</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-23">
                          Thanks! comment-only for now. https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_host/navigation_request.cc File content/browser/frame_host/navigation_request.cc (right): https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_host/navigation_request.cc#newcode304 content/browser/frame_host/navigation_request.cc:304: // TODO(falken): This should do ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-05-27 05:47:04 UTC)
                <a href="#msg24">#24</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-23"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-23"
            >Thanks! comment-only for now.

<a href="https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_host/navigation_request.cc" rel="nofollow">https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_h...</a>
File content/browser/frame_host/navigation_request.cc (right):

<a href="https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_host/navigation_request.cc#newcode304" rel="nofollow">https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_h...</a>
content/browser/frame_host/navigation_request.cc:304: // TODO(falken): This
should do an isSecureContext check too.
On 2016/05/26 22:13:35, alexmos wrote:
&gt; On 2016/05/26 15:45:31, clamy wrote:
&gt; &gt; On 2016/05/26 02:09:49, falken wrote:
&gt; &gt; &gt; On 2016/05/25 11:21:46, clamy wrote:
&gt; &gt; &gt; &gt; On 2016/05/25 09:19:58, falken wrote:
&gt; &gt; &gt; &gt; &gt; On 2016/05/24 18:06:03, jww wrote:
&gt; &gt; &gt; &gt; &gt; &gt; To ask a dumb question, why not add that check right now?
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; I didn&#39;t look too hard, but there&#39;s no WebFrame here. clamy, how hard
&gt; &gt; would
&gt; &gt; &gt; it
&gt; &gt; &gt; &gt; &gt; be to add a check here like the one in
&gt; service_worker_navigation_provider?
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; If you&#39;re checking for the sandbox flags, you can get them from the
&gt; &gt; &gt; &gt; FrameTreeNode that NavigationRequest keeps a pointer to.
&gt; &gt; &gt; 
&gt; &gt; &gt; I want to do an ancestor walk over the frame tree, checking their security
&gt; (I
&gt; &gt; &gt; think FrameTreeNode doesn&#39;t have that info). But I think the latest patch
&gt; &gt; &gt; changed this so service_worker_network_provider can handle the PlzNavigate
&gt; &gt; case
&gt; &gt; &gt; well.
&gt; &gt; 
&gt; &gt; FrameTreeNodes do allow you to walk over the FrameTree. Each of them has a
&gt; &gt; FrameTreeNodeReplicationState that has some security info, including the
&gt; origin
&gt; &gt; (and whether it&#39;s potentially trustworthy). The only thing missing to do a
&gt; check
&gt; &gt; that matches the one in RenderFrame is the list of whitelisted urls. I&#39;m not
&gt; &gt; sure where you&#39;d find that in the renderer.
&gt; 
&gt; Yeah, you should be able to follow the FrameTreeNode::parent() chain and do
the
&gt; check on FrameTreeNode::current_origin().  You&#39;d need to do some additional
work
&gt; to get isSecureContext&#39;s scheme whitelist here, but seems like
&gt; secureContextBypassingSchemes() ultimately comes from 
&gt; GetSchemesBypassingSecureContextCheckWhitelist(), which is in chrome/common,
so
&gt; available in the browser process.  So it&#39;s actually isn&#39;t that bad, but you&#39;d
&gt; need some extra delegate plumbing to get to it from content/.
&gt; 
&gt; What seems harder is that the origin we have on FrameTreeNodes is a
url::Origin,
&gt; which doesn&#39;t have all the information from a SecurityOrigin.  We do have a
&gt; trustworthiness bit in FrameTreeNode::current_replication_state(),
&gt; has_potentially_trustworthy_unique_origin, but it isn&#39;t actually equivalent to
&gt; SecurityOrigin::isPotentiallyTrustworthy.  It&#39;s only meaningful for unique
&gt; origins (i.e., it indicates potential trustworthiness for a sandboxed iframe),
&gt; and you&#39;d still need to either do all the other work in
&gt; SecurityOrigin::isPotentiallyTrustworthy() in the browser process, or
replicate
&gt; the full value of isPotentiallyTrustworthy() from the renderer.  Overall, all
&gt; this seems non-trivial and I&#39;d vote for doing it in a separate CL.
&gt; 
&gt; CC-ing estark@, who&#39;s worked on isSecureContext plumbing recently and may have
&gt; more thoughts on getting it to work from the browser process.

Sorry yes I meant &quot;FrameTreeNode doesn&#39;t have the security info&quot;. But I think
the latest patchset is OK doing the walk renderer-side, for the PlzNavigation
case?

<a href="https://codereview.chromium.org/2009453002/diff/120001/content/browser/service_worker/service_worker_request_handler.cc" rel="nofollow">https://codereview.chromium.org/2009453002/diff/120001/content/browser/servic...</a>
File content/browser/service_worker/service_worker_request_handler.cc (right):

<a href="https://codereview.chromium.org/2009453002/diff/120001/content/browser/service_worker/service_worker_request_handler.cc#newcode219" rel="nofollow">https://codereview.chromium.org/2009453002/diff/120001/content/browser/servic...</a>
content/browser/service_worker/service_worker_request_handler.cc:219: if
(new_provider_id == kInvalidServiceWorkerVersionId)
On 2016/05/26 20:37:11, Marijn Kruisselbrink wrote:
&gt; Shouldn&#39;t this be kInvalidServiceWorkerProviderId rather than VersionId? I
know
&gt; they&#39;re all -1, but the types are different.

Done. Bad autocomplete choice.

<a href="https://codereview.chromium.org/2009453002/diff/120001/third_party/WebKit/public/web/WebFrame.h" rel="nofollow">https://codereview.chromium.org/2009453002/diff/120001/third_party/WebKit/pub...</a>
File third_party/WebKit/public/web/WebFrame.h (right):

<a href="https://codereview.chromium.org/2009453002/diff/120001/third_party/WebKit/public/web/WebFrame.h#newcode555" rel="nofollow">https://codereview.chromium.org/2009453002/diff/120001/third_party/WebKit/pub...</a>
third_party/WebKit/public/web/WebFrame.h:555: BLINK_EXPORT bool
canHaveSecureChild(WebString&amp; errorMessage) const;
On 2016/05/26 22:13:35, alexmos wrote:
&gt; Do we need both this and WebDocument::isSecureContext in the public API? 
Seems
&gt; WebDocument::isSecureContext is only used in plugins, where it&#39;s called on the
&gt; plugin container frame.  Could that just use canHaveSecureChild?

I think there&#39;s two problems there:
1) isSecureContext allows for scheme exceptions and canHaveSecureChild doesn&#39;t.
2) A Document can be frameless (apparently. the comments for WebDocument::frame
say so). So document.isSecureContext() can&#39;t be transformed to
document.frame()-&gt;canHaveSecureChild().

1) could probably be resolved by refactoring to a common method, but 2) looks
more difficult.

To be more specific, IIRC, the plugin situation looks like:
- Frame
  - Document
    ...
      - plugin container (Element)
        - plugin instance

It&#39;s calling isSecureContext on the document. So it can be whitelisted by
scheme. If we instead call Frame::canHaveSecureChild, the scheme whitelist
doesn&#39;t happen. And we might not have a frame.

Probably canHaveSecureChild should be renamed to something like
canHaveSecureChildFrameIgnoringSchemeExceptions.

Having said all that, the plugin check is just for metrics and isn&#39;t a security
check. So maybe it&#39;s ok being slightly &quot;wrong&quot; there? +raymes

&gt; Also, since both uses don&#39;t care about the error message, maybe we don&#39;t need
it
&gt; in the public API either?

I can certainly remove it.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg25"
           name="24">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(24)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>alexmos</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-24">
                          https://codereview.chromium.org/2009453002/diff/120001/third_party/WebKit/public/web/WebFrame.h File third_party/WebKit/public/web/WebFrame.h (right): https://codereview.chromium.org/2009453002/diff/120001/third_party/WebKit/public/web/WebFrame.h#newcode555 third_party/WebKit/public/web/WebFrame.h:555: BLINK_EXPORT bool canHaveSecureChild(WebString&amp; errorMessage) const; On 2016/05/27 05:47:04, falken ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-05-27 22:44:30 UTC)
                <a href="#msg25">#25</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-24"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-24"
            ><a href="https://codereview.chromium.org/2009453002/diff/120001/third_party/WebKit/public/web/WebFrame.h" rel="nofollow">https://codereview.chromium.org/2009453002/diff/120001/third_party/WebKit/pub...</a>
File third_party/WebKit/public/web/WebFrame.h (right):

<a href="https://codereview.chromium.org/2009453002/diff/120001/third_party/WebKit/public/web/WebFrame.h#newcode555" rel="nofollow">https://codereview.chromium.org/2009453002/diff/120001/third_party/WebKit/pub...</a>
third_party/WebKit/public/web/WebFrame.h:555: BLINK_EXPORT bool
canHaveSecureChild(WebString&amp; errorMessage) const;
On 2016/05/27 05:47:04, falken wrote:
&gt; On 2016/05/26 22:13:35, alexmos wrote:
&gt; &gt; Do we need both this and WebDocument::isSecureContext in the public API? 
&gt; Seems
&gt; &gt; WebDocument::isSecureContext is only used in plugins, where it&#39;s called on
the
&gt; &gt; plugin container frame.  Could that just use canHaveSecureChild?
&gt; 
&gt; I think there&#39;s two problems there:
&gt; 1) isSecureContext allows for scheme exceptions and canHaveSecureChild
doesn&#39;t.
&gt; 2) A Document can be frameless (apparently. the comments for
WebDocument::frame
&gt; say so). So document.isSecureContext() can&#39;t be transformed to
&gt; document.frame()-&gt;canHaveSecureChild().
&gt; 
&gt; 1) could probably be resolved by refactoring to a common method, but 2) looks
&gt; more difficult.
&gt; 
&gt; To be more specific, IIRC, the plugin situation looks like:
&gt; - Frame
&gt;   - Document
&gt;     ...
&gt;       - plugin container (Element)
&gt;         - plugin instance
&gt; 
&gt; It&#39;s calling isSecureContext on the document. So it can be whitelisted by
&gt; scheme. If we instead call Frame::canHaveSecureChild, the scheme whitelist
&gt; doesn&#39;t happen. And we might not have a frame.
&gt; 
&gt; Probably canHaveSecureChild should be renamed to something like
&gt; canHaveSecureChildFrameIgnoringSchemeExceptions.
&gt; 
&gt; Having said all that, the plugin check is just for metrics and isn&#39;t a
security
&gt; check. So maybe it&#39;s ok being slightly &quot;wrong&quot; there? +raymes

Yeah, I&#39;m curious if the plugin case cares about scheme exceptions at all. 
Looks like it was added (by raymes@ in r329895) before scheme exceptions were
introduced (by jww@ in r354650), so I&#39;ll let jww@ and raymes@ comment. :)</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg26"
           name="25">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(25)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>jww</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-25">
                          On 2016/05/27 22:44:30, alexmos wrote: &gt; https://codereview.chromium.org/2009453002/diff/120001/third_party/WebKit/public/web/WebFrame.h &gt; File third_party/WebKit/public/web/WebFrame.h (right): &gt; &gt; https://codereview.chromium.org/2009453002/diff/120001/third_party/WebKit/public/web/WebFrame.h#newcode555 &gt; ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-05-28 01:35:14 UTC)
                <a href="#msg26">#26</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-25"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-25"
            >On 2016/05/27 22:44:30, alexmos wrote:
&gt;
<a href="https://codereview.chromium.org/2009453002/diff/120001/third_party/WebKit/public/web/WebFrame.h" rel="nofollow">https://codereview.chromium.org/2009453002/diff/120001/third_party/WebKit/pub...</a>
&gt; File third_party/WebKit/public/web/WebFrame.h (right):
&gt; 
&gt;
<a href="https://codereview.chromium.org/2009453002/diff/120001/third_party/WebKit/public/web/WebFrame.h#newcode555" rel="nofollow">https://codereview.chromium.org/2009453002/diff/120001/third_party/WebKit/pub...</a>
&gt; third_party/WebKit/public/web/WebFrame.h:555: BLINK_EXPORT bool
&gt; canHaveSecureChild(WebString&amp; errorMessage) const;
&gt; On 2016/05/27 05:47:04, falken wrote:
&gt; &gt; On 2016/05/26 22:13:35, alexmos wrote:
&gt; &gt; &gt; Do we need both this and WebDocument::isSecureContext in the public API? 
&gt; &gt; Seems
&gt; &gt; &gt; WebDocument::isSecureContext is only used in plugins, where it&#39;s called on
&gt; the
&gt; &gt; &gt; plugin container frame.  Could that just use canHaveSecureChild?
&gt; &gt; 
&gt; &gt; I think there&#39;s two problems there:
&gt; &gt; 1) isSecureContext allows for scheme exceptions and canHaveSecureChild
&gt; doesn&#39;t.
&gt; &gt; 2) A Document can be frameless (apparently. the comments for
&gt; WebDocument::frame
&gt; &gt; say so). So document.isSecureContext() can&#39;t be transformed to
&gt; &gt; document.frame()-&gt;canHaveSecureChild().
&gt; &gt; 
&gt; &gt; 1) could probably be resolved by refactoring to a common method, but 2)
looks
&gt; &gt; more difficult.
&gt; &gt; 
&gt; &gt; To be more specific, IIRC, the plugin situation looks like:
&gt; &gt; - Frame
&gt; &gt;   - Document
&gt; &gt;     ...
&gt; &gt;       - plugin container (Element)
&gt; &gt;         - plugin instance
&gt; &gt; 
&gt; &gt; It&#39;s calling isSecureContext on the document. So it can be whitelisted by
&gt; &gt; scheme. If we instead call Frame::canHaveSecureChild, the scheme whitelist
&gt; &gt; doesn&#39;t happen. And we might not have a frame.
&gt; &gt; 
&gt; &gt; Probably canHaveSecureChild should be renamed to something like
&gt; &gt; canHaveSecureChildFrameIgnoringSchemeExceptions.
&gt; &gt; 
&gt; &gt; Having said all that, the plugin check is just for metrics and isn&#39;t a
&gt; security
&gt; &gt; check. So maybe it&#39;s ok being slightly &quot;wrong&quot; there? +raymes
&gt; 
&gt; Yeah, I&#39;m curious if the plugin case cares about scheme exceptions at all. 
&gt; Looks like it was added (by raymes@ in r329895) before scheme exceptions were
&gt; introduced (by jww@ in r354650), so I&#39;ll let jww@ and raymes@ comment. :)

Definitely a question for raymes@. I&#39;m very wary of adding a separate security
check that mimics but is slightly different from isSecureContext. Also, why does
canHaveSecureChildFrame ignore scheme exceptions? Namely, this ignores
extensions, I think, and we generally do want to treat them as secure.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg27"
           name="26">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(26)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>jww</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-26">
                          https://codereview.chromium.org/2009453002/diff/20001/content/child/service_worker/service_worker_network_provider.cc File content/child/service_worker/service_worker_network_provider.cc (right): https://codereview.chromium.org/2009453002/diff/20001/content/child/service_worker/service_worker_network_provider.cc#newcode86 content/child/service_worker/service_worker_network_provider.cc:86: while (parent &amp;&amp; should_create_provider_for_window) { On 2016/05/25 04:09:45, falken ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-05-28 01:35:25 UTC)
                <a href="#msg27">#27</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-26"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-26"
            ><a href="https://codereview.chromium.org/2009453002/diff/20001/content/child/service_worker/service_worker_network_provider.cc" rel="nofollow">https://codereview.chromium.org/2009453002/diff/20001/content/child/service_w...</a>
File content/child/service_worker/service_worker_network_provider.cc (right):

<a href="https://codereview.chromium.org/2009453002/diff/20001/content/child/service_worker/service_worker_network_provider.cc#newcode86" rel="nofollow">https://codereview.chromium.org/2009453002/diff/20001/content/child/service_w...</a>
content/child/service_worker/service_worker_network_provider.cc:86: while
(parent &amp;&amp; should_create_provider_for_window) {
On 2016/05/25 04:09:45, falken wrote:
&gt; On 2016/05/25 01:33:34, falken wrote:
&gt; &gt; On 2016/05/24 18:06:03, jww wrote:
&gt; &gt; &gt; On 2016/05/24 17:03:35, Marijn Kruisselbrink wrote:
&gt; &gt; &gt; &gt; On 2016/05/24 at 13:16:37, falken wrote:
&gt; &gt; &gt; &gt; &gt; This ancestor walk should probably be some utility function like
&gt; &gt; &gt; &gt; Document::isSecureContext(). One subtle difference is we shouldn&#39;t check
&gt; for
&gt; &gt; &gt; &gt; scheme exceptions like Document does, since those shouldn&#39;t be applied
to
&gt; &gt; &gt; child
&gt; &gt; &gt; &gt; frames, which is what we care about here.
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; Also keep in mind that to truly match what is specified in
&gt; &gt; &gt; &gt; <a href="https://w3c.github.io/webappsec-secure-contexts/#settings-object" rel="nofollow">https://w3c.github.io/webappsec-secure-contexts/#settings-object</a> you
need
&gt; to
&gt; &gt; &gt; not
&gt; &gt; &gt; &gt; only exclude iframes inside insecure contexts, but also top-level
windows
&gt; &gt; &gt; opened
&gt; &gt; &gt; &gt; by insecure contexts without no-opener.
&gt; &gt; &gt; 
&gt; &gt; &gt; I have a strong preference to factor this out into a shared utility
function
&gt; &gt; &gt; that Document and this both use. It will be much easier to track changes,
&gt; and
&gt; &gt; &gt; even to just track that this check exists at all. This would also probably
&gt; &gt; give
&gt; &gt; &gt; you a helpful error message to use, no?
&gt; &gt; &gt; 
&gt; &gt; &gt; Also, why don&#39;t you check if the current origin is potentially
trustworthy?
&gt; &gt; That
&gt; &gt; &gt; is, you only start checking the child frames. I think this is related to
&gt; mek&#39;s
&gt; &gt; &gt; comment.
&gt; &gt; 
&gt; &gt; I can&#39;t start with the current frame because document is not yet created.
&gt; &gt; getSecurityOrigin() calls frame()-&gt;securityContext()-&gt;getSecurityOrigin(),
but
&gt; &gt; securityContext() is just document(), so it blows up.
&gt; &gt; 
&gt; &gt; I probably do need to check the current frame to address mek&#39;s point. Ideas?
&gt; 
&gt; Does Chrome currently check for insecure opener when deciding whether a
context
&gt; is secure? It looks like Document::isSecureContext() doesn&#39;t check it. If I do
&gt; window.open from an http page to an https page, I can register a service
worker
&gt; from the opened page.

That&#39;s a great question. I believe the answer is &quot;no&quot;, we don&#39;t do that yet.

<a href="https://codereview.chromium.org/2009453002/diff/120001/third_party/WebKit/Source/web/WebFrame.cpp" rel="nofollow">https://codereview.chromium.org/2009453002/diff/120001/third_party/WebKit/Sou...</a>
File third_party/WebKit/Source/web/WebFrame.cpp (right):

<a href="https://codereview.chromium.org/2009453002/diff/120001/third_party/WebKit/Source/web/WebFrame.cpp#newcode276" rel="nofollow">https://codereview.chromium.org/2009453002/diff/120001/third_party/WebKit/Sou...</a>
third_party/WebKit/Source/web/WebFrame.cpp:276: bool
WebFrame::canHaveSecureChild(WebString&amp; errorMessage) const
Can you add some unit tests to this, similar to what we have for
SecurityOrigin::isPotentiallyTrustworthy()?</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg28"
           name="27">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(27)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>raymes</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-27">
                          +cc timwillis https://codereview.chromium.org/2009453002/diff/120001/third_party/WebKit/public/web/WebFrame.h File third_party/WebKit/public/web/WebFrame.h (right): https://codereview.chromium.org/2009453002/diff/120001/third_party/WebKit/public/web/WebFrame.h#newcode555 third_party/WebKit/public/web/WebFrame.h:555: BLINK_EXPORT bool canHaveSecureChild(WebString&amp; errorMessage) const; The plugin ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-05-30 01:08:08 UTC)
                <a href="#msg28">#28</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-27"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-27"
            >+cc timwillis

<a href="https://codereview.chromium.org/2009453002/diff/120001/third_party/WebKit/public/web/WebFrame.h" rel="nofollow">https://codereview.chromium.org/2009453002/diff/120001/third_party/WebKit/pub...</a>
File third_party/WebKit/public/web/WebFrame.h (right):

<a href="https://codereview.chromium.org/2009453002/diff/120001/third_party/WebKit/public/web/WebFrame.h#newcode555" rel="nofollow">https://codereview.chromium.org/2009453002/diff/120001/third_party/WebKit/pub...</a>
third_party/WebKit/public/web/WebFrame.h:555: BLINK_EXPORT bool
canHaveSecureChild(WebString&amp; errorMessage) const;
The plugin case is just for metrics - we were just testing how frequently
plugins were loaded in secure contexts (that is, it&#39;s src is https and it&#39;s
parents are https). If we get something which approximates that it should be
fine especially if it simplifies code.

jww: Do we even still need those metrics? timwillis may know.

The metrics are: Pepper.PluginContextSecurity.TCPConnect and
Pepper.PluginContextSecurity.UDPBind</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg29"
           name="28">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(28)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>falken</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-28">
                          I think jww is right: it&#39;s incorrect to ignore scheme exceptions here, since extension service ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-05-30 10:20:53 UTC)
                <a href="#msg29">#29</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-28"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-28"
            >I think jww is right: it&#39;s incorrect to ignore scheme exceptions here, since
extension service workers are expected to function inside insecure contexts.

That means the current document url must be taken into account. I’m wary,
though, of attempting to do so in SWNetworkProvider before we have a document.
One problem is redirects. If a chrome://extension could redirect to an https
context (it probably can’t), something could sneak past the check with:
1. An http frame embeds a frame with a scheme exception 
2. SWNetworkProvider treats the frame as secure, and sends the IPC to create a
SWProviderHost
3. SWControlleeRequestHandler intercepts the request
4. The request redirects to an https resource
SWControlleeRequestHandler continues handling the request. It has no idea that
it’s no longer secure.

It’s also weird that empirically the datasource URL is often empty when
SWNetworkProvider is created. So seems too early to do the complete check ala
Document-&gt;isSecureContext().

I propose:
SWNetworkProvider does the ancestor walk and sends is_parent_frame_secure in the
IPC, where it’s stored by SWProviderHost
SWControlleeRequestHandler combines that bit and the document url to check
whether the context is secure.

The latest patchset is a WIPish patch that does that. It adds a test that
extensions work too. WDYT of this approach?

I understand the concerns about adding a separate security check that mimics but
is slightly different from isSecureContext. At least for the web layer, I’m
happy removing WebDocument::isSecureContext() if that’s OK for the plugin
usecase.

I’m also wondering about frame reparenting. Is it possible to go from a secure
context to an insecure one, without triggering a reload? I did some
investigation and it looks like moving an iframe will trigger a reload (I
believe due to <a href="https://bugs.webkit.org/show_bug.cgi?id=81590" rel="nofollow">https://bugs.webkit.org/show_bug.cgi?id=81590</a> following
<a href="https://bugs.webkit.org/show_bug.cgi?id=32848" rel="nofollow">https://bugs.webkit.org/show_bug.cgi?id=32848</a>)

<a href="https://codereview.chromium.org/2009453002/diff/120001/third_party/WebKit/Source/web/WebFrame.cpp" rel="nofollow">https://codereview.chromium.org/2009453002/diff/120001/third_party/WebKit/Sou...</a>
File third_party/WebKit/Source/web/WebFrame.cpp (right):

<a href="https://codereview.chromium.org/2009453002/diff/120001/third_party/WebKit/Source/web/WebFrame.cpp#newcode276" rel="nofollow">https://codereview.chromium.org/2009453002/diff/120001/third_party/WebKit/Sou...</a>
third_party/WebKit/Source/web/WebFrame.cpp:276: bool
WebFrame::canHaveSecureChild(WebString&amp; errorMessage) const
On 2016/05/28 01:35:25, jww wrote:
&gt; Can you add some unit tests to this, similar to what we have for
&gt; SecurityOrigin::isPotentiallyTrustworthy()?

Didn&#39;t get to this in the latest patchset, but will do this.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg30"
           name="29">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(29)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>clamy</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-29">
                          https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_host/navigation_request.cc File content/browser/frame_host/navigation_request.cc (right): https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_host/navigation_request.cc#newcode304 content/browser/frame_host/navigation_request.cc:304: // TODO(falken): This should do an isSecureContext check too. ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-05-30 16:22:42 UTC)
                <a href="#msg30">#30</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-29"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-29"
            ><a href="https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_host/navigation_request.cc" rel="nofollow">https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_h...</a>
File content/browser/frame_host/navigation_request.cc (right):

<a href="https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_host/navigation_request.cc#newcode304" rel="nofollow">https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_h...</a>
content/browser/frame_host/navigation_request.cc:304: // TODO(falken): This
should do an isSecureContext check too.
On 2016/05/27 05:47:03, falken wrote:
&gt; On 2016/05/26 22:13:35, alexmos wrote:
&gt; &gt; On 2016/05/26 15:45:31, clamy wrote:
&gt; &gt; &gt; On 2016/05/26 02:09:49, falken wrote:
&gt; &gt; &gt; &gt; On 2016/05/25 11:21:46, clamy wrote:
&gt; &gt; &gt; &gt; &gt; On 2016/05/25 09:19:58, falken wrote:
&gt; &gt; &gt; &gt; &gt; &gt; On 2016/05/24 18:06:03, jww wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; To ask a dumb question, why not add that check right now?
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; I didn&#39;t look too hard, but there&#39;s no WebFrame here. clamy, how
hard
&gt; &gt; &gt; would
&gt; &gt; &gt; &gt; it
&gt; &gt; &gt; &gt; &gt; &gt; be to add a check here like the one in
&gt; &gt; service_worker_navigation_provider?
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; If you&#39;re checking for the sandbox flags, you can get them from the
&gt; &gt; &gt; &gt; &gt; FrameTreeNode that NavigationRequest keeps a pointer to.
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; I want to do an ancestor walk over the frame tree, checking their
security
&gt; &gt; (I
&gt; &gt; &gt; &gt; think FrameTreeNode doesn&#39;t have that info). But I think the latest
patch
&gt; &gt; &gt; &gt; changed this so service_worker_network_provider can handle the
PlzNavigate
&gt; &gt; &gt; case
&gt; &gt; &gt; &gt; well.
&gt; &gt; &gt; 
&gt; &gt; &gt; FrameTreeNodes do allow you to walk over the FrameTree. Each of them has a
&gt; &gt; &gt; FrameTreeNodeReplicationState that has some security info, including the
&gt; &gt; origin
&gt; &gt; &gt; (and whether it&#39;s potentially trustworthy). The only thing missing to do a
&gt; &gt; check
&gt; &gt; &gt; that matches the one in RenderFrame is the list of whitelisted urls. I&#39;m
not
&gt; &gt; &gt; sure where you&#39;d find that in the renderer.
&gt; &gt; 
&gt; &gt; Yeah, you should be able to follow the FrameTreeNode::parent() chain and do
&gt; the
&gt; &gt; check on FrameTreeNode::current_origin().  You&#39;d need to do some additional
&gt; work
&gt; &gt; to get isSecureContext&#39;s scheme whitelist here, but seems like
&gt; &gt; secureContextBypassingSchemes() ultimately comes from 
&gt; &gt; GetSchemesBypassingSecureContextCheckWhitelist(), which is in chrome/common,
&gt; so
&gt; &gt; available in the browser process.  So it&#39;s actually isn&#39;t that bad, but
you&#39;d
&gt; &gt; need some extra delegate plumbing to get to it from content/.
&gt; &gt; 
&gt; &gt; What seems harder is that the origin we have on FrameTreeNodes is a
&gt; url::Origin,
&gt; &gt; which doesn&#39;t have all the information from a SecurityOrigin.  We do have a
&gt; &gt; trustworthiness bit in FrameTreeNode::current_replication_state(),
&gt; &gt; has_potentially_trustworthy_unique_origin, but it isn&#39;t actually equivalent
to
&gt; &gt; SecurityOrigin::isPotentiallyTrustworthy.  It&#39;s only meaningful for unique
&gt; &gt; origins (i.e., it indicates potential trustworthiness for a sandboxed
iframe),
&gt; &gt; and you&#39;d still need to either do all the other work in
&gt; &gt; SecurityOrigin::isPotentiallyTrustworthy() in the browser process, or
&gt; replicate
&gt; &gt; the full value of isPotentiallyTrustworthy() from the renderer.  Overall,
all
&gt; &gt; this seems non-trivial and I&#39;d vote for doing it in a separate CL.
&gt; &gt; 
&gt; &gt; CC-ing estark@, who&#39;s worked on isSecureContext plumbing recently and may
have
&gt; &gt; more thoughts on getting it to work from the browser process.
&gt; 
&gt; Sorry yes I meant &quot;FrameTreeNode doesn&#39;t have the security info&quot;. But I think
&gt; the latest patchset is OK doing the walk renderer-side, for the PlzNavigation
&gt; case?

Probably. In any case, we&#39;ll have to make significant changes to how PlzNavigate
works with ServiceWorker, so it&#39;s quite possible that this code will go away
anyway.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg31"
           name="30">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(30)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>jww</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-30">
                          On 2016/05/30 16:22:42, clamy wrote: &gt; https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_host/navigation_request.cc &gt; File content/browser/frame_host/navigation_request.cc (right): &gt; &gt; https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_host/navigation_request.cc#newcode304 &gt; ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-05-31 19:26:41 UTC)
                <a href="#msg31">#31</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-30"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-30"
            >On 2016/05/30 16:22:42, clamy wrote:
&gt;
<a href="https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_host/navigation_request.cc" rel="nofollow">https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_h...</a>
&gt; File content/browser/frame_host/navigation_request.cc (right):
&gt; 
&gt;
<a href="https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_host/navigation_request.cc#newcode304" rel="nofollow">https://codereview.chromium.org/2009453002/diff/20001/content/browser/frame_h...</a>
&gt; content/browser/frame_host/navigation_request.cc:304: // TODO(falken): This
&gt; should do an isSecureContext check too.
&gt; On 2016/05/27 05:47:03, falken wrote:
&gt; &gt; On 2016/05/26 22:13:35, alexmos wrote:
&gt; &gt; &gt; On 2016/05/26 15:45:31, clamy wrote:
&gt; &gt; &gt; &gt; On 2016/05/26 02:09:49, falken wrote:
&gt; &gt; &gt; &gt; &gt; On 2016/05/25 11:21:46, clamy wrote:
&gt; &gt; &gt; &gt; &gt; &gt; On 2016/05/25 09:19:58, falken wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; On 2016/05/24 18:06:03, jww wrote:
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; To ask a dumb question, why not add that check right now?
&gt; &gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; &gt; I didn&#39;t look too hard, but there&#39;s no WebFrame here. clamy, how
&gt; hard
&gt; &gt; &gt; &gt; would
&gt; &gt; &gt; &gt; &gt; it
&gt; &gt; &gt; &gt; &gt; &gt; &gt; be to add a check here like the one in
&gt; &gt; &gt; service_worker_navigation_provider?
&gt; &gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; &gt; If you&#39;re checking for the sandbox flags, you can get them from the
&gt; &gt; &gt; &gt; &gt; &gt; FrameTreeNode that NavigationRequest keeps a pointer to.
&gt; &gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; &gt; I want to do an ancestor walk over the frame tree, checking their
&gt; security
&gt; &gt; &gt; (I
&gt; &gt; &gt; &gt; &gt; think FrameTreeNode doesn&#39;t have that info). But I think the latest
&gt; patch
&gt; &gt; &gt; &gt; &gt; changed this so service_worker_network_provider can handle the
&gt; PlzNavigate
&gt; &gt; &gt; &gt; case
&gt; &gt; &gt; &gt; &gt; well.
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; FrameTreeNodes do allow you to walk over the FrameTree. Each of them has
a
&gt; &gt; &gt; &gt; FrameTreeNodeReplicationState that has some security info, including the
&gt; &gt; &gt; origin
&gt; &gt; &gt; &gt; (and whether it&#39;s potentially trustworthy). The only thing missing to do
a
&gt; &gt; &gt; check
&gt; &gt; &gt; &gt; that matches the one in RenderFrame is the list of whitelisted urls. I&#39;m
&gt; not
&gt; &gt; &gt; &gt; sure where you&#39;d find that in the renderer.
&gt; &gt; &gt; 
&gt; &gt; &gt; Yeah, you should be able to follow the FrameTreeNode::parent() chain and
do
&gt; &gt; the
&gt; &gt; &gt; check on FrameTreeNode::current_origin().  You&#39;d need to do some
additional
&gt; &gt; work
&gt; &gt; &gt; to get isSecureContext&#39;s scheme whitelist here, but seems like
&gt; &gt; &gt; secureContextBypassingSchemes() ultimately comes from 
&gt; &gt; &gt; GetSchemesBypassingSecureContextCheckWhitelist(), which is in
chrome/common,
&gt; &gt; so
&gt; &gt; &gt; available in the browser process.  So it&#39;s actually isn&#39;t that bad, but
&gt; you&#39;d
&gt; &gt; &gt; need some extra delegate plumbing to get to it from content/.
&gt; &gt; &gt; 
&gt; &gt; &gt; What seems harder is that the origin we have on FrameTreeNodes is a
&gt; &gt; url::Origin,
&gt; &gt; &gt; which doesn&#39;t have all the information from a SecurityOrigin.  We do have
a
&gt; &gt; &gt; trustworthiness bit in FrameTreeNode::current_replication_state(),
&gt; &gt; &gt; has_potentially_trustworthy_unique_origin, but it isn&#39;t actually
equivalent
&gt; to
&gt; &gt; &gt; SecurityOrigin::isPotentiallyTrustworthy.  It&#39;s only meaningful for unique
&gt; &gt; &gt; origins (i.e., it indicates potential trustworthiness for a sandboxed
&gt; iframe),
&gt; &gt; &gt; and you&#39;d still need to either do all the other work in
&gt; &gt; &gt; SecurityOrigin::isPotentiallyTrustworthy() in the browser process, or
&gt; &gt; replicate
&gt; &gt; &gt; the full value of isPotentiallyTrustworthy() from the renderer.  Overall,
&gt; all
&gt; &gt; &gt; this seems non-trivial and I&#39;d vote for doing it in a separate CL.
&gt; &gt; &gt; 
&gt; &gt; &gt; CC-ing estark@, who&#39;s worked on isSecureContext plumbing recently and may
&gt; have
&gt; &gt; &gt; more thoughts on getting it to work from the browser process.
&gt; &gt; 
&gt; &gt; Sorry yes I meant &quot;FrameTreeNode doesn&#39;t have the security info&quot;. But I
think
&gt; &gt; the latest patchset is OK doing the walk renderer-side, for the
PlzNavigation
&gt; &gt; case?
&gt; 
&gt; Probably. In any case, we&#39;ll have to make significant changes to how
PlzNavigate
&gt; works with ServiceWorker, so it&#39;s quite possible that this code will go away
&gt; anyway.

raymes@: Yes, I think we still care about those metrics since they affect the
future of HTTPS restrictions on Pepper plugins, which we could tighten
eventually, depending on these types of metrics.

falken: That sounds good to me, although I think alexmos@ really needs to give
confirmation.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg32"
           name="31">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(31)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>alexmos</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-31">
                          &gt; falken: That sounds good to me, although I think alexmos@ really needs to give ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-01 01:30:10 UTC)
                <a href="#msg32">#32</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-31"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-31"
            >&gt; falken: That sounds good to me, although I think alexmos@ really needs to give
&gt; confirmation.

Yes, that plan sounds ok.  Since you&#39;re already doing part of the check on the
browser process side, I do wonder if it&#39;s just easier to also move the ancestor
walk there now (and use origins on FrameTreeNodes).  You&#39;d need to replicate
isPotentiallyTrustworthy values for FrameTreeNode origins, but that might
actually be easier than what you had to add for is_parent_frame_secure.  Or does
ServiceWorkerControlleeRequestHandler::PrepareForMainResource run on the IO
thread, in which case that&#39;s not possible?  (Sorry, I&#39;m out of my depth for 
service worker machinery.)</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    generated"
           style="display: none"
           id="generated-msg33"
           name="32">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(32)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>alexmos</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-32">
                          alexmos@chromium.org changed reviewers: + dcheng@chromium.org
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-01 01:34:20 UTC)
                <a href="#msg33">#33</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-32"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-32"
            ><a href="mailto:alexmos@chromium.org">alexmos@chromium.org</a> changed reviewers:
+ <a href="mailto:dcheng@chromium.org">dcheng@chromium.org</a></pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg34"
           name="33">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(33)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>alexmos</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-33">
                          &gt; I’m also wondering about frame reparenting. Is it possible to go from a secure ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-01 01:34:21 UTC)
                <a href="#msg34">#34</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-33"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-33"
            >&gt; I’m also wondering about frame reparenting. Is it possible to go from a secure
&gt; context to an insecure one, without triggering a reload? I did some
&gt; investigation and it looks like moving an iframe will trigger a reload (I
&gt; believe due to <a href="https://bugs.webkit.org/show_bug.cgi?id=81590" rel="nofollow">https://bugs.webkit.org/show_bug.cgi?id=81590</a> following
&gt; <a href="https://bugs.webkit.org/show_bug.cgi?id=32848" rel="nofollow">https://bugs.webkit.org/show_bug.cgi?id=32848</a>)

Right, I don&#39;t think that should be possible without a reload, as otherwise all
sorts of things would break in the OOPIF world, but +dcheng@ to verify (I wasn&#39;t
aware we even supported this at some point).</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg35"
           name="34">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(34)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Marijn Kruisselbrink</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-34">
                          On 2016/06/01 at 01:34:21, alexmos wrote: &gt; &gt; I’m also wondering about frame reparenting. Is ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-01 01:47:55 UTC)
                <a href="#msg35">#35</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-34"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-34"
            >On 2016/06/01 at 01:34:21, alexmos wrote:
&gt; &gt; I’m also wondering about frame reparenting. Is it possible to go from a
secure
&gt; &gt; context to an insecure one, without triggering a reload? I did some
&gt; &gt; investigation and it looks like moving an iframe will trigger a reload (I
&gt; &gt; believe due to <a href="https://bugs.webkit.org/show_bug.cgi?id=81590" rel="nofollow">https://bugs.webkit.org/show_bug.cgi?id=81590</a> following
&gt; &gt; <a href="https://bugs.webkit.org/show_bug.cgi?id=32848" rel="nofollow">https://bugs.webkit.org/show_bug.cgi?id=32848</a>)
&gt; 
&gt; Right, I don&#39;t think that should be possible without a reload, as otherwise
all sorts of things would break in the OOPIF world, but +dcheng@ to verify (I
wasn&#39;t aware we even supported this at some point).

On the subject of going from a secure to an insecure comment, at some point it
was discussed that maybe setting window.domain could be made mutually exclusive
with secure contexts (setting document.domain would make a secure context
insecure, and accessing any API that would require a secure context would make
setting window.domain impossible). But I don&#39;t believe that anybody is actively
pursuing that idea. And it would probably also be really hard to actually
implement, so probably not worth worrying about.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg36"
           name="35">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(35)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>falken</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-35">
                          On 2016/06/01 01:30:10, alexmos wrote: &gt; &gt; falken: That sounds good to me, although I ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-01 03:20:11 UTC)
                <a href="#msg36">#36</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-35"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-35"
            >On 2016/06/01 01:30:10, alexmos wrote:
&gt; &gt; falken: That sounds good to me, although I think alexmos@ really needs to
give
&gt; &gt; confirmation.
&gt; 
&gt; Yes, that plan sounds ok.  Since you&#39;re already doing part of the check on the
&gt; browser process side, I do wonder if it&#39;s just easier to also move the
ancestor
&gt; walk there now (and use origins on FrameTreeNodes).  You&#39;d need to replicate
&gt; isPotentiallyTrustworthy values for FrameTreeNode origins, but that might
&gt; actually be easier than what you had to add for is_parent_frame_secure.  Or
does
&gt; ServiceWorkerControlleeRequestHandler::PrepareForMainResource run on the IO
&gt; thread, in which case that&#39;s not possible?  (Sorry, I&#39;m out of my depth for 
&gt; service worker machinery.)

Yep, all of ServiceWorkerControlleeRequestHandler is on the IO thread. Are
FrameTreeNodes used on the UI thread only?

I&#39;ll push forward with the is_parent_frame_secure approach.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg37"
           name="36">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(36)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>falken</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-36">
                          alexmos, jww: please review again I decided not to change the plugin callsite since I ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-01 07:14:44 UTC)
                <a href="#msg37">#37</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-36"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-36"
            >alexmos, jww: please review again

I decided not to change the plugin callsite since I think people shouldn&#39;t try
to think of WebFrame::canChildBeSecure as a check for whether a context is
secure. I put some explanatory comments above canChildBeSecure.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg38"
           name="37">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(37)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>falken</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-37">
                          alexmos, jww: ping
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-02 01:13:06 UTC)
                <a href="#msg38">#38</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-37"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-37"
            >alexmos, jww: ping</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg39"
           name="38">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(38)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Marijn Kruisselbrink</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-38">
                          drive-by suggestion, as I&#39;m trying to build on top of this change https://codereview.chromium.org/2009453002/diff/220001/content/browser/service_worker/service_worker_controllee_request_handler.cc File content/browser/service_worker/service_worker_controllee_request_handler.cc ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-02 22:44:44 UTC)
                <a href="#msg39">#39</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-38"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-38"
            >drive-by suggestion, as I&#39;m trying to build on top of this change

<a href="https://codereview.chromium.org/2009453002/diff/220001/content/browser/service_worker/service_worker_controllee_request_handler.cc" rel="nofollow">https://codereview.chromium.org/2009453002/diff/220001/content/browser/servic...</a>
File content/browser/service_worker/service_worker_controllee_request_handler.cc
(right):

<a href="https://codereview.chromium.org/2009453002/diff/220001/content/browser/service_worker/service_worker_controllee_request_handler.cc#newcode220" rel="nofollow">https://codereview.chromium.org/2009453002/diff/220001/content/browser/servic...</a>
content/browser/service_worker/service_worker_controllee_request_handler.cc:220:
if (schemes.find(provider_host_-&gt;document_url().scheme()) ==
Would it make sense to combine both the is_parent_frame_secure and the checking
for whitelisted schemes into one helper method somewhere in SWProviderHost? I
did something like that in <a href="https://codereview.chromium.org/1914593002" rel="nofollow">https://codereview.chromium.org/1914593002</a> where I&#39;m
(still very much WIP) trying to apply the same secure context limitations to
when Link headers are allowed to install service workers for navigations.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message  approval  "
           
           id="msg40"
           name="39">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(39)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>jww</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-39">
                          On 2016/06/02 22:44:44, Marijn Kruisselbrink wrote: &gt; drive-by suggestion, as I&#39;m trying to build on ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-02 22:56:45 UTC)
                <a href="#msg40">#40</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-39"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-39"
            >On 2016/06/02 22:44:44, Marijn Kruisselbrink wrote:
&gt; drive-by suggestion, as I&#39;m trying to build on top of this change
&gt; 
&gt;
<a href="https://codereview.chromium.org/2009453002/diff/220001/content/browser/service_worker/service_worker_controllee_request_handler.cc" rel="nofollow">https://codereview.chromium.org/2009453002/diff/220001/content/browser/servic...</a>
&gt; File
content/browser/service_worker/service_worker_controllee_request_handler.cc
&gt; (right):
&gt; 
&gt;
<a href="https://codereview.chromium.org/2009453002/diff/220001/content/browser/service_worker/service_worker_controllee_request_handler.cc#newcode220" rel="nofollow">https://codereview.chromium.org/2009453002/diff/220001/content/browser/servic...</a>
&gt;
content/browser/service_worker/service_worker_controllee_request_handler.cc:220:
&gt; if (schemes.find(provider_host_-&gt;document_url().scheme()) ==
&gt; Would it make sense to combine both the is_parent_frame_secure and the
checking
&gt; for whitelisted schemes into one helper method somewhere in SWProviderHost? I
&gt; did something like that in <a href="https://codereview.chromium.org/1914593002" rel="nofollow">https://codereview.chromium.org/1914593002</a> where
I&#39;m
&gt; (still very much WIP) trying to apply the same secure context limitations to
&gt; when Link headers are allowed to install service workers for navigations.

lgtm, but please do what for alexmos&#39;s review as well.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg41"
           name="40">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(40)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>jww</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-40">
                          On 2016/06/02 22:56:45, jww wrote: &gt; On 2016/06/02 22:44:44, Marijn Kruisselbrink wrote: &gt; &gt; drive-by ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-02 22:57:07 UTC)
                <a href="#msg41">#41</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-40"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-40"
            >On 2016/06/02 22:56:45, jww wrote:
&gt; On 2016/06/02 22:44:44, Marijn Kruisselbrink wrote:
&gt; &gt; drive-by suggestion, as I&#39;m trying to build on top of this change
&gt; &gt; 
&gt; &gt;
&gt;
<a href="https://codereview.chromium.org/2009453002/diff/220001/content/browser/service_worker/service_worker_controllee_request_handler.cc" rel="nofollow">https://codereview.chromium.org/2009453002/diff/220001/content/browser/servic...</a>
&gt; &gt; File
&gt; content/browser/service_worker/service_worker_controllee_request_handler.cc
&gt; &gt; (right):
&gt; &gt; 
&gt; &gt;
&gt;
<a href="https://codereview.chromium.org/2009453002/diff/220001/content/browser/service_worker/service_worker_controllee_request_handler.cc#newcode220" rel="nofollow">https://codereview.chromium.org/2009453002/diff/220001/content/browser/servic...</a>
&gt; &gt;
&gt;
content/browser/service_worker/service_worker_controllee_request_handler.cc:220:
&gt; &gt; if (schemes.find(provider_host_-&gt;document_url().scheme()) ==
&gt; &gt; Would it make sense to combine both the is_parent_frame_secure and the
&gt; checking
&gt; &gt; for whitelisted schemes into one helper method somewhere in SWProviderHost?
I
&gt; &gt; did something like that in <a href="https://codereview.chromium.org/1914593002" rel="nofollow">https://codereview.chromium.org/1914593002</a> where
&gt; I&#39;m
&gt; &gt; (still very much WIP) trying to apply the same secure context limitations to
&gt; &gt; when Link headers are allowed to install service workers for navigations.
&gt; 
&gt; lgtm, but please do what for alexmos&#39;s review as well.

&quot;what&quot; -&gt; &quot;wait&quot;</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message  approval  "
           
           id="msg42"
           name="41">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(41)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>alexmos</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-41">
                          &gt; Yep, all of ServiceWorkerControlleeRequestHandler is on the IO thread. Are &gt; FrameTreeNodes used on ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-02 23:54:47 UTC)
                <a href="#msg42">#42</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-41"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-41"
            >&gt; Yep, all of ServiceWorkerControlleeRequestHandler is on the IO thread. Are
&gt; FrameTreeNodes used on the UI thread only?

Yes.  We&#39;re planning to make some of this information available on the IO thread
(via FrameIOData, see some related discussion at
<a href="https://groups.google.com/a/chromium.org/d/msg/site-isolation-dev/L1nkukFURro/VkpjyJk-BgAJ" rel="nofollow">https://groups.google.com/a/chromium.org/d/msg/site-isolation-dev/L1nkukFURro...</a>),
and I hope this will allow us to clean this up and move that check entirely to
the browser process.  That&#39;s a longer-term effort though, so I think it&#39;s ok to
use this approach in the meantime.  LGTM with a few nits below.

<a href="https://codereview.chromium.org/2009453002/diff/220001/chrome/browser/extensions/service_worker_apitest.cc" rel="nofollow">https://codereview.chromium.org/2009453002/diff/220001/chrome/browser/extensi...</a>
File chrome/browser/extensions/service_worker_apitest.cc (right):

<a href="https://codereview.chromium.org/2009453002/diff/220001/chrome/browser/extensions/service_worker_apitest.cc#newcode681" rel="nofollow">https://codereview.chromium.org/2009453002/diff/220001/chrome/browser/extensi...</a>
chrome/browser/extensions/service_worker_apitest.cc:681:
WebAccessibleResourcesInsecureIframe) {
Can you run this through the linux_site_isolation trybot, just to make sure this
is working correctly with --site-per-process?

<a href="https://codereview.chromium.org/2009453002/diff/220001/chrome/browser/extensions/service_worker_apitest.cc#newcode695" rel="nofollow">https://codereview.chromium.org/2009453002/diff/220001/chrome/browser/extensi...</a>
chrome/browser/extensions/service_worker_apitest.cc:695: page_url =
page_url.ReplaceComponents(replace_host_and_scheme);
Why not just use embedded_test_server()-&gt;GetURL(&quot;a.com&quot;, &quot;/rest/of/path&quot;)?

<a href="https://codereview.chromium.org/2009453002/diff/220001/content/browser/service_worker/service_worker_request_handler.cc" rel="nofollow">https://codereview.chromium.org/2009453002/diff/220001/content/browser/servic...</a>
File content/browser/service_worker/service_worker_request_handler.cc (right):

<a href="https://codereview.chromium.org/2009453002/diff/220001/content/browser/service_worker/service_worker_request_handler.cc#newcode219" rel="nofollow">https://codereview.chromium.org/2009453002/diff/220001/content/browser/servic...</a>
content/browser/service_worker/service_worker_request_handler.cc:219: if
(new_provider_id == kInvalidServiceWorkerVersionId)
Why is this needed?

<a href="https://codereview.chromium.org/2009453002/diff/220001/content/common/service_worker/service_worker_messages.h" rel="nofollow">https://codereview.chromium.org/2009453002/diff/220001/content/common/service...</a>
File content/common/service_worker/service_worker_messages.h (right):

<a href="https://codereview.chromium.org/2009453002/diff/220001/content/common/service_worker/service_worker_messages.h#newcode205" rel="nofollow">https://codereview.chromium.org/2009453002/diff/220001/content/common/service...</a>
content/common/service_worker/service_worker_messages.h:205: // (Service
Workers).
Update this comment to describe |is_parent_frame_secure|.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    generated"
           style="display: none"
           id="generated-msg43"
           name="42">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(42)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>falken</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-42">
                          falken@chromium.org changed reviewers: + rdevlin.cronin@chromium.org, tsepez@chromium.org
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-03 08:22:03 UTC)
                <a href="#msg43">#43</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-42"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-42"
            ><a href="mailto:falken@chromium.org">falken@chromium.org</a> changed reviewers:
+ <a href="mailto:rdevlin.cronin@chromium.org">rdevlin.cronin@chromium.org</a>, <a href="mailto:tsepez@chromium.org">tsepez@chromium.org</a></pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg44"
           name="43">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(43)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>falken</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-43">
                          Thank you all. Pulling in more owners: horo: Can you review everything? devlin: chrome/browser/extensions/service_worker_apitest.cc tsepez: ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-03 08:22:05 UTC)
                <a href="#msg44">#44</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-43"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-43"
            >Thank you all. Pulling in more owners:

horo: Can you review everything?
devlin: chrome/browser/extensions/service_worker_apitest.cc
tsepez: platform/weborigin/
dcheng: messages and web/
(as for message security: a compromised renderer could lie about
|is_parent_frame_secure|, but we normally rely on the renderer to do these
security checks like in Document::isSecureContext anyway)

<a href="https://codereview.chromium.org/2009453002/diff/220001/chrome/browser/extensions/service_worker_apitest.cc" rel="nofollow">https://codereview.chromium.org/2009453002/diff/220001/chrome/browser/extensi...</a>
File chrome/browser/extensions/service_worker_apitest.cc (right):

<a href="https://codereview.chromium.org/2009453002/diff/220001/chrome/browser/extensions/service_worker_apitest.cc#newcode681" rel="nofollow">https://codereview.chromium.org/2009453002/diff/220001/chrome/browser/extensi...</a>
chrome/browser/extensions/service_worker_apitest.cc:681:
WebAccessibleResourcesInsecureIframe) {
On 2016/06/02 23:54:47, alexmos wrote:
&gt; Can you run this through the linux_site_isolation trybot, just to make sure
this
&gt; is working correctly with --site-per-process?

That trybot is in the CQ_INCLUDE_TRYBOT so the CQ will run it (unfortunately,
git-cl try doesn&#39;t seem to know about it).

BTW can I do this locally with:
$ browser_tests --site-per-process
--gtest_filter=&quot;ServiceWorkerTest.WebAccessibleResourcesInsecureIframe&quot;
?

<a href="https://codereview.chromium.org/2009453002/diff/220001/chrome/browser/extensions/service_worker_apitest.cc#newcode695" rel="nofollow">https://codereview.chromium.org/2009453002/diff/220001/chrome/browser/extensi...</a>
chrome/browser/extensions/service_worker_apitest.cc:695: page_url =
page_url.ReplaceComponents(replace_host_and_scheme);
On 2016/06/02 23:54:47, alexmos wrote:
&gt; Why not just use embedded_test_server()-&gt;GetURL(&quot;a.com&quot;, &quot;/rest/of/path&quot;)?

Done. This is because I just copied jww&#39;s test in
<a href="https://codereview.chromium.org/1383483007" rel="nofollow">https://codereview.chromium.org/1383483007</a>

<a href="https://codereview.chromium.org/2009453002/diff/220001/content/browser/service_worker/service_worker_controllee_request_handler.cc" rel="nofollow">https://codereview.chromium.org/2009453002/diff/220001/content/browser/servic...</a>
File content/browser/service_worker/service_worker_controllee_request_handler.cc
(right):

<a href="https://codereview.chromium.org/2009453002/diff/220001/content/browser/service_worker/service_worker_controllee_request_handler.cc#newcode220" rel="nofollow">https://codereview.chromium.org/2009453002/diff/220001/content/browser/servic...</a>
content/browser/service_worker/service_worker_controllee_request_handler.cc:220:
if (schemes.find(provider_host_-&gt;document_url().scheme()) ==
On 2016/06/02 22:44:43, Marijn Kruisselbrink wrote:
&gt; Would it make sense to combine both the is_parent_frame_secure and the
checking
&gt; for whitelisted schemes into one helper method somewhere in SWProviderHost? I
&gt; did something like that in <a href="https://codereview.chromium.org/1914593002" rel="nofollow">https://codereview.chromium.org/1914593002</a> where
I&#39;m
&gt; (still very much WIP) trying to apply the same secure context limitations to
&gt; when Link headers are allowed to install service workers for navigations.

I like that and ended up adopting your patch, thanks. I think we must use
OriginCanAccessServiceWorkers, which is slightly different from IsOriginSecure
(SW is HTTP/HTTPS only and has its own set of exceptions, but in practice that
is just chrome://extensions).

I think the SWProviderHost function needs to be called something like
IsSecureEnoughForServiceWorkers.

<a href="https://codereview.chromium.org/2009453002/diff/220001/content/browser/service_worker/service_worker_request_handler.cc" rel="nofollow">https://codereview.chromium.org/2009453002/diff/220001/content/browser/servic...</a>
File content/browser/service_worker/service_worker_request_handler.cc (right):

<a href="https://codereview.chromium.org/2009453002/diff/220001/content/browser/service_worker/service_worker_request_handler.cc#newcode219" rel="nofollow">https://codereview.chromium.org/2009453002/diff/220001/content/browser/servic...</a>
content/browser/service_worker/service_worker_request_handler.cc:219: if
(new_provider_id == kInvalidServiceWorkerVersionId)
On 2016/06/02 23:54:47, alexmos wrote:
&gt; Why is this needed?

Ah, this was needed in the earlier patch that used
kInvalidServiceWorkerProviderId instead of passing is_parent_frame_secure. That
patch caused site isolation bot to fail without this code.

I still think there&#39;s a bug here because we can use
kInvalidServiceWorkerProviderId due to sandboxed iframes, in which case
TransferProviderHostIn will crash. But I&#39;ll fix that in a separate patch.

Reverted changes to this file.

<a href="https://codereview.chromium.org/2009453002/diff/220001/content/common/service_worker/service_worker_messages.h" rel="nofollow">https://codereview.chromium.org/2009453002/diff/220001/content/common/service...</a>
File content/common/service_worker/service_worker_messages.h (right):

<a href="https://codereview.chromium.org/2009453002/diff/220001/content/common/service_worker/service_worker_messages.h#newcode205" rel="nofollow">https://codereview.chromium.org/2009453002/diff/220001/content/common/service...</a>
content/common/service_worker/service_worker_messages.h:205: // (Service
Workers).
On 2016/06/02 23:54:47, alexmos wrote:
&gt; Update this comment to describe |is_parent_frame_secure|.

Done.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg45"
           name="44">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(44)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>horo</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-44">
                          https://codereview.chromium.org/2009453002/diff/280001/content/browser/service_worker/service_worker_context_core.cc File content/browser/service_worker/service_worker_context_core.cc (right): https://codereview.chromium.org/2009453002/diff/280001/content/browser/service_worker/service_worker_context_core.cc#newcode650 content/browser/service_worker/service_worker_context_core.cc:650: return false; Do we need the returned value? https://codereview.chromium.org/2009453002/diff/280001/content/browser/service_worker/service_worker_provider_host.h ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-03 09:54:45 UTC)
                <a href="#msg45">#45</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-44"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-44"
            ><a href="https://codereview.chromium.org/2009453002/diff/280001/content/browser/service_worker/service_worker_context_core.cc" rel="nofollow">https://codereview.chromium.org/2009453002/diff/280001/content/browser/servic...</a>
File content/browser/service_worker/service_worker_context_core.cc (right):

<a href="https://codereview.chromium.org/2009453002/diff/280001/content/browser/service_worker/service_worker_context_core.cc#newcode650" rel="nofollow">https://codereview.chromium.org/2009453002/diff/280001/content/browser/servic...</a>
content/browser/service_worker/service_worker_context_core.cc:650: return false;
Do we need the returned value?

<a href="https://codereview.chromium.org/2009453002/diff/280001/content/browser/service_worker/service_worker_provider_host.h" rel="nofollow">https://codereview.chromium.org/2009453002/diff/280001/content/browser/servic...</a>
File content/browser/service_worker/service_worker_provider_host.h (right):

<a href="https://codereview.chromium.org/2009453002/diff/280001/content/browser/service_worker/service_worker_provider_host.h#newcode88" rel="nofollow">https://codereview.chromium.org/2009453002/diff/280001/content/browser/servic...</a>
content/browser/service_worker/service_worker_provider_host.h:88:
is_parent_frame_secure_ = is_parent_frame_secure;
Please add DCHECK() to ensure that set_parent_frame_secure() can&#39;t be called
after IsContextSecureForServiceWorker() is called.

<a href="https://codereview.chromium.org/2009453002/diff/280001/content/public/browser/content_browser_client.h" rel="nofollow">https://codereview.chromium.org/2009453002/diff/280001/content/public/browser...</a>
File content/public/browser/content_browser_client.h (right):

<a href="https://codereview.chromium.org/2009453002/diff/280001/content/public/browser/content_browser_client.h#newcode599" rel="nofollow">https://codereview.chromium.org/2009453002/diff/280001/content/public/browser...</a>
content/public/browser/content_browser_client.h:599: virtual void
GetSchemesBypassingSecureContextCheckWhitelist(
We need comment.

<a href="https://codereview.chromium.org/2009453002/diff/280001/third_party/WebKit/Source/web/WebFrame.cpp" rel="nofollow">https://codereview.chromium.org/2009453002/diff/280001/third_party/WebKit/Sou...</a>
File third_party/WebKit/Source/web/WebFrame.cpp (right):

<a href="https://codereview.chromium.org/2009453002/diff/280001/third_party/WebKit/Source/web/WebFrame.cpp#newcode295" rel="nofollow">https://codereview.chromium.org/2009453002/diff/280001/third_party/WebKit/Sou...</a>
third_party/WebKit/Source/web/WebFrame.cpp:295: return result;
nit: we don&#39;t need `result` variable.

<a href="https://codereview.chromium.org/2009453002/diff/280001/third_party/WebKit/Source/web/tests/WebFrameTest.cpp" rel="nofollow">https://codereview.chromium.org/2009453002/diff/280001/third_party/WebKit/Sou...</a>
File third_party/WebKit/Source/web/tests/WebFrameTest.cpp (right):

<a href="https://codereview.chromium.org/2009453002/diff/280001/third_party/WebKit/Source/web/tests/WebFrameTest.cpp#newcode8730" rel="nofollow">https://codereview.chromium.org/2009453002/diff/280001/third_party/WebKit/Sou...</a>
third_party/WebKit/Source/web/tests/WebFrameTest.cpp:8730: // A document in an
insecure context can be considered
nit: strange line break.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg46"
           name="45">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(45)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>falken</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-45">
                          Thank you. https://codereview.chromium.org/2009453002/diff/280001/content/browser/service_worker/service_worker_context_core.cc File content/browser/service_worker/service_worker_context_core.cc (right): https://codereview.chromium.org/2009453002/diff/280001/content/browser/service_worker/service_worker_context_core.cc#newcode650 content/browser/service_worker/service_worker_context_core.cc:650: return false; On 2016/06/03 09:54:44, horo wrote: ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-03 12:10:45 UTC)
                <a href="#msg46">#46</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-45"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-45"
            >Thank you.

<a href="https://codereview.chromium.org/2009453002/diff/280001/content/browser/service_worker/service_worker_context_core.cc" rel="nofollow">https://codereview.chromium.org/2009453002/diff/280001/content/browser/servic...</a>
File content/browser/service_worker/service_worker_context_core.cc (right):

<a href="https://codereview.chromium.org/2009453002/diff/280001/content/browser/service_worker/service_worker_context_core.cc#newcode650" rel="nofollow">https://codereview.chromium.org/2009453002/diff/280001/content/browser/servic...</a>
content/browser/service_worker/service_worker_context_core.cc:650: return false;
On 2016/06/03 09:54:44, horo wrote:
&gt; Do we need the returned value?

Not anymore. Failed partial revert. Done.

<a href="https://codereview.chromium.org/2009453002/diff/280001/content/browser/service_worker/service_worker_provider_host.h" rel="nofollow">https://codereview.chromium.org/2009453002/diff/280001/content/browser/servic...</a>
File content/browser/service_worker/service_worker_provider_host.h (right):

<a href="https://codereview.chromium.org/2009453002/diff/280001/content/browser/service_worker/service_worker_provider_host.h#newcode88" rel="nofollow">https://codereview.chromium.org/2009453002/diff/280001/content/browser/servic...</a>
content/browser/service_worker/service_worker_provider_host.h:88:
is_parent_frame_secure_ = is_parent_frame_secure;
On 2016/06/03 09:54:45, horo wrote:
&gt; Please add DCHECK() to ensure that set_parent_frame_secure() can&#39;t be called
&gt; after IsContextSecureForServiceWorker() is called.

Done. I ended up making the bool an enum, which is cleaner anyway.

<a href="https://codereview.chromium.org/2009453002/diff/280001/content/public/browser/content_browser_client.h" rel="nofollow">https://codereview.chromium.org/2009453002/diff/280001/content/public/browser...</a>
File content/public/browser/content_browser_client.h (right):

<a href="https://codereview.chromium.org/2009453002/diff/280001/content/public/browser/content_browser_client.h#newcode599" rel="nofollow">https://codereview.chromium.org/2009453002/diff/280001/content/public/browser...</a>
content/public/browser/content_browser_client.h:599: virtual void
GetSchemesBypassingSecureContextCheckWhitelist(
On 2016/06/03 09:54:45, horo wrote:
&gt; We need comment.

Done.

<a href="https://codereview.chromium.org/2009453002/diff/280001/third_party/WebKit/Source/web/WebFrame.cpp" rel="nofollow">https://codereview.chromium.org/2009453002/diff/280001/third_party/WebKit/Sou...</a>
File third_party/WebKit/Source/web/WebFrame.cpp (right):

<a href="https://codereview.chromium.org/2009453002/diff/280001/third_party/WebKit/Source/web/WebFrame.cpp#newcode295" rel="nofollow">https://codereview.chromium.org/2009453002/diff/280001/third_party/WebKit/Sou...</a>
third_party/WebKit/Source/web/WebFrame.cpp:295: return result;
On 2016/06/03 09:54:45, horo wrote:
&gt; nit: we don&#39;t need `result` variable.

Done.

<a href="https://codereview.chromium.org/2009453002/diff/280001/third_party/WebKit/Source/web/tests/WebFrameTest.cpp" rel="nofollow">https://codereview.chromium.org/2009453002/diff/280001/third_party/WebKit/Sou...</a>
File third_party/WebKit/Source/web/tests/WebFrameTest.cpp (right):

<a href="https://codereview.chromium.org/2009453002/diff/280001/third_party/WebKit/Source/web/tests/WebFrameTest.cpp#newcode8730" rel="nofollow">https://codereview.chromium.org/2009453002/diff/280001/third_party/WebKit/Sou...</a>
third_party/WebKit/Source/web/tests/WebFrameTest.cpp:8730: // A document in an
insecure context can be considered
On 2016/06/03 09:54:45, horo wrote:
&gt; nit: strange line break.

My vim sometimes gets in a state where it can&#39;t gq well. Done.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    generated"
           style="display: none"
           id="generated-msg47"
           name="46">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(46)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Devlin</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-46">
                          rdevlin.cronin@chromium.org changed reviewers: + lazyboy@chromium.org
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-03 15:06:44 UTC)
                <a href="#msg47">#47</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-46"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-46"
            ><a href="mailto:rdevlin.cronin@chromium.org">rdevlin.cronin@chromium.org</a> changed reviewers:
+ <a href="mailto:lazyboy@chromium.org">lazyboy@chromium.org</a></pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message  approval  "
           
           id="msg48"
           name="47">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(47)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Devlin</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-47">
                          service_worker_apitest.cc lgtm, but +lazyboy@ as FYI and in case he sees something I missed.
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-03 15:06:45 UTC)
                <a href="#msg48">#48</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-47"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-47"
            >service_worker_apitest.cc lgtm, but +lazyboy@ as FYI and in case he sees
something I missed.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg49"
           name="48">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(48)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Tom Sepez</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-48">
                          https://codereview.chromium.org/2009453002/diff/300001/third_party/WebKit/Source/platform/weborigin/SecurityOrigin.cpp File third_party/WebKit/Source/platform/weborigin/SecurityOrigin.cpp (right): https://codereview.chromium.org/2009453002/diff/300001/third_party/WebKit/Source/platform/weborigin/SecurityOrigin.cpp#newcode362 third_party/WebKit/Source/platform/weborigin/SecurityOrigin.cpp:362: bool SecurityOrigin::isPotentiallyTrustworthy(String* errorMessage) const Why do we need to ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-03 17:29:58 UTC)
                <a href="#msg49">#49</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-48"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-48"
            ><a href="https://codereview.chromium.org/2009453002/diff/300001/third_party/WebKit/Source/platform/weborigin/SecurityOrigin.cpp" rel="nofollow">https://codereview.chromium.org/2009453002/diff/300001/third_party/WebKit/Sou...</a>
File third_party/WebKit/Source/platform/weborigin/SecurityOrigin.cpp (right):

<a href="https://codereview.chromium.org/2009453002/diff/300001/third_party/WebKit/Source/platform/weborigin/SecurityOrigin.cpp#newcode362" rel="nofollow">https://codereview.chromium.org/2009453002/diff/300001/third_party/WebKit/Sou...</a>
third_party/WebKit/Source/platform/weborigin/SecurityOrigin.cpp:362: bool
SecurityOrigin::isPotentiallyTrustworthy(String* errorMessage) const
Why do we need to add this?  Can&#39;t the caller use the existing version and then
call the public isPotentiallyTrustworthyErrorMessage() as needed?</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg50"
           name="49">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(49)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Tom Sepez</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-49">
                          
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-03 17:32:51 UTC)
                <a href="#msg50">#50</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-49"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-49"
            ></pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message  approval  "
           
           id="msg51"
           name="50">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(50)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>horo</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-50">
                          lgtm
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-06 01:54:33 UTC)
                <a href="#msg51">#51</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-50"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-50"
            >lgtm</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    generated"
           style="display: none"
           id="generated-msg52"
           name="51">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(51)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>falken</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-51">
                          Patchset #17 (id:340001) has been deleted
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-06 04:53:59 UTC)
                <a href="#msg52">#52</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-51"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-51"
            >Patchset #17 (id:340001) has been deleted</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg53"
           name="52">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(52)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>falken</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-52">
                          Thanks, updated. Please take another look. devlin, lazyboy: I made some changes in /service_worker_apitest.cc. I ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-06 06:38:13 UTC)
                <a href="#msg53">#53</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-52"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-52"
            >Thanks, updated. Please take another look.

devlin, lazyboy: I made some changes in /service_worker_apitest.cc. I had
originally meant to refactor the two tests into a common function but didn&#39;t see
a way to do that without using a new test class, which seemed like overkill.
Since the tests are the exact same except for the secure vs insecure URL, I
decided to just change the existing test to use the insecure URL, since secure
URLs are exercise in other tests. Let me know if you&#39;d rather have two separate
tests, or have another idea.

<a href="https://codereview.chromium.org/2009453002/diff/300001/chrome/browser/extensions/service_worker_apitest.cc" rel="nofollow">https://codereview.chromium.org/2009453002/diff/300001/chrome/browser/extensi...</a>
File chrome/browser/extensions/service_worker_apitest.cc (right):

<a href="https://codereview.chromium.org/2009453002/diff/300001/chrome/browser/extensions/service_worker_apitest.cc#newcode696" rel="nofollow">https://codereview.chromium.org/2009453002/diff/300001/chrome/browser/extensi...</a>
chrome/browser/extensions/service_worker_apitest.cc:696: page_url =
page_url.ReplaceComponents(replace_host_and_scheme);
Oops, I meant to delete the use of GURL::Replacements earlier. Done now.

<a href="https://codereview.chromium.org/2009453002/diff/300001/third_party/WebKit/Source/platform/weborigin/SecurityOrigin.cpp" rel="nofollow">https://codereview.chromium.org/2009453002/diff/300001/third_party/WebKit/Sou...</a>
File third_party/WebKit/Source/platform/weborigin/SecurityOrigin.cpp (right):

<a href="https://codereview.chromium.org/2009453002/diff/300001/third_party/WebKit/Source/platform/weborigin/SecurityOrigin.cpp#newcode362" rel="nofollow">https://codereview.chromium.org/2009453002/diff/300001/third_party/WebKit/Sou...</a>
third_party/WebKit/Source/platform/weborigin/SecurityOrigin.cpp:362: bool
SecurityOrigin::isPotentiallyTrustworthy(String* errorMessage) const
On 2016/06/03 17:29:58, Tom Sepez wrote:
&gt; Why do we need to add this?  Can&#39;t the caller use the existing version and
then
&gt; call the public isPotentiallyTrustworthyErrorMessage() as needed?

Done, removed. Yeah, we don&#39;t need it. I also removed the param from
Frame::canChildBeSecure so now only Document::isSecureContext is responsible for
populating the error message. I think the original idea was for the message to
be more detailed about the exact error, but it&#39;s currently always just
SecurityOrigin::isPotentiallyTrustworthyErrorMessage.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg54"
           name="53">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(53)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>kinuko</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-53">
                          nits only https://codereview.chromium.org/2009453002/diff/360001/content/browser/service_worker/service_worker_provider_host.h File content/browser/service_worker/service_worker_provider_host.h (right): https://codereview.chromium.org/2009453002/diff/360001/content/browser/service_worker/service_worker_provider_host.h#newcode96 content/browser/service_worker/service_worker_provider_host.h:96: } nit: why do we always translate ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-06 06:43:16 UTC)
                <a href="#msg54">#54</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-53"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-53"
            >nits only

<a href="https://codereview.chromium.org/2009453002/diff/360001/content/browser/service_worker/service_worker_provider_host.h" rel="nofollow">https://codereview.chromium.org/2009453002/diff/360001/content/browser/servic...</a>
File content/browser/service_worker/service_worker_provider_host.h (right):

<a href="https://codereview.chromium.org/2009453002/diff/360001/content/browser/service_worker/service_worker_provider_host.h#newcode96" rel="nofollow">https://codereview.chromium.org/2009453002/diff/360001/content/browser/servic...</a>
content/browser/service_worker/service_worker_provider_host.h:96: }
nit: why do we always translate enum to bool / bool to enum here?

<a href="https://codereview.chromium.org/2009453002/diff/360001/third_party/WebKit/public/web/WebFrame.h" rel="nofollow">https://codereview.chromium.org/2009453002/diff/360001/third_party/WebKit/pub...</a>
File third_party/WebKit/public/web/WebFrame.h (right):

<a href="https://codereview.chromium.org/2009453002/diff/360001/third_party/WebKit/public/web/WebFrame.h#newcode560" rel="nofollow">https://codereview.chromium.org/2009453002/diff/360001/third_party/WebKit/pub...</a>
third_party/WebKit/public/web/WebFrame.h:560: // check whether a context is
secure.
nit: the term &#39;context&#39; is pretty vague in general, &quot;check whether the document
is a secure context&quot; ?</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg55"
           name="54">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(54)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>falken</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-54">
                          Updated. https://codereview.chromium.org/2009453002/diff/360001/content/browser/service_worker/service_worker_provider_host.h File content/browser/service_worker/service_worker_provider_host.h (right): https://codereview.chromium.org/2009453002/diff/360001/content/browser/service_worker/service_worker_provider_host.h#newcode96 content/browser/service_worker/service_worker_provider_host.h:96: } On 2016/06/06 06:43:16, kinuko wrote: &gt; nit: ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-06 06:56:55 UTC)
                <a href="#msg55">#55</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-54"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-54"
            >Updated.

<a href="https://codereview.chromium.org/2009453002/diff/360001/content/browser/service_worker/service_worker_provider_host.h" rel="nofollow">https://codereview.chromium.org/2009453002/diff/360001/content/browser/servic...</a>
File content/browser/service_worker/service_worker_provider_host.h (right):

<a href="https://codereview.chromium.org/2009453002/diff/360001/content/browser/service_worker/service_worker_provider_host.h#newcode96" rel="nofollow">https://codereview.chromium.org/2009453002/diff/360001/content/browser/servic...</a>
content/browser/service_worker/service_worker_provider_host.h:96: }
On 2016/06/06 06:43:16, kinuko wrote:
&gt; nit: why do we always translate enum to bool / bool to enum here?

I&#39;m still a bit undecided about this. On the renderer-side, UNINITIALIZED is
never used.  The renderer knows if the frame is secure or insecure, and sends
that bool in the message.

On the browser-side...
in non-plz-navigate case: we create the provider host once we get the IPC
message.
in the plz-navigate case: we create the provider before we get the IPC message.
So we need UNINITIALIZED on the browser-side.

Having the IPC message use a bool restricts it to the allowed values, which is
maybe a nicer than the enum. It also is simpler to work with: you can use an
if/else instead of switch.

<a href="https://codereview.chromium.org/2009453002/diff/360001/third_party/WebKit/public/web/WebFrame.h" rel="nofollow">https://codereview.chromium.org/2009453002/diff/360001/third_party/WebKit/pub...</a>
File third_party/WebKit/public/web/WebFrame.h (right):

<a href="https://codereview.chromium.org/2009453002/diff/360001/third_party/WebKit/public/web/WebFrame.h#newcode560" rel="nofollow">https://codereview.chromium.org/2009453002/diff/360001/third_party/WebKit/pub...</a>
third_party/WebKit/public/web/WebFrame.h:560: // check whether a context is
secure.
On 2016/06/06 06:43:16, kinuko wrote:
&gt; nit: the term &#39;context&#39; is pretty vague in general, &quot;check whether the
document
&gt; is a secure context&quot; ?

Yes I think there&#39;s some inconsistency here. Did some wordsmithing.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message  approval  "
           
           id="msg56"
           name="55">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(55)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>kinuko</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-55">
                          (rs-ish) lgtm https://codereview.chromium.org/2009453002/diff/360001/content/browser/service_worker/service_worker_provider_host.h File content/browser/service_worker/service_worker_provider_host.h (right): https://codereview.chromium.org/2009453002/diff/360001/content/browser/service_worker/service_worker_provider_host.h#newcode96 content/browser/service_worker/service_worker_provider_host.h:96: } On 2016/06/06 06:56:55, falken wrote: &gt; ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-06 09:28:04 UTC)
                <a href="#msg56">#56</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-55"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-55"
            >(rs-ish) lgtm

<a href="https://codereview.chromium.org/2009453002/diff/360001/content/browser/service_worker/service_worker_provider_host.h" rel="nofollow">https://codereview.chromium.org/2009453002/diff/360001/content/browser/servic...</a>
File content/browser/service_worker/service_worker_provider_host.h (right):

<a href="https://codereview.chromium.org/2009453002/diff/360001/content/browser/service_worker/service_worker_provider_host.h#newcode96" rel="nofollow">https://codereview.chromium.org/2009453002/diff/360001/content/browser/servic...</a>
content/browser/service_worker/service_worker_provider_host.h:96: }
On 2016/06/06 06:56:55, falken wrote:
&gt; On 2016/06/06 06:43:16, kinuko wrote:
&gt; &gt; nit: why do we always translate enum to bool / bool to enum here?
&gt; 
&gt; I&#39;m still a bit undecided about this. On the renderer-side, UNINITIALIZED is
&gt; never used.  The renderer knows if the frame is secure or insecure, and sends
&gt; that bool in the message.
&gt; 
&gt; On the browser-side...
&gt; in non-plz-navigate case: we create the provider host once we get the IPC
&gt; message.
&gt; in the plz-navigate case: we create the provider before we get the IPC
message.
&gt; So we need UNINITIALIZED on the browser-side.
&gt; 
&gt; Having the IPC message use a bool restricts it to the allowed values, which is
&gt; maybe a nicer than the enum. It also is simpler to work with: you can use an
&gt; if/else instead of switch.

I think we have mild preference for enum over bool, while I see that having
UNINITIALIZED only in limited cases is a bit unfortunate. I&#39;ll let it go now,
but reg: if/else condition basically always checking security_level == SECURE
seems to be equivalent too.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    generated"
           style="display: none"
           id="generated-msg57"
           name="56">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(56)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>falken</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-56">
                          falken@chromium.org changed reviewers: - raymes@chromium.org, tsepez@chromium.org
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-06 13:32:35 UTC)
                <a href="#msg57">#57</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-56"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-56"
            ><a href="mailto:falken@chromium.org">falken@chromium.org</a> changed reviewers:
- <a href="mailto:raymes@chromium.org">raymes@chromium.org</a>, <a href="mailto:tsepez@chromium.org">tsepez@chromium.org</a></pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg58"
           name="57">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(57)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>falken</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-57">
                          Thanks. Refreshing reviewer roster: +dcheng: web/ and messages +devlin/lazyboy: changes to service_worker_apitest.cc since last review ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-06 13:32:37 UTC)
                <a href="#msg58">#58</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-57"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-57"
            >Thanks. Refreshing reviewer roster:
+dcheng: web/ and messages
+devlin/lazyboy: changes to service_worker_apitest.cc since last review

(-tsepez, -raymes as the relevant files are no longer changed. Thanks for
looking.)</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg59"
           name="58">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(58)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Devlin</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-58">
                          https://codereview.chromium.org/2009453002/diff/380001/chrome/browser/extensions/service_worker_apitest.cc File chrome/browser/extensions/service_worker_apitest.cc (right): https://codereview.chromium.org/2009453002/diff/380001/chrome/browser/extensions/service_worker_apitest.cc#newcode638 chrome/browser/extensions/service_worker_apitest.cc:638: // Extension service workers must be able to control ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-06 15:20:57 UTC)
                <a href="#msg59">#59</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-58"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-58"
            ><a href="https://codereview.chromium.org/2009453002/diff/380001/chrome/browser/extensions/service_worker_apitest.cc" rel="nofollow">https://codereview.chromium.org/2009453002/diff/380001/chrome/browser/extensi...</a>
File chrome/browser/extensions/service_worker_apitest.cc (right):

<a href="https://codereview.chromium.org/2009453002/diff/380001/chrome/browser/extensions/service_worker_apitest.cc#newcode638" rel="nofollow">https://codereview.chromium.org/2009453002/diff/380001/chrome/browser/extensi...</a>
chrome/browser/extensions/service_worker_apitest.cc:638: // Extension service
workers must be able to control insecure contexts. So set
I don&#39;t quite understand this comment.  I&#39;m assuming &quot;insecure context&quot; refers
to a.com?  The extension isn&#39;t actually controlling the insecure context at all
(we don&#39;t allow extensions to serve up other origins) - it just controls and
extension page (secure context) iframed within an insecure context.  Right?  Or
am I missing something?</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg60"
           name="59">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(59)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Marijn Kruisselbrink</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-59">
                          https://codereview.chromium.org/2009453002/diff/380001/chrome/browser/extensions/service_worker_apitest.cc File chrome/browser/extensions/service_worker_apitest.cc (right): https://codereview.chromium.org/2009453002/diff/380001/chrome/browser/extensions/service_worker_apitest.cc#newcode638 chrome/browser/extensions/service_worker_apitest.cc:638: // Extension service workers must be able to control ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-06 17:31:20 UTC)
                <a href="#msg60">#60</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-59"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-59"
            ><a href="https://codereview.chromium.org/2009453002/diff/380001/chrome/browser/extensions/service_worker_apitest.cc" rel="nofollow">https://codereview.chromium.org/2009453002/diff/380001/chrome/browser/extensi...</a>
File chrome/browser/extensions/service_worker_apitest.cc (right):

<a href="https://codereview.chromium.org/2009453002/diff/380001/chrome/browser/extensions/service_worker_apitest.cc#newcode638" rel="nofollow">https://codereview.chromium.org/2009453002/diff/380001/chrome/browser/extensi...</a>
chrome/browser/extensions/service_worker_apitest.cc:638: // Extension service
workers must be able to control insecure contexts. So set
On 2016/06/06 at 15:20:57, Devlin wrote:
&gt; I don&#39;t quite understand this comment.  I&#39;m assuming &quot;insecure context&quot; refers
to a.com?  The extension isn&#39;t actually controlling the insecure context at all
(we don&#39;t allow extensions to serve up other origins) - it just controls and
extension page (secure context) iframed within an insecure context.  Right?  Or
am I missing something?

An iframe within an insecure context is itself an insecure context, even if it
is served from a secure scheme like https (see example 7 in
<a href="https://w3c.github.io/webappsec-secure-contexts/#examples-framed" rel="nofollow">https://w3c.github.io/webappsec-secure-contexts/#examples-framed</a>). But yes, it
does seem like the comment could do a better job explaining what this code is
doing (probably by mentioning iframes inside insecure contexts rather than just
insecure contexts).</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg61"
           name="60">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(60)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>falken</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-60">
                          https://codereview.chromium.org/2009453002/diff/380001/chrome/browser/extensions/service_worker_apitest.cc File chrome/browser/extensions/service_worker_apitest.cc (right): https://codereview.chromium.org/2009453002/diff/380001/chrome/browser/extensions/service_worker_apitest.cc#newcode638 chrome/browser/extensions/service_worker_apitest.cc:638: // Extension service workers must be able to control ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-07 01:15:30 UTC)
                <a href="#msg61">#61</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-60"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-60"
            ><a href="https://codereview.chromium.org/2009453002/diff/380001/chrome/browser/extensions/service_worker_apitest.cc" rel="nofollow">https://codereview.chromium.org/2009453002/diff/380001/chrome/browser/extensi...</a>
File chrome/browser/extensions/service_worker_apitest.cc (right):

<a href="https://codereview.chromium.org/2009453002/diff/380001/chrome/browser/extensions/service_worker_apitest.cc#newcode638" rel="nofollow">https://codereview.chromium.org/2009453002/diff/380001/chrome/browser/extensi...</a>
chrome/browser/extensions/service_worker_apitest.cc:638: // Extension service
workers must be able to control insecure contexts. So set
On 2016/06/06 17:31:20, Marijn Kruisselbrink wrote:
&gt; On 2016/06/06 at 15:20:57, Devlin wrote:
&gt; &gt; I don&#39;t quite understand this comment.  I&#39;m assuming &quot;insecure context&quot;
refers
&gt; to a.com?  The extension isn&#39;t actually controlling the insecure context at
all
&gt; (we don&#39;t allow extensions to serve up other origins) - it just controls and
&gt; extension page (secure context) iframed within an insecure context.  Right? 
Or
&gt; am I missing something?
&gt; 
&gt; An iframe within an insecure context is itself an insecure context, even if it
&gt; is served from a secure scheme like https (see example 7 in
&gt; <a href="https://w3c.github.io/webappsec-secure-contexts/#examples-framed" rel="nofollow">https://w3c.github.io/webappsec-secure-contexts/#examples-framed</a>). But yes, it
&gt; does seem like the comment could do a better job explaining what this code is
&gt; doing (probably by mentioning iframes inside insecure contexts rather than
just
&gt; insecure contexts).

Thanks, I revised the comment. What do you think?</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message  approval  "
           
           id="msg62"
           name="61">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(61)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Devlin</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-61">
                          On 2016/06/07 01:15:30, falken wrote: &gt; Thanks, I revised the comment. What do you think? ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-07 01:17:19 UTC)
                <a href="#msg62">#62</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-61"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-61"
            >On 2016/06/07 01:15:30, falken wrote:
&gt; Thanks, I revised the comment. What do you think?

Much clearer, thanks. :)

lgtm</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message  approval  "
           
           id="msg63"
           name="62">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(62)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>dcheng</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-62">
                          blink/ipc lgtm but two concerns that I&#39;d like to see addressed in followups 1) I ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-07 02:21:20 UTC)
                <a href="#msg63">#63</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-62"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-62"
            >blink/ipc lgtm but two concerns that I&#39;d like to see addressed in followups

1) I hope that we can (eventually?) enforce this check in the browser process
rather than relying on the renderer, since it can lie about the new bool.

2) I&#39;m not a fan of the new Blink API.
- It&#39;s confusing to have canHaveSecureChild() and isSecureContext() exposed in
the public API
- It&#39;s also confusing that one is on Frame and the other is on Document.
canHaveSecureChild() is a property of a Document / RemoteSecurityContext, not
the Frame.
- It should be unnecessary to walk the ancestors each time this is called. The
parents of a frame cannot change (if they do, the Frame/Document is no longer
attached), nor can the security origin of a Document change. Instead, these bits
ought to only be determined once, when the context is initialized.

(1) is hard to address in the near-term (something something FrameIOData?). (2)
is something I&#39;m hoping we can address sooner though.

<a href="https://codereview.chromium.org/2009453002/diff/420001/content/public/browser/content_browser_client.h" rel="nofollow">https://codereview.chromium.org/2009453002/diff/420001/content/public/browser...</a>
File content/public/browser/content_browser_client.h (right):

<a href="https://codereview.chromium.org/2009453002/diff/420001/content/public/browser/content_browser_client.h#newcode603" rel="nofollow">https://codereview.chromium.org/2009453002/diff/420001/content/public/browser...</a>
content/public/browser/content_browser_client.h:603: std::set&lt;std::string&gt;*
schemes) {}
I guess this is just following existing convention, but note that it&#39;s fine to
return this by value: copy elision will generally prevent us from copying
anyway. If I saw something like this (without looking at the declaration), I
might think that it could return a bool or error or something else like that.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg64"
           name="63">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(63)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>falken</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-63">
                          Thanks. I made one minor change to Document to simplify the errorMessage population. Will put ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-07 03:14:29 UTC)
                <a href="#msg64">#64</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-63"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-63"
            >Thanks. I made one minor change to Document to simplify the errorMessage
population. Will put through CQ.

<a href="https://codereview.chromium.org/2009453002/diff/420001/content/public/browser/content_browser_client.h" rel="nofollow">https://codereview.chromium.org/2009453002/diff/420001/content/public/browser...</a>
File content/public/browser/content_browser_client.h (right):

<a href="https://codereview.chromium.org/2009453002/diff/420001/content/public/browser/content_browser_client.h#newcode603" rel="nofollow">https://codereview.chromium.org/2009453002/diff/420001/content/public/browser...</a>
content/public/browser/content_browser_client.h:603: std::set&lt;std::string&gt;*
schemes) {}
On 2016/06/07 02:21:20, dcheng wrote:
&gt; I guess this is just following existing convention, but note that it&#39;s fine to
&gt; return this by value: copy elision will generally prevent us from copying
&gt; anyway. If I saw something like this (without looking at the declaration), I
&gt; might think that it could return a bool or error or something else like that.

Thanks I see. I decided to keep this for consistency with the existing
GetSchemesBypassingSecureContextCheckWhitelist.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    generated"
           style="display: none"
           id="generated-msg65"
           name="64">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(64)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>falken</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-64">
                          The CQ bit was checked by falken@chromium.org
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-07 03:15:21 UTC)
                <a href="#msg65">#65</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-64"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-64"
            >The CQ bit was checked by <a href="mailto:falken@chromium.org">falken@chromium.org</a></pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    generated"
           style="display: none"
           id="generated-msg66"
           name="65">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(65)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>falken</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-65">
                          The patchset sent to the CQ was uploaded after l-g-t-m from clamy@chromium.org, alexmos@chromium.org, jww@chromium.org, horo@chromium.org, ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-07 03:15:25 UTC)
                <a href="#msg66">#66</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-65"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-65"
            >The patchset sent to the CQ was uploaded after l-g-t-m from <a href="mailto:clamy@chromium.org">clamy@chromium.org</a>,
<a href="mailto:alexmos@chromium.org">alexmos@chromium.org</a>, <a href="mailto:jww@chromium.org">jww@chromium.org</a>, <a href="mailto:horo@chromium.org">horo@chromium.org</a>, <a href="mailto:kinuko@chromium.org">kinuko@chromium.org</a>,
<a href="mailto:rdevlin.cronin@chromium.org">rdevlin.cronin@chromium.org</a>, <a href="mailto:dcheng@chromium.org">dcheng@chromium.org</a>
Link to the patchset: <a href="https://codereview.chromium.org/2009453002/#ps440001" rel="nofollow">https://codereview.chromium.org/2009453002/#ps440001</a>
(title: &quot;refactor errorMessage&quot;)</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg67"
           name="66">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(66)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>commit-bot: I haz the power</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-66">
                          CQ is trying da patch. Follow status at https://chromium-cq-status.appspot.com/patch-status/2009453002/440001
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-07 03:15:47 UTC)
                <a href="#msg67">#67</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-66"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-66"
            >CQ is trying da patch. Follow status at
 <a href="https://chromium-cq-status.appspot.com/patch-status/2009453002/440001" rel="nofollow">https://chromium-cq-status.appspot.com/patch-status/2009453002/440001</a></pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message issue_was_closed   generated"
           style="display: none"
           id="generated-msg68"
           name="67">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(67)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>commit-bot: I haz the power</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-67">
                          Description was changed from ========== service worker: Don&#39;t control a subframe of an insecure context ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-07 05:06:26 UTC)
                <a href="#msg68">#68</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-67"
             style="display: none;">
          <div class="message-body">
            
              <span class="extra-note">
                Message was sent while issue was closed.
              </span>
            
            <pre name="cl-message-67"
            >Description was changed from

==========
service worker: Don&#39;t control a subframe of an insecure context

We must check isSecureContext when creating the network provider to
adhere to
<a href="https://w3c.github.io/webappsec/specs/powerfulfeatures/#settings-privileged" rel="nofollow">https://w3c.github.io/webappsec/specs/powerfulfeatures/#settings-privileged</a>.

We already did this for getRegistration(), register(), unregister() but must
also do this when deciding whether to control an in-scope document.

BUG=607543
CQ_INCLUDE_TRYBOTS=tryserver.chromium.linux:linux_site_isolation
==========

to

==========
service worker: Don&#39;t control a subframe of an insecure context

We must check isSecureContext when creating the network provider to
adhere to
<a href="https://w3c.github.io/webappsec/specs/powerfulfeatures/#settings-privileged" rel="nofollow">https://w3c.github.io/webappsec/specs/powerfulfeatures/#settings-privileged</a>.

We already did this for getRegistration(), register(), unregister() but must
also do this when deciding whether to control an in-scope document.

BUG=607543
CQ_INCLUDE_TRYBOTS=tryserver.chromium.linux:linux_site_isolation
==========</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message issue_was_closed   "
           
           id="msg69"
           name="68">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(68)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>commit-bot: I haz the power</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-68">
                          Committed patchset #21 (id:440001)
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-07 05:06:29 UTC)
                <a href="#msg69">#69</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-68"
             style="display: none;">
          <div class="message-body">
            
              <span class="extra-note">
                Message was sent while issue was closed.
              </span>
            
            <pre name="cl-message-68"
            >Committed patchset #21 (id:440001)</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message issue_was_closed   generated"
           style="display: none"
           id="generated-msg70"
           name="69">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(69)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>commit-bot: I haz the power</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-69">
                          Description was changed from ========== service worker: Don&#39;t control a subframe of an insecure context ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-07 05:08:41 UTC)
                <a href="#msg70">#70</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-69"
             style="display: none;">
          <div class="message-body">
            
              <span class="extra-note">
                Message was sent while issue was closed.
              </span>
            
            <pre name="cl-message-69"
            >Description was changed from

==========
service worker: Don&#39;t control a subframe of an insecure context

We must check isSecureContext when creating the network provider to
adhere to
<a href="https://w3c.github.io/webappsec/specs/powerfulfeatures/#settings-privileged" rel="nofollow">https://w3c.github.io/webappsec/specs/powerfulfeatures/#settings-privileged</a>.

We already did this for getRegistration(), register(), unregister() but must
also do this when deciding whether to control an in-scope document.

BUG=607543
CQ_INCLUDE_TRYBOTS=tryserver.chromium.linux:linux_site_isolation
==========

to

==========
service worker: Don&#39;t control a subframe of an insecure context

We must check isSecureContext when creating the network provider to
adhere to
<a href="https://w3c.github.io/webappsec/specs/powerfulfeatures/#settings-privileged" rel="nofollow">https://w3c.github.io/webappsec/specs/powerfulfeatures/#settings-privileged</a>.

We already did this for getRegistration(), register(), unregister() but must
also do this when deciding whether to control an in-scope document.

BUG=607543
CQ_INCLUDE_TRYBOTS=tryserver.chromium.linux:linux_site_isolation

Committed: <a href="https://crrev.com/59a2e54eeb0e61971a0c27c44c54dd0c30b5d06d" rel="nofollow">https://crrev.com/59a2e54eeb0e61971a0c27c44c54dd0c30b5d06d</a>
Cr-Commit-Position: refs/heads/master@{#398229}
==========</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message issue_was_closed   "
           
           id="msg71"
           name="70">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(70)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>commit-bot: I haz the power</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-70">
                          Patchset 21 (id:??) landed as https://crrev.com/59a2e54eeb0e61971a0c27c44c54dd0c30b5d06d Cr-Commit-Position: refs/heads/master@{#398229}
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-07 05:08:43 UTC)
                <a href="#msg71">#71</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-70"
             style="display: none;">
          <div class="message-body">
            
              <span class="extra-note">
                Message was sent while issue was closed.
              </span>
            
            <pre name="cl-message-70"
            >Patchset 21 (id:??) landed as
<a href="https://crrev.com/59a2e54eeb0e61971a0c27c44c54dd0c30b5d06d" rel="nofollow">https://crrev.com/59a2e54eeb0e61971a0c27c44c54dd0c30b5d06d</a>
Cr-Commit-Position: refs/heads/master@{#398229}</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message issue_was_closed   "
           
           id="msg72"
           name="71">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(71)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>dcheng</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden; display: none;"
                           class="extra"
                           id="cl-preview-71">
                          A revert of this CL (patchset #21 id:440001) has been created in https://codereview.chromium.org/2055433002/ by dcheng@chromium.org. ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-08 18:03:53 UTC)
                <a href="#msg72">#72</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-71"
             >
          <div class="message-body">
            
              <span class="extra-note">
                Message was sent while issue was closed.
              </span>
            
            <pre name="cl-message-71"
            >A revert of this CL (patchset #21 id:440001) has been created in
<a href="https://codereview.chromium.org/2055433002/" rel="nofollow">https://codereview.chromium.org/2055433002/</a> by <a href="mailto:dcheng@chromium.org">dcheng@chromium.org</a>.

The reason for reverting is:
ServiceWorkerProviderHost::SetControllerVersionAttribute CHECK is firing in
release builds: <a href="https://crbug.com/618365" rel="nofollow">https://crbug.com/618365</a>.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    

    <div>
      <a href="javascript:M_expandAllVisibleComments('cl', 72)">
        Expand Messages</a>
      |
      <a href="javascript:M_collapseAllVisibleComments('cl', 72)">
        Collapse Messages</a>
      
      |
      <a href="javascript:M_showGeneratedComments(72)">
        Show Generated Messages</a>
      |
      <a href="javascript:M_hideGeneratedComments(72)">
        Hide Generated Messages</a>
      
    </div>

  </div>

<script language="JavaScript" type="text/javascript">
<!--
var lastMsgID = 72;
// -->
</script>




<script language="JavaScript" type="text/javascript">
  <!--
    document.onkeydown = M_changelistKeyDown;
    var dashboardState = new M_DashboardState(window, 'patch', 'M_CLPatchMarker');
    var issueId = 2009453002;
    M_toggleIssueOverviewByAnchor();
  // -->
</script>



      </td>
    </tr>
  </table>

</div>

  
    <div class="popup" id="popup-issue">
      <b>Issue 2009453002: service worker: Don&#39;t control a subframe of an insecure context
     (Closed) </b><br/>
      Created 4 years, 7 months ago by falken<br/>
      Modified 4 years, 6 months ago<br/>
      Reviewers: dcheng, alexmos, clamy, horo, jww, kinuko, lazyboy, Devlin<br/>
      Base URL: https://chromium.googlesource.com/chromium/src.git@master<br/>
      Comments: 61
      
    </div>
  


<p></p>
<div style="float: left;">
  <a target="_blank" href="http://code.google.com/appengine/"><img border="0"
   src="/static/appengine-noborder-120x30.gif"
   alt="Powered by Google App Engine" /></a>
</div>

<div class="extra" style="font-size: 9pt; float: right; text-align: right;">
  <div style="margin-top: .3em;">This is Rietveld <a href='http://code.google.com/p/rietveld/source/list'>408576698
</a></div>
</div>


<script>
  // Google Analytics.
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-55762617-11', {
    'allowLinker': true,
    'siteSpeedSampleRate': 100
  });
  ga('require', 'linker');
  ga('linker:autoLink',
     ['chromiumcodereview.appspot.com', 'codereview.chromium.org'] );
  ga('send', 'pageview');

  // CRDX Feedback button.
  (function(i,s,o,g,r,a,m){i['CrDXObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://storage.googleapis.com/crdx-feedback.appspot.com/feedback.js','crdx');

  crdx('setFeedbackButtonLink',
      'https://bugs.chromium.org/p/chromium/issues/entry?cc=andybons@chromium.org&components=Infra%3ECodereview%3ERietveld&labels=Infra-DX');
</script>


</body>
</html>
