<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>b87c968e5a41a1a09166199bf54eee12608f3900 - platform/frameworks/base - Git at Google</title><link rel="stylesheet" type="text/css" href="/+static/base.css"><!-- default customHeadTagPart --></head><body class="Site"><header class="Site-header"><div class="Header"><a class="Header-image" href="/"><img src="//www.gstatic.com/images/branding/lockups/2x/lockup_git_color_108x24dp.png" width="108" height="24" alt="Google Git"></a><div class="Header-menu"> <a class="Header-menuItem" href="https://accounts.google.com/AccountChooser?service=gerritcodereview&amp;continue=https://android.googlesource.com/login/platform/frameworks/base/%2B/b87c968e5a41a1a09166199bf54eee12608f3900">Sign in</a> </div></div></header><div class="Site-content"><div class="Container "><div class="Breadcrumbs"><a class="Breadcrumbs-crumb" href="/?format=HTML">android</a> / <a class="Breadcrumbs-crumb" href="/platform/">platform</a> / <a class="Breadcrumbs-crumb" href="/platform/frameworks/">frameworks</a> / <a class="Breadcrumbs-crumb" href="/platform/frameworks/base/">base</a> / <span class="Breadcrumbs-crumb">b87c968e5a41a1a09166199bf54eee12608f3900</span></div><div class="u-monospace Metadata"><table><tr><th class="Metadata-title">commit</th><td>b87c968e5a41a1a09166199bf54eee12608f3900</td><td><span>[<a href="/platform/frameworks/base/+log/b87c968e5a41a1a09166199bf54eee12608f3900">log</a>]</span> <span>[<a href="/platform/frameworks/base/+archive/b87c968e5a41a1a09166199bf54eee12608f3900.tar.gz">tgz</a>]</span></td></tr><tr><th class="Metadata-title">author</th><td>Charles He &lt;qiurui@google.com&gt;</td><td>Fri Jul 14 14:41:06 2017 +0100</td></tr><tr><th class="Metadata-title">committer</th><td>android-build-team Robot &lt;android-build-team-robot@google.com&gt;</td><td>Tue Aug 22 23:20:12 2017 +0000</td></tr><tr><th class="Metadata-title">tree</th><td><a href="/platform/frameworks/base/+/b87c968e5a41a1a09166199bf54eee12608f3900/">58065d5f3847794bc69adf5c0e329d4a2a7e21be</a></td></tr><tr><th class="Metadata-title">parent</th><td><a href="/platform/frameworks/base/+/b87c968e5a41a1a09166199bf54eee12608f3900%5E">c574568aaede7f652432deb7707f20ae54bbdf9a</a> <span>[<a href="/platform/frameworks/base/+/b87c968e5a41a1a09166199bf54eee12608f3900%5E%21/">diff</a>]</span></td></tr></table></div><pre class="u-pre u-monospace MetadataMessage">Fix security hole in GateKeeperResponse.

GateKeeperResponse has inconsistent writeToParcel() and
createFromParcel() methods, making it possible for a malicious app to
create a Bundle that changes contents after reserialization. Such
Bundles can be used to execute Intents with system privileges.

This CL changes writeToParcel() to make serialization and
deserialization consistent, thus fixing the issue.

Bug: 62998805
Test: use the debug app (see bug)
Change-Id: <a href="https://android-review.googlesource.com/#/q/Ie1c64172c454c3a4b7a0919eb3454f0e38efcd09">Ie1c64172c454c3a4b7a0919eb3454f0e38efcd09</a>
(cherry picked from commit e74cae8f7c3e6b12f2bf2b75427ee8f5b53eca3c)
</pre><ul class="DiffTree"><li><a href="/platform/frameworks/base/+/b87c968e5a41a1a09166199bf54eee12608f3900/core/java/android/service/gatekeeper/GateKeeperResponse.java">core/java/android/service/gatekeeper/GateKeeperResponse.java</a><span class="DiffTree-action DiffTree-action--modify">[<a href="/platform/frameworks/base/+/b87c968e5a41a1a09166199bf54eee12608f3900%5E%21/#F0">diff</a>]</span></li></ul><div class="DiffSummary">1 file changed</div><div class="TreeDetail"><div class="u-sha1 u-monospace TreeDetail-sha1">tree: 58065d5f3847794bc69adf5c0e329d4a2a7e21be</div><ol class="FileList"><li class="FileList-item FileList-item--regularFile" title="Regular file - Android.bp"><a class="FileList-itemLink" href="/platform/frameworks/base/+/b87c968e5a41a1a09166199bf54eee12608f3900/Android.bp">Android.bp</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - Android.mk"><a class="FileList-itemLink" href="/platform/frameworks/base/+/b87c968e5a41a1a09166199bf54eee12608f3900/Android.mk">Android.mk</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - CleanSpec.mk"><a class="FileList-itemLink" href="/platform/frameworks/base/+/b87c968e5a41a1a09166199bf54eee12608f3900/CleanSpec.mk">CleanSpec.mk</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - MODULE_LICENSE_APACHE2"><a class="FileList-itemLink" href="/platform/frameworks/base/+/b87c968e5a41a1a09166199bf54eee12608f3900/MODULE_LICENSE_APACHE2">MODULE_LICENSE_APACHE2</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - NOTICE"><a class="FileList-itemLink" href="/platform/frameworks/base/+/b87c968e5a41a1a09166199bf54eee12608f3900/NOTICE">NOTICE</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - PREUPLOAD.cfg"><a class="FileList-itemLink" href="/platform/frameworks/base/+/b87c968e5a41a1a09166199bf54eee12608f3900/PREUPLOAD.cfg">PREUPLOAD.cfg</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - apct-tests/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/b87c968e5a41a1a09166199bf54eee12608f3900/apct-tests/">apct-tests/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - api/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/b87c968e5a41a1a09166199bf54eee12608f3900/api/">api/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - cmds/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/b87c968e5a41a1a09166199bf54eee12608f3900/cmds/">cmds/</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - compiled-classes-phone"><a class="FileList-itemLink" href="/platform/frameworks/base/+/b87c968e5a41a1a09166199bf54eee12608f3900/compiled-classes-phone">compiled-classes-phone</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - core/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/b87c968e5a41a1a09166199bf54eee12608f3900/core/">core/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - data/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/b87c968e5a41a1a09166199bf54eee12608f3900/data/">data/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - docs/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/b87c968e5a41a1a09166199bf54eee12608f3900/docs/">docs/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - drm/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/b87c968e5a41a1a09166199bf54eee12608f3900/drm/">drm/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - graphics/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/b87c968e5a41a1a09166199bf54eee12608f3900/graphics/">graphics/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - keystore/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/b87c968e5a41a1a09166199bf54eee12608f3900/keystore/">keystore/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - legacy-test/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/b87c968e5a41a1a09166199bf54eee12608f3900/legacy-test/">legacy-test/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - libs/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/b87c968e5a41a1a09166199bf54eee12608f3900/libs/">libs/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - location/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/b87c968e5a41a1a09166199bf54eee12608f3900/location/">location/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - media/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/b87c968e5a41a1a09166199bf54eee12608f3900/media/">media/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - native/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/b87c968e5a41a1a09166199bf54eee12608f3900/native/">native/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - nfc-extras/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/b87c968e5a41a1a09166199bf54eee12608f3900/nfc-extras/">nfc-extras/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - obex/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/b87c968e5a41a1a09166199bf54eee12608f3900/obex/">obex/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - opengl/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/b87c968e5a41a1a09166199bf54eee12608f3900/opengl/">opengl/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - packages/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/b87c968e5a41a1a09166199bf54eee12608f3900/packages/">packages/</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - pathmap.mk"><a class="FileList-itemLink" href="/platform/frameworks/base/+/b87c968e5a41a1a09166199bf54eee12608f3900/pathmap.mk">pathmap.mk</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - preloaded-classes"><a class="FileList-itemLink" href="/platform/frameworks/base/+/b87c968e5a41a1a09166199bf54eee12608f3900/preloaded-classes">preloaded-classes</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - proto/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/b87c968e5a41a1a09166199bf54eee12608f3900/proto/">proto/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - rs/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/b87c968e5a41a1a09166199bf54eee12608f3900/rs/">rs/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - samples/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/b87c968e5a41a1a09166199bf54eee12608f3900/samples/">samples/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - sax/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/b87c968e5a41a1a09166199bf54eee12608f3900/sax/">sax/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - services/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/b87c968e5a41a1a09166199bf54eee12608f3900/services/">services/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - telecomm/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/b87c968e5a41a1a09166199bf54eee12608f3900/telecomm/">telecomm/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - telephony/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/b87c968e5a41a1a09166199bf54eee12608f3900/telephony/">telephony/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - test-runner/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/b87c968e5a41a1a09166199bf54eee12608f3900/test-runner/">test-runner/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - tests/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/b87c968e5a41a1a09166199bf54eee12608f3900/tests/">tests/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - tools/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/b87c968e5a41a1a09166199bf54eee12608f3900/tools/">tools/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - vr/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/b87c968e5a41a1a09166199bf54eee12608f3900/vr/">vr/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - wifi/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/b87c968e5a41a1a09166199bf54eee12608f3900/wifi/">wifi/</a></li></ol></div></div> <!-- Container --></div> <!-- Site-content --><footer class="Site-footer"><div class="Footer"><span class="Footer-poweredBy">Powered by <a href="https://gerrit.googlesource.com/gitiles/">Gitiles</a>| <a href="https://policies.google.com/privacy">Privacy</a></span><span class="Footer-formats"><a class="u-monospace Footer-formatsItem" href="?format=TEXT">txt</a> <a class="u-monospace Footer-formatsItem" href="?format=JSON">json</a></span></div></footer></body></html>