-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

IBM SECURITY ADVISORY

First Issued: Thu Jun 20 13:00:02 CDT 2012
 Updated: Mon Oct 29 11:43:29 CDT 2012
 Update: IFIX and CSUM for 6100-07-04
 Update: New ifixes for the latest SP's
 Updated: Thu May 23 11:04:10 CDT 2014
 Update: New APAR/Interim Fixes
 Update: CONTACT INFORMATION
 Update: ACKNOWLEDGMENTS
|Updated: Thu Jun  5 13:01:39 CDT 2014
|Update: Changed CVE# from CVE-2012-2179 to CVE-2014-3977
|Update: New CVSS Temporal Score link

The most recent version of this document is available here:

http://aix.software.ibm.com/aix/efixes/security/libodm_advisory.asc
===============================================================================
                           VULNERABILITY SUMMARY

VULNERABILITY:      Arbitary file overwrite symlink in libodm

PLATFORMS:          6.1, and 7.1 releases
                    VIOS 2.2.*

SOLUTION:           Apply the fix as described below

THREAT:             A local attacker could gain lateral or elevated privileges

|CVE Number:         CVE-2014-3977

Reboot required?    YES
Workarounds?        NO
Protected by FPM?   NO
Protected by SED?   NO
===============================================================================
                           DETAILED INFORMATION

I. DESCRIPTION

    AIX could allow a arbitrary file overwrite symlink vulnerability
    due to libodm.a bug. 

II. CVSS

    CVSS Base Score: 6.9
|   CVSS Temporal Score: See http://xforce.iss.net/xforce/xfdb/93595 for the current score
    CVSS Environmental Score*: Undefined
    CVSS Vector: (AV:L/AC:M/Au:N/C:C/I:C/A:C)

III. PLATFORM VULNERABILITY ASSESSMENT

    Note: To use the following commands on VIOS you must first
    execute:

    oem_setup_env

    To determine if your system is vulnerable, execute the following
    command:

    lslpp -L bos.rte.odm

    The following fileset levels are vulnerable:

    AIX Fileset        Lower Level   Upper Level   KEY
    --------------------------------------------------------
    bos.rte.odm        6.1.7.0       6.1.7.16      key_w_fix
    bos.rte.odm        6.1.8.0       6.1.8.0       key_w_fix
    bos.rte.odm        6.1.9.0       6.1.9.0       key_w_fix
    bos.rte.odm        7.1.1.0       7.1.1.16      key_w_fix
    bos.rte.odm        7.1.2.0       7.1.2.15      key_w_fix
    bos.rte.odm        7.1.3.0       7.1.3.0       key_w_fix

    AIX Fileset (VIOS)  Lower Level           Upper Level
    ----------------------------------------------------------------
    bos.rte.odm         6.1.7.0(2.2.1.0)      6.1.7.16(2.2.1.8)
    bos.rte.odm         6.1.8.0(2.2.2.0)      6.1.8.0(2.2.2.4)
    bos.rte.odm         6.1.9.0(2.2.3.0)      6.1.9.0 (2.2.3.2)


IV. SOLUTIONS

    A. APARS

        IBM has assigned the following APARs to this problem:

        AIX Level        APAR number     Availability      KEY
        ------------------------------------------------------------
        6.1.7            IV60313         08/29/2014 SP10   key_w_fix
        6.1.8            IV60311         08/29/2014 SP5    key_w_fix
        6.1.9            IV60299         06/03/2014 SP3    key_w_fix
        7.1.1            IV60312         08/29/2014 SP10   key_w_fix
        7.1.2            IV60314         08/29/2014 SP5    key_w_fix
        7.1.3            IV60303         06/03/2014 SP3    key_w_fix

        Subscribe to the APARs here:

        http://www.ibm.com/support/docview.wss?uid=isg1IV60313
        http://www.ibm.com/support/docview.wss?uid=isg1IV60311
        http://www.ibm.com/support/docview.wss?uid=isg1IV60299
        http://www.ibm.com/support/docview.wss?uid=isg1IV60312
        http://www.ibm.com/support/docview.wss?uid=isg1IV60314
        http://www.ibm.com/support/docview.wss?uid=isg1IV60303

        By subscribing, you will receive periodic email alerting you
        to the status of the APAR, and a link to download the fix once
        it becomes available.

    B. FIXES

        Fixes are available.  The fixes can be downloaded via ftp
        from:

        ftp://aix.software.ibm.com/aix/efixes/security/libodm_ifix.tar

        The link above is to a tar file containing this signed
        advisory, fix packages, and PGP signatures for each package.
        The fixes below include prerequisite checking. This will
        enforce the correct mapping between the fixes and AIX
        Technology Levels.

        AIX Level    Interim Fix (*.Z)            KEY
        ---------------------------------------------------
        6.1.7.9      IV60313s9a.140515.epkg.Z     key_w_fix
        6.1.8.4      IV60311s4a.140515.epkg.Z     key_w_fix
        6.1.9.2      IV60299s2a.140515.epkg.Z     key_w_fix
        7.1.1.9      IV60312s9a.140515.epkg.Z     key_w_fix
        7.1.2.4      IV60314s4a.140515.epkg.Z     key_w_fix
        7.1.3.2      IV60303s2a.140515.epkg.Z     key_w_fix

        VIOS Level   Interim Fix (*.Z)
        -------------------------------------
        2.2.1.8      IV60313s9a.140515.epkg.Z
        2.2.2.4      IV60311s4a.140515.epkg.Z
        2.2.3.2      IV60299s2a.140515.epkg.Z

        To extract the fixes from the tar file:

        tar xvf libodm_ifix.tar
        cd libodm_ifix

        Verify you have retrieved the fixes intact:

        The checksums below were generated using the
        "csum -h SHA1" (sha1sum) command is the followng:

        csum -h SHA1 (sha1sum)                    filename
        ------------------------------------------------------------------
        3f0fad2c7aa306c3734abfe37a90da27f2746b0b  IV60313s9a.140515.epkg.Z
        838ecef0b07ce299db71ee75b4b4cf7421bb512d  IV60311s4a.140515.epkg.Z
        d2d9140cf0d34eb8315dd07b03e5aedecd640aba  IV60299s2a.140515.epkg.Z
        ef83ed48203525ffa96c91184732778c8657e60e  IV60312s9a.140515.epkg.Z
        72b88677f23d2972f16d827b2d77e801eea833c7  IV60314s4a.140515.epkg.Z
        ba76617832bb803737fa4f8aee210846631632b3  IV60303s2a.140515.epkg.Z

        To verify the sum, use the text of this advisory as input to sha1sum.
        For example:

        csum -h SHA1 -i Advisory.asc
        sha1sum -c Advisory.asc

        These sums should match exactly. The PGP signatures in the tar
        file and on this advisory can also be used to verify the
        integrity of the fixes.  If the sums or signatures cannot be
        confirmed, contact IBM AIX Security at
        security-alert@austin.ibm.com and describe the discrepancy.

     C. FIX AND INTERIM FIX INSTALLATION

        IMPORTANT: If possible, it is recommended that a mksysb backup
        of the system be created.  Verify it is both bootable and
        readable before proceeding.

        To preview a fix installation:

        installp -a -d fix_name -p all  # where fix_name is the name of the
                                        # fix package being previewed.
        To install a fix package:

        installp -a -d fix_name -X all  # where fix_name is the name of the
                                        # fix package being installed.

        Interim fixes have had limited functional and regression
        testing but not the full regression testing that takes place
        for Service Packs; thus, IBM does not warrant the fully
        correct functionality of an interim fix.

        Interim fix management documentation can be found at:

        http://www14.software.ibm.com/webapp/set2/sas/f/aix.efixmgmt/home.html

        To preview an interim fix installation:

        emgr -e ipkg_name -p         # where ipkg_name is the name of the
                                     # interim fix package being previewed.

        To install an interim fix package:

        emgr -e ipkg_name -X         # where ipkg_name is the name of the
                                     # interim fix package being installed.

V. WORKAROUNDS

    None

VI. OBTAINING FIXES

    AIX security fixes can be downloaded from:

        ftp://aix.software.ibm.com/aix/efixes/security

    AIX fixes can be downloaded from:

        http://www.ibm.com/eserver/support/fixes/fixcentral/main/pseries/aix

    NOTE: Affected customers are urged to upgrade to the latest
    applicable Technology Level and Service Pack.

VII. CONTACT INFORMATION

    If you would like to receive AIX Security Advisories via email,
    please visit:

        http://www.ibm.com/systems/support
 
    and click on the "My notifications" link.

    To view previously issued advisories, please visit:
 
        http://www14.software.ibm.com/webapp/set2/subscriptions/onvdq

    Comments regarding the content of this announcement can be
    directed to:

        security-alert@austin.ibm.com

    To request the PGP public key that can be used to communicate
    securely with the AIX Security Team you can either:

        A. Send an email with "get key" in the subject line to:

            security-alert@austin.ibm.com

        B. Download the key from a PGP Public Key Server. The key ID is:

            0x28BFAA12

    Please contact your local IBM AIX support center for any
    assistance.

    eServer is a trademark of International Business Machines
    Corporation.  IBM, AIX and pSeries are registered trademarks of
    International Business Machines Corporation.  All other trademarks
    are property of their respective holders.

VIII. ACKNOWLEDGMENTS

    This vulnerability was originally reported by Jakub Wartak.
    Update to vulnerability requiring new Interim Fixes was reported by 
    Tim Brown from Portcullis Computer Security Ltd.

IX. REFERENCES:

    Complete CVSS Guide: http://www.first.org/cvss/cvss-guide.html
    On-line Calculator V2: http://nvd.nist.gov/cvss.cfm?calculator&adv&version=2
    X-Force Vulnerability Database: http://xforce.iss.net/xforce/xfdb/75510
    CVE-2012-2179: http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-2179

    *The CVSS Environment Score is customer environment specific and will
    ultimately impact the Overall CVSS Score. Customers can evaluate the
    impact of this vulnerability in their environments by accessing the links
    in the Reference section of this Flash.

    Note: According to the Forum of Incident Response and Security Teams
    (FIRST), the Common Vulnerability Scoring System (CVSS) is an "industry
    open standard designed to convey vulnerability severity and help to
    determine urgency and priority of response." IBM PROVIDES THE CVSS SCORES
    "AS IS" WITHOUT WARRANTY OF ANY KIND, INCLUDING THE IMPLIED WARRANTIES OF
    MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. CUSTOMERS ARE
    RESPONSIBLE FOR ASSESSING THE IMPACT OF ANY ACTUAL OR POTENTIAL SECURITY
    VULNERABILITY.

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.13 (AIX)

iEYEARECAAYFAlOQuLMACgkQ4fmd+Ci/qhLnzQCeJzqbd33F6y6+sGBOKTd4zOmX
9a0AniX5j1JrHDpSzf8CeHwPNbZEAx65
=dH4m
-----END PGP SIGNATURE-----
