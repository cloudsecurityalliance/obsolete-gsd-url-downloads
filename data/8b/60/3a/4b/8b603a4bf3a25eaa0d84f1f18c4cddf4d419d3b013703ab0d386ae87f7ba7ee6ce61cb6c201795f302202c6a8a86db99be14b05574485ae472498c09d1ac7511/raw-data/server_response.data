<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
<link rel="icon" href="/favicon.png">
<title>#737051 - python-logilab-common: insecure use of /tmp (CVE-2014-1838 CVE-2014-1839) - Debian Bug report logs</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="/css/bugs.css" type="text/css">

<link rel="canonical" href="&lt;a href=&quot;bugreport.cgi?bug=737051&quot;&gt;737051&lt;/a&gt;">
<script type="text/javascript">
<!--
function toggle_infmessages()
{
        allDivs=document.getElementsByTagName("div");
        for (var i = 0 ; i < allDivs.length ; i++ )
        {
                if (allDivs[i].className == "infmessage")
                {
                        allDivs[i].style.display=(allDivs[i].style.display == 'none' | allDivs[i].style.display == '') ? 'block' : 'none';
                }
        }
}
-->
</script>
</head>
<body>
<h1>Debian Bug report logs - 
<a href="mailto:737051@bugs.debian.org">#737051</a><br>
python-logilab-common: insecure use of /tmp (CVE-2014-1838 CVE-2014-1839)</h1>
<div class="versiongraph"><a href="version.cgi?absolute=0;package=python-logilab-common;fixed=logilab-common%2F0.61.0-1;collapse=1;info=1;found=logilab-common%2F0.60.1-1"><img alt="version graph" src="version.cgi?width=2;found=logilab-common%2F0.60.1-1;absolute=0;package=python-logilab-common;fixed=logilab-common%2F0.61.0-1;collapse=1;height=2"></a></div>
<div class="pkginfo">
  <p>Package:
     <a class="submitter" href="pkgreport.cgi?package=python-logilab-common">python-logilab-common</a>;
Maintainer for <a href="pkgreport.cgi?package=python-logilab-common">python-logilab-common</a> is <a href="pkgreport.cgi?maint=morph%40debian.org">Sandro Tosi &lt;morph@debian.org&gt;</a>; Source for <a href="pkgreport.cgi?package=python-logilab-common">python-logilab-common</a> is <a href="pkgreport.cgi?src=logilab-common">src:logilab-common</a> (<a href="https://tracker.debian.org/pkg/logilab-common">PTS</a>, <a href="https://buildd.debian.org/logilab-common">buildd</a>, <a href="https://qa.debian.org/popcon.php?package=logilab-common">popcon</a>). </p>

</div>

<div class="buginfo">
  <p>Reported by: <a href="pkgreport.cgi?submitter=jwilk%40debian.org">Jakub Wilk &lt;jwilk@debian.org&gt;</a></p>
  <p>Date: Wed, 29 Jan 2014 19:30:02 UTC</p>

<p>Severity: important</p>
<p>Tags: fixed-upstream, security, upstream</p>

<p>Found in version logilab-common/0.60.1-1</p>
<p>Fixed in version logilab-common/0.61.0-1</p>

<p><strong>Done:</strong> Sandro Tosi &lt;morph@debian.org&gt;</p>

<p>Bug is archived. No further changes may be made.<p></div>

<p><a href="javascript:toggle_infmessages();">Toggle useless messages</a></p><div class="msgreceived"><p>View this report as an <a href="bugreport.cgi?bug=737051;mbox=yes">mbox folder</a>, <a href="bugreport.cgi?bug=737051;mbox=yes;mboxstatus=yes">status mbox</a>, <a href="bugreport.cgi?bug=737051;mbox=yes;mboxmaint=yes">maintainer mbox</a></p></div>

<div class="infmessage"><hr><p>
<a name="1"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, jwilk@debian.org, Debian Python Modules Team &lt;python-modules-team@lists.alioth.debian.org&gt; -->
<!-- time:1391023806 -->
<strong>Report forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, jwilk@debian.org, Debian Python Modules Team &lt;python-modules-team@lists.alioth.debian.org&gt;</code>:<br>
<code>Bug#737051</code>; Package <code>python-logilab-common</code>.
 (Wed, 29 Jan 2014 19:30:06 GMT) (<a href="bugreport.cgi?bug=737051;msg=2">full text</a>, <a href="bugreport.cgi?bug=737051;mbox=yes;msg=2">mbox</a>, <a href="#1">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="3"></a><a name="msg3"></a><a href="#3">Message #3</a> received at submit@bugs.debian.org (<a href="bugreport.cgi?bug=737051;msg=3">full text</a>, <a href="bugreport.cgi?bug=737051;mbox=yes;msg=3">mbox</a>, <a href="mailto:737051@bugs.debian.org?References=%3C20140129192758.GA12404%40jwilk.net%3E&amp;In-Reply-To=%3C20140129192758.GA12404%40jwilk.net%3E&amp;subject=Re%3A%20python-logilab-common%3A%20insecure%20use%20of%20%2Ftmp&amp;body=On%20Wed%2C%2029%20Jan%202014%2020%3A27%3A58%20%2B0100%20Jakub%20Wilk%20%3Cjwilk%40debian.org%3E%20wrote%3A%0A%3E%20Package%3A%20python-logilab-common%0A%3E%20Version%3A%200.60.1-1%0A%3E%20Severity%3A%20important%0A%3E%20Tags%3A%20security%0A%3E%20%0A%3E%20I%20saw%20these%20gems%20in%20logilab%2Fcommon%2Fpdf_ext.py%3A%0A%3E%20%0A%3E%20def%20extract_keys_from_pdf%28filename%29%3A%0A%3E%20%20%20%20%20%20%23%20what%20about%20using%20%27pdftk%20filename%20dump_data_fields%27%20and%20parsing%20the%20output%20%3F%0A%3E%20%20%20%20%20%20os.system%28%27pdftk%20%25s%20generate_fdf%20output%20%2Ftmp%2Ftoto.fdf%27%20%25%20filename%29%0A%3E%20%20%20%20%20%20lines%20%3D%20file%28%27%2Ftmp%2Ftoto.fdf%27%29.readlines%28%29%0A%3E%20%20%20%20%20%20return%20extract_keys%28lines%29%0A%3E%20%0A%3E%20def%20fill_pdf%28infile%2C%20outfile%2C%20fields%29%3A%0A%3E%20%20%20%20%20%20write_fields%28file%28%27%2Ftmp%2Ftoto.fdf%27%2C%20%27w%27%29%2C%20fields%29%0A%3E%20%20%20%20%20%20os.system%28%27pdftk%20%25s%20fill_form%20%2Ftmp%2Ftoto.fdf%20output%20%25s%20flatten%27%20%25%20%28infile%2C%20outfile%29%29%0A%3E%20%0A%3E%20--%20%0A%3E%20Jakub%20Wilk%0A%3E%20%0A%3E%20%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=jwilk%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Jakub Wilk &lt;jwilk@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> Debian Bug Tracking System &lt;submit@bugs.debian.org&gt;</div>
<div class="header"><span class="headerfield">Subject:</span> python-logilab-common: insecure use of /tmp</div>
<div class="header"><span class="headerfield">Date:</span> Wed, 29 Jan 2014 20:27:58 +0100</div>
</div>
<pre class="message flowed">Package: python-logilab-common
Version: 0.60.1-1
Severity: important
Tags: security

I saw these gems in logilab/common/pdf_ext.py:

def extract_keys_from_pdf(filename):
    # what about using &#39;pdftk filename dump_data_fields&#39; and parsing the output ?
    os.system(&#39;pdftk %s generate_fdf output /tmp/toto.fdf&#39; % filename)
    lines = file(&#39;/tmp/toto.fdf&#39;).readlines()
    return extract_keys(lines)

def fill_pdf(infile, outfile, fields):
    write_fields(file(&#39;/tmp/toto.fdf&#39;, &#39;w&#39;), fields)
    os.system(&#39;pdftk %s fill_form /tmp/toto.fdf output %s flatten&#39; % (infile, outfile))

-- 
Jakub Wilk


</pre>

<div class="infmessage"><hr><p>
<a name="4"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Debian Python Modules Team &lt;python-modules-team@lists.alioth.debian.org&gt; -->
<!-- time:1391027045 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Debian Python Modules Team &lt;python-modules-team@lists.alioth.debian.org&gt;</code>:<br>
<code>Bug#737051</code>; Package <code>python-logilab-common</code>.
 (Wed, 29 Jan 2014 20:24:05 GMT) (<a href="bugreport.cgi?bug=737051;msg=5">full text</a>, <a href="bugreport.cgi?bug=737051;mbox=yes;msg=5">mbox</a>, <a href="#4">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="6"></a><a name="msg6"></a><a href="#6">Message #6</a> received at 737051@bugs.debian.org (<a href="bugreport.cgi?bug=737051;msg=6">full text</a>, <a href="bugreport.cgi?bug=737051;mbox=yes;msg=6">mbox</a>, <a href="mailto:737051@bugs.debian.org?body=On%20Wed%2C%2029%20Jan%202014%2021%3A21%3A49%20%2B0100%20Jakub%20Wilk%20%3Cjwilk%40debian.org%3E%20wrote%3A%0A%3E%20More%20vulnerable%20code%20in%20logilab%2Fcommon%2Fshellutils.py%3A%0A%3E%20%0A%3E%20class%20Execute%3A%0A%3E%20%20%20%20%20%20%22%22%22This%20is%20a%20deadlock%20safe%20version%20of%20popen2%20%28no%20stdin%29%2C%20that%20returns%0A%3E%20%20%20%20%20%20an%20object%20with%20errorlevel%2C%20out%20and%20err.%0A%3E%20%20%20%20%20%20%22%22%22%0A%3E%20%0A%3E%20%20%20%20%20%20def%20__init__%28self%2C%20command%29%3A%0A%3E%20%20%20%20%20%20%20%20%20%20outfile%20%3D%20tempfile.mktemp%28%29%0A%3E%20%20%20%20%20%20%20%20%20%20errfile%20%3D%20tempfile.mktemp%28%29%0A%3E%20%20%20%20%20%20%20%20%20%20self.status%20%3D%20os.system%28%22%28%20%25s%20%29%20%3E%25s%202%3E%25s%22%20%25%0A%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%28command%2C%20outfile%2C%20errfile%29%29%20%3E%3E%208%0A%3E%20%20%20%20%20%20%20%20%20%20self.out%20%3D%20open%28outfile%2C%20%22r%22%29.read%28%29%0A%3E%20%20%20%20%20%20%20%20%20%20self.err%20%3D%20open%28errfile%2C%20%22r%22%29.read%28%29%0A%3E%20%20%20%20%20%20%20%20%20%20os.remove%28outfile%29%0A%3E%20%20%20%20%20%20%20%20%20%20os.remove%28errfile%29%0A%3E%20%0A%3E%20%20From%20the%20tempfile.mktemp%28%29%20docstring%3A%20%E2%80%9CThis%20function%20is%20unsafe%20and%20%0A%3E%20should%20not%20be%20used.%20The%20file%20name%20refers%20to%20a%20file%20that%20did%20not%20exist%20at%20%0A%3E%20some%20point%2C%20but%20by%20the%20time%20you%20get%20around%20to%20creating%20it%2C%20someone%20else%20%0A%3E%20may%20have%20beaten%20you%20to%20the%20punch.%E2%80%9D%0A%3E%20%0A%3E%20--%20%0A%3E%20Jakub%20Wilk%0A%3E%20%0A%3E%20%0A&amp;subject=Re%3A%20Bug%23737051%3A%20python-logilab-common%3A%20insecure%20use%20of%20%2Ftmp&amp;In-Reply-To=%3C20140129202149.GA14372%40jwilk.net%3E&amp;References=%3C20140129192758.GA12404%40jwilk.net%3E%0A%20%3C20140129202149.GA14372%40jwilk.net%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=jwilk%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Jakub Wilk &lt;jwilk@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> 737051@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#737051: python-logilab-common: insecure use of /tmp</div>
<div class="header"><span class="headerfield">Date:</span> Wed, 29 Jan 2014 21:21:49 +0100</div>
</div>
<pre class="message flowed">More vulnerable code in logilab/common/shellutils.py:

class Execute:
    &quot;&quot;&quot;This is a deadlock safe version of popen2 (no stdin), that returns
    an object with errorlevel, out and err.
    &quot;&quot;&quot;

    def __init__(self, command):
        outfile = tempfile.mktemp()
        errfile = tempfile.mktemp()
        self.status = os.system(&quot;( %s ) &gt;%s 2&gt;%s&quot; %
                                (command, outfile, errfile)) &gt;&gt; 8
        self.out = open(outfile, &quot;r&quot;).read()
        self.err = open(errfile, &quot;r&quot;).read()
        os.remove(outfile)
        os.remove(errfile)

From the tempfile.mktemp() docstring: “This function is unsafe and 
should not be used. The file name refers to a file that did not exist at 
some point, but by the time you get around to creating it, someone else 
may have beaten you to the punch.”

-- 
Jakub Wilk


</pre>

<div class="infmessage"><hr><p>
<a name="7"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Debian Python Modules Team &lt;python-modules-team@lists.alioth.debian.org&gt; -->
<!-- time:1391405764 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Debian Python Modules Team &lt;python-modules-team@lists.alioth.debian.org&gt;</code>:<br>
<code>Bug#737051</code>; Package <code>python-logilab-common</code>.
 (Mon, 03 Feb 2014 05:36:04 GMT) (<a href="bugreport.cgi?bug=737051;msg=8">full text</a>, <a href="bugreport.cgi?bug=737051;mbox=yes;msg=8">mbox</a>, <a href="#7">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="9"></a>
<!-- request_addr: Salvatore Bonaccorso &lt;carnil@debian.org&gt; -->
<!-- time:1391405765 -->
<strong>Acknowledgement sent</strong>
to <code>Salvatore Bonaccorso &lt;carnil@debian.org&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Debian Python Modules Team &lt;python-modules-team@lists.alioth.debian.org&gt;</code>.
 (Mon, 03 Feb 2014 05:36:05 GMT) (<a href="bugreport.cgi?bug=737051;msg=10">full text</a>, <a href="bugreport.cgi?bug=737051;mbox=yes;msg=10">mbox</a>, <a href="#9">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="11"></a><a name="msg11"></a><a href="#11">Message #11</a> received at 737051@bugs.debian.org (<a href="bugreport.cgi?bug=737051;msg=11">full text</a>, <a href="bugreport.cgi?bug=737051;mbox=yes;msg=11">mbox</a>, <a href="mailto:737051@bugs.debian.org?References=%3C20140129192758.GA12404%40jwilk.net%3E%0A%20%3C20140129202149.GA14372%40jwilk.net%3E%0A%20%3C20140203053233.GA21385%40elende.valinor.li%3E&amp;subject=Re%3A%20Bug%23737051%3A%20python-logilab-common%3A%20insecure%20use%20of%20%2Ftmp&amp;In-Reply-To=%3C20140203053233.GA21385%40elende.valinor.li%3E&amp;body=On%20Mon%2C%203%20Feb%202014%2006%3A32%3A33%20%2B0100%20Salvatore%20Bonaccorso%20%3Ccarnil%40debian.org%3E%20wrote%3A%0A%3E%20Control%3A%20retitle%20-1%20python-logilab-common%3A%20insecure%20use%20of%20%2Ftmp%20%28CVE-2014-1838%20CVE-2014-1839%29%0A%3E%20%0A%3E%20Hi%20Jakub%2C%0A%3E%20%0A%3E%20FYI%2C%20two%20CVEs%20were%20assigned%20for%20these%20issues%3A%20CVE-2014-1838%20and%0A%3E%20CVE-2014-1839%2C%20see%20%5B1%5D%20for%20the%20assignment.%0A%3E%20%0A%3E%20%20%5B1%5D%20http%3A%2F%2Fmarc.info%2F%3Fl%3Doss-security%26m%3D139139947905109%26w%3D2%0A%3E%20%0A%3E%20Regards%2C%0A%3E%20Salvatore%0A%3E%20%0A%3E%20%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=carnil%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Salvatore Bonaccorso &lt;carnil@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> Jakub Wilk &lt;jwilk@debian.org&gt;, 737051@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#737051: python-logilab-common: insecure use of /tmp</div>
<div class="header"><span class="headerfield">Date:</span> Mon, 3 Feb 2014 06:32:33 +0100</div>
</div>
<pre class="message">Control: retitle -1 python-logilab-common: insecure use of /tmp (<a href="https://security-tracker.debian.org/tracker/CVE-2014-1838">CVE-2014-1838</a> CVE-2014-1839)

Hi Jakub,

FYI, two CVEs were assigned for these issues: <a href="https://security-tracker.debian.org/tracker/CVE-2014-1838">CVE-2014-1838</a> and
<a href="https://security-tracker.debian.org/tracker/CVE-2014-1839">CVE-2014-1839</a>, see [1] for the assignment.

 [1] <a href="http://marc.info/?l=oss-security&amp;m=139139947905109&amp;w=2">http://marc.info/?l=oss-security&amp;m=139139947905109&amp;w=2</a>

Regards,
Salvatore


</pre>

<div class="msgreceived"><hr><p>
<a name="12"></a>
<!-- command:title -->
<!-- requester: Salvatore Bonaccorso &lt;carnil@debian.org&gt; -->
<!-- request_addr: 737051-submit@bugs.debian.org -->
<!-- time:1391405765 -->
<!-- new_data:
$new_data = {
              &#39;subject&#39; =&gt; &#39;python-logilab-common: insecure use of /tmp (CVE-2014-1838 CVE-2014-1839)&#39;
            };
-->
<!-- old_data:
$old_data = {
              &#39;subject&#39; =&gt; &#39;python-logilab-common: insecure use of /tmp&#39;
            };
-->
<strong>Changed Bug title to &#39;python-logilab-common: insecure use of /tmp (CVE-2014-1838 CVE-2014-1839)&#39; from &#39;python-logilab-common: insecure use of /tmp&#39;</strong>
Request was from <code>Salvatore Bonaccorso &lt;carnil@debian.org&gt;</code>
to <code>737051-submit@bugs.debian.org</code>.
 (Mon, 03 Feb 2014 05:36:05 GMT) (<a href="bugreport.cgi?bug=737051;msg=13">full text</a>, <a href="bugreport.cgi?bug=737051;mbox=yes;msg=13">mbox</a>, <a href="#12">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="14"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Debian Python Modules Team &lt;python-modules-team@lists.alioth.debian.org&gt; -->
<!-- time:1391436904 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Debian Python Modules Team &lt;python-modules-team@lists.alioth.debian.org&gt;</code>:<br>
<code>Bug#737051</code>; Package <code>python-logilab-common</code>.
 (Mon, 03 Feb 2014 14:15:04 GMT) (<a href="bugreport.cgi?bug=737051;msg=15">full text</a>, <a href="bugreport.cgi?bug=737051;mbox=yes;msg=15">mbox</a>, <a href="#14">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="16"></a>
<!-- request_addr: Julien Cristau &lt;julien.cristau@logilab.fr&gt; -->
<!-- time:1391436904 -->
<strong>Acknowledgement sent</strong>
to <code>Julien Cristau &lt;julien.cristau@logilab.fr&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Debian Python Modules Team &lt;python-modules-team@lists.alioth.debian.org&gt;</code>.
 (Mon, 03 Feb 2014 14:15:04 GMT) (<a href="bugreport.cgi?bug=737051;msg=17">full text</a>, <a href="bugreport.cgi?bug=737051;mbox=yes;msg=17">mbox</a>, <a href="#16">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="18"></a><a name="msg18"></a><a href="#18">Message #18</a> received at 737051@bugs.debian.org (<a href="bugreport.cgi?bug=737051;msg=18">full text</a>, <a href="bugreport.cgi?bug=737051;mbox=yes;msg=18">mbox</a>, <a href="mailto:737051@bugs.debian.org?References=%3C20140203141212.GA8615%40crater2.logilab.fr%3E&amp;body=On%20Mon%2C%203%20Feb%202014%2015%3A12%3A14%20%2B0100%20Julien%20Cristau%20%3Cjulien.cristau%40logilab.fr%3E%20wrote%3A%0A%3E%20Thanks%20for%20the%20report%2C%20Jakub.%0A%3E%20%0A%3E%20On%20Wed%2C%20Jan%2029%2C%202014%20at%2020%3A27%3A58%20%2B0100%2C%20Jakub%20Wilk%20wrote%3A%0A%3E%20%0A%3E%20%3E%20Package%3A%20python-logilab-common%0A%3E%20%3E%20Version%3A%200.60.1-1%0A%3E%20%3E%20Severity%3A%20important%0A%3E%20%3E%20Tags%3A%20security%0A%3E%20%3E%20%0A%3E%20%3E%20I%20saw%20these%20gems%20in%20logilab%2Fcommon%2Fpdf_ext.py%3A%0A%3E%20%3E%20%0A%3E%20%3E%20def%20extract_keys_from_pdf%28filename%29%3A%0A%3E%20%3E%20%20%20%20%20%23%20what%20about%20using%20%27pdftk%20filename%20dump_data_fields%27%20and%20parsing%20the%20output%20%3F%0A%3E%20%3E%20%20%20%20%20os.system%28%27pdftk%20%25s%20generate_fdf%20output%20%2Ftmp%2Ftoto.fdf%27%20%25%20filename%29%0A%3E%20%3E%20%20%20%20%20lines%20%3D%20file%28%27%2Ftmp%2Ftoto.fdf%27%29.readlines%28%29%0A%3E%20%3E%20%20%20%20%20return%20extract_keys%28lines%29%0A%3E%20%3E%20%0A%3E%20%3E%20def%20fill_pdf%28infile%2C%20outfile%2C%20fields%29%3A%0A%3E%20%3E%20%20%20%20%20write_fields%28file%28%27%2Ftmp%2Ftoto.fdf%27%2C%20%27w%27%29%2C%20fields%29%0A%3E%20%3E%20%20%20%20%20os.system%28%27pdftk%20%25s%20fill_form%20%2Ftmp%2Ftoto.fdf%20output%20%25s%20flatten%27%20%25%20%28infile%2C%20outfile%29%29%0A%3E%20%3E%20%0A%3E%20Tracked%20upstream%20as%20http%3A%2F%2Fwww.logilab.org%2Fticket%2F207561%0A%3E%20%0A%3E%20On%20Wed%2C%20Jan%2029%2C%202014%20at%2021%3A21%3A49%20%2B0100%2C%20Jakub%20Wilk%20wrote%3A%0A%3E%20%0A%3E%20%3E%20More%20vulnerable%20code%20in%20logilab%2Fcommon%2Fshellutils.py%3A%0A%3E%20%3E%20%0A%3E%20%3E%20class%20Execute%3A%0A%3E%20%3E%20%20%20%20%20%22%22%22This%20is%20a%20deadlock%20safe%20version%20of%20popen2%20%28no%20stdin%29%2C%20that%20returns%0A%3E%20%3E%20%20%20%20%20an%20object%20with%20errorlevel%2C%20out%20and%20err.%0A%3E%20%3E%20%20%20%20%20%22%22%22%0A%3E%20%3E%20%0A%3E%20%3E%20%20%20%20%20def%20__init__%28self%2C%20command%29%3A%0A%3E%20%3E%20%20%20%20%20%20%20%20%20outfile%20%3D%20tempfile.mktemp%28%29%0A%3E%20%3E%20%20%20%20%20%20%20%20%20errfile%20%3D%20tempfile.mktemp%28%29%0A%3E%20%3E%20%20%20%20%20%20%20%20%20self.status%20%3D%20os.system%28%22%28%20%25s%20%29%20%3E%25s%202%3E%25s%22%20%25%0A%3E%20%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%28command%2C%20outfile%2C%20errfile%29%29%20%3E%3E%208%0A%3E%20%3E%20%20%20%20%20%20%20%20%20self.out%20%3D%20open%28outfile%2C%20%22r%22%29.read%28%29%0A%3E%20%3E%20%20%20%20%20%20%20%20%20self.err%20%3D%20open%28errfile%2C%20%22r%22%29.read%28%29%0A%3E%20%3E%20%20%20%20%20%20%20%20%20os.remove%28outfile%29%0A%3E%20%3E%20%20%20%20%20%20%20%20%20os.remove%28errfile%29%0A%3E%20%3E%20%0A%3E%20%3E%20From%20the%20tempfile.mktemp%28%29%20docstring%3A%20%E2%80%9CThis%20function%20is%20unsafe%20and%0A%3E%20%3E%20should%20not%20be%20used.%20The%20file%20name%20refers%20to%20a%20file%20that%20did%20not%0A%3E%20%3E%20exist%20at%20some%20point%2C%20but%20by%20the%20time%20you%20get%20around%20to%20creating%20it%2C%0A%3E%20%3E%20someone%20else%20may%20have%20beaten%20you%20to%20the%20punch.%E2%80%9D%0A%3E%20%3E%20%0A%3E%20Tracked%20as%20http%3A%2F%2Fwww.logilab.org%2Fticket%2F207562%0A%3E%20%0A%3E%20Cheers%2C%0A%3E%20Julien%0A%3E%20--%20%0A%3E%20Julien%20Cristau%20%20%20%20%20%20%20%20%20%20%3Cjulien.cristau%40logilab.fr%3E%0A%3E%20Logilab%09%09%20%20%20%20%20%20%20%20http%3A%2F%2Fwww.logilab.fr%2F%0A%3E%20Informatique%20scientifique%20%26%20gestion%20de%20connaissances%0A%3E%20%0A%3E%20%0A&amp;subject=Re%3A%20Bug%23737051%3A%20python-logilab-common%3A%20insecure%20use%20of%20%2Ftmp&amp;In-Reply-To=%3C20140203141212.GA8615%40crater2.logilab.fr%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=julien.cristau%40logilab.fr" alt="">
<div class="header"><span class="headerfield">From:</span> Julien Cristau &lt;julien.cristau@logilab.fr&gt;</div>
<div class="header"><span class="headerfield">To:</span> Jakub Wilk &lt;jwilk@debian.org&gt;, 737051@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: Bug#737051: python-logilab-common: insecure use of /tmp</div>
<div class="header"><span class="headerfield">Date:</span> Mon, 3 Feb 2014 15:12:14 +0100</div>
</div>
<pre class="message">Thanks for the report, Jakub.

On Wed, Jan 29, 2014 at 20:27:58 +0100, Jakub Wilk wrote:

&gt; Package: python-logilab-common
&gt; Version: 0.60.1-1
&gt; Severity: important
&gt; Tags: security
&gt; 
&gt; I saw these gems in logilab/common/pdf_ext.py:
&gt; 
&gt; def extract_keys_from_pdf(filename):
&gt;     # what about using &#39;pdftk filename dump_data_fields&#39; and parsing the output ?
&gt;     os.system(&#39;pdftk %s generate_fdf output /tmp/toto.fdf&#39; % filename)
&gt;     lines = file(&#39;/tmp/toto.fdf&#39;).readlines()
&gt;     return extract_keys(lines)
&gt; 
&gt; def fill_pdf(infile, outfile, fields):
&gt;     write_fields(file(&#39;/tmp/toto.fdf&#39;, &#39;w&#39;), fields)
&gt;     os.system(&#39;pdftk %s fill_form /tmp/toto.fdf output %s flatten&#39; % (infile, outfile))
&gt; 
Tracked upstream as <a href="http://www.logilab.org/ticket/207561">http://www.logilab.org/ticket/207561</a>

On Wed, Jan 29, 2014 at 21:21:49 +0100, Jakub Wilk wrote:

&gt; More vulnerable code in logilab/common/shellutils.py:
&gt; 
&gt; class Execute:
&gt;     &quot;&quot;&quot;This is a deadlock safe version of popen2 (no stdin), that returns
&gt;     an object with errorlevel, out and err.
&gt;     &quot;&quot;&quot;
&gt; 
&gt;     def __init__(self, command):
&gt;         outfile = tempfile.mktemp()
&gt;         errfile = tempfile.mktemp()
&gt;         self.status = os.system(&quot;( %s ) &gt;%s 2&gt;%s&quot; %
&gt;                                 (command, outfile, errfile)) &gt;&gt; 8
&gt;         self.out = open(outfile, &quot;r&quot;).read()
&gt;         self.err = open(errfile, &quot;r&quot;).read()
&gt;         os.remove(outfile)
&gt;         os.remove(errfile)
&gt; 
&gt; From the tempfile.mktemp() docstring: “This function is unsafe and
&gt; should not be used. The file name refers to a file that did not
&gt; exist at some point, but by the time you get around to creating it,
&gt; someone else may have beaten you to the punch.”
&gt; 
Tracked as <a href="http://www.logilab.org/ticket/207562">http://www.logilab.org/ticket/207562</a>

Cheers,
Julien
-- 
Julien Cristau          &lt;julien.cristau@logilab.fr&gt;
Logilab		        <a href="http://www.logilab.fr/">http://www.logilab.fr/</a>
Informatique scientifique &amp; gestion de connaissances


</pre>

<div class="msgreceived"><hr><p>
<a name="19"></a>
<!-- command:tag -->
<!-- requester: Julien Cristau &lt;julien.cristau@logilab.fr&gt; -->
<!-- request_addr: control@bugs.debian.org -->
<!-- time:1392140345 -->
<!-- new_data:
$new_data = {
              &#39;keywords&#39; =&gt; &#39;upstream security fixed-upstream&#39;
            };
-->
<!-- old_data:
$old_data = {
              &#39;keywords&#39; =&gt; &#39;security&#39;
            };
-->
<strong>Added tag(s) upstream and fixed-upstream.</strong>
Request was from <code>Julien Cristau &lt;julien.cristau@logilab.fr&gt;</code>
to <code>control@bugs.debian.org</code>.
 (Tue, 11 Feb 2014 17:39:05 GMT) (<a href="bugreport.cgi?bug=737051;msg=20">full text</a>, <a href="bugreport.cgi?bug=737051;mbox=yes;msg=20">mbox</a>, <a href="#19">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="21"></a>
<!-- command:tag -->
<!-- requester: morph@users.alioth.debian.org -->
<!-- request_addr: control@bugs.debian.org -->
<!-- time:1392741731 -->
<!-- new_data:
$new_data = {
              &#39;keywords&#39; =&gt; &#39;upstream security pending fixed-upstream&#39;
            };
-->
<!-- old_data:
$old_data = {
              &#39;keywords&#39; =&gt; &#39;upstream security fixed-upstream&#39;
            };
-->
<strong>Added tag(s) pending.</strong>
Request was from <code>morph@users.alioth.debian.org</code>
to <code>control@bugs.debian.org</code>.
 (Tue, 18 Feb 2014 16:42:11 GMT) (<a href="bugreport.cgi?bug=737051;msg=22">full text</a>, <a href="bugreport.cgi?bug=737051;mbox=yes;msg=22">mbox</a>, <a href="#21">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="23"></a>
<!-- request_addr: Sandro Tosi &lt;morph@debian.org&gt; -->
<!-- time:1392751265 -->
<strong>Reply sent</strong>
to <code>Sandro Tosi &lt;morph@debian.org&gt;</code>:<br>
You have taken responsibility.
 (Tue, 18 Feb 2014 19:21:05 GMT) (<a href="bugreport.cgi?bug=737051;msg=24">full text</a>, <a href="bugreport.cgi?bug=737051;mbox=yes;msg=24">mbox</a>, <a href="#23">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="25"></a>
<!-- request_addr: Jakub Wilk &lt;jwilk@debian.org&gt; -->
<!-- time:1392751265 -->
<strong>Notification sent</strong>
to <code>Jakub Wilk &lt;jwilk@debian.org&gt;</code>:<br>
Bug acknowledged by developer.
 (Tue, 18 Feb 2014 19:21:05 GMT) (<a href="bugreport.cgi?bug=737051;msg=26">full text</a>, <a href="bugreport.cgi?bug=737051;mbox=yes;msg=26">mbox</a>, <a href="#25">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="27"></a><a name="msg27"></a><a href="#27">Message #27</a> received at 737051-close@bugs.debian.org (<a href="bugreport.cgi?bug=737051;msg=27">full text</a>, <a href="bugreport.cgi?bug=737051;mbox=yes;msg=27">mbox</a>, <a href="mailto:737051@bugs.debian.org?References=%3CE1WFqBp-0005hJ-RI%40franck.debian.org%3E&amp;subject=Re%3A%20Bug%23737051%3A%20fixed%20in%20logilab-common%200.61.0-1&amp;In-Reply-To=%3CE1WFqBp-0005hJ-RI%40franck.debian.org%3E&amp;body=On%20Tue%2C%2018%20Feb%202014%2019%3A18%3A45%20%2B0000%20Sandro%20Tosi%20%3Cmorph%40debian.org%3E%20wrote%3A%0A%3E%20Source%3A%20logilab-common%0A%3E%20Source-Version%3A%200.61.0-1%0A%3E%20%0A%3E%20We%20believe%20that%20the%20bug%20you%20reported%20is%20fixed%20in%20the%20latest%20version%20of%0A%3E%20logilab-common%2C%20which%20is%20due%20to%20be%20installed%20in%20the%20Debian%20FTP%20archive.%0A%3E%20%0A%3E%20A%20summary%20of%20the%20changes%20between%20this%20version%20and%20the%20previous%20one%20is%0A%3E%20attached.%0A%3E%20%0A%3E%20Thank%20you%20for%20reporting%20the%20bug%2C%20which%20will%20now%20be%20closed.%20%20If%20you%0A%3E%20have%20further%20comments%20please%20address%20them%20to%20737051%40bugs.debian.org%2C%0A%3E%20and%20the%20maintainer%20will%20reopen%20the%20bug%20report%20if%20appropriate.%0A%3E%20%0A%3E%20Debian%20distribution%20maintenance%20software%0A%3E%20pp.%0A%3E%20Sandro%20Tosi%20%3Cmorph%40debian.org%3E%20%28supplier%20of%20updated%20logilab-common%20package%29%0A%3E%20%0A%3E%20%28This%20message%20was%20generated%20automatically%20at%20their%20request%3B%20if%20you%0A%3E%20believe%20that%20there%20is%20a%20problem%20with%20it%20please%20contact%20the%20archive%0A%3E%20administrators%20by%20mailing%20ftpmaster%40ftp-master.debian.org%29%0A%3E%20%0A%3E%20%0A%3E%20-----BEGIN%20PGP%20SIGNED%20MESSAGE-----%0A%3E%20Hash%3A%20SHA1%0A%3E%20%0A%3E%20Format%3A%201.8%0A%3E%20Date%3A%20Tue%2C%2018%20Feb%202014%2020%3A03%3A39%20%2B0100%0A%3E%20Source%3A%20logilab-common%0A%3E%20Binary%3A%20python-logilab-common%20python3-logilab-common%0A%3E%20Architecture%3A%20source%20all%0A%3E%20Version%3A%200.61.0-1%0A%3E%20Distribution%3A%20unstable%0A%3E%20Urgency%3A%20medium%0A%3E%20Maintainer%3A%20Sandro%20Tosi%20%3Cmorph%40debian.org%3E%0A%3E%20Changed-By%3A%20Sandro%20Tosi%20%3Cmorph%40debian.org%3E%0A%3E%20Description%3A%20%0A%3E%20%20python-logilab-common%20-%20useful%20miscellaneous%20modules%20used%20by%20Logilab%20projects%0A%3E%20%20python3-logilab-common%20-%20useful%20miscellaneous%20modules%20used%20by%20Logilab%20projects%20%28Python3%29%0A%3E%20Closes%3A%20737051%0A%3E%20Changes%3A%20%0A%3E%20%20logilab-common%20%280.61.0-1%29%20unstable%3B%20urgency%3Dmedium%0A%3E%20%20.%0A%3E%20%20%20%20%2A%20New%20upstream%20release%0A%3E%20%20%20%20%20%20-%20fix%20insecure%20use%20of%20%2Ftmp%2C%20thanks%20to%20Jakub%20Wilk%20for%20the%20report%3B%0A%3E%20%20%20%20%20%20%20%20Closes%3A%20%23737051%0A%3E%20%20%20%20%2A%20Switch%20to%20dh_python2%0A%3E%20%20%20%20%2A%20debian%2Fcontrol%0A%3E%20%20%20%20%20%20-%20switch%20me%20to%20Maintainer%20%28team%20to%20Uploaders%29%0A%3E%20%20%20%20%2A%20debian%2Fcopyright%0A%3E%20%20%20%20%20%20-%20switch%20to%20DEP-5%20format%0A%3E%20Checksums-Sha1%3A%20%0A%3E%20%208a9d9b67972cbf7ca7d5ec9d4d7eab6baa42df46%201634%20logilab-common_0.61.0-1.dsc%0A%3E%20%20700c87f45133a8a20e1ac815f197cc1a5a408e27%20199304%20logilab-common_0.61.0.orig.tar.gz%0A%3E%20%20b27a9255a4b9aded5d76c8e6193e2586d62d8792%207960%20logilab-common_0.61.0-1.debian.tar.xz%0A%3E%20%20539cc182ad26365a532eb57f65205eee6af2d77a%20427084%20python-logilab-common_0.61.0-1_all.deb%0A%3E%20%20dec4f1bff2568afefe24f3b64b9f0bb22f2af4a5%20130482%20python3-logilab-common_0.61.0-1_all.deb%0A%3E%20Checksums-Sha256%3A%20%0A%3E%20%20b33c12d186264d2220b3960071a3c2aed9c0f93e70876a38a56ac17aa20efa2a%201634%20logilab-common_0.61.0-1.dsc%0A%3E%20%200d92e78deeaa16bf23cd94d8b3ea41522d0a110db16657fbe22a52b959d65725%20199304%20logilab-common_0.61.0.orig.tar.gz%0A%3E%20%20c081602050c9facc7dd1aafd2854770562c22c47cead4f592093b0795f3c4aea%207960%20logilab-common_0.61.0-1.debian.tar.xz%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=morph%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Sandro Tosi &lt;morph@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> 737051-close@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Bug#737051: fixed in logilab-common 0.61.0-1</div>
<div class="header"><span class="headerfield">Date:</span> Tue, 18 Feb 2014 19:18:45 +0000</div>
</div>
<pre class="message">Source: logilab-common
Source-Version: 0.61.0-1

We believe that the bug you reported is fixed in the latest version of
logilab-common, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 737051@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Sandro Tosi &lt;morph@debian.org&gt; (supplier of updated logilab-common package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.8
Date: Tue, 18 Feb 2014 20:03:39 +0100
Source: logilab-common
Binary: python-logilab-common python3-logilab-common
Architecture: source all
Version: 0.61.0-1
Distribution: unstable
Urgency: medium
Maintainer: Sandro Tosi &lt;morph@debian.org&gt;
Changed-By: Sandro Tosi &lt;morph@debian.org&gt;
Description: 
 python-logilab-common - useful miscellaneous modules used by Logilab projects
 python3-logilab-common - useful miscellaneous modules used by Logilab projects (Python3)
Closes: <a href="bugreport.cgi?bug=737051">737051</a>
Changes: 
 logilab-common (0.61.0-1) unstable; urgency=medium
 .
   * New upstream release
     - fix insecure use of /tmp, thanks to Jakub Wilk for the report;
       Closes: #<a href="bugreport.cgi?bug=737051">737051</a>
   * Switch to dh_python2
   * debian/control
     - switch me to Maintainer (team to Uploaders)
   * debian/copyright
     - switch to DEP-5 format
Checksums-Sha1: 
 8a9d9b67972cbf7ca7d5ec9d4d7eab6baa42df46 1634 logilab-common_0.61.0-1.dsc
 700c87f45133a8a20e1ac815f197cc1a5a408e27 199304 logilab-common_0.61.0.orig.tar.gz
 b27a9255a4b9aded5d76c8e6193e2586d62d8792 7960 logilab-common_0.61.0-1.debian.tar.xz
 539cc182ad26365a532eb57f65205eee6af2d77a 427084 python-logilab-common_0.61.0-1_all.deb
 dec4f1bff2568afefe24f3b64b9f0bb22f2af4a5 130482 python3-logilab-common_0.61.0-1_all.deb
Checksums-Sha256: 
 b33c12d186264d2220b3960071a3c2aed9c0f93e70876a38a56ac17aa20efa2a 1634 logilab-common_0.61.0-1.dsc
 0d92e78deeaa16bf23cd94d8b3ea41522d0a110db16657fbe22a52b959d65725 199304 logilab-common_0.61.0.orig.tar.gz
 c081602050c9facc7dd1aafd2854770562c22c47cead4f592093b0795f3c4aea 7960 logilab-common_0.61.0-1.debian.tar.xz
 e36adb02aaead81b5ac4c8f04c0b9da1eed3436c9e55cf1287449dad85caebc2 427084 python-logilab-common_0.61.0-1_all.deb
 6f49eac0cf80f8c91f62d0c5603fe966afd7c2206565f22331dbda0ac338fdd1 130482 python3-logilab-common_0.61.0-1_all.deb
Files: 
 3662c6a4c6b1f3e74419b0a75eee1019 1634 python optional logilab-common_0.61.0-1.dsc
 1506cb79a2468ddf7b09b6bf2855a697 199304 python optional logilab-common_0.61.0.orig.tar.gz
 0181dd14a78955f9e449dc9326cde794 7960 python optional logilab-common_0.61.0-1.debian.tar.xz
 e2dc229861623dd7ea1f7ef76ce23d0b 427084 python optional python-logilab-common_0.61.0-1_all.deb
 2aa971ff98d9c2c7d48d3a9bf05b7f88 130482 python optional python3-logilab-common_0.61.0-1_all.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (GNU/Linux)

iEYEARECAAYFAlMDr4AACgkQAukwV0RN2VCpfwCffmFl9lBV3qkcoKjl7cUW/qMV
rqgAn2qXpmlG/XI2R2yFYB7UY9pWzU5i
=1T1l
-----END PGP SIGNATURE-----



</pre>

<div class="msgreceived"><hr><p>
<a name="28"></a>
<!-- command:archive -->
<!-- requester: Debbugs Internal Request &lt;owner@bugs.debian.org&gt; -->
<!-- request_addr: internal_control@bugs.debian.org -->
<!-- time:1395646205 -->
<!-- new_data:
$new_data = {};
-->
<!-- old_data:
$old_data = {};
-->
<strong>Bug archived.</strong>
Request was from <code>Debbugs Internal Request &lt;owner@bugs.debian.org&gt;</code>
to <code>internal_control@bugs.debian.org</code>.
 (Mon, 24 Mar 2014 07:30:05 GMT) (<a href="bugreport.cgi?bug=737051;msg=29">full text</a>, <a href="bugreport.cgi?bug=737051;mbox=yes;msg=29">mbox</a>, <a href="#28">link</a>).</p></p></div>

<hr>
<p class="msgreceived">Send a report that <a href="https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=737051">this bug log contains spam</a>.</p>
<hr>
<ADDRESS>Debian bug tracking system administrator &lt;<A HREF="mailto:owner@bugs.debian.org">owner@bugs.debian.org</A>&gt;.
Last modified:
<!--timestamp-->Sat Oct 30 18:28:29 2021<!--end timestamp-->; 
Machine Name:
<!--machinename-->buxtehude<!--machinename-->
<P>
<A HREF="https://www.debian.org/Bugs/">Debian Bug tracking system</A>
</p>
<p>
  Debbugs is free software and licensed under the terms of the GNU
  Public License version 2. The current version can be obtained
  from <a href="https://bugs.debian.org/debbugs-source/">https://bugs.debian.org/debbugs-source/</a>.
</p>
<p>
Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.
</p>
</ADDRESS>

</body>
</html>
