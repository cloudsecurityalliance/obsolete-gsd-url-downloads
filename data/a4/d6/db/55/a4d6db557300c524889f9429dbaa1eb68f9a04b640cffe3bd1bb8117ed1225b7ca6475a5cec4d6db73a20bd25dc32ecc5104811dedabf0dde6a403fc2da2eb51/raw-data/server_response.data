<!DOCTYPE html
	PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
	 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
<title>Cryptology ePrint Archive: Report 2016/1195 - Constant-Time Callees with Variable-Time Callers</title>
<link rev="made" href="mailto:eprint-admin%40iacr.org" />
<meta content="Cesar Pereida Garcïa" name="citation_author" />
<meta content="Billy Bob Brumley" name="citation_author" />
<meta viewport="initial-scale=1, width=device-width" />
<meta content="Constant-Time Callees with Variable-Time Callers" name="citation_title" />
<meta content="2016" name="citation_publication_date" />
<meta content="Cryptology ePrint Archive" name="citation_journal_title" />
<meta content="https://eprint.iacr.org/2016/1195.pdf" name="citation_pdf_url" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
</head>
<body bgcolor="white">
<h2>Cryptology ePrint Archive: Report 2016/1195</h2><p />
<p /><script type="text/javascript" 
src="/javascript/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML">  
MathJax.Hub.Config({
extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js"], 
jax: ["input/TeX", "output/HTML-CSS"], 
tex2jax: {
inlineMath: [ ['$','$'], ["\\(","\\)"] ], 
displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
}, 
"HTML-CSS": { availableFonts: ["TeX"] }
}); 
</script>
<b>Constant-Time  Callees  with  Variable-Time  Callers</b><p />
<i>Cesar  Pereida  Garcïa   and  Billy  Bob  Brumley</i><p />
<b>Abstract: </b>Side-channel  attacks  are  a  serious  threat  to  security-critical  software.  To  mitigate  remote  timing   and  cache-timing  attacks,  many  ubiquitous  cryptography  software  libraries  feature  constant-time  implementations  of  cryptographic  primitives.  In  this  work,  we  disclose  a  vulnerability  in  OpenSSL 1.0.1u  that  recovers  ECDSA  private  keys  for  the  standardized  elliptic  curve  P-256  despite  the  library  featuring  both  constant-time  curve  operations   and  modular  inversion  with  microarchitecture  attack  mitigations.  Exploiting  this  defect,  we  target 
the  errant  modular  inversion  code  path  with  a  cache-timing   and  improved 
performance  degradation  attack,  recovering  the  inversion  state  sequence.  We  propose  a  new  approach  of  extracting  a  variable  number  of  nonce  bits  from  these  sequences,   and  improve  upon  the  best  theoretical  result  to  recover  private  keys  in  a  lattice  attack  with  as  few  as 50  signatures   and  corresponding  traces.  As  far  as  we  are  aware,  this  is  the  first  timing  attack  against  OpenSSL  ECDSA  that  does  not  target  scalar  multiplication,  the  first  side-channel  attack  on  cryptosystems
leveraging  P-256  constant-time  scalar  multiplication   and  furthermore,  we  extend  our  attack  to  TLS   and  SSH  protocols,  both  linked  to  OpenSSL  for  P-256  ECDSA  signing.
<p />
<b>Category / Keywords: </b>applied cryptography; elliptic curve cryptography; digital signatures; side-channel analysis; timing attacks; cache-timing attacks; performance degradation; ECDSA; modular inversion; binary extended Euclidean algorithm; lattice attacks; constant-time software; OpenSSL; NIST P-256; CVE-2016-7056<p />
<b>Original Publication</b><b> (in the same form): </b>The 26th USENIX Security Symposium USENIX Security 17 
<p />
<b>Date: </b>received 31 Dec 2016, last revised 29 Aug 2017<p />
<b>Contact author: </b>cesar pereidagarcia at tut fi<p />
<b>Available format(s): </b><a href="/2016/1195.pdf">PDF</a>  | <a href="/eprint-bin/cite.pl?entry=2016/1195">BibTeX Citation</a>
<p />
<b>Note: </b>As appears in USENIX Security 17
<p />
<b>Version: </b><a href="/2016/1195/20170829:065152">20170829:065152</a> (<a href="/eprint-bin/versions.pl?entry=2016/1195">All versions of this report</a>)

<p />
<b>Short URL: </b><a href='https://ia.cr/2016/1195'>ia.cr/2016/1195</a>
<p /><hr />[ <a href="/">Cryptology ePrint archive</a> ]

</body>
</html>