<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="UTF-8">
<meta property="og:type" content="website">
<meta property="og:title" content="1086999 - (CVE-2015-4490) CSP: Asterisk (*) wildcard should not allow blob:, data:, or filesystem: when matching source expressions">
<meta property="og:url" content="https://bugzilla.mozilla.org/show_bug.cgi?id=1086999">
<meta property="og:description"
      content="RESOLVED (ckerschb) in Core - DOM: Security. Last updated 2015-08-15.">
<meta name="twitter:label1" value="Type">
<meta name="twitter:data1" value="defect">
<meta name="twitter:label2" value="Priority">
<meta name="twitter:data2" value="P1">

    <meta name="viewport" content="width=1024">
    <meta name="color-scheme" content="dark light">
    <meta name="generator" content="Bugzilla 20211025.1">
    <meta name="bugzilla-global" content="dummy"
        id="bugzilla-global" data-bugzilla="{&quot;api_token&quot;:&quot;&quot;,&quot;config&quot;:{&quot;basepath&quot;:&quot;\/&quot;},&quot;constant&quot;:{&quot;COMMENT_COLS&quot;:80},&quot;param&quot;:{&quot;maxattachmentsize&quot;:&quot;10240&quot;,&quot;maxusermatches&quot;:&quot;50&quot;,&quot;splinter_base&quot;:&quot;\/page.cgi?id=splinter.html&amp;ignore=\/&quot;},&quot;string&quot;:{&quot;bug_type_required&quot;:&quot;You must select a Type for this bug&quot;,&quot;component_required&quot;:&quot;You must select a Component for this bug&quot;,&quot;description_required&quot;:&quot;You must enter a Description for this bug&quot;,&quot;short_desc_required&quot;:&quot;You must enter a Summary for this bug&quot;,&quot;version_required&quot;:&quot;You must select a Version for this bug&quot;},&quot;user&quot;:{&quot;is_new&quot;:1,&quot;login&quot;:&quot;&quot;}}">
    <title>1086999 - (CVE-2015-4490) CSP: Asterisk (*) wildcard should not allow blob:, data:, or filesystem: when matching source expressions</title>

<link rel="Top" href="/">

  


  
    <link rel="Show" title="Dependency Tree"
          href="/showdependencytree.cgi?id=1086999&amp;hide_resolved=1">
      <link rel="Show" title="Dependency Graph"
            href="/showdependencygraph.cgi?id=1086999">

      <link rel="Show" title="Bug Activity"
            href="/show_activity.cgi?id=1086999">

<link href="/static/v20211025.1/skins/yui.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/standard/global.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BugModal/web/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BMO/web/styles/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/EditComments/web/styles/inline-editor.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-structure-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-theme-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/lib/prism.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Needinfo/web/styles/needinfo.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Review/web/styles/badge.css" rel="stylesheet" type="text/css">



    
<script nonce="08qa6p7mpjobVjqWwNBQbbDIst1SWSLgz6KHnNgSO5H6t0Z3" src="/static/v20211025.1/js/jquery/jquery-min.js"></script><script nonce="08qa6p7mpjobVjqWwNBQbbDIst1SWSLgz6KHnNgSO5H6t0Z3" src="/static/v20211025.1/js/jquery/ui/jquery-ui-min.js"></script><script nonce="08qa6p7mpjobVjqWwNBQbbDIst1SWSLgz6KHnNgSO5H6t0Z3" src="/static/v20211025.1/js/yui.js"></script><script nonce="08qa6p7mpjobVjqWwNBQbbDIst1SWSLgz6KHnNgSO5H6t0Z3" src="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu-min.js"></script><script nonce="08qa6p7mpjobVjqWwNBQbbDIst1SWSLgz6KHnNgSO5H6t0Z3" src="/static/v20211025.1/js/jquery/plugins/devbridgeAutocomplete/devbridgeAutocomplete-min.js"></script><script nonce="08qa6p7mpjobVjqWwNBQbbDIst1SWSLgz6KHnNgSO5H6t0Z3" src="/static/v20211025.1/js/global.js"></script><script nonce="08qa6p7mpjobVjqWwNBQbbDIst1SWSLgz6KHnNgSO5H6t0Z3" src="/static/v20211025.1/js/util.js"></script><script nonce="08qa6p7mpjobVjqWwNBQbbDIst1SWSLgz6KHnNgSO5H6t0Z3" src="/static/v20211025.1/js/dropdown.js"></script>

      <script nonce="08qa6p7mpjobVjqWwNBQbbDIst1SWSLgz6KHnNgSO5H6t0Z3">
          YAHOO.namespace('bugzilla');
          if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
              YAHOO.util.Event._simpleRemove(window, "unload",
                                             YAHOO.util.Event._unload);
          }BUGZILLA.value_descs = JSON.parse('{\"bug_status\":{},\"resolution\":{\"\":\"---\"}}');

  
    var tracking_flags_str = "{\"comments\":{\"cf_tracking_firefox_esr91\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_sumo\":{\"none-needed\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox_relnote\":{\"?\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_a11y_review_project_flag\":{\"requested\":\"Description:\\nPlease provide an explanation of the feature or change. Include a description of the user scenario in which it would be used and how the user would complete the task(s).\\nScreenshots and visual UI specs are welcome, but please include sufficient accompanying explanation so that blind members of the accessibility team are able to understand the feature\/change.\\n\\nHow do we test this?\\nIf there is an implementation to test, please provide instructions for testing it; e.g. setting preferences, other preparation, how to trigger the UI, etc.\\n\\nWhen will this ship?\\nTracking bug\/issue:\\nDesign documents (e.g. Product Requirements Document, UI spec):\\nEngineering lead:\\nProduct manager:\\n\\nThe accessibility team has developed the Mozilla Accessibility Release Guidelines which outline what is needed to make user interfaces accessible:\\nhttps:\/\/wiki.mozilla.org\/Accessibility\/Guidelines\\nPlease describe the accessibility guidelines you considered and what steps you\'ve taken to address them:\\n\\nDescribe any areas of concern to which you want the accessibility team to give special attention:\"},\"cf_tracking_firefox95\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox40\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox94\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox93\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr78\":{\"?\":\"[Tracking Requested - why for this release]:\"}},\"flags\":{\"project\":{\"cf_root_cause\":\"---\",\"cf_tracking_firefox_sumo\":\"---\",\"cf_a11y_review_project_flag\":\"---\",\"cf_webcompat_priority\":\"---\",\"cf_fission_milestone\":\"---\"},\"tracking\":{\"cf_status_firefox_esr78\":\"---\",\"cf_tracking_firefox_esr91\":\"---\",\"cf_status_firefox94\":\"---\",\"cf_tracking_firefox_relnote\":\"---\",\"cf_status_firefox_esr91\":\"---\",\"cf_tracking_thunderbird_esr78\":\"---\",\"cf_status_firefox40\":\"fixed\",\"cf_tracking_firefox93\":\"---\",\"cf_tracking_firefox95\":\"---\",\"cf_tracking_firefox94\":\"---\",\"cf_tracking_firefox40\":\"+\",\"cf_status_firefox95\":\"---\",\"cf_status_firefox93\":\"---\",\"cf_tracking_thunderbird_esr91\":\"---\",\"cf_status_thunderbird_esr91\":\"---\",\"cf_tracking_firefox_esr78\":\"---\",\"cf_status_thunderbird_esr78\":\"---\"}},\"types\":[\"tracking\"]}";
    var TrackingFlags = $.parseJSON(tracking_flags_str);

  

  
  BUGZILLA.bug_id = 1086999;
  BUGZILLA.bug_title = '1086999 - (CVE-2015-4490) CSP: Asterisk (*) wildcard should not allow blob:, data:, or filesystem: when matching source expressions';
  BUGZILLA.bug_summary = 'CSP: Asterisk (*) wildcard should not allow blob:, data:, or filesystem: when matching source expressions';
  BUGZILLA.bug_url = 'https:\/\/bugzilla.mozilla.org\/show_bug.cgi?id=1086999';
  BUGZILLA.bug_keywords = 'dev-doc-complete, sec-moderate, site-compat',
  BUGZILLA.user = {
    id: 0,
    login: '',
    is_insider: false,
    is_timetracker: false,
    can_tag: false,
    timezone: 'America\/Los_Angeles',
    settings: {
      quote_replies: 'quoted_reply',
      zoom_textareas: true,
      remember_collapsed: true,
      inline_attachments: true,
      autosize_comments: false
    }
  };

  BUGZILLA.bug_secure = false;
      </script>
<script nonce="08qa6p7mpjobVjqWwNBQbbDIst1SWSLgz6KHnNgSO5H6t0Z3" src="/static/v20211025.1/extensions/BugModal/web/autosize.min.js"></script><script nonce="08qa6p7mpjobVjqWwNBQbbDIst1SWSLgz6KHnNgSO5H6t0Z3" src="/static/v20211025.1/extensions/ProdCompSearch/web/js/prod_comp_search.js"></script><script nonce="08qa6p7mpjobVjqWwNBQbbDIst1SWSLgz6KHnNgSO5H6t0Z3" src="/static/v20211025.1/extensions/BugModal/web/bug_modal.js"></script><script nonce="08qa6p7mpjobVjqWwNBQbbDIst1SWSLgz6KHnNgSO5H6t0Z3" src="/static/v20211025.1/extensions/BugModal/web/comments.js"></script><script nonce="08qa6p7mpjobVjqWwNBQbbDIst1SWSLgz6KHnNgSO5H6t0Z3" src="/static/v20211025.1/extensions/ComponentWatching/web/js/overlay.js"></script><script nonce="08qa6p7mpjobVjqWwNBQbbDIst1SWSLgz6KHnNgSO5H6t0Z3" src="/static/v20211025.1/js/bugzilla-readable-status-min.js"></script><script nonce="08qa6p7mpjobVjqWwNBQbbDIst1SWSLgz6KHnNgSO5H6t0Z3" src="/static/v20211025.1/js/field.js"></script><script nonce="08qa6p7mpjobVjqWwNBQbbDIst1SWSLgz6KHnNgSO5H6t0Z3" src="/static/v20211025.1/js/comments.js"></script><script nonce="08qa6p7mpjobVjqWwNBQbbDIst1SWSLgz6KHnNgSO5H6t0Z3" src="/static/v20211025.1/extensions/TrackingFlags/web/js/flags.js"></script><script nonce="08qa6p7mpjobVjqWwNBQbbDIst1SWSLgz6KHnNgSO5H6t0Z3" src="/static/v20211025.1/extensions/BMO/web/js/firefox-crash-table.js"></script><script nonce="08qa6p7mpjobVjqWwNBQbbDIst1SWSLgz6KHnNgSO5H6t0Z3" src="/static/v20211025.1/extensions/MozChangeField/web/js/severity-s1-priority-p1.js"></script><script nonce="08qa6p7mpjobVjqWwNBQbbDIst1SWSLgz6KHnNgSO5H6t0Z3" src="/static/v20211025.1/extensions/MozChangeField/web/js/clear-tracking-priority-s1.js"></script><script nonce="08qa6p7mpjobVjqWwNBQbbDIst1SWSLgz6KHnNgSO5H6t0Z3" src="/static/v20211025.1/extensions/MozChangeField/web/js/set-tracking-severity-s1.js"></script><script nonce="08qa6p7mpjobVjqWwNBQbbDIst1SWSLgz6KHnNgSO5H6t0Z3" src="/static/v20211025.1/js/lib/prism.js"></script><script nonce="08qa6p7mpjobVjqWwNBQbbDIst1SWSLgz6KHnNgSO5H6t0Z3" src="/static/v20211025.1/extensions/GoogleAnalytics/web/js/analytics.js"></script><script nonce="08qa6p7mpjobVjqWwNBQbbDIst1SWSLgz6KHnNgSO5H6t0Z3" src="/static/v20211025.1/js/lib/md5.min.js"></script><script nonce="08qa6p7mpjobVjqWwNBQbbDIst1SWSLgz6KHnNgSO5H6t0Z3" src="/static/v20211025.1/extensions/Review/web/js/badge.js"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla@Mozilla" href="/search_plugin.cgi"><link rel="shortcut icon" href="/extensions/BMO/web/images/favicon.ico">
<link rel="canonical" href="https://bugzilla.mozilla.org/show_bug.cgi?id=1086999">
<link rel="shorturl" href="https://bugzilla.mozilla.org/1086999"><meta name="google-analytics" content="UA-36116321-3" data-location="https://bugzilla.mozilla.org/bug/show-modal" data-title="1086999 - (CVE-2015-4490) CSP: Asterisk (*) wildcard should not allow blob:, data:, or filesystem: when matching source expressions">
<script async src="https://www.google-analytics.com/analytics.js"></script><meta name="robots" content="noarchive">
  </head>



  <body
        class="bugzilla-mozilla-org
               skin-standard bug_modal yui-skin-sam">



<div id="wrapper">

<header id="header" role="banner">
  <div class="inner">
    <h1 id="header-title" class="title"><a href="https://bugzilla.mozilla.org/home" title="Go to home page">Bugzilla</a></h1>
    <form role="search" id="header-search" class="quicksearch" action="/buglist.cgi" data-no-csrf>
      <section class="searchbox-outer dropdown" role="combobox" aria-expanded="false" aria-haspopup="listbox"
               aria-labelledby="header-search-label" aria-owns="header-search-dropdown">
        <h2 id="header-search-label">Quick Search</h2>
        <span class="icon" aria-hidden="true"></span>
        <input role="searchbox" id="quicksearch_top" class="dropdown-button" name="quicksearch" autocomplete="off"
               value="" placeholder="Search Bugs"
               title="Enter a bug number or some search terms" aria-controls="header-search-dropdown"
               aria-label="Quick Search"><div id="header-search-dropdown" class="dropdown-content right" role="listbox" style="display: none;">
  <div id="header-search-dropdown-wrapper">
  </div>
</div>
      </section>
    </form>
    <nav id="header-nav">
      <ul class="links">
        <li class="link-browse">
          <a href="/describecomponents.cgi" title="Browse bugs by component">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Browse</span>
          </a>
        </li>
        <li class="link-search">
          <a href="/query.cgi?format=advanced" title="Search bugs using various criteria">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Advanced Search</span>
          </a>
        </li>
      </ul>
      <div class="dropdown">
        <button type="button" id="header-tools-menu-button" class="dropdown-button minor" title="More tools…"
                aria-label="More tools…" aria-expanded="false" aria-haspopup="true" aria-controls="header-tools-menu">
          <span class="icon" aria-hidden="true"></span>
        </button>
        <ul class="dropdown-content left" id="header-tools-menu" role="menu" style="display:none;">
          <li role="presentation">
            <a href="/report.cgi" role="menuitem" tabindex="-1">Reports</a>
          </li>
            <li role="separator"></li>
            <li role="presentation">
              <a href="https://bmo.readthedocs.io/en/latest/" role="menuitem" tabindex="-1">Documentation</a>
            </li>
        </ul>
      </div>
    </nav>
      <ul id="header-login" class="links">
          <li id="moz_new_account_container_top"><a href="/createaccount.cgi">New Account</a></li><li id="mini_login_container_top">
  <a id="login_link_top" href="/index.cgi?GoAheadAndLogIn=1"
     class='show_mini_login_form' data-qs-suffix="_top">Log In</a>

  <div id="mini_login_top" class="mini-popup mini_login bz_default_hidden"><span id="github_mini_login_top" class="mini_login_top">
    <form method="post" action="/github.cgi">
      <input type="hidden" name="github_secret" value="XB3gSyiCsj80LviImpg6CnjPHWn2a6vDRefnZ0Dv9qEvBHxvQFyGONAgu4USCaGauDYxcjM5OcYS0fCjP3LYkTcda7rxfuzEcIRPVz6wP1bVjhX9hg7NIR0J4gB6Lnskepu82lKe8yMiJgkRqpgKWXe1jgZumPtdKp50hhquMz3Fkb2MNXh5SzdioKtYW7Z9eiubRXrfSYzBU9L1XdIgFstvbMmSESlcdAVD2GUNtsqSa83D3J92HElEb8ZSFBob">
      <input type="hidden" name="target_uri" value="https://bugzilla.mozilla.org/show_bug.cgi">
      <input type="image" src="/extensions/GitHubAuth/web/images/sign_in.png" height="22" width="75" align="absmiddle"
             alt="Sign in with GitHub"
             title="Sign in with GitHub"> or
    </form>
  </span>

  <form action="/show_bug.cgi?id=1086999" method="POST"
        data-qs-suffix="_top">

    <input id="Bugzilla_login_top"
           class="bz_login"
           name="Bugzilla_login"
           title="Login"
           placeholder="Email"
           aria-label="Email"
           type="email"
           required
    >
    <input class="bz_password"
           id="Bugzilla_password_top"
           name="Bugzilla_password"
           type="password"
           title="Password"
           placeholder="Password"
           aria-label="Password"
           required
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text"
           id="Bugzilla_password_dummy_top" value="password"
           title="Password"
    >
      <input type="checkbox" id="Bugzilla_remember_top"
             name="Bugzilla_remember" value="on" class="bz_remember"
                 checked>
      <label for="Bugzilla_remember_top">Remember</label>
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
           class="check_mini_login_fields"
            id="log_in_top">
    <a href="#" id="hide_mini_login_top" aria-label="Close"
       class="close-button hide_mini_login_form" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
<li id="forgot_container_top">
  <a id="forgot_link_top" href="/index.cgi?GoAheadAndLogIn=1#forgot"
     class='show_forgot_form'
     data-qs-suffix="_top">Forgot Password</a>
  <div id="forgot_form_top" class="mini-popup mini_forgot bz_default_hidden">
  <form action="/token.cgi" method="post">
    <input type="email" name="loginname" size="20" placeholder="Email" aria-label="Email" required>
    <input id="forgot_button_top" value="Reset Password"
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <input type="hidden" id="token_top" name="token" value="1635622519-jSSqGvwHpgfVmOPh7qcwoTfAA5P8ugCaGvD6DqdnnVY">
    <a href="#" class="close-button hide_forgot_form" aria-label="Close" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
      </ul><div id="header-external-links" class="dropdown first">
  <button type="button" id="header-external-menu-button" class="dropdown-button minor" title="Mozilla"
          aria-label="Mozilla" aria-expanded="false" aria-haspopup="true" aria-controls="header-external-menu">
    <img src="/static/v20211025.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg" width="32" height="32" alt="">
  </button>
  <ul class="dropdown-content right" id="header-external-menu" role="menu" style="display:none;">
    <li role="presentation">
      <a href="https://www.mozilla.org/" role="menuitem" tabindex="-1">Mozilla Home</a>
    </li>
    <li role="separator"></li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/" role="menuitem" tabindex="-1">Privacy</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/#cookies" role="menuitem" tabindex="-1">Cookies</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/about/legal/" role="menuitem" tabindex="-1">Legal</a>
    </li>
  </ul>
</div>
  </div>
</header> 


<main id="bugzilla-body" tabindex="-1">

<aside id="message-container" role="complementary">
  <noscript>
    <div class="noscript">
      <div class="inner">
        <p>Please enable JavaScript in your browser to use all the features on this site.</p>
      </div>
    </div>
  </noscript>
</aside>

<div id="main-inner">




<div role="toolbar" id="page-toolbar">
  <div role="group" class="buttons">
    <button type="button" id="copy-summary" class="secondary"
      title="Copy bug number and summary to your clipboard">Copy Summary</button>
    <div id="clip-container" style="display:none"><input type="text" id="clip"></div>
    <div class="dropdown">
      <button type="button" id="action-menu-btn" aria-haspopup="true" aria-label="View"
        aria-expanded="false" aria-controls="action-menu" class="dropdown-button secondary">View &#9662;</button>
      <ul class="dropdown-content left" id="action-menu" role="menu" style="display:none;">
        <li role="presentation">
          <a id="action-reset" role="menuitem" tabindex="-1">Reset Sections</a>
        </li>
        <li role="presentation">
          <a id="action-expand-all" role="menuitem" tabindex="-1">Expand All Sections</a>
        </li>
        <li role="presentation">
          <a id="action-collapse-all" role="menuitem" tabindex="-1">Collapse All Sections</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a id="action-history" role="menuitem" tabindex="-1">History</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a href="/rest/bug/1086999" role="menuitem" tabindex="-1">JSON</a>
        </li>
        <li role="presentation">
          <a href="/show_bug.cgi?ctype=xml&amp;id=1086999" role="menuitem" tabindex="-1">XML</a>
        </li>
      </ul>
    </div>
  </div>
</div>



<div role="status" id="io-error" style="display:none"></div>
<div role="status" id="floating-message" style="display:none">
  <div id="floating-message-text"></div>
</div>
<section class="module"
>
  <div class="module-content"
  >
  <div id="summary-container">
    <div class="field indent" id="field-status_summary"
>


  
    <div class=" container">
        <span id="field-value-status_summary">
      <span class="bug-status-label text" data-status="closed">Closed</span>
      <span id="field-value-bug_id">
        <a href="/show_bug.cgi?id=1086999">Bug 1086999</a>
          <span class="edit-hide">(CVE-2015-4490)</span>
      </span>
      <span>
        <span class="bug-time-label">Opened <span class="rel-time" title="2014-10-21 15:02 PDT" data-time="1413928960">7 years ago</span></span>
          <span class="bug-time-label">Closed <span class="rel-time" title="2015-04-06 18:24 PDT" data-time="1428369893">7 years ago</span></span>
      </span>
        </span>
    </div>

  
</div>
<div class="field indent edit-hide"
>


  
    <div class=" container">
      

      <h1 id="field-value-short_desc">CSP: Asterisk (*) wildcard should not allow blob:, data:, or filesystem: when matching source expressions</h1>
    </div>

  
</div>

    <div class="field edit-show" id="field-short_desc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc" id="short_desc-help-link" class="help">Summary:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-short_desc">
            CSP: Asterisk (*) wildcard should not allow blob:, data:, or filesystem: when matching source expressions

        </span>
    </div>

  
</div>
  </div>
  </div>
</section>


<section class="module" id="module-categories"
>
    <header id="module-categories-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Categories section"
           data-label-collapsed="Expand Categories section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-categories-content"
             aria-expanded="true"
             aria-labeledby="module-categories-title"
             aria-describedby="module-categories-subtitle"></div>
        <h2 class="module-title" id="module-categories-title">Categories</h2>
          <h3 class="module-subtitle" id="module-categories-subtitle">
            (Core :: DOM: Security, defect, P1)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-categories-content"
  ><div class="fields-lhs">

    <div class="field" id="field-product"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=Core" id="product-help-link" class="help">Product:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-product">
      <div class="name-info-outer dropdown">
        <span id="product-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="product-info">Core
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="product-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Product description and actions">
          <header>
            <div class="title">Core</div>
            <div class="description">Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the <a href="https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox">Firefox</a> product. (<a href="https://wiki.mozilla.org/Modules/All#Core">More info</a>)</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=Core&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Product</a></div>
            <div><a href="/enter_bug.cgi?product=Core"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Product</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="Core"
                         data-label-watch="Watch This Product" data-label-unwatch="Unwatch This Product"
                         data-source="BugModal">Watch This Product</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-component"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=Core&component=DOM%3A%20Security#DOM%3A%20Security" id="component-help-link" class="help">Component:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-component">
      <div class="name-info-outer dropdown">
        <span id="component-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="component-info">DOM: Security
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="component-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Component description and actions">
          <header>
            <div class="title">Core :: DOM: Security</div>
            <div class="description">Native content-based security features including: Content Security Policy (CSP), Mixed Content Blocker (MCB), and Safe Browsing.</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=Core&amp;component=DOM%3A%20Security&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Component</a></div>
            <div><a href="/buglist.cgi?product=Core&amp;component=DOM%3A%20Security&amp;chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__"
                    target="_blank" role="menuitem" tabindex="-1">Recently Fixed Bugs in This Component</a></div>
            <div><a href="/enter_bug.cgi?product=Core&amp;component=DOM%3A%20Security"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Component</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="Core" data-component="DOM: Security"
                         data-label-watch="Watch This Component" data-label-unwatch="Unwatch This Component"
                         data-source="BugModal">Watch This Component</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-version" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#version" id="version-help-link" class="help">Version:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-version">
            unspecified

        </span>
    </div>

  
</div>

    <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform" id="-help-link" class="help">Platform:
        </a>
    </div>


  
    <div class=" container"><div class="field inline" id="field-rep_platform"
>


  
    <div class="value">
        <span id="field-value-rep_platform">
            All

        </span>
    </div>

  
</div><div class="field indent inline" id="field-op_sys"
>


  
    <div class="value">
        <span id="field-value-op_sys">
            All

        </span>
    </div>

  
</div><div class="field indent inline"
>


  
    <div class=" container">
    </div>

  
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field contains-buttons" id="field-bug_type"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type" id="bug_type-help-link" class="help">Type:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_type">
      <span class="bug-type-label iconic-text" data-type="defect">
        <span class="icon" aria-hidden="true"></span>defect</span>
        </span>
    </div>

  
</div>

    <div class="field" id="field-importance"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority" id="importance-help-link" class="help">Priority:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-importance"><div class="field inline" id="field-priority"
>


  
    <div class="value">
        <span id="field-value-priority">P1
        </span>
    </div>

  
</div><div class="field inline" id="field-bug_severity"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity" id="bug_severity-help-link" class="help">Severity:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_severity">
            normal

        </span>
    </div>

  
</div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-cf_fx_points" style="display:none"
>
    <div class="name">Points:
    </div>


  
    <div class="value">
        <span id="field-value-cf_fx_points">
            ---

        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-tracking"
>
    <header id="module-tracking-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Tracking section"
           data-label-collapsed="Expand Tracking section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-tracking-content"
             aria-expanded="true"
             aria-labeledby="module-tracking-title"
             aria-describedby="module-tracking-subtitle"></div>
        <h2 class="module-title" id="module-tracking-title">Tracking</h2>
          <h3 class="module-subtitle" id="module-tracking-subtitle">
            (<span id="readable-bug-status" data-readable-bug-status="{&quot;flags&quot;:[{&quot;name&quot;:&quot;in-testsuite&quot;,&quot;status&quot;:&quot;+&quot;}],&quot;cf_a11y_review_project_flag&quot;:&quot;---&quot;,&quot;cf_tracking_firefox40&quot;:&quot;+&quot;,&quot;cf_tracking_firefox95&quot;:&quot;---&quot;,&quot;cf_tracking_firefox93&quot;:&quot;---&quot;,&quot;id&quot;:1086999,&quot;cf_status_firefox94&quot;:&quot;---&quot;,&quot;cf_status_firefox_esr91&quot;:&quot;---&quot;,&quot;cf_tracking_thunderbird_esr78&quot;:&quot;---&quot;,&quot;resolution&quot;:&quot;FIXED&quot;,&quot;priority&quot;:&quot;P1&quot;,&quot;cf_webcompat_priority&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_sumo&quot;:&quot;---&quot;,&quot;cf_status_firefox95&quot;:&quot;---&quot;,&quot;cf_fission_milestone&quot;:&quot;---&quot;,&quot;cf_tracking_firefox94&quot;:&quot;---&quot;,&quot;dupe_of&quot;:null,&quot;cf_status_firefox40&quot;:&quot;fixed&quot;,&quot;cf_status_firefox_esr78&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_esr91&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_relnote&quot;:&quot;---&quot;,&quot;cf_status_thunderbird_esr78&quot;:&quot;---&quot;,&quot;cf_status_thunderbird_esr91&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_esr78&quot;:&quot;---&quot;,&quot;cf_tracking_thunderbird_esr91&quot;:&quot;---&quot;,&quot;target_milestone&quot;:&quot;mozilla40&quot;,&quot;keywords&quot;:[&quot;dev-doc-complete&quot;,&quot;sec-moderate&quot;,&quot;site-compat&quot;],&quot;cf_root_cause&quot;:&quot;---&quot;,&quot;status&quot;:&quot;RESOLVED&quot;,&quot;cf_status_firefox93&quot;:&quot;---&quot;}"></span>)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-tracking-content"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-status-view"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-view-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-view">RESOLVED
        FIXED
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-status-edit" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-edit-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-edit"><div class="field inline" id="field-bug_status"
>


  
    <div class="value">
        <span id="field-value-bug_status">
            RESOLVED

        </span>
    </div>

  
</div><div class="field indent inline" id="field-resolution"
>


  
    <div class="value">
        <span id="field-value-resolution">
            FIXED

        </span>
    </div>

  
</div>
  <div id="status-action-buttons">
      <div id="assigned-container" style="display:none">
        <button type="button" class="secondary" id="mark-as-assigned-btn">
          Mark as Assigned
        </button>
      </div>
  </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-target_milestone"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone" id="target_milestone-help-link" class="help">Milestone:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-target_milestone">
            mozilla40

        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-cf_fx_iteration" style="display:none"
>
    <div class="name">Iteration:
    </div>


  
    <div class="value">
        <span id="field-value-cf_fx_iteration">
            ---

        </span>
    </div>

  
</div>


      <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Project Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <td class="tracking-flag-name">a11y-review</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_a11y_review_project_flag-dirty">
  <select id="cf_a11y_review_project_flag" name="cf_a11y_review_project_flag">
        <option value="---"
          id="v4876_cf_a11y_review_project_flag" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Root Cause</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_root_cause-dirty">
  <select id="cf_root_cause" name="cf_root_cause">
        <option value="---"
          id="v4701_cf_root_cause" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Webcompat Priority</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_webcompat_priority-dirty">
  <select id="cf_webcompat_priority" name="cf_webcompat_priority">
        <option value="---"
          id="v4274_cf_webcompat_priority" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">user-doc-firefox</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_sumo-dirty">
  <select id="cf_tracking_firefox_sumo" name="cf_tracking_firefox_sumo">
        <option value="---"
          id="v4660_cf_tracking_firefox_sumo" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Fission Milestone</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_fission_milestone-dirty">
  <select id="cf_fission_milestone" name="cf_fission_milestone">
        <option value="---"
          id="v4222_cf_fission_milestone" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

      <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Tracking Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-hide">
    <table class="layout-table tracking-flags">
        <tr>
          <th></th>
          <th>Tracking</th>
          <th>Status</th>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox40</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox40&amp;o1=equals&amp;v1=%2B">+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox40&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
    </table>
  </div>


<div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <th></th>
        <th>Tracking</th>
        <th>Status</th>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox40</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox40-dirty">
  <select id="cf_tracking_firefox40" name="cf_tracking_firefox40">
        <option value="+"
          id="v2194_cf_tracking_firefox40" selected
        >+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox40-dirty">
  <select id="cf_status_firefox40" name="cf_status_firefox40">
        <option value="fixed"
          id="v2200_cf_status_firefox40" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">relnote-firefox</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_relnote-dirty">
  <select id="cf_tracking_firefox_relnote" name="cf_tracking_firefox_relnote">
        <option value="---"
          id="v539_cf_tracking_firefox_relnote" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr78-dirty">
  <select id="cf_tracking_thunderbird_esr78" name="cf_tracking_thunderbird_esr78">
        <option value="---"
          id="v4823_cf_tracking_thunderbird_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr78-dirty">
  <select id="cf_status_thunderbird_esr78" name="cf_status_thunderbird_esr78">
        <option value="---"
          id="v4829_cf_status_thunderbird_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr91-dirty">
  <select id="cf_tracking_thunderbird_esr91" name="cf_tracking_thunderbird_esr91">
        <option value="---"
          id="v5236_cf_tracking_thunderbird_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr91-dirty">
  <select id="cf_status_thunderbird_esr91" name="cf_status_thunderbird_esr91">
        <option value="---"
          id="v5242_cf_status_thunderbird_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr78-dirty">
  <select id="cf_tracking_firefox_esr78" name="cf_tracking_firefox_esr78">
        <option value="---"
          id="v4808_cf_tracking_firefox_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr78-dirty">
  <select id="cf_status_firefox_esr78" name="cf_status_firefox_esr78">
        <option value="---"
          id="v4813_cf_status_firefox_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr91-dirty">
  <select id="cf_tracking_firefox_esr91" name="cf_tracking_firefox_esr91">
        <option value="---"
          id="v5194_cf_tracking_firefox_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr91-dirty">
  <select id="cf_status_firefox_esr91" name="cf_status_firefox_esr91">
        <option value="---"
          id="v5199_cf_status_firefox_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox93</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox93-dirty">
  <select id="cf_tracking_firefox93" name="cf_tracking_firefox93">
        <option value="---"
          id="v5266_cf_tracking_firefox93" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox93-dirty">
  <select id="cf_status_firefox93" name="cf_status_firefox93">
        <option value="---"
          id="v5271_cf_status_firefox93" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox94</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox94-dirty">
  <select id="cf_tracking_firefox94" name="cf_tracking_firefox94">
        <option value="---"
          id="v5284_cf_tracking_firefox94" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox94-dirty">
  <select id="cf_status_firefox94" name="cf_status_firefox94">
        <option value="---"
          id="v5289_cf_status_firefox94" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox95</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox95-dirty">
  <select id="cf_tracking_firefox95" name="cf_tracking_firefox95">
        <option value="---"
          id="v5311_cf_tracking_firefox95" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox95-dirty">
  <select id="cf_status_firefox95" name="cf_status_firefox95">
        <option value="---"
          id="v5316_cf_status_firefox95" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>

</div>
  </div>
</section>



<section class="module" id="module-people"
>
    <header id="module-people-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse People section"
           data-label-collapsed="Expand People section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-people-content"
             aria-expanded="false"
             aria-labeledby="module-people-title"
             aria-describedby="module-people-subtitle"></div>
        <h2 class="module-title" id="module-people-title">People</h2>
          <h3 class="module-subtitle" id="module-people-subtitle">
            (Reporter: ckerschb, Assigned: ckerschb)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-people-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-assigned_to"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to"><div class="vcard vcard_363267" ><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=363267" > <span class="fna">ckerschb</span></a>
</div>
        </span>
    </div>

  
</div><div class="field edit-show" id="field-assigned_to" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-assignee" name="set_default_assignee" class="set-default"
          value="1" data-for="assigned_to">
        <label for="set-default-assignee">Reset Assignee to default</label>
      </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-bug_mentors" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor" id="bug_mentors-help-link" class="help">Mentors:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_mentors">---
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-qa_contact" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact" id="qa_contact-help-link" class="help">QA Contact:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-qa_contact">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-qa-contact" name="set_default_qa_contact" class="set-default"
          value="1" data-for="qa_contact">
        <label for="set-default-qa-contact">Reset QA Contact to default</label>
      </div>
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-reporter"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter" id="reporter-help-link" class="help">Reporter:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-reporter">
            <div class="vcard vcard_363267" ><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=363267" > <span class="fna">ckerschb</span></a>
</div>

        </span>
    </div>

  
</div>

    <div class="field" id="field-triage_owner"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner" id="triage_owner-help-link" class="help">Triage Owner:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-triage_owner">
            <div class="vcard vcard_363267" ><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=363267" > <span class="fna">ckerschb</span></a>
</div>

        </span>
    </div>

  
</div>

    

    <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc" id="-help-link" class="help">CC:
        </a>
    </div>


  
    <div class=" container">


        <span aria-owns="cc-summary cc-latch">
          <span role="button" tabindex="0" id="cc-summary" data-count="16">16 people
          </span>
        </span>


        <div id="cc-list" style="display:none"></div>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-references"
>
    <header id="module-references-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse References section"
           data-label-collapsed="Expand References section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-references-content"
             aria-expanded="false"
             aria-labeledby="module-references-title"
             aria-describedby="module-references-subtitle"></div>
        <h2 class="module-title" id="module-references-title">References</h2>
          <h3 class="module-subtitle" id="module-references-subtitle">
            (Blocks 2 open bugs)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-references-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field bug-list" id="field-dependson"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson" id="dependson-help-link" class="help">Depends on:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-dependson">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED WORKSFORME - WhatsApp Web displaying wrongly because page's settings block the loading of a resource at data:image/... (&quot;img-src *&quot;)"
   href="/show_bug.cgi?id=1154704">1154704</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED WORKSFORME - cnn.com home page shows low-resolution placeholder image until window is resized"
   href="/show_bug.cgi?id=1155792">1155792</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Fastmail.com missing images due to CSP error"
   href="/show_bug.cgi?id=1157084">1157084</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED INVALID - html5test doesn't detect script execution events"
   href="/show_bug.cgi?id=1157724">1157724</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Image onload doesn't run if src attribute is data: on a facebook page due to a CSP that forbids data: loads"
   href="/show_bug.cgi?id=1181379">1181379</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Rendering issues in logo, spinner on Voluum"
   href="/show_bug.cgi?id=1182476">1182476</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Fastmail won't allow to insert inline images to emails"
   href="/show_bug.cgi?id=1186412">1186412</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED INVALID - Firefox 40 doesn't accept '*' as image source in Content-Security-Policy header"
   href="/show_bug.cgi?id=1193648">1193648</a>
      </div>

        </span>
    </div>

  
</div><div class="field bug-list" id="field-blocked"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks" id="blocked-help-link" class="help">Blocks:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-blocked">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_NEW"
   title="NEW - Content Security Policy (CSP) blocks SVG embedded as data URI in CSS url()"
   href="/show_bug.cgi?id=878608">878608</a>
      </div>
      <div class="bug-list">
        <span class="bug-type-label iconic" title="enhancement"
              aria-label="enhancement" data-type="enhancement">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_NEW"
   title="NEW - Implement Content Security Policy"
   href="/show_bug.cgi?id=493857">CSP</a>
      </div>

        </span>
    </div>

  
</div><div class="field" id="field-dependencytree"
>
    <div class="name">
    </div>


  
    <div class=" container">
        <span id="field-value-dependencytree">
        Dependency <a href="/showdependencytree.cgi?id=1086999&amp;hide_resolved=1">tree</a>
        / <a href="/showdependencygraph.cgi?id=1086999">graph</a>
        </span>
    </div>

  
</div>

    <div class="field bug-list edit-show" id="field-regresses" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses" id="regresses-help-link" class="help">Regressions:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regresses">
        ---
        </span>
    </div>

  
</div><div class="field bug-list edit-show" id="field-regressed_by" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by" id="regressed_by-help-link" class="help">Regressed by:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regressed_by">
        ---
        </span>
    </div>

  
</div>

    
</div><div class="fields-rhs">

    <div class="field edit-show" id="field-bug_file_loc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc" id="bug_file_loc-help-link" class="help">URL:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_file_loc"><div class="link">
    <a href="" target="_blank"
      rel="noreferrer" title=""
      class="bug-url" data-safe="0"></a>
  </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-see_also" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also" id="see_also-help-link" class="help">See Also:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-see_also">
        ---
        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-details"
>
    <header id="module-details-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Details section"
           data-label-collapsed="Expand Details section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-details-content"
             aria-expanded="false"
             aria-labeledby="module-details-title"
             aria-describedby="module-details-subtitle"></div>
        <h2 class="module-title" id="module-details-title">Details</h2>
          <h3 class="module-subtitle" id="module-details-subtitle">
            (Keywords: dev-doc-complete, sec-moderate, site-compat, Whiteboard: [adv-main40+])
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-details-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-show" id="field-alias" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias" id="alias-help-link" class="help">Alias:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-alias">
            CVE-2015-4490

        </span>
    </div>

  
</div>

    <div class="field" id="field-keywords"
>
    <div class="name">
        <a href="/describekeywords.cgi" id="keywords-help-link" class="help">Keywords:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-keywords">
          <a href="/buglist.cgi?keywords=dev-doc-complete&amp;resolution=---">dev-doc-complete</a>, 
          <a href="/buglist.cgi?keywords=sec-moderate&amp;resolution=---">sec-moderate</a>, 
          <a href="/buglist.cgi?keywords=site-compat&amp;resolution=---">site-compat</a>
        </span>
    </div>

  
</div>

    <div class="field" id="field-status_whiteboard"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/Whiteboard" id="status_whiteboard-help-link" class="help">Whiteboard:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-status_whiteboard">[adv-main40+]
        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_qa_whiteboard" style="display:none"
>
    <div class="name">QA Whiteboard:
    </div>


  
    <div class="value">
        <span id="field-value-cf_qa_whiteboard">
        ---
        </span>
    </div>

  
</div>

    

    <div class="field edit-show" id="field-cf_has_regression_range" style="display:none"
>
    <div class="name">Has Regression Range:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_regression_range">
            ---

        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_has_str" style="display:none"
>
    <div class="name">Has STR:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_str">
            ---

        </span>
    </div>

  
</div>

    <div class="field" id="field-votes"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes" id="votes-help-link" class="help">Votes:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-votes">0
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-bug_flags"
>
    <div class="name">Bug Flags:
    </div>


  
    <div class=" container">
        <span id="field-value-bug_flags"><div id="bug-flags" class="flags">
  <table class="layout-table">
          <tbody class="edit-hide"><tr>
    <td class="flag-setter"><div class="vcard vcard_75935" ><a class="email " href="/user_profile?user_id=75935" > <span class="fna">RyanVM</span></a>
</div>
    </td>

    <td class="flag-name">
        <a href="#c30"
            class="rel-time-title activity-ref"
            title="7 years ago"
        data-time="1428369893"
      >in-testsuite</a>
    </td>

    <td class="flag-value">+
    </td>

  </tr>
          </tbody>
          <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter"><div class="vcard vcard_75935" ><a class="email " href="/user_profile?user_id=75935" > <span class="fna">RyanVM</span></a>
</div>
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag-1140344">in-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag-1140344-dirty">
      <select id="flag-1140344" name="flag-1140344"
        title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" selected>+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr>
          </tbody>
    <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?" for="flag_type-930">behind-pref</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-930-dirty">
      <select id="flag_type-930" name="flag_type-930"
        title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?"
        class="bug-flag">
          <option value="X"></option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag tracking inclusion in the desktop Firefox product backlog." for="flag_type-846">firefox-backlog</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-846-dirty">
      <select id="flag_type-846" name="flag_type-846"
        title="Flag tracking inclusion in the desktop Firefox product backlog."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug." for="flag_type-803">sec-bounty</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-803-dirty">
      <select id="flag_type-803" name="flag_type-803"
        title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame." for="flag_type-913">sec-bounty-hof</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-913-dirty">
      <select id="flag_type-913" name="flag_type-913"
        title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-787">in-qa-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-787-dirty">
      <select id="flag_type-787" name="flag_type-787"
        title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>

      <td class="flag-requestee">
        <div id="requestee_type-787-container" style="display:none"><input
    name="requestee_type-787"
    value="" class="requestee bz_autocomplete_user"  id="requestee_type-787" 
  >
        </div>
      <td>

  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually" for="flag_type-864">qe-verify</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-864-dirty">
      <select id="flag_type-864" name="flag_type-864"
        title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually"
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr>
    </tbody>
  </table>
</div>
        </span>
    </div>

  
</div>
</div>

  
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-crash-data"
>
    <header id="module-crash-data-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Crash Data section"
           data-label-collapsed="Expand Crash Data section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-crash-data-content"
             aria-expanded="false"
             aria-labeledby="module-crash-data-title"
             aria-describedby="module-crash-data-subtitle"></div>
        <h2 class="module-title" id="module-crash-data-title">Crash Data</h2>
      </div>
    </header>
  <div class="module-content" id="module-crash-data-content" style="display:none"
  ><div class="field edit-show" id="field-cf_crash_signature" style="display:none"
>
    <div class="name">Signature:
    </div>


  
    <div class="value">
        <span id="field-value-cf_crash_signature">
        </span>
    </div>

  
</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-security"
>
    <header id="module-security-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Security section"
           data-label-collapsed="Expand Security section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-security-content"
             aria-expanded="false"
             aria-labeledby="module-security-title"
             aria-describedby="module-security-subtitle"></div>
        <h2 class="module-title" id="module-security-title">Security</h2>
          <h3 class="module-subtitle" id="module-security-subtitle">
            (public)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-security-content" style="display:none"
  ><div class="groups edit-hide">
    This bug is publicly visible.
</div>

<div class="groups edit-show" style="display:none">


</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-user-story" data-non-stick="1"
>
    <header id="module-user-story-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse User Story section"
           data-label-collapsed="Expand User Story section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-user-story-content"
             aria-expanded="false"
             aria-labeledby="module-user-story-title"
             aria-describedby="module-user-story-subtitle"></div>
        <h2 class="module-title" id="module-user-story-title">User Story</h2>
      </div>
    </header>
  <div class="module-content" id="module-user-story-content" style="display:none"
  >
    <pre id="user-story"></pre>
  </div>
</section>







<section class="module" id="module-attachments"
>
    <header id="module-attachments-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Attachments section"
           data-label-collapsed="Expand Attachments section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-attachments-content"
             aria-expanded="true"
             aria-labeledby="module-attachments-title"
             aria-describedby="module-attachments-subtitle"></div>
        <h2 class="module-title" id="module-attachments-title">Attachments</h2>
          <h3 class="module-subtitle" id="module-attachments-subtitle">
            (4 files, 6 obsolete files)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-attachments-content"
  ><table role="table" class="layout-table" id="attachments">
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8560739">bug_1086999.patch</a>
        </div>
        <div>
            <a href="#c4" class="attach-time activity-ref"><span class="rel-time" title="2015-02-06 14:59 PST" data-time="1423263593">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_363267" ><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div></span>
        </div>
        <div class="attach-info">1.48 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8560739&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8560739&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1086999&attachment=8560739">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8562376">bug_1086999.patch</a>
        </div>
        <div>
            <a href="#c5" class="attach-time activity-ref"><span class="rel-time" title="2015-02-10 14:55 PST" data-time="1423608921">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_363267" ><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div></span>
        </div>
        <div class="attach-info">1.78 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_339203" ><span class="fn">geekboy</span>
</div>:
              <a href="#c7"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1423608921"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8562376&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8562376&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1086999&attachment=8562376">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8562377">bug_1086999_tests.patch</a>
        </div>
        <div>
            <a href="#c6" class="attach-time activity-ref"><span class="rel-time" title="2015-02-10 14:56 PST" data-time="1423609012">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_363267" ><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div></span>
        </div>
        <div class="attach-info">5.36 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_339203" ><span class="fn">geekboy</span>
</div>:
              <a href="#c8"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1423609012"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8562377&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8562377&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1086999&attachment=8562377">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8575573">bug_1086999.patch</a>
        </div>
        <div>
            <a href="#c9" class="attach-time activity-ref"><span class="rel-time" title="2015-03-10 14:29 PDT" data-time="1426022981">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_363267" ><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div></span>
        </div>
        <div class="attach-info">3.20 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_363267" ><span class="fn">ckerschb</span>
</div>:
              <a href="#c9"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1426022981"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8575573&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8575573&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1086999&attachment=8575573">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8575577">bug_1086999_tests.patch</a>
        </div>
        <div>
            <a href="#c10" class="attach-time activity-ref"><span class="rel-time" title="2015-03-10 14:34 PDT" data-time="1426023257">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_363267" ><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div></span>
        </div>
        <div class="attach-info">5.65 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_363267" ><span class="fn">ckerschb</span>
</div>:
              <a href="#c10"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1426023257"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8575577&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8575577&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1086999&attachment=8575577">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8576334">bug_1086999.patch</a>
        </div>
        <div>
            <a href="#c14" class="attach-time activity-ref"><span class="rel-time" title="2015-03-11 17:18 PDT" data-time="1426119513">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_363267" ><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div></span>
        </div>
        <div class="attach-info">1.91 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_363267" ><span class="fn">ckerschb</span>
</div>:
              <a href="#c14"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1426119513"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8576334&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8576334&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1086999&attachment=8576334">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8576337">bug_1086999_web_platform_test_update.patch</a>
        </div>
        <div>
            <a href="#c15" class="attach-time activity-ref"><span class="rel-time" title="2015-03-11 17:25 PDT" data-time="1426119946">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_363267" ><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div></span>
        </div>
        <div class="attach-info">2.18 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_339203" ><span class="fn">geekboy</span>
</div>:
              <a href="#c16"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1426119946"
            >
              review+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_389650" ><span class="fn">jgraham</span>
</div>:
              <a href="#c17"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1426119946"
            >
              review-</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8576337&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8576337&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1086999&attachment=8576337">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8580349">bug_1086999_web_platform_test_update.patch</a>
        </div>
        <div>
            <a href="#c18" class="attach-time activity-ref"><span class="rel-time" title="2015-03-19 16:26 PDT" data-time="1426807590">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_363267" ><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div></span>
        </div>
        <div class="attach-info">1.99 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8580349&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8580349&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1086999&attachment=8580349">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8580352">bug_1086999_web_platform_test_update.patch</a>
        </div>
        <div>
            <a href="#c19" class="attach-time activity-ref"><span class="rel-time" title="2015-03-19 16:29 PDT" data-time="1426807749">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_363267" ><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div></span>
        </div>
        <div class="attach-info">1.93 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_389650" ><span class="fn">jgraham</span>
</div>:
              <a href="#a13177752_389650"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1426807749"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8580352&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8580352&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1086999&attachment=8580352">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8583426">bug_1086999_b2g_policy_updates.patch</a>
        </div>
        <div>
            <a href="#c23" class="attach-time activity-ref"><span class="rel-time" title="2015-03-25 16:04 PDT" data-time="1427324642">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_363267" ><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div></span>
        </div>
        <div class="attach-info">3.81 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_434339" ><span class="fn">pauljt</span>
</div>:
              <a href="#a14017279_434339"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1427823752"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8583426&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8583426&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1086999&attachment=8583426">Splinter Review</a>
    </tr>
</table>

<footer id="attachments-footer">
  <div id="attachments-actions">
      <button type="button" id="attachments-obsolete-btn" class="secondary">Show Obsolete</button>
  </div>
  
</footer>
  </div>
</section>



<script nonce="08qa6p7mpjobVjqWwNBQbbDIst1SWSLgz6KHnNgSO5H6t0Z3">
  init_module_visibility();
</script>



<meta name="firefox-versions" content="{&quot;FIREFOX_AURORA&quot;:&quot;&quot;,&quot;FIREFOX_DEVEDITION&quot;:&quot;94.0b9&quot;,&quot;FIREFOX_ESR&quot;:&quot;78.15.0esr&quot;,&quot;FIREFOX_ESR_NEXT&quot;:&quot;91.2.0esr&quot;,&quot;FIREFOX_NIGHTLY&quot;:&quot;95.0a1&quot;,&quot;FIREFOX_PINEBUILD&quot;:&quot;&quot;,&quot;LAST_MERGE_DATE&quot;:&quot;2021-10-04&quot;,&quot;LAST_RELEASE_DATE&quot;:&quot;2021-10-05&quot;,&quot;LAST_SOFTFREEZE_DATE&quot;:&quot;2021-09-30&quot;,&quot;LATEST_FIREFOX_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_OLDER_VERSION&quot;:&quot;3.6.28&quot;,&quot;LATEST_FIREFOX_RELEASED_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_VERSION&quot;:&quot;93.0&quot;,&quot;NEXT_MERGE_DATE&quot;:&quot;2021-11-01&quot;,&quot;NEXT_RELEASE_DATE&quot;:&quot;2021-11-02&quot;,&quot;NEXT_SOFTFREEZE_DATE&quot;:&quot;2021-10-28&quot;}">


<div id="comment-actions">
    <button type="button" id="bottom-btn" class="secondary" aria-label="Go to Page Bottom">Bottom &darr;</button>
  <div class="dropdown">
    <button type="button" id="comment-tags-btn" aria-haspopup="true" aria-label="Tags"
      aria-expanded="false" aria-controls="comment-tags-menu" class="dropdown-button minor">Tags &#9662;</button>
    <ul id="comment-tags-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a role="menuitem" tabindex="-1" data-comment-tag="">Reset</a>
      </li>
    </ul>
  </div>
  <div class="dropdown">
    <button type="button" id="view-menu-btn" aria-haspopup="true" aria-label="Timeline"
      aria-expanded="false" aria-controls="view-menu" class="dropdown-button minor">Timeline &#9662;</button>
    <ul id="view-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a id="view-reset" role="menuitem" tabindex="-1">Reset</a>
      </li>
      <li role="separator"></li>
      <li role="presentation">
        <a id="view-collapse-all" role="menuitem" tabindex="-1">Collapse All</a>
      </li>
      <li role="presentation">
        <a id="view-expand-all" role="menuitem" tabindex="-1">Expand All</a>
      </li>
      <li role="presentation">
        <a id="view-comments-only" role="menuitem" tabindex="-1">Comments Only</a>
      </li>
    </ul>
   </div>
</div>
<div class="change-set" id="c0"><div class="comment" data-id="9481123" data-no="0"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-0" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" ><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" ><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-0"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-0" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#c0">Description</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-21 15:02 PDT" data-time="1413928960">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-0">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-0" data-comment-id="9481123">There is a discrepancy in our CSP implementation and the spec. The spec says [1] that blob:, data:, and filesystem: should be excluded in case of a wildcard (allow all) when matching source expressions.

Currently we allow all schemes in case of an asterisk wildcard, e.g. here: [2].

We should update our implementation to follow the spec.

[1] <a rel="nofollow" href="http://www.w3.org/TR/CSP11/#match-source-expression">http://www.w3.org/TR/CSP11/#match-source-expression</a>
[2] <a rel="nofollow" href="http://mxr.mozilla.org/mozilla-central/source/content/base/src/nsCSPUtils.cpp#291">http://mxr.mozilla.org/mozilla-central/source/content/base/src/nsCSPUtils.cpp#291</a></pre></div><div class="change-set" id="a79_363267"><div class="change" id="aa79_363267">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a79_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_363267" id="a79_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a79_363267"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a79_363267">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#a79_363267">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-21 15:03 PDT" data-time="1413929039">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Blocks: <a class="bz_bug_link
          bz_status_NEW"
   title="NEW - Implement Content Security Policy"
   href="/show_bug.cgi?id=493857">CSP</a></div></div></div><div class="change-set" id="c1"><div class="comment" data-id="9481130" data-no="1"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-1" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a79_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a79_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-1"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-1" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#c1">Comment 1</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-21 15:04 PDT" data-time="1413929078">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-1">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-1" data-comment-id="9481130">Francois, do you wanna take this one?</pre><div class="activity"><div class="change">Flags: needinfo?(francois)</div></div></div><div class="change-set" id="c2"><div class="comment" data-id="9488556" data-no="2"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-2" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_303427" id="a79_363267"><img src="https://secure.gravatar.com/avatar/0110e86fdb31486c22dd381326d99de9?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_303427" id="a79_363267"><a class="email " href="/user_profile?user_id=303427" > <span class="fna">François Marier [:francois]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-2"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-2" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#c2">Comment 2</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-22 17:54 PDT" data-time="1414025696">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-2">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-2" data-comment-id="9488556">Sure.</pre><div class="activity"><div class="change">Status: NEW &rarr; ASSIGNED</div><div class="change">Flags: <span class="activity-deleted">needinfo?(francois)</span></div></div></div><div class="change-set" id="a96743_303427"><div class="change" id="aa96743_303427">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_303427" id="a96743_303427"><img src="https://secure.gravatar.com/avatar/0110e86fdb31486c22dd381326d99de9?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_303427" id="a96743_303427"><a class="email " href="/user_profile?user_id=303427" > <span class="fna">François Marier [:francois]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a96743_303427"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a96743_303427">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#a96743_303427">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-22 17:55 PDT" data-time="1414025703">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Assignee: nobody &rarr; francois</div></div></div><div class="change-set" id="a1109692_363267"><div class="change" id="aa1109692_363267">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a1109692_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_363267" id="a1109692_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1109692_363267"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1109692_363267">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#a1109692_363267">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-11-03 10:17 PST" data-time="1415038652">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Priority: -- &rarr; P1</div></div></div><div class="change-set" id="c3"><div class="comment" data-id="9619101" data-no="3"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-3" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a1109692_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a1109692_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-3"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-3" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#c3">Comment 3</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-11-20 15:05 PST" data-time="1416524749">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-3">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-3" data-comment-id="9619101">It's not a dependency, but I think <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - It should be possible to whitelist a protocol handler with respect to webpage CSP"
   href="/show_bug.cgi?id=1021669">Bug 1021669</a> is closely related to this one - Francois a CC'd you on <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - It should be possible to whitelist a protocol handler with respect to webpage CSP"
   href="/show_bug.cgi?id=1021669">Bug 1021669</a> as well.</pre></div><div class="change-set" id="a9333740_1689"><div class="change" id="aa9333740_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a9333740_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a9333740_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a9333740_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a9333740_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#a9333740_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-02-06 14:45 PST" data-time="1423262700">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Keywords: <a href="/buglist.cgi?keywords=sec-moderate&amp;resolution=---">sec-moderate</a></div></div></div><div class="change-set" id="c4"><div class="comment" data-id="9892469" data-no="4"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-4" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a9333740_1689"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a9333740_1689"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-4"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-4" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#c4">Comment 4</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-02-06 14:59 PST" data-time="1423263593">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-4">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8560739"
         class="attachment patch obsolete"
         data-id="8560739" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug_1086999.patch">
      <meta itemprop="contentSize" content="1516">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8560739">
          <a class="link" href="attachment.cgi?id=8560739&amp;action=diff">
        <span id="att-8560739-description" itemprop="description">bug_1086999.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8560739&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1086999&attachment=8560739">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-4" data-comment-id="9892469">That should fix the problem, but we still need a testcase for it.</pre></div><div class="change-set" id="a9597516_303427"><div class="change" id="aa9597516_303427">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_303427" id="a9597516_303427"><img src="https://secure.gravatar.com/avatar/0110e86fdb31486c22dd381326d99de9?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_303427" id="a9597516_303427"><a class="email " href="/user_profile?user_id=303427" > <span class="fna">François Marier [:francois]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a9597516_303427"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a9597516_303427">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#a9597516_303427">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-02-09 16:01 PST" data-time="1423526476">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Assignee: francois &rarr; mozilla</div></div></div><div class="change-set" id="c5"><div class="comment" data-id="9905202" data-no="5"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-5" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a9597516_303427"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a9597516_303427"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-5"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-5" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#c5">Comment 5</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-02-10 14:55 PST" data-time="1423608921">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-5">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8562376"
         class="attachment patch obsolete"
         data-id="8562376" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug_1086999.patch">
      <meta itemprop="contentSize" content="1822">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8562376">
          <a class="link" href="attachment.cgi?id=8562376&amp;action=diff">
        <span id="att-8562376-description" itemprop="description">bug_1086999.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8562376&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1086999&attachment=8562376">Splinter Review</a>
      </div>
    </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8560739&amp;action=edit"
           title="bug_1086999.patch"
           class=""
        >Attachment #8560739</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8562376&amp;action=edit"
           title="bug_1086999.patch"
           class=""
        >Attachment #8562376</a> -
        Flags: review?(sstamm)</div></div></div><div class="change-set" id="c6"><div class="comment" data-id="9905209" data-no="6"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-6" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a9597516_303427"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a9597516_303427"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-6"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-6" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#c6">Comment 6</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-02-10 14:56 PST" data-time="1423609012">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-6">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8562377"
         class="attachment patch obsolete"
         data-id="8562377" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug_1086999_tests.patch">
      <meta itemprop="contentSize" content="5488">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8562377">
          <a class="link" href="attachment.cgi?id=8562377&amp;action=diff">
        <span id="att-8562377-description" itemprop="description">bug_1086999_tests.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8562377&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1086999&attachment=8562377">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-6" data-comment-id="9905209">Please note that I choose the onload/onerror solution on purpose. I think we have enough tests that rely on observers. I'd rather have a variation of tests hence that choice.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8562377&amp;action=edit"
           title="bug_1086999_tests.patch"
           class=""
        >Attachment #8562377</a> -
        Flags: review?(sstamm)</div></div></div><div class="change-set" id="c7"><div class="comment" data-id="9931191" data-no="7"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-7" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_339203" id="a9597516_303427"><img src="https://secure.gravatar.com/avatar/acd21cf298169c0b87813c52025ee6e9?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_339203" id="a9597516_303427"><a class="email " href="/user_profile?user_id=339203" > <span class="fna">Sid Stamm [:geekboy or :sstamm]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-7"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-7" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#c7">Comment 7</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-02-18 07:42 PST" data-time="1424274134">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-7">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-7" data-comment-id="9931191">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8562376" name="attach_8562376" title="bug_1086999.patch">attachment 8562376</a> <a href="/attachment.cgi?id=8562376&amp;action=edit" title="bug_1086999.patch">[details]</a> <a href="/attachment.cgi?id=8562376&amp;action=diff" title="bug_1086999.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1086999&amp;attachment=8562376'>[review]</a>
bug_1086999.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8562376" name="attach_8562376" title="bug_1086999.patch">attachment 8562376</a> <a href="/attachment.cgi?id=8562376&amp;action=edit" title="bug_1086999.patch">[details]</a> <a href="/attachment.cgi?id=8562376&amp;action=diff" title="bug_1086999.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1086999&amp;attachment=8562376'>[review]</a>:
-----------------------------------------------------------------

r=me with filesystem-&gt;file changes here and in nsCSPService.cpp.

::: dom/security/nsCSPUtils.cpp
&#64;&#64; +386,5 &#64;&#64;
<span class="quote">&gt; +      (NS_SUCCEEDED(aUri-&gt;SchemeIs(&quot;blob&quot;, &amp;isBlobScheme)) &amp;&amp; isBlobScheme);
&gt; +    bool isDataScheme =
&gt; +      (NS_SUCCEEDED(aUri-&gt;SchemeIs(&quot;data&quot;, &amp;isDataScheme)) &amp;&amp; isDataScheme);
&gt; +    bool isFileScheme =
&gt; +      (NS_SUCCEEDED(aUri-&gt;SchemeIs(&quot;filesystem&quot;, &amp;isFileScheme)) &amp;&amp; isFileScheme);</span >

I think you want &quot;file&quot; here, not &quot;filesystem&quot;.  The WG should probably fix that, or clarify where &quot;filesystem&quot; scheme is defined (I can't find it used anywhere).

When you change this to &quot;file&quot;, please update nsCSPService.cpp too.
<a rel="nofollow" href="http://mxr.mozilla.org/mozilla-central/source/dom/security/nsCSPService.cpp#68">http://mxr.mozilla.org/mozilla-central/source/dom/security/nsCSPService.cpp#68</a></pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8562376&amp;action=edit"
           title="bug_1086999.patch"
           class=""
        >Attachment #8562376</a> -
        Flags: review?(sstamm) &rarr; review+</div></div></div><div class="change-set" id="c8"><div class="comment" data-id="9931249" data-no="8"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-8" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_339203" id="a9597516_303427"><img src="https://secure.gravatar.com/avatar/acd21cf298169c0b87813c52025ee6e9?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_339203" id="a9597516_303427"><a class="email " href="/user_profile?user_id=339203" > <span class="fna">Sid Stamm [:geekboy or :sstamm]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-8"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-8" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#c8">Comment 8</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-02-18 07:57 PST" data-time="1424275032">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-8">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-8" data-comment-id="9931249">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8562377" name="attach_8562377" title="bug_1086999_tests.patch">attachment 8562377</a> <a href="/attachment.cgi?id=8562377&amp;action=edit" title="bug_1086999_tests.patch">[details]</a> <a href="/attachment.cgi?id=8562377&amp;action=diff" title="bug_1086999_tests.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1086999&amp;attachment=8562377'>[review]</a>
bug_1086999_tests.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8562377" name="attach_8562377" title="bug_1086999_tests.patch">attachment 8562377</a> <a href="/attachment.cgi?id=8562377&amp;action=edit" title="bug_1086999_tests.patch">[details]</a> <a href="/attachment.cgi?id=8562377&amp;action=diff" title="bug_1086999_tests.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1086999&amp;attachment=8562377'>[review]</a>:
-----------------------------------------------------------------

r=me if you apply the right CSP for each test (see below) and verify that the tests work before landing.  I'm happy to re-review too if you want.

It's nice to see the event-based testing.  Do you think anything could cause neither one of the &quot;onload&quot; or &quot;onerror&quot; events to fire?

::: dom/base/test/csp/test_blob_data_schemes.html
&#64;&#64; +57,5 &#64;&#64;
<span class="quote">&gt; +  messageCounter = 0;
&gt; +
&gt; +  var src = &quot;file_csp_testserver.sjs&quot;;
&gt; +  // append the file that should be served
&gt; +  src += &quot;?file=&quot; + escape(&quot;tests/dom/base/test/csp/file_blob_data_schemes.html&quot;);</span >

Random question: why are the CSP tests still in dom/base?  Did we decide not to move them when we moved csp into dom/security?

&#64;&#64; +59,5 &#64;&#64;
<span class="quote">&gt; +  var src = &quot;file_csp_testserver.sjs&quot;;
&gt; +  // append the file that should be served
&gt; +  src += &quot;?file=&quot; + escape(&quot;tests/dom/base/test/csp/file_blob_data_schemes.html&quot;);
&gt; +  // append the CSP that should be used to serve the file
&gt; +  src += &quot;&amp;csp=&quot; + escape(&quot;default-src 'unsafe-inline' * blob: data:&quot;);</span >

Don't you want curTest.policy here instead of a CSP in a string literal?</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8562377&amp;action=edit"
           title="bug_1086999_tests.patch"
           class=""
        >Attachment #8562377</a> -
        Flags: review?(sstamm) &rarr; review+</div></div></div><div class="change-set" id="c9"><div class="comment" data-id="10011741" data-no="9"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-9" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a9597516_303427"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a9597516_303427"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-9"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-9" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#c9">Comment 9</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-10 14:29 PDT" data-time="1426022981">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-9">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8575573"
         class="attachment patch obsolete"
         data-id="8575573" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug_1086999.patch">
      <meta itemprop="contentSize" content="3276">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8575573">
          <a class="link" href="attachment.cgi?id=8575573&amp;action=diff">
        <span id="att-8575573-description" itemprop="description">bug_1086999.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8575573&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1086999&attachment=8575573">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-9" data-comment-id="10011741">(In reply to Sid Stamm [:geekboy or :sstamm] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - CSP: Asterisk (*) wildcard should not allow blob:, data:, or filesystem: when matching source expressions"
   href="/show_bug.cgi?id=1086999#c7">comment #7</a>)
<span class="quote">&gt; I think you want &quot;file&quot; here, not &quot;filesystem&quot;.  The WG should probably fix
&gt; that, or clarify where &quot;filesystem&quot; scheme is defined (I can't find it used
&gt; anywhere).
&gt; 
&gt; When you change this to &quot;file&quot;, please update nsCSPService.cpp too.
&gt; <a rel="nofollow" href="http://mxr.mozilla.org/mozilla-central/source/dom/security/nsCSPService">http://mxr.mozilla.org/mozilla-central/source/dom/security/nsCSPService</a>.
&gt; cpp#68</span >

Thanks - that's a great catch - updated!</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8562376&amp;action=edit"
           title="bug_1086999.patch"
           class=""
        >Attachment #8562376</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8562377&amp;action=edit"
           title="bug_1086999_tests.patch"
           class=""
        >Attachment #8562377</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8575573&amp;action=edit"
           title="bug_1086999.patch"
           class=""
        >Attachment #8575573</a> -
        Flags: review+</div></div></div><div class="change-set" id="c10"><div class="comment" data-id="10011770" data-no="10"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-10" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a9597516_303427"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a9597516_303427"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-10"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-10" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#c10">Comment 10</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-10 14:34 PDT" data-time="1426023257">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-10">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8575577"
         class="attachment patch"
         data-id="8575577" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug_1086999_tests.patch">
      <meta itemprop="contentSize" content="5781">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8575577">
          <a class="link" href="attachment.cgi?id=8575577&amp;action=diff">
        <span id="att-8575577-description" itemprop="description">bug_1086999_tests.patch</span></a>
        — <a href="attachment.cgi?id=8575577&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1086999&attachment=8575577">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-10" data-comment-id="10011770">(In reply to Sid Stamm [:geekboy or :sstamm] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - CSP: Asterisk (*) wildcard should not allow blob:, data:, or filesystem: when matching source expressions"
   href="/show_bug.cgi?id=1086999#c8">comment #8</a>)
<span class="quote">&gt; r=me if you apply the right CSP for each test (see below) and verify that
&gt; the tests work before landing.  I'm happy to re-review too if you want.</span >

Thanks Sid, addressed your concerns, the reason it was working is because I used ok() instead of is(). ok() just makes sure the first argument is non-null - updated those bits - still works.
 
<span class="quote">&gt; It's nice to see the event-based testing.  Do you think anything could cause
&gt; neither one of the &quot;onload&quot; or &quot;onerror&quot; events to fire?</span >

I don't think onload can cause problems, but I see onError overreporting, hence I slighlty updated to patch to wait for the callback that data and blob actually ran.

<span class="quote">&gt; Random question: why are the CSP tests still in dom/base?  Did we decide not
&gt; to move them when we moved csp into dom/security?</span >

It's blocked by some WebRTC problems - Nils is on it to get the problem fixed - once fixed we can finally move the tests into dom/security - I really want that to happen sooner than later.
 
<span class="quote">&gt; &#64;&#64; +59,5 &#64;&#64;
&gt; &gt; +  var src = &quot;file_csp_testserver.sjs&quot;;
&gt; &gt; +  // append the file that should be served
&gt; &gt; +  src += &quot;?file=&quot; + escape(&quot;tests/dom/base/test/csp/file_blob_data_schemes.html&quot;);
&gt; &gt; +  // append the CSP that should be used to serve the file
&gt; &gt; +  src += &quot;&amp;csp=&quot; + escape(&quot;default-src 'unsafe-inline' * blob: data:&quot;);
&gt; 
&gt; Don't you want curTest.policy here instead of a CSP in a string literal?</span >

Yes, explained above I was using ok() instead of is() - works correctly now.

I don't think there is need for a re-review - carrying over r+.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8575577&amp;action=edit"
           title="bug_1086999_tests.patch"
           class=""
        >Attachment #8575577</a> -
        Flags: review+</div></div></div><div class="change-set" id="c11"><div class="comment" data-id="10016317" data-no="11"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-11" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a9597516_303427"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a9597516_303427"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-11"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-11" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#c11">Comment 11</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-11 11:02 PDT" data-time="1426096963">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-11">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-11" data-comment-id="10016317">I had this patch on TRY [1] and apparently:
<span class="quote">&gt; ./mach web-platform-tests testing/web-platform/tests/content-security-policy/script-src/script-src-1_9.html</span >
is not running anymore. Reason is that the policy used for the test is:
<span class="quote">&gt; default-src *; report-uri ...</span >
which then blocks
<span class="quote">&gt; blob:<a rel="nofollow" href="http://web-platform.test:8000/d20996e0-961a-42a1-af82-244bfb1768fd">http://web-platform.test:8000/d20996e0-961a-42a1-af82-244bfb1768fd</a></span >

Since we are changing that blob and data URLs have to be whitelisted explicitly in the CSP policy in this bug we are blocking that request correctly, but now the test needs to be updated.

Interesting note, even without the patch the test does not pass, neither on Firefox, nor in Chrome, but the reason the mochitest-suite is complaining is the test is &quot;NOT RUN&quot; at all.

[1] <a rel="nofollow" href="https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=0ad9ee25eed8">https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=0ad9ee25eed8</a></pre></div><div class="change-set" id="c12"><div class="comment" data-id="10017372" data-no="12"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-12" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a9597516_303427"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a9597516_303427"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-12"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-12" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#c12">Comment 12</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-11 13:54 PDT" data-time="1426107297">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-12">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-12" data-comment-id="10017372">James, I see you checked in the latest web-platform-tests [1]. I found a compatibility problem (see <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - CSP: Asterisk (*) wildcard should not allow blob:, data:, or filesystem: when matching source expressions"
   href="/show_bug.cgi?id=1086999#c11">Comment 11</a>). Can you tell me the workflow how we update our web-platform tests? Where do we pull them from? I suppose I am not going to fix the test problem in mc, right? Potentially I have to create a pull request so the tests use a updated CSP which whitelists 'blobs' explicitly.

[1] <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Update wpt to a4f1782fd9e93746364ed219e60a8c2bafd0910e"
   href="/show_bug.cgi?id=1118722">https://bugzilla.mozilla.org/show_bug.cgi?id=1118722</a></pre><div class="activity"><div class="change">Flags: needinfo?(james)</div></div></div><div class="change-set" id="c13"><div class="comment" data-id="10017488" data-no="13"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-13" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_389650" id="a9597516_303427"><img src="https://secure.gravatar.com/avatar/1f995d40ccb8561d5ae1e53ede750c3e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_389650" id="a9597516_303427"><a class="email " href="/user_profile?user_id=389650" > <span class="fna">James Graham [:jgraham]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-13"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-13" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#c13">Comment 13</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-11 14:14 PDT" data-time="1426108449">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-13">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-13" data-comment-id="10017488">You actually can just do the fix in m-c and it will get upstreamed next time we do an update. Or you can do the fix in <a rel="nofollow" href="https://github.com/w3c/web-platform-tests">https://github.com/w3c/web-platform-tests</a> and it will gt downstreamed next time we do an update.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(james)</span></div></div></div><div class="change-set" id="c14"><div class="comment" data-id="10018264" data-no="14"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-14" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a9597516_303427"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a9597516_303427"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-14"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-14" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#c14">Comment 14</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-11 17:18 PDT" data-time="1426119513">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-14">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8576334"
         class="attachment patch"
         data-id="8576334" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug_1086999.patch">
      <meta itemprop="contentSize" content="1955">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8576334">
          <a class="link" href="attachment.cgi?id=8576334&amp;action=diff">
        <span id="att-8576334-description" itemprop="description">bug_1086999.patch</span></a>
        — <a href="attachment.cgi?id=8576334&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1086999&attachment=8576334">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-14" data-comment-id="10018264">Dan brought to my attention that it indeed should be 'filesystem:' and not 'file:' - I added a comment to make sure we are spec compliant even though firefox does not support 'filesystem:' schemes at the moment.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8575573&amp;action=edit"
           title="bug_1086999.patch"
           class=""
        >Attachment #8575573</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8576334&amp;action=edit"
           title="bug_1086999.patch"
           class=""
        >Attachment #8576334</a> -
        Flags: review+</div></div></div><div class="change-set" id="c15"><div class="comment" data-id="10018291" data-no="15"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-15" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a9597516_303427"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a9597516_303427"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-15"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-15" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#c15">Comment 15</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-11 17:25 PDT" data-time="1426119946">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-15">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8576337"
         class="attachment patch obsolete"
         data-id="8576337" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug_1086999_web_platform_test_update.patch">
      <meta itemprop="contentSize" content="2236">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8576337">
          <a class="link" href="attachment.cgi?id=8576337&amp;action=diff">
        <span id="att-8576337-description" itemprop="description">bug_1086999_web_platform_test_update.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8576337&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1086999&attachment=8576337">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-15" data-comment-id="10018291"><span class="quote">&gt; &#64;Sid:</span >
I had to change this web-platform test since the blob is now blocked correctly, hence the postMessage can't fire anymore.

In fact, we should also send a violation report, but at the moment we don't because we incorrectly identify the load as a preLoad [1].

We have already identified the problem of incorrectly classifying preloads once a while ago [2] - we have to fix that at some point.


[1] <a rel="nofollow" href="http://mxr.mozilla.org/mozilla-central/source/dom/security/nsCSPContext.cpp#163">http://mxr.mozilla.org/mozilla-central/source/dom/security/nsCSPContext.cpp#163</a>
[2] <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Add internal contentPolicyTypes to allow identification of preloads within CSP"
   href="/show_bug.cgi?id=1048048#c4">https://bugzilla.mozilla.org/show_bug.cgi?id=1048048#c4</a>

<span class="quote">&gt; &#64;James:</span >
Thanks for the speedy response. Does the change look reasonable to you? I would rather land on mc and then have you do the upstream instead of the other way round.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8576337&amp;action=edit"
           title="bug_1086999_web_platform_test_update.patch"
           class=""
        >Attachment #8576337</a> -
        Flags: review?(sstamm)</div><div class="change">
        <a href="/attachment.cgi?id=8576337&amp;action=edit"
           title="bug_1086999_web_platform_test_update.patch"
           class=""
        >Attachment #8576337</a> -
        Flags: review?(james)</div></div></div><div class="change-set" id="c16"><div class="comment" data-id="10037498" data-no="16"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-16" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_339203" id="a9597516_303427"><img src="https://secure.gravatar.com/avatar/acd21cf298169c0b87813c52025ee6e9?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_339203" id="a9597516_303427"><a class="email " href="/user_profile?user_id=339203" > <span class="fna">Sid Stamm [:geekboy or :sstamm]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-16"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-16" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#c16">Comment 16</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-16 18:12 PDT" data-time="1426554753">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-16">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-16" data-comment-id="10037498">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8576337" name="attach_8576337" title="bug_1086999_web_platform_test_update.patch">attachment 8576337</a> <a href="/attachment.cgi?id=8576337&amp;action=edit" title="bug_1086999_web_platform_test_update.patch">[details]</a> <a href="/attachment.cgi?id=8576337&amp;action=diff" title="bug_1086999_web_platform_test_update.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1086999&amp;attachment=8576337'>[review]</a>
bug_1086999_web_platform_test_update.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8576337" name="attach_8576337" title="bug_1086999_web_platform_test_update.patch">attachment 8576337</a> <a href="/attachment.cgi?id=8576337&amp;action=edit" title="bug_1086999_web_platform_test_update.patch">[details]</a> <a href="/attachment.cgi?id=8576337&amp;action=diff" title="bug_1086999_web_platform_test_update.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1086999&amp;attachment=8576337'>[review]</a>:
-----------------------------------------------------------------

::: testing/web-platform/tests/content-security-policy/script-src/buildInlineWorker.js
&#64;&#64; +24,2 &#64;&#64;
<span class="quote">&gt;      test.step(function () {
&gt; +       assert_true(true, 'inline script not ran');</span >

Nit: grammar.  Maybe 'inline script was blocked'?</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8576337&amp;action=edit"
           title="bug_1086999_web_platform_test_update.patch"
           class=""
        >Attachment #8576337</a> -
        Flags: review?(sstamm) &rarr; review+</div></div></div><div class="change-set" id="c17"><div class="comment" data-id="10051751" data-no="17"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-17" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_389650" id="a9597516_303427"><img src="https://secure.gravatar.com/avatar/1f995d40ccb8561d5ae1e53ede750c3e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_389650" id="a9597516_303427"><a class="email " href="/user_profile?user_id=389650" > <span class="fna">James Graham [:jgraham]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-17"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-17" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#c17">Comment 17</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-19 09:49 PDT" data-time="1426783764">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-17">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-17" data-comment-id="10051751">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8576337" name="attach_8576337" title="bug_1086999_web_platform_test_update.patch">attachment 8576337</a> <a href="/attachment.cgi?id=8576337&amp;action=edit" title="bug_1086999_web_platform_test_update.patch">[details]</a> <a href="/attachment.cgi?id=8576337&amp;action=diff" title="bug_1086999_web_platform_test_update.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1086999&amp;attachment=8576337'>[review]</a>
bug_1086999_web_platform_test_update.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8576337" name="attach_8576337" title="bug_1086999_web_platform_test_update.patch">attachment 8576337</a> <a href="/attachment.cgi?id=8576337&amp;action=edit" title="bug_1086999_web_platform_test_update.patch">[details]</a> <a href="/attachment.cgi?id=8576337&amp;action=diff" title="bug_1086999_web_platform_test_update.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1086999&amp;attachment=8576337'>[review]</a>:
-----------------------------------------------------------------

Just some style issues.

::: testing/web-platform/meta/content-security-policy/script-src/script-src-1_9.html.ini
&#64;&#64; +1,4 &#64;&#64;
<span class="quote">&gt;  [script-src-1_9.html]
&gt;    type: testharness
&gt;    [test inline worker]
&gt; +    expected: PASS</span >

You don't need expected: PASS, that's the default. Just remove the whole subsection.

::: testing/web-platform/tests/content-security-policy/script-src/buildInlineWorker.js
&#64;&#64; +7,5 &#64;&#64;
<span class="quote">&gt;  
&gt;   // can I create a new script tag like this? ack...
&gt;   var url = window.URL.createObjectURL(blob);
&gt;  
&gt; + try {</span >

So I haven't looked at the spec here, I'm just judging the test as a whole. I think the intent isn't very clear; it's not obvious what can fail. So based on what I think I understand, the test should look more like:

var t = async_test(&quot;inline worker&quot;);

t.step(function() {
  var workerSource = document.getElementById('inlineWorker');
  var blob = new Blob([workerSource.textContent]);
  try {
    var worker = new Worker(url);
  catch(e) {
    // Would be nice to assert something about e here
    // But otehrwise the test passes if trying to construct the worker throws
    t.done();
  }
  // Not sure why this isn't assert_unreached() to fail the test…
  worker.addEventListener(&quot;message&quot;, t.step_func(function(e) {
    assert_unreached(&quot;script ran&quot;);
  })

  worker.postMessage(&quot;&quot;);
})

And actually, you can probably strip most of the boilerplate away thus:

var workerSource = document.getElementById('inlineWorker');
var blob = new Blob([workerSource.textContent]);
try {
  var worker = new Worker(url);
catch(e) {
  // Would be nice to assert something about e here
  // But otehrwise the test passes if trying to construct the worker throws
  done();
}
// Not sure why this isn't assert_unreached() to fail the test…
worker.addEventListener(&quot;message&quot;, function(e) {
    assert_unreached(&quot;script ran&quot;);
})

worker.postMessage(&quot;&quot;);


Which works because there's only one test in the file.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8576337&amp;action=edit"
           title="bug_1086999_web_platform_test_update.patch"
           class=""
        >Attachment #8576337</a> -
        Flags: review?(james) &rarr; review-</div></div></div><div class="change-set" id="c18"><div class="comment" data-id="10053659" data-no="18"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-18" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a9597516_303427"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a9597516_303427"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-18"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-18" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#c18">Comment 18</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-19 16:26 PDT" data-time="1426807590">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-18">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8580349"
         class="attachment patch obsolete"
         data-id="8580349" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug_1086999_web_platform_test_update.patch">
      <meta itemprop="contentSize" content="2034">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8580349">
          <a class="link" href="attachment.cgi?id=8580349&amp;action=diff">
        <span id="att-8580349-description" itemprop="description">bug_1086999_web_platform_test_update.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8580349&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1086999&attachment=8580349">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-18" data-comment-id="10053659">James, thanks for the info, that all makes sense to me. Unfortunately there is nothing we can assert before we call done() in the catch-block.

The only thing we can do is to fix the preload problem I described so that we actually send out a violation report so that both tests in that testfile pass. But that might take a while, it's not super high up in my priority list at the moment.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8576337&amp;action=edit"
           title="bug_1086999_web_platform_test_update.patch"
           class=""
        >Attachment #8576337</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8580349&amp;action=edit"
           title="bug_1086999_web_platform_test_update.patch"
           class=""
        >Attachment #8580349</a> -
        Flags: review?(james)</div></div></div><div class="change-set" id="c19"><div class="comment" data-id="10053674" data-no="19"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-19" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a9597516_303427"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a9597516_303427"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-19"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-19" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#c19">Comment 19</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-19 16:29 PDT" data-time="1426807749">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-19">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8580352"
         class="attachment patch"
         data-id="8580352" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug_1086999_web_platform_test_update.patch">
      <meta itemprop="contentSize" content="1978">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8580352">
          <a class="link" href="attachment.cgi?id=8580352&amp;action=diff">
        <span id="att-8580352-description" itemprop="description">bug_1086999_web_platform_test_update.patch</span></a>
        — <a href="attachment.cgi?id=8580352&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1086999&attachment=8580352">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-19" data-comment-id="10053674">Oops - forgot to qref before uploading the patch - here we go.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8580349&amp;action=edit"
           title="bug_1086999_web_platform_test_update.patch"
           class=""
        >Attachment #8580349</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8580349&amp;action=edit"
           title="bug_1086999_web_platform_test_update.patch"
           class=""
        >Attachment #8580349</a> -
        Flags: <span class="activity-deleted">review?(james)</span></div><div class="change">
        <a href="/attachment.cgi?id=8580352&amp;action=edit"
           title="bug_1086999_web_platform_test_update.patch"
           class=""
        >Attachment #8580352</a> -
        Flags: review?(james)</div></div></div><div class="change-set" id="a12941134_363267"><div class="change" id="aa12941134_363267">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a12941134_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_363267" id="a12941134_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a12941134_363267"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a12941134_363267">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#a12941134_363267">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-20 09:48 PDT" data-time="1426870094">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Blocks: <a class="bz_bug_link
          bz_status_NEW"
   title="NEW - Content Security Policy (CSP) blocks SVG embedded as data URI in CSS url()"
   href="/show_bug.cgi?id=878608">878608</a></div></div></div><div class="change-set" id="a13177752_389650"><div class="change" id="aa13177752_389650">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_389650" id="a13177752_389650"><img src="https://secure.gravatar.com/avatar/1f995d40ccb8561d5ae1e53ede750c3e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_389650" id="a13177752_389650"><a class="email " href="/user_profile?user_id=389650" > <span class="fna">James Graham [:jgraham]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a13177752_389650"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a13177752_389650">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#a13177752_389650">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-23 03:31 PDT" data-time="1427106712">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8580352&amp;action=edit"
           title="bug_1086999_web_platform_test_update.patch"
           class=""
        >Attachment #8580352</a> -
        Flags: review?(james) &rarr; review+</div></div></div><div class="change-set" id="c20"><div class="comment" data-id="10065048" data-no="20"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-20" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a13177752_389650"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a13177752_389650"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-20"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-20" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#c20">Comment 20</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-23 09:23 PDT" data-time="1427127834">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-20">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-20" data-comment-id="10065048"><a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/5f23080673ee">https://hg.mozilla.org/integration/mozilla-inbound/rev/5f23080673ee</a>
<a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/cb83b6efa9ea">https://hg.mozilla.org/integration/mozilla-inbound/rev/cb83b6efa9ea</a>
<a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/772945b1130d">https://hg.mozilla.org/integration/mozilla-inbound/rev/772945b1130d</a></pre><div class="activity"><div class="change">Target Milestone: --- &rarr; mozilla39</div></div></div><div class="change-set" id="c21"><div class="comment" data-id="10065757" data-no="21"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-21" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a13177752_389650"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a13177752_389650"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-21"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-21" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#c21">Comment 21</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-23 11:22 PDT" data-time="1427134969">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-21">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-21" data-comment-id="10065757">Backed out for Gaia context_menu_test.js integration test failures.
<a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/84f7fa96af4f">https://hg.mozilla.org/integration/mozilla-inbound/rev/84f7fa96af4f</a>

<a rel="nofollow" href="https://treeherder.mozilla.org/logviewer.html#?job_id=7938256&amp;repo=mozilla-inbound">https://treeherder.mozilla.org/logviewer.html#?job_id=7938256&amp;repo=mozilla-inbound</a></pre></div><div class="change-set" id="c22"><div class="comment" data-id="10065856" data-no="22"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-22" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a13177752_389650"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a13177752_389650"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-22"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-22" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#c22">Comment 22</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-23 11:37 PDT" data-time="1427135860">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-22">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-22" data-comment-id="10065856">Potentially also causing intermittents for <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED WORKSFORME - Intermittent media-src-7_1.html | In-policy async video source element - expected PASS"
   href="/show_bug.cgi?id=1138973">Bug 1138973</a> and <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Intermittent media-src-7_1.html | Violation report status OK. - Test timed out"
   href="/show_bug.cgi?id=1124091">Bug 1124091</a></pre></div><div class="change-set" id="c23"><div class="comment" data-id="10078622" data-no="23"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-23" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a13177752_389650"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a13177752_389650"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-23"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-23" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#c23">Comment 23</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-25 16:04 PDT" data-time="1427324642">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-23">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8583426"
         class="attachment patch"
         data-id="8583426" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug_1086999_b2g_policy_updates.patch">
      <meta itemprop="contentSize" content="3897">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8583426">
          <a class="link" href="attachment.cgi?id=8583426&amp;action=diff">
        <span id="att-8583426-description" itemprop="description">bug_1086999_b2g_policy_updates.patch</span></a>
        — <a href="attachment.cgi?id=8583426&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1086999&attachment=8583426">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-23" data-comment-id="10078622">Fabrice, the csp spec [1] states that the wildcard (*) should not match data:, blob: and filesystem:. We have incorporated that change into our CSP implementation, which is now breaking B2G, specifically it's breaking the following gaia integration test:
<span class="quote">&gt; apps/system/test/marionette/context_menu_test.js</span >
which uses the CSP defined in modules/libpref/init/all.js.

I am not sure if I have updated all the right policies in the attached patch. I am also not sure whether this is the right change to perform, maybe the default policy for trusted, privileged or certified apps should not even allow blob: or data: schemes.

One thing to mention (and to be explicit):
<span class="quote">&gt; default-src *</span >
is now equivalent to
<span class="quote">&gt; default-src * blob: data:</span >

Please let me know how to proceed!


[1] <a rel="nofollow" href="http://www.w3.org/TR/CSP11/#match-source-expression">http://www.w3.org/TR/CSP11/#match-source-expression</a></pre><div class="activity"><div class="change">Flags: needinfo?(fabrice)</div><div class="change">
        <a href="/attachment.cgi?id=8583426&amp;action=edit"
           title="bug_1086999_b2g_policy_updates.patch"
           class=""
        >Attachment #8583426</a> -
        Flags: feedback?(fabrice)</div></div></div><div class="change-set" id="c24"><div class="comment" data-id="10088183" data-no="24"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-24" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_390071" id="a13177752_389650"><img src="https://secure.gravatar.com/avatar/bc49a1bf10e676d3040252dedf2bacc3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_390071" id="a13177752_389650"><a class="email " href="/user_profile?user_id=390071" > <span class="fna">[:fabrice] Fabrice Desré</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-24"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-24" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#c24">Comment 24</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-27 09:26 PDT" data-time="1427473599">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-24">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-24" data-comment-id="10088183">I'm gonna redirect to Paul that knows that much better than I do.</pre><div class="activity"><div class="change">Flags: needinfo?(fabrice) &rarr; needinfo?(ptheriault)</div></div></div><div class="change-set" id="a13544663_390071"><div class="change" id="aa13544663_390071">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_390071" id="a13544663_390071"><img src="https://secure.gravatar.com/avatar/bc49a1bf10e676d3040252dedf2bacc3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_390071" id="a13544663_390071"><a class="email " href="/user_profile?user_id=390071" > <span class="fna">[:fabrice] Fabrice Desré</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a13544663_390071"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a13544663_390071">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#a13544663_390071">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-27 09:27 PDT" data-time="1427473623">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8583426&amp;action=edit"
           title="bug_1086999_b2g_policy_updates.patch"
           class=""
        >Attachment #8583426</a> -
        Flags: feedback?(fabrice) &rarr; feedback?(ptheriault)</div></div></div><div class="change-set" id="c25"><div class="comment" data-id="10094505" data-no="25"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-25" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_434339" id="a13544663_390071"><img src="https://secure.gravatar.com/avatar/9a0a16bc1cb5b0144e373deb8e357804?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_434339" id="a13544663_390071"><a class="email disabled" href="/user_profile?user_id=434339" > <span class="fna">Paul Theriault [:pauljt] (no longer reading bugmail)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-25"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-25" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#c25">Comment 25</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-30 01:46 PDT" data-time="1427705168">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-25">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-25" data-comment-id="10094505">(In reply to Christoph Kerschbaumer [:ckerschb] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - CSP: Asterisk (*) wildcard should not allow blob:, data:, or filesystem: when matching source expressions"
   href="/show_bug.cgi?id=1086999#c23">comment #23</a>)
<span class="quote">&gt; Created <span class=""><a href="/attachment.cgi?id=8583426" name="attach_8583426" title="bug_1086999_b2g_policy_updates.patch">attachment 8583426</a> <a href="/attachment.cgi?id=8583426&amp;action=edit" title="bug_1086999_b2g_policy_updates.patch">[details]</a> <a href="/attachment.cgi?id=8583426&amp;action=diff" title="bug_1086999_b2g_policy_updates.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1086999&amp;attachment=8583426'>[review]</a>
&gt; bug_1086999_b2g_policy_updates.patch
&gt; 
&gt; Fabrice, the csp spec [1] states that the wildcard (*) should not match
&gt; data:, blob: and filesystem:. We have incorporated that change into our CSP
&gt; implementation, which is now breaking B2G, specifically it's breaking the
&gt; following gaia integration test:
&gt; &gt; apps/system/test/marionette/context_menu_test.js
&gt; which uses the CSP defined in modules/libpref/init/all.js.
&gt; 
&gt; I am not sure if I have updated all the right policies in the attached
&gt; patch. I am also not sure whether this is the right change to perform, maybe
&gt; the default policy for trusted, privileged or certified apps should not even
&gt; allow blob: or data: schemes.
&gt; 
&gt; One thing to mention (and to be explicit):
&gt; &gt; default-src *
&gt; is now equivalent to
&gt; &gt; default-src * blob: data:
&gt; 
&gt; Please let me know how to proceed!
&gt; 
&gt; 
&gt; [1] <a rel="nofollow" href="http://www.w3.org/TR/CSP11/#match-source-expression">http://www.w3.org/TR/CSP11/#match-source-expression</a></span >

Thanks Christoph - this looks good to me in terms of whats in the policy.  Certified apps use blob: uris all over the place (wallpaper, icons etc), and we mainly care about script (I care about inline styles too, but 968907 blocks using style-src 'self' )

I was going to suggest that we could also just not supply a default-src attribute, but I read from the spec that if default-src is NOT supplied, then it default's to * (i.e. blocking data: &amp; blob:). 

I don't know why we set the privileged CSP preference in a different place to where we set the certified apps CSP, or if this is indeed the correct place though. (TBH I thought we set them in b2g.js, I'm not sure why the privileged one moved to modules/libpref/init/all.js)</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(ptheriault)</span></div></div></div><div class="change-set" id="c26"><div class="comment" data-id="10096035" data-no="26"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-26" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_390071" id="a13544663_390071"><img src="https://secure.gravatar.com/avatar/bc49a1bf10e676d3040252dedf2bacc3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_390071" id="a13544663_390071"><a class="email " href="/user_profile?user_id=390071" > <span class="fna">[:fabrice] Fabrice Desré</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-26"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-26" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#c26">Comment 26</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-30 09:25 PDT" data-time="1427732717">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-26">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-26" data-comment-id="10096035">(In reply to Paul Theriault [:pauljt] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - CSP: Asterisk (*) wildcard should not allow blob:, data:, or filesystem: when matching source expressions"
   href="/show_bug.cgi?id=1086999#c25">comment #25</a>)

<span class="quote">&gt; I don't know why we set the privileged CSP preference in a different place
&gt; to where we set the certified apps CSP, or if this is indeed the correct
&gt; place though. (TBH I thought we set them in b2g.js, I'm not sure why the
&gt; privileged one moved to modules/libpref/init/all.js)</span >

We did that when android and desktop started to support privileged apps.</pre></div><div class="change-set" id="c27"><div class="comment" data-id="10101697" data-no="27"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-27" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a13544663_390071"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a13544663_390071"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-27"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-27" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#c27">Comment 27</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-31 10:42 PDT" data-time="1427823752">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-27">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-27" data-comment-id="10101697">Comment on <span class=""><a href="/attachment.cgi?id=8583426" name="attach_8583426" title="bug_1086999_b2g_policy_updates.patch">attachment 8583426</a> <a href="/attachment.cgi?id=8583426&amp;action=edit" title="bug_1086999_b2g_policy_updates.patch">[details]</a> <a href="/attachment.cgi?id=8583426&amp;action=diff" title="bug_1086999_b2g_policy_updates.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1086999&amp;attachment=8583426'>[review]</a>
bug_1086999_b2g_policy_updates.patch

Paul, seems like you are fine with the change, right? If so, could you r+ the patch, otherwise please let me know how to update. Thanks!</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8583426&amp;action=edit"
           title="bug_1086999_b2g_policy_updates.patch"
           class=""
        >Attachment #8583426</a> -
        Flags: feedback?(ptheriault) &rarr; review?(ptheriault)</div></div></div><div class="change-set" id="a14017279_434339"><div class="change" id="aa14017279_434339">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_434339" id="a14017279_434339"><img src="https://secure.gravatar.com/avatar/9a0a16bc1cb5b0144e373deb8e357804?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_434339" id="a14017279_434339"><a class="email disabled" href="/user_profile?user_id=434339" > <span class="fna">Paul Theriault [:pauljt] (no longer reading bugmail)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a14017279_434339"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a14017279_434339">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#a14017279_434339">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-01 20:43 PDT" data-time="1427946239">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8583426&amp;action=edit"
           title="bug_1086999_b2g_policy_updates.patch"
           class=""
        >Attachment #8583426</a> -
        Flags: review?(ptheriault) &rarr; review+</div></div></div><div class="change-set" id="c28"><div class="comment" data-id="10109471" data-no="28"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-28" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_434339" id="a14017279_434339"><img src="https://secure.gravatar.com/avatar/9a0a16bc1cb5b0144e373deb8e357804?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_434339" id="a14017279_434339"><a class="email disabled" href="/user_profile?user_id=434339" > <span class="fna">Paul Theriault [:pauljt] (no longer reading bugmail)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-28"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-28" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#c28">Comment 28</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-01 20:44 PDT" data-time="1427946267">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-28">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-28" data-comment-id="10109471">(In reply to Christoph Kerschbaumer [:ckerschb] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - CSP: Asterisk (*) wildcard should not allow blob:, data:, or filesystem: when matching source expressions"
   href="/show_bug.cgi?id=1086999#c27">comment #27</a>)
<span class="quote">&gt; Comment on <span class=""><a href="/attachment.cgi?id=8583426" name="attach_8583426" title="bug_1086999_b2g_policy_updates.patch">attachment 8583426</a> <a href="/attachment.cgi?id=8583426&amp;action=edit" title="bug_1086999_b2g_policy_updates.patch">[details]</a> <a href="/attachment.cgi?id=8583426&amp;action=diff" title="bug_1086999_b2g_policy_updates.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1086999&amp;attachment=8583426'>[review]</a>
&gt; bug_1086999_b2g_policy_updates.patch
&gt; 
&gt; Paul, seems like you are fine with the change, right? If so, could you r+
&gt; the patch, otherwise please let me know how to update. Thanks!</span >

Yep - big thanks for this Christoph.</pre></div><div class="change-set" id="c29"><div class="comment" data-id="10121343" data-no="29"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-29" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a14017279_434339"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a14017279_434339"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-29"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-29" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#c29">Comment 29</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-06 09:04 PDT" data-time="1428336250">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-29">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-29" data-comment-id="10121343"><a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/3aaf3cccabac">https://hg.mozilla.org/integration/mozilla-inbound/rev/3aaf3cccabac</a>
<a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/c683f8d5426d">https://hg.mozilla.org/integration/mozilla-inbound/rev/c683f8d5426d</a>
<a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/a8aa222f1d01">https://hg.mozilla.org/integration/mozilla-inbound/rev/a8aa222f1d01</a>
<a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/183190289b9c">https://hg.mozilla.org/integration/mozilla-inbound/rev/183190289b9c</a></pre><div class="activity"><div class="change">Target Milestone: mozilla39 &rarr; mozilla40</div></div></div><div class="change-set" id="c30"><div class="comment" data-id="10123678" data-no="30"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-30" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a14017279_434339"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a14017279_434339"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-30"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-30" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#c30">Comment 30</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-06 18:24 PDT" data-time="1428369893">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-30">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-30" data-comment-id="10123678"><a rel="nofollow" href="https://hg.mozilla.org/mozilla-central/rev/3aaf3cccabac">https://hg.mozilla.org/mozilla-central/rev/3aaf3cccabac</a>
<a rel="nofollow" href="https://hg.mozilla.org/mozilla-central/rev/c683f8d5426d">https://hg.mozilla.org/mozilla-central/rev/c683f8d5426d</a>
<a rel="nofollow" href="https://hg.mozilla.org/mozilla-central/rev/a8aa222f1d01">https://hg.mozilla.org/mozilla-central/rev/a8aa222f1d01</a>
<a rel="nofollow" href="https://hg.mozilla.org/mozilla-central/rev/183190289b9c">https://hg.mozilla.org/mozilla-central/rev/183190289b9c</a></pre><div class="activity"><div class="change">Status: ASSIGNED &rarr; RESOLVED</div><div class="change">Closed: <span class="rel-time" title="2015-04-06 18:24 PDT" data-time="1428369893">7 years ago</span></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox40&amp;o1=isnotempty">status-firefox40</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox40&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">Flags: in-testsuite+</div><div class="change">Resolution: --- &rarr; FIXED</div></div></div><div class="change-set" id="a15457892_293623"><div class="change" id="aa15457892_293623">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_293623" id="a15457892_293623"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_293623" id="a15457892_293623"><a class="email " href="/user_profile?user_id=293623" > <span class="fna">Alice0775 White</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a15457892_293623"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a15457892_293623">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#a15457892_293623">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-18 12:54 PDT" data-time="1429386852">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED WORKSFORME - cnn.com home page shows low-resolution placeholder image until window is resized"
   href="/show_bug.cgi?id=1155792">1155792</a></div></div></div><div class="change-set" id="a15631427_20209"><div class="change" id="aa15631427_20209">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_20209" id="a15631427_20209"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_20209" id="a15631427_20209"><a class="email " href="/user_profile?user_id=20209" > <span class="fna">Boris Zbarsky [:bzbarsky]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a15631427_20209"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a15631427_20209">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#a15631427_20209">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-20 13:06 PDT" data-time="1429560387">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED WORKSFORME - WhatsApp Web displaying wrongly because page's settings block the loading of a resource at data:image/... (&quot;img-src *&quot;)"
   href="/show_bug.cgi?id=1154704">1154704</a></div></div></div><div class="change-set" id="c31"><div class="comment" data-id="10177132" data-no="31"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-31" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_20209" id="a15631427_20209"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_20209" id="a15631427_20209"><a class="email " href="/user_profile?user_id=20209" > <span class="fna">Boris Zbarsky [:bzbarsky]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-31"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-31" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#c31">Comment 31</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-20 13:07 PDT" data-time="1429560455">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-31">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-31" data-comment-id="10177132">Does any browser implement this part of the spec?  We've now had at least two instances of site breakage reported in the two weeks since this patch landed...  It may just be that no one implemented the spec correctly and now the spec is not web-compatible.</pre><div class="activity"><div class="change">Flags: needinfo?(mozilla)</div></div></div><div class="change-set" id="c32"><div class="comment" data-id="10177745" data-no="32"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-32" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a15631427_20209"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a15631427_20209"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-32"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-32" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#c32">Comment 32</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-20 15:33 PDT" data-time="1429569210">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-32">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-32" data-comment-id="10177745">(In reply to Not doing reviews right now from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - CSP: Asterisk (*) wildcard should not allow blob:, data:, or filesystem: when matching source expressions"
   href="/show_bug.cgi?id=1086999#c31">comment #31</a>)
<span class="quote">&gt; Does any browser implement this part of the spec?</span >

Our original implementation did (X-Content-Security-Policy header, written in JS). Apparently a casualty of the C++ rewrite.

<span class="quote">&gt; We've now had at least two instances of site breakage reported in the two weeks since
&gt; this patch landed...  It may just be that no one implemented the spec correctly and now
&gt; the spec is not web-compatible.</span >

Probably, and the remaining options are really sucky. The downsides to supporting data: don't affect Chrome because they never supported the part of the HTML5 spec that says they should be same-origin with the context that created them. Because we _do_ it is absolutely unsafe to allow '*' to include data: for iframe-src, script-src, object-src, and to a lesser extent script-src. No one's likely to do &quot;script-src *&quot;, but if they rely on the same-origin policy they might well leave out frame-src and let it fallback to a &quot;default-src *&quot; -- harmless in Chrome, deadly in Firefox.

Our options seem to be:
 a) insist on the spec interpretation, and tech evangelize the broken sites (how many sites use CSP?)
 b) go ahead and make data: no longer inherit the principal. Although it's the logical equivalent to document.write() it's been a huge footgun for us anyway. Will probably break some Firefox-only content though.
 c) have '*' include data: for image-src and media-src where it's not that dangerous since that's the case we keep breaking. But now the behavior of * is inconsistent depending on CSP directive.
 d) switch the gating permission for data: in the dangerous contexts on the user having set 'unsafe-inline' on the appropriate directive. bonus: we really ought to have done that for iframe srcdoc anyway.</pre></div><div class="change-set" id="c33"><div class="comment" data-id="10178392" data-no="33"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-33" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_20209" id="a15631427_20209"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_20209" id="a15631427_20209"><a class="email " href="/user_profile?user_id=20209" > <span class="fna">Boris Zbarsky [:bzbarsky]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-33"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-33" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#c33">Comment 33</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-20 18:47 PDT" data-time="1429580840">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-33">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-33" data-comment-id="10178392"> e) As (b) but only on sites where there is a CSP.  Might be confusing to people, though.</pre></div><div class="change-set" id="a15743310_258260"><div class="change" id="aa15743310_258260">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_258260" id="a15743310_258260"><img src="https://secure.gravatar.com/avatar/8b1310ea5e48db8c93631d8a51a13827?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_258260" id="a15743310_258260"><a class="email " href="/user_profile?user_id=258260" > <span class="fna">Fred Wenzel [:wenzel]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a15743310_258260"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a15743310_258260">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#a15743310_258260">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-21 20:11 PDT" data-time="1429672270">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Fastmail.com missing images due to CSP error"
   href="/show_bug.cgi?id=1157084">1157084</a></div></div></div><div class="change-set" id="c34"><div class="comment" data-id="10188642" data-no="34"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-34" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a15743310_258260"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a15743310_258260"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-34"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-34" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#c34">Comment 34</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-22 20:02 PDT" data-time="1429758151">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-34">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-34" data-comment-id="10188642">Thanks Boris and Dan for the info/feedback. Unfortunately none of the options mentioned in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - CSP: Asterisk (*) wildcard should not allow blob:, data:, or filesystem: when matching source expressions"
   href="/show_bug.cgi?id=1086999#c32">Comment 32</a> and <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - CSP: Asterisk (*) wildcard should not allow blob:, data:, or filesystem: when matching source expressions"
   href="/show_bug.cgi?id=1086999#c33">Comment 33</a> seem compelling at the moment.

So far we got three bug reports of web compatibility issues after landing the patches attached to this Bug (1157084, 1154704, 1155792).

After chatting with Dan in person, I think we realistically of two options:
a) We back out the change for now.
b) We file evangelism bugs for the three sites that break and hope they update their sites quickly. And further hope that Mike sees that the same way [1] so other browser's CSP implementations are going to match ours in regards to blocking blob:, data:, if not explicitly whitelisted in the CSP header.

[1] <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED WORKSFORME - cnn.com home page shows low-resolution placeholder image until window is resized"
   href="/show_bug.cgi?id=1155792#c7">https://bugzilla.mozilla.org/show_bug.cgi?id=1155792#c7</a></pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(mozilla)</span></div></div></div><div class="change-set" id="a15931033_240353"><div class="change" id="aa15931033_240353">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_240353" id="a15931033_240353"><img src="https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_240353" id="a15931033_240353"><a class="email " href="/user_profile?user_id=240353" > <span class="fna">Marco Bonardo [:mak]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a15931033_240353"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a15931033_240353">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#a15931033_240353">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-24 00:19 PDT" data-time="1429859993">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED INVALID - html5test doesn't detect script execution events"
   href="/show_bug.cgi?id=1157724">1157724</a></div></div></div><div class="change-set" id="c35"><div class="comment" data-id="10194983" data-no="35"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-35" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_446518" id="a15931033_240353"><img src="https://secure.gravatar.com/avatar/337fa9c543a4f881977b6d2fbbd2dea8?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_446518" id="a15931033_240353"><a class="email " href="/user_profile?user_id=446518" > <span class="fna">Sebastian Zartner [:sebo]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-35"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-35" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#c35">Comment 35</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-24 03:10 PDT" data-time="1429870258">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-35">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-35" data-comment-id="10194983">(In reply to Christoph Kerschbaumer [:ckerschb] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - CSP: Asterisk (*) wildcard should not allow blob:, data:, or filesystem: when matching source expressions"
   href="/show_bug.cgi?id=1086999#c34">comment #34</a>)
<span class="quote">&gt; So far we got three bug reports of web compatibility issues after landing
&gt; the patches attached to this Bug (1157084, 1154704, 1155792).</span >

<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED INVALID - html5test doesn't detect script execution events"
   href="/show_bug.cgi?id=1157724">Bug 1157724</a> is another one, though this can be easily fixed on the website. So I filed an issue there.[1]

Sebastian

[1] <a rel="nofollow" href="https://github.com/NielsLeenheer/html5test/issues/387">https://github.com/NielsLeenheer/html5test/issues/387</a></pre></div><div class="change-set" id="c36"><div class="comment" data-id="10217565" data-no="36"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-36" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_451704" id="a15931033_240353"><img src="https://secure.gravatar.com/avatar/6168ea97fda0cefa449331e59b24e8f7?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_451704" id="a15931033_240353"><a class="email " href="/user_profile?user_id=451704" > <span class="fna">Liz Henry (:lizzard Please n-i to RyanVM, jcristau, or pascal)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-36"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-36" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#c36">Comment 36</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-30 08:56 PDT" data-time="1430409382">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-36">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-36" data-comment-id="10217565">Tracking this for Firefox 40 since it doesn't seem to be completely resolved and we're seeing multiple reports of sites breaking.</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox40&amp;o1=isnotempty">tracking-firefox40</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox40&amp;o1=equals&amp;v1=%2B">+</a></div></div></div><div class="change-set" id="a17789621_232883"><div class="change" id="aa17789621_232883">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_232883" id="a17789621_232883"><img src="https://secure.gravatar.com/avatar/f84bbc6968ecda0a64ab50d1060c320e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_232883" id="a17789621_232883"><a class="email " href="/user_profile?user_id=232883" > <span class="fna">Kohei Yoshino</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a17789621_232883"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a17789621_232883">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#a17789621_232883">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-15 12:36 PDT" data-time="1431718581">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Keywords: <a href="/buglist.cgi?keywords=site-compat&amp;resolution=---">site-compat</a></div></div></div><div class="change-set" id="a21998552_232883"><div class="change" id="aa21998552_232883">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_232883" id="a21998552_232883"><img src="https://secure.gravatar.com/avatar/f84bbc6968ecda0a64ab50d1060c320e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_232883" id="a21998552_232883"><a class="email " href="/user_profile?user_id=232883" > <span class="fna">Kohei Yoshino</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a21998552_232883"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a21998552_232883">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#a21998552_232883">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-03 05:45 PDT" data-time="1435927512">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Keywords: <a href="/buglist.cgi?keywords=dev-doc-needed&amp;resolution=---">dev-doc-needed</a></div></div></div><div class="change-set" id="c37"><div class="comment" data-id="10463216" data-no="37"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-37" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_446518" id="a21998552_232883"><img src="https://secure.gravatar.com/avatar/337fa9c543a4f881977b6d2fbbd2dea8?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_446518" id="a21998552_232883"><a class="email " href="/user_profile?user_id=446518" > <span class="fna">Sebastian Zartner [:sebo]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-37"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-37" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#c37">Comment 37</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-07 02:03 PDT" data-time="1436259781">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-37">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-37" data-comment-id="10463216">Added a note to <a rel="nofollow" href="https://developer.mozilla.org/en-US/Firefox/Releases/40#Security">https://developer.mozilla.org/en-US/Firefox/Releases/40#Security</a> and added the related schemes to <a rel="nofollow" href="https://developer.mozilla.org/en-US/docs/Web/Security/CSP/CSP_policy_directives">https://developer.mozilla.org/en-US/docs/Web/Security/CSP/CSP_policy_directives</a>.

Let me know if there's anything else to add.

Sebastian</pre><div class="activity"><div class="change">Keywords: <a href="/buglist.cgi?keywords=dev-doc-needed&amp;resolution=---">dev-doc-needed</a> &rarr; <a href="/buglist.cgi?keywords=dev-doc-complete&amp;resolution=---">dev-doc-complete</a></div></div></div><div class="change-set" id="a22397913_20209"><div class="change" id="aa22397913_20209">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_20209" id="a22397913_20209"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_20209" id="a22397913_20209"><a class="email " href="/user_profile?user_id=20209" > <span class="fna">Boris Zbarsky [:bzbarsky]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a22397913_20209"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a22397913_20209">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#a22397913_20209">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-07 20:41 PDT" data-time="1436326873">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Image onload doesn't run if src attribute is data: on a facebook page due to a CSP that forbids data: loads"
   href="/show_bug.cgi?id=1181379">1181379</a></div></div></div><div class="change-set" id="a22874451_363267"><div class="change" id="aa22874451_363267">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a22874451_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_363267" id="a22874451_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a22874451_363267"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a22874451_363267">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#a22874451_363267">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-13 09:03 PDT" data-time="1436803411">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Rendering issues in logo, spinner on Voluum"
   href="/show_bug.cgi?id=1182476">1182476</a></div></div></div><div class="change-set" id="a23645658_468907"><div class="change" id="aa23645658_468907">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_468907" id="a23645658_468907"><img src="https://secure.gravatar.com/avatar/756fb1e50f81748b5aa628e4fc9bf85a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_468907" id="a23645658_468907"><a class="email " href="/user_profile?user_id=468907" > <span class="fna">Benjamin Bouvier [:bbouvier] (inactive)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a23645658_468907"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a23645658_468907">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#a23645658_468907">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-22 07:16 PDT" data-time="1437574618">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Blocks: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Fastmail won't allow to insert inline images to emails"
   href="/show_bug.cgi?id=1186412">1186412</a></div></div></div><div class="change-set" id="a23742287_363267"><div class="change" id="aa23742287_363267">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a23742287_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_363267" id="a23742287_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a23742287_363267"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a23742287_363267">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#a23742287_363267">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-23 10:07 PDT" data-time="1437671247">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">No longer blocks: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Fastmail won't allow to insert inline images to emails"
   href="/show_bug.cgi?id=1186412">1186412</a></div><div class="change">Depends on: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Fastmail won't allow to insert inline images to emails"
   href="/show_bug.cgi?id=1186412">1186412</a></div></div></div><div class="change-set" id="a24287262_280903"><div class="change" id="aa24287262_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a24287262_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a24287262_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a24287262_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a24287262_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#a24287262_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-29 17:30 PDT" data-time="1438216222">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: [adv-main40+]</div></div></div><div class="change-set" id="a24371513_280903"><div class="change" id="aa24371513_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a24371513_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a24371513_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a24371513_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a24371513_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#a24371513_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-30 16:54 PDT" data-time="1438300473">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Alias: CVE-2015-4490</div></div></div><div class="change-set" id="a25757740_232883"><div class="change" id="aa25757740_232883">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_232883" id="a25757740_232883"><img src="https://secure.gravatar.com/avatar/f84bbc6968ecda0a64ab50d1060c320e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_232883" id="a25757740_232883"><a class="email " href="/user_profile?user_id=232883" > <span class="fna">Kohei Yoshino</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a25757740_232883"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a25757740_232883">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1086999#a25757740_232883">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-15 17:58 PDT" data-time="1439686700">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED INVALID - Firefox 40 doesn't accept '*' as image source in Content-Security-Policy header"
   href="/show_bug.cgi?id=1193648">1193648</a></div></div></div><div id="new-comment-notice">
          You need to <a href="/show_bug.cgi?id=1086999&amp;GoAheadAndLogIn=1">log in</a>
          before you can comment on or make changes to this bug.
        </div>



<div id="bottom-actions">
  <div id="bottom-right-actions">
    <button type="button" id="top-btn" class="secondary" aria-label="Go to Page Top">Top &uarr;</button>
  </div>
</div></div> 
</main> 
</div> 


</body>
</html>