
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>
Issue 39503: [security][CVE-2020-8492] Denial of service in urllib.request.AbstractBasicAuthHandler - Python tracker

</title>
<link rel="shortcut icon" href="@@file/favicon.ico" />
<link rel="stylesheet" type="text/css" href="@@file/main.css" />
<link rel="stylesheet" type="text/css" href="@@file/style.css" />
<link rel="search" type="application/opensearchdescription+xml" href="@@file/osd.xml" title="Python bug tracker search" />
<meta http-equiv="Content-Type"
      content="text/html; charset=utf-8" />

<script nonce="7f4f0cee175b4d76f4ebe45400f64a3b6822f149c7bf2a8984506d4a542ebbc5" type="text/javascript">
submitted = false;
function submit_once() {
    if (submitted) {
        alert("Your request is being processed.\nPlease be patient.");
        return false;
    }
    submitted = true;
    return true;
}

function help_window(helpurl, width, height) {
    HelpWin = window.open('https://bugs.python.org/' + helpurl, 'RoundupHelpWindow', 'scrollbars=yes,resizable=yes,toolbar=no,height='+height+',width='+width);
    HelpWin.focus ()
}
</script>


<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.15/jquery-ui.js"></script>
<script type="text/javascript" src="@@file/issue.item.js"></script>
<link rel="stylesheet" type="text/css" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/smoothness/jquery-ui.css" />


</head>
<body>
  <!--  Logo  -->
  <h1 id="logoheader">
    <a accesskey="1" href="." id="logolink">
       <img src="@@file/python-logo.gif" alt="homepage" border="0" id="logo" /></a>
  </h1>

<div id="utility-menu">
<!-- Search Box -->
<div id="searchbox">
    <form name="searchform" method="get" action="issue" id="searchform">
      <div id="search">
       <input type="hidden" name="@columns"
              value="id,activity,title,creator,assignee,status,type" />
       <input type="hidden" name="@sort" value="-activity" />
       <input type="hidden" name="@filter" value="status" />
       <input type="hidden" name="@action" value="searchid" />
       <input type="hidden" name="ignore" value="file:content" />
       <input class="input-text" id="search-text"
              name="@search_text" size="10" />
       <input type="submit" id="submit" value="search" name="submit" class="input-button" />
       <input type="radio" name="status"
              id="status_notresolved" value="-1,1,3" />
       <label for="status_notresolved">open</label>
       <input type="radio" name="status" checked="checked"
              id="status_all" value="-1,1,2,3" />
       <label for="status_all">all</label>
      </div>
     </form>
</div>
</div>


<div id="left-hand-navigation">
<!--  Main Menu NEED LEVEL TWO HEADER AND FOOTER -->
<div id="menu">
  <ul class="level-one">
    <li><a href="https://www.python.org/" title="Go to the Python homepage">Python Home</a></li>
    <li><a href="https://www.python.org/about/" title="About The Python Language">About</a></li>
    <li><a href="https://www.python.org/blogs/" title="">News</a></li>
    <li><a href="https://www.python.org/doc/" title="">Documentation</a></li>
    <li><a href="https://www.python.org/downloads/" title="">Downloads</a></li>
    <li><a href="https://www.python.org/community/" title="">Community</a></li>
    <li><a href="https://www.python.org/psf/" title="Python Software Foundation">Foundation</a></li>
    <li><a href="https://devguide.python.org/" title="Python Developer's Guide">Developer's Guide</a></li>
    <li class="selected"><a href="." class="selected" title="Python Issue Tracker">Issue Tracker</a>
      <ul class="level-two">
        <li>
          <strong>Issues</strong>
          <ul class="level-three">
            
            <li><a href="issue?@template=search&amp;status=1">Search</a></li>
            <li><a href="issue?@action=random">Random Issue</a></li>
            <li>
              <form method="post" action="issue39503">
                <input type="submit" class="form-small"
                       value="Show issue:" />
                <input class="form-small" size="4" type="text" name="@number" />
                <input type="hidden" name="@type" value="issue" />
                <input type="hidden" name="@action" value="show" />
              </form>
            </li>
          </ul>
        </li>


        <li>
          <strong>Summaries</strong>
          <ul class="level-three">
            

            

            

            <li>
              <a href="issue?status=1&amp;@sort=-activity&amp;@columns=id%2Cactivity%2Ctitle%2Ccreator%2Cstatus&amp;@dispname=Issues%20with%20patch&amp;@startwith=0&amp;@group=priority&amp;keywords=2&amp;@action=search&amp;@filter=&amp;@pagesize=50">Issues with patch</a>
            </li>

            <li>
              <a href="issue?status=1&amp;@sort=-activity&amp;@columns=id%2Cactivity%2Ctitle%2Ccreator%2Cstatus&amp;@dispname=Easy%20issues&amp;@startwith=0&amp;@group=priority&amp;keywords=6&amp;@action=search&amp;@filter=&amp;@pagesize=50">Easy issues</a>
            </li>

            <li>
              <a href="issue?@template=stats">Stats</a>
            </li>

          </ul>
        </li>


        <li>
          <strong>User</strong>
          <form method="post" action="issue39503">
          <ul class="level-three">
            <li>
                Login&nbsp;(OpenID&nbsp;possible)<br />
	         <a style="display:inline;width:0;margin:0"
             href="issue39503?@action=oic_login&amp;provider=Google">
                  <img hspace="0" vspace="0" width="16"
                       height="16"
                       src="https://www.google.com/favicon.ico"
                       alt="Google" title="Google" /></a>
	         <a style="display:inline;width:0;margin:0"
             href="issue39503?@action=oic_login&amp;provider=GitHub">
                  <img hspace="0" vspace="0" width="16"
                       height="16"
                       src="https://www.github.com/favicon.ico"
                       alt="GitHub" title="GitHub" /></a>
	         <a style="display:inline;width:0;margin:0"
             href="issue39503?@action=openid_login&amp;provider=Launchpad">
                  <img hspace="0" vspace="0" width="16"
                       height="16"
                       src="https://launchpad.net/favicon.ico"
                       alt="Launchpad" title="Launchpad" /></a>
                <input size="10" name="openid_identifier" style="background:url(@@file/openid-16x16.gif)
                  center left no-repeat;padding-left:16px" /><br />
                <input size="10" type="password" name="__login_password" /><br />
                <input type="hidden" name="@action" value="Login" />
                <input type="checkbox" name="remember" id="remember" />
                <label for="remember">Remember me?</label><br />
                <input class="form-small" type="submit"
                       value="Login" /><br />
                <input type="hidden" name="__came_from"
                       value="https://bugs.python.org/issue39503?">
                
                <input type="hidden" name="@sort" value=""/>
<input type="hidden" name="@group" value=""/>
<input type="hidden" name="@pagesize" value="50"/>
<input type="hidden" name="@startwith" value="0"/>
            </li>
            <li>
                <a href="user?@template=register">Register</a>
            </li>
            <li><a href="user?@template=forgotten">Lost&nbsp;your&nbsp;login?</a></li>
          </ul>
          </form>
        </li>

        

        

        <li>
          <strong>Administration</strong>
          <ul class="level-three">
            
            <li>
                <a href="user?@sort=username">User List</a></li>
            <li>
                <a href="user?iscommitter=1&amp;@action=search&amp;@sort=username&amp;@pagesize=300">Committer List</a></li>
            
            
            
          </ul>
        </li>

        <li>
          <strong>Help</strong>
          <ul class="level-three">
            <li><a href="http://docs.python.org/devguide/triaging.html">
                Tracker Documentation</a></li>
            <li><a href="http://wiki.python.org/moin/TrackerDevelopment">
                Tracker Development</a></li>
            <li><a href="https://github.com/python/psf-infra-meta/issues">
                Report Tracker Problem</a></li>
          </ul>
        </li>

      </ul>
    </li>
  </ul>
</div> <!-- menu -->
</div> <!-- left-hand-navigation -->

<div id="content-body">
<div id="body-main">
<div id="content">
<div id="breadcrumb">
 
 
 Issue39503
 
</div>
 
 





<div>

<form method="post" name="itemSynopsis"
      onsubmit="return submit_once()"
      enctype="multipart/form-data" action="issue39503">

<fieldset><legend>classification</legend>
<table class="form">
<tr>
 <th class="required"><a href="http://docs.python.org/devguide/triaging.html#title" target="_blank">Title</a>:</th>
 
 <td colspan="3">
  <span>[security][CVE-2020-8492] Denial of service in urllib.request.AbstractBasicAuthHandler</span>
  <input type="hidden" name="title"
         value="[security][CVE-2020-8492] Denial of service in urllib.request.AbstractBasicAuthHandler">
 </td>
</tr>

<tr>
 <th class="required"><a href="http://docs.python.org/devguide/triaging.html#type" target="_blank">Type</a>:</th>
 <td>security</td>
 <th><a href="http://docs.python.org/devguide/triaging.html#stage" target="_blank">Stage</a>:</th>
 <td>resolved</td>
</tr>

<tr>
 <th><a href="http://docs.python.org/devguide/triaging.html#components" target="_blank">Components</a>:</th>
 <td>Library (Lib)</td>
 <th><a href="http://docs.python.org/devguide/triaging.html#versions" target="_blank">Versions</a>:</th>
 <td>Python 3.11, Python 3.10, Python 3.9, Python 3.8, Python 3.7</td>
</tr>
</table>
</fieldset>

<fieldset><legend>process</legend>
<table class="form">
<tr>
  <th><a href="http://docs.python.org/devguide/triaging.html#status" target="_blank">Status</a>:</th>
  <td>closed</td>
  <th><a href="http://docs.python.org/devguide/triaging.html#resolution" target="_blank">Resolution</a>:</th>
  <td>fixed</td>
</tr>

<tr>
 <th>
    <a href="http://docs.python.org/devguide/triaging.html#dependencies"
       target="_blank">Dependencies</a>:
 </th>
 <td>
  
  
 </td>
 <th><a href="http://docs.python.org/devguide/triaging.html#superseder" target="_blank">Superseder</a>:</th>
 <td>
  
 
 </td>
 </tr>
 <tr>
 <th>
   <a href="http://docs.python.org/devguide/triaging.html#assigned-to"
      target="_blank">Assigned To</a>:
 </th>
 
 <td>
  
 </td>
 <th>
   <a href="http://docs.python.org/devguide/triaging.html#nosy-list"
      target="_blank">Nosy List</a><!--
        <span tal:condition="context/nosy_count" tal:replace="python: ' (%d)' % context.nosy_count" /> -->:
 </th>
 <td>
     Anselmo Melo, bc, koobs, larry, mgorny, miss-islington, ned.deily, sxt1001, tapakund, vstinner, ware
     
 </td>
</tr>
<tr>
 <th>
   <a href="http://docs.python.org/devguide/triaging.html#priority"
      target="_blank">Priority</a>:
 </th>
 <td>normal</td>
 <th>
    <a href="http://docs.python.org/devguide/triaging.html#keywords"
       target="_blank">Keywords</a>:
 </th>
 <td>patch</td>


</tr>









</table>
</fieldset>

</form>

<p>Created on <strong>2020-01-30 15:11</strong> by <strong>vstinner</strong>, last changed <strong>2021-09-14 10:39</strong> by <strong>vstinner</strong>. This issue is now <strong style="color:#00F; background-color:inherit;">closed</strong>.</p>

<table class="files">
 <tr><th colspan="5" class="header">Files</th></tr>
 <tr>
  <th>File name</th>
  <th>Uploaded</th>
  <th>Description</th>
  <th>Edit</th>
 </tr>
 <tr>
  <td>
   <a href="file49016/bench_parser.py">bench_parser.py</a>
  </td>
  <td>
   <span>vstinner</span>,
   <span>2020-03-30 17:21</span>
  </td>
  <td></td>
  <td>
      
      
      
  </td>
 </tr>
 <tr>
  <td>
   <a href="file49023/bench_parser2.py">bench_parser2.py</a>
  </td>
  <td>
   <span>bc</span>,
   <span>2020-04-02 00:46</span>
  </td>
  <td>Benchmark</td>
  <td>
      
      
      
  </td>
 </tr>
</table>

<table class="files">
 <tr><th class="header" colspan="4">Pull Requests</th></tr>
 <tr>
  <th>URL</th>
  <th>Status</th>
  <th>Linked</th>
  <th>Edit</th>
 </tr>
 <tr>
  <td><a href="https://github.com/python/cpython/pull/18284" title="bpo-39503: CVE-2020-8492: Fix AbstractBasicAuthHandler">PR 18284</a></td>
  <td>merged</td>
  <td>
   <span>vstinner</span>,
   <span>2020-01-30 15:20</span>
  </td>
  <td>
    
  </td>
 </tr>
 <tr>
  <td><a href="https://github.com/python/cpython/pull/19291" title="[3.8] bpo-39503: CVE-2020-8492: Fix AbstractBasicAuthHandler (GH-18284)">PR 19291</a></td>
  <td>closed</td>
  <td>
   <span>miss-islington</span>,
   <span>2020-04-02 00:52</span>
  </td>
  <td>
    
  </td>
 </tr>
 <tr>
  <td><a href="https://github.com/python/cpython/pull/19292" title="[3.7] bpo-39503: CVE-2020-8492: Fix AbstractBasicAuthHandler (GH-18284)">PR 19292</a></td>
  <td>closed</td>
  <td>
   <span>miss-islington</span>,
   <span>2020-04-02 00:52</span>
  </td>
  <td>
    
  </td>
 </tr>
 <tr>
  <td><a href="https://github.com/python/cpython/pull/19296" title="[3.8] bpo-39503: CVE-2020-8492: Fix AbstractBasicAuthHandler (GH-18284)">PR 19296</a></td>
  <td>merged</td>
  <td>
   <span>miss-islington</span>,
   <span>2020-04-02 01:39</span>
  </td>
  <td>
    
  </td>
 </tr>
 <tr>
  <td><a href="https://github.com/python/cpython/pull/19297" title="[3.7] bpo-39503: CVE-2020-8492: Fix AbstractBasicAuthHandler (GH-18284)">PR 19297</a></td>
  <td>merged</td>
  <td>
   <span>miss-islington</span>,
   <span>2020-04-02 01:39</span>
  </td>
  <td>
    
  </td>
 </tr>
 <tr>
  <td><a href="https://github.com/python/cpython/pull/19299" title="[3.6] bpo-39503: CVE-2020-8492: Fix AbstractBasicAuthHandler">PR 19299</a></td>
  <td>closed</td>
  <td>
   <span>tapakund</span>,
   <span>2020-04-02 07:09</span>
  </td>
  <td>
    
  </td>
 </tr>
 <tr>
  <td><a href="https://github.com/python/cpython/pull/19301" title="[3.5] bpo-39503: CVE-2020-8492: Fix AbstractBasicAuthHandler">PR 19301</a></td>
  <td>closed</td>
  <td>
   <span>tapakund</span>,
   <span>2020-04-02 09:13</span>
  </td>
  <td>
    
  </td>
 </tr>
 <tr>
  <td><a href="https://github.com/python/cpython/pull/19302" title="[2.7] bpo-39503: CVE-2020-8492: Fix AbstractBasicAuthHandler">PR 19302</a></td>
  <td>closed</td>
  <td>
   <span>tapakund</span>,
   <span>2020-04-02 10:27</span>
  </td>
  <td>
    
  </td>
 </tr>
 <tr>
  <td><a href="https://github.com/python/cpython/pull/19304" title="[3.6] bpo-39503: CVE-2020-8492: Fix AbstractBasicAuthHandler (GH-18284)">PR 19304</a></td>
  <td>merged</td>
  <td>
   <span>vstinner</span>,
   <span>2020-04-02 11:59</span>
  </td>
  <td>
    
  </td>
 </tr>
 <tr>
  <td><a href="https://github.com/python/cpython/pull/19305" title="[3.5] bpo-39503: CVE-2020-8492: Fix AbstractBasicAuthHandler (GH-18284)">PR 19305</a></td>
  <td>merged</td>
  <td>
   <span>vstinner</span>,
   <span>2020-04-02 12:05</span>
  </td>
  <td>
    
  </td>
 </tr>
</table>





<table class="messages">
 <tr><th colspan="4" class="header">Messages (17)</th></tr>
 
  <tr>
    <th>
     <a href="#msg361072" id="msg361072">msg361072</a> - <a
    href="msg361072">(view)</a></th>
   <th>Author: STINNER Victor (vstinner) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2020-01-30 15:11</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>Copy of an email received on the Python Security Response team, 9 days ago. I consider that it's not worth it to have an embargo on this vulnerability, so I make it public.

Hi there,

I believe I've found a denial-of-service (DoS) bug in
urllib.request.AbstractBasicAuthHandler. To start, I'm operating on some
background information from this document: HTTP authentication
&lt;<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Authentication">https://developer.mozilla.org/en-US/docs/Web/HTTP/Authentication</a>&gt;. The bug
itself is a ReDoS &lt;<a href="https://www.regular-expressions.info/redos.html">https://www.regular-expressions.info/redos.html</a>&gt; bug
causing catastrophic backtracking. To reproduce the issue we can use the
following code:

from urllib.request import AbstractBasicAuthHandler
auth_handler = AbstractBasicAuthHandler()
auth_handler.http_error_auth_reqed(
    'www-authenticate',
    'unused',
    'unused',
    {
        'www-authenticate': 'Basic ' + ',' * 64 + ' ' + 'foo' + ' ' +
'realm'
    }
)

The issue itself is in the following regular expression:

rx = re.compile('(?:.*,)*[ \t]*([^ \t]+)[ \t]+'
                'realm=(["\']?)([^"\']*)\\2', re.I)

In particular, the (?:.*,)* portion. Since "." and "," overlap and there
are nested quantifiers we can cause catastrophic backtracking by repeating
a comma. Note that since AbstractBasicAuthHandler is vulnerable, then both
HTTPBasicAuthHandler and ProxyBasicAuthHandler are as well because they
call http_error_auth_reqed. Building from the HTTP authentication document
above, this means a server can send a specially crafted header along with
an HTTP 401 or HTTP 407 and cause a DoS on the client.

I won't speculate on the severity of the issue too much - you will surely
understand the impact better than I will. Although, the fact that this is
client-side as opposed to server-side appears to reduce the severity,
however the fact that it's a security-sensitive context (HTTP
authentication) may raise the severity.

One possible fix would be changing the rx expression to the following:

rx = re.compile('(?:[^,]*,)*[ \t]*([^ \t]+)[ \t]+'
                'realm=(["\']?)([^"\']*)\\2', re.I)

This removes the character overlap in the nested quantifier and thus
negates the catastrophic backtracking.

Let me know if you have any questions or what the next steps are from here.
Thanks for supporting Python security!

-- 
Matt Schwager</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg361073" id="msg361073">msg361073</a> - <a
    href="msg361073">(view)</a></th>
   <th>Author: STINNER Victor (vstinner) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2020-01-30 15:30</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>I added this vulnerability to the following page to track fixes in all Python supported branches:
<a href="https://python-security.readthedocs.io/vuln/urllib-basic-auth-regex.html">https://python-security.readthedocs.io/vuln/urllib-basic-auth-regex.html</a></pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg361081" id="msg361081">msg361081</a> - <a
    href="msg361081">(view)</a></th>
   <th>Author: STINNER Victor (vstinner) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2020-01-30 22:33</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>CVE-2020-8492 has been assigned to this vulnerability:
<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=2020-8492">https://cve.mitre.org/cgi-bin/cvename.cgi?name=2020-8492</a></pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg361343" id="msg361343">msg361343</a> - <a
    href="msg361343">(view)</a></th>
   <th>Author: Ben Caller (bc) <span title="Contributor form received">*</span></th>
   <th>Date: 2020-02-04 10:53</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>Isn't this a duplicate of <a class="closed" title="[closed] Regular Expression Denial of Service in urllib.request.AbstractBasicAuthHandler" href="issue38826">bpo-38826</a> ?</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg364996" id="msg364996">msg364996</a> - <a
    href="msg364996">(view)</a></th>
   <th>Author: STINNER Victor (vstinner) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2020-03-25 16:19</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>&gt; Isn't this a duplicate of <a class="closed" title="[closed] Regular Expression Denial of Service in urllib.request.AbstractBasicAuthHandler" href="issue38826">bpo-38826</a> ?

Oh right. I marked it as a duplicate of this issue.</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg365335" id="msg365335">msg365335</a> - <a
    href="msg365335">(view)</a></th>
   <th>Author: STINNER Victor (vstinner) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2020-03-30 17:21</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>bench_parser.py: Benchmark for AbstractBasicAuthHandler.http_error_auth_reqed().</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg365538" id="msg365538">msg365538</a> - <a
    href="msg365538">(view)</a></th>
   <th>Author: Ben Caller (bc) <span title="Contributor form received">*</span></th>
   <th>Date: 2020-04-02 00:24</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>Instead of

repeat_10_3 = 'Basic ' + ', ' * (10 ** 3) + simple

in the benchmark, try

repeat_10_3 = 'Basic ' + ', ' * (10 ** 3) + 'A'</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg365541" id="msg365541">msg365541</a> - <a
    href="msg365541">(view)</a></th>
   <th>Author: STINNER Victor (vstinner) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2020-04-02 00:44</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>Ooooh, I see. I didn't measure the performance of the right header. I re-run a benchmark using the HTTP header (repeat=15):

    header = 'Basic ' + ', ' * 15 + 'A'

Now I see a major performance difference. Comparison between master ("ref") and <a href="https://github.com/python/cpython/pull/18284" class="closed" title="GitHub PR 18284: [merged] bpo-39503: CVE-2020-8492: Fix AbstractBasicAuthHandler">PR 18284</a> ("fix"):

Mean +- std dev: [ref] 88.9 ms +- 2.4 ms -&gt; [fix] 17.5 us +- 0.7 us: 5083.23x faster (-100%)

So the worst case is now way faster: more than 5000x faster!

It's even possible to go up to repeat=10**6 characters, it still takes less than 1 seconds: 412 ms +- 19 ms.

On the master branch, repeat=20 already takes around 3 seconds... The slowdown is exponential with repeat increase.</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg365542" id="msg365542">msg365542</a> - <a
    href="msg365542">(view)</a></th>
   <th>Author: STINNER Victor (vstinner) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2020-04-02 00:52</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>
New changeset <a href="https://hg.python.org/lookup/0b297d4ff1c0e4480ad33acae793fbaf4bf015b4">0b297d4ff1c0e4480ad33acae793fbaf4bf015b4</a> by Victor Stinner in branch 'master':
<a class="closed" title="[closed] [security][CVE-2020-8492] Denial of service in urllib.request.AbstractBasicAuthHandler" href="issue39503">bpo-39503</a>: CVE-2020-8492: Fix AbstractBasicAuthHandler (<a href="https://github.com/python/cpython/pull/18284" class="closed" title="GitHub PR 18284: [merged] bpo-39503: CVE-2020-8492: Fix AbstractBasicAuthHandler">GH-18284</a>)
<a href="https://github.com/python/cpython/commit/0b297d4ff1c0e4480ad33acae793fbaf4bf015b4">https://github.com/python/cpython/commit/0b297d4ff1c0e4480ad33acae793fbaf4bf015b4</a>
</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg365578" id="msg365578">msg365578</a> - <a
    href="msg365578">(view)</a></th>
   <th>Author: STINNER Victor (vstinner) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2020-04-02 10:15</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>
New changeset <a href="https://hg.python.org/lookup/ea9e240aa02372440be8024acb110371f69c9d41">ea9e240aa02372440be8024acb110371f69c9d41</a> by Miss Islington (bot) in branch '3.8':
<a class="closed" title="[closed] [security][CVE-2020-8492] Denial of service in urllib.request.AbstractBasicAuthHandler" href="issue39503">bpo-39503</a>: CVE-2020-8492: Fix AbstractBasicAuthHandler (<a href="https://github.com/python/cpython/pull/18284" class="closed" title="GitHub PR 18284: [merged] bpo-39503: CVE-2020-8492: Fix AbstractBasicAuthHandler">GH-18284</a>) (<a href="https://github.com/python/cpython/pull/19296" class="closed" title="GitHub PR 19296: [merged] [3.8] bpo-39503: CVE-2020-8492: Fix AbstractBasicAuthHandler (GH-18284)">GH-19296</a>)
<a href="https://github.com/python/cpython/commit/ea9e240aa02372440be8024acb110371f69c9d41">https://github.com/python/cpython/commit/ea9e240aa02372440be8024acb110371f69c9d41</a>
</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg365579" id="msg365579">msg365579</a> - <a
    href="msg365579">(view)</a></th>
   <th>Author: STINNER Victor (vstinner) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2020-04-02 10:16</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>
New changeset <a href="https://hg.python.org/lookup/b57a73694e26e8b2391731b5ee0b1be59437388e">b57a73694e26e8b2391731b5ee0b1be59437388e</a> by Miss Islington (bot) in branch '3.7':
<a class="closed" title="[closed] [security][CVE-2020-8492] Denial of service in urllib.request.AbstractBasicAuthHandler" href="issue39503">bpo-39503</a>: CVE-2020-8492: Fix AbstractBasicAuthHandler (<a href="https://github.com/python/cpython/pull/18284" class="closed" title="GitHub PR 18284: [merged] bpo-39503: CVE-2020-8492: Fix AbstractBasicAuthHandler">GH-18284</a>) (<a href="https://github.com/python/cpython/pull/19297" class="closed" title="GitHub PR 19297: [merged] [3.7] bpo-39503: CVE-2020-8492: Fix AbstractBasicAuthHandler (GH-18284)">GH-19297</a>)
<a href="https://github.com/python/cpython/commit/b57a73694e26e8b2391731b5ee0b1be59437388e">https://github.com/python/cpython/commit/b57a73694e26e8b2391731b5ee0b1be59437388e</a>
</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg365663" id="msg365663">msg365663</a> - <a
    href="msg365663">(view)</a></th>
   <th>Author: Ned Deily (ned.deily) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2020-04-03 01:16</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>
New changeset <a href="https://hg.python.org/lookup/69cdeeb93e0830004a495ed854022425b93b3f3e">69cdeeb93e0830004a495ed854022425b93b3f3e</a> by Victor Stinner in branch '3.6':
<a class="closed" title="[closed] [security][CVE-2020-8492] Denial of service in urllib.request.AbstractBasicAuthHandler" href="issue39503">bpo-39503</a>: CVE-2020-8492: Fix AbstractBasicAuthHandler (<a href="https://github.com/python/cpython/pull/18284" class="closed" title="GitHub PR 18284: [merged] bpo-39503: CVE-2020-8492: Fix AbstractBasicAuthHandler">GH-18284</a>) (<a href="https://github.com/python/cpython/pull/19304" class="closed" title="GitHub PR 19304: [merged] [3.6] bpo-39503: CVE-2020-8492: Fix AbstractBasicAuthHandler (GH-18284)">GH-19304</a>)
<a href="https://github.com/python/cpython/commit/69cdeeb93e0830004a495ed854022425b93b3f3e">https://github.com/python/cpython/commit/69cdeeb93e0830004a495ed854022425b93b3f3e</a>
</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg371921" id="msg371921">msg371921</a> - <a
    href="msg371921">(view)</a></th>
   <th>Author: Larry Hastings (larry) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2020-06-20 06:27</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>
New changeset <a href="https://hg.python.org/lookup/37fe316479e0b6906a74b0c0a5e495c55037fdfd">37fe316479e0b6906a74b0c0a5e495c55037fdfd</a> by Victor Stinner in branch '3.5':
<a class="closed" title="[closed] [security][CVE-2020-8492] Denial of service in urllib.request.AbstractBasicAuthHandler" href="issue39503">bpo-39503</a>: CVE-2020-8492: Fix AbstractBasicAuthHandler (<a href="https://github.com/python/cpython/pull/18284" class="closed" title="GitHub PR 18284: [merged] bpo-39503: CVE-2020-8492: Fix AbstractBasicAuthHandler">GH-18284</a>) (<a class="closed" title="[closed] sporadic test_asyncio failure under FreeBSD" href="issue19305">#19305</a>)
<a href="https://github.com/python/cpython/commit/37fe316479e0b6906a74b0c0a5e495c55037fdfd">https://github.com/python/cpython/commit/37fe316479e0b6906a74b0c0a5e495c55037fdfd</a>
</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg401762" id="msg401762">msg401762</a> - <a
    href="msg401762">(view)</a></th>
   <th>Author: tongxiaoge (sxt1001)</th>
   <th>Date: 2021-09-14 06:57</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre><a href="https://github.com/python/cpython/blob/9f93018b69d72cb48d3444554261ae3b0ea00c93/Lib/urllib/request.py#L989">https://github.com/python/cpython/blob/9f93018b69d72cb48d3444554261ae3b0ea00c93/Lib/urllib/request.py#L989</a>
"headers" is a dict object? If so, the dict object does not seem to have no attribute "get_all".</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg401766" id="msg401766">msg401766</a> - <a
    href="msg401766">(view)</a></th>
   <th>Author: STINNER Victor (vstinner) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2021-09-14 10:23</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>&gt; "headers" is a dict object? If so, the dict object does not seem to have no attribute "get_all".

No, it's not a dict object.</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg401768" id="msg401768">msg401768</a> - <a
    href="msg401768">(view)</a></th>
   <th>Author: tongxiaoge (sxt1001)</th>
   <th>Date: 2021-09-14 10:33</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>At the beginning of the issue, there is the following reproduction code:
from urllib.request import AbstractBasicAuthHandler
auth_handler = AbstractBasicAuthHandler()
auth_handler.http_error_auth_reqed(
    'www-authenticate',
    'unused',
    'unused',
    {
        'www-authenticate': 'Basic ' + ',' * 64 + ' ' + 'foo' + ' ' +
'realm'
    }
)

Here's the headers:

{
        'www-authenticate': 'Basic ' + ',' * 64 + ' ' + 'foo' + ' ' +
'realm'
 }

I think this is a dict object, so the current problem is fixed and no longer compatible with the previous usage?</pre>
   </td>
  </tr>
 
 
  <tr>
    <th>
     <a href="#msg401770" id="msg401770">msg401770</a> - <a
    href="msg401770">(view)</a></th>
   <th>Author: STINNER Victor (vstinner) <span title="Contributor form received">*</span> <img src="@@file/committer.png" title="Python committer" alt="(Python committer)" /></th>
   <th>Date: 2021-09-14 10:39</th>
  </tr>
  <tr>
   <td colspan="4" class="content">
    
    <pre>This issue was a security vulnerability. It's now closed, please don't comment closed issues. If you consider that there is a regression, please open a new issue.</pre>
   </td>
  </tr>
 
</table>

<table class="history table table-condensed table-striped"><tr><th colspan="4" class="header">
History
</th></tr><tr>
<th>Date</th>
<th>User</th>
<th>Action</th>
<th>Args</th>
</tr>
<tr><td>2021-09-14&nbsp;10:39:30</td><td>vstinner</td><td>set</td><td>messages:
  + <a rel="nofollow" href="msg401770">msg401770</a></td></tr>
<tr><td>2021-09-14&nbsp;10:33:05</td><td>sxt1001</td><td>set</td><td>messages:
  + <a rel="nofollow" href="msg401768">msg401768</a></td></tr>
<tr><td>2021-09-14&nbsp;10:23:50</td><td>vstinner</td><td>set</td><td>messages:
  + <a rel="nofollow" href="msg401766">msg401766</a></td></tr>
<tr><td>2021-09-14&nbsp;06:57:28</td><td>sxt1001</td><td>set</td><td>nosy:
  + <a rel="nofollow" href="user39530">sxt1001</a><br /><br />messages:
  + <a rel="nofollow" href="msg401762">msg401762</a><br />versions:
  + Python 3.10, Python 3.11, - Python 3.5, Python 3.6</td></tr>
<tr><td>2020-06-20&nbsp;08:33:12</td><td>larry</td><td>set</td><td>status: open -> closed<br />resolution: fixed<br />stage: patch review -> resolved</td></tr>
<tr><td>2020-06-20&nbsp;08:30:06</td><td>koobs</td><td>set</td><td>nosy:
  + <a rel="nofollow" href="user16276">koobs</a><br /></td></tr>
<tr><td>2020-06-20&nbsp;06:27:09</td><td>larry</td><td>set</td><td>nosy:
  + <a rel="nofollow" href="user2731">larry</a><br />messages:
  + <a rel="nofollow" href="msg371921">msg371921</a><br /></td></tr>
<tr><td>2020-04-03&nbsp;01:16:03</td><td>ned.deily</td><td>set</td><td>nosy:
  + <a rel="nofollow" href="user5248">ned.deily</a><br />messages:
  + <a rel="nofollow" href="msg365663">msg365663</a><br /></td></tr>
<tr><td>2020-04-02&nbsp;12:05:26</td><td>vstinner</td><td>set</td><td>pull_requests:
  + <a rel="nofollow" href="pull_request18667">pull_request18667</a></td></tr>
<tr><td>2020-04-02&nbsp;11:59:15</td><td>vstinner</td><td>set</td><td>pull_requests:
  + <a rel="nofollow" href="pull_request18666">pull_request18666</a></td></tr>
<tr><td>2020-04-02&nbsp;11:43:04</td><td>vstinner</td><td>set</td><td>versions:
  - Python 2.7</td></tr>
<tr><td>2020-04-02&nbsp;10:27:09</td><td>tapakund</td><td>set</td><td>pull_requests:
  + <a rel="nofollow" href="pull_request18664">pull_request18664</a></td></tr>
<tr><td>2020-04-02&nbsp;10:16:20</td><td>vstinner</td><td>set</td><td>messages:
  + <a rel="nofollow" href="msg365579">msg365579</a></td></tr>
<tr><td>2020-04-02&nbsp;10:15:59</td><td>vstinner</td><td>set</td><td>messages:
  + <a rel="nofollow" href="msg365578">msg365578</a></td></tr>
<tr><td>2020-04-02&nbsp;09:13:52</td><td>tapakund</td><td>set</td><td>pull_requests:
  + <a rel="nofollow" href="pull_request18663">pull_request18663</a></td></tr>
<tr><td>2020-04-02&nbsp;07:09:03</td><td>tapakund</td><td>set</td><td>nosy:
  + <a rel="nofollow" href="user31632">tapakund</a><br />pull_requests:
  + <a rel="nofollow" href="pull_request18661">pull_request18661</a><br /></td></tr>
<tr><td>2020-04-02&nbsp;01:39:24</td><td>miss-islington</td><td>set</td><td>pull_requests:
  + <a rel="nofollow" href="pull_request18656">pull_request18656</a></td></tr>
<tr><td>2020-04-02&nbsp;01:39:16</td><td>miss-islington</td><td>set</td><td>pull_requests:
  + <a rel="nofollow" href="pull_request18655">pull_request18655</a></td></tr>
<tr><td>2020-04-02&nbsp;00:52:45</td><td>miss-islington</td><td>set</td><td>pull_requests:
  + <a rel="nofollow" href="pull_request18651">pull_request18651</a></td></tr>
<tr><td>2020-04-02&nbsp;00:52:38</td><td>miss-islington</td><td>set</td><td>nosy:
  + <a rel="nofollow" href="user27838">miss-islington</a><br />pull_requests:
  + <a rel="nofollow" href="pull_request18650">pull_request18650</a><br /></td></tr>
<tr><td>2020-04-02&nbsp;00:52:23</td><td>vstinner</td><td>set</td><td>messages:
  + <a rel="nofollow" href="msg365542">msg365542</a></td></tr>
<tr><td>2020-04-02&nbsp;00:46:16</td><td>bc</td><td>set</td><td>files:
  - <a rel="nofollow" href="file49022">bench_parser2.py</a></td></tr>
<tr><td>2020-04-02&nbsp;00:46:00</td><td>bc</td><td>set</td><td>files:
  + <a rel="nofollow" href="file49023">bench_parser2.py</a></td></tr>
<tr><td>2020-04-02&nbsp;00:44:09</td><td>vstinner</td><td>set</td><td>messages:
  + <a rel="nofollow" href="msg365541">msg365541</a></td></tr>
<tr><td>2020-04-02&nbsp;00:25:00</td><td>bc</td><td>set</td><td>files:
  + <a rel="nofollow" href="file49022">bench_parser2.py</a><br /><br />messages:
  + <a rel="nofollow" href="msg365538">msg365538</a></td></tr>
<tr><td>2020-03-30&nbsp;17:21:05</td><td>vstinner</td><td>set</td><td>files:
  + <a rel="nofollow" href="file49016">bench_parser.py</a><br /><br />messages:
  + <a rel="nofollow" href="msg365335">msg365335</a></td></tr>
<tr><td>2020-03-25&nbsp;16:19:57</td><td>vstinner</td><td>set</td><td>messages:
  + <a rel="nofollow" href="msg364996">msg364996</a></td></tr>
<tr><td>2020-03-25&nbsp;16:19:39</td><td>vstinner</td><td>link</td><td><a rel="nofollow" href="issue38826">issue38826 superseder</a></td></tr>
<tr><td>2020-03-04&nbsp;23:06:47</td><td>ware</td><td>set</td><td>nosy:
  + <a rel="nofollow" href="user31061">ware</a><br /></td></tr>
<tr><td>2020-03-02&nbsp;09:23:41</td><td>mgorny</td><td>set</td><td>nosy:
  + <a rel="nofollow" href="user13113">mgorny</a><br /></td></tr>
<tr><td>2020-02-04&nbsp;10:53:53</td><td>bc</td><td>set</td><td>nosy:
  + <a rel="nofollow" href="user32960">bc</a><br />messages:
  + <a rel="nofollow" href="msg361343">msg361343</a><br /></td></tr>
<tr><td>2020-01-31&nbsp;17:24:57</td><td>Anselmo Melo</td><td>set</td><td>nosy:
  + <a rel="nofollow" href="user32342">Anselmo Melo</a><br /></td></tr>
<tr><td>2020-01-30&nbsp;22:33:12</td><td>vstinner</td><td>set</td><td>messages:
  + <a rel="nofollow" href="msg361081">msg361081</a><br />title: [security] Denial of service in urllib.request.AbstractBasicAuthHandler -> [security][CVE-2020-8492] Denial of service in urllib.request.AbstractBasicAuthHandler</td></tr>
<tr><td>2020-01-30&nbsp;15:30:40</td><td>vstinner</td><td>set</td><td>messages:
  + <a rel="nofollow" href="msg361073">msg361073</a></td></tr>
<tr><td>2020-01-30&nbsp;15:20:34</td><td>vstinner</td><td>set</td><td>keywords:
  + <a rel="nofollow" href="keyword2">patch</a><br />stage: patch review<br />pull_requests:
  + <a rel="nofollow" href="pull_request17659">pull_request17659</a></td></tr>
<tr><td>2020-01-30&nbsp;15:11:29</td><td>vstinner</td><td>create</td><td></td></tr>
</table>

</div>


</div> <!-- content-body -->
<div id="footer">
<div id="credits">
  Hosted on <a href="https://m.do.co/c/783434964889" title="Hosted on DigitalOcean">DigitalOcean</a>,
  <br>
  Supported by <a href="https://python.org/psf-landing/" title="The Python Software Foundation">The Python Software Foundation</a>,
  <br>
  Powered by <a href="http://roundup.sourceforge.net" title="Powered by the Roundup Issue Tracker">Roundup</a>
</div> <!-- credits -->
Copyright &copy; 1990-2020, <a href="http://python.org/psf">Python Software Foundation</a><br />
<a href="http://python.org/about/legal">Legal Statements</a>
</div> <!-- footer -->
</div> <!-- body-main -->
</div> <!-- content -->



</body>
</html>

