-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

IBM SECURITY ADVISORY

First Issued: Thu May 20 16:44:30 CDT 2010
| Updated: Wed Dec  1 11:46:29 CST 2010
| Fixed upper level

The most recent version of this document is available here:

http://aix.software.ibm.com/aix/efixes/security/pcnfsd_advisory.asc

                           VULNERABILITY SUMMARY

VULNERABILITY:   AIX rpc.pcnfsd integer overflow vulnerability

PLATFORMS:       AIX 5.3, 6.1, and earlier releases
                 VIOS 1.5, 2.1, and earlier releases

SOLUTION:        Apply the fix or workaround as described below.

THREAT:          This can be exploited to cause an integer overflow via a 
                 specially crafted RPC request. Successful exploitation of 
                 this issue could allow the attacker to execute arbitrary 
                 code on an affected system. 

CERT VU Number:  N/A
CVE Number:      CVE-2010-1039

Reboot required?    NO
Workarounds?        YES
Protected by FPM?   NO
Protected by SED?   NO

                           DETAILED INFORMATION

I. DESCRIPTION (from IPS Research Center)

    "An integer overflow vulnerability was reported in the rpc.pcnfsd 
    service within the several systems. The rpc.pcnfsd daemon handles 
    requests from PC-NFS clients for authentication services on 
    remote machines. These services include authentication for 
    mounting and for print spooling. The vulnerability is triggered 
    when parsing crafted RPC requests. A remote attacker can leverage 
    this vulnerability by sending a crafted RPC message to the target 
    host, to potentially inject and execute arbitrary code."

    Please see the following for more information:

    http://www.checkpoint.com/defense/advisories/public/2010/cpai-13-May.html

II. PLATFORM VULNERABILITY ASSESSMENT

    Note: To use the following commands on VIOS you must first
    execute:

    oem_setup_env

    To determine if your system is vulnerable, execute the following
    command:

    lslpp -L bos.net.nfs.client

    The following fileset levels are vulnerable:

    AIX Fileset        Lower Level       Upper Level
    ------------------------------------------------
|   bos.net.nfs.client    5.3.9.0           5.3.9.5
|   bos.net.nfs.client    5.3.10.0          5.3.10.3
|   bos.net.nfs.client    5.3.11.0          5.3.11.3
|   bos.net.nfs.client    5.3.12.0          5.3.12.0
    bos.net.nfs.client    6.1.2.0           6.1.2.7
|   bos.net.nfs.client    6.1.3.0           6.1.3.3
    bos.net.nfs.client    6.1.4.0           6.1.4.4
|   bos.net.nfs.client    6.1.5.0           6.1.5.0

III. SOLUTION

    A. FIXES

        Fixes are now available.  The fixes can be downloaded from:

        http://aix.software.ibm.com/aix/efixes/security/pcnfsd_fix.tar

        The links above are to a tar file containing this signed
        advisory, fix packages, and PGP signatures for each package.

        AIX Level    VIOS Level       Fix
        -------------------------------------------------------------------
        5.3.9        1.5.2            IZ73874_09.100520.epkg.Z
        5.3.10                        IZ73757_10.100520.epkg.Z
        5.3.11                        IZ73681_11.100520.epkg.Z
        5.3.12                        IZ73590_12.100520.epkg.Z
        6.1.2        2.1.0            IZ75465_02.100520.epkg.Z
        6.1.3        2.1.1            IZ75440_03.100520.epkg.Z
        6.1.4        2.1.2            IZ75369_04.100520.epkg.Z
        6.1.5        2.1.3            IZ73599_05.100520.epkg.Z

        To extract the fixes from the tar file:

        tar xvf pcnfsd_fix.tar
        cd pcnfsd_fix

        Verify you have retrieved the fixes intact:

        The checksums below were generated using the "csum -h SHA1"
        (sha1sum) commands and are as follows:

        csum -h SHA1 (sha1sum)                    filename
        ------------------------------------------------------------------
        e674c6f69fe943f54a7a93f6786264344864063c  IZ73590_12.100520.epkg.Z
        620f8b39a994dd5ccd496d037c56786184a17dd4  IZ73599_05.100520.epkg.Z
        b2c42ca760d166ebe26f8865a7d04e03ddf00a5d  IZ73681_11.100520.epkg.Z
        28e874371b5fb111040acd5102a5e8dd0398bdfe  IZ73757_10.100520.epkg.Z
        9ac461a3e65b970a76bb985b30838126a9e9aaa4  IZ73874_09.100520.epkg.Z
        0d568287bc7f64fe49fbc105d6b17084dad1cbb2  IZ75369_04.100520.epkg.Z
        1caee8275ef5cda18fb271cc2f7ad7e1ce2af1c1  IZ75440_03.100520.epkg.Z
        53b6e98a1bc1d23c611f88f446c1141b7dee87fc  IZ75465_02.100520.epkg.Z

        To verify the sums, use the text of this advisory as input to
        csum or sha1sum. For example:

        csum -h SHA1 -i Advisory.asc
        sha1sum -c Advisory.asc

        These sums should match exactly. The PGP signatures in the tar
        file and on this advisory can also be used to verify the
        integrity of the fixes.  If the sums or signatures cannot be
        confirmed, contact IBM AIX Security and describe the
        discrepancy at the following address:

            security-alert@austin.ibm.com

     B. FIX INSTALLATION

        IMPORTANT: If possible, it is recommended that a mksysb backup
        of the system be created.  Verify it is both bootable and
        readable before proceeding.

        Fix management documentation can be found at:

        http://www14.software.ibm.com/webapp/set2/sas/f/aix.efixmgmt/home.html

        To preview fix installation:

        emgr -e fix_name -p         # where fix_name is the name of the  
                                    # fix being previewed.

        To install fix package:

        emgr -e fix_name -X         # where fix_name is the name of the  
                                    # fix being installed.

        IMPORTANT: The fix will not take affect until any running rpc.pcnfsd 
        servers have been stopped and restarted with the following
        commands:
 
	Stop:
	1. comment out pcnfsd entry in /etc/inetd.conf
	2. kill rpc.pcnfsd
	3. refresh inetd

	apply fix

	Start:
	1. uncomment pcnfsd entry in /etc/inetd.conf
	2. refresh inetd

    C. APARS

        IBM has assigned the following APARs to this problem:

        AIX Level           APAR number        Service pack date
        --------------------------------------------------------
        5.3.9               IZ73874            9/22/10 sp8
        5.3.10              IZ73757            9/22/10 sp5
        5.3.11              IZ73681            9/22/10 sp5
        5.3.12              IZ73590            9/22/10 sp2
        6.1.2               IZ75465            6/16/10 sp9
        6.1.3               IZ75440            6/16/10 sp6
        6.1.4               IZ75369            6/16/10 sp6
        6.1.5               IZ73599            8/25/10 sp2

        Subscribe to the APARs here:

        http://www.ibm.com/support/docview.wss?uid=isg1IZ73874
        http://www.ibm.com/support/docview.wss?uid=isg1IZ73757
        http://www.ibm.com/support/docview.wss?uid=isg1IZ73681
        http://www.ibm.com/support/docview.wss?uid=isg1IZ73590
        http://www.ibm.com/support/docview.wss?uid=isg1IZ75465
        http://www.ibm.com/support/docview.wss?uid=isg1IZ75440
        http://www.ibm.com/support/docview.wss?uid=isg1IZ75369
        http://www.ibm.com/support/docview.wss?uid=isg1IZ73599

        By subscribing, you will receive periodic email alerting you
        to the status of the APAR, and a link to download the service
        pack when it becomes available.

IV. WORKAROUND

    Don't run rpc.pcnfsd. Comment the entry for rpc.pcnfsd from 
    /etc/inetd.conf and refresh the instance of inetd. This can
    be done by running the following command.

    /usr/bin/refresh -s inetd 

VI. CONTACT INFORMATION

    If you would like to receive AIX Security Advisories via email,
    please visit:
 
        http://www.ibm.com/systems/support
 
    and click on the "My notifications" link.
 
    To view previously issued advisories, please visit:
 
        http://www14.software.ibm.com/webapp/set2/subscriptions/pqvcmjd
 
    Comments regarding the content of this announcement can be
    directed to:

        security-alert@austin.ibm.com
 
    To obtain the PGP public key that can be used to communicate
    securely with the AIX Security Team you can either:

        A. Send an email with "get key" in the subject line to:

            security-alert@austin.ibm.com

        B. Download the key from our web page:

  http://www.ibm.com/systems/resources/systems_p_os_aix_security_pgpkey.txt

        C. Download the key from a PGP Public Key Server. The key ID is:

            0x28BFAA12
 
    Please contact your local IBM AIX support center for any
    assistance.
 
    eServer is a trademark of International Business Machines
    Corporation.  IBM, AIX and pSeries are registered trademarks of
    International Business Machines Corporation.  All other trademarks
    are property of their respective holders.

VII. ACKNOWLEDGMENTS

    This vulnerability was discovered and exploited by Rodrigo Rubira Branco.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.7 (AIX)

iD8DBQFM9qQc4fmd+Ci/qhIRAhXRAJwJt7ToP8VJ0LHYGPziU1u7KfPhcACZAXZb
tdNd/uUirDjhWUJJnLOY8TE=
=ylcT
-----END PGP SIGNATURE-----
