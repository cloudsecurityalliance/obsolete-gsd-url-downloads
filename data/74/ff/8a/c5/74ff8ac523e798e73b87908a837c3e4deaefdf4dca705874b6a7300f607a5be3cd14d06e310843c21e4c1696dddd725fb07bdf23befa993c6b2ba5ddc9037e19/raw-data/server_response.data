<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="UTF-8">
<meta property="og:type" content="website">
<meta property="og:title" content="1432358 - (CVE-2018-5175) Universal CSP strict-dynamic bypass via require.js of browser resource">
<meta property="og:url" content="https://bugzilla.mozilla.org/show_bug.cgi?id=1432358">
<meta property="og:description"
      content="VERIFIED (ckerschb) in Core - DOM: Security. Last updated 2018-11-05.">
<meta name="twitter:label1" value="Type">
<meta name="twitter:data1" value="defect">
<meta name="twitter:label2" value="Priority">
<meta name="twitter:data2" value="P1">

    <meta name="viewport" content="width=1024">
    <meta name="color-scheme" content="dark light">
    <meta name="generator" content="Bugzilla 20211025.1">
    <meta name="bugzilla-global" content="dummy"
        id="bugzilla-global" data-bugzilla="{&quot;api_token&quot;:&quot;&quot;,&quot;config&quot;:{&quot;basepath&quot;:&quot;\/&quot;},&quot;constant&quot;:{&quot;COMMENT_COLS&quot;:80},&quot;param&quot;:{&quot;maxattachmentsize&quot;:&quot;10240&quot;,&quot;maxusermatches&quot;:&quot;50&quot;,&quot;splinter_base&quot;:&quot;\/page.cgi?id=splinter.html&amp;ignore=\/&quot;},&quot;string&quot;:{&quot;bug_type_required&quot;:&quot;You must select a Type for this bug&quot;,&quot;component_required&quot;:&quot;You must select a Component for this bug&quot;,&quot;description_required&quot;:&quot;You must enter a Description for this bug&quot;,&quot;short_desc_required&quot;:&quot;You must enter a Summary for this bug&quot;,&quot;version_required&quot;:&quot;You must select a Version for this bug&quot;},&quot;user&quot;:{&quot;is_new&quot;:1,&quot;login&quot;:&quot;&quot;}}">
    <title>1432358 - (CVE-2018-5175) Universal CSP strict-dynamic bypass via require.js of browser resource</title>

<link rel="Top" href="/">

  


  
    <link rel="Show" title="Dependency Tree"
          href="/showdependencytree.cgi?id=1432358&amp;hide_resolved=1">
      <link rel="Show" title="Dependency Graph"
            href="/showdependencygraph.cgi?id=1432358">

      <link rel="Show" title="Bug Activity"
            href="/show_activity.cgi?id=1432358">

<link href="/static/v20211025.1/skins/yui.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/standard/global.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BugModal/web/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BMO/web/styles/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/EditComments/web/styles/inline-editor.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-structure-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-theme-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/lib/prism.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Needinfo/web/styles/needinfo.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Review/web/styles/badge.css" rel="stylesheet" type="text/css">



    
<script nonce="VJPiFVc2HYE8aDxCbYx2bnuytxlkNg7vDW1VyLMxVaQ8e9EM" src="/static/v20211025.1/js/jquery/jquery-min.js"></script><script nonce="VJPiFVc2HYE8aDxCbYx2bnuytxlkNg7vDW1VyLMxVaQ8e9EM" src="/static/v20211025.1/js/jquery/ui/jquery-ui-min.js"></script><script nonce="VJPiFVc2HYE8aDxCbYx2bnuytxlkNg7vDW1VyLMxVaQ8e9EM" src="/static/v20211025.1/js/yui.js"></script><script nonce="VJPiFVc2HYE8aDxCbYx2bnuytxlkNg7vDW1VyLMxVaQ8e9EM" src="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu-min.js"></script><script nonce="VJPiFVc2HYE8aDxCbYx2bnuytxlkNg7vDW1VyLMxVaQ8e9EM" src="/static/v20211025.1/js/jquery/plugins/devbridgeAutocomplete/devbridgeAutocomplete-min.js"></script><script nonce="VJPiFVc2HYE8aDxCbYx2bnuytxlkNg7vDW1VyLMxVaQ8e9EM" src="/static/v20211025.1/js/global.js"></script><script nonce="VJPiFVc2HYE8aDxCbYx2bnuytxlkNg7vDW1VyLMxVaQ8e9EM" src="/static/v20211025.1/js/util.js"></script><script nonce="VJPiFVc2HYE8aDxCbYx2bnuytxlkNg7vDW1VyLMxVaQ8e9EM" src="/static/v20211025.1/js/dropdown.js"></script>

      <script nonce="VJPiFVc2HYE8aDxCbYx2bnuytxlkNg7vDW1VyLMxVaQ8e9EM">
          YAHOO.namespace('bugzilla');
          if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
              YAHOO.util.Event._simpleRemove(window, "unload",
                                             YAHOO.util.Event._unload);
          }BUGZILLA.value_descs = JSON.parse('{\"bug_status\":{},\"resolution\":{\"\":\"---\"}}');

  
    var tracking_flags_str = "{\"flags\":{\"tracking\":{\"cf_status_thunderbird_esr78\":\"---\",\"cf_status_firefox58\":\"wontfix\",\"cf_tracking_firefox93\":\"---\",\"cf_tracking_firefox_esr78\":\"---\",\"cf_tracking_firefox60\":\"+\",\"cf_status_firefox_esr52\":\"wontfix\",\"cf_status_firefox_esr78\":\"---\",\"cf_tracking_thunderbird_esr91\":\"---\",\"cf_status_firefox60\":\"verified\",\"cf_status_firefox59\":\"wontfix\",\"cf_tracking_firefox94\":\"---\",\"cf_status_firefox61\":\"verified\",\"cf_tracking_thunderbird_esr78\":\"---\",\"cf_status_firefox94\":\"---\",\"cf_status_firefox93\":\"---\",\"cf_tracking_firefox_relnote\":\"---\",\"cf_tracking_firefox95\":\"---\",\"cf_status_firefox_esr91\":\"---\",\"cf_tracking_firefox59\":\"+\",\"cf_tracking_firefox_esr52\":\"-\",\"cf_tracking_firefox_esr91\":\"---\",\"cf_status_firefox95\":\"---\",\"cf_status_thunderbird_esr91\":\"---\"},\"project\":{\"cf_tracking_firefox_sumo\":\"---\",\"cf_webcompat_priority\":\"---\",\"cf_a11y_review_project_flag\":\"---\",\"cf_fission_milestone\":\"---\",\"cf_root_cause\":\"---\"}},\"comments\":{\"cf_tracking_firefox_relnote\":{\"?\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox_sumo\":{\"none-needed\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox94\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_a11y_review_project_flag\":{\"requested\":\"Description:\\nPlease provide an explanation of the feature or change. Include a description of the user scenario in which it would be used and how the user would complete the task(s).\\nScreenshots and visual UI specs are welcome, but please include sufficient accompanying explanation so that blind members of the accessibility team are able to understand the feature\/change.\\n\\nHow do we test this?\\nIf there is an implementation to test, please provide instructions for testing it; e.g. setting preferences, other preparation, how to trigger the UI, etc.\\n\\nWhen will this ship?\\nTracking bug\/issue:\\nDesign documents (e.g. Product Requirements Document, UI spec):\\nEngineering lead:\\nProduct manager:\\n\\nThe accessibility team has developed the Mozilla Accessibility Release Guidelines which outline what is needed to make user interfaces accessible:\\nhttps:\/\/wiki.mozilla.org\/Accessibility\/Guidelines\\nPlease describe the accessibility guidelines you considered and what steps you\'ve taken to address them:\\n\\nDescribe any areas of concern to which you want the accessibility team to give special attention:\"},\"cf_tracking_firefox59\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox93\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr91\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox60\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr78\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr52\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox95\":{\"?\":\"[Tracking Requested - why for this release]:\"}},\"types\":[\"tracking\"]}";
    var TrackingFlags = $.parseJSON(tracking_flags_str);

  

  
  BUGZILLA.bug_id = 1432358;
  BUGZILLA.bug_title = '1432358 - (CVE-2018-5175) Universal CSP strict-dynamic bypass via require.js of browser resource';
  BUGZILLA.bug_summary = 'Universal CSP strict-dynamic bypass via require.js of browser resource';
  BUGZILLA.bug_url = 'https:\/\/bugzilla.mozilla.org\/show_bug.cgi?id=1432358';
  BUGZILLA.bug_keywords = 'csectype-other, sec-moderate',
  BUGZILLA.user = {
    id: 0,
    login: '',
    is_insider: false,
    is_timetracker: false,
    can_tag: false,
    timezone: 'America\/Los_Angeles',
    settings: {
      quote_replies: 'quoted_reply',
      zoom_textareas: true,
      remember_collapsed: true,
      inline_attachments: true,
      autosize_comments: false
    }
  };

  BUGZILLA.bug_secure = false;
      </script>
<script nonce="VJPiFVc2HYE8aDxCbYx2bnuytxlkNg7vDW1VyLMxVaQ8e9EM" src="/static/v20211025.1/extensions/BugModal/web/autosize.min.js"></script><script nonce="VJPiFVc2HYE8aDxCbYx2bnuytxlkNg7vDW1VyLMxVaQ8e9EM" src="/static/v20211025.1/extensions/ProdCompSearch/web/js/prod_comp_search.js"></script><script nonce="VJPiFVc2HYE8aDxCbYx2bnuytxlkNg7vDW1VyLMxVaQ8e9EM" src="/static/v20211025.1/extensions/BugModal/web/bug_modal.js"></script><script nonce="VJPiFVc2HYE8aDxCbYx2bnuytxlkNg7vDW1VyLMxVaQ8e9EM" src="/static/v20211025.1/extensions/BugModal/web/comments.js"></script><script nonce="VJPiFVc2HYE8aDxCbYx2bnuytxlkNg7vDW1VyLMxVaQ8e9EM" src="/static/v20211025.1/extensions/ComponentWatching/web/js/overlay.js"></script><script nonce="VJPiFVc2HYE8aDxCbYx2bnuytxlkNg7vDW1VyLMxVaQ8e9EM" src="/static/v20211025.1/js/bugzilla-readable-status-min.js"></script><script nonce="VJPiFVc2HYE8aDxCbYx2bnuytxlkNg7vDW1VyLMxVaQ8e9EM" src="/static/v20211025.1/js/field.js"></script><script nonce="VJPiFVc2HYE8aDxCbYx2bnuytxlkNg7vDW1VyLMxVaQ8e9EM" src="/static/v20211025.1/js/comments.js"></script><script nonce="VJPiFVc2HYE8aDxCbYx2bnuytxlkNg7vDW1VyLMxVaQ8e9EM" src="/static/v20211025.1/extensions/TrackingFlags/web/js/flags.js"></script><script nonce="VJPiFVc2HYE8aDxCbYx2bnuytxlkNg7vDW1VyLMxVaQ8e9EM" src="/static/v20211025.1/extensions/BMO/web/js/firefox-crash-table.js"></script><script nonce="VJPiFVc2HYE8aDxCbYx2bnuytxlkNg7vDW1VyLMxVaQ8e9EM" src="/static/v20211025.1/extensions/MozChangeField/web/js/severity-s1-priority-p1.js"></script><script nonce="VJPiFVc2HYE8aDxCbYx2bnuytxlkNg7vDW1VyLMxVaQ8e9EM" src="/static/v20211025.1/extensions/MozChangeField/web/js/clear-tracking-priority-s1.js"></script><script nonce="VJPiFVc2HYE8aDxCbYx2bnuytxlkNg7vDW1VyLMxVaQ8e9EM" src="/static/v20211025.1/extensions/MozChangeField/web/js/set-tracking-severity-s1.js"></script><script nonce="VJPiFVc2HYE8aDxCbYx2bnuytxlkNg7vDW1VyLMxVaQ8e9EM" src="/static/v20211025.1/js/lib/prism.js"></script><script nonce="VJPiFVc2HYE8aDxCbYx2bnuytxlkNg7vDW1VyLMxVaQ8e9EM" src="/static/v20211025.1/extensions/GoogleAnalytics/web/js/analytics.js"></script><script nonce="VJPiFVc2HYE8aDxCbYx2bnuytxlkNg7vDW1VyLMxVaQ8e9EM" src="/static/v20211025.1/js/lib/md5.min.js"></script><script nonce="VJPiFVc2HYE8aDxCbYx2bnuytxlkNg7vDW1VyLMxVaQ8e9EM" src="/static/v20211025.1/extensions/Review/web/js/badge.js"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla@Mozilla" href="/search_plugin.cgi"><link rel="shortcut icon" href="/extensions/BMO/web/images/favicon.ico">
<link rel="canonical" href="https://bugzilla.mozilla.org/show_bug.cgi?id=1432358">
<link rel="shorturl" href="https://bugzilla.mozilla.org/1432358"><meta name="google-analytics" content="UA-36116321-3" data-location="https://bugzilla.mozilla.org/bug/show-modal" data-title="1432358 - (CVE-2018-5175) Universal CSP strict-dynamic bypass via require.js of browser resource">
<script async src="https://www.google-analytics.com/analytics.js"></script><meta name="robots" content="noarchive">
  </head>



  <body
        class="bugzilla-mozilla-org
               skin-standard bug_modal yui-skin-sam">



<div id="wrapper">

<header id="header" role="banner">
  <div class="inner">
    <h1 id="header-title" class="title"><a href="https://bugzilla.mozilla.org/home" title="Go to home page">Bugzilla</a></h1>
    <form role="search" id="header-search" class="quicksearch" action="/buglist.cgi" data-no-csrf>
      <section class="searchbox-outer dropdown" role="combobox" aria-expanded="false" aria-haspopup="listbox"
               aria-labelledby="header-search-label" aria-owns="header-search-dropdown">
        <h2 id="header-search-label">Quick Search</h2>
        <span class="icon" aria-hidden="true"></span>
        <input role="searchbox" id="quicksearch_top" class="dropdown-button" name="quicksearch" autocomplete="off"
               value="" placeholder="Search Bugs"
               title="Enter a bug number or some search terms" aria-controls="header-search-dropdown"
               aria-label="Quick Search"><div id="header-search-dropdown" class="dropdown-content right" role="listbox" style="display: none;">
  <div id="header-search-dropdown-wrapper">
  </div>
</div>
      </section>
    </form>
    <nav id="header-nav">
      <ul class="links">
        <li class="link-browse">
          <a href="/describecomponents.cgi" title="Browse bugs by component">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Browse</span>
          </a>
        </li>
        <li class="link-search">
          <a href="/query.cgi?format=advanced" title="Search bugs using various criteria">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Advanced Search</span>
          </a>
        </li>
      </ul>
      <div class="dropdown">
        <button type="button" id="header-tools-menu-button" class="dropdown-button minor" title="More tools…"
                aria-label="More tools…" aria-expanded="false" aria-haspopup="true" aria-controls="header-tools-menu">
          <span class="icon" aria-hidden="true"></span>
        </button>
        <ul class="dropdown-content left" id="header-tools-menu" role="menu" style="display:none;">
          <li role="presentation">
            <a href="/report.cgi" role="menuitem" tabindex="-1">Reports</a>
          </li>
            <li role="separator"></li>
            <li role="presentation">
              <a href="https://bmo.readthedocs.io/en/latest/" role="menuitem" tabindex="-1">Documentation</a>
            </li>
        </ul>
      </div>
    </nav>
      <ul id="header-login" class="links">
          <li id="moz_new_account_container_top"><a href="/createaccount.cgi">New Account</a></li><li id="mini_login_container_top">
  <a id="login_link_top" href="/index.cgi?GoAheadAndLogIn=1"
     class='show_mini_login_form' data-qs-suffix="_top">Log In</a>

  <div id="mini_login_top" class="mini-popup mini_login bz_default_hidden"><span id="github_mini_login_top" class="mini_login_top">
    <form method="post" action="/github.cgi">
      <input type="hidden" name="github_secret" value="HqxxpbyJKor8lax4MyEixA6EeknJDUwPEF22vTjzWsb5oxyxOUEdJDTX23Gft0SOAK6bATn2S2S79gKh6V7idHSITbpMVjnnPBB2uC0SJsTyrXdmmN2VkOfHsYyIeGYvVzK0tFej0ClJkC9MKNHiaEVxuxqyXWLQVhg4ZZQuAOPf5xywrjvMpA7e3VsMVvsGSKMCR1k30k140WBGNsqy6YqMjGuYaf2vHcHnUxsQZSYxrtd8LxdUeVxkzgTbPoNr">
      <input type="hidden" name="target_uri" value="https://bugzilla.mozilla.org/show_bug.cgi">
      <input type="image" src="/extensions/GitHubAuth/web/images/sign_in.png" height="22" width="75" align="absmiddle"
             alt="Sign in with GitHub"
             title="Sign in with GitHub"> or
    </form>
  </span>

  <form action="/show_bug.cgi?id=1432358" method="POST"
        data-qs-suffix="_top">

    <input id="Bugzilla_login_top"
           class="bz_login"
           name="Bugzilla_login"
           title="Login"
           placeholder="Email"
           aria-label="Email"
           type="email"
           required
    >
    <input class="bz_password"
           id="Bugzilla_password_top"
           name="Bugzilla_password"
           type="password"
           title="Password"
           placeholder="Password"
           aria-label="Password"
           required
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text"
           id="Bugzilla_password_dummy_top" value="password"
           title="Password"
    >
      <input type="checkbox" id="Bugzilla_remember_top"
             name="Bugzilla_remember" value="on" class="bz_remember"
                 checked>
      <label for="Bugzilla_remember_top">Remember</label>
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
           class="check_mini_login_fields"
            id="log_in_top">
    <a href="#" id="hide_mini_login_top" aria-label="Close"
       class="close-button hide_mini_login_form" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
<li id="forgot_container_top">
  <a id="forgot_link_top" href="/index.cgi?GoAheadAndLogIn=1#forgot"
     class='show_forgot_form'
     data-qs-suffix="_top">Forgot Password</a>
  <div id="forgot_form_top" class="mini-popup mini_forgot bz_default_hidden">
  <form action="/token.cgi" method="post">
    <input type="email" name="loginname" size="20" placeholder="Email" aria-label="Email" required>
    <input id="forgot_button_top" value="Reset Password"
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <input type="hidden" id="token_top" name="token" value="1635623288-SQjsDiJCz2WfZY67xZDUIKeEaBPczbCfbCODjdGSw04">
    <a href="#" class="close-button hide_forgot_form" aria-label="Close" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
      </ul><div id="header-external-links" class="dropdown first">
  <button type="button" id="header-external-menu-button" class="dropdown-button minor" title="Mozilla"
          aria-label="Mozilla" aria-expanded="false" aria-haspopup="true" aria-controls="header-external-menu">
    <img src="/static/v20211025.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg" width="32" height="32" alt="">
  </button>
  <ul class="dropdown-content right" id="header-external-menu" role="menu" style="display:none;">
    <li role="presentation">
      <a href="https://www.mozilla.org/" role="menuitem" tabindex="-1">Mozilla Home</a>
    </li>
    <li role="separator"></li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/" role="menuitem" tabindex="-1">Privacy</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/#cookies" role="menuitem" tabindex="-1">Cookies</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/about/legal/" role="menuitem" tabindex="-1">Legal</a>
    </li>
  </ul>
</div>
  </div>
</header> 


<main id="bugzilla-body" tabindex="-1">

<aside id="message-container" role="complementary">
  <noscript>
    <div class="noscript">
      <div class="inner">
        <p>Please enable JavaScript in your browser to use all the features on this site.</p>
      </div>
    </div>
  </noscript>
</aside>

<div id="main-inner">




<div role="toolbar" id="page-toolbar">
  <div role="group" class="buttons">
    <button type="button" id="copy-summary" class="secondary"
      title="Copy bug number and summary to your clipboard">Copy Summary</button>
    <div id="clip-container" style="display:none"><input type="text" id="clip"></div>
    <div class="dropdown">
      <button type="button" id="action-menu-btn" aria-haspopup="true" aria-label="View"
        aria-expanded="false" aria-controls="action-menu" class="dropdown-button secondary">View &#9662;</button>
      <ul class="dropdown-content left" id="action-menu" role="menu" style="display:none;">
        <li role="presentation">
          <a id="action-reset" role="menuitem" tabindex="-1">Reset Sections</a>
        </li>
        <li role="presentation">
          <a id="action-expand-all" role="menuitem" tabindex="-1">Expand All Sections</a>
        </li>
        <li role="presentation">
          <a id="action-collapse-all" role="menuitem" tabindex="-1">Collapse All Sections</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a id="action-history" role="menuitem" tabindex="-1">History</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a href="/rest/bug/1432358" role="menuitem" tabindex="-1">JSON</a>
        </li>
        <li role="presentation">
          <a href="/show_bug.cgi?ctype=xml&amp;id=1432358" role="menuitem" tabindex="-1">XML</a>
        </li>
      </ul>
    </div>
  </div>
</div>



<div role="status" id="io-error" style="display:none"></div>
<div role="status" id="floating-message" style="display:none">
  <div id="floating-message-text"></div>
</div>
<section class="module"
>
  <div class="module-content"
  >
  <div id="summary-container">
    <div class="field indent" id="field-status_summary"
>


  
    <div class=" container">
        <span id="field-value-status_summary">
      <span class="bug-status-label text" data-status="closed">Closed</span>
      <span id="field-value-bug_id">
        <a href="/show_bug.cgi?id=1432358">Bug 1432358</a>
          <span class="edit-hide">(CVE-2018-5175)</span>
      </span>
      <span>
        <span class="bug-time-label">Opened <span class="rel-time" title="2018-01-22 18:27 PST" data-time="1516674466">4 years ago</span></span>
          <span class="bug-time-label">Closed <span class="rel-time" title="2018-02-18 14:13 PST" data-time="1518991999">4 years ago</span></span>
      </span>
        </span>
    </div>

  
</div>
<div class="field indent edit-hide"
>


  
    <div class=" container">
      

      <h1 id="field-value-short_desc">Universal CSP strict-dynamic bypass via require<wbr>.js of browser resource</h1>
    </div>

  
</div>

    <div class="field edit-show" id="field-short_desc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc" id="short_desc-help-link" class="help">Summary:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-short_desc">
            Universal CSP strict-dynamic bypass via require.js of browser resource

        </span>
    </div>

  
</div>
  </div>
  </div>
</section>


<section class="module" id="module-categories"
>
    <header id="module-categories-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Categories section"
           data-label-collapsed="Expand Categories section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-categories-content"
             aria-expanded="true"
             aria-labeledby="module-categories-title"
             aria-describedby="module-categories-subtitle"></div>
        <h2 class="module-title" id="module-categories-title">Categories</h2>
          <h3 class="module-subtitle" id="module-categories-subtitle">
            (Core :: DOM: Security, defect, P1)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-categories-content"
  ><div class="fields-lhs">

    <div class="field" id="field-product"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=Core" id="product-help-link" class="help">Product:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-product">
      <div class="name-info-outer dropdown">
        <span id="product-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="product-info">Core
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="product-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Product description and actions">
          <header>
            <div class="title">Core</div>
            <div class="description">Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the <a href="https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox">Firefox</a> product. (<a href="https://wiki.mozilla.org/Modules/All#Core">More info</a>)</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=Core&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Product</a></div>
            <div><a href="/enter_bug.cgi?product=Core"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Product</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="Core"
                         data-label-watch="Watch This Product" data-label-unwatch="Unwatch This Product"
                         data-source="BugModal">Watch This Product</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-component"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=Core&component=DOM%3A%20Security#DOM%3A%20Security" id="component-help-link" class="help">Component:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-component">
      <div class="name-info-outer dropdown">
        <span id="component-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="component-info">DOM: Security
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="component-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Component description and actions">
          <header>
            <div class="title">Core :: DOM: Security</div>
            <div class="description">Native content-based security features including: Content Security Policy (CSP), Mixed Content Blocker (MCB), and Safe Browsing.</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=Core&amp;component=DOM%3A%20Security&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Component</a></div>
            <div><a href="/buglist.cgi?product=Core&amp;component=DOM%3A%20Security&amp;chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__"
                    target="_blank" role="menuitem" tabindex="-1">Recently Fixed Bugs in This Component</a></div>
            <div><a href="/enter_bug.cgi?product=Core&amp;component=DOM%3A%20Security"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Component</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="Core" data-component="DOM: Security"
                         data-label-watch="Watch This Component" data-label-unwatch="Unwatch This Component"
                         data-source="BugModal">Watch This Component</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-version"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#version" id="version-help-link" class="help">Version:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-version">
            60 Branch

        </span>
    </div>

  
</div>

    <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform" id="-help-link" class="help">Platform:
        </a>
    </div>


  
    <div class=" container"><div class="field inline" id="field-rep_platform"
>


  
    <div class="value">
        <span id="field-value-rep_platform">
            Unspecified

        </span>
    </div>

  
</div><div class="field indent inline" id="field-op_sys"
>


  
    <div class="value">
        <span id="field-value-op_sys">
            Unspecified

        </span>
    </div>

  
</div><div class="field indent inline"
>


  
    <div class=" container">
    </div>

  
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field contains-buttons" id="field-bug_type"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type" id="bug_type-help-link" class="help">Type:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_type">
      <span class="bug-type-label iconic-text" data-type="defect">
        <span class="icon" aria-hidden="true"></span>defect</span>
        </span>
    </div>

  
</div>

    <div class="field" id="field-importance"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority" id="importance-help-link" class="help">Priority:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-importance"><div class="field inline" id="field-priority"
>


  
    <div class="value">
        <span id="field-value-priority">P1
        </span>
    </div>

  
</div><div class="field inline" id="field-bug_severity"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity" id="bug_severity-help-link" class="help">Severity:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_severity">
            normal

        </span>
    </div>

  
</div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-cf_fx_points" style="display:none"
>
    <div class="name">Points:
    </div>


  
    <div class="value">
        <span id="field-value-cf_fx_points">
            ---

        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-tracking"
>
    <header id="module-tracking-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Tracking section"
           data-label-collapsed="Expand Tracking section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-tracking-content"
             aria-expanded="true"
             aria-labeledby="module-tracking-title"
             aria-describedby="module-tracking-subtitle"></div>
        <h2 class="module-title" id="module-tracking-title">Tracking</h2>
          <h3 class="module-subtitle" id="module-tracking-subtitle">
            (<span id="readable-bug-status" data-readable-bug-status="{&quot;cf_tracking_firefox_esr52&quot;:&quot;-&quot;,&quot;cf_tracking_firefox_esr91&quot;:&quot;---&quot;,&quot;cf_status_firefox95&quot;:&quot;---&quot;,&quot;resolution&quot;:&quot;FIXED&quot;,&quot;cf_status_thunderbird_esr91&quot;:&quot;---&quot;,&quot;target_milestone&quot;:&quot;mozilla60&quot;,&quot;status&quot;:&quot;VERIFIED&quot;,&quot;cf_tracking_firefox95&quot;:&quot;---&quot;,&quot;cf_status_firefox_esr91&quot;:&quot;---&quot;,&quot;cf_root_cause&quot;:&quot;---&quot;,&quot;cf_tracking_firefox59&quot;:&quot;+&quot;,&quot;cf_a11y_review_project_flag&quot;:&quot;---&quot;,&quot;cf_status_firefox61&quot;:&quot;verified&quot;,&quot;cf_webcompat_priority&quot;:&quot;---&quot;,&quot;flags&quot;:[{&quot;name&quot;:&quot;sec-bounty&quot;,&quot;status&quot;:&quot;+&quot;},{&quot;status&quot;:&quot;+&quot;,&quot;name&quot;:&quot;in-testsuite&quot;}],&quot;cf_tracking_thunderbird_esr78&quot;:&quot;---&quot;,&quot;cf_fission_milestone&quot;:&quot;---&quot;,&quot;cf_status_firefox94&quot;:&quot;---&quot;,&quot;cf_status_firefox93&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_sumo&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_relnote&quot;:&quot;---&quot;,&quot;id&quot;:1432358,&quot;cf_status_firefox58&quot;:&quot;wontfix&quot;,&quot;cf_status_thunderbird_esr78&quot;:&quot;---&quot;,&quot;cf_tracking_firefox93&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_esr78&quot;:&quot;---&quot;,&quot;priority&quot;:&quot;P1&quot;,&quot;cf_status_firefox_esr52&quot;:&quot;wontfix&quot;,&quot;cf_tracking_firefox60&quot;:&quot;+&quot;,&quot;cf_tracking_thunderbird_esr91&quot;:&quot;---&quot;,&quot;cf_status_firefox_esr78&quot;:&quot;---&quot;,&quot;keywords&quot;:[&quot;csectype-other&quot;,&quot;sec-moderate&quot;],&quot;cf_status_firefox60&quot;:&quot;verified&quot;,&quot;cf_status_firefox59&quot;:&quot;wontfix&quot;,&quot;cf_tracking_firefox94&quot;:&quot;---&quot;,&quot;dupe_of&quot;:null}"></span>)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-tracking-content"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-status-view"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-view-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-view">VERIFIED
        FIXED
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-status-edit" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-edit-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-edit"><div class="field inline" id="field-bug_status"
>


  
    <div class="value">
        <span id="field-value-bug_status">
            VERIFIED

        </span>
    </div>

  
</div><div class="field indent inline" id="field-resolution"
>


  
    <div class="value">
        <span id="field-value-resolution">
            FIXED

        </span>
    </div>

  
</div>
  <div id="status-action-buttons">
      <div id="assigned-container" style="display:none">
        <button type="button" class="secondary" id="mark-as-assigned-btn">
          Mark as Assigned
        </button>
      </div>
  </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-target_milestone"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone" id="target_milestone-help-link" class="help">Milestone:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-target_milestone">
            mozilla60

        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-cf_fx_iteration" style="display:none"
>
    <div class="name">Iteration:
    </div>


  
    <div class="value">
        <span id="field-value-cf_fx_iteration">
            ---

        </span>
    </div>

  
</div>


      <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Project Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <td class="tracking-flag-name">Webcompat Priority</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_webcompat_priority-dirty">
  <select id="cf_webcompat_priority" name="cf_webcompat_priority">
        <option value="---"
          id="v4274_cf_webcompat_priority" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Root Cause</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_root_cause-dirty">
  <select id="cf_root_cause" name="cf_root_cause">
        <option value="---"
          id="v4701_cf_root_cause" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">a11y-review</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_a11y_review_project_flag-dirty">
  <select id="cf_a11y_review_project_flag" name="cf_a11y_review_project_flag">
        <option value="---"
          id="v4876_cf_a11y_review_project_flag" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">user-doc-firefox</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_sumo-dirty">
  <select id="cf_tracking_firefox_sumo" name="cf_tracking_firefox_sumo">
        <option value="---"
          id="v4660_cf_tracking_firefox_sumo" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Fission Milestone</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_fission_milestone-dirty">
  <select id="cf_fission_milestone" name="cf_fission_milestone">
        <option value="---"
          id="v4222_cf_fission_milestone" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

      <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Tracking Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-hide">
    <table class="layout-table tracking-flags">
        <tr>
          <th></th>
          <th>Tracking</th>
          <th>Status</th>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox-esr52</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox_esr52&amp;o1=equals&amp;v1=-">-</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox_esr52&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox58</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox58&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox59</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox59&amp;o1=equals&amp;v1=%2B">+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox59&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox60</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox60&amp;o1=equals&amp;v1=%2B">+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox60&amp;o1=equals&amp;v1=verified">verified</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox61</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox61&amp;o1=equals&amp;v1=verified">verified</a>
          </td>
        </tr>
    </table>
  </div>


<div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <th></th>
        <th>Tracking</th>
        <th>Status</th>
      </tr>
      <tr>
        <td class="tracking-flag-name">relnote-firefox</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_relnote-dirty">
  <select id="cf_tracking_firefox_relnote" name="cf_tracking_firefox_relnote">
        <option value="---"
          id="v539_cf_tracking_firefox_relnote" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr78-dirty">
  <select id="cf_tracking_thunderbird_esr78" name="cf_tracking_thunderbird_esr78">
        <option value="---"
          id="v4823_cf_tracking_thunderbird_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr78-dirty">
  <select id="cf_status_thunderbird_esr78" name="cf_status_thunderbird_esr78">
        <option value="---"
          id="v4829_cf_status_thunderbird_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr91-dirty">
  <select id="cf_tracking_thunderbird_esr91" name="cf_tracking_thunderbird_esr91">
        <option value="---"
          id="v5236_cf_tracking_thunderbird_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr91-dirty">
  <select id="cf_status_thunderbird_esr91" name="cf_status_thunderbird_esr91">
        <option value="---"
          id="v5242_cf_status_thunderbird_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr52</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr52-dirty">
  <select id="cf_tracking_firefox_esr52" name="cf_tracking_firefox_esr52">
        <option value="-"
          id="v3106_cf_tracking_firefox_esr52" selected
        >-
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr52-dirty">
  <select id="cf_status_firefox_esr52" name="cf_status_firefox_esr52">
        <option value="wontfix"
          id="v3142_cf_status_firefox_esr52" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr78-dirty">
  <select id="cf_tracking_firefox_esr78" name="cf_tracking_firefox_esr78">
        <option value="---"
          id="v4808_cf_tracking_firefox_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr78-dirty">
  <select id="cf_status_firefox_esr78" name="cf_status_firefox_esr78">
        <option value="---"
          id="v4813_cf_status_firefox_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr91-dirty">
  <select id="cf_tracking_firefox_esr91" name="cf_tracking_firefox_esr91">
        <option value="---"
          id="v5194_cf_tracking_firefox_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr91-dirty">
  <select id="cf_status_firefox_esr91" name="cf_status_firefox_esr91">
        <option value="---"
          id="v5199_cf_status_firefox_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox58</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox58-dirty">
  <select id="cf_status_firefox58" name="cf_status_firefox58">
        <option value="wontfix"
          id="v3447_cf_status_firefox58" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox59</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox59-dirty">
  <select id="cf_tracking_firefox59" name="cf_tracking_firefox59">
        <option value="+"
          id="v3502_cf_tracking_firefox59" selected
        >+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox59-dirty">
  <select id="cf_status_firefox59" name="cf_status_firefox59">
        <option value="wontfix"
          id="v3511_cf_status_firefox59" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox60</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox60-dirty">
  <select id="cf_tracking_firefox60" name="cf_tracking_firefox60">
        <option value="+"
          id="v3558_cf_tracking_firefox60" selected
        >+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox60-dirty">
  <select id="cf_status_firefox60" name="cf_status_firefox60">
        <option value="verified"
          id="v3568_cf_status_firefox60" selected
        >verified
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox61</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox61-dirty">
  <select id="cf_status_firefox61" name="cf_status_firefox61">
        <option value="verified"
          id="v3655_cf_status_firefox61" selected
        >verified
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox93</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox93-dirty">
  <select id="cf_tracking_firefox93" name="cf_tracking_firefox93">
        <option value="---"
          id="v5266_cf_tracking_firefox93" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox93-dirty">
  <select id="cf_status_firefox93" name="cf_status_firefox93">
        <option value="---"
          id="v5271_cf_status_firefox93" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox94</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox94-dirty">
  <select id="cf_tracking_firefox94" name="cf_tracking_firefox94">
        <option value="---"
          id="v5284_cf_tracking_firefox94" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox94-dirty">
  <select id="cf_status_firefox94" name="cf_status_firefox94">
        <option value="---"
          id="v5289_cf_status_firefox94" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox95</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox95-dirty">
  <select id="cf_tracking_firefox95" name="cf_tracking_firefox95">
        <option value="---"
          id="v5311_cf_tracking_firefox95" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox95-dirty">
  <select id="cf_status_firefox95" name="cf_status_firefox95">
        <option value="---"
          id="v5316_cf_status_firefox95" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>

</div>
  </div>
</section>



<section class="module" id="module-people"
>
    <header id="module-people-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse People section"
           data-label-collapsed="Expand People section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-people-content"
             aria-expanded="false"
             aria-labeledby="module-people-title"
             aria-describedby="module-people-subtitle"></div>
        <h2 class="module-title" id="module-people-title">People</h2>
          <h3 class="module-subtitle" id="module-people-subtitle">
            (Reporter: masatokinugawa, Assigned: ckerschb)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-people-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-assigned_to"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to"><div class="vcard vcard_363267" ><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=363267" > <span class="fna">ckerschb</span></a>
</div>
        </span>
    </div>

  
</div><div class="field edit-show" id="field-assigned_to" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-assignee" name="set_default_assignee" class="set-default"
          value="1" data-for="assigned_to">
        <label for="set-default-assignee">Reset Assignee to default</label>
      </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-bug_mentors" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor" id="bug_mentors-help-link" class="help">Mentors:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_mentors">---
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-qa_contact" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact" id="qa_contact-help-link" class="help">QA Contact:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-qa_contact">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-qa-contact" name="set_default_qa_contact" class="set-default"
          value="1" data-for="qa_contact">
        <label for="set-default-qa-contact">Reset QA Contact to default</label>
      </div>
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-reporter"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter" id="reporter-help-link" class="help">Reporter:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-reporter">
            <div class="vcard vcard_393170" ><img src="https://secure.gravatar.com/avatar/1a5bce24526a7d6f1ab89678df2d673c?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=393170" > <span class="fna">masatokinugawa</span></a>
</div>

        </span>
    </div>

  
</div>

    <div class="field" id="field-triage_owner"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner" id="triage_owner-help-link" class="help">Triage Owner:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-triage_owner">
            <div class="vcard vcard_363267" ><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=363267" > <span class="fna">ckerschb</span></a>
</div>

        </span>
    </div>

  
</div>

    

    <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc" id="-help-link" class="help">CC:
        </a>
    </div>


  
    <div class=" container">


        <span aria-owns="cc-summary cc-latch">
          <span role="button" tabindex="0" id="cc-summary" data-count="17">17 people
          </span>
        </span>


        <div id="cc-list" style="display:none"></div>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-references"
>
    <header id="module-references-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse References section"
           data-label-collapsed="Expand References section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-references-content"
             aria-expanded="false"
             aria-labeledby="module-references-title"
             aria-describedby="module-references-subtitle"></div>
        <h2 class="module-title" id="module-references-title">References</h2>
          <h3 class="module-subtitle" id="module-references-subtitle">
            (Depends on 1 open bug)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-references-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field bug-list" id="field-dependson"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson" id="dependson-help-link" class="help">Depends on:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-dependson">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox nightly shows XML content as plain text"
   href="/show_bug.cgi?id=1439444">1439444</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE - The image is wrongly displayed if the &quot;View Image&quot; option is used"
   href="/show_bug.cgi?id=1439964">1439964</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Crash in nsDocument::InitCSP via nsHTMLDocument::StartDocumentLoad"
   href="/show_bug.cgi?id=1443110">1443110</a>
      </div>
      <div class="bug-list">
        <span class="bug-type-label iconic" title="enhancement"
              aria-label="enhancement" data-type="enhancement">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_NEW"
   title="NEW - Re-Enable test_ext_contentscript_triggeringPrincipal.js on Windows Debug"
   href="/show_bug.cgi?id=1438796">1438796</a>
      </div>

        </span>
    </div>

  
</div><div class="field bug-list edit-show" id="field-blocked" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks" id="blocked-help-link" class="help">Blocks:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-blocked">
        ---
        </span>
    </div>

  
</div><div class="field" id="field-dependencytree"
>
    <div class="name">
    </div>


  
    <div class=" container">
        <span id="field-value-dependencytree">
        Dependency <a href="/showdependencytree.cgi?id=1432358&amp;hide_resolved=1">tree</a>
        / <a href="/showdependencygraph.cgi?id=1432358">graph</a>
        </span>
    </div>

  
</div>

    <div class="field bug-list edit-show" id="field-regresses" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses" id="regresses-help-link" class="help">Regressions:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regresses">
        ---
        </span>
    </div>

  
</div><div class="field bug-list edit-show" id="field-regressed_by" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by" id="regressed_by-help-link" class="help">Regressed by:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regressed_by">
        ---
        </span>
    </div>

  
</div>

    
</div><div class="fields-rhs">

    <div class="field edit-show" id="field-bug_file_loc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc" id="bug_file_loc-help-link" class="help">URL:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_file_loc"><div class="link">
    <a href="" target="_blank"
      rel="noreferrer" title=""
      class="bug-url" data-safe="0"></a>
  </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-see_also" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also" id="see_also-help-link" class="help">See Also:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-see_also">
        ---
        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-details"
>
    <header id="module-details-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Details section"
           data-label-collapsed="Expand Details section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-details-content"
             aria-expanded="false"
             aria-labeledby="module-details-title"
             aria-describedby="module-details-subtitle"></div>
        <h2 class="module-title" id="module-details-title">Details</h2>
          <h3 class="module-subtitle" id="module-details-subtitle">
            (Keywords: csectype-other, sec-moderate, Whiteboard: [domsecurity-active][adv-main60+])
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-details-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-show" id="field-alias" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias" id="alias-help-link" class="help">Alias:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-alias">
            CVE-2018-5175

        </span>
    </div>

  
</div>

    <div class="field" id="field-keywords"
>
    <div class="name">
        <a href="/describekeywords.cgi" id="keywords-help-link" class="help">Keywords:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-keywords">
          <a href="/buglist.cgi?keywords=csectype-other&amp;resolution=---">csectype-other</a>, 
          <a href="/buglist.cgi?keywords=sec-moderate&amp;resolution=---">sec-moderate</a>
        </span>
    </div>

  
</div>

    <div class="field" id="field-status_whiteboard"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/Whiteboard" id="status_whiteboard-help-link" class="help">Whiteboard:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-status_whiteboard">[domsecurity-active][adv-main60+]
        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_qa_whiteboard" style="display:none"
>
    <div class="name">QA Whiteboard:
    </div>


  
    <div class="value">
        <span id="field-value-cf_qa_whiteboard">
        ---
        </span>
    </div>

  
</div>

    

    <div class="field edit-show" id="field-cf_has_regression_range" style="display:none"
>
    <div class="name">Has Regression Range:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_regression_range">
            ---

        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_has_str" style="display:none"
>
    <div class="name">Has STR:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_str">
            ---

        </span>
    </div>

  
</div>

    <div class="field" id="field-votes"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes" id="votes-help-link" class="help">Votes:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-votes">0
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-bug_flags"
>
    <div class="name">Bug Flags:
    </div>


  
    <div class=" container">
        <span id="field-value-bug_flags"><div id="bug-flags" class="flags">
  <table class="layout-table">
          <tbody class="edit-hide"><tr>
    <td class="flag-setter"><div class="vcard vcard_1689" ><a class="email " href="/user_profile?user_id=1689" > <span class="fna">dveditz</span></a>
</div>
    </td>

    <td class="flag-name">
        <a href="#c84"
            class="rel-time-title activity-ref"
            title="4 years ago"
        data-time="1522092610"
      >sec-bounty</a>
    </td>

    <td class="flag-value">+
    </td>

  </tr>
          </tbody>
          <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter"><div class="vcard vcard_1689" ><a class="email " href="/user_profile?user_id=1689" > <span class="fna">dveditz</span></a>
</div>
    </td>

    <td class="flag-name">
      <label title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug." for="flag-1735002">sec-bounty</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag-1735002-dirty">
      <select id="flag-1735002" name="flag-1735002"
        title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug."
        class="bug-flag">
            <option value="+" selected>+</option>
      </select>
    </td>


  </tr>
          </tbody>
          <tbody class="edit-hide"><tr>
    <td class="flag-setter"><div class="vcard vcard_75935" ><a class="email " href="/user_profile?user_id=75935" > <span class="fna">RyanVM</span></a>
</div>
    </td>

    <td class="flag-name">
        <a href="#c80"
            class="rel-time-title activity-ref"
            title="4 years ago"
        data-time="1519250962"
      >in-testsuite</a>
    </td>

    <td class="flag-value">+
    </td>

  </tr>
          </tbody>
          <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter"><div class="vcard vcard_75935" ><a class="email " href="/user_profile?user_id=75935" > <span class="fna">RyanVM</span></a>
</div>
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag-1719778">in-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag-1719778-dirty">
      <select id="flag-1719778" name="flag-1719778"
        title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" selected>+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr>
          </tbody>
    <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?" for="flag_type-930">behind-pref</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-930-dirty">
      <select id="flag_type-930" name="flag_type-930"
        title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?"
        class="bug-flag">
          <option value="X"></option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag tracking inclusion in the desktop Firefox product backlog." for="flag_type-846">firefox-backlog</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-846-dirty">
      <select id="flag_type-846" name="flag_type-846"
        title="Flag tracking inclusion in the desktop Firefox product backlog."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame." for="flag_type-913">sec-bounty-hof</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-913-dirty">
      <select id="flag_type-913" name="flag_type-913"
        title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-787">in-qa-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-787-dirty">
      <select id="flag_type-787" name="flag_type-787"
        title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>

      <td class="flag-requestee">
        <div id="requestee_type-787-container" style="display:none"><input
    name="requestee_type-787"
    value="" class="requestee bz_autocomplete_user"  id="requestee_type-787" 
  >
        </div>
      <td>

  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually" for="flag_type-864">qe-verify</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-864-dirty">
      <select id="flag_type-864" name="flag_type-864"
        title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually"
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr>
    </tbody>
  </table>
</div>
        </span>
    </div>

  
</div>
</div>

  
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-crash-data"
>
    <header id="module-crash-data-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Crash Data section"
           data-label-collapsed="Expand Crash Data section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-crash-data-content"
             aria-expanded="false"
             aria-labeledby="module-crash-data-title"
             aria-describedby="module-crash-data-subtitle"></div>
        <h2 class="module-title" id="module-crash-data-title">Crash Data</h2>
      </div>
    </header>
  <div class="module-content" id="module-crash-data-content" style="display:none"
  ><div class="field edit-show" id="field-cf_crash_signature" style="display:none"
>
    <div class="name">Signature:
    </div>


  
    <div class="value">
        <span id="field-value-cf_crash_signature">
        </span>
    </div>

  
</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-security"
>
    <header id="module-security-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Security section"
           data-label-collapsed="Expand Security section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-security-content"
             aria-expanded="false"
             aria-labeledby="module-security-title"
             aria-describedby="module-security-subtitle"></div>
        <h2 class="module-title" id="module-security-title">Security</h2>
          <h3 class="module-subtitle" id="module-security-subtitle">
            (public)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-security-content" style="display:none"
  ><div class="groups edit-hide">
    This bug is publicly visible.
</div>

<div class="groups edit-show" style="display:none">


</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-user-story" data-non-stick="1"
>
    <header id="module-user-story-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse User Story section"
           data-label-collapsed="Expand User Story section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-user-story-content"
             aria-expanded="false"
             aria-labeledby="module-user-story-title"
             aria-describedby="module-user-story-subtitle"></div>
        <h2 class="module-title" id="module-user-story-title">User Story</h2>
      </div>
    </header>
  <div class="module-content" id="module-user-story-content" style="display:none"
  >
    <pre id="user-story"></pre>
  </div>
</section>







<section class="module" id="module-attachments"
>
    <header id="module-attachments-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Attachments section"
           data-label-collapsed="Expand Attachments section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-attachments-content"
             aria-expanded="true"
             aria-labeledby="module-attachments-title"
             aria-describedby="module-attachments-subtitle"></div>
        <h2 class="module-title" id="module-attachments-title">Attachments</h2>
          <h3 class="module-subtitle" id="module-attachments-subtitle">
            (7 files, 10 obsolete files)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-attachments-content"
  ><table role="table" class="layout-table" id="attachments">
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8944629">csp_bypass_require.html</a>
        </div>
        <div>
            <a href="#c0" class="attach-time activity-ref"><span class="rel-time" title="2018-01-22 18:27 PST" data-time="1516674466">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_393170" ><a class="email " href="/user_profile?user_id=393170" > <span class="fna">Masato Kinugawa</span></a>
</div></span>
        </div>
        <div class="attach-info">407 bytes,
          text/html        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8944629&amp;action=edit">Details</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8945065">bug_1432358_apply_csp_to_resource_uri.patch</a>
        </div>
        <div>
            <a href="#c11" class="attach-time activity-ref"><span class="rel-time" title="2018-01-24 05:13 PST" data-time="1516799626">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_363267" ><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div></span>
        </div>
        <div class="attach-info">2.86 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8945065&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8945065&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1432358&attachment=8945065">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8945066">bug_1432358_test_resource_uri.patch</a>
        </div>
        <div>
            <a href="#c13" class="attach-time activity-ref"><span class="rel-time" title="2018-01-24 05:15 PST" data-time="1516799721">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_363267" ><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div></span>
        </div>
        <div class="attach-info">3.39 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8945066&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8945066&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1432358&attachment=8945066">Splinter Review</a>
    </tr>
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8945081">csp_bypass_require_chromeurl.html</a>
        </div>
        <div>
            <a href="#c19" class="attach-time activity-ref"><span class="rel-time" title="2018-01-24 06:33 PST" data-time="1516804391">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_393170" ><a class="email " href="/user_profile?user_id=393170" > <span class="fna">Masato Kinugawa</span></a>
</div></span>
        </div>
        <div class="attach-info">446 bytes,
          text/html        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8945081&amp;action=edit">Details</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8945177">bug_1432358_apply_csp_to_resource_uri.patch</a>
        </div>
        <div>
            <a href="#c22" class="attach-time activity-ref"><span class="rel-time" title="2018-01-24 11:50 PST" data-time="1516823416">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_363267" ><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div></span>
        </div>
        <div class="attach-info">2.82 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_159069" ><span class="fn">Gijs</span>
</div>:
              <a href="#c28"
                  class="flag-name-status rel-time-title activity-ref"
                  title="4 years ago"
              data-time="1516823416"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8945177&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8945177&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1432358&attachment=8945177">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8945178">bug_1432358_test_subjecttocsp.patch</a>
        </div>
        <div>
            <a href="#c24" class="attach-time activity-ref"><span class="rel-time" title="2018-01-24 11:52 PST" data-time="1516823560">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_363267" ><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div></span>
        </div>
        <div class="attach-info">4.44 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_159069" ><span class="fn">Gijs</span>
</div>:
              <a href="#c29"
                  class="flag-name-status rel-time-title activity-ref"
                  title="4 years ago"
              data-time="1516823560"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8945178&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8945178&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1432358&attachment=8945178">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8945420">bug_1432358_apply_csp_to_resource.patch</a>
        </div>
        <div>
            <a href="#c30" class="attach-time activity-ref"><span class="rel-time" title="2018-01-25 05:32 PST" data-time="1516887166">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_363267" ><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div></span>
        </div>
        <div class="attach-info">2.80 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_363267" ><span class="fn">ckerschb</span>
</div>:
              <a href="#c30"
                  class="flag-name-status rel-time-title activity-ref"
                  title="4 years ago"
              data-time="1516887166"
            >
              review+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_280903" ><span class="fn">abillings</span>
</div>:
              <a href="#a950109_280903"
                  class="flag-name-status rel-time-title activity-ref"
                  title="4 years ago"
              data-time="1517491344"
            >
              sec-approval+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8945420&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8945420&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1432358&attachment=8945420">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8945421">bug_1432358_test_subjecttocsp.patch</a>
        </div>
        <div>
            <a href="#c31" class="attach-time activity-ref"><span class="rel-time" title="2018-01-25 05:34 PST" data-time="1516887243">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_363267" ><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div></span>
        </div>
        <div class="attach-info">5.36 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_363267" ><span class="fn">ckerschb</span>
</div>:
              <a href="#c31"
                  class="flag-name-status rel-time-title activity-ref"
                  title="4 years ago"
              data-time="1516887243"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8945421&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8945421&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1432358&attachment=8945421">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8945444">bug_1432358_update_test_triggeringPrincipal.patch</a>
        </div>
        <div>
            <a href="#c32" class="attach-time activity-ref"><span class="rel-time" title="2018-01-25 06:58 PST" data-time="1516892300">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_363267" ><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div></span>
        </div>
        <div class="attach-info">1.66 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8945444&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8945444&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1432358&attachment=8945444">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8945483">bug_1432358_update_test_jsonview.patch</a>
        </div>
        <div>
            <a href="#c33" class="attach-time activity-ref"><span class="rel-time" title="2018-01-25 07:52 PST" data-time="1516895552">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_363267" ><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div></span>
        </div>
        <div class="attach-info">740 bytes,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_303767" ><span class="fn">Honza</span>
</div>:
              <a href="#c34"
                  class="flag-name-status rel-time-title activity-ref"
                  title="4 years ago"
              data-time="1516895552"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8945483&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8945483&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1432358&attachment=8945483">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8946410">bug_1432358_update_overridescsp.patch</a>
        </div>
        <div>
            <a href="#c41" class="attach-time activity-ref"><span class="rel-time" title="2018-01-29 13:19 PST" data-time="1517260756">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_363267" ><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div></span>
        </div>
        <div class="attach-info">1.98 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_106098" ><span class="fn">kmag</span>
</div>:
              <a href="#c42"
                  class="flag-name-status rel-time-title activity-ref"
                  title="4 years ago"
              data-time="1517260756"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8946410&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8946410&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1432358&attachment=8946410">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8947044">bug_1432358_allow_dropping_csp.patch</a>
        </div>
        <div>
            <a href="#c45" class="attach-time activity-ref"><span class="rel-time" title="2018-01-31 04:06 PST" data-time="1517400413">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_363267" ><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div></span>
        </div>
        <div class="attach-info">7.83 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8947044&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8947044&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1432358&attachment=8947044">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8947380">bug_1432358_channel_csp_agnostic.patch</a>
        </div>
        <div>
            <a href="#c51" class="attach-time activity-ref"><span class="rel-time" title="2018-02-01 01:06 PST" data-time="1517475965">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_363267" ><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div></span>
        </div>
        <div class="attach-info">15.06 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_39966" ><span class="fn">smaug</span>
</div>:
              <a href="#c52"
                  class="flag-name-status rel-time-title activity-ref"
                  title="4 years ago"
              data-time="1517475965"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8947380&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8947380&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1432358&attachment=8947380">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8947427">bug_1432358_update_overridescsp.patch</a>
        </div>
        <div>
            <a href="#c53" class="attach-time activity-ref"><span class="rel-time" title="2018-02-01 05:07 PST" data-time="1517490459">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_363267" ><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div></span>
        </div>
        <div class="attach-info">1.88 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_363267" ><span class="fn">ckerschb</span>
</div>:
              <a href="#a816038_363267"
                  class="flag-name-status rel-time-title activity-ref"
                  title="4 years ago"
              data-time="1517490504"
            >
              review+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_280903" ><span class="fn">abillings</span>
</div>:
              <a href="#a950137_280903"
                  class="flag-name-status rel-time-title activity-ref"
                  title="4 years ago"
              data-time="1517491386"
            >
              sec-approval+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8947427&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8947427&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1432358&attachment=8947427">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8947428">bug_1432358_channel_csp_agnostic.patch</a>
        </div>
        <div>
            <a href="#c54" class="attach-time activity-ref"><span class="rel-time" title="2018-02-01 05:08 PST" data-time="1517490490">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_363267" ><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div></span>
        </div>
        <div class="attach-info">15.06 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_363267" ><span class="fn">ckerschb</span>
</div>:
              <a href="#a816044_363267"
                  class="flag-name-status rel-time-title activity-ref"
                  title="4 years ago"
              data-time="1517490510"
            >
              review+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_280903" ><span class="fn">abillings</span>
</div>:
              <a href="#a950172_280903"
                  class="flag-name-status rel-time-title activity-ref"
                  title="4 years ago"
              data-time="1517491396"
            >
              sec-approval+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8947428&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8947428&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1432358&attachment=8947428">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8950155">bug_1432358_fix_xpcshell_test.patch</a>
        </div>
        <div>
            <a href="#c64" class="attach-time activity-ref"><span class="rel-time" title="2018-02-12 01:43 PST" data-time="1518428599">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_363267" ><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div></span>
        </div>
        <div class="attach-info">1.09 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_258347" ><span class="fn">aryx</span>
</div>:
              <a href="#a1756941_258347"
                  class="flag-name-status rel-time-title activity-ref"
                  title="4 years ago"
              data-time="1518428599"
            >
              review+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_363267" ><span class="fn">ckerschb</span>
</div>:
              <a href="#c65"
                  class="flag-name-status rel-time-title activity-ref"
                  title="4 years ago"
              data-time="1518441002"
            >
              sec-approval+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8950155&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8950155&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1432358&attachment=8950155">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8951547">bug_1432358_fix_xpcshell_test.patch</a>
        </div>
        <div>
            <a href="#c69" class="attach-time activity-ref"><span class="rel-time" title="2018-02-16 02:38 PST" data-time="1518777527">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_363267" ><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div></span>
        </div>
        <div class="attach-info">1.12 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_258347" ><span class="fn">aryx</span>
</div>:
              <a href="#a2116040_258347"
                  class="flag-name-status rel-time-title activity-ref"
                  title="4 years ago"
              data-time="1518777527"
            >
              review+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_363267" ><span class="fn">ckerschb</span>
</div>:
              <a href="#c70"
                  class="flag-name-status rel-time-title activity-ref"
                  title="4 years ago"
              data-time="1518953924"
            >
              sec-approval+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8951547&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8951547&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1432358&attachment=8951547">Splinter Review</a>
    </tr>
</table>

<footer id="attachments-footer">
  <div id="attachments-actions">
      <button type="button" id="attachments-obsolete-btn" class="secondary">Show Obsolete</button>
  </div>
  
</footer>
  </div>
</section>



<script nonce="VJPiFVc2HYE8aDxCbYx2bnuytxlkNg7vDW1VyLMxVaQ8e9EM">
  init_module_visibility();
</script>



<meta name="firefox-versions" content="{&quot;FIREFOX_AURORA&quot;:&quot;&quot;,&quot;FIREFOX_DEVEDITION&quot;:&quot;94.0b9&quot;,&quot;FIREFOX_ESR&quot;:&quot;78.15.0esr&quot;,&quot;FIREFOX_ESR_NEXT&quot;:&quot;91.2.0esr&quot;,&quot;FIREFOX_NIGHTLY&quot;:&quot;95.0a1&quot;,&quot;FIREFOX_PINEBUILD&quot;:&quot;&quot;,&quot;LAST_MERGE_DATE&quot;:&quot;2021-10-04&quot;,&quot;LAST_RELEASE_DATE&quot;:&quot;2021-10-05&quot;,&quot;LAST_SOFTFREEZE_DATE&quot;:&quot;2021-09-30&quot;,&quot;LATEST_FIREFOX_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_OLDER_VERSION&quot;:&quot;3.6.28&quot;,&quot;LATEST_FIREFOX_RELEASED_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_VERSION&quot;:&quot;93.0&quot;,&quot;NEXT_MERGE_DATE&quot;:&quot;2021-11-01&quot;,&quot;NEXT_RELEASE_DATE&quot;:&quot;2021-11-02&quot;,&quot;NEXT_SOFTFREEZE_DATE&quot;:&quot;2021-10-28&quot;}">


<div id="comment-actions">
    <button type="button" id="bottom-btn" class="secondary" aria-label="Go to Page Bottom">Bottom &darr;</button>
  <div class="dropdown">
    <button type="button" id="comment-tags-btn" aria-haspopup="true" aria-label="Tags"
      aria-expanded="false" aria-controls="comment-tags-menu" class="dropdown-button minor">Tags &#9662;</button>
    <ul id="comment-tags-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a role="menuitem" tabindex="-1" data-comment-tag="">Reset</a>
      </li>
    </ul>
  </div>
  <div class="dropdown">
    <button type="button" id="view-menu-btn" aria-haspopup="true" aria-label="Timeline"
      aria-expanded="false" aria-controls="view-menu" class="dropdown-button minor">Timeline &#9662;</button>
    <ul id="view-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a id="view-reset" role="menuitem" tabindex="-1">Reset</a>
      </li>
      <li role="separator"></li>
      <li role="presentation">
        <a id="view-collapse-all" role="menuitem" tabindex="-1">Collapse All</a>
      </li>
      <li role="presentation">
        <a id="view-expand-all" role="menuitem" tabindex="-1">Expand All</a>
      </li>
      <li role="presentation">
        <a id="view-comments-only" role="menuitem" tabindex="-1">Comments Only</a>
      </li>
    </ul>
   </div>
</div>
<div class="change-set" id="c0"><div class="comment" data-id="12987886" data-no="0"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-0" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_393170" ><img src="https://secure.gravatar.com/avatar/1a5bce24526a7d6f1ab89678df2d673c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_393170" ><a class="email " href="/user_profile?user_id=393170" > <span class="fna">Masato Kinugawa</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-0"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-0" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c0">Description</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-22 18:27 PST" data-time="1516674466">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-0">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8944629"
         class="attachment"
         data-id="8944629" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="csp_bypass_require.html">
      <meta itemprop="contentSize" content="407">
      <meta itemprop="encodingFormat" content="text/html">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=8944629" itemprop="contentUrl">
        <span id="att-8944629-description" itemprop="description">csp_bypass_require.html</span></a>
        — <a href="attachment.cgi?id=8944629&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-0" data-comment-id="12987886">User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:60.0) Gecko/20100101 Firefox/60.0
Build ID: 20180122220231

Steps to reproduce:

The URLs located in `resource://devtools-client-jsonview/.*` bypass CSP. ( maybe intentionally )
A `require.js` file is in the this directory and it can be used for CSP strict-dynamic bypass against any websites.

Steps to reproduce:
1. Go to attached PoC( csp_bypass_require.html ). This page has strict CSP rules:

&lt;meta http-equiv=&quot;Content-Security-Policy&quot; content=&quot;default-src 'none';script-src 'nonce-random' 'strict-dynamic'&quot;&gt;

2. However, you can see `alert(1)`. It is executed from the following code:

&lt;script data-main='data:,alert(1)'&gt;&lt;/script&gt;
&lt;script src=&quot;resource://devtools-client-jsonview/lib/require.js&quot;&gt;&lt;/script&gt;


Actual results:

CSP strict-dynamic is bypassed via browser resources.


Expected results:

CSP strict-dynamic should not be bypassed via browser resources.</pre></div><div class="change-set" id="a434_393170"><div class="change" id="aa434_393170">
    <table class="layout-table change-head reporter" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_393170" id="a434_393170"><img src="https://secure.gravatar.com/avatar/1a5bce24526a7d6f1ab89678df2d673c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_393170" id="a434_393170"><a class="email " href="/user_profile?user_id=393170" > <span class="fna">Masato Kinugawa</span></a>
</div>
            <span class="user-role">Reporter</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a434_393170"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a434_393170">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#a434_393170">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-22 18:35 PST" data-time="1516674900">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Summary: CSP strict-dynamic bypass via require.js &rarr; Universal CSP strict-dynamic bypass via require.js of browser resource</div></div></div><div class="change-set" id="c1"><div class="comment" data-id="12987947" data-no="1"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-1" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_393170" id="a434_393170"><img src="https://secure.gravatar.com/avatar/1a5bce24526a7d6f1ab89678df2d673c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_393170" id="a434_393170"><a class="email " href="/user_profile?user_id=393170" > <span class="fna">Masato Kinugawa</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-1"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-1" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c1">Comment 1</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-22 19:40 PST" data-time="1516678823">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-1">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-1" data-comment-id="12987947">FYI, the possibility of strict-dynamic bypass by `require.js` is already known.
You can find some CSP bypass variations including it from this research by Google: <a rel="nofollow" href="https://github.com/google/security-research-pocs/tree/master/script-gadgets">https://github.com/google/security-research-pocs/tree/master/script-gadgets</a></pre></div><div class="change-set" id="c2"><div class="comment" data-id="12988371" data-no="2"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-2" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a434_393170"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a434_393170"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-2"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-2" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c2">Comment 2</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-23 02:39 PST" data-time="1516703984">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-2">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-2" data-comment-id="12988371">Honza/Christoph, do you have ideas about where this should live / where/how we can address this? Thanks!</pre><div class="activity"><div class="change">Flags: needinfo?(odvarko)</div><div class="change">Flags: needinfo?(ckerschb)</div></div></div><div class="change-set" id="c3"><div class="comment" data-id="12988504" data-no="3"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-3" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a434_393170"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a434_393170"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-3"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-3" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c3">Comment 3</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-23 04:10 PST" data-time="1516709434">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-3">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-3" data-comment-id="12988504">FWIW, this whitelisting of resource URIs is happening here:
  <a rel="nofollow" href="https://dxr.mozilla.org/mozilla-central/source/dom/security/nsCSPService.cpp#88-97">https://dxr.mozilla.org/mozilla-central/source/dom/security/nsCSPService.cpp#88-97</a>

I think the bug should live in DOM:Security since it's a CSP bug, but I don't know what the best way of addressing this problem is. Ultimately browser internals should not be affected by a page's CSP. This case makes a unified behavior tricky however.

I am happy to implement the changes here, but I don't know what's the best strategy to accomplish.</pre><div class="activity"><div class="change">Group: firefox-core-security &rarr; core-security</div><div class="change">Component: Untriaged &rarr; DOM: Security</div><div class="change">Flags: <span class="activity-deleted">needinfo?(ckerschb)</span></div><div class="change">Product: Firefox &rarr; Core</div></div></div><div class="change-set" id="c4"><div class="comment" data-id="12988842" data-no="4"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-4" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_303767" id="a434_393170"><img src="https://secure.gravatar.com/avatar/34b251cf082c202fb3160b1afb810001?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_303767" id="a434_393170"><a class="email " href="/user_profile?user_id=303767" > <span class="fna">Jan Honza Odvarko [:Honza] (always need-info? me)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-4"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-4" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c4">Comment 4</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-23 06:55 PST" data-time="1516719325">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-4">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-4" data-comment-id="12988842">I don't have enough experience with CSP to help here.
Honza</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(odvarko)</span></div></div></div><div class="change-set" id="c5"><div class="comment" data-id="12989427" data-no="5"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-5" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a434_393170"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a434_393170"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-5"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-5" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c5">Comment 5</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-23 10:04 PST" data-time="1516730642">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-5">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-5" data-comment-id="12989427">I understand why we're loading the resource: url despite the CSP. Now that we don't support legacy extensions maybe we can stop doing that. But I don't understand how react.js executes the data-main if CSP is preventing inline script and eval. Does react know about strict-dynamic and dig up the nonce to create passable scripts?</pre><div class="activity"><div class="change">Assignee: nobody &rarr; ckerschb</div><div class="change">Group: core-security &rarr; dom-core-security</div><div class="change">Status: UNCONFIRMED &rarr; NEW</div><div class="change">Ever confirmed: true</div><div class="change">Keywords: <a href="/buglist.cgi?keywords=csectype-other&amp;resolution=---">csectype-other</a>, 
          
            <a href="/buglist.cgi?keywords=sec-high&amp;resolution=---">sec-high</a></div><div class="change">Priority: -- &rarr; P1</div></div></div><div class="change-set" id="c6"><div class="comment" data-id="12989434" data-no="6"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-6" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a434_393170"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a434_393170"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-6"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-6" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c6">Comment 6</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-23 10:05 PST" data-time="1516730758">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-6">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-6" data-comment-id="12989434">Not sure we should be exposing react to every web page. Can this resource be made non-accessible? I don't know if resource: supports that like chrome: and moz-extension:</pre></div><div class="change-set" id="c7"><div class="comment" data-id="12989444" data-no="7"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-7" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a434_393170"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a434_393170"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-7"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-7" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c7">Comment 7</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-23 10:09 PST" data-time="1516730970">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-7">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-7" data-comment-id="12989444">Sorry, &quot;require.js&quot;, not &quot;react&quot;. Thinking of the wrong library.</pre></div><div class="change-set" id="c8"><div class="comment" data-id="12989506" data-no="8"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-8" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_393170" id="a434_393170"><img src="https://secure.gravatar.com/avatar/1a5bce24526a7d6f1ab89678df2d673c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_393170" id="a434_393170"><a class="email " href="/user_profile?user_id=393170" > <span class="fna">Masato Kinugawa</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-8"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-8" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c8">Comment 8</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-23 10:31 PST" data-time="1516732319">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-8">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-8" data-comment-id="12989506">(In reply to Daniel Veditz [:dveditz] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Universal CSP strict-dynamic bypass via require.js of browser resource"
   href="/show_bug.cgi?id=1432358#c5">comment #5</a>)
<span class="quote">&gt;I don't understand how react.js executes the data-main if CSP is preventing inline script and eval.</span >
Basically require.js executes the following code using the data-main attribute:

script=document.createElement('script');
script.src='data:,alert(1)';
document.head.appendChild(script);

You can confirm this behavior by putting a break point here:
<a rel="nofollow" href="https://dxr.mozilla.org/mozilla-beta/source/devtools/client/jsonview/lib/require.js#1903">https://dxr.mozilla.org/mozilla-beta/source/devtools/client/jsonview/lib/require.js#1903</a>

A strict-dynamic does not block the script execution via non-&quot;parser-inserted&quot; script elements:
<a rel="nofollow" href="https://www.w3.org/TR/CSP3/#strict-dynamic-usage">https://www.w3.org/TR/CSP3/#strict-dynamic-usage</a>
<span class="quote">&gt;Script requests which are triggered by non-&quot;parser-inserted&quot; script elements are allowed.</span >

Due to this, it works.</pre></div><div class="change-set" id="c9"><div class="comment" data-id="12990112" data-no="9"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-9" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a434_393170"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a434_393170"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-9"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-9" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c9">Comment 9</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-23 13:57 PST" data-time="1516744664">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-9">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-9" data-comment-id="12990112">(In reply to Daniel Veditz [:dveditz] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Universal CSP strict-dynamic bypass via require.js of browser resource"
   href="/show_bug.cgi?id=1432358#c6">comment #6</a>)
<span class="quote">&gt; Can this resource be
&gt; made non-accessible? I don't know if resource: supports that like chrome:
&gt; and moz-extension:</span >

resource: in principle supports this (<a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - resource:// URIs leak information (Tor 8725)"
   href="/show_bug.cgi?id=863246">bug 863246</a>). But the JSON view executes in a content-privileged sandbox, and so I don't know if it would be possible to restrict its own script sources in this way. I would be somewhat surprised if so.

(In reply to Christoph Kerschbaumer [:ckerschb] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Universal CSP strict-dynamic bypass via require.js of browser resource"
   href="/show_bug.cgi?id=1432358#c3">comment #3</a>)
<span class="quote">&gt; FWIW, this whitelisting of resource URIs is happening here:
&gt;  
&gt; <a rel="nofollow" href="https://dxr.mozilla.org/mozilla-central/source/dom/security/nsCSPService">https://dxr.mozilla.org/mozilla-central/source/dom/security/nsCSPService</a>.
&gt; cpp#88-97</span >

Like Dan, I don't think I understand why this is necessary. Why can't we just make resource: URIs obey CSP?

<span class="quote">&gt; Ultimately browser internals should not be affected by a page's CSP.</span >

I agree, but certainly for the JSON viewer, the viewer has control over the relevant CSP headers because it munges the request, AIUI. Presumably it could set different headers, ie here: <a rel="nofollow" href="https://dxr.mozilla.org/mozilla-central/rev/c4ebc8c28a33b785dfbfa533810517cc707d1ad0/devtools/client/jsonview/converter-child.js#79">https://dxr.mozilla.org/mozilla-central/rev/c4ebc8c28a33b785dfbfa533810517cc707d1ad0/devtools/client/jsonview/converter-child.js#79</a> ? Christoph, would that work? Why do we specialcase resource: at all?</pre><div class="activity"><div class="change">Flags: needinfo?(ckerschb)</div></div></div><div class="change-set" id="c10"><div class="comment" data-id="12990856" data-no="10"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-10" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a434_393170"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a434_393170"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-10"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-10" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c10">Comment 10</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-23 22:58 PST" data-time="1516777128">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-10">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-10" data-comment-id="12990856">(In reply to :Gijs (lower availability until Jan 27) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Universal CSP strict-dynamic bypass via require.js of browser resource"
   href="/show_bug.cgi?id=1432358#c9">comment #9</a>)
<span class="quote">&gt; Like Dan, I don't think I understand why this is necessary. Why can't we
&gt; just make resource: URIs obey CSP?</span >

That decision predates my time at Mozilla. I vaguely remember when we rewrote CSP in C++ (formerly our implementation was based on JS) we already whitelisted resource URIs, I guess mostly because of extensions. Unfortunately I couldn't dig out the exact bug, only the one that introduces subjectToCSP(), but even that bug didn't change that exclusion of resource: loads for CSP [1].

Anyway, I agree with both of you, probably we don't have to specialcase resource URIs now that we don't support legacy extensions anymore. Let's see how TRY likes that and we can take it from there:
  <a rel="nofollow" href="https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=7ef53f8052af82b2abc53de2ddcbe59969e92c4b">https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=7ef53f8052af82b2abc53de2ddcbe59969e92c4b</a>


[1] <a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/80b2348e3ab6#l1.109">https://hg.mozilla.org/integration/mozilla-inbound/rev/80b2348e3ab6#l1.109</a></pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(ckerschb)</span></div></div></div><div class="change-set" id="c11"><div class="comment" data-id="12991307" data-no="11"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-11" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a434_393170"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a434_393170"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-11"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-11" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c11">Comment 11</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-24 05:13 PST" data-time="1516799626">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-11">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8945065"
         class="attachment patch obsolete"
         data-id="8945065" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug_1432358_apply_csp_to_resource_uri.patch">
      <meta itemprop="contentSize" content="2926">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8945065">
          <a class="link" href="attachment.cgi?id=8945065&amp;action=diff">
        <span id="att-8945065-description" itemprop="description">bug_1432358_apply_csp_to_resource_uri.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8945065&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1432358&attachment=8945065">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-11" data-comment-id="12991307">Given the TRY run and our reasoning I think we can change subjectToCSP() to include resource URIs. It seems the only test affected is browser_jsonview_csp_json.js within devtools - I am not sure if this change of making resource URIs subject to CSP will affect more things within devtools.

Honza, any insights? Also we would have to fix browser_jsonview_csp_json.js, any suggestions how to accomplish that?

Would it make sense to land the change but also add a pref around it, in case we have to revert the change for any reason?</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8945065&amp;action=edit"
           title="bug_1432358_apply_csp_to_resource_uri.patch"
           class=""
        >Attachment #8945065</a> -
        Flags: review?(gijskruitbosch+bugs)</div></div></div><div class="change-set" id="c12"><div class="comment" data-id="12991309" data-no="12"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-12" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a434_393170"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a434_393170"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-12"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-12" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c12">Comment 12</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-24 05:14 PST" data-time="1516799657">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-12">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-12" data-comment-id="12991309">Honza, please have a look at <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Universal CSP strict-dynamic bypass via require.js of browser resource"
   href="/show_bug.cgi?id=1432358#c11">comment 11</a> - thanks!</pre><div class="activity"><div class="change">Flags: needinfo?(odvarko)</div></div></div><div class="change-set" id="c13"><div class="comment" data-id="12991312" data-no="13"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-13" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a434_393170"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a434_393170"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-13"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-13" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c13">Comment 13</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-24 05:15 PST" data-time="1516799721">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-13">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8945066"
         class="attachment patch obsolete"
         data-id="8945066" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug_1432358_test_resource_uri.patch">
      <meta itemprop="contentSize" content="3468">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8945066">
          <a class="link" href="attachment.cgi?id=8945066&amp;action=diff">
        <span id="att-8945066-description" itemprop="description">bug_1432358_test_resource_uri.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8945066&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1432358&attachment=8945066">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-13" data-comment-id="12991312">And here is the automated test!</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8945066&amp;action=edit"
           title="bug_1432358_test_resource_uri.patch"
           class=""
        >Attachment #8945066</a> -
        Flags: review?(gijskruitbosch+bugs)</div></div></div><div class="change-set" id="c14"><div class="comment" data-id="12991330" data-no="14"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-14" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a434_393170"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a434_393170"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-14"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-14" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c14">Comment 14</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-24 05:27 PST" data-time="1516800434">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-14">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-14" data-comment-id="12991330">Just chatted with Patrick on IRC and it seems that most likely that change of having CSP apply to resource: URIs will affect devtools a whole lot. Also given browser_jsonview_csp_json.js. Exactly what we are trying to prevent, devtools code relies on. E.g. the error on the console for browser_jsonview_csp_json.js is:

Content Security Policy: The page’s settings blocked the loading of a resource at resource://devtools-client-jsonview/css/main.css (“default-src”). 
Content Security Policy: The page’s settings blocked the loading of a resource at resource://devtools-client-jsonview/lib/require.js (“default-src”)</pre></div><div class="change-set" id="c15"><div class="comment" data-id="12991335" data-no="15"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-15" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a434_393170"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a434_393170"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-15"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-15" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c15">Comment 15</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-24 05:29 PST" data-time="1516800583">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-15">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-15" data-comment-id="12991335">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8945065" name="attach_8945065" title="bug_1432358_apply_csp_to_resource_uri.patch">attachment 8945065</a> <a href="/attachment.cgi?id=8945065&amp;action=edit" title="bug_1432358_apply_csp_to_resource_uri.patch">[details]</a> <a href="/attachment.cgi?id=8945065&amp;action=diff" title="bug_1432358_apply_csp_to_resource_uri.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1432358&amp;attachment=8945065'>[review]</a>
bug_1432358_apply_csp_to_resource_uri.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8945065" name="attach_8945065" title="bug_1432358_apply_csp_to_resource_uri.patch">attachment 8945065</a> <a href="/attachment.cgi?id=8945065&amp;action=edit" title="bug_1432358_apply_csp_to_resource_uri.patch">[details]</a> <a href="/attachment.cgi?id=8945065&amp;action=diff" title="bug_1432358_apply_csp_to_resource_uri.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1432358&amp;attachment=8945065'>[review]</a>:
-----------------------------------------------------------------

So, luckily, as far as I can tell this require.js file isn't accessible via chrome:// , for one because it's not packaged / in the same location as the chrome:// stuff, and also because chrome://devtools isn't contentaccessible . But that seems a fragile thing to rely on. Why do we need to have any exceptions here? Does more stuff break if chrome:// is subject to CSP? I guess I kind of assume that things that run in content frame scripts and so on have chrome privileges and already don't encounter CSP, irrespective of the URIs of their respective resources, and I can think of no cases where we directly intend to inject chrome:// URI stuff into web content (that is subject to CSP).

::: dom/security/nsCSPService.cpp
&#64;&#64; +57,2 &#64;&#64;
<span class="quote">&gt;    // protocol flag (URI_IS_LOCAL_RESOURCE) with other protocols, like
&gt; +  // chrome: and  moz-icon:, but those protocols are subject to CSP,</span >

I don't really know why we shouldn't make chrome and moz-icon subject to CSP, too...

&#64;&#64; +89,5 &#64;&#64;
<span class="quote">&gt;    }
&gt;  
&gt;    // Other protocols are not subject to CSP and can be whitelisted:
&gt;    // * URI_IS_LOCAL_RESOURCE
&gt; +  //   e.g. chrome:, data:, blob:, moz-icon:</span >

Looks like data: and blob: also want removing from this list.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8945065&amp;action=edit"
           title="bug_1432358_apply_csp_to_resource_uri.patch"
           class=""
        >Attachment #8945065</a> -
        Flags: <span class="activity-deleted">review?(gijskruitbosch+bugs)</span></div></div></div><div class="change-set" id="c16"><div class="comment" data-id="12991339" data-no="16"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-16" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a434_393170"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a434_393170"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-16"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-16" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c16">Comment 16</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-24 05:31 PST" data-time="1516800662">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-16">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-16" data-comment-id="12991339">(In reply to Christoph Kerschbaumer [:ckerschb] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Universal CSP strict-dynamic bypass via require.js of browser resource"
   href="/show_bug.cgi?id=1432358#c14">comment #14</a>)
<span class="quote">&gt; Just chatted with Patrick on IRC and it seems that most likely that change
&gt; of having CSP apply to resource: URIs will affect devtools a whole lot. Also
&gt; given browser_jsonview_csp_json.js. Exactly what we are trying to prevent,
&gt; devtools code relies on. E.g. the error on the console for
&gt; browser_jsonview_csp_json.js is:
&gt; 
&gt; Content Security Policy: The page’s settings blocked the loading of a
&gt; resource at resource://devtools-client-jsonview/css/main.css
&gt; (“default-src”). 
&gt; Content Security Policy: The page’s settings blocked the loading of a
&gt; resource at resource://devtools-client-jsonview/lib/require.js
&gt; (“default-src”)</span >

Yes. My suggestion (poorly expressed) in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Universal CSP strict-dynamic bypass via require.js of browser resource"
   href="/show_bug.cgi?id=1432358#c9">comment #9</a>, is that we alter the CSP header / data when invoking the JSON viewer, and make specific exceptions for the sources we need in addition to whatever the contents of the CSP are at that point.</pre></div><div class="change-set" id="c17"><div class="comment" data-id="12991355" data-no="17"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-17" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a434_393170"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a434_393170"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-17"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-17" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c17">Comment 17</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-24 05:38 PST" data-time="1516801103">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-17">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-17" data-comment-id="12991355">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8945066" name="attach_8945066" title="bug_1432358_test_resource_uri.patch">attachment 8945066</a> <a href="/attachment.cgi?id=8945066&amp;action=edit" title="bug_1432358_test_resource_uri.patch">[details]</a> <a href="/attachment.cgi?id=8945066&amp;action=diff" title="bug_1432358_test_resource_uri.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1432358&amp;attachment=8945066'>[review]</a>
bug_1432358_test_resource_uri.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8945066" name="attach_8945066" title="bug_1432358_test_resource_uri.patch">attachment 8945066</a> <a href="/attachment.cgi?id=8945066&amp;action=edit" title="bug_1432358_test_resource_uri.patch">[details]</a> <a href="/attachment.cgi?id=8945066&amp;action=diff" title="bug_1432358_test_resource_uri.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1432358&amp;attachment=8945066'>[review]</a>:
-----------------------------------------------------------------

::: dom/security/test/csp/file_resource_url.html
&#64;&#64; +12,5 &#64;&#64;
<span class="quote">&gt; +&lt;script&gt;document.getElementById(&quot;regScriptDiv&quot;).textContent=&quot;allowed&quot;;&lt;/script&gt;
&gt; +
&gt; +&lt;!-- resource URL test --&gt;
&gt; +&lt;script data-main='data:,document.getElementById(&quot;resourceScriptDiv&quot;).textContent=&quot;allowed;&quot;'&gt;&lt;/script&gt;
&gt; +&lt;script src=&quot;resource://devtools-client-jsonview/lib/require.js&quot;&gt;&lt;/script&gt;</span >

I think we shouldn't make this dom/ test rely on the contents of a devtools bit of code.

We should make the test create its own resource: mapping dynamically (at runtime) using setSubstitutionWithFlags on the protocol handler (making sure to make the relevant resource: thing contentaccessible) and then attempt to access that from the file we load.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8945066&amp;action=edit"
           title="bug_1432358_test_resource_uri.patch"
           class=""
        >Attachment #8945066</a> -
        Flags: <span class="activity-deleted">review?(gijskruitbosch+bugs)</span></div></div></div><div class="change-set" id="c18"><div class="comment" data-id="12991356" data-no="18"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-18" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a434_393170"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a434_393170"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-18"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-18" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c18">Comment 18</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-24 05:38 PST" data-time="1516801134">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-18">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-18" data-comment-id="12991356">(In reply to :Gijs (lower availability until Jan 27) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Universal CSP strict-dynamic bypass via require.js of browser resource"
   href="/show_bug.cgi?id=1432358#c15">comment #15</a>)
<span class="quote">&gt;  Why do we need to have any
&gt; exceptions here? Does more stuff break if chrome:// is subject to CSP? I
&gt; guess I kind of assume that things that run in content frame scripts and so
&gt; on have chrome privileges and already don't encounter CSP, irrespective of
&gt; the URIs of their respective resources, and I can think of no cases where we
&gt; directly intend to inject chrome:// URI stuff into web content (that is
&gt; subject to CSP).</span >

That seems like a fair assumption. Nothing that executes with system privileges is subject to CSP, so I think it makes sense what you are suggesting and we can also make chrome: and moz-icon subject to CSP.</pre></div><div class="change-set" id="c19"><div class="comment" data-id="12991501" data-no="19"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-19" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_393170" id="a434_393170"><img src="https://secure.gravatar.com/avatar/1a5bce24526a7d6f1ab89678df2d673c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_393170" id="a434_393170"><a class="email " href="/user_profile?user_id=393170" > <span class="fna">Masato Kinugawa</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-19"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-19" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c19">Comment 19</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-24 06:33 PST" data-time="1516804391">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-19">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8945081"
         class="attachment"
         data-id="8945081" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="csp_bypass_require_chromeurl.html">
      <meta itemprop="contentSize" content="446">
      <meta itemprop="encodingFormat" content="text/html">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=8945081" itemprop="contentUrl">
        <span id="att-8945081-description" itemprop="description">csp_bypass_require_chromeurl.html</span></a>
        — <a href="attachment.cgi?id=8945081&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-19" data-comment-id="12991501">(In reply to :Gijs (lower availability until Jan 27) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Universal CSP strict-dynamic bypass via require.js of browser resource"
   href="/show_bug.cgi?id=1432358#c15">comment #15</a>)
<span class="quote">&gt;So, luckily, as far as I can tell this require.js file isn't accessible via chrome:// </span >
I noticed require.js can be fetched via chrome:// URL also.
We can access from: chrome://browser/content//chrome/devtools/modules/devtools/client/jsonview/lib/require.js
Please take notice to the two slashes of &quot;content//chrome&quot;. I think this is an another issue which allows path traversal.</pre></div><div class="change-set" id="c20"><div class="comment" data-id="12991517" data-no="20"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-20" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a434_393170"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a434_393170"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-20"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-20" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c20">Comment 20</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-24 06:37 PST" data-time="1516804650">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-20">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-20" data-comment-id="12991517">(In reply to Masato Kinugawa from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Universal CSP strict-dynamic bypass via require.js of browser resource"
   href="/show_bug.cgi?id=1432358#c19">comment #19</a>)
<span class="quote">&gt; Created <span class=""><a href="/attachment.cgi?id=8945081" name="attach_8945081" title="csp_bypass_require_chromeurl.html">attachment 8945081</a> <a href="/attachment.cgi?id=8945081&amp;action=edit" title="csp_bypass_require_chromeurl.html">[details]</a></span>
&gt; csp_bypass_require_chromeurl.html
&gt; 
&gt; (In reply to :Gijs (lower availability until Jan 27) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Universal CSP strict-dynamic bypass via require.js of browser resource"
   href="/show_bug.cgi?id=1432358#c15">comment #15</a>)
&gt; &gt;So, luckily, as far as I can tell this require.js file isn't accessible via chrome:// 
&gt; I noticed require.js can be fetched via chrome:// URL also.
&gt; We can access from:
&gt; chrome://browser/content//chrome/devtools/modules/devtools/client/jsonview/
&gt; lib/require.js
&gt; Please take notice to the two slashes of &quot;content//chrome&quot;. I think this is
&gt; an another issue which allows path traversal.</span >

Please file a separate bug for this.</pre><div class="activity"><div class="change">Flags: needinfo?(masatokinugawa)</div></div></div><div class="change-set" id="c21"><div class="comment" data-id="12992276" data-no="21"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-21" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_393170" id="a434_393170"><img src="https://secure.gravatar.com/avatar/1a5bce24526a7d6f1ab89678df2d673c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_393170" id="a434_393170"><a class="email " href="/user_profile?user_id=393170" > <span class="fna">Masato Kinugawa</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-21"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-21" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c21">Comment 21</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-24 10:47 PST" data-time="1516819621">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-21">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-21" data-comment-id="12992276">(In reply to :Gijs (lower availability until Jan 27) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Universal CSP strict-dynamic bypass via require.js of browser resource"
   href="/show_bug.cgi?id=1432358#c20">comment #20</a>)
<span class="quote">&gt; Please file a separate bug for this.</span >
Filed as <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Path traversal on chrome:// URLs"
   href="/show_bug.cgi?id=1432870">bug 1432870</a>.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(masatokinugawa)</span></div></div></div><div class="change-set" id="c22"><div class="comment" data-id="12992430" data-no="22"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-22" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a434_393170"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a434_393170"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-22"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-22" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c22">Comment 22</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-24 11:50 PST" data-time="1516823416">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-22">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8945177"
         class="attachment patch obsolete"
         data-id="8945177" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug_1432358_apply_csp_to_resource_uri.patch">
      <meta itemprop="contentSize" content="2885">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8945177">
          <a class="link" href="attachment.cgi?id=8945177&amp;action=diff">
        <span id="att-8945177-description" itemprop="description">bug_1432358_apply_csp_to_resource_uri.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8945177&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1432358&attachment=8945177">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-22" data-comment-id="12992430">Gijs, as agreed we should also have subjectToCSP apply to chrome: URIs in addition to resource URIs. Try seems happy overall [1], there are only two issues:
* test_ext_contentscript_triggeringPrincipal.js
* browser_jsonview_csp_json.js

Once you are fine with the patch here I will follow up with devtools folks to get those issues resolved.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8945065&amp;action=edit"
           title="bug_1432358_apply_csp_to_resource_uri.patch"
           class=""
        >Attachment #8945065</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8945177&amp;action=edit"
           title="bug_1432358_apply_csp_to_resource_uri.patch"
           class=""
        >Attachment #8945177</a> -
        Flags: review?(gijskruitbosch+bugs)</div></div></div><div class="change-set" id="c23"><div class="comment" data-id="12992432" data-no="23"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-23" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a434_393170"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a434_393170"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-23"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-23" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c23">Comment 23</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-24 11:51 PST" data-time="1516823466">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-23">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-23" data-comment-id="12992432">Oh, I forgot, here is the TRY run for <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Universal CSP strict-dynamic bypass via require.js of browser resource"
   href="/show_bug.cgi?id=1432358#c22">comment 22</a>:
[1] <a rel="nofollow" href="https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=c2182293c22c9ea9634ff9b0c9c376fe8a940161&amp;selectedJob=158207724">https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=c2182293c22c9ea9634ff9b0c9c376fe8a940161&amp;selectedJob=158207724</a></pre></div><div class="change-set" id="c24"><div class="comment" data-id="12992437" data-no="24"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-24" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a434_393170"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a434_393170"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-24"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-24" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c24">Comment 24</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-24 11:52 PST" data-time="1516823560">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-24">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8945178"
         class="attachment patch obsolete"
         data-id="8945178" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug_1432358_test_subjecttocsp.patch">
      <meta itemprop="contentSize" content="4544">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8945178">
          <a class="link" href="attachment.cgi?id=8945178&amp;action=diff">
        <span id="att-8945178-description" itemprop="description">bug_1432358_test_subjecttocsp.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8945178&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1432358&attachment=8945178">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-24" data-comment-id="12992437">And here is the automated test where we register a resource URI. Intially I wanted to capture the precise bypass, hence the initial test was based on require.js. Anyway, this test is self contained now and registers it's own chrome URI.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8945066&amp;action=edit"
           title="bug_1432358_test_resource_uri.patch"
           class=""
        >Attachment #8945066</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8945178&amp;action=edit"
           title="bug_1432358_test_subjecttocsp.patch"
           class=""
        >Attachment #8945178</a> -
        Flags: review?(gijskruitbosch+bugs)</div></div></div><div class="change-set" id="c25"><div class="comment" data-id="12992816" data-no="25"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-25" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a434_393170"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a434_393170"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-25"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-25" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c25">Comment 25</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-24 14:06 PST" data-time="1516831603">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-25">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-25" data-comment-id="12992816">Bit busy tonight, but from a quick look at the patch, why can't we just return true for all URIs with URI_IS_LOCAL_RESOURCE, rather than enumerating all the sub-cases here? Does that not cover chrome: or some other URI schemes?

That is, prior to the patch, the state was:

// some local URI schemes bad:
if (scheme == &quot;foo&quot;) {
  return true;
}
if (scheme == &quot;bar&quot;) {
  return true;
}

// all other local schemes good:
if (uri.hasFlag(local)) {
  return false;
}

Which URI schemes do we actually still need to treat as &quot;good&quot; here? Can't we just flip the default to &quot;all local URI schemes participate in CSP&quot;, and only make exceptions for schemes with this flag that really really don't (maybe file: which I don't currently see mentioned but presumably has this flag?) ? [Though I also don't know why file: doesn't participate in CSP, but that's a question for another bug...)</pre><div class="activity"><div class="change">Flags: needinfo?(ckerschb)</div></div></div><div class="change-set" id="c26"><div class="comment" data-id="12994010" data-no="26"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-26" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a434_393170"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a434_393170"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-26"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-26" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c26">Comment 26</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-25 02:00 PST" data-time="1516874428">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-26">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-26" data-comment-id="12994010">(In reply to :Gijs (lower availability until Jan 27) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Universal CSP strict-dynamic bypass via require.js of browser resource"
   href="/show_bug.cgi?id=1432358#c25">comment #25</a>)
<span class="quote">&gt; Bit busy tonight, but from a quick look at the patch, why can't we just
&gt; return true for all URIs with URI_IS_LOCAL_RESOURCE, rather than enumerating
&gt; all the sub-cases here?</span >

Potentially we can, but I am not sure if we should do that within this bug (which most likely will be uplifted) or rather file a follow up to make sure that assumption is not breaking anything else. I think the important part here is that resource and chrome become subject to CSP, right?

One of my question is, can anyone still register it's own ProtocolHandler besides Firefox itself these days given that legacy extensions are gone? If not, then the follow up will become a little easier. What do you think?</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(ckerschb)</span></div></div></div><div class="change-set" id="a199971_363267"><div class="change" id="aa199971_363267">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a199971_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_363267" id="a199971_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a199971_363267"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a199971_363267">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#a199971_363267">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-25 02:00 PST" data-time="1516874437">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Status: NEW &rarr; ASSIGNED</div></div></div><div class="change-set" id="c27"><div class="comment" data-id="12994332" data-no="27"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-27" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a199971_363267"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a199971_363267"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-27"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-27" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c27">Comment 27</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-25 05:04 PST" data-time="1516885458">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-27">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-27" data-comment-id="12994332">(In reply to Christoph Kerschbaumer [:ckerschb] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Universal CSP strict-dynamic bypass via require.js of browser resource"
   href="/show_bug.cgi?id=1432358#c26">comment #26</a>)
<span class="quote">&gt; One of my question is, can anyone still register it's own ProtocolHandler
&gt; besides Firefox itself these days given that legacy extensions are gone?</span >

No. Only web-based registerProtocolHandler, which shouldn't ever get URI_IS_LOCAL_RESOURCE.

<span class="quote">&gt; If not, then the follow up will become a little easier. What do you think?</span >

Yep, but it's also OK to do this in a separate bug as you suggested, if that's easier.</pre></div><div class="change-set" id="c28"><div class="comment" data-id="12994338" data-no="28"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-28" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a199971_363267"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a199971_363267"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-28"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-28" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c28">Comment 28</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-25 05:06 PST" data-time="1516885600">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-28">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-28" data-comment-id="12994338">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8945177" name="attach_8945177" title="bug_1432358_apply_csp_to_resource_uri.patch">attachment 8945177</a> <a href="/attachment.cgi?id=8945177&amp;action=edit" title="bug_1432358_apply_csp_to_resource_uri.patch">[details]</a> <a href="/attachment.cgi?id=8945177&amp;action=diff" title="bug_1432358_apply_csp_to_resource_uri.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1432358&amp;attachment=8945177'>[review]</a>
bug_1432358_apply_csp_to_resource_uri.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8945177" name="attach_8945177" title="bug_1432358_apply_csp_to_resource_uri.patch">attachment 8945177</a> <a href="/attachment.cgi?id=8945177&amp;action=edit" title="bug_1432358_apply_csp_to_resource_uri.patch">[details]</a> <a href="/attachment.cgi?id=8945177&amp;action=diff" title="bug_1432358_apply_csp_to_resource_uri.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1432358&amp;attachment=8945177'>[review]</a>:
-----------------------------------------------------------------

::: dom/security/nsCSPService.cpp
&#64;&#64; +61,2 &#64;&#64;
<span class="quote">&gt;    // <a rel="nofollow" href="http://www.w3.org/TR/CSP2/#source-list-guid-matching">http://www.w3.org/TR/CSP2/#source-list-guid-matching</a>
&gt; +  </span >

Nit: whitespace

&#64;&#64; +101,5 &#64;&#64;
<span class="quote">&gt; +  }
&gt; +  rv = aURI-&gt;SchemeIs(&quot;moz-icon&quot;, &amp;match);
&gt; +  if (NS_SUCCEEDED(rv) &amp;&amp; match) {
&gt; +    return true;
&gt; +  }</span >

I wonder if, given the number of scheme comparisons here, this would be better written by just getting the scheme and using EqualsLiteral. Anyway, this is certainly OK for fixing this bug if you prefer not rewriting this method that drastically.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8945177&amp;action=edit"
           title="bug_1432358_apply_csp_to_resource_uri.patch"
           class=""
        >Attachment #8945177</a> -
        Flags: review?(gijskruitbosch+bugs) &rarr; review+</div></div></div><div class="change-set" id="c29"><div class="comment" data-id="12994339" data-no="29"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-29" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a199971_363267"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a199971_363267"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-29"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-29" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c29">Comment 29</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-25 05:08 PST" data-time="1516885723">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-29">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-29" data-comment-id="12994339">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8945178" name="attach_8945178" title="bug_1432358_test_subjecttocsp.patch">attachment 8945178</a> <a href="/attachment.cgi?id=8945178&amp;action=edit" title="bug_1432358_test_subjecttocsp.patch">[details]</a> <a href="/attachment.cgi?id=8945178&amp;action=diff" title="bug_1432358_test_subjecttocsp.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1432358&amp;attachment=8945178'>[review]</a>
bug_1432358_test_subjecttocsp.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8945178" name="attach_8945178" title="bug_1432358_test_subjecttocsp.patch">attachment 8945178</a> <a href="/attachment.cgi?id=8945178&amp;action=edit" title="bug_1432358_test_subjecttocsp.patch">[details]</a> <a href="/attachment.cgi?id=8945178&amp;action=diff" title="bug_1432358_test_subjecttocsp.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1432358&amp;attachment=8945178'>[review]</a>:
-----------------------------------------------------------------

::: dom/security/test/csp/test_resource_uri.html
&#64;&#64; +33,5 &#64;&#64;
<span class="quote">&gt; +    // html file does apply meta CSP of:
&gt; +    // default-src 'none'; script-src 'nonce-random' 'strict-dynamic'
&gt; +    file: &quot;file_resource_uri.html&quot;,
&gt; +    result: &quot;blocked&quot;,
&gt; +    description: &quot;resource: URI should be blocked by CSP&quot;,</span >

Should we have a third test that we can allow the resource again if the full URI is included in the list of script-src's in the CSP?

&#64;&#64; +42,5 &#64;&#64;
<span class="quote">&gt; +  resourceHandler.setSubstitution(&quot;csptest&quot;, null);
&gt; +  SimpleTest.finish();
&gt; +}
&gt; +
&gt; +function ckeckResult() {</span >

Should be 'checkResult', I think.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8945178&amp;action=edit"
           title="bug_1432358_test_subjecttocsp.patch"
           class=""
        >Attachment #8945178</a> -
        Flags: review?(gijskruitbosch+bugs) &rarr; review+</div></div></div><div class="change-set" id="c30"><div class="comment" data-id="12994377" data-no="30"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-30" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a199971_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a199971_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-30"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-30" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c30">Comment 30</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-25 05:32 PST" data-time="1516887166">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-30">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8945420"
         class="attachment patch"
         data-id="8945420" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug_1432358_apply_csp_to_resource.patch">
      <meta itemprop="contentSize" content="2863">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8945420">
          <a class="link" href="attachment.cgi?id=8945420&amp;action=diff">
        <span id="att-8945420-description" itemprop="description">bug_1432358_apply_csp_to_resource.patch</span></a>
        — <a href="attachment.cgi?id=8945420&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1432358&attachment=8945420">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-30" data-comment-id="12994377">[Carrying over r+ from Gijs]

(In reply to :Gijs (lower availability until Jan 27) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Universal CSP strict-dynamic bypass via require.js of browser resource"
   href="/show_bug.cgi?id=1432358#c28">comment #28</a>)
<span class="quote">&gt; I wonder if, given the number of scheme comparisons here, this would be
&gt; better written by just getting the scheme and using EqualsLiteral. Anyway,
&gt; this is certainly OK for fixing this bug if you prefer not rewriting this
&gt; method that drastically.</span >

I think that makes sense and I have considered that as well. As agreed we can clean that entire function up in a follow up bug.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8945177&amp;action=edit"
           title="bug_1432358_apply_csp_to_resource_uri.patch"
           class=""
        >Attachment #8945177</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8945420&amp;action=edit"
           title="bug_1432358_apply_csp_to_resource.patch"
           class=""
        >Attachment #8945420</a> -
        Flags: review+</div></div></div><div class="change-set" id="c31"><div class="comment" data-id="12994378" data-no="31"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-31" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a199971_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a199971_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-31"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-31" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c31">Comment 31</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-25 05:34 PST" data-time="1516887243">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-31">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8945421"
         class="attachment patch"
         data-id="8945421" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug_1432358_test_subjecttocsp.patch">
      <meta itemprop="contentSize" content="5489">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8945421">
          <a class="link" href="attachment.cgi?id=8945421&amp;action=diff">
        <span id="att-8945421-description" itemprop="description">bug_1432358_test_subjecttocsp.patch</span></a>
        — <a href="attachment.cgi?id=8945421&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1432358&attachment=8945421">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-31" data-comment-id="12994378">[Carrying over r+ from Gijs]

(In reply to :Gijs (lower availability until Jan 27) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Universal CSP strict-dynamic bypass via require.js of browser resource"
   href="/show_bug.cgi?id=1432358#c29">comment #29</a>)
<span class="quote">&gt; Should we have a third test that we can allow the resource again if the full
&gt; URI is included in the list of script-src's in the CSP?</span >

I like that suggestion, thanks. I have incorporated such a test within this patch.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8945178&amp;action=edit"
           title="bug_1432358_test_subjecttocsp.patch"
           class=""
        >Attachment #8945178</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8945421&amp;action=edit"
           title="bug_1432358_test_subjecttocsp.patch"
           class=""
        >Attachment #8945421</a> -
        Flags: review+</div></div></div><div class="change-set" id="c32"><div class="comment" data-id="12994555" data-no="32"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-32" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a199971_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a199971_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-32"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-32" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c32">Comment 32</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-25 06:58 PST" data-time="1516892300">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-32">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8945444"
         class="attachment patch obsolete"
         data-id="8945444" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug_1432358_update_test_triggeringPrincipal.patch">
      <meta itemprop="contentSize" content="1697">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8945444">
          <a class="link" href="attachment.cgi?id=8945444&amp;action=diff">
        <span id="att-8945444-description" itemprop="description">bug_1432358_update_test_triggeringPrincipal.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8945444&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1432358&attachment=8945444">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-32" data-comment-id="12994555">Hey Kris, within this bug we are changing the behavior of CSP and make CSP apply to chrome: and resource: URIs as well. In turn this change causes test test_ext_contentscript_triggeringPrincipal.js. The test applies default-src 'none' which with the patches from this bug applied causes the file chrome://global/content/bindings/scrollbar.xml to be blocked within your test.

I don't know if this change might have bigger implications than just fixing the test, so I am relying on your input. Anyway, the *.xml file loads uses the internal load type of TYPE_XBL which is governed by default-src within CSP. Whitelisting chrome: within default-src fixes the test.

Am I missing something or is it fine to just update the test?</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8945444&amp;action=edit"
           title="bug_1432358_update_test_triggeringPrincipal.patch"
           class=""
        >Attachment #8945444</a> -
        Flags: review?(kmaglione+bmo)</div></div></div><div class="change-set" id="c33"><div class="comment" data-id="12994720" data-no="33"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-33" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a199971_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a199971_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-33"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-33" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c33">Comment 33</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-25 07:52 PST" data-time="1516895552">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-33">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8945483"
         class="attachment patch obsolete"
         data-id="8945483" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug_1432358_update_test_jsonview.patch">
      <meta itemprop="contentSize" content="740">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8945483">
          <a class="link" href="attachment.cgi?id=8945483&amp;action=diff">
        <span id="att-8945483-description" itemprop="description">bug_1432358_update_test_jsonview.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8945483&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1432358&attachment=8945483">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-33" data-comment-id="12994720">Honza, as discussed on IRC; let's whitelist chrome: and resource: for that particular test for now with the potential problem that the code changes within this bug might affect devtools on a broader scale. We will have to do some thorough testing to make sure devtools still work in combination with CSP.

FWIW, I am whitelisting chrome and resource within that test because of:
* resource://devtools-client-jsonview/css/main.css
* chrome://global/content/bindings/scrollbar.xml</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(odvarko)</span></div><div class="change">
        <a href="/attachment.cgi?id=8945483&amp;action=edit"
           title="bug_1432358_update_test_jsonview.patch"
           class=""
        >Attachment #8945483</a> -
        Flags: review?(odvarko)</div></div></div><div class="change-set" id="c34"><div class="comment" data-id="12994766" data-no="34"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-34" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_303767" id="a199971_363267"><img src="https://secure.gravatar.com/avatar/34b251cf082c202fb3160b1afb810001?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_303767" id="a199971_363267"><a class="email " href="/user_profile?user_id=303767" > <span class="fna">Jan Honza Odvarko [:Honza] (always need-info? me)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-34"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-34" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c34">Comment 34</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-25 08:06 PST" data-time="1516896396">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-34">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-34" data-comment-id="12994766">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8945483" name="attach_8945483" title="bug_1432358_update_test_jsonview.patch">attachment 8945483</a> <a href="/attachment.cgi?id=8945483&amp;action=edit" title="bug_1432358_update_test_jsonview.patch">[details]</a> <a href="/attachment.cgi?id=8945483&amp;action=diff" title="bug_1432358_update_test_jsonview.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1432358&amp;attachment=8945483'>[review]</a>
bug_1432358_update_test_jsonview.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8945483" name="attach_8945483" title="bug_1432358_update_test_jsonview.patch">attachment 8945483</a> <a href="/attachment.cgi?id=8945483&amp;action=edit" title="bug_1432358_update_test_jsonview.patch">[details]</a> <a href="/attachment.cgi?id=8945483&amp;action=diff" title="bug_1432358_update_test_jsonview.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1432358&amp;attachment=8945483'>[review]</a>:
-----------------------------------------------------------------

As we discussed on Slack, whitelisting the resource: protocol looks ok.

Thanks for the patch!
Honza</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8945483&amp;action=edit"
           title="bug_1432358_update_test_jsonview.patch"
           class=""
        >Attachment #8945483</a> -
        Flags: review?(odvarko) &rarr; review+</div></div></div><div class="change-set" id="c35"><div class="comment" data-id="12996252" data-no="35"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-35" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" id="a199971_363267"><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_106098" id="a199971_363267"><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-35"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-35" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c35">Comment 35</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-25 16:18 PST" data-time="1516925880">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-35">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-35" data-comment-id="12996252">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8945444" name="attach_8945444" title="bug_1432358_update_test_triggeringPrincipal.patch">attachment 8945444</a> <a href="/attachment.cgi?id=8945444&amp;action=edit" title="bug_1432358_update_test_triggeringPrincipal.patch">[details]</a> <a href="/attachment.cgi?id=8945444&amp;action=diff" title="bug_1432358_update_test_triggeringPrincipal.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1432358&amp;attachment=8945444'>[review]</a>
bug_1432358_update_test_triggeringPrincipal.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8945444" name="attach_8945444" title="bug_1432358_update_test_triggeringPrincipal.patch">attachment 8945444</a> <a href="/attachment.cgi?id=8945444&amp;action=edit" title="bug_1432358_update_test_triggeringPrincipal.patch">[details]</a> <a href="/attachment.cgi?id=8945444&amp;action=diff" title="bug_1432358_update_test_triggeringPrincipal.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1432358&amp;attachment=8945444'>[review]</a>:
-----------------------------------------------------------------

I don't think this affects just this test. This test doesn't particularly rely on the scrollbar.xml binding. That binding just happens to get loaded into most content pages, and this page has a (perfectly ordinary) CSP which blocks it. If these patches are causing this test to fail because the CSP blocks scrollbar.xml from loading, it probably also breaks scrollbars on any site with a similarly strict CSP.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8945444&amp;action=edit"
           title="bug_1432358_update_test_triggeringPrincipal.patch"
           class=""
        >Attachment #8945444</a> -
        Flags: <span class="activity-deleted">review?(kmaglione+bmo)</span></div></div></div><div class="change-set" id="c36"><div class="comment" data-id="12996655" data-no="36"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-36" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a199971_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a199971_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-36"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-36" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c36">Comment 36</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-25 22:13 PST" data-time="1516947220">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-36">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-36" data-comment-id="12996655">(In reply to Kris Maglione [:kmag] (long backlog; ping on IRC if you're blocked) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Universal CSP strict-dynamic bypass via require.js of browser resource"
   href="/show_bug.cgi?id=1432358#c35">comment #35</a>)
<span class="quote">&gt; I don't think this affects just this test. This test doesn't particularly
&gt; rely on the scrollbar.xml binding. That binding just happens to get loaded
&gt; into most content pages, and this page has a (perfectly ordinary) CSP which
&gt; blocks it. If these patches are causing this test to fail because the CSP
&gt; blocks scrollbar.xml from loading, it probably also breaks scrollbars on any
&gt; site with a similarly strict CSP.</span >

Gijs, I guess that puts us back to the start, right? Any suggestions on how to proceed?</pre><div class="activity"><div class="change">Flags: needinfo?(gijskruitbosch+bugs)</div></div></div><div class="change-set" id="c37"><div class="comment" data-id="12996681" data-no="37"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-37" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" id="a199971_363267"><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_106098" id="a199971_363267"><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-37"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-37" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c37">Comment 37</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-25 23:02 PST" data-time="1516950126">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-37">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-37" data-comment-id="12996681">Depending on the principal of the stylesheet that applies those bindings, it might be enough to make content injected by system principals immune to CSP here:

<a rel="nofollow" href="https://searchfox.org/mozilla-central/rev/062e1cf551f5bf3f0af33671b818f75a55ac497b/caps/BasePrincipal.h#136-154">https://searchfox.org/mozilla-central/rev/062e1cf551f5bf3f0af33671b818f75a55ac497b/caps/BasePrincipal.h#136-154</a>

That would leave chrome: and resource: URLs subject to CSP in the general case, but allow them when they're injected by chrome.</pre></div><div class="change-set" id="c38"><div class="comment" data-id="12996781" data-no="38"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-38" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a199971_363267"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a199971_363267"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-38"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-38" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c38">Comment 38</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-26 00:43 PST" data-time="1516956189">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-38">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-38" data-comment-id="12996781">Re: resource:/chrome: generally: We should try Kris' suggestion from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Universal CSP strict-dynamic bypass via require.js of browser resource"
   href="/show_bug.cgi?id=1432358#c37">comment #37</a>. Otherwise we can limit the new behaviour to resource: and fix chrome: separately.

(In reply to Jan Honza Odvarko [:Honza] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Universal CSP strict-dynamic bypass via require.js of browser resource"
   href="/show_bug.cgi?id=1432358#c34">comment #34</a>)
<span class="quote">&gt; Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8945483" name="attach_8945483" title="bug_1432358_update_test_jsonview.patch">attachment 8945483</a> <a href="/attachment.cgi?id=8945483&amp;action=edit" title="bug_1432358_update_test_jsonview.patch">[details]</a> <a href="/attachment.cgi?id=8945483&amp;action=diff" title="bug_1432358_update_test_jsonview.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1432358&amp;attachment=8945483'>[review]</a>
&gt; bug_1432358_update_test_jsonview.patch
&gt; 
&gt; Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8945483" name="attach_8945483" title="bug_1432358_update_test_jsonview.patch">attachment 8945483</a> <a href="/attachment.cgi?id=8945483&amp;action=edit" title="bug_1432358_update_test_jsonview.patch">[details]</a> <a href="/attachment.cgi?id=8945483&amp;action=diff" title="bug_1432358_update_test_jsonview.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1432358&amp;attachment=8945483'>[review]</a>:
&gt; -----------------------------------------------------------------
&gt; 
&gt; As we discussed on Slack, whitelisting the resource: protocol looks ok.</span >

I have to admit this patch confuses me. My understanding (though I haven't tested to verify that...) is that this patch will break the json viewer on any JSON that has strict CSP, unless we hack up the jsonview content transformer/handler (that actually includes all the resource: based script etc. ) to force a change to the CSP to always allow resource: for content viewed in the JSON viewer. But the patch only fixes 1 test file, not the jsonview behaviour...</pre><div class="activity"><div class="change">Flags: needinfo?(gijskruitbosch+bugs) &rarr; needinfo?(odvarko)</div></div></div><div class="change-set" id="c39"><div class="comment" data-id="13001997" data-no="39"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-39" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a199971_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a199971_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-39"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-39" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c39">Comment 39</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-29 04:11 PST" data-time="1517227870">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-39">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-39" data-comment-id="13001997">(In reply to Kris Maglione [:kmag] (long backlog; ping on IRC if you're blocked) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Universal CSP strict-dynamic bypass via require.js of browser resource"
   href="/show_bug.cgi?id=1432358#c37">comment #37</a>)
<span class="quote">&gt; Depending on the principal of the stylesheet that applies those bindings, it
&gt; might be enough to make content injected by system principals immune to CSP
&gt; here:
&gt; 
&gt; <a rel="nofollow" href="https://searchfox.org/mozilla-central/rev/">https://searchfox.org/mozilla-central/rev/</a>
&gt; 062e1cf551f5bf3f0af33671b818f75a55ac497b/caps/BasePrincipal.h#136-154
&gt; 
&gt; That would leave chrome: and resource: URLs subject to CSP in the general
&gt; case, but allow them when they're injected by chrome.</span >

Kris, thanks for the hint, I've tried that, but it seems content is *not* injected by the systemPrincipal in that case, at least not for the test test_ext_contentscript_triggeringPrincipal.js. Any other suggestions that I could try to incorporate?</pre><div class="activity"><div class="change">Flags: needinfo?(kmaglione+bmo)</div></div></div><div class="change-set" id="c40"><div class="comment" data-id="13002032" data-no="40"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-40" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a199971_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a199971_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-40"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-40" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c40">Comment 40</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-29 04:43 PST" data-time="1517229803">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-40">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-40" data-comment-id="13002032">(In reply to Christoph Kerschbaumer [:ckerschb] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Universal CSP strict-dynamic bypass via require.js of browser resource"
   href="/show_bug.cgi?id=1432358#c39">comment #39</a>)
<span class="quote">&gt; Kris, thanks for the hint, I've tried that, but it seems content is *not*
&gt; injected by the systemPrincipal in that case, at least not for the test
&gt; test_ext_contentscript_triggeringPrincipal.js. Any other suggestions that I
&gt; could try to incorporate?</span >

Ah, I see why. So your suggestion only applies to loads of TYPE_STYLESHEET (see [1]). But we are loading chrome://global/content/bindings/scrollbar.xml with TYPE_XBL which then presumably uses a different code path. Probably we can do a similar whitelisting as you suggested for the *.xml. Let me see if I can find the right place in the code for that. I think that should be doable though.

[1] <a rel="nofollow" href="https://dxr.mozilla.org/mozilla-central/source/layout/style/nsStyleUtil.cpp#887">https://dxr.mozilla.org/mozilla-central/source/layout/style/nsStyleUtil.cpp#887</a></pre></div><div class="change-set" id="c41"><div class="comment" data-id="13003427" data-no="41"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-41" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a199971_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a199971_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-41"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-41" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c41">Comment 41</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-29 13:19 PST" data-time="1517260756">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-41">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8946410"
         class="attachment patch obsolete"
         data-id="8946410" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug_1432358_update_overridescsp.patch">
      <meta itemprop="contentSize" content="2032">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8946410">
          <a class="link" href="attachment.cgi?id=8946410&amp;action=diff">
        <span id="att-8946410-description" itemprop="description">bug_1432358_update_overridescsp.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8946410&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1432358&attachment=8946410">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-41" data-comment-id="13003427">Kris, thanks for your suggestion. It all makes sense now. Loads triggered by the system should bypass the CSP of the page. I don't know why that didn't work when I first tried this morning, but having overrideCSP() return true when called on a SystemPrincipal allows loading an XBL if triggered by the system here [1].

That whitelisting in turn allows test_ext_contentscript_triggeringPrincipal.js to work properly again.

Do you feel comfortable accepting that change or do we need someone else to sign off on it as well?

[1] <a rel="nofollow" href="https://dxr.mozilla.org/mozilla-central/source/dom/security/nsCSPService.cpp#142">https://dxr.mozilla.org/mozilla-central/source/dom/security/nsCSPService.cpp#142</a></pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8945444&amp;action=edit"
           title="bug_1432358_update_test_triggeringPrincipal.patch"
           class=""
        >Attachment #8945444</a> -
        Attachment is obsolete: true</div><div class="change">Flags: <span class="activity-deleted">needinfo?(kmaglione+bmo)</span></div><div class="change">
        <a href="/attachment.cgi?id=8946410&amp;action=edit"
           title="bug_1432358_update_overridescsp.patch"
           class=""
        >Attachment #8946410</a> -
        Flags: review?(kmaglione+bmo)</div></div></div><div class="change-set" id="c42"><div class="comment" data-id="13003658" data-no="42"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-42" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_106098" id="a199971_363267"><img src="https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_106098" id="a199971_363267"><a class="email " href="/user_profile?user_id=106098" > <span class="fna">Kris Maglione [:kmag]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-42"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-42" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c42">Comment 42</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-29 14:34 PST" data-time="1517265249">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-42">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-42" data-comment-id="13003658">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8946410" name="attach_8946410" title="bug_1432358_update_overridescsp.patch">attachment 8946410</a> <a href="/attachment.cgi?id=8946410&amp;action=edit" title="bug_1432358_update_overridescsp.patch">[details]</a> <a href="/attachment.cgi?id=8946410&amp;action=diff" title="bug_1432358_update_overridescsp.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1432358&amp;attachment=8946410'>[review]</a>
bug_1432358_update_overridescsp.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8946410" name="attach_8946410" title="bug_1432358_update_overridescsp.patch">attachment 8946410</a> <a href="/attachment.cgi?id=8946410&amp;action=edit" title="bug_1432358_update_overridescsp.patch">[details]</a> <a href="/attachment.cgi?id=8946410&amp;action=diff" title="bug_1432358_update_overridescsp.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1432358&amp;attachment=8946410'>[review]</a>:
-----------------------------------------------------------------

::: caps/BasePrincipal.h
&#64;&#64; +135,5 &#64;&#64;
<span class="quote">&gt;  
&gt;    /**
&gt; +   * Returns true if this principal's CSP should override a document's
&gt; +   * CSP for loads that it triggers. Currently true for system
&gt; +   * principals and for expanded principals which subsume the document</span >

Nit: s/ and for/,/

Also, should probably be &quot;the system principal&quot; rather than &quot;system principals&quot;, since there's only ever one.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8946410&amp;action=edit"
           title="bug_1432358_update_overridescsp.patch"
           class=""
        >Attachment #8946410</a> -
        Flags: review?(kmaglione+bmo) &rarr; review+</div></div></div><div class="change-set" id="c43"><div class="comment" data-id="13004676" data-no="43"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-43" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a199971_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a199971_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-43"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-43" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c43">Comment 43</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-30 02:23 PST" data-time="1517307832">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-43">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-43" data-comment-id="13004676">(In reply to :Gijs from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Universal CSP strict-dynamic bypass via require.js of browser resource"
   href="/show_bug.cgi?id=1432358#c38">comment #38</a>)
<span class="quote">&gt; I have to admit this patch confuses me. My understanding (though I haven't
&gt; tested to verify that...) is that this patch will break the json viewer on
&gt; any JSON that has strict CSP, unless we hack up the jsonview content
&gt; transformer/handler (that actually includes all the resource: based script
&gt; etc. ) to force a change to the CSP to always allow resource: for content
&gt; viewed in the JSON viewer. But the patch only fixes 1 test file, not the
&gt; jsonview behaviour...</span >

Gijs, I think you are right. I tried to debug that part again and it seems we are loading require.js using a resource:// URI within the JSON converter here [1]. I agree that this patch most likely will only fix the test browser_jsonview_csp_json.js but most likely will cause more problems around the JSON converter in the wild (whenever a page uses a strong CSP). Currently the triggeringPrincipal for loading resource://devtools-client-jsonview/lib/require.js is a NullPrincipal so the previous patch to overrule a pages CSP has no effect on the JSON converter code.

Do you have any suggestions how to update the JSON converter code [1] so it's not subject to a page's CSP?

[1] <a rel="nofollow" href="https://dxr.mozilla.org/mozilla-central/source/devtools/client/jsonview/converter-child.js#252">https://dxr.mozilla.org/mozilla-central/source/devtools/client/jsonview/converter-child.js#252</a></pre><div class="activity"><div class="change">Flags: needinfo?(gijskruitbosch+bugs)</div></div></div><div class="change-set" id="a638533_363267"><div class="change" id="aa638533_363267">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a638533_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_363267" id="a638533_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a638533_363267"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a638533_363267">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#a638533_363267">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-30 03:49 PST" data-time="1517312999">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: [domsecurity-active]</div></div></div><div class="change-set" id="c44"><div class="comment" data-id="13006650" data-no="44"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-44" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a638533_363267"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a638533_363267"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-44"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-44" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c44">Comment 44</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-30 14:11 PST" data-time="1517350290">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-44">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-44" data-comment-id="13006650">Talked about this with Christoph out-of-band. We can either do this such that CSPs don't apply to the jsonviewer, or overwrite the CSP with our own thing that only allows our own resources and nothing else. We'll do whatever is expedient given the immediate nature of the issue.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(gijskruitbosch+bugs)</span></div></div></div><div class="change-set" id="c45"><div class="comment" data-id="13007984" data-no="45"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-45" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a638533_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a638533_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-45"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-45" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c45">Comment 45</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-31 04:06 PST" data-time="1517400413">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-45">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8947044"
         class="attachment patch obsolete"
         data-id="8947044" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug_1432358_allow_dropping_csp.patch">
      <meta itemprop="contentSize" content="8021">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8947044">
          <a class="link" href="attachment.cgi?id=8947044&amp;action=diff">
        <span id="att-8947044-description" itemprop="description">bug_1432358_allow_dropping_csp.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8947044&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1432358&attachment=8947044">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-45" data-comment-id="13007984">Olli, within this patch we want to make chrome: and resource: URIs to become subject to CSP. In turn, this change will break the json viewer, because it loads resource: URIs, e.g. here [1] which might get blocked by a document's CSP now. Within our own testsuite this change causes browser_jsonview_csp_json.js to fail.

I thought of a few things to make this work. Ultimately, I think the best approach is to allow dropping the CSP in that specific case. I tried to minimize the risk by making the function a no-op for all principals other than a NullPrincipal.

FWIW, the load uses a NullPrincipal because we explicitly reset to do so here [2].

I know it's a little hacky, but I think it's the best option we have to make this work again. What do you think?

[1] <a rel="nofollow" href="https://dxr.mozilla.org/mozilla-central/source/devtools/client/jsonview/converter-child.js#252">https://dxr.mozilla.org/mozilla-central/source/devtools/client/jsonview/converter-child.js#252</a>
[2] <a rel="nofollow" href="https://dxr.mozilla.org/mozilla-central/source/devtools/client/jsonview/converter-child.js#95">https://dxr.mozilla.org/mozilla-central/source/devtools/client/jsonview/converter-child.js#95</a></pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8945483&amp;action=edit"
           title="bug_1432358_update_test_jsonview.patch"
           class=""
        >Attachment #8945483</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8947044&amp;action=edit"
           title="bug_1432358_allow_dropping_csp.patch"
           class=""
        >Attachment #8947044</a> -
        Flags: review?(bugs)</div></div></div><div class="change-set" id="c46"><div class="comment" data-id="13008649" data-no="46"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-46" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_39966" id="a638533_363267"><img src="https://secure.gravatar.com/avatar/7ba0f00f24191ccef0d14185bd7ca4ca?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_39966" id="a638533_363267"><a class="email " href="/user_profile?user_id=39966" > <span class="fna">Olli Pettay [:smaug]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-46"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-46" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c46">Comment 46</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-31 08:15 PST" data-time="1517415338">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-46">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-46" data-comment-id="13008649">Honza, could you explain the jsonviewer setup? How does it even end up using csp from the json response?</pre></div><div class="change-set" id="c47"><div class="comment" data-id="13008658" data-no="47"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-47" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_39966" id="a638533_363267"><img src="https://secure.gravatar.com/avatar/7ba0f00f24191ccef0d14185bd7ca4ca?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_39966" id="a638533_363267"><a class="email " href="/user_profile?user_id=39966" > <span class="fna">Olli Pettay [:smaug]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-47"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-47" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c47">Comment 47</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-31 08:17 PST" data-time="1517415473">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-47">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-47" data-comment-id="13008658">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8947044" name="attach_8947044" title="bug_1432358_allow_dropping_csp.patch">attachment 8947044</a> <a href="/attachment.cgi?id=8947044&amp;action=edit" title="bug_1432358_allow_dropping_csp.patch">[details]</a> <a href="/attachment.cgi?id=8947044&amp;action=diff" title="bug_1432358_allow_dropping_csp.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1432358&amp;attachment=8947044'>[review]</a>
bug_1432358_allow_dropping_csp.patch

Can't really review this atm.


It smells like we shouldn't inherit the CSP from the beginning, if we end up wanting to drop it anyhow. So, should something somewhere create a null principal without csp?
But I don't understand jsonviewer setup.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8947044&amp;action=edit"
           title="bug_1432358_allow_dropping_csp.patch"
           class=""
        >Attachment #8947044</a> -
        Flags: <span class="activity-deleted">review?(bugs)</span></div></div></div><div class="change-set" id="c48"><div class="comment" data-id="13008710" data-no="48"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-48" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_303767" id="a638533_363267"><img src="https://secure.gravatar.com/avatar/34b251cf082c202fb3160b1afb810001?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_303767" id="a638533_363267"><a class="email " href="/user_profile?user_id=303767" > <span class="fna">Jan Honza Odvarko [:Honza] (always need-info? me)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-48"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-48" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c48">Comment 48</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-31 08:35 PST" data-time="1517416556">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-48">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-48" data-comment-id="13008710">I don't know why it's using the same CSP, but the initial setup happens in onStartRequest (converter-child.js). This method converts plain JSON into an application that is rendered instead (in the same tab/window). The HTML app is generated by initialHTML() method (in the same file)

The method also explicitly sets request.loadInfo.resetPrincipalToInheritToNullPrincipal(); (as mentioned in the previous comment) If we want to create new (and correct) principal it feels like it should be done at this place...

Honza</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(odvarko)</span></div></div></div><div class="change-set" id="c49"><div class="comment" data-id="13009213" data-no="49"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-49" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a638533_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a638533_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-49"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-49" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c49">Comment 49</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-31 11:24 PST" data-time="1517426654">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-49">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-49" data-comment-id="13009213">Olli, initially I wanted to not even apply (or actually even parse) a CSP in that case. I thought, maybe we can detect the loading  of a *.json file in nsDocument.cpp where we apply the CSP to the document (somewhere around here [1]). The problem is that we can't reliably detect JSON loading. In the specific case of browser_jsonview_csp_json.js for example we are loading the content type &quot;text/html&quot;. Solely not applying a CSP based on the file ending is a no go anyway. So that option is out, or am I missing something?

The next thing I tried is to overwrite the principal (that holds the CSP) with yet another freshly created NullPrincipal. But that's not doable. Let me explain: This [2] resetting of the principal to inherit on the loadInfo caused the new document's nodePrincipal to be that NullPrincipal. Resetting the LoadingPrincipal on the loadInfo after the NodePrincipal has been assigned on the document has no effect in terms of querying the CSP within the CSP-code anymore, because the CSP code queries the CSP from the loadingContext (see [3]) and not from the loadInfo.

Since there is no document-&gt;SetNodePrincipal() we can not overwrite that principal anymore. The only option we have is, to get a pointer to the principal and drop the CSP, which is what my patch was doing.

I am open to better suggestions, but I can't think of anything else. Again, ideally I would like to not even parse the CSP in case of loading a *.json, but I think that's not reliably doable.

Are you willing to reconsider my patch for an r+?

[1] <a rel="nofollow" href="https://dxr.mozilla.org/mozilla-central/source/dom/base/nsDocument.cpp#2915">https://dxr.mozilla.org/mozilla-central/source/dom/base/nsDocument.cpp#2915</a>
[2] <a rel="nofollow" href="https://dxr.mozilla.org/mozilla-central/source/devtools/client/jsonview/converter-child.js#95">https://dxr.mozilla.org/mozilla-central/source/devtools/client/jsonview/converter-child.js#95</a>
[3] <a rel="nofollow" href="https://dxr.mozilla.org/mozilla-central/source/dom/security/nsCSPService.cpp#145">https://dxr.mozilla.org/mozilla-central/source/dom/security/nsCSPService.cpp#145</a></pre><div class="activity"><div class="change">Flags: needinfo?(bugs)</div></div></div><div class="change-set" id="c50"><div class="comment" data-id="13009513" data-no="50"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-50" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_39966" id="a638533_363267"><img src="https://secure.gravatar.com/avatar/7ba0f00f24191ccef0d14185bd7ca4ca?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_39966" id="a638533_363267"><a class="email " href="/user_profile?user_id=39966" > <span class="fna">Olli Pettay [:smaug]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-50"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-50" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c50">Comment 50</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-31 12:54 PST" data-time="1517432062">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-50">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-50" data-comment-id="13009513">I'm worried about having a principal around which first has csp and then it suddenly loses it. What guarantees no code between those states try to access csp?

Can we mark loadinfo or channel or something as don't-apply-csp? Do that before we end up setting up csp in nsDocument</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(bugs)</span></div></div></div><div class="change-set" id="c51"><div class="comment" data-id="13010681" data-no="51"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-51" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a638533_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a638533_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-51"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-51" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c51">Comment 51</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-01 01:06 PST" data-time="1517475965">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-51">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8947380"
         class="attachment patch obsolete"
         data-id="8947380" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug_1432358_channel_csp_agnostic.patch">
      <meta itemprop="contentSize" content="15423">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8947380">
          <a class="link" href="attachment.cgi?id=8947380&amp;action=diff">
        <span id="att-8947380-description" itemprop="description">bug_1432358_channel_csp_agnostic.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8947380&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1432358&attachment=8947380">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-51" data-comment-id="13010681">(In reply to Olli Pettay [:smaug] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Universal CSP strict-dynamic bypass via require.js of browser resource"
   href="/show_bug.cgi?id=1432358#c50">comment #50</a>)
<span class="quote">&gt; Can we mark loadinfo or channel or something as don't-apply-csp? Do that
&gt; before we end up setting up csp in nsDocument</span >

In fact I like that idea a lot - here we go. What do you think?</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8947044&amp;action=edit"
           title="bug_1432358_allow_dropping_csp.patch"
           class=""
        >Attachment #8947044</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8947380&amp;action=edit"
           title="bug_1432358_channel_csp_agnostic.patch"
           class=""
        >Attachment #8947380</a> -
        Flags: review?(bugs)</div></div></div><div class="change-set" id="c52"><div class="comment" data-id="13010754" data-no="52"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-52" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_39966" id="a638533_363267"><img src="https://secure.gravatar.com/avatar/7ba0f00f24191ccef0d14185bd7ca4ca?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_39966" id="a638533_363267"><a class="email " href="/user_profile?user_id=39966" > <span class="fna">Olli Pettay [:smaug]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-52"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-52" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c52">Comment 52</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-01 01:42 PST" data-time="1517478152">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-52">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-52" data-comment-id="13010754">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8947380" name="attach_8947380" title="bug_1432358_channel_csp_agnostic.patch">attachment 8947380</a> <a href="/attachment.cgi?id=8947380&amp;action=edit" title="bug_1432358_channel_csp_agnostic.patch">[details]</a> <a href="/attachment.cgi?id=8947380&amp;action=diff" title="bug_1432358_channel_csp_agnostic.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1432358&amp;attachment=8947380'>[review]</a>
bug_1432358_channel_csp_agnostic.patch

 
<span class="quote">&gt; NS_IMETHODIMP
&gt;+LoadInfo::SetAllowDocumentToBeAgnosticToCSP(bool aAllowDocumentToBeAgnosticToCSP)
&gt;+{
&gt;+  if (mInternalContentPolicyType != nsIContentPolicy::TYPE_DOCUMENT) {
&gt;+    MOZ_ASSERT(false, &quot;not available for on loads other than TYPE_DOCUMENT&quot;);</span >
I think &quot;not available for loads other than...&quot;



Yeah, I think this approach is rather clear.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8947380&amp;action=edit"
           title="bug_1432358_channel_csp_agnostic.patch"
           class=""
        >Attachment #8947380</a> -
        Flags: review?(bugs) &rarr; review+</div></div></div><div class="change-set" id="c53"><div class="comment" data-id="13011093" data-no="53"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-53" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a638533_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a638533_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-53"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-53" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c53">Comment 53</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-01 05:07 PST" data-time="1517490459">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-53">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8947427"
         class="attachment patch"
         data-id="8947427" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug_1432358_update_overridescsp.patch">
      <meta itemprop="contentSize" content="1921">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8947427">
          <a class="link" href="attachment.cgi?id=8947427&amp;action=diff">
        <span id="att-8947427-description" itemprop="description">bug_1432358_update_overridescsp.patch</span></a>
        — <a href="attachment.cgi?id=8947427&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1432358&attachment=8947427">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-53" data-comment-id="13011093">Incorporated nits; carrying over r+ from kmag.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8946410&amp;action=edit"
           title="bug_1432358_update_overridescsp.patch"
           class=""
        >Attachment #8946410</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="c54"><div class="comment" data-id="13011095" data-no="54"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-54" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a638533_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a638533_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-54"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-54" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c54">Comment 54</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-01 05:08 PST" data-time="1517490490">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-54">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8947428"
         class="attachment patch"
         data-id="8947428" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug_1432358_channel_csp_agnostic.patch">
      <meta itemprop="contentSize" content="15420">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8947428">
          <a class="link" href="attachment.cgi?id=8947428&amp;action=diff">
        <span id="att-8947428-description" itemprop="description">bug_1432358_channel_csp_agnostic.patch</span></a>
        — <a href="attachment.cgi?id=8947428&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1432358&attachment=8947428">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-54" data-comment-id="13011095">Incorporated nits; carrying over r+ from smaug.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8947380&amp;action=edit"
           title="bug_1432358_channel_csp_agnostic.patch"
           class=""
        >Attachment #8947380</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="a816038_363267"><div class="change" id="aa816038_363267">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a816038_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_363267" id="a816038_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a816038_363267"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a816038_363267">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#a816038_363267">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-01 05:08 PST" data-time="1517490504">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8947427&amp;action=edit"
           title="bug_1432358_update_overridescsp.patch"
           class=""
        >Attachment #8947427</a> -
        Flags: review+</div></div></div><div class="change-set" id="a816044_363267"><div class="change" id="aa816044_363267">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a816044_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_363267" id="a816044_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a816044_363267"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a816044_363267">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#a816044_363267">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-01 05:08 PST" data-time="1517490510">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8947428&amp;action=edit"
           title="bug_1432358_channel_csp_agnostic.patch"
           class=""
        >Attachment #8947428</a> -
        Flags: review+</div></div></div><div class="change-set" id="c55"><div class="comment" data-id="13011112" data-no="55"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-55" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a816044_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a816044_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-55"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-55" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c55">Comment 55</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-01 05:22 PST" data-time="1517491344">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-55">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-55" data-comment-id="13011112">Comment on <span class=""><a href="/attachment.cgi?id=8945420" name="attach_8945420" title="bug_1432358_apply_csp_to_resource.patch">attachment 8945420</a> <a href="/attachment.cgi?id=8945420&amp;action=edit" title="bug_1432358_apply_csp_to_resource.patch">[details]</a> <a href="/attachment.cgi?id=8945420&amp;action=diff" title="bug_1432358_apply_csp_to_resource.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1432358&amp;attachment=8945420'>[review]</a>
bug_1432358_apply_csp_to_resource.patch

[Security approval request comment]
How easily could an exploit be constructed based on the patch?
Not that easily, because an attacker would have to know that Firefox's file require.js looks for a script tag of 'data-main' which makes the Universal CSP bypass possible at all. See the following example:
&lt;script data-main='data:,alert(1)'&gt;&lt;/script&gt;
&lt;script src=&quot;resource://devtools-client-jsonview/lib/require.js&quot;&gt;&lt;/script&gt;

The automatic testcase here registers it's own resource file so we don't pinpount to the weakness for require.js explicitly.

Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
No. The patch including comments does not reveal the actual problem. See explanation above.

Which older supported branches are affected by this flaw?
I don't know offhand, most likely all supported branches are affected. Resource URIs have never been subject to CSP since the introduction of our CSP code. I guess the question is, when did require.js land, but I imagine that file has also been around for a very long time.

If not all supported branches, which bug introduced the flaw?
see above.

Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
I don't have backports. I would imagine that the attached patches apply more or less cleanly to other affected branches.

How likely is this patch to cause regressions; how much testing does it need?
Not very likely, because less than %5 of webpages ship a CSP. Out of those only a very small percentage load resource:// URIs.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8945420&amp;action=edit"
           title="bug_1432358_apply_csp_to_resource.patch"
           class=""
        >Attachment #8945420</a> -
        Flags: sec-approval?</div></div></div><div class="change-set" id="c56"><div class="comment" data-id="13011115" data-no="56"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-56" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a816044_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a816044_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-56"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-56" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c56">Comment 56</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-01 05:22 PST" data-time="1517491377">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-56">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-56" data-comment-id="13011115">Comment on <span class=""><a href="/attachment.cgi?id=8945421" name="attach_8945421" title="bug_1432358_test_subjecttocsp.patch">attachment 8945421</a> <a href="/attachment.cgi?id=8945421&amp;action=edit" title="bug_1432358_test_subjecttocsp.patch">[details]</a> <a href="/attachment.cgi?id=8945421&amp;action=diff" title="bug_1432358_test_subjecttocsp.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1432358&amp;attachment=8945421'>[review]</a>
bug_1432358_test_subjecttocsp.patch

[Security approval request comment]
See <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Universal CSP strict-dynamic bypass via require.js of browser resource"
   href="/show_bug.cgi?id=1432358#c55">comment 55</a>.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8945421&amp;action=edit"
           title="bug_1432358_test_subjecttocsp.patch"
           class=""
        >Attachment #8945421</a> -
        Flags: sec-approval?</div></div></div><div class="change-set" id="c57"><div class="comment" data-id="13011116" data-no="57"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-57" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a816044_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a816044_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-57"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-57" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c57">Comment 57</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-01 05:23 PST" data-time="1517491386">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-57">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-57" data-comment-id="13011116">Comment on <span class=""><a href="/attachment.cgi?id=8947427" name="attach_8947427" title="bug_1432358_update_overridescsp.patch">attachment 8947427</a> <a href="/attachment.cgi?id=8947427&amp;action=edit" title="bug_1432358_update_overridescsp.patch">[details]</a> <a href="/attachment.cgi?id=8947427&amp;action=diff" title="bug_1432358_update_overridescsp.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1432358&amp;attachment=8947427'>[review]</a>
bug_1432358_update_overridescsp.patch

[Security approval request comment]
See <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Universal CSP strict-dynamic bypass via require.js of browser resource"
   href="/show_bug.cgi?id=1432358#c55">comment 55</a>.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8947427&amp;action=edit"
           title="bug_1432358_update_overridescsp.patch"
           class=""
        >Attachment #8947427</a> -
        Flags: sec-approval?</div></div></div><div class="change-set" id="c58"><div class="comment" data-id="13011118" data-no="58"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-58" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a816044_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a816044_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-58"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-58" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c58">Comment 58</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-01 05:23 PST" data-time="1517491396">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-58">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-58" data-comment-id="13011118">Comment on <span class=""><a href="/attachment.cgi?id=8947428" name="attach_8947428" title="bug_1432358_channel_csp_agnostic.patch">attachment 8947428</a> <a href="/attachment.cgi?id=8947428&amp;action=edit" title="bug_1432358_channel_csp_agnostic.patch">[details]</a> <a href="/attachment.cgi?id=8947428&amp;action=diff" title="bug_1432358_channel_csp_agnostic.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1432358&amp;attachment=8947428'>[review]</a>
bug_1432358_channel_csp_agnostic.patch

[Security approval request comment]
See <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Universal CSP strict-dynamic bypass via require.js of browser resource"
   href="/show_bug.cgi?id=1432358#c55">comment 55</a>.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8947428&amp;action=edit"
           title="bug_1432358_channel_csp_agnostic.patch"
           class=""
        >Attachment #8947428</a> -
        Flags: sec-approval?</div></div></div><div class="change-set" id="c59"><div class="comment" data-id="13015607" data-no="59"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-59" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a816044_363267"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_280903" id="a816044_363267"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-59"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-59" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c59">Comment 59</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-02 18:22 PST" data-time="1517624554">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-59">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-59" data-comment-id="13015607">Tests aren't going to get sec-approval on a sec-high rated issue until after we ship it in a release. I'll clear the sec-approval on that. You should set in-testsuite? to remember to check the tests in four weeks after we ship a release with the fix.

I'll give sec-approval+ on the patches for trunk. 

You should nominate Beta and ESR52 patches for this as well.</pre></div><div class="change-set" id="a950109_280903"><div class="change" id="aa950109_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a950109_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a950109_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a950109_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a950109_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#a950109_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-02 18:22 PST" data-time="1517624575">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8945420&amp;action=edit"
           title="bug_1432358_apply_csp_to_resource.patch"
           class=""
        >Attachment #8945420</a> -
        Flags: sec-approval? &rarr; sec-approval+</div></div></div><div class="change-set" id="a950123_280903"><div class="change" id="aa950123_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a950123_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a950123_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a950123_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a950123_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#a950123_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-02 18:23 PST" data-time="1517624589">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8945421&amp;action=edit"
           title="bug_1432358_test_subjecttocsp.patch"
           class=""
        >Attachment #8945421</a> -
        Flags: <span class="activity-deleted">sec-approval?</span></div></div></div><div class="change-set" id="a950137_280903"><div class="change" id="aa950137_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a950137_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a950137_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a950137_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a950137_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#a950137_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-02 18:23 PST" data-time="1517624603">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8947427&amp;action=edit"
           title="bug_1432358_update_overridescsp.patch"
           class=""
        >Attachment #8947427</a> -
        Flags: sec-approval? &rarr; sec-approval+</div></div></div><div class="change-set" id="a950172_280903"><div class="change" id="aa950172_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a950172_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a950172_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a950172_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a950172_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#a950172_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-02 18:23 PST" data-time="1517624638">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8947428&amp;action=edit"
           title="bug_1432358_channel_csp_agnostic.patch"
           class=""
        >Attachment #8947428</a> -
        Flags: sec-approval? &rarr; sec-approval+</div></div></div><div class="change-set" id="a1270558_75935"><div class="change" id="aa1270558_75935">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a1270558_75935"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_75935" id="a1270558_75935"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1270558_75935"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1270558_75935">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#a1270558_75935">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-06 11:23 PST" data-time="1517945024">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox58&amp;o1=isnotempty">status-firefox58</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox58&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox59&amp;o1=isnotempty">status-firefox59</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox59&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox60&amp;o1=isnotempty">status-firefox60</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox60&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr52&amp;o1=isnotempty">status-firefox-esr52</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr52&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox59&amp;o1=isnotempty">tracking-firefox59</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox59&amp;o1=equals&amp;v1=%2B">+</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox60&amp;o1=isnotempty">tracking-firefox60</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox60&amp;o1=equals&amp;v1=%2B">+</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr52&amp;o1=isnotempty">tracking-firefox-esr52</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox_esr52&amp;o1=equals&amp;v1=59%2B">59+</a></div></div></div><div class="change-set" id="a1434536_363267"><div class="change" id="aa1434536_363267">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a1434536_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_363267" id="a1434536_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1434536_363267"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1434536_363267">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#a1434536_363267">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-08 08:56 PST" data-time="1518109002">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Keywords: <a href="/buglist.cgi?keywords=checkin-needed&amp;resolution=---">checkin-needed</a></div></div></div><div class="change-set" id="c60"><div class="comment" data-id="13031506" data-no="60"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-60" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_258347" id="a1434536_363267"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_258347" id="a1434536_363267"><a class="email " href="/user_profile?user_id=258347" > <span class="fna">Sebastian Hengst [:aryx] (needinfo on intermittent or backout)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-60"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-60" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c60">Comment 60</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-09 11:26 PST" data-time="1518204398">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-60">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-60" data-comment-id="13031506"><a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/60852dec9e041887bea80313a70ad2a4cba745a6">https://hg.mozilla.org/integration/mozilla-inbound/rev/60852dec9e041887bea80313a70ad2a4cba745a6</a>
<a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/6840396ed6ec8cdc9e77e253c1c61258a24fb987">https://hg.mozilla.org/integration/mozilla-inbound/rev/6840396ed6ec8cdc9e77e253c1c61258a24fb987</a>
<a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/27527f95cccca4927d4fee56b0dab9af11c5733f">https://hg.mozilla.org/integration/mozilla-inbound/rev/27527f95cccca4927d4fee56b0dab9af11c5733f</a></pre><div class="activity"><div class="change">Keywords: <span class="activity-deleted"><a href="/buglist.cgi?keywords=checkin-needed&amp;resolution=---">checkin-needed</a></span></div></div></div><div class="change-set" id="c61"><div class="comment" data-id="13031955" data-no="61"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-61" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_258347" id="a1434536_363267"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_258347" id="a1434536_363267"><a class="email " href="/user_profile?user_id=258347" > <span class="fna">Sebastian Hengst [:aryx] (needinfo on intermittent or backout)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-61"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-61" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c61">Comment 61</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-09 14:04 PST" data-time="1518213866">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-61">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-61" data-comment-id="13031955">Backed out for failing xpcshell's test_ext_contentscript_triggeringPrincipal.js on Windows debug:

<a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/a824791e0d28623e928f9b5314cb6d948b2218ef">https://hg.mozilla.org/integration/mozilla-inbound/rev/a824791e0d28623e928f9b5314cb6d948b2218ef</a>

Push with failures: <a rel="nofollow" href="https://treeherder.mozilla.org/#/jobs?repo=mozilla-inbound&amp;revision=35b81e0007ab42a5c0e7ec037ee2295d6708607e&amp;filter-resultStatus=testfailed&amp;filter-resultStatus=busted&amp;filter-resultStatus=exception&amp;filter-resultStatus=retry&amp;filter-resultStatus=usercancel&amp;filter-resultStatus=runnable">https://treeherder.mozilla.org/#/jobs?repo=mozilla-inbound&amp;revision=35b81e0007ab42a5c0e7ec037ee2295d6708607e&amp;filter-resultStatus=testfailed&amp;filter-resultStatus=busted&amp;filter-resultStatus=exception&amp;filter-resultStatus=retry&amp;filter-resultStatus=usercancel&amp;filter-resultStatus=runnable</a>
Failure log: <a rel="nofollow" href="https://treeherder.mozilla.org/logviewer.html#?job_id=161405747&amp;repo=mozilla-inbound">https://treeherder.mozilla.org/logviewer.html#?job_id=161405747&amp;repo=mozilla-inbound</a>

20:55:02     INFO -  TEST-START | xpcshell-e10s.ini:toolkit/components/extensions/test/xpcshell/test_ext_contentscript_triggeringPrincipal.js
21:00:02  WARNING -  TEST-UNEXPECTED-TIMEOUT | xpcshell-e10s.ini:toolkit/components/extensions/test/xpcshell/test_ext_contentscript_triggeringPrincipal.js | Test timed out</pre><div class="activity"><div class="change">Flags: needinfo?(ckerschb)</div></div></div><div class="change-set" id="c62"><div class="comment" data-id="13035244" data-no="62"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-62" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a1434536_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a1434536_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-62"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-62" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c62">Comment 62</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-12 00:29 PST" data-time="1518424181">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-62">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-62" data-comment-id="13035244">(In reply to Sebastian Hengst [:aryx][:archaeopteryx] (needinfo on intermittent or backout) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Universal CSP strict-dynamic bypass via require.js of browser resource"
   href="/show_bug.cgi?id=1432358#c61">comment #61</a>)
<span class="quote">&gt; Backed out for failing xpcshell's
&gt; test_ext_contentscript_triggeringPrincipal.js on Windows debug:</span >

Kris, even though the test runs quite long it works locally. I guess the problem is that we just exceed the allowed timeout of that xpcshell test. Can we somehow request a longer timeout? I know we have requestLongerTimeout() on mochitests, not sure if we have an equivalent for xcpshell tests. What do you think?</pre><div class="activity"><div class="change">Flags: needinfo?(ckerschb) &rarr; needinfo?(kmaglione+bmo)</div></div></div><div class="change-set" id="c63"><div class="comment" data-id="13035278" data-no="63"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-63" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_258347" id="a1434536_363267"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_258347" id="a1434536_363267"><a class="email " href="/user_profile?user_id=258347" > <span class="fna">Sebastian Hengst [:aryx] (needinfo on intermittent or backout)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-63"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-63" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c63">Comment 63</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-12 01:00 PST" data-time="1518426016">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-63">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-63" data-comment-id="13035278">Use requesttimeoutfactor = number in the xpcshell.ini.

Code: <a rel="nofollow" href="https://dxr.mozilla.org/mozilla-central/rev/2b7d42d527af582a465e49187fe387442d524a7c/testing/xpcshell/runxpcshelltests.py#667">https://dxr.mozilla.org/mozilla-central/rev/2b7d42d527af582a465e49187fe387442d524a7c/testing/xpcshell/runxpcshelltests.py#667</a>
Example: <a rel="nofollow" href="https://dxr.mozilla.org/mozilla-central/rev/2b7d42d527af582a465e49187fe387442d524a7c/netwerk/test/unit/xpcshell.ini#88-89">https://dxr.mozilla.org/mozilla-central/rev/2b7d42d527af582a465e49187fe387442d524a7c/netwerk/test/unit/xpcshell.ini#88-89</a></pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(kmaglione+bmo)</span></div></div></div><div class="change-set" id="c64"><div class="comment" data-id="13035338" data-no="64"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-64" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a1434536_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a1434536_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-64"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-64" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c64">Comment 64</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-12 01:43 PST" data-time="1518428599">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-64">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8950155"
         class="attachment patch obsolete"
         data-id="8950155" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug_1432358_fix_xpcshell_test.patch">
      <meta itemprop="contentSize" content="1120">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8950155">
          <a class="link" href="attachment.cgi?id=8950155&amp;action=diff">
        <span id="att-8950155-description" itemprop="description">bug_1432358_fix_xpcshell_test.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8950155&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1432358&attachment=8950155">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-64" data-comment-id="13035338">Aryx, are you comfortable accepting this? If so, could you please also reland those patches for me by any chance?</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8950155&amp;action=edit"
           title="bug_1432358_fix_xpcshell_test.patch"
           class=""
        >Attachment #8950155</a> -
        Flags: review?(aryx.bugmail)</div></div></div><div class="change-set" id="a1756941_258347"><div class="change" id="aa1756941_258347">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_258347" id="a1756941_258347"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_258347" id="a1756941_258347"><a class="email " href="/user_profile?user_id=258347" > <span class="fna">Sebastian Hengst [:aryx] (needinfo on intermittent or backout)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1756941_258347"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1756941_258347">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#a1756941_258347">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-12 02:30 PST" data-time="1518431407">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8950155&amp;action=edit"
           title="bug_1432358_fix_xpcshell_test.patch"
           class=""
        >Attachment #8950155</a> -
        Flags: review?(aryx.bugmail) &rarr; review+</div></div></div><div class="change-set" id="a1766506_363267"><div class="change" id="aa1766506_363267">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a1766506_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_363267" id="a1766506_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1766506_363267"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1766506_363267">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#a1766506_363267">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-12 05:09 PST" data-time="1518440972">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Keywords: <a href="/buglist.cgi?keywords=checkin-needed&amp;resolution=---">checkin-needed</a></div></div></div><div class="change-set" id="c65"><div class="comment" data-id="13035650" data-no="65"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-65" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a1766506_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a1766506_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-65"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-65" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c65">Comment 65</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-12 05:10 PST" data-time="1518441002">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-65">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-65" data-comment-id="13035650">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8950155" name="attach_8950155" title="bug_1432358_fix_xpcshell_test.patch">attachment 8950155</a> <a href="/attachment.cgi?id=8950155&amp;action=edit" title="bug_1432358_fix_xpcshell_test.patch">[details]</a> <a href="/attachment.cgi?id=8950155&amp;action=diff" title="bug_1432358_fix_xpcshell_test.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1432358&amp;attachment=8950155'>[review]</a>
bug_1432358_fix_xpcshell_test.patch

Setting sec-approval for this part as well since it's only a test timeout update.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8950155&amp;action=edit"
           title="bug_1432358_fix_xpcshell_test.patch"
           class=""
        >Attachment #8950155</a> -
        Flags: sec-approval+</div></div></div><div class="change-set" id="c66"><div class="comment" data-id="13035666" data-no="66"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-66" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_258347" id="a1766506_363267"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_258347" id="a1766506_363267"><a class="email " href="/user_profile?user_id=258347" > <span class="fna">Sebastian Hengst [:aryx] (needinfo on intermittent or backout)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-66"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-66" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c66">Comment 66</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-12 05:22 PST" data-time="1518441742">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-66">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-66" data-comment-id="13035666">Pushed this before lunch:
<a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/91c948c94506089d6f40dc59d13c75ab78ce914d">https://hg.mozilla.org/integration/mozilla-inbound/rev/91c948c94506089d6f40dc59d13c75ab78ce914d</a>
<a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/a67e95bd0ccf13faa26aaa6b56fd1d826a7608ec">https://hg.mozilla.org/integration/mozilla-inbound/rev/a67e95bd0ccf13faa26aaa6b56fd1d826a7608ec</a>
<a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/2fa11c525da3d0c7ca58a593241c1902f2849528">https://hg.mozilla.org/integration/mozilla-inbound/rev/2fa11c525da3d0c7ca58a593241c1902f2849528</a>
<a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/ef7b8eef07c1181cec03246e40807d6051f971c9">https://hg.mozilla.org/integration/mozilla-inbound/rev/ef7b8eef07c1181cec03246e40807d6051f971c9</a></pre></div><div class="change-set" id="a1767295_258347"><div class="change" id="aa1767295_258347">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_258347" id="a1767295_258347"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_258347" id="a1767295_258347"><a class="email " href="/user_profile?user_id=258347" > <span class="fna">Sebastian Hengst [:aryx] (needinfo on intermittent or backout)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1767295_258347"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1767295_258347">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#a1767295_258347">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-12 05:22 PST" data-time="1518441761">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Keywords: <span class="activity-deleted"><a href="/buglist.cgi?keywords=checkin-needed&amp;resolution=---">checkin-needed</a></span></div></div></div><div class="change-set" id="c67"><div class="comment" data-id="13036580" data-no="67"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-67" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_258347" id="a1767295_258347"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_258347" id="a1767295_258347"><a class="email " href="/user_profile?user_id=258347" > <span class="fna">Sebastian Hengst [:aryx] (needinfo on intermittent or backout)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-67"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-67" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c67">Comment 67</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-12 10:05 PST" data-time="1518458704">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-67">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-67" data-comment-id="13036580">Backed out for failing xpcshell's test_ext_contentscript_triggeringPrincipal.js on Windows debug:

<a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/5d726f46260f0d96dba2ec23d5b01375f588c6e1">https://hg.mozilla.org/integration/mozilla-inbound/rev/5d726f46260f0d96dba2ec23d5b01375f588c6e1</a>

First push which ran failing jobs: <a rel="nofollow" href="https://treeherder.mozilla.org/#/jobs?repo=mozilla-inbound&amp;revision=50145ed826265cd5e228fb7d973b871359ca2213&amp;filter-resultStatus=testfailed&amp;filter-resultStatus=busted&amp;filter-resultStatus=exception&amp;filter-resultStatus=retry">https://treeherder.mozilla.org/#/jobs?repo=mozilla-inbound&amp;revision=50145ed826265cd5e228fb7d973b871359ca2213&amp;filter-resultStatus=testfailed&amp;filter-resultStatus=busted&amp;filter-resultStatus=exception&amp;filter-resultStatus=retry</a>
Failure log: <a rel="nofollow" href="https://treeherder.mozilla.org/logviewer.html#?job_id=161700807&amp;repo=mozilla-inbound">https://treeherder.mozilla.org/logviewer.html#?job_id=161700807&amp;repo=mozilla-inbound</a>

16:20:22     INFO -  &quot;Got CSP report for forbidden URL <a rel="nofollow" href="http://localhost:51627/audio-source.webm?origin=page&amp;source=pageScript-relative-url">http://localhost:51627/audio-source.webm?origin=page&amp;source=pageScript-relative-url</a>&quot;
16:20:22     INFO -  &quot;Got CSP report for forbidden URL <a rel="nofollow" href="http://localhost:51627/video.webm?origin=page&amp;source=pageScript-relative-url">http://localhost:51627/video.webm?origin=page&amp;source=pageScript-relative-url</a>&quot;
16:20:22     INFO -  &quot;Got CSP report for forbidden URL <a rel="nofollow" href="http://localhost:51627/video-source.webm?origin=page&amp;source=pageScript-relative-url">http://localhost:51627/video-source.webm?origin=page&amp;source=pageScript-relative-url</a>&quot;
16:20:22     INFO -  &lt;&lt;&lt;&lt;&lt;&lt;&lt;
16:20:22     INFO -  mozcrash kill_pid(): wait failed (-1) terminating pid 11692: error 5
16:20:22     INFO -  xpcshell return code: None
16:20:22     INFO -  xpcshell-e10s.ini:toolkit/components/extensions/test/xpcshell/test_ext_contentscript_triggeringPrincipal.js | Process still running after test!
16:20:22     INFO -  TEST-START | xpcshell-remote.ini:toolkit/components/extensions/test/xpcshell/test_ext_contentscript_triggeringPrincipal.js
16:30:22  WARNING -  TEST-UNEXPECTED-TIMEOUT | xpcshell-remote.ini:toolkit/components/extensions/test/xpcshell/test_ext_contentscript_triggeringPrincipal.js | Test timed out
16:30:22     INFO -  TEST-INFO took 600000ms
16:30:22     INFO -  &gt;&gt;&gt;&gt;&gt;&gt;&gt;</pre><div class="activity"><div class="change">Flags: needinfo?(ckerschb)</div></div></div><div class="change-set" id="c68"><div class="comment" data-id="13036676" data-no="68"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-68" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a1767295_258347"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a1767295_258347"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-68"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-68" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c68">Comment 68</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-12 10:26 PST" data-time="1518459985">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-68">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-68" data-comment-id="13036676">(In reply to Sebastian Hengst [:aryx][:archaeopteryx] (needinfo on intermittent or backout) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Universal CSP strict-dynamic bypass via require.js of browser resource"
   href="/show_bug.cgi?id=1432358#c67">comment #67</a>)
<span class="quote">&gt; Backed out for failing xpcshell's
&gt; test_ext_contentscript_triggeringPrincipal.js on Windows debug:</span >

No idea why. Kris, any idea what might be wrong? Would you be strictly against disabling the test on windows debug or is that an option?</pre><div class="activity"><div class="change">Flags: needinfo?(ckerschb) &rarr; needinfo?(kmaglione+bmo)</div></div></div><div class="change-set" id="a2102749_363267"><div class="change" id="aa2102749_363267">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a2102749_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_363267" id="a2102749_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a2102749_363267"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a2102749_363267">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#a2102749_363267">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-16 02:33 PST" data-time="1518777215">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_NEW"
   title="NEW - Re-Enable test_ext_contentscript_triggeringPrincipal.js on Windows Debug"
   href="/show_bug.cgi?id=1438796">1438796</a></div></div></div><div class="change-set" id="c69"><div class="comment" data-id="13047144" data-no="69"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-69" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a2102749_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a2102749_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-69"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-69" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c69">Comment 69</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-16 02:38 PST" data-time="1518777527">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-69">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8951547"
         class="attachment patch"
         data-id="8951547" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug_1432358_fix_xpcshell_test.patch">
      <meta itemprop="contentSize" content="1152">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8951547">
          <a class="link" href="attachment.cgi?id=8951547&amp;action=diff">
        <span id="att-8951547-description" itemprop="description">bug_1432358_fix_xpcshell_test.patch</span></a>
        — <a href="attachment.cgi?id=8951547&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1432358&attachment=8951547">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-69" data-comment-id="13047144">As discussed, going ahead and disabling the test to get this sec-high bug landed. I filed <a class="bz_bug_link
          bz_status_NEW"
   title="NEW - Re-Enable test_ext_contentscript_triggeringPrincipal.js on Windows Debug"
   href="/show_bug.cgi?id=1438796">Bug 1438796</a> to figure out the problem and re-enable the test.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8950155&amp;action=edit"
           title="bug_1432358_fix_xpcshell_test.patch"
           class=""
        >Attachment #8950155</a> -
        Attachment is obsolete: true</div><div class="change">Flags: <span class="activity-deleted">needinfo?(kmaglione+bmo)</span></div><div class="change">
        <a href="/attachment.cgi?id=8951547&amp;action=edit"
           title="bug_1432358_fix_xpcshell_test.patch"
           class=""
        >Attachment #8951547</a> -
        Flags: review?(aryx.bugmail)</div></div></div><div class="change-set" id="a2116040_258347"><div class="change" id="aa2116040_258347">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_258347" id="a2116040_258347"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_258347" id="a2116040_258347"><a class="email " href="/user_profile?user_id=258347" > <span class="fna">Sebastian Hengst [:aryx] (needinfo on intermittent or backout)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a2116040_258347"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a2116040_258347">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#a2116040_258347">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-16 06:15 PST" data-time="1518790506">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8951547&amp;action=edit"
           title="bug_1432358_fix_xpcshell_test.patch"
           class=""
        >Attachment #8951547</a> -
        Flags: review?(aryx.bugmail) &rarr; review+</div></div></div><div class="change-set" id="c70"><div class="comment" data-id="13050281" data-no="70"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-70" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a2116040_258347"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a2116040_258347"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-70"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-70" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c70">Comment 70</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-18 03:38 PST" data-time="1518953924">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-70">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-70" data-comment-id="13050281">Comment on <span class=""><a href="/attachment.cgi?id=8951547" name="attach_8951547" title="bug_1432358_fix_xpcshell_test.patch">attachment 8951547</a> <a href="/attachment.cgi?id=8951547&amp;action=edit" title="bug_1432358_fix_xpcshell_test.patch">[details]</a> <a href="/attachment.cgi?id=8951547&amp;action=diff" title="bug_1432358_fix_xpcshell_test.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1432358&amp;attachment=8951547'>[review]</a>
bug_1432358_fix_xpcshell_test.patch

Setting sec-approval on this one as well since it's only a tmp disable of a windows debug test.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8951547&amp;action=edit"
           title="bug_1432358_fix_xpcshell_test.patch"
           class=""
        >Attachment #8951547</a> -
        Flags: sec-approval+</div></div></div><div class="change-set" id="a2279479_363267"><div class="change" id="aa2279479_363267">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a2279479_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_363267" id="a2279479_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a2279479_363267"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a2279479_363267">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#a2279479_363267">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-18 03:39 PST" data-time="1518953945">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Keywords: <a href="/buglist.cgi?keywords=checkin-needed&amp;resolution=---">checkin-needed</a></div></div></div><div class="change-set" id="c71"><div class="comment" data-id="13050321" data-no="71"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-71" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_258347" id="a2279479_363267"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_258347" id="a2279479_363267"><a class="email " href="/user_profile?user_id=258347" > <span class="fna">Sebastian Hengst [:aryx] (needinfo on intermittent or backout)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-71"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-71" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c71">Comment 71</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-18 05:20 PST" data-time="1518960034">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-71">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-71" data-comment-id="13050321"><a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/fc871960d805efc5b3c4ac9e0682312d7bb23bda">https://hg.mozilla.org/integration/mozilla-inbound/rev/fc871960d805efc5b3c4ac9e0682312d7bb23bda</a>
<a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/a8b53e720ac7c35192eada9bf7c174df78105504">https://hg.mozilla.org/integration/mozilla-inbound/rev/a8b53e720ac7c35192eada9bf7c174df78105504</a>
<a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/93dcf59ff87e075acefb7fd7634c270519a857f8">https://hg.mozilla.org/integration/mozilla-inbound/rev/93dcf59ff87e075acefb7fd7634c270519a857f8</a>
<a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/9f37220bc5360c91a80278119a1ce2a4940d9aec">https://hg.mozilla.org/integration/mozilla-inbound/rev/9f37220bc5360c91a80278119a1ce2a4940d9aec</a></pre><div class="activity"><div class="change">Keywords: <span class="activity-deleted"><a href="/buglist.cgi?keywords=checkin-needed&amp;resolution=---">checkin-needed</a></span></div></div></div><div class="change-set" id="c72"><div class="comment" data-id="13050328" data-no="72"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-72" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_258347" id="a2279479_363267"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_258347" id="a2279479_363267"><a class="email " href="/user_profile?user_id=258347" > <span class="fna">Sebastian Hengst [:aryx] (needinfo on intermittent or backout)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-72"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-72" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c72">Comment 72</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-18 05:33 PST" data-time="1518960795">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-72">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-72" data-comment-id="13050328">Test annotation fix: <a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/d4aa33646f8bb62025644f240b71af17a854fcca">https://hg.mozilla.org/integration/mozilla-inbound/rev/d4aa33646f8bb62025644f240b71af17a854fcca</a></pre></div><div class="change-set" id="c73"><div class="comment" data-id="13050643" data-no="73"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-73" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_258347" id="a2279479_363267"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_258347" id="a2279479_363267"><a class="email " href="/user_profile?user_id=258347" > <span class="fna">Sebastian Hengst [:aryx] (needinfo on intermittent or backout)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-73"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-73" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c73">Comment 73</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-18 14:13 PST" data-time="1518991999">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-73">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-73" data-comment-id="13050643"><a rel="nofollow" href="https://hg.mozilla.org/mozilla-central/rev/fc871960d805">https://hg.mozilla.org/mozilla-central/rev/fc871960d805</a>
<a rel="nofollow" href="https://hg.mozilla.org/mozilla-central/rev/a8b53e720ac7">https://hg.mozilla.org/mozilla-central/rev/a8b53e720ac7</a>
<a rel="nofollow" href="https://hg.mozilla.org/mozilla-central/rev/93dcf59ff87e">https://hg.mozilla.org/mozilla-central/rev/93dcf59ff87e</a>
<a rel="nofollow" href="https://hg.mozilla.org/mozilla-central/rev/9f37220bc536">https://hg.mozilla.org/mozilla-central/rev/9f37220bc536</a>
<a rel="nofollow" href="https://hg.mozilla.org/mozilla-central/rev/d4aa33646f8b">https://hg.mozilla.org/mozilla-central/rev/d4aa33646f8b</a></pre><div class="activity"><div class="change">Status: ASSIGNED &rarr; RESOLVED</div><div class="change">Closed: <span class="rel-time" title="2018-02-18 14:13 PST" data-time="1518991999">4 years ago</span></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox60&amp;o1=isnotempty">status-firefox60</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox60&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox60&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">Resolution: --- &rarr; FIXED</div><div class="change">Target Milestone: --- &rarr; mozilla60</div></div></div><div class="change-set" id="a2452677_353206"><div class="change" id="aa2452677_353206">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_353206" id="a2452677_353206"><img src="https://secure.gravatar.com/avatar/cc5bc8d9afda0459276592e8ce5a2265?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_353206" id="a2452677_353206"><a class="email " href="/user_profile?user_id=353206" > <span class="fna">Gingerbread Man</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a2452677_353206"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a2452677_353206">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#a2452677_353206">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-20 03:45 PST" data-time="1519127143">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox nightly shows XML content as plain text"
   href="/show_bug.cgi?id=1439444">1439444</a></div></div></div><div class="change-set" id="a2495366_1689"><div class="change" id="aa2495366_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a2495366_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a2495366_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a2495366_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a2495366_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#a2495366_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-20 15:37 PST" data-time="1519169832">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: dom-core-security &rarr; core-security-release</div></div></div><div class="change-set" id="c74"><div class="comment" data-id="13058650" data-no="74"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-74" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a2495366_1689"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a2495366_1689"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-74"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-74" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c74">Comment 74</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-21 10:32 PST" data-time="1519237962">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-74">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-74" data-comment-id="13058650">Comment on <span class=""><a href="/attachment.cgi?id=8945420" name="attach_8945420" title="bug_1432358_apply_csp_to_resource.patch">attachment 8945420</a> <a href="/attachment.cgi?id=8945420&amp;action=edit" title="bug_1432358_apply_csp_to_resource.patch">[details]</a> <a href="/attachment.cgi?id=8945420&amp;action=diff" title="bug_1432358_apply_csp_to_resource.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1432358&amp;attachment=8945420'>[review]</a>
bug_1432358_apply_csp_to_resource.patch

Approval Request Comment
[Feature/Bug causing the regression]:
That problem has been around for a long time. If I would have to pick a bug (even though it's not the root cause of the problem, but allowed us to reveal the problem) then I would choose <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - CSP: Implement 'strict-dynamic'"
   href="/show_bug.cgi?id=1299483">Bug 1299483</a> - CSP: Implement 'strict-dynamic'.

[User impact if declined]:
Universal CSP bypass using browser internals.

[Is this code covered by automated tests?]:
Yes, automatet test is attached to this bug.

[Has the fix been verified in Nightly?]:
No, not yet.

[Needs manual test from QE? If yes, steps to reproduce]:
No, has automated test which is sufficient.

[List of other uplifts needed for the feature/fix]:
none

[Is the change risky?]:
There is low risk involved in a sense that a page having CSP might block a content exposed chrome: URL which gets loaded by a webpage.

[Why is the change risky/not risky?]:
see previous comment

[String changes made/needed]:
no</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8945420&amp;action=edit"
           title="bug_1432358_apply_csp_to_resource.patch"
           class=""
        >Attachment #8945420</a> -
        Flags: approval-mozilla-beta?</div></div></div><div class="change-set" id="c75"><div class="comment" data-id="13058655" data-no="75"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-75" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a2495366_1689"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a2495366_1689"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-75"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-75" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c75">Comment 75</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-21 10:33 PST" data-time="1519238015">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-75">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-75" data-comment-id="13058655">Comment on <span class=""><a href="/attachment.cgi?id=8945421" name="attach_8945421" title="bug_1432358_test_subjecttocsp.patch">attachment 8945421</a> <a href="/attachment.cgi?id=8945421&amp;action=edit" title="bug_1432358_test_subjecttocsp.patch">[details]</a> <a href="/attachment.cgi?id=8945421&amp;action=diff" title="bug_1432358_test_subjecttocsp.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1432358&amp;attachment=8945421'>[review]</a>
bug_1432358_test_subjecttocsp.patch

Approval Request Comment
See <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Universal CSP strict-dynamic bypass via require.js of browser resource"
   href="/show_bug.cgi?id=1432358#c74">Comment 74</a></pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8945421&amp;action=edit"
           title="bug_1432358_test_subjecttocsp.patch"
           class=""
        >Attachment #8945421</a> -
        Flags: approval-mozilla-beta?</div></div></div><div class="change-set" id="c76"><div class="comment" data-id="13058656" data-no="76"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-76" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a2495366_1689"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a2495366_1689"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-76"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-76" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c76">Comment 76</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-21 10:33 PST" data-time="1519238031">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-76">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-76" data-comment-id="13058656">Comment on <span class=""><a href="/attachment.cgi?id=8947427" name="attach_8947427" title="bug_1432358_update_overridescsp.patch">attachment 8947427</a> <a href="/attachment.cgi?id=8947427&amp;action=edit" title="bug_1432358_update_overridescsp.patch">[details]</a> <a href="/attachment.cgi?id=8947427&amp;action=diff" title="bug_1432358_update_overridescsp.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1432358&amp;attachment=8947427'>[review]</a>
bug_1432358_update_overridescsp.patch

Approval Request Comment
See <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Universal CSP strict-dynamic bypass via require.js of browser resource"
   href="/show_bug.cgi?id=1432358#c74">Comment 74</a></pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8947427&amp;action=edit"
           title="bug_1432358_update_overridescsp.patch"
           class=""
        >Attachment #8947427</a> -
        Flags: approval-mozilla-beta?</div></div></div><div class="change-set" id="c77"><div class="comment" data-id="13058658" data-no="77"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-77" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a2495366_1689"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a2495366_1689"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-77"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-77" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c77">Comment 77</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-21 10:34 PST" data-time="1519238048">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-77">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-77" data-comment-id="13058658">Comment on <span class=""><a href="/attachment.cgi?id=8947428" name="attach_8947428" title="bug_1432358_channel_csp_agnostic.patch">attachment 8947428</a> <a href="/attachment.cgi?id=8947428&amp;action=edit" title="bug_1432358_channel_csp_agnostic.patch">[details]</a> <a href="/attachment.cgi?id=8947428&amp;action=diff" title="bug_1432358_channel_csp_agnostic.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1432358&amp;attachment=8947428'>[review]</a>
bug_1432358_channel_csp_agnostic.patch

Approval Request Comment
See <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Universal CSP strict-dynamic bypass via require.js of browser resource"
   href="/show_bug.cgi?id=1432358#c74">Comment 74</a></pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8947428&amp;action=edit"
           title="bug_1432358_channel_csp_agnostic.patch"
           class=""
        >Attachment #8947428</a> -
        Flags: approval-mozilla-beta?</div></div></div><div class="change-set" id="c78"><div class="comment" data-id="13058660" data-no="78"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-78" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a2495366_1689"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a2495366_1689"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-78"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-78" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c78">Comment 78</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-21 10:34 PST" data-time="1519238066">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-78">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-78" data-comment-id="13058660">Comment on <span class=""><a href="/attachment.cgi?id=8951547" name="attach_8951547" title="bug_1432358_fix_xpcshell_test.patch">attachment 8951547</a> <a href="/attachment.cgi?id=8951547&amp;action=edit" title="bug_1432358_fix_xpcshell_test.patch">[details]</a> <a href="/attachment.cgi?id=8951547&amp;action=diff" title="bug_1432358_fix_xpcshell_test.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1432358&amp;attachment=8951547'>[review]</a>
bug_1432358_fix_xpcshell_test.patch

Approval Request Comment
See <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Universal CSP strict-dynamic bypass via require.js of browser resource"
   href="/show_bug.cgi?id=1432358#c74">Comment 74</a></pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8951547&amp;action=edit"
           title="bug_1432358_fix_xpcshell_test.patch"
           class=""
        >Attachment #8951547</a> -
        Flags: approval-mozilla-beta?</div></div></div><div class="change-set" id="a2563767_363267"><div class="change" id="aa2563767_363267">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a2563767_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_363267" id="a2563767_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a2563767_363267"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a2563767_363267">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#a2563767_363267">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-21 10:37 PST" data-time="1519238233">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE - The image is wrongly displayed if the &quot;View Image&quot; option is used"
   href="/show_bug.cgi?id=1439964">1439964</a></div></div></div><div class="change-set" id="c79"><div class="comment" data-id="13058699" data-no="79"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-79" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a2563767_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a2563767_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-79"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-79" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c79">Comment 79</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-21 10:45 PST" data-time="1519238734">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-79">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-79" data-comment-id="13058699">Comment on <span class=""><a href="/attachment.cgi?id=8945420" name="attach_8945420" title="bug_1432358_apply_csp_to_resource.patch">attachment 8945420</a> <a href="/attachment.cgi?id=8945420&amp;action=edit" title="bug_1432358_apply_csp_to_resource.patch">[details]</a> <a href="/attachment.cgi?id=8945420&amp;action=diff" title="bug_1432358_apply_csp_to_resource.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1432358&amp;attachment=8945420'>[review]</a>
bug_1432358_apply_csp_to_resource.patch

Just discussed things we Gijs again and it seems it's probably not worth uplifting that change, given the possibility that this might break some pages.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8945420&amp;action=edit"
           title="bug_1432358_apply_csp_to_resource.patch"
           class=""
        >Attachment #8945420</a> -
        Flags: <span class="activity-deleted">approval-mozilla-beta?</span></div></div></div><div class="change-set" id="a2564287_363267"><div class="change" id="aa2564287_363267">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a2564287_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_363267" id="a2564287_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a2564287_363267"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a2564287_363267">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#a2564287_363267">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-21 10:45 PST" data-time="1519238753">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8945421&amp;action=edit"
           title="bug_1432358_test_subjecttocsp.patch"
           class=""
        >Attachment #8945421</a> -
        Flags: <span class="activity-deleted">approval-mozilla-beta?</span></div></div></div><div class="change-set" id="a2564301_363267"><div class="change" id="aa2564301_363267">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a2564301_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_363267" id="a2564301_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a2564301_363267"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a2564301_363267">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#a2564301_363267">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-21 10:46 PST" data-time="1519238767">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8947427&amp;action=edit"
           title="bug_1432358_update_overridescsp.patch"
           class=""
        >Attachment #8947427</a> -
        Flags: <span class="activity-deleted">approval-mozilla-beta?</span></div></div></div><div class="change-set" id="a2564317_363267"><div class="change" id="aa2564317_363267">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a2564317_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_363267" id="a2564317_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a2564317_363267"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a2564317_363267">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#a2564317_363267">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-21 10:46 PST" data-time="1519238783">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8947428&amp;action=edit"
           title="bug_1432358_channel_csp_agnostic.patch"
           class=""
        >Attachment #8947428</a> -
        Flags: <span class="activity-deleted">approval-mozilla-beta?</span></div></div></div><div class="change-set" id="a2564330_363267"><div class="change" id="aa2564330_363267">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a2564330_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_363267" id="a2564330_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a2564330_363267"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a2564330_363267">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#a2564330_363267">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-21 10:46 PST" data-time="1519238796">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8951547&amp;action=edit"
           title="bug_1432358_fix_xpcshell_test.patch"
           class=""
        >Attachment #8951547</a> -
        Flags: <span class="activity-deleted">approval-mozilla-beta?</span></div></div></div><div class="change-set" id="c80"><div class="comment" data-id="13059387" data-no="80"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-80" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a2564330_363267"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a2564330_363267"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-80"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-80" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c80">Comment 80</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-21 14:09 PST" data-time="1519250962">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-80">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-80" data-comment-id="13059387">Updating status flags per the recent discussion in the bug and with Dan on IRC. That said, it isn't clear to me if ESR52 is wontfix at this point or if we'd still want to try to ship a fix in 52.8 after this has had more opportunity for testing.</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox59&amp;o1=isnotempty">status-firefox59</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox59&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox59&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr52&amp;o1=isnotempty">tracking-firefox-esr52</a>:
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr52&amp;o1=equals&amp;v1=59%2B">59+</a> &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox_esr52&amp;o1=equals&amp;v1=%3F">?</a></div><div class="change">Flags: in-testsuite+</div></div></div><div class="change-set" id="c81"><div class="comment" data-id="13059440" data-no="81"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-81" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a2564330_363267"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a2564330_363267"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-81"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-81" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c81">Comment 81</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-21 14:30 PST" data-time="1519252203">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-81">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-81" data-comment-id="13059440">(In reply to Christoph Kerschbaumer [:ckerschb] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Universal CSP strict-dynamic bypass via require.js of browser resource"
   href="/show_bug.cgi?id=1432358#c79">comment #79</a>)
<span class="quote">&gt; Comment on <span class=""><a href="/attachment.cgi?id=8945420" name="attach_8945420" title="bug_1432358_apply_csp_to_resource.patch">attachment 8945420</a> <a href="/attachment.cgi?id=8945420&amp;action=edit" title="bug_1432358_apply_csp_to_resource.patch">[details]</a> <a href="/attachment.cgi?id=8945420&amp;action=diff" title="bug_1432358_apply_csp_to_resource.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1432358&amp;attachment=8945420'>[review]</a></span >

When we've got 6 exceptions in that code to using the protocol flag we're clearly doing something wrong. Clearly the URI_IS_LOCAL_RESOURCE flag isn't as good a fit as we first thought. Maybe we need to add a special purpose URI_SOMETHING_CSP_SOMETHING flag and add that to the few places left.

The specific PoC in this bug uses a copy of require.js that was not web-exposed in Firefox 52. Maybe we don't need to backport to ESR.</pre></div><div class="change-set" id="c82"><div class="comment" data-id="13062742" data-no="82"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-82" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a2564330_363267"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a2564330_363267"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-82"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-82" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c82">Comment 82</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-22 15:12 PST" data-time="1519341120">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-82">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-82" data-comment-id="13062742">Christoph, what are your thoughts RE: the last 2 comments?</pre><div class="activity"><div class="change">Flags: needinfo?(ckerschb)</div></div></div><div class="change-set" id="c83"><div class="comment" data-id="13063382" data-no="83"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-83" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a2564330_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a2564330_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-83"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-83" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c83">Comment 83</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-23 00:16 PST" data-time="1519373797">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-83">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-83" data-comment-id="13063382">(In reply to Ryan VanderMeulen [:RyanVM] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Universal CSP strict-dynamic bypass via require.js of browser resource"
   href="/show_bug.cgi?id=1432358#c82">comment #82</a>)
<span class="quote">&gt; Christoph, what are your thoughts RE: the last 2 comments?</span >

I agree to both of the above 2 comments. First, I don't think we should backport this to ESR. Second, probably there is a better solution than relying on URI_IS_LOCAL_RESOURCE and we should revisit that decision eventually. For now, it seems like the right fix for this bug.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(ckerschb)</span></div></div></div><div class="change-set" id="a2731316_75935"><div class="change" id="aa2731316_75935">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a2731316_75935"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_75935" id="a2731316_75935"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a2731316_75935"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a2731316_75935">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#a2731316_75935">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-23 09:09 PST" data-time="1519405782">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr52&amp;o1=isnotempty">status-firefox-esr52</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox_esr52&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr52&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr52&amp;o1=isnotempty">tracking-firefox-esr52</a>:
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr52&amp;o1=equals&amp;v1=%3F">?</a> &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox_esr52&amp;o1=equals&amp;v1=-">-</a></div></div></div><div class="change-set" id="a3939019_29811"><div class="change" id="aa3939019_29811">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_29811" id="a3939019_29811"><img src="https://secure.gravatar.com/avatar/20697ca69672a5276f24a34382a1ddbd?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_29811" id="a3939019_29811"><a class="email " href="/user_profile?user_id=29811" > <span class="fna">Wayne Mery (:wsmwk)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a3939019_29811"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a3939019_29811">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#a3939019_29811">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-03-09 08:38 PST" data-time="1520613485">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Crash in nsDocument::InitCSP via nsHTMLDocument::StartDocumentLoad"
   href="/show_bug.cgi?id=1443110">1443110</a></div></div></div><div class="change-set" id="a5418144_434339"><div class="change" id="aa5418144_434339">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_434339" id="a5418144_434339"><img src="https://secure.gravatar.com/avatar/9a0a16bc1cb5b0144e373deb8e357804?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_434339" id="a5418144_434339"><a class="email disabled" href="/user_profile?user_id=434339" > <span class="fna">Paul Theriault [:pauljt] (no longer reading bugmail)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a5418144_434339"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a5418144_434339">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#a5418144_434339">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-03-26 12:30 PDT" data-time="1522092610">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: sec-bounty?</div></div></div><div class="change-set" id="c84"><div class="comment" data-id="13174343" data-no="84"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-84" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a5418144_434339"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a5418144_434339"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-84"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-84" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c84">Comment 84</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-04-02 10:40 PDT" data-time="1522690804">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-84">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-84" data-comment-id="13174343">CSP bypass bugs should be capped to sec-moderate because (at this point, at least) it's a little-used mitigation that sites can opt in to. Even with the bypass the victim site must have a serious security bug itself.</pre><div class="activity"><div class="change">Flags: sec-bounty? &rarr; sec-bounty+</div><div class="change">Keywords: <a href="/buglist.cgi?keywords=sec-high&amp;resolution=---">sec-high</a> &rarr; <a href="/buglist.cgi?keywords=sec-moderate&amp;resolution=---">sec-moderate</a></div></div></div><div class="change-set" id="c85"><div class="comment" data-id="13175670" data-no="85"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-85" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a5418144_434339"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a5418144_434339"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-85"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-85" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c85">Comment 85</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-04-03 01:21 PDT" data-time="1522743690">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-85">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-85" data-comment-id="13175670">(In reply to Daniel Veditz [:dveditz] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Universal CSP strict-dynamic bypass via require.js of browser resource"
   href="/show_bug.cgi?id=1432358#c84">comment #84</a>)
<span class="quote">&gt; CSP bypass bugs should be capped to sec-moderate because (at this point, at
&gt; least) it's a little-used mitigation that sites can opt in to. Even with the
&gt; bypass the victim site must have a serious security bug itself.</span >

I'm not arguing against the rating, but there are scenarios around CSP sandbox, that don't involve the web page being vulnerable.</pre></div><div class="change-set" id="a8195838_280903"><div class="change" id="aa8195838_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a8195838_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a8195838_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a8195838_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a8195838_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#a8195838_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-04-27 16:05 PDT" data-time="1524870304">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: [domsecurity-active] &rarr; [domsecurity-active][adv-main60+]</div></div></div><div class="change-set" id="a8467345_280903"><div class="change" id="aa8467345_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a8467345_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a8467345_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a8467345_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a8467345_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#a8467345_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-04-30 19:30 PDT" data-time="1525141811">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Alias: CVE-2018-5175</div></div></div><div class="change-set" id="c86"><div class="comment" data-id="13252468" data-no="86"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-86" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_588744" id="a8467345_280903"><img src="https://secure.gravatar.com/avatar/8641c9f2c9af8263df2208974cf26aab?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_588744" id="a8467345_280903"><a class="email " href="/user_profile?user_id=588744" > <span class="fna">Emil Ghitta, QA [:emilghitta]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-86"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-86" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#c86">Comment 86</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-05-03 09:00 PDT" data-time="1525363240">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-86">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-86" data-comment-id="13252468">I have managed to reproduce this issue using Firefox 60.0a1(BuildId:20180122220231).

This issue is verified fixed using Firefox 61.0a1(BuildId:20180503100146) and Firefox 60.0(BuildId:20180430165945) on Windows 10 64bit, macOS 10.13.3 and Ubuntu 16.04 64bit.</pre><div class="activity"><div class="change">Status: RESOLVED &rarr; VERIFIED</div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox60&amp;o1=isnotempty">status-firefox60</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox60&amp;o1=equals&amp;v1=fixed">fixed</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox60&amp;o1=equals&amp;v1=verified">verified</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox61&amp;o1=isnotempty">status-firefox61</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox61&amp;o1=equals&amp;v1=verified">verified</a></div></div></div><div class="change-set" id="a24782178_1689"><div class="change" id="aa24782178_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a24782178_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a24782178_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a24782178_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a24782178_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1432358#a24782178_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-11-05 14:24 PST" data-time="1541456644">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: <span class="activity-deleted">core-security-release</span></div></div></div><div id="new-comment-notice">
          You need to <a href="/show_bug.cgi?id=1432358&amp;GoAheadAndLogIn=1">log in</a>
          before you can comment on or make changes to this bug.
        </div>



<div id="bottom-actions">
  <div id="bottom-right-actions">
    <button type="button" id="top-btn" class="secondary" aria-label="Go to Page Top">Top &uarr;</button>
  </div>
</div></div> 
</main> 
</div> 


</body>
</html>