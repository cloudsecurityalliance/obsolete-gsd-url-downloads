<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="UTF-8">
<meta property="og:type" content="website">
<meta property="og:title" content="1647078 - (CVE-2020-15647) content:// provider allows websites to remotely steal any file from the device if the path is known">
<meta property="og:url" content="https://bugzilla.mozilla.org/show_bug.cgi?id=1647078">
<meta property="og:description"
      content="VERIFIED (agi) in Firefox for Android Graveyard - General. Last updated 2021-03-15.">
<meta name="twitter:label1" value="Type">
<meta name="twitter:data1" value="defect">
<meta name="twitter:label2" value="Priority">
<meta name="twitter:data2" value="P1">

    <meta name="viewport" content="width=1024">
    <meta name="color-scheme" content="dark light">
    <meta name="generator" content="Bugzilla 20211025.1">
    <meta name="bugzilla-global" content="dummy"
        id="bugzilla-global" data-bugzilla="{&quot;api_token&quot;:&quot;&quot;,&quot;config&quot;:{&quot;basepath&quot;:&quot;\/&quot;},&quot;constant&quot;:{&quot;COMMENT_COLS&quot;:80},&quot;param&quot;:{&quot;maxattachmentsize&quot;:&quot;10240&quot;,&quot;maxusermatches&quot;:&quot;50&quot;,&quot;splinter_base&quot;:&quot;\/page.cgi?id=splinter.html&amp;ignore=\/&quot;},&quot;string&quot;:{&quot;bug_type_required&quot;:&quot;You must select a Type for this bug&quot;,&quot;component_required&quot;:&quot;You must select a Component for this bug&quot;,&quot;description_required&quot;:&quot;You must enter a Description for this bug&quot;,&quot;short_desc_required&quot;:&quot;You must enter a Summary for this bug&quot;,&quot;version_required&quot;:&quot;You must select a Version for this bug&quot;},&quot;user&quot;:{&quot;is_new&quot;:1,&quot;login&quot;:&quot;&quot;}}">
    <title>1647078 - (CVE-2020-15647) content:// provider allows websites to remotely steal any file from the device if the path is known</title>

<link rel="Top" href="/">

  


  
    <link rel="Show" title="Dependency Tree"
          href="/showdependencytree.cgi?id=1647078&amp;hide_resolved=1">
      <link rel="Show" title="Dependency Graph"
            href="/showdependencygraph.cgi?id=1647078">

      <link rel="Show" title="Bug Activity"
            href="/show_activity.cgi?id=1647078">

<link href="/static/v20211025.1/skins/yui.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/standard/global.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BugModal/web/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BMO/web/styles/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/EditComments/web/styles/inline-editor.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-structure-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-theme-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/lib/prism.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Needinfo/web/styles/needinfo.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Review/web/styles/badge.css" rel="stylesheet" type="text/css">



    
<script nonce="FwYcXRs52cc9ZdokC9TO9gL9Lzm8SXUrhZ5U4G92Z8831Q2f" src="/static/v20211025.1/js/jquery/jquery-min.js"></script><script nonce="FwYcXRs52cc9ZdokC9TO9gL9Lzm8SXUrhZ5U4G92Z8831Q2f" src="/static/v20211025.1/js/jquery/ui/jquery-ui-min.js"></script><script nonce="FwYcXRs52cc9ZdokC9TO9gL9Lzm8SXUrhZ5U4G92Z8831Q2f" src="/static/v20211025.1/js/yui.js"></script><script nonce="FwYcXRs52cc9ZdokC9TO9gL9Lzm8SXUrhZ5U4G92Z8831Q2f" src="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu-min.js"></script><script nonce="FwYcXRs52cc9ZdokC9TO9gL9Lzm8SXUrhZ5U4G92Z8831Q2f" src="/static/v20211025.1/js/jquery/plugins/devbridgeAutocomplete/devbridgeAutocomplete-min.js"></script><script nonce="FwYcXRs52cc9ZdokC9TO9gL9Lzm8SXUrhZ5U4G92Z8831Q2f" src="/static/v20211025.1/js/global.js"></script><script nonce="FwYcXRs52cc9ZdokC9TO9gL9Lzm8SXUrhZ5U4G92Z8831Q2f" src="/static/v20211025.1/js/util.js"></script><script nonce="FwYcXRs52cc9ZdokC9TO9gL9Lzm8SXUrhZ5U4G92Z8831Q2f" src="/static/v20211025.1/js/dropdown.js"></script>

      <script nonce="FwYcXRs52cc9ZdokC9TO9gL9Lzm8SXUrhZ5U4G92Z8831Q2f">
          YAHOO.namespace('bugzilla');
          if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
              YAHOO.util.Event._simpleRemove(window, "unload",
                                             YAHOO.util.Event._unload);
          }BUGZILLA.value_descs = JSON.parse('{\"bug_status\":{},\"resolution\":{\"\":\"---\"}}');

  
    var tracking_flags_str = "{\"flags\":{\"tracking\":{\"cf_status_firefox_esr78\":\"---\",\"cf_tracking_firefox94\":\"---\",\"cf_tracking_firefox_esr91\":\"---\",\"cf_status_firefox_esr68\":\"verified\",\"cf_tracking_firefox93\":\"---\",\"cf_tracking_firefox95\":\"---\",\"cf_status_firefox_esr91\":\"---\",\"cf_tracking_firefox_esr78\":\"---\",\"cf_status_firefox95\":\"---\",\"cf_status_firefox93\":\"---\",\"cf_status_firefox94\":\"---\",\"cf_tracking_firefox_relnote\":\"---\",\"cf_tracking_firefox_esr68\":\"78+\"},\"project\":{\"cf_tracking_firefox_sumo\":\"---\",\"cf_fission_milestone\":\"---\",\"cf_webcompat_priority\":\"---\",\"cf_root_cause\":\"---\"}},\"types\":[\"tracking\"],\"comments\":{\"cf_tracking_firefox95\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr78\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox93\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr68\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_sumo\":{\"none-needed\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox_relnote\":{\"?\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox_esr91\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox94\":{\"?\":\"[Tracking Requested - why for this release]:\"}}}";
    var TrackingFlags = $.parseJSON(tracking_flags_str);

  

  
  BUGZILLA.bug_id = 1647078;
  BUGZILLA.bug_title = '1647078 - (CVE-2020-15647) content:\/\/ provider allows websites to remotely steal any file from the device if the path is known';
  BUGZILLA.bug_summary = 'content:\/\/ provider allows websites to remotely steal any file from the device if the path is known';
  BUGZILLA.bug_url = 'https:\/\/bugzilla.mozilla.org\/show_bug.cgi?id=1647078';
  BUGZILLA.bug_keywords = 'csectype-sop, sec-critical',
  BUGZILLA.user = {
    id: 0,
    login: '',
    is_insider: false,
    is_timetracker: false,
    can_tag: false,
    timezone: 'America\/Los_Angeles',
    settings: {
      quote_replies: 'quoted_reply',
      zoom_textareas: true,
      remember_collapsed: true,
      inline_attachments: true,
      autosize_comments: false
    }
  };

  BUGZILLA.bug_secure = false;
      </script>
<script nonce="FwYcXRs52cc9ZdokC9TO9gL9Lzm8SXUrhZ5U4G92Z8831Q2f" src="/static/v20211025.1/extensions/BugModal/web/autosize.min.js"></script><script nonce="FwYcXRs52cc9ZdokC9TO9gL9Lzm8SXUrhZ5U4G92Z8831Q2f" src="/static/v20211025.1/extensions/ProdCompSearch/web/js/prod_comp_search.js"></script><script nonce="FwYcXRs52cc9ZdokC9TO9gL9Lzm8SXUrhZ5U4G92Z8831Q2f" src="/static/v20211025.1/extensions/BugModal/web/bug_modal.js"></script><script nonce="FwYcXRs52cc9ZdokC9TO9gL9Lzm8SXUrhZ5U4G92Z8831Q2f" src="/static/v20211025.1/extensions/BugModal/web/comments.js"></script><script nonce="FwYcXRs52cc9ZdokC9TO9gL9Lzm8SXUrhZ5U4G92Z8831Q2f" src="/static/v20211025.1/extensions/ComponentWatching/web/js/overlay.js"></script><script nonce="FwYcXRs52cc9ZdokC9TO9gL9Lzm8SXUrhZ5U4G92Z8831Q2f" src="/static/v20211025.1/js/bugzilla-readable-status-min.js"></script><script nonce="FwYcXRs52cc9ZdokC9TO9gL9Lzm8SXUrhZ5U4G92Z8831Q2f" src="/static/v20211025.1/js/field.js"></script><script nonce="FwYcXRs52cc9ZdokC9TO9gL9Lzm8SXUrhZ5U4G92Z8831Q2f" src="/static/v20211025.1/js/comments.js"></script><script nonce="FwYcXRs52cc9ZdokC9TO9gL9Lzm8SXUrhZ5U4G92Z8831Q2f" src="/static/v20211025.1/extensions/TrackingFlags/web/js/flags.js"></script><script nonce="FwYcXRs52cc9ZdokC9TO9gL9Lzm8SXUrhZ5U4G92Z8831Q2f" src="/static/v20211025.1/extensions/BMO/web/js/firefox-crash-table.js"></script><script nonce="FwYcXRs52cc9ZdokC9TO9gL9Lzm8SXUrhZ5U4G92Z8831Q2f" src="/static/v20211025.1/extensions/MozChangeField/web/js/severity-s1-priority-p1.js"></script><script nonce="FwYcXRs52cc9ZdokC9TO9gL9Lzm8SXUrhZ5U4G92Z8831Q2f" src="/static/v20211025.1/extensions/MozChangeField/web/js/clear-tracking-priority-s1.js"></script><script nonce="FwYcXRs52cc9ZdokC9TO9gL9Lzm8SXUrhZ5U4G92Z8831Q2f" src="/static/v20211025.1/extensions/MozChangeField/web/js/set-tracking-severity-s1.js"></script><script nonce="FwYcXRs52cc9ZdokC9TO9gL9Lzm8SXUrhZ5U4G92Z8831Q2f" src="/static/v20211025.1/js/lib/prism.js"></script><script nonce="FwYcXRs52cc9ZdokC9TO9gL9Lzm8SXUrhZ5U4G92Z8831Q2f" src="/static/v20211025.1/extensions/GoogleAnalytics/web/js/analytics.js"></script><script nonce="FwYcXRs52cc9ZdokC9TO9gL9Lzm8SXUrhZ5U4G92Z8831Q2f" src="/static/v20211025.1/js/lib/md5.min.js"></script><script nonce="FwYcXRs52cc9ZdokC9TO9gL9Lzm8SXUrhZ5U4G92Z8831Q2f" src="/static/v20211025.1/extensions/Review/web/js/badge.js"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla@Mozilla" href="/search_plugin.cgi"><link rel="shortcut icon" href="/extensions/BMO/web/images/favicon.ico">
<link rel="canonical" href="https://bugzilla.mozilla.org/show_bug.cgi?id=1647078">
<link rel="shorturl" href="https://bugzilla.mozilla.org/1647078"><meta name="google-analytics" content="UA-36116321-3" data-location="https://bugzilla.mozilla.org/bug/show-modal" data-title="1647078 - (CVE-2020-15647) content:// provider allows websites to remotely steal any file from the device if the path is known">
<script async src="https://www.google-analytics.com/analytics.js"></script><meta name="robots" content="noarchive">
  </head>



  <body
        class="bugzilla-mozilla-org
               skin-standard bug_modal yui-skin-sam">



<div id="wrapper">

<header id="header" role="banner">
  <div class="inner">
    <h1 id="header-title" class="title"><a href="https://bugzilla.mozilla.org/home" title="Go to home page">Bugzilla</a></h1>
    <form role="search" id="header-search" class="quicksearch" action="/buglist.cgi" data-no-csrf>
      <section class="searchbox-outer dropdown" role="combobox" aria-expanded="false" aria-haspopup="listbox"
               aria-labelledby="header-search-label" aria-owns="header-search-dropdown">
        <h2 id="header-search-label">Quick Search</h2>
        <span class="icon" aria-hidden="true"></span>
        <input role="searchbox" id="quicksearch_top" class="dropdown-button" name="quicksearch" autocomplete="off"
               value="" placeholder="Search Bugs"
               title="Enter a bug number or some search terms" aria-controls="header-search-dropdown"
               aria-label="Quick Search"><div id="header-search-dropdown" class="dropdown-content right" role="listbox" style="display: none;">
  <div id="header-search-dropdown-wrapper">
  </div>
</div>
      </section>
    </form>
    <nav id="header-nav">
      <ul class="links">
        <li class="link-browse">
          <a href="/describecomponents.cgi" title="Browse bugs by component">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Browse</span>
          </a>
        </li>
        <li class="link-search">
          <a href="/query.cgi?format=advanced" title="Search bugs using various criteria">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Advanced Search</span>
          </a>
        </li>
      </ul>
      <div class="dropdown">
        <button type="button" id="header-tools-menu-button" class="dropdown-button minor" title="More tools…"
                aria-label="More tools…" aria-expanded="false" aria-haspopup="true" aria-controls="header-tools-menu">
          <span class="icon" aria-hidden="true"></span>
        </button>
        <ul class="dropdown-content left" id="header-tools-menu" role="menu" style="display:none;">
          <li role="presentation">
            <a href="/report.cgi" role="menuitem" tabindex="-1">Reports</a>
          </li>
            <li role="separator"></li>
            <li role="presentation">
              <a href="https://bmo.readthedocs.io/en/latest/" role="menuitem" tabindex="-1">Documentation</a>
            </li>
        </ul>
      </div>
    </nav>
      <ul id="header-login" class="links">
          <li id="moz_new_account_container_top"><a href="/createaccount.cgi">New Account</a></li><li id="mini_login_container_top">
  <a id="login_link_top" href="/index.cgi?GoAheadAndLogIn=1"
     class='show_mini_login_form' data-qs-suffix="_top">Log In</a>

  <div id="mini_login_top" class="mini-popup mini_login bz_default_hidden"><span id="github_mini_login_top" class="mini_login_top">
    <form method="post" action="/github.cgi">
      <input type="hidden" name="github_secret" value="NBJgXHwB752WUVFT3NeK99gICStRFoYN06jQXABbe0NDFyn1qwna12Y8WrUxXNcUoL1Ei3DYUEmWFFLhzywxu1Zl44du3msyiJfD736Eo4uK8SRoZx08r2JNW3YORrDHKpw2ZBxH89olQko5ggccf7DpwdduLo8os55WOZ5LrWH9F3PQZjhxTSPfyiVAUpIRa1Cdx4ctMpbN5EjRGHzLxTQeW7EmXB7UmAg9FmoZwDUVRZa7eZ00FsSfzAqfjCpS">
      <input type="hidden" name="target_uri" value="https://bugzilla.mozilla.org/show_bug.cgi">
      <input type="image" src="/extensions/GitHubAuth/web/images/sign_in.png" height="22" width="75" align="absmiddle"
             alt="Sign in with GitHub"
             title="Sign in with GitHub"> or
    </form>
  </span>

  <form action="/show_bug.cgi?id=1647078" method="POST"
        data-qs-suffix="_top">

    <input id="Bugzilla_login_top"
           class="bz_login"
           name="Bugzilla_login"
           title="Login"
           placeholder="Email"
           aria-label="Email"
           type="email"
           required
    >
    <input class="bz_password"
           id="Bugzilla_password_top"
           name="Bugzilla_password"
           type="password"
           title="Password"
           placeholder="Password"
           aria-label="Password"
           required
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text"
           id="Bugzilla_password_dummy_top" value="password"
           title="Password"
    >
      <input type="checkbox" id="Bugzilla_remember_top"
             name="Bugzilla_remember" value="on" class="bz_remember"
                 checked>
      <label for="Bugzilla_remember_top">Remember</label>
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
           class="check_mini_login_fields"
            id="log_in_top">
    <a href="#" id="hide_mini_login_top" aria-label="Close"
       class="close-button hide_mini_login_form" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
<li id="forgot_container_top">
  <a id="forgot_link_top" href="/index.cgi?GoAheadAndLogIn=1#forgot"
     class='show_forgot_form'
     data-qs-suffix="_top">Forgot Password</a>
  <div id="forgot_form_top" class="mini-popup mini_forgot bz_default_hidden">
  <form action="/token.cgi" method="post">
    <input type="email" name="loginname" size="20" placeholder="Email" aria-label="Email" required>
    <input id="forgot_button_top" value="Reset Password"
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <input type="hidden" id="token_top" name="token" value="1635623528-ZP13JOD71Oq9DikS5qezBogkXMcB6YbzFtUhIOTHmks">
    <a href="#" class="close-button hide_forgot_form" aria-label="Close" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
      </ul><div id="header-external-links" class="dropdown first">
  <button type="button" id="header-external-menu-button" class="dropdown-button minor" title="Mozilla"
          aria-label="Mozilla" aria-expanded="false" aria-haspopup="true" aria-controls="header-external-menu">
    <img src="/static/v20211025.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg" width="32" height="32" alt="">
  </button>
  <ul class="dropdown-content right" id="header-external-menu" role="menu" style="display:none;">
    <li role="presentation">
      <a href="https://www.mozilla.org/" role="menuitem" tabindex="-1">Mozilla Home</a>
    </li>
    <li role="separator"></li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/" role="menuitem" tabindex="-1">Privacy</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/#cookies" role="menuitem" tabindex="-1">Cookies</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/about/legal/" role="menuitem" tabindex="-1">Legal</a>
    </li>
  </ul>
</div>
  </div>
</header> 


<main id="bugzilla-body" tabindex="-1">

<aside id="message-container" role="complementary">
  <noscript>
    <div class="noscript">
      <div class="inner">
        <p>Please enable JavaScript in your browser to use all the features on this site.</p>
      </div>
    </div>
  </noscript>
</aside>

<div id="main-inner">




<div role="toolbar" id="page-toolbar">
  <div role="group" class="buttons">
    <button type="button" id="copy-summary" class="secondary"
      title="Copy bug number and summary to your clipboard">Copy Summary</button>
    <div id="clip-container" style="display:none"><input type="text" id="clip"></div>
    <div class="dropdown">
      <button type="button" id="action-menu-btn" aria-haspopup="true" aria-label="View"
        aria-expanded="false" aria-controls="action-menu" class="dropdown-button secondary">View &#9662;</button>
      <ul class="dropdown-content left" id="action-menu" role="menu" style="display:none;">
        <li role="presentation">
          <a id="action-reset" role="menuitem" tabindex="-1">Reset Sections</a>
        </li>
        <li role="presentation">
          <a id="action-expand-all" role="menuitem" tabindex="-1">Expand All Sections</a>
        </li>
        <li role="presentation">
          <a id="action-collapse-all" role="menuitem" tabindex="-1">Collapse All Sections</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a id="action-history" role="menuitem" tabindex="-1">History</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a href="/rest/bug/1647078" role="menuitem" tabindex="-1">JSON</a>
        </li>
        <li role="presentation">
          <a href="/show_bug.cgi?ctype=xml&amp;id=1647078" role="menuitem" tabindex="-1">XML</a>
        </li>
      </ul>
    </div>
  </div>
</div>



<div role="status" id="io-error" style="display:none"></div>
<div role="status" id="floating-message" style="display:none">
  <div id="floating-message-text"></div>
</div>
<section class="module"
>
  <div class="module-content"
  >
  <div id="summary-container">
    <div class="field indent" id="field-status_summary"
>


  
    <div class=" container">
        <span id="field-value-status_summary">
      <span class="bug-status-label text" data-status="closed">Closed</span>
      <span id="field-value-bug_id">
        <a href="/show_bug.cgi?id=1647078">Bug 1647078</a>
          <span class="edit-hide">(CVE-2020-15647)</span>
      </span>
      <span>
        <span class="bug-time-label">Opened <span class="rel-time" title="2020-06-20 07:34 PDT" data-time="1592663692">1 year ago</span></span>
          <span class="bug-time-label">Closed <span class="rel-time" title="2020-07-06 13:17 PDT" data-time="1594066656">1 year ago</span></span>
      </span>
        </span>
    </div>

  
</div>
<div class="field indent edit-hide"
>


  
    <div class=" container">
      

      <h1 id="field-value-short_desc">content:// provider allows websites to remotely steal any file from the device if the path is known</h1>
    </div>

  
</div>

    <div class="field edit-show" id="field-short_desc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc" id="short_desc-help-link" class="help">Summary:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-short_desc">
            content:// provider allows websites to remotely steal any file from the device if the path is known

        </span>
    </div>

  
</div>
  </div>
  </div>
</section>


<section class="module" id="module-categories"
>
    <header id="module-categories-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Categories section"
           data-label-collapsed="Expand Categories section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-categories-content"
             aria-expanded="true"
             aria-labeledby="module-categories-title"
             aria-describedby="module-categories-subtitle"></div>
        <h2 class="module-title" id="module-categories-title">Categories</h2>
          <h3 class="module-subtitle" id="module-categories-subtitle">
            (Firefox for Android Graveyard :: General, defect, P1)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-categories-content"
  ><div class="fields-lhs">

    <div class="field" id="field-product"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=Firefox%20for%20Android%20Graveyard" id="product-help-link" class="help">Product:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-product">
      <div class="name-info-outer dropdown">
        <span id="product-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="product-info">Firefox for Android Graveyard
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="product-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Product description and actions">
          <header>
            <div class="title">Firefox for Android Graveyard</div>
            <div class="description">Old, retired Fennec bugs. Fennec is the code name of the effort to build a mobile version of Firefox (<a href="http://wiki.mozilla.org/Mobile/FennecVision">more info</a>)</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=Firefox%20for%20Android%20Graveyard&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Product</a></div>
            <div><a href="/enter_bug.cgi?product=Firefox%20for%20Android%20Graveyard"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Product</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="Firefox for Android Graveyard"
                         data-label-watch="Watch This Product" data-label-unwatch="Unwatch This Product"
                         data-source="BugModal">Watch This Product</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-component"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=Firefox%20for%20Android%20Graveyard&component=General#General" id="component-help-link" class="help">Component:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-component">
      <div class="name-info-outer dropdown">
        <span id="component-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="component-info">General
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="component-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Component description and actions">
          <header>
            <div class="title">Firefox for Android Graveyard :: General</div>
            <div class="description">For bugs in Fennec which do not fit into other more specific Fennec components.</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=Firefox%20for%20Android%20Graveyard&amp;component=General&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Component</a></div>
            <div><a href="/buglist.cgi?product=Firefox%20for%20Android%20Graveyard&amp;component=General&amp;chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__"
                    target="_blank" role="menuitem" tabindex="-1">Recently Fixed Bugs in This Component</a></div>
            <div><a href="/enter_bug.cgi?product=Firefox%20for%20Android%20Graveyard&amp;component=General"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Component</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="Firefox for Android Graveyard" data-component="General"
                         data-label-watch="Watch This Component" data-label-unwatch="Unwatch This Component"
                         data-source="BugModal">Watch This Component</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-version" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#version" id="version-help-link" class="help">Version:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-version">
            unspecified

        </span>
    </div>

  
</div>

    <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform" id="-help-link" class="help">Platform:
        </a>
    </div>


  
    <div class=" container"><div class="field inline" id="field-rep_platform"
>


  
    <div class="value">
        <span id="field-value-rep_platform">
            Unspecified

        </span>
    </div>

  
</div><div class="field indent inline" id="field-op_sys"
>


  
    <div class="value">
        <span id="field-value-op_sys">
            Unspecified

        </span>
    </div>

  
</div><div class="field indent inline"
>


  
    <div class=" container">
    </div>

  
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field contains-buttons" id="field-bug_type"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type" id="bug_type-help-link" class="help">Type:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_type">
      <span class="bug-type-label iconic-text" data-type="defect">
        <span class="icon" aria-hidden="true"></span>defect</span>
        </span>
    </div>

  
</div>

    <div class="field" id="field-importance"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority" id="importance-help-link" class="help">Priority:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-importance"><div class="field inline" id="field-priority"
>


  
    <div class="value">
        <span id="field-value-priority">P1
        </span>
    </div>

  
</div><div class="field inline" id="field-bug_severity"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity" id="bug_severity-help-link" class="help">Severity:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_severity">
            --

        </span>
    </div>

  
</div>
        </span>
    </div>

  
</div>

    
</div>
  </div>
</section>


<section class="module" id="module-tracking"
>
    <header id="module-tracking-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Tracking section"
           data-label-collapsed="Expand Tracking section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-tracking-content"
             aria-expanded="true"
             aria-labeledby="module-tracking-title"
             aria-describedby="module-tracking-subtitle"></div>
        <h2 class="module-title" id="module-tracking-title">Tracking</h2>
          <h3 class="module-subtitle" id="module-tracking-subtitle">
            (firefox-esr6878+ verified)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-tracking-content"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-status-view"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-view-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-view">VERIFIED
        FIXED
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-status-edit" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-edit-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-edit"><div class="field inline" id="field-bug_status"
>


  
    <div class="value">
        <span id="field-value-bug_status">
            VERIFIED

        </span>
    </div>

  
</div><div class="field indent inline" id="field-resolution"
>


  
    <div class="value">
        <span id="field-value-resolution">
            FIXED

        </span>
    </div>

  
</div>
  <div id="status-action-buttons">
      <div id="assigned-container" style="display:none">
        <button type="button" class="secondary" id="mark-as-assigned-btn">
          Mark as Assigned
        </button>
      </div>
  </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-target_milestone" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone" id="target_milestone-help-link" class="help">Milestone:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-target_milestone">
            ---

        </span>
    </div>

  
</div>

    


      <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Project Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <td class="tracking-flag-name">Webcompat Priority</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_webcompat_priority-dirty">
  <select id="cf_webcompat_priority" name="cf_webcompat_priority">
        <option value="---"
          id="v4274_cf_webcompat_priority" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Root Cause</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_root_cause-dirty">
  <select id="cf_root_cause" name="cf_root_cause">
        <option value="---"
          id="v4701_cf_root_cause" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">user-doc-firefox</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_sumo-dirty">
  <select id="cf_tracking_firefox_sumo" name="cf_tracking_firefox_sumo">
        <option value="---"
          id="v4660_cf_tracking_firefox_sumo" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Fission Milestone</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_fission_milestone-dirty">
  <select id="cf_fission_milestone" name="cf_fission_milestone">
        <option value="---"
          id="v4222_cf_fission_milestone" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

      <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Tracking Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-hide">
    <table class="layout-table tracking-flags">
        <tr>
          <th></th>
          <th>Tracking</th>
          <th>Status</th>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox-esr68</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox_esr68&amp;o1=equals&amp;v1=78%2B">78+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox_esr68&amp;o1=equals&amp;v1=verified">verified</a>
          </td>
        </tr>
    </table>
  </div>


<div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <th></th>
        <th>Tracking</th>
        <th>Status</th>
      </tr>
      <tr>
        <td class="tracking-flag-name">relnote-firefox</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_relnote-dirty">
  <select id="cf_tracking_firefox_relnote" name="cf_tracking_firefox_relnote">
        <option value="---"
          id="v539_cf_tracking_firefox_relnote" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr68</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr68-dirty">
  <select id="cf_tracking_firefox_esr68" name="cf_tracking_firefox_esr68">
        <option value="78+"
          id="v4779_cf_tracking_firefox_esr68" selected
        >78+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr68-dirty">
  <select id="cf_status_firefox_esr68" name="cf_status_firefox_esr68">
        <option value="verified"
          id="v4413_cf_status_firefox_esr68" selected
        >verified
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr78-dirty">
  <select id="cf_tracking_firefox_esr78" name="cf_tracking_firefox_esr78">
        <option value="---"
          id="v4808_cf_tracking_firefox_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr78-dirty">
  <select id="cf_status_firefox_esr78" name="cf_status_firefox_esr78">
        <option value="---"
          id="v4813_cf_status_firefox_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr91-dirty">
  <select id="cf_tracking_firefox_esr91" name="cf_tracking_firefox_esr91">
        <option value="---"
          id="v5194_cf_tracking_firefox_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr91-dirty">
  <select id="cf_status_firefox_esr91" name="cf_status_firefox_esr91">
        <option value="---"
          id="v5199_cf_status_firefox_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox93</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox93-dirty">
  <select id="cf_tracking_firefox93" name="cf_tracking_firefox93">
        <option value="---"
          id="v5266_cf_tracking_firefox93" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox93-dirty">
  <select id="cf_status_firefox93" name="cf_status_firefox93">
        <option value="---"
          id="v5271_cf_status_firefox93" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox94</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox94-dirty">
  <select id="cf_tracking_firefox94" name="cf_tracking_firefox94">
        <option value="---"
          id="v5284_cf_tracking_firefox94" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox94-dirty">
  <select id="cf_status_firefox94" name="cf_status_firefox94">
        <option value="---"
          id="v5289_cf_status_firefox94" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox95</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox95-dirty">
  <select id="cf_tracking_firefox95" name="cf_tracking_firefox95">
        <option value="---"
          id="v5311_cf_tracking_firefox95" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox95-dirty">
  <select id="cf_status_firefox95" name="cf_status_firefox95">
        <option value="---"
          id="v5316_cf_status_firefox95" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>

</div>
  </div>
</section>



<section class="module" id="module-people"
>
    <header id="module-people-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse People section"
           data-label-collapsed="Expand People section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-people-content"
             aria-expanded="false"
             aria-labeledby="module-people-title"
             aria-describedby="module-people-subtitle"></div>
        <h2 class="module-title" id="module-people-title">People</h2>
          <h3 class="module-subtitle" id="module-people-subtitle">
            (Reporter: kanytu, Assigned: agi)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-people-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-assigned_to"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to"><div class="vcard vcard_421286" ><img src="https://secure.gravatar.com/avatar/2f23a572bdd06777026ab2c155cfe0c0?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=421286" > <span class="fna">agi</span></a>
</div>
        </span>
    </div>

  
</div><div class="field edit-show" id="field-assigned_to" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-assignee" name="set_default_assignee" class="set-default"
          value="1" data-for="assigned_to">
        <label for="set-default-assignee">Reset Assignee to default</label>
      </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-bug_mentors" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor" id="bug_mentors-help-link" class="help">Mentors:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_mentors">---
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-qa_contact" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact" id="qa_contact-help-link" class="help">QA Contact:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-qa_contact">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-qa-contact" name="set_default_qa_contact" class="set-default"
          value="1" data-for="qa_contact">
        <label for="set-default-qa-contact">Reset QA Contact to default</label>
      </div>
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-reporter"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter" id="reporter-help-link" class="help">Reporter:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-reporter">
            <div class="vcard vcard_665275" ><img src="https://secure.gravatar.com/avatar/fba1cdeef36023e3cfc2558b3d82963d?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=665275" > <span class="fna">kanytu</span></a>
</div>

        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-triage_owner" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner" id="triage_owner-help-link" class="help">Triage Owner:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-triage_owner">
            ---

        </span>
    </div>

  
</div>

    

    <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc" id="-help-link" class="help">CC:
        </a>
    </div>


  
    <div class=" container">


        <span aria-owns="cc-summary cc-latch">
          <span role="button" tabindex="0" id="cc-summary" data-count="24">24 people
          </span>
        </span>


        <div id="cc-list" style="display:none"></div>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-references"
>
    <header id="module-references-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse References section"
           data-label-collapsed="Expand References section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-references-content"
             aria-expanded="false"
             aria-labeledby="module-references-title"
             aria-describedby="module-references-subtitle"></div>
        <h2 class="module-title" id="module-references-title">References</h2>
      </div>
    </header>
  <div class="module-content" id="module-references-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field bug-list edit-show" id="field-dependson" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson" id="dependson-help-link" class="help">Depends on:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-dependson">
        ---
        </span>
    </div>

  
</div><div class="field bug-list edit-show" id="field-blocked" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks" id="blocked-help-link" class="help">Blocks:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-blocked">
        ---
        </span>
    </div>

  
</div>

    <div class="field bug-list edit-show" id="field-regresses" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses" id="regresses-help-link" class="help">Regressions:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regresses">
        ---
        </span>
    </div>

  
</div><div class="field bug-list edit-show" id="field-regressed_by" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by" id="regressed_by-help-link" class="help">Regressed by:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regressed_by">
        ---
        </span>
    </div>

  
</div>

    
</div><div class="fields-rhs">

    <div class="field edit-show" id="field-bug_file_loc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc" id="bug_file_loc-help-link" class="help">URL:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_file_loc"><div class="link">
    <a href="" target="_blank"
      rel="noreferrer" title=""
      class="bug-url" data-safe="0"></a>
  </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-see_also"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also" id="see_also-help-link" class="help">See Also:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-see_also">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Private files are allowed to be uploaded (exfiltration)"
   href="/show_bug.cgi?id=1652364">CVE-2020-15649</a>, <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Path traversal in upload feature allows internal file overwrite"
   href="/show_bug.cgi?id=1652360">CVE-2020-15650</a>
      </div>

        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-details"
>
    <header id="module-details-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Details section"
           data-label-collapsed="Expand Details section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-details-content"
             aria-expanded="false"
             aria-labeledby="module-details-title"
             aria-describedby="module-details-subtitle"></div>
        <h2 class="module-title" id="module-details-title">Details</h2>
          <h3 class="module-subtitle" id="module-details-subtitle">
            (Keywords: csectype-sop, sec-critical, Whiteboard: [reporter-external] [client-bounty-form] [verif?][sec-survey])
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-details-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-show" id="field-alias" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias" id="alias-help-link" class="help">Alias:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-alias">
            CVE-2020-15647

        </span>
    </div>

  
</div>

    <div class="field" id="field-keywords"
>
    <div class="name">
        <a href="/describekeywords.cgi" id="keywords-help-link" class="help">Keywords:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-keywords">
          <a href="/buglist.cgi?keywords=csectype-sop&amp;resolution=---">csectype-sop</a>, 
          <a href="/buglist.cgi?keywords=sec-critical&amp;resolution=---">sec-critical</a>
        </span>
    </div>

  
</div>

    <div class="field" id="field-status_whiteboard"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/Whiteboard" id="status_whiteboard-help-link" class="help">Whiteboard:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-status_whiteboard">[reporter-external] [client-bounty-form] [verif?][sec-survey]
        </span>
    </div>

  
</div>

    

    <div class="field edit-show" id="field-cf_has_regression_range" style="display:none"
>
    <div class="name">Has Regression Range:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_regression_range">
            ---

        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_has_str" style="display:none"
>
    <div class="name">Has STR:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_str">
            ---

        </span>
    </div>

  
</div>

    <div class="field" id="field-votes"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes" id="votes-help-link" class="help">Votes:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-votes">0
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-bug_flags"
>
    <div class="name">Bug Flags:
    </div>


  
    <div class=" container">
        <span id="field-value-bug_flags"><div id="bug-flags" class="flags">
  <table class="layout-table">
          <tbody class="edit-hide"><tr>
    <td class="flag-setter"><div class="vcard vcard_1689" ><a class="email " href="/user_profile?user_id=1689" > <span class="fna">dveditz</span></a>
</div>
    </td>

    <td class="flag-name">
        <a href="#a1482129_1689"
            class="rel-time-title activity-ref"
            title="1 year ago"
        data-time="1592663692"
      >sec-bounty</a>
    </td>

    <td class="flag-value">+
    </td>

  </tr>
          </tbody>
          <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter"><div class="vcard vcard_1689" ><a class="email " href="/user_profile?user_id=1689" > <span class="fna">dveditz</span></a>
</div>
    </td>

    <td class="flag-name">
      <label title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug." for="flag-1981781">sec-bounty</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag-1981781-dirty">
      <select id="flag-1981781" name="flag-1981781"
        title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug."
        class="bug-flag">
            <option value="+" selected>+</option>
      </select>
    </td>


  </tr>
          </tbody>
    <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?" for="flag_type-930">behind-pref</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-930-dirty">
      <select id="flag_type-930" name="flag_type-930"
        title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?"
        class="bug-flag">
          <option value="X"></option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame." for="flag_type-913">sec-bounty-hof</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-913-dirty">
      <select id="flag_type-913" name="flag_type-913"
        title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-787">in-qa-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-787-dirty">
      <select id="flag_type-787" name="flag_type-787"
        title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>

      <td class="flag-requestee">
        <div id="requestee_type-787-container" style="display:none"><input
    name="requestee_type-787"
    value="" class="requestee bz_autocomplete_user"  id="requestee_type-787" 
  >
        </div>
      <td>

  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-37">in-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-37-dirty">
      <select id="flag_type-37" name="flag_type-37"
        title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually" for="flag_type-864">qe-verify</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-864-dirty">
      <select id="flag_type-864" name="flag_type-864"
        title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually"
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr>
    </tbody>
  </table>
</div>
        </span>
    </div>

  
</div>
</div>

  
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-crash-data"
>
    <header id="module-crash-data-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Crash Data section"
           data-label-collapsed="Expand Crash Data section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-crash-data-content"
             aria-expanded="false"
             aria-labeledby="module-crash-data-title"
             aria-describedby="module-crash-data-subtitle"></div>
        <h2 class="module-title" id="module-crash-data-title">Crash Data</h2>
      </div>
    </header>
  <div class="module-content" id="module-crash-data-content" style="display:none"
  ><div class="field edit-show" id="field-cf_crash_signature" style="display:none"
>
    <div class="name">Signature:
    </div>


  
    <div class="value">
        <span id="field-value-cf_crash_signature">
        </span>
    </div>

  
</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-security"
>
    <header id="module-security-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Security section"
           data-label-collapsed="Expand Security section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-security-content"
             aria-expanded="false"
             aria-labeledby="module-security-title"
             aria-describedby="module-security-subtitle"></div>
        <h2 class="module-title" id="module-security-title">Security</h2>
          <h3 class="module-subtitle" id="module-security-subtitle">
            (public)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-security-content" style="display:none"
  ><div class="groups edit-hide">
    This bug is publicly visible.
</div>

<div class="groups edit-show" style="display:none">


</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-user-story" data-non-stick="1"
>
    <header id="module-user-story-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse User Story section"
           data-label-collapsed="Expand User Story section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-user-story-content"
             aria-expanded="false"
             aria-labeledby="module-user-story-title"
             aria-describedby="module-user-story-subtitle"></div>
        <h2 class="module-title" id="module-user-story-title">User Story</h2>
      </div>
    </header>
  <div class="module-content" id="module-user-story-content" style="display:none"
  >
    <pre id="user-story"></pre>
  </div>
</section>







<section class="module" id="module-attachments"
>
    <header id="module-attachments-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Attachments section"
           data-label-collapsed="Expand Attachments section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-attachments-content"
             aria-expanded="true"
             aria-labeledby="module-attachments-title"
             aria-describedby="module-attachments-subtitle"></div>
        <h2 class="module-title" id="module-attachments-title">Attachments</h2>
          <h3 class="module-subtitle" id="module-attachments-subtitle">
            (9 files)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-attachments-content"
  ><table role="table" class="layout-table" id="attachments">
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9158004">attachments.zip</a>
        </div>
        <div>
            <a href="#c0" class="attach-time activity-ref"><span class="rel-time" title="2020-06-20 07:34 PDT" data-time="1592663692">1 year ago</span></a>
          <span class="attach-author"><div class="vcard vcard_665275" ><a class="email " href="/user_profile?user_id=665275" > <span class="fna">Pedro Oliveira</span></a>
</div></span>
        </div>
        <div class="attach-info">4.62 MB,
          application/zip        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9158004&amp;action=edit">Details</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9159562">Bug 1647078 - Load content:// URIs from intents as file://.</a>
        </div>
        <div>
            <a href="#c23" class="attach-time activity-ref"><span class="rel-time" title="2020-06-25 17:26 PDT" data-time="1593131205">1 year ago</span></a>
          <span class="attach-author"><div class="vcard vcard_421286" ><a class="email " href="/user_profile?user_id=421286" > <span class="fna">Agi Sferro | :agi | ni? for questions | ⏰ PST | he/him</span></a>
</div></span>
        </div>
        <div class="attach-info">47 bytes,
          text/x-phabricator-request        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_75935" ><span class="fn">RyanVM</span>
</div>:
              <a href="#c74"
                  class="flag-name-status rel-time-title activity-ref"
                  title="1 year ago"
              data-time="1593537125"
            >
              approval-mozilla-esr68+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_1689" ><span class="fn">dveditz</span>
</div>:
              <a href="#c69"
                  class="flag-name-status rel-time-title activity-ref"
                  title="1 year ago"
              data-time="1593537125"
            >
              sec-approval+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9159562&amp;action=edit">Details</a>&#x0020; |
  <a href="/attachment.cgi?id=9159562">Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9159563">Bug 1647078 - Never handle content:// channels from Web.</a>
        </div>
        <div>
            <a href="#c24" class="attach-time activity-ref"><span class="rel-time" title="2020-06-25 17:26 PDT" data-time="1593131209">1 year ago</span></a>
          <span class="attach-author"><div class="vcard vcard_421286" ><a class="email " href="/user_profile?user_id=421286" > <span class="fna">Agi Sferro | :agi | ni? for questions | ⏰ PST | he/him</span></a>
</div></span>
        </div>
        <div class="attach-info">47 bytes,
          text/x-phabricator-request        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_1689" ><span class="fn">dveditz</span>
</div>:
              <a href="#a886673_1689"
                  class="flag-name-status rel-time-title activity-ref"
                  title="1 year ago"
              data-time="1593537128"
            >
              sec-approval+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9159563&amp;action=edit">Details</a>&#x0020; |
  <a href="/attachment.cgi?id=9159563">Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9159564">Bug 1647078 - Use random file names when copying a content:// URI.</a>
        </div>
        <div>
            <a href="#c25" class="attach-time activity-ref"><span class="rel-time" title="2020-06-25 17:26 PDT" data-time="1593131212">1 year ago</span></a>
          <span class="attach-author"><div class="vcard vcard_421286" ><a class="email " href="/user_profile?user_id=421286" > <span class="fna">Agi Sferro | :agi | ni? for questions | ⏰ PST | he/him</span></a>
</div></span>
        </div>
        <div class="attach-info">47 bytes,
          text/x-phabricator-request        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_1689" ><span class="fn">dveditz</span>
</div>:
              <a href="#a886678_1689"
                  class="flag-name-status rel-time-title activity-ref"
                  title="1 year ago"
              data-time="1593537128"
            >
              sec-approval+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9159564&amp;action=edit">Details</a>&#x0020; |
  <a href="/attachment.cgi?id=9159564">Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9159565">Bug 1647078 - Always copy content:// files.</a>
        </div>
        <div>
            <a href="#c26" class="attach-time activity-ref"><span class="rel-time" title="2020-06-25 17:27 PDT" data-time="1593131221">1 year ago</span></a>
          <span class="attach-author"><div class="vcard vcard_421286" ><a class="email " href="/user_profile?user_id=421286" > <span class="fna">Agi Sferro | :agi | ni? for questions | ⏰ PST | he/him</span></a>
</div></span>
        </div>
        <div class="attach-info">47 bytes,
          text/x-phabricator-request        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_1689" ><span class="fn">dveditz</span>
</div>:
              <a href="#a886689_1689"
                  class="flag-name-status rel-time-title activity-ref"
                  title="1 year ago"
              data-time="1593537128"
            >
              sec-approval+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9159565&amp;action=edit">Details</a>&#x0020; |
  <a href="/attachment.cgi?id=9159565">Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9159742">Bug 1647078 - Restrict content:// paths to external storage.</a>
        </div>
        <div>
            <a href="#c43" class="attach-time activity-ref"><span class="rel-time" title="2020-06-26 09:27 PDT" data-time="1593188854">1 year ago</span></a>
          <span class="attach-author"><div class="vcard vcard_421286" ><a class="email " href="/user_profile?user_id=421286" > <span class="fna">Agi Sferro | :agi | ni? for questions | ⏰ PST | he/him</span></a>
</div></span>
        </div>
        <div class="attach-info">47 bytes,
          text/x-phabricator-request        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_1689" ><span class="fn">dveditz</span>
</div>:
              <a href="#a886682_1689"
                  class="flag-name-status rel-time-title activity-ref"
                  title="1 year ago"
              data-time="1593537128"
            >
              sec-approval+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9159742&amp;action=edit">Details</a>&#x0020; |
  <a href="/attachment.cgi?id=9159742">Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9159814">Bug 1647078 - Don't load Web-originated intents that open in the browser.</a>
        </div>
        <div>
            <a href="#c47" class="attach-time activity-ref"><span class="rel-time" title="2020-06-26 14:41 PDT" data-time="1593207663">1 year ago</span></a>
          <span class="attach-author"><div class="vcard vcard_421286" ><a class="email " href="/user_profile?user_id=421286" > <span class="fna">Agi Sferro | :agi | ni? for questions | ⏰ PST | he/him</span></a>
</div></span>
        </div>
        <div class="attach-info">47 bytes,
          text/x-phabricator-request        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_1689" ><span class="fn">dveditz</span>
</div>:
              <a href="#a886665_1689"
                  class="flag-name-status rel-time-title activity-ref"
                  title="1 year ago"
              data-time="1593537128"
            >
              sec-approval+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9159814&amp;action=edit">Details</a>&#x0020; |
  <a href="/attachment.cgi?id=9159814">Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9161643">Bug 1647078 - Fix unit tests and checkstyle. a=RyanVM</a>
        </div>
        <div>
            <a href="#c75" class="attach-time activity-ref"><span class="rel-time" title="2020-07-06 09:08 PDT" data-time="1594051684">1 year ago</span></a>
          <span class="attach-author"><div class="vcard vcard_421286" ><a class="email " href="/user_profile?user_id=421286" > <span class="fna">Agi Sferro | :agi | ni? for questions | ⏰ PST | he/him</span></a>
</div></span>
        </div>
        <div class="attach-info">47 bytes,
          text/x-phabricator-request        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9161643&amp;action=edit">Details</a>&#x0020; |
  <a href="/attachment.cgi?id=9161643">Review</a>
    </tr>
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9161647">advisory.txt</a>
        </div>
        <div>
            <a href="#c76" class="attach-time activity-ref"><span class="rel-time" title="2020-07-06 09:18 PDT" data-time="1594052334">1 year ago</span></a>
          <span class="attach-author"><div class="vcard vcard_578488" ><a class="email " href="/user_profile?user_id=578488" > <span class="fna">Tom Ritter [:tjr] (ni? for response to CVE/sec-approval/advisories/etc)</span></a>
</div></span>
        </div>
        <div class="attach-info">264 bytes,
          text/plain        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9161647&amp;action=edit">Details</a>
    </tr>
</table>

<footer id="attachments-footer">
  <div id="attachments-actions">
  </div>
  
</footer>
  </div>
</section>



<script nonce="FwYcXRs52cc9ZdokC9TO9gL9Lzm8SXUrhZ5U4G92Z8831Q2f">
  init_module_visibility();
</script>



<meta name="firefox-versions" content="{&quot;FIREFOX_AURORA&quot;:&quot;&quot;,&quot;FIREFOX_DEVEDITION&quot;:&quot;94.0b9&quot;,&quot;FIREFOX_ESR&quot;:&quot;78.15.0esr&quot;,&quot;FIREFOX_ESR_NEXT&quot;:&quot;91.2.0esr&quot;,&quot;FIREFOX_NIGHTLY&quot;:&quot;95.0a1&quot;,&quot;FIREFOX_PINEBUILD&quot;:&quot;&quot;,&quot;LAST_MERGE_DATE&quot;:&quot;2021-10-04&quot;,&quot;LAST_RELEASE_DATE&quot;:&quot;2021-10-05&quot;,&quot;LAST_SOFTFREEZE_DATE&quot;:&quot;2021-09-30&quot;,&quot;LATEST_FIREFOX_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_OLDER_VERSION&quot;:&quot;3.6.28&quot;,&quot;LATEST_FIREFOX_RELEASED_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_VERSION&quot;:&quot;93.0&quot;,&quot;NEXT_MERGE_DATE&quot;:&quot;2021-11-01&quot;,&quot;NEXT_RELEASE_DATE&quot;:&quot;2021-11-02&quot;,&quot;NEXT_SOFTFREEZE_DATE&quot;:&quot;2021-10-28&quot;}">


<div id="comment-actions">
    <button type="button" id="bottom-btn" class="secondary" aria-label="Go to Page Bottom">Bottom &darr;</button>
  <div class="dropdown">
    <button type="button" id="comment-tags-btn" aria-haspopup="true" aria-label="Tags"
      aria-expanded="false" aria-controls="comment-tags-menu" class="dropdown-button minor">Tags &#9662;</button>
    <ul id="comment-tags-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a role="menuitem" tabindex="-1" data-comment-tag="">Reset</a>
      </li>
    </ul>
  </div>
  <div class="dropdown">
    <button type="button" id="view-menu-btn" aria-haspopup="true" aria-label="Timeline"
      aria-expanded="false" aria-controls="view-menu" class="dropdown-button minor">Timeline &#9662;</button>
    <ul id="view-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a id="view-reset" role="menuitem" tabindex="-1">Reset</a>
      </li>
      <li role="separator"></li>
      <li role="presentation">
        <a id="view-collapse-all" role="menuitem" tabindex="-1">Collapse All</a>
      </li>
      <li role="presentation">
        <a id="view-expand-all" role="menuitem" tabindex="-1">Expand All</a>
      </li>
      <li role="presentation">
        <a id="view-comments-only" role="menuitem" tabindex="-1">Comments Only</a>
      </li>
    </ul>
   </div>
</div>
<div class="change-set" id="c0"><div class="comment" data-id="14891357" data-no="0"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-0" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_665275" ><img src="https://secure.gravatar.com/avatar/fba1cdeef36023e3cfc2558b3d82963d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_665275" ><a class="email " href="/user_profile?user_id=665275" > <span class="fna">Pedro Oliveira</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-0"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-0" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c0">Description</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-20 07:34 PDT" data-time="1592663692">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-0">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9158004"
         class="attachment"
         data-id="9158004" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="attachments.zip">
      <meta itemprop="contentSize" content="4844828">
      <meta itemprop="encodingFormat" content="application/zip">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=9158004" itemprop="contentUrl">
        <span id="att-9158004-description" itemprop="description">attachments.zip</span></a>
        — <a href="attachment.cgi?id=9158004&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <div
        class="comment-text markdown-body "
        id="ct-0" data-comment-id="14891357" data-ismarkdown="true" ><p>The following report is in Markdown format, consider using a reader for better experience.</p>
<h2>Environment</h2>
<ul>
<li><strong>Device:</strong> HTC m8</li>
<li><strong>OS version:</strong> Android 9</li>
<li><strong>Package name:</strong> org.mozilla.firefox</li>
<li><strong>App version:</strong> 68.9.0 (<code>versionCode</code> 2015701353) (stable channel)</li>
</ul>
<hr>
<h2>Proof of concept</h2>
<h3>Pre-conditions:</h3>
<ul>
<li>Firefox installed</li>
<li>Python3 installed</li>
<li>ngrok (optional for easy tunneling)</li>
</ul>
<h3>Steps:</h3>
<ul>
<li>
<p>Start the <code>server.py</code> (see attachments) using the following command:</p>
<pre><code>$ python3 server.py &lt;WEBSITE&gt; &lt;PORT_TO_LISTEN&gt;
</code></pre>
<p>The <code>&lt;WEBSITE&gt;</code> is the URL that is going to be opened in the device without scheme (Examples: <code>192.1.1.1</code>, <code>myDomain.com</code>, <code>192.6.1.3:8080</code>).</p>
<p>The <code>&lt;PORT&gt;</code> is the port for the server</p>
</li>
<li>
<p>Open the website above in Firefox for Android</p>
</li>
</ul>
<h3>Result</h3>
<ul>
<li>A javascript alert is shown with the contents of the cookies database</li>
</ul>
<h3>Expected result</h3>
<ul>
<li>No private file should be accessed</li>
</ul>
<hr>
<h2>Detailed explanation</h2>
<p>When the webiste is opened in Firefox, a webpage is served that contains a <code>&lt;iframe&gt;</code> that downloads a file named <code>profile.ini</code> to <code>/sdcard/Download/profile.ini</code> and opens it after a short delay using this <code>href</code>:</p>
<pre><code>android-app://org.mozilla.firefox/content/org.mozilla.firefox.fileprovider/root/sdcard/Download/profiles.ini#Intent;type=text/html;end
</code></pre>
<p>This Intent orders Firefox to open the URI <code>content://org.mozilla.firefox.fileprovider/root/sdcard/Download/profiles.ini</code>. Firefox will download this <code>content://</code> URI to <code>/data/data/org.mozilla.firefox/cache/contentUri</code> while rendering it. The name is maintained so a new file called <code>/data/data/org.mozilla.firefox/cache/contentUri/profiles.ini</code> has been now created.</p>
<p>The contents of <code>profile.ini</code> can be seen in <code>server.py</code> (method <code>get_profiles_html</code>) but basically it&#39;s a HTML page that contains an <code>&lt;iframe&gt;</code> that loads another <code>content://</code> URI and trigger a javascript function after a while (more info bellow).</p>
<p>The URI loaded is:</p>
<pre><code>content://org.mozilla.firefox.fileprovider/data/user/0/org.mozilla.firefox/files/mozilla/profiles.ini
</code></pre>
<p>This provider is misconfigured and contains the following entry in its XML configuration file (<code>provider_paths.xml</code>):</p>
<pre><code class="language-xml">&lt;paths xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;
    &lt;root-path name=&quot;root&quot; path=&quot;.&quot;/&gt;
&lt;/paths&gt;
</code></pre>
<p>Firefox is using <code>root-path</code> with path <code>.</code> which essentially allows all files to be resolved by this provider. This allows private files from Firefox to be accessed.</p>
<p>The logic to download the file from a <code>content://</code> URI is rewriting the file, so the contents of <code>profile.ini</code> (the current page loaded) were now overriden and contains the values of <code>/data/user/0/org.mozilla.firefox/files/mozilla/profiles.ini</code>.</p>
<p>After the above <code>&lt;iframe&gt;</code> is loaded, the javascript function triggers. This javascript reads the contents of the current page (this bypass CORS protections because the file is the same). The current page is now the <code>profiles.ini</code> file from Firefox. This file contains the path to the cookies directory. After the path has been retrieved from the file, it repeats the process again but for <code>/data/user/0/org.mozilla.firefox/files/mozilla/&lt;PATH&gt;/cookies.sqlite</code>.</p>
<p>**Resuming: **</p>
<p>This is a combination of multiple misconfigurations/flawed logic:</p>
<ul>
<li>Firefox allows private files to be opened in it</li>
<li>Content provider from Firefox allows private file inclusion</li>
<li>Files downloaded from content providers with the same name are downloaded to the same place.</li>
</ul>
<hr>
<h2>Vulnerable code</h2>
<ul>
<li><code>res/xml/provider_paths.xml</code></li>
</ul>
<pre><code>&lt;root-path name=&quot;root&quot; path=&quot;.&quot;/&gt;
</code></pre>
<hr>
<h2>Remediation</h2>
<p>Firefox should not allow private files to be accessed by it&#39;s provider. A suggested fix here is to use instead:</p>
<pre><code>&lt;root-path name=&quot;root&quot; path=&quot;/storage/&quot;/&gt;
</code></pre>
<p>Firefox should also not override the contents from <code>contentUri</code> otherwise it&#39;ll be possible to override the contents of a file and retrieve it afterwards.</p>
<hr>
<h2>Attachments</h2>
<ul>
<li>
<p>server.py</p>
<p>Python3 server containg the full proof of concept.</p>
</li>
<li>
<p>video.mp4</p>
<p>A video showing the exploit in action.</p>
</li>
</ul>
<hr>
<h2>Impact</h2>
<ul>
<li>Remote file steal of cookies or any other file if the attacker knows the path which is easy for common applications.</li>
</ul>
</div><div class="activity"><div class="change">Flags: sec-bounty?</div></div></div><div class="change-set" id="c1"><div class="comment" data-id="14894364" data-no="1"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-1" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" ><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" ><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-1"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-1" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c1">Comment 1</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-22 08:55 PDT" data-time="1592841323">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-1">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-1" data-comment-id="14894364" data-ismarkdown="true" ><p>Stefan/snorp, can one of you (find someone to) investigate?</p>
</div><div class="activity"><div class="change">Group: firefox-core-security &rarr; mobile-core-security</div><div class="change">Type: task &rarr; defect</div><div class="change">Component: Security &rarr; General</div><div class="change">Flags: needinfo?(snorp)</div><div class="change">Flags: needinfo?(sarentz)</div><div class="change">Product: Firefox &rarr; Firefox for Android</div></div></div><div class="change-set" id="a260507_388264"><div class="change" id="aa260507_388264">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_388264" id="a260507_388264"><img src="https://secure.gravatar.com/avatar/73072cf44258fa9cb3ae3ed4f47b9939?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_388264" id="a260507_388264"><a class="email " href="/user_profile?user_id=388264" > <span class="fna">Stefan Arentz | :st3fan | ⏰ EST | he/him</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a260507_388264"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a260507_388264">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#a260507_388264">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-23 07:56 PDT" data-time="1592924199">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(sarentz)</span></div></div></div><div class="change-set" id="c2"><div class="comment" data-id="14896608" data-no="2"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-2" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_388264" id="a260507_388264"><img src="https://secure.gravatar.com/avatar/73072cf44258fa9cb3ae3ed4f47b9939?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_388264" id="a260507_388264"><a class="email " href="/user_profile?user_id=388264" > <span class="fna">Stefan Arentz | :st3fan | ⏰ EST | he/him</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-2"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-2" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c2">Comment 2</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-23 07:57 PDT" data-time="1592924237">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-2">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-2" data-comment-id="14896608" data-ismarkdown="true" ><p>Adding Petru too. The suggested remediation looks good, but I don&#39;t know if that will regress anything else.</p>
</div></div><div class="change-set" id="a266813_388264"><div class="change" id="aa266813_388264">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_388264" id="a266813_388264"><img src="https://secure.gravatar.com/avatar/73072cf44258fa9cb3ae3ed4f47b9939?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_388264" id="a266813_388264"><a class="email " href="/user_profile?user_id=388264" > <span class="fna">Stefan Arentz | :st3fan | ⏰ EST | he/him</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a266813_388264"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a266813_388264">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#a266813_388264">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-23 09:41 PDT" data-time="1592930505">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Priority: -- &rarr; P1</div></div></div><div class="change-set" id="c3"><div class="comment" data-id="14899025" data-no="3"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-3" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_613831" id="a266813_388264"><img src="https://secure.gravatar.com/avatar/30b3814cd436f3c69ec94320d4d72398?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_613831" id="a266813_388264"><a class="email " href="/user_profile?user_id=613831" > <span class="fna">Petru-Mugurel Lingurar [:petru]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-3"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-3" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c3">Comment 3</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-24 06:50 PDT" data-time="1593006658">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-3">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-3" data-comment-id="14899025" data-ismarkdown="true" ><p>Thanks Stefan!<br>
Based on the comment here - <a href="https://hg.mozilla.org/mozreview/gecko/rev/703dce7078d2296c209dd0b2e5aabf1790c76361#index_header" rel="nofollow">https://hg.mozilla.org/mozreview/gecko/rev/703dce7078d2296c209dd0b2e5aabf1790c76361#index_header</a> we needed the FileProvider to allow access to the whole file system as the user has the possibility to set the downloads folder at any location.<br>
So using just <code>&lt;root-path name=&quot;root&quot; path=&quot;/storage/&quot;/&gt;</code> might indeed break some things.<br>
Will investigate a bit more.</p>
</div></div><div class="change-set" id="c4"><div class="comment" data-id="14899033" data-no="4"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-4" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_665275" id="a266813_388264"><img src="https://secure.gravatar.com/avatar/fba1cdeef36023e3cfc2558b3d82963d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_665275" id="a266813_388264"><a class="email " href="/user_profile?user_id=665275" > <span class="fna">Pedro Oliveira</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-4"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-4" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c4">Comment 4</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-24 06:55 PDT" data-time="1593006938">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-4">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-4" data-comment-id="14899033" data-ismarkdown="true" ><p>Hey Firefox team,</p>
<p>Given the last comment, the user shouldn&#39;t be able to set the downloads folder in the internal folder of the application. No file manager will have access to /data/.. unless the device is rooted, so I still think the suggested approach fixes the issue.</p>
<p>However, I need to enforce that this is only part of the fix. It is important that downloads to /contentUri/ are not replaced and a new file is created even if the name is the same. Otherwise, it will still be possible to steal any file from the device that is saved in /storage/.</p>
<p>Thank you,<br>
@kanytu</p>
</div></div><div class="change-set" id="a432287_580382"><div class="change" id="aa432287_580382">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_580382" id="a432287_580382"><img src="https://secure.gravatar.com/avatar/15b9b3783e4671cd882bff1316df14c9?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_580382" id="a432287_580382"><a class="email " href="/user_profile?user_id=580382" > <span class="fna">Julien Cristau [:jcristau]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a432287_580382"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a432287_580382">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#a432287_580382">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-25 07:39 PDT" data-time="1593095979">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr68&amp;o1=isnotempty">status-firefox-esr68</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr68&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr68&amp;o1=isnotempty">tracking-firefox-esr68</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox_esr68&amp;o1=equals&amp;v1=%3F">?</a></div></div></div><div class="change-set" id="c5"><div class="comment" data-id="14901775" data-no="5"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-5" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_388264" id="a432287_580382"><img src="https://secure.gravatar.com/avatar/73072cf44258fa9cb3ae3ed4f47b9939?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_388264" id="a432287_580382"><a class="email " href="/user_profile?user_id=388264" > <span class="fna">Stefan Arentz | :st3fan | ⏰ EST | he/him</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-5"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-5" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c5">Comment 5</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-25 08:20 PDT" data-time="1593098441">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-5">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-5" data-comment-id="14901775" data-ismarkdown="true" ><p>Hi kanytu, thank you very much for this report and also for your collaboration towards a good fix for this issue.</p>
</div></div><div class="change-set" id="a442364_1689"><div class="change" id="aa442364_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a442364_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a442364_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a442364_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a442364_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#a442364_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-25 10:27 PDT" data-time="1593106056">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Status: UNCONFIRMED &rarr; NEW</div><div class="change">Ever confirmed: true</div><div class="change">Keywords: <a href="/buglist.cgi?keywords=csectype-sop&amp;resolution=---">csectype-sop</a>, 
          
            <a href="/buglist.cgi?keywords=sec-critical&amp;resolution=---">sec-critical</a></div></div></div><div class="change-set" id="a442451_1689"><div class="change" id="aa442451_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a442451_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a442451_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a442451_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a442451_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#a442451_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-25 10:29 PDT" data-time="1593106143">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Summary: A misconfiguration in a content provider of Firefox for Android is allowing websites to remotely steal any file from the device if the path is known. In this report, I demonstrate how it's possible to remotely steal all cookies from a user. &rarr; content:// provider allows websites to remotely steal any file from the device if the path is known</div></div></div><div class="change-set" id="c6"><div class="comment" data-id="14902194" data-no="6"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-6" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a442451_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a442451_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-6"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-6" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c6">Comment 6</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-25 11:15 PDT" data-time="1593108959">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-6">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-6" data-comment-id="14902194" data-ismarkdown="true" ><p>so what is this content:// scheme? it&#39;s like file:// but worse, and none of the special-cased code that protects file:// from web content. what other non-web internal schemes does Fennec support and expose to web content?</p>
</div><div class="activity"><div class="change">Flags: needinfo?(petru.lingurar)</div></div></div><div class="change-set" id="c7"><div class="comment" data-id="14902203" data-no="7"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-7" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_388264" id="a442451_1689"><img src="https://secure.gravatar.com/avatar/73072cf44258fa9cb3ae3ed4f47b9939?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_388264" id="a442451_1689"><a class="email " href="/user_profile?user_id=388264" > <span class="fna">Stefan Arentz | :st3fan | ⏰ EST | he/him</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-7"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-7" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c7">Comment 7</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-25 11:21 PDT" data-time="1593109295">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-7">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-7" data-comment-id="14902203" data-ismarkdown="true" ><p>Is this a possible solution: disable access to content:// URLs from web content?</p>
</div></div><div class="change-set" id="c8"><div class="comment" data-id="14902220" data-no="8"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-8" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_421286" id="a442451_1689"><img src="https://secure.gravatar.com/avatar/2f23a572bdd06777026ab2c155cfe0c0?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_421286" id="a442451_1689"><a class="email " href="/user_profile?user_id=421286" > <span class="fna">Agi Sferro | :agi | ni? for questions | ⏰ PST | he/him</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-8"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-8" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c8">Comment 8</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-25 11:32 PDT" data-time="1593109937">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-8">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-8" data-comment-id="14902220" data-ismarkdown="true" ><p>Yeah why is <code>content://</code> exposed to web content? I don&#39;t think it should? I&#39;m investigating.</p>
</div></div><div class="change-set" id="c9"><div class="comment" data-id="14902242" data-no="9"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-9" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_665275" id="a442451_1689"><img src="https://secure.gravatar.com/avatar/fba1cdeef36023e3cfc2558b3d82963d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_665275" id="a442451_1689"><a class="email " href="/user_profile?user_id=665275" > <span class="fna">Pedro Oliveira</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-9"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-9" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c9">Comment 9</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-25 11:40 PDT" data-time="1593110413">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-9">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-9" data-comment-id="14902242" data-ismarkdown="true" ><p>Hey again,</p>
<p>I just want to clarify the last comments. The Web has not access to the <code>content://</code> Uri. What is happening in this exploit, is the usage of <code>android-app</code> scheme to force Firefox to open a <code>content://</code> Uri webpage.</p>
<p>As seen in your intent-filter:</p>
<pre><code> &lt;intent-filter&gt;
	 &lt;action android:name=&quot;android.intent.action.VIEW&quot;/&gt;
   &lt;category android:name=&quot;android.intent.category.BROWSABLE&quot;/&gt;
   &lt;category android:name=&quot;android.intent.category.DEFAULT&quot;/&gt;
   &lt;data android:scheme=&quot;file&quot;/&gt;
   &lt;data android:scheme=&quot;http&quot;/&gt;
   &lt;data android:scheme=&quot;https&quot;/&gt;
   &lt;data android:scheme=&quot;content&quot;/&gt;
   &lt;data android:mimeType=&quot;text/html&quot;/&gt;
   &lt;data android:mimeType=&quot;text/plain&quot;/&gt;
   &lt;data android:mimeType=&quot;application/xhtml+xml&quot;/&gt;
   &lt;data android:mimeType=&quot;image/svg+xml&quot;/&gt;
 &lt;/intent-filter&gt;

</code></pre>
<p>Firefox supports the <code>content</code> schema. And is that schema I&#39;m sending in this javascript code:</p>
<pre><code>window.location.href = &#39;android-app://org.mozilla.firefox/content/org.mozilla.firefox.fileprovider/root/sdcard/Download/cookies.sqlite#Intent;type=text/html;end&#39;;
</code></pre>
<p>This forces Firefox to process an <code>android-app</code> intent (<a href="https://developer.android.com/reference/android/content/Intent#URI_ANDROID_APP_SCHEME" rel="nofollow">more info here</a>), which will open an HTML page that was just downloaded (by the same page.). So the exploit is local at this point. I just forced Firefox to open the newly downloaded file.</p>
<p>Removing that support for <code>content://</code> will make Firefox unable to open local HTML files (e.g Open with... )</p>
<p>Let me know if I can help you clarifying the attack vector,</p>
<p>Thanks</p>
<p>@kanytu</p>
</div></div><div class="change-set" id="c10"><div class="comment" data-id="14902278" data-no="10"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-10" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_421286" id="a442451_1689"><img src="https://secure.gravatar.com/avatar/2f23a572bdd06777026ab2c155cfe0c0?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_421286" id="a442451_1689"><a class="email " href="/user_profile?user_id=421286" > <span class="fna">Agi Sferro | :agi | ni? for questions | ⏰ PST | he/him</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-10"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-10" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c10">Comment 10</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-25 11:58 PDT" data-time="1593111523">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-10">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-10" data-comment-id="14902278" data-ismarkdown="true" ><p>kanytu, thanks for reporting this.</p>
<p>I tried to load this html from a local http server in Fennec</p>
<pre><code>&lt;html&gt;
&lt;body&gt;
  &lt;iframe src=&quot;content://org.mozilla.firefox.fileprovider/data/local/tmp/test.txt&quot;&gt;&lt;/iframe&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>and I got a crash, so at least in some form web content <em>does</em> have access to a <code>content://</code> URL, which I think it&#39;s wrong, but it might be unrelated to this.</p>
</div></div><div class="change-set" id="c11"><div class="comment" data-id="14902285" data-no="11"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-11" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_665275" id="a442451_1689"><img src="https://secure.gravatar.com/avatar/fba1cdeef36023e3cfc2558b3d82963d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_665275" id="a442451_1689"><a class="email " href="/user_profile?user_id=665275" > <span class="fna">Pedro Oliveira</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-11"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-11" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c11">Comment 11</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-25 12:02 PDT" data-time="1593111739">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-11">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-11" data-comment-id="14902285" data-ismarkdown="true" ><p>Hum I see,</p>
<p>Indeed that shouldn&#39;t happen, however the website wont have access to that Iframe because the origin is not the same, so that doesn&#39;t seem much of a security problem to me. But that still shows that Firefox tried to download that content uri file to its internal directory. The crash might have been because the URI is correctly generated.</p>
<p>That being said, that doesn&#39;t seem related to this attack because the intent redirection turns the vector from remote to local.</p>
</div></div><div class="change-set" id="c12"><div class="comment" data-id="14902313" data-no="12"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-12" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_388264" id="a442451_1689"><img src="https://secure.gravatar.com/avatar/73072cf44258fa9cb3ae3ed4f47b9939?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_388264" id="a442451_1689"><a class="email " href="/user_profile?user_id=388264" > <span class="fna">Stefan Arentz | :st3fan | ⏰ EST | he/him</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-12"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-12" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c12">Comment 12</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-25 12:19 PDT" data-time="1593112761">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-12">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-12" data-comment-id="14902313" data-ismarkdown="true" ><p>FWIW I am not against disabling <code>content://</code> for Fennec 68.11.</p>
</div></div><div class="change-set" id="c13"><div class="comment" data-id="14902317" data-no="13"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-13" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_388264" id="a442451_1689"><img src="https://secure.gravatar.com/avatar/73072cf44258fa9cb3ae3ed4f47b9939?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_388264" id="a442451_1689"><a class="email " href="/user_profile?user_id=388264" > <span class="fna">Stefan Arentz | :st3fan | ⏰ EST | he/him</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-13"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-13" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c13">Comment 13</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-25 12:20 PDT" data-time="1593112829">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-13">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-13" data-comment-id="14902317" data-ismarkdown="true" ><p>kanytu, do you think changing the root path to <code>/storage/</code> and disabling <code>content://</code> scheme from the <code>VIEW</code> intent would be enough to stop this attack?</p>
</div><div class="activity"><div class="change">Flags: needinfo?(kanytu)</div></div></div><div class="change-set" id="c14"><div class="comment" data-id="14902331" data-no="14"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-14" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_665275" id="a442451_1689"><img src="https://secure.gravatar.com/avatar/fba1cdeef36023e3cfc2558b3d82963d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_665275" id="a442451_1689"><a class="email " href="/user_profile?user_id=665275" > <span class="fna">Pedro Oliveira</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-14"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-14" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c14">Comment 14</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-25 12:27 PDT" data-time="1593113239">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-14">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-14" data-comment-id="14902331" data-ismarkdown="true" ><p>Yes. It will. However won&#39;t be enough for a local attack with a malicious app I guess. I think an application without storage permissions will still be able to extract files from the device with this exploit by sending an explicit intent to Firefox following the same strategy.</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(kanytu)</span></div></div></div><div class="change-set" id="c15"><div class="comment" data-id="14902346" data-no="15"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-15" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_665275" id="a442451_1689"><img src="https://secure.gravatar.com/avatar/fba1cdeef36023e3cfc2558b3d82963d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_665275" id="a442451_1689"><a class="email " href="/user_profile?user_id=665275" > <span class="fna">Pedro Oliveira</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-15"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-15" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c15">Comment 15</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-25 12:35 PDT" data-time="1593113735">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-15">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-15" data-comment-id="14902346" data-ismarkdown="true" ><p>The above comment is valid only if you don&#39;t address the replacement problem in content URI downloads.</p>
<p>If you address that, there is no way this attack can be achieved.</p>
</div></div><div class="change-set" id="c16"><div class="comment" data-id="14902356" data-no="16"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-16" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_388264" id="a442451_1689"><img src="https://secure.gravatar.com/avatar/73072cf44258fa9cb3ae3ed4f47b9939?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_388264" id="a442451_1689"><a class="email " href="/user_profile?user_id=388264" > <span class="fna">Stefan Arentz | :st3fan | ⏰ EST | he/him</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-16"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-16" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c16">Comment 16</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-25 12:39 PDT" data-time="1593113995">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-16">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-16" data-comment-id="14902356" data-ismarkdown="true" ><p>Possibly related to / more hints in <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1516467">https://bugzilla.mozilla.org/show_bug.cgi?id=1516467</a></p>
</div></div><div class="change-set" id="c17"><div class="comment" data-id="14902400" data-no="17"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-17" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_388264" id="a442451_1689"><img src="https://secure.gravatar.com/avatar/73072cf44258fa9cb3ae3ed4f47b9939?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_388264" id="a442451_1689"><a class="email " href="/user_profile?user_id=388264" > <span class="fna">Stefan Arentz | :st3fan | ⏰ EST | he/him</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-17"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-17" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c17">Comment 17</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-25 12:49 PDT" data-time="1593114556">1 year ago</span>
          </div>&bull;
<div class="change-revisions">
  <a href="/page.cgi?id=comment-revisions.html&amp;bug_id=1647078&amp;comment_id=14902400"
     title="1 revision">Edited</a>
</div>
        </td>
      </tr>

      <tr id="ctag-17">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-17" data-comment-id="14902400" data-ismarkdown="true" ><p>I think this regression was introduced by <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1499618">https://bugzilla.mozilla.org/show_bug.cgi?id=1499618</a></p>
<p>which in turn seemed to be a regression from <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1406903">https://bugzilla.mozilla.org/show_bug.cgi?id=1406903</a></p>
<p>which is &quot;cannot view files using content:// scheme&quot;</p>
</div></div><div class="change-set" id="c18"><div class="comment" data-id="14902433" data-no="18"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-18" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_388264" id="a442451_1689"><img src="https://secure.gravatar.com/avatar/73072cf44258fa9cb3ae3ed4f47b9939?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_388264" id="a442451_1689"><a class="email " href="/user_profile?user_id=388264" > <span class="fna">Stefan Arentz | :st3fan | ⏰ EST | he/him</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-18"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-18" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c18">Comment 18</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-25 13:05 PDT" data-time="1593115554">1 year ago</span>
          </div>&bull;
<div class="change-revisions">
  <a href="/page.cgi?id=comment-revisions.html&amp;bug_id=1647078&amp;comment_id=14902433"
     title="2 revisions">Edited</a>
</div>
        </td>
      </tr>

      <tr id="ctag-18">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-18" data-comment-id="14902433" data-ismarkdown="true" ><p>Given the short timeframe we have towards Fennec 68.11 I want to suggest three options:</p>
<ul>
<li>
<p>We remove support for <code>content://</code>. Not just from the manifest and through the <code>VIEW</code> intent, but also from the code introduced by 1406903 and 1499618</p>
</li>
<li>
<p>We remove just the code introduced by <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1499618" title="RESOLVED FIXED - Crash in java.lang.IllegalArgumentException: at android.database.AbstractCursor.getColumnIndexOrThrow(AbstractCursor.java)">bug 1499618</a> since that is probably the culprit here, trying to be smart about content urls, and doing the actual file copy to a temporary file which is then served.</p>
</li>
<li>
<p>We fix this properly. Keeping the existing functionality but putting proper URL santization and whatever else needed on the handling of content:// URIs</p>
</li>
</ul>
<p>Considering the future of Fennec,  my personal preference would be the first option.  But it may also be the most risky one since it may touch a lot of code. Although mostly removal probably.</p>
<p>Let&#39;s try to make a decision soon. It is not entirely clear what path to take.</p>
</div></div><div class="change-set" id="c19"><div class="comment" data-id="14902480" data-no="19"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-19" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_406670" id="a442451_1689"><img src="https://secure.gravatar.com/avatar/3be472321f8ced3986562b808499a0a4?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_406670" id="a442451_1689"><a class="email " href="/user_profile?user_id=406670" > <span class="fna">Kevin Brosnan [:kbrosnan]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-19"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-19" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c19">Comment 19</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-25 13:27 PDT" data-time="1593116839">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-19">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-19" data-comment-id="14902480" data-ismarkdown="true" ><p>I don&#39;t love the idea of removing <code>content:</code> URIs globally. This is the modern way of passing data between apps. Android 7.0 switched to content: being the way to reference local files. <a href="https://developer.android.com/about/versions/nougat/android-7.0-changes#sharing-files" rel="nofollow">https://developer.android.com/about/versions/nougat/android-7.0-changes#sharing-files</a></p>
<p><a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1375035" title="RESOLVED DUPLICATE - Add support for opening .html files">Bug 1375035</a> provides a fairly common example of how content: uris are used in Android. Passing an attachment from email apps.</p>
<p>JanH could be a good person to talk to about this.</p>
</div></div><div class="change-set" id="c20"><div class="comment" data-id="14902557" data-no="20"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-20" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_421286" id="a442451_1689"><img src="https://secure.gravatar.com/avatar/2f23a572bdd06777026ab2c155cfe0c0?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_421286" id="a442451_1689"><a class="email " href="/user_profile?user_id=421286" > <span class="fna">Agi Sferro | :agi | ni? for questions | ⏰ PST | he/him</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-20"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-20" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c20">Comment 20</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-25 13:56 PDT" data-time="1593118590">1 year ago</span>
          </div>&bull;
<div class="change-revisions">
  <a href="/page.cgi?id=comment-revisions.html&amp;bug_id=1647078&amp;comment_id=14902557"
     title="1 revision">Edited</a>
</div>
        </td>
      </tr>

      <tr id="ctag-20">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-20" data-comment-id="14902557" data-ismarkdown="true" ><p>Removing <code>content:</code> globally probably not , but we should restrict it severely, similar to <code>file:</code>, right now it looks like it&#39;s completely unrestricted.</p>
<p>Looks like Fenix doesn&#39;t support this case FWIW, so unless we plan to implement it soon this functionality will go away anyway.</p>
</div></div><div class="change-set" id="c21"><div class="comment" data-id="14902567" data-no="21"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-21" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_421286" id="a442451_1689"><img src="https://secure.gravatar.com/avatar/2f23a572bdd06777026ab2c155cfe0c0?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_421286" id="a442451_1689"><a class="email " href="/user_profile?user_id=421286" > <span class="fna">Agi Sferro | :agi | ni? for questions | ⏰ PST | he/him</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-21"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-21" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c21">Comment 21</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-25 14:03 PDT" data-time="1593119030">1 year ago</span>
          </div>&bull;
<div class="change-revisions">
  <a href="/page.cgi?id=comment-revisions.html&amp;bug_id=1647078&amp;comment_id=14902567"
     title="1 revision">Edited</a>
</div>
        </td>
      </tr>

      <tr id="ctag-21">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-21" data-comment-id="14902567" data-ismarkdown="true" ><p>I think what we should do here is reject any attempt to load from <code>content://</code> URIs from in-content, leaving top-level as the only way to load a <code>content://</code> URIs. So top-level HTML/images etc will still load in Fennec but all sub-resources will be broken.</p>
</div></div><div class="change-set" id="a455580_152868"><div class="change" id="aa455580_152868">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_152868" id="a455580_152868"><img src="https://secure.gravatar.com/avatar/d306c2d94128ba9f5f1830321f99e9c2?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_152868" id="a455580_152868"><a class="email " href="/user_profile?user_id=152868" > <span class="fna">David Bolter [:davidb] (NeedInfo me for attention)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a455580_152868"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a455580_152868">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#a455580_152868">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-25 14:07 PDT" data-time="1593119272">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(snorp)</span></div></div></div><div class="change-set" id="c22"><div class="comment" data-id="14902919" data-no="22"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-22" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a455580_152868"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a455580_152868"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-22"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-22" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c22">Comment 22</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-25 17:19 PDT" data-time="1593130746">1 year ago</span>
          </div>&bull;
<div class="change-revisions">
  <a href="/page.cgi?id=comment-revisions.html&amp;bug_id=1647078&amp;comment_id=14902919"
     title="1 revision">Edited</a>
</div>
        </td>
      </tr>

      <tr id="ctag-22">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-22" data-comment-id="14902919" data-ismarkdown="true" ><p>Apologies if this is a dumb question, I don&#39;t normally work on our mobile apps. But why is web content allowed to navigate to <code>android-app:</code> protocol URIs? Is that required for web compat, even without user interaction? And even if we do need it, can we at least block the ones pointing to our own app&#39;s <code>content:</code> URL provider?</p>
</div></div><div class="change-set" id="c23"><div class="comment" data-id="14902928" data-no="23"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-23" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_421286" id="a455580_152868"><img src="https://secure.gravatar.com/avatar/2f23a572bdd06777026ab2c155cfe0c0?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_421286" id="a455580_152868"><a class="email " href="/user_profile?user_id=421286" > <span class="fna">Agi Sferro | :agi | ni? for questions | ⏰ PST | he/him</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-23"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-23" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c23">Comment 23</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-25 17:26 PDT" data-time="1593131205">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-23">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9159562"
         class="attachment"
         data-id="9159562" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="phabricator-D81253-url.txt">
      <meta itemprop="contentSize" content="47">
      <meta itemprop="encodingFormat" content="text/x-phabricator-request">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=9159562" itemprop="contentUrl">
        <span id="att-9159562-description" itemprop="description">Bug 1647078 - Load content:// URIs from intents as file://.</span></a>
        — <a href="attachment.cgi?id=9159562&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <div
        class="comment-text markdown-body "
        id="ct-23" data-comment-id="14902928" data-ismarkdown="true" ><p>This change intercepts intents that try to load a content:// URI, copy the<br>
content to a file and then open that file:// in the browser.</p>
</div></div><div class="change-set" id="a467513_600971"><div class="change" id="aa467513_600971">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_600971" id="a467513_600971"><img src="https://secure.gravatar.com/avatar/a088418052679d9583556d277e6774ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_600971" id="a467513_600971"><a class="email " href="/user_profile?user_id=600971" > <span class="fna">Phabricator Automation</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a467513_600971"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a467513_600971">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#a467513_600971">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-25 17:26 PDT" data-time="1593131205">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Assignee: nobody &rarr; agi</div><div class="change">Status: NEW &rarr; ASSIGNED</div></div></div><div class="change-set" id="c24"><div class="comment" data-id="14902929" data-no="24"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-24" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_421286" id="a467513_600971"><img src="https://secure.gravatar.com/avatar/2f23a572bdd06777026ab2c155cfe0c0?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_421286" id="a467513_600971"><a class="email " href="/user_profile?user_id=421286" > <span class="fna">Agi Sferro | :agi | ni? for questions | ⏰ PST | he/him</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-24"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-24" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c24">Comment 24</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-25 17:26 PDT" data-time="1593131209">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-24">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9159563"
         class="attachment"
         data-id="9159563" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="phabricator-D81254-url.txt">
      <meta itemprop="contentSize" content="47">
      <meta itemprop="encodingFormat" content="text/x-phabricator-request">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=9159563" itemprop="contentUrl">
        <span id="att-9159563-description" itemprop="description">Bug 1647078 - Never handle content:// channels from Web.</span></a>
        — <a href="attachment.cgi?id=9159563&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <div
        class="comment-text markdown-body "
        id="ct-24" data-comment-id="14902929" data-ismarkdown="true" ><p>This patch forbids loading content:// URIs coming from web content. If a web<br>
page tries to load a content:// url in a sub-resource (like an image, script or<br>
iframe) the browser will return an unknown protocol error.</p>
</div></div><div class="change-set" id="c25"><div class="comment" data-id="14902930" data-no="25"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-25" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_421286" id="a467513_600971"><img src="https://secure.gravatar.com/avatar/2f23a572bdd06777026ab2c155cfe0c0?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_421286" id="a467513_600971"><a class="email " href="/user_profile?user_id=421286" > <span class="fna">Agi Sferro | :agi | ni? for questions | ⏰ PST | he/him</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-25"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-25" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c25">Comment 25</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-25 17:26 PDT" data-time="1593131212">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-25">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9159564"
         class="attachment"
         data-id="9159564" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="phabricator-D81255-url.txt">
      <meta itemprop="contentSize" content="47">
      <meta itemprop="encodingFormat" content="text/x-phabricator-request">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=9159564" itemprop="contentUrl">
        <span id="att-9159564-description" itemprop="description">Bug 1647078 - Use random file names when copying a content:// URI.</span></a>
        — <a href="attachment.cgi?id=9159564&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <div
        class="comment-text markdown-body "
        id="ct-25" data-comment-id="14902930" data-ismarkdown="true" ><p>When copying a content:// URI to a temp file we will use a random file name<br>
instead of the actual file name of the resource to avoid name clashing.</p>
</div></div><div class="change-set" id="c26"><div class="comment" data-id="14902931" data-no="26"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-26" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_421286" id="a467513_600971"><img src="https://secure.gravatar.com/avatar/2f23a572bdd06777026ab2c155cfe0c0?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_421286" id="a467513_600971"><a class="email " href="/user_profile?user_id=421286" > <span class="fna">Agi Sferro | :agi | ni? for questions | ⏰ PST | he/him</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-26"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-26" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c26">Comment 26</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-25 17:27 PDT" data-time="1593131221">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-26">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9159565"
         class="attachment"
         data-id="9159565" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="phabricator-D81256-url.txt">
      <meta itemprop="contentSize" content="47">
      <meta itemprop="encodingFormat" content="text/x-phabricator-request">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=9159565" itemprop="contentUrl">
        <span id="att-9159565-description" itemprop="description">Bug 1647078 - Always copy content:// files.</span></a>
        — <a href="attachment.cgi?id=9159565&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <div
        class="comment-text markdown-body "
        id="ct-26" data-comment-id="14902931" data-ismarkdown="true" ><p>This patch makes it so we never attempt to load a content:// URI by guessing<br>
it&#39;s file location, and instead always open a copy.</p>
</div></div><div class="change-set" id="c27"><div class="comment" data-id="14902934" data-no="27"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-27" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_421286" id="a467513_600971"><img src="https://secure.gravatar.com/avatar/2f23a572bdd06777026ab2c155cfe0c0?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_421286" id="a467513_600971"><a class="email " href="/user_profile?user_id=421286" > <span class="fna">Agi Sferro | :agi | ni? for questions | ⏰ PST | he/him</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-27"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-27" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c27">Comment 27</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-25 17:28 PDT" data-time="1593131335">1 year ago</span>
          </div>&bull;
<div class="change-revisions">
  <a href="/page.cgi?id=comment-revisions.html&amp;bug_id=1647078&amp;comment_id=14902934"
     title="1 revision">Edited</a>
</div>
        </td>
      </tr>

      <tr id="ctag-27">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-27" data-comment-id="14902934" data-ismarkdown="true" ><p>(In reply to :Gijs (he/him) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1647078#c22" title="VERIFIED FIXED - content:// provider allows websites to remotely steal any file from the device if the path is known">comment #22</a>)</p>
<blockquote>
<p>Apologies if this is a dumb question, I don&#39;t normally work on our mobile apps. But why is web content allowed to navigate to <code>android-app:</code> protocol URIs? Is that required for web compat, even without user interaction? And even if we do need it, can we at least block the ones pointing to our own app&#39;s <code>content:</code> URL provider?</p>
</blockquote>
<p><code>android-app:</code> links are the way web pages open an app instead of a web page when navigating to them. We can definitely restrict them to user-interaction-only, and I think Fenix does that already.</p>
<p>Also you&#39;re correct into thinking that <code>android-app:</code> should never open Firefox itself, just external apps (and we should probably check that for Fenix?). Although the same attack can be carried over by a local app on the device, which is still pretty bad.</p>
</div></div><div class="change-set" id="c28"><div class="comment" data-id="14902942" data-no="28"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-28" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_421286" id="a467513_600971"><img src="https://secure.gravatar.com/avatar/2f23a572bdd06777026ab2c155cfe0c0?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_421286" id="a467513_600971"><a class="email " href="/user_profile?user_id=421286" > <span class="fna">Agi Sferro | :agi | ni? for questions | ⏰ PST | he/him</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-28"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-28" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c28">Comment 28</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-25 17:39 PDT" data-time="1593131977">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-28">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-28" data-comment-id="14902942" data-ismarkdown="true" ><p>The patches that I&#39;ve attached to this add some hardening of the <code>content://</code> handling in Fennec. We don&#39;t have to take them all, we can also just disable the <code>content://</code> protocol outright by just taking <a href="https://phabricator.services.mozilla.com/D81254" rel="nofollow">this one</a> (plus not responding to the content:// protocol at all in the manifest).</p>
<p>These are the steps that the above patches take:</p>
<ul>
<li>The file name is a secure-random UUID, so name clashing or resource spoofing is not possible anymore</li>
<li>We always open a <code>content://</code> URI to a temporary file, never in the actual location, so that the page cannot request additional resource from protected folders</li>
<li>We only accept <code>content://</code> URIs from intents, and we immediately translate them to the copied-over file:// URL. This ensures that sub-resources cannot load <code>content://</code> URIs (like scripts, images, iframes). This also means that loading html files only works for plain HTML, all subresources won&#39;t be loaded. This is not actually a big loss, since on modern android versions this is basically what happens anyway.</li>
<li>We double check that we&#39;re not trying to load a <code>content://</code> URI in the external protocol handler, and if that happens we just reject the load without asking Fennec.</li>
</ul>
</div></div><div class="change-set" id="c29"><div class="comment" data-id="14902944" data-no="29"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-29" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_421286" id="a467513_600971"><img src="https://secure.gravatar.com/avatar/2f23a572bdd06777026ab2c155cfe0c0?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_421286" id="a467513_600971"><a class="email " href="/user_profile?user_id=421286" > <span class="fna">Agi Sferro | :agi | ni? for questions | ⏰ PST | he/him</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-29"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-29" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c29">Comment 29</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-25 17:40 PDT" data-time="1593132037">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-29">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-29" data-comment-id="14902944" data-ismarkdown="true" ><p>TL;DR After these changes the user can still open attachments from other apps, including HTML files but none of the attack vectors are present anymore. Subresources like images, scripts and iframes from HTML files won&#39;t load at all.</p>
</div></div><div class="change-set" id="c30"><div class="comment" data-id="14903160" data-no="30"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-30" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_421286" id="a467513_600971"><img src="https://secure.gravatar.com/avatar/2f23a572bdd06777026ab2c155cfe0c0?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_421286" id="a467513_600971"><a class="email " href="/user_profile?user_id=421286" > <span class="fna">Agi Sferro | :agi | ni? for questions | ⏰ PST | he/him</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-30"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-30" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c30">Comment 30</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-25 22:38 PDT" data-time="1593149929">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-30">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-30" data-comment-id="14903160" data-ismarkdown="true" ><p>One thing I haven&#39;t looked at yet is whether an app can still trick Fennec into producing a <code>content://</code> intent for internal data.</p>
</div></div><div class="change-set" id="c31"><div class="comment" data-id="14903364" data-no="31"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-31" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_613831" id="a467513_600971"><img src="https://secure.gravatar.com/avatar/30b3814cd436f3c69ec94320d4d72398?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_613831" id="a467513_600971"><a class="email " href="/user_profile?user_id=613831" > <span class="fna">Petru-Mugurel Lingurar [:petru]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-31"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-31" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c31">Comment 31</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-26 01:46 PDT" data-time="1593161200">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-31">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-31" data-comment-id="14903364" data-ismarkdown="true" ><p>The way I see it, I don&#39;t really think this ^^ is a possibility anymore.<br>
After the patches here an app could still start fennec with a <code>content://</code> or <code>file</code> Intent data (while websites could not anymore) to open a specific file. It could even be an internal storage file.<br>
It could even be the html disguised as profile.ini from here. And we needed this behavior for relatively common usecases like loading/opening device files with Fennec.<br>
I think previously <code>content://</code> Intents would&#39;ve probably even worked for overwriting contentUri files. Now with random filenames this isn&#39;t possible anymore.<br>
The biggest find in this report is though how through nested htmls(iframes) and by leveraging the overwriting we did in contentUri directory one cleverly designed script could overwrite with and then most importantly extract that data of private files.<br>
After the changes from the patches here to not handle <code>content://</code> uris requests from the web I don&#39;t see any possibility of extracting the data.</p>
</div></div><div class="change-set" id="a497539_613831"><div class="change" id="aa497539_613831">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_613831" id="a497539_613831"><img src="https://secure.gravatar.com/avatar/30b3814cd436f3c69ec94320d4d72398?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_613831" id="a497539_613831"><a class="email " href="/user_profile?user_id=613831" > <span class="fna">Petru-Mugurel Lingurar [:petru]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a497539_613831"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a497539_613831">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#a497539_613831">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-26 01:47 PDT" data-time="1593161231">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(petru.lingurar)</span></div></div></div><div class="change-set" id="c32"><div class="comment" data-id="14903497" data-no="32"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-32" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_665275" id="a497539_613831"><img src="https://secure.gravatar.com/avatar/fba1cdeef36023e3cfc2558b3d82963d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_665275" id="a497539_613831"><a class="email " href="/user_profile?user_id=665275" > <span class="fna">Pedro Oliveira</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-32"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-32" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c32">Comment 32</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-26 03:05 PDT" data-time="1593165929">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-32">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-32" data-comment-id="14903497" data-ismarkdown="true" ><p>I see that the Content Provider configuration XML was not addressed. It is still exposing the root folder of the device. This can potentially lead to security issues. Is this expected?</p>
</div></div><div class="change-set" id="c33"><div class="comment" data-id="14903516" data-no="33"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-33" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_613831" id="a497539_613831"><img src="https://secure.gravatar.com/avatar/30b3814cd436f3c69ec94320d4d72398?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_613831" id="a497539_613831"><a class="email " href="/user_profile?user_id=613831" > <span class="fna">Petru-Mugurel Lingurar [:petru]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-33"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-33" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c33">Comment 33</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-26 03:14 PDT" data-time="1593166460">1 year ago</span>
          </div>&bull;
<div class="change-revisions">
  <a href="/page.cgi?id=comment-revisions.html&amp;bug_id=1647078&amp;comment_id=14903516"
     title="1 revision">Edited</a>
</div>
        </td>
      </tr>

      <tr id="ctag-33">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-33" data-comment-id="14903516" data-ismarkdown="true" ><p>(In reply to Daniel Veditz [:dveditz] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1647078#c6" title="VERIFIED FIXED - content:// provider allows websites to remotely steal any file from the device if the path is known">comment #6</a>)</p>
<blockquote>
<p>so what is this content:// scheme? it&#39;s like file:// but worse, and none of the special-cased code that protects file:// from web content. what other non-web internal schemes does Fennec support and expose to web content?</p>
</blockquote>
<p>Actually is should be like <code>file://</code> but better. After Android 7.0 exposing files through the <code>file://</code> scheme is discouraged (<a href="https://developer.android.com/about/versions/nougat/android-7.0-changes.html#perm" rel="nofollow">Android changelog</a>).<br>
The <code>content</code> scheme is of the essence here because of how that is handled inside the app: Because it&#39;s real source is not known, may not even be a resource on disk, we cache that as a File on disk in the contentUri directory in app&#39;s internal storage and then open that inside of Fennec.<br>
If another request is made to load another content uri which would resolve to the same File name the already existing one in the contentUri private directory would get overwritten. And if someone was to already have a reference to that initial File it would get the new content.</p>
</div></div><div class="change-set" id="c34"><div class="comment" data-id="14903521" data-no="34"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-34" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_613831" id="a497539_613831"><img src="https://secure.gravatar.com/avatar/30b3814cd436f3c69ec94320d4d72398?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_613831" id="a497539_613831"><a class="email " href="/user_profile?user_id=613831" > <span class="fna">Petru-Mugurel Lingurar [:petru]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-34"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-34" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c34">Comment 34</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-26 03:18 PDT" data-time="1593166710">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-34">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-34" data-comment-id="14903521" data-ismarkdown="true" ><p>(In reply to kanytu from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1647078#c32" title="VERIFIED FIXED - content:// provider allows websites to remotely steal any file from the device if the path is known">comment #32</a>)</p>
<blockquote>
<p>I see that the Content Provider configuration XML was not addressed. It is still exposing the root folder of the device. This can potentially lead to security issues. Is this expected?</p>
</blockquote>
<p>I think this is the expected behavior.<br>
Until now there was not a clear indication of how private data could be extracted from Fennec.<br>
It can open any files, yes, but only for the user&#39;s eyes.<br>
Only with your report we got a scenario in which a rogue website could extract private Fennec data.</p>
</div></div><div class="change-set" id="c35"><div class="comment" data-id="14903787" data-no="35"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-35" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_388264" id="a497539_613831"><img src="https://secure.gravatar.com/avatar/73072cf44258fa9cb3ae3ed4f47b9939?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_388264" id="a497539_613831"><a class="email " href="/user_profile?user_id=388264" > <span class="fna">Stefan Arentz | :st3fan | ⏰ EST | he/him</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-35"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-35" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c35">Comment 35</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-26 06:12 PDT" data-time="1593177122">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-35">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-35" data-comment-id="14903787" data-ismarkdown="true" ><p>Petru, what would regress if we change the root folder to the suggested <code>/storage/</code> ? I don&#39;t have a good feeling about this <code>.</code> there, which I assume means the root of Firefox. If we don&#39;t have a good reason for this, then I would suggest to change it to <code>/storage/</code>?</p>
</div></div><div class="change-set" id="a513452_388264"><div class="change" id="aa513452_388264">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_388264" id="a513452_388264"><img src="https://secure.gravatar.com/avatar/73072cf44258fa9cb3ae3ed4f47b9939?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_388264" id="a513452_388264"><a class="email " href="/user_profile?user_id=388264" > <span class="fna">Stefan Arentz | :st3fan | ⏰ EST | he/him</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a513452_388264"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a513452_388264">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#a513452_388264">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-26 06:12 PDT" data-time="1593177144">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: needinfo?(petru.lingurar)</div></div></div><div class="change-set" id="c36"><div class="comment" data-id="14903936" data-no="36"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-36" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_421286" id="a513452_388264"><img src="https://secure.gravatar.com/avatar/2f23a572bdd06777026ab2c155cfe0c0?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_421286" id="a513452_388264"><a class="email " href="/user_profile?user_id=421286" > <span class="fna">Agi Sferro | :agi | ni? for questions | ⏰ PST | he/him</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-36"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-36" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c36">Comment 36</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-26 07:43 PDT" data-time="1593182620">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-36">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-36" data-comment-id="14903936" data-ismarkdown="true" ><p>(In reply to Stefan Arentz [:st3fan] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1647078#c35" title="VERIFIED FIXED - content:// provider allows websites to remotely steal any file from the device if the path is known">comment #35</a>)</p>
<blockquote>
<p>Petru, what would regress if we change the root folder to the suggested <code>/storage/</code> ? I don&#39;t have a good feeling about this <code>.</code> there, which I assume means the root of Firefox. If we don&#39;t have a good reason for this, then I would suggest to change it to <code>/storage/</code>?</p>
</blockquote>
<p>My understanding is that will break opening Downloads for people that moved their download folder in a non-standard location. From what I can see this is only an <code>about:config</code> option?</p>
</div></div><div class="change-set" id="c37"><div class="comment" data-id="14903951" data-no="37"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-37" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_421286" id="a513452_388264"><img src="https://secure.gravatar.com/avatar/2f23a572bdd06777026ab2c155cfe0c0?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_421286" id="a513452_388264"><a class="email " href="/user_profile?user_id=421286" > <span class="fna">Agi Sferro | :agi | ni? for questions | ⏰ PST | he/him</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-37"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-37" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c37">Comment 37</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-26 07:50 PDT" data-time="1593183058">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-37">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-37" data-comment-id="14903951" data-ismarkdown="true" ><p>(In reply to kanytu from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1647078#c32" title="VERIFIED FIXED - content:// provider allows websites to remotely steal any file from the device if the path is known">comment #32</a>)</p>
<blockquote>
<p>I see that the Content Provider configuration XML was not addressed. It is still exposing the root folder of the device. This can potentially lead to security issues. Is this expected?</p>
</blockquote>
<p>That&#39;s what I meant with <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1647078#c30" title="VERIFIED FIXED - content:// provider allows websites to remotely steal any file from the device if the path is known">Comment 30</a>, I&#39;m looking into that right now :)</p>
</div></div><div class="change-set" id="c38"><div class="comment" data-id="14903971" data-no="38"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-38" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_421286" id="a513452_388264"><img src="https://secure.gravatar.com/avatar/2f23a572bdd06777026ab2c155cfe0c0?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_421286" id="a513452_388264"><a class="email " href="/user_profile?user_id=421286" > <span class="fna">Agi Sferro | :agi | ni? for questions | ⏰ PST | he/him</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-38"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-38" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c38">Comment 38</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-26 07:59 PDT" data-time="1593183596">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-38">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-38" data-comment-id="14903971" data-ismarkdown="true" ><p>(In reply to Agi Sferro | :agi | ⏰ PST | he/him from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1647078#c36" title="VERIFIED FIXED - content:// provider allows websites to remotely steal any file from the device if the path is known">comment #36</a>)</p>
<blockquote>
<p>(In reply to Stefan Arentz [:st3fan] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1647078#c35" title="VERIFIED FIXED - content:// provider allows websites to remotely steal any file from the device if the path is known">comment #35</a>)</p>
<blockquote>
<p>Petru, what would regress if we change the root folder to the suggested <code>/storage/</code> ? I don&#39;t have a good feeling about this <code>.</code> there, which I assume means the root of Firefox. If we don&#39;t have a good reason for this, then I would suggest to change it to <code>/storage/</code>?</p>
</blockquote>
<p>My understanding is that will break opening Downloads for people that moved their download folder in a non-standard location. From what I can see this is only an <code>about:config</code> option?</p>
</blockquote>
<p>actually it would only break it for people who moved their Download folder to an internal Firefox folder? that seems pretty unusual.</p>
</div></div><div class="change-set" id="c39"><div class="comment" data-id="14903974" data-no="39"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-39" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_665275" id="a513452_388264"><img src="https://secure.gravatar.com/avatar/fba1cdeef36023e3cfc2558b3d82963d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_665275" id="a513452_388264"><a class="email " href="/user_profile?user_id=665275" > <span class="fna">Pedro Oliveira</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-39"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-39" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c39">Comment 39</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-26 08:02 PDT" data-time="1593183724">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-39">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-39" data-comment-id="14903974" data-ismarkdown="true" ><p>That&#39;s what I said in <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1647078#c4">https://bugzilla.mozilla.org/show_bug.cgi?id=1647078#c4</a></p>
<p>No file manager would give the option to choose an internal folder.  For removable sdcards, their path always start with <code>/storage/</code> too.</p>
</div></div><div class="change-set" id="c40"><div class="comment" data-id="14903982" data-no="40"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-40" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_421286" id="a513452_388264"><img src="https://secure.gravatar.com/avatar/2f23a572bdd06777026ab2c155cfe0c0?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_421286" id="a513452_388264"><a class="email " href="/user_profile?user_id=421286" > <span class="fna">Agi Sferro | :agi | ni? for questions | ⏰ PST | he/him</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-40"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-40" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c40">Comment 40</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-26 08:06 PDT" data-time="1593183996">1 year ago</span>
          </div>&bull;
<div class="change-revisions">
  <a href="/page.cgi?id=comment-revisions.html&amp;bug_id=1647078&amp;comment_id=14903982"
     title="1 revision">Edited</a>
</div>
        </td>
      </tr>

      <tr id="ctag-40">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-40" data-comment-id="14903982" data-ismarkdown="true" ><p>(In reply to Stefan Arentz [:st3fan] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1647078#c35" title="VERIFIED FIXED - content:// provider allows websites to remotely steal any file from the device if the path is known">comment #35</a>)</p>
<blockquote>
<p>Petru, what would regress if we change the root folder to the suggested <code>/storage/</code> ? I don&#39;t have a good feeling about this <code>.</code> there, which I assume means the root of Firefox. If we don&#39;t have a good reason for this, then I would suggest to change it to <code>/storage/</code>?</p>
</blockquote>
<p><code>root-path</code> is actually the root of the device (and from what I can see it&#39;s an undocumented option). So it&#39;s actually worse than you think.</p>
<p>(In reply to kanytu from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1647078#c39" title="VERIFIED FIXED - content:// provider allows websites to remotely steal any file from the device if the path is known">comment #39</a>)</p>
<blockquote>
<p>That&#39;s what I said in <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1647078#c4">https://bugzilla.mozilla.org/show_bug.cgi?id=1647078#c4</a></p>
<p>No file manager would give the option to choose an internal folder.  For removable sdcards, their path always start with <code>/storage/</code> too.</p>
</blockquote>
<p>oh I see, sorry I&#39;m still processing all of this, thanks! The user can still type the folder out in <code>about:config</code> even if they don&#39;t have access to it but yeah, not really a use case.</p>
</div></div><div class="change-set" id="c41"><div class="comment" data-id="14903990" data-no="41"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-41" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_613831" id="a513452_388264"><img src="https://secure.gravatar.com/avatar/30b3814cd436f3c69ec94320d4d72398?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_613831" id="a513452_388264"><a class="email " href="/user_profile?user_id=613831" > <span class="fna">Petru-Mugurel Lingurar [:petru]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-41"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-41" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c41">Comment 41</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-26 08:11 PDT" data-time="1593184311">1 year ago</span>
          </div>&bull;
<div class="change-revisions">
  <a href="/page.cgi?id=comment-revisions.html&amp;bug_id=1647078&amp;comment_id=14903990"
     title="1 revision">Edited</a>
</div>
        </td>
      </tr>

      <tr id="ctag-41">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-41" data-comment-id="14903990" data-ismarkdown="true" ><p>My understanding is the same as Agi&#39;s.<br>
There is a very small possibility that some users set (through about:config which I wasn&#39;t able to, we can test more if needed) their downloads folder to be in some other location that the external storage - what normal users see as storage - device or sdcard.</p>
<p><code>&lt;root-path name=&quot;root&quot; path=&quot;.&quot;/&gt;</code> normal users, not even root users could use fennec&#39;s internal storage + any external storage mediums.<br>
<code>&lt;root-path name=&quot;root&quot; path=&quot;/storage/&quot;/&gt;</code> would mean any external storage - device memory + sdcard, USB OTG drives, etc.</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(petru.lingurar)</span></div></div></div><div class="change-set" id="c42"><div class="comment" data-id="14903993" data-no="42"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-42" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_665275" id="a513452_388264"><img src="https://secure.gravatar.com/avatar/fba1cdeef36023e3cfc2558b3d82963d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_665275" id="a513452_388264"><a class="email " href="/user_profile?user_id=665275" > <span class="fna">Pedro Oliveira</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-42"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-42" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c42">Comment 42</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-26 08:13 PDT" data-time="1593184428">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-42">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-42" data-comment-id="14903993" data-ismarkdown="true" ><blockquote>
<p>root-path is actually the root of the device (and from what I can see it&#39;s an undocumented option). So it&#39;s actually worse than you think.</p>
</blockquote>
<p>It is not documented because it is known to be commonly misused. You can check  the source code for Android&#39;s FileProvider <a href="https://cs.android.com/androidx/platform/frameworks/support/+/androidx-master-dev:core/core/src/main/java/androidx/core/content/FileProvider.java;l=346?q=fileprovider" rel="nofollow">here</a></p>
<p>The <code>root-path</code>  element points to <code>File(&quot;/&quot;)</code> . Similar to a <code>~</code>. It is literally the root of the device.</p>
</div></div><div class="change-set" id="c43"><div class="comment" data-id="14904155" data-no="43"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-43" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_421286" id="a513452_388264"><img src="https://secure.gravatar.com/avatar/2f23a572bdd06777026ab2c155cfe0c0?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_421286" id="a513452_388264"><a class="email " href="/user_profile?user_id=421286" > <span class="fna">Agi Sferro | :agi | ni? for questions | ⏰ PST | he/him</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-43"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-43" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c43">Comment 43</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-26 09:27 PDT" data-time="1593188854">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-43">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9159742"
         class="attachment"
         data-id="9159742" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="phabricator-D81359-url.txt">
      <meta itemprop="contentSize" content="47">
      <meta itemprop="encodingFormat" content="text/x-phabricator-request">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=9159742" itemprop="contentUrl">
        <span id="att-9159742-description" itemprop="description">Bug 1647078 - Restrict content:// paths to external storage.</span></a>
        — <a href="attachment.cgi?id=9159742&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div></div><div class="change-set" id="c44"><div class="comment" data-id="14904318" data-no="44"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-44" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_388264" id="a513452_388264"><img src="https://secure.gravatar.com/avatar/73072cf44258fa9cb3ae3ed4f47b9939?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_388264" id="a513452_388264"><a class="email " href="/user_profile?user_id=388264" > <span class="fna">Stefan Arentz | :st3fan | ⏰ EST | he/him</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-44"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-44" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c44">Comment 44</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-26 11:06 PDT" data-time="1593194815">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-44">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-44" data-comment-id="14904318" data-ismarkdown="true" ><p>Agi do you think we should land all the patches attached to this bug? Can you add Petru as a reviewer and I will find another person to take a look?</p>
</div></div><div class="change-set" id="a531135_388264"><div class="change" id="aa531135_388264">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_388264" id="a531135_388264"><img src="https://secure.gravatar.com/avatar/73072cf44258fa9cb3ae3ed4f47b9939?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_388264" id="a531135_388264"><a class="email " href="/user_profile?user_id=388264" > <span class="fna">Stefan Arentz | :st3fan | ⏰ EST | he/him</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a531135_388264"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a531135_388264">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#a531135_388264">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-26 11:07 PDT" data-time="1593194827">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: needinfo?(agi)</div></div></div><div class="change-set" id="c45"><div class="comment" data-id="14904527" data-no="45"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-45" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_665275" id="a531135_388264"><img src="https://secure.gravatar.com/avatar/fba1cdeef36023e3cfc2558b3d82963d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_665275" id="a531135_388264"><a class="email " href="/user_profile?user_id=665275" > <span class="fna">Pedro Oliveira</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-45"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-45" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c45">Comment 45</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-26 13:22 PDT" data-time="1593202979">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-45">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-45" data-comment-id="14904527" data-ismarkdown="true" ><p>This is unrelated to this issue but after setting up TOTP to access Phabricator, I can&#39;t use any action that requires an TOTP. I always get an &quot;Invalid verification code.&quot; message. I&#39;ve tried changing the device time to PST but it doesn&#39;t seem to help either. I&#39;m afraid I might be locked out and lose track of this issue if my session expires.</p>
<p>I&#39;m not sure if that TOTP thing is a known issue but if not, and to avoid being locked out, what can I do continue tracking this issue and not lose the account?</p>
</div></div><div class="change-set" id="c46"><div class="comment" data-id="14904694" data-no="46"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-46" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_406670" id="a531135_388264"><img src="https://secure.gravatar.com/avatar/3be472321f8ced3986562b808499a0a4?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_406670" id="a531135_388264"><a class="email " href="/user_profile?user_id=406670" > <span class="fna">Kevin Brosnan [:kbrosnan]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-46"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-46" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c46">Comment 46</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-26 13:27 PDT" data-time="1593203266">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-46">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-46" data-comment-id="14904694" data-ismarkdown="true" ><p>I would try reaching out to the Moz Phabricator folks at <a href="https://chat.mozilla.org/#/room/#conduit:mozilla.org" rel="nofollow">https://chat.mozilla.org/#/room/#conduit:mozilla.org</a> and explain the situation.</p>
</div></div><div class="change-set" id="c47"><div class="comment" data-id="14904904" data-no="47"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-47" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_421286" id="a531135_388264"><img src="https://secure.gravatar.com/avatar/2f23a572bdd06777026ab2c155cfe0c0?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_421286" id="a531135_388264"><a class="email " href="/user_profile?user_id=421286" > <span class="fna">Agi Sferro | :agi | ni? for questions | ⏰ PST | he/him</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-47"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-47" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c47">Comment 47</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-26 14:41 PDT" data-time="1593207663">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-47">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9159814"
         class="attachment"
         data-id="9159814" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="phabricator-D81410-url.txt">
      <meta itemprop="contentSize" content="47">
      <meta itemprop="encodingFormat" content="text/x-phabricator-request">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=9159814" itemprop="contentUrl">
        <span id="att-9159814-description" itemprop="description">Bug 1647078 - Don't load Web-originated intents that open in the browser.</span></a>
        — <a href="attachment.cgi?id=9159814&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div></div><div class="change-set" id="c48"><div class="comment" data-id="14904906" data-no="48"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-48" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_421286" id="a531135_388264"><img src="https://secure.gravatar.com/avatar/2f23a572bdd06777026ab2c155cfe0c0?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_421286" id="a531135_388264"><a class="email " href="/user_profile?user_id=421286" > <span class="fna">Agi Sferro | :agi | ni? for questions | ⏰ PST | he/him</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-48"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-48" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c48">Comment 48</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-26 14:41 PDT" data-time="1593207694">1 year ago</span>
          </div>&bull;
<div class="change-revisions">
  <a href="/page.cgi?id=comment-revisions.html&amp;bug_id=1647078&amp;comment_id=14904906"
     title="1 revision">Edited</a>
</div>
        </td>
      </tr>

      <tr id="ctag-48">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-48" data-comment-id="14904906" data-ismarkdown="true" ><p>(In reply to Stefan Arentz [:st3fan] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1647078#c44" title="VERIFIED FIXED - content:// provider allows websites to remotely steal any file from the device if the path is known">comment #44</a>)</p>
<blockquote>
<p>Agi do you think we should land all the patches attached to this bug? Can you add Petru as a reviewer and I will find another person to take a look?</p>
</blockquote>
<p>If we want to keep opening <code>content://</code> links (like email attachments), then yes. Will add Petru as reviewer.</p>
<p>Also I just noticed while looking into this, that our handling of <code>android-app</code> also allows <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1356893" title="VERIFIED FIXED - Firefox for Android allows navigating from http: to file: URLs">Bug 1356893</a> to happen. So I added a fix for that too. E.g. something like this navigates to a file URL (even after the fixes) (substitute <code>org.mozilla.firefox</code> with the app name)</p>
<pre><code>&lt;html&gt;
&lt;body&gt;
  &lt;iframe src=&quot;android-app://org.mozilla.firefox/content/org.mozilla.firefox.fileprovider/storage/emulated/0/Download/noscript_data.txt#Intent;type=text/html;end&quot;&gt;&lt;/iframe&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>for current Fennec substitute the url to: <code>android-app://org.mozilla.firefox/content/org.mozilla.firefox.fileprovider/root/storage/emulated/0/Download/noscript_data.txt#Intent;type=text/html;end</code>.</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(agi)</span></div></div></div><div class="change-set" id="c49"><div class="comment" data-id="14904918" data-no="49"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-49" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_421286" id="a531135_388264"><img src="https://secure.gravatar.com/avatar/2f23a572bdd06777026ab2c155cfe0c0?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_421286" id="a531135_388264"><a class="email " href="/user_profile?user_id=421286" > <span class="fna">Agi Sferro | :agi | ni? for questions | ⏰ PST | he/him</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-49"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-49" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c49">Comment 49</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-26 14:51 PDT" data-time="1593208291">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-49">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-49" data-comment-id="14904918" data-ismarkdown="true" ><p>After we&#39;re done fixing this I want to compile a list of checks that we should run on Fenix to make sure we&#39;re not doing any of this bad stuff there.</p>
</div></div><div class="change-set" id="c50"><div class="comment" data-id="14904920" data-no="50"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-50" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_406670" id="a531135_388264"><img src="https://secure.gravatar.com/avatar/3be472321f8ced3986562b808499a0a4?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_406670" id="a531135_388264"><a class="email " href="/user_profile?user_id=406670" > <span class="fna">Kevin Brosnan [:kbrosnan]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-50"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-50" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c50">Comment 50</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-26 14:56 PDT" data-time="1593208615">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-50">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-50" data-comment-id="14904920" data-ismarkdown="true" ><p>We don&#39;t accept <code>content:</code> or <code>file:</code> in the Fenix manifest. <a href="https://github.com/mozilla-mobile/fenix/blob/master/app/src/main/AndroidManifest.xml" rel="nofollow">https://github.com/mozilla-mobile/fenix/blob/master/app/src/main/AndroidManifest.xml</a></p>
</div></div><div class="change-set" id="c51"><div class="comment" data-id="14904928" data-no="51"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-51" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_421286" id="a531135_388264"><img src="https://secure.gravatar.com/avatar/2f23a572bdd06777026ab2c155cfe0c0?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_421286" id="a531135_388264"><a class="email " href="/user_profile?user_id=421286" > <span class="fna">Agi Sferro | :agi | ni? for questions | ⏰ PST | he/him</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-51"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-51" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c51">Comment 51</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-26 15:02 PDT" data-time="1593208951">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-51">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-51" data-comment-id="14904928" data-ismarkdown="true" ><p>I&#39;m gonna push to try as soon as it reopens (squashing the patches and replacing the commit message).</p>
</div></div><div class="change-set" id="c52"><div class="comment" data-id="14905036" data-no="52"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-52" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_421286" id="a531135_388264"><img src="https://secure.gravatar.com/avatar/2f23a572bdd06777026ab2c155cfe0c0?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_421286" id="a531135_388264"><a class="email " href="/user_profile?user_id=421286" > <span class="fna">Agi Sferro | :agi | ni? for questions | ⏰ PST | he/him</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-52"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-52" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c52">Comment 52</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-26 16:34 PDT" data-time="1593214487">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-52">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-52" data-comment-id="14905036" data-ismarkdown="true" ><p><a href="https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=07fad090f7773ac26c6f1390bbdbeda9d2a29c70" rel="nofollow">https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=07fad090f7773ac26c6f1390bbdbeda9d2a29c70</a></p>
</div></div><div class="change-set" id="c53"><div class="comment" data-id="14908271" data-no="53"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-53" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_388264" id="a531135_388264"><img src="https://secure.gravatar.com/avatar/73072cf44258fa9cb3ae3ed4f47b9939?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_388264" id="a531135_388264"><a class="email " href="/user_profile?user_id=388264" > <span class="fna">Stefan Arentz | :st3fan | ⏰ EST | he/him</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-53"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-53" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c53">Comment 53</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-29 07:22 PDT" data-time="1593440578">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-53">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-53" data-comment-id="14908271" data-ismarkdown="true" ><p>Diana, can QA pick up the above build and do testing around downloads and opening html file from other apps or storage?</p>
<p>Kevin, can you identify some more concrete tests or areas that we should cover?</p>
</div><div class="activity"><div class="change">Flags: needinfo?(kbrosnan)</div><div class="change">Flags: needinfo?(diana.rus)</div></div></div><div class="change-set" id="c54"><div class="comment" data-id="14908304" data-no="54"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-54" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_613831" id="a531135_388264"><img src="https://secure.gravatar.com/avatar/30b3814cd436f3c69ec94320d4d72398?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_613831" id="a531135_388264"><a class="email " href="/user_profile?user_id=613831" > <span class="fna">Petru-Mugurel Lingurar [:petru]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-54"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-54" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c54">Comment 54</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-29 07:47 PDT" data-time="1593442077">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-54">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-54" data-comment-id="14908304" data-ismarkdown="true" ><p>The patches from Agi look awesome!<br>
We&#39;ll have an a lot tighter control over who and how uses the <code>content://</code> scheme leaving a lot less room for abuse.</p>
<p>Regarding the proposed scenario to test the exploit:<br>
I tried along with Diana to test using the proposed STRs:</p>
<blockquote>
<ul>
<li>ngrok http 8080</li>
<li>python3 server.py xxxx.ngrok.io 8080</li>
<li>fennec → <a href="http://xxxx.ngrok.io" rel="nofollow">http://xxxx.ngrok.io</a></li>
</ul>
</blockquote>
<p>but we couldn&#39;t get the js alert with the cookies in plain on any device that we tested on.<br>
In fact, based on ngrok web interface we never get past the <code>generateProfiles</code> method.<br>
It may be that there&#39;s something needed to be changed in <code>server.py</code>.. will investigate a bit.</p>
<p>Curious if others managed to reproduce this, to better assess it&#39;s incidence.</p>
<p>Will let Diana present her conclusions.</p>
</div></div><div class="change-set" id="c55"><div class="comment" data-id="14908316" data-no="55"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-55" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_665275" id="a531135_388264"><img src="https://secure.gravatar.com/avatar/fba1cdeef36023e3cfc2558b3d82963d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_665275" id="a531135_388264"><a class="email " href="/user_profile?user_id=665275" > <span class="fna">Pedro Oliveira</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-55"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-55" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c55">Comment 55</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-29 07:55 PDT" data-time="1593442506">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-55">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-55" data-comment-id="14908316" data-ismarkdown="true" ><p>Hey @petru,</p>
<p>Regarding your comment, you&#39;re trying to test that with or without the fix?</p>
<p>Also, make sure you delete the cookies and profile.ini file from the downloads folder before each test. Otherwise, Fennec will rename the file to another one and the exploit wont work.</p>
</div></div><div class="change-set" id="c56"><div class="comment" data-id="14908334" data-no="56"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-56" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_665275" id="a531135_388264"><img src="https://secure.gravatar.com/avatar/fba1cdeef36023e3cfc2558b3d82963d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_665275" id="a531135_388264"><a class="email " href="/user_profile?user_id=665275" > <span class="fna">Pedro Oliveira</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-56"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-56" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c56">Comment 56</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-29 08:05 PDT" data-time="1593443133">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-56">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-56" data-comment-id="14908334" data-ismarkdown="true" ><p>One more thing, as per <code>server.py</code>, line 20, don&#39;t include a scheme (<code>http://</code>) in your parameter. I&#39;m already concatenating a scheme in it.</p>
<p>I had no troubles triggering the inner <code>iframe</code> but if you do, change them to something like <code>&lt;iframe src=&quot;http://NGROK_SERVER/generateProfiles&quot;&gt;&lt;/iframe&gt;</code></p>
</div></div><div class="change-set" id="c57"><div class="comment" data-id="14908346" data-no="57"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-57" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_636695" id="a531135_388264"><img src="https://secure.gravatar.com/avatar/88e6ce873f2a55e04214be30e6c23372?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_636695" id="a531135_388264"><a class="email " href="/user_profile?user_id=636695" > <span class="fna">Diana Rus</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-57"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-57" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c57">Comment 57</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-29 08:11 PDT" data-time="1593443488">1 year ago</span>
          </div>&bull;
<div class="change-revisions">
  <a href="/page.cgi?id=comment-revisions.html&amp;bug_id=1647078&amp;comment_id=14908346"
     title="1 revision">Edited</a>
</div>
        </td>
      </tr>

      <tr id="ctag-57">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-57" data-comment-id="14908346" data-ismarkdown="true" ><p>Hi, I didn&#39;t managed to reproduce the issue on Firefox Release 68.9.0 (from playstore) with Sony Xperia Z5 (Android 7), Samsung Galaxy S9 (Android 8) nor with Google Pixel 3 XL (Android 9), I managed to trigger the download but the javascript error wasn&#39;t present, please check <a href="https://drive.google.com/file/d/1yBTvDRILpjcMg4tXuCJwWtIY4_0qhAlX/view?usp=sharing" rel="nofollow">video</a>  and <a href="https://drive.google.com/file/d/1qDMK73uyeC5NYptUkVUAmwvSxrPdQzg1/view?usp=sharing" rel="nofollow">settings</a>.</p>
<p>Note:<br>
On the try build (more exactly the build from Android 4.0 API16+ Release opt )i had the following outcome present after doing the steps from description <a href="https://drive.google.com/file/d/1Gfqlk-ppL-D1U7BaCrRHy-eSVxOhcQDT/view?usp=sharing" rel="nofollow">image of the saved file contents</a>.<br>
After accessing a ngrok.io link the first outcome was that a download of the profiles.ini was triggered and afterwards a redirection to Play Store was present.<br>
The iframe remains open in the browser, URL displays the ngrok.io link.</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(diana.rus)</span></div></div></div><div class="change-set" id="c58"><div class="comment" data-id="14908437" data-no="58"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-58" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_636695" id="a531135_388264"><img src="https://secure.gravatar.com/avatar/88e6ce873f2a55e04214be30e6c23372?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_636695" id="a531135_388264"><a class="email " href="/user_profile?user_id=636695" > <span class="fna">Diana Rus</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-58"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-58" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c58">Comment 58</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-29 08:50 PDT" data-time="1593445815">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-58">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-58" data-comment-id="14908437" data-ismarkdown="true" ><p>Hi, re-checked on Firefox Release 68.9.0 ,based on <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1647078#c55" title="VERIFIED FIXED - content:// provider allows websites to remotely steal any file from the device if the path is known">Comment55</a> (no second download of the file neither cookies) with Samsung Galaxy S9 (Android 8) and Google Pixel 3 XL (Android 9) - <a href="https://drive.google.com/file/d/1I1kods_m6zKDnKJqJbN3Zd2PmOKu_lLF/view?usp=sharing" rel="nofollow">video</a></p>
</div></div><div class="change-set" id="c59"><div class="comment" data-id="14908469" data-no="59"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-59" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_665275" id="a531135_388264"><img src="https://secure.gravatar.com/avatar/fba1cdeef36023e3cfc2558b3d82963d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_665275" id="a531135_388264"><a class="email " href="/user_profile?user_id=665275" > <span class="fna">Pedro Oliveira</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-59"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-59" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c59">Comment 59</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-29 09:06 PDT" data-time="1593446800">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-59">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-59" data-comment-id="14908469" data-ismarkdown="true" ><p>Hey Diana,</p>
<p>I&#39;ve attached a new <code>server.py</code>. I simplified the logic a log. This now only steals <code>profile.ini</code> which  should be enough for the test.</p>
<p>Could you please try with the same steps?</p>
<p><a href="https://drive.google.com/drive/folders/1dBzRgpiEKwqSiLANaQC4-pDUx10vmJdD?usp=sharing" rel="nofollow">https://drive.google.com/drive/folders/1dBzRgpiEKwqSiLANaQC4-pDUx10vmJdD?usp=sharing</a></p>
</div></div><div class="change-set" id="c60"><div class="comment" data-id="14908485" data-no="60"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-60" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_388264" id="a531135_388264"><img src="https://secure.gravatar.com/avatar/73072cf44258fa9cb3ae3ed4f47b9939?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_388264" id="a531135_388264"><a class="email " href="/user_profile?user_id=388264" > <span class="fna">Stefan Arentz | :st3fan | ⏰ EST | he/him</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-60"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-60" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c60">Comment 60</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-29 09:13 PDT" data-time="1593447191">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-60">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-60" data-comment-id="14908485" data-ismarkdown="true" ><p>Do we need the exploit code hosted somewhere more permanently? I can put it online on a server if that helps.</p>
</div></div><div class="change-set" id="c61"><div class="comment" data-id="14908501" data-no="61"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-61" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_613831" id="a531135_388264"><img src="https://secure.gravatar.com/avatar/30b3814cd436f3c69ec94320d4d72398?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_613831" id="a531135_388264"><a class="email " href="/user_profile?user_id=613831" > <span class="fna">Petru-Mugurel Lingurar [:petru]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-61"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-61" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c61">Comment 61</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-29 09:22 PDT" data-time="1593447731">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-61">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-61" data-comment-id="14908501" data-ismarkdown="true" ><p>Thank you @kanytu!<br>
The new script makes it easy to see how a webpage could extract internal storage files content from Fennec.<br>
<a href="https://drive.google.com/file/d/1lOi_fAATehvthAjS-6nwEC3ikOu8Zb49/view?usp=sharing" rel="nofollow">https://drive.google.com/file/d/1lOi_fAATehvthAjS-6nwEC3ikOu8Zb49/view?usp=sharing</a><br>
We can now easily test the fix for this and then that all else work as expected.</p>
</div></div><div class="change-set" id="c62"><div class="comment" data-id="14908536" data-no="62"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-62" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_636695" id="a531135_388264"><img src="https://secure.gravatar.com/avatar/88e6ce873f2a55e04214be30e6c23372?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_636695" id="a531135_388264"><a class="email " href="/user_profile?user_id=636695" > <span class="fna">Diana Rus</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-62"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-62" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c62">Comment 62</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-29 09:35 PDT" data-time="1593448529">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-62">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-62" data-comment-id="14908536" data-ismarkdown="true" ><p>Hi, yes as Petru&#39;s mentioned, i also reproduce <a href="https://drive.google.com/file/d/1YhiLtjSkGJclMnBQs8wq_h0Nv5zRSgtC/view?usp=sharing" rel="nofollow">video</a>.</p>
</div></div><div class="change-set" id="c63"><div class="comment" data-id="14908569" data-no="63"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-63" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_421286" id="a531135_388264"><img src="https://secure.gravatar.com/avatar/2f23a572bdd06777026ab2c155cfe0c0?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_421286" id="a531135_388264"><a class="email " href="/user_profile?user_id=421286" > <span class="fna">Agi Sferro | :agi | ni? for questions | ⏰ PST | he/him</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-63"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-63" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c63">Comment 63</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-29 09:55 PDT" data-time="1593449708">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-63">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-63" data-comment-id="14908569" data-ismarkdown="true" ><p>This apk can be used to test the fix <a href="https://firefox-ci-tc.services.mozilla.com/api/queue/v1/task/TV8MdQOtR1e8k4OKO6b_PQ/runs/0/artifacts/public/build/target.apk" rel="nofollow">https://firefox-ci-tc.services.mozilla.com/api/queue/v1/task/TV8MdQOtR1e8k4OKO6b_PQ/runs/0/artifacts/public/build/target.apk</a></p>
</div></div><div class="change-set" id="c64"><div class="comment" data-id="14908629" data-no="64"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-64" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_636695" id="a531135_388264"><img src="https://secure.gravatar.com/avatar/88e6ce873f2a55e04214be30e6c23372?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_636695" id="a531135_388264"><a class="email " href="/user_profile?user_id=636695" > <span class="fna">Diana Rus</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-64"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-64" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c64">Comment 64</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-29 10:25 PDT" data-time="1593451541">1 year ago</span>
          </div>&bull;
<div class="change-revisions">
  <a href="/page.cgi?id=comment-revisions.html&amp;bug_id=1647078&amp;comment_id=14908629"
     title="1 revision">Edited</a>
</div>
        </td>
      </tr>

      <tr id="ctag-64">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-64" data-comment-id="14908629" data-ismarkdown="true" ><p>After checking with Samsung Galaxy S9 (Android 8) and Google Pixel 3XL (Android 9) on try build from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1647078#c63" title="VERIFIED FIXED - content:// provider allows websites to remotely steal any file from the device if the path is known">Comment 63</a> with same str.<br>
<a href="https://drive.google.com/file/d/1Zk6vPuDvzl_cW0oaH676MzpziJjOhF3o/view?usp=sharing" rel="nofollow">Video-Samsung</a><br>
<a href="https://drive.google.com/file/d/1S8Wm76DZgYdEAXsbDcixyrs2qwT0ElN-/view?usp=sharing" rel="nofollow">Video-Pixel 3 XL</a><br>
After accessing the ngrok.io link, profiles.ini file starts downloading, the navigation bar contains the ngrok.io link and the &quot;Open with&quot; android notification is displayed.</p>
</div></div><div class="change-set" id="c65"><div class="comment" data-id="14908727" data-no="65"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-65" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_665275" id="a531135_388264"><img src="https://secure.gravatar.com/avatar/fba1cdeef36023e3cfc2558b3d82963d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_665275" id="a531135_388264"><a class="email " href="/user_profile?user_id=665275" > <span class="fna">Pedro Oliveira</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-65"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-65" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c65">Comment 65</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-29 10:59 PDT" data-time="1593453557">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-65">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-65" data-comment-id="14908727" data-ismarkdown="true" ><p>I am unable to replicate this attack in the new APK. I&#39;m pretty sure this exploit has been eradicated by using random names and restricting he content provider&#39;s access to private files.</p>
</div></div><div class="change-set" id="c66"><div class="comment" data-id="14908732" data-no="66"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-66" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_388264" id="a531135_388264"><img src="https://secure.gravatar.com/avatar/73072cf44258fa9cb3ae3ed4f47b9939?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_388264" id="a531135_388264"><a class="email " href="/user_profile?user_id=388264" > <span class="fna">Stefan Arentz | :st3fan | ⏰ EST | he/him</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-66"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-66" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c66">Comment 66</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-29 11:06 PDT" data-time="1593454009">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-66">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-66" data-comment-id="14908732" data-ismarkdown="true" ><p>Agi mentioned the following on Slack</p>
<blockquote>
<p>it would be nice if we could get some regression testing around opening attachments from email apps (like html pages) and opening downloads (both in Fennec and in other apps)</p>
</blockquote>
</div></div><div class="change-set" id="c67"><div class="comment" data-id="14909993" data-no="67"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-67" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_636695" id="a531135_388264"><img src="https://secure.gravatar.com/avatar/88e6ce873f2a55e04214be30e6c23372?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_636695" id="a531135_388264"><a class="email " href="/user_profile?user_id=636695" > <span class="fna">Diana Rus</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-67"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-67" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c67">Comment 67</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-30 03:05 PDT" data-time="1593511525">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-67">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-67" data-comment-id="14909993" data-ismarkdown="true" ><p>Hi, checked with Samsung Galaxy S9 (Android 8) and Google Pixel 3 XL (Android 9) on build from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1647078#c63" title="VERIFIED FIXED - content:// provider allows websites to remotely steal any file from the device if the path is known">Comment63</a>:</p>
<ul>
<li>moved Firefox Download folder from where initial is, to org.mozilla.firefox same outcome is present as when the Download&#39;s folder path is not changed(<a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1647078#c64" title="VERIFIED FIXED - content:// provider allows websites to remotely steal any file from the device if the path is known">Comment64</a>) - no crash encountered<br>
The path where the file is saved &quot;/storage/emulated/0/Downloads/profiles.ini&quot;.</li>
<li>opened attachments from mail (http, https pages, html page with iframe through custom tab and directly in browser)</li>
<li>opened files from file://storage/emulated/0/Download/ (images-png, jpg, html)<br>
Verified also opening files from download in Fenix, no crashes or other problems encountered at opening of downloaded files..</li>
</ul>
</div></div><div class="change-set" id="c68"><div class="comment" data-id="14910966" data-no="68"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-68" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_421286" id="a531135_388264"><img src="https://secure.gravatar.com/avatar/2f23a572bdd06777026ab2c155cfe0c0?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_421286" id="a531135_388264"><a class="email " href="/user_profile?user_id=421286" > <span class="fna">Agi Sferro | :agi | ni? for questions | ⏰ PST | he/him</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-68"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-68" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c68">Comment 68</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-30 10:12 PDT" data-time="1593537125">1 year ago</span>
          </div>&bull;
<div class="change-revisions">
  <a href="/page.cgi?id=comment-revisions.html&amp;bug_id=1647078&amp;comment_id=14910966"
     title="2 revisions">Edited</a>
</div>
        </td>
      </tr>

      <tr id="ctag-68">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-68" data-comment-id="14910966" data-ismarkdown="true" ><p>Comment on <span class=""><a href="/attachment.cgi?id=9159562" name="attach_9159562" title="Bug 1647078 - Load content:// URIs from intents as file://.">attachment 9159562</a> <a href="/attachment.cgi?id=9159562&amp;action=edit" title="Bug 1647078 - Load content:// URIs from intents as file://.">[details]</a></span><br>
<a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1647078" title="VERIFIED FIXED - content:// provider allows websites to remotely steal any file from the device if the path is known">Bug 1647078</a> - Load content:// URIs from intents as file://.</p>
<h3>Security Approval Request</h3>
<ul>
<li><strong>How easily could an exploit be constructed based on the patch?</strong>: Experimenting with content:// URLs quickly leads to various exploits. How to construct an exploit to read internal files like cookies might not be immediately obvious, but any skilled researcher could definitely do that. We can squash the patches and add a vague commit message to mitigate these concerns, however I would assume that any ESR patch gets a lot of scrutiny anyway.</li>
<li><strong>Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?</strong>: Yes</li>
<li><strong>Which older supported branches are affected by this flaw?</strong>: esr only</li>
<li><strong>If not all supported branches, which bug introduced the flaw?</strong>: None</li>
<li><strong>Do you have backports for the affected branches?</strong>: Yes</li>
<li><strong>If not, how different, hard to create, and risky will they be?</strong>: N/A this code is only in ESR68</li>
<li><strong>How likely is this patch to cause regressions; how much testing does it need?</strong>: The code is involved, so regressions are possible. Worst case scenario is Fennec crashes when opening a download or an intent from a third-party app. We ran QA regression testing on these scenarios.</li>
</ul>
<h3>ESR Uplift Approval Request</h3>
<ul>
<li><strong>If this is not a sec:{high,crit} bug, please state case for ESR consideration</strong>: sec-crit</li>
<li><strong>User impact if declined</strong>: Any webpage can easily steal all user data (cookies, passwords, etc)</li>
<li><strong>Fix Landed on Version</strong>: pending</li>
<li><strong>Risk to taking this patch</strong>: High</li>
<li><strong>Why is the change risky/not risky? (and alternatives if risky)</strong>: The patch is android-only.<br>
We have to close a few holes in our content:// protocol handling, also we don&#39;t have any baking in any other channel since this is a ESR only bug.</li>
</ul>
<p>A marginally less risky approach would be to remove the feature outright, that means that users would not be able to open attachments from email in Fennec, which has been a feature since 2018.</p>
<ul>
<li><strong>String or UUID changes made by this patch</strong>: none</li>
</ul>
</div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9159562&amp;action=edit"
           title="Bug 1647078 - Load content:// URIs from intents as file://."
           class=""
        >Attachment #9159562</a> -
        Flags: sec-approval?</div><div class="change">
        <a href="/attachment.cgi?id=9159562&amp;action=edit"
           title="Bug 1647078 - Load content:// URIs from intents as file://."
           class=""
        >Attachment #9159562</a> -
        Flags: approval-mozilla-esr68?</div></div></div><div class="change-set" id="a873436_421286"><div class="change" id="aa873436_421286">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_421286" id="a873436_421286"><img src="https://secure.gravatar.com/avatar/2f23a572bdd06777026ab2c155cfe0c0?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_421286" id="a873436_421286"><a class="email " href="/user_profile?user_id=421286" > <span class="fna">Agi Sferro | :agi | ni? for questions | ⏰ PST | he/him</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a873436_421286"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a873436_421286">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#a873436_421286">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-30 10:12 PDT" data-time="1593537128">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9159563&amp;action=edit"
           title="Bug 1647078 - Never handle content:// channels from Web."
           class=""
        >Attachment #9159563</a> -
        Flags: sec-approval?</div><div class="change">
        <a href="/attachment.cgi?id=9159564&amp;action=edit"
           title="Bug 1647078 - Use random file names when copying a content:// URI."
           class=""
        >Attachment #9159564</a> -
        Flags: sec-approval?</div><div class="change">
        <a href="/attachment.cgi?id=9159565&amp;action=edit"
           title="Bug 1647078 - Always copy content:// files."
           class=""
        >Attachment #9159565</a> -
        Flags: sec-approval?</div><div class="change">
        <a href="/attachment.cgi?id=9159742&amp;action=edit"
           title="Bug 1647078 - Restrict content:// paths to external storage."
           class=""
        >Attachment #9159742</a> -
        Flags: sec-approval?</div><div class="change">
        <a href="/attachment.cgi?id=9159814&amp;action=edit"
           title="Bug 1647078 - Don't load Web-originated intents that open in the browser."
           class=""
        >Attachment #9159814</a> -
        Flags: sec-approval?</div></div></div><div class="change-set" id="c69"><div class="comment" data-id="14911454" data-no="69"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-69" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a873436_421286"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a873436_421286"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-69"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-69" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c69">Comment 69</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-30 13:51 PDT" data-time="1593550308">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-69">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-69" data-comment-id="14911454" data-ismarkdown="true" ><p>Comment on <span class=""><a href="/attachment.cgi?id=9159562" name="attach_9159562" title="Bug 1647078 - Load content:// URIs from intents as file://.">attachment 9159562</a> <a href="/attachment.cgi?id=9159562&amp;action=edit" title="Bug 1647078 - Load content:// URIs from intents as file://.">[details]</a></span><br>
<a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1647078" title="VERIFIED FIXED - content:// provider allows websites to remotely steal any file from the device if the path is known">Bug 1647078</a> - Load content:// URIs from intents as file://.</p>
<p>sec-approval+ to land whenever release drivers give you the OK for the branch uplift.</p>
<p>Do we want to also land this on nightly just in case people have forked this code for their own use? Or have we landed lots of ESR-branch-only patches prior to this?</p>
</div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9159562&amp;action=edit"
           title="Bug 1647078 - Load content:// URIs from intents as file://."
           class=""
        >Attachment #9159562</a> -
        Flags: sec-approval? &rarr; sec-approval+</div></div></div><div class="change-set" id="a886665_1689"><div class="change" id="aa886665_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a886665_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a886665_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a886665_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a886665_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#a886665_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-30 13:52 PDT" data-time="1593550357">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9159814&amp;action=edit"
           title="Bug 1647078 - Don't load Web-originated intents that open in the browser."
           class=""
        >Attachment #9159814</a> -
        Flags: sec-approval? &rarr; sec-approval+</div></div></div><div class="change-set" id="a886673_1689"><div class="change" id="aa886673_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a886673_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a886673_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a886673_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a886673_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#a886673_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-30 13:52 PDT" data-time="1593550365">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9159563&amp;action=edit"
           title="Bug 1647078 - Never handle content:// channels from Web."
           class=""
        >Attachment #9159563</a> -
        Flags: sec-approval? &rarr; sec-approval+</div></div></div><div class="change-set" id="a886678_1689"><div class="change" id="aa886678_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a886678_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a886678_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a886678_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a886678_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#a886678_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-30 13:52 PDT" data-time="1593550370">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9159564&amp;action=edit"
           title="Bug 1647078 - Use random file names when copying a content:// URI."
           class=""
        >Attachment #9159564</a> -
        Flags: sec-approval? &rarr; sec-approval+</div></div></div><div class="change-set" id="a886682_1689"><div class="change" id="aa886682_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a886682_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a886682_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a886682_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a886682_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#a886682_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-30 13:52 PDT" data-time="1593550374">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9159742&amp;action=edit"
           title="Bug 1647078 - Restrict content:// paths to external storage."
           class=""
        >Attachment #9159742</a> -
        Flags: sec-approval? &rarr; sec-approval+</div></div></div><div class="change-set" id="a886689_1689"><div class="change" id="aa886689_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a886689_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a886689_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a886689_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a886689_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#a886689_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-30 13:53 PDT" data-time="1593550381">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9159565&amp;action=edit"
           title="Bug 1647078 - Always copy content:// files."
           class=""
        >Attachment #9159565</a> -
        Flags: sec-approval? &rarr; sec-approval+</div></div></div><div class="change-set" id="c70"><div class="comment" data-id="14911473" data-no="70"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-70" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_421286" id="a886689_1689"><img src="https://secure.gravatar.com/avatar/2f23a572bdd06777026ab2c155cfe0c0?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_421286" id="a886689_1689"><a class="email " href="/user_profile?user_id=421286" > <span class="fna">Agi Sferro | :agi | ni? for questions | ⏰ PST | he/him</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-70"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-70" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c70">Comment 70</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-30 13:55 PDT" data-time="1593550550">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-70">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-70" data-comment-id="14911473" data-ismarkdown="true" ><p>(In reply to Daniel Veditz [:dveditz] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1647078#c69" title="VERIFIED FIXED - content:// provider allows websites to remotely steal any file from the device if the path is known">comment #69</a>)</p>
<blockquote>
<p>Do we want to also land this on nightly just in case people have forked this code for their own use? Or have we landed lots of ESR-branch-only patches prior to this?</p>
</blockquote>
<p>discussed privately, there&#39;s no m-c counterpart to this, so nothing to land on nightly.</p>
</div></div><div class="change-set" id="c71"><div class="comment" data-id="14920653" data-no="71"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-71" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_665275" id="a886689_1689"><img src="https://secure.gravatar.com/avatar/fba1cdeef36023e3cfc2558b3d82963d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_665275" id="a886689_1689"><a class="email " href="/user_profile?user_id=665275" > <span class="fna">Pedro Oliveira</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-71"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-71" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c71">Comment 71</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-07-06 05:24 PDT" data-time="1594038274">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-71">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-71" data-comment-id="14920653" data-ismarkdown="true" ><p>Hello everyone,</p>
<p>I can confirm the fix landed in the latest Firefox version available in Google Play Store.</p>
<p>I want to take the opportunity to congratulate everyone involved for their transparency and professionalism in dealing with this issue.</p>
<p>I would also like to task if this is going to be part of any security advisory and/or CVE.</p>
<p>Thanks,<br>
@kanytu</p>
</div></div><div class="change-set" id="c72"><div class="comment" data-id="14920780" data-no="72"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-72" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a886689_1689"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a886689_1689"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-72"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-72" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c72">Comment 72</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-07-06 06:42 PDT" data-time="1594042959">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-72">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-72" data-comment-id="14920780" data-ismarkdown="true" ><p>@kanytu, we haven&#39;t shipped a fixed release yet. Our plan was to build and ship a 68.10.1 release with this fix early this week.</p>
</div></div><div class="change-set" id="c73"><div class="comment" data-id="14920781" data-no="73"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-73" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_665275" id="a886689_1689"><img src="https://secure.gravatar.com/avatar/fba1cdeef36023e3cfc2558b3d82963d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_665275" id="a886689_1689"><a class="email " href="/user_profile?user_id=665275" > <span class="fna">Pedro Oliveira</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-73"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-73" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c73">Comment 73</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-07-06 06:45 PDT" data-time="1594043135">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-73">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-73" data-comment-id="14920781" data-ismarkdown="true" ><p>You are right. I forgot to give STORAGE permissions to Firefox before making the test :/<br>
Sorry to bother.</p>
</div></div><div class="change-set" id="a1383240_75935"><div class="change" id="aa1383240_75935">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a1383240_75935"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_75935" id="a1383240_75935"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1383240_75935"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1383240_75935">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#a1383240_75935">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-07-06 07:48 PDT" data-time="1594046932">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr68&amp;o1=isnotempty">tracking-firefox-esr68</a>:
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr68&amp;o1=equals&amp;v1=%3F">?</a> &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox_esr68&amp;o1=equals&amp;v1=78%2B">78+</a></div></div></div><div class="change-set" id="c74"><div class="comment" data-id="14920905" data-no="74"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-74" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a1383240_75935"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a1383240_75935"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-74"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-74" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c74">Comment 74</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-07-06 07:49 PDT" data-time="1594046949">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-74">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-74" data-comment-id="14920905" data-ismarkdown="true" ><p>Comment on <span class=""><a href="/attachment.cgi?id=9159562" name="attach_9159562" title="Bug 1647078 - Load content:// URIs from intents as file://.">attachment 9159562</a> <a href="/attachment.cgi?id=9159562&amp;action=edit" title="Bug 1647078 - Load content:// URIs from intents as file://.">[details]</a></span><br>
<a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1647078" title="VERIFIED FIXED - content:// provider allows websites to remotely steal any file from the device if the path is known">Bug 1647078</a> - Load content:// URIs from intents as file://.</p>
<p>Approved for Fennec 68.10.1.</p>
</div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9159562&amp;action=edit"
           title="Bug 1647078 - Load content:// URIs from intents as file://."
           class=""
        >Attachment #9159562</a> -
        Flags: approval-mozilla-esr68? &rarr; approval-mozilla-esr68+</div></div></div><div class="change-set" id="c75"><div class="comment" data-id="14921074" data-no="75"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-75" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_421286" id="a1383240_75935"><img src="https://secure.gravatar.com/avatar/2f23a572bdd06777026ab2c155cfe0c0?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_421286" id="a1383240_75935"><a class="email " href="/user_profile?user_id=421286" > <span class="fna">Agi Sferro | :agi | ni? for questions | ⏰ PST | he/him</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-75"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-75" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c75">Comment 75</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-07-06 09:08 PDT" data-time="1594051684">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-75">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9161643"
         class="attachment"
         data-id="9161643" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="phabricator-D82397-url.txt">
      <meta itemprop="contentSize" content="47">
      <meta itemprop="encodingFormat" content="text/x-phabricator-request">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=9161643" itemprop="contentUrl">
        <span id="att-9161643-description" itemprop="description">Bug 1647078 - Fix unit tests and checkstyle. a=RyanVM</span></a>
        — <a href="attachment.cgi?id=9161643&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div></div><div class="change-set" id="c76"><div class="comment" data-id="14921103" data-no="76"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-76" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_578488" id="a1383240_75935"><img src="https://secure.gravatar.com/avatar/6822db445808be789b12cfae22d118dc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_578488" id="a1383240_75935"><a class="email " href="/user_profile?user_id=578488" > <span class="fna">Tom Ritter [:tjr] (ni? for response to CVE/sec-approval/advisories/etc)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-76"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-76" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c76">Comment 76</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-07-06 09:18 PDT" data-time="1594052334">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-76">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9161647"
         class="attachment"
         data-id="9161647" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="file_1647078.txt">
      <meta itemprop="contentSize" content="264">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=9161647" itemprop="contentUrl">
        <span id="att-9161647-description" itemprop="description">advisory.txt</span></a>
        — <a href="attachment.cgi?id=9161647&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div></div><div class="change-set" id="c77"><div class="comment" data-id="14921643" data-no="77"
       data-tags="uplift">
    
    <table class="layout-table change-head " id="ch-77" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a1383240_75935"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a1383240_75935"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-77"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-77" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c77">Comment 77</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-07-06 13:17 PDT" data-time="1594066656">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-77">
        <td colspan="2" class="comment-tags"><span class="comment-tag">uplift</span>
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-77" data-comment-id="14921643" data-ismarkdown="true" ><p>FIREFOX_ESR_68_10_X_RELBRANCH (68.10.1):<br>
<a href="https://hg.mozilla.org/releases/mozilla-esr68/rev/ad9ac638aa8f2105e9854169fe0de333e463beb6" rel="nofollow">https://hg.mozilla.org/releases/mozilla-esr68/rev/ad9ac638aa8f2105e9854169fe0de333e463beb6</a><br>
<a href="https://hg.mozilla.org/releases/mozilla-esr68/rev/c87234a340c14826aabf41afc0da0f9df765392f" rel="nofollow">https://hg.mozilla.org/releases/mozilla-esr68/rev/c87234a340c14826aabf41afc0da0f9df765392f</a><br>
<a href="https://hg.mozilla.org/releases/mozilla-esr68/rev/003ff248966ae98bddc028882e4c70e00b56ea10" rel="nofollow">https://hg.mozilla.org/releases/mozilla-esr68/rev/003ff248966ae98bddc028882e4c70e00b56ea10</a><br>
<a href="https://hg.mozilla.org/releases/mozilla-esr68/rev/f5b74d48979155c082baf699716290d2f154b9c5" rel="nofollow">https://hg.mozilla.org/releases/mozilla-esr68/rev/f5b74d48979155c082baf699716290d2f154b9c5</a><br>
<a href="https://hg.mozilla.org/releases/mozilla-esr68/rev/bb07a1c15096474bc00516258e5ec4d622ecc718" rel="nofollow">https://hg.mozilla.org/releases/mozilla-esr68/rev/bb07a1c15096474bc00516258e5ec4d622ecc718</a><br>
<a href="https://hg.mozilla.org/releases/mozilla-esr68/rev/7e2374db758b3cfcc74a9f26aea9911418ba711c" rel="nofollow">https://hg.mozilla.org/releases/mozilla-esr68/rev/7e2374db758b3cfcc74a9f26aea9911418ba711c</a><br>
<a href="https://hg.mozilla.org/releases/mozilla-esr68/rev/69fce10096d5ee43bd6f3a979631d62174d652a7" rel="nofollow">https://hg.mozilla.org/releases/mozilla-esr68/rev/69fce10096d5ee43bd6f3a979631d62174d652a7</a></p>
<p>default (68.11+):<br>
<a href="https://hg.mozilla.org/releases/mozilla-esr68/rev/d2dba14d515116e556e6403263df12062fef49e3" rel="nofollow">https://hg.mozilla.org/releases/mozilla-esr68/rev/d2dba14d515116e556e6403263df12062fef49e3</a><br>
<a href="https://hg.mozilla.org/releases/mozilla-esr68/rev/0c161b487485ec2f1a0248082e05e3e93b4c3317" rel="nofollow">https://hg.mozilla.org/releases/mozilla-esr68/rev/0c161b487485ec2f1a0248082e05e3e93b4c3317</a><br>
<a href="https://hg.mozilla.org/releases/mozilla-esr68/rev/bfa52add2ca5094a9bc2485f6266d670f0412372" rel="nofollow">https://hg.mozilla.org/releases/mozilla-esr68/rev/bfa52add2ca5094a9bc2485f6266d670f0412372</a><br>
<a href="https://hg.mozilla.org/releases/mozilla-esr68/rev/04a1051357b379b59965d46c1a0266bda38288a3" rel="nofollow">https://hg.mozilla.org/releases/mozilla-esr68/rev/04a1051357b379b59965d46c1a0266bda38288a3</a><br>
<a href="https://hg.mozilla.org/releases/mozilla-esr68/rev/97ae634f83d1d971384d6bf772cd49988ab20952" rel="nofollow">https://hg.mozilla.org/releases/mozilla-esr68/rev/97ae634f83d1d971384d6bf772cd49988ab20952</a><br>
<a href="https://hg.mozilla.org/releases/mozilla-esr68/rev/f1ee7e600869cc5209278ba1851c2b515a4244be" rel="nofollow">https://hg.mozilla.org/releases/mozilla-esr68/rev/f1ee7e600869cc5209278ba1851c2b515a4244be</a><br>
<a href="https://hg.mozilla.org/releases/mozilla-esr68/rev/8fbc6afcebf60d4ddb81f8aa603f0961262355a5" rel="nofollow">https://hg.mozilla.org/releases/mozilla-esr68/rev/8fbc6afcebf60d4ddb81f8aa603f0961262355a5</a></p>
</div><div class="activity"><div class="change">Status: ASSIGNED &rarr; RESOLVED</div><div class="change">Closed: <span class="rel-time" title="2020-07-06 13:17 PDT" data-time="1594066656">1 year ago</span></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr68&amp;o1=isnotempty">status-firefox-esr68</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox_esr68&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr68&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">Resolution: --- &rarr; FIXED</div></div></div><div class="change-set" id="a1408521_1689"><div class="change" id="aa1408521_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a1408521_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a1408521_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1408521_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1408521_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#a1408521_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-07-06 14:50 PDT" data-time="1594072213">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: mobile-core-security &rarr; core-security-release</div></div></div><div class="change-set" id="c78"><div class="comment" data-id="14922782" data-no="78"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-78" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_636695" id="a1408521_1689"><img src="https://secure.gravatar.com/avatar/88e6ce873f2a55e04214be30e6c23372?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_636695" id="a1408521_1689"><a class="email " href="/user_profile?user_id=636695" > <span class="fna">Diana Rus</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-78"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-78" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c78">Comment 78</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-07-07 05:00 PDT" data-time="1594123225">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-78">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-78" data-comment-id="14922782" data-ismarkdown="true" ><p>Hi, verified as fixed with Google Pixel 3 XL (Android 9)-sends user directly to Google Playstore-&gt;Firefox and Samsung Galaxy S9 (Android 8) on Firefox Release 68.10.1 with same outcomes present in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1647078#c64" title="VERIFIED FIXED - content:// provider allows websites to remotely steal any file from the device if the path is known">Comment 64</a> and with same scenarios from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1647078#c67" title="VERIFIED FIXED - content:// provider allows websites to remotely steal any file from the device if the path is known">Comment67</a>.<br>
No javascript message present, empty iframe and no crashes encountered.</p>
</div><div class="activity"><div class="change">Status: RESOLVED &rarr; VERIFIED</div></div></div><div class="change-set" id="a1459546_636695"><div class="change" id="aa1459546_636695">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_636695" id="a1459546_636695"><img src="https://secure.gravatar.com/avatar/88e6ce873f2a55e04214be30e6c23372?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_636695" id="a1459546_636695"><a class="email " href="/user_profile?user_id=636695" > <span class="fna">Diana Rus</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1459546_636695"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1459546_636695">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#a1459546_636695">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-07-07 05:00 PDT" data-time="1594123238">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr68&amp;o1=isnotempty">status-firefox-esr68</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox_esr68&amp;o1=equals&amp;v1=fixed">fixed</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr68&amp;o1=equals&amp;v1=verified">verified</a></div></div></div><div class="change-set" id="a1482129_1689"><div class="change" id="aa1482129_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a1482129_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a1482129_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1482129_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1482129_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#a1482129_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-07-07 11:17 PDT" data-time="1594145821">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: sec-bounty? &rarr; sec-bounty+</div></div></div><div class="change-set" id="c79"><div class="comment" data-id="14925684" data-no="79"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-79" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_575867" id="a1482129_1689"><img src="https://secure.gravatar.com/avatar/9eb8612b118640351041fb0877c5fc8f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_575867" id="a1482129_1689"><a class="email " href="/user_profile?user_id=575867" > <span class="fna">Release mgmt bot [:sylvestre / :calixte / :marco for bugbug]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-79"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-79" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c79">Comment 79</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-07-08 10:00 PDT" data-time="1594227617">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-79">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-79" data-comment-id="14925684" data-ismarkdown="true" ><p>As part of a security bug pattern analysis, we are requesting your help with a high level analysis of this bug. It is our hope to develop static analysis (or potentially runtime/dynamic analysis) in the future to identify classes of bugs.</p>
<p>Please visit <a href="https://docs.google.com/forms/d/e/1FAIpQLSe9uRXuoMK6tRglbNL5fpXbun_oEb6_xC2zpuE_CKA_GUjrvA/viewform?usp=pp_url&amp;entry.2124261401=https%3A%2F%2Fbugzilla.mozilla.org%2Fshow_bug.cgi%3Fid%3D1647078" rel="nofollow">this google form</a> to reply.</p>
</div><div class="activity"><div class="change">Flags: needinfo?(agi)</div><div class="change">Whiteboard: [reporter-external] [client-bounty-form] [verif?] &rarr; [reporter-external] [client-bounty-form] [verif?][sec-survey]</div></div></div><div class="change-set" id="c80"><div class="comment" data-id="14925814" data-no="80"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-80" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_421286" id="a1482129_1689"><img src="https://secure.gravatar.com/avatar/2f23a572bdd06777026ab2c155cfe0c0?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_421286" id="a1482129_1689"><a class="email " href="/user_profile?user_id=421286" > <span class="fna">Agi Sferro | :agi | ni? for questions | ⏰ PST | he/him</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-80"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-80" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c80">Comment 80</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-07-08 11:04 PDT" data-time="1594231462">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-80">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-80" data-comment-id="14925814" data-ismarkdown="true" ><p>Done.</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(agi)</span></div></div></div><div class="change-set" id="c81"><div class="comment" data-id="14925826" data-no="81"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-81" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_388264" id="a1482129_1689"><img src="https://secure.gravatar.com/avatar/73072cf44258fa9cb3ae3ed4f47b9939?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_388264" id="a1482129_1689"><a class="email " href="/user_profile?user_id=388264" > <span class="fna">Stefan Arentz | :st3fan | ⏰ EST | he/him</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-81"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-81" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c81">Comment 81</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-07-08 11:10 PDT" data-time="1594231848">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-81">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-81" data-comment-id="14925826" data-ismarkdown="true" ><p>Thanks Agi - I looked at the form but wasn&#39;t sure what to put in there. Except for one thing: I think static code analysis is probably very tricky for this specific bug. (Or maye you had a different idea about that, i&#39;m curious) - But, there is another type of analysis we could do: audit the AndroidManifest.xml and check for changes in for example intent handlers or supported content types. So that when those change, a patch will get flagged as needing a security review. Cc to :sylvestre</p>
</div><div class="activity"><div class="change">Flags: needinfo?(sledru)</div></div></div><div class="change-set" id="c82"><div class="comment" data-id="14931638" data-no="82"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-82" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_495955" id="a1482129_1689"><img src="https://secure.gravatar.com/avatar/5aa2e382197a147b42d020b6878f8623?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_495955" id="a1482129_1689"><a class="email " href="/user_profile?user_id=495955" > <span class="fna">Sylvestre Ledru [:Sylvestre]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-82"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-82" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c82">Comment 82</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-07-12 02:54 PDT" data-time="1594547653">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-82">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-82" data-comment-id="14931638" data-ismarkdown="true" ><p>Redirecting to Freddy (he is the one owning this rule)</p>
</div><div class="activity"><div class="change">Flags: needinfo?(sledru) &rarr; needinfo?(fbraun)</div></div></div><div class="change-set" id="a1928888_159069"><div class="change" id="aa1928888_159069">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a1928888_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_159069" id="a1928888_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1928888_159069"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1928888_159069">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#a1928888_159069">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-07-12 15:23 PDT" data-time="1594592580">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">See Also:  &rarr; <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Private files are allowed to be uploaded (exfiltration)"
   href="/show_bug.cgi?id=1652364">CVE-2020-15649</a></div></div></div><div class="change-set" id="a1928987_159069"><div class="change" id="aa1928987_159069">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a1928987_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_159069" id="a1928987_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1928987_159069"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1928987_159069">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#a1928987_159069">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-07-12 15:24 PDT" data-time="1594592679">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">See Also:  &rarr; <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Path traversal in upload feature allows internal file overwrite"
   href="/show_bug.cgi?id=1652360">CVE-2020-15650</a></div></div></div><div class="change-set" id="c83"><div class="comment" data-id="14932690" data-no="83"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-83" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a1928987_159069"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a1928987_159069"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-83"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-83" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c83">Comment 83</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-07-12 23:19 PDT" data-time="1594621174">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-83">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-83" data-comment-id="14932690" data-ismarkdown="true" ><p>Thanks! I&#39;ve added this to the response we have on file for this bug.</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(fbraun)</span></div></div></div><div class="change-set" id="a2249237_578488"><div class="change" id="aa2249237_578488">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_578488" id="a2249237_578488"><img src="https://secure.gravatar.com/avatar/6822db445808be789b12cfae22d118dc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_578488" id="a2249237_578488"><a class="email " href="/user_profile?user_id=578488" > <span class="fna">Tom Ritter [:tjr] (ni? for response to CVE/sec-approval/advisories/etc)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a2249237_578488"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a2249237_578488">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#a2249237_578488">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-07-16 08:22 PDT" data-time="1594912929">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Alias: CVE-2020-15647</div></div></div><div class="change-set" id="c84"><div class="comment" data-id="15101568" data-no="84"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-84" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_665275" id="a2249237_578488"><img src="https://secure.gravatar.com/avatar/fba1cdeef36023e3cfc2558b3d82963d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_665275" id="a2249237_578488"><a class="email " href="/user_profile?user_id=665275" > <span class="fna">Pedro Oliveira</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-84"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-84" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c84">Comment 84</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-10-26 12:47 PDT" data-time="1603741645">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-84">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-84" data-comment-id="15101568" data-ismarkdown="true" ><p>Hello again,</p>
<p>I&#39;m planning to disclose this bug in a write-up by November.<br>
I&#39;m willing to share the draft here before publish.</p>
<p>However, I would like to ask if the timing is appropriate given the severity of the issue.</p>
<p>I can omit some details if necessary. Do you think it&#39;s okay to disclose this by that time?</p>
<p>Thank you,<br>
kanytu</p>
</div></div><div class="change-set" id="a11077988_665275"><div class="change" id="aa11077988_665275">
    <table class="layout-table change-head reporter" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_665275" id="a11077988_665275"><img src="https://secure.gravatar.com/avatar/fba1cdeef36023e3cfc2558b3d82963d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_665275" id="a11077988_665275"><a class="email " href="/user_profile?user_id=665275" > <span class="fna">Pedro Oliveira</span></a>
</div>
            <span class="user-role">Reporter</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a11077988_665275"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a11077988_665275">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#a11077988_665275">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-10-26 12:48 PDT" data-time="1603741680">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: needinfo?(dveditz)</div></div></div><div class="change-set" id="c85"><div class="comment" data-id="15105978" data-no="85"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-85" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a11077988_665275"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a11077988_665275"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-85"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-85" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c85">Comment 85</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-10-29 01:21 PDT" data-time="1603959707">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-85">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-85" data-comment-id="15105978" data-ismarkdown="true" ><p>Thanks for reaching out.<br>
We&#39;re expecting users to have received an update for a while now, feel free to go ahead. We&#39;d be interested to read your blog post, when it&#39;s ready. Mostly out of curiosity, though.</p>
<p>Great bug and thanks for checking in, Pedro!</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(dveditz)</span></div></div></div><div class="change-set" id="c86"><div class="comment" data-id="15131851" data-no="86"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-86" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_665275" id="a11077988_665275"><img src="https://secure.gravatar.com/avatar/fba1cdeef36023e3cfc2558b3d82963d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_665275" id="a11077988_665275"><a class="email " href="/user_profile?user_id=665275" > <span class="fna">Pedro Oliveira</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-86"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-86" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#c86">Comment 86</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-11-15 16:51 PST" data-time="1605487886">1 year ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-86">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-86" data-comment-id="15131851" data-ismarkdown="true" ><p>Hey again team,</p>
<p>The writeup has been published today. You can check it out here:</p>
<p>“Firefox and how a website could steal all of your cookies” by Pedro Oliveira <a href="https://medium.com/@kanytu/firefox-and-how-a-website-could-steal-all-of-your-cookies-581fe4648e8d" rel="nofollow">https://medium.com/@kanytu/firefox-and-how-a-website-could-steal-all-of-your-cookies-581fe4648e8d</a></p>
<p>Once again, thank you<br>
@kanytu</p>
</div></div><div class="change-set" id="a15677156_1689"><div class="change" id="aa15677156_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a15677156_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a15677156_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a15677156_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a15677156_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#a15677156_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-12-18 17:20 PST" data-time="1608340848">11 months ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: <span class="activity-deleted">core-security-release</span></div></div></div><div class="change-set" id="a15912234_1"><div class="change" id="aa15912234_1">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1" id="a15912234_1"><img src="https://secure.gravatar.com/avatar/eaa3c40fff208819d0810fc338eea0aa?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1" id="a15912234_1"><a class="email " href="/user_profile?user_id=1" > <span class="fna">Nobody; OK to take it and work on it</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a15912234_1"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a15912234_1">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#a15912234_1">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-12-21 10:38 PST" data-time="1608575926">10 months ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Product: Firefox for Android &rarr; Firefox for Android Graveyard</div></div></div><div class="change-set" id="a23185832_406670"><div class="change" id="aa23185832_406670">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_406670" id="a23185832_406670"><img src="https://secure.gravatar.com/avatar/3be472321f8ced3986562b808499a0a4?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_406670" id="a23185832_406670"><a class="email " href="/user_profile?user_id=406670" > <span class="fna">Kevin Brosnan [:kbrosnan]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a23185832_406670"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a23185832_406670">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1647078#a23185832_406670">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2021-03-15 16:05 PDT" data-time="1615849524">8 months ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(kbrosnan)</span></div></div></div><div id="new-comment-notice">
          You need to <a href="/show_bug.cgi?id=1647078&amp;GoAheadAndLogIn=1">log in</a>
          before you can comment on or make changes to this bug.
        </div>



<div id="bottom-actions">
  <div id="bottom-right-actions">
    <button type="button" id="top-btn" class="secondary" aria-label="Go to Page Top">Top &uarr;</button>
  </div>
</div></div> 
</main> 
</div> 


</body>
</html>