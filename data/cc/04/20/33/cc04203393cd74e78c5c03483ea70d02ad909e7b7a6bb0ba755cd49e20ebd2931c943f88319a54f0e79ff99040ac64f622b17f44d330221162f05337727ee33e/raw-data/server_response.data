<!DOCTYPE html>
<html>
  <head>
    <link rel="shortcut icon" type="image/png" href="https://blog.kos-lab.com/images/logo.png">
    <title>Hello World and Intelbras Ncloud vulnerability disclosure – Kos-Lab – Cyber Security Unit from</title>

        <meta charset="utf-8" />
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0'>

    
    <meta name="description" content="Author: Pedro Aguiar (pedro.aguiar@kryptus.com)

" />
    <meta property="og:description" content="Author: Pedro Aguiar (pedro.aguiar@kryptus.com)

" />
    
    <meta name="author" content="Kos-Lab" />

    
    <meta property="og:title" content="Hello World and Intelbras Ncloud vulnerability disclosure" />
    <meta property="twitter:title" content="Hello World and Intelbras Ncloud vulnerability disclosure" />
    

    <!--[if lt IE 9]>
      <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="alternate" type="application/rss+xml" title="Kos-Lab - Cyber Security Unit from" href="/feed.xml" />

    <!-- Created with Jekyll Now - http://github.com/barryclark/jekyll-now -->
  </head>

  <body>
    <div class="wrapper-masthead">
      <div class="container">
        <header class="masthead clearfix">
          <a href="/" class="site-avatar"><img src="https://blog.kos-lab.com/images/logo.png" /></a>

          <div class="site-info">
            <h1 class="site-name"><a href="/">Kos-Lab</a></h1>
            <p class="site-description">Cyber Security Unit from <a href="https://kryptus.com">Kryptus</a></p>
          </div>

          <nav>
            <a href="/">Blog</a>
            <a href="/about">About</a>
          </nav>
        </header>
      </div>
    </div>

    <div id="main" role="main" class="container">
      <article class="post">
  <h1>Hello World and Intelbras Ncloud vulnerability disclosure</h1>

  <div class="entry">
    <p>Author: Pedro Aguiar (pedro.aguiar@kryptus.com)</p>

<p>Welcome to the first post in this blog, written by the Kos-Lab team, the Cyber Security Unit of <a href="https://kryptus.com">Kryptus</a>, a brazilian Cyber Defense company.</p>

<p>A few weeks ago, we got our hands in a Intelbras Ncloud 300 device, an interesting wireless router, with features like a Torrent Client and USB storage, after a few days taking a look at it, the following was discovered:</p>

<h2 id="unprotected-serial-port-uart">Unprotected Serial port (UART)</h2>

<p>Connecting to the serial interface, a root shell was obtained, using this method, the root password hash was also obtained:</p>

<figure class="highlight"><pre><code class="language-conf" data-lang="conf"><span class="n">root</span>:<span class="n">uax</span>./<span class="n">Fu15Jqo6</span>:<span class="m">0</span>:<span class="m">0</span>:<span class="n">Adminstrator</span>:/:/<span class="n">bin</span>/<span class="n">sh</span></code></pre></figure>

<p>John the Ripper quickly cracked that hash, the password is: cary</p>

<p>Those credentials can be used on the telnet port, this is particularly critical because it is possible for the attacker to see any files the user has stored in the USB device connected.</p>

<p>In cases where the user root does not work, it was replaced with the web interface credentials, which can be obtained exploring the next vulnerability:</p>

<p><img src="/images/Ncloud0.jpeg" alt="Ncloud0.jpeg" /></p>

<h2 id="unauthenticated-configuration-backup">Unauthenticated configuration backup</h2>

<p>Even though the web interface of the device has a login system, it is not properly enforced, therefore, when a request to /cgi-bin/ExportSettings.sh is done, a configuration “backup” is retrieved, which includes the web interface username and password:</p>

<p><img src="/images/Ncloud1.png" alt="Ncloud1.png" /></p>

<p>The following CVE was assigned to this issue: CVE-2018-11094</p>

<h2 id="unauthenticated-wireless-password-disclosure">Unauthenticated wireless password disclosure</h2>

<p>When a request to /goform/updateWPS is done, the wireless network password is disclosed:</p>

<p><img src="/images/Ncloud2.png" alt="Ncloud2.png" /></p>

<p>The URL /goform/vpnBasicSettings is also vulnerable to this, being possible to enable or disable the VPN.</p>

<h2 id="unauthenticated-device-reboot">Unauthenticated device reboot</h2>

<p>When a request to /goform/RebootSystem is done, the device reboots:</p>

<p><img src="/images/Ncloud3.png" alt="Ncloud3.png" /></p>

<h2 id="poc">PoC</h2>
<p>An <a href="https://www.exploit-db.com/exploits/44637/">exploit</a> was created to demonstrate the issues described in this post:</p>

<p><img src="/images/Ncloud4.png" alt="Ncloud4.png" /></p>

<p>Timeline:<br />
9 May, 2018 - Vendor was notified via email about the vulnerability<br />
10 May, 2018 - Vendor responded to the email asking for more details<br />
14 May, 2018 - Vendor called us and informed us that the product was discontinued and there was no possibility of a patch being developed, they also agreed with full disclosure.</p>

  </div>

  <div class="date">
    Written on May 15, 2018
  </div>

  
</article>

    </div>

    <div class="wrapper-footer">
      <div class="container">
        <footer class="footer">
          
<a href="mailto:cyber@kryptus.com"><i class="svg-icon email"></i></a>


<a href="https://github.com/kos-lab/kos-lab.github.io"><i class="svg-icon github"></i></a>








        </footer>
      </div>
    </div>

    
	<!-- Google Analytics -->
	<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

		ga('create', 'UA-119322823-1', 'auto');
		ga('send', 'pageview', {
		  'page': '/Hello-World/',
		  'title': 'Hello World and Intelbras Ncloud vulnerability disclosure'
		});
	</script>
	<!-- End Google Analytics -->


  </body>
</html>
