<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>ed4c8d79153baab7f26562afb8930652dfbf853b - platform/frameworks/minikin - Git at Google</title><link rel="stylesheet" type="text/css" href="/+static/base.css"><!-- default customHeadTagPart --></head><body class="Site"><header class="Site-header"><div class="Header"><a class="Header-image" href="/"><img src="//www.gstatic.com/images/branding/lockups/2x/lockup_git_color_108x24dp.png" width="108" height="24" alt="Google Git"></a><div class="Header-menu"> <a class="Header-menuItem" href="https://accounts.google.com/AccountChooser?service=gerritcodereview&amp;continue=https://android.googlesource.com/login/platform/frameworks/minikin/%2B/ed4c8d79153baab7f26562afb8930652dfbf853b">Sign in</a> </div></div></header><div class="Site-content"><div class="Container "><div class="Breadcrumbs"><a class="Breadcrumbs-crumb" href="/?format=HTML">android</a> / <a class="Breadcrumbs-crumb" href="/platform/">platform</a> / <a class="Breadcrumbs-crumb" href="/platform/frameworks/">frameworks</a> / <a class="Breadcrumbs-crumb" href="/platform/frameworks/minikin/">minikin</a> / <span class="Breadcrumbs-crumb">ed4c8d79153baab7f26562afb8930652dfbf853b</span></div><div class="u-monospace Metadata"><table><tr><th class="Metadata-title">commit</th><td>ed4c8d79153baab7f26562afb8930652dfbf853b</td><td><span>[<a href="/platform/frameworks/minikin/+log/ed4c8d79153baab7f26562afb8930652dfbf853b">log</a>]</span> <span>[<a href="/platform/frameworks/minikin/+archive/ed4c8d79153baab7f26562afb8930652dfbf853b.tar.gz">tgz</a>]</span></td></tr><tr><th class="Metadata-title">author</th><td>Raph Levien &lt;raph@google.com&gt;</td><td>Mon Nov 30 15:04:59 2015 -0800</td></tr><tr><th class="Metadata-title">committer</th><td>The Android Automerger &lt;android-build@google.com&gt;</td><td>Thu Dec 10 16:41:09 2015 -0800</td></tr><tr><th class="Metadata-title">tree</th><td><a href="/platform/frameworks/minikin/+/ed4c8d79153baab7f26562afb8930652dfbf853b/">7bcf2ce6b7cd2cf91c8703780bfba13274f55b80</a></td></tr><tr><th class="Metadata-title">parent</th><td><a href="/platform/frameworks/minikin/+/ed4c8d79153baab7f26562afb8930652dfbf853b%5E">253320d25fccbb49621926d49dcf5ef64cf529c6</a> <span>[<a href="/platform/frameworks/minikin/+/ed4c8d79153baab7f26562afb8930652dfbf853b%5E%21/">diff</a>]</span></td></tr></table></div><pre class="u-pre u-monospace MetadataMessage">Avoid integer overflows in parsing fonts

A malformed TTF can cause size calculations to overflow. This patch
checks the maximum reasonable value so that the total size fits in 32
bits. It also adds some explicit casting to avoid possible technical
undefined behavior when parsing sized unsigned values.

Bug: 25645298
Change-Id: <a href="https://android-review.googlesource.com/#/q/Id4716132041a6f4f1fbb73ec4e445391cf7d9616">Id4716132041a6f4f1fbb73ec4e445391cf7d9616</a>
(cherry picked from commit 183c9ec2800baa2ce099ee260c6cbc6121cf1274)
</pre><ul class="DiffTree"><li><a href="/platform/frameworks/minikin/+/ed4c8d79153baab7f26562afb8930652dfbf853b/libs/minikin/CmapCoverage.cpp">libs/minikin/CmapCoverage.cpp</a><span class="DiffTree-action DiffTree-action--modify">[<a href="/platform/frameworks/minikin/+/ed4c8d79153baab7f26562afb8930652dfbf853b%5E%21/#F0">diff</a>]</span></li></ul><div class="DiffSummary">1 file changed</div><div class="TreeDetail"><div class="u-sha1 u-monospace TreeDetail-sha1">tree: 7bcf2ce6b7cd2cf91c8703780bfba13274f55b80</div><ol class="FileList"><li class="FileList-item FileList-item--gitTree" title="Tree - include/"><a class="FileList-itemLink" href="/platform/frameworks/minikin/+/ed4c8d79153baab7f26562afb8930652dfbf853b/include/">include/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - libs/"><a class="FileList-itemLink" href="/platform/frameworks/minikin/+/ed4c8d79153baab7f26562afb8930652dfbf853b/libs/">libs/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - sample/"><a class="FileList-itemLink" href="/platform/frameworks/minikin/+/ed4c8d79153baab7f26562afb8930652dfbf853b/sample/">sample/</a></li></ol></div></div> <!-- Container --></div> <!-- Site-content --><footer class="Site-footer"><div class="Footer"><span class="Footer-poweredBy">Powered by <a href="https://gerrit.googlesource.com/gitiles/">Gitiles</a>| <a href="https://policies.google.com/privacy">Privacy</a></span><span class="Footer-formats"><a class="u-monospace Footer-formatsItem" href="?format=TEXT">txt</a> <a class="u-monospace Footer-formatsItem" href="?format=JSON">json</a></span></div></footer></body></html>