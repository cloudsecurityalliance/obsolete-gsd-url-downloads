<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="UTF-8">
<meta property="og:type" content="website">
<meta property="og:title" content="1429093 - (CVE-2018-5141) Push API allows DOM event without user interaction">
<meta property="og:url" content="https://bugzilla.mozilla.org/show_bug.cgi?id=1429093">
<meta property="og:description"
      content="RESOLVED (ben) in Core - DOM: Service Workers. Last updated 2018-08-28.">
<meta name="twitter:label1" value="Type">
<meta name="twitter:data1" value="defect">
<meta name="twitter:label2" value="Priority">
<meta name="twitter:data2" value="P2">

    <meta name="viewport" content="width=1024">
    <meta name="color-scheme" content="dark light">
    <meta name="generator" content="Bugzilla 20211025.1">
    <meta name="bugzilla-global" content="dummy"
        id="bugzilla-global" data-bugzilla="{&quot;api_token&quot;:&quot;&quot;,&quot;config&quot;:{&quot;basepath&quot;:&quot;\/&quot;},&quot;constant&quot;:{&quot;COMMENT_COLS&quot;:80},&quot;param&quot;:{&quot;maxattachmentsize&quot;:&quot;10240&quot;,&quot;maxusermatches&quot;:&quot;50&quot;,&quot;splinter_base&quot;:&quot;\/page.cgi?id=splinter.html&amp;ignore=\/&quot;},&quot;string&quot;:{&quot;bug_type_required&quot;:&quot;You must select a Type for this bug&quot;,&quot;component_required&quot;:&quot;You must select a Component for this bug&quot;,&quot;description_required&quot;:&quot;You must enter a Description for this bug&quot;,&quot;short_desc_required&quot;:&quot;You must enter a Summary for this bug&quot;,&quot;version_required&quot;:&quot;You must select a Version for this bug&quot;},&quot;user&quot;:{&quot;is_new&quot;:1,&quot;login&quot;:&quot;&quot;}}">
    <title>1429093 - (CVE-2018-5141) Push API allows DOM event without user interaction</title>

<link rel="Top" href="/">

  


  
    <link rel="Show" title="Dependency Tree"
          href="/showdependencytree.cgi?id=1429093&amp;hide_resolved=1">
      <link rel="Show" title="Dependency Graph"
            href="/showdependencygraph.cgi?id=1429093">

      <link rel="Show" title="Bug Activity"
            href="/show_activity.cgi?id=1429093">

<link href="/static/v20211025.1/skins/yui.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/standard/global.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BugModal/web/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BMO/web/styles/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/EditComments/web/styles/inline-editor.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-structure-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-theme-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/lib/prism.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Needinfo/web/styles/needinfo.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Review/web/styles/badge.css" rel="stylesheet" type="text/css">



    
<script nonce="0pjeA7N4JqWJZYJWZd1NedORUyya4obKmNrLaGhRKtwkL3Vc" src="/static/v20211025.1/js/jquery/jquery-min.js"></script><script nonce="0pjeA7N4JqWJZYJWZd1NedORUyya4obKmNrLaGhRKtwkL3Vc" src="/static/v20211025.1/js/jquery/ui/jquery-ui-min.js"></script><script nonce="0pjeA7N4JqWJZYJWZd1NedORUyya4obKmNrLaGhRKtwkL3Vc" src="/static/v20211025.1/js/yui.js"></script><script nonce="0pjeA7N4JqWJZYJWZd1NedORUyya4obKmNrLaGhRKtwkL3Vc" src="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu-min.js"></script><script nonce="0pjeA7N4JqWJZYJWZd1NedORUyya4obKmNrLaGhRKtwkL3Vc" src="/static/v20211025.1/js/jquery/plugins/devbridgeAutocomplete/devbridgeAutocomplete-min.js"></script><script nonce="0pjeA7N4JqWJZYJWZd1NedORUyya4obKmNrLaGhRKtwkL3Vc" src="/static/v20211025.1/js/global.js"></script><script nonce="0pjeA7N4JqWJZYJWZd1NedORUyya4obKmNrLaGhRKtwkL3Vc" src="/static/v20211025.1/js/util.js"></script><script nonce="0pjeA7N4JqWJZYJWZd1NedORUyya4obKmNrLaGhRKtwkL3Vc" src="/static/v20211025.1/js/dropdown.js"></script>

      <script nonce="0pjeA7N4JqWJZYJWZd1NedORUyya4obKmNrLaGhRKtwkL3Vc">
          YAHOO.namespace('bugzilla');
          if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
              YAHOO.util.Event._simpleRemove(window, "unload",
                                             YAHOO.util.Event._unload);
          }BUGZILLA.value_descs = JSON.parse('{\"bug_status\":{},\"resolution\":{\"\":\"---\"}}');

  
    var tracking_flags_str = "{\"flags\":{\"project\":{\"cf_a11y_review_project_flag\":\"---\",\"cf_webcompat_priority\":\"---\",\"cf_root_cause\":\"---\",\"cf_fission_milestone\":\"---\",\"cf_tracking_firefox_sumo\":\"---\"},\"tracking\":{\"cf_status_firefox_esr78\":\"---\",\"cf_tracking_firefox_esr91\":\"---\",\"cf_status_firefox95\":\"---\",\"cf_tracking_thunderbird_esr78\":\"---\",\"cf_status_firefox58\":\"wontfix\",\"cf_status_firefox93\":\"---\",\"cf_tracking_firefox94\":\"---\",\"cf_status_thunderbird_esr78\":\"---\",\"cf_tracking_firefox_relnote\":\"---\",\"cf_status_firefox_esr52\":\"unaffected\",\"cf_tracking_firefox95\":\"---\",\"cf_status_thunderbird_esr91\":\"---\",\"cf_tracking_thunderbird_esr91\":\"---\",\"cf_tracking_firefox93\":\"---\",\"cf_status_firefox_esr91\":\"---\",\"cf_status_firefox60\":\"fixed\",\"cf_tracking_firefox_esr78\":\"---\",\"cf_status_firefox94\":\"---\",\"cf_status_firefox59\":\"fixed\"}},\"comments\":{\"cf_tracking_firefox94\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_a11y_review_project_flag\":{\"requested\":\"Description:\\nPlease provide an explanation of the feature or change. Include a description of the user scenario in which it would be used and how the user would complete the task(s).\\nScreenshots and visual UI specs are welcome, but please include sufficient accompanying explanation so that blind members of the accessibility team are able to understand the feature\/change.\\n\\nHow do we test this?\\nIf there is an implementation to test, please provide instructions for testing it; e.g. setting preferences, other preparation, how to trigger the UI, etc.\\n\\nWhen will this ship?\\nTracking bug\/issue:\\nDesign documents (e.g. Product Requirements Document, UI spec):\\nEngineering lead:\\nProduct manager:\\n\\nThe accessibility team has developed the Mozilla Accessibility Release Guidelines which outline what is needed to make user interfaces accessible:\\nhttps:\/\/wiki.mozilla.org\/Accessibility\/Guidelines\\nPlease describe the accessibility guidelines you considered and what steps you\'ve taken to address them:\\n\\nDescribe any areas of concern to which you want the accessibility team to give special attention:\"},\"cf_tracking_firefox_esr78\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_sumo\":{\"none-needed\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox_relnote\":{\"?\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox95\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox93\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr91\":{\"?\":\"[Tracking Requested - why for this release]:\"}},\"types\":[\"tracking\"]}";
    var TrackingFlags = $.parseJSON(tracking_flags_str);

  

  
  BUGZILLA.bug_id = 1429093;
  BUGZILLA.bug_title = '1429093 - (CVE-2018-5141) Push API allows DOM event without user interaction';
  BUGZILLA.bug_summary = 'Push API allows DOM event without user interaction';
  BUGZILLA.bug_url = 'https:\/\/bugzilla.mozilla.org\/show_bug.cgi?id=1429093';
  BUGZILLA.bug_keywords = 'csectype-dos, sec-low',
  BUGZILLA.user = {
    id: 0,
    login: '',
    is_insider: false,
    is_timetracker: false,
    can_tag: false,
    timezone: 'America\/Los_Angeles',
    settings: {
      quote_replies: 'quoted_reply',
      zoom_textareas: true,
      remember_collapsed: true,
      inline_attachments: true,
      autosize_comments: false
    }
  };

  BUGZILLA.bug_secure = false;
      </script>
<script nonce="0pjeA7N4JqWJZYJWZd1NedORUyya4obKmNrLaGhRKtwkL3Vc" src="/static/v20211025.1/extensions/BugModal/web/autosize.min.js"></script><script nonce="0pjeA7N4JqWJZYJWZd1NedORUyya4obKmNrLaGhRKtwkL3Vc" src="/static/v20211025.1/extensions/ProdCompSearch/web/js/prod_comp_search.js"></script><script nonce="0pjeA7N4JqWJZYJWZd1NedORUyya4obKmNrLaGhRKtwkL3Vc" src="/static/v20211025.1/extensions/BugModal/web/bug_modal.js"></script><script nonce="0pjeA7N4JqWJZYJWZd1NedORUyya4obKmNrLaGhRKtwkL3Vc" src="/static/v20211025.1/extensions/BugModal/web/comments.js"></script><script nonce="0pjeA7N4JqWJZYJWZd1NedORUyya4obKmNrLaGhRKtwkL3Vc" src="/static/v20211025.1/extensions/ComponentWatching/web/js/overlay.js"></script><script nonce="0pjeA7N4JqWJZYJWZd1NedORUyya4obKmNrLaGhRKtwkL3Vc" src="/static/v20211025.1/js/bugzilla-readable-status-min.js"></script><script nonce="0pjeA7N4JqWJZYJWZd1NedORUyya4obKmNrLaGhRKtwkL3Vc" src="/static/v20211025.1/js/field.js"></script><script nonce="0pjeA7N4JqWJZYJWZd1NedORUyya4obKmNrLaGhRKtwkL3Vc" src="/static/v20211025.1/js/comments.js"></script><script nonce="0pjeA7N4JqWJZYJWZd1NedORUyya4obKmNrLaGhRKtwkL3Vc" src="/static/v20211025.1/extensions/TrackingFlags/web/js/flags.js"></script><script nonce="0pjeA7N4JqWJZYJWZd1NedORUyya4obKmNrLaGhRKtwkL3Vc" src="/static/v20211025.1/extensions/BMO/web/js/firefox-crash-table.js"></script><script nonce="0pjeA7N4JqWJZYJWZd1NedORUyya4obKmNrLaGhRKtwkL3Vc" src="/static/v20211025.1/extensions/MozChangeField/web/js/severity-s1-priority-p1.js"></script><script nonce="0pjeA7N4JqWJZYJWZd1NedORUyya4obKmNrLaGhRKtwkL3Vc" src="/static/v20211025.1/extensions/MozChangeField/web/js/clear-tracking-priority-s1.js"></script><script nonce="0pjeA7N4JqWJZYJWZd1NedORUyya4obKmNrLaGhRKtwkL3Vc" src="/static/v20211025.1/extensions/MozChangeField/web/js/set-tracking-severity-s1.js"></script><script nonce="0pjeA7N4JqWJZYJWZd1NedORUyya4obKmNrLaGhRKtwkL3Vc" src="/static/v20211025.1/js/lib/prism.js"></script><script nonce="0pjeA7N4JqWJZYJWZd1NedORUyya4obKmNrLaGhRKtwkL3Vc" src="/static/v20211025.1/extensions/GoogleAnalytics/web/js/analytics.js"></script><script nonce="0pjeA7N4JqWJZYJWZd1NedORUyya4obKmNrLaGhRKtwkL3Vc" src="/static/v20211025.1/js/lib/md5.min.js"></script><script nonce="0pjeA7N4JqWJZYJWZd1NedORUyya4obKmNrLaGhRKtwkL3Vc" src="/static/v20211025.1/extensions/Review/web/js/badge.js"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla@Mozilla" href="/search_plugin.cgi"><link rel="shortcut icon" href="/extensions/BMO/web/images/favicon.ico">
<link rel="canonical" href="https://bugzilla.mozilla.org/show_bug.cgi?id=1429093">
<link rel="shorturl" href="https://bugzilla.mozilla.org/1429093"><meta name="google-analytics" content="UA-36116321-3" data-location="https://bugzilla.mozilla.org/bug/show-modal" data-title="1429093 - (CVE-2018-5141) Push API allows DOM event without user interaction">
<script async src="https://www.google-analytics.com/analytics.js"></script><meta name="robots" content="noarchive">
  </head>



  <body
        class="bugzilla-mozilla-org
               skin-standard bug_modal yui-skin-sam">



<div id="wrapper">

<header id="header" role="banner">
  <div class="inner">
    <h1 id="header-title" class="title"><a href="https://bugzilla.mozilla.org/home" title="Go to home page">Bugzilla</a></h1>
    <form role="search" id="header-search" class="quicksearch" action="/buglist.cgi" data-no-csrf>
      <section class="searchbox-outer dropdown" role="combobox" aria-expanded="false" aria-haspopup="listbox"
               aria-labelledby="header-search-label" aria-owns="header-search-dropdown">
        <h2 id="header-search-label">Quick Search</h2>
        <span class="icon" aria-hidden="true"></span>
        <input role="searchbox" id="quicksearch_top" class="dropdown-button" name="quicksearch" autocomplete="off"
               value="" placeholder="Search Bugs"
               title="Enter a bug number or some search terms" aria-controls="header-search-dropdown"
               aria-label="Quick Search"><div id="header-search-dropdown" class="dropdown-content right" role="listbox" style="display: none;">
  <div id="header-search-dropdown-wrapper">
  </div>
</div>
      </section>
    </form>
    <nav id="header-nav">
      <ul class="links">
        <li class="link-browse">
          <a href="/describecomponents.cgi" title="Browse bugs by component">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Browse</span>
          </a>
        </li>
        <li class="link-search">
          <a href="/query.cgi?format=advanced" title="Search bugs using various criteria">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Advanced Search</span>
          </a>
        </li>
      </ul>
      <div class="dropdown">
        <button type="button" id="header-tools-menu-button" class="dropdown-button minor" title="More tools…"
                aria-label="More tools…" aria-expanded="false" aria-haspopup="true" aria-controls="header-tools-menu">
          <span class="icon" aria-hidden="true"></span>
        </button>
        <ul class="dropdown-content left" id="header-tools-menu" role="menu" style="display:none;">
          <li role="presentation">
            <a href="/report.cgi" role="menuitem" tabindex="-1">Reports</a>
          </li>
            <li role="separator"></li>
            <li role="presentation">
              <a href="https://bmo.readthedocs.io/en/latest/" role="menuitem" tabindex="-1">Documentation</a>
            </li>
        </ul>
      </div>
    </nav>
      <ul id="header-login" class="links">
          <li id="moz_new_account_container_top"><a href="/createaccount.cgi">New Account</a></li><li id="mini_login_container_top">
  <a id="login_link_top" href="/index.cgi?GoAheadAndLogIn=1"
     class='show_mini_login_form' data-qs-suffix="_top">Log In</a>

  <div id="mini_login_top" class="mini-popup mini_login bz_default_hidden"><span id="github_mini_login_top" class="mini_login_top">
    <form method="post" action="/github.cgi">
      <input type="hidden" name="github_secret" value="jRHkUt97iH4Re5I0owxmV3qjM1n5DERW3IrSTgn2oHjJQUgMbeTJCvErzZiaEcFq9kMcZs9kb0OwofvfOvNvlLg7hDHX559Ff5xXsWqFAOH4QYmCEQIUzVyH8svh9uLUrpA6KnES4bwAc8Ltx6mwLFhCZtLuVd16hXqJArhd8EOtUQKmcVzpfq9v0kyb30LgxJRXO8tYMSNl4bUvjPP4Ad0IdG7LSDE65E96OZazlXplsNJDYJuvSdNAnipqJJ8l">
      <input type="hidden" name="target_uri" value="https://bugzilla.mozilla.org/show_bug.cgi">
      <input type="image" src="/extensions/GitHubAuth/web/images/sign_in.png" height="22" width="75" align="absmiddle"
             alt="Sign in with GitHub"
             title="Sign in with GitHub"> or
    </form>
  </span>

  <form action="/show_bug.cgi?id=1429093" method="POST"
        data-qs-suffix="_top">

    <input id="Bugzilla_login_top"
           class="bz_login"
           name="Bugzilla_login"
           title="Login"
           placeholder="Email"
           aria-label="Email"
           type="email"
           required
    >
    <input class="bz_password"
           id="Bugzilla_password_top"
           name="Bugzilla_password"
           type="password"
           title="Password"
           placeholder="Password"
           aria-label="Password"
           required
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text"
           id="Bugzilla_password_dummy_top" value="password"
           title="Password"
    >
      <input type="checkbox" id="Bugzilla_remember_top"
             name="Bugzilla_remember" value="on" class="bz_remember"
                 checked>
      <label for="Bugzilla_remember_top">Remember</label>
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
           class="check_mini_login_fields"
            id="log_in_top">
    <a href="#" id="hide_mini_login_top" aria-label="Close"
       class="close-button hide_mini_login_form" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
<li id="forgot_container_top">
  <a id="forgot_link_top" href="/index.cgi?GoAheadAndLogIn=1#forgot"
     class='show_forgot_form'
     data-qs-suffix="_top">Forgot Password</a>
  <div id="forgot_form_top" class="mini-popup mini_forgot bz_default_hidden">
  <form action="/token.cgi" method="post">
    <input type="email" name="loginname" size="20" placeholder="Email" aria-label="Email" required>
    <input id="forgot_button_top" value="Reset Password"
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <input type="hidden" id="token_top" name="token" value="1635623282-H_SILrOCN1aEQlxjH4j9KIo3HocAOCw3EFTo5sbDEYA">
    <a href="#" class="close-button hide_forgot_form" aria-label="Close" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
      </ul><div id="header-external-links" class="dropdown first">
  <button type="button" id="header-external-menu-button" class="dropdown-button minor" title="Mozilla"
          aria-label="Mozilla" aria-expanded="false" aria-haspopup="true" aria-controls="header-external-menu">
    <img src="/static/v20211025.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg" width="32" height="32" alt="">
  </button>
  <ul class="dropdown-content right" id="header-external-menu" role="menu" style="display:none;">
    <li role="presentation">
      <a href="https://www.mozilla.org/" role="menuitem" tabindex="-1">Mozilla Home</a>
    </li>
    <li role="separator"></li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/" role="menuitem" tabindex="-1">Privacy</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/#cookies" role="menuitem" tabindex="-1">Cookies</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/about/legal/" role="menuitem" tabindex="-1">Legal</a>
    </li>
  </ul>
</div>
  </div>
</header> 


<main id="bugzilla-body" tabindex="-1">

<aside id="message-container" role="complementary">
  <noscript>
    <div class="noscript">
      <div class="inner">
        <p>Please enable JavaScript in your browser to use all the features on this site.</p>
      </div>
    </div>
  </noscript>
</aside>

<div id="main-inner">




<div role="toolbar" id="page-toolbar">
  <div role="group" class="buttons">
    <button type="button" id="copy-summary" class="secondary"
      title="Copy bug number and summary to your clipboard">Copy Summary</button>
    <div id="clip-container" style="display:none"><input type="text" id="clip"></div>
    <div class="dropdown">
      <button type="button" id="action-menu-btn" aria-haspopup="true" aria-label="View"
        aria-expanded="false" aria-controls="action-menu" class="dropdown-button secondary">View &#9662;</button>
      <ul class="dropdown-content left" id="action-menu" role="menu" style="display:none;">
        <li role="presentation">
          <a id="action-reset" role="menuitem" tabindex="-1">Reset Sections</a>
        </li>
        <li role="presentation">
          <a id="action-expand-all" role="menuitem" tabindex="-1">Expand All Sections</a>
        </li>
        <li role="presentation">
          <a id="action-collapse-all" role="menuitem" tabindex="-1">Collapse All Sections</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a id="action-history" role="menuitem" tabindex="-1">History</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a href="/rest/bug/1429093" role="menuitem" tabindex="-1">JSON</a>
        </li>
        <li role="presentation">
          <a href="/show_bug.cgi?ctype=xml&amp;id=1429093" role="menuitem" tabindex="-1">XML</a>
        </li>
      </ul>
    </div>
  </div>
</div>



<div role="status" id="io-error" style="display:none"></div>
<div role="status" id="floating-message" style="display:none">
  <div id="floating-message-text"></div>
</div>
<section class="module"
>
  <div class="module-content"
  >
  <div id="summary-container">
    <div class="field indent" id="field-status_summary"
>


  
    <div class=" container">
        <span id="field-value-status_summary">
      <span class="bug-status-label text" data-status="closed">Closed</span>
      <span id="field-value-bug_id">
        <a href="/show_bug.cgi?id=1429093">Bug 1429093</a>
          <span class="edit-hide">(CVE-2018-5141)</span>
      </span>
      <span>
        <span class="bug-time-label">Opened <span class="rel-time" title="2018-01-09 07:47 PST" data-time="1515512868">4 years ago</span></span>
          <span class="bug-time-label">Closed <span class="rel-time" title="2018-01-24 14:54 PST" data-time="1516834447">4 years ago</span></span>
      </span>
        </span>
    </div>

  
</div>
<div class="field indent edit-hide"
>


  
    <div class=" container">
      

      <h1 id="field-value-short_desc">Push API allows DOM event without user interaction</h1>
    </div>

  
</div>

    <div class="field edit-show" id="field-short_desc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc" id="short_desc-help-link" class="help">Summary:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-short_desc">
            Push API allows DOM event without user interaction

        </span>
    </div>

  
</div>
  </div>
  </div>
</section>


<section class="module" id="module-categories"
>
    <header id="module-categories-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Categories section"
           data-label-collapsed="Expand Categories section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-categories-content"
             aria-expanded="true"
             aria-labeledby="module-categories-title"
             aria-describedby="module-categories-subtitle"></div>
        <h2 class="module-title" id="module-categories-title">Categories</h2>
          <h3 class="module-subtitle" id="module-categories-subtitle">
            (Core :: DOM: Service Workers, defect, P2)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-categories-content"
  ><div class="fields-lhs">

    <div class="field" id="field-product"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=Core" id="product-help-link" class="help">Product:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-product">
      <div class="name-info-outer dropdown">
        <span id="product-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="product-info">Core
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="product-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Product description and actions">
          <header>
            <div class="title">Core</div>
            <div class="description">Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the <a href="https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox">Firefox</a> product. (<a href="https://wiki.mozilla.org/Modules/All#Core">More info</a>)</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=Core&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Product</a></div>
            <div><a href="/enter_bug.cgi?product=Core"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Product</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="Core"
                         data-label-watch="Watch This Product" data-label-unwatch="Unwatch This Product"
                         data-source="BugModal">Watch This Product</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-component"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=Core&component=DOM%3A%20Service%20Workers#DOM%3A%20Service%20Workers" id="component-help-link" class="help">Component:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-component">
      <div class="name-info-outer dropdown">
        <span id="component-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="component-info">DOM: Service Workers
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="component-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Component description and actions">
          <header>
            <div class="title">Core :: DOM: Service Workers</div>
            <div class="description">This component covers the <a href="https://github.com/slightlyoff/ServiceWorker/">Service Worker</a> implementation in Gecko.</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=Core&amp;component=DOM%3A%20Service%20Workers&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Component</a></div>
            <div><a href="/buglist.cgi?product=Core&amp;component=DOM%3A%20Service%20Workers&amp;chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__"
                    target="_blank" role="menuitem" tabindex="-1">Recently Fixed Bugs in This Component</a></div>
            <div><a href="/enter_bug.cgi?product=Core&amp;component=DOM%3A%20Service%20Workers"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Component</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="Core" data-component="DOM: Service Workers"
                         data-label-watch="Watch This Component" data-label-unwatch="Unwatch This Component"
                         data-source="BugModal">Watch This Component</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-version"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#version" id="version-help-link" class="help">Version:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-version">
            57 Branch

        </span>
    </div>

  
</div>

    <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform" id="-help-link" class="help">Platform:
        </a>
    </div>


  
    <div class=" container"><div class="field inline" id="field-rep_platform"
>


  
    <div class="value">
        <span id="field-value-rep_platform">
            Unspecified

        </span>
    </div>

  
</div><div class="field indent inline" id="field-op_sys"
>


  
    <div class="value">
        <span id="field-value-op_sys">
            Unspecified

        </span>
    </div>

  
</div><div class="field indent inline"
>


  
    <div class=" container">
    </div>

  
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field contains-buttons" id="field-bug_type"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type" id="bug_type-help-link" class="help">Type:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_type">
      <span class="bug-type-label iconic-text" data-type="defect">
        <span class="icon" aria-hidden="true"></span>defect</span>
        </span>
    </div>

  
</div>

    <div class="field" id="field-importance"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority" id="importance-help-link" class="help">Priority:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-importance"><div class="field inline" id="field-priority"
>


  
    <div class="value">
        <span id="field-value-priority">P2
        </span>
    </div>

  
</div><div class="field inline" id="field-bug_severity"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity" id="bug_severity-help-link" class="help">Severity:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_severity">
            normal

        </span>
    </div>

  
</div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-cf_fx_points" style="display:none"
>
    <div class="name">Points:
    </div>


  
    <div class="value">
        <span id="field-value-cf_fx_points">
            ---

        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-tracking"
>
    <header id="module-tracking-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Tracking section"
           data-label-collapsed="Expand Tracking section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-tracking-content"
             aria-expanded="true"
             aria-labeledby="module-tracking-title"
             aria-describedby="module-tracking-subtitle"></div>
        <h2 class="module-title" id="module-tracking-title">Tracking</h2>
          <h3 class="module-subtitle" id="module-tracking-subtitle">
            (<span id="readable-bug-status" data-readable-bug-status="{&quot;flags&quot;:[{&quot;name&quot;:&quot;in-testsuite&quot;,&quot;status&quot;:&quot;+&quot;},{&quot;name&quot;:&quot;qe-verify&quot;,&quot;status&quot;:&quot;-&quot;}],&quot;cf_status_thunderbird_esr78&quot;:&quot;---&quot;,&quot;cf_tracking_firefox94&quot;:&quot;---&quot;,&quot;cf_a11y_review_project_flag&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_sumo&quot;:&quot;---&quot;,&quot;cf_status_thunderbird_esr91&quot;:&quot;---&quot;,&quot;dupe_of&quot;:null,&quot;target_milestone&quot;:&quot;mozilla60&quot;,&quot;cf_status_firefox_esr52&quot;:&quot;unaffected&quot;,&quot;priority&quot;:&quot;P2&quot;,&quot;cf_status_firefox_esr78&quot;:&quot;---&quot;,&quot;cf_status_firefox58&quot;:&quot;wontfix&quot;,&quot;cf_tracking_firefox_esr91&quot;:&quot;---&quot;,&quot;cf_fission_milestone&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_esr78&quot;:&quot;---&quot;,&quot;cf_status_firefox59&quot;:&quot;fixed&quot;,&quot;cf_status_firefox94&quot;:&quot;---&quot;,&quot;cf_tracking_firefox93&quot;:&quot;---&quot;,&quot;cf_tracking_thunderbird_esr91&quot;:&quot;---&quot;,&quot;resolution&quot;:&quot;FIXED&quot;,&quot;cf_status_firefox93&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_relnote&quot;:&quot;---&quot;,&quot;cf_root_cause&quot;:&quot;---&quot;,&quot;cf_tracking_firefox95&quot;:&quot;---&quot;,&quot;id&quot;:1429093,&quot;cf_webcompat_priority&quot;:&quot;---&quot;,&quot;cf_tracking_thunderbird_esr78&quot;:&quot;---&quot;,&quot;cf_status_firefox95&quot;:&quot;---&quot;,&quot;keywords&quot;:[&quot;csectype-dos&quot;,&quot;sec-low&quot;],&quot;status&quot;:&quot;RESOLVED&quot;,&quot;cf_status_firefox60&quot;:&quot;fixed&quot;,&quot;cf_status_firefox_esr91&quot;:&quot;---&quot;}"></span>)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-tracking-content"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-status-view"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-view-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-view">RESOLVED
        FIXED
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-status-edit" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-edit-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-edit"><div class="field inline" id="field-bug_status"
>


  
    <div class="value">
        <span id="field-value-bug_status">
            RESOLVED

        </span>
    </div>

  
</div><div class="field indent inline" id="field-resolution"
>


  
    <div class="value">
        <span id="field-value-resolution">
            FIXED

        </span>
    </div>

  
</div>
  <div id="status-action-buttons">
      <div id="assigned-container" style="display:none">
        <button type="button" class="secondary" id="mark-as-assigned-btn">
          Mark as Assigned
        </button>
      </div>
  </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-target_milestone"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone" id="target_milestone-help-link" class="help">Milestone:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-target_milestone">
            mozilla60

        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-cf_fx_iteration" style="display:none"
>
    <div class="name">Iteration:
    </div>


  
    <div class="value">
        <span id="field-value-cf_fx_iteration">
            ---

        </span>
    </div>

  
</div>


      <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Project Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <td class="tracking-flag-name">Root Cause</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_root_cause-dirty">
  <select id="cf_root_cause" name="cf_root_cause">
        <option value="---"
          id="v4701_cf_root_cause" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Webcompat Priority</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_webcompat_priority-dirty">
  <select id="cf_webcompat_priority" name="cf_webcompat_priority">
        <option value="---"
          id="v4274_cf_webcompat_priority" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">a11y-review</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_a11y_review_project_flag-dirty">
  <select id="cf_a11y_review_project_flag" name="cf_a11y_review_project_flag">
        <option value="---"
          id="v4876_cf_a11y_review_project_flag" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">user-doc-firefox</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_sumo-dirty">
  <select id="cf_tracking_firefox_sumo" name="cf_tracking_firefox_sumo">
        <option value="---"
          id="v4660_cf_tracking_firefox_sumo" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Fission Milestone</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_fission_milestone-dirty">
  <select id="cf_fission_milestone" name="cf_fission_milestone">
        <option value="---"
          id="v4222_cf_fission_milestone" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

      <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Tracking Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-hide">
    <table class="layout-table tracking-flags">
        <tr>
          <th></th>
          <th>Tracking</th>
          <th>Status</th>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox-esr52</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox_esr52&amp;o1=equals&amp;v1=unaffected">unaffected</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox58</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox58&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox59</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox59&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox60</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox60&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
    </table>
  </div>


<div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <th></th>
        <th>Tracking</th>
        <th>Status</th>
      </tr>
      <tr>
        <td class="tracking-flag-name">relnote-firefox</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_relnote-dirty">
  <select id="cf_tracking_firefox_relnote" name="cf_tracking_firefox_relnote">
        <option value="---"
          id="v539_cf_tracking_firefox_relnote" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr78-dirty">
  <select id="cf_tracking_thunderbird_esr78" name="cf_tracking_thunderbird_esr78">
        <option value="---"
          id="v4823_cf_tracking_thunderbird_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr78-dirty">
  <select id="cf_status_thunderbird_esr78" name="cf_status_thunderbird_esr78">
        <option value="---"
          id="v4829_cf_status_thunderbird_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr91-dirty">
  <select id="cf_tracking_thunderbird_esr91" name="cf_tracking_thunderbird_esr91">
        <option value="---"
          id="v5236_cf_tracking_thunderbird_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr91-dirty">
  <select id="cf_status_thunderbird_esr91" name="cf_status_thunderbird_esr91">
        <option value="---"
          id="v5242_cf_status_thunderbird_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr52</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr52-dirty">
  <select id="cf_status_firefox_esr52" name="cf_status_firefox_esr52">
        <option value="unaffected"
          id="v3134_cf_status_firefox_esr52" selected
        >unaffected
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr78-dirty">
  <select id="cf_tracking_firefox_esr78" name="cf_tracking_firefox_esr78">
        <option value="---"
          id="v4808_cf_tracking_firefox_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr78-dirty">
  <select id="cf_status_firefox_esr78" name="cf_status_firefox_esr78">
        <option value="---"
          id="v4813_cf_status_firefox_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr91-dirty">
  <select id="cf_tracking_firefox_esr91" name="cf_tracking_firefox_esr91">
        <option value="---"
          id="v5194_cf_tracking_firefox_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr91-dirty">
  <select id="cf_status_firefox_esr91" name="cf_status_firefox_esr91">
        <option value="---"
          id="v5199_cf_status_firefox_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox58</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox58-dirty">
  <select id="cf_status_firefox58" name="cf_status_firefox58">
        <option value="wontfix"
          id="v3447_cf_status_firefox58" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox59</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox59-dirty">
  <select id="cf_status_firefox59" name="cf_status_firefox59">
        <option value="fixed"
          id="v3510_cf_status_firefox59" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox60</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox60-dirty">
  <select id="cf_status_firefox60" name="cf_status_firefox60">
        <option value="fixed"
          id="v3566_cf_status_firefox60" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox93</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox93-dirty">
  <select id="cf_tracking_firefox93" name="cf_tracking_firefox93">
        <option value="---"
          id="v5266_cf_tracking_firefox93" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox93-dirty">
  <select id="cf_status_firefox93" name="cf_status_firefox93">
        <option value="---"
          id="v5271_cf_status_firefox93" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox94</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox94-dirty">
  <select id="cf_tracking_firefox94" name="cf_tracking_firefox94">
        <option value="---"
          id="v5284_cf_tracking_firefox94" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox94-dirty">
  <select id="cf_status_firefox94" name="cf_status_firefox94">
        <option value="---"
          id="v5289_cf_status_firefox94" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox95</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox95-dirty">
  <select id="cf_tracking_firefox95" name="cf_tracking_firefox95">
        <option value="---"
          id="v5311_cf_tracking_firefox95" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox95-dirty">
  <select id="cf_status_firefox95" name="cf_status_firefox95">
        <option value="---"
          id="v5316_cf_status_firefox95" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>

</div>
  </div>
</section>



<section class="module" id="module-people"
>
    <header id="module-people-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse People section"
           data-label-collapsed="Expand People section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-people-content"
             aria-expanded="false"
             aria-labeledby="module-people-title"
             aria-describedby="module-people-subtitle"></div>
        <h2 class="module-title" id="module-people-title">People</h2>
          <h3 class="module-subtitle" id="module-people-subtitle">
            (Reporter: zohar, Assigned: bkelly)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-people-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-assigned_to"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to"><div class="vcard vcard_465500" ><img src="https://secure.gravatar.com/avatar/bc5e85dbd8d5c9b11c419c65ee4081b5?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=465500" > <span class="fna">bkelly</span></a>
</div>
        </span>
    </div>

  
</div><div class="field edit-show" id="field-assigned_to" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-assignee" name="set_default_assignee" class="set-default"
          value="1" data-for="assigned_to">
        <label for="set-default-assignee">Reset Assignee to default</label>
      </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-bug_mentors" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor" id="bug_mentors-help-link" class="help">Mentors:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_mentors">---
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-qa_contact" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact" id="qa_contact-help-link" class="help">QA Contact:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-qa_contact">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-qa-contact" name="set_default_qa_contact" class="set-default"
          value="1" data-for="qa_contact">
        <label for="set-default-qa-contact">Reset QA Contact to default</label>
      </div>
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-reporter"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter" id="reporter-help-link" class="help">Reporter:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-reporter">
            <div class="vcard vcard_609555" ><img src="https://secure.gravatar.com/avatar/f9449e8de5f17bda351cec34a13ec417?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=609555" > <span class="fna">zohar</span></a>
</div>

        </span>
    </div>

  
</div>

    <div class="field" id="field-triage_owner"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner" id="triage_owner-help-link" class="help">Triage Owner:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-triage_owner">
            <div class="vcard vcard_646284" ><img src="https://secure.gravatar.com/avatar/9dcff4a8838b41f34d204c2f4cadbcc4?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=646284" > <span class="fna">jstutte</span></a>
</div>

        </span>
    </div>

  
</div>

    

    <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc" id="-help-link" class="help">CC:
        </a>
    </div>


  
    <div class=" container">


        <span aria-owns="cc-summary cc-latch">
          <span role="button" tabindex="0" id="cc-summary" data-count="10">10 people
          </span>
        </span>


        <div id="cc-list" style="display:none"></div>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-references"
>
    <header id="module-references-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse References section"
           data-label-collapsed="Expand References section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-references-content"
             aria-expanded="false"
             aria-labeledby="module-references-title"
             aria-describedby="module-references-subtitle"></div>
        <h2 class="module-title" id="module-references-title">References</h2>
      </div>
    </header>
  <div class="module-content" id="module-references-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field bug-list edit-show" id="field-dependson" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson" id="dependson-help-link" class="help">Depends on:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-dependson">
        ---
        </span>
    </div>

  
</div><div class="field bug-list edit-show" id="field-blocked" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks" id="blocked-help-link" class="help">Blocks:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-blocked">
        ---
        </span>
    </div>

  
</div>

    <div class="field bug-list edit-show" id="field-regresses" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses" id="regresses-help-link" class="help">Regressions:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regresses">
        ---
        </span>
    </div>

  
</div><div class="field bug-list edit-show" id="field-regressed_by" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by" id="regressed_by-help-link" class="help">Regressed by:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regressed_by">
        ---
        </span>
    </div>

  
</div>

    
</div><div class="fields-rhs">

    <div class="field edit-show" id="field-bug_file_loc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc" id="bug_file_loc-help-link" class="help">URL:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_file_loc"><div class="link">
    <a href="" target="_blank"
      rel="noreferrer" title=""
      class="bug-url" data-safe="0"></a>
  </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-see_also" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also" id="see_also-help-link" class="help">See Also:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-see_also">
        ---
        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-details"
>
    <header id="module-details-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Details section"
           data-label-collapsed="Expand Details section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-details-content"
             aria-expanded="false"
             aria-labeledby="module-details-title"
             aria-describedby="module-details-subtitle"></div>
        <h2 class="module-title" id="module-details-title">Details</h2>
          <h3 class="module-subtitle" id="module-details-subtitle">
            (Keywords: csectype-dos, sec-low, Whiteboard: [post-critsmash-triage][adv-main59+])
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-details-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-show" id="field-alias" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias" id="alias-help-link" class="help">Alias:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-alias">
            CVE-2018-5141

        </span>
    </div>

  
</div>

    <div class="field" id="field-keywords"
>
    <div class="name">
        <a href="/describekeywords.cgi" id="keywords-help-link" class="help">Keywords:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-keywords">
          <a href="/buglist.cgi?keywords=csectype-dos&amp;resolution=---">csectype-dos</a>, 
          <a href="/buglist.cgi?keywords=sec-low&amp;resolution=---">sec-low</a>
        </span>
    </div>

  
</div>

    <div class="field" id="field-status_whiteboard"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/Whiteboard" id="status_whiteboard-help-link" class="help">Whiteboard:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-status_whiteboard">[post-critsmash-triage][adv-main59+]
        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_qa_whiteboard" style="display:none"
>
    <div class="name">QA Whiteboard:
    </div>


  
    <div class="value">
        <span id="field-value-cf_qa_whiteboard">
        ---
        </span>
    </div>

  
</div>

    

    <div class="field edit-show" id="field-cf_has_regression_range" style="display:none"
>
    <div class="name">Has Regression Range:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_regression_range">
            ---

        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_has_str" style="display:none"
>
    <div class="name">Has STR:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_str">
            ---

        </span>
    </div>

  
</div>

    <div class="field" id="field-votes"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes" id="votes-help-link" class="help">Votes:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-votes">0
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-bug_flags"
>
    <div class="name">Bug Flags:
    </div>


  
    <div class=" container">
        <span id="field-value-bug_flags"><div id="bug-flags" class="flags">
  <table class="layout-table">
          <tbody class="edit-hide"><tr>
    <td class="flag-setter"><div class="vcard vcard_75935" ><a class="email " href="/user_profile?user_id=75935" > <span class="fna">RyanVM</span></a>
</div>
    </td>

    <td class="flag-name">
        <a href="#c39"
            class="rel-time-title activity-ref"
            title="4 years ago"
        data-time="1516848178"
      >in-testsuite</a>
    </td>

    <td class="flag-value">+
    </td>

  </tr>
          </tbody>
          <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter"><div class="vcard vcard_75935" ><a class="email " href="/user_profile?user_id=75935" > <span class="fna">RyanVM</span></a>
</div>
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag-1707928">in-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag-1707928-dirty">
      <select id="flag-1707928" name="flag-1707928"
        title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" selected>+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr>
          </tbody>
          <tbody class="edit-hide"><tr>
    <td class="flag-setter"><div class="vcard vcard_452604" ><a class="email disabled" href="/user_profile?user_id=452604" > <span class="fna">mwobensmith</span></a>
</div>
    </td>

    <td class="flag-name">
        <a href="#a4498997_452604"
            class="rel-time-title activity-ref"
            title="4 years ago"
        data-time="1520011865"
      >qe-verify</a>
    </td>

    <td class="flag-value">-
    </td>

  </tr>
          </tbody>
          <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter"><div class="vcard vcard_452604" ><a class="email disabled" href="/user_profile?user_id=452604" > <span class="fna">mwobensmith</span></a>
</div>
    </td>

    <td class="flag-name">
      <label title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually" for="flag-1724234">qe-verify</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag-1724234-dirty">
      <select id="flag-1724234" name="flag-1724234"
        title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually"
          disabled
        class="bug-flag">
            <option value="-" selected>-</option>
      </select>
    </td>


  </tr>
          </tbody>
    <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?" for="flag_type-930">behind-pref</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-930-dirty">
      <select id="flag_type-930" name="flag_type-930"
        title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?"
        class="bug-flag">
          <option value="X"></option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag tracking inclusion in the desktop Firefox product backlog." for="flag_type-846">firefox-backlog</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-846-dirty">
      <select id="flag_type-846" name="flag_type-846"
        title="Flag tracking inclusion in the desktop Firefox product backlog."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug." for="flag_type-803">sec-bounty</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-803-dirty">
      <select id="flag_type-803" name="flag_type-803"
        title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame." for="flag_type-913">sec-bounty-hof</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-913-dirty">
      <select id="flag_type-913" name="flag_type-913"
        title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-787">in-qa-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-787-dirty">
      <select id="flag_type-787" name="flag_type-787"
        title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>

      <td class="flag-requestee">
        <div id="requestee_type-787-container" style="display:none"><input
    name="requestee_type-787"
    value="" class="requestee bz_autocomplete_user"  id="requestee_type-787" 
  >
        </div>
      <td>

  </tr>
    </tbody>
  </table>
</div>
        </span>
    </div>

  
</div>
</div>

  
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-crash-data"
>
    <header id="module-crash-data-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Crash Data section"
           data-label-collapsed="Expand Crash Data section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-crash-data-content"
             aria-expanded="false"
             aria-labeledby="module-crash-data-title"
             aria-describedby="module-crash-data-subtitle"></div>
        <h2 class="module-title" id="module-crash-data-title">Crash Data</h2>
      </div>
    </header>
  <div class="module-content" id="module-crash-data-content" style="display:none"
  ><div class="field edit-show" id="field-cf_crash_signature" style="display:none"
>
    <div class="name">Signature:
    </div>


  
    <div class="value">
        <span id="field-value-cf_crash_signature">
        </span>
    </div>

  
</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-security"
>
    <header id="module-security-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Security section"
           data-label-collapsed="Expand Security section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-security-content"
             aria-expanded="false"
             aria-labeledby="module-security-title"
             aria-describedby="module-security-subtitle"></div>
        <h2 class="module-title" id="module-security-title">Security</h2>
          <h3 class="module-subtitle" id="module-security-subtitle">
            (public)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-security-content" style="display:none"
  ><div class="groups edit-hide">
    This bug is publicly visible.
</div>

<div class="groups edit-show" style="display:none">


</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-user-story" data-non-stick="1"
>
    <header id="module-user-story-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse User Story section"
           data-label-collapsed="Expand User Story section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-user-story-content"
             aria-expanded="false"
             aria-labeledby="module-user-story-title"
             aria-describedby="module-user-story-subtitle"></div>
        <h2 class="module-title" id="module-user-story-title">User Story</h2>
      </div>
    </header>
  <div class="module-content" id="module-user-story-content" style="display:none"
  >
    <pre id="user-story"></pre>
  </div>
</section>







<section class="module" id="module-attachments"
>
    <header id="module-attachments-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Attachments section"
           data-label-collapsed="Expand Attachments section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-attachments-content"
             aria-expanded="true"
             aria-labeledby="module-attachments-title"
             aria-describedby="module-attachments-subtitle"></div>
        <h2 class="module-title" id="module-attachments-title">Attachments</h2>
          <h3 class="module-subtitle" id="module-attachments-subtitle">
            (4 files, 3 obsolete files)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-attachments-content"
  ><table role="table" class="layout-table" id="attachments">
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8941091">javascript code for service worker. Use this to register a push notifications, then send consecutive requests to the endpoit</a>
        </div>
        <div>
            <a href="#c1" class="attach-time activity-ref"><span class="rel-time" title="2018-01-09 07:50 PST" data-time="1515513044">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_609555" ><a class="email " href="/user_profile?user_id=609555" > <span class="fna">Zohar</span></a>
</div></span>
        </div>
        <div class="attach-info">1.06 KB,
          text/plain        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8941091&amp;action=edit">Details</a>
    </tr>
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8941142">A short video clip demonstrating the issue</a>
        </div>
        <div>
            <a href="#c2" class="attach-time activity-ref"><span class="rel-time" title="2018-01-09 09:44 PST" data-time="1515519847">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_609555" ><a class="email " href="/user_profile?user_id=609555" > <span class="fna">Zohar</span></a>
</div></span>
        </div>
        <div class="attach-info">5.36 MB,
          video/mp4        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8941142&amp;action=edit">Details</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8942604">P1</a>
        </div>
        <div>
            <a href="#c21" class="attach-time activity-ref"><span class="rel-time" title="2018-01-15 00:55 PST" data-time="1516006547">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_552411" ><a class="email " href="/user_profile?user_id=552411" > <span class="fna">Tom Tung [:tt, :ttung]</span></a>
</div></span>
        </div>
        <div class="attach-info">2.11 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8942604&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8942604&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1429093&attachment=8942604">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8942605">P2</a>
        </div>
        <div>
            <a href="#c22" class="attach-time activity-ref"><span class="rel-time" title="2018-01-15 00:56 PST" data-time="1516006572">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_552411" ><a class="email " href="/user_profile?user_id=552411" > <span class="fna">Tom Tung [:tt, :ttung]</span></a>
</div></span>
        </div>
        <div class="attach-info">4.55 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8942605&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8942605&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1429093&attachment=8942605">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8943108">Bug 1429093 - P1: Only allow notification click to call allowWindowInteraction. r=bkelly</a>
        </div>
        <div>
            <a href="#c25" class="attach-time activity-ref"><span class="rel-time" title="2018-01-16 19:40 PST" data-time="1516160437">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_552411" ><a class="email " href="/user_profile?user_id=552411" > <span class="fna">Tom Tung [:tt, :ttung]</span></a>
</div></span>
        </div>
        <div class="attach-info">1.86 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_465500" ><span class="fn">bkelly</span>
</div>:
              <a href="#c28"
                  class="flag-name-status rel-time-title activity-ref"
                  title="4 years ago"
              data-time="1516160437"
            >
              review+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_451704" ><span class="fn">lizzard</span>
</div>:
              <a href="#c44"
                  class="flag-name-status rel-time-title activity-ref"
                  title="4 years ago"
              data-time="1516894852"
            >
              approval-mozilla-beta+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8943108&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8943108&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1429093&attachment=8943108">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8943109">Bug 1429093 - P2: A test to verify the close event is not allowed to window interaction. r=bkelly</a>
        </div>
        <div>
            <a href="#c26" class="attach-time activity-ref"><span class="rel-time" title="2018-01-16 19:41 PST" data-time="1516160505">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_552411" ><a class="email " href="/user_profile?user_id=552411" > <span class="fna">Tom Tung [:tt, :ttung]</span></a>
</div></span>
        </div>
        <div class="attach-info">3.35 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_465500" ><span class="fn">bkelly</span>
</div>:
              <a href="#c29"
                  class="flag-name-status rel-time-title activity-ref"
                  title="4 years ago"
              data-time="1516160505"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8943109&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8943109&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1429093&attachment=8943109">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8944821">P2: A test to verify the close event is not allowed to window interaction. r=bkelly</a>
        </div>
        <div>
            <a href="#c36" class="attach-time activity-ref"><span class="rel-time" title="2018-01-23 11:13 PST" data-time="1516734784">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_465500" ><a class="email " href="/user_profile?user_id=465500" > <span class="fna">Ben Kelly [:bkelly, not reviewing]</span></a>
</div></span>
        </div>
        <div class="attach-info">3.81 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_465500" ><span class="fn">bkelly</span>
</div>:
              <a href="#a1381799_465500"
                  class="flag-name-status rel-time-title activity-ref"
                  title="4 years ago"
              data-time="1516894667"
            >
              review+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_451704" ><span class="fn">lizzard</span>
</div>:
              <a href="#a1910900_451704"
                  class="flag-name-status rel-time-title activity-ref"
                  title="4 years ago"
              data-time="1516894874"
            >
              approval-mozilla-beta+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8944821&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8944821&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1429093&attachment=8944821">Splinter Review</a>
    </tr>
</table>

<footer id="attachments-footer">
  <div id="attachments-actions">
      <button type="button" id="attachments-obsolete-btn" class="secondary">Show Obsolete</button>
  </div>
  
</footer>
  </div>
</section>



<script nonce="0pjeA7N4JqWJZYJWZd1NedORUyya4obKmNrLaGhRKtwkL3Vc">
  init_module_visibility();
</script>



<meta name="firefox-versions" content="{&quot;FIREFOX_AURORA&quot;:&quot;&quot;,&quot;FIREFOX_DEVEDITION&quot;:&quot;94.0b9&quot;,&quot;FIREFOX_ESR&quot;:&quot;78.15.0esr&quot;,&quot;FIREFOX_ESR_NEXT&quot;:&quot;91.2.0esr&quot;,&quot;FIREFOX_NIGHTLY&quot;:&quot;95.0a1&quot;,&quot;FIREFOX_PINEBUILD&quot;:&quot;&quot;,&quot;LAST_MERGE_DATE&quot;:&quot;2021-10-04&quot;,&quot;LAST_RELEASE_DATE&quot;:&quot;2021-10-05&quot;,&quot;LAST_SOFTFREEZE_DATE&quot;:&quot;2021-09-30&quot;,&quot;LATEST_FIREFOX_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_OLDER_VERSION&quot;:&quot;3.6.28&quot;,&quot;LATEST_FIREFOX_RELEASED_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_VERSION&quot;:&quot;93.0&quot;,&quot;NEXT_MERGE_DATE&quot;:&quot;2021-11-01&quot;,&quot;NEXT_RELEASE_DATE&quot;:&quot;2021-11-02&quot;,&quot;NEXT_SOFTFREEZE_DATE&quot;:&quot;2021-10-28&quot;}">


<div id="comment-actions">
    <button type="button" id="bottom-btn" class="secondary" aria-label="Go to Page Bottom">Bottom &darr;</button>
  <div class="dropdown">
    <button type="button" id="comment-tags-btn" aria-haspopup="true" aria-label="Tags"
      aria-expanded="false" aria-controls="comment-tags-menu" class="dropdown-button minor">Tags &#9662;</button>
    <ul id="comment-tags-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a role="menuitem" tabindex="-1" data-comment-tag="">Reset</a>
      </li>
    </ul>
  </div>
  <div class="dropdown">
    <button type="button" id="view-menu-btn" aria-haspopup="true" aria-label="Timeline"
      aria-expanded="false" aria-controls="view-menu" class="dropdown-button minor">Timeline &#9662;</button>
    <ul id="view-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a id="view-reset" role="menuitem" tabindex="-1">Reset</a>
      </li>
      <li role="separator"></li>
      <li role="presentation">
        <a id="view-collapse-all" role="menuitem" tabindex="-1">Collapse All</a>
      </li>
      <li role="presentation">
        <a id="view-expand-all" role="menuitem" tabindex="-1">Expand All</a>
      </li>
      <li role="presentation">
        <a id="view-comments-only" role="menuitem" tabindex="-1">Comments Only</a>
      </li>
    </ul>
   </div>
</div>
<div class="change-set" id="c0"><div class="comment" data-id="12955088" data-no="0"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-0" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_609555" ><img src="https://secure.gravatar.com/avatar/f9449e8de5f17bda351cec34a13ec417?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_609555" ><a class="email " href="/user_profile?user_id=609555" > <span class="fna">Zohar</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-0"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-0" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#c0">Description</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-09 07:47 PST" data-time="1515512868">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-0">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-0" data-comment-id="12955088">User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.84 Safari/537.36

Steps to reproduce:

I've created an application that uses the notification Push API. In the service worker JS. I've created a listener for the 'NotificationClose' event, which launches a DOM interaction (opens a new tab on browser).

Then, I've registered to the application with Firefox (allowing it to send me push notification). 

Finally, I've sent few consecutive push notifications to the endpoint in a short time (for example 5 notification in 4 seconds).

Example code fro service worker is attached. 


Actual results:

When sending few consecutive notifications, I was able to invoke the 'notification close' event without user interaction. Furthermore, each notification launched a new Tab (invoking a DOM event). 

In essence:
1) If the browser was opened, I was able to remotely open an arbitrary amount of tabs on the browser without user interaction.

2) If the browser was closed, all the tabs open upon next launch.

This behavior puts the user in risk:

1) Adware: If the user once allowed a malicious application to send notification, now the ad providers can launch as many ads as they choose without the user interaction.

2) Persistence for attackers: if once I was able to get a user to register to my app, I can now redirect him to  malicious link (for example containing CSRF or XSS) whenever I choose (for example I will send the user to a CSRF link again and again without his interaction, until he has a valid session with the target application).

3) Client side denial of service: I can launch infinite numbers of tabs every time the user opens the browser, effectively rendering the browser unusable. 

It is important to stress that the user cannot stop the attack once the notifications were allowed, I.e. he cannot prevent the attacker from opening a tab on his browser


Expected results:

Events (such as 'close notification') should require user interaction. Furthermore:
1. close / push events should not allowed DOM interaction (opening a tab, for example). note that this is enforced in Chrome. 

2. DOM intercations should be limited to 'one at a time', and not queued without restriction.</pre></div><div class="change-set" id="c1"><div class="comment" data-id="12955098" data-no="1"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-1" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_609555" ><img src="https://secure.gravatar.com/avatar/f9449e8de5f17bda351cec34a13ec417?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_609555" ><a class="email " href="/user_profile?user_id=609555" > <span class="fna">Zohar</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-1"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-1" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#c1">Comment 1</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-09 07:50 PST" data-time="1515513044">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-1">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8941091"
         class="attachment"
         data-id="8941091" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="sw2.js.text">
      <meta itemprop="contentSize" content="1082">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=8941091" itemprop="contentUrl">
        <span id="att-8941091-description" itemprop="description">javascript code for service worker. Use this to register a push notifications, then send consecutive requests to the endpoit</span></a>
        — <a href="attachment.cgi?id=8941091&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div></div><div class="change-set" id="c2"><div class="comment" data-id="12955495" data-no="2"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-2" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_609555" ><img src="https://secure.gravatar.com/avatar/f9449e8de5f17bda351cec34a13ec417?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_609555" ><a class="email " href="/user_profile?user_id=609555" > <span class="fna">Zohar</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-2"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-2" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#c2">Comment 2</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-09 09:44 PST" data-time="1515519847">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-2">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8941142"
         class="attachment"
         data-id="8941142" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="edited.mp4">
      <meta itemprop="contentSize" content="5616272">
      <meta itemprop="encodingFormat" content="video/mp4">
      <div class="label">
        Attached video
          <a class="link" href="attachment.cgi?id=8941142" itemprop="contentUrl">
        <span id="att-8941142-description" itemprop="description">A short video clip demonstrating the issue</span></a>
        — <a href="attachment.cgi?id=8941142&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-2" data-comment-id="12955495">the issue is demonstrated both when the browser is opened, and closed. The notifications are sent via fiddler (standard web proxy) and you can see the firefox tabs open in the background. Hope that makes the issue more clear :)</pre></div><div class="change-set" id="a9014_406194"><div class="change" id="aa9014_406194">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_406194" id="a9014_406194"><img src="https://secure.gravatar.com/avatar/0a70c84cd33dba0151fe15f2f8773137?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_406194" id="a9014_406194"><a class="email " href="/user_profile?user_id=406194" > <span class="fna">Andrew McCreight [:mccr8]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a9014_406194"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a9014_406194">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#a9014_406194">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-09 10:18 PST" data-time="1515521882">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: firefox-core-security &rarr; dom-core-security</div><div class="change">Component: Untriaged &rarr; DOM: Service Workers</div><div class="change">Product: Firefox &rarr; Core</div></div></div><div class="change-set" id="c3"><div class="comment" data-id="12955626" data-no="3"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-3" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_465500" id="a9014_406194"><img src="https://secure.gravatar.com/avatar/bc5e85dbd8d5c9b11c419c65ee4081b5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_465500" id="a9014_406194"><a class="email " href="/user_profile?user_id=465500" > <span class="fna">Ben Kelly [:bkelly, not reviewing]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-3"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-3" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#c3">Comment 3</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-09 10:26 PST" data-time="1515522403">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-3">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-3" data-comment-id="12955626">The issue is that we &quot;allow window interaction&quot; for any kind of notification event.  We need to restrict this notification clicks.

<a rel="nofollow" href="https://searchfox.org/mozilla-central/rev/cf149b7b63ff97023e28723167725e38cf5df757/dom/workers/ServiceWorkerPrivate.cpp#1255">https://searchfox.org/mozilla-central/rev/cf149b7b63ff97023e28723167725e38cf5df757/dom/workers/ServiceWorkerPrivate.cpp#1255</a>

We can add a check like this at the above call site:

<a rel="nofollow" href="https://searchfox.org/mozilla-central/rev/cf149b7b63ff97023e28723167725e38cf5df757/dom/workers/ServiceWorkerPrivate.cpp#1288">https://searchfox.org/mozilla-central/rev/cf149b7b63ff97023e28723167725e38cf5df757/dom/workers/ServiceWorkerPrivate.cpp#1288</a>

Tom, do you have any time to look at this?</pre><div class="activity"><div class="change">Flags: needinfo?(ttung)</div></div></div><div class="change-set" id="c4"><div class="comment" data-id="12956737" data-no="4"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-4" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_552411" id="a9014_406194"><img src="https://secure.gravatar.com/avatar/08b5f16b66786915fef5524c528fdb49?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_552411" id="a9014_406194"><a class="email " href="/user_profile?user_id=552411" > <span class="fna">Tom Tung [:tt, :ttung]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-4"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-4" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#c4">Comment 4</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-09 17:20 PST" data-time="1515547229">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-4">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-4" data-comment-id="12956737">Sure</pre><div class="activity"><div class="change">Assignee: nobody &rarr; ttung</div><div class="change">Status: UNCONFIRMED &rarr; ASSIGNED</div><div class="change">Ever confirmed: true</div><div class="change">Flags: <span class="activity-deleted">needinfo?(ttung)</span></div></div></div><div class="change-set" id="c5"><div class="comment" data-id="12956986" data-no="5"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-5" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_552411" id="a9014_406194"><img src="https://secure.gravatar.com/avatar/08b5f16b66786915fef5524c528fdb49?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_552411" id="a9014_406194"><a class="email " href="/user_profile?user_id=552411" > <span class="fna">Tom Tung [:tt, :ttung]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-5"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-5" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#c5">Comment 5</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-09 20:02 PST" data-time="1515556952">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-5">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-5" data-comment-id="12956986">(In reply to Zohar from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Push API allows DOM event without user interaction"
   href="/show_bug.cgi?id=1429093#c2">comment #2</a>)
<span class="quote">&gt; Created <span class=""><a href="/attachment.cgi?id=8941142" name="attach_8941142" title="A short video clip demonstrating the issue">attachment 8941142</a> <a href="/attachment.cgi?id=8941142&amp;action=edit" title="A short video clip demonstrating the issue">[details]</a></span>
&gt; A short video clip demonstrating the issue
&gt; 
&gt; the issue is demonstrated both when the browser is opened, and closed. The
&gt; notifications are sent via fiddler (standard web proxy) and you can see the
&gt; firefox tabs open in the background. Hope that makes the issue more clear :)</span >

Thanks for reporting the issue and providing the STR &amp; video! That does make the issue more clear.</pre></div><div class="change-set" id="c6"><div class="comment" data-id="12957050" data-no="6"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-6" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_609555" id="a9014_406194"><img src="https://secure.gravatar.com/avatar/f9449e8de5f17bda351cec34a13ec417?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_609555" id="a9014_406194"><a class="email " href="/user_profile?user_id=609555" > <span class="fna">Zohar</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-6"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-6" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#c6">Comment 6</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-09 21:08 PST" data-time="1515560905">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-6">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-6" data-comment-id="12957050">(In reply to Tom Tung [:tt] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Push API allows DOM event without user interaction"
   href="/show_bug.cgi?id=1429093#c5">comment #5</a>)
<span class="quote">&gt; (In reply to Zohar from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Push API allows DOM event without user interaction"
   href="/show_bug.cgi?id=1429093#c2">comment #2</a>)
&gt; &gt; Created <span class=""><a href="/attachment.cgi?id=8941142" name="attach_8941142" title="A short video clip demonstrating the issue">attachment 8941142</a> <a href="/attachment.cgi?id=8941142&amp;action=edit" title="A short video clip demonstrating the issue">[details]</a></span>
&gt; &gt; A short video clip demonstrating the issue
&gt; &gt; 
&gt; &gt; the issue is demonstrated both when the browser is opened, and closed. The
&gt; &gt; notifications are sent via fiddler (standard web proxy) and you can see the
&gt; &gt; firefox tabs open in the background. Hope that makes the issue more clear :)
&gt; 
&gt; Thanks for reporting the issue and providing the STR &amp; video! That does make
&gt; the issue more clear.</span >

My pleasure, 
if there are any questions or clarifications needed please feel free to ask. 

Cheers, 
Zohar</pre></div><div class="change-set" id="c7"><div class="comment" data-id="12960582" data-no="7"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-7" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_552411" id="a9014_406194"><img src="https://secure.gravatar.com/avatar/08b5f16b66786915fef5524c528fdb49?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_552411" id="a9014_406194"><a class="email " href="/user_profile?user_id=552411" > <span class="fna">Tom Tung [:tt, :ttung]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-7"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-7" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#c7">Comment 7</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-11 00:56 PST" data-time="1515661012">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-7">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-7" data-comment-id="12960582">Ben, I collect the things I understand so far and present them below. Could you correct me if I put anything wrong? And maybe give me some feedback? Thanks!

IIUC, we are going to disallow client.openWindow() on &quot;notificationclose&quot; event, but keep allowing it work on &quot;notificationonclick&quot; event. 

After skimming the code, I found there are two places to increase the counter for WindowInteraction. One is in the WorkerRun [1] while the other is inside the AllowWindowInteractionHandler [2]. And the code for consuming the counter [3] (opposite to [1]) and [4] (opposite to [2]).

I guess [1, 3] cover all the microtasks in the event listener. But I'm not sure about whether should we ensure client.openWindow() in another task. And [2] covers even more.  
For example, in the following case:
  onnotificationclick = function(event) {
    setTimeout(client.openWindow(&quot;foo.com&quot;), 0);          // Place A
    Promise.resolve().then(client.openWindow(&quot;foo.com&quot;)); // Place B
    client.openWindow(&quot;foo.com&quot;);                         // Place C
    notfication.close();         
  }
  
  onnotificationclose = function(event) {
    client.openWindow(&quot;foo.com&quot;);                         // Place D 
  }

The order of executing client.openWindow is: 
  click's [1] -&gt; click 's [2] -&gt; C -&gt; B  -&gt; A -&gt; click's [3] -&gt; close's [1] -&gt; close's [2] -&gt; D -&gt; close's [3] -&gt; close's [4] -&gt; click's [4]

I think, ideally, we should resolve the promise at Place A, B, and C, but reject the promise at Place D. However, I'm sure whether shall we allow the window interaction in other tasks (e.g. set a timeout too long to make user realize the opening window is triggered by the notification click event).

If we shouldn't, then the solution would be as your suggestion in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Push API allows DOM event without user interaction"
   href="/show_bug.cgi?id=1429093#c3">comment #3</a> which is adding if-statement on [1, 3]. Besides, we might consider removing [2, 4].

[1] <a rel="nofollow" href="https://searchfox.org/mozilla-central/rev/03877052c151a8f062eea177f684a2743cd7b1d5/dom/workers/ServiceWorkerPrivate.cpp#1117">https://searchfox.org/mozilla-central/rev/03877052c151a8f062eea177f684a2743cd7b1d5/dom/workers/ServiceWorkerPrivate.cpp#1117</a>
[2] <a rel="nofollow" href="https://searchfox.org/mozilla-central/rev/cf149b7b63ff97023e28723167725e38cf5df757/dom/workers/ServiceWorkerPrivate.cpp#1255">https://searchfox.org/mozilla-central/rev/cf149b7b63ff97023e28723167725e38cf5df757/dom/workers/ServiceWorkerPrivate.cpp#1255</a>
[3] <a rel="nofollow" href="https://searchfox.org/mozilla-central/rev/03877052c151a8f062eea177f684a2743cd7b1d5/dom/workers/ServiceWorkerPrivate.cpp#1267">https://searchfox.org/mozilla-central/rev/03877052c151a8f062eea177f684a2743cd7b1d5/dom/workers/ServiceWorkerPrivate.cpp#1267</a>
[4] <a rel="nofollow" href="https://searchfox.org/mozilla-central/rev/03877052c151a8f062eea177f684a2743cd7b1d5/dom/workers/ServiceWorkerPrivate.cpp#1093">https://searchfox.org/mozilla-central/rev/03877052c151a8f062eea177f684a2743cd7b1d5/dom/workers/ServiceWorkerPrivate.cpp#1093</a></pre><div class="activity"><div class="change">Flags: needinfo?(bkelly)</div></div></div><div class="change-set" id="c8"><div class="comment" data-id="12960589" data-no="8"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-8" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_552411" id="a9014_406194"><img src="https://secure.gravatar.com/avatar/08b5f16b66786915fef5524c528fdb49?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_552411" id="a9014_406194"><a class="email " href="/user_profile?user_id=552411" > <span class="fna">Tom Tung [:tt, :ttung]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-8"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-8" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#c8">Comment 8</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-11 00:58 PST" data-time="1515661115">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-8">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-8" data-comment-id="12960589">BTW, chromium seems to only allow window interaction only when the event is notificationclick or payment:

<a rel="nofollow" href="https://cs.chromium.org/chromium/src/third_party/WebKit/Source/modules/serviceworkers/WaitUntilObserver.cpp?l=120-121">https://cs.chromium.org/chromium/src/third_party/WebKit/Source/modules/serviceworkers/WaitUntilObserver.cpp?l=120-121</a></pre></div><div class="change-set" id="c9"><div class="comment" data-id="12961261" data-no="9"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-9" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_465500" id="a9014_406194"><img src="https://secure.gravatar.com/avatar/bc5e85dbd8d5c9b11c419c65ee4081b5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_465500" id="a9014_406194"><a class="email " href="/user_profile?user_id=465500" > <span class="fna">Ben Kelly [:bkelly, not reviewing]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-9"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-9" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#c9">Comment 9</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-11 06:29 PST" data-time="1515680982">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-9">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-9" data-comment-id="12961261">Right, I think we want to look for the notificationclick event type string and only do the logic then.

I don't think you would do the check in StartClearWindowTimer(), though.  I think instead it would be better to not create the AllowWindowInteractionHandler() at all.

Whether to remove the extra Allow/Consume calls might be a bit orthogonal.  You could try to remove them, but if its easier we could also just make them all respect the event name check.

Something like:

  bool allowInteraction = mEventName == NAME;

  RefPtr&lt;AllowWindowInteractionHandler&gt; allowWindowInteraction
  if (allowInteraction) {
    aWorkerPrivate-&gt;GlobalScope()-&gt;AllowWindowInteraction();
    allowWindowInteraction = new AllowWindowInteractionHandler(aWorkerPrivate);
  }

  nsresult rv = DispatchExtendableEventOnWorkerScope(aCx,
                                                     aWorkerPrivate-&gt;GlobalScope(),
                                                     event,
                                                     allowWindowInteraction);

  /* ... */

  if (allowInteraction) {
    aWorkerPrivate-&gt;GlobalScope()-&gt;ConsumeWindowInteraction();
  }

Does that help?</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(bkelly)</span></div></div></div><div class="change-set" id="a182659_1689"><div class="change" id="aa182659_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a182659_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a182659_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a182659_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a182659_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#a182659_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-11 10:32 PST" data-time="1515695527">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Keywords: <a href="/buglist.cgi?keywords=csectype-dos&amp;resolution=---">csectype-dos</a>, 
          
            <a href="/buglist.cgi?keywords=sec-low&amp;resolution=---">sec-low</a></div></div></div><div class="change-set" id="c10"><div class="comment" data-id="12963043" data-no="10"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-10" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_552411" id="a182659_1689"><img src="https://secure.gravatar.com/avatar/08b5f16b66786915fef5524c528fdb49?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_552411" id="a182659_1689"><a class="email " href="/user_profile?user_id=552411" > <span class="fna">Tom Tung [:tt, :ttung]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-10"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-10" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#c10">Comment 10</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-11 16:57 PST" data-time="1515718666">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-10">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-10" data-comment-id="12963043">(In reply to Ben Kelly [:bkelly] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Push API allows DOM event without user interaction"
   href="/show_bug.cgi?id=1429093#c9">comment #9</a>)
<span class="quote">&gt; I don't think you would do the check in StartClearWindowTimer(), though.  I
&gt; think instead it would be better to not create the
&gt; AllowWindowInteractionHandler() at all.</span >

Yeah, we shouldn't create AllowWindowInteractionHandler for the notificationclose event if we don't want it to allow window interaction. That makes sense.

<span class="quote">&gt; Whether to remove the extra Allow/Consume calls might be a bit orthogonal. 
&gt; You could try to remove them, but if its easier we could also just make them
&gt; all respect the event name check.
&gt; 
&gt; Something like:
&gt; 
&gt;   bool allowInteraction = mEventName == NAME;
&gt; 
&gt;   RefPtr&lt;AllowWindowInteractionHandler&gt; allowWindowInteraction
&gt;   if (allowInteraction) {
&gt;     aWorkerPrivate-&gt;GlobalScope()-&gt;AllowWindowInteraction();
&gt;     allowWindowInteraction = new
&gt; AllowWindowInteractionHandler(aWorkerPrivate);
&gt;   }
&gt; 
&gt;   nsresult rv = DispatchExtendableEventOnWorkerScope(aCx,
&gt;                                                     
&gt; aWorkerPrivate-&gt;GlobalScope(),
&gt;                                                      event,
&gt;                                                      allowWindowInteraction);
&gt; 
&gt;   /* ... */
&gt; 
&gt;   if (allowInteraction) {
&gt;     aWorkerPrivate-&gt;GlobalScope()-&gt;ConsumeWindowInteraction();
&gt;   }</span >

But it might allow clients to open window even in the notificationclose event when that event is triggered by a notificationclick event.
For example, just like the example in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Push API allows DOM event without user interaction"
   href="/show_bug.cgi?id=1429093#c7">comment 7</a>:

onnotificationclick = function(event) {
    notfication.close();
}
onnotificationclose = function(event) {
    client.openWindow(&quot;foo.com&quot;);                
}

In this example, the window will open. Do we allow that? I was thinking that we don't, but I'm not sure about it.

If we do, then I believe I don't need to remove the allow/consume pair in the AllowWindowInteractionHandler. If not, then we probably want to remove that pair.</pre></div><div class="change-set" id="c11"><div class="comment" data-id="12963071" data-no="11"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-11" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_465500" id="a182659_1689"><img src="https://secure.gravatar.com/avatar/bc5e85dbd8d5c9b11c419c65ee4081b5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_465500" id="a182659_1689"><a class="email " href="/user_profile?user_id=465500" > <span class="fna">Ben Kelly [:bkelly, not reviewing]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-11"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-11" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#c11">Comment 11</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-11 17:01 PST" data-time="1515718918">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-11">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-11" data-comment-id="12963071">The allow interaction is timer based.  It should be permitted from other async callbacks if it's within the time window.

I think the extra calls around the dispatch might just support calling openWindow synchronously in a long running event handler.</pre></div><div class="change-set" id="c12"><div class="comment" data-id="12963076" data-no="12"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-12" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_552411" id="a182659_1689"><img src="https://secure.gravatar.com/avatar/08b5f16b66786915fef5524c528fdb49?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_552411" id="a182659_1689"><a class="email " href="/user_profile?user_id=552411" > <span class="fna">Tom Tung [:tt, :ttung]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-12"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-12" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#c12">Comment 12</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-11 17:10 PST" data-time="1515719441">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-12">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-12" data-comment-id="12963076">(In reply to Ben Kelly [:bkelly] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Push API allows DOM event without user interaction"
   href="/show_bug.cgi?id=1429093#c11">comment #11</a>)
<span class="quote">&gt; The allow interaction is timer based.  It should be permitted from other
&gt; async callbacks if it's within the time window.
&gt; 
&gt; I think the extra calls around the dispatch might just support calling
&gt; openWindow synchronously in a long running event handler.</span >

Oh, I see. So, in this case, the window can be opened is because of the timer hasn't expired rather than triggered by the click event. And we do allow this happen.

Thanks for clearing my confusion!</pre></div><div class="change-set" id="c13"><div class="comment" data-id="12963081" data-no="13"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-13" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_465500" id="a182659_1689"><img src="https://secure.gravatar.com/avatar/bc5e85dbd8d5c9b11c419c65ee4081b5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_465500" id="a182659_1689"><a class="email " href="/user_profile?user_id=465500" > <span class="fna">Ben Kelly [:bkelly, not reviewing]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-13"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-13" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#c13">Comment 13</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-11 17:20 PST" data-time="1515720051">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-13">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-13" data-comment-id="12963081">Well, we start the timer right before firing the event handler.  We should only do that for the click event and not the other events.</pre></div><div class="change-set" id="c14"><div class="comment" data-id="12963095" data-no="14"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-14" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_552411" id="a182659_1689"><img src="https://secure.gravatar.com/avatar/08b5f16b66786915fef5524c528fdb49?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_552411" id="a182659_1689"><a class="email " href="/user_profile?user_id=552411" > <span class="fna">Tom Tung [:tt, :ttung]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-14"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-14" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#c14">Comment 14</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-11 17:33 PST" data-time="1515720796">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-14">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-14" data-comment-id="12963095">(In reply to Ben Kelly [:bkelly] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Push API allows DOM event without user interaction"
   href="/show_bug.cgi?id=1429093#c13">comment #13</a>)
<span class="quote">&gt; Well, we start the timer right before firing the event handler.  We should
&gt; only do that for the click event and not the other events.</span >

Hmm, then I dive into the code a bit more because it seems that we clear the window allow after running into handler for the close event in this case. 

Sorry for misreading your comment :(</pre></div><div class="change-set" id="c15"><div class="comment" data-id="12963125" data-no="15"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-15" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_465500" id="a182659_1689"><img src="https://secure.gravatar.com/avatar/bc5e85dbd8d5c9b11c419c65ee4081b5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_465500" id="a182659_1689"><a class="email " href="/user_profile?user_id=465500" > <span class="fna">Ben Kelly [:bkelly, not reviewing]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-15"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-15" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#c15">Comment 15</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-11 18:01 PST" data-time="1515722515">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-15">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-15" data-comment-id="12963125">The timer is started as a side effect of creating the AllowWindowInteractionHandler():

<a rel="nofollow" href="https://searchfox.org/mozilla-central/rev/88439dc6c5b02e167032374071cdc697a056efa1/dom/workers/ServiceWorkerPrivate.cpp#1168">https://searchfox.org/mozilla-central/rev/88439dc6c5b02e167032374071cdc697a056efa1/dom/workers/ServiceWorkerPrivate.cpp#1168</a>

We create the AllowWindowInteractionHandler() right before dispatching the event:

<a rel="nofollow" href="https://searchfox.org/mozilla-central/rev/88439dc6c5b02e167032374071cdc697a056efa1/dom/workers/ServiceWorkerPrivate.cpp#1258">https://searchfox.org/mozilla-central/rev/88439dc6c5b02e167032374071cdc697a056efa1/dom/workers/ServiceWorkerPrivate.cpp#1258</a>

Right now we do that before all notification events, but the bug here is to only do it before notificationclick events.

Looking at the code now, though, it seems we cancel the timer and call ConsumeWindowInteraction() when the function event's waitUntil() completes:

<a rel="nofollow" href="https://searchfox.org/mozilla-central/rev/88439dc6c5b02e167032374071cdc697a056efa1/dom/workers/ServiceWorkerPrivate.cpp#1117">https://searchfox.org/mozilla-central/rev/88439dc6c5b02e167032374071cdc697a056efa1/dom/workers/ServiceWorkerPrivate.cpp#1117</a>
<a rel="nofollow" href="https://searchfox.org/mozilla-central/rev/88439dc6c5b02e167032374071cdc697a056efa1/dom/workers/ServiceWorkerPrivate.cpp#1093">https://searchfox.org/mozilla-central/rev/88439dc6c5b02e167032374071cdc697a056efa1/dom/workers/ServiceWorkerPrivate.cpp#1093</a>

So I think maybe I was confused.  We want to allow async code to call clients.openWindow() until the notificationevent's waitUntil() promise resolves.

Sorry for my confusion here.  This code is a bit hard to follow.

So I think you are mostly right about <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Push API allows DOM event without user interaction"
   href="/show_bug.cgi?id=1429093#c7">comment 7</a>, but you probably need to include a waitUntil() that covers A, B, and C.

Assuming notification.close() does not fire the notificationclose event synchronously (I don't think it should), then D should reject as you suggest.

I still think <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Push API allows DOM event without user interaction"
   href="/show_bug.cgi?id=1429093#c9">comment 9</a> changes probably achieve this, but clearly this code could use some cleanup.  Not sure if we want to do that here or in a follow-up that is not marked private.

Does that help at all or confuse things further?  Thanks again for looking at this.</pre></div><div class="change-set" id="c16"><div class="comment" data-id="12963484" data-no="16"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-16" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_609555" id="a182659_1689"><img src="https://secure.gravatar.com/avatar/f9449e8de5f17bda351cec34a13ec417?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_609555" id="a182659_1689"><a class="email " href="/user_profile?user_id=609555" > <span class="fna">Zohar</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-16"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-16" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#c16">Comment 16</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-11 23:35 PST" data-time="1515742520">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-16">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-16" data-comment-id="12963484">Hey guys, 
I just want to add my opinion as a security researcher, 
I think  the potential impact of this bug is quite severe (I saw you marked the bug as a 'low risk' security event)

The situation is that I, the attacker, can cause a victim to visit any link I choose, whenever I choose, and as many times as I choose.

So any reflected cross site scripting I detect in any website - I can make sure the user is impacted:
1) I detect a reflected XSS in website A
2) I create a link the exploits the XSS
3) I send the link to the user inside a notification (for example as the notification data), and force the user to visit the link
using the 'close' event.
4) I monitor the exploitation from my CNC server:
  a. If the user had a session with website A when he visited it, I win (as i get to execute my javascript in the context of website A domain). 
  b IF the user did not have a logged in session, I simply wait some time and fire the attack again. 

This is obviously a very simple example. The same can be used to exploit many other vulnerabilities (CSRF, Phishing, adware, Exploit kits, etc.). 

The point is that having the ability to force a client to visit any website of my choosing again and again is a very strong asset to the attacker and puts the client in quite a serious risk. 

So, please consider giving the issue a higher security rating.

Thanks</pre></div><div class="change-set" id="c17"><div class="comment" data-id="12964062" data-no="17"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-17" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_552411" id="a182659_1689"><img src="https://secure.gravatar.com/avatar/08b5f16b66786915fef5524c528fdb49?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_552411" id="a182659_1689"><a class="email " href="/user_profile?user_id=552411" > <span class="fna">Tom Tung [:tt, :ttung]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-17"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-17" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#c17">Comment 17</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-12 02:22 PST" data-time="1515752548">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-17">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-17" data-comment-id="12964062">(In reply to Ben Kelly [:bkelly] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Push API allows DOM event without user interaction"
   href="/show_bug.cgi?id=1429093#c15">comment #15</a>)
<span class="quote">&gt; So I think you are mostly right about <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Push API allows DOM event without user interaction"
   href="/show_bug.cgi?id=1429093#c7">comment 7</a>, but you probably need to
&gt; include a waitUntil() that covers A, B, and C.
&gt; 
&gt; Assuming notification.close() does not fire the notificationclose event
&gt; synchronously (I don't think it should), then D should reject as you suggest.
&gt; 
&gt; I still think <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Push API allows DOM event without user interaction"
   href="/show_bug.cgi?id=1429093#c9">comment 9</a> changes probably achieve this, but clearly this code
&gt; could use some cleanup.  Not sure if we want to do that here or in a
&gt; follow-up that is not marked private.</span >

That makes sense to me. Thanks for elaborating on it! 
For correction, if I apply the <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Push API allows DOM event without user interaction"
   href="/show_bug.cgi?id=1429093#c9">comment 9</a>:
onnotificationclick = function(event) {
    event.notfication.close();
}
onnotificationclose = function(event) {
    client.openWindow(&quot;foo.com&quot;);      // the window won't be opened           
}

I guess what I get stuck is that I accidently found a strage way to open window in the close evnet after applying <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Push API allows DOM event without user interaction"
   href="/show_bug.cgi?id=1429093#c9">comment 9</a>. 
For example, if I specify to close the notification in the existing test [1] just above the waitUntil:
onnotificationclick = function(e) {
    ...

    e.notfication.close();
    e.waitUntil(Promise.All(promises).then(() =&gt; client.postMessage(results)));
}
onnotificationclose = function(event) {
    client.openWindow(&quot;foo.com&quot;);                
}

Then, I found the window is still opened even after I do the check as your <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Push API allows DOM event without user interaction"
   href="/show_bug.cgi?id=1429093#c9">comment 9</a>. 

I guess maybe it's an another issue for waitUtil(f) while the &quot;f&quot; takes tons of time? I'll investigate more about this.

[1] <a rel="nofollow" href="https://searchfox.org/mozilla-central/source/dom/workers/test/serviceworkers/openWindow_worker.js#111">https://searchfox.org/mozilla-central/source/dom/workers/test/serviceworkers/openWindow_worker.js#111</a></pre></div><div class="change-set" id="c18"><div class="comment" data-id="12964676" data-no="18"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-18" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_465500" id="a182659_1689"><img src="https://secure.gravatar.com/avatar/bc5e85dbd8d5c9b11c419c65ee4081b5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_465500" id="a182659_1689"><a class="email " href="/user_profile?user_id=465500" > <span class="fna">Ben Kelly [:bkelly, not reviewing]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-18"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-18" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#c18">Comment 18</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-12 07:01 PST" data-time="1515769297">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-18">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-18" data-comment-id="12964676">Well, if the notificationclose event handler is fired before the waitUntil promises resolve, then in theory it should be allowed to open the window.  But this only really matters if the notificationclick did not open a window.  If the click opened a window then it should have consumed the interaction.

The important thing is we only allow one additional &quot;open a window&quot; token per click dispatch.

If you try to open a window in both click and close, do you get two windows?

(Maybe this does argue for trying to remove any extraneous AllowWindowInteraction() calls as that might allow two windows to be synchronously opened in the click handler.)</pre></div><div class="change-set" id="c19"><div class="comment" data-id="12964678" data-no="19"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-19" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_465500" id="a182659_1689"><img src="https://secure.gravatar.com/avatar/bc5e85dbd8d5c9b11c419c65ee4081b5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_465500" id="a182659_1689"><a class="email " href="/user_profile?user_id=465500" > <span class="fna">Ben Kelly [:bkelly, not reviewing]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-19"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-19" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#c19">Comment 19</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-12 07:02 PST" data-time="1515769335">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-19">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-19" data-comment-id="12964678">Daniel, please see <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Push API allows DOM event without user interaction"
   href="/show_bug.cgi?id=1429093#c16">comment 16</a> about possible impact.</pre><div class="activity"><div class="change">Flags: needinfo?(dveditz)</div></div></div><div class="change-set" id="c20"><div class="comment" data-id="12969351" data-no="20"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-20" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_552411" id="a182659_1689"><img src="https://secure.gravatar.com/avatar/08b5f16b66786915fef5524c528fdb49?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_552411" id="a182659_1689"><a class="email " href="/user_profile?user_id=552411" > <span class="fna">Tom Tung [:tt, :ttung]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-20"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-20" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#c20">Comment 20</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-14 22:42 PST" data-time="1515998552">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-20">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-20" data-comment-id="12969351">(In reply to Ben Kelly [:bkelly] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Push API allows DOM event without user interaction"
   href="/show_bug.cgi?id=1429093#c18">comment #18</a>)
I'm afraid I might misunderstand something. I put them as follows:

<span class="quote">&gt; Well, if the notificationclose event handler is fired before the waitUntil
&gt; promises resolve, then in theory it should be allowed to open the window. </span >

Yeah, it looks like the close event is fired before the promises in waitUntil() is resolved.

<span class="quote">&gt; But this only really matters if the notificationclick did not open a window.</span >

Because the close event is fired before the promise in waitUntil() is resolved, we can make client's window be opened even if the click event doesn't call clients.openWindow().
For example:
onnotificationclick = function(event) {
    event.notfication.close();
    event.waitUntil(client.focus());
}
onnotificationclose = function(event) {
    client.openWindow(&quot;foo.com&quot;);      // The window will be opened        
}

I guess my problem is whether should allow this window to be opened?

<span class="quote">&gt; If the click opened a window then it should have consumed the interaction.</span >

Sorry, I'm a little confused here. I reckon I might misunderstand something. Please correct me if there is anything wrong.

If we don't call the clients.windowOpen() in the click event handler, the window interaction will still be consumed.

The open window doesn't consume the interaction. The current implementation consumes the interaction at the end of WorkerRun() [1] and ClearWindowAllowed() [2]. And it seems we don't trigger either of them after calling openWindow() [3]. Therefore, we can open few windows in the current test test_openWindow.html [4] (testForUrl calls clients.openWindow). (Note: I run the test with lldb and there are two allow &amp; consume pairs. The first interaction is consumed by the end of WorkerRun, and the second interaction is consumed by timer's callback [5]). 

[1] <a rel="nofollow" href="https://searchfox.org/mozilla-central/source/dom/workers/ServiceWorkerPrivate.cpp#1267">https://searchfox.org/mozilla-central/source/dom/workers/ServiceWorkerPrivate.cpp#1267</a> 
[2] <a rel="nofollow" href="https://searchfox.org/mozilla-central/source/dom/workers/ServiceWorkerPrivate.cpp#1093">https://searchfox.org/mozilla-central/source/dom/workers/ServiceWorkerPrivate.cpp#1093</a>
[3] <a rel="nofollow" href="https://searchfox.org/mozilla-central/source/dom/clients/api/Clients.cpp#219">https://searchfox.org/mozilla-central/source/dom/clients/api/Clients.cpp#219</a>
[4] <a rel="nofollow" href="https://searchfox.org/mozilla-central/source/dom/workers/test/serviceworkers/openWindow_worker.js#97-110">https://searchfox.org/mozilla-central/source/dom/workers/test/serviceworkers/openWindow_worker.js#97-110</a>
[5] <a rel="nofollow" href="https://searchfox.org/mozilla-central/source/dom/workers/ServiceWorkerPrivate.cpp#1134-1141">https://searchfox.org/mozilla-central/source/dom/workers/ServiceWorkerPrivate.cpp#1134-1141</a>

<span class="quote">&gt; The important thing is we only allow one additional &quot;open a window&quot; token
&gt; per click dispatch.</span >

I'm not sure about one additional &quot;open a window&quot; token. Do you mean we allow open a window in the close event handler if it's trigger by the click event handler? Can you elaborate on that?

<span class="quote">&gt; If you try to open a window in both click and close, do you get two windows?</span >

The answer is yes.
But the behavior doesn't change whether opening a window in the click event or not.
For example:
// get client from onmessage (client = event.source)
onnotificationclick = function(event) {
    clients.openWindow(&quot;foo.com&quot;);     // A
    event.notfication.close();
}
onnotificationclose = function(event) {
    client.openWindow(&quot;foo.com&quot;);      // The client will open a window by A (Won't open a window if without A)       
}

//-------

onnotificationclick = function(event) {
    clients.openWindow(&quot;foo.com&quot;);     // A
    event.notfication.close();
    event.waitUntil(client.focus());
}
onnotificationclose = function(event) {
    client.openWindow(&quot;foo.com&quot;);      // The client will open two windows (Will open a window if without A).        
}</pre></div><div class="change-set" id="c21"><div class="comment" data-id="12969513" data-no="21"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-21" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_552411" id="a182659_1689"><img src="https://secure.gravatar.com/avatar/08b5f16b66786915fef5524c528fdb49?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_552411" id="a182659_1689"><a class="email " href="/user_profile?user_id=552411" > <span class="fna">Tom Tung [:tt, :ttung]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-21"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-21" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#c21">Comment 21</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-15 00:55 PST" data-time="1516006547">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-21">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8942604"
         class="attachment patch obsolete"
         data-id="8942604" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="Bug1429093-p1.patch">
      <meta itemprop="contentSize" content="2156">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8942604">
          <a class="link" href="attachment.cgi?id=8942604&amp;action=diff">
        <span id="att-8942604-description" itemprop="description">P1</span></a> (obsolete)
        — <a href="attachment.cgi?id=8942604&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1429093&attachment=8942604">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-21" data-comment-id="12969513">patch for only allowing window interaction for the notification click.</pre></div><div class="change-set" id="c22"><div class="comment" data-id="12969514" data-no="22"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-22" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_552411" id="a182659_1689"><img src="https://secure.gravatar.com/avatar/08b5f16b66786915fef5524c528fdb49?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_552411" id="a182659_1689"><a class="email " href="/user_profile?user_id=552411" > <span class="fna">Tom Tung [:tt, :ttung]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-22"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-22" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#c22">Comment 22</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-15 00:56 PST" data-time="1516006572">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-22">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8942605"
         class="attachment patch obsolete"
         data-id="8942605" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="Bug1429093-p2.patch">
      <meta itemprop="contentSize" content="4656">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8942605">
          <a class="link" href="attachment.cgi?id=8942605&amp;action=diff">
        <span id="att-8942605-description" itemprop="description">P2</span></a> (obsolete)
        — <a href="attachment.cgi?id=8942605&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1429093&attachment=8942605">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-22" data-comment-id="12969514">Test for verifying P1</pre></div><div class="change-set" id="c23"><div class="comment" data-id="12972124" data-no="23"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-23" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_465500" id="a182659_1689"><img src="https://secure.gravatar.com/avatar/bc5e85dbd8d5c9b11c419c65ee4081b5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_465500" id="a182659_1689"><a class="email " href="/user_profile?user_id=465500" > <span class="fna">Ben Kelly [:bkelly, not reviewing]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-23"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-23" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#c23">Comment 23</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-16 07:39 PST" data-time="1516117150">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-23">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-23" data-comment-id="12972124">I guess I'm trying to say when a notificationclick event occurs we should only increase WorkerScope::mWindowInteractionAllowed by one:

<a rel="nofollow" href="https://searchfox.org/mozilla-central/source/dom/workers/WorkerScope.h#65">https://searchfox.org/mozilla-central/source/dom/workers/WorkerScope.h#65</a>

Currently we are increasing it by two because we call AllowWindowInteraction() twice.  We consume one of those synchronously after the event handler runs, but don't consume the other one until either waitUntil() promise resolves or the timer fires.

So I think we should remove the AllowWindowInteraction() and ConsumeWindowInteraction() calls here:

<a rel="nofollow" href="https://searchfox.org/mozilla-central/rev/41925c0b6c6d58578690121de439d2a8d3d690f3/dom/workers/ServiceWorkerPrivate.cpp#1256">https://searchfox.org/mozilla-central/rev/41925c0b6c6d58578690121de439d2a8d3d690f3/dom/workers/ServiceWorkerPrivate.cpp#1256</a>
<a rel="nofollow" href="https://searchfox.org/mozilla-central/rev/41925c0b6c6d58578690121de439d2a8d3d690f3/dom/workers/ServiceWorkerPrivate.cpp#1267">https://searchfox.org/mozilla-central/rev/41925c0b6c6d58578690121de439d2a8d3d690f3/dom/workers/ServiceWorkerPrivate.cpp#1267</a>

And then only create the AllowWindowInteractionHandler if the event is exactly notificationclick instead of any notification event.</pre></div><div class="change-set" id="c24"><div class="comment" data-id="12975054" data-no="24"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-24" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_552411" id="a182659_1689"><img src="https://secure.gravatar.com/avatar/08b5f16b66786915fef5524c528fdb49?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_552411" id="a182659_1689"><a class="email " href="/user_profile?user_id=552411" > <span class="fna">Tom Tung [:tt, :ttung]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-24"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-24" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#c24">Comment 24</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-16 18:23 PST" data-time="1516155804">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-24">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-24" data-comment-id="12975054">(In reply to Ben Kelly [:bkelly] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Push API allows DOM event without user interaction"
   href="/show_bug.cgi?id=1429093#c23">comment #23</a>)
<span class="quote">&gt; And then only create the AllowWindowInteractionHandler if the event is
&gt; exactly notificationclick instead of any notification event.</span >

Oh, I see! So, you are right in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Push API allows DOM event without user interaction"
   href="/show_bug.cgi?id=1429093#c15">comment 15</a>, which is <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Push API allows DOM event without user interaction"
   href="/show_bug.cgi?id=1429093#c9">comment 9</a> can already achieve this. The call for AllowWindowInteraction() in WorkerRun() seems to be redundant. But, I'd like to do it together with <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Push API allows DOM event without user interaction"
   href="/show_bug.cgi?id=1429093#c9">comment 9</a>, since the change is small.

Sorry for taking so much time to understand...

I was thinking to avoid allowing the window interaction in the close event (even if it's triggered by the click event). But, I find out I don't need to worry about that because the click event needs users' interaction to trigger.</pre></div><div class="change-set" id="c25"><div class="comment" data-id="12975153" data-no="25"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-25" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_552411" id="a182659_1689"><img src="https://secure.gravatar.com/avatar/08b5f16b66786915fef5524c528fdb49?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_552411" id="a182659_1689"><a class="email " href="/user_profile?user_id=552411" > <span class="fna">Tom Tung [:tt, :ttung]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-25"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-25" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#c25">Comment 25</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-16 19:40 PST" data-time="1516160437">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-25">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8943108"
         class="attachment patch"
         data-id="8943108" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="Bug1429093-p1.patch">
      <meta itemprop="contentSize" content="1907">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8943108">
          <a class="link" href="attachment.cgi?id=8943108&amp;action=diff">
        <span id="att-8943108-description" itemprop="description">Bug 1429093 - P1: Only allow notification click to call allowWindowInteraction. r=bkelly</span></a>
        — <a href="attachment.cgi?id=8943108&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1429093&attachment=8943108">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-25" data-comment-id="12975153">Hi Ben,

This patch is for only allowing notificationclick to increase the mWindowInteractionAllowed token. Also, it removes the extra adding/consuming token in WorkerRun. Would you mind helping me to review this? Thanks!</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8942604&amp;action=edit"
           title="P1"
           class=""
        >Attachment #8942604</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8943108&amp;action=edit"
           title="Bug 1429093 - P1: Only allow notification click to call allowWindowInteraction. r=bkelly"
           class=""
        >Attachment #8943108</a> -
        Flags: review?(bkelly)</div></div></div><div class="change-set" id="c26"><div class="comment" data-id="12975155" data-no="26"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-26" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_552411" id="a182659_1689"><img src="https://secure.gravatar.com/avatar/08b5f16b66786915fef5524c528fdb49?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_552411" id="a182659_1689"><a class="email " href="/user_profile?user_id=552411" > <span class="fna">Tom Tung [:tt, :ttung]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-26"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-26" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#c26">Comment 26</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-16 19:41 PST" data-time="1516160505">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-26">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8943109"
         class="attachment patch obsolete"
         data-id="8943109" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="Bug1429093-p2.patch">
      <meta itemprop="contentSize" content="3433">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8943109">
          <a class="link" href="attachment.cgi?id=8943109&amp;action=diff">
        <span id="att-8943109-description" itemprop="description">Bug 1429093 - P2: A test to verify the close event is not allowed to window interaction. r=bkelly</span></a> (obsolete)
        — <a href="attachment.cgi?id=8943109&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1429093&attachment=8943109">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-26" data-comment-id="12975155">This patch is a test for verifying the P1.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8942605&amp;action=edit"
           title="P2"
           class=""
        >Attachment #8942605</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8943109&amp;action=edit"
           title="Bug 1429093 - P2: A test to verify the close event is not allowed to window interaction. r=bkelly"
           class=""
        >Attachment #8943109</a> -
        Flags: review?(bkelly)</div></div></div><div class="change-set" id="c27"><div class="comment" data-id="12975159" data-no="27"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-27" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_552411" id="a182659_1689"><img src="https://secure.gravatar.com/avatar/08b5f16b66786915fef5524c528fdb49?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_552411" id="a182659_1689"><a class="email " href="/user_profile?user_id=552411" > <span class="fna">Tom Tung [:tt, :ttung]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-27"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-27" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#c27">Comment 27</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-16 19:45 PST" data-time="1516160707">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-27">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-27" data-comment-id="12975159">try: <a rel="nofollow" href="https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=11c58ba6541ea92bf2368523a4eecb4f9220c2fb">https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=11c58ba6541ea92bf2368523a4eecb4f9220c2fb</a></pre></div><div class="change-set" id="a656051_434964"><div class="change" id="aa656051_434964">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_434964" id="a656051_434964"><img src="https://secure.gravatar.com/avatar/331afc283e18d6d28cb7ebb11b2cf5bb?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_434964" id="a656051_434964"><a class="email " href="/user_profile?user_id=434964" > <span class="fna">Hsin-Yi Tsai [:hsinyi]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a656051_434964"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a656051_434964">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#a656051_434964">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-16 22:01 PST" data-time="1516168919">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Priority: -- &rarr; P2</div></div></div><div class="change-set" id="c28"><div class="comment" data-id="12976351" data-no="28"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-28" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_465500" id="a656051_434964"><img src="https://secure.gravatar.com/avatar/bc5e85dbd8d5c9b11c419c65ee4081b5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_465500" id="a656051_434964"><a class="email " href="/user_profile?user_id=465500" > <span class="fna">Ben Kelly [:bkelly, not reviewing]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-28"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-28" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#c28">Comment 28</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-17 06:59 PST" data-time="1516201172">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-28">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-28" data-comment-id="12976351">Comment on <span class=""><a href="/attachment.cgi?id=8943108" name="attach_8943108" title="Bug 1429093 - P1: Only allow notification click to call allowWindowInteraction. r=bkelly">attachment 8943108</a> <a href="/attachment.cgi?id=8943108&amp;action=edit" title="Bug 1429093 - P1: Only allow notification click to call allowWindowInteraction. r=bkelly">[details]</a> <a href="/attachment.cgi?id=8943108&amp;action=diff" title="Bug 1429093 - P1: Only allow notification click to call allowWindowInteraction. r=bkelly">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1429093&amp;attachment=8943108'>[review]</a>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Push API allows DOM event without user interaction"
   href="/show_bug.cgi?id=1429093">Bug 1429093</a> - P1: Only allow notification click to call allowWindowInteraction. r=bkelly

Review of <span class=""><a href="/attachment.cgi?id=8943108" name="attach_8943108" title="Bug 1429093 - P1: Only allow notification click to call allowWindowInteraction. r=bkelly">attachment 8943108</a> <a href="/attachment.cgi?id=8943108&amp;action=edit" title="Bug 1429093 - P1: Only allow notification click to call allowWindowInteraction. r=bkelly">[details]</a> <a href="/attachment.cgi?id=8943108&amp;action=diff" title="Bug 1429093 - P1: Only allow notification click to call allowWindowInteraction. r=bkelly">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1429093&amp;attachment=8943108'>[review]</a>:
-----------------------------------------------------------------

Thanks!</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8943108&amp;action=edit"
           title="Bug 1429093 - P1: Only allow notification click to call allowWindowInteraction. r=bkelly"
           class=""
        >Attachment #8943108</a> -
        Flags: review?(bkelly) &rarr; review+</div></div></div><div class="change-set" id="c29"><div class="comment" data-id="12976362" data-no="29"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-29" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_465500" id="a656051_434964"><img src="https://secure.gravatar.com/avatar/bc5e85dbd8d5c9b11c419c65ee4081b5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_465500" id="a656051_434964"><a class="email " href="/user_profile?user_id=465500" > <span class="fna">Ben Kelly [:bkelly, not reviewing]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-29"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-29" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#c29">Comment 29</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-17 07:02 PST" data-time="1516201345">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-29">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-29" data-comment-id="12976362">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8943109" name="attach_8943109" title="Bug 1429093 - P2: A test to verify the close event is not allowed to window interaction. r=bkelly">attachment 8943109</a> <a href="/attachment.cgi?id=8943109&amp;action=edit" title="Bug 1429093 - P2: A test to verify the close event is not allowed to window interaction. r=bkelly">[details]</a> <a href="/attachment.cgi?id=8943109&amp;action=diff" title="Bug 1429093 - P2: A test to verify the close event is not allowed to window interaction. r=bkelly">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1429093&amp;attachment=8943109'>[review]</a>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Push API allows DOM event without user interaction"
   href="/show_bug.cgi?id=1429093">Bug 1429093</a> - P2: A test to verify the close event is not allowed to window interaction. r=bkelly

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8943109" name="attach_8943109" title="Bug 1429093 - P2: A test to verify the close event is not allowed to window interaction. r=bkelly">attachment 8943109</a> <a href="/attachment.cgi?id=8943109&amp;action=edit" title="Bug 1429093 - P2: A test to verify the close event is not allowed to window interaction. r=bkelly">[details]</a> <a href="/attachment.cgi?id=8943109&amp;action=diff" title="Bug 1429093 - P2: A test to verify the close event is not allowed to window interaction. r=bkelly">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1429093&amp;attachment=8943109'>[review]</a>:
-----------------------------------------------------------------

Since this is currently marked sec-low I guess we can land the test with the change.

::: dom/workers/test/serviceworkers/notificationclose.js
&#64;&#64; +2,5 &#64;&#64;
<span class="quote">&gt;  // <a rel="nofollow" href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</a>
&gt;  //
&gt; +onnotificationclose = async function(e) {
&gt; +  let windowOpened = true;
&gt; +  await clients.openWindow(&quot;hello.html&quot;)</span >

This should probable use waitUntil.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8943109&amp;action=edit"
           title="Bug 1429093 - P2: A test to verify the close event is not allowed to window interaction. r=bkelly"
           class=""
        >Attachment #8943109</a> -
        Flags: review?(bkelly) &rarr; review+</div></div></div><div class="change-set" id="c30"><div class="comment" data-id="12978019" data-no="30"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-30" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_552411" id="a656051_434964"><img src="https://secure.gravatar.com/avatar/08b5f16b66786915fef5524c528fdb49?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_552411" id="a656051_434964"><a class="email " href="/user_profile?user_id=552411" > <span class="fna">Tom Tung [:tt, :ttung]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-30"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-30" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#c30">Comment 30</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-17 17:52 PST" data-time="1516240347">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-30">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-30" data-comment-id="12978019">(In reply to Ben Kelly [:bkelly] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Push API allows DOM event without user interaction"
   href="/show_bug.cgi?id=1429093#c29">comment #29</a>)
<span class="quote">&gt; ::: dom/workers/test/serviceworkers/notificationclose.js
&gt; &#64;&#64; +2,5 &#64;&#64;
&gt; &gt;  // <a rel="nofollow" href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</a>
&gt; &gt;  //
&gt; &gt; +onnotificationclose = async function(e) {
&gt; &gt; +  let windowOpened = true;
&gt; &gt; +  await clients.openWindow(&quot;hello.html&quot;)
&gt; 
&gt; This should probable use waitUntil.</span >

Could you tell me more about it?

I have considered using waitUntil(), but I was not sure how to do it's better.
The main document (test_notificationclose.html) will wait for its iframe's callback (notificationclose.html). The iframe is the client of the service worker (notificationclose.js) and it is waiting for the postMessage() from the service worker. The iframe will notify the main document after receiving the message.

So, I decided to the pass extra information in the postMessage and used await to make sure the promise for openWindow() is rejected before posting the message to the client.

If I want to add waitUtil(), I thought I should add it at the place of client.postMessage(). But, since it's in a for-loop (though, it should just have only one client), I was afraid it would lead the test to be confusing.

BTW, should I uplift this to Beta after I got the security-approval?</pre></div><div class="change-set" id="c31"><div class="comment" data-id="12978071" data-no="31"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-31" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_465500" id="a656051_434964"><img src="https://secure.gravatar.com/avatar/bc5e85dbd8d5c9b11c419c65ee4081b5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_465500" id="a656051_434964"><a class="email " href="/user_profile?user_id=465500" > <span class="fna">Ben Kelly [:bkelly, not reviewing]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-31"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-31" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#c31">Comment 31</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-17 18:25 PST" data-time="1516242307">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-31">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-31" data-comment-id="12978071">You can just do the waitUntil around the whole thing.  Instead of passing the async function as the event handler do:

  onnotificationclose = function(evt) {
    evt.waitUntil(async function() {
      // handler body
    }());
  };

If we can land this before next week, then no uplift is necessary.  It's too late to get it in 58.</pre></div><div class="change-set" id="c32"><div class="comment" data-id="12978080" data-no="32"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-32" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_552411" id="a656051_434964"><img src="https://secure.gravatar.com/avatar/08b5f16b66786915fef5524c528fdb49?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_552411" id="a656051_434964"><a class="email " href="/user_profile?user_id=552411" > <span class="fna">Tom Tung [:tt, :ttung]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-32"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-32" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#c32">Comment 32</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-17 18:29 PST" data-time="1516242542">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-32">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-32" data-comment-id="12978080">(In reply to Ben Kelly [:bkelly] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Push API allows DOM event without user interaction"
   href="/show_bug.cgi?id=1429093#c31">comment #31</a>)
<span class="quote">&gt; You can just do the waitUntil around the whole thing.  Instead of passing
&gt; the async function as the event handler do:
&gt; 
&gt;   onnotificationclose = function(evt) {
&gt;     evt.waitUntil(async function() {
&gt;       // handler body
&gt;     }());
&gt;   };</span >

Oh, I see! Thanks!

I was restricting myself to use waitUtil() for a single line...

<span class="quote">&gt; If we can land this before next week, then no uplift is necessary.  It's too
&gt; late to get it in 58.</span >

Got it!</pre></div><div class="change-set" id="c33"><div class="comment" data-id="12980947" data-no="33"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-33" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_552411" id="a656051_434964"><img src="https://secure.gravatar.com/avatar/08b5f16b66786915fef5524c528fdb49?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_552411" id="a656051_434964"><a class="email " href="/user_profile?user_id=552411" > <span class="fna">Tom Tung [:tt, :ttung]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-33"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-33" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#c33">Comment 33</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-18 18:04 PST" data-time="1516327479">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-33">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-33" data-comment-id="12980947">Sorry, but I guess I don't have enough time to fix this (ask for sec-approval, ... etc)</pre><div class="activity"><div class="change">Assignee: ttung &rarr; nobody</div><div class="change">Status: ASSIGNED &rarr; NEW</div></div></div><div class="change-set" id="c34"><div class="comment" data-id="12980962" data-no="34"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-34" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_465500" id="a656051_434964"><img src="https://secure.gravatar.com/avatar/bc5e85dbd8d5c9b11c419c65ee4081b5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_465500" id="a656051_434964"><a class="email " href="/user_profile?user_id=465500" > <span class="fna">Ben Kelly [:bkelly, not reviewing]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-34"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-34" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#c34">Comment 34</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-18 18:25 PST" data-time="1516328755">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-34">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-34" data-comment-id="12980962">Thank you Tom.  You've done really great work.</pre></div><div class="change-set" id="c35"><div class="comment" data-id="12989036" data-no="35"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-35" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_465500" id="a656051_434964"><img src="https://secure.gravatar.com/avatar/bc5e85dbd8d5c9b11c419c65ee4081b5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_465500" id="a656051_434964"><a class="email " href="/user_profile?user_id=465500" > <span class="fna">Ben Kelly [:bkelly, not reviewing]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-35"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-35" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#c35">Comment 35</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-23 08:07 PST" data-time="1516723678">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-35">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-35" data-comment-id="12989036">I'll get this landed.</pre><div class="activity"><div class="change">Assignee: nobody &rarr; bkelly</div><div class="change">Status: NEW &rarr; ASSIGNED</div></div></div><div class="change-set" id="c36"><div class="comment" data-id="12989679" data-no="36"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-36" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_465500" id="a656051_434964"><img src="https://secure.gravatar.com/avatar/bc5e85dbd8d5c9b11c419c65ee4081b5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_465500" id="a656051_434964"><a class="email " href="/user_profile?user_id=465500" > <span class="fna">Ben Kelly [:bkelly, not reviewing]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-36"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-36" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#c36">Comment 36</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-23 11:13 PST" data-time="1516734784">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-36">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8944821"
         class="attachment patch"
         data-id="8944821" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="Bug1429093-p2.patch">
      <meta itemprop="contentSize" content="3901">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8944821">
          <a class="link" href="attachment.cgi?id=8944821&amp;action=diff">
        <span id="att-8944821-description" itemprop="description">P2: A test to verify the close event is not allowed to window interaction. r=bkelly</span></a>
        — <a href="attachment.cgi?id=8944821&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1429093&attachment=8944821">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-36" data-comment-id="12989679">Updated based on my review feedback.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8943109&amp;action=edit"
           title="Bug 1429093 - P2: A test to verify the close event is not allowed to window interaction. r=bkelly"
           class=""
        >Attachment #8943109</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="c37"><div class="comment" data-id="12989687" data-no="37"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-37" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_465500" id="a656051_434964"><img src="https://secure.gravatar.com/avatar/bc5e85dbd8d5c9b11c419c65ee4081b5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_465500" id="a656051_434964"><a class="email " href="/user_profile?user_id=465500" > <span class="fna">Ben Kelly [:bkelly, not reviewing]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-37"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-37" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#c37">Comment 37</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-23 11:17 PST" data-time="1516735049">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-37">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-37" data-comment-id="12989687">Pushed since this is sec-low and doesn't require sec-approval:

remote:   <a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/20b048f7a32fc9d76827c2f06be1d50afb8bbd00">https://hg.mozilla.org/integration/mozilla-inbound/rev/20b048f7a32fc9d76827c2f06be1d50afb8bbd00</a>
remote:   <a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/abd11ceb68ca7f0b04a4e4b3dc49090c523ad067">https://hg.mozilla.org/integration/mozilla-inbound/rev/abd11ceb68ca7f0b04a4e4b3dc49090c523ad067</a></pre></div><div class="change-set" id="c38"><div class="comment" data-id="12993043" data-no="38"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-38" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_258347" id="a656051_434964"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_258347" id="a656051_434964"><a class="email " href="/user_profile?user_id=258347" > <span class="fna">Sebastian Hengst [:aryx] (needinfo on intermittent or backout)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-38"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-38" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#c38">Comment 38</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-24 14:54 PST" data-time="1516834447">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-38">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-38" data-comment-id="12993043"><a rel="nofollow" href="https://hg.mozilla.org/mozilla-central/rev/20b048f7a32f">https://hg.mozilla.org/mozilla-central/rev/20b048f7a32f</a>
<a rel="nofollow" href="https://hg.mozilla.org/mozilla-central/rev/abd11ceb68ca">https://hg.mozilla.org/mozilla-central/rev/abd11ceb68ca</a></pre><div class="activity"><div class="change">Status: ASSIGNED &rarr; RESOLVED</div><div class="change">Closed: <span class="rel-time" title="2018-01-24 14:54 PST" data-time="1516834447">4 years ago</span></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox60&amp;o1=isnotempty">status-firefox60</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox60&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">Resolution: --- &rarr; FIXED</div><div class="change">Target Milestone: --- &rarr; mozilla60</div></div></div><div class="change-set" id="c39"><div class="comment" data-id="12993456" data-no="39"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-39" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a656051_434964"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a656051_434964"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-39"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-39" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#c39">Comment 39</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-24 18:42 PST" data-time="1516848178">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-39">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-39" data-comment-id="12993456">Please request Beta approval on this when you get a chance.</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox58&amp;o1=isnotempty">status-firefox58</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox58&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox59&amp;o1=isnotempty">status-firefox59</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox59&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr52&amp;o1=isnotempty">status-firefox-esr52</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr52&amp;o1=equals&amp;v1=unaffected">unaffected</a></div><div class="change">Flags: needinfo?(bkelly)</div><div class="change">Flags: in-testsuite+</div></div></div><div class="change-set" id="c40"><div class="comment" data-id="12993698" data-no="40"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-40" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_609555" id="a656051_434964"><img src="https://secure.gravatar.com/avatar/f9449e8de5f17bda351cec34a13ec417?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_609555" id="a656051_434964"><a class="email " href="/user_profile?user_id=609555" > <span class="fna">Zohar</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-40"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-40" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#c40">Comment 40</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-24 22:22 PST" data-time="1516861341">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-40">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-40" data-comment-id="12993698">Hey, Glad you got this sorted! 
thanks for the hard work!

Will there be a security bounty attached to this bug? 

Cheers, 
Zohar</pre></div><div class="change-set" id="c41"><div class="comment" data-id="12994688" data-no="41"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-41" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_465500" id="a656051_434964"><img src="https://secure.gravatar.com/avatar/bc5e85dbd8d5c9b11c419c65ee4081b5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_465500" id="a656051_434964"><a class="email " href="/user_profile?user_id=465500" > <span class="fna">Ben Kelly [:bkelly, not reviewing]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-41"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-41" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#c41">Comment 41</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-25 07:37 PST" data-time="1516894653">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-41">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-41" data-comment-id="12994688">This is not for me to decide.  The security team will does a periodic review to determine that.

I will request beta uplift.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(bkelly)</span></div></div></div><div class="change-set" id="a1381799_465500"><div class="change" id="aa1381799_465500">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_465500" id="a1381799_465500"><img src="https://secure.gravatar.com/avatar/bc5e85dbd8d5c9b11c419c65ee4081b5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_465500" id="a1381799_465500"><a class="email " href="/user_profile?user_id=465500" > <span class="fna">Ben Kelly [:bkelly, not reviewing]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1381799_465500"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1381799_465500">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#a1381799_465500">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-25 07:37 PST" data-time="1516894667">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8944821&amp;action=edit"
           title="P2: A test to verify the close event is not allowed to window interaction. r=bkelly"
           class=""
        >Attachment #8944821</a> -
        Flags: review+</div></div></div><div class="change-set" id="c42"><div class="comment" data-id="12994693" data-no="42"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-42" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_465500" id="a1381799_465500"><img src="https://secure.gravatar.com/avatar/bc5e85dbd8d5c9b11c419c65ee4081b5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_465500" id="a1381799_465500"><a class="email " href="/user_profile?user_id=465500" > <span class="fna">Ben Kelly [:bkelly, not reviewing]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-42"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-42" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#c42">Comment 42</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-25 07:40 PST" data-time="1516894852">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-42">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-42" data-comment-id="12994693">Comment on <span class=""><a href="/attachment.cgi?id=8943108" name="attach_8943108" title="Bug 1429093 - P1: Only allow notification click to call allowWindowInteraction. r=bkelly">attachment 8943108</a> <a href="/attachment.cgi?id=8943108&amp;action=edit" title="Bug 1429093 - P1: Only allow notification click to call allowWindowInteraction. r=bkelly">[details]</a> <a href="/attachment.cgi?id=8943108&amp;action=diff" title="Bug 1429093 - P1: Only allow notification click to call allowWindowInteraction. r=bkelly">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1429093&amp;attachment=8943108'>[review]</a>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Push API allows DOM event without user interaction"
   href="/show_bug.cgi?id=1429093">Bug 1429093</a> - P1: Only allow notification click to call allowWindowInteraction. r=bkelly

Approval Request Comment
[Feature/Bug causing the regression]: Service worker push notifications
[User impact if declined]: A malicious website with push permissions could spam the user with notifications and new tabs.
[Is this code covered by automated tests?]: Test in P2 patch.
[Has the fix been verified in Nightly?]: The fix has been in nightly for a day and it has a test.  I don't think we have formally verified it, though.
[Needs manual test from QE? If yes, steps to reproduce]:  No.
[List of other uplifts needed for the feature/fix]: No.
[Is the change risky?]: Low risk.
[Why is the change risky/not risky?]: The change is contained to only notification related code and relatively small.  The risk of functional regressions is low.
[String changes made/needed]: None</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8943108&amp;action=edit"
           title="Bug 1429093 - P1: Only allow notification click to call allowWindowInteraction. r=bkelly"
           class=""
        >Attachment #8943108</a> -
        Flags: approval-mozilla-beta?</div></div></div><div class="change-set" id="c43"><div class="comment" data-id="12994694" data-no="43"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-43" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_465500" id="a1381799_465500"><img src="https://secure.gravatar.com/avatar/bc5e85dbd8d5c9b11c419c65ee4081b5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_465500" id="a1381799_465500"><a class="email " href="/user_profile?user_id=465500" > <span class="fna">Ben Kelly [:bkelly, not reviewing]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-43"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-43" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#c43">Comment 43</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-25 07:41 PST" data-time="1516894874">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-43">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-43" data-comment-id="12994694">Comment on <span class=""><a href="/attachment.cgi?id=8944821" name="attach_8944821" title="P2: A test to verify the close event is not allowed to window interaction. r=bkelly">attachment 8944821</a> <a href="/attachment.cgi?id=8944821&amp;action=edit" title="P2: A test to verify the close event is not allowed to window interaction. r=bkelly">[details]</a> <a href="/attachment.cgi?id=8944821&amp;action=diff" title="P2: A test to verify the close event is not allowed to window interaction. r=bkelly">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1429093&amp;attachment=8944821'>[review]</a>
P2: A test to verify the close event is not allowed to window interaction. r=bkelly

See <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Push API allows DOM event without user interaction"
   href="/show_bug.cgi?id=1429093#c42">comment 42</a>.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8944821&amp;action=edit"
           title="P2: A test to verify the close event is not allowed to window interaction. r=bkelly"
           class=""
        >Attachment #8944821</a> -
        Flags: approval-mozilla-beta?</div></div></div><div class="change-set" id="c44"><div class="comment" data-id="13006597" data-no="44"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-44" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_451704" id="a1381799_465500"><img src="https://secure.gravatar.com/avatar/6168ea97fda0cefa449331e59b24e8f7?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_451704" id="a1381799_465500"><a class="email " href="/user_profile?user_id=451704" > <span class="fna">Liz Henry (:lizzard Please n-i to RyanVM, jcristau, or pascal)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-44"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-44" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#c44">Comment 44</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-30 13:59 PST" data-time="1517349546">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-44">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-44" data-comment-id="13006597">Comment on <span class=""><a href="/attachment.cgi?id=8943108" name="attach_8943108" title="Bug 1429093 - P1: Only allow notification click to call allowWindowInteraction. r=bkelly">attachment 8943108</a> <a href="/attachment.cgi?id=8943108&amp;action=edit" title="Bug 1429093 - P1: Only allow notification click to call allowWindowInteraction. r=bkelly">[details]</a> <a href="/attachment.cgi?id=8943108&amp;action=diff" title="Bug 1429093 - P1: Only allow notification click to call allowWindowInteraction. r=bkelly">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1429093&amp;attachment=8943108'>[review]</a>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Push API allows DOM event without user interaction"
   href="/show_bug.cgi?id=1429093">Bug 1429093</a> - P1: Only allow notification click to call allowWindowInteraction. r=bkelly

Regression from 58, has test coverage. Let's uplift this for 59 beta 6.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8943108&amp;action=edit"
           title="Bug 1429093 - P1: Only allow notification click to call allowWindowInteraction. r=bkelly"
           class=""
        >Attachment #8943108</a> -
        Flags: approval-mozilla-beta? &rarr; approval-mozilla-beta+</div></div></div><div class="change-set" id="a1838499_1689"><div class="change" id="aa1838499_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a1838499_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a1838499_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1838499_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1838499_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#a1838499_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-30 14:29 PST" data-time="1517351367">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: dom-core-security &rarr; core-security-release</div></div></div><div class="change-set" id="c45"><div class="comment" data-id="13007175" data-no="45"
       data-tags="uplift">
    
    <table class="layout-table change-head " id="ch-45" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a1838499_1689"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a1838499_1689"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-45"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-45" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#c45">Comment 45</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-30 17:43 PST" data-time="1517363015">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-45">
        <td colspan="2" class="comment-tags"><span class="comment-tag">uplift</span>
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-45" data-comment-id="13007175"><a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-beta/rev/ca41b3ad3577">https://hg.mozilla.org/releases/mozilla-beta/rev/ca41b3ad3577</a>
<a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-beta/rev/57b52fb5a9a5">https://hg.mozilla.org/releases/mozilla-beta/rev/57b52fb5a9a5</a></pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox59&amp;o1=isnotempty">status-firefox59</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox59&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox59&amp;o1=equals&amp;v1=fixed">fixed</a></div></div></div><div class="change-set" id="a1910900_451704"><div class="change" id="aa1910900_451704">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_451704" id="a1910900_451704"><img src="https://secure.gravatar.com/avatar/6168ea97fda0cefa449331e59b24e8f7?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_451704" id="a1910900_451704"><a class="email " href="/user_profile?user_id=451704" > <span class="fna">Liz Henry (:lizzard Please n-i to RyanVM, jcristau, or pascal)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1910900_451704"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1910900_451704">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#a1910900_451704">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-01-31 10:36 PST" data-time="1517423768">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8944821&amp;action=edit"
           title="P2: A test to verify the close event is not allowed to window interaction. r=bkelly"
           class=""
        >Attachment #8944821</a> -
        Flags: approval-mozilla-beta? &rarr; approval-mozilla-beta+</div></div></div><div class="change-set" id="a4498997_452604"><div class="change" id="aa4498997_452604">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_452604" id="a4498997_452604"><img src="https://secure.gravatar.com/avatar/7bb698c4991c5af83adabe3c3b8ee8aa?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_452604" id="a4498997_452604"><a class="email disabled" href="/user_profile?user_id=452604" > <span class="fna">Matt Wobensmith [:mwobensmith][:matt:]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a4498997_452604"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a4498997_452604">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#a4498997_452604">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-03-02 09:31 PST" data-time="1520011865">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: qe-verify-</div><div class="change">Whiteboard: [post-critsmash-triage]</div></div></div><div class="change-set" id="a4959600_280903"><div class="change" id="aa4959600_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a4959600_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a4959600_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a4959600_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a4959600_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#a4959600_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-03-07 17:27 PST" data-time="1520472468">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: [post-critsmash-triage] &rarr; [post-critsmash-triage][adv-main59+]</div></div></div><div class="change-set" id="a5025379_280903"><div class="change" id="aa5025379_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a5025379_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a5025379_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a5025379_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a5025379_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#a5025379_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-03-08 11:44 PST" data-time="1520538247">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Alias: CVE-2018-5141</div></div></div><div class="change-set" id="c46"><div class="comment" data-id="13117958" data-no="46"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-46" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a5025379_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_280903" id="a5025379_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-46"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-46" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#c46">Comment 46</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-03-09 13:08 PST" data-time="1520629707">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-46">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-46" data-comment-id="13117958">(In reply to Zohar from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Push API allows DOM event without user interaction"
   href="/show_bug.cgi?id=1429093#c16">comment #16</a>)
<span class="quote">&gt; Hey guys, 
&gt; I just want to add my opinion as a security researcher, 
&gt; I think  the potential impact of this bug is quite severe (I saw you marked
&gt; the bug as a 'low risk' security event)</span >

DOS attacks are generally rated as &quot;low&quot; per our rating guidelines at <a rel="nofollow" href="https://wiki.mozilla.org/Security_Severity_Ratings">https://wiki.mozilla.org/Security_Severity_Ratings</a>, linked to from our security pages at <a rel="nofollow" href="http://www.mozilla.org/security/">http://www.mozilla.org/security/</a>. DOS attacks are only rated about sec-low if they are persistent, which this attack isn't. 

(In reply to Zohar from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Push API allows DOM event without user interaction"
   href="/show_bug.cgi?id=1429093#c40">comment #40</a>)

<span class="quote">&gt; Will there be a security bounty attached to this bug? </span >

Not by default, no. If you are interested in the bug bounty program, you need to write to us at our <a href="mailto:security&#64;mozilla.org">security&#64;mozilla.org</a> email address and ask it to be considered for bounty. Please read the program guidelines at <a rel="nofollow" href="https://www.mozilla.org/en-US/security/client-bug-bounty/">https://www.mozilla.org/en-US/security/client-bug-bounty/</a>. We will not automatically flag bugs for bounty except in very unusual circumstances as there is no guarantee that people from the bounty committee will see all issues.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(dveditz)</span></div></div></div><div class="change-set" id="a20009328_1689"><div class="change" id="aa20009328_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a20009328_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a20009328_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a20009328_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a20009328_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1429093#a20009328_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-08-28 22:56 PDT" data-time="1535522196">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: <span class="activity-deleted">core-security-release</span></div></div></div><div id="new-comment-notice">
          You need to <a href="/show_bug.cgi?id=1429093&amp;GoAheadAndLogIn=1">log in</a>
          before you can comment on or make changes to this bug.
        </div>



<div id="bottom-actions">
  <div id="bottom-right-actions">
    <button type="button" id="top-btn" class="secondary" aria-label="Go to Page Top">Top &uarr;</button>
  </div>
</div></div> 
</main> 
</div> 


</body>
</html>