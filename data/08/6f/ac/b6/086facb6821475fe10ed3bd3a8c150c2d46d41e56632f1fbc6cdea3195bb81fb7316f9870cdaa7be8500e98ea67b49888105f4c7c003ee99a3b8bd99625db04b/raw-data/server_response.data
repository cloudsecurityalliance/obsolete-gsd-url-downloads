<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<title>Navigate CMS</title>
<meta name="HandheldFriendly" content="True" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<script src="/cdn-cgi/apps/head/0n4s3BxVAlZX-V6vtgdxBjVezdM.js"></script><link rel="preload" href="/assets/css/app.css?v=d7e163d66c" as="style" />
<link rel="preload" href="/assets/js/manifest.js?v=d7e163d66c" as="script" />
<link rel="preload" href="/assets/js/vendor/content-api.min.js?v=d7e163d66c" as="script" />
<link rel="preload" href="/assets/js/vendor.js?v=d7e163d66c" as="script" />
<link rel="preload" href="/assets/js/app.js?v=d7e163d66c" as="script" />
<link rel="preconnect" href="https://polyfill.io">
<link rel="dns-prefetch" href="https://polyfill.io">
<link rel="preload" href="/assets/css/post.css?v=d7e163d66c" as="style" />
<link rel="preload" href="/assets/js/page.js?v=d7e163d66c" as="script" />
<style>
      /* These font-faces are here to make fonts work if the Ghost instance is installed in a subdirectory */

      /* source-sans-pro-regular */
      @font-face {
        font-family: 'Source Sans Pro';
        font-style: normal;
        font-weight: 400;
        font-display: swap;
        src: local('SourceSansPro-Regular'),
            url("/assets/fonts/source-sans-pro/latin/source-sans-pro-regular.woff2?v=d7e163d66c") format('woff2'),
            url("/assets/fonts/source-sans-pro/latin/source-sans-pro-regular.woff?v=d7e163d66c") format('woff');
      }

      /* source-sans-pro-600 */
      @font-face {
        font-family: 'Source Sans Pro';
        font-style: normal;
        font-weight: 600;
        font-display: swap;
        src: local('SourceSansPro-SemiBold'),
            url("/assets/fonts/source-sans-pro/latin/source-sans-pro-600.woff2?v=d7e163d66c") format('woff2'),
            url("/assets/fonts/source-sans-pro/latin/source-sans-pro-600.woff?v=d7e163d66c") format('woff');
      }

      /* source-sans-pro-700 */
      @font-face {
        font-family: 'Source Sans Pro';
        font-style: normal;
        font-weight: 700;
        font-display: swap;
        src: local('SourceSansPro-Bold'),
            url("/assets/fonts/source-sans-pro/latin/source-sans-pro-700.woff2?v=d7e163d66c") format('woff2'),
            url("/assets/fonts/source-sans-pro/latin/source-sans-pro-700.woff?v=d7e163d66c") format('woff');
      }

      /* iconmoon */
      @font-face {
        font-family: 'icomoon';
        font-weight: normal;
        font-style: normal;
        font-display: swap;
        src: url("/assets/fonts/icomoon/icomoon.eot?101fc3?v=d7e163d66c");
        src: url("/assets/fonts/icomoon/icomoon.eot?101fc3#iefix?v=d7e163d66c") format('embedded-opentype'),
        url("/assets/fonts/icomoon/icomoon.ttf?101fc3?v=d7e163d66c") format('truetype'),
        url("/assets/fonts/icomoon/icomoon.woff?101fc3?v=d7e163d66c") format('woff'),
        url("/assets/fonts/icomoon/icomoon.svg?101fc3#icomoon?v=d7e163d66c") format('svg');
      }
    </style>
<link rel="stylesheet" type="text/css" href="/assets/css/app.css?v=d7e163d66c" media="screen" />
<link rel="stylesheet" type="text/css" href="/assets/css/post.css?v=d7e163d66c" media="screen" />
<link rel="icon" href="/favicon.png" type="image/png" />
<link rel="canonical" href="https://blog.sean-wright.com/navigate-cms/" />
<meta name="referrer" content="no-referrer-when-downgrade" />
<meta property="og:site_name" content="Sean Wright" />
<meta property="og:type" content="website" />
<meta property="og:title" content="Navigate CMS" />
<meta property="og:description" content="Findings from a live bug hunting exercise on Navigate CMS." />
<meta property="og:url" content="https://blog.sean-wright.com/navigate-cms/" />
<meta property="og:image" content="https://blog.sean-wright.com/content/images/2020/06/logo-navigate.png" />
<meta property="article:published_time" content="2020-06-23T12:39:53.000Z" />
<meta property="article:modified_time" content="2020-06-23T12:48:37.000Z" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="Navigate CMS" />
<meta name="twitter:description" content="Findings from a live bug hunting exercise on Navigate CMS." />
<meta name="twitter:url" content="https://blog.sean-wright.com/navigate-cms/" />
<meta name="twitter:image" content="https://blog.sean-wright.com/content/images/2020/06/logo-navigate.png" />
<meta name="twitter:label1" content="Written by" />
<meta name="twitter:data1" content="Sean Wright" />
<meta name="twitter:site" content="@SeanWrightSec" />
<meta name="twitter:creator" content="@SeanWrightSec" />
<meta property="og:image:width" content="250" />
<meta property="og:image:height" content="113" />
<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Sean Wright",
        "url": "https://blog.sean-wright.com/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://blog.sean-wright.com/favicon.png",
            "width": 60,
            "height": 60
        }
    },
    "author": {
        "@type": "Person",
        "name": "Sean Wright",
        "image": {
            "@type": "ImageObject",
            "url": "https://blog.sean-wright.com/content/images/2021/09/profile-1.png",
            "width": 872,
            "height": 849
        },
        "url": "https://blog.sean-wright.com/author/sean/",
        "sameAs": [
            "https://twitter.com/SeanWrightSec"
        ]
    },
    "headline": "Navigate CMS",
    "url": "https://blog.sean-wright.com/navigate-cms/",
    "datePublished": "2020-06-23T12:39:53.000Z",
    "dateModified": "2020-06-23T12:48:37.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://blog.sean-wright.com/content/images/2020/06/logo-navigate.png",
        "width": 250,
        "height": 113
    },
    "description": "Findings from a live bug hunting exercise on Navigate CMS.",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://blog.sean-wright.com/"
    }
}
    </script>
<meta name="generator" content="Ghost 4.20" />
<link rel="alternate" type="application/rss+xml" title="Sean Wright" href="https://blog.sean-wright.com/rss/" />
<script defer src="https://unpkg.com/@tryghost/portal@~1.12.0/umd/portal.min.js" data-ghost="https://blog.sean-wright.com/" crossorigin="anonymous"></script><style id="gh-members-styles">.gh-post-upgrade-cta-content,
.gh-post-upgrade-cta {
    display: flex;
    flex-direction: column;
    align-items: center;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    text-align: center;
    width: 100%;
    color: #ffffff;
    font-size: 16px;
}

.gh-post-upgrade-cta-content {
    border-radius: 8px;
    padding: 40px 4vw;
}

.gh-post-upgrade-cta h2 {
    color: #ffffff;
    font-size: 28px;
    letter-spacing: -0.2px;
    margin: 0;
    padding: 0;
}

.gh-post-upgrade-cta p {
    margin: 20px 0 0;
    padding: 0;
}

.gh-post-upgrade-cta small {
    font-size: 16px;
    letter-spacing: -0.2px;
}

.gh-post-upgrade-cta a {
    color: #ffffff;
    cursor: pointer;
    font-weight: 500;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a:hover {
    color: #ffffff;
    opacity: 0.8;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a.gh-btn {
    display: block;
    background: #ffffff;
    text-decoration: none;
    margin: 28px 0 0;
    padding: 8px 18px;
    border-radius: 4px;
    font-size: 16px;
    font-weight: 600;
}

.gh-post-upgrade-cta a.gh-btn:hover {
    opacity: 0.92;
}</style>

<script async defer data-domain="blog.sean-wright.com" src="https://stats.blog.sean-wright.com/js/index.js"></script><style>:root {--ghost-accent-color: #15171A;}</style>
<script>
      // @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&dn=expat.txt Expat
      const ghostHost = "https://blog.sean-wright.com"
      // @license-end
    </script>
</head>
<body class="page-template page-navigate-cms">
<header class="m-header with-picture js-header">
<div class="m-mobile-topbar" data-aos="fade-down">
<button class="m-icon-button in-mobile-topbar js-open-menu" aria-label="Open menu">
<span class="icon-menu" aria-hidden="true"></span>
</button>
<a href="https://blog.sean-wright.com" class="m-site-name in-mobile-topbar">
Sean Wright
</a>
<button class="m-icon-button in-mobile-topbar js-open-search" aria-label="Open search">
<span class="icon-search" aria-hidden="true"></span>
</button>
</div>
<div class="m-menu js-menu">
<button class="m-icon-button outlined as-close-menu js-close-menu" aria-label="Close menu">
<span class="icon-close"></span>
</button>
<div class="m-menu__main" data-aos="fade-down">
<div class="l-wrapper">
<div class="m-nav js-main-nav">
<nav class="m-nav__left js-main-nav-left" role="navigation" aria-label="Main menu">
<ul>
<li class="only-desktop">
<a href="https://blog.sean-wright.com" class="m-site-name in-desktop-menu">
Sean Wright
</a>
</li>
<li class="nav-home">
<a href="https://blog.sean-wright.com/">Home</a>
</li>
<li class="nav-about-the-author">
<a href="https://blog.sean-wright.com/about-the-author/">About The Author</a>
</li>
<li class="nav-findings-vulnerabilities">
<a href="https://blog.sean-wright.com/findings/">Findings/Vulnerabilities</a>
</li>
<li class="nav-videos">
<a href="https://blog.sean-wright.com/videos/">Videos</a>
</li>
<li class="nav-talks">
<a href="https://blog.sean-wright.com/talks/">Talks</a>
</li>
<li class="nav-media">
<a href="https://blog.sean-wright.com/media/">Media</a>
</li>
<li class="nav-resources">
<a href="https://blog.sean-wright.com/resources/">Resources</a>
</li>
<li class="nav-analytics">
<a href="https://plausible.io/blog.sean-wright.com">Analytics</a>
</li>
<li class="submenu-option js-submenu-option">
<button class="m-icon-button in-menu-main more js-toggle-submenu" aria-label="Open submenu">
<span class="icon-more" aria-hidden="true"></span>
</button>
<div class="m-submenu js-submenu">
<div class="l-wrapper in-submenu">
<section class="m-recent-articles">
<h3 class="m-submenu-title in-recent-articles">Recent articles</h3>
<div class="glide js-recent-slider">
<div class="glide__track" data-glide-el="track">
<div class="glide__slides">
<div class="glide__slide">
<a href="/windows-11/" class="m-recent-article">
<div class="m-recent-article__picture ">
<img src="https://images.unsplash.com/photo-1624571404553-49e7dbfbc90e?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;MnwxMTc3M3wwfDF8c2VhcmNofDJ8fFdpbmRvd3MlMjAxMXxlbnwwfHx8fDE2MzUyNTE2NzQ&amp;ixlib&#x3D;rb-1.2.1&amp;q&#x3D;80&amp;w&#x3D;2000" loading="lazy" alt="">
</div>
<h3 class="m-recent-article__title js-recent-article-title" title="Windows 11">
Windows 11
</h3>
<span class="m-recent-article__date">9 hours ago</span>
</a>
</div>
<div class="glide__slide">
 <a href="/moving-beyond-the-fud/" class="m-recent-article">
<div class="m-recent-article__picture ">
<img src="https://images.unsplash.com/photo-1559736139-6531cc82432e?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;MnwxMTc3M3wwfDF8c2VhcmNofDE4fHx3b2xmfGVufDB8fHx8MTYzNDQ3ODIzMw&amp;ixlib&#x3D;rb-1.2.1&amp;q&#x3D;80&amp;w&#x3D;2000" loading="lazy" alt="">
</div>
<h3 class="m-recent-article__title js-recent-article-title" title="Moving Beyond the FUD">
Moving Beyond the FUD
</h3>
<span class="m-recent-article__date">9 days ago</span>
</a>
</div>
<div class="glide__slide">
<a href="/spreading-misinformation/" class="m-recent-article">
<div class="m-recent-article__picture ">
<img src="https://images.unsplash.com/photo-1588681664899-f142ff2dc9b1?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;MnwxMTc3M3wwfDF8c2VhcmNofDJ8fG5ld3N8ZW58MHx8fHwxNjE4MDU3NTkx&amp;ixlib&#x3D;rb-1.2.1&amp;q&#x3D;80&amp;w&#x3D;2000" loading="lazy" alt="">
</div>
<h3 class="m-recent-article__title js-recent-article-title" title="Spreading Misinformation Using Twitter">
Spreading Misinformation Using Twitter
</h3>
<span class="m-recent-article__date">7 months ago</span>
</a>
</div>
<div class="glide__slide">
<a href="/analytics/" class="m-recent-article">
<div class="m-recent-article__picture ">
<img src="https://images.unsplash.com/photo-1560472354-b33ff0c44a43?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;MnwxMTc3M3wwfDF8c2VhcmNofDV8fEFuYWx5dGljc3xlbnwwfHx8fDE2MTgwNjE0MTU&amp;ixlib&#x3D;rb-1.2.1&amp;q&#x3D;80&amp;w&#x3D;2000" loading="lazy" alt="">
</div>
<h3 class="m-recent-article__title js-recent-article-title" title="Analytics - Why">
Analytics - Why
</h3>
<span class="m-recent-article__date">7 months ago</span>
</a>
</div>
</div>
</div>
</div>
</section>
<section class="m-tags">
<h3 class="m-submenu-title">Tags</h3>
<ul>
<li>
<a href="/tag/accountability/">accountability</a>
</li>
<li>
<a href="/tag/acme/">acme</a>
</li>
<li>
<a href="/tag/analytics/">analytics</a>
</li>
<li>
<a href="/tag/authentication/">authentication</a>
</li>
<li>
<a href="/tag/automation/">automation</a>
</li>
<li>
<a href="/tag/backup/">backup</a>
</li>
<li>
<a href="/tag/blog/">blog</a>
</li>
<li>
<a href="/tag/blogger/">blogger</a>
</li>
<li>
<a href="/tag/breach/">breach</a>
</li>
<li>
<a href="/tag/bugbounty/">bugbounty</a>
</li>
</ul>
</section>
</div>
</div>
</li>
</ul>
</nav>
<div class="m-nav__right">
<button class="m-icon-button in-menu-main js-open-search" aria-label="Open search">
<span class="icon-search" aria-hidden="true"></span>
</button>
<div class="m-toggle-darkmode js-tooltip" data-tippy-content="Toggle dark mode" tabindex="0">
<label for="toggle-darkmode" class="sr-only">
Toggle dark mode
</label>
<input id="toggle-darkmode" type="checkbox" class="js-toggle-darkmode">
<div>
<span class="icon-moon moon" aria-hidden="true"></span>
<span class="icon-sunny sun" aria-hidden="true"></span>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</header>
<main class="main-wrap">
<section class="m-hero with-picture" data-aos="fade">
<div class="m-hero__picture ">
<img srcset="
          /content/images/size/w300/2020/06/logo-navigate.png 300w,
          /content/images/size/w600/2020/06/logo-navigate.png 600w,
          /content/images/size/w1000/2020/06/logo-navigate.png 1000w,
          /content/images/size/w2000/2020/06/logo-navigate.png 2000w
        " sizes="(max-width: 600px) 600px, (max-width: 1000px) 1000px, 2000px" src="/content/images/size/w1000/2020/06/logo-navigate.png" alt="" />
</div>
<div class="m-hero__content" data-aos="fade-down">
<h1 class="m-hero-title bigger">Navigate CMS</h1>
<p class="m-hero-description">Findings from a live bug hunting exercise on Navigate CMS.</p>
</div>
</section>
<article>
<div class="l-content">
<div class="l-wrapper in-post" data-aos="fade-up" data-aos-delay="300">
<div class="l-post-content">
<div class="pos-relative js-post-content">
<p>I recently took part in a live bug hunting event:</p><figure class="kg-card kg-embed-card"><blockquote class="twitter-tweet" data-width="550"><p lang="en" dir="ltr">Who&#39;s excited for <a href="https://twitter.com/SecGus?ref_src=twsrc%5Etfw">@SecGus</a> going live in 1 hour with <a href="https://twitter.com/CalumBoal?ref_src=twsrc%5Etfw">@CalumBoal</a> for the first ever <a href="https://twitter.com/hashtag/HackStream?src=hash&amp;ref_src=twsrc%5Etfw">#HackStream</a>!<br><br>Live <a href="https://twitter.com/hashtag/BugHunting?src=hash&amp;ref_src=twsrc%5Etfw">#BugHunting</a> on <a href="https://twitter.com/hashtag/Stream?src=hash&amp;ref_src=twsrc%5Etfw">#Stream</a> trying to find some 0 days @ <a href="https://t.co/IJCwWiIO5G">https://t.co/IJCwWiIO5G</a><a href="https://twitter.com/hashtag/TT0dayHuntingNavigate?src=hash&amp;ref_src=twsrc%5Etfw">#TT0dayHuntingNavigate</a> <a href="https://t.co/nS3ho6JdWq">pic.twitter.com/nS3ho6JdWq</a></p>&mdash; OnSecurity - We&#39;re Hiring! (@HackersOnDemand) <a href="https://twitter.com/HackersOnDemand/status/1270401265705652224?ref_src=twsrc%5Etfw">June 9, 2020</a></blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</figure><p>As part of these event, we reviewed the product <a href="https://www.navigatecms.com/en/home">Navigate CMS</a>. In order to perform this review I setup a local instance of this tool, using version v2.9 r1433 (2020/06).</p><p>While taking part of this event, I managed to help identify several findings:</p><ul><li>User enumeration</li><li>Session information leakage</li><li>User password reset vulnerability</li><li>Store Cross-Site Scripting (XSS)</li><li>Reflected Cross-Site Scripting (XSS)</li></ul><h2 id="user-enumeration-cve-2020-14016">User Enumeration - CVE-2020-14016</h2><p>Navigate CMS has a <em>Forgot password?</em> feature, which allows a user to reset their password if they forgot what their current password is. </p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.sean-wright.com/content/images/2020/06/Annotation-2020-06-10-174043.png" class="kg-image" alt loading="lazy"><figcaption>Navigate CMS login page with <em>Forgot password?</em> link.</figcaption></figure><p>In order to use this feature the user supplies either their username associated with their account, or the email address which is associate with their account.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.sean-wright.com/content/images/2020/06/Annotation-2020-06-10-174535.png" class="kg-image" alt loading="lazy"><figcaption>Forgot password feature.</figcaption></figure><p>When entering the username or email address of a non-existent user, it produces and error stating that the user couldn't be found: </p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.sean-wright.com/content/images/2020/06/Annotation-2020-06-10-175247.png" class="kg-image" alt loading="lazy"><figcaption>Result of providing details of non-existent user.</figcaption></figure><p>When reviewing the HTTP response it can clearly be seen that the HTTP response responds with the message <em>not_found</em> in the response body:</p><h2 id="httprequest">HTTP request:</h2>
<pre><code>POST /navigate/login.php HTTP/1.1
Host: 192.168.0.130
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:77.0) Gecko/20100101 Firefox/77.0
Accept: */*
Accept-Language: en-GB,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
X-Csrf-Token: 236c7e771d9d104865dd84a095910bdeef4434443f7c55be1cdff82bb6037b7f
X-Requested-With: XMLHttpRequest
Content-Length: 36
Origin: http://192.168.0.130
Connection: close
Referer: http://192.168.0.130/navigate/login.php
Cookie: PHPSESSID=6ls0ko8kgh9fikeqt0a78cmp0t; navigate-tinymce-scroll=%7B%7D; NVSID_ff0d48a629500e15=6ls0ko8kgh9fikeqt0a78cmp0t

action=forgot-password&amp;value=invalid
</code></pre>
<h2 id="httpresponse">HTTP Response</h2>
<pre><code>HTTP/1.1 200 OK
Date: Wed, 10 Jun 2020 16:55:33 GMT
Server: Apache/2.4.41 (Ubuntu)
Set-Cookie: NVSID_ff0d48a629500e15=6ls0ko8kgh9fikeqt0a78cmp0t; path=/
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
Set-Cookie: NVSID_ff0d48a629500e15=6ls0ko8kgh9fikeqt0a78cmp0t; expires=Wed, 10-Jun-2020 17:55:33 GMT; Max-Age=3600; path=/; domain=192.168.0.130; HttpOnly; SameSite=Lax
Set-Cookie: PHPSESSID=6ls0ko8kgh9fikeqt0a78cmp0t; expires=Wed, 10-Jun-2020 17:55:33 GMT; Max-Age=3600; path=/; domain=192.168.0.130; HttpOnly; SameSite=Lax
X-Csrf-Token: 236c7e771d9d104865dd84a095910bdeef4434443f7c55be1cdff82bb6037b7f
Vary: Accept-Encoding
Connection: close
Content-Type: text/html; charset=utf-8
Content-Length: 9

not_found
</code></pre>
<p>Using this one can either use something such as a wordlist to try enumeration which users exist on the system:</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.sean-wright.com/content/images/2020/06/Annotation-2020-06-10-180904.png" class="kg-image" alt loading="lazy"><figcaption>User enumeration of the <em>Forgot password?</em> feature.</figcaption></figure><h2 id="session-information-leakage-cve-2020-14017">Session Information Leakage - CVE-2020-14017</h2><p>Navigate CMS stores session information in plaintext files on the server in the webroot. These files are then publicly available to un-authenticated users. As part of the setup, there is an option to copy/install the appropriate <em>.htaccess</em> files used to prevent access to this directory and files. However it appears that this doesn't prevent access with later versions of Apache HTTPD.</p><p>Depending how the server has been configured, it could be possible to view the contents of the directory:</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.sean-wright.com/content/images/2020/06/Annotation-2020-06-10-184731.png" class="kg-image" alt loading="lazy"><figcaption>Directory list of the directory private/sessions which contains all session files.</figcaption></figure><p>Upon navigating to one of the session files (most preferably the most recent), one is able to view details and sensitive information (such as CSRF tokens) which are associated with the session:</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.sean-wright.com/content/images/2020/06/Annotation-2020-06-10-185047.png" class="kg-image" alt loading="lazy"><figcaption>Details of session file.</figcaption></figure><p>If directory listing has been disabled on the webserver (such as via Apache configuration), an attacker is still able to access these files without authentication, however they would need to bruteforce the session IDs to find existing sessions and thus the existing session files:</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.sean-wright.com/content/images/2020/06/Annotation-2020-06-10-185609.png" class="kg-image" alt loading="lazy"><figcaption>Bruteforcing of session files.</figcaption></figure><h2 id="user-password-reset-vulnerability-cve-2020-14015">User Password Reset Vulnerability - CVE-2020-14015</h2><p>The <em>Forgot password?</em> feature allows a user to reset their password. When a user successfully enters their username or email address in the forgot password feature, an email is sent the user which contains a password reset link. This link contains an <em>activation code</em>, which allows the user to then reset the password associated with their account.</p><p>When providing an invalid code, the user is presented with the login screen:</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.sean-wright.com/content/images/2020/06/Annotation-2020-06-10-190110.png" class="kg-image" alt loading="lazy"><figcaption>Login screen with invalid password activation code.</figcaption></figure><p>However a flaw exists when no code is presented, the user is prompted for a new password:</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.sean-wright.com/content/images/2020/06/Annotation-2020-06-10-190458.png" class="kg-image" alt loading="lazy"><figcaption>Password reset for now password activation code.</figcaption></figure><p>And setting the password results in success:</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.sean-wright.com/content/images/2020/06/Annotation-2020-06-10-190548.png" class="kg-image" alt loading="lazy"><figcaption>Password reset successful.</figcaption></figure><p>Upon further investigation, the reason is that when a user is created, their account is created without an activation code:</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.sean-wright.com/content/images/2020/06/image.png" class="kg-image" alt loading="lazy"><figcaption>Database after user created.</figcaption></figure><p>When no code is supplied in the password reset process flow, the first user without an activation key will be matched and thus have their password reset.</p><h2 id="stored-cross-site-scripting-cve-2020-14018">Stored Cross-Site Scripting - CVE-2020-14018</h2><p>While there is HTML encoding on <em>User</em> field in the Users / Edit page, there is not sufficient encoding on the <em>E-Mail</em> field, these leaves it vulnerable to a store XSS vulnerability:</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.sean-wright.com/content/images/2020/06/image-1.png" class="kg-image" alt loading="lazy"><figcaption>Stored XSS from E-Mail field on the Users / Edit page.</figcaption></figure><p>As stated the <em>User</em> field is appropriate HTML encoded, preventing any XSS vulnerability from this field on this page:</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.sean-wright.com/content/images/2020/06/Annotation-2020-06-10-191329.png" class="kg-image" alt loading="lazy"><figcaption>HTML encoding of the <em>User</em> field.</figcaption></figure><p>However the E-Mail field is does not have sufficient HTML encoding, resulting in a stored XSS vulnerability:</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.sean-wright.com/content/images/2020/06/Annotation-2020-06-10-191629.png" class="kg-image" alt loading="lazy"><figcaption>XSS vulnerability in the <em>E-Mail</em> field.</figcaption></figure><p>This stored XSS vulnerability is persisted and present from both the <em>User</em> as well as the <em>E-Mail</em> fields when viewing users on the <em>Users</em> page:</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.sean-wright.com/content/images/2020/06/Annotation-2020-06-10-191809.png" class="kg-image" alt loading="lazy"><figcaption>Stored XSS from the <em>User</em> field.</figcaption></figure><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.sean-wright.com/content/images/2020/06/Annotation-2020-06-10-191809-1.png" class="kg-image" alt loading="lazy"><figcaption>Stored XSS from the <em>E-Mail </em>field.</figcaption></figure><h2 id="reflected-cross-site-scripting-cve-2020-14014">Reflected Cross-Site Scripting - CVE-2020-14014</h2><p>On the landing page once the user authenticates, there is a resource <em>/nagivate.php</em> which can take the query parameter <em>fid</em>. The value from this parameter is reflected back on the page, without having appropriate validation or HTML encoding. This makes the page vulnerable to reflected XSS:</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.sean-wright.com/content/images/2020/06/Annotation-2020-06-10-192137.png" class="kg-image" alt loading="lazy"><figcaption>Reflected XSS from the vulnerable <em>fid</em> query parameter.</figcaption></figure><p>This is since the value is reflected to a link in the top right corner of the page:</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.sean-wright.com/content/images/2020/06/Annotation-2020-06-10-192252.png" class="kg-image" alt loading="lazy"><figcaption>Reflected link contain the reflected XSS.</figcaption></figure><h2 id="resolution">Resolution</h2><p>Fixed as of version v2.9.1 r1487 (2020/06).</p><h2 id="vendor-notification">Vendor Notification</h2><ul><li>10 June 2020 - Initial contact with the vendor, indicating wish to share findings with vendor before disclosing publicly.</li><li>11 June 2020 - Received response from vendor expressing wish to obtain information about findings.</li><li>11 June 2020 - Forwarded findings to vendor.</li><li>17 June 2020 - Vendor shared fixes with myself and asked me to review the fixes.</li><li>21 June 2020 - Reviewed fixes and confirmed with vendor.</li><li>22 June 2020 - Vendor confirmed new version and approved public disclosure of findings.</li></ul>
</div>
</div>
</div>
</div>
</article>
</main>
<div class="m-search js-search" role="dialog" aria-modal="true" aria-label="Search">
<button class="m-icon-button outlined as-close-search js-close-search" aria-label="Close search">
<span class="icon-close" aria-hidden="true"></span>
</button>
<div class="m-search__content">
<form class="m-search__form">
<div class="pos-relative">
<span class="icon-search m-search-icon" aria-hidden="true"></span>
<label for="search-input" class="sr-only">
Type to search
</label>
<input id="search-input" type="text" class="m-input in-search js-input-search" placeholder="Type to search">
</div>
</form>
<div class="js-search-results hide"></div>
<p class="m-not-found align-center hide js-no-results">
No results for your search, please try with something else.
</p>
</div>
</div>
<footer class="m-footer">
<div class="m-footer__content">
<nav class="m-footer-social">
<a href="https://twitter.com/SeanWrightSec" target="_blank" rel="noopener" aria-label="Twitter">
<span class="icon-twitter" aria-hidden="true"></span>
</a>
<a href="https://blog.sean-wright.com/rss" aria-label="RSS">
<span class="icon-rss" aria-hidden="true"></span>
</a>
</nav>
<p class="m-footer-copyright">
<span>Sean Wright &copy; 2021</span>
<span>&nbsp; &bull; &nbsp;</span>
<span>Published with <a href="https://ghost.org" target="_blank" rel="noopener">Ghost</a></span>
</p>
<p class="m-footer-copyright jslicense">
<a href="/assets/html/javascript.html?v=d7e163d66c" rel="jslicense">JavaScript license information</a>
</p>
</div>
</footer>
<div class="m-alert success subscribe js-alert" data-notification="subscribe">
Great! You&#x27;ve successfully subscribed.
<button class="m-alert__close js-notification-close" aria-label="Close">
<span class="icon-close"></span>
</button>
</div>
<div class="m-alert success signup js-alert" data-notification="signup">
Great! Next, complete checkout for full access.
<button class="m-alert__close js-notification-close" aria-label="Close">
<span class="icon-close"></span>
</button>
</div>
<div class="m-alert success signin js-alert" data-notification="signin">
Welcome back! You&#x27;ve successfully signed in.
<button class="m-alert__close js-notification-close" aria-label="Close">
<span class="icon-close"></span>
</button>
</div>
<div class="m-alert success checkout js-alert" data-notification="checkout">
Success! Your account is fully activated, you now have access to all content.
<button class="m-alert__close js-notification-close" aria-label="Close">
<span class="icon-close"></span>
</button>
</div>
<script crossorigin="anonymous" src="https://polyfill.io/v3/polyfill.min.js?features=IntersectionObserver%2CPromise%2CArray.prototype.includes%2CString.prototype.endsWith%2CString.prototype.startsWith%2CObject.assign%2CNodeList.prototype.forEach"></script>
<script defer src="/assets/js/manifest.js?v=d7e163d66c"></script>
<script defer src="/assets/js/vendor/content-api.min.js?v=d7e163d66c"></script>
<script defer src="/assets/js/vendor.js?v=d7e163d66c"></script>
<script defer src="/assets/js/app.js?v=d7e163d66c"></script>
<script defer src="/assets/js/page.js?v=d7e163d66c"></script>
</body>
</html>
