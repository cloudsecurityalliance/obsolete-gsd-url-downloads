<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta http-equiv="X-Content-Type-Options" content="nosniff" />
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="X-XSS-Protection" content="1; mode=block" />
    <meta http-equiv="X-Frame-Options" content="SAMEORIGIN" />
    <meta http-equiv="Strict-Transport-Security" content="max-age=31536000; includeSubDomains" />
    <meta http-equiv="Referrer-Policy" content="same-origin" />

    <title>Multiple security vulnerabilities affect PAXSTORE (PAX Technology) - PSADV2021-001</title>
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="preload" href="/assets/css/app.css?v=53bc4809a6" as="style" />
    <link rel="preload" href="/assets/js/manifest.js?v=53bc4809a6" as="script" />
    <link rel="preload" href="/assets/js/vendor/content-api.min.js?v=53bc4809a6" as="script" />
    <link rel="preload" href="/assets/js/vendor.js?v=53bc4809a6" as="script" />
    <link rel="preload" href="/assets/js/app.js?v=53bc4809a6" as="script" />
    <link rel="preconnect" href="https://polyfill.io">
    <link rel="dns-prefetch" href="https://polyfill.io">

      <link rel="preload" href="/assets/css/post.css?v=53bc4809a6" as="style" />
  <link rel="preload" href="/assets/js/post.js?v=53bc4809a6" as="script" />


    <style>
      /* These font-faces are here to make fonts work if the Ghost instance is installed in a subdirectory */

      /* source-sans-pro-regular */
      @font-face {
        font-family: 'Source Sans Pro';
        font-style: normal;
        font-weight: 400;
        font-display: swap;
        src: local('Source Sans Pro Regular'), local('SourceSansPro-Regular'),
            url("/assets/fonts/source-sans-pro/latin/source-sans-pro-regular.woff2?v=53bc4809a6") format('woff2'),
            url("/assets/fonts/source-sans-pro/latin/source-sans-pro-regular.woff?v=53bc4809a6") format('woff');
      }

      /* source-sans-pro-600 */
      @font-face {
        font-family: 'Source Sans Pro';
        font-style: normal;
        font-weight: 600;
        font-display: swap;
        src: local('Source Sans Pro SemiBold'), local('SourceSansPro-SemiBold'),
            url("/assets/fonts/source-sans-pro/latin/source-sans-pro-600.woff2?v=53bc4809a6") format('woff2'),
            url("/assets/fonts/source-sans-pro/latin/source-sans-pro-600.woff?v=53bc4809a6") format('woff');
      }

      /* source-sans-pro-700 */
      @font-face {
        font-family: 'Source Sans Pro';
        font-style: normal;
        font-weight: 700;
        font-display: swap;
        src: local('Source Sans Pro Bold'), local('SourceSansPro-Bold'),
            url("/assets/fonts/source-sans-pro/latin/source-sans-pro-700.woff2?v=53bc4809a6") format('woff2'),
            url("/assets/fonts/source-sans-pro/latin/source-sans-pro-700.woff?v=53bc4809a6") format('woff');
      }

      /* iconmoon */
      @font-face {
        font-family: 'icomoon';
        font-weight: normal;
        font-style: normal;
        font-display: swap;
        src: url("/assets/fonts/icomoon/icomoon.eot?101fc3?v=53bc4809a6");
        src: url("/assets/fonts/icomoon/icomoon.eot?101fc3#iefix?v=53bc4809a6") format('embedded-opentype'),
        url("/assets/fonts/icomoon/icomoon.ttf?101fc3?v=53bc4809a6") format('truetype'),
        url("/assets/fonts/icomoon/icomoon.woff?101fc3?v=53bc4809a6") format('woff'),
        url("/assets/fonts/icomoon/icomoon.svg?101fc3#icomoon?v=53bc4809a6") format('svg');
      }
    </style>

    <link rel="stylesheet" type="text/css" href="/assets/css/app.css?v=53bc4809a6" media="screen" />

      <link rel="stylesheet" type="text/css" href="/assets/css/post.css?v=53bc4809a6" media="screen" />


    

    <link rel="icon" href="/favicon.png" type="image/png" />
    <link rel="canonical" href="https://blog.pridesec.com.br/en/multiple-security-vulnerabilities-affect-paxstore-pax-technology/" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    <link rel="amphtml" href="https://blog.pridesec.com.br/en/multiple-security-vulnerabilities-affect-paxstore-pax-technology/amp/" />
    
    <meta property="og:site_name" content="PRIDE Security Blog" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Multiple security vulnerabilities affect PAXSTORE (PAX Technology) - PSADV2021-001" />
    <meta property="og:description" content="Disclaimer  This Security Advisory is provided on an &amp;quot;as is&amp;quot; basis and do not imply any kind of guarantee or warranty. Your use of the information in this publication or linked materials is at your own risk. PRIDE Security reserves the right to change or update this content" />
    <meta property="og:url" content="https://blog.pridesec.com.br/en/multiple-security-vulnerabilities-affect-paxstore-pax-technology/" />
    <meta property="og:image" content="https://blog.pridesec.com.br/content/images/2021/05/arte_1920x1080-5.jpg" />
    <meta property="article:published_time" content="2021-05-14T12:00:00.000Z" />
    <meta property="article:modified_time" content="2021-05-14T23:05:06.000Z" />
    <meta property="article:tag" content="Pride Security" />
    <meta property="article:tag" content="PrideSec" />
    <meta property="article:tag" content="Security Advisory" />
    <meta property="article:tag" content="Hacking" />
    <meta property="article:tag" content="PAX TECHNOLOGY" />
    <meta property="article:tag" content="PAX STORE" />
    <meta property="article:tag" content="CVE" />
    
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Multiple security vulnerabilities affect PAXSTORE (PAX Technology) - PSADV2021-001" />
    <meta name="twitter:description" content="Disclaimer  This Security Advisory is provided on an &amp;quot;as is&amp;quot; basis and do not imply any kind of guarantee or warranty. Your use of the information in this publication or linked materials is at your own risk. PRIDE Security reserves the right to change or update this content" />
    <meta name="twitter:url" content="https://blog.pridesec.com.br/en/multiple-security-vulnerabilities-affect-paxstore-pax-technology/" />
    <meta name="twitter:image" content="https://blog.pridesec.com.br/content/images/2021/05/arte_1920x1080-5.jpg" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="PRIDE Security" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="Pride Security, PrideSec, Security Advisory, Hacking, PAX TECHNOLOGY, PAX STORE, CVE" />
    <meta property="og:image:width" content="1920" />
    <meta property="og:image:height" content="1080" />
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "PRIDE Security Blog",
        "url": "https://blog.pridesec.com.br/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://blog.pridesec.com.br/favicon.png",
            "width": 60,
            "height": 60
        }
    },
    "author": {
        "@type": "Person",
        "name": "PRIDE Security",
        "url": "https://blog.pridesec.com.br/author/pridesecurity/",
        "sameAs": [
            "https://www.pridesec.com.br"
        ]
    },
    "headline": "Multiple security vulnerabilities affect PAXSTORE (PAX Technology) - PSADV2021-001",
    "url": "https://blog.pridesec.com.br/en/multiple-security-vulnerabilities-affect-paxstore-pax-technology/",
    "datePublished": "2021-05-14T12:00:00.000Z",
    "dateModified": "2021-05-14T23:05:06.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://blog.pridesec.com.br/content/images/2021/05/arte_1920x1080-5.jpg",
        "width": 1920,
        "height": 1080
    },
    "keywords": "Pride Security, PrideSec, Security Advisory, Hacking, PAX TECHNOLOGY, PAX STORE, CVE",
    "description": " Disclaimer\nThis Security Advisory is provided on an &quot;as is&quot; basis and do not imply any kind\nof guarantee or warranty. Your use of the information in this publication or\nlinked materials is at your own risk. PRIDE Security\n[https://www.pridesec.com.br/] reserves the right to change or update this\ncontent without notice at any time.\n\nAbout manufacturer\nPAX Technology, founded in 2001, is one of the world leaders in payment\nterminals. PAX has delivered over 45 million terminals to more than 120\nco",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://blog.pridesec.com.br/"
    }
}
    </script>

    <meta name="generator" content="Ghost 4.20" />
    <link rel="alternate" type="application/rss+xml" title="PRIDE Security Blog" href="https://blog.pridesec.com.br/rss/" />
    <script defer src="https://unpkg.com/@tryghost/portal@~1.12.0/umd/portal.min.js" data-ghost="https://blog.pridesec.com.br/" crossorigin="anonymous"></script><style id="gh-members-styles">.gh-post-upgrade-cta-content,
.gh-post-upgrade-cta {
    display: flex;
    flex-direction: column;
    align-items: center;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    text-align: center;
    width: 100%;
    color: #ffffff;
    font-size: 16px;
}

.gh-post-upgrade-cta-content {
    border-radius: 8px;
    padding: 40px 4vw;
}

.gh-post-upgrade-cta h2 {
    color: #ffffff;
    font-size: 28px;
    letter-spacing: -0.2px;
    margin: 0;
    padding: 0;
}

.gh-post-upgrade-cta p {
    margin: 20px 0 0;
    padding: 0;
}

.gh-post-upgrade-cta small {
    font-size: 16px;
    letter-spacing: -0.2px;
}

.gh-post-upgrade-cta a {
    color: #ffffff;
    cursor: pointer;
    font-weight: 500;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a:hover {
    color: #ffffff;
    opacity: 0.8;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a.gh-btn {
    display: block;
    background: #ffffff;
    text-decoration: none;
    margin: 28px 0 0;
    padding: 8px 18px;
    border-radius: 4px;
    font-size: 16px;
    font-weight: 600;
}

.gh-post-upgrade-cta a.gh-btn:hover {
    opacity: 0.92;
}</style>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-TPYQZVTK0M"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TPYQZVTK0M');
</script><style>:root {--ghost-accent-color: #3c7da3;}</style>
    <link rel="alternate" href="https://blog.pridesec.com.br/br/multiple-security-vulnerabilities-affect-paxstore-pax-technology-psadv2021-001/" hreflang="br" />

    <script>
      // @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&dn=expat.txt Expat
      const ghostHost = "https://blog.pridesec.com.br"
      // @license-end
    </script>
  </head>
  <body class="post-template tag-hash-pax-adv tag-hash-en tag-pride-security tag-pridesec tag-security-advisory tag-hacking tag-pax-technology tag-pax-store tag-cve">
    
    

































  
<meta http-equiv="X-Content-Type-Options" content="nosniff" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="X-XSS-Protection" content="1; mode=block" />
<meta http-equiv="X-Frame-Options" content="SAMEORIGIN" />
<meta http-equiv="Strict-Transport-Security" content="max-age=31536000; includeSubDomains" />
<meta http-equiv="Referrer-Policy" content="same-origin" />

<header class="m-header with-picture js-header">
  <div class="m-mobile-topbar" data-aos="fade-down">
    <button class="m-icon-button in-mobile-topbar js-open-menu" aria-label="Open menu">
      <span class="icon-menu" aria-hidden="true"></span>
    </button>
      <a href="https://blog.pridesec.com.br" class="m-site-name in-mobile-topbar">
        PRIDE Security Blog
      </a>
    <button class="m-icon-button in-mobile-topbar js-open-search" aria-label="Open search">
      <span class="icon-search" aria-hidden="true"></span>
    </button>
  </div>

  <div class="m-menu js-menu">
    <button class="m-icon-button outlined as-close-menu js-close-menu" aria-label="Close menu">
      <span class="icon-close"></span>
    </button>
    <div class="m-menu__main" data-aos="fade-down">
      <div class="l-wrapper">
        <div class="m-nav js-main-nav">
          <nav class="m-nav__left js-main-nav-left" role="navigation" aria-label="Main menu">
            <ul>
                <li class="only-desktop">
                  <a href="https://blog.pridesec.com.br" class="m-site-name in-desktop-menu">
                    PRIDE Security Blog
                  </a>
                </li>
                              <li class="submenu-option js-submenu-option">
                <button class="m-icon-button in-menu-main more js-toggle-submenu" aria-label="Open submenu">
                  <span class="icon-more" aria-hidden="true"></span>
                </button>
                <div class="m-submenu js-submenu">
                  <div class="l-wrapper in-submenu">
                    <section class="m-recent-articles">
                      <h3 class="m-submenu-title in-recent-articles">Recent articles</h3>
                          <div class="glide js-recent-slider">
                            <div class="glide__track" data-glide-el="track">
                              <div class="glide__slides">
                                <div class="glide__slide">
                                  <a href="/en/multiple-security-vulnerabilities-affect-paxstore-pax-technology/" class="m-recent-article">
                                    <div class="m-recent-article__picture ">
                                        <img src="/content/images/size/w300/2021/05/arte_1920x1080-5.jpg" loading="lazy" alt="">
                                    </div>
                                    <h3 class="m-recent-article__title js-recent-article-title" title="Multiple security vulnerabilities affect PAXSTORE (PAX Technology) - PSADV2021-001">
                                      Multiple security vulnerabilities affect PAXSTORE (PAX Technology) - PSADV2021-001
                                    </h3>
                                    <span class="m-recent-article__date">5 months ago</span>
                                  </a>
                                </div>
                              </div>
                            </div>
                          </div>
                    </section>
                    <section class="m-tags">
                      <h3 class="m-submenu-title">Tags</h3>
                        <ul>
                            <li>
                              <a href="/tag/cve/">CVE</a>
                            </li>
                            <li>
                              <a href="/tag/hacking/">Hacking</a>
                            </li>
                            <li>
                              <a href="/tag/pax-store/">PAX STORE</a>
                            </li>
                            <li>
                              <a href="/tag/pax-technology/">PAX TECHNOLOGY</a>
                            </li>
                            <li>
                              <a href="/tag/pride-security/">Pride Security</a>
                            </li>
                            <li>
                              <a href="/tag/pridesec/">PrideSec</a>
                            </li>
                            <li>
                              <a href="/tag/security-advisory/">Security Advisory</a>
                            </li>
                        </ul>
                    </section>
                  </div>
                </div>
              </li>
            </ul>
          </nav>
          <div class="m-nav__right">
            <button class="m-icon-button in-menu-main js-open-search" aria-label="Open search">
              <span class="icon-search" aria-hidden="true"></span>
            </button>
            <div class="m-toggle-darkmode js-tooltip" data-tippy-content="Toggle dark mode" tabindex="0">
              <label for="toggle-darkmode" class="sr-only">
                Toggle dark mode
              </label>
              <input id="toggle-darkmode" type="checkbox" class="js-toggle-darkmode">
              <div>
                <span class="icon-moon moon" aria-hidden="true"></span>
                <span class="icon-sunny sun" aria-hidden="true"></span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

</header>


<main class="main-wrap">
    
  <section class="m-hero with-picture" data-aos="fade">
    <div class="m-hero__picture in-post">
      <img
        srcset="
          /content/images/size/w300/2021/05/arte_1920x1080-5.jpg 300w,
          /content/images/size/w600/2021/05/arte_1920x1080-5.jpg 600w,
          /content/images/size/w1000/2021/05/arte_1920x1080-5.jpg 1000w,
          /content/images/size/w2000/2021/05/arte_1920x1080-5.jpg 2000w
        "
        sizes="(max-width: 600px) 600px, (max-width: 1000px) 1000px, 2000px"
        src="/content/images/size/w1000/2021/05/arte_1920x1080-5.jpg"
        alt=""
      />
    </div>
    </section>

  <article>
    <div class="l-content in-post">
        <div class="l-wrapper in-post  js-aos-wrapper" data-aos="fade-up"
  data-aos-delay="300">
  <div
    class="l-post-content  has-subscribe-form js-progress-content">
    <header class="m-heading">
      <h1 class="m-heading__title in-post">Multiple security vulnerabilities affect PAXSTORE (PAX Technology) - PSADV2021-001</h1>
      <div class="m-heading__meta">

        <span class="m-heading__meta__time">May 14, 2021</span>
        <span class="m-heading__meta__divider" aria-hidden="true">&bull;</span>

            <a href="/br/multiple-security-vulnerabilities-affect-paxstore-pax-technology-psadv2021-001/" style="text-decoration: none;">
      Altere o idioma para 🇧🇷
          </a>
      </div>
    </header>
    <div class="pos-relative js-post-content">
      <div class="m-share">
        <div class="m-share__content js-sticky">
          <button class="m-icon-button filled in-share progress js-scrolltop" aria-label="Scroll to top">
            <span class="icon-arrow-top" aria-hidden="true"></span>
            <svg aria-hidden="true">
              <circle class="progress-ring__circle js-progress" fill="transparent" r="0" />
            </svg>
          </button>
        </div>
      </div>
      <!--kg-card-begin: html--><div style="text-align: justify"> <!--kg-card-end: html--><!--kg-card-begin: markdown--><p><strong>Disclaimer</strong><br>
This Security Advisory is provided on an &quot;as is&quot; basis and do not imply any kind of guarantee or warranty. Your use of the information in this publication or linked materials is at your own risk. <a href="https://www.pridesec.com.br/">PRIDE Security</a> reserves the right to change or update this content without notice at any time.</p>
<!--kg-card-end: markdown--><p><strong>About manufacturer</strong><br>PAX Technology, founded in 2001, is one of the world leaders in payment terminals. PAX has delivered over 45 million terminals to more than 120 countries around the world. Packed with the latest technology and internationally required security certifications.<br><em>Site:</em> <a href="https://marketing.paxtechnology.com/about-pax">https://marketing.paxtechnology.com/about-pax</a></p><p><strong>About the product</strong><br>PAXSTORE is a product of PAX Technology connecting over 1 million terminals, thousands of app developers, and more than 150 marketplaces in over 80 countries worldwide.<br><br>You can have your own independent marketplace in minutes. Full lifecycle POS apps management functionalities are ready for your using. You can create an out-of-the-box tailored apps solution based on the category of merchant and specific needs they require.<br><br>As the owner of a smart POS terminal, or if are an organization that manages a large number of such devices, you will have full management and monitoring capabilities and can perform real-time operations for the deployed terminals through PAXSTORE. <br><br>Rich payment industry value-added services, so that you can easily manage your terminals, apps and merchants. Business Intelligent will be your close assistant to do business strategy.<br><em>Site: </em><a href="https://www.whatspos.com/">https://www.whatspos.com/</a></p><p><strong>Versions affected</strong><br>PAXSTORE version 7.5 and lower (PAX Technology)</p><p><strong>Summary</strong><br>In July 2020, <a href="https://www.pridesec.com.br/">PRIDE Security</a> was hired to assess the security of software and hardware in PAX Technology’s products purchased by one of their customers. In December 2020, after the contractor mitigated the security issues found in its environment, PAX Technology was communicated about some of the software security vulnerabilities relevant to the PAXSTORE ecosystem.<br><br>These security issues discovered in the PAXSTORE marketplace’s APIs show a high security risk, since these vulnerabilities could compromise the entire environment when properly exploited by an attacker. In general, these vulnerabilities allow privilege escalation (horizontal and vertical), in addition permits to list and to read files from the Web server.<br><br><a href="https://www.pridesec.com.br/">PRIDE Security</a> is reporting these vulnerabilities with the purpose to awareness about the risks in PAXSTORE ecosystem, as well encouraging customers to immediate update to the latest version (8.0).</p><p><strong>Impact</strong><br>To illustrate the impact, during this engagement PRIDE Security abused this security issues to compromise the private keys of JWT token used by the marketplace analyzed and reused them to manipulate the access tokens to access the platform as any desired user (clients and administrators). Thereafter, an attacker could easily force the remote installation of any application in thousands of payment terminals managed by PAXSTORE. </p><p>It is worth mentioning that this technique could be used for several purposes, such as the creation of botnets aimed to launch Distributed Denial of Service (DDoS), theft financial information, force all payment terminals managed through the platform to stay in non-operating state (off-line), fraud, etc. <br><br>Based on the security issues identified in the PAXSTORE ecosystem, it is estimated that more than 150 PAXSTORE marketplaces in the world are currently vulnerable, and the lack of diligence can put millions of payment terminals at risk and cause immeasurable damage.</p><!--kg-card-begin: markdown--><h5 id="finding-1-xml-external-entity-%E2%80%93-xxe-cve-2020-36124">Finding 1: XML External Entity – XXE (CVE-2020-36124)</h5>
<p>The PAXSTORE ecosystem allows that anyone sign-up as a developer at marketplace (<a href="https://paxstore-marketpace-customer.com/developer">https://paxstore-marketpace-customer.com/developer</a>). As describe in the PAXSTORE documentation, the developer can define an XML template for its application.</p>
<p>However, two of those endpoints available in that panel, are vulnerable to XXE. They are:</p>
<ul>
<li>POST /p-market-web/v1/developers/apks/{App-ID}/paramTemplateSchema;</li>
<li>POST /p-market-web/v1/developers/{Dev-ID}/app/{App-ID}/paramAnalysis.</li>
</ul>
<p>Example - HTTPS Request (shortened):</p>
<pre><code>POST /p-market-web/v1/developers/apks/{APK-ID}/paramTemplateSchema HTTP/1.1
Host: api.a-paxstore-marketplace-domain.com
Authorization: Bearer Developer-Access-Token
X-Market-Domain: X-Market-Domain-Name
Content-Type: multipart/form-data; boundary=----WebKitFormBoundarykVegzdE7IoasleA2

------WebKitFormBoundarykVegzdE7IoasleA2
Content-Disposition: form-data; name=&quot;paramTemplateFile&quot;; filename=&quot;PrideSec.xml&quot;
Content-Type: text/xml

&lt;!DOCTYPE foo [&lt;!ENTITY load SYSTEM &quot;file:///path/to/conf/fs.properties&quot; &gt;]&gt;
&lt;Schema&gt;
&lt;Groups&gt;
&lt;Group&gt;
&lt;ID&gt;sys_G0&lt;/ID&gt;
&lt;Title&gt;&amp;load;&lt;/Title&gt;
…
&lt;/Group&gt;
&lt;/Groups&gt;
…
&lt;/Schema&gt;------WebKitFormBoundarykVegzdE7IoasleA2
Content-Disposition: form-data; name=&quot;paramTemplateName&quot;

undefined
------WebKitFormBoundarykVegzdE7IoasleA2--
</code></pre>
<p>Example - HTTPS Response (shortened):</p>
<pre><code>HTTP/1.1 200 
Content-Type: application/json;charset=UTF-8

{&quot;paramTemplateName&quot;:&quot;paramTemplateFile&quot;,&quot;groupList&quot;:[{&quot;id&quot;:&quot;&quot;,&quot;title&quot;:&quot;XXE-RETURN-HERE”…}]}]}]}
</code></pre>
<p>The <em>XML External Entity</em> injection (as known as XXE) is a security issue that allows an attacker to manipulate the processing of XML data. In this case, it allows the attacker to list and read files from the APIs server. Among the files accessible on the back-end, was possible to identify that the /path/to/conf/fs.properties contains sensitive information, such as signing keys.</p>
<!--kg-card-end: markdown--><!--kg-card-begin: markdown--><h5 id="finding-2-insecure-direct-object-references-%E2%80%93-idor-cve-2020-36126">Finding 2: Insecure direct object references – IDOR (CVE-2020-36126)</h5>
<p>PAXSTORE marketplace’s endpoints allows an authenticated user to read and write data not owned by them, including data from third-party users, application and payment terminals.</p>
<p>This behavior represents a <em>Broken Access Control – IDOR</em> vulnerability. In total, 26 endpoints were identified with this class of vulnerability.<br>
As described, this kind of vulnerability allows an attacker to impersonate any user, may lead to the unauthorized disclosure, modification or destruction of its information.</p>
<p>The following endpoints are vulnerable with <em>IDOR</em>:</p>
<ul>
<li>
<p>GET /p-market-web/v1/developers/apps/{App-ID}<br>
<em>It allows a developer to collect information about any application from marketplace, for example, the App Key and App Secret, given the App ID (sequential value starting from 1000000001).</em></p>
</li>
<li>
<p>PUT /p-market-web/v1/developers/apps/{App-ID}/appKey<br>
<em>It allows a developer to update sensitive information, as App Key and App Secret of any applications in the marketplace, given the AppID (sequential value starting from 1000000001).</em></p>
</li>
<li>
<p>GET /p-market-web/v1/terminals/{Terminal-ID}/installedApks<br>
<em>It allows an user without administrative privileges to list installed application in any payment terminal, given the Terminal ID (value with 10 numerical digits starting from &quot;1000&quot;).</em></p>
</li>
<li>
<p>DELETE /p-market-web/v1/users/notification/messages/{Message-ID}<br>
<em>It allows an user without administrative privileges to delete received message of other users, given the Message ID (value of 10 numerical digits starting from “1000”).</em></p>
</li>
<li>
<p>PUT /p-market-web/v1/developers/sandbox/terminals/{Sandbox-Terminal-ID}<br>
<em>It allows a developer to add sandbox terminals in other user’s accounts, given the Sandbox Terminal ID (sequential value starting from 1).</em></p>
</li>
<li>
<p>GET /p-market-web/v1/developers/sandbox/terminals/{Sandbox-Terminal-ID}<br>
<em>It allows a developer to collect information about sandbox terminals of other users, given Sandbox Terminal ID (sequential value starting from 1).</em></p>
</li>
<li>
<p>DELETE /p-market-web/v1/developers/sandbox/terminals/{Sandbox-Terminal-ID}<br>
<em>It allows a developer to delete sandbox terminal of other user’s accounts, given the Sandbox Terminal ID (sequential value starting from 1).</em></p>
</li>
<li>
<p>GET /p-market-web/v1/terminals/serialNo/{Terminal-SerialNo}<br>
<em>It allows an user without administrative privileges to collect information of any payment terminal, given the serial number (value with 10 numerical digits, usually starting from “117”).</em></p>
</li>
<li>
<p>GET /p-market-web/v1/users/{User-ID}<br>
<em>It allows a developer or reseller to collect user’s profile information (name, e-mail, phone number, login name, account privilege, last login timestamp, etc.), given the User ID (sequential value starting from 1000000001).</em></p>
</li>
<li>
<p>POST /p-market-web/v1/developers/enterprise/{User-ID}/admin?admin=true<br>
<em>It allows a developer to change the status Developer Admin (true or false) of any user’s accounts, given the victim User ID (sequential value starting from 1000000001).</em></p>
</li>
<li>
<p>POST /p-market-web/v1/feedbacks<br>
<em>It allows an user without administrative privileges to create feedback messages, with a crafted ID of any payment terminal in the payload, that can induce other users to believe that this message was created by the terminal owner.</em></p>
</li>
<li>
<p>DELETE /p-market-web/v1/feedbacks/{Feedback-ID}<br>
<em>It allows an user without administrative privileges to remove feedback messages, given its ID (sequential value starting from 1).</em></p>
</li>
<li>
<p>POST /p-market-web/v1/developers/apks/{Apk-ID}/originFile<br>
<em>It allows an user without administrative privileges to download (downloadTaskId) any Android application available at Store without platform signature, even those that are restrict for a specific resellers group. For that, an attacker must include the Apk-ID (sequential value starting from 1000000001).</em></p>
</li>
<li>
<p>DELETE /p-market-web/v1/developers/apps/{App-ID}<br>
<em>It allows a developer to delete application available in the marketplace, given the App ID (sequential value starting from 1000000001). Once done, it is impossible to restore the application deleted.</em></p>
</li>
<li>
<p>POST /p-market-web/v1/developers/apps/{App-ID}/apks/file<br>
<em>It allows a developer to add an APK in any application project, given the App ID (sequential value starting from 1000000001).</em></p>
</li>
<li>
<p>POST /p-market-web/v1/developers/apps/{App-ID}/apks/{Apk-ID}/file<br>
<em>It allows a developer to add a new APK version for any application in the marketplace, given the App ID and Apk ID.</em></p>
</li>
<li>
<p>DELETE /p-market-web/v1/developers/apps/{App-ID}/apks/{Apk-ID}<br>
<em>It allows a developer to remove a specific APK version of any application in the marketplace, given the App ID and ApkID.</em></p>
</li>
<li>
<p>POST /p-market-web/v1/developers/apps/{App-ID}/apks/{Apk-ID}/submit<br>
<em>It allows a developer to submit a new APK version to be approved for any application in the marketplace (even the ones not authorized to this developer), given App ID and Apk ID. If the administrator approves, the application will be available for download in the platform.</em></p>
</li>
<li>
<p>POST /p-market-web/v1/admin/apps/{App-ID}/specific<br>
<em>It allows a reseller to distribute any application in the marketplace (even the not available to this reseller) to their own POS terminals. With that, a reseller can access application distributed by other resellers.</em></p>
</li>
<li>
<p>GET /p-market-web/v1/admin/apps/{App-Id}/installed/terminals<br>
<em>It allows a reseller to verify which terminals downloaded a particular application, even for apps that they do not own.</em></p>
</li>
<li>
<p>POST /p-market-web/v1/admin/apps/apks/{Apk-ID}/file<br>
<em>It allows a reseller to download of any application from the marketplace, even those that they do not own.</em></p>
</li>
<li>
<p>GET /p-market-web/v1/terminals/{Terminal-ID}/configurations<br>
<em>It allows a reseller the access some hardware status of any payment terminal (ex.: GPS status, screen brightness, language, POS volume).</em></p>
</li>
<li>
<p>GET /p-market-web/v1/terminals/{Terminal-ID}/installedFirmware<br>
<em>It allows a reseller to access the firmware name installed in the POS terminal.</em></p>
</li>
<li>
<p>GET /p-market-web/v1/admin/apps<br>
<em>It allows a reseller to get a list of available applications in the marketplace, even those that they do not own.</em></p>
</li>
<li>
<p>GET /p-market-web/v1/guides/admin/docs/{Doc-ID}<br>
<em>It allows an user without administrative privileges to access documentation of the administrator panel guide, given the Doc-ID (sequential value starting from 1).</em></p>
</li>
<li>
<p>GET /p-market-web/v1/guides/super/docs/{Doc-ID}<br>
<em>It allows an user without administrative privileges to access the documentation of the global administration panel guide, given the Doc-ID (sequential value starting from 1).</em></p>
</li>
</ul>
<!--kg-card-end: markdown--><!--kg-card-begin: markdown--><h5 id="finding-3-obtaining-a-signing-certificate-and-its-password-cve-2020-36127">Finding 3: Obtaining a signing certificate and its password (CVE-2020-36127)</h5>
<p>PAXSTORE marketplace gives users with administrator privilege control over extra platform features, such as the public certificate key responsible for signing Android applications at payment terminals.</p>
<p>Opening the marketplace administration panel and accessing the PUK Signature functionality, the administrator will not have access to the current p12 certificate and password. That occurs due the Web application request the endpoint GET /p-market-web/v1/admin/signature.</p>
<p>When accessing this functionality, the user has the option to replace the current certificate through the interface and it is not possible to view the certificate password (p12) already deployed on the platform. However, an endpoint was identified, not accessible through the administrative interface, which returns the p12 certificate in base64 with its password, and both can be accessed even by users with reseller privilege.</p>
<p>The mentioned endpoint is:</p>
<ul>
<li>GET /p-market-web/v1/admin/signature/signaturePuk<br>
<em>Returns the current p12 certificate in base64 with its password.</em></li>
</ul>
<p>Example - HTTPS Request (shortened):</p>
<pre><code>GET /p-market-web/v1/admin/signature/signaturePuk HTTP/1.1
Host: api.a-paxstore-marketplace-domain.com
Authorization: Access-Token-from-Reseller-or-greater-privilege
X-Market-Domain: X-Market-Domain-Name
</code></pre>
<p>Example - HTTPS Response (shortened):</p>
<pre><code>HTTP/1.1 200 
Content-Type: application/json;charset=UTF-8

{…&quot;password&quot;:&quot;PASSWORD-RETURNED-HERE&quot;,&quot;certificateName&quot;:&quot;CERTIFICATE-NAME-RETURNED-HERE&quot;,&quot;certificate&quot;:&quot;CERTIFICATE-RETURNED-HERE&quot;…}
</code></pre>
<!--kg-card-end: markdown--><!--kg-card-begin: markdown--><h5 id="finding-4-x-terminal-token-can-be-retried-without-a-password-cve-2020-36128">Finding 4: X-Terminal-Token can be retried without a password (CVE-2020-36128)</h5>
<p>A payment terminal that has the marketplace application installed on its operating system allows the user to download the available applications.</p>
<p>Each payment terminal has a session token (called X-Terminal-Token) to access the marketplace. This allows the store to identify the terminal and make available the applications distributed by its reseller. In addition, all remote communication with the marketplace, which includes sending commands, changing hardware status (among others), is done based on the X-Terminal-Token token present in the terminal.</p>
<p>However, during the process to intercept HTTPS traffic from the application store, it was possible to collect the request responsible for assigning the X-Terminal-Token to the terminal and there is no password or security key that prevents the terminal from obtaining a X-Terminal-Token crafted pretending to be another device.</p>
<p>The mentioned endpoint is:</p>
<ul>
<li>POST /p-market-api/v1/terminal/login</li>
</ul>
<p>An attacker can use this behavior to authenticate its own payment terminal in the application store impersonating another device.</p>
<p>For example, this will allow a terminal to no longer be managed by its real reseller, or even to have access to other restricted applications.</p>
<!--kg-card-end: markdown--><!--kg-card-begin: markdown--><h5 id="finding-5-password-revalidation-in-sensitive-operations-can-be-bypassed-cve-2020-36125">Finding 5: Password revalidation in sensitive operations can be bypassed (CVE-2020-36125)</h5>
<p>The PAXSTORE marketplace gives users with administrator privilege the control over sensitive operations, like upload of a new certificate signature of Android application.</p>
<p>Every time that actions is requested, is necessary that user to enter its password again, even if the administrator is already authenticated. However, this password validation can be easily bypassed by requesting the endpoint directly. Thus, in a scenario where an attacker has access to a user's session, all types of action can be taken, even without the consent of the person responsible.</p>
<p>However, this validation, although performed on the backend, does not prevent the user from requesting the operation directly, for example, through the endpoint below.</p>
<ul>
<li>GET /p-market-web/v1/admin/signature</li>
</ul>
<p>Password revalidation is also required when trying to view the Access Secret of the credential belonging to integration with external systems. Also, when the authenticated user's password is unknown, it is possible to directly request the endpoint below, responsible for returning the Access Secret.</p>
<ul>
<li>GET /p-market-web/v1/admin/market/3rdsys/config/secret</li>
</ul>
<p>Note that the credential of external systems provides access to several sensitive application endpoints. To use them, just follow the steps of the PAXSTORE Open API project, available at GitHub (<a href="https://github.com/PAXSTORE/paxstore-openapi-java-sdk">https://github.com/PAXSTORE/paxstore-openapi-java-sdk</a>). Therefore, its exposure represents a relevant risk to applications.</p>
<!--kg-card-end: markdown--><p><strong>Vulnerabilities recommendation</strong><br>PAX Technology released version 8.0 where they informed <a href="https://www.pridesec.com.br/">PRIDE Security</a> that all the security issued above were fixed. </p><p>It's important to note that <a href="https://www.pridesec.com.br/">PRIDE Security</a> did not retested or confirmed that the fixes are effective.</p><p><strong>Communication timeline with manufacturer</strong><br>•	December 02, 2020	– Contact over e-mail (attempt 1).<br>•	December 30, 2020	– Contact over e-mail (attempt 2).<br>•	December 31, 2020	– PAX Technology acknowledge receipt of the email.<br>•	January 07, 2021		– PAX Technology  provides a roadmap to fix all issues.<br>•	April 25, 2021 			 – PAX Technology released version. 8.0 with fixes.<br>•	May 14, 2021 			  – Public release (PRIDE Security).</p><!--kg-card-begin: markdown--><p><strong>Acknowledgements</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Company</th>
</tr>
</thead>
<tbody>
<tr>
<td>Ricardo B. Gonçales</td>
<td>PRIDE Security</td>
</tr>
<tr>
<td>Andriel C. S. Biagioni</td>
<td>PRIDE Security</td>
</tr>
</tbody>
</table>
<!--kg-card-end: markdown--><!--kg-card-begin: markdown--><p><strong>About PRIDE Security</strong><br>
<a href="https://www.pridesec.com.br/">PRIDE Security</a> is a company specialized in information security that focuses on technical excellence and personalized services. Founded by information security experts, we have worked in various types of projects, from ATM (automated teller machines) penetration testing to national security projects.</p>
<p>Composed of an experienced team of more than 15 years in the market and with technical excellence proven by national and international technical recognition, <a href="https://www.pridesec.com.br/">PRIDE Security</a> sees in each project a new challenge to deliver more than expected.</p>
<p>As proof of international technical recognition, our professionals are constantly approved or invited to lecture on security events around the world. We cite below some examples of congresses, conferences and seminars focused on information security, which we participate as lecturers or coordinators of the technical groups:</p>
<p>• Blackhat – USA<br>
• RSA Conference – USA<br>
• Defcon – USA<br>
• ToorCon – USA<br>
• Blackhat – Europe edition<br>
• OWASP AppSec Research – Europe edition<br>
• OWASP AppSecEU09 – Europe edition<br>
• Troppers – Germany<br>
• H2HC (Hackers 2 Hackers Conference) – Brazil<br>
• YSTS (You Sh0t The Sheriff) – Brazil</p>
<p>In addition to lecturing at major security events around the world, our team of experts are also responsible for writing various papers, co-author of offensive technology patent registered in the United States of America (US8756697), finding and publishing security vulnerabilities in famous software such as Sun Solaris, FreeBSD / NetBSD kernel, QNX RTOS, Microsoft ISA Server, Microsoft Word, Adobe Flash, Adobe PDF, among others.</p>
<p>Many organizations of all sizes concerned with information security rely on <a href="https://www.pridesec.com.br/">PRIDE Security</a>. If you aim, we will be pleased to connect you with our customers to share about their experience with our services.</p>
<!--kg-card-end: markdown--><!--kg-card-begin: html--></div><!--kg-card-end: html-->
        <section class="m-tags in-post">
          <h3 class="m-submenu-title">Tags</h3>
          <ul>
              <li>
                <a href="/tag/pride-security/" title="Pride Security">Pride Security</a>
              </li>
              <li>
                <a href="/tag/pridesec/" title="PrideSec">PrideSec</a>
              </li>
              <li>
                <a href="/tag/security-advisory/" title="Security Advisory">Security Advisory</a>
              </li>
              <li>
                <a href="/tag/hacking/" title="Hacking">Hacking</a>
              </li>
              <li>
                <a href="/tag/pax-technology/" title="PAX TECHNOLOGY">PAX TECHNOLOGY</a>
              </li>
              <li>
                <a href="/tag/pax-store/" title="PAX STORE">PAX STORE</a>
              </li>
              <li>
                <a href="/tag/cve/" title="CVE">CVE</a>
              </li>
          </ul>
        </section>
    </div>
  </div>
</div>
  <section class="m-subscribe-section">
    <div class="l-wrapper in-post">
      <div class="m-subscribe-section__content">
        <div class="m-subscribe-section__text">
          <h4 class="m-subscribe-section__title">Subscribe to our newsletter</h4>
          <p class="m-subscribe-section__description">
            Get the latest posts delivered right to your inbox.
          </p>
        </div>
        <div class="m-subscribe-section__form">
          
<div class="m-subscribe-section__form">
  <form data-members-form="subscribe" id="newsletter-form" class="m-subscribe-section__container">
    <div class="m-subscribe__form">
      <div class="pos-relative">
           <label for="newsletter-input" class="sr-only">Your email address</label>
        <input data-members-email id="newsletter-input" class="m-input in-subscribe-section" type="email"
          placeholder="Your email address" required />
      </div>
          <button id="newsletter-button" class="m-button primary block" type="submit">Subscribe</button>
    </div>
    <div class="m-subscribe__success">
      <header class="m-heading no-margin">
        <img src="/assets/images/success.png?v=53bc4809a6" alt="Success!" class="m-subscribe__success_icon">
        <p class="m-heading__description in-newsletter-form">
          Now check your inbox and click the link to confirm your subscription.
        </p>
      </header>
    </div>
    <p class="m-subscribe__invalid m-small-text">
      Please enter a valid email address
    </p>
    <p class="m-subscribe__error m-small-text">
      Oops! There was an error sending the email, please try later.
    </p>
  </form>
</div>
        </div>
      </div>
    </div>
  </section>
<section class="m-author">
  <div class="m-author__content">
    <div class="m-author__picture">
      <a href="https://blog.pridesec.com.br/author/pridesecurity/" class="m-author-picture" aria-label="PRIDE Security">
          <div style="background-image: url(/assets/images/default-avatar-square-small.jpg?v=53bc4809a6);"></div>
      </a>
    </div>
    <div class="m-author__info">
      <h4 class="m-author__name">
        <a href="https://blog.pridesec.com.br/author/pridesecurity/">PRIDE Security</a>
      </h4>
        <p class="m-small-text in-author-along-with">
          Among with <a href="/author/ricardo/">Ricardo Bernardini</a>, <a href="/author/dril/">Andriel Biagioni</a>
        </p>
        <p class="m-author__bio">PRIDE Security is a consultancy specialized in information security that offers customized services and products to meet every business’ needs and goals.</p>
      <ul class="m-author-links">
          <li>
            <a href="https://www.pridesec.com.br" target="_blank" rel="noopener" aria-label="Website">
              <span class="icon-globe" aria-hidden="true"></span>
            </a>
          </li>
      </ul>
    </div>
  </div>
</section>

            





    <section class="m-recommended">
      <div class="l-wrapper in-recommended">
        <h3 class="m-section-title in-recommended">Recommended for you
</h3>
        <div class="m-recommended-articles">
          <div class="m-recommended-slider glide js-recommended-slider">
            <div class="glide__track" data-glide-el="track">
              <div class="glide__slides">
                <div class="m-recommended-slider__item glide__slide">
                  <div class="m-heading no-margin">
                    <h3>No posts found
</h3>
                    <p>
                      Apparently there are no posts at the moment, check again later.

                    </p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    </div>
  </article>
</main>



    
<div class="m-search js-search" role="dialog" aria-modal="true" aria-label="Search">
  <button class="m-icon-button outlined as-close-search js-close-search" aria-label="Close search">
    <span class="icon-close" aria-hidden="true"></span>
  </button>
  <div class="m-search__content">
    <form class="m-search__form">
      <div class="pos-relative">
        <span class="icon-search m-search-icon" aria-hidden="true"></span>
        <label for="search-input" class="sr-only">
          Type to search
        </label>
        <input id="search-input" type="text" class="m-input in-search js-input-search" placeholder="Type to search">
      </div>
    </form>
    <div class="js-search-results hide"></div>
    <p class="m-not-found align-center hide js-no-results">
      No results for your search, please try with something else.
    </p>
  </div>
</div>

      
<footer class="m-footer">
  <div class="m-footer__content">
    <nav class="m-footer-social">
      <a href="https://blog.pridesec.com.br/rss" aria-label="RSS">
        <span class="icon-rss" aria-hidden="true"></span>
      </a>
    </nav>
    <p class="m-footer-copyright">
      <span>PRIDE Security Blog &copy; 2021</span>
      <span>&nbsp; &bull; &nbsp;</span>
      <span>Powered by <a href="https://www.pridesec.com.br" target="_blank" rel="noopener">PRIDE Security</a></span>
    </p>
  </div>
</footer>


          <div class="m-alert success subscribe js-alert" data-notification="subscribe">
      Ótimo! Você se inscreveu com sucesso.
      <button class="m-alert__close js-notification-close" aria-label="Fechar">
        <span class="icon-close"></span>
      </button>
    </div>

      <div class="m-alert success signup js-alert" data-notification="signup">
        Ótimo! Agora, complete  o checkout para ter acesso completo.
        <button class="m-alert__close js-notification-close" aria-label="Fechar">
          <span class="icon-close"></span>
        </button>
      </div>

   <div class="m-alert success signin js-alert" data-notification="signin">
      Bem vindo de volta! Você fez login com sucesso.
      <button class="m-alert__close js-notification-close" aria-label="Fechar">
        <span class="icon-close"></span>
      </button>
    </div>

    <div class="m-alert success checkout js-alert" data-notification="checkout">
      Parábens! Sua conta está completamente ativada, agora você tem acesso completo ao conteúdo.
      <button class="m-alert__close js-notification-close" aria-label="Fechar">
        <span class="icon-close"></span>
      </button>
    </div>


    <script crossorigin="anonymous" src="https://polyfill.io/v3/polyfill.min.js?features=IntersectionObserver%2CPromise%2CArray.prototype.includes%2CString.prototype.endsWith%2CString.prototype.startsWith%2CObject.assign%2CNodeList.prototype.forEach"></script>
    <script defer src="/assets/js/manifest.js?v=53bc4809a6"></script>
    <script defer src="/assets/js/vendor/content-api.min.js?v=53bc4809a6"></script>
    <script defer src="/assets/js/vendor.js?v=53bc4809a6"></script>
    <script defer src="/assets/js/app.js?v=53bc4809a6"></script>

      <script defer src="/assets/js/post.js?v=53bc4809a6"></script>


    
  </body>
</html>
