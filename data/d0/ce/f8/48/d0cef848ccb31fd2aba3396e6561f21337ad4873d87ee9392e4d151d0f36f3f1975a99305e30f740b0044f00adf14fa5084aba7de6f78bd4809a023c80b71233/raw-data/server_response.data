<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
  "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>
    
    
      
    
    
      Issue 1669723002: NTP: don&#39;t allow navigateContentWindow to navigate where it pleases. -
    
    Code Review
  </title>
  <link rel="icon" href="/static/favicon.ico" />
  <link type="text/css" rel="stylesheet"
  href="/static/styles.css?v=408576698
" />
  <script type="text/javascript" src="/static/autocomplete/lib/jquery.js"></script>
  <script type="text/javascript"
    src="/static/script.js?v=408576698
"></script>
   <!-- head block to insert js/css for forms processing -->
   
   <!-- /head -->
</head>
<body onunload="M_unloadPage();">

<!-- Begin help window -->
<script type="text/javascript"><!--
var xsrfToken = '1605d08f757a7cca67f98a07b72e82db';
var helpDisplayed = false;
document.onclick = M_clickCommon;
var media_url = "/static/";
var base_url = "/";
// -->
</script>
<div id="help" style="display: none;">

<div style="font-size: medium; text-align: center;">Keyboard Shortcuts</div>
<hr />
<table class="shortcuts">
  <tr valign="top">
    <td>
      <table>
        <tr>
          <td></td><th>File</th>
        </tr>
        <tr>
          <td><span>u</span> <b>:</b></td><td>up to issue</td>
        </tr>
        <tr>
          <td><span>j</span> / <span>k</span> <b>:</b></td><td>jump to file after / before current file</td>
        </tr>
        <tr>
          <td><span>J</span> / <span>K</span> <b>:</b></td><td>jump to next file with a comment after / before current file</td>
        </tr>
        <tr>
          <td></td><th>Side-by-side diff</th>
        </tr>
        <tr>
          <td><span>i</span> <b>:</b></td><td>toggle intra-line diffs</td>
        </tr>
        <tr>
          <td><span>e</span> <b>:</b></td><td>expand all comments</td>
        </tr>
        <tr>
          <td><span>c</span> <b>:</b></td><td>collapse all comments</td>
        </tr>
        <tr>
          <td><span>s</span> <b>:</b></td><td>toggle showing all comments</td>
        </tr>
        <tr>
          <td><span>n</span> / <span>p</span> <b>:</b></td><td>next / previous diff chunk or comment</td>
        </tr>
        <tr>
          <td><span>N</span> / <span>P</span> <b>:</b></td><td>next / previous comment</td>
        </tr>
        <tr>
          <td><span>&lt;Up&gt;</span> / <span>&lt;Down&gt;</span> <b>:</b></td><td>next / previous line</td>
        </tr>
      </table>
    </td>
    <td>
      <table>
        <tr>
          <td></td><th>Issue</th>
        </tr>
        <tr>
          <td><span>u</span> <b>:</b></td><td>up to list of issues</td>
        </tr>
        <tr>
          <td><span>j</span> / <span>k</span> <b>:</b></td><td>jump to patch after / before current patch</td>
        </tr>
        <tr>
          <td><span>o</span> / <span>&lt;Enter&gt;</span> <b>:</b></td><td>open current patch in side-by-side view</td>
        </tr>
        <tr>
          <td><span>i</span> <b>:</b></td><td>open current patch in unified diff view</td>
        </tr>
        <tr><td>&nbsp;</td></tr>
          <tr><td></td><th>Issue List</th></tr>
        <tr>
          <td><span>j</span> / <span>k</span> <b>:</b></td><td>jump to issue after / before current issue</td>
        </tr>
        <tr>
          <td><span>o</span> / <span>&lt;Enter&gt;</span> <b>:</b></td><td>open current issue</td>
        </tr>
      </table>
    </td>
  </tr>

</table>
</div>
<!-- End help window -->

<div align="right">

<div style="float:left; font-size:x-large"><img style="vertical-align:middle" src="/static/chromium-24.png" /> Chromium Code Reviews</div>




<b>chromiumcodereview-hr@appspot.gserviceaccount.com (chromiumcodereview-hr)</b>
|

<span style="color:red">Please choose your nickname with</span>
<a class="novisit" href="/settings">Settings</a>
|


<a class="novisit" target="_blank"
   href="http://code.google.com/p/rietveld/wiki/CodeReviewHelp">Help</a>

|
<a class="novisit" href="http://www.chromium.org/">Chromium Project</a>
|
<a class="novisit" href="https://chromium-review.googlesource.com/dashboard/self?polygerrit=1">Gerrit Changes</a>
|

<a class="novisit" href="https://codereview.chromium.org/_ah/logout?continue=https://accounts.google.com/Logout%3Fcontinue%3Dhttps://uc.appengine.google.com/_ah/logout%253Fcontinue%253Dhttps://google.com/url%25253Fsa%25253DD%252526q%25253Dhttps://codereview.chromium.org/1669723002%252526ust%25253D1608719214034487%252526usg%25253DAFQjCNHfoAYD9gDCIISbhVZ2UhaNLWdDmg%26service%3Dah">Sign out</a>

</div>
<div class="counter">(232)</div>
<br />
<div class="mainmenu">
  
  <a href="/" class="active">Issues</a>
  <a href="/search">Search</a>

</div>
<div class="mainmenu2">
  
  
    &nbsp;&nbsp;&nbsp;
    <a href="/mine">My Issues</a>
    |
    <a href="/starred">Starred</a>
    &nbsp;&nbsp;&nbsp;
    <a href="/all?closed=0">Open</a>
    |
    <a href="/all?closed=1">Closed</a>
    |
    <a href="/all">All</a>
  

</div>

<div>

  <h2>
    <span id="issue-star-1669723002">
  
    
      <img src="/static/star-dark.gif" width="15" height="15" border="0">
    
  
</span>

    Issue <a href="/1669723002/"
               onmouseover="M_showPopUp(this, 'popup-issue');">
            1669723002</a>:
    NTP: don&#39;t allow navigateContentWindow to navigate where it pleases.  (Closed) 
  </h2>

  <table class="issue-details" border="0" width="100%">
    <tr valign="top">

      <td class="meta" width="20%">
        <div class="issue_details_sidebar">
          <div><b>Created:</b><br/>
            4 years, 10 months ago by <a href="/user/dcheng" onMouseOver="M_showUserInfoPopup(this)">dcheng</a>
          </div>
          <div><b>Modified:</b><br/>
            4 years, 10 months ago
          </div>
          <div><b>Reviewers:</b><br/>
            <a href="/user/jochen%20(gone%20-%20plz%20use%20gerrit)" onMouseOver="M_showUserInfoPopup(this)">jochen (gone - plz use gerrit)</a>, <a href="/user/Mathieu" onMouseOver="M_showUserInfoPopup(this)">Mathieu</a>, <a href="/user/samarth" onMouseOver="M_showUserInfoPopup(this)">samarth</a>, <span class='approval'><a href="/user/Marc%20Treib" onMouseOver="M_showUserInfoPopup(this)">Marc Treib</a></span>, <a href="/user/Nico" onMouseOver="M_showUserInfoPopup(this)">Nico</a>, <a href="/user/nasko" onMouseOver="M_showUserInfoPopup(this)">nasko</a>, <a href="/user/Robert%20Sesek" onMouseOver="M_showUserInfoPopup(this)">Robert Sesek</a>, <span class='approval'><a href="/user/Charlie%20Reis" onMouseOver="M_showUserInfoPopup(this)">Charlie Reis</a></span>, <span class='approval'><a href="/user/Jered" onMouseOver="M_showUserInfoPopup(this)">Jered</a></span>
          </div>
          
          <div><b>CC:</b><br/>
            chromium-apps-reviews_chromium.org, chromium-reviews, David Black, dhollowa+watch_chromium.org, donnd+watch_chromium.org, dougw+watch_chromium.org, extensions-reviews_chromium.org, jfweitz+watch_chromium.org, kmadhusu, melevin+watch_chromium.org, nasko, samarth, skanuj+watch_chromium.org
          </div>
          
          
          <div><b>Base URL:</b><br/>
            
            https://chromium.googlesource.com/chromium/src.git@master
            
          </div>
          
          
          <div><b>Target Ref:</b><br/>
            refs/pending/heads/master
          </div>
          
          
          <div><b>Project:</b><br/>
            <a href="/search?project=chromium">
              chromium
            </a>
          </div>
          
          <div><b>Visibility:</b><br/>
            
                Public.
            
          </div>
          
          <div><a title="Find reviews for the same repository ID - c14d891d44f0afff64e56ed7c9702df1d807b1ee"
               href="/search?repo_guid=c14d891d44f0afff64e56ed7c9702df1d807b1ee">
            <b>More Reviews</b></a>
          </div>
          
        </div>
      </td>

      <td style="padding-left: .8em; padding-right: .8em;" width="80%">
        




  <h3><a id="issue-description-pointer"
     href="javascript:M_toggleSection('issue-description')"
     class="toggled-section opentriangle">
    Description</a></h3>
  <div id="issue-description">NTP: don't allow navigateContentWindow to navigate where it pleases.

BUG=<a href="https://bugs.chromium.org/p/chromium/issues/detail?id=509313">509313</a>
Committed: <a href="https://crrev.com/d523a41aed4e321d4c8197b5cccb73be23c8dcc2">https://crrev.com/d523a41aed4e321d4c8197b5cccb73be23c8dcc2</a>
Cr-Commit-Position: refs/heads/master@{#373598}
  </div>




  <h3>
    <a id="ps-1-pointer"
       href="/1669723002/#ps1"
       onclick="M_toggleSectionForPS('1669723002', '1')"
       class="toggled-section ">
      Patch Set 1
      
      <span class="anchor">#</span>
    </a>
  </h3>

  

  <div id="ps-1"
  
       style="display:none">
  
  </div>
  

  <h3>
    <a id="ps-20001-pointer"
       href="/1669723002/#ps20001"
       onclick="M_toggleSectionForPS('1669723002', '20001')"
       class="toggled-section ">
      Patch Set 2
      : Check in browser ^_^
      <span class="anchor">#</span>
    </a>
  </h3>

  

  <div id="ps-20001"
  
       style="display:none">
  
  </div>
  

  <h3>
    <a id="ps-40001-pointer"
       href="/1669723002/#ps40001"
       onclick="M_toggleSectionForPS('1669723002', '40001')"
       class="toggled-section ">
      Patch Set 3
      : Move all checks into InstantService.
      <span class="anchor">#</span>
    </a>
  </h3>

  

  <div id="ps-40001"
  
       style="display:none">
  
  </div>
  

  <h3>
    <a id="ps-60001-pointer"
       href="/1669723002/#ps60001"
       onclick="M_toggleSectionForPS('1669723002', '60001')"
       class="toggled-section ">
      Patch Set 4
      : Some tests
      <span class="anchor">#</span>
    </a>
  </h3>

  

  <div id="ps-60001"
  
       style="display:none">
  
  </div>
  

  <h3>
    <a id="ps-80001-pointer"
       href="/1669723002/#ps80001"
       onclick="M_toggleSectionForPS('1669723002', '80001')"
       class="toggled-section ">
      Patch Set 5
      : Add a null check
      <span class="anchor">#</span>
    </a>
  </h3>

  

  <div id="ps-80001"
  
       style="display:none">
  
  </div>
  

  <h3>
    <a id="ps-100001-pointer"
       href="/1669723002/#ps100001"
       onclick="M_toggleSectionForPS('1669723002', '100001')"
       class="toggled-section ">
      Patch Set 6
      : Add missing _
      <span class="anchor">#</span>
    </a>
  </h3>

  
    <div>
      <i>Total comments:</i> 2
      
    </div>
  

  <div id="ps-100001"
  
       style="display:none">
  
  </div>
  

  <h3>
    <a id="ps-120001-pointer"
       href="/1669723002/#ps120001"
       onclick="M_toggleSectionForPS('1669723002', '120001')"
       class="toggled-section ">
      Patch Set 7
      : Use constants for schemes.
      <span class="anchor">#</span>
    </a>
  </h3>

  

  <div id="ps-120001"
  
       style="display:none">
  
  </div>
  

  <h3>
    <a id="ps-140001-pointer"
       href="/1669723002/#ps140001"
       onclick="M_toggleSectionForPS('1669723002', '140001')"
       class="toggled-section ">
      Patch Set 8
      : Let it navigate more places it pleases.
      <span class="anchor">#</span>
    </a>
  </h3>

  

  <div id="ps-140001"
  
       style="display:none">
  
  </div>
  

  <h3>
    <a id="ps-160001-pointer"
       href="/1669723002/#ps160001"
       onclick="M_toggleSectionForPS('1669723002', '160001')"
       class="toggled-section ">
      Patch Set 9
      : -IWYU
      <span class="anchor">#</span>
    </a>
  </h3>

  
    <div>
      <i>Total comments:</i> 8
      
    </div>
  

  <div id="ps-160001"
  
       style="display:none">
  
  </div>
  

  <h3>
    <a id="ps-180001-pointer"
       href="/1669723002/#ps180001"
       onclick="M_toggleSectionForPS('1669723002', '180001')"
       class="toggled-section ">
      Patch Set 10
      : Comments
      <span class="anchor">#</span>
    </a>
  </h3>

  
    <div>
      <i>Total comments:</i> 2
      
    </div>
  

  <div id="ps-180001"
  
       style="display:none">
  
  </div>
  

  <h3>
    <a id="ps-200001-pointer"
       href="/1669723002/#ps200001"
       onclick="M_toggleSectionForPS('1669723002', '200001')"
       class="toggled-section opentriangle">
      Patch Set 11
      : Better comments
      <span class="anchor">#</span>
    </a>
  </h3>

  

  <div id="ps-200001"
  
       style="">
    
<div class="issue-list">

  <div class="pagination">
    <div style="float: left;">
      <i>Created:</i> 4 years, 10 months ago
    </div>
    <div style="float: right;">
      
        Download
          <a href="/download/issue1669723002_200001.diff"
            title="Patchset in text format">[raw]</a>
          <a href="/tarball/1669723002/200001"
            title="Tarball containing the original and patched files">[tar.bz2]</a>
      
    </div>
    <div style="clear:both;"></div>
  </div>

  <table id="queues" style="clear:both;">
    <tr align="left">
      <th colspan="2"></th>
      <th>Unified diffs</th>
      <th>Side-by-side diffs</th>
      <th>Delta from patch set</th>
      <th colspan="3">Stats <font style='font-weight: normal'>(<i>+92 lines, -1 line</i>)</font></th>
      <th>Patch</th>
    </tr>

    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/1669723002/patch/200001/210002">
            chrome/browser/search/instant_service.h
          </a>
        </td>
        <td>
          <a class="noul"
             href="/1669723002/diff/200001/chrome/browser/search/instant_service.h">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/1669723002/diff2/1:200001/chrome/browser/search/instant_service.h"
             title="Delta from patch set 1">1</a>
        
        </td>
        
          <td style="white-space: nowrap">1 chunk</td>
          <td style="white-space: nowrap">+4 lines, -0 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue1669723002_200001_210002.diff"
             title="Download patch for chrome/browser/search/instant_service.h">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/1669723002/patch/200001/210001">
            chrome/browser/search/instant_service.cc
          </a>
        </td>
        <td>
          <a class="noul"
             href="/1669723002/diff/200001/chrome/browser/search/instant_service.cc">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/1669723002/diff2/1:200001/chrome/browser/search/instant_service.cc"
             title="Delta from patch set 1">1</a>
        
          <a href="/1669723002/diff2/20001:200001/chrome/browser/search/instant_service.cc"
             title="Delta from patch set 2">2</a>
        
          <a href="/1669723002/diff2/40001:200001/chrome/browser/search/instant_service.cc"
             title="Delta from patch set 3">3</a>
        
          <a href="/1669723002/diff2/60001:200001/chrome/browser/search/instant_service.cc"
             title="Delta from patch set 4">4</a>
        
          <a href="/1669723002/diff2/80001:200001/chrome/browser/search/instant_service.cc"
             title="Delta from patch set 5">5</a>
        
          <a href="/1669723002/diff2/100001:200001/chrome/browser/search/instant_service.cc"
             title="Delta from patch set 6">6</a>
        
          <a href="/1669723002/diff2/120001:200001/chrome/browser/search/instant_service.cc"
             title="Delta from patch set 7">7</a>
        
          <a href="/1669723002/diff2/140001:200001/chrome/browser/search/instant_service.cc"
             title="Delta from patch set 8">8</a>
        
        </td>
        
          <td style="white-space: nowrap">2 chunks</td>
          <td style="white-space: nowrap">+26 lines, -0 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue1669723002_200001_210001.diff"
             title="Download patch for chrome/browser/search/instant_service.cc">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/1669723002/patch/200001/210003">
            chrome/browser/search/instant_service_unittest.cc
          </a>
        </td>
        <td>
          <a class="noul"
             href="/1669723002/diff/200001/chrome/browser/search/instant_service_unittest.cc">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/1669723002/diff2/1:200001/chrome/browser/search/instant_service_unittest.cc"
             title="Delta from patch set 1">1</a>
        
          <a href="/1669723002/diff2/20001:200001/chrome/browser/search/instant_service_unittest.cc"
             title="Delta from patch set 2">2</a>
        
          <a href="/1669723002/diff2/40001:200001/chrome/browser/search/instant_service_unittest.cc"
             title="Delta from patch set 3">3</a>
        
          <a href="/1669723002/diff2/60001:200001/chrome/browser/search/instant_service_unittest.cc"
             title="Delta from patch set 4">4</a>
        
          <a href="/1669723002/diff2/80001:200001/chrome/browser/search/instant_service_unittest.cc"
             title="Delta from patch set 5">5</a>
        
          <a href="/1669723002/diff2/100001:200001/chrome/browser/search/instant_service_unittest.cc"
             title="Delta from patch set 6">6</a>
        
          <a href="/1669723002/diff2/120001:200001/chrome/browser/search/instant_service_unittest.cc"
             title="Delta from patch set 7">7</a>
        
        </td>
        
          <td style="white-space: nowrap">2 chunks</td>
          <td style="white-space: nowrap">+50 lines, -0 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue1669723002_200001_210003.diff"
             title="Download patch for chrome/browser/search/instant_service_unittest.cc">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/1669723002/patch/200001/210004">
            chrome/browser/ui/search/search_tab_helper.cc
          </a>
        </td>
        <td>
          <a class="noul"
             href="/1669723002/diff/200001/chrome/browser/ui/search/search_tab_helper.cc">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/1669723002/diff2/1:200001/chrome/browser/ui/search/search_tab_helper.cc"
             title="Delta from patch set 1">1</a>
        
          <a href="/1669723002/diff2/20001:200001/chrome/browser/ui/search/search_tab_helper.cc"
             title="Delta from patch set 2">2</a>
        
          <a href="/1669723002/diff2/40001:200001/chrome/browser/ui/search/search_tab_helper.cc"
             title="Delta from patch set 3">3</a>
        
          <a href="/1669723002/diff2/60001:200001/chrome/browser/ui/search/search_tab_helper.cc"
             title="Delta from patch set 4">4</a>
        
          <a href="/1669723002/diff2/80001:200001/chrome/browser/ui/search/search_tab_helper.cc"
             title="Delta from patch set 5">5</a>
        
          <a href="/1669723002/diff2/100001:200001/chrome/browser/ui/search/search_tab_helper.cc"
             title="Delta from patch set 6">6</a>
        
          <a href="/1669723002/diff2/120001:200001/chrome/browser/ui/search/search_tab_helper.cc"
             title="Delta from patch set 7">7</a>
        
          <a href="/1669723002/diff2/140001:200001/chrome/browser/ui/search/search_tab_helper.cc"
             title="Delta from patch set 8">8</a>
        
          <a href="/1669723002/diff2/160001:200001/chrome/browser/ui/search/search_tab_helper.cc"
             title="Delta from patch set 9">9</a>
        
          <a href="/1669723002/diff2/180001:200001/chrome/browser/ui/search/search_tab_helper.cc"
             title="Delta from patch set 10">10</a>
        
        </td>
        
          <td style="white-space: nowrap">1 chunk</td>
          <td style="white-space: nowrap">+9 lines, -0 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue1669723002_200001_210004.diff"
             title="Download patch for chrome/browser/ui/search/search_tab_helper.cc">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/1669723002/patch/200001/210005">
            chrome/renderer/searchbox/searchbox_extension.cc
          </a>
        </td>
        <td>
          <a class="noul"
             href="/1669723002/diff/200001/chrome/renderer/searchbox/searchbox_extension.cc">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/1669723002/diff2/1:200001/chrome/renderer/searchbox/searchbox_extension.cc"
             title="Delta from patch set 1">1</a>
        
          <a href="/1669723002/diff2/20001:200001/chrome/renderer/searchbox/searchbox_extension.cc"
             title="Delta from patch set 2">2</a>
        
          <a href="/1669723002/diff2/40001:200001/chrome/renderer/searchbox/searchbox_extension.cc"
             title="Delta from patch set 3">3</a>
        
          <a href="/1669723002/diff2/60001:200001/chrome/renderer/searchbox/searchbox_extension.cc"
             title="Delta from patch set 4">4</a>
        
          <a href="/1669723002/diff2/80001:200001/chrome/renderer/searchbox/searchbox_extension.cc"
             title="Delta from patch set 5">5</a>
        
          <a href="/1669723002/diff2/100001:200001/chrome/renderer/searchbox/searchbox_extension.cc"
             title="Delta from patch set 6">6</a>
        
          <a href="/1669723002/diff2/120001:200001/chrome/renderer/searchbox/searchbox_extension.cc"
             title="Delta from patch set 7">7</a>
        
          <a href="/1669723002/diff2/140001:200001/chrome/renderer/searchbox/searchbox_extension.cc"
             title="Delta from patch set 8">8</a>
        
          <a href="/1669723002/diff2/160001:200001/chrome/renderer/searchbox/searchbox_extension.cc"
             title="Delta from patch set 9">9</a>
        
        </td>
        
          <td style="white-space: nowrap">1 chunk</td>
          <td style="white-space: nowrap">+3 lines, -1 line</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue1669723002_200001_210005.diff"
             title="Download patch for chrome/renderer/searchbox/searchbox_extension.cc">
            Download
          </a>
        </td>
      </tr>
    
  </table>

  
  
</div>

  
  </div>
  
    <script language="JavaScript" type="text/javascript">
         <!--
         var lastPSId = 200001;
         // -->
       </script>
  




  <h3>
    <a id="messages-pointer"
       href="javascript:M_toggleSection('messages')"
       class="toggled-section opentriangle">
      Messages
    </a>
  </h3>

  
    <div><i>
    Total messages: 54 (17 generated)
    </i></div>
  

  <div id="messages">
    <div style="margin-bottom: .5em;">
      <a href="javascript:M_expandAllVisibleComments('cl', 54)">
        Expand Messages</a>
      |
      <a href="javascript:M_collapseAllVisibleComments('cl', 54)">
        Collapse Messages</a>
      
      |
      <a href="javascript:M_showGeneratedComments(54)">
        Show Generated Messages</a>
      |
      <a href="javascript:M_hideGeneratedComments(54)">
        Hide Generated Messages</a>
      
    </div>

    
      <div class="message    generated"
           style="display: none"
           id="generated-msg1"
           name="0">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(0)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>dcheng</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-0">
                          dcheng@chromium.org changed reviewers: + jochen@chromium.org
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 02:43:28 UTC)
                <a href="#msg1">#1</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-0"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-0"
            ><a href="mailto:dcheng@chromium.org">dcheng@chromium.org</a> changed reviewers:
+ <a href="mailto:jochen@chromium.org">jochen@chromium.org</a></pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg2"
           name="1">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(1)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>dcheng</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-1">
                          +jochen for primary review. The owners of this code appear to be inactive in Chromium, ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 02:52:40 UTC)
                <a href="#msg2">#2</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-1"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-1"
            >+jochen for primary review. The owners of this code appear to be inactive in
Chromium, but I&#39;ve CCed them as well.

Note that I would have preferred to implement this check in
SearchIPCRouter::OnSearchBoxNavigate, but there&#39;s a lot of delegate and policy
interfaces. So unfortunately, implementing the check in the concrete
implementation of SearchIPCRouter::Delegate used by the real browser is the
easiest way.

I&#39;m thinking about ways to add a unit test, but it&#39;s a bit tricky given how this
is currently written. I&#39;m guessing I&#39;ll end up friending a lot of random things.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    generated"
           style="display: none"
           id="generated-msg3"
           name="2">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(2)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>dcheng</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-2">
                          The CQ bit was checked by dcheng@chromium.org to run a CQ dry run
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 04:35:38 UTC)
                <a href="#msg3">#3</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-2"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-2"
            >The CQ bit was checked by <a href="mailto:dcheng@chromium.org">dcheng@chromium.org</a> to run a CQ dry run</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg4"
           name="3">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(3)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>commit-bot: I haz the power</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-3">
                          Dry run: CQ is trying da patch. Follow status at https://chromium-cq-status.appspot.com/patch-status/1669723002/80001 View timeline at https://chromium-cq-status.appspot.com/patch-timeline/1669723002/80001
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 04:36:13 UTC)
                <a href="#msg4">#4</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-3"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-3"
            >Dry run: CQ is trying da patch. Follow status at
 <a href="https://chromium-cq-status.appspot.com/patch-status/1669723002/80001" rel="nofollow">https://chromium-cq-status.appspot.com/patch-status/1669723002/80001</a>
View timeline at
 <a href="https://chromium-cq-status.appspot.com/patch-timeline/1669723002/80001" rel="nofollow">https://chromium-cq-status.appspot.com/patch-timeline/1669723002/80001</a></pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    generated"
           style="display: none"
           id="generated-msg5"
           name="4">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(4)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>commit-bot: I haz the power</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-4">
                          The CQ bit was unchecked by commit-bot@chromium.org
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 04:49:44 UTC)
                <a href="#msg5">#5</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-4"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-4"
            >The CQ bit was unchecked by <a href="mailto:commit-bot@chromium.org">commit-bot@chromium.org</a></pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg6"
           name="5">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(5)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>commit-bot: I haz the power</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-5">
                          Dry run: Try jobs failed on following builders: linux_chromium_chromeos_rel_ng on tryserver.chromium.linux (JOB_FAILED, http://build.chromium.org/p/tryserver.chromium.linux/builders/linux_chromium_chromeos_rel_ng/builds/161867)
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 04:49:45 UTC)
                <a href="#msg6">#6</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-5"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-5"
            >Dry run: Try jobs failed on following builders:
  linux_chromium_chromeos_rel_ng on tryserver.chromium.linux (JOB_FAILED,
<a href="http://build.chromium.org/p/tryserver.chromium.linux/builders/linux_chromium_chromeos_rel_ng/builds/161867" rel="nofollow">http://build.chromium.org/p/tryserver.chromium.linux/builders/linux_chromium_...</a>)</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    generated"
           style="display: none"
           id="generated-msg7"
           name="6">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(6)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>dcheng</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-6">
                          The CQ bit was checked by dcheng@chromium.org to run a CQ dry run
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 04:57:57 UTC)
                <a href="#msg7">#7</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-6"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-6"
            >The CQ bit was checked by <a href="mailto:dcheng@chromium.org">dcheng@chromium.org</a> to run a CQ dry run</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg8"
           name="7">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(7)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>commit-bot: I haz the power</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-7">
                          Dry run: CQ is trying da patch. Follow status at https://chromium-cq-status.appspot.com/patch-status/1669723002/100001 View timeline at https://chromium-cq-status.appspot.com/patch-timeline/1669723002/100001
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 04:58:42 UTC)
                <a href="#msg8">#8</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-7"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-7"
            >Dry run: CQ is trying da patch. Follow status at
 <a href="https://chromium-cq-status.appspot.com/patch-status/1669723002/100001" rel="nofollow">https://chromium-cq-status.appspot.com/patch-status/1669723002/100001</a>
View timeline at
 <a href="https://chromium-cq-status.appspot.com/patch-timeline/1669723002/100001" rel="nofollow">https://chromium-cq-status.appspot.com/patch-timeline/1669723002/100001</a></pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    generated"
           style="display: none"
           id="generated-msg9"
           name="8">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(8)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>commit-bot: I haz the power</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-8">
                          The CQ bit was unchecked by commit-bot@chromium.org
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 06:11:59 UTC)
                <a href="#msg9">#9</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-8"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-8"
            >The CQ bit was unchecked by <a href="mailto:commit-bot@chromium.org">commit-bot@chromium.org</a></pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg10"
           name="9">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(9)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>commit-bot: I haz the power</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-9">
                          Dry run: This issue passed the CQ dry run.
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 06:12:00 UTC)
                <a href="#msg10">#10</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-9"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-9"
            >Dry run: This issue passed the CQ dry run.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    generated"
           style="display: none"
           id="generated-msg11"
           name="10">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(10)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Marc Treib</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-10">
                          treib@chromium.org changed reviewers: + treib@chromium.org
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 14:00:13 UTC)
                <a href="#msg11">#11</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-10"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-10"
            ><a href="mailto:treib@chromium.org">treib@chromium.org</a> changed reviewers:
+ <a href="mailto:treib@chromium.org">treib@chromium.org</a></pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message  approval  "
           
           id="msg12"
           name="11">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(11)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Marc Treib</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-11">
                          LGTM (but I don&#39;t own anything here :-/) https://codereview.chromium.org/1669723002/diff/100001/chrome/browser/search/instant_service.cc File chrome/browser/search/instant_service.cc (right): https://codereview.chromium.org/1669723002/diff/100001/chrome/browser/search/instant_service.cc#newcode307 chrome/browser/search/instant_service.cc:307: if ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 14:00:14 UTC)
                <a href="#msg12">#12</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-11"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-11"
            >LGTM (but I don&#39;t own anything here :-/)

<a href="https://codereview.chromium.org/1669723002/diff/100001/chrome/browser/search/instant_service.cc" rel="nofollow">https://codereview.chromium.org/1669723002/diff/100001/chrome/browser/search/...</a>
File chrome/browser/search/instant_service.cc (right):

<a href="https://codereview.chromium.org/1669723002/diff/100001/chrome/browser/search/instant_service.cc#newcode307" rel="nofollow">https://codereview.chromium.org/1669723002/diff/100001/chrome/browser/search/...</a>
chrome/browser/search/instant_service.cc:307: if (url.SchemeIs(&quot;chrome&quot;) ||
url.SchemeIs(&quot;chrome-extension&quot;))
nit: content::kChromeUIScheme and extensions::kExtensionScheme, respectively</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg13"
           name="12">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(12)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Pam (message me for reviews)</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-12">
                          On 2016/02/04 14:00:14, Marc Treib wrote: &gt; LGTM (but I don&#39;t own anything here :-/) ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 15:56:19 UTC)
                <a href="#msg13">#13</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-12"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-12"
            >On 2016/02/04 14:00:14, Marc Treib wrote:
&gt; LGTM (but I don&#39;t own anything here :-/)
&gt; 
&gt;
<a href="https://codereview.chromium.org/1669723002/diff/100001/chrome/browser/search/instant_service.cc" rel="nofollow">https://codereview.chromium.org/1669723002/diff/100001/chrome/browser/search/...</a>
&gt; File chrome/browser/search/instant_service.cc (right):
&gt; 
&gt;
<a href="https://codereview.chromium.org/1669723002/diff/100001/chrome/browser/search/instant_service.cc#newcode307" rel="nofollow">https://codereview.chromium.org/1669723002/diff/100001/chrome/browser/search/...</a>
&gt; chrome/browser/search/instant_service.cc:307: if (url.SchemeIs(&quot;chrome&quot;) ||
&gt; url.SchemeIs(&quot;chrome-extension&quot;))
&gt; nit: content::kChromeUIScheme and extensions::kExtensionScheme, respectively

Jochen has been OOO today (Thursday CET), so feel free to bring in another owner
during the PST day.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    generated"
           style="display: none"
           id="generated-msg14"
           name="13">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(13)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>dcheng</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-13">
                          dcheng@chromium.org changed reviewers: + creis@chromium.org, nasko@chromium.org, thakis@chromium.org
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 16:21:00 UTC)
                <a href="#msg14">#14</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-13"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-13"
            ><a href="mailto:dcheng@chromium.org">dcheng@chromium.org</a> changed reviewers:
+ <a href="mailto:creis@chromium.org">creis@chromium.org</a>, <a href="mailto:nasko@chromium.org">nasko@chromium.org</a>, <a href="mailto:thakis@chromium.org">thakis@chromium.org</a></pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg15"
           name="14">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(14)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>dcheng</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-14">
                          +thakis for OWNERS review +creis, +nasko as navigation experts I was looking at the scheme ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 16:21:01 UTC)
                <a href="#msg15">#15</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-14"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-14"
            >+thakis for OWNERS review

+creis, +nasko as navigation experts

I was looking at the scheme blacklist, and I&#39;m wondering if there&#39;s a better
way: there are other &#39;weird&#39; schemes that I wouldn&#39;t expect to be valid
navigation targets for 1993 (such as chrome-devtools://). Do we need to worry
about other schemes here as well? Is there a more generic way to determine a
dangerous scheme that will grant a renderer additional privileges?

rsesek and I initially considered a whitelist approach, but were a little
worried that this might not capture everything a user might have in their most
visited items (e.g. I&#39;m not sure if an ftp URL could end up in there).

<a href="https://codereview.chromium.org/1669723002/diff/100001/chrome/browser/search/instant_service.cc" rel="nofollow">https://codereview.chromium.org/1669723002/diff/100001/chrome/browser/search/...</a>
File chrome/browser/search/instant_service.cc (right):

<a href="https://codereview.chromium.org/1669723002/diff/100001/chrome/browser/search/instant_service.cc#newcode307" rel="nofollow">https://codereview.chromium.org/1669723002/diff/100001/chrome/browser/search/...</a>
chrome/browser/search/instant_service.cc:307: if (url.SchemeIs(&quot;chrome&quot;) ||
url.SchemeIs(&quot;chrome-extension&quot;))
On 2016/02/04 at 14:00:14, Marc Treib wrote:
&gt; nit: content::kChromeUIScheme and extensions::kExtensionScheme, respectively

Ah, thanks. Done.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    generated"
           style="display: none"
           id="generated-msg16"
           name="15">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(15)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>dcheng</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-15">
                          The CQ bit was checked by dcheng@chromium.org to run a CQ dry run
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 16:21:07 UTC)
                <a href="#msg16">#16</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-15"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-15"
            >The CQ bit was checked by <a href="mailto:dcheng@chromium.org">dcheng@chromium.org</a> to run a CQ dry run</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg17"
           name="16">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(16)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>commit-bot: I haz the power</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-16">
                          Dry run: CQ is trying da patch. Follow status at https://chromium-cq-status.appspot.com/patch-status/1669723002/120001 View timeline at https://chromium-cq-status.appspot.com/patch-timeline/1669723002/120001
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 16:21:34 UTC)
                <a href="#msg17">#17</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-16"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-16"
            >Dry run: CQ is trying da patch. Follow status at
 <a href="https://chromium-cq-status.appspot.com/patch-status/1669723002/120001" rel="nofollow">https://chromium-cq-status.appspot.com/patch-status/1669723002/120001</a>
View timeline at
 <a href="https://chromium-cq-status.appspot.com/patch-timeline/1669723002/120001" rel="nofollow">https://chromium-cq-status.appspot.com/patch-timeline/1669723002/120001</a></pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg18"
           name="17">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(17)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Robert Sesek</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-17">
                          On 2016/02/04 16:21:01, dcheng wrote: &gt; I was looking at the scheme blacklist, and I&#39;m ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 16:35:15 UTC)
                <a href="#msg18">#18</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-17"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-17"
            >On 2016/02/04 16:21:01, dcheng wrote:
&gt; I was looking at the scheme blacklist, and I&#39;m wondering if there&#39;s a better
&gt; way: there are other &#39;weird&#39; schemes that I wouldn&#39;t expect to be valid
&gt; navigation targets for 1993 (such as chrome-devtools://). Do we need to worry
&gt; about other schemes here as well? Is there a more generic way to determine a
&gt; dangerous scheme that will grant a renderer additional privileges?
&gt; 
&gt; rsesek and I initially considered a whitelist approach, but were a little
&gt; worried that this might not capture everything a user might have in their most
&gt; visited items (e.g. I&#39;m not sure if an ftp URL could end up in there).

I was thinking about this more last night, and I think a whiltelist may be
better than a blacklist. I don&#39;t think schemes other than http, https, file, and
ftp should be allowed.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    generated"
           style="display: none"
           id="generated-msg19"
           name="18">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(18)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Jered</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-18">
                          jered@chromium.org changed reviewers: + jered@chromium.org, mathp@chromium.org
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 17:05:55 UTC)
                <a href="#msg19">#19</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-18"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-18"
            ><a href="mailto:jered@chromium.org">jered@chromium.org</a> changed reviewers:
+ <a href="mailto:jered@chromium.org">jered@chromium.org</a>, <a href="mailto:mathp@chromium.org">mathp@chromium.org</a></pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message  approval  "
           
           id="msg20"
           name="19">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(19)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Jered</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-19">
                          +mathp will this break most likely? Given the immediate concerns this lgtm.
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 17:05:55 UTC)
                <a href="#msg20">#20</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-19"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-19"
            >+mathp will this break most likely?

Given the immediate concerns this lgtm.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg21"
           name="20">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(20)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Mathieu</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-20">
                          On 2016/02/04 17:05:55, Jered wrote: &gt; +mathp will this break most likely? &gt; &gt; Given ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 17:11:26 UTC)
                <a href="#msg21">#21</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-20"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-20"
            >On 2016/02/04 17:05:55, Jered wrote:
&gt; +mathp will this break most likely?
&gt; 
&gt; Given the immediate concerns this lgtm.

Depends if the SuggestionsService is used. Since it&#39;s becoming the default soon
for the server NTP (finkm@ and team can confirm), I&#39;d say that it won&#39;t break
it. If the current server side code ran on this then yes it would break (because
|suggestions_items_| wouldn&#39;t know about the most likely items).</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    generated"
           style="display: none"
           id="generated-msg22"
           name="21">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(21)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>commit-bot: I haz the power</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-21">
                          The CQ bit was unchecked by commit-bot@chromium.org
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 17:12:10 UTC)
                <a href="#msg22">#22</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-21"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-21"
            >The CQ bit was unchecked by <a href="mailto:commit-bot@chromium.org">commit-bot@chromium.org</a></pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg23"
           name="22">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(22)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>commit-bot: I haz the power</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-22">
                          Dry run: This issue passed the CQ dry run.
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 17:12:11 UTC)
                <a href="#msg23">#23</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-22"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-22"
            >Dry run: This issue passed the CQ dry run.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg24"
           name="23">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(23)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Charlie Reis</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-23">
                          On 2016/02/04 16:35:15, Robert Sesek wrote: &gt; On 2016/02/04 16:21:01, dcheng wrote: &gt; &gt; I ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 17:13:32 UTC)
                <a href="#msg24">#24</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-23"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-23"
            >On 2016/02/04 16:35:15, Robert Sesek wrote:
&gt; On 2016/02/04 16:21:01, dcheng wrote:
&gt; &gt; I was looking at the scheme blacklist, and I&#39;m wondering if there&#39;s a better
&gt; &gt; way: there are other &#39;weird&#39; schemes that I wouldn&#39;t expect to be valid
&gt; &gt; navigation targets for 1993 (such as chrome-devtools://). Do we need to
worry
&gt; &gt; about other schemes here as well? Is there a more generic way to determine a
&gt; &gt; dangerous scheme that will grant a renderer additional privileges?
&gt; &gt; 
&gt; &gt; rsesek and I initially considered a whitelist approach, but were a little
&gt; &gt; worried that this might not capture everything a user might have in their
most
&gt; &gt; visited items (e.g. I&#39;m not sure if an ftp URL could end up in there).
&gt; 
&gt; I was thinking about this more last night, and I think a whiltelist may be
&gt; better than a blacklist. I don&#39;t think schemes other than http, https, file,
and
&gt; ftp should be allowed.

On one hand, I&#39;d love to lock it down to a whitelist. 
ChildProcessSecurityPolicy::IsWebSafeScheme might be a good candidate.

On the other hand, what restrictions do we have on the most visited and
suggestion URLs?  Can chrome-extension:// URLs show up there (e.g., if they&#39;re
web accessible)?  Can chrome:// URLs?  (Hopefully not.)  I don&#39;t want to
introduce a regression where users can&#39;t click on those tiles, assuming that the
tiles use this API.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg25"
           name="24">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(24)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Robert Sesek</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-24">
                          On 2016/02/04 17:13:32, Charlie Reis wrote: &gt; On 2016/02/04 16:35:15, Robert Sesek wrote: &gt; &gt; ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 17:17:46 UTC)
                <a href="#msg25">#25</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-24"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-24"
            >On 2016/02/04 17:13:32, Charlie Reis wrote:
&gt; On 2016/02/04 16:35:15, Robert Sesek wrote:
&gt; &gt; On 2016/02/04 16:21:01, dcheng wrote:
&gt; &gt; &gt; I was looking at the scheme blacklist, and I&#39;m wondering if there&#39;s a
better
&gt; &gt; &gt; way: there are other &#39;weird&#39; schemes that I wouldn&#39;t expect to be valid
&gt; &gt; &gt; navigation targets for 1993 (such as chrome-devtools://). Do we need to
&gt; worry
&gt; &gt; &gt; about other schemes here as well? Is there a more generic way to determine
a
&gt; &gt; &gt; dangerous scheme that will grant a renderer additional privileges?
&gt; &gt; &gt; 
&gt; &gt; &gt; rsesek and I initially considered a whitelist approach, but were a little
&gt; &gt; &gt; worried that this might not capture everything a user might have in their
&gt; most
&gt; &gt; &gt; visited items (e.g. I&#39;m not sure if an ftp URL could end up in there).
&gt; &gt; 
&gt; &gt; I was thinking about this more last night, and I think a whiltelist may be
&gt; &gt; better than a blacklist. I don&#39;t think schemes other than http, https, file,
&gt; and
&gt; &gt; ftp should be allowed.
&gt; 
&gt; On one hand, I&#39;d love to lock it down to a whitelist. 
&gt; ChildProcessSecurityPolicy::IsWebSafeScheme might be a good candidate.
&gt; 
&gt; On the other hand, what restrictions do we have on the most visited and
&gt; suggestion URLs?  Can chrome-extension:// URLs show up there (e.g., if they&#39;re
&gt; web accessible)?  Can chrome:// URLs?  (Hopefully not.)  I don&#39;t want to
&gt; introduce a regression where users can&#39;t click on those tiles, assuming that
the
&gt; tiles use this API.

I&#39;ve been trying to dig into that, but it&#39;s kind of a complicated subsystem.
TopSites gets its data from the HistoryService, and so I&#39;m not sure at what
layer a scheme filter would be applied at. I agree that whatever whitelist we
come up with should apply to both the frontend and backend.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg26"
           name="25">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(25)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Charlie Reis</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-25">
                          On 2016/02/04 17:13:32, Charlie Reis wrote: &gt; On 2016/02/04 16:35:15, Robert Sesek wrote: &gt; &gt; ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 17:18:15 UTC)
                <a href="#msg26">#26</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-25"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-25"
            >On 2016/02/04 17:13:32, Charlie Reis wrote:
&gt; On 2016/02/04 16:35:15, Robert Sesek wrote:
&gt; &gt; On 2016/02/04 16:21:01, dcheng wrote:
&gt; &gt; &gt; I was looking at the scheme blacklist, and I&#39;m wondering if there&#39;s a
better
&gt; &gt; &gt; way: there are other &#39;weird&#39; schemes that I wouldn&#39;t expect to be valid
&gt; &gt; &gt; navigation targets for 1993 (such as chrome-devtools://). Do we need to
&gt; worry
&gt; &gt; &gt; about other schemes here as well? Is there a more generic way to determine
a
&gt; &gt; &gt; dangerous scheme that will grant a renderer additional privileges?
&gt; &gt; &gt; 
&gt; &gt; &gt; rsesek and I initially considered a whitelist approach, but were a little
&gt; &gt; &gt; worried that this might not capture everything a user might have in their
&gt; most
&gt; &gt; &gt; visited items (e.g. I&#39;m not sure if an ftp URL could end up in there).
&gt; &gt; 
&gt; &gt; I was thinking about this more last night, and I think a whiltelist may be
&gt; &gt; better than a blacklist. I don&#39;t think schemes other than http, https, file,
&gt; and
&gt; &gt; ftp should be allowed.
&gt; 
&gt; On one hand, I&#39;d love to lock it down to a whitelist. 
&gt; ChildProcessSecurityPolicy::IsWebSafeScheme might be a good candidate.
&gt; 
&gt; On the other hand, what restrictions do we have on the most visited and
&gt; suggestion URLs?  Can chrome-extension:// URLs show up there (e.g., if they&#39;re
&gt; web accessible)?  Can chrome:// URLs?  (Hopefully not.)  I don&#39;t want to
&gt; introduce a regression where users can&#39;t click on those tiles, assuming that
the
&gt; tiles use this API.

For example, see this comment in search_ipc_router.h:

    // Called when the page wants to navigate to |url|. Usually used by the
    // page to navigate to privileged destinations (e.g. chrome:// URLs) or to
    // navigate to URLs that are hidden from the page using Restricted IDs (rid
    // in the API).
    virtual void NavigateToURL(const GURL&amp; url,
                               WindowOpenDisposition disposition,
                               bool is_most_visited_item_url) = 0;

It makes me sad that there are apparently no tests covering this behavior, if it
was actually introduced to support navigations to privileged URLs.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    generated"
           style="display: none"
           id="generated-msg27"
           name="26">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(26)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>samarth</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-26">
                          samarth@chromium.org changed reviewers: + samarth@chromium.org - rsesek@chromium.org
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 17:20:43 UTC)
                <a href="#msg27">#27</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-26"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-26"
            ><a href="mailto:samarth@chromium.org">samarth@chromium.org</a> changed reviewers:
+ <a href="mailto:samarth@chromium.org">samarth@chromium.org</a>
- <a href="mailto:rsesek@chromium.org">rsesek@chromium.org</a></pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg28"
           name="27">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(27)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>samarth</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-27">
                          We could also make this check in the renderer process in searchbox_extension here: https://code.google.com/p/chromium/codesearch#chromium/src/chrome/renderer/searchbox/searchbox_extension.cc&amp;q=searchbox_exte&amp;sq=package:chromium&amp;l=1138 Note ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 17:20:44 UTC)
                <a href="#msg28">#28</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-27"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-27"
            >We could also make this check in the renderer process in  searchbox_extension
here:
<a href="https://code.google.com/p/chromium/codesearch#chromium/src/chrome/renderer/searchbox/searchbox_extension.cc&amp;q=searchbox_exte&amp;sq=package:chromium&amp;l=1138" rel="nofollow">https://code.google.com/p/chromium/codesearch#chromium/src/chrome/renderer/se...</a>

Note that it has access to the most visited items:
<a href="https://code.google.com/p/chromium/codesearch#chromium/src/chrome/renderer/searchbox/searchbox.cc&amp;sq=package:chromium&amp;l=308&amp;rcl=1454589471" rel="nofollow">https://code.google.com/p/chromium/codesearch#chromium/src/chrome/renderer/se...</a>

On one hand, that&#39;s where the check for javascript: scheme resides and it&#39;d be
better for these checks to be centralized.  But I don&#39;t know if it&#39;s preferable
to have these be in the browser process instead.

Thanks,
Samarth</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg29"
           name="28">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(28)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Charlie Reis</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-28">
                          On 2016/02/04 17:20:44, samarth wrote: &gt; We could also make this check in the renderer ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 17:26:25 UTC)
                <a href="#msg29">#29</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-28"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-28"
            >On 2016/02/04 17:20:44, samarth wrote:
&gt; We could also make this check in the renderer process in  searchbox_extension
&gt; here:
&gt;
<a href="https://code.google.com/p/chromium/codesearch#chromium/src/chrome/renderer/searchbox/searchbox_extension.cc&amp;q=searchbox_exte&amp;sq=package:chromium&amp;l=1138" rel="nofollow">https://code.google.com/p/chromium/codesearch#chromium/src/chrome/renderer/se...</a>
&gt; 
&gt; Note that it has access to the most visited items:
&gt;
<a href="https://code.google.com/p/chromium/codesearch#chromium/src/chrome/renderer/searchbox/searchbox.cc&amp;sq=package:chromium&amp;l=308&amp;rcl=1454589471" rel="nofollow">https://code.google.com/p/chromium/codesearch#chromium/src/chrome/renderer/se...</a>
&gt; 
&gt; On one hand, that&#39;s where the check for javascript: scheme resides and it&#39;d be
&gt; better for these checks to be centralized.  But I don&#39;t know if it&#39;s
preferable
&gt; to have these be in the browser process instead.
&gt; 
&gt; Thanks,
&gt; Samarth

Thanks for looking.  We definitely want to enforce this in the browser process,
though I&#39;m not opposed to also having a check in the renderer process.

Samarth, it looks like you added the comment about using this API for privileged
URLs in <a href="https://codereview.chromium.org/11824050" rel="nofollow">https://codereview.chromium.org/11824050</a> (in instant_page.h at the
time).  Can you let us know why that was needed and what will break if we
prevent it now?</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg30"
           name="29">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(29)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>samarth</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-29">
                          On 2016/02/04 17:26:25, Charlie Reis wrote: &gt; On 2016/02/04 17:20:44, samarth wrote: &gt; &gt; We ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 17:43:46 UTC)
                <a href="#msg30">#30</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-29"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-29"
            >On 2016/02/04 17:26:25, Charlie Reis wrote:
&gt; On 2016/02/04 17:20:44, samarth wrote:
&gt; &gt; We could also make this check in the renderer process in 
searchbox_extension
&gt; &gt; here:
&gt; &gt;
&gt;
<a href="https://code.google.com/p/chromium/codesearch#chromium/src/chrome/renderer/searchbox/searchbox_extension.cc&amp;q=searchbox_exte&amp;sq=package:chromium&amp;l=1138" rel="nofollow">https://code.google.com/p/chromium/codesearch#chromium/src/chrome/renderer/se...</a>
&gt; &gt; 
&gt; &gt; Note that it has access to the most visited items:
&gt; &gt;
&gt;
<a href="https://code.google.com/p/chromium/codesearch#chromium/src/chrome/renderer/searchbox/searchbox.cc&amp;sq=package:chromium&amp;l=308&amp;rcl=1454589471" rel="nofollow">https://code.google.com/p/chromium/codesearch#chromium/src/chrome/renderer/se...</a>
&gt; &gt; 
&gt; &gt; On one hand, that&#39;s where the check for javascript: scheme resides and it&#39;d
be
&gt; &gt; better for these checks to be centralized.  But I don&#39;t know if it&#39;s
&gt; preferable
&gt; &gt; to have these be in the browser process instead.
&gt; &gt; 
&gt; &gt; Thanks,
&gt; &gt; Samarth
&gt; 
&gt; Thanks for looking.  We definitely want to enforce this in the browser
process,
&gt; though I&#39;m not opposed to also having a check in the renderer process.
&gt; 
&gt; Samarth, it looks like you added the comment about using this API for
privileged
&gt; URLs in <a href="https://codereview.chromium.org/11824050" rel="nofollow">https://codereview.chromium.org/11824050</a> (in instant_page.h at the
&gt; time).  Can you let us know why that was needed and what will break if we
&gt; prevent it now?

There&#39;s a long history behind NavigateContentWindow.

In the beginning, this API was meant to be used both for most visited items as
well as for suggestions in the HTML-based omnibox popup.  The latter never
launched.  In the suggest case, you could definitely end up with chrome:// URLs
in the suggestions and this API provided a way for the HTML omnibox popup to
navigate to those URLs when the user selected those suggestions.  The comment
here probably dates to that use case.

At this point, we only need NCW for most visited/most likely so it can much more
limited.  Even better, each most visited item is rendered as regular links
inside chrome-search:// iframes, so you might wonder why we need this API at
all.  I think there are three issues:
1) For a11y, we need to support keyboard navigation.  That logic is still in the
JS in the NTP so it needs a way to trigger navigations.
2) You can&#39;t arbitrarily link to privileged URLs like chrome://.  Though, it
might be better to allow chrome-search:// to link to these URLs rather than make
NCW to support it.
3) With MostLikely, the browser didn&#39;t actually have knowledge of what the URLs
were so you couldn&#39;t just have a RID-based NCW.  Sounds like this is changing
from Mathieu&#39;s reply earlier.

So the summary of all of this I think is that if change that Mathieu alluded to
earlier is done, we should at least get rid of the URL-based NCW and only have a
RID version.  It&#39;s also potentially feasible to kill this altogether and just
have them be regular links but that will require more changes to make sure we
don&#39;t break a11y.

In the short term, unfortunately, I don&#39;t know what URLs can and can not enter
Most Visited/Likely.  But I&#39;m pretty sure that comment was not added to
specifically deal with that case.

Thanks,
Samarth</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg31"
           name="30">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(30)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>dcheng</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-30">
                          On 2016/02/04 at 17:11:26, mathp wrote: &gt; On 2016/02/04 17:05:55, Jered wrote: &gt; &gt; +mathp ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 17:48:58 UTC)
                <a href="#msg31">#31</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-30"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-30"
            >On 2016/02/04 at 17:11:26, mathp wrote:
&gt; On 2016/02/04 17:05:55, Jered wrote:
&gt; &gt; +mathp will this break most likely?
&gt; &gt; 
&gt; &gt; Given the immediate concerns this lgtm.
&gt; 
&gt; Depends if the SuggestionsService is used. Since it&#39;s becoming the default
soon for the server NTP (finkm@ and team can confirm), I&#39;d say that it won&#39;t
break it. If the current server side code ran on this then yes it would break
(because |suggestions_items_| wouldn&#39;t know about the most likely items).


Can you elaborate on this? The current check uses both |most_visited_items_| and
|suggestions_items_| (which is actually a lot less strict than I&#39;d prefer).

On 2016/02/04 at 17:20:44, samarth wrote:
&gt; We could also make this check in the renderer process in  searchbox_extension
here:
&gt;
<a href="https://code.google.com/p/chromium/codesearch#chromium/src/chrome/renderer/searchbox/searchbox_extension.cc&amp;q=searchbox_exte&amp;sq=package:chromium&amp;l=1138" rel="nofollow">https://code.google.com/p/chromium/codesearch#chromium/src/chrome/renderer/se...</a>
&gt; 
&gt; Note that it has access to the most visited items:
&gt;
<a href="https://code.google.com/p/chromium/codesearch#chromium/src/chrome/renderer/searchbox/searchbox.cc&amp;sq=package:chromium&amp;l=308&amp;rcl=1454589471" rel="nofollow">https://code.google.com/p/chromium/codesearch#chromium/src/chrome/renderer/se...</a>
&gt; 
&gt; On one hand, that&#39;s where the check for javascript: scheme resides and it&#39;d be
better for these checks to be centralized.  But I don&#39;t know if it&#39;s preferable
to have these be in the browser process instead.
&gt; 
&gt; Thanks,
&gt; Samarth


That&#39;s where I added it initially, but the renderer is untrusted and therefore
checks in the renderer are fundamentally meaningless. There have been exploits
in the past that sent IPCs directly, which would bypass this check completely (I
know that we now verify that the IPC is from an instant process, but it is still
better to verify browser side).

On 2016/02/04 at 17:18:15, creis wrote:
&gt; On 2016/02/04 17:13:32, Charlie Reis wrote:
&gt; &gt; On 2016/02/04 16:35:15, Robert Sesek wrote:
&gt; &gt; &gt; On 2016/02/04 16:21:01, dcheng wrote:
&gt; &gt; &gt; &gt; I was looking at the scheme blacklist, and I&#39;m wondering if there&#39;s a
better
&gt; &gt; &gt; &gt; way: there are other &#39;weird&#39; schemes that I wouldn&#39;t expect to be valid
&gt; &gt; &gt; &gt; navigation targets for 1993 (such as chrome-devtools://). Do we need to
&gt; &gt; worry
&gt; &gt; &gt; &gt; about other schemes here as well? Is there a more generic way to
determine a
&gt; &gt; &gt; &gt; dangerous scheme that will grant a renderer additional privileges?
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; rsesek and I initially considered a whitelist approach, but were a
little
&gt; &gt; &gt; &gt; worried that this might not capture everything a user might have in
their
&gt; &gt; most
&gt; &gt; &gt; &gt; visited items (e.g. I&#39;m not sure if an ftp URL could end up in there).
&gt; &gt; &gt; 
&gt; &gt; &gt; I was thinking about this more last night, and I think a whiltelist may be
&gt; &gt; &gt; better than a blacklist. I don&#39;t think schemes other than http, https,
file,
&gt; &gt; and
&gt; &gt; &gt; ftp should be allowed.
&gt; &gt; 
&gt; &gt; On one hand, I&#39;d love to lock it down to a whitelist. 
&gt; &gt; ChildProcessSecurityPolicy::IsWebSafeScheme might be a good candidate.
&gt; &gt; 
&gt; &gt; On the other hand, what restrictions do we have on the most visited and
&gt; &gt; suggestion URLs?  Can chrome-extension:// URLs show up there (e.g., if
they&#39;re
&gt; &gt; web accessible)?  Can chrome:// URLs?  (Hopefully not.)  I don&#39;t want to
&gt; &gt; introduce a regression where users can&#39;t click on those tiles, assuming that
the
&gt; &gt; tiles use this API.
&gt; 
&gt; For example, see this comment in search_ipc_router.h:
&gt; 
&gt;     // Called when the page wants to navigate to |url|. Usually used by the
&gt;     // page to navigate to privileged destinations (e.g. chrome:// URLs) or to
&gt;     // navigate to URLs that are hidden from the page using Restricted IDs
(rid
&gt;     // in the API).
&gt;     virtual void NavigateToURL(const GURL&amp; url,
&gt;                                WindowOpenDisposition disposition,
&gt;                                bool is_most_visited_item_url) = 0;
&gt; 
&gt; It makes me sad that there are apparently no tests covering this behavior, if
it was actually introduced to support navigations to privileged URLs.

Breaking Chrome in a security merge is definitely something that was worrying
me.

One &quot;easy&quot; fix is to filter dangerous URLs from |most_visited_items_| and
|suggestions_items_| when they&#39;re set. On the other hand, this starts getting
into &quot;uncomfortably exciting to merge into stable branch&quot; territory. Maybe we
can limit the scheme filter to just chrome:// URLs for now? I&#39;d hate to check
this in without it being that effective because there&#39;s actually some way of
chrome:// URLs getting into most visited sites pretty easily...</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg32"
           name="31">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(31)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Charlie Reis</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-31">
                          On 2016/02/04 17:43:46, samarth wrote: &gt; On 2016/02/04 17:26:25, Charlie Reis wrote: &gt; &gt; On ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 17:51:07 UTC)
                <a href="#msg32">#32</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-31"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-31"
            >On 2016/02/04 17:43:46, samarth wrote:
&gt; On 2016/02/04 17:26:25, Charlie Reis wrote:
&gt; &gt; On 2016/02/04 17:20:44, samarth wrote:
&gt; &gt; &gt; We could also make this check in the renderer process in 
&gt; searchbox_extension
&gt; &gt; &gt; here:
&gt; &gt; &gt;
&gt; &gt;
&gt;
<a href="https://code.google.com/p/chromium/codesearch#chromium/src/chrome/renderer/searchbox/searchbox_extension.cc&amp;q=searchbox_exte&amp;sq=package:chromium&amp;l=1138" rel="nofollow">https://code.google.com/p/chromium/codesearch#chromium/src/chrome/renderer/se...</a>
&gt; &gt; &gt; 
&gt; &gt; &gt; Note that it has access to the most visited items:
&gt; &gt; &gt;
&gt; &gt;
&gt;
<a href="https://code.google.com/p/chromium/codesearch#chromium/src/chrome/renderer/searchbox/searchbox.cc&amp;sq=package:chromium&amp;l=308&amp;rcl=1454589471" rel="nofollow">https://code.google.com/p/chromium/codesearch#chromium/src/chrome/renderer/se...</a>
&gt; &gt; &gt; 
&gt; &gt; &gt; On one hand, that&#39;s where the check for javascript: scheme resides and
it&#39;d
&gt; be
&gt; &gt; &gt; better for these checks to be centralized.  But I don&#39;t know if it&#39;s
&gt; &gt; preferable
&gt; &gt; &gt; to have these be in the browser process instead.
&gt; &gt; &gt; 
&gt; &gt; &gt; Thanks,
&gt; &gt; &gt; Samarth
&gt; &gt; 
&gt; &gt; Thanks for looking.  We definitely want to enforce this in the browser
&gt; process,
&gt; &gt; though I&#39;m not opposed to also having a check in the renderer process.
&gt; &gt; 
&gt; &gt; Samarth, it looks like you added the comment about using this API for
&gt; privileged
&gt; &gt; URLs in <a href="https://codereview.chromium.org/11824050" rel="nofollow">https://codereview.chromium.org/11824050</a> (in instant_page.h at the
&gt; &gt; time).  Can you let us know why that was needed and what will break if we
&gt; &gt; prevent it now?
&gt; 
&gt; There&#39;s a long history behind NavigateContentWindow.
&gt; 
&gt; In the beginning, this API was meant to be used both for most visited items as
&gt; well as for suggestions in the HTML-based omnibox popup.  The latter never
&gt; launched.  In the suggest case, you could definitely end up with chrome://
URLs
&gt; in the suggestions and this API provided a way for the HTML omnibox popup to
&gt; navigate to those URLs when the user selected those suggestions.  The comment
&gt; here probably dates to that use case.
&gt; 
&gt; At this point, we only need NCW for most visited/most likely so it can much
more
&gt; limited.  Even better, each most visited item is rendered as regular links
&gt; inside chrome-search:// iframes, so you might wonder why we need this API at
&gt; all.  I think there are three issues:
&gt; 1) For a11y, we need to support keyboard navigation.  That logic is still in
the
&gt; JS in the NTP so it needs a way to trigger navigations.
&gt; 2) You can&#39;t arbitrarily link to privileged URLs like chrome://.  Though, it
&gt; might be better to allow chrome-search:// to link to these URLs rather than
make
&gt; NCW to support it.
&gt; 3) With MostLikely, the browser didn&#39;t actually have knowledge of what the
URLs
&gt; were so you couldn&#39;t just have a RID-based NCW.  Sounds like this is changing
&gt; from Mathieu&#39;s reply earlier.
&gt; 
&gt; So the summary of all of this I think is that if change that Mathieu alluded
to
&gt; earlier is done, we should at least get rid of the URL-based NCW and only have
a
&gt; RID version.  It&#39;s also potentially feasible to kill this altogether and just
&gt; have them be regular links but that will require more changes to make sure we
&gt; don&#39;t break a11y.
&gt; 
&gt; In the short term, unfortunately, I don&#39;t know what URLs can and can not enter
&gt; Most Visited/Likely.  But I&#39;m pretty sure that comment was not added to
&gt; specifically deal with that case.
&gt; 
&gt; Thanks,
&gt; Samarth

Fantastic.  Thank for all the context.  That makes me happier with the approach
taken here, though there&#39;s still some risk of regression since we don&#39;t know
which chrome:// or chrome-extension:// URLs can show up in the tiles.

I&#39;ll copy your comment over to the bug and we can discuss followup CLs from
there.

For now, I think the decision to make is whether to limit the URL-based API to a
whitelist (like IsWebSafeScheme) or just trust what&#39;s in the Most Visited and
Suggestions lists.  I want to land something that&#39;s unlikely to get reverted and
is easy to merge.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg33"
           name="32">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(32)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Jered</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-32">
                          On 2016/02/04 17:43:46, samarth wrote: &gt; On 2016/02/04 17:26:25, Charlie Reis wrote: &gt; &gt; On ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 17:51:21 UTC)
                <a href="#msg33">#33</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-32"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-32"
            >On 2016/02/04 17:43:46, samarth wrote:
&gt; On 2016/02/04 17:26:25, Charlie Reis wrote:
&gt; &gt; On 2016/02/04 17:20:44, samarth wrote:
&gt; &gt; &gt; We could also make this check in the renderer process in 
&gt; searchbox_extension
&gt; &gt; &gt; here:
&gt; &gt; &gt;
&gt; &gt;
&gt;
<a href="https://code.google.com/p/chromium/codesearch#chromium/src/chrome/renderer/searchbox/searchbox_extension.cc&amp;q=searchbox_exte&amp;sq=package:chromium&amp;l=1138" rel="nofollow">https://code.google.com/p/chromium/codesearch#chromium/src/chrome/renderer/se...</a>
&gt; &gt; &gt; 
&gt; &gt; &gt; Note that it has access to the most visited items:
&gt; &gt; &gt;
&gt; &gt;
&gt;
<a href="https://code.google.com/p/chromium/codesearch#chromium/src/chrome/renderer/searchbox/searchbox.cc&amp;sq=package:chromium&amp;l=308&amp;rcl=1454589471" rel="nofollow">https://code.google.com/p/chromium/codesearch#chromium/src/chrome/renderer/se...</a>
&gt; &gt; &gt; 
&gt; &gt; &gt; On one hand, that&#39;s where the check for javascript: scheme resides and
it&#39;d
&gt; be
&gt; &gt; &gt; better for these checks to be centralized.  But I don&#39;t know if it&#39;s
&gt; &gt; preferable
&gt; &gt; &gt; to have these be in the browser process instead.
&gt; &gt; &gt; 
&gt; &gt; &gt; Thanks,
&gt; &gt; &gt; Samarth
&gt; &gt; 
&gt; &gt; Thanks for looking.  We definitely want to enforce this in the browser
&gt; process,
&gt; &gt; though I&#39;m not opposed to also having a check in the renderer process.
&gt; &gt; 
&gt; &gt; Samarth, it looks like you added the comment about using this API for
&gt; privileged
&gt; &gt; URLs in <a href="https://codereview.chromium.org/11824050" rel="nofollow">https://codereview.chromium.org/11824050</a> (in instant_page.h at the
&gt; &gt; time).  Can you let us know why that was needed and what will break if we
&gt; &gt; prevent it now?
&gt; 
&gt; There&#39;s a long history behind NavigateContentWindow.
&gt; 
&gt; In the beginning, this API was meant to be used both for most visited items as
&gt; well as for suggestions in the HTML-based omnibox popup.  The latter never
&gt; launched.  In the suggest case, you could definitely end up with chrome://
URLs
&gt; in the suggestions and this API provided a way for the HTML omnibox popup to
&gt; navigate to those URLs when the user selected those suggestions.  The comment
&gt; here probably dates to that use case.
&gt; 
&gt; At this point, we only need NCW for most visited/most likely so it can much
more
&gt; limited.  Even better, each most visited item is rendered as regular links
&gt; inside chrome-search:// iframes, so you might wonder why we need this API at
&gt; all.  I think there are three issues:
&gt; 1) For a11y, we need to support keyboard navigation.  That logic is still in
the
&gt; JS in the NTP so it needs a way to trigger navigations.
&gt; 2) You can&#39;t arbitrarily link to privileged URLs like chrome://.  Though, it
&gt; might be better to allow chrome-search:// to link to these URLs rather than
make
&gt; NCW to support it.
&gt; 3) With MostLikely, the browser didn&#39;t actually have knowledge of what the
URLs
&gt; were so you couldn&#39;t just have a RID-based NCW.  Sounds like this is changing
&gt; from Mathieu&#39;s reply earlier.
&gt; 
&gt; So the summary of all of this I think is that if change that Mathieu alluded
to
&gt; earlier is done, we should at least get rid of the URL-based NCW and only have
a
&gt; RID version.  It&#39;s also potentially feasible to kill this altogether and just
&gt; have them be regular links but that will require more changes to make sure we
&gt; don&#39;t break a11y.

iirc bing are using the url api so coordinating that change may be complex.

&gt; 
&gt; In the short term, unfortunately, I don&#39;t know what URLs can and can not enter
&gt; Most Visited/Likely.  But I&#39;m pretty sure that comment was not added to
&gt; specifically deal with that case.
&gt; 
&gt; Thanks,
&gt; Samarth</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg34"
           name="33">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(33)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Jered</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-33">
                          On 2016/02/04 17:51:07, Charlie Reis wrote: &gt; On 2016/02/04 17:43:46, samarth wrote: &gt; &gt; On ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 17:53:20 UTC)
                <a href="#msg34">#34</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-33"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-33"
            >On 2016/02/04 17:51:07, Charlie Reis wrote:
&gt; On 2016/02/04 17:43:46, samarth wrote:
&gt; &gt; On 2016/02/04 17:26:25, Charlie Reis wrote:
&gt; &gt; &gt; On 2016/02/04 17:20:44, samarth wrote:
&gt; &gt; &gt; &gt; We could also make this check in the renderer process in 
&gt; &gt; searchbox_extension
&gt; &gt; &gt; &gt; here:
&gt; &gt; &gt; &gt;
&gt; &gt; &gt;
&gt; &gt;
&gt;
<a href="https://code.google.com/p/chromium/codesearch#chromium/src/chrome/renderer/searchbox/searchbox_extension.cc&amp;q=searchbox_exte&amp;sq=package:chromium&amp;l=1138" rel="nofollow">https://code.google.com/p/chromium/codesearch#chromium/src/chrome/renderer/se...</a>
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; Note that it has access to the most visited items:
&gt; &gt; &gt; &gt;
&gt; &gt; &gt;
&gt; &gt;
&gt;
<a href="https://code.google.com/p/chromium/codesearch#chromium/src/chrome/renderer/searchbox/searchbox.cc&amp;sq=package:chromium&amp;l=308&amp;rcl=1454589471" rel="nofollow">https://code.google.com/p/chromium/codesearch#chromium/src/chrome/renderer/se...</a>
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; On one hand, that&#39;s where the check for javascript: scheme resides and
&gt; it&#39;d
&gt; &gt; be
&gt; &gt; &gt; &gt; better for these checks to be centralized.  But I don&#39;t know if it&#39;s
&gt; &gt; &gt; preferable
&gt; &gt; &gt; &gt; to have these be in the browser process instead.
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; Thanks,
&gt; &gt; &gt; &gt; Samarth
&gt; &gt; &gt; 
&gt; &gt; &gt; Thanks for looking.  We definitely want to enforce this in the browser
&gt; &gt; process,
&gt; &gt; &gt; though I&#39;m not opposed to also having a check in the renderer process.
&gt; &gt; &gt; 
&gt; &gt; &gt; Samarth, it looks like you added the comment about using this API for
&gt; &gt; privileged
&gt; &gt; &gt; URLs in <a href="https://codereview.chromium.org/11824050" rel="nofollow">https://codereview.chromium.org/11824050</a> (in instant_page.h at the
&gt; &gt; &gt; time).  Can you let us know why that was needed and what will break if we
&gt; &gt; &gt; prevent it now?
&gt; &gt; 
&gt; &gt; There&#39;s a long history behind NavigateContentWindow.
&gt; &gt; 
&gt; &gt; In the beginning, this API was meant to be used both for most visited items
as
&gt; &gt; well as for suggestions in the HTML-based omnibox popup.  The latter never
&gt; &gt; launched.  In the suggest case, you could definitely end up with chrome://
&gt; URLs
&gt; &gt; in the suggestions and this API provided a way for the HTML omnibox popup to
&gt; &gt; navigate to those URLs when the user selected those suggestions.  The
comment
&gt; &gt; here probably dates to that use case.
&gt; &gt; 
&gt; &gt; At this point, we only need NCW for most visited/most likely so it can much
&gt; more
&gt; &gt; limited.  Even better, each most visited item is rendered as regular links
&gt; &gt; inside chrome-search:// iframes, so you might wonder why we need this API at
&gt; &gt; all.  I think there are three issues:
&gt; &gt; 1) For a11y, we need to support keyboard navigation.  That logic is still in
&gt; the
&gt; &gt; JS in the NTP so it needs a way to trigger navigations.
&gt; &gt; 2) You can&#39;t arbitrarily link to privileged URLs like chrome://.  Though, it
&gt; &gt; might be better to allow chrome-search:// to link to these URLs rather than
&gt; make
&gt; &gt; NCW to support it.
&gt; &gt; 3) With MostLikely, the browser didn&#39;t actually have knowledge of what the
&gt; URLs
&gt; &gt; were so you couldn&#39;t just have a RID-based NCW.  Sounds like this is
changing
&gt; &gt; from Mathieu&#39;s reply earlier.
&gt; &gt; 
&gt; &gt; So the summary of all of this I think is that if change that Mathieu alluded
&gt; to
&gt; &gt; earlier is done, we should at least get rid of the URL-based NCW and only
have
&gt; a
&gt; &gt; RID version.  It&#39;s also potentially feasible to kill this altogether and
just
&gt; &gt; have them be regular links but that will require more changes to make sure
we
&gt; &gt; don&#39;t break a11y.
&gt; &gt; 
&gt; &gt; In the short term, unfortunately, I don&#39;t know what URLs can and can not
enter
&gt; &gt; Most Visited/Likely.  But I&#39;m pretty sure that comment was not added to
&gt; &gt; specifically deal with that case.
&gt; &gt; 
&gt; &gt; Thanks,
&gt; &gt; Samarth
&gt; 
&gt; Fantastic.  Thank for all the context.  That makes me happier with the
approach
&gt; taken here, though there&#39;s still some risk of regression since we don&#39;t know
&gt; which chrome:// or chrome-extension:// URLs can show up in the tiles.
&gt; 
&gt; I&#39;ll copy your comment over to the bug and we can discuss followup CLs from
&gt; there.
&gt; 
&gt; For now, I think the decision to make is whether to limit the URL-based API to
a
&gt; whitelist (like IsWebSafeScheme) or just trust what&#39;s in the Most Visited and
&gt; Suggestions lists.  I want to land something that&#39;s unlikely to get reverted
and
&gt; is easy to merge.

Based on mathp&#39;s comments, I think IsWebSafeScheme() would be a safer merge.
But I think this is a better fix assuming that the suggestions list is actually
populated.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg35"
           name="34">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(34)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Charlie Reis</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-34">
                          On 2016/02/04 17:48:58, dcheng wrote: &gt; Breaking Chrome in a security merge is definitely something ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 17:53:40 UTC)
                <a href="#msg35">#35</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-34"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-34"
            >On 2016/02/04 17:48:58, dcheng wrote:
&gt; Breaking Chrome in a security merge is definitely something that was worrying
&gt; me.
&gt; 
&gt; One &quot;easy&quot; fix is to filter dangerous URLs from |most_visited_items_| and
&gt; |suggestions_items_| when they&#39;re set. On the other hand, this starts getting
&gt; into &quot;uncomfortably exciting to merge into stable branch&quot; territory. Maybe we
&gt; can limit the scheme filter to just chrome:// URLs for now? I&#39;d hate to check
&gt; this in without it being that effective because there&#39;s actually some way of
&gt; chrome:// URLs getting into most visited sites pretty easily...

Do you know of a way for an attacker to get chrome:// URLs into Most Visited, or
are you just worried that it might be possible?  I would hope that would be just
as difficult as navigating to a chrome:// URL in the first place, which is what
the attack was using this API for.

I could be ok with limiting the check to chrome:// URLs for now.  That might be
a good balance between security and avoiding possible regressions.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg36"
           name="35">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(35)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>dcheng</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-35">
                          On 2016/02/04 at 17:53:40, creis wrote: &gt; On 2016/02/04 17:48:58, dcheng wrote: &gt; &gt; Breaking ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 17:56:44 UTC)
                <a href="#msg36">#36</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-35"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-35"
            >On 2016/02/04 at 17:53:40, creis wrote:
&gt; On 2016/02/04 17:48:58, dcheng wrote:
&gt; &gt; Breaking Chrome in a security merge is definitely something that was
worrying
&gt; &gt; me.
&gt; &gt; 
&gt; &gt; One &quot;easy&quot; fix is to filter dangerous URLs from |most_visited_items_| and
&gt; &gt; |suggestions_items_| when they&#39;re set. On the other hand, this starts
getting
&gt; &gt; into &quot;uncomfortably exciting to merge into stable branch&quot; territory. Maybe
we
&gt; &gt; can limit the scheme filter to just chrome:// URLs for now? I&#39;d hate to
check
&gt; &gt; this in without it being that effective because there&#39;s actually some way of
&gt; &gt; chrome:// URLs getting into most visited sites pretty easily...
&gt; 
&gt; Do you know of a way for an attacker to get chrome:// URLs into Most Visited,
or are you just worried that it might be possible?  I would hope that would be
just as difficult as navigating to a chrome:// URL in the first place, which is
what the attack was using this API for.
&gt; 
&gt; I could be ok with limiting the check to chrome:// URLs for now.  That might
be a good balance between security and avoiding possible regressions.

I don&#39;t but I&#39;m not familiar with the code. I&#39;ll update the CL to just filter on
chrome://.

Re: IsWebSafeScheme: that&#39;s definitely a much more aggressive and restrictive
change, so I think that should be done in followups by whoever owns the code
now.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg37"
           name="36">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(36)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Charlie Reis</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-36">
                          On 2016/02/04 17:53:20, Jered wrote: &gt; &gt; Fantastic. Thank for all the context. That makes ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 17:58:18 UTC)
                <a href="#msg37">#37</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-36"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-36"
            >On 2016/02/04 17:53:20, Jered wrote:
&gt; &gt; Fantastic.  Thank for all the context.  That makes me happier with the
&gt; approach
&gt; &gt; taken here, though there&#39;s still some risk of regression since we don&#39;t know
&gt; &gt; which chrome:// or chrome-extension:// URLs can show up in the tiles.
&gt; &gt; 
&gt; &gt; I&#39;ll copy your comment over to the bug and we can discuss followup CLs from
&gt; &gt; there.
&gt; &gt; 
&gt; &gt; For now, I think the decision to make is whether to limit the URL-based API
to
&gt; a
&gt; &gt; whitelist (like IsWebSafeScheme) or just trust what&#39;s in the Most Visited
and
&gt; &gt; Suggestions lists.  I want to land something that&#39;s unlikely to get reverted
&gt; and
&gt; &gt; is easy to merge.
&gt; 
&gt; Based on mathp&#39;s comments, I think IsWebSafeScheme() would be a safer merge.
&gt; But I think this is a better fix assuming that the suggestions list is
actually
&gt; populated.

As Daniel mentions, IsWebSafeScheme seems like the least safe merge, at least
from a regression perspective.  It will almost certainly break attempts to visit
chrome-extension:// URLs that are in Most Visited, assuming that&#39;s possible.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg38"
           name="37">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(37)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>finkm</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-37">
                          On 2016/02/04 17:11:26, Mathieu Perreault wrote: &gt; On 2016/02/04 17:05:55, Jered wrote: &gt; &gt; +mathp ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 18:12:25 UTC)
                <a href="#msg38">#38</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-37"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-37"
            >On 2016/02/04 17:11:26, Mathieu Perreault wrote:
&gt; On 2016/02/04 17:05:55, Jered wrote:
&gt; &gt; +mathp will this break most likely?
&gt; &gt; 
&gt; &gt; Given the immediate concerns this lgtm.
&gt; 
&gt; Depends if the SuggestionsService is used. Since it&#39;s becoming the default
soon
&gt; for the server NTP (finkm@ and team can confirm)

We haven&#39;t started working on that. I&#39;ll discuss with the team if/when we can
squeeze that in.

On 2016/02/04 17:53:20, Jered wrote:
&gt; I don&#39;t but I&#39;m not familiar with the code. I&#39;ll update the CL to just filter
on
&gt; chrome://.

SGTM</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg39"
           name="38">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(38)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>dcheng</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-38">
                          PTAL, I&#39;ve relaxed the check to just forbid chrome:// URLs. I&#39;ve also added TODOs for ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 18:14:08 UTC)
                <a href="#msg39">#39</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-38"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-38"
            >PTAL, I&#39;ve relaxed the check to just forbid chrome:// URLs.

I&#39;ve also added TODOs for followup work (trieb, I&#39;ve put your name in them for
now, hopefully that&#39;s ok ;-)</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message  approval  "
           
           id="msg40"
           name="39">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(39)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Charlie Reis</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-39">
                          LGTM with nits. https://codereview.chromium.org/1669723002/diff/160001/chrome/browser/ui/search/search_tab_helper.cc File chrome/browser/ui/search/search_tab_helper.cc (right): https://codereview.chromium.org/1669723002/diff/160001/chrome/browser/ui/search/search_tab_helper.cc#newcode454 chrome/browser/ui/search/search_tab_helper.cc:454: // items list. Note that the ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 18:37:53 UTC)
                <a href="#msg40">#40</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-39"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-39"
            >LGTM with nits.

<a href="https://codereview.chromium.org/1669723002/diff/160001/chrome/browser/ui/search/search_tab_helper.cc" rel="nofollow">https://codereview.chromium.org/1669723002/diff/160001/chrome/browser/ui/sear...</a>
File chrome/browser/ui/search/search_tab_helper.cc (right):

<a href="https://codereview.chromium.org/1669723002/diff/160001/chrome/browser/ui/search/search_tab_helper.cc#newcode454" rel="nofollow">https://codereview.chromium.org/1669723002/diff/160001/chrome/browser/ui/sear...</a>
chrome/browser/ui/search/search_tab_helper.cc:454: // items list. Note that the
|is_most_visited_item_url| is apparently
Maybe this second sentence should be a TODO to remove it?  Right now it&#39;s just
going to confuse people reading the code, as if it&#39;s part of the intended
design.

<a href="https://codereview.chromium.org/1669723002/diff/160001/chrome/renderer/searchbox/searchbox_extension.cc" rel="nofollow">https://codereview.chromium.org/1669723002/diff/160001/chrome/renderer/search...</a>
File chrome/renderer/searchbox/searchbox_extension.cc (right):

<a href="https://codereview.chromium.org/1669723002/diff/160001/chrome/renderer/searchbox/searchbox_extension.cc#newcode1168" rel="nofollow">https://codereview.chromium.org/1669723002/diff/160001/chrome/renderer/search...</a>
chrome/renderer/searchbox/searchbox_extension.cc:1168: // TODO(treib): Remove
this check, since it&#39;s redundant with the browser-side
I disagree with removing this.  It&#39;s fine to have the renderer skip the IPC if
it knows the URL won&#39;t be allowed, and just have the browser-side check as a
backup.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg41"
           name="40">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(40)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>dcheng</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-40">
                          https://codereview.chromium.org/1669723002/diff/160001/chrome/browser/ui/search/search_tab_helper.cc File chrome/browser/ui/search/search_tab_helper.cc (right): https://codereview.chromium.org/1669723002/diff/160001/chrome/browser/ui/search/search_tab_helper.cc#newcode454 chrome/browser/ui/search/search_tab_helper.cc:454: // items list. Note that the |is_most_visited_item_url| is apparently ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 18:41:33 UTC)
                <a href="#msg41">#41</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-40"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-40"
            ><a href="https://codereview.chromium.org/1669723002/diff/160001/chrome/browser/ui/search/search_tab_helper.cc" rel="nofollow">https://codereview.chromium.org/1669723002/diff/160001/chrome/browser/ui/sear...</a>
File chrome/browser/ui/search/search_tab_helper.cc (right):

<a href="https://codereview.chromium.org/1669723002/diff/160001/chrome/browser/ui/search/search_tab_helper.cc#newcode454" rel="nofollow">https://codereview.chromium.org/1669723002/diff/160001/chrome/browser/ui/sear...</a>
chrome/browser/ui/search/search_tab_helper.cc:454: // items list. Note that the
|is_most_visited_item_url| is apparently
On 2016/02/04 at 18:37:53, Charlie Reis wrote:
&gt; Maybe this second sentence should be a TODO to remove it?  Right now it&#39;s just
going to confuse people reading the code, as if it&#39;s part of the intended
design.

Hm... I think it&#39;s actually kind of important to document that this variable
doesn&#39;t mean what a reader thinks it does: my initial impression was that this
would allow me to check |suggestions_items_| or |most_visited_items_| based on
the value of this flag, but that&#39;s not true. Do you have suggestions on how to
improve this?

<a href="https://codereview.chromium.org/1669723002/diff/160001/chrome/renderer/searchbox/searchbox_extension.cc" rel="nofollow">https://codereview.chromium.org/1669723002/diff/160001/chrome/renderer/search...</a>
File chrome/renderer/searchbox/searchbox_extension.cc (right):

<a href="https://codereview.chromium.org/1669723002/diff/160001/chrome/renderer/searchbox/searchbox_extension.cc#newcode1168" rel="nofollow">https://codereview.chromium.org/1669723002/diff/160001/chrome/renderer/search...</a>
chrome/renderer/searchbox/searchbox_extension.cc:1168: // TODO(treib): Remove
this check, since it&#39;s redundant with the browser-side
On 2016/02/04 at 18:37:53, Charlie Reis wrote:
&gt; I disagree with removing this.  It&#39;s fine to have the renderer skip the IPC if
it knows the URL won&#39;t be allowed, and just have the browser-side check as a
backup.

On the flip side, having it here makes it tempting to add further checks here (I
fell into this trap initially yesterday).</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg42"
           name="41">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(41)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Charlie Reis</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-41">
                          Some suggestions below. https://codereview.chromium.org/1669723002/diff/160001/chrome/browser/ui/search/search_tab_helper.cc File chrome/browser/ui/search/search_tab_helper.cc (right): https://codereview.chromium.org/1669723002/diff/160001/chrome/browser/ui/search/search_tab_helper.cc#newcode454 chrome/browser/ui/search/search_tab_helper.cc:454: // items list. Note that the ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 18:45:23 UTC)
                <a href="#msg42">#42</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-41"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-41"
            >Some suggestions below.

<a href="https://codereview.chromium.org/1669723002/diff/160001/chrome/browser/ui/search/search_tab_helper.cc" rel="nofollow">https://codereview.chromium.org/1669723002/diff/160001/chrome/browser/ui/sear...</a>
File chrome/browser/ui/search/search_tab_helper.cc (right):

<a href="https://codereview.chromium.org/1669723002/diff/160001/chrome/browser/ui/search/search_tab_helper.cc#newcode454" rel="nofollow">https://codereview.chromium.org/1669723002/diff/160001/chrome/browser/ui/sear...</a>
chrome/browser/ui/search/search_tab_helper.cc:454: // items list. Note that the
|is_most_visited_item_url| is apparently
On 2016/02/04 18:41:32, dcheng wrote:
&gt; On 2016/02/04 at 18:37:53, Charlie Reis wrote:
&gt; &gt; Maybe this second sentence should be a TODO to remove it?  Right now it&#39;s
just
&gt; going to confuse people reading the code, as if it&#39;s part of the intended
&gt; design.
&gt; 
&gt; Hm... I think it&#39;s actually kind of important to document that this variable
&gt; doesn&#39;t mean what a reader thinks it does: my initial impression was that this
&gt; would allow me to check |suggestions_items_| or |most_visited_items_| based on
&gt; the value of this flag, but that&#39;s not true. Do you have suggestions on how to
&gt; improve this?

TODO(...): The |is_most_visited_item_url| is apparently meaningless. Can it be
removed?

<a href="https://codereview.chromium.org/1669723002/diff/160001/chrome/renderer/searchbox/searchbox_extension.cc" rel="nofollow">https://codereview.chromium.org/1669723002/diff/160001/chrome/renderer/search...</a>
File chrome/renderer/searchbox/searchbox_extension.cc (right):

<a href="https://codereview.chromium.org/1669723002/diff/160001/chrome/renderer/searchbox/searchbox_extension.cc#newcode1168" rel="nofollow">https://codereview.chromium.org/1669723002/diff/160001/chrome/renderer/search...</a>
chrome/renderer/searchbox/searchbox_extension.cc:1168: // TODO(treib): Remove
this check, since it&#39;s redundant with the browser-side
On 2016/02/04 18:41:32, dcheng wrote:
&gt; On 2016/02/04 at 18:37:53, Charlie Reis wrote:
&gt; &gt; I disagree with removing this.  It&#39;s fine to have the renderer skip the IPC
if
&gt; it knows the URL won&#39;t be allowed, and just have the browser-side check as a
&gt; backup.
&gt; 
&gt; On the flip side, having it here makes it tempting to add further checks here
(I
&gt; fell into this trap initially yesterday).

// Navigate the main frame. Note that the safety checks are enforced by the
browser process in InstantService but are useful here for avoiding unnecessary
IPCs.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg43"
           name="42">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(42)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>dcheng</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-42">
                          https://codereview.chromium.org/1669723002/diff/160001/chrome/browser/ui/search/search_tab_helper.cc File chrome/browser/ui/search/search_tab_helper.cc (right): https://codereview.chromium.org/1669723002/diff/160001/chrome/browser/ui/search/search_tab_helper.cc#newcode454 chrome/browser/ui/search/search_tab_helper.cc:454: // items list. Note that the |is_most_visited_item_url| is apparently ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 19:05:01 UTC)
                <a href="#msg43">#43</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-42"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-42"
            ><a href="https://codereview.chromium.org/1669723002/diff/160001/chrome/browser/ui/search/search_tab_helper.cc" rel="nofollow">https://codereview.chromium.org/1669723002/diff/160001/chrome/browser/ui/sear...</a>
File chrome/browser/ui/search/search_tab_helper.cc (right):

<a href="https://codereview.chromium.org/1669723002/diff/160001/chrome/browser/ui/search/search_tab_helper.cc#newcode454" rel="nofollow">https://codereview.chromium.org/1669723002/diff/160001/chrome/browser/ui/sear...</a>
chrome/browser/ui/search/search_tab_helper.cc:454: // items list. Note that the
|is_most_visited_item_url| is apparently
On 2016/02/04 at 18:45:23, Charlie Reis wrote:
&gt; On 2016/02/04 18:41:32, dcheng wrote:
&gt; &gt; On 2016/02/04 at 18:37:53, Charlie Reis wrote:
&gt; &gt; &gt; Maybe this second sentence should be a TODO to remove it?  Right now it&#39;s
just
&gt; &gt; going to confuse people reading the code, as if it&#39;s part of the intended
&gt; &gt; design.
&gt; &gt; 
&gt; &gt; Hm... I think it&#39;s actually kind of important to document that this variable
&gt; &gt; doesn&#39;t mean what a reader thinks it does: my initial impression was that
this
&gt; &gt; would allow me to check |suggestions_items_| or |most_visited_items_| based
on
&gt; &gt; the value of this flag, but that&#39;s not true. Do you have suggestions on how
to
&gt; &gt; improve this?
&gt; 
&gt; TODO(...): The |is_most_visited_item_url| is apparently meaningless. Can it be
removed?

Done.

<a href="https://codereview.chromium.org/1669723002/diff/160001/chrome/renderer/searchbox/searchbox_extension.cc" rel="nofollow">https://codereview.chromium.org/1669723002/diff/160001/chrome/renderer/search...</a>
File chrome/renderer/searchbox/searchbox_extension.cc (right):

<a href="https://codereview.chromium.org/1669723002/diff/160001/chrome/renderer/searchbox/searchbox_extension.cc#newcode1168" rel="nofollow">https://codereview.chromium.org/1669723002/diff/160001/chrome/renderer/search...</a>
chrome/renderer/searchbox/searchbox_extension.cc:1168: // TODO(treib): Remove
this check, since it&#39;s redundant with the browser-side
On 2016/02/04 at 18:45:23, Charlie Reis wrote:
&gt; On 2016/02/04 18:41:32, dcheng wrote:
&gt; &gt; On 2016/02/04 at 18:37:53, Charlie Reis wrote:
&gt; &gt; &gt; I disagree with removing this.  It&#39;s fine to have the renderer skip the
IPC if
&gt; &gt; it knows the URL won&#39;t be allowed, and just have the browser-side check as a
&gt; &gt; backup.
&gt; &gt; 
&gt; &gt; On the flip side, having it here makes it tempting to add further checks
here (I
&gt; &gt; fell into this trap initially yesterday).
&gt; 
&gt; // Navigate the main frame. Note that the safety checks are enforced by the
browser process in InstantService but are useful here for avoiding unnecessary
IPCs.

Done.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message  approval  "
           
           id="msg44"
           name="43">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(43)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Charlie Reis</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-43">
                          Thanks. LGTM. https://codereview.chromium.org/1669723002/diff/180001/chrome/browser/ui/search/search_tab_helper.cc File chrome/browser/ui/search/search_tab_helper.cc (right): https://codereview.chromium.org/1669723002/diff/180001/chrome/browser/ui/search/search_tab_helper.cc#newcode455 chrome/browser/ui/search/search_tab_helper.cc:455: // TODO(trieb) The |is_most_visited_item_url| is meaningless: the ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 19:10:04 UTC)
                <a href="#msg44">#44</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-43"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-43"
            >Thanks. LGTM.

<a href="https://codereview.chromium.org/1669723002/diff/180001/chrome/browser/ui/search/search_tab_helper.cc" rel="nofollow">https://codereview.chromium.org/1669723002/diff/180001/chrome/browser/ui/sear...</a>
File chrome/browser/ui/search/search_tab_helper.cc (right):

<a href="https://codereview.chromium.org/1669723002/diff/180001/chrome/browser/ui/search/search_tab_helper.cc#newcode455" rel="nofollow">https://codereview.chromium.org/1669723002/diff/180001/chrome/browser/ui/sear...</a>
chrome/browser/ui/search/search_tab_helper.cc:455: // TODO(trieb) The
|is_most_visited_item_url| is meaningless: the way it&#39;s
nit: treib  (I&#39;m sensitive to ie/ei as well.)  :)
nit: Add colon after close paren.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    generated"
           style="display: none"
           id="generated-msg45"
           name="44">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(44)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>dcheng</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-44">
                          The CQ bit was checked by dcheng@chromium.org
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 19:12:38 UTC)
                <a href="#msg45">#45</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-44"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-44"
            >The CQ bit was checked by <a href="mailto:dcheng@chromium.org">dcheng@chromium.org</a></pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg46"
           name="45">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(45)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>dcheng</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-45">
                          https://codereview.chromium.org/1669723002/diff/180001/chrome/browser/ui/search/search_tab_helper.cc File chrome/browser/ui/search/search_tab_helper.cc (right): https://codereview.chromium.org/1669723002/diff/180001/chrome/browser/ui/search/search_tab_helper.cc#newcode455 chrome/browser/ui/search/search_tab_helper.cc:455: // TODO(trieb) The |is_most_visited_item_url| is meaningless: the way it&#39;s ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 19:12:39 UTC)
                <a href="#msg46">#46</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-45"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-45"
            ><a href="https://codereview.chromium.org/1669723002/diff/180001/chrome/browser/ui/search/search_tab_helper.cc" rel="nofollow">https://codereview.chromium.org/1669723002/diff/180001/chrome/browser/ui/sear...</a>
File chrome/browser/ui/search/search_tab_helper.cc (right):

<a href="https://codereview.chromium.org/1669723002/diff/180001/chrome/browser/ui/search/search_tab_helper.cc#newcode455" rel="nofollow">https://codereview.chromium.org/1669723002/diff/180001/chrome/browser/ui/sear...</a>
chrome/browser/ui/search/search_tab_helper.cc:455: // TODO(trieb) The
|is_most_visited_item_url| is meaningless: the way it&#39;s
On 2016/02/04 at 19:10:04, Charlie Reis wrote:
&gt; nit: treib  (I&#39;m sensitive to ie/ei as well.)  :)
&gt; nit: Add colon after close paren.

Done.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    generated"
           style="display: none"
           id="generated-msg47"
           name="46">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(46)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>dcheng</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-46">
                          The patchset sent to the CQ was uploaded after l-g-t-m from treib@chromium.org, jered@chromium.org, creis@chromium.org Link ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 19:12:39 UTC)
                <a href="#msg47">#47</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-46"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-46"
            >The patchset sent to the CQ was uploaded after l-g-t-m from <a href="mailto:treib@chromium.org">treib@chromium.org</a>,
<a href="mailto:jered@chromium.org">jered@chromium.org</a>, <a href="mailto:creis@chromium.org">creis@chromium.org</a>
Link to the patchset: <a href="https://codereview.chromium.org/1669723002/#ps200001" rel="nofollow">https://codereview.chromium.org/1669723002/#ps200001</a>
(title: &quot;Better comments&quot;)</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg48"
           name="47">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(47)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>commit-bot: I haz the power</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-47">
                          CQ is trying da patch. Follow status at https://chromium-cq-status.appspot.com/patch-status/1669723002/200001 View timeline at https://chromium-cq-status.appspot.com/patch-timeline/1669723002/200001
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 19:13:25 UTC)
                <a href="#msg48">#48</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-47"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-47"
            >CQ is trying da patch. Follow status at
 <a href="https://chromium-cq-status.appspot.com/patch-status/1669723002/200001" rel="nofollow">https://chromium-cq-status.appspot.com/patch-status/1669723002/200001</a>
View timeline at
 <a href="https://chromium-cq-status.appspot.com/patch-timeline/1669723002/200001" rel="nofollow">https://chromium-cq-status.appspot.com/patch-timeline/1669723002/200001</a></pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    generated"
           style="display: none"
           id="generated-msg49"
           name="48">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(48)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Robert Sesek</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-48">
                          Description was changed from ========== NTP: don&#39;t allow navigateContentWindow to navigate where it pleases. BUG=509313 ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 19:17:36 UTC)
                <a href="#msg49">#49</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-48"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-48"
            >Description was changed from

==========
NTP: don&#39;t allow navigateContentWindow to navigate where it pleases.

BUG=509313
==========

to

==========
NTP: don&#39;t allow navigateContentWindow to navigate where it pleases.

BUG=509313
==========</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    generated"
           style="display: none"
           id="generated-msg50"
           name="49">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(49)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Robert Sesek</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-49">
                          rsesek@chromium.org changed reviewers: + rsesek@chromium.org
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 19:17:36 UTC)
                <a href="#msg50">#50</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-49"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-49"
            ><a href="mailto:rsesek@chromium.org">rsesek@chromium.org</a> changed reviewers:
+ <a href="mailto:rsesek@chromium.org">rsesek@chromium.org</a></pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message issue_was_closed   generated"
           style="display: none"
           id="generated-msg51"
           name="50">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(50)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>commit-bot: I haz the power</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-50">
                          Description was changed from ========== NTP: don&#39;t allow navigateContentWindow to navigate where it pleases. BUG=509313 ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 20:06:22 UTC)
                <a href="#msg51">#51</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-50"
             style="display: none;">
          <div class="message-body">
            
              <span class="extra-note">
                Message was sent while issue was closed.
              </span>
            
            <pre name="cl-message-50"
            >Description was changed from

==========
NTP: don&#39;t allow navigateContentWindow to navigate where it pleases.

BUG=509313
==========

to

==========
NTP: don&#39;t allow navigateContentWindow to navigate where it pleases.

BUG=509313
==========</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message issue_was_closed   "
           
           id="msg52"
           name="51">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(51)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>commit-bot: I haz the power</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-51">
                          Committed patchset #11 (id:200001)
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 20:06:23 UTC)
                <a href="#msg52">#52</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-51"
             style="display: none;">
          <div class="message-body">
            
              <span class="extra-note">
                Message was sent while issue was closed.
              </span>
            
            <pre name="cl-message-51"
            >Committed patchset #11 (id:200001)</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message issue_was_closed   generated"
           style="display: none"
           id="generated-msg53"
           name="52">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(52)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>commit-bot: I haz the power</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-52">
                          Description was changed from ========== NTP: don&#39;t allow navigateContentWindow to navigate where it pleases. BUG=509313 ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 20:07:35 UTC)
                <a href="#msg53">#53</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-52"
             style="display: none;">
          <div class="message-body">
            
              <span class="extra-note">
                Message was sent while issue was closed.
              </span>
            
            <pre name="cl-message-52"
            >Description was changed from

==========
NTP: don&#39;t allow navigateContentWindow to navigate where it pleases.

BUG=509313
==========

to

==========
NTP: don&#39;t allow navigateContentWindow to navigate where it pleases.

BUG=509313

Committed: <a href="https://crrev.com/d523a41aed4e321d4c8197b5cccb73be23c8dcc2" rel="nofollow">https://crrev.com/d523a41aed4e321d4c8197b5cccb73be23c8dcc2</a>
Cr-Commit-Position: refs/heads/master@{#373598}
==========</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message issue_was_closed   "
           
           id="msg54"
           name="53">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(53)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>commit-bot: I haz the power</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden; display: none;"
                           class="extra"
                           id="cl-preview-53">
                          Patchset 11 (id:??) landed as https://crrev.com/d523a41aed4e321d4c8197b5cccb73be23c8dcc2 Cr-Commit-Position: refs/heads/master@{#373598}
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 10 months ago
		(2016-02-04 20:07:36 UTC)
                <a href="#msg54">#54</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-53"
             >
          <div class="message-body">
            
              <span class="extra-note">
                Message was sent while issue was closed.
              </span>
            
            <pre name="cl-message-53"
            >Patchset 11 (id:??) landed as
<a href="https://crrev.com/d523a41aed4e321d4c8197b5cccb73be23c8dcc2" rel="nofollow">https://crrev.com/d523a41aed4e321d4c8197b5cccb73be23c8dcc2</a>
Cr-Commit-Position: refs/heads/master@{#373598}</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    

    <div>
      <a href="javascript:M_expandAllVisibleComments('cl', 54)">
        Expand Messages</a>
      |
      <a href="javascript:M_collapseAllVisibleComments('cl', 54)">
        Collapse Messages</a>
      
      |
      <a href="javascript:M_showGeneratedComments(54)">
        Show Generated Messages</a>
      |
      <a href="javascript:M_hideGeneratedComments(54)">
        Hide Generated Messages</a>
      
    </div>

  </div>

<script language="JavaScript" type="text/javascript">
<!--
var lastMsgID = 54;
// -->
</script>




<script language="JavaScript" type="text/javascript">
  <!--
    document.onkeydown = M_changelistKeyDown;
    var dashboardState = new M_DashboardState(window, 'patch', 'M_CLPatchMarker');
    var issueId = 1669723002;
    M_toggleIssueOverviewByAnchor();
  // -->
</script>



      </td>
    </tr>
  </table>

</div>

  
    <div class="popup" id="popup-issue">
      <b>Issue 1669723002: NTP: don&#39;t allow navigateContentWindow to navigate where it pleases.
     (Closed) </b><br/>
      Created 4 years, 10 months ago by dcheng<br/>
      Modified 4 years, 10 months ago<br/>
      Reviewers: Charlie Reis, Jered, jochen (gone - plz use gerrit), Mathieu, nasko, samarth, Nico, Marc Treib, Robert Sesek<br/>
      Base URL: https://chromium.googlesource.com/chromium/src.git@master<br/>
      Comments: 12
      
    </div>
  


<p></p>
<div style="float: left;">
  <a target="_blank" href="http://code.google.com/appengine/"><img border="0"
   src="/static/appengine-noborder-120x30.gif"
   alt="Powered by Google App Engine" /></a>
</div>

<div class="extra" style="font-size: 9pt; float: right; text-align: right;">
  <div style="margin-top: .3em;">This is Rietveld <a href='http://code.google.com/p/rietveld/source/list'>408576698
</a></div>
</div>


<script>
  // Google Analytics.
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-55762617-11', {
    'allowLinker': true,
    'siteSpeedSampleRate': 100
  });
  ga('require', 'linker');
  ga('linker:autoLink',
     ['chromiumcodereview.appspot.com', 'codereview.chromium.org'] );
  ga('send', 'pageview');

  // CRDX Feedback button.
  (function(i,s,o,g,r,a,m){i['CrDXObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://storage.googleapis.com/crdx-feedback.appspot.com/feedback.js','crdx');

  crdx('setFeedbackButtonLink',
      'https://bugs.chromium.org/p/chromium/issues/entry?cc=andybons@chromium.org&components=Infra%3ECodereview%3ERietveld&labels=Infra-DX');
</script>


</body>
</html>
