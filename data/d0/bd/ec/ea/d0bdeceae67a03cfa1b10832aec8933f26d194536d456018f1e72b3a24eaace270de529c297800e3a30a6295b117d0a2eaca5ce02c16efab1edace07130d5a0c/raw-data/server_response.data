<!DOCTYPE html>
<html lang="en">
  <head>
    <title>28823 &ndash; Missing input sanitation in __glXDisp_CreateContext  triggers SEGV</title>

      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<link href="data/assets/c60deb3d48830179eae269c9e65a7506.css?1462892334" rel="stylesheet" type="text/css">



    
<script type="text/javascript" src="data/assets/a7c2f3a028f17a9aa60f56dc9d6e732d.js?1462892331"></script>

    <script type="text/javascript">
    <!--
        YAHOO.namespace('bugzilla');
        YAHOO.util.Event.addListener = function (el, sType, fn, obj, overrideContext) {
               if ( ("onpagehide" in window || YAHOO.env.ua.gecko) && sType === "unload") { sType = "pagehide"; };
               var capture = ((sType == "focusin" || sType == "focusout") && !YAHOO.env.ua.ie) ? true : false;
               return this._addListener(el, this._getType(sType), fn, obj, overrideContext, capture);
         };
        if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
            YAHOO.util.Event._simpleRemove(window, "unload", 
                                           YAHOO.util.Event._unload);
        }
        
        function unhide_language_selector() { 
            YAHOO.util.Dom.removeClass(
                'lang_links_container', 'bz_default_hidden'
            ); 
        } 
        YAHOO.util.Event.onDOMReady(unhide_language_selector);

        
        var BUGZILLA = {
            param: {
                cookiepath: '\/',
                maxusermatches: 1000
            },
            constant: {
                COMMENT_COLS: 80
            },
            string: {
                

                attach_desc_required:
                    "You must enter a Description for this attachment.",
                component_required:
                    "You must select a Component for this bug.",
                description_required:
                    "You must enter a Description for this bug.",
                short_desc_required:
                    "You must enter a Summary for this bug.",
                version_required:
                    "You must select a Version for this bug."
            }
              , api_token: ''
        };

    if (history && history.replaceState) {
      if(!document.location.href.match(/show_bug\.cgi/)) {
        history.replaceState( null,
                             "28823 – Missing input sanitation in __glXDisp_CreateContext  triggers SEGV",
                             "show_bug.cgi?id=28823" );
        document.title = "28823 – Missing input sanitation in __glXDisp_CreateContext  triggers SEGV";
      }
      if (document.location.href.match(/show_bug\.cgi\?.*list_id=/)) {
        var href = document.location.href;
        href = href.replace(/[\?&]+list_id=(\d+|cookie)/, '');
        history.replaceState(null, "28823 – Missing input sanitation in __glXDisp_CreateContext  triggers SEGV", href);
      }
    }
    YAHOO.util.Event.onDOMReady(function() {
      initDirtyFieldTracking();

    });
    // -->
    </script>
<script type="text/javascript" src="data/assets/daf5e0fb6826e6a35280e622913f0c4a.js?1462892334"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla" href="./search_plugin.cgi">
    <link rel="shortcut icon" href="images/favicon.ico">
  </head>

  <body 
        class="bugs-freedesktop-org
                 bz_bug
                 bz_status_RESOLVED
                 bz_product_xorg
                 bz_component_Security
                 bz_bug_28823 yui-skin-sam">

  <div id="header"><div id="banner">
  </div>

    <div id="titles">
      <span id="title">Bugzilla &ndash; Bug&nbsp;28823</span>

        <span id="subtitle" class="subheader">Missing input sanitation in __glXDisp_CreateContext  triggers SEGV</span>

        <span id="information" class="header_addl_info">Last modified: 2011-09-22 10:23:50 UTC</span>
    </div>


    <div id="common_links"><ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="describecomponents.cgi">Browse</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_top" name="no_redirect" value="0">
    <script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_top");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_top" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_top"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>


</ul>
    </div>
  </div>

  <div id="bugzilla-body">


<script type="text/javascript">
<!--

//-->
</script>

<form name="changeform" id="changeform" method="post" action="process_bug.cgi">

  <input type="hidden" name="delta_ts" value="2011-09-22 10:23:50">
  <input type="hidden" name="id" value="28823">
  <input type="hidden" name="token" value="1635619149-60mfUMZ4qX6NI2BwSmtTOdct0oAEUmX7Oeanf4433Uo">
<div class="bz_short_desc_container edit_form">
     <a href="show_bug.cgi?id=28823"><b>Bug&nbsp;28823</b></a> <span id="summary_container" class="bz_default_hidden">
      - <span id="short_desc_nonedit_display">Missing input sanitation in __glXDisp_CreateContext  triggers SEGV</span>
     </span>

    <div id="summary_input"><span class="field_label "
    id="field_label_short_desc">


  <a 
      title="The bug summary is a short sentence which succinctly describes what the bug is about."
      class="field_help_link"
      href="page.cgi?id=fields.html#short_desc"
  >Summary:</a>

</span>Missing input sanitation in __glXDisp_CreateContext  triggers SEGV
    </div>
  </div>
  <script type="text/javascript">
    hideEditableField('summary_container',
                      'summary_input',
                      'summary_edit_action',
                      'short_desc',
                      'Missing input sanitation in __glXDisp_CreateContext  triggers SEGV' );
  </script>
  <table class="edit_form">
    <tr>
      
      <td id="bz_show_bug_column_1" class="bz_show_bug_column">     
        <table>
          <tr>
    <th class="field_label">
      <a href="page.cgi?id=fields.html#bug_status">Status</a>:
    </th>
    <td id="bz_field_status">
      <span id="static_bug_status">RESOLVED
          FIXED
      </span>
    </td>
  </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_alias">


  <a 
      title="A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla."
      class="field_help_link"
      href="page.cgi?id=fields.html#alias"
  >Alias:</a>

</th>
    <td>
        None
    </td>
  </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_product">


  <a 
      title="Bugs are categorised into Products and Components."
      class="field_help_link"
      href="describecomponents.cgi"
  >Product:</a>

</th>
  <td class="field_value "
      id="field_container_product" >xorg

</td>
    </tr>

    
    <tr class="bz_default_hidden"><th class="field_label "
    id="field_label_classification">


  <a 
      title="Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation."
      class="field_help_link"
      href="page.cgi?id=fields.html#classification"
  >Classification:</a>

</th>
  <td class="field_value "
      id="field_container_classification" >Unclassified

</td>
    </tr>
        
    
    
    <tr><th class="field_label "
    id="field_label_component">


  <a 
      title="Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list."
      class="field_help_link"
      href="describecomponents.cgi?product=xorg"
  >Component:</a>

</th>
  <td class="field_value "
      id="field_container_component" >Security

  (<a href="buglist.cgi?component=Security&amp;product=xorg&amp;bug_status=__open__"
      target="_blank">show other bugs</a>)
</td>
    </tr>
    <tr><th class="field_label "
    id="field_label_version">


  <a 
      title="The version field defines the version of the software the bug was found in."
      class="field_help_link"
      href="page.cgi?id=fields.html#version"
  >Version:</a>

</th>
<td>7.5 (2009.10)
  </td>
    </tr>
        
    
        
    <tr><th class="field_label "
    id="field_label_rep_platform">


  <a 
      title="The hardware platform the bug was observed on. Note: When searching, selecting the option &quot;All&quot; only finds bugs whose value for this field is literally the word &quot;All&quot;."
      class="field_help_link"
      href="page.cgi?id=fields.html#rep_platform"
  >Hardware:</a>

</th>
      <td class="field_value">x86 (IA32)
        Linux (All)
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          
          <tr>
      <th class="field_label">
        <label  accesskey="i">
          <a href="page.cgi?id=fields.html#importance"><u>I</u>mportance</a></label>:
      </th>
      <td>medium
       major
      </td>
    </tr>
          
          <tr><th class="field_label "
    id="field_label_assigned_to">


  <a 
      title="The person in charge of resolving the bug."
      class="field_help_link"
      href="page.cgi?id=fields.html#assigned_to"
  >Assignee:</a>

</th>
      <td><span class="vcard"><span class="fn">X.Org Security</span>
</span>
      </td>
    </tr>

    <tr><th class="field_label "
    id="field_label_qa_contact">


  <a 
      title="The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#qa_contact"
  >QA Contact:</a>

</th>
      <td><span class="vcard"><span class="fn">X.Org Security</span>
</span>
      </td>
    </tr>
    <script type="text/javascript">
      assignToDefaultOnChange(['product', 'component'],
        'xorg_security\x40x.org',
        'xorg_security\x40x.org');
    </script>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr><th class="field_label "
    id="field_label_bug_file_loc">


  <a 
      title="Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen."
      class="field_help_link"
      href="page.cgi?id=fields.html#bug_file_loc"
  >URL:</a>

</th>
    <td>
      <span id="bz_url_input_area">
      </span>
    </td>
  </tr>

    <tr><th class="field_label "
    id="field_label_status_whiteboard">


  <a 
      title="Each bug has a free-form single line text entry box for adding tags and status information."
      class="field_help_link"
      href="page.cgi?id=fields.html#status_whiteboard"
  >Whiteboard:</a>

</th><td>  
  </td>
    </tr>

    <tr><th class="field_label "
    id="field_label_keywords">


  <a 
      title="You can add keywords from a defined list to bugs, in order to easily identify and group them."
      class="field_help_link"
      href="describekeywords.cgi"
  >Keywords:</a>

</th>
  <td class="field_value "
      id="field_container_keywords" >

</td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>

          
<tr><th class="field_label "
    id="field_label_dependson">


  <a 
      title="The bugs listed here must be resolved before this bug can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#dependson"
  >Depends on:</a>

</th>

  <td>
    <span id="dependson_input_area">
    </span>

  </td>
  </tr>
  
  <tr><th class="field_label "
    id="field_label_blocked">


  <a 
      title="This bug must be resolved before the bugs listed in this field can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#blocked"
  >Blocks:</a>

</th>

  <td>
    <span id="blocked_input_area">
    </span>

  </td>
  </tr>
          
        </table>
      </td>
      <td>
        <div class="bz_column_spacer">&nbsp;</div>
      </td>
      
      <td id="bz_show_bug_column_2" class="bz_show_bug_column">
        <table>
        <tr>
    <th class="field_label">
      Reported:
    </th>
    <td>2010-06-29 14:10 UTC by <span class="vcard"><span class="fn">halfdog</span>
</span>
    </td>
  </tr>
  
  <tr>
    <th class="field_label">
      Modified:
    </th>
    <td>2011-09-22 10:23 UTC
      (<a href="show_activity.cgi?id=28823">History</a>)
    </td>
  
  </tr>
<tr>
      <th class="field_label">
        <label  accesskey="a">
          CC List:
        </label>
      </th>
      <td>2 
          users
          <span id="cc_edit_area_showhide_container" class="bz_default_hidden">
            (<a href="#" id="cc_edit_area_showhide">show</a>)
          </span>
        <div id="cc_edit_area">
          <br>
            <select id="cc" multiple="multiple" size="5" >
                <option value="meissner">meissner</option>
                <option value="sndirsch">sndirsch</option>
            </select>
        </div>
          <script type="text/javascript">
            hideEditableField( 'cc_edit_area_showhide_container', 
                               'cc_edit_area', 
                               'cc_edit_area_showhide', 
                               '', 
                               '');  
          </script>
      </td>
    </tr>

<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_see_also">


  <a 
      title="This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields."
      class="field_help_link"
      href="page.cgi?id=fields.html#see_also"
  >See Also:</a>

</th>
  <td class="field_value "
      id="field_container_see_also" >

</td>
    </tr> 
<tr>
      <th class="field_label  bz_hidden_field"
    id="field_label_cf_i915_platform">


  <a 
      title="Intel platforms affected by the bug"
      class="field_help_link"
      href="page.cgi?id=fields.html#cf_i915_platform"
  >i915 platform:</a>

</th>
  <td class="field_value  bz_hidden_field"
      id="field_container_cf_i915_platform" >

</td>
    </tr>
    <tr>
      <th class="field_label  bz_hidden_field"
    id="field_label_cf_i915_features">


  <a 
      title="Features of the i915 driver affected by the bug."
      class="field_help_link"
      href="page.cgi?id=fields.html#cf_i915_features"
  >i915 features:</a>

</th>
  <td class="field_value  bz_hidden_field"
      id="field_container_cf_i915_features" >

</td>
    </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>



        </table>
      </td>
    </tr>
    <tr>
      <td colspan="3">
          <hr id="bz_top_half_spacer">
      </td>
    </tr>
  </table>

  <table id="bz_big_form_parts">
  <tr>
  <td>

    
<script type="text/javascript">
<!--
function toggle_display(link) {
    var table = document.getElementById("attachment_table");
    var view_all = document.getElementById("view_all");
    var hide_obsolete_url_parameter = "&hide_obsolete=1";
    // Store current height for scrolling later
    var originalHeight = table.offsetHeight;
    var rows = YAHOO.util.Dom.getElementsByClassName(
        'bz_tr_obsolete', 'tr', table);

    for (var i = 0; i < rows.length; i++) {
        bz_toggleClass(rows[i], 'bz_default_hidden');
    }

    if (YAHOO.util.Dom.hasClass(rows[0], 'bz_default_hidden')) {
        link.innerHTML = "Show Obsolete";
        view_all.href = view_all.href + hide_obsolete_url_parameter 
    }
    else {
        link.innerHTML = "Hide Obsolete";
        view_all.href = view_all.href.replace(hide_obsolete_url_parameter,"");
    }

    var newHeight = table.offsetHeight;
    // This scrolling makes the window appear to not move at all.
    window.scrollBy(0, newHeight - originalHeight);

    return false;
}
//-->
</script>

<br>
<table id="attachment_table">
  <tr id="a0">
    <th colspan="3" class="left">
      Attachments
    </th>
  </tr>


      <tr id="a1" class="bz_contenttype_text_plain bz_patch">
        <td>
            <a href="attachment.cgi?id=36729"
               title="View the content of the attachment">
          <b>check for screen &lt; 0 in validGlxScreen()</b></a>

          <span class="bz_attach_extra_info">
              (748 bytes,
                patch)

            <br>
            <a href="#attach_36729"
               title="Go to the comment associated with the attachment">2010-07-03 12:21 UTC</a>,

            <span class="vcard"><span class="fn">Julien Cristau</span>
</span>
          </span>
        </td>

          <td class="bz_attach_flags">
              <i>no flags</i>
          </td>

        <td>
          <a href="attachment.cgi?id=36729&amp;action=edit">Details</a>&#x0020; |
    <a href="https://bugs.freedesktop.org/page.cgi?id=splinter.html&amp;bug=28823&amp;attachment=36729">
      Splinter Review</a>
        </td>
      </tr>
      <tr id="a2" class="bz_contenttype_text_plain bz_patch">
        <td>
            <a href="attachment.cgi?id=36730"
               title="View the content of the attachment">
          <b>use validGlxScreen in more places</b></a>

          <span class="bz_attach_extra_info">
              (3.01 KB,
                patch)

            <br>
            <a href="#attach_36730"
               title="Go to the comment associated with the attachment">2010-07-03 12:22 UTC</a>,

            <span class="vcard"><span class="fn">Julien Cristau</span>
</span>
          </span>
        </td>

          <td class="bz_attach_flags">
              <i>no flags</i>
          </td>

        <td>
          <a href="attachment.cgi?id=36730&amp;action=edit">Details</a>&#x0020; |
    <a href="https://bugs.freedesktop.org/page.cgi?id=splinter.html&amp;bug=28823&amp;attachment=36730">
      Splinter Review</a>
        </td>
      </tr>
      <tr id="a3" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td>
            <a href="attachment.cgi?id=36731"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">validate request lengths</span></b></a>

          <span class="bz_attach_extra_info">
              (19.52 KB,
                patch)

            <br>
            <a href="#attach_36731"
               title="Go to the comment associated with the attachment">2010-07-03 12:23 UTC</a>,

            <span class="vcard"><span class="fn">Julien Cristau</span>
</span>
          </span>
        </td>

          <td class="bz_attach_flags">
              <i>no flags</i>
          </td>

        <td>
          <a href="attachment.cgi?id=36731&amp;action=edit">Details</a>&#x0020; |
    <a href="https://bugs.freedesktop.org/page.cgi?id=splinter.html&amp;bug=28823&amp;attachment=36731">
      Splinter Review</a>
        </td>
      </tr>
      <tr id="a4" class="bz_contenttype_text_plain bz_patch">
        <td>
            <a href="attachment.cgi?id=38061"
               title="View the content of the attachment">
          <b>validate request lengths</b></a>

          <span class="bz_attach_extra_info">
              (19.99 KB,
                patch)

            <br>
            <a href="#attach_38061"
               title="Go to the comment associated with the attachment">2010-08-22 08:29 UTC</a>,

            <span class="vcard"><span class="fn">Julien Cristau</span>
</span>
          </span>
        </td>

          <td class="bz_attach_flags">
              <i>no flags</i>
          </td>

        <td>
          <a href="attachment.cgi?id=38061&amp;action=edit">Details</a>&#x0020; |
    <a href="https://bugs.freedesktop.org/page.cgi?id=splinter.html&amp;bug=28823&amp;attachment=38061">
      Splinter Review</a>
        </td>
      </tr>
      <tr id="a5" class="bz_contenttype_text_plain bz_patch">
        <td>
            <a href="attachment.cgi?id=38062"
               title="View the content of the attachment">
          <b>check request lengths before swapping</b></a>

          <span class="bz_attach_extra_info">
              (19.29 KB,
                patch)

            <br>
            <a href="#attach_38062"
               title="Go to the comment associated with the attachment">2010-08-22 08:32 UTC</a>,

            <span class="vcard"><span class="fn">Julien Cristau</span>
</span>
          </span>
        </td>

          <td class="bz_attach_flags">
              <i>no flags</i>
          </td>

        <td>
          <a href="attachment.cgi?id=38062&amp;action=edit">Details</a>&#x0020; |
    <a href="https://bugs.freedesktop.org/page.cgi?id=splinter.html&amp;bug=28823&amp;attachment=38062">
      Splinter Review</a>
        </td>
      </tr>
      <tr id="a6" class="bz_contenttype_text_plain bz_patch">
        <td>
            <a href="attachment.cgi?id=38063"
               title="View the content of the attachment">
          <b>swap 2 * numAttribs ints, not just numAttribs</b></a>

          <span class="bz_attach_extra_info">
              (2.39 KB,
                patch)

            <br>
            <a href="#attach_38063"
               title="Go to the comment associated with the attachment">2010-08-22 08:34 UTC</a>,

            <span class="vcard"><span class="fn">Julien Cristau</span>
</span>
          </span>
        </td>

          <td class="bz_attach_flags">
              <i>no flags</i>
          </td>

        <td>
          <a href="attachment.cgi?id=38063&amp;action=edit">Details</a>&#x0020; |
    <a href="https://bugs.freedesktop.org/page.cgi?id=splinter.html&amp;bug=28823&amp;attachment=38063">
      Splinter Review</a>
        </td>
      </tr>
      <tr id="a7" class="bz_contenttype_text_plain">
        <td>
            <a href="attachment.cgi?id=40181"
               title="View the content of the attachment">
          <b>testcase for glXCreateContext</b></a>

          <span class="bz_attach_extra_info">
              (861 bytes,
                text/plain)

            <br>
            <a href="#attach_40181"
               title="Go to the comment associated with the attachment">2010-11-10 11:52 UTC</a>,

            <span class="vcard"><span class="fn">Julien Cristau</span>
</span>
          </span>
        </td>

          <td class="bz_attach_flags">
              <i>no flags</i>
          </td>

        <td>
          <a href="attachment.cgi?id=40181&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a8" class="bz_contenttype_text_plain bz_patch">
        <td>
            <a href="attachment.cgi?id=40185"
               title="View the content of the attachment">
          <b>check that req-&gt;numattribs is not too big</b></a>

          <span class="bz_attach_extra_info">
              (4.59 KB,
                patch)

            <br>
            <a href="#attach_40185"
               title="Go to the comment associated with the attachment">2010-11-10 14:51 UTC</a>,

            <span class="vcard"><span class="fn">Julien Cristau</span>
</span>
          </span>
        </td>

          <td class="bz_attach_flags">
              <i>no flags</i>
          </td>

        <td>
          <a href="attachment.cgi?id=40185&amp;action=edit">Details</a>&#x0020; |
    <a href="https://bugs.freedesktop.org/page.cgi?id=splinter.html&amp;bug=28823&amp;attachment=40185">
      Splinter Review</a>
        </td>
      </tr>

  <tr class="bz_attach_footer">
    <td colspan="3">
        <span class="bz_attach_view_hide">
            <a href="#a0" onclick="return toggle_display(this);">Show
              Obsolete</a> (1)
            <a id="view_all" href="attachment.cgi?bugid=28823&amp;action=viewall&amp;hide_obsolete=1">View All</a>
        </span>
    </td>
  </tr>
</table>
<br>
  </td>
  <td>
  </td>
  </tr></table>

  
  <div id="comments"><script src="js/comments.js?1462891770" type="text/javascript">
</script>

<script type="text/javascript">
<!--
  /* Adds the reply text to the 'comment' textarea */
  function replyToComment(id, real_id, name) {
      var prefix = "(In reply to " + name + " from comment #" + id + ")\n";
      var replytext = "";
        /* pre id="comment_name_N" */
        var text_elem = document.getElementById('comment_text_'+id);
        var text = getText(text_elem);
        replytext = prefix + wrapReplyText(text);


      /* <textarea id="comment"> */
      var textarea = document.getElementById('comment');
      if (textarea.value != replytext) {
          textarea.value += replytext;
      }

      textarea.focus();
  } 
//-->
</script>


<!-- This auto-sizes the comments and positions the collapse/expand links 
     to the right. -->
<table class="bz_comment_table">
<tr>
<td>
<div id="c0" class="bz_comment bz_first_comment">

      <div class="bz_first_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=28823#c0">Description</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">halfdog</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-06-29 14:10:51 UTC
        </span>

      </div>




<pre class="bz_comment_text">During X server security testing, current lucid xserver was terminated on
invalid request:

ii  xserver-xorg                      1:7.5+5ubuntu1                           
      the X.Org X server
ii  xserver-xorg-core                 2:1.7.6-2ubuntu7.2                       
      Xorg X server - core server


These 2 packets (auth, __glXDisp_CreateContext) cause glx to read screen information from arbitrary memory location, but maybe only on 32 bit systems.

0000000: 6c00 0b00 0000 0000 0000 0000 9a03 0500  l...............
0000010: f857 3051 67e9 c5ba 735d 6edc b51c 95cf  .W0Qg...s]n.....


Problem is in glx/glxcmds.c validGlxScreen

static int
validGlxScreen(ClientPtr client, int screen, __GLXscreen **pGlxScreen, int *err)
{
    /*
    ** Check if screen exists.
    */
<span class="quote">&gt;&gt;&gt;&gt;&gt;&gt; No error if screen number is negative</span >
    if (screen &gt;= screenInfo.numScreens) {
        client-&gt;errorValue = screen;
        *err = BadValue;
        return FALSE;
    }
<span class="quote">&gt;&gt;&gt;&gt;&gt;&gt; Wrap around in 32bit mem few times</span >
    *pGlxScreen = glxGetScreen(screenInfo.screens[screen]);

    return TRUE;
}


Backtrace:
0: /usr/bin/X (xorg_backtrace+0x3b) [0x80e937b]
1: /usr/bin/X (0x8048000+0x61c7d) [0x80a9c7d]
2: (vdso) (__kernel_rt_sigreturn+0x0) [0xa6c410]
3: /usr/lib/xorg/modules/extensions/libglx.so (0x3f6000+0x34a76) [0x42aa76]
4: /usr/lib/xorg/modules/extensions/libglx.so (0x3f6000+0x36c22) [0x42cc22]
5: /usr/bin/X (0x8048000+0x2a477) [0x8072477]
6: /usr/bin/X (0x8048000+0x1ed7a) [0x8066d7a]
7: /lib/tls/i686/cmov/libc.so.6 (__libc_start_main+0xe6) [0xac6bd6]
8: /usr/bin/X (0x8048000+0x1e961) [0x8066961]
Segmentation fault at address 0x79d95180

Consequence of error not clear, since invalid screen data pointer might produce nearly unpredictable side effects. Apart from that, function is called from various locations in code.


Credits to <a href="mailto:me&#64;halfdog.net">me&#64;halfdog.net</a></pre>
    </div>

    <div id="c1" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=28823#c1">Comment 1</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">halfdog</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-06-30 13:31:32 UTC
        </span>

      </div>




<pre class="bz_comment_text">The glx code is rather buggy, e.g.

Not even verify if screen is valid, just dereference (occurs more than once)

int __glXDisp_HyperpipeConfigSGIX(__GLXclientState *cl, GLbyte *pc)
{
    ClientPtr client = cl-&gt;client;
    xGLXHyperpipeConfigSGIXReq * req =
        (xGLXHyperpipeConfigSGIXReq *) pc;
    xGLXHyperpipeConfigSGIXReply reply;
    int screen = req-&gt;screen;
    void *rdata;

    int npipes=0, networkId;
    int hpId=-1;
    __GLXscreen *pGlxScreen;
<span class="quote">&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; untrusted screen var</span >
    pGlxScreen = glxGetScreen(screenInfo.screens[screen]);


Some of the numattr loops do not check the client request size and the num attr value, large attr value (CARD32) triggers SEGV</pre>
    </div>

    <div id="c2" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=28823#c2">Comment 2</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Julien Cristau</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-07-03 12:21:17 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class=""><a href="attachment.cgi?id=36729" name="attach_36729" title="check for screen &lt; 0 in validGlxScreen()">attachment 36729</a> <a href="attachment.cgi?id=36729&amp;action=edit" title="check for screen &lt; 0 in validGlxScreen()">[details]</a></span> <a href='page.cgi?id=splinter.html&amp;bug=28823&amp;attachment=36729'>[review]</a>
check for screen &lt; 0 in validGlxScreen()

Here's a (mostly untested) attempt at fixing a few of those things.</pre>
    </div>

    <div id="c3" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=28823#c3">Comment 3</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Julien Cristau</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-07-03 12:22:20 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class=""><a href="attachment.cgi?id=36730" name="attach_36730" title="use validGlxScreen in more places">attachment 36730</a> <a href="attachment.cgi?id=36730&amp;action=edit" title="use validGlxScreen in more places">[details]</a></span> <a href='page.cgi?id=splinter.html&amp;bug=28823&amp;attachment=36730'>[review]</a>
use validGlxScreen in more places</pre>
    </div>

    <div id="c4" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=28823#c4">Comment 4</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Julien Cristau</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-07-03 12:23:34 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=36731" name="attach_36731" title="validate request lengths">attachment 36731</a> <a href="attachment.cgi?id=36731&amp;action=edit" title="validate request lengths">[details]</a></span> <a href='page.cgi?id=splinter.html&amp;bug=28823&amp;attachment=36731'>[review]</a>
validate request lengths

Something similar probably needs to be done for the glxcmdsswap.c?</pre>
    </div>

    <div id="c5" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=28823#c5">Comment 5</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Adam Jackson</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-08-20 12:30:47 UTC
        </span>

      </div>




<pre class="bz_comment_text">Reviewed-by: Adam Jackson &lt;<a href="mailto:ajax&#64;redhat.com">ajax&#64;redhat.com</a>&gt;

for the above three patches.</pre>
    </div>

    <div id="c6" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=28823#c6">Comment 6</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Julien Cristau</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-08-22 08:29:13 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class=""><a href="attachment.cgi?id=38061" name="attach_38061" title="validate request lengths">attachment 38061</a> <a href="attachment.cgi?id=38061&amp;action=edit" title="validate request lengths">[details]</a></span> <a href='page.cgi?id=splinter.html&amp;bug=28823&amp;attachment=38061'>[review]</a>
validate request lengths

While looking at glxcmdsswap.c I noticed a mistake and an omission in the previous patch.  Interdiff is:

diff --git a/glx/glxcmds.c b/glx/glxcmds.c
index 73c3b2a..70c766c 100644
--- a/glx/glxcmds.c
+++ b/glx/glxcmds.c
&#64;&#64; -1511,7 +1511,7 &#64;&#64; int __glXDisp_CreateWindow(__GLXclientState *cl, GLbyte *pc)
     DrawablePtr                 pDraw;
     int                         err;
 
-    REQUEST_SIZE_MATCH(xGLXCreateWindowReq);
+    REQUEST_FIXED_SIZE(xGLXCreateWindowReq, req-&gt;numAttribs &lt;&lt; 3);
 
     LEGAL_NEW_RESOURCE(req-&gt;glxwindow, client);
 
diff --git a/glx/xfont.c b/glx/xfont.c
index b4081cf..eafac01 100644
--- a/glx/xfont.c
+++ b/glx/xfont.c
&#64;&#64; -155,6 +155,8 &#64;&#64; int __glXDisp_UseXFont(__GLXclientState *cl, GLbyte *pc)
     __GLXcontext *cx;
     int error;
 
+    REQUEST_SIZE_MATCH(xGLXUseXFontReq);
+
     req = (xGLXUseXFontReq *) pc;
     cx = __glXForceCurrent(cl, req-&gt;contextTag, &amp;error);
     if (!cx) {</pre>
    </div>

    <div id="c7" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=28823#c7">Comment 7</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Julien Cristau</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-08-22 08:32:18 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class=""><a href="attachment.cgi?id=38062" name="attach_38062" title="check request lengths before swapping">attachment 38062</a> <a href="attachment.cgi?id=38062&amp;action=edit" title="check request lengths before swapping">[details]</a></span> <a href='page.cgi?id=splinter.html&amp;bug=28823&amp;attachment=38062'>[review]</a>
check request lengths before swapping</pre>
    </div>

    <div id="c8" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=28823#c8">Comment 8</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Julien Cristau</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-08-22 08:34:16 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class=""><a href="attachment.cgi?id=38063" name="attach_38063" title="swap 2 * numAttribs ints, not just numAttribs">attachment 38063</a> <a href="attachment.cgi?id=38063&amp;action=edit" title="swap 2 * numAttribs ints, not just numAttribs">[details]</a></span> <a href='page.cgi?id=splinter.html&amp;bug=28823&amp;attachment=38063'>[review]</a>
swap 2 * numAttribs ints, not just numAttribs

I noticed this while adding the length checks: some glx requests include a list of pairs of CARD32, with numAttribs elements (i.e. pairs).  From what I can tell we were only swapping numAttribs CARD32s.</pre>
    </div>

    <div id="c9" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=28823#c9">Comment 9</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Julien Cristau</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-10-20 09:45:46 UTC
        </span>

      </div>




<pre class="bz_comment_text">Review of <span class=""><a href="attachment.cgi?id=38061" name="attach_38061" title="validate request lengths">attachment 38061</a> <a href="attachment.cgi?id=38061&amp;action=edit" title="validate request lengths">[details]</a></span> <a href='page.cgi?id=splinter.html&amp;bug=28823&amp;attachment=38061'>[review]</a>:

::: glx/glxcmds.c
&#64;&#64; +1285,3 &#64;&#64;
     int err;
 
+    REQUEST_FIXED_SIZE(xGLXCreatePixmapReq, req-&gt;numAttribs &lt;&lt; 3);

I suppose this should validate numAttribs first to make sure it doesn't overflow.  *sigh*</pre>
    </div>

    <div id="c10" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=28823#c10">Comment 10</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Thomas Biege</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-10-21 02:50:38 UTC
        </span>

      </div>




<pre class="bz_comment_text">How can I reproduce the bug?</pre>
    </div>

    <div id="c11" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=28823#c11">Comment 11</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Julien Cristau</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-11-10 11:52:41 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class=""><a href="attachment.cgi?id=40181" name="attach_40181" title="testcase for glXCreateContext">attachment 40181</a> <a href="attachment.cgi?id=40181&amp;action=edit" title="testcase for glXCreateContext">[details]</a></span>
testcase for glXCreateContext

attached trivial testcase crashes the server by passing a broken screen number to glxCreateContext</pre>
    </div>

    <div id="c12" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=28823#c12">Comment 12</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Julien Cristau</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-11-10 14:51:11 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class=""><a href="attachment.cgi?id=40185" name="attach_40185" title="check that req-&gt;numattribs is not too big">attachment 40185</a> <a href="attachment.cgi?id=40185&amp;action=edit" title="check that req-&gt;numattribs is not too big">[details]</a></span> <a href='page.cgi?id=splinter.html&amp;bug=28823&amp;attachment=40185'>[review]</a>
check that req-&gt;numattribs is not too big

One more patch to check req-&gt;numAttribs before using it to compute the request length.</pre>
    </div>

    <div id="c13" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=28823#c13">Comment 13</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Julien Cristau</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-11-10 14:52:23 UTC
        </span>

      </div>




<pre class="bz_comment_text">(In reply to <a href="show_bug.cgi?id=28823#c3">comment #3</a>)
<span class="quote">&gt; Created an attachment (id=36730) [details]
&gt; use validGlxScreen in more places</span >

this one is actually patching dead code, so not strictly necessary.</pre>
    </div>

    <div id="c14" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=28823#c14">Comment 14</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Thomas Biege</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-11-15 05:06:45 UTC
        </span>

      </div>




<pre class="bz_comment_text">Thank you a lot.</pre>
    </div>

    <div id="c15" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=28823#c15">Comment 15</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Julien Cristau</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-01-19 02:09:42 UTC
        </span>

      </div>




<pre class="bz_comment_text">Fixed in master</pre>
    </div>

    <div id="c16" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=28823#c16">Comment 16</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Marcus Meissner</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-09-22 09:22:05 UTC
        </span>

      </div>




<pre class="bz_comment_text">fixed apparently by following mainline xorg commit ids in master:

 402b329c3aa8ddbebaa1f593306a02d4cd6fed26
 d9225b9602c85603ae616a7381c784f5cf5e811c
 62319e8381ebd645ae36b25e5fc3c0e9b098387b
 6c69235a9dfc52e4b4e47630ff4bab1a820eb543
 ec9c97c6bf70b523bc500bd3adf62176f1bb33a4
 3f0d3f4d97bce75c1828635c322b6560a45a037f

(in git log order)</pre>
    </div>

    <div id="c17" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=28823#c17">Comment 17</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Julien Cristau</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-09-22 10:23:50 UTC
        </span>

      </div>




<pre class="bz_comment_text"><span class="quote">&gt; --- <a href="show_bug.cgi?id=28823#c16">Comment #16</a> from Marcus Meissner &lt;<a href="mailto:meissner&#64;suse.de">meissner&#64;suse.de</a>&gt; 2011-09-22 09:22:05 PDT ---
&gt; fixed apparently by following mainline xorg commit ids in master:
&gt; 
&gt;  402b329c3aa8ddbebaa1f593306a02d4cd6fed26</span >

1137c11be0f82049d28024eaf963c6f76e0d4334
a883cf1545abd89bb2cadfa659718884b56fd234

(fixed bugs in the initial series)

<span class="quote">&gt;  d9225b9602c85603ae616a7381c784f5cf5e811c
&gt;  62319e8381ebd645ae36b25e5fc3c0e9b098387b
&gt;  6c69235a9dfc52e4b4e47630ff4bab1a820eb543
&gt;  ec9c97c6bf70b523bc500bd3adf62176f1bb33a4
&gt;  3f0d3f4d97bce75c1828635c322b6560a45a037f
&gt; 
&gt; (in git log order)</span >
&gt;</pre>
    </div>


  

</td>
<td>
</td>
</tr></table>
  </div>

</form>

<hr>
<ul class="related_actions">
    <li><a href="show_bug.cgi?format=multiple&amp;id=28823">Format For Printing</a></li>
    
    <li>&nbsp;-&nbsp;<a href="#">Top of page </a></li>
    </ul>

<br>
</div>

    <div id="footer">
      <div class="intro"></div>
<ul id="useful-links">
  <li id="links-actions"><ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="describecomponents.cgi">Browse</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_bottom" name="no_redirect" value="0">
    <script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_bottom");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_bottom" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_bottom"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>


</ul>
  </li>

  




  
</ul>

      <div class="outro"></div>
    </div>
<p align="center">
  Use of freedesktop.org services, including Bugzilla, is subject to our <a href="https://www.freedesktop.org/wiki/CodeOfConduct/">Code of Conduct</a>. How we collect and use information is described in our <a href="https://www.freedesktop.org/wiki/PrivacyPolicy">Privacy Policy</a>.
</p>
  </body>
</html>