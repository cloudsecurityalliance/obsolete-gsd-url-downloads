<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                      "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">
  <head>
    <title>Bug 1791 &ndash; ZDI-CAN-3542: New Vulnerability Report</title>

      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">


<link rel="Top" href="https://bugs.exim.org/">

  


  
    <link rel="Show" title="Dependency Tree"
          href="showdependencytree.cgi?id=1791&amp;hide_resolved=1">
      <link rel="Show" title="Dependency Graph"
            href="showdependencygraph.cgi?id=1791">

      <link rel="Show" title="Bug Activity"
            href="show_activity.cgi?id=1791">
      <link rel="Show" title="Printer-Friendly Version"
            href="show_bug.cgi?format=multiple&amp;id=1791">



    
    <link href="skins/standard/global.css"
          rel="alternate stylesheet" 
          title="Classic"><link href="js/yui/assets/skins/sam/autocomplete.css" rel="stylesheet"
        type="text/css" ><link href="js/yui/assets/skins/sam/calendar.css" rel="stylesheet"
        type="text/css" ><link href="skins/standard/global.css" rel="stylesheet"
        type="text/css" ><link href="skins/standard/show_bug.css" rel="stylesheet"
        type="text/css" ><!--[if lte IE 7]>
      


  <link href="skins/standard/IE-fixes.css" rel="stylesheet"
        type="text/css" >
<![endif]-->

    <link href="skins/contrib/Dusk/global.css" rel="stylesheet"
        type="text/css" title="Dusk">

    

    

    
<script type="text/javascript" src="js/yui/yahoo-dom-event/yahoo-dom-event.js"></script><script type="text/javascript" src="js/yui/cookie/cookie-min.js"></script><script type="text/javascript" src="js/yui/datasource/datasource-min.js"></script><script type="text/javascript" src="js/yui/connection/connection-min.js"></script><script type="text/javascript" src="js/yui/json/json-min.js"></script><script type="text/javascript" src="js/yui/autocomplete/autocomplete-min.js"></script><script type="text/javascript" src="js/yui/calendar/calendar-min.js"></script><script type="text/javascript" src="js/global.js"></script>

    <script type="text/javascript">
    <!--
        YAHOO.namespace('bugzilla');
        YAHOO.util.Event.addListener = function (el, sType, fn, obj, overrideContext) {
               if ( ("onpagehide" in window || YAHOO.env.ua.gecko) && sType === "unload") { sType = "pagehide"; };
               var capture = ((sType == "focusin" || sType == "focusout") && !YAHOO.env.ua.ie) ? true : false;
               return this._addListener(el, this._getType(sType), fn, obj, overrideContext, capture);
         };
        if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
            YAHOO.util.Event._simpleRemove(window, "unload", 
                                           YAHOO.util.Event._unload);
        }
        
        function unhide_language_selector() { 
            YAHOO.util.Dom.removeClass(
                'lang_links_container', 'bz_default_hidden'
            ); 
        } 
        YAHOO.util.Event.onDOMReady(unhide_language_selector);

        
        var BUGZILLA = {
            param: {
                cookiepath: '\/',
                maxusermatches: 1000
            },
            constant: {
                COMMENT_COLS: 80
            },
            string: {
                

                attach_desc_required:
                    'You must enter a Description for this attachment.',
                component_required:
                    'You must select a Component for this bug.',
                description_required:
                    'You must enter a Description for this bug.',
                short_desc_required:
                    'You must enter a Summary for this bug.',
                version_required:
                    'You must select a Version for this bug.'
            }
        };

    if (history && history.replaceState) {
      if(!document.location.href.match(/show_bug\.cgi/)) {
        history.replaceState( null, 
                             "Bug 1791 – ZDI-CAN-3542: New Vulnerability Report",  
                             "show_bug.cgi?id=1791" );
        document.title = "Bug 1791 – ZDI-CAN-3542: New Vulnerability Report";
      }
      if (document.location.href.match(/show_bug\.cgi\?.*list_id=/)) {
        var href = document.location.href;
        href = href.replace(/[\?&]+list_id=(\d+|cookie)/, '');
        history.replaceState(null, "Bug 1791 – ZDI-CAN-3542: New Vulnerability Report", href);
      }
    }
    YAHOO.util.Event.onDOMReady(function() {
      initDirtyFieldTracking();
    });
    // -->
    </script>
<script type="text/javascript" src="js/util.js"></script><script type="text/javascript" src="js/field.js"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla" href="./search_plugin.cgi">
    <link rel="shortcut icon" href="images/favicon.ico" >
  </head>



  <body onload=""
        class="bugs-exim-org bz_bug bz_status_RESOLVED bz_product_PCRE bz_component_Code bz_bug_1791 yui-skin-sam">



<div id="header">
<div id="banner">
  </div>

<table border="0" cellspacing="0" cellpadding="0" id="titles">
<tr>
    <td id="title">
      <p>Bugzilla &ndash; Bug&nbsp;1791</p>
    </td>

    <td id="subtitle">
      <p class="subheader">ZDI-CAN-3542: New Vulnerability Report</p>
    </td>

    <td id="information">
      <p class="header_addl_info">Last modified: 2016-04-15 16:44:52 UTC</p>
    </td>
</tr>
</table>

<table id="lang_links_container" cellpadding="0" cellspacing="0"
       class="bz_default_hidden"><tr><td>
</td></tr></table>
<ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi">New</a></li>
  <li><span class="separator">| </span><a href="describecomponents.cgi">Browse</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_top" name="no_redirect" value="0">
    <script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_top");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_top" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_top"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li></li>

  <li>
        <span class="separator">| </span>
        <a href="docs/html/bug_page.html" target="_blank">Help</a>
      </li>
    
      <li id="new_account_container_top">
        <span class="separator">| </span>
        <a href="createaccount.cgi">New&nbsp;Account</a>
      </li>

    <li id="mini_login_container_top">
  <span class="separator">| </span>
  <a id="login_link_top" href="show_bug.cgi?id=1791&amp;GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('_top')">Log In</a>

  
  <form action="show_bug.cgi?id=1791" method="POST" 
        class="mini_login bz_default_hidden"
        id="mini_login_top"
        onsubmit="return check_mini_login_fields( '_top' );"
  >
    <input id="Bugzilla_login_top" 
           class="bz_login"
           name="Bugzilla_login"
           title="Login"
           onfocus="mini_login_on_focus('_top')"
    >
    <input class="bz_password" 
           id="Bugzilla_password_top" 
           name="Bugzilla_password"
           type="password"
           title="Password"
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text" 
           id="Bugzilla_password_dummy_top" value="password"
           title="Password"
           onfocus="mini_login_on_focus('_top')"
    >
      <input type="checkbox" id="Bugzilla_remember_top" 
             name="Bugzilla_remember" value="on" class="bz_remember"
                 checked>
      <label for="Bugzilla_remember_top">Remember</label>
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
            id="log_in_top">
    <script type="text/javascript">
      mini_login_constants = {
          "login" : "login",
          "warning" : "You must set the login and password before logging in."
      };
      
      if (YAHOO.env.ua.gecko || YAHOO.env.ua.ie || YAHOO.env.ua.opera) {
          YAHOO.util.Event.onDOMReady(function() {
              init_mini_login_form('_top');
          });
      }
      else {
          YAHOO.util.Event.on(window, 'load', function () {
              window.setTimeout(function() {
                  init_mini_login_form('_top');
              }, 200);
          });
    }
    </script>
    <a href="#" onclick="return hide_mini_login_form('_top')">[x]</a>
  </form>
</li>
<li id="forgot_container_top">
  <span class="separator">| </span>
  <a id="forgot_link_top" href="show_bug.cgi?id=1791&amp;GoAheadAndLogIn=1#forgot"
     onclick="return show_forgot_form('_top')">Forgot Password</a>
  <form action="token.cgi" method="post" id="forgot_form_top"
        class="mini_forgot bz_default_hidden">
    <label for="login_top">Login:</label>
    <input type="text" name="loginname" size="20" id="login_top">
    <input id="forgot_button_top" value="Reset Password" 
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <input type="hidden" id="token_top" name="token" value="1635619105-gqN9MYDnQOTDY_lKDisYbJQg12h_WWeo9UMqlozvFlk">
    <a href="#" onclick="return hide_forgot_form('_top')">[x]</a>
  </form>
</li>
</ul>
</div> 

<div id="bugzilla-body">

<div class="navigation">
  
  <i><font color="#777777">First</font></i>
  <i><font color="#777777">Last</font></i>
  <i><font color="#777777">Prev</font></i>
  <i><font color="#777777">Next</font></i>
  &nbsp;&nbsp;
  <i><font color="#777777">This bug is not in your last
    search results.</font></i>
</div>
<script type="text/javascript">
<!--

//-->
</script>

<form name="changeform" id="changeform" method="post" action="process_bug.cgi">

  <input type="hidden" name="delta_ts" value="2016-04-15 16:44:52">
  <input type="hidden" name="longdesclength" value="6">
  <input type="hidden" name="id" value="1791">
  <input type="hidden" name="token" value="1635619105-RPCk2HqnGUQTeYKn7BYqlfVTpRD8UwHbjjR7VEY3C3o">
<div class="bz_alias_short_desc_container edit_form">
     <a href="show_bug.cgi?id=1791"><b>Bug&nbsp;1791</b></a> -<span id="summary_alias_container" class="bz_default_hidden"> 
      <span id="short_desc_nonedit_display">ZDI-CAN-3542: New Vulnerability Report</span>
     </span>
  
       
    <div id="summary_alias_input">
      <table id="summary"> 
        <tr>
            <td colspan="2">
          </td>
        </tr>
        
        <tr><th class="field_label "
    id="field_label_short_desc">

    <label for="short_desc" accesskey="s">

  <a 
      title="The bug summary is a short sentence which succinctly describes what the bug is about."
      class="field_help_link"
      href="page.cgi?id=fields.html#short_desc"
  >Summary:</a>
</label>
</th>
          <td>ZDI-CAN-3542: New Vulnerability Report
          </td>
        </tr>
      </table>
    </div>
  </div>
  <script type="text/javascript">
    hideAliasAndSummary('ZDI-CAN-3542: New Vulnerability Report', '');
  </script>
  <table class="edit_form">
    <tr>
      
      <td id="bz_show_bug_column_1" class="bz_show_bug_column">     
        <table>
          <tr>
    <th class="field_label">
      <a href="page.cgi?id=fields.html#bug_status">Status</a>:
    </th>
    <td id="bz_field_status">
      <span id="static_bug_status">RESOLVED
          FIXED
      </span>
    </td>
  </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr><th class="field_label "
    id="field_label_product">


  <a 
      title="Bugs are categorised into Products and Components."
      class="field_help_link"
      href="describecomponents.cgi"
  >Product:</a>

</th>
  <td class="field_value "
      id="field_container_product" >PCRE</td>
    </tr>

    
    <tr class="bz_default_hidden"><th class="field_label "
    id="field_label_classification">


  <a 
      title="Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation."
      class="field_help_link"
      href="page.cgi?id=fields.html#classification"
  >Classification:</a>

</th>
  <td class="field_value "
      id="field_container_classification" >Unclassified</td>
    </tr>
        
    
    
    <tr><th class="field_label "
    id="field_label_component">


  <a 
      title="Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list."
      class="field_help_link"
      href="describecomponents.cgi?product=PCRE"
  >Component:</a>

</th>
  <td class="field_value "
      id="field_container_component" >Code</td>
    </tr>
    <tr><th class="field_label "
    id="field_label_version">

    <label for="version">

  <a 
      title="The version field defines the version of the software the bug was found in."
      class="field_help_link"
      href="page.cgi?id=fields.html#version"
  >Version:</a>
</label>
</th>
        <td>N/A
  </td>
    </tr>
        
    
        
    <tr><th class="field_label "
    id="field_label_rep_platform">

    <label for="rep_platform" accesskey="h">

  <a 
      title="The hardware platform the bug was observed on. Note: When searching, selecting the option &quot;All&quot; only finds bugs whose value for this field is literally the word &quot;All&quot;."
      class="field_help_link"
      href="page.cgi?id=fields.html#rep_platform"
  >Hardware:</a>
</label>
</th>
      <td class="field_value">x86
       Windows
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          
          <tr>
      <th class="field_label">
        <label for="priority" accesskey="i">
          <a href="page.cgi?id=fields.html#importance"><u>I</u>mportance</a></label>:
      </th>
      <td>medium
       bug
      </td>
    </tr>

      <tr>
        <th class="field_label">
          <label for="target_milestone">
            <a href="page.cgi?id=fields.html#target_milestone">
            Target&nbsp;Milestone</a></label>:
        </th><td>---
  </td>
      </tr>            
          
          <tr>
      <th class="field_label">
        <a href="page.cgi?id=fields.html#assigned_to">Assigned To</a>:
      </th>
      <td><span class="vcard"><span class="fn">Philip Hazel</span>
</span>
      </td>
    </tr>

    <tr><th class="field_label "
    id="field_label_qa_contact">

    <label for="qa_contact" accesskey="q">

  <a 
      title="The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#qa_contact"
  >QA Contact:</a>
</label>
</th>
      <td><span class="vcard">
</span>
      </td>
    </tr>
    <script type="text/javascript">
      assignToDefaultOnChange(['product', 'component'],
        'Philip.Hazel\x40gmail.com',
        '');
    </script>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr><th class="field_label "
    id="field_label_bug_file_loc">

    <label for="bug_file_loc" accesskey="u">

  <a 
      title="Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen."
      class="field_help_link"
      href="page.cgi?id=fields.html#bug_file_loc"
  >URL:</a>
</label>
</th>
    <td>
      <span id="bz_url_input_area">
      </span>
    </td>
  </tr>
  
  
    <tr>
      <th class="field_label">
        <label for="keywords" accesskey="k">
          <a href="describekeywords.cgi"><u>K</u>eywords</a></label>:
      </th>
      <td class="field_value" colspan="2">
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>

          
<tr><th class="field_label "
    id="field_label_dependson">


  <a 
      title="The bugs listed here must be resolved before this bug can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#dependson"
  >Depends on:</a>

</th>

  <td>
    <span id="dependson_input_area">
    </span>
    
  </td>
  </tr>
  
  <tr><th class="field_label "
    id="field_label_blocked">


  <a 
      title="This bug must be resolved before the bugs listed in this field can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#blocked"
  >Blocks:</a>

</th>

  <td>
    <span id="blocked_input_area">
    </span>
    
  </td>
  </tr>
  
  <tr>
    <th>&nbsp;</th>
  
    <td colspan="2" align="left" id="show_dependency_tree_or_graph">
      Show dependency <a href="showdependencytree.cgi?id=1791&amp;hide_resolved=1">tree</a>
  
        /&nbsp;<a href="showdependencygraph.cgi?id=1791">graph</a>
    </td>
  </tr>
          
        </table>
      </td>
      <td>
        <div class="bz_column_spacer">&nbsp;</div>
      </td>
      
      <td id="bz_show_bug_column_2" class="bz_show_bug_column">
        <table cellpadding="3" cellspacing="1">
        <tr>
    <th class="field_label">
      Reported:
    </th>
    <td>2016-02-09 22:08 UTC by <span class="vcard"><span class="fn">Shannon</span>
</span>
    </td>
  </tr>
  
  <tr>
    <th class="field_label">
      Modified:
    </th>
    <td>2016-04-15 16:44 UTC 
      (<a href="show_activity.cgi?id=1791">History</a>)
    </td>
  
  </tr>
         <tr>
      <th class="field_label">
        <label for="newcc" accesskey="a">CC List:</label>
      </th>
      <td>4 
          users
          <span id="cc_edit_area_showhide_container" class="bz_default_hidden">
            (<a href="#" id="cc_edit_area_showhide">show</a>)
          </span>
        <div id="cc_edit_area">
          <br>
            <select id="cc" multiple="multiple" size="5">
                <option value="hzmester">hzmester</option>
                <option value="kvmanoj">kvmanoj</option>
                <option value="Lokesh.Ubuntu">Lokesh.Ubuntu</option>
                <option value="pcre-dev">pcre-dev</option>
            </select>
        </div>
          <script type="text/javascript">
            hideEditableField( 'cc_edit_area_showhide_container', 
                               'cc_edit_area', 
                               'cc_edit_area_showhide', 
                               '', 
                               '');  
          </script>
      </td>
    </tr>
         <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_see_also">


  <a 
      title="This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields."
      class="field_help_link"
      href="page.cgi?id=fields.html#see_also"
  >See Also:</a>

</th>
  <td class="field_value "
      id="field_container_see_also" ></td>
    </tr> 
         
         <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
         
                

        </table>
      </td>
    </tr>
    <tr>
      <td colspan="3">
          <hr id="bz_top_half_spacer">
      </td>
    </tr>
  </table>

  <table id="bz_big_form_parts" cellspacing="0" cellpadding="0"><tr>
  <td>

    
<script type="text/javascript">
<!--
function toggle_display(link) {
    var table = document.getElementById("attachment_table");
    var view_all = document.getElementById("view_all");
    var hide_obsolete_url_parameter = "&hide_obsolete=1";
    // Store current height for scrolling later
    var originalHeight = table.offsetHeight;
    var rows = YAHOO.util.Dom.getElementsByClassName(
        'bz_tr_obsolete', 'tr', table);

    for (var i = 0; i < rows.length; i++) {
        bz_toggleClass(rows[i], 'bz_default_hidden');
    }

    if (YAHOO.util.Dom.hasClass(rows[0], 'bz_default_hidden')) {
        link.innerHTML = "Show Obsolete";
        view_all.href = view_all.href + hide_obsolete_url_parameter 
    }
    else {
        link.innerHTML = "Hide Obsolete";
        view_all.href = view_all.href.replace(hide_obsolete_url_parameter,"");
    }

    var newHeight = table.offsetHeight;
    // This scrolling makes the window appear to not move at all.
    window.scrollBy(0, newHeight - originalHeight);

    return false;
}
//-->
</script>

<br>
<table id="attachment_table" cellspacing="0" cellpadding="4">
  <tr id="a0">
    <th colspan="2" align="left">
      Attachments
    </th>
  </tr>


      <tr id="a1" class="bz_contenttype_application_x-zip-compressed">
        <td valign="top">
            <a href="attachment.cgi?id=865"
               title="View the content of the attachment">
          <b>poc</b></a>

          <span class="bz_attach_extra_info">
              (473 bytes,
                application/x-zip-compressed)

            <br>
            <a href="#attach_865"
               title="Go to the comment associated with the attachment">2016-02-09 22:08 UTC</a>,

            <span class="vcard"><span class="fn">Shannon</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=865&amp;action=edit">Details</a>
        </td>
      </tr>

  <tr class="bz_attach_footer">
    <td colspan="2">
        <span class="bz_attach_view_hide">
        </span>
        <a href="attachment.cgi?bugid=1791&amp;action=enter">Add an attachment</a>
        (proposed patch, testcase, etc.)
    </td>
  </tr>
</table>
<br>
<div id="add_comment" class="bz_section_additional_comments">
      <table>
        <tr>
          <td>
            <fieldset>
              <legend>Note</legend>
              You need to
              <a href="show_bug.cgi?id=1791&amp;GoAheadAndLogIn=1">log in</a>
              before you can comment on or make changes to this bug.
            </fieldset>
          </td>
        </tr> 
      </table>
  </div>
  </td>
  <td>
  </td>
  </tr></table>

  
  <div id="comments"><script src="js/comments.js" type="text/javascript">
</script>

<script type="text/javascript">
<!--
  /* Adds the reply text to the `comment' textarea */
  function replyToComment(id, real_id, name) {
      var prefix = "(In reply to " + name + " from comment #" + id + ")\n";
      var replytext = "";
        /* pre id="comment_name_N" */
        var text_elem = document.getElementById('comment_text_'+id);
        var text = getText(text_elem);
        replytext = prefix + wrapReplyText(text);


      /* <textarea id="comment"> */
      var textarea = document.getElementById('comment');
      if (textarea.value != replytext) {
          textarea.value += replytext;
      }

      textarea.focus();
  } 
//-->
</script>




<!-- This auto-sizes the comments and positions the collapse/expand links 
     to the right. -->
<table class="bz_comment_table" cellpadding="0" cellspacing="0"><tr>
<td>
<div id="c0" class="bz_comment bz_first_comment">

      <div class="bz_first_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1791#c0">Description</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Shannon</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2016-02-09 22:08:35 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Created <span class=""><a href="attachment.cgi?id=865" name="attach_865" title="poc">attachment 865</a> <a href="attachment.cgi?id=865&amp;action=edit" title="poc">[details]</a></span>
poc

ZDI-CAN-3542: PCRE Regular Expression Compilation Stack Buffer Overflow Remote Code Execution Vulnerability


-- CVSS -----------------------------------------

5.1, AV:N/AC:H/Au:N/C:P/I:P/A:P


-- ABSTRACT -------------------------------------

HP's Zero Day Initiative has identified a vulnerability affecting the following products:

  PCRE PCRE


-- VULNERABILITY DETAILS ------------------------

Tested on Linux.

PCRE does not validate that handling the (*ACCEPT) verb will occur within the bounds of the cworkspace stack buffer, leading to a stack buffer overflow.

```
$ php-5.6.17/sapi/cli/php test_case.php
================================================================
==97723==ERROR: AddressSanitizer: stack-buffer-overflow on address 0x7ffd1d0fb050 at pc 0x4ff262 bp 0x7ffd1d0b3dd0 sp 0x7ffd1d0b3dc0
WRITE of size 1 at 0x7ffd1d0fb050 thread T0
    #0 0x4ff261 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x4ff261)
    #1 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #2 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #3 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #4 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #5 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #6 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #7 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #8 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #9 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #10 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #11 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #12 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #13 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #14 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #15 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #16 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #17 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #18 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #19 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #20 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #21 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #22 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #23 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #24 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #25 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #26 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #27 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #28 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #29 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #30 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #31 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #32 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #33 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #34 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #35 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #36 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #37 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #38 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #39 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #40 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #41 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #42 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #43 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #44 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #45 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #46 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #47 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #48 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #49 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #50 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #51 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #52 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #53 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #54 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #55 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #56 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #57 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #58 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #59 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #60 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #61 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #62 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #63 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #64 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #65 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #66 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #67 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #68 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #69 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #70 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #71 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #72 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #73 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #74 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #75 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #76 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #77 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #78 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #79 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #80 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #81 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #82 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #83 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #84 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #85 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #86 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #87 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #88 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #89 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #90 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #91 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #92 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #93 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #94 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #95 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #96 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #97 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #98 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #99 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #100 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #101 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #102 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #103 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #104 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #105 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #106 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #107 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #108 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #109 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #110 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #111 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #112 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #113 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #114 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #115 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #116 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #117 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #118 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #119 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #120 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #121 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #122 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #123 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #124 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #125 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #126 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #127 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #128 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #129 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #130 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #131 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #132 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #133 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #134 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #135 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #136 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #137 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #138 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #139 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #140 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #141 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #142 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #143 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #144 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #145 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #146 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #147 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #148 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #149 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #150 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #151 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #152 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #153 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #154 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #155 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #156 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #157 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #158 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #159 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #160 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #161 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #162 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #163 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #164 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #165 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #166 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #167 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #168 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #169 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #170 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #171 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #172 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #173 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #174 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #175 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #176 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #177 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #178 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #179 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #180 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #181 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #182 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #183 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #184 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #185 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #186 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #187 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #188 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #189 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #190 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #191 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #192 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #193 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #194 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #195 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #196 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #197 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #198 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #199 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #200 0x5051f1 in compile_branch (/home/zdi/php-5.6.17/sapi/cli/php+0x5051f1)
    #201 0x5077e9 in compile_regex (/home/zdi/php-5.6.17/sapi/cli/php+0x5077e9)
    #202 0x50bb5c in php_pcre_compile2 (/home/zdi/php-5.6.17/sapi/cli/php+0x50bb5c)
    #203 0x50a143 in php_pcre_compile (/home/zdi/php-5.6.17/sapi/cli/php+0x50a143)
    #204 0x5c1dd8 in pcre_get_compiled_regex_cache (/home/zdi/php-5.6.17/sapi/cli/php+0x5c1dd8)
    #205 0x5c2bd0 in php_do_pcre_match (/home/zdi/php-5.6.17/sapi/cli/php+0x5c2bd0)
    #206 0x5c53c3 in zif_preg_match (/home/zdi/php-5.6.17/sapi/cli/php+0x5c53c3)
    #207 0xee5bd0 in zend_do_fcall_common_helper_SPEC (/home/zdi/php-5.6.17/sapi/cli/php+0xee5bd0)
    #208 0xeff289 in ZEND_DO_FCALL_SPEC_CONST_HANDLER (/home/zdi/php-5.6.17/sapi/cli/php+0xeff289)
    #209 0xee10b8 in execute_ex (/home/zdi/php-5.6.17/sapi/cli/php+0xee10b8)
    #210 0xee2a60 in zend_execute (/home/zdi/php-5.6.17/sapi/cli/php+0xee2a60)
    #211 0xe1606d in zend_execute_scripts (/home/zdi/php-5.6.17/sapi/cli/php+0xe1606d)
    #212 0xc9e2d8 in php_execute_script (/home/zdi/php-5.6.17/sapi/cli/php+0xc9e2d8)
    #213 0x118e8f2 in do_cli (/home/zdi/php-5.6.17/sapi/cli/php+0x118e8f2)
    #214 0x1191572 in main (/home/zdi/php-5.6.17/sapi/cli/php+0x1191572)
    #215 0x7f46a9719a3f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x20a3f)
    #216 0x421318 in _start (/home/zdi/php-5.6.17/sapi/cli/php+0x421318)

Address 0x7ffd1d0fb050 is located in stack of thread T0 at offset 5216 in frame
    #0 0x50a155 in php_pcre_compile2 (/home/zdi/php-5.6.17/sapi/cli/php+0x50a155)

  This frame has 11 object(s):
    [32, 36) 'length'
    [96, 100) 'firstcharflags'
    [160, 164) 'reqcharflags'
    [224, 228) 'firstchar'
    [288, 292) 'reqchar'
    [352, 356) 'errorcode'
    [416, 424) 'code'
    [480, 488) 'ptr'
    [544, 736) 'compile_block'
    [768, 1088) 'named_groups'
    [1120, 5216) 'cworkspace' &lt;== Memory access at offset 5216 overflows this variable
HINT: this may be a false positive if your program uses some custom stack unwind mechanism or swapcontext
      (longjmp and C++ exceptions *are* supported)
SUMMARY: AddressSanitizer: stack-buffer-overflow ??:0 compile_branch
Shadow bytes around the buggy address:
  0x100023a175b0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x100023a175c0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x100023a175d0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x100023a175e0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x100023a175f0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
=&gt;0x100023a17600: 00 00 00 00 00 00 00 00 00 00[f3]f3 f3 f3 00 00
  0x100023a17610: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x100023a17620: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 f1 f1
  0x100023a17630: f1 f1 01 f4 f4 f4 f2 f2 f2 f2 04 f4 f4 f4 f2 f2
  0x100023a17640: f2 f2 04 f4 f4 f4 f2 f2 f2 f2 04 f4 f4 f4 f2 f2
  0x100023a17650: f2 f2 00 f4 f4 f4 f2 f2 f2 f2 00 f4 f4 f4 f2 f2
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07
  Heap left redzone:       fa
  Heap right redzone:      fb
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack partial redzone:   f4
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Contiguous container OOB:fc
  ASan internal:           fe
==97723==ABORTING
```

Also hits on PHP 7.0.2 as well as PCRE 8.38 and PCRE2 10.21

-- CREDIT ---------------------------------------

This vulnerability was discovered by:

   Wei Lei Peng Haoxiang and Liu Yang of Nanyang Technological University working with HP's Zero Day Initiative

-- FURTHER DETAILS ------------------------------

If supporting files were contained with this report they are provided within a password protected ZIP file. The password is the ZDI candidate number in the form: ZDI-CAN-XXXX where XXXX is the ID number.

Please confirm receipt of this report. We expect all vendors to remediate ZDI vulnerabilities within 120 days of the reported date. If you are ready to release a patch at any point leading up the the deadline please coordinate with us so that we may release our advisory detailing the issue. If the 120 day deadline is reached and no patch has been made available we will release a limited public advisory with our own mitigations so that the public can protect themselves in the absence of a patch. Please keep us updated regarding the status of this issue and feel free to contact us at any time:

Zero Day Initiative
<a href="mailto:zdi-disclosures&#64;hpe.com">zdi-disclosures&#64;hpe.com</a>

The PGP key used for all ZDI vendor communications is available from:

     <a href="http://www.zerodayinitiative.com/documents/disclosures-pgp-key.asc">http://www.zerodayinitiative.com/documents/disclosures-pgp-key.asc</a>

-- INFORMATION ABOUT THE ZDI ---------------------

Established by TippingPoint and acquired by Hewlett-Packard, The Zero Day Initiative (ZDI) represents a best-of-breed model for rewarding security researchers for responsibly disclosing discovered vulnerabilities.

The ZDI is unique in how the acquired vulnerability information is used. The ZDI does not re-sell the vulnerability details or any exploit code. Instead, upon notifying the affected product vendor, the ZDI provides its HP TippingPoint customers with zero day protection through its intrusion prevention technology. Explicit details regarding the specifics of the vulnerability are not exposed to any parties until an official vendor patch is publicly available.

    <a href="http://www.zerodayinitiative.com">http://www.zerodayinitiative.com</a>

-- DISCLOSURE POLICY ----------------------------

Our vulnerability disclosure policy is available online at:

    <a href="http://www.zerodayinitiative.com/advisories/disclosure_policy/">http://www.zerodayinitiative.com/advisories/disclosure_policy/</a></pre>
    </div><div id="c1" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1791#c1">Comment 1</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Philip Hazel</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2016-02-10 19:15:20 UTC
        </span>
      </div>



<pre class="bz_comment_text" >This turned out to be a simple bug to fix. I have fixed it in both PCRE1 and PCRE2, and committed the patches to the repository.</pre>
    </div><div id="c2" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1791#c2">Comment 2</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Manoj</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2016-03-28 14:09:04 UTC
        </span>
      </div>



<pre class="bz_comment_text" >Hi Philip,

   Is this bugfix available in the source code which can be downloaded ?

   I don't see any modifications to PCRE source code after Jan-12-2016 from below link.

     <a href="https://sourceforge.net/projects/pcre/files/">https://sourceforge.net/projects/pcre/files/</a>

Thanks,
Manoj</pre>
    </div><div id="c3" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1791#c3">Comment 3</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Zoltan Herczeg</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2016-03-28 16:09:40 UTC
        </span>
      </div>



<pre class="bz_comment_text" ><span class="quote">&gt;    I don't see any modifications to PCRE source code after Jan-12-2016 from
&gt; below link.</span >

That is probably a mirror. I haven't even heard about it.

The official source code is available here:

svn://vcs.exim.org/pcre/code/trunk
svn://vcs.exim.org/pcre2/code/trunk</pre>
    </div><div id="c4" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1791#c4">Comment 4</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Lokesh</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2016-04-15 15:52:43 UTC
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to Philip Hazel from <a href="show_bug.cgi?id=1791#c1">comment #1</a>)
<span class="quote">&gt; This turned out to be a simple bug to fix. I have fixed it in both PCRE1 and
&gt; PCRE2, and committed the patches to the repository.</span >

Is it possible having fix view, if so look point?</pre>
    </div><div id="c5" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=1791#c5">Comment 5</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Philip Hazel</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2016-04-15 16:44:52 UTC
        </span>
      </div>



<pre class="bz_comment_text" >The current code for PCRE1 and PCRE2 can be check out like this:

svn co svn://vcs.exim.org/pcre/code/trunk pcre
or
svn co svn://vcs.exim.org/pcre2/code/trunk pcre2</pre>
    </div>


  

</td>
<td>
</td>
</tr></table>
  </div>
        

</form>

<hr>
<ul class="related_actions">
    <li><a href="show_bug.cgi?format=multiple&amp;id=1791">Format For Printing</a></li>
    <li>&nbsp;-&nbsp;<a href="show_bug.cgi?ctype=xml&amp;id=1791">XML</a></li>
    <li>&nbsp;-&nbsp;<a href="enter_bug.cgi?cloned_bug_id=1791">Clone This Bug</a></li>
    
    <li>&nbsp;-&nbsp;<a href="#">Top of page </a></li>
    </ul>        


<div class="navigation">
  
  <i><font color="#777777">First</font></i>
  <i><font color="#777777">Last</font></i>
  <i><font color="#777777">Prev</font></i>
  <i><font color="#777777">Next</font></i>
  &nbsp;&nbsp;
  <i><font color="#777777">This bug is not in your last
    search results.</font></i>
</div>

<br>
</div>



<div id="footer">
  <div class="intro"></div>




<ul id="useful-links">
  <li id="links-actions"><ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi">New</a></li>
  <li><span class="separator">| </span><a href="describecomponents.cgi">Browse</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_bottom" name="no_redirect" value="0">
    <script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_bottom");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_bottom" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_bottom"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li></li>

  <li>
        <span class="separator">| </span>
        <a href="docs/html/bug_page.html" target="_blank">Help</a>
      </li>
    
      <li id="new_account_container_bottom">
        <span class="separator">| </span>
        <a href="createaccount.cgi">New&nbsp;Account</a>
      </li>

    <li id="mini_login_container_bottom">
  <span class="separator">| </span>
  <a id="login_link_bottom" href="show_bug.cgi?id=1791&amp;GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('_bottom')">Log In</a>

  
  <form action="show_bug.cgi?id=1791" method="POST" 
        class="mini_login bz_default_hidden"
        id="mini_login_bottom"
        onsubmit="return check_mini_login_fields( '_bottom' );"
  >
    <input id="Bugzilla_login_bottom" 
           class="bz_login"
           name="Bugzilla_login"
           title="Login"
           onfocus="mini_login_on_focus('_bottom')"
    >
    <input class="bz_password" 
           id="Bugzilla_password_bottom" 
           name="Bugzilla_password"
           type="password"
           title="Password"
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text" 
           id="Bugzilla_password_dummy_bottom" value="password"
           title="Password"
           onfocus="mini_login_on_focus('_bottom')"
    >
      <input type="checkbox" id="Bugzilla_remember_bottom" 
             name="Bugzilla_remember" value="on" class="bz_remember"
                 checked>
      <label for="Bugzilla_remember_bottom">Remember</label>
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
            id="log_in_bottom">
    <script type="text/javascript">
      mini_login_constants = {
          "login" : "login",
          "warning" : "You must set the login and password before logging in."
      };
      
      if (YAHOO.env.ua.gecko || YAHOO.env.ua.ie || YAHOO.env.ua.opera) {
          YAHOO.util.Event.onDOMReady(function() {
              init_mini_login_form('_bottom');
          });
      }
      else {
          YAHOO.util.Event.on(window, 'load', function () {
              window.setTimeout(function() {
                  init_mini_login_form('_bottom');
              }, 200);
          });
    }
    </script>
    <a href="#" onclick="return hide_mini_login_form('_bottom')">[x]</a>
  </form>
</li>
<li id="forgot_container_bottom">
  <span class="separator">| </span>
  <a id="forgot_link_bottom" href="show_bug.cgi?id=1791&amp;GoAheadAndLogIn=1#forgot"
     onclick="return show_forgot_form('_bottom')">Forgot Password</a>
  <form action="token.cgi" method="post" id="forgot_form_bottom"
        class="mini_forgot bz_default_hidden">
    <label for="login_bottom">Login:</label>
    <input type="text" name="loginname" size="20" id="login_bottom">
    <input id="forgot_button_bottom" value="Reset Password" 
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <input type="hidden" id="token_bottom" name="token" value="1635619105-gqN9MYDnQOTDY_lKDisYbJQg12h_WWeo9UMqlozvFlk">
    <a href="#" onclick="return hide_forgot_form('_bottom')">[x]</a>
  </form>
</li>
</ul>
  </li>

  
    


  
</ul>

  <div class="outro"></div>
</div>


</body>
</html>