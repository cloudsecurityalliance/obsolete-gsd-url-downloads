<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="UTF-8">
<meta property="og:type" content="website">
<meta property="og:title" content="1138554 - (CVE-2015-4000) NSS accepts export-length DHE keys with regular DHE cipher suites (&quot;Logjam&quot;)">
<meta property="og:url" content="https://bugzilla.mozilla.org/show_bug.cgi?id=1138554">
<meta property="og:description"
      content="RESOLVED (mt) in NSS - Libraries. Last updated 2015-08-27.">
<meta name="twitter:label1" value="Type">
<meta name="twitter:data1" value="defect">
<meta name="twitter:label2" value="Priority">
<meta name="twitter:data2" value="--">

    <meta name="viewport" content="width=1024">
    <meta name="color-scheme" content="dark light">
    <meta name="generator" content="Bugzilla 20211025.1">
    <meta name="bugzilla-global" content="dummy"
        id="bugzilla-global" data-bugzilla="{&quot;api_token&quot;:&quot;&quot;,&quot;config&quot;:{&quot;basepath&quot;:&quot;\/&quot;},&quot;constant&quot;:{&quot;COMMENT_COLS&quot;:80},&quot;param&quot;:{&quot;maxattachmentsize&quot;:&quot;10240&quot;,&quot;maxusermatches&quot;:&quot;50&quot;,&quot;splinter_base&quot;:&quot;\/page.cgi?id=splinter.html&amp;ignore=\/&quot;},&quot;string&quot;:{&quot;bug_type_required&quot;:&quot;You must select a Type for this bug&quot;,&quot;component_required&quot;:&quot;You must select a Component for this bug&quot;,&quot;description_required&quot;:&quot;You must enter a Description for this bug&quot;,&quot;short_desc_required&quot;:&quot;You must enter a Summary for this bug&quot;,&quot;version_required&quot;:&quot;You must select a Version for this bug&quot;},&quot;user&quot;:{&quot;is_new&quot;:1,&quot;login&quot;:&quot;&quot;}}">
    <title>1138554 - (CVE-2015-4000) NSS accepts export-length DHE keys with regular DHE cipher suites (&quot;Logjam&quot;)</title>

<link rel="Top" href="/">

  


  
    <link rel="Show" title="Dependency Tree"
          href="/showdependencytree.cgi?id=1138554&amp;hide_resolved=1">
      <link rel="Show" title="Dependency Graph"
            href="/showdependencygraph.cgi?id=1138554">

      <link rel="Show" title="Bug Activity"
            href="/show_activity.cgi?id=1138554">

<link href="/static/v20211025.1/skins/yui.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/standard/global.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BugModal/web/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BMO/web/styles/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/EditComments/web/styles/inline-editor.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-structure-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-theme-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/lib/prism.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Needinfo/web/styles/needinfo.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Review/web/styles/badge.css" rel="stylesheet" type="text/css">



    
<script nonce="CSTOu9QXNtgNT60wHPiJdTzY3qaDrtnRObLsKzI1lrew9sGP" src="/static/v20211025.1/js/jquery/jquery-min.js"></script><script nonce="CSTOu9QXNtgNT60wHPiJdTzY3qaDrtnRObLsKzI1lrew9sGP" src="/static/v20211025.1/js/jquery/ui/jquery-ui-min.js"></script><script nonce="CSTOu9QXNtgNT60wHPiJdTzY3qaDrtnRObLsKzI1lrew9sGP" src="/static/v20211025.1/js/yui.js"></script><script nonce="CSTOu9QXNtgNT60wHPiJdTzY3qaDrtnRObLsKzI1lrew9sGP" src="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu-min.js"></script><script nonce="CSTOu9QXNtgNT60wHPiJdTzY3qaDrtnRObLsKzI1lrew9sGP" src="/static/v20211025.1/js/jquery/plugins/devbridgeAutocomplete/devbridgeAutocomplete-min.js"></script><script nonce="CSTOu9QXNtgNT60wHPiJdTzY3qaDrtnRObLsKzI1lrew9sGP" src="/static/v20211025.1/js/global.js"></script><script nonce="CSTOu9QXNtgNT60wHPiJdTzY3qaDrtnRObLsKzI1lrew9sGP" src="/static/v20211025.1/js/util.js"></script><script nonce="CSTOu9QXNtgNT60wHPiJdTzY3qaDrtnRObLsKzI1lrew9sGP" src="/static/v20211025.1/js/dropdown.js"></script>

      <script nonce="CSTOu9QXNtgNT60wHPiJdTzY3qaDrtnRObLsKzI1lrew9sGP">
          YAHOO.namespace('bugzilla');
          if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
              YAHOO.util.Event._simpleRemove(window, "unload",
                                             YAHOO.util.Event._unload);
          }BUGZILLA.value_descs = JSON.parse('{\"bug_status\":{},\"resolution\":{\"\":\"---\"}}');

  
    var tracking_flags_str = "{\"flags\":{\"project\":{\"cf_fission_milestone\":\"---\",\"cf_root_cause\":\"---\",\"cf_tracking_firefox_sumo\":\"---\"},\"tracking\":{\"cf_status_b2g_2_0\":\"fixed\",\"cf_status_firefox_esr38\":\"verified\",\"cf_tracking_firefox_relnote\":\"39+\",\"cf_status_firefox93\":\"---\",\"cf_status_firefox41\":\"verified\",\"cf_status_firefox94\":\"---\",\"cf_status_b2g_2_0m\":\"fixed\",\"cf_tracking_firefox93\":\"---\",\"cf_status_firefox_esr31\":\"verified\",\"cf_tracking_firefox_esr78\":\"---\",\"cf_status_firefox40\":\"verified\",\"cf_tracking_firefox94\":\"---\",\"cf_status_firefox_esr78\":\"---\",\"cf_tracking_firefox_esr38\":\"39+\",\"cf_status_b2g_2_2\":\"fixed\",\"cf_status_firefox38_0_5\":\"wontfix\",\"cf_tracking_firefox_esr91\":\"---\",\"cf_status_firefox95\":\"---\",\"cf_tracking_firefox_esr31\":\"39+\",\"cf_status_firefox_esr91\":\"---\",\"cf_status_firefox38\":\"wontfix\",\"cf_status_b2g_2_1_s\":\"fixed\",\"cf_tracking_firefox95\":\"---\",\"cf_status_b2g_2_1\":\"fixed\",\"cf_status_b2g_master\":\"fixed\",\"cf_status_firefox39\":\"verified\"}},\"comments\":{\"cf_tracking_firefox95\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr78\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr91\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox93\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr31\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr38\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_sumo\":{\"none-needed\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox_relnote\":{\"?\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox94\":{\"?\":\"[Tracking Requested - why for this release]:\"}},\"types\":[\"tracking\"]}";
    var TrackingFlags = $.parseJSON(tracking_flags_str);

  

  
  BUGZILLA.bug_id = 1138554;
  BUGZILLA.bug_title = '1138554 - (CVE-2015-4000) NSS accepts export-length DHE keys with regular DHE cipher suites (\"Logjam\")';
  BUGZILLA.bug_summary = 'NSS accepts export-length DHE keys with regular DHE cipher suites (\"Logjam\")';
  BUGZILLA.bug_url = 'https:\/\/bugzilla.mozilla.org\/show_bug.cgi?id=1138554';
  BUGZILLA.bug_keywords = 'dev-doc-needed, sec-moderate, site-compat',
  BUGZILLA.user = {
    id: 0,
    login: '',
    is_insider: false,
    is_timetracker: false,
    can_tag: false,
    timezone: 'America\/Los_Angeles',
    settings: {
      quote_replies: 'quoted_reply',
      zoom_textareas: true,
      remember_collapsed: true,
      inline_attachments: true,
      autosize_comments: false
    }
  };

  BUGZILLA.bug_secure = false;
      </script>
<script nonce="CSTOu9QXNtgNT60wHPiJdTzY3qaDrtnRObLsKzI1lrew9sGP" src="/static/v20211025.1/extensions/BugModal/web/autosize.min.js"></script><script nonce="CSTOu9QXNtgNT60wHPiJdTzY3qaDrtnRObLsKzI1lrew9sGP" src="/static/v20211025.1/extensions/ProdCompSearch/web/js/prod_comp_search.js"></script><script nonce="CSTOu9QXNtgNT60wHPiJdTzY3qaDrtnRObLsKzI1lrew9sGP" src="/static/v20211025.1/extensions/BugModal/web/bug_modal.js"></script><script nonce="CSTOu9QXNtgNT60wHPiJdTzY3qaDrtnRObLsKzI1lrew9sGP" src="/static/v20211025.1/extensions/BugModal/web/comments.js"></script><script nonce="CSTOu9QXNtgNT60wHPiJdTzY3qaDrtnRObLsKzI1lrew9sGP" src="/static/v20211025.1/extensions/ComponentWatching/web/js/overlay.js"></script><script nonce="CSTOu9QXNtgNT60wHPiJdTzY3qaDrtnRObLsKzI1lrew9sGP" src="/static/v20211025.1/js/bugzilla-readable-status-min.js"></script><script nonce="CSTOu9QXNtgNT60wHPiJdTzY3qaDrtnRObLsKzI1lrew9sGP" src="/static/v20211025.1/js/field.js"></script><script nonce="CSTOu9QXNtgNT60wHPiJdTzY3qaDrtnRObLsKzI1lrew9sGP" src="/static/v20211025.1/js/comments.js"></script><script nonce="CSTOu9QXNtgNT60wHPiJdTzY3qaDrtnRObLsKzI1lrew9sGP" src="/static/v20211025.1/extensions/TrackingFlags/web/js/flags.js"></script><script nonce="CSTOu9QXNtgNT60wHPiJdTzY3qaDrtnRObLsKzI1lrew9sGP" src="/static/v20211025.1/extensions/BMO/web/js/firefox-crash-table.js"></script><script nonce="CSTOu9QXNtgNT60wHPiJdTzY3qaDrtnRObLsKzI1lrew9sGP" src="/static/v20211025.1/extensions/MozChangeField/web/js/severity-s1-priority-p1.js"></script><script nonce="CSTOu9QXNtgNT60wHPiJdTzY3qaDrtnRObLsKzI1lrew9sGP" src="/static/v20211025.1/extensions/MozChangeField/web/js/clear-tracking-priority-s1.js"></script><script nonce="CSTOu9QXNtgNT60wHPiJdTzY3qaDrtnRObLsKzI1lrew9sGP" src="/static/v20211025.1/extensions/MozChangeField/web/js/set-tracking-severity-s1.js"></script><script nonce="CSTOu9QXNtgNT60wHPiJdTzY3qaDrtnRObLsKzI1lrew9sGP" src="/static/v20211025.1/js/lib/prism.js"></script><script nonce="CSTOu9QXNtgNT60wHPiJdTzY3qaDrtnRObLsKzI1lrew9sGP" src="/static/v20211025.1/extensions/GoogleAnalytics/web/js/analytics.js"></script><script nonce="CSTOu9QXNtgNT60wHPiJdTzY3qaDrtnRObLsKzI1lrew9sGP" src="/static/v20211025.1/js/lib/md5.min.js"></script><script nonce="CSTOu9QXNtgNT60wHPiJdTzY3qaDrtnRObLsKzI1lrew9sGP" src="/static/v20211025.1/extensions/Review/web/js/badge.js"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla@Mozilla" href="/search_plugin.cgi"><link rel="shortcut icon" href="/extensions/BMO/web/images/favicon.ico">
<link rel="canonical" href="https://bugzilla.mozilla.org/show_bug.cgi?id=1138554">
<link rel="shorturl" href="https://bugzilla.mozilla.org/1138554"><meta name="google-analytics" content="UA-36116321-3" data-location="https://bugzilla.mozilla.org/bug/show-modal" data-title="1138554 - (CVE-2015-4000) NSS accepts export-length DHE keys with regular DHE cipher suites (&amp;quot;Logjam&amp;quot;)">
<script async src="https://www.google-analytics.com/analytics.js"></script><meta name="robots" content="noarchive">
  </head>



  <body
        class="bugzilla-mozilla-org
               skin-standard bug_modal yui-skin-sam">



<div id="wrapper">

<header id="header" role="banner">
  <div class="inner">
    <h1 id="header-title" class="title"><a href="https://bugzilla.mozilla.org/home" title="Go to home page">Bugzilla</a></h1>
    <form role="search" id="header-search" class="quicksearch" action="/buglist.cgi" data-no-csrf>
      <section class="searchbox-outer dropdown" role="combobox" aria-expanded="false" aria-haspopup="listbox"
               aria-labelledby="header-search-label" aria-owns="header-search-dropdown">
        <h2 id="header-search-label">Quick Search</h2>
        <span class="icon" aria-hidden="true"></span>
        <input role="searchbox" id="quicksearch_top" class="dropdown-button" name="quicksearch" autocomplete="off"
               value="" placeholder="Search Bugs"
               title="Enter a bug number or some search terms" aria-controls="header-search-dropdown"
               aria-label="Quick Search"><div id="header-search-dropdown" class="dropdown-content right" role="listbox" style="display: none;">
  <div id="header-search-dropdown-wrapper">
  </div>
</div>
      </section>
    </form>
    <nav id="header-nav">
      <ul class="links">
        <li class="link-browse">
          <a href="/describecomponents.cgi" title="Browse bugs by component">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Browse</span>
          </a>
        </li>
        <li class="link-search">
          <a href="/query.cgi?format=advanced" title="Search bugs using various criteria">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Advanced Search</span>
          </a>
        </li>
      </ul>
      <div class="dropdown">
        <button type="button" id="header-tools-menu-button" class="dropdown-button minor" title="More tools…"
                aria-label="More tools…" aria-expanded="false" aria-haspopup="true" aria-controls="header-tools-menu">
          <span class="icon" aria-hidden="true"></span>
        </button>
        <ul class="dropdown-content left" id="header-tools-menu" role="menu" style="display:none;">
          <li role="presentation">
            <a href="/report.cgi" role="menuitem" tabindex="-1">Reports</a>
          </li>
            <li role="separator"></li>
            <li role="presentation">
              <a href="https://bmo.readthedocs.io/en/latest/" role="menuitem" tabindex="-1">Documentation</a>
            </li>
        </ul>
      </div>
    </nav>
      <ul id="header-login" class="links">
          <li id="moz_new_account_container_top"><a href="/createaccount.cgi">New Account</a></li><li id="mini_login_container_top">
  <a id="login_link_top" href="/index.cgi?GoAheadAndLogIn=1"
     class='show_mini_login_form' data-qs-suffix="_top">Log In</a>

  <div id="mini_login_top" class="mini-popup mini_login bz_default_hidden"><span id="github_mini_login_top" class="mini_login_top">
    <form method="post" action="/github.cgi">
      <input type="hidden" name="github_secret" value="JQhcXYl3c22XXfJwTA5z5mdV0YaHaW0JEwKVoI98X1umXEDXcm34uXR3ZO1flVJ1quwJiCzxXQ6JmzlUqtlJvgh8dq5Q61LcLyrPfG6is72dPbE6yOxT8dFXxGtJKzq440xXBhfFaHSZcTGKMtoaBdssYogxMshduNtG1g5ArX35RQXwlfWFs4zQWNoz4wUj80ocpDwjk7FCGUrE778c1flfngjQkp2D2uwxRQlTjl4zM9uVfIeh9NPIcukaA2YN">
      <input type="hidden" name="target_uri" value="https://bugzilla.mozilla.org/show_bug.cgi">
      <input type="image" src="/extensions/GitHubAuth/web/images/sign_in.png" height="22" width="75" align="absmiddle"
             alt="Sign in with GitHub"
             title="Sign in with GitHub"> or
    </form>
  </span>

  <form action="/show_bug.cgi?id=1138554" method="POST"
        data-qs-suffix="_top">

    <input id="Bugzilla_login_top"
           class="bz_login"
           name="Bugzilla_login"
           title="Login"
           placeholder="Email"
           aria-label="Email"
           type="email"
           required
    >
    <input class="bz_password"
           id="Bugzilla_password_top"
           name="Bugzilla_password"
           type="password"
           title="Password"
           placeholder="Password"
           aria-label="Password"
           required
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text"
           id="Bugzilla_password_dummy_top" value="password"
           title="Password"
    >
      <input type="checkbox" id="Bugzilla_remember_top"
             name="Bugzilla_remember" value="on" class="bz_remember"
                 checked>
      <label for="Bugzilla_remember_top">Remember</label>
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
           class="check_mini_login_fields"
            id="log_in_top">
    <a href="#" id="hide_mini_login_top" aria-label="Close"
       class="close-button hide_mini_login_form" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
<li id="forgot_container_top">
  <a id="forgot_link_top" href="/index.cgi?GoAheadAndLogIn=1#forgot"
     class='show_forgot_form'
     data-qs-suffix="_top">Forgot Password</a>
  <div id="forgot_form_top" class="mini-popup mini_forgot bz_default_hidden">
  <form action="/token.cgi" method="post">
    <input type="email" name="loginname" size="20" placeholder="Email" aria-label="Email" required>
    <input id="forgot_button_top" value="Reset Password"
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <input type="hidden" id="token_top" name="token" value="1635622603-yjN5JpJSy1VONK3zRM9ImALteT0rfVuEl13cqp4q7C8">
    <a href="#" class="close-button hide_forgot_form" aria-label="Close" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
      </ul><div id="header-external-links" class="dropdown first">
  <button type="button" id="header-external-menu-button" class="dropdown-button minor" title="Mozilla"
          aria-label="Mozilla" aria-expanded="false" aria-haspopup="true" aria-controls="header-external-menu">
    <img src="/static/v20211025.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg" width="32" height="32" alt="">
  </button>
  <ul class="dropdown-content right" id="header-external-menu" role="menu" style="display:none;">
    <li role="presentation">
      <a href="https://www.mozilla.org/" role="menuitem" tabindex="-1">Mozilla Home</a>
    </li>
    <li role="separator"></li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/" role="menuitem" tabindex="-1">Privacy</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/#cookies" role="menuitem" tabindex="-1">Cookies</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/about/legal/" role="menuitem" tabindex="-1">Legal</a>
    </li>
  </ul>
</div>
  </div>
</header> 


<main id="bugzilla-body" tabindex="-1">

<aside id="message-container" role="complementary">
  <noscript>
    <div class="noscript">
      <div class="inner">
        <p>Please enable JavaScript in your browser to use all the features on this site.</p>
      </div>
    </div>
  </noscript>
</aside>

<div id="main-inner">




<div role="toolbar" id="page-toolbar">
  <div role="group" class="buttons">
    <button type="button" id="copy-summary" class="secondary"
      title="Copy bug number and summary to your clipboard">Copy Summary</button>
    <div id="clip-container" style="display:none"><input type="text" id="clip"></div>
    <div class="dropdown">
      <button type="button" id="action-menu-btn" aria-haspopup="true" aria-label="View"
        aria-expanded="false" aria-controls="action-menu" class="dropdown-button secondary">View &#9662;</button>
      <ul class="dropdown-content left" id="action-menu" role="menu" style="display:none;">
        <li role="presentation">
          <a id="action-reset" role="menuitem" tabindex="-1">Reset Sections</a>
        </li>
        <li role="presentation">
          <a id="action-expand-all" role="menuitem" tabindex="-1">Expand All Sections</a>
        </li>
        <li role="presentation">
          <a id="action-collapse-all" role="menuitem" tabindex="-1">Collapse All Sections</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a id="action-history" role="menuitem" tabindex="-1">History</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a href="/rest/bug/1138554" role="menuitem" tabindex="-1">JSON</a>
        </li>
        <li role="presentation">
          <a href="/show_bug.cgi?ctype=xml&amp;id=1138554" role="menuitem" tabindex="-1">XML</a>
        </li>
      </ul>
    </div>
  </div>
</div>



<div role="status" id="io-error" style="display:none"></div>
<div role="status" id="floating-message" style="display:none">
  <div id="floating-message-text"></div>
</div>
<section class="module"
>
  <div class="module-content"
  >
  <div id="summary-container">
    <div class="field indent" id="field-status_summary"
>


  
    <div class=" container">
        <span id="field-value-status_summary">
      <span class="bug-status-label text" data-status="closed">Closed</span>
      <span id="field-value-bug_id">
        <a href="/show_bug.cgi?id=1138554">Bug 1138554</a>
          <span class="edit-hide">(CVE-2015-4000)</span>
      </span>
      <span>
        <span class="bug-time-label">Opened <span class="rel-time" title="2015-03-02 10:11 PST" data-time="1425319895">7 years ago</span></span>
          <span class="bug-time-label">Closed <span class="rel-time" title="2015-05-20 17:13 PDT" data-time="1432167198">7 years ago</span></span>
      </span>
        </span>
    </div>

  
</div>
<div class="field indent edit-hide"
>


  
    <div class=" container">
      

      <h1 id="field-value-short_desc">NSS accepts export-length DHE keys with regular DHE cipher suites (&quot;Logjam&quot;)</h1>
    </div>

  
</div>

    <div class="field edit-show" id="field-short_desc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc" id="short_desc-help-link" class="help">Summary:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-short_desc">
            NSS accepts export-length DHE keys with regular DHE cipher suites (&quot;Logjam&quot;)

        </span>
    </div>

  
</div>
  </div>
  </div>
</section>


<section class="module" id="module-categories"
>
    <header id="module-categories-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Categories section"
           data-label-collapsed="Expand Categories section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-categories-content"
             aria-expanded="true"
             aria-labeledby="module-categories-title"
             aria-describedby="module-categories-subtitle"></div>
        <h2 class="module-title" id="module-categories-title">Categories</h2>
          <h3 class="module-subtitle" id="module-categories-subtitle">
            (NSS :: Libraries, defect)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-categories-content"
  ><div class="fields-lhs">

    <div class="field" id="field-product"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=NSS" id="product-help-link" class="help">Product:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-product">
      <div class="name-info-outer dropdown">
        <span id="product-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="product-info">NSS
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="product-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Product description and actions">
          <header>
            <div class="title">NSS</div>
            <div class="description">Network Security Services - a cross-platform
security library (<a href="http://www.mozilla.org/projects/security/pki/nss/">more info</a>)</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=NSS&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Product</a></div>
            <div><a href="/enter_bug.cgi?product=NSS"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Product</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="NSS"
                         data-label-watch="Watch This Product" data-label-unwatch="Unwatch This Product"
                         data-source="BugModal">Watch This Product</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-component"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=NSS&component=Libraries#Libraries" id="component-help-link" class="help">Component:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-component">
      <div class="name-info-outer dropdown">
        <span id="component-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="component-info">Libraries
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="component-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Component description and actions">
          <header>
            <div class="title">NSS :: Libraries</div>
            <div class="description">Libraries for client support of SSL v2 and v3, TLS, PKCS #5,
PKCS #7, PKCS #11, PKCS #12, S/MIME, X.509 v3 certificates,
and other security standards</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=NSS&amp;component=Libraries&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Component</a></div>
            <div><a href="/buglist.cgi?product=NSS&amp;component=Libraries&amp;chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__"
                    target="_blank" role="menuitem" tabindex="-1">Recently Fixed Bugs in This Component</a></div>
            <div><a href="/enter_bug.cgi?product=NSS&amp;component=Libraries"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Component</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="NSS" data-component="Libraries"
                         data-label-watch="Watch This Component" data-label-unwatch="Unwatch This Component"
                         data-source="BugModal">Watch This Component</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-version" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#version" id="version-help-link" class="help">Version:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-version">
            trunk

        </span>
    </div>

  
</div>

    <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform" id="-help-link" class="help">Platform:
        </a>
    </div>


  
    <div class=" container"><div class="field inline" id="field-rep_platform"
>


  
    <div class="value">
        <span id="field-value-rep_platform">
            All

        </span>
    </div>

  
</div><div class="field indent inline" id="field-op_sys"
>


  
    <div class="value">
        <span id="field-value-op_sys">
            All

        </span>
    </div>

  
</div><div class="field indent inline"
>


  
    <div class=" container">
    </div>

  
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field contains-buttons" id="field-bug_type"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type" id="bug_type-help-link" class="help">Type:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_type">
      <span class="bug-type-label iconic-text" data-type="defect">
        <span class="icon" aria-hidden="true"></span>defect</span>
        </span>
    </div>

  
</div>

    <div class="field" id="field-importance"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority" id="importance-help-link" class="help">Priority:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-importance"><div class="field inline" id="field-priority"
>


  
    <div class="value">
        <span id="field-value-priority">
          <em>Not set</em>
        </span>
    </div>

  
</div><div class="field inline" id="field-bug_severity"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity" id="bug_severity-help-link" class="help">Severity:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_severity">
            normal

        </span>
    </div>

  
</div>
        </span>
    </div>

  
</div>

    
</div>
  </div>
</section>


<section class="module" id="module-tracking"
>
    <header id="module-tracking-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Tracking section"
           data-label-collapsed="Expand Tracking section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-tracking-content"
             aria-expanded="true"
             aria-labeledby="module-tracking-title"
             aria-describedby="module-tracking-subtitle"></div>
        <h2 class="module-title" id="module-tracking-title">Tracking</h2>
          <h3 class="module-subtitle" id="module-tracking-subtitle">
            (firefox38 wontfix, firefox38.0.5 wontfix, firefox39 verified, firefox40 verified, firefox41 verified, firefox-esr3139+ verified, firefox-esr3839+ verified, b2g-v2.0 fixed, b2g-v2.0M fixed, b2g-v2.1 fixed, b2g-v2.1S fixed, b2g-v2.2 fixed, b2g-master fixed, relnote-firefox 39+)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-tracking-content"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-status-view"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-view-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-view">RESOLVED
        FIXED
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-status-edit" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-edit-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-edit"><div class="field inline" id="field-bug_status"
>


  
    <div class="value">
        <span id="field-value-bug_status">
            RESOLVED

        </span>
    </div>

  
</div><div class="field indent inline" id="field-resolution"
>


  
    <div class="value">
        <span id="field-value-resolution">
            FIXED

        </span>
    </div>

  
</div>
  <div id="status-action-buttons">
      <div id="assigned-container" style="display:none">
        <button type="button" class="secondary" id="mark-as-assigned-btn">
          Mark as Assigned
        </button>
      </div>
  </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-target_milestone"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone" id="target_milestone-help-link" class="help">Milestone:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-target_milestone">
            3.19.1

        </span>
    </div>

  
</div>

    


      <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Project Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <td class="tracking-flag-name">Root Cause</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_root_cause-dirty">
  <select id="cf_root_cause" name="cf_root_cause">
        <option value="---"
          id="v4701_cf_root_cause" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">user-doc-firefox</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_sumo-dirty">
  <select id="cf_tracking_firefox_sumo" name="cf_tracking_firefox_sumo">
        <option value="---"
          id="v4660_cf_tracking_firefox_sumo" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Fission Milestone</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_fission_milestone-dirty">
  <select id="cf_fission_milestone" name="cf_fission_milestone">
        <option value="---"
          id="v4222_cf_fission_milestone" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

      <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Tracking Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-hide">
    <table class="layout-table tracking-flags">
        <tr>
          <th></th>
          <th>Tracking</th>
          <th>Status</th>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox38</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox38&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox38.0.5</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox38_0_5&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox39</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox39&amp;o1=equals&amp;v1=verified">verified</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox40</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox40&amp;o1=equals&amp;v1=verified">verified</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox41</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox41&amp;o1=equals&amp;v1=verified">verified</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox-esr31</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox_esr31&amp;o1=equals&amp;v1=39%2B">39+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox_esr31&amp;o1=equals&amp;v1=verified">verified</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox-esr38</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox_esr38&amp;o1=equals&amp;v1=39%2B">39+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox_esr38&amp;o1=equals&amp;v1=verified">verified</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">b2g-v2.0</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_b2g_2_0&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">b2g-v2.0M</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_b2g_2_0m&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">b2g-v2.1</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_b2g_2_1&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">b2g-v2.1S</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_b2g_2_1_s&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">b2g-v2.2</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_b2g_2_2&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">b2g-master</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_b2g_master&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">relnote-firefox</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_tracking_firefox_relnote&amp;o1=equals&amp;v1=39%2B">39+</a>
          </td>
        </tr>
    </table>
  </div>


<div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <th></th>
        <th>Tracking</th>
        <th>Status</th>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox38</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox38-dirty">
  <select id="cf_status_firefox38" name="cf_status_firefox38">
        <option value="wontfix"
          id="v2093_cf_status_firefox38" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox38.0.5</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox38_0_5-dirty">
  <select id="cf_status_firefox38_0_5" name="cf_status_firefox38_0_5">
        <option value="wontfix"
          id="v2242_cf_status_firefox38_0_5" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox39</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox39-dirty">
  <select id="cf_status_firefox39" name="cf_status_firefox39">
        <option value="verified"
          id="v2165_cf_status_firefox39" selected
        >verified
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox40</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox40-dirty">
  <select id="cf_status_firefox40" name="cf_status_firefox40">
        <option value="verified"
          id="v2202_cf_status_firefox40" selected
        >verified
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox41</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox41-dirty">
  <select id="cf_status_firefox41" name="cf_status_firefox41">
        <option value="verified"
          id="v2261_cf_status_firefox41" selected
        >verified
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr31</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr31-dirty">
  <select id="cf_tracking_firefox_esr31" name="cf_tracking_firefox_esr31">
        <option value="39+"
          id="v1761_cf_tracking_firefox_esr31" selected
        >39+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr31-dirty">
  <select id="cf_status_firefox_esr31" name="cf_status_firefox_esr31">
        <option value="verified"
          id="v1767_cf_status_firefox_esr31" selected
        >verified
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr38</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr38-dirty">
  <select id="cf_tracking_firefox_esr38" name="cf_tracking_firefox_esr38">
        <option value="39+"
          id="v2144_cf_tracking_firefox_esr38" selected
        >39+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr38-dirty">
  <select id="cf_status_firefox_esr38" name="cf_status_firefox_esr38">
        <option value="verified"
          id="v2150_cf_status_firefox_esr38" selected
        >verified
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">b2g-v2.0</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_b2g_2_0-dirty">
  <select id="cf_status_b2g_2_0" name="cf_status_b2g_2_0">
        <option value="fixed"
          id="v1603_cf_status_b2g_2_0" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">b2g-v2.0M</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_b2g_2_0m-dirty">
  <select id="cf_status_b2g_2_0m" name="cf_status_b2g_2_0m">
        <option value="fixed"
          id="v1914_cf_status_b2g_2_0m" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">b2g-v2.1</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_b2g_2_1-dirty">
  <select id="cf_status_b2g_2_1" name="cf_status_b2g_2_1">
        <option value="fixed"
          id="v1737_cf_status_b2g_2_1" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">b2g-v2.1S</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_b2g_2_1_s-dirty">
  <select id="cf_status_b2g_2_1_s" name="cf_status_b2g_2_1_s">
        <option value="fixed"
          id="v2121_cf_status_b2g_2_1_s" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">b2g-v2.2</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_b2g_2_2-dirty">
  <select id="cf_status_b2g_2_2" name="cf_status_b2g_2_2">
        <option value="fixed"
          id="v1878_cf_status_b2g_2_2" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">b2g-master</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_b2g_master-dirty">
  <select id="cf_status_b2g_master" name="cf_status_b2g_master">
        <option value="fixed"
          id="v2078_cf_status_b2g_master" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">relnote-firefox</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_relnote-dirty">
  <select id="cf_tracking_firefox_relnote" name="cf_tracking_firefox_relnote">
        <option value="39+"
          id="v2180_cf_tracking_firefox_relnote" selected
        >39+
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr78-dirty">
  <select id="cf_tracking_firefox_esr78" name="cf_tracking_firefox_esr78">
        <option value="---"
          id="v4808_cf_tracking_firefox_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr78-dirty">
  <select id="cf_status_firefox_esr78" name="cf_status_firefox_esr78">
        <option value="---"
          id="v4813_cf_status_firefox_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr91-dirty">
  <select id="cf_tracking_firefox_esr91" name="cf_tracking_firefox_esr91">
        <option value="---"
          id="v5194_cf_tracking_firefox_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr91-dirty">
  <select id="cf_status_firefox_esr91" name="cf_status_firefox_esr91">
        <option value="---"
          id="v5199_cf_status_firefox_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox93</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox93-dirty">
  <select id="cf_tracking_firefox93" name="cf_tracking_firefox93">
        <option value="---"
          id="v5266_cf_tracking_firefox93" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox93-dirty">
  <select id="cf_status_firefox93" name="cf_status_firefox93">
        <option value="---"
          id="v5271_cf_status_firefox93" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox94</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox94-dirty">
  <select id="cf_tracking_firefox94" name="cf_tracking_firefox94">
        <option value="---"
          id="v5284_cf_tracking_firefox94" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox94-dirty">
  <select id="cf_status_firefox94" name="cf_status_firefox94">
        <option value="---"
          id="v5289_cf_status_firefox94" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox95</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox95-dirty">
  <select id="cf_tracking_firefox95" name="cf_tracking_firefox95">
        <option value="---"
          id="v5311_cf_tracking_firefox95" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox95-dirty">
  <select id="cf_status_firefox95" name="cf_status_firefox95">
        <option value="---"
          id="v5316_cf_status_firefox95" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>

</div>
  </div>
</section>



<section class="module" id="module-people"
>
    <header id="module-people-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse People section"
           data-label-collapsed="Expand People section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-people-content"
             aria-expanded="false"
             aria-labeledby="module-people-title"
             aria-describedby="module-people-subtitle"></div>
        <h2 class="module-title" id="module-people-title">People</h2>
          <h3 class="module-subtitle" id="module-people-subtitle">
            (Reporter: ekr, Assigned: mt)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-people-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-assigned_to"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to"><div class="vcard vcard_438654" ><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=438654" > <span class="fna">mt</span></a>
</div>
        </span>
    </div>

  
</div><div class="field edit-show" id="field-assigned_to" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-assignee" name="set_default_assignee" class="set-default"
          value="1" data-for="assigned_to">
        <label for="set-default-assignee">Reset Assignee to default</label>
      </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-bug_mentors" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor" id="bug_mentors-help-link" class="help">Mentors:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_mentors">---
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-qa_contact" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact" id="qa_contact-help-link" class="help">QA Contact:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-qa_contact">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-qa-contact" name="set_default_qa_contact" class="set-default"
          value="1" data-for="qa_contact">
        <label for="set-default-qa-contact">Reset QA Contact to default</label>
      </div>
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-reporter"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter" id="reporter-help-link" class="help">Reporter:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-reporter">
            <div class="vcard vcard_35667" ><img src="https://secure.gravatar.com/avatar/f3b5a842a3ef240e7ba5b3efab681531?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=35667" > <span class="fna">ekr</span></a>
</div>

        </span>
    </div>

  
</div>

    <div class="field" id="field-triage_owner"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner" id="triage_owner-help-link" class="help">Triage Owner:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-triage_owner">
            <div class="vcard vcard_622637" ><img src="https://secure.gravatar.com/avatar/38f561698d679a724938d4600c0f8b52?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=622637" > <span class="fna">beurdouche</span></a>
</div>

        </span>
    </div>

  
</div>

    

    <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc" id="-help-link" class="help">CC:
        </a>
    </div>


  
    <div class=" container">


        <span aria-owns="cc-summary cc-latch">
          <span role="button" tabindex="0" id="cc-summary" data-count="44">44 people
          </span>
        </span>


        <div id="cc-list" style="display:none"></div>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-references"
>
    <header id="module-references-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse References section"
           data-label-collapsed="Expand References section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-references-content"
             aria-expanded="false"
             aria-labeledby="module-references-title"
             aria-describedby="module-references-subtitle"></div>
        <h2 class="module-title" id="module-references-title">References</h2>
          <h3 class="module-subtitle" id="module-references-subtitle">
            (Depends on 1 open bug)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-references-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field bug-list" id="field-dependson"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson" id="dependson-help-link" class="help">Depends on:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-dependson">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - home.nest.com breaks with Firefox 39 or higher"
   href="/show_bug.cgi?id=1170833">1170833</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED WONTFIX - Thunderbird 38.1.0+38.0.1: SMTP+IMAP with STARTTLS: no remaining auth method"
   href="/show_bug.cgi?id=1184488">1184488</a>
      </div>
      <div class="bug-list">
        <span class="bug-type-label iconic" title="enhancement"
              aria-label="enhancement" data-type="enhancement">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_NEW"
   title="NEW - Thunderbird UI should report rejected SSL/TLS connections"
   href="/show_bug.cgi?id=1187797">1187797</a>
      </div>

        </span>
    </div>

  
</div><div class="field bug-list" id="field-blocked"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks" id="blocked-help-link" class="help">Blocks:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-blocked">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Update to NSS 3.19.1"
   href="/show_bug.cgi?id=1166031">1166031</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED WONTFIX - After upgrade to v38.1.0 cannot get emails (using self-signed SSL certificates with 512bit keys ) because of Logjam/weak Diffie-Hellman key mitigation"
   href="/show_bug.cgi?id=1185060">1185060</a>
      </div>

        </span>
    </div>

  
</div><div class="field" id="field-dependencytree"
>
    <div class="name">
    </div>


  
    <div class=" container">
        <span id="field-value-dependencytree">
        Dependency <a href="/showdependencytree.cgi?id=1138554&amp;hide_resolved=1">tree</a>
        / <a href="/showdependencygraph.cgi?id=1138554">graph</a>
        </span>
    </div>

  
</div>

    <div class="field bug-list edit-show" id="field-regresses" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses" id="regresses-help-link" class="help">Regressions:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regresses">
        ---
        </span>
    </div>

  
</div><div class="field bug-list edit-show" id="field-regressed_by" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by" id="regressed_by-help-link" class="help">Regressed by:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regressed_by">
        ---
        </span>
    </div>

  
</div>

    <div class="field bug-list"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates" id="-help-link" class="help">Duplicates:
        </a>
    </div>


  
    <div class="value">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE - Minimum Diffie-Hellman (DH) group size"
   href="/show_bug.cgi?id=1166690">1166690</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE - This is about Logjam vulnerability on Firefox"
   href="/show_bug.cgi?id=1167165">1167165</a>
      </div>

    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field edit-show" id="field-bug_file_loc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc" id="bug_file_loc-help-link" class="help">URL:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_file_loc"><div class="link">
    <a href="" target="_blank"
      rel="noreferrer" title=""
      class="bug-url" data-safe="0"></a>
  </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-see_also"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also" id="see_also-help-link" class="help">See Also:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-see_also">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS incorrectly permits skipping of ServerKeyExchange"
   href="/show_bug.cgi?id=1086145">CVE-2015-2721</a>
      </div>

        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-details"
>
    <header id="module-details-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Details section"
           data-label-collapsed="Expand Details section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-details-content"
             aria-expanded="false"
             aria-labeledby="module-details-title"
             aria-describedby="module-details-subtitle"></div>
        <h2 class="module-title" id="module-details-title">Details</h2>
          <h3 class="module-subtitle" id="module-details-subtitle">
            (Keywords: dev-doc-needed, sec-moderate, site-compat, Whiteboard: [adv-main39+][adv-esr38.1+][adv-esr31.8+] Embargo until multi-vendor coordinated info release (May 19))
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-details-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-show" id="field-alias" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias" id="alias-help-link" class="help">Alias:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-alias">
            CVE-2015-4000

        </span>
    </div>

  
</div>

    <div class="field" id="field-keywords"
>
    <div class="name">
        <a href="/describekeywords.cgi" id="keywords-help-link" class="help">Keywords:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-keywords">
          <a href="/buglist.cgi?keywords=dev-doc-needed&amp;resolution=---">dev-doc-needed</a>, 
          <a href="/buglist.cgi?keywords=sec-moderate&amp;resolution=---">sec-moderate</a>, 
          <a href="/buglist.cgi?keywords=site-compat&amp;resolution=---">site-compat</a>
        </span>
    </div>

  
</div>

    <div class="field" id="field-status_whiteboard"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/Whiteboard" id="status_whiteboard-help-link" class="help">Whiteboard:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-status_whiteboard">[adv-main39+][adv-esr38.1+][adv-esr31.8+] Embargo until multi-vendor coordinated info release (May 19)
        </span>
    </div>

  
</div>

    

    <div class="field edit-show" id="field-cf_has_regression_range" style="display:none"
>
    <div class="name">Has Regression Range:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_regression_range">
            ---

        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_has_str" style="display:none"
>
    <div class="name">Has STR:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_str">
            ---

        </span>
    </div>

  
</div>

    <div class="field" id="field-votes"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes" id="votes-help-link" class="help">Votes:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-votes">3
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field edit-show" id="field-bug_flags" style="display:none"
>
    <div class="name">Bug Flags:
    </div>


  
    <div class=" container">
        <span id="field-value-bug_flags"><div id="bug-flags" class="flags">
  <table class="layout-table">
    <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?" for="flag_type-930">behind-pref</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-930-dirty">
      <select id="flag_type-930" name="flag_type-930"
        title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?"
        class="bug-flag">
          <option value="X"></option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug." for="flag_type-803">sec-bounty</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-803-dirty">
      <select id="flag_type-803" name="flag_type-803"
        title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame." for="flag_type-913">sec-bounty-hof</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-913-dirty">
      <select id="flag_type-913" name="flag_type-913"
        title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-787">in-qa-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-787-dirty">
      <select id="flag_type-787" name="flag_type-787"
        title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>

      <td class="flag-requestee">
        <div id="requestee_type-787-container" style="display:none"><input
    name="requestee_type-787"
    value="" class="requestee bz_autocomplete_user"  id="requestee_type-787" 
  >
        </div>
      <td>

  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-37">in-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-37-dirty">
      <select id="flag_type-37" name="flag_type-37"
        title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually" for="flag_type-864">qe-verify</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-864-dirty">
      <select id="flag_type-864" name="flag_type-864"
        title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually"
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr>
    </tbody>
  </table>
</div>
        </span>
    </div>

  
</div>
</div>

  
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-crash-data"
>
    <header id="module-crash-data-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Crash Data section"
           data-label-collapsed="Expand Crash Data section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-crash-data-content"
             aria-expanded="false"
             aria-labeledby="module-crash-data-title"
             aria-describedby="module-crash-data-subtitle"></div>
        <h2 class="module-title" id="module-crash-data-title">Crash Data</h2>
      </div>
    </header>
  <div class="module-content" id="module-crash-data-content" style="display:none"
  ><div class="field edit-show" id="field-cf_crash_signature" style="display:none"
>
    <div class="name">Signature:
    </div>


  
    <div class="value">
        <span id="field-value-cf_crash_signature">
        </span>
    </div>

  
</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-security"
>
    <header id="module-security-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Security section"
           data-label-collapsed="Expand Security section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-security-content"
             aria-expanded="false"
             aria-labeledby="module-security-title"
             aria-describedby="module-security-subtitle"></div>
        <h2 class="module-title" id="module-security-title">Security</h2>
          <h3 class="module-subtitle" id="module-security-subtitle">
            (public)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-security-content" style="display:none"
  ><div class="groups edit-hide">
    This bug is publicly visible.
</div>

<div class="groups edit-show" style="display:none">


</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-user-story" data-non-stick="1"
>
    <header id="module-user-story-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse User Story section"
           data-label-collapsed="Expand User Story section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-user-story-content"
             aria-expanded="false"
             aria-labeledby="module-user-story-title"
             aria-describedby="module-user-story-subtitle"></div>
        <h2 class="module-title" id="module-user-story-title">User Story</h2>
      </div>
    </header>
  <div class="module-content" id="module-user-story-content" style="display:none"
  >
    <pre id="user-story"></pre>
  </div>
</section>







<section class="module" id="module-attachments"
>
    <header id="module-attachments-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Attachments section"
           data-label-collapsed="Expand Attachments section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-attachments-content"
             aria-expanded="true"
             aria-labeledby="module-attachments-title"
             aria-describedby="module-attachments-subtitle"></div>
        <h2 class="module-title" id="module-attachments-title">Attachments</h2>
          <h3 class="module-subtitle" id="module-attachments-subtitle">
            (1 file, 10 obsolete files)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-attachments-content"
  ><table role="table" class="layout-table" id="attachments">
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8580961">bug1138554.patch</a>
        </div>
        <div>
            <a href="#c24" class="attach-time activity-ref"><span class="rel-time" title="2015-03-20 15:56 PDT" data-time="1426892178">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_438654" ><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div></span>
        </div>
        <div class="attach-info">1.06 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_1584" ><span class="fn">wtc</span>
</div>:
              <a href="#c25"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1426892178"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8580961&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8580961&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1138554&attachment=8580961">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8581044">bug1138554.patch</a>
        </div>
        <div>
            <a href="#c28" class="attach-time activity-ref"><span class="rel-time" title="2015-03-20 21:32 PDT" data-time="1426912377">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_438654" ><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div></span>
        </div>
        <div class="attach-info">9.99 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_1584" ><span class="fn">wtc</span>
</div>:
              <a href="#c32"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1426912377"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8581044&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8581044&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1138554&attachment=8581044">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8588235">bug1138554-1.patch</a>
        </div>
        <div>
            <a href="#c34" class="attach-time activity-ref"><span class="rel-time" title="2015-04-03 17:11 PDT" data-time="1428106300">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_438654" ><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div></span>
        </div>
        <div class="attach-info">13.36 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_438654" ><span class="fn">mt</span>
</div>:
              <a href="#c34"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1428106300"
            >
              review+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_1584" ><span class="fn">wtc</span>
</div>:
              <a href="#c37"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1428347049"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8588235&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8588235&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1138554&attachment=8588235">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8588236">bug1138554-2.patch</a>
        </div>
        <div>
            <a href="#c35" class="attach-time activity-ref"><span class="rel-time" title="2015-04-03 17:12 PDT" data-time="1428106331">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_438654" ><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div></span>
        </div>
        <div class="attach-info">2.79 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8588236&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8588236&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1138554&attachment=8588236">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8588644">bug1138554-2.patch</a>
        </div>
        <div>
            <a href="#c36" class="attach-time activity-ref"><span class="rel-time" title="2015-04-06 10:18 PDT" data-time="1428340695">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_438654" ><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div></span>
        </div>
        <div class="attach-info">2.96 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8588644&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8588644&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1138554&attachment=8588644">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8589276">bug1138554.patch</a>
        </div>
        <div>
            <a href="#c43" class="attach-time activity-ref"><span class="rel-time" title="2015-04-07 13:25 PDT" data-time="1428438317">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_438654" ><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div></span>
        </div>
        <div class="attach-info">15.99 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8589276&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8589276&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1138554&attachment=8589276">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8589277">interdiff.txt</a>
        </div>
        <div>
            <a href="#c44" class="attach-time activity-ref"><span class="rel-time" title="2015-04-07 13:25 PDT" data-time="1428438340">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_438654" ><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div></span>
        </div>
        <div class="attach-info">4.31 KB,
          text/plain        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8589277&amp;action=edit">Details</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8607648">bug1138554.patch</a>
        </div>
        <div>
            <a href="#c54" class="attach-time activity-ref"><span class="rel-time" title="2015-05-19 10:46 PDT" data-time="1432057568">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_438654" ><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div></span>
        </div>
        <div class="attach-info">15.13 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8607648&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8607648&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1138554&attachment=8607648">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8607687">bug1138554.patch</a>
        </div>
        <div>
            <a href="#c56" class="attach-time activity-ref"><span class="rel-time" title="2015-05-19 11:28 PDT" data-time="1432060133">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_438654" ><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div></span>
        </div>
        <div class="attach-info">575.12 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8607687&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8607687&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1138554&attachment=8607687">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8608187">bug1138554.patch</a>
        </div>
        <div>
            <a href="#c62" class="attach-time activity-ref"><span class="rel-time" title="2015-05-20 09:38 PDT" data-time="1432139921">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_438654" ><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div></span>
        </div>
        <div class="attach-info">575.35 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8608187&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8608187&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1138554&attachment=8608187">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8608384">bug1138554.patch</a>
        </div>
        <div>
            <a href="#c67" class="attach-time activity-ref"><span class="rel-time" title="2015-05-20 15:55 PDT" data-time="1432162501">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_438654" ><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div></span>
        </div>
        <div class="attach-info">15.23 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_1584" ><span class="fn">wtc</span>
</div>:
              <a href="#c72"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1432162501"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8608384&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8608384&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1138554&attachment=8608384">Splinter Review</a>
    </tr>
</table>

<footer id="attachments-footer">
  <div id="attachments-actions">
      <button type="button" id="attachments-obsolete-btn" class="secondary">Show Obsolete</button>
  </div>
  
</footer>
  </div>
</section>



<script nonce="CSTOu9QXNtgNT60wHPiJdTzY3qaDrtnRObLsKzI1lrew9sGP">
  init_module_visibility();
</script>



<meta name="firefox-versions" content="{&quot;FIREFOX_AURORA&quot;:&quot;&quot;,&quot;FIREFOX_DEVEDITION&quot;:&quot;94.0b9&quot;,&quot;FIREFOX_ESR&quot;:&quot;78.15.0esr&quot;,&quot;FIREFOX_ESR_NEXT&quot;:&quot;91.2.0esr&quot;,&quot;FIREFOX_NIGHTLY&quot;:&quot;95.0a1&quot;,&quot;FIREFOX_PINEBUILD&quot;:&quot;&quot;,&quot;LAST_MERGE_DATE&quot;:&quot;2021-10-04&quot;,&quot;LAST_RELEASE_DATE&quot;:&quot;2021-10-05&quot;,&quot;LAST_SOFTFREEZE_DATE&quot;:&quot;2021-09-30&quot;,&quot;LATEST_FIREFOX_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_OLDER_VERSION&quot;:&quot;3.6.28&quot;,&quot;LATEST_FIREFOX_RELEASED_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_VERSION&quot;:&quot;93.0&quot;,&quot;NEXT_MERGE_DATE&quot;:&quot;2021-11-01&quot;,&quot;NEXT_RELEASE_DATE&quot;:&quot;2021-11-02&quot;,&quot;NEXT_SOFTFREEZE_DATE&quot;:&quot;2021-10-28&quot;}">


<div id="comment-actions">
    <button type="button" id="bottom-btn" class="secondary" aria-label="Go to Page Bottom">Bottom &darr;</button>
  <div class="dropdown">
    <button type="button" id="comment-tags-btn" aria-haspopup="true" aria-label="Tags"
      aria-expanded="false" aria-controls="comment-tags-menu" class="dropdown-button minor">Tags &#9662;</button>
    <ul id="comment-tags-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a role="menuitem" tabindex="-1" data-comment-tag="">Reset</a>
      </li>
    </ul>
  </div>
  <div class="dropdown">
    <button type="button" id="view-menu-btn" aria-haspopup="true" aria-label="Timeline"
      aria-expanded="false" aria-controls="view-menu" class="dropdown-button minor">Timeline &#9662;</button>
    <ul id="view-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a id="view-reset" role="menuitem" tabindex="-1">Reset</a>
      </li>
      <li role="separator"></li>
      <li role="presentation">
        <a id="view-collapse-all" role="menuitem" tabindex="-1">Collapse All</a>
      </li>
      <li role="presentation">
        <a id="view-expand-all" role="menuitem" tabindex="-1">Expand All</a>
      </li>
      <li role="presentation">
        <a id="view-comments-only" role="menuitem" tabindex="-1">Comments Only</a>
      </li>
    </ul>
   </div>
</div>
<div class="change-set" id="c0"><div class="comment" data-id="9974705" data-no="0"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-0" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_35667" ><img src="https://secure.gravatar.com/avatar/f3b5a842a3ef240e7ba5b3efab681531?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_35667" ><a class="email " href="/user_profile?user_id=35667" > <span class="fna">Eric Rescorla (:ekr)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-0"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-0" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c0">Description</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-02 10:11 PST" data-time="1425319895">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-0">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  empty"
        id="ct-0" data-comment-id="9974705"><em>No description provided.</em></pre></div><div class="change-set" id="c1"><div class="comment" data-id="9974788" data-no="1"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-1" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_35667" ><img src="https://secure.gravatar.com/avatar/f3b5a842a3ef240e7ba5b3efab681531?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_35667" ><a class="email " href="/user_profile?user_id=35667" > <span class="fna">Eric Rescorla (:ekr)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-1"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-1" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c1">Comment 1</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-02 10:22 PST" data-time="1425320531">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-1">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-1" data-comment-id="9974788">The following issue needs to be externally coordinated.

Matthew Green informed me this morning of a potential issue in libssl
and DHE processing. The scenario is a TLS server which is configured
for export DHE modes, such as:

  TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA

As well as stronger modes.


In this scenario, the server is supposed to use a 512-bit DHE key.
If the server uses a static key rather than a fresh key for each
connection, then it is potentially possible for an attacker to
break the key. At that point he modifies the client's ClientHello
to only offer the export DHE mode, causing the server to return
a valid ServerKeyExchange with that key. The attacker than computes
the master secret and assumes the rest of the connection.

Green suggests that NSS should address this by increasing the
minimum DHE key size. See:
<a rel="nofollow" href="https://dxr.mozilla.org/mozilla-central/source/security/nss/lib/ssl/ssl3con.c#6734">https://dxr.mozilla.org/mozilla-central/source/security/nss/lib/ssl/ssl3con.c#6734</a></pre></div><div class="change-set" id="a991_35667"><div class="change" id="aa991_35667">
    <table class="layout-table change-head reporter" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_35667" id="a991_35667"><img src="https://secure.gravatar.com/avatar/f3b5a842a3ef240e7ba5b3efab681531?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_35667" id="a991_35667"><a class="email " href="/user_profile?user_id=35667" > <span class="fna">Eric Rescorla (:ekr)</span></a>
</div>
            <span class="user-role">Reporter</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a991_35667"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a991_35667">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#a991_35667">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-02 10:28 PST" data-time="1425320886">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Summary: NSS needs to check length of DHE keys &rarr; NSS accepts export-length DHE keys with regular DHE cipher suites</div></div></div><div class="change-set" id="c2"><div class="comment" data-id="9974893" data-no="2"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-2" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a991_35667"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a991_35667"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-2"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-2" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c2">Comment 2</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-02 10:38 PST" data-time="1425321533">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-2">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-2" data-comment-id="9974893">I have an second fix.  Delete all of that nasty dangerous export rubbish.  It has been off by default for ages already.

I'm not sure about the purported attack: Finished should prevent the downgrade.  And if peers are willing to negotiate export strength suites, then they get what they deserve.</pre></div><div class="change-set" id="c3"><div class="comment" data-id="9975427" data-no="3"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-3" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_35667" id="a991_35667"><img src="https://secure.gravatar.com/avatar/f3b5a842a3ef240e7ba5b3efab681531?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_35667" id="a991_35667"><a class="email " href="/user_profile?user_id=35667" > <span class="fna">Eric Rescorla (:ekr)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-3"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-3" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c3">Comment 3</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-02 12:20 PST" data-time="1425327603">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-3">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-3" data-comment-id="9975427">I do not believe that Finished will detect the downgrade because the
attacker knows the MS.</pre></div><div class="change-set" id="c4"><div class="comment" data-id="9976232" data-no="4"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-4" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a991_35667"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a991_35667"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-4"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-4" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c4">Comment 4</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-02 14:35 PST" data-time="1425335700">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-4">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-4" data-comment-id="9976232">possibly related <a class="bz_bug_link
          bz_status_ASSIGNED"
   title="ASSIGNED - RSA key size limits are not uniformly applied in freebl and softoken"
   href="/show_bug.cgi?id=308724">bug 308724</a>?  See also discussion in 587234

If I'm looking at the right category we have very few connections at &lt; 1024 bits
<a rel="nofollow" href="http://telemetry.mozilla.org/#filter=beta%2F37%2FSSL_KEA_DHE_KEY_SIZE_FULL%2Fsaved_session%2FFirefox&amp;aggregates=multiselect-all!Submissions&amp;evoOver=Builds&amp;locked=true&amp;sanitize=true&amp;renderhistogram=Graph">http://telemetry.mozilla.org/#filter=beta%2F37%2FSSL_KEA_DHE_KEY_SIZE_FULL%2Fsaved_session%2FFirefox&amp;aggregates=multiselect-all!Submissions&amp;evoOver=Builds&amp;locked=true&amp;sanitize=true&amp;renderhistogram=Graph</a>

There's recent work (December) trying to block connections with fewer bits in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Disallow connections when the server uses a DHE key that is too weak"
   href="/show_bug.cgi?id=587407">bug 587407</a></pre></div><div class="change-set" id="c5"><div class="comment" data-id="9976272" data-no="5"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-5" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a991_35667"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a991_35667"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-5"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-5" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c5">Comment 5</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-02 14:41 PST" data-time="1425336071">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-5">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-5" data-comment-id="9976272">Is there any way the server you're talking to is doing this accidentally? Seems like something you'd do in a deliberate attempt to make traffic exposed, and if the server is complicit they could just take the data and ship it out the back end. Going with &quot;moderate&quot; severity for now, but if you think this is a realistic attack scenario then maybe &quot;high&quot; is better.</pre><div class="activity"><div class="change">Keywords: <a href="/buglist.cgi?keywords=sec-moderate&amp;resolution=---">sec-moderate</a></div><div class="change">Whiteboard: Embargo until multi-vendor coordinated info release</div></div></div><div class="change-set" id="c6"><div class="comment" data-id="9976624" data-no="6"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-6" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a991_35667"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a991_35667"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-6"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-6" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c6">Comment 6</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-02 15:51 PST" data-time="1425340286">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-6">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-6" data-comment-id="9976624">(In reply to Eric Rescorla (:ekr) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS accepts export-length DHE keys with regular DHE cipher suites (&quot;Logjam&quot;)"
   href="/show_bug.cgi?id=1138554#c3">comment #3</a>)
<span class="quote">&gt; I do not believe that Finished will detect the downgrade because the
&gt; attacker knows the MS.</span >

Ahh, I didn't get that bit.  Is this right?

1. The client sends a regular HS with a DHE suite.
2. The MitM switches out all the ciphers for an export suite.
3. The server sends a pathetic DH share (&lt;512 bit).  And signs it.
4. The MitM recovers the servers private value based on the share.  (Leap of faith required here, but at 512 bits, that's not especially big.)
5. The MitM constructs a ServerHello with the weak DHE share (matching it to one of the client's DHE suites).
6. The MitM can now impersonate both peers toward each other and construct valid Finished messages.

From step 3, is it the case that the server can now be impersonated on any connection where the client offers a DHE suite?  That would make step 4 much more plausible.

Landing <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Disallow connections when the server uses a DHE key that is too weak"
   href="/show_bug.cgi?id=587407">bug 587407</a> seems like the right thing here.</pre></div><div class="change-set" id="c7"><div class="comment" data-id="9977101" data-no="7"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-7" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_532936" id="a991_35667"><img src="https://secure.gravatar.com/avatar/0c686ee27e835834c44ad17115185e12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_532936" id="a991_35667"><a class="email disabled" href="/user_profile?user_id=532936" > <span class="fna">Matthew Green</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-7"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-7" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c7">Comment 7</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-02 17:56 PST" data-time="1425347807">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-7">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-7" data-comment-id="9977101"><span class="quote">&gt; From step 3, is it the case that the server can now be impersonated on any
&gt; connection where the client offers a DHE suite?  That would make step 4 much
&gt; more plausible.</span >

This is exactly the attack. Two more data points:

1. Most Apache servers generate the DHE export key once at startup, and use the same key for the entire session. I checked the mod_ssl to verify this.

2. We can factor a 512-bit RSA key in 8 hours for $75 on EC2. This is based on recent, real efforts. Discrete log should be approximately the same effort, but we haven't verified this.

I don't know how widespread these export-grade DHE ciphers are. Going to get someone to run a scan. In a minute or two of searching I found at least one on SSL Labs:

<a rel="nofollow" href="https://www.ssllabs.com/ssltest/analyze.html?d=partnerapi.iassist.com">https://www.ssllabs.com/ssltest/analyze.html?d=partnerapi.iassist.com</a>

Matt</pre></div><div class="change-set" id="c8"><div class="comment" data-id="9981423" data-no="8"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-8" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a991_35667"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a991_35667"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-8"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-8" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c8">Comment 8</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-03 13:26 PST" data-time="1425417995">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-8">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-8" data-comment-id="9981423">Might want to open this up now: <a rel="nofollow" href="http://arstechnica.com/security/2015/03/freak-flaw-in-android-and-apple-devices-cripples-https-crypto-protection/">http://arstechnica.com/security/2015/03/freak-flaw-in-android-and-apple-devices-cripples-https-crypto-protection/</a></pre></div><div class="change-set" id="c9"><div class="comment" data-id="9981438" data-no="9"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-9" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_35667" id="a991_35667"><img src="https://secure.gravatar.com/avatar/f3b5a842a3ef240e7ba5b3efab681531?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_35667" id="a991_35667"><a class="email " href="/user_profile?user_id=35667" > <span class="fna">Eric Rescorla (:ekr)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-9"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-9" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c9">Comment 9</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-03 13:29 PST" data-time="1425418181">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-9">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-9" data-comment-id="9981438">i believe that does not describe the issue in NSS. Please check with Matt Green first.</pre></div><div class="change-set" id="c10"><div class="comment" data-id="9981444" data-no="10"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-10" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_373085" id="a991_35667"><img src="https://secure.gravatar.com/avatar/0f471505131b1c419602ba75cfa91397?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_373085" id="a991_35667"><a class="email " href="/user_profile?user_id=373085" > <span class="fna">Richard Barnes [:rbarnes]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-10"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-10" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c10">Comment 10</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-03 13:31 PST" data-time="1425418308">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-10">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-10" data-comment-id="9981444"><span class="quote">&gt; Landing <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Disallow connections when the server uses a DHE key that is too weak"
   href="/show_bug.cgi?id=587407">bug 587407</a> seems like the right thing here.</span >

+1, especially given that there's already a WIP patch.</pre></div><div class="change-set" id="c11"><div class="comment" data-id="9981454" data-no="11"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-11" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_532936" id="a991_35667"><img src="https://secure.gravatar.com/avatar/0c686ee27e835834c44ad17115185e12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_532936" id="a991_35667"><a class="email disabled" href="/user_profile?user_id=532936" > <span class="fna">Matthew Green</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-11"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-11" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c11">Comment 11</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-03 13:34 PST" data-time="1425418459">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-11">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-11" data-comment-id="9981454">The bug that was disclosed today affects RSA ciphersuites only. NSS is not vulnerable to that particular vector (dodged it by a whisker). The DHE thing is a completely different issue that won't be affected by any existing client-side patch.

The best you can hope for is that Akamai wipes out all of its export ciphersuites (both RSA and DHE), but there's no guarantee this will happen. A client-side patch would be a very good idea.</pre></div><div class="change-set" id="c12"><div class="comment" data-id="9981466" data-no="12"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-12" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a991_35667"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a991_35667"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-12"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-12" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c12">Comment 12</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-03 13:37 PST" data-time="1425418631">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-12">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-12" data-comment-id="9981466">OK, let's land the fix in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Disallow connections when the server uses a DHE key that is too weak"
   href="/show_bug.cgi?id=587407">bug 587407</a> before we open this up.  Arguably, this is even more serious than FREAK.</pre></div><div class="change-set" id="c13"><div class="comment" data-id="9981777" data-no="13"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-13" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445246" id="a991_35667"><img src="https://secure.gravatar.com/avatar/04110fd15242c638565b4b558f003b3e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445246" id="a991_35667"><a class="email " href="/user_profile?user_id=445246" > <span class="fna">Karthikeyan Bhargavan</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-13"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-13" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c13">Comment 13</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-03 14:54 PST" data-time="1425423255">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-13">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-13" data-comment-id="9981777">Is the proposal in 587407 to set the minimum DH group size to 1024?</pre></div><div class="change-set" id="a107275_14661"><div class="change" id="aa107275_14661">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a107275_14661"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_14661" id="a107275_14661"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a107275_14661"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a107275_14661">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#a107275_14661">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-03 15:59 PST" data-time="1425427170">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">See Also:  &rarr; <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS incorrectly permits skipping of ServerKeyExchange"
   href="/show_bug.cgi?id=1086145">CVE-2015-2721</a></div></div></div><div class="change-set" id="c14"><div class="comment" data-id="10052071" data-no="14"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-14" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a107275_14661"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a107275_14661"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-14"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-14" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c14">Comment 14</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-19 10:44 PDT" data-time="1426787077">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-14">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-14" data-comment-id="10052071">After looking at <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Disallow connections when the server uses a DHE key that is too weak"
   href="/show_bug.cgi?id=587407">bug 587407</a> and discussing this on the NSS, I think that we should avoid those changes and provide a hard limit in NSS.  The stated plan was to limit at 1024...ish.  We will need to check whether this is 1024, or whether we need to make this slightly less to avoid excluding too many sites.</pre></div><div class="change-set" id="c15"><div class="comment" data-id="10052445" data-no="15"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-15" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a107275_14661"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a107275_14661"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-15"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-15" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c15">Comment 15</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-19 12:00 PDT" data-time="1426791619">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-15">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-15" data-comment-id="10052445">I suggest first increasing the limit to 768 bits, because that fixes the export cipher suite problem problem and 768 bits is the size used by many Java servers. Then uplift that change and then investigate making the minimum 1024, knowing that there will be a higher compatibility impact that will likely require additional work and/or delay to address.</pre></div><div class="change-set" id="c16"><div class="comment" data-id="10052488" data-no="16"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-16" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445246" id="a107275_14661"><img src="https://secure.gravatar.com/avatar/04110fd15242c638565b4b558f003b3e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445246" id="a107275_14661"><a class="email " href="/user_profile?user_id=445246" > <span class="fna">Karthikeyan Bhargavan</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-16"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-16" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c16">Comment 16</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-19 12:10 PDT" data-time="1426792209">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-16">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-16" data-comment-id="10052488">Some data points for comparison:

- Windows 10 has set 1024 as the minimum size for DH groups.
  This limit is being backported to older versions of Windows.

- In our scan of the Alexa top 1M sites, only 773 (0.2%) uses 768-bit primes, and 118 used 512-bit primes.
  In the full IP space the number of 768-bit primes was higher (about 2.6%)

- Most of the sites offering short primes seem to prefer RSA ciphersuites and hence would pick
  those over DHE anyway.

In summary, based on public servers on the web, we do not see many reasons for accepting &lt;1024-bit groups.
Maybe there are other servers out there that are of concern for this?</pre></div><div class="change-set" id="c17"><div class="comment" data-id="10052564" data-no="17"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-17" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a107275_14661"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a107275_14661"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-17"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-17" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c17">Comment 17</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-19 12:23 PDT" data-time="1426793009">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-17">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-17" data-comment-id="10052564">(In reply to Karthikeyan Bhargavan from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS accepts export-length DHE keys with regular DHE cipher suites (&quot;Logjam&quot;)"
   href="/show_bug.cgi?id=1138554#c16">comment #16</a>)
<span class="quote">&gt; - In our scan of the Alexa top 1M sites, only 773 (0.2%) uses 768-bit
&gt; primes, and 118 used 512-bit primes.
&gt;   In the full IP space the number of 768-bit primes was higher (about 2.6%)</span >

TLS 1.2 intolerance was less than 1% after SSLv3 was disabled, IIRC. So the compatibility risk and approximate amount of work required to have a 1024 bit limit could be as high as 3x the associated risk and cost of disabling non-secure version fallback.

It is good that Windows 10 enforces a higher minimimum. However, Windows 8.1 and lower only offer DHE key exchange for AES-GCM and DSS cipher suites, so the compatibility risk is probably much lower for Microsoft. And, of course, windows 10 hasn't been released and those backports haven't happened yet.</pre></div><div class="change-set" id="c18"><div class="comment" data-id="10052596" data-no="18"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-18" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a107275_14661"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a107275_14661"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-18"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-18" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c18">Comment 18</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-19 12:29 PDT" data-time="1426793385">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-18">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-18" data-comment-id="10052596">(In reply to Karthikeyan Bhargavan from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS accepts export-length DHE keys with regular DHE cipher suites (&quot;Logjam&quot;)"
   href="/show_bug.cgi?id=1138554#c16">comment #16</a>)
<span class="quote">&gt; - In our scan of the Alexa top 1M sites, only 773 (0.2%) uses 768-bit
&gt; primes, and 118 used 512-bit primes.
&gt;   In the full IP space the number of 768-bit primes was higher (about 2.6%)</span >

See also [1], which measures the DHE key size distribution that Firefox uses. The key is at [2]. [3] tells you the percentage of time that DHE key exchange is used in Firefox (about 5% of the time). These numbers give an alternative (more optimistic) estimate of the compatibility impact of enforcing a 1024-bit minimum.

[1] <a rel="nofollow" href="http://telemetry.mozilla.org/#filter=release%2F36%2FSSL_KEA_DHE_KEY_SIZE_FULL">http://telemetry.mozilla.org/#filter=release%2F36%2FSSL_KEA_DHE_KEY_SIZE_FULL</a>
[2] <a rel="nofollow" href="https://mxr.mozilla.org/mozilla-central/source/security/manager/ssl/src/nsNSSCallbacks.cpp?rev=7badc767cc25#1029">https://mxr.mozilla.org/mozilla-central/source/security/manager/ssl/src/nsNSSCallbacks.cpp?rev=7badc767cc25#1029</a>
[3] <a rel="nofollow" href="http://telemetry.mozilla.org/#filter=release%2F36%2FSSL_KEY_EXCHANGE_ALGORITHM_FULL">http://telemetry.mozilla.org/#filter=release%2F36%2FSSL_KEY_EXCHANGE_ALGORITHM_FULL</a></pre></div><div class="change-set" id="c19"><div class="comment" data-id="10052676" data-no="19"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-19" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445246" id="a107275_14661"><img src="https://secure.gravatar.com/avatar/04110fd15242c638565b4b558f003b3e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445246" id="a107275_14661"><a class="email " href="/user_profile?user_id=445246" > <span class="fna">Karthikeyan Bhargavan</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-19"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-19" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c19">Comment 19</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-19 12:44 PDT" data-time="1426794297">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-19">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-19" data-comment-id="10052676">Thanks, these numbers are quite interesting.

I should clarify that our concern about short groups is two-fold:

1) Groups &lt;= 512 can be broken right now with academic processing power

2) Most groups &gt; 512 bits being used out there are really old.
  The vast majority use Apache hard-coded groups from 15-20 years ago.
  I believe the Java and IIS 768-bit groups are also hard-coded.
  This has given some adversaries more than a decade to break them.
  
The second point above is more worrisome, and cannot be fixed just at the client.
Still, raising to 1024 may help stave off the attacks for longer.

None of this is new of course and I don't want to preach to the choir.
I agree that raising the limit from 512-bits is a no-brainer, and should be done asap, even if just to 768.</pre></div><div class="change-set" id="c20"><div class="comment" data-id="10052756" data-no="20"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-20" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a107275_14661"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a107275_14661"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-20"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-20" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c20">Comment 20</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-19 13:02 PDT" data-time="1426795351">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-20">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-20" data-comment-id="10052756">(In reply to Karthikeyan Bhargavan from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS accepts export-length DHE keys with regular DHE cipher suites (&quot;Logjam&quot;)"
   href="/show_bug.cgi?id=1138554#c19">comment #19</a>)
<span class="quote">&gt; The second point above is more worrisome, and cannot be fixed just at the
&gt; client.
&gt; Still, raising to 1024 may help stave off the attacks for longer.
&gt; 
&gt; None of this is new of course and I don't want to preach to the choir.
&gt; I agree that raising the limit from 512-bits is a no-brainer, and should be
&gt; done asap, even if just to 768.</span >

I agree. In fact, the TLS design is just completely broken here, because the DHE key is effectively authenticating itself. That means that a secure minimum size for the DHE key is whatever the minimum size we require for authentication, which is going to be *2048* bits after <a class="bz_bug_link
          bz_status_NEW"
   title="NEW - Show Untrusted Connection Error when cert in chain uses less than RSA 2048 signatures"
   href="/show_bug.cgi?id=1137484">bug 1137484</a> lands. And, almost nobody doing DHE is using 2048-bit DHE keys.

Note that this has interesting implications for the negotiated FF-DHE extension that the TLS WG is working on. A few months ago I already alluded to this issue on the TLS WG mailing list, where I suggested that the client's FF-DHE extension should be signed along with the DHE parameters. It would be great if you could contribute to that discussion by sharing your research on the mailing list soon.</pre></div><div class="change-set" id="c21"><div class="comment" data-id="10052829" data-no="21"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-21" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445246" id="a107275_14661"><img src="https://secure.gravatar.com/avatar/04110fd15242c638565b4b558f003b3e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445246" id="a107275_14661"><a class="email " href="/user_profile?user_id=445246" > <span class="fna">Karthikeyan Bhargavan</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-21"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-21" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c21">Comment 21</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-19 13:16 PDT" data-time="1426796217">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-21">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-21" data-comment-id="10052829">(In reply to Brian Smith (:briansmith, :bsmith, use NEEDINFO?) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS accepts export-length DHE keys with regular DHE cipher suites (&quot;Logjam&quot;)"
   href="/show_bug.cgi?id=1138554#c20">comment #20</a>)

<span class="quote">&gt; Note that this has interesting implications for the negotiated FF-DHE
&gt; extension that the TLS WG is working on. A few months ago I already alluded
&gt; to this issue on the TLS WG mailing list, where I suggested that the
&gt; client's FF-DHE extension should be signed along with the DHE parameters. It
&gt; would be great if you could contribute to that discussion by sharing your
&gt; research on the mailing list soon.</span >

Indeed it would be great if the core idea of the TLS 1.3 server signature design were to be
backported into earlier versions of TLS. E.g. signing a hash of the handshake
into the ServerKeyExchange would solve a whole bunch of downgrade issues (including DHE_EXPORT).</pre></div><div class="change-set" id="c22"><div class="comment" data-id="10053072" data-no="22"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-22" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a107275_14661"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a107275_14661"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-22"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-22" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c22">Comment 22</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-19 14:05 PDT" data-time="1426799149">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-22">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-22" data-comment-id="10053072">Based on this discussion and the telemetry numbers (I tallied just over 1% for DHE suites, which are again 5% of the total, so 0.05%), I've been convinced that raising to 1024 is safe.  

I would like to go higher, but I don't see a way of doing that.  Our options for the attack at 1024 are: raise to 2048 (and lose virtually the entire 5% of DHE servers), or implement the extended master secret (in progress, but I can't see that being implemented by affected servers).

Based on the telemetry numbers, the bulk of the bit sizes are in the 1025-1279 bucket.  Rejecting everything &lt;=1023 seems tolerable based on that.</pre></div><div class="change-set" id="c23"><div class="comment" data-id="10059083" data-no="23"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-23" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a107275_14661"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a107275_14661"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-23"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-23" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c23">Comment 23</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-20 15:53 PDT" data-time="1426891992">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-23">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-23" data-comment-id="10059083"><a rel="nofollow" href="http://codereview.appspot.com/215460043">http://codereview.appspot.com/215460043</a> - access on request.</pre></div><div class="change-set" id="c24"><div class="comment" data-id="10059097" data-no="24"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-24" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a107275_14661"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a107275_14661"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-24"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-24" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c24">Comment 24</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-20 15:56 PDT" data-time="1426892178">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-24">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8580961"
         class="attachment patch obsolete"
         data-id="8580961" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1138554.patch">
      <meta itemprop="contentSize" content="1090">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8580961">
          <a class="link" href="attachment.cgi?id=8580961&amp;action=diff">
        <span id="att-8580961-description" itemprop="description">bug1138554.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8580961&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1138554&attachment=8580961">Splinter Review</a>
      </div>
    </div><div class="activity"><div class="change">Assignee: nobody &rarr; martin.thomson</div><div class="change">Status: NEW &rarr; ASSIGNED</div><div class="change">
        <a href="/attachment.cgi?id=8580961&amp;action=edit"
           title="bug1138554.patch"
           class=""
        >Attachment #8580961</a> -
        Flags: review?(wtc)</div></div></div><div class="change-set" id="c25"><div class="comment" data-id="10059157" data-no="25"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-25" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1584" id="a107275_14661"><img src="https://secure.gravatar.com/avatar/3e0b23cde901a6405f541eed3973331c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1584" id="a107275_14661"><a class="email " href="/user_profile?user_id=1584" > <span class="fna">Wan-Teh Chang</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-25"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-25" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c25">Comment 25</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-20 16:16 PDT" data-time="1426893400">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-25">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-25" data-comment-id="10059157">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8580961" name="attach_8580961" title="bug1138554.patch">attachment 8580961</a> <a href="/attachment.cgi?id=8580961&amp;action=edit" title="bug1138554.patch">[details]</a> <a href="/attachment.cgi?id=8580961&amp;action=diff" title="bug1138554.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1138554&amp;attachment=8580961'>[review]</a>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS accepts export-length DHE keys with regular DHE cipher suites (&quot;Logjam&quot;)"
   href="/show_bug.cgi?id=1138554">bug1138554</a>.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8580961" name="attach_8580961" title="bug1138554.patch">attachment 8580961</a> <a href="/attachment.cgi?id=8580961&amp;action=edit" title="bug1138554.patch">[details]</a> <a href="/attachment.cgi?id=8580961&amp;action=diff" title="bug1138554.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1138554&amp;attachment=8580961'>[review]</a>:
-----------------------------------------------------------------

r=wtc. I wrote more comments at <a rel="nofollow" href="https://codereview.appspot.com/215460043/">https://codereview.appspot.com/215460043/</a></pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8580961&amp;action=edit"
           title="bug1138554.patch"
           class=""
        >Attachment #8580961</a> -
        Flags: review?(wtc) &rarr; review+</div></div></div><div class="change-set" id="c26"><div class="comment" data-id="10059633" data-no="26"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-26" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a107275_14661"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a107275_14661"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-26"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-26" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c26">Comment 26</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-20 19:49 PDT" data-time="1426906153">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-26">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-26" data-comment-id="10059633">So I got a nominal OK here, but something still bothers me about this.  I think that perhaps it was Wan-Teh's old patch that attempted to place limits on the RSA modulus in the same way that caused me to rethink it.

I looked at the code all the way down to the point that it hits the bignum code in freebl/mpi.c.  Nowhere on that chain can I find a place where we reject primes with a large number of leading zeros in their encoding.  The only exception is that SECKEY_PublicKeyStrength docks one byte (8 bits) from the strength if the first byte is zero, which is hardly worth much.  If you follow the chain to its conclusion, mp_read_unsigned_octets() is happy to ignore leading zero bytes.

I take that to mean that - as currently specified - it would be trivial for an attacker to zero-pad any prime in order to make it pass our superficial test of strength.  I think that we should at least make a passing attempt at doing better.  It's not like we can test that the value is a safe prime, (at least not in any reasonable time) but if we want to protect against this attack, we should at least check if it is plausibly long.  New patch inbound.

I also want to check that we are checking the RSA modulus size properly before we open this up.  If someone can confirm my thinking, it might be worth raising this point with other implementations.

Matt, who might I need to coordinate with on this?</pre><div class="activity"><div class="change">Flags: needinfo?(matthewdgreen)</div></div></div><div class="change-set" id="c27"><div class="comment" data-id="10059690" data-no="27"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-27" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a107275_14661"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a107275_14661"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-27"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-27" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c27">Comment 27</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-20 21:12 PDT" data-time="1426911165">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-27">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-27" data-comment-id="10059690">Wan-Teh, I looked at <a rel="nofollow" href="https://bugzilla.mozilla.org/page.cgi?id=splinter.html&amp;bug=587234&amp;attachment=468110">https://bugzilla.mozilla.org/page.cgi?id=splinter.html&amp;bug=587234&amp;attachment=468110</a> as you suggested.  I'm pretty sure that your check for the RSA modulus size is in dead code.  The ServerKeyExchange message is not sent for an RSA key exchange, see <a rel="nofollow" href="https://tools.ietf.org/html/rfc5246#section-7.4.3">https://tools.ietf.org/html/rfc5246#section-7.4.3</a>

Also, I don't think we need to have a bit-size check for ECC suites; disabling groups is probably the right way to deal with that and our weakest supported is currently 163, which is (by most accounts) stronger than 1024-bit DHE or RSA.

I think that I've got all the necessary parts in place now, but this is a much bigger change than originally thought.</pre></div><div class="change-set" id="c28"><div class="comment" data-id="10059700" data-no="28"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-28" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a107275_14661"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a107275_14661"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-28"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-28" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c28">Comment 28</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-20 21:32 PDT" data-time="1426912377">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-28">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8581044"
         class="attachment patch obsolete"
         data-id="8581044" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1138554.patch">
      <meta itemprop="contentSize" content="10227">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8581044">
          <a class="link" href="attachment.cgi?id=8581044&amp;action=diff">
        <span id="att-8581044-description" itemprop="description">bug1138554.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8581044&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1138554&attachment=8581044">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-28" data-comment-id="10059700">This is a significantly more scary patch.

Also, I've added a check on the size of the RSA modulus in the server certificate.  This has the effect of killing off export cipher suites, so we'll want to discuss that on the list.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8580961&amp;action=edit"
           title="bug1138554.patch"
           class=""
        >Attachment #8580961</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8581044&amp;action=edit"
           title="bug1138554.patch"
           class=""
        >Attachment #8581044</a> -
        Flags: review?(wtc)</div></div></div><div class="change-set" id="c29"><div class="comment" data-id="10059730" data-no="29"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-29" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a107275_14661"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a107275_14661"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-29"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-29" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c29">Comment 29</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-20 21:44 PDT" data-time="1426913090">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-29">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-29" data-comment-id="10059730">I found the other bug that relates to the size calculation: <a class="bz_bug_link
          bz_status_NEW"
   title="NEW - DHE key length is calculated differently in weak key check and SSL_GetChannelInfo"
   href="/show_bug.cgi?id=623658">bug 623658</a>.</pre></div><div class="change-set" id="c30"><div class="comment" data-id="10060196" data-no="30"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-30" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_532936" id="a107275_14661"><img src="https://secure.gravatar.com/avatar/0c686ee27e835834c44ad17115185e12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_532936" id="a107275_14661"><a class="email disabled" href="/user_profile?user_id=532936" > <span class="fna">Matthew Green</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-30"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-30" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c30">Comment 30</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-21 05:24 PDT" data-time="1426940640">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-30">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-30" data-comment-id="10060196"><span class="quote">&gt; I also want to check that we are checking the RSA modulus size properly
&gt; before we open this up.  If someone can confirm my thinking, it might be
&gt; worth raising this point with other implementations.
&gt; 
&gt; Matt, who might I need to coordinate with on this?</span >

It should be hard for an MITM attacker to pad the primes, since fortunately those values are properly signed. A bad server could issue a small prime, but a bad server is probably already outside of your threat model.

Can you clarify your request? Let me know what you want to check and I'll make sure the right people get involved.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(matthewdgreen)</span></div></div></div><div class="change-set" id="c31"><div class="comment" data-id="10060583" data-no="31"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-31" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a107275_14661"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a107275_14661"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-31"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-31" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c31">Comment 31</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-03-21 09:11 PDT" data-time="1426954307">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-31">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-31" data-comment-id="10060583">The signature is the piece of information I'd overlooked. No need to file up further, thanks.</pre></div><div class="change-set" id="c32"><div class="comment" data-id="10113784" data-no="32"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-32" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1584" id="a107275_14661"><img src="https://secure.gravatar.com/avatar/3e0b23cde901a6405f541eed3973331c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1584" id="a107275_14661"><a class="email " href="/user_profile?user_id=1584" > <span class="fna">Wan-Teh Chang</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-32"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-32" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c32">Comment 32</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-02 15:20 PDT" data-time="1428013253">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-32">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-32" data-comment-id="10113784">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8581044" name="attach_8581044" title="bug1138554.patch">attachment 8581044</a> <a href="/attachment.cgi?id=8581044&amp;action=edit" title="bug1138554.patch">[details]</a> <a href="/attachment.cgi?id=8581044&amp;action=diff" title="bug1138554.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1138554&amp;attachment=8581044'>[review]</a>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS accepts export-length DHE keys with regular DHE cipher suites (&quot;Logjam&quot;)"
   href="/show_bug.cgi?id=1138554">bug1138554</a>.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8581044" name="attach_8581044" title="bug1138554.patch">attachment 8581044</a> <a href="/attachment.cgi?id=8581044&amp;action=edit" title="bug1138554.patch">[details]</a> <a href="/attachment.cgi?id=8581044&amp;action=diff" title="bug1138554.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1138554&amp;attachment=8581044'>[review]</a>:
-----------------------------------------------------------------

r=wtc. I suggest some changes, some of which may be important.

::: lib/cryptohi/keyhi.h
&#64;&#64; +38,5 &#64;&#64;
<span class="quote">&gt;  SECKEY_UpdateCertPQG(CERTCertificate * subjectCert);
&gt;  
&gt; +/* This sets a limit on the DH or RSA modulus that we are OK with accepting. */
&gt; +#ifndef SECKEY_MIN_MODP_PRIME_BITS
&gt; +#define SECKEY_MIN_MODP_PRIME_BITS 1017</span >

1. This macro definition probably should be moved to keythi.h. The &quot;t&quot; in the header file's name stands for &quot;type&quot;.

2. We should not need to protect redefinition, i.e., the &quot;#ifndef SECKEY_MIN_MODP_PRIME_BITS&quot; seems unnecessary.

3. Since 1017 is not a power of 2 that computer programmers are used to, it would be nice to cite the source of this minimum.

&#64;&#64; +45,5 &#64;&#64;
<span class="quote">&gt; +/*
&gt; +** Return the number of bits in the provided number.  This assumes that the
&gt; +** SECItem contains a big-endian number and counts from the first non-zero bit.
&gt; +*/
&gt; +extern unsigned SECKEY_ModulusLengthBits(const SECItem *number);</span >

I am surprised NSS doesn't yet have such a function. This seems to imply the existing key size/strength functions are deficient. If so, please add a comment to document how this new function is better than existing key size/strength functions.

Or is the input parameter type the only difference? In that case, perhaps you can rename the function to be more general, such as &quot;SECKEY_BigIntegerBits&quot;.

::: lib/cryptohi/seckey.c
&#64;&#64; +949,5 &#64;&#64;
<span class="quote">&gt; +    unsigned octets;
&gt; +    unsigned bits;
&gt; +
&gt; +    if (!number || !number-&gt;data) {
&gt; +        PORT_SetError(SEC_ERROR_INVALID_KEY);</span >

Should we also check || number-&gt;len == 0 ?

&#64;&#64; +955,5 &#64;&#64;
<span class="quote">&gt; +    }
&gt; +
&gt; +    p = number-&gt;data;
&gt; +    octets = number-&gt;len;
&gt; +    while (!*p &amp;&amp; octets &gt; 0) {</span >

IMPORTANT: we need to check these in the reverse order, otherwise we may read one byte beyond the end of the buffer. This should read:

  while (octets &gt; 0 &amp;&amp; !*p) {

&#64;&#64; +963,5 &#64;&#64;
<span class="quote">&gt; +    if (octets == 0) {
&gt; +        return 0;
&gt; +    }
&gt; +    /* bits = 7..1 because we know at least one bit is set already */
&gt; +    for (bits = 7; bits &gt; 0; --bits) {</span >

There is a trick to do this using binary search. Since a properly generated key should have the most significant bit set, this for loop should exit in the first iteration. So it doesn't seem necessary to use the binary search trick.

&#64;&#64; +975,5 &#64;&#64;
<span class="quote">&gt;  /* returns key strength in bytes (not bits) */
&gt;  unsigned
&gt;  SECKEY_PublicKeyStrength(const SECKEYPublicKey *pubk)
&gt;  {
&gt; +    return (SECKEY_PublicKeyStrengthInBits(pubk) + 7) / 8;</span >

I like your changes to these two functions. However, the change to SECKEY_PublicKeyStrengthInBits may break code that assumes it always return a multiple of 8 for RSA, DSA, and DH keys. I think that is very unlikely though.

&#64;&#64; +984,5 &#64;&#64;
<span class="quote">&gt;  SECKEY_PublicKeyStrengthInBits(const SECKEYPublicKey *pubk)
&gt;  {
&gt; +    unsigned bitSize = 0;
&gt; +
&gt; +    /* interpret modulus length as key strength */</span >

Nit: move this comment to the switch statement.

::: lib/nss/nss.def
&#64;&#64; +222,5 &#64;&#64;
<span class="quote">&gt;  RSA_FormatBlock;
&gt;  SECITEM_CompareItem;
&gt;  SECKEY_CreateRSAPrivateKey;
&gt;  SECKEY_DestroyPublicKey;
&gt; +SECKEY_ModulusLengthBits;</span >

This needs to be added at the end of the file, inside a new section with the current NSS version.

::: lib/ssl/ssl3con.c
&#64;&#64; +6660,5 &#64;&#64;
<span class="quote">&gt;  	    goto loser;		/* malformed. */
&gt;  	}
&gt; +        if (SECKEY_ModulusLengthBits(&amp;modulus) &lt; SECKEY_MIN_MODP_PRIME_BITS) {
&gt; +            errCode = SSL_ERROR_WEAK_SERVER_RSA_KEY;
&gt; +            desc = insufficient_security;</span >

The insufficient_security alert was added in TLS 1.0. So we need an alternative for SSL 3.0.

&#64;&#64; +6754,5 &#64;&#64;
<span class="quote">&gt;      	if (rv != SECSuccess) {
&gt;  	    goto loser;		/* malformed. */
&gt;  	}
&gt; +        /* Allow a little less than 1024 */
&gt; +	if (SECKEY_ModulusLengthBits(&amp;dh_p) &lt; SECKEY_MIN_MODP_PRIME_BITS) {</span >

Please update the comment. It doesn't match the code.

&#64;&#64; +10058,5 &#64;&#64;
<span class="quote">&gt;  	    ss-&gt;sec.keaKeyBits = ss-&gt;sec.authKeyBits =
&gt;  		SECKEY_PublicKeyStrengthInBits(pubKey);
&gt; +            /* Too small: not good enough. Send a fatal alert. */
&gt; +            if (ss-&gt;sec.keaKeyBits &lt; SECKEY_MIN_MODP_PRIME_BITS) {
&gt; +                PORT_SetError(SSL_ERROR_WEAK_SERVER_RSA_KEY);</span >

How do you know the key is an RSA key?

&#64;&#64; +10059,5 &#64;&#64;
<span class="quote">&gt;  		SECKEY_PublicKeyStrengthInBits(pubKey);
&gt; +            /* Too small: not good enough. Send a fatal alert. */
&gt; +            if (ss-&gt;sec.keaKeyBits &lt; SECKEY_MIN_MODP_PRIME_BITS) {
&gt; +                PORT_SetError(SSL_ERROR_WEAK_SERVER_RSA_KEY);
&gt; +                (void)SSL3_SendAlert(ss, alert_fatal, insufficient_security);</span >

We need a different alert for SSL 3.0.

&#64;&#64; +10060,5 &#64;&#64;
<span class="quote">&gt; +            /* Too small: not good enough. Send a fatal alert. */
&gt; +            if (ss-&gt;sec.keaKeyBits &lt; SECKEY_MIN_MODP_PRIME_BITS) {
&gt; +                PORT_SetError(SSL_ERROR_WEAK_SERVER_RSA_KEY);
&gt; +                (void)SSL3_SendAlert(ss, alert_fatal, insufficient_security);
&gt; +                SECKEY_DestroyPublicKey(pubKey); </span >

Nit: please remove the space at the end of the line.

&#64;&#64; +10067,1 &#64;&#64;
<span class="quote">&gt;  #ifndef NSS_DISABLE_ECC</span >

IMPORTANT: please check this block of code, which adjusts ss-&gt;sec.authKeyBit (initialized on lines 10058-10059). Please make sure it doesn't undo the improvement you made to SECKEY_PublicKeyStrengthInBits(pubKey);</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8581044&amp;action=edit"
           title="bug1138554.patch"
           class=""
        >Attachment #8581044</a> -
        Flags: review?(wtc) &rarr; review+</div></div></div><div class="change-set" id="c33"><div class="comment" data-id="10118069" data-no="33"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-33" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a107275_14661"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a107275_14661"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-33"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-33" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c33">Comment 33</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-03 17:04 PDT" data-time="1428105855">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-33">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-33" data-comment-id="10118069">(In reply to Wan-Teh Chang from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS accepts export-length DHE keys with regular DHE cipher suites (&quot;Logjam&quot;)"
   href="/show_bug.cgi?id=1138554#c32">comment #32</a>)
<span class="quote">&gt; 1. This macro definition probably should be moved to keythi.h. The &quot;t&quot; in
&gt; the header file's name stands for &quot;type&quot;.</span >

Done.
 
<span class="quote">&gt; 2. We should not need to protect redefinition, i.e., the &quot;#ifndef
&gt; SECKEY_MIN_MODP_PRIME_BITS&quot; seems unnecessary.</span >

Done.

<span class="quote">&gt; 3. Since 1017 is not a power of 2 that computer programmers are used to, it
&gt; would be nice to cite the source of this minimum.</span >

Done.  I'm being conservative with this number.  Setting this to 1023 would be OK with me too.

<span class="quote">&gt; &gt; +extern unsigned SECKEY_ModulusLengthBits(const SECItem *number);
&gt; 
&gt; I am surprised NSS doesn't yet have such a function. This seems to imply the
&gt; existing key size/strength functions are deficient. If so, please add a
&gt; comment to document how this new function is better than existing key
&gt; size/strength functions.</span >

The current size methods were added in 3.8.  And arguably they were deficient as you can see by my refactoring.

I couldn't find anything that is equivalent, though I did find something in ssl3con.c that I can replace with a call to this function while fixing up the other patch:

-	if (dh_g.len &gt; dh_p.len || !ssl3_BigIntGreaterThanOne(&amp;dh_g))
-	    goto alert_loser;
+        dh_g_bits = SECKEY_BigIntegerBitLength(&amp;dh_g);
+        if (dh_g_bits &gt; dh_p_bits || dh_g_bits &lt;= 1)
+            goto alert_loser;


That makes the checking a little more robust for DHE as a result, though still not actually correct.  Here I'm assuming that the check on length is merely a sanity check and that we do a proper check somewhere else.
 
<span class="quote">&gt; Or is the input parameter type the only difference? In that case, perhaps
&gt; you can rename the function to be more general, such as
&gt; &quot;SECKEY_BigIntegerBits&quot;.</span >

The input parameter is an important difference, yes.

<span class="quote">&gt; ::: lib/cryptohi/seckey.c
&gt; &#64;&#64; +949,5 &#64;&#64;
&gt; &gt; +    unsigned octets;
&gt; &gt; +    unsigned bits;
&gt; &gt; +
&gt; &gt; +    if (!number || !number-&gt;data) {
&gt; &gt; +        PORT_SetError(SEC_ERROR_INVALID_KEY);
&gt; 
&gt; Should we also check || number-&gt;len == 0 ?</span >

Well, given the more generic name now, I think that we can let the function simply report 0 bits in that case.

<span class="quote">&gt; &#64;&#64; +955,5 &#64;&#64;
&gt; &gt; +    }
&gt; &gt; +
&gt; &gt; +    p = number-&gt;data;
&gt; &gt; +    octets = number-&gt;len;
&gt; &gt; +    while (!*p &amp;&amp; octets &gt; 0) {
&gt; 
&gt; IMPORTANT: we need to check these in the reverse order, otherwise we may
&gt; read one byte beyond the end of the buffer. This should read:
&gt; 
&gt;   while (octets &gt; 0 &amp;&amp; !*p) {</span >

Oops.

<span class="quote">&gt; &#64;&#64; +963,5 &#64;&#64;
&gt; &gt; +    if (octets == 0) {
&gt; &gt; +        return 0;
&gt; &gt; +    }
&gt; &gt; +    /* bits = 7..1 because we know at least one bit is set already */
&gt; &gt; +    for (bits = 7; bits &gt; 0; --bits) {
&gt; 
&gt; There is a trick to do this using binary search. Since a properly generated
&gt; key should have the most significant bit set, this for loop should exit in
&gt; the first iteration. So it doesn't seem necessary to use the binary search
&gt; trick.</span >

I looked at the binary search and it's a little complex to set up.  And I came to the same conclusion you did regarding performance.
 
<span class="quote">&gt; &#64;&#64; +975,5 &#64;&#64;
&gt; &gt;  /* returns key strength in bytes (not bits) */
&gt; &gt;  unsigned
&gt; &gt;  SECKEY_PublicKeyStrength(const SECKEYPublicKey *pubk)
&gt; &gt;  {
&gt; &gt; +    return (SECKEY_PublicKeyStrengthInBits(pubk) + 7) / 8;
&gt; 
&gt; I like your changes to these two functions. However, the change to
&gt; SECKEY_PublicKeyStrengthInBits may break code that assumes it always return
&gt; a multiple of 8 for RSA, DSA, and DH keys. I think that is very unlikely
&gt; though.</span >

I thought the same.  I think that this is worth adding to the release notes.  Firefox assumes that these functions are doing the right thing, as most other users will, I expect.

<span class="quote">&gt; ::: lib/ssl/ssl3con.c
&gt; &#64;&#64; +6660,5 &#64;&#64;
&gt; &gt;  	    goto loser;		/* malformed. */
&gt; &gt;  	}
&gt; &gt; +        if (SECKEY_ModulusLengthBits(&amp;modulus) &lt; SECKEY_MIN_MODP_PRIME_BITS) {
&gt; &gt; +            errCode = SSL_ERROR_WEAK_SERVER_RSA_KEY;
&gt; &gt; +            desc = insufficient_security;
&gt; 
&gt; The insufficient_security alert was added in TLS 1.0. So we need an
&gt; alternative for SSL 3.0.</span >

Another reason for me to want to kill SSL 3.0 support.  I've chosen illegal_parameter here.  I couldn't see a better choice.  Correctness in SSL 3.0 when it comes to error reporting isn't a high priority.

<span class="quote">&gt; &#64;&#64; +10058,5 &#64;&#64;
&gt; &gt;  	    ss-&gt;sec.keaKeyBits = ss-&gt;sec.authKeyBits =
&gt; &gt;  		SECKEY_PublicKeyStrengthInBits(pubKey);
&gt; &gt; +            /* Too small: not good enough. Send a fatal alert. */
&gt; &gt; +            if (ss-&gt;sec.keaKeyBits &lt; SECKEY_MIN_MODP_PRIME_BITS) {
&gt; &gt; +                PORT_SetError(SSL_ERROR_WEAK_SERVER_RSA_KEY);
&gt; 
&gt; How do you know the key is an RSA key?</span >

I'll check the signtype on the kea_def.  I realize that this would have failed the tests for that other bug, had I run them over this patch.

<span class="quote">&gt; &#64;&#64; +10059,5 &#64;&#64;
&gt; &gt;  		SECKEY_PublicKeyStrengthInBits(pubKey);
&gt; &gt; +            /* Too small: not good enough. Send a fatal alert. */
&gt; &gt; +            if (ss-&gt;sec.keaKeyBits &lt; SECKEY_MIN_MODP_PRIME_BITS) {
&gt; &gt; +                PORT_SetError(SSL_ERROR_WEAK_SERVER_RSA_KEY);
&gt; &gt; +                (void)SSL3_SendAlert(ss, alert_fatal, insufficient_security);
&gt; 
&gt; We need a different alert for SSL 3.0.</span >

Boo.

<span class="quote">&gt; &#64;&#64; +10067,1 &#64;&#64;
&gt; &gt;  #ifndef NSS_DISABLE_ECC
&gt; 
&gt; IMPORTANT: please check this block of code, which adjusts ss-&gt;sec.authKeyBit
&gt; (initialized on lines 10058-10059). Please make sure it doesn't undo the
&gt; improvement you made to SECKEY_PublicKeyStrengthInBits(pubKey);</span >

Well, it only affects ECDH certificates, of which there are approximately none, so it doesn't make things worse.  That said, it could use a little fixing up.  The only question is whether it's worthwhile.

I just spent quite a while trying to work out how to do that properly.  The best method I could think of is below: get the certificate issuer, then to extract the issuer public key and call SECKEY_PublicKeyStrengthInBits on that.  I'm not that confident about getting that code right though.  What do you think?

/* Static ECDH suites carry parameters in the certificate and 
 * are therefore authenticated by the strength of their issuer. */
if ((ss-&gt;ssl3.hs.kea_def-&gt;kea == kea_ecdh_ecdsa ||
     ss-&gt;ssl3.hs.kea_def-&gt;kea == kea_ecdh_rsa) &amp;&amp;
    !cert-&gt;isRoot) {
    CERTCertificate *issuerCert = CERT_FindCertIssuer(subjectCert, PR_Now(), certUsageAnyCA);
    SECKEYPublicKey *issuerPublicKey = CERT_ExtractPublicKey(cert);
    ss-&gt;sec.authKeyBits = SECKEY_PublicKeyStrengthInBits(issuerPublicKey);
    CERT_DestroyCertificate(issuerCert);
}

I'm operating outside of my comfort zone here.  The original code is obviously extremely hacky.</pre></div><div class="change-set" id="c34"><div class="comment" data-id="10118083" data-no="34"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-34" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a107275_14661"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a107275_14661"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-34"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-34" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c34">Comment 34</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-03 17:11 PDT" data-time="1428106300">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-34">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8588235"
         class="attachment patch obsolete"
         data-id="8588235" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1138554-1.patch">
      <meta itemprop="contentSize" content="13680">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8588235">
          <a class="link" href="attachment.cgi?id=8588235&amp;action=diff">
        <span id="att-8588235-description" itemprop="description">bug1138554-1.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8588235&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1138554&attachment=8588235">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-34" data-comment-id="10118083">r=wtc</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8581044&amp;action=edit"
           title="bug1138554.patch"
           class=""
        >Attachment #8581044</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8588235&amp;action=edit"
           title="bug1138554-1.patch"
           class=""
        >Attachment #8588235</a> -
        Flags: review+</div></div></div><div class="change-set" id="c35"><div class="comment" data-id="10118087" data-no="35"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-35" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a107275_14661"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a107275_14661"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-35"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-35" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c35">Comment 35</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-03 17:12 PDT" data-time="1428106331">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-35">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8588236"
         class="attachment patch obsolete"
         data-id="8588236" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1138554-2.patch">
      <meta itemprop="contentSize" content="2855">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8588236">
          <a class="link" href="attachment.cgi?id=8588236&amp;action=diff">
        <span id="att-8588236-description" itemprop="description">bug1138554-2.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8588236&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1138554&attachment=8588236">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-35" data-comment-id="10118087">This is the bit that I'm not so sure about.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8588236&amp;action=edit"
           title="bug1138554-2.patch"
           class=""
        >Attachment #8588236</a> -
        Flags: review?(wtc)</div></div></div><div class="change-set" id="c36"><div class="comment" data-id="10121683" data-no="36"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-36" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a107275_14661"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a107275_14661"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-36"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-36" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c36">Comment 36</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-06 10:18 PDT" data-time="1428340695">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-36">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8588644"
         class="attachment patch obsolete"
         data-id="8588644" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1138554-2.patch">
      <meta itemprop="contentSize" content="3029">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8588644">
          <a class="link" href="attachment.cgi?id=8588644&amp;action=diff">
        <span id="att-8588644-description" itemprop="description">bug1138554-2.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8588644&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1138554&attachment=8588644">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-36" data-comment-id="10121683">Updated to actually check return status on the different functions.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8588236&amp;action=edit"
           title="bug1138554-2.patch"
           class=""
        >Attachment #8588236</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8588236&amp;action=edit"
           title="bug1138554-2.patch"
           class=""
        >Attachment #8588236</a> -
        Flags: <span class="activity-deleted">review?(wtc)</span></div><div class="change">
        <a href="/attachment.cgi?id=8588644&amp;action=edit"
           title="bug1138554-2.patch"
           class=""
        >Attachment #8588644</a> -
        Flags: review?(wtc)</div></div></div><div class="change-set" id="c37"><div class="comment" data-id="10122194" data-no="37"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-37" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1584" id="a107275_14661"><img src="https://secure.gravatar.com/avatar/3e0b23cde901a6405f541eed3973331c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1584" id="a107275_14661"><a class="email " href="/user_profile?user_id=1584" > <span class="fna">Wan-Teh Chang</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-37"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-37" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c37">Comment 37</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-06 12:04 PDT" data-time="1428347049">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-37">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-37" data-comment-id="10122194">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8588235" name="attach_8588235" title="bug1138554-1.patch">attachment 8588235</a> <a href="/attachment.cgi?id=8588235&amp;action=edit" title="bug1138554-1.patch">[details]</a> <a href="/attachment.cgi?id=8588235&amp;action=diff" title="bug1138554-1.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1138554&amp;attachment=8588235'>[review]</a>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS accepts export-length DHE keys with regular DHE cipher suites (&quot;Logjam&quot;)"
   href="/show_bug.cgi?id=1138554">bug1138554</a>-1.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8588235" name="attach_8588235" title="bug1138554-1.patch">attachment 8588235</a> <a href="/attachment.cgi?id=8588235&amp;action=edit" title="bug1138554-1.patch">[details]</a> <a href="/attachment.cgi?id=8588235&amp;action=diff" title="bug1138554-1.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1138554&amp;attachment=8588235'>[review]</a>:
-----------------------------------------------------------------

r=wtc. I suggest some changes. Please note the comments marked with &quot;IMPORTANT&quot;. Arguably even those are minor issues, but I think we should handle them correctly.

::: lib/cryptohi/keythi.h
&#64;&#64; +57,5 &#64;&#64;
<span class="quote">&gt; +/* This sets a limit on the DH or RSA modulus that we are OK with accepting.
&gt; + * This allows for moduli that were previously (incorrectly) counted as being
&gt; + * 1024 bits long because a bit in the most significant byte was set.
&gt; + */
&gt; +#define SECKEY_MIN_MODP_PRIME_BITS 1017</span >

This macro name isn't appropriate if we also use it with an RSA modulus because an RSA modulus is not a prime number. Please try to come with a neutral name that would work with both DH and RSA. Perhaps SECKEY_MIN_MODULUS_BITS?

It just occurred to me that we usually define such MIN/MAX constants in blapit.h. In particular, see <a rel="nofollow" href="http://mxr.mozilla.org/nss/source/lib/freebl/blapit.h#137">http://mxr.mozilla.org/nss/source/lib/freebl/blapit.h#137</a>

Please take a look and see it would be more appropriate to move this macro to blapit.h, or perhaps just increase the existing RSA_MIN_MODULUS_BITS and DH_MIN_P_BITS values to 1017.

::: lib/ssl/ssl3con.c
&#64;&#64; +6641,5 &#64;&#64;
<span class="quote">&gt;      	rv = ssl3_ConsumeHandshakeVariable(ss, &amp;modulus, 2, &amp;b, &amp;length);
&gt;      	if (rv != SECSuccess) {
&gt;  	    goto loser;		/* malformed. */
&gt;  	}
&gt; +        if (SECKEY_BigIntegerBitLength(&amp;modulus) &lt; SECKEY_MIN_MODP_PRIME_BITS) {</span >

IMPORTANT: for RSA keys, I believe this check is wrong because the temporary RSA keys should be 512 bits. See TLS 1.0 (RFC 2246) Appendix D.1: <a rel="nofollow" href="https://tools.ietf.org/html/rfc2246#appendix-D.1">https://tools.ietf.org/html/rfc2246#appendix-D.1</a>

I believe this RSA key size check should be performed in ssl3_HandleCertificate() instead.

&#64;&#64; +6733,5 &#64;&#64;
<span class="quote">&gt;  	SECItem          dh_g      = {siBuffer, NULL, 0};
&gt;  	SECItem          dh_Ys     = {siBuffer, NULL, 0};
&gt; +        unsigned dh_p_bits;
&gt; +        unsigned dh_g_bits;
&gt; +        unsigned dh_Ys_bits;</span >

Nit: these three can be combined into the same variable. I guess the compiler will do this for us?

&#64;&#64; +6748,5 &#64;&#64;
<span class="quote">&gt;      	rv = ssl3_ConsumeHandshakeVariable(ss, &amp;dh_g, 2, &amp;b, &amp;length);
&gt;      	if (rv != SECSuccess) {
&gt;  	    goto loser;		/* malformed. */
&gt;  	}
&gt; +        /* Check if dh_g is 1 or 0, or obviously too big. */</span >

Nit: reverse this comment to match the two checks on line 6754.

&#64;&#64; +10049,5 &#64;&#64;
<span class="quote">&gt; +            /* Too small: not good enough. Send a fatal alert. */
&gt; +            if ((ss-&gt;ssl3.hs.kea_def-&gt;signKeyType == sign_rsa ||
&gt; +                 ss-&gt;ssl3.hs.kea_def-&gt;signKeyType == sign_dsa) &amp;&amp;
&gt; +                ss-&gt;sec.keaKeyBits &lt; SECKEY_MIN_MODP_PRIME_BITS) {
&gt; +                PORT_SetError(SSL_ERROR_WEAK_SERVER_RSA_KEY);</span >

IMPORTANT: this error code is wrong for the ss-&gt;ssl3.hs.kea_def-&gt;signKeyType == sign_dsa case.

We can either add a SSL_ERROR_WEAK_SERVER_DSA_KEY error code, or just add a generic SSL_ERROR_WEAK_SERVER_CERTIFICATE_KEY error code that applies to RSA, DSA, and ECDSA public keys in server certificates.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8588235&amp;action=edit"
           title="bug1138554-1.patch"
           class=""
        >Attachment #8588235</a> -
        Flags: review+</div></div></div><div class="change-set" id="c38"><div class="comment" data-id="10122414" data-no="38"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-38" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a107275_14661"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a107275_14661"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-38"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-38" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c38">Comment 38</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-06 12:50 PDT" data-time="1428349800">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-38">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-38" data-comment-id="10122414">Thanks Wan-Teh.

(In reply to Wan-Teh Chang from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS accepts export-length DHE keys with regular DHE cipher suites (&quot;Logjam&quot;)"
   href="/show_bug.cgi?id=1138554#c37">comment #37</a>)
<span class="quote">&gt; Please take a look and see it would be more appropriate to move this macro
&gt; to blapit.h, or perhaps just increase the existing RSA_MIN_MODULUS_BITS and
&gt; DH_MIN_P_BITS values to 1017.</span >

Hmm, I think that is the right way to do this.  DH_MIN_P_BITS isn't currently used, but this can correct that.

The RSA one is used for things like keygen.  That means that we won't be able to generate the keys needed for export-strength suites.  That's OK with me, but it means that we won't be able to act as a server for the rsa_1024 export cipher, since we'd be preventing the generation of the 512-bit ephemeral key.

For the record, I'm quite happy to break export modes.

<span class="quote">&gt; ::: lib/ssl/ssl3con.c
&gt; &gt; +        if (SECKEY_BigIntegerBitLength(&amp;modulus) &lt; SECKEY_MIN_MODP_PRIME_BITS) {
&gt; 
&gt; IMPORTANT: for RSA keys, I believe this check is wrong because the temporary
&gt; RSA keys should be 512 bits. See TLS 1.0 (RFC 2246) Appendix D.1:
&gt; <a rel="nofollow" href="https://tools.ietf.org/html/rfc2246#appendix-D.1">https://tools.ietf.org/html/rfc2246#appendix-D.1</a></span >

You are right; this effectively makes US export compliance impossible.  The crazy-person that turns on those suites is already operating well outside the recommended parameters.

I think that I might just reduce this specific limit with 512, but replace it with a nice little banner that explains that export RSA is a hazard.
 
<span class="quote">&gt; I believe this RSA key size check should be performed in
&gt; ssl3_HandleCertificate() instead.</span >

ssl3_AuthCertificate() (which is called from ssl3_HandleCertificate) already has this check in place.  The limit here only affects the ephemeral exchange, which in effect disables export compatibility.

<span class="quote">&gt; &#64;&#64; +6733,5 &#64;&#64;
&gt; &gt; +        unsigned dh_p_bits;
&gt; &gt; +        unsigned dh_g_bits;
&gt; &gt; +        unsigned dh_Ys_bits;
&gt; 
&gt; Nit: these three can be combined into the same variable. I guess the
&gt; compiler will do this for us?</span >

Both are compared to dh_p_bits so you need two at least.  I considered compressing dh_g_bits and dh_Ys_bits, but it seemed less obvious that way.  

<span class="quote">&gt; &#64;&#64; +10049,5 &#64;&#64;
&gt; &gt; +            /* Too small: not good enough. Send a fatal alert. */
&gt; &gt; +            if ((ss-&gt;ssl3.hs.kea_def-&gt;signKeyType == sign_rsa ||
&gt; &gt; +                 ss-&gt;ssl3.hs.kea_def-&gt;signKeyType == sign_dsa) &amp;&amp;
&gt; &gt; +                ss-&gt;sec.keaKeyBits &lt; SECKEY_MIN_MODP_PRIME_BITS) {
&gt; &gt; +                PORT_SetError(SSL_ERROR_WEAK_SERVER_RSA_KEY);
&gt; 
&gt; IMPORTANT: this error code is wrong for the ss-&gt;ssl3.hs.kea_def-&gt;signKeyType
&gt; == sign_dsa case.
&gt; 
&gt; We can either add a SSL_ERROR_WEAK_SERVER_DSA_KEY error code, or just add a
&gt; generic SSL_ERROR_WEAK_SERVER_CERTIFICATE_KEY error code that applies to
&gt; RSA, DSA, and ECDSA public keys in server certificates.</span >

I think that the latter works out fine.  I don't think that being specific provides any particular advantage here.</pre></div><div class="change-set" id="c39"><div class="comment" data-id="10122471" data-no="39"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-39" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a107275_14661"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a107275_14661"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-39"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-39" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c39">Comment 39</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-06 13:01 PDT" data-time="1428350509">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-39">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-39" data-comment-id="10122471">OK, I just tested this out.  Turns out that setting RSA_MIN_MODULUS_BITS to 1023 causes the default configuration to break.  The default setup creates a 512-bit &quot;step down&quot; key in ssl_ConfigSecureServer().  That fails with a higher minimum.

I'm not really looking to embark upon a purge of export cipher suites for just this little change.

I see a couple of options:
A. Another #define for the *real* RSA modulus minimum.
B. Change the default for ss-&gt;opt.noStepDown
C. Generate a 1024-bit &quot;step down&quot; key.
D. Start a partial removal of export cipher suites.

I'm inclined to choose B, but D is looking quite attractive.</pre></div><div class="change-set" id="c40"><div class="comment" data-id="10122802" data-no="40"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-40" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1584" id="a107275_14661"><img src="https://secure.gravatar.com/avatar/3e0b23cde901a6405f541eed3973331c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1584" id="a107275_14661"><a class="email " href="/user_profile?user_id=1584" > <span class="fna">Wan-Teh Chang</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-40"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-40" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c40">Comment 40</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-06 14:03 PDT" data-time="1428354184">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-40">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-40" data-comment-id="10122802">Martin: thanks a lot for looking into this. We should not do C.
I didn't mean to make you do a lot of work. It seems that we
should immediately increase RSA_MIN_MODULUS_BITS from 128 to
at least 512. In ssl3con.c, we can consider using the number
1017 directly or add a new macro for the RSA modulus minimum
outside freebl until we have removed the export ciphersuites.</pre></div><div class="change-set" id="c41"><div class="comment" data-id="10123331" data-no="41"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-41" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1584" id="a107275_14661"><img src="https://secure.gravatar.com/avatar/3e0b23cde901a6405f541eed3973331c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1584" id="a107275_14661"><a class="email " href="/user_profile?user_id=1584" > <span class="fna">Wan-Teh Chang</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-41"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-41" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c41">Comment 41</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-06 16:04 PDT" data-time="1428361486">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-41">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-41" data-comment-id="10123331">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8588644" name="attach_8588644" title="bug1138554-2.patch">attachment 8588644</a> <a href="/attachment.cgi?id=8588644&amp;action=edit" title="bug1138554-2.patch">[details]</a> <a href="/attachment.cgi?id=8588644&amp;action=diff" title="bug1138554-2.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1138554&amp;attachment=8588644'>[review]</a>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS accepts export-length DHE keys with regular DHE cipher suites (&quot;Logjam&quot;)"
   href="/show_bug.cgi?id=1138554">bug1138554</a>-2.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8588644" name="attach_8588644" title="bug1138554-2.patch">attachment 8588644</a> <a href="/attachment.cgi?id=8588644&amp;action=edit" title="bug1138554-2.patch">[details]</a> <a href="/attachment.cgi?id=8588644&amp;action=diff" title="bug1138554-2.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1138554&amp;attachment=8588644'>[review]</a>:
-----------------------------------------------------------------

This seems correct, but I am worried that the CERT_FindCertIssuer() call may not work well. But I don't have a good suggestion.

::: lib/ssl/ssl3con.c
&#64;&#64; +10060,5 &#64;&#64;
<span class="quote">&gt;              }
&gt;  #ifndef NSS_DISABLE_ECC
&gt; +            /* Static ECDH suites carry parameters in the certificate and
&gt; +             * are therefore authenticated by the strength of their issuer. */
&gt; +            if (ss-&gt;sec.keaType == kt_ecdh &amp;&amp; !cert-&gt;isRoot &amp;&amp;</span >

1. I think we can omit the ss-&gt;sec.keaType == kt_ecdh check because it is redundant with (ss-&gt;ssl3.hs.kea_def-&gt;kea == kea_ecdh_ecdsa || ss-&gt;ssl3.hs.kea_def-&gt;kea == kea_ecdh_rsa).

2. Why do we need to check !cert-&gt;isRoot? We don't verify root certificates.

UPDATE: I guess this is to short-circuit the CERT_FindCertIssuer() call?

&#64;&#64; +10064,5 &#64;&#64;
<span class="quote">&gt; +            if (ss-&gt;sec.keaType == kt_ecdh &amp;&amp; !cert-&gt;isRoot &amp;&amp;
&gt; +                (ss-&gt;ssl3.hs.kea_def-&gt;kea == kea_ecdh_ecdsa ||
&gt; +                 ss-&gt;ssl3.hs.kea_def-&gt;kea == kea_ecdh_rsa)) {
&gt; +                CERTCertificate *issuerCert =
&gt; +                    CERT_FindCertIssuer(cert, PR_Now(), certUsageAnyCA);</span >

IMPORTANT: this requires more thought. CERT_FindCertIssuer() uses a naive way to find the issuer certificate. It doesn't do proper certification path construction. Do you know if that matters here?

&#64;&#64; +10074,5 &#64;&#64;
<span class="quote">&gt; +                            SECKEY_PublicKeyStrengthInBits(issuerPublicKey);
&gt; +                        SECKEY_DestroyPublicKey(issuerPublicKey);
&gt; +                    }
&gt; +                }
&gt; +                CERT_DestroyCertificate(issuerCert);</span >

IMPORTANT: move this inside the &quot;if (issuerCert)&quot; block.</pre></div><div class="change-set" id="c42"><div class="comment" data-id="10123457" data-no="42"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-42" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a107275_14661"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a107275_14661"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-42"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-42" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c42">Comment 42</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-06 17:01 PDT" data-time="1428364863">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-42">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-42" data-comment-id="10123457">Thanks Wan-Teh.

I think that CERT_FindCertIssuer() is probably OK; this is only to update the auth bit count.

Checking isRoot avoids the need to look for an issuer, which would only fail.  We get that all the time with WebRTC (though we don't use static ECDH certs.

BTW, I didn't add a macro, just a bare 1023 and a big warning sticker on it.</pre></div><div class="change-set" id="c43"><div class="comment" data-id="10127770" data-no="43"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-43" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a107275_14661"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a107275_14661"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-43"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-43" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c43">Comment 43</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-07 13:25 PDT" data-time="1428438317">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-43">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8589276"
         class="attachment patch obsolete"
         data-id="8589276" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1138554.patch">
      <meta itemprop="contentSize" content="16374">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8589276">
          <a class="link" href="attachment.cgi?id=8589276&amp;action=diff">
        <span id="att-8589276-description" itemprop="description">bug1138554.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8589276&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1138554&attachment=8589276">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-43" data-comment-id="10127770">I rolled the patches together.  Interdiff coming if you'd prefer to see only that.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8588235&amp;action=edit"
           title="bug1138554-1.patch"
           class=""
        >Attachment #8588235</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8588644&amp;action=edit"
           title="bug1138554-2.patch"
           class=""
        >Attachment #8588644</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8588644&amp;action=edit"
           title="bug1138554-2.patch"
           class=""
        >Attachment #8588644</a> -
        Flags: <span class="activity-deleted">review?(wtc)</span></div><div class="change">
        <a href="/attachment.cgi?id=8589276&amp;action=edit"
           title="bug1138554.patch"
           class=""
        >Attachment #8589276</a> -
        Flags: review?(wtc)</div></div></div><div class="change-set" id="c44"><div class="comment" data-id="10127772" data-no="44"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-44" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a107275_14661"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a107275_14661"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-44"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-44" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c44">Comment 44</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-07 13:25 PDT" data-time="1428438340">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-44">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8589277"
         class="attachment obsolete"
         data-id="8589277" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="interdiff.txt">
      <meta itemprop="contentSize" content="4409">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=8589277" itemprop="contentUrl">
        <span id="att-8589277-description" itemprop="description">interdiff.txt</span></a> (obsolete)
        — <a href="attachment.cgi?id=8589277&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-44" data-comment-id="10127772">Only the changes from the last round.</pre></div><div class="change-set" id="c45"><div class="comment" data-id="10128146" data-no="45"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-45" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1584" id="a107275_14661"><img src="https://secure.gravatar.com/avatar/3e0b23cde901a6405f541eed3973331c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1584" id="a107275_14661"><a class="email " href="/user_profile?user_id=1584" > <span class="fna">Wan-Teh Chang</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-45"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-45" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c45">Comment 45</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-07 14:38 PDT" data-time="1428442701">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-45">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-45" data-comment-id="10128146">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8589276" name="attach_8589276" title="bug1138554.patch">attachment 8589276</a> <a href="/attachment.cgi?id=8589276&amp;action=edit" title="bug1138554.patch">[details]</a> <a href="/attachment.cgi?id=8589276&amp;action=diff" title="bug1138554.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1138554&amp;attachment=8589276'>[review]</a>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS accepts export-length DHE keys with regular DHE cipher suites (&quot;Logjam&quot;)"
   href="/show_bug.cgi?id=1138554">bug1138554</a>.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8589276" name="attach_8589276" title="bug1138554.patch">attachment 8589276</a> <a href="/attachment.cgi?id=8589276&amp;action=edit" title="bug1138554.patch">[details]</a> <a href="/attachment.cgi?id=8589276&amp;action=diff" title="bug1138554.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1138554&amp;attachment=8589276'>[review]</a>:
-----------------------------------------------------------------

This seems correct. I have two comments.

::: lib/freebl/blapit.h
&#64;&#64; +180,5 &#64;&#64;
<span class="quote">&gt;   */
&gt;  
&gt;  #define DSA1_Q_BITS      160
&gt;  #define DSA_MAX_P_BITS	3072
&gt; +#define DSA_MIN_P_BITS  1023</span >

This can be 1024 because only a few discrete DSA key sizes are specified.

::: lib/ssl/ssl3con.c
&#64;&#64; +10053,5 &#64;&#64;
<span class="quote">&gt; +             * RSA_MIN_MODULUS_BITS and use that here. */
&gt; +            if ((ss-&gt;ssl3.hs.kea_def-&gt;signKeyType == sign_rsa &amp;&amp;
&gt; +                 ss-&gt;sec.keaKeyBits &lt; 1023) ||
&gt; +                (ss-&gt;ssl3.hs.kea_def-&gt;signKeyType == sign_dsa &amp;&amp;
&gt; +                 ss-&gt;sec.keaKeyBits &lt; DSA_MIN_P_BITS)) {</span >

It seems that we should not need to check the certificate's public key size here. The ss-&gt;authCertificate callback is supposed to check the certificate's key size. Are we trying to enforce an NSS minimum? If we are, then we also need to check ECDSA key size, and we should do the certificate key size checks after the static ECDH adjustment below.

Note that freebl will also perform minimum key size checks.

&#64;&#64; +10069,5 &#64;&#64;
<span class="quote">&gt; +            if (!cert-&gt;isRoot &amp;&amp;
&gt; +                (ss-&gt;ssl3.hs.kea_def-&gt;kea == kea_ecdh_ecdsa ||
&gt; +                 ss-&gt;ssl3.hs.kea_def-&gt;kea == kea_ecdh_rsa)) {
&gt; +                CERTCertificate *issuerCert =
&gt; +                    CERT_FindCertIssuer(cert, PR_Now(), certUsageAnyCA);</span >

I think we should use certUsageSSLServer instead of certUsageAnyCA here.

If you trace the code of SSL_AuthCertificate:
<a rel="nofollow" href="http://mxr.mozilla.org/mozilla-central/ident?i=SSL_AuthCertificate">http://mxr.mozilla.org/mozilla-central/ident?i=SSL_AuthCertificate</a>

the call chain goes through CERT_VerifyCert, cert_VerifyCertWithFlags, CERT_VerifyCertChain, cert_VerifyCertChain, cert_VerifyCertChainOld, eventually you will arrive at this CERT_FindCertIssuer call:

<a rel="nofollow" href="http://mxr.mozilla.org/mozilla-central/source/security/nss/lib/certhigh/certvfy.c#449">http://mxr.mozilla.org/mozilla-central/source/security/nss/lib/certhigh/certvfy.c#449</a>

449 	/* find the certificate of the issuer */
450 	issuerCert = CERT_FindCertIssuer(subjectCert, t, certUsage);

So, SSL_AuthCertificate passes certUsageSSLServer to CERT_FindCertIssuer. We should emulate that here.</pre></div><div class="change-set" id="c46"><div class="comment" data-id="10128345" data-no="46"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-46" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a107275_14661"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a107275_14661"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-46"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-46" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c46">Comment 46</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-07 15:15 PDT" data-time="1428444923">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-46">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-46" data-comment-id="10128345">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8589276" name="attach_8589276" title="bug1138554.patch">attachment 8589276</a> <a href="/attachment.cgi?id=8589276&amp;action=edit" title="bug1138554.patch">[details]</a> <a href="/attachment.cgi?id=8589276&amp;action=diff" title="bug1138554.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1138554&amp;attachment=8589276'>[review]</a>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS accepts export-length DHE keys with regular DHE cipher suites (&quot;Logjam&quot;)"
   href="/show_bug.cgi?id=1138554">bug1138554</a>.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8589276" name="attach_8589276" title="bug1138554.patch">attachment 8589276</a> <a href="/attachment.cgi?id=8589276&amp;action=edit" title="bug1138554.patch">[details]</a> <a href="/attachment.cgi?id=8589276&amp;action=diff" title="bug1138554.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1138554&amp;attachment=8589276'>[review]</a>:
-----------------------------------------------------------------

I didn't check the whole patch, but I have a comment on one part, after reading Wan-Teh mention CERT_FindCertIssuer.

::: lib/ssl/ssl3con.c
&#64;&#64; +10069,5 &#64;&#64;
<span class="quote">&gt; +            if (!cert-&gt;isRoot &amp;&amp;
&gt; +                (ss-&gt;ssl3.hs.kea_def-&gt;kea == kea_ecdh_ecdsa ||
&gt; +                 ss-&gt;ssl3.hs.kea_def-&gt;kea == kea_ecdh_rsa)) {
&gt; +                CERTCertificate *issuerCert =
&gt; +                    CERT_FindCertIssuer(cert, PR_Now(), certUsageAnyCA);</span >

This change may be best done in a separate bug.

Note that calling CERT_FindCertIssuer here is generally a bad thing to do, because CERT_FindCertIssuer is generally not smart enough like libpkix, mozilla::pkix, etc. are. It's OK as far as Gecko is concerned, currently, because Gecko doesn't use these cipher suites. But, I don't think it's good to add new calls to CERT_FindCertIssuer to libssl when we're supposed to be excising them.

More generally, I disagree with the whole premise of the logic here. authKeyBits should be the size of the ECDH key, not the size of the issuer's key. authKeyBits is &quot;assuming the end-end certificate is valid, how strong is the authentication of this handshake?&quot; In ECDH key exchange, the only asymmetric key uesd for authenticate is the ECDH key.

Obviously, our trust in a particular end-entity's key is limited by your trust in the issuer's key. But, that kind of transitive trust in crypto parameters isn't what authKeySize is used for in applications.

I suggest, instead, that we just set authKeyBits to keaKeyBits for these cipher suites.</pre></div><div class="change-set" id="c47"><div class="comment" data-id="10128391" data-no="47"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-47" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a107275_14661"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a107275_14661"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-47"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-47" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c47">Comment 47</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-07 15:22 PDT" data-time="1428445374">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-47">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-47" data-comment-id="10128391">Karthikeyan, Matthew,

Do you (still) think that 1024 bits is sufficient for this change? The impression I got from your recent email is that you *don't* think 1024 is a sufficient limit. I am also doubting that 1024 bits is generally sufficient.

In my comments above, I suggested that it might be better to do this gradually, increasing the limit to 768 bits and then to 1024 bits. That is because I didn't understand at that time that the problem is more general than the fact that export-sized parameters are accepted. Thanks to Karthikeyan for clarifying my understanding on that.

I think this change should land, but I also think that it is time to disable the TLS_DHE_* cipher suites in Firefox and probably in NSS by default, considering a 1024-bit minimum seems insufficient but any minimum higher than that will have big compatibility problems.</pre><div class="activity"><div class="change">Flags: needinfo?(matthewdgreen)</div><div class="change">Flags: needinfo?(karthikeyan.bhargavan)</div><div class="change">OS: Mac OS X &rarr; All</div><div class="change">Hardware: x86 &rarr; All</div><div class="change">Target Milestone: --- &rarr; 3.18</div><div class="change">Version: 3.18 &rarr; trunk</div></div></div><div class="change-set" id="c48"><div class="comment" data-id="10128404" data-no="48"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-48" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a107275_14661"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a107275_14661"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-48"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-48" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c48">Comment 48</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-07 15:24 PDT" data-time="1428445485">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-48">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-48" data-comment-id="10128404">(In reply to Brian Smith (:briansmith, :bsmith, use NEEDINFO?) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS accepts export-length DHE keys with regular DHE cipher suites (&quot;Logjam&quot;)"
   href="/show_bug.cgi?id=1138554#c46">comment #46</a>)
<span class="quote">&gt; I suggest, instead, that we just set authKeyBits to keaKeyBits for these
&gt; cipher suites.</span >

That is something that I can do easily.  Delete the whole mess.</pre></div><div class="change-set" id="c49"><div class="comment" data-id="10128455" data-no="49"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-49" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a107275_14661"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a107275_14661"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-49"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-49" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c49">Comment 49</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-07 15:34 PDT" data-time="1428446049">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-49">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-49" data-comment-id="10128455">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8589276" name="attach_8589276" title="bug1138554.patch">attachment 8589276</a> <a href="/attachment.cgi?id=8589276&amp;action=edit" title="bug1138554.patch">[details]</a> <a href="/attachment.cgi?id=8589276&amp;action=diff" title="bug1138554.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1138554&amp;attachment=8589276'>[review]</a>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS accepts export-length DHE keys with regular DHE cipher suites (&quot;Logjam&quot;)"
   href="/show_bug.cgi?id=1138554">bug1138554</a>.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8589276" name="attach_8589276" title="bug1138554.patch">attachment 8589276</a> <a href="/attachment.cgi?id=8589276&amp;action=edit" title="bug1138554.patch">[details]</a> <a href="/attachment.cgi?id=8589276&amp;action=diff" title="bug1138554.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1138554&amp;attachment=8589276'>[review]</a>:
-----------------------------------------------------------------

::: lib/cryptohi/seckey.c
&#64;&#64; +970,5 &#64;&#64;
<span class="quote">&gt; +        if (*p &amp; (1 &lt;&lt; bits)) {
&gt; +            break;
&gt; +        }
&gt; +    }
&gt; +    return octets * 8 + bits - 7;</span >

Again, I didn't read the whole patch, however I read this part.

I suggest that you avoid trying to be so precise here.

We know from previous reports that some certificates have 2047 and 1023 bit keys, according to this type of calculation. I believe it's likely that there are checks within Gecko and probably within other applications that assume (after reading the NSS code) that these key sizes will get rounded up to the next multiple of 8 bits.

Since this change is likely going to get put into an accelerated release, it's better to be conservative here and continue doing the rounding up, to minimize compatibility problems. If you think the added precision is useful (I'm not sure it is) then perhaps that can land in a follow-up change in the very next NSS (pre-)release, where we'll have more time to test it.</pre></div><div class="change-set" id="c50"><div class="comment" data-id="10198445" data-no="50"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-50" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_445246" id="a107275_14661"><img src="https://secure.gravatar.com/avatar/04110fd15242c638565b4b558f003b3e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_445246" id="a107275_14661"><a class="email " href="/user_profile?user_id=445246" > <span class="fna">Karthikeyan Bhargavan</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-50"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-50" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c50">Comment 50</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-04-24 22:19 PDT" data-time="1429939140">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-50">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-50" data-comment-id="10198445">(In reply to Brian Smith (:briansmith, :bsmith, use NEEDINFO?) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS accepts export-length DHE keys with regular DHE cipher suites (&quot;Logjam&quot;)"
   href="/show_bug.cgi?id=1138554#c47">comment #47</a>)
<span class="quote">&gt; Do you (still) think that 1024 bits is sufficient for this change? The
&gt; impression I got from your recent email is that you *don't* think 1024 is a
&gt; sufficient limit. I am also doubting that 1024 bits is generally sufficient.</span >

Our current thinking is that 512 and 768 bit groups are currently broken even 
against modestly powerful adversaries. We have several demonstrations for 512
bit groups and fairly solid estimates for 768 bits. 

We believe that 1024 bit groups are probably broken against state-level adversaries, 
but do not yet have concrete numbers to match this judgement. 

I don't speak for Matthew, but for 1024 bits, I think that the pressing concern is 
that most servers are using very old (hard-coded) groups that may have been broken
with multi-year efforts. Turning off 1024 bits at the client would help, 
but we also need to move servers to stronger groups. 

Moving wholesale from DHE to ECDHE seems attractive, but mainly because
we don't know good attacks on curves just yet. I don't know enough on 
the EC literature to say whether it is just a matter of time before such attacks appear.

On a separate note, we've started notifying all vendors about our disclosure date.
We are submitting our paper to ACM CCS, deadline May 16. We will publish a preprint
paper soon after, so you can expect disclosure during the May 18-22 week.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(karthikeyan.bhargavan)</span></div></div></div><div class="change-set" id="a6138450_438654"><div class="change" id="aa6138450_438654">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a6138450_438654"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_438654" id="a6138450_438654"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a6138450_438654"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a6138450_438654">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#a6138450_438654">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-12 12:19 PDT" data-time="1431458345">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: Embargo until multi-vendor coordinated info release &rarr; Embargo until multi-vendor coordinated info release (May 18)</div></div></div><div class="change-set" id="c51"><div class="comment" data-id="10265060" data-no="51"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-51" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a6138450_438654"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a6138450_438654"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-51"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-51" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c51">Comment 51</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-13 11:28 PDT" data-time="1431541717">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-51">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-51" data-comment-id="10265060">Adding Hubert.  The discussion in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Implement the server-side code of the DHE SSL ciphersuites."
   href="/show_bug.cgi?id=102794">bug 102794</a> is heading dangerously close to this and you need to be aware of the problem.</pre></div><div class="change-set" id="c52"><div class="comment" data-id="10267956" data-no="52"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-52" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_487652" id="a6138450_438654"><img src="https://secure.gravatar.com/avatar/b0fb5a6d4bf1758a9ef4db8f700e3bb4?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_487652" id="a6138450_438654"><a class="email " href="/user_profile?user_id=487652" > <span class="fna">Hubert Kario</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-52"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-52" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c52">Comment 52</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-14 03:49 PDT" data-time="1431600588">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-52">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-52" data-comment-id="10267956">Thanks for including me to it, but I've known about this issue for a long time, it's far from secret. There was even a test site to check your browser for this (<a rel="nofollow" href="https://dh.tlsfun.de/">https://dh.tlsfun.de/</a>), sadly a bit broken now.</pre></div><div class="change-set" id="a6645726_438654"><div class="change" id="aa6645726_438654">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a6645726_438654"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_438654" id="a6645726_438654"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a6645726_438654"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a6645726_438654">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#a6645726_438654">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-18 09:13 PDT" data-time="1431965621">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: Embargo until multi-vendor coordinated info release (May 18) &rarr; Embargo until multi-vendor coordinated info release (May 19)</div></div></div><div class="change-set" id="a6658430_75935"><div class="change" id="aa6658430_75935">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a6658430_75935"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_75935" id="a6658430_75935"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a6658430_75935"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a6658430_75935">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#a6658430_75935">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-18 12:45 PDT" data-time="1431978325">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_2_0&amp;o1=isnotempty">status-b2g-v2.0</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_2_0&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_2_0m&amp;o1=isnotempty">status-b2g-v2.0M</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_2_0m&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_2_1&amp;o1=isnotempty">status-b2g-v2.1</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_2_1&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_2_1_s&amp;o1=isnotempty">status-b2g-v2.1S</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_2_1_s&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_2_2&amp;o1=isnotempty">status-b2g-v2.2</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_2_2&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_master&amp;o1=isnotempty">status-b2g-master</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_master&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox38&amp;o1=isnotempty">status-firefox38</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox38&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox38_0_5&amp;o1=isnotempty">status-firefox38.0.5</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox38_0_5&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox39&amp;o1=isnotempty">status-firefox39</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox39&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox40&amp;o1=isnotempty">status-firefox40</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox40&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox41&amp;o1=isnotempty">status-firefox41</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox41&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr31&amp;o1=isnotempty">status-firefox-esr31</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr31&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr38&amp;o1=isnotempty">status-firefox-esr38</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr38&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">Target Milestone: 3.18 &rarr; 3.19.1</div></div></div><div class="change-set" id="a6658926_438654"><div class="change" id="aa6658926_438654">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a6658926_438654"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_438654" id="a6658926_438654"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a6658926_438654"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a6658926_438654">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#a6658926_438654">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-18 12:53 PDT" data-time="1431978821">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Blocks: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Update to NSS 3.19.1"
   href="/show_bug.cgi?id=1166031">1166031</a></div></div></div><div class="change-set" id="c53"><div class="comment" data-id="10281336" data-no="53"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-53" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a6658926_438654"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a6658926_438654"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-53"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-53" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c53">Comment 53</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-18 12:55 PDT" data-time="1431978928">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-53">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-53" data-comment-id="10281336">Clearing n-i.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(matthewdgreen)</span></div></div></div><div class="change-set" id="c54"><div class="comment" data-id="10285783" data-no="54"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-54" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a6658926_438654"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a6658926_438654"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-54"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-54" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c54">Comment 54</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-19 10:46 PDT" data-time="1432057568">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-54">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8607648"
         class="attachment patch obsolete"
         data-id="8607648" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1138554.patch">
      <meta itemprop="contentSize" content="15497">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8607648">
          <a class="link" href="attachment.cgi?id=8607648&amp;action=diff">
        <span id="att-8607648-description" itemprop="description">bug1138554.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8607648&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1138554&attachment=8607648">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-54" data-comment-id="10285783">I realize that I didn't double-check that we had all the necessary approvals.  And now we don't have a lot of time.

Wan-Teh, are we good to go with this?  Based on <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS accepts export-length DHE keys with regular DHE cipher suites (&quot;Logjam&quot;)"
   href="/show_bug.cgi?id=1138554#c46">comment 46</a>, I've removed the issuer tracing that we were doing for static ECDH.  That should also remove the concerns you raised in your last comment.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8589276&amp;action=edit"
           title="bug1138554.patch"
           class=""
        >Attachment #8589276</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8589277&amp;action=edit"
           title="interdiff.txt"
           class=""
        >Attachment #8589277</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8589276&amp;action=edit"
           title="bug1138554.patch"
           class=""
        >Attachment #8589276</a> -
        Flags: <span class="activity-deleted">review?(wtc)</span></div><div class="change">
        <a href="/attachment.cgi?id=8607648&amp;action=edit"
           title="bug1138554.patch"
           class=""
        >Attachment #8607648</a> -
        Flags: review?(wtc)</div></div></div><div class="change-set" id="c55"><div class="comment" data-id="10286015" data-no="55"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-55" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a6658926_438654"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a6658926_438654"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-55"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-55" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c55">Comment 55</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-19 11:19 PDT" data-time="1432059592">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-55">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-55" data-comment-id="10286015">Good thing I ran a full regression suite this morning.  This change regresses ECDH_RSA suites.  If it weren't for the fact that it took so long, I would have noticed earlier.</pre></div><div class="change-set" id="c56"><div class="comment" data-id="10286068" data-no="56"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-56" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a6658926_438654"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a6658926_438654"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-56"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-56" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c56">Comment 56</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-19 11:28 PDT" data-time="1432060133">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-56">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8607687"
         class="attachment patch obsolete"
         data-id="8607687" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1138554.patch">
      <meta itemprop="contentSize" content="588923">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8607687">
          <a class="link" href="attachment.cgi?id=8607687&amp;action=diff">
        <span id="att-8607687-description" itemprop="description">bug1138554.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8607687&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1138554&attachment=8607687">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-56" data-comment-id="10286068">Apologies for the churn.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8607648&amp;action=edit"
           title="bug1138554.patch"
           class=""
        >Attachment #8607648</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8607648&amp;action=edit"
           title="bug1138554.patch"
           class=""
        >Attachment #8607648</a> -
        Flags: <span class="activity-deleted">review?(wtc)</span></div><div class="change">
        <a href="/attachment.cgi?id=8607687&amp;action=edit"
           title="bug1138554.patch"
           class=""
        >Attachment #8607687</a> -
        Flags: review?(wtc)</div></div></div><div class="change-set" id="c57"><div class="comment" data-id="10287466" data-no="57"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-57" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1584" id="a6658926_438654"><img src="https://secure.gravatar.com/avatar/3e0b23cde901a6405f541eed3973331c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1584" id="a6658926_438654"><a class="email " href="/user_profile?user_id=1584" > <span class="fna">Wan-Teh Chang</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-57"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-57" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c57">Comment 57</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-19 16:41 PDT" data-time="1432078909">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-57">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-57" data-comment-id="10287466">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8607687" name="attach_8607687" title="bug1138554.patch">attachment 8607687</a> <a href="/attachment.cgi?id=8607687&amp;action=edit" title="bug1138554.patch">[details]</a> <a href="/attachment.cgi?id=8607687&amp;action=diff" title="bug1138554.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1138554&amp;attachment=8607687'>[review]</a>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS accepts export-length DHE keys with regular DHE cipher suites (&quot;Logjam&quot;)"
   href="/show_bug.cgi?id=1138554">bug1138554</a>.patch

Martin: can you prepare a version of this patch
that omits the white space changes to ssl3con.c?</pre></div><div class="change-set" id="c58"><div class="comment" data-id="10287511" data-no="58"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-58" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1584" id="a6658926_438654"><img src="https://secure.gravatar.com/avatar/3e0b23cde901a6405f541eed3973331c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1584" id="a6658926_438654"><a class="email " href="/user_profile?user_id=1584" > <span class="fna">Wan-Teh Chang</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-58"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-58" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c58">Comment 58</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-19 16:54 PDT" data-time="1432079676">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-58">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-58" data-comment-id="10287511">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8607687" name="attach_8607687" title="bug1138554.patch">attachment 8607687</a> <a href="/attachment.cgi?id=8607687&amp;action=edit" title="bug1138554.patch">[details]</a> <a href="/attachment.cgi?id=8607687&amp;action=diff" title="bug1138554.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1138554&amp;attachment=8607687'>[review]</a>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS accepts export-length DHE keys with regular DHE cipher suites (&quot;Logjam&quot;)"
   href="/show_bug.cgi?id=1138554">bug1138554</a>.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8607687" name="attach_8607687" title="bug1138554.patch">attachment 8607687</a> <a href="/attachment.cgi?id=8607687&amp;action=edit" title="bug1138554.patch">[details]</a> <a href="/attachment.cgi?id=8607687&amp;action=diff" title="bug1138554.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1138554&amp;attachment=8607687'>[review]</a>:
-----------------------------------------------------------------

::: lib/ssl/ssl3con.c
&#64;&#64; +10052,5 &#64;&#64;
<span class="quote">&gt; +             * break export cipher suites; when those are removed, update
&gt; +             * RSA_MIN_MODULUS_BITS and use that here. */
&gt; +            if ((ss-&gt;ssl3.hs.kea_def-&gt;signKeyType == sign_rsa &amp;&amp;
&gt; +                 ss-&gt;sec.keaKeyBits &lt; 1023 &amp;&amp;
&gt; +                 ss-&gt;ssl3.hs.kea_def-&gt;kea != kea_ecdh_rsa) ||</span >

Why do we need the ss-&gt;ssl3.hs.kea_def-&gt;kea != kea_ecdh_rsa test?

Should we also test for kea_dh_rsa?

&#64;&#64; +10054,5 &#64;&#64;
<span class="quote">&gt; +            if ((ss-&gt;ssl3.hs.kea_def-&gt;signKeyType == sign_rsa &amp;&amp;
&gt; +                 ss-&gt;sec.keaKeyBits &lt; 1023 &amp;&amp;
&gt; +                 ss-&gt;ssl3.hs.kea_def-&gt;kea != kea_ecdh_rsa) ||
&gt; +                (ss-&gt;ssl3.hs.kea_def-&gt;signKeyType == sign_dsa &amp;&amp;
&gt; +                 ss-&gt;sec.keaKeyBits &lt; DSA_MIN_P_BITS)) {</span >

Should we also test for kea_dh_dss?</pre></div><div class="change-set" id="c59"><div class="comment" data-id="10287559" data-no="59"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-59" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1584" id="a6658926_438654"><img src="https://secure.gravatar.com/avatar/3e0b23cde901a6405f541eed3973331c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1584" id="a6658926_438654"><a class="email " href="/user_profile?user_id=1584" > <span class="fna">Wan-Teh Chang</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-59"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-59" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c59">Comment 59</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-19 17:12 PDT" data-time="1432080753">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-59">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-59" data-comment-id="10287559">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8607687" name="attach_8607687" title="bug1138554.patch">attachment 8607687</a> <a href="/attachment.cgi?id=8607687&amp;action=edit" title="bug1138554.patch">[details]</a> <a href="/attachment.cgi?id=8607687&amp;action=diff" title="bug1138554.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1138554&amp;attachment=8607687'>[review]</a>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS accepts export-length DHE keys with regular DHE cipher suites (&quot;Logjam&quot;)"
   href="/show_bug.cgi?id=1138554">bug1138554</a>.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8607687" name="attach_8607687" title="bug1138554.patch">attachment 8607687</a> <a href="/attachment.cgi?id=8607687&amp;action=edit" title="bug1138554.patch">[details]</a> <a href="/attachment.cgi?id=8607687&amp;action=diff" title="bug1138554.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1138554&amp;attachment=8607687'>[review]</a>:
-----------------------------------------------------------------

::: lib/ssl/ssl3con.c
&#64;&#64; +10054,5 &#64;&#64;
<span class="quote">&gt; +            if ((ss-&gt;ssl3.hs.kea_def-&gt;signKeyType == sign_rsa &amp;&amp;
&gt; +                 ss-&gt;sec.keaKeyBits &lt; 1023 &amp;&amp;
&gt; +                 ss-&gt;ssl3.hs.kea_def-&gt;kea != kea_ecdh_rsa) ||
&gt; +                (ss-&gt;ssl3.hs.kea_def-&gt;signKeyType == sign_dsa &amp;&amp;
&gt; +                 ss-&gt;sec.keaKeyBits &lt; DSA_MIN_P_BITS)) {</span >

Martin: after staring at this code for a few minutes, I think
we should rewrite the conditional expression as follows:

    if ((pubKey-&gt;keyType == rsaKey &amp;&amp;
         ss-&gt;sec.authKeyBits &lt; 1023) ||
        (pubKey-&gt;keyType == dsaKey &amp;&amp;
         ss-&gt;sec.authKeyBits &lt; DSA_MIN_P_BITS)) {

Note that I suggest testing authKeyBits instead of keaKeyBits
even though they have the same value.

We can use SECKEY_GetPublicKeyType(pubKey) instead of pubKey-&gt;keyType.</pre></div><div class="change-set" id="c60"><div class="comment" data-id="10287599" data-no="60"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-60" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a6658926_438654"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a6658926_438654"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-60"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-60" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c60">Comment 60</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-19 17:30 PDT" data-time="1432081849">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-60">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-60" data-comment-id="10287599">Arrgggh, I'm sorry about the whitespace.  I'll get onto that.

(In reply to Wan-Teh Chang from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS accepts export-length DHE keys with regular DHE cipher suites (&quot;Logjam&quot;)"
   href="/show_bug.cgi?id=1138554#c58">comment #58</a>)
<span class="quote">&gt; Why do we need the ss-&gt;ssl3.hs.kea_def-&gt;kea != kea_ecdh_rsa test?</span >

Hmm, this definitely needs a comment then.

_ECDH_RSA_ suites are funny because the public key is EC and that doesn't pass the test.

<span class="quote">&gt; Should we also test for kea_dh_rsa?</span >
...
<span class="quote">&gt; Should we also test for kea_dh_dss?</span >

The test for kea_dh_{rsa,dss} would be correct-ish, in the sense that it's on the right order of magnitude.  But we will be testing against the wrong constant if RSA and DH ever diverge in configuration.

The test that I'm looking for here is a little tricky to get from the information we have.  It's whether the key is wide enough to sign, if we're signing, or wide enough for key exchange for the static rsa suites.  We sign for ephemeral suites.  We only do static key exchange when signKeyType == sign_rsa AND exchKeyType == kt_rsa.

Maybe the test needs to be

// rsa signing of ephemeral keys, or static rsa
  (signKeyType == sign_rsa &amp;&amp; (ephemeral || exchKeyType == ssl_kea_rsa) &amp;&amp; size &lt; 1023)
// dsa signing of ephemeral keys
  || (signKeyType == sign_dsa &amp;&amp; ephemeral &amp;&amp; size &lt; DSA_MIN_P_BITS)
// static DH
  || (exchKeyType == ssl_kea_dh &amp;&amp; !ephemeral &amp;&amp; size &lt; DH_MIN_P_BITS)
// ...and we don't check EC yet

That's complicated, but does it make sense?</pre></div><div class="change-set" id="c61"><div class="comment" data-id="10287602" data-no="61"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-61" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a6658926_438654"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a6658926_438654"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-61"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-61" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c61">Comment 61</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-19 17:31 PDT" data-time="1432081914">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-61">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-61" data-comment-id="10287602">(In reply to Wan-Teh Chang from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS accepts export-length DHE keys with regular DHE cipher suites (&quot;Logjam&quot;)"
   href="/show_bug.cgi?id=1138554#c59">comment #59</a>)
<span class="quote">&gt; We can use SECKEY_GetPublicKeyType(pubKey) instead of pubKey-&gt;keyType.</span >

That makes perfect sense.  Greater knowledge prevails.  That's what I was looking for.</pre></div><div class="change-set" id="c62"><div class="comment" data-id="10290946" data-no="62"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-62" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a6658926_438654"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a6658926_438654"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-62"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-62" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c62">Comment 62</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-20 09:38 PDT" data-time="1432139921">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-62">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8608187"
         class="attachment patch obsolete"
         data-id="8608187" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1138554.patch">
      <meta itemprop="contentSize" content="589162">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8608187">
          <a class="link" href="attachment.cgi?id=8608187&amp;action=diff">
        <span id="att-8608187-description" itemprop="description">bug1138554.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8608187&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1138554&attachment=8608187">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-62" data-comment-id="10290946">This passes the whole test suite and I think that it's a better check.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8607687&amp;action=edit"
           title="bug1138554.patch"
           class=""
        >Attachment #8607687</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8607687&amp;action=edit"
           title="bug1138554.patch"
           class=""
        >Attachment #8607687</a> -
        Flags: <span class="activity-deleted">review?(wtc)</span></div><div class="change">
        <a href="/attachment.cgi?id=8608187&amp;action=edit"
           title="bug1138554.patch"
           class=""
        >Attachment #8608187</a> -
        Flags: review?(wtc)</div></div></div><div class="change-set" id="a6824389_14661"><div class="change" id="aa6824389_14661">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a6824389_14661"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_14661" id="a6824389_14661"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a6824389_14661"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a6824389_14661">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#a6824389_14661">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-20 10:51 PDT" data-time="1432144284">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Duplicate of this bug: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE - Minimum Diffie-Hellman (DH) group size"
   href="/show_bug.cgi?id=1166690">1166690</a></div></div></div><div class="change-set" id="c64"><div class="comment" data-id="10291751" data-no="64"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-64" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_11608" id="a6824389_14661"><img src="https://secure.gravatar.com/avatar/d2dc9227eafcd0ec5ba3712ee4f19b75?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_11608" id="a6824389_14661"><a class="email " href="/user_profile?user_id=11608" > <span class="fna">Jesse Ruderman</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-64"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-64" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c64">Comment 64</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-20 11:56 PDT" data-time="1432148188">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-64">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-64" data-comment-id="10291751">Can this bug be made public now?</pre></div><div class="change-set" id="c65"><div class="comment" data-id="10292804" data-no="65"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-65" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1584" id="a6824389_14661"><img src="https://secure.gravatar.com/avatar/3e0b23cde901a6405f541eed3973331c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1584" id="a6824389_14661"><a class="email " href="/user_profile?user_id=1584" > <span class="fna">Wan-Teh Chang</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-65"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-65" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c65">Comment 65</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-20 15:42 PDT" data-time="1432161725">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-65">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-65" data-comment-id="10292804">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8608187" name="attach_8608187" title="bug1138554.patch">attachment 8608187</a> <a href="/attachment.cgi?id=8608187&amp;action=edit" title="bug1138554.patch">[details]</a> <a href="/attachment.cgi?id=8608187&amp;action=diff" title="bug1138554.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1138554&amp;attachment=8608187'>[review]</a>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS accepts export-length DHE keys with regular DHE cipher suites (&quot;Logjam&quot;)"
   href="/show_bug.cgi?id=1138554">bug1138554</a>.patch

Martin: the ssl3con.c file in this patch still contains white
space changes. So I can't mark this patch review+.</pre></div><div class="change-set" id="c66"><div class="comment" data-id="10292861" data-no="66"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-66" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a6824389_14661"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a6824389_14661"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-66"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-66" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c66">Comment 66</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-20 15:52 PDT" data-time="1432162378">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-66">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-66" data-comment-id="10292861">Again! I'm sorry, let me fix that.</pre></div><div class="change-set" id="c67"><div class="comment" data-id="10292877" data-no="67"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-67" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a6824389_14661"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a6824389_14661"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-67"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-67" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c67">Comment 67</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-20 15:55 PDT" data-time="1432162501">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-67">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8608384"
         class="attachment patch"
         data-id="8608384" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1138554.patch">
      <meta itemprop="contentSize" content="15592">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8608384">
          <a class="link" href="attachment.cgi?id=8608384&amp;action=diff">
        <span id="att-8608384-description" itemprop="description">bug1138554.patch</span></a>
        — <a href="attachment.cgi?id=8608384&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1138554&attachment=8608384">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-67" data-comment-id="10292877">I'm so sorry about the whitespace thing.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8608187&amp;action=edit"
           title="bug1138554.patch"
           class=""
        >Attachment #8608187</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8608187&amp;action=edit"
           title="bug1138554.patch"
           class=""
        >Attachment #8608187</a> -
        Flags: <span class="activity-deleted">review?(wtc)</span></div><div class="change">
        <a href="/attachment.cgi?id=8608384&amp;action=edit"
           title="bug1138554.patch"
           class=""
        >Attachment #8608384</a> -
        Flags: review?(wtc)</div></div></div><div class="change-set" id="c68"><div class="comment" data-id="10292886" data-no="68"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-68" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a6824389_14661"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a6824389_14661"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-68"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-68" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c68">Comment 68</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-20 15:57 PDT" data-time="1432162639">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-68">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-68" data-comment-id="10292886">ni? mt for <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS accepts export-length DHE keys with regular DHE cipher suites (&quot;Logjam&quot;)"
   href="/show_bug.cgi?id=1138554#c64">comment 64</a></pre><div class="activity"><div class="change">Flags: needinfo?(martin.thomson)</div></div></div><div class="change-set" id="c69"><div class="comment" data-id="10292891" data-no="69"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-69" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a6824389_14661"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a6824389_14661"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-69"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-69" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c69">Comment 69</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-20 15:58 PDT" data-time="1432162709">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-69">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-69" data-comment-id="10292891">Don't we usually land this stuff before opening them?</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(martin.thomson)</span></div></div></div><div class="change-set" id="c70"><div class="comment" data-id="10292936" data-no="70"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-70" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a6824389_14661"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a6824389_14661"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-70"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-70" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c70">Comment 70</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-20 16:14 PDT" data-time="1432163646">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-70">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-70" data-comment-id="10292936">usually, but usually bugs aren't announced until a fix is available. We hide bugs to protect users from bad guys (or, additional bad guys?) from figuring out how to abuse the problem while there is no fix. If the problem is public then there's probably nothing to protect. Unless there are additional details about the problem here that haven't been made public then we should un-hide it.</pre></div><div class="change-set" id="c71"><div class="comment" data-id="10293027" data-no="71"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-71" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a6824389_14661"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a6824389_14661"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-71"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-71" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c71">Comment 71</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-20 16:34 PDT" data-time="1432164847">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-71">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-71" data-comment-id="10293027">:mt says we can unhide it.</pre><div class="activity"><div class="change">Group: <span class="activity-deleted">core-security</span></div></div></div><div class="change-set" id="c72"><div class="comment" data-id="10293055" data-no="72"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-72" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1584" id="a6824389_14661"><img src="https://secure.gravatar.com/avatar/3e0b23cde901a6405f541eed3973331c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1584" id="a6824389_14661"><a class="email " href="/user_profile?user_id=1584" > <span class="fna">Wan-Teh Chang</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-72"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-72" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c72">Comment 72</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-20 16:41 PDT" data-time="1432165300">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-72">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-72" data-comment-id="10293055">Comment on <span class=""><a href="/attachment.cgi?id=8608384" name="attach_8608384" title="bug1138554.patch">attachment 8608384</a> <a href="/attachment.cgi?id=8608384&amp;action=edit" title="bug1138554.patch">[details]</a> <a href="/attachment.cgi?id=8608384&amp;action=diff" title="bug1138554.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1138554&amp;attachment=8608384'>[review]</a>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS accepts export-length DHE keys with regular DHE cipher suites (&quot;Logjam&quot;)"
   href="/show_bug.cgi?id=1138554">bug1138554</a>.patch

Review of <span class=""><a href="/attachment.cgi?id=8608384" name="attach_8608384" title="bug1138554.patch">attachment 8608384</a> <a href="/attachment.cgi?id=8608384&amp;action=edit" title="bug1138554.patch">[details]</a> <a href="/attachment.cgi?id=8608384&amp;action=diff" title="bug1138554.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1138554&amp;attachment=8608384'>[review]</a>:
-----------------------------------------------------------------

r=wtc. I hope you can add a short comment to explain why
the minimum key size is 1023 bits rather than 1024 bits.

It may be enough to only allow off-by-one key sizes for
RSA keys. Does the EFF SSL Observatory report any 1023-bit
RSA certificates?</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8608384&amp;action=edit"
           title="bug1138554.patch"
           class=""
        >Attachment #8608384</a> -
        Flags: review?(wtc) &rarr; review+</div></div></div><div class="change-set" id="c73"><div class="comment" data-id="10293184" data-no="73"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-73" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a6824389_14661"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a6824389_14661"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-73"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-73" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c73">Comment 73</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-20 17:13 PDT" data-time="1432167198">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-73">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-73" data-comment-id="10293184"><a rel="nofollow" href="https://hg.mozilla.org/projects/nss/rev/ae72d76f8d24">https://hg.mozilla.org/projects/nss/rev/ae72d76f8d24</a>

Thanks for your perseverance Wan-Teh.

I added comments in two places, the one for RSA is a little shorter.  When we get some better stats (and we should do now that the accounting has been updated), we will be able to collect accurate data.  I'd like to hoist these numbers soon, but that might be a good thing to add to the &quot;remove export ciphers entirely&quot; work.

I don't know about the observatory data.  I suspect that there are not and we can increase this to 1024 safely.  The security difference between the two is marginal.</pre><div class="activity"><div class="change">Status: ASSIGNED &rarr; RESOLVED</div><div class="change">Closed: <span class="rel-time" title="2015-05-20 17:13 PDT" data-time="1432167198">7 years ago</span></div><div class="change">Resolution: --- &rarr; FIXED</div></div></div><div class="change-set" id="c74"><div class="comment" data-id="10294786" data-no="74"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-74" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_487652" id="a6824389_14661"><img src="https://secure.gravatar.com/avatar/b0fb5a6d4bf1758a9ef4db8f700e3bb4?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_487652" id="a6824389_14661"><a class="email " href="/user_profile?user_id=487652" > <span class="fna">Hubert Kario</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-74"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-74" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c74">Comment 74</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-21 03:09 PDT" data-time="1432202991">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-74">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-74" data-comment-id="10294786">we know there have been 1023 bit certs in the past, and they may still be on intranets</pre></div><div class="change-set" id="a6890540_159069"><div class="change" id="aa6890540_159069">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a6890540_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_159069" id="a6890540_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a6890540_159069"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a6890540_159069">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#a6890540_159069">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-21 05:13 PDT" data-time="1432210435">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Duplicate of this bug: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE - This is about Logjam vulnerability on Firefox"
   href="/show_bug.cgi?id=1167165">1167165</a></div></div></div><div class="change-set" id="c76"><div class="comment" data-id="10299490" data-no="76"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-76" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_495955" id="a6890540_159069"><img src="https://secure.gravatar.com/avatar/5aa2e382197a147b42d020b6878f8623?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_495955" id="a6890540_159069"><a class="email " href="/user_profile?user_id=495955" > <span class="fna">Sylvestre Ledru [:Sylvestre]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-76"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-76" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c76">Comment 76</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-22 01:55 PDT" data-time="1432284937">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-76">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-76" data-comment-id="10299490">Martin, please fill the uplift request to aurora, beta &amp; esr38 asap. thanks</pre><div class="activity"><div class="change">Flags: needinfo?(martin.thomson)</div></div></div><div class="change-set" id="c77"><div class="comment" data-id="10300891" data-no="77"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-77" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_451704" id="a6890540_159069"><img src="https://secure.gravatar.com/avatar/6168ea97fda0cefa449331e59b24e8f7?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_451704" id="a6890540_159069"><a class="email " href="/user_profile?user_id=451704" > <span class="fna">Liz Henry (:lizzard Please n-i to RyanVM, jcristau, or pascal)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-77"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-77" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c77">Comment 77</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-22 09:29 PDT" data-time="1432312157">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-77">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-77" data-comment-id="10300891">39.0b1 users could plan to use the addon: <a rel="nofollow" href="https://addons.mozilla.org/en-US/firefox/addon/disable-dhe/">https://addons.mozilla.org/en-US/firefox/addon/disable-dhe/</a>  I think that the patch we want to uplift is in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Update to NSS 3.19.1"
   href="/show_bug.cgi?id=1166031">bug 1166031</a>, but that needs more time on Nightly.  Beta 2 will be out next Friday so we may aim for that.</pre></div><div class="change-set" id="c78"><div class="comment" data-id="10301100" data-no="78"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-78" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_451704" id="a6890540_159069"><img src="https://secure.gravatar.com/avatar/6168ea97fda0cefa449331e59b24e8f7?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_451704" id="a6890540_159069"><a class="email " href="/user_profile?user_id=451704" > <span class="fna">Liz Henry (:lizzard Please n-i to RyanVM, jcristau, or pascal)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-78"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-78" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c78">Comment 78</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-22 09:57 PDT" data-time="1432313870">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-78">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-78" data-comment-id="10301100">Martin how about this. Let's uplift this patch to aurora on Monday. And plan to uplift whatever happens in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Update to NSS 3.19.1"
   href="/show_bug.cgi?id=1166031">bug 1166031</a> later in the week.  
Meanwhile let's write a release note with a link to the addon.  If you can improve the wording of the note (which is long -- I just used your addon description) that would be great. This seems like too much detail. 

Release Note Request (optional, but appreciated)
[Why is this notable]:  
[Suggested wording]: The logjam attack allows an attacker to impersonate servers that support weak keys.

Later versions of Firefox 39 will include changes that will increase the minimum strength of keys to 1024 bits.

Until then, users who are concerned about their online security can install this addon to disable the TLS cipher suites that could be used to mount the logjam attack. 

[Links (documentation, blog post, etc)]: <a rel="nofollow" href="https://addons.mozilla.org/en-US/firefox/addon/disable-dhe">https://addons.mozilla.org/en-US/firefox/addon/disable-dhe</a></pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox_relnote&amp;o1=isnotempty">relnote-firefox</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox_relnote&amp;o1=equals&amp;v1=39%2B">39+</a></div></div></div><div class="change-set" id="c79"><div class="comment" data-id="10301126" data-no="79"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-79" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a6890540_159069"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a6890540_159069"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-79"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-79" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c79">Comment 79</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-22 10:03 PDT" data-time="1432314217">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-79">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-79" data-comment-id="10301126"><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS accepts export-length DHE keys with regular DHE cipher suites (&quot;Logjam&quot;)"
   href="/show_bug.cgi?id=1138554#c78">comment 78</a>, r+ from me.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(martin.thomson)</span></div></div></div><div class="change-set" id="c80"><div class="comment" data-id="10301259" data-no="80"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-80" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_451704" id="a6890540_159069"><img src="https://secure.gravatar.com/avatar/6168ea97fda0cefa449331e59b24e8f7?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_451704" id="a6890540_159069"><a class="email " href="/user_profile?user_id=451704" > <span class="fna">Liz Henry (:lizzard Please n-i to RyanVM, jcristau, or pascal)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-80"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-80" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c80">Comment 80</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-22 10:25 PDT" data-time="1432315527">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-80">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-80" data-comment-id="10301259">Revised relnote: Users concerned about the Logjam vulnerability can install the Disable-DHE addon (<a rel="nofollow" href="https://addons.mozilla.org/en-US/firefox/addon/disable-dhe">https://addons.mozilla.org/en-US/firefox/addon/disable-dhe</a>)</pre></div><div class="change-set" id="c81"><div class="comment" data-id="10306806" data-no="81"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-81" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a6890540_159069"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a6890540_159069"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-81"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-81" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c81">Comment 81</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-25 09:16 PDT" data-time="1432570573">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-81">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-81" data-comment-id="10306806">(In reply to Martin Thomson [:mt] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS accepts export-length DHE keys with regular DHE cipher suites (&quot;Logjam&quot;)"
   href="/show_bug.cgi?id=1138554#c73">comment #73</a>)
<span class="quote">&gt; <a rel="nofollow" href="https://hg.mozilla.org/projects/nss/rev/ae72d76f8d24">https://hg.mozilla.org/projects/nss/rev/ae72d76f8d24</a></span >

This caused a bustage with older Windows compilers, because of the C++ style variable declaration in the middle of a code block.
<a rel="nofollow" href="https://bot.nss-crypto.org:8011/builders/1-win-x32-DBG/builds/447/steps/shell_1/logs/stdio">https://bot.nss-crypto.org:8011/builders/1-win-x32-DBG/builds/447/steps/shell_1/logs/stdio</a>

I've checked in a bustage fix:
<a rel="nofollow" href="https://hg.mozilla.org/projects/nss/rev/be964e8dc8e9">https://hg.mozilla.org/projects/nss/rev/be964e8dc8e9</a>

(I think it would have worked to reorder the two lines, but I didn't want to introduce a semantic change as part of a bustage fix, that's why I've kept the order of assignments.)</pre></div><div class="change-set" id="c82"><div class="comment" data-id="10310814" data-no="82"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-82" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1584" id="a6890540_159069"><img src="https://secure.gravatar.com/avatar/3e0b23cde901a6405f541eed3973331c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1584" id="a6890540_159069"><a class="email " href="/user_profile?user_id=1584" > <span class="fna">Wan-Teh Chang</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-82"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-82" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c82">Comment 82</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-26 10:56 PDT" data-time="1432662974">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-82">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-82" data-comment-id="10310814">Kai: thanks for fixing the compilation error. I confirm it is also OK
to just reorder those two lines.</pre></div><div class="change-set" id="c83"><div class="comment" data-id="10312182" data-no="83"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-83" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a6890540_159069"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a6890540_159069"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-83"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-83" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c83">Comment 83</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-26 14:12 PDT" data-time="1432674774">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-83">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-83" data-comment-id="10312182">:lizzard just asked about the bustage in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS accepts export-length DHE keys with regular DHE cipher suites (&quot;Logjam&quot;)"
   href="/show_bug.cgi?id=1138554#c81">comment 81</a>.  The concern here is that taking NSS_3_19_1_BETA1, which has the bustage, might cause problems.  As far as I know - though I'm not certain - we use the same compiler configuration to build everything from Nightly through to Release.  Since this bustage didn't cause problems with Nightly (and soon, DevEdition) builds, I think that it is safe enough to take the _BETA1 label into Beta.

Release channels are going to wait for the _RTM tag, which will include the fix.</pre></div><div class="change-set" id="a7686462_75935"><div class="change" id="aa7686462_75935">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a7686462_75935"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_75935" id="a7686462_75935"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a7686462_75935"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a7686462_75935">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#a7686462_75935">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-30 10:19 PDT" data-time="1433006357">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_2_0&amp;o1=isnotempty">status-b2g-v2.0</a>:
          <a href="/buglist.cgi?f1=cf_status_b2g_2_0&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_2_0&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_2_0m&amp;o1=isnotempty">status-b2g-v2.0M</a>:
          <a href="/buglist.cgi?f1=cf_status_b2g_2_0m&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_2_0m&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_2_1&amp;o1=isnotempty">status-b2g-v2.1</a>:
          <a href="/buglist.cgi?f1=cf_status_b2g_2_1&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_2_1&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_2_1_s&amp;o1=isnotempty">status-b2g-v2.1S</a>:
          <a href="/buglist.cgi?f1=cf_status_b2g_2_1_s&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_2_1_s&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_2_2&amp;o1=isnotempty">status-b2g-v2.2</a>:
          <a href="/buglist.cgi?f1=cf_status_b2g_2_2&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_2_2&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_master&amp;o1=isnotempty">status-b2g-master</a>:
          <a href="/buglist.cgi?f1=cf_status_b2g_master&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_master&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox39&amp;o1=isnotempty">status-firefox39</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox39&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox39&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox40&amp;o1=isnotempty">status-firefox40</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox40&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox40&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox41&amp;o1=isnotempty">status-firefox41</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox41&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox41&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr31&amp;o1=isnotempty">status-firefox-esr31</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox_esr31&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr31&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr38&amp;o1=isnotempty">status-firefox-esr38</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox_esr38&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr38&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr31&amp;o1=isnotempty">tracking-firefox-esr31</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox_esr31&amp;o1=equals&amp;v1=%3F">?</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr38&amp;o1=isnotempty">tracking-firefox-esr38</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox_esr38&amp;o1=equals&amp;v1=%3F">?</a></div></div></div><div class="change-set" id="a7971068_1689"><div class="change" id="aa7971068_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a7971068_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a7971068_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a7971068_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a7971068_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#a7971068_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-06-02 17:22 PDT" data-time="1433290963">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - home.nest.com breaks with Firefox 39 or higher"
   href="/show_bug.cgi?id=1170833">1170833</a></div></div></div><div class="change-set" id="c84"><div class="comment" data-id="10342999" data-no="84"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-84" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_381992" id="a7971068_1689"><img src="https://secure.gravatar.com/avatar/a430cf58452b9e73dfdde1555ad7eab3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_381992" id="a7971068_1689"><a class="email " href="/user_profile?user_id=381992" > <span class="fna">Ryan Sleevi</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-84"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-84" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c84">Comment 84</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-06-03 14:13 PDT" data-time="1433366019">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-84">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-84" data-comment-id="10342999">Martin,

This change ended up breaking Chrome's use of NSS, and I'm fairly certain represents a bigger change than intended.

That is, I think it's totally reasonable to reject these keys during TLS handshakes or usage. However, by raising the minimum that can be used to generate, I think this represents a real API change.

Concrete requests:
1) Bob, can you take a look at the changes to blapit.h and indicate your/Red Hat's feelings on the API change of this nature
2) Martin, can you make sure to review the release notes prior to them going out to make sure subtle-but-big changes like this are documented? We really should have a &quot;BREAKING CHANGES&quot; section for things like this.
3) Kai, do we have a process for updating/amending the release notes after we've announced?

I've been following this bug and even I wasn't aware of those changes - I truly thought you were just fixing the SSL layer, and that's what was documented in the release notes ( <a rel="nofollow" href="https://developer.mozilla.org/en-US/docs/Mozilla/Projects/NSS/NSS_3.19.1_release_notes">https://developer.mozilla.org/en-US/docs/Mozilla/Projects/NSS/NSS_3.19.1_release_notes</a> )

I'm not trying to derail this bug with a discussion of why - but we do it so that tests run in a reasonable time under instrumentation.

I also explicitly didn't reopen this bug, because I think that depends on Bob's feedback. If it is a breaking change, then we decide whether to roll back or simply accept the documentation and roll forward, although if that was the case, I think we should have called 3.19.1 3.20</pre><div class="activity"><div class="change">Flags: needinfo?(rrelyea)</div><div class="change">Flags: needinfo?(martin.thomson)</div><div class="change">Flags: needinfo?(kaie)</div></div></div><div class="change-set" id="c85"><div class="comment" data-id="10343267" data-no="85"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-85" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a7971068_1689"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a7971068_1689"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-85"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-85" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c85">Comment 85</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-06-03 15:08 PDT" data-time="1433369285">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-85">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-85" data-comment-id="10343267">Patch notes updated.  Feel free to add any shouting you feel appropriate, I didn't.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(martin.thomson)</span></div></div></div><div class="change-set" id="c86"><div class="comment" data-id="10344392" data-no="86"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-86" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_540684" id="a7971068_1689"><img src="https://secure.gravatar.com/avatar/921b9a6a0a6ff8bb4adf6128bf382474?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_540684" id="a7971068_1689"><a class="email disabled" href="/user_profile?user_id=540684" > <span class="fna">Mostyn Bramley-Moore</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-86"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-86" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c86">Comment 86</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-06-03 23:18 PDT" data-time="1433398714">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-86">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-86" data-comment-id="10344392">Shouldn't the Compatibility section of the 3.19.1 release notes be updated also?</pre></div><div class="change-set" id="c87"><div class="comment" data-id="10345528" data-no="87"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-87" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1584" id="a7971068_1689"><img src="https://secure.gravatar.com/avatar/3e0b23cde901a6405f541eed3973331c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1584" id="a7971068_1689"><a class="email " href="/user_profile?user_id=1584" > <span class="fna">Wan-Teh Chang</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-87"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-87" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c87">Comment 87</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-06-04 07:11 PDT" data-time="1433427066">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-87">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-87" data-comment-id="10345528">We can easily lower RSA_MIN_MODULUS_BITS, DH_MIN_P_BITS,
and DSA_MIN_P_BITS in blapit.h and add new SSL-specific
macros for the minimum RSA, DH, and DSA key sizes.

Please suggest the appropriate values for RSA_MIN_MODULUS_BITS,
DH_MIN_P_BITS, and DSA_MIN_P_BITS for freebl/softoken. Thanks.</pre></div><div class="change-set" id="c88"><div class="comment" data-id="10346879" data-no="88"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-88" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_11099" id="a7971068_1689"><img src="https://secure.gravatar.com/avatar/4e29cfbfaece102427b6d6aa84d135f5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_11099" id="a7971068_1689"><a class="email " href="/user_profile?user_id=11099" > <span class="fna">Robert Relyea</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-88"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-88" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c88">Comment 88</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-06-04 11:16 PDT" data-time="1433441789">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-88">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-88" data-comment-id="10346879">For Redhat, we will won't be picking up the softoken changes for our RHEL-6 build because it affects the FIPS boundary. I'm in general OK with increasing it. I am concerned that Ryan has ran into some compatibility issues, however. If these issues are 'real', then I would prefer not increasing the min values in softoken. It's better to handle that in the protocols we are using (e.i. SSL, cert verification, etc.). I'd like to know what the issues were, because they may affect whether we pick the changes up in RHEL7 (as well as recommendations here, I don't want to arbitrarily hose Chrome, for instance)

I too thought we were just changing the ssl layer, and was surprised when we got the note that there were softoken changes.

I think Kai is on PTO right now, so you may not get a quick response from him.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(rrelyea)</span></div></div></div><div class="change-set" id="c89"><div class="comment" data-id="10347025" data-no="89"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-89" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_540684" id="a7971068_1689"><img src="https://secure.gravatar.com/avatar/921b9a6a0a6ff8bb4adf6128bf382474?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_540684" id="a7971068_1689"><a class="email disabled" href="/user_profile?user_id=540684" > <span class="fna">Mostyn Bramley-Moore</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-89"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-89" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c89">Comment 89</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-06-04 11:49 PDT" data-time="1433443788">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-89">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-89" data-comment-id="10347025">&#64;Robert: the breaking change I found was that PK11_GenerateKeyPair now fails if you ask for a small key.</pre></div><div class="change-set" id="c90"><div class="comment" data-id="10348502" data-no="90"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-90" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_451704" id="a7971068_1689"><img src="https://secure.gravatar.com/avatar/6168ea97fda0cefa449331e59b24e8f7?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_451704" id="a7971068_1689"><a class="email " href="/user_profile?user_id=451704" > <span class="fna">Liz Henry (:lizzard Please n-i to RyanVM, jcristau, or pascal)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-90"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-90" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c90">Comment 90</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-06-04 17:00 PDT" data-time="1433462451">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-90">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-90" data-comment-id="10348502">This appears to also be underlying <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Firefox fails to connect to Flash game server (regression in Firefox 39/40/41)"
   href="/show_bug.cgi?id=1171502">bug 1171502</a> where there is some disagreement about whether we should be rolling back this change or expecting sites to upgrade in response.</pre></div><div class="change-set" id="c91"><div class="comment" data-id="10352484" data-no="91"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-91" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1584" id="a7971068_1689"><img src="https://secure.gravatar.com/avatar/3e0b23cde901a6405f541eed3973331c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1584" id="a7971068_1689"><a class="email " href="/user_profile?user_id=1584" > <span class="fna">Wan-Teh Chang</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-91"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-91" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c91">Comment 91</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-06-05 13:12 PDT" data-time="1433535146">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-91">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-91" data-comment-id="10352484">I filed <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Undo the freebl/softoken RSA/DH/DSA minimum key size increases in bug 1138554"
   href="/show_bug.cgi?id=1172128">bug 1172128</a> to fix the problem Ryan reported
in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS accepts export-length DHE keys with regular DHE cipher suites (&quot;Logjam&quot;)"
   href="/show_bug.cgi?id=1138554#c84">comment 84</a>.</pre></div><div class="change-set" id="c92"><div class="comment" data-id="10356758" data-no="92"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-92" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a7971068_1689"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a7971068_1689"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-92"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-92" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c92">Comment 92</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-06-08 07:48 PDT" data-time="1433774889">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-92">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-92" data-comment-id="10356758">(In reply to Ryan Sleevi from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS accepts export-length DHE keys with regular DHE cipher suites (&quot;Logjam&quot;)"
   href="/show_bug.cgi?id=1138554#c84">comment #84</a>)
<span class="quote">&gt; 3) Kai, do we have a process for updating/amending the release notes after
&gt; we've announced?</span >

We don't have a process yet.

If it's just clarification or additional information, I think it is fine to add to the release notes page.

If it's an important addition to the release notes, then it would be nice to send a follow up message to the release announcement on the dev-tech-crypto newsgroup.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(kaie)</span></div></div></div><div class="change-set" id="c93"><div class="comment" data-id="10403712" data-no="93"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-93" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_500713" id="a7971068_1689"><img src="https://secure.gravatar.com/avatar/d270c3f60de326734614886547536dcf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_500713" id="a7971068_1689"><a class="email " href="/user_profile?user_id=500713" > <span class="fna">Florin Mezei, QA (:FlorinMezei)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-93"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-93" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c93">Comment 93</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-06-18 02:37 PDT" data-time="1434620245">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-93">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-93" data-comment-id="10403712">Is manual testing needed for this fix? If yes, could you provide some testing steps?</pre><div class="activity"><div class="change">Flags: needinfo?(martin.thomson)</div></div></div><div class="change-set" id="c94"><div class="comment" data-id="10405525" data-no="94"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-94" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a7971068_1689"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a7971068_1689"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-94"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-94" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c94">Comment 94</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-06-18 10:11 PDT" data-time="1434647466">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-94">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-94" data-comment-id="10405525">Visit <a rel="nofollow" href="https://weakdh.org/">https://weakdh.org/</a>.

It should say &quot; Good News! Your browser is safe against the Logjam attack. &quot;</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(martin.thomson)</span></div></div></div><div class="change-set ca-1689" id="c95"><div class="comment" data-id="10407266" data-no="95"
       data-tags="obsolete">
    
    <table class="layout-table change-head " id="ch-95" style="display:none" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a7971068_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a7971068_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-95"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-95" style="display:none">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c95">Comment 95</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-06-18 16:20 PDT" data-time="1434669622">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-95">
        <td colspan="2" class="comment-tags"><span class="comment-tag">obsolete</span>
        </td>
      </tr>
    </table>

    
      <table class="layout-table change-head default-collapsed" id="cc-95"
             role="presentation">
      <tr>
        <td class="comment-collapse-reason"
            title="dveditz [7 years ago]">
            Comment hidden (obsolete)
        </td>
        <td class="comment-actions">
          <button type="button" class="change-spinner minor iconic" id="ccs-95"
                  aria-label="Expand"
                  aria-expanded="false"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </td>
      </tr>
      </table>
  </div><pre
        class="comment-text  "
        id="ct-95" data-comment-id="10407266" style="display:none">NSS's version of the Logjam vulnerability shall be known as <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-2723">CVE-2015-2723</a>.</pre><div class="activity" style="display:none"><div class="change">Alias: CVE-2015-2723</div></div></div><div class="change-set" id="c96"><div class="comment" data-id="10407295" data-no="96"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-96" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_381992" id="a7971068_1689"><img src="https://secure.gravatar.com/avatar/a430cf58452b9e73dfdde1555ad7eab3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_381992" id="a7971068_1689"><a class="email " href="/user_profile?user_id=381992" > <span class="fna">Ryan Sleevi</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-96"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-96" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c96">Comment 96</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-06-18 16:29 PDT" data-time="1434670161">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-96">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-96" data-comment-id="10407295">Dan: That was the same CVE for <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS incorrectly permits skipping of ServerKeyExchange"
   href="/show_bug.cgi?id=1086145#c84">https://bugzilla.mozilla.org/show_bug.cgi?id=1086145#c84</a> . Perhaps I've botched things in my email?</pre></div><div class="change-set" id="c97"><div class="comment" data-id="10407297" data-no="97"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-97" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_381992" id="a7971068_1689"><img src="https://secure.gravatar.com/avatar/a430cf58452b9e73dfdde1555ad7eab3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_381992" id="a7971068_1689"><a class="email " href="/user_profile?user_id=381992" > <span class="fna">Ryan Sleevi</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-97"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-97" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c97">Comment 97</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-06-18 16:30 PDT" data-time="1434670220">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-97">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-97" data-comment-id="10407297">Er, sorry, I botched the #. <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS incorrectly permits skipping of ServerKeyExchange"
   href="/show_bug.cgi?id=1086145">Bug 1086145</a> was <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-2721">CVE-2015-2721</a>.</pre></div><div class="change-set" id="a9433365_280903"><div class="change" id="aa9433365_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a9433365_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a9433365_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a9433365_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a9433365_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#a9433365_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-06-19 15:34 PDT" data-time="1434753260">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr31&amp;o1=isnotempty">tracking-firefox-esr31</a>:
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr31&amp;o1=equals&amp;v1=%3F">?</a> &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox_esr31&amp;o1=equals&amp;v1=39%2B">39+</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr38&amp;o1=isnotempty">tracking-firefox-esr38</a>:
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr38&amp;o1=equals&amp;v1=%3F">?</a> &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox_esr38&amp;o1=equals&amp;v1=39%2B">39+</a></div><div class="change">Whiteboard: Embargo until multi-vendor coordinated info release (May 19) &rarr; [adv-main39+][adv-esr38.1+][adv-esr31.8+] Embargo until multi-vendor coordinated info release (May 19)</div></div></div><div class="change-set" id="c98"><div class="comment" data-id="10411078" data-no="98"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-98" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a9433365_280903"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a9433365_280903"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-98"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-98" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c98">Comment 98</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-06-19 17:44 PDT" data-time="1434761048">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-98">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-98" data-comment-id="10411078">MITRE says we should use the CVE assigned to the protocol issue overall rather than assigning one specific to our implementation of DHE. That CVE is <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000">CVE-2015-4000</a></pre><div class="activity"><div class="change">Alias: CVE-2015-2723 &rarr; CVE-2015-4000</div></div></div><div class="change-set" id="c99"><div class="comment" data-id="10424598" data-no="99"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-99" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_488993" id="a9433365_280903"><img src="https://secure.gravatar.com/avatar/42f2a9436bbaefa7e0028e214f2b9350?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_488993" id="a9433365_280903"><a class="email " href="/user_profile?user_id=488993" > <span class="fna">Andrei Vaida [:avaida]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-99"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-99" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c99">Comment 99</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-06-26 01:37 PDT" data-time="1435307823">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-99">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-99" data-comment-id="10424598">Verified fixed on:
* ESR 31.8.0 (20150624141335),
* ESR 38.1.0 (20150624141534),
* RC 39.0 Build 4 (20150624153222),
* Aurora 40.0a2 (2015-06-25),
* Nightly 41.0a1 (2015-06-25),
using Windows 8.1 (x64), Ubuntu 14.04 (x86) and Mac OS X 10.9.5.

Testing was done according to the instructions from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS accepts export-length DHE keys with regular DHE cipher suites (&quot;Logjam&quot;)"
   href="/show_bug.cgi?id=1138554#c94">Comment 94</a>.</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox39&amp;o1=isnotempty">status-firefox39</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox39&amp;o1=equals&amp;v1=fixed">fixed</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox39&amp;o1=equals&amp;v1=verified">verified</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox40&amp;o1=isnotempty">status-firefox40</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox40&amp;o1=equals&amp;v1=fixed">fixed</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox40&amp;o1=equals&amp;v1=verified">verified</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox41&amp;o1=isnotempty">status-firefox41</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox41&amp;o1=equals&amp;v1=fixed">fixed</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox41&amp;o1=equals&amp;v1=verified">verified</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr31&amp;o1=isnotempty">status-firefox-esr31</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox_esr31&amp;o1=equals&amp;v1=fixed">fixed</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr31&amp;o1=equals&amp;v1=verified">verified</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr38&amp;o1=isnotempty">status-firefox-esr38</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox_esr38&amp;o1=equals&amp;v1=fixed">fixed</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr38&amp;o1=equals&amp;v1=verified">verified</a></div></div></div><div class="change-set" id="c100"><div class="comment" data-id="10427405" data-no="100"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-100" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_398515" id="a9433365_280903"><img src="https://secure.gravatar.com/avatar/517197190f6f8901f3280331772c3d41?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_398515" id="a9433365_280903"><a class="email " href="/user_profile?user_id=398515" > <span class="fna">YF (Yang)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-100"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-100" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c100">Comment 100</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-06-26 18:08 PDT" data-time="1435367330">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-100">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-100" data-comment-id="10427405">Update for refnote?</pre><div class="activity"><div class="change">Flags: needinfo?(lhenry)</div></div></div><div class="change-set" id="c101"><div class="comment" data-id="10458032" data-no="101"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-101" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_232883" id="a9433365_280903"><img src="https://secure.gravatar.com/avatar/f84bbc6968ecda0a64ab50d1060c320e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_232883" id="a9433365_280903"><a class="email " href="/user_profile?user_id=232883" > <span class="fna">Kohei Yoshino</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-101"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-101" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c101">Comment 101</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-06 01:16 PDT" data-time="1436170561">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-101">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-101" data-comment-id="10458032">As per my weekend analysis, this is the biggest site compatibility issue of Firefox 39.

<a rel="nofollow" href="https://developer.mozilla.org/en-US/Firefox/Releases/39/Site_Compatibility#Security">https://developer.mozilla.org/en-US/Firefox/Releases/39/Site_Compatibility#Security</a>
<a rel="nofollow" href="https://input.mozilla.org/en-US/?product=Firefox&amp;q=ssl_error_weak_server_ephemeral_dh_key">https://input.mozilla.org/en-US/?product=Firefox&amp;q=ssl_error_weak_server_ephemeral_dh_key</a>
<a rel="nofollow" href="https://support.mozilla.org/en-US/search?q=ssl_error_weak_server_ephemeral_dh_key">https://support.mozilla.org/en-US/search?q=ssl_error_weak_server_ephemeral_dh_key</a>

I'm reaching out to those affected sites via <a rel="nofollow" href="https://twitter.com/FxSiteCompat">https://twitter.com/FxSiteCompat</a></pre><div class="activity"><div class="change">Keywords: <a href="/buglist.cgi?keywords=dev-doc-needed&amp;resolution=---">dev-doc-needed</a>, 
          
            <a href="/buglist.cgi?keywords=site-compat&amp;resolution=---">site-compat</a></div></div></div><div class="change-set" id="c102"><div class="comment" data-id="10458170" data-no="102"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-102" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_333742" id="a9433365_280903"><img src="https://secure.gravatar.com/avatar/b94ad5ae55b771c021ff5d01ae4394ba?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_333742" id="a9433365_280903"><a class="email " href="/user_profile?user_id=333742" > <span class="fna">Christian Kujau</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-102"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-102" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c102">Comment 102</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-06 02:23 PDT" data-time="1436174608">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-102">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-102" data-comment-id="10458170">Isn't Thunderbird also affected by <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000">CVE-2015-4000</a> when using (START)TLS? I couldn't find a bug report for Thunderbird (only <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED INVALID - LogJam with TLS authentication (OpenSSL)"
   href="/show_bug.cgi?id=1175816">bug 1175816</a>, but this seems to be invalid/duplicate).</pre></div><div class="change-set" id="c103"><div class="comment" data-id="10461780" data-no="103"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-103" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a9433365_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_280903" id="a9433365_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-103"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-103" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#c103">Comment 103</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-06 16:02 PDT" data-time="1436223773">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-103">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-103" data-comment-id="10461780">(In reply to Christian Kujau from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - NSS accepts export-length DHE keys with regular DHE cipher suites (&quot;Logjam&quot;)"
   href="/show_bug.cgi?id=1138554#c102">comment #102</a>)
<span class="quote">&gt; Isn't Thunderbird also affected by <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000">CVE-2015-4000</a> when using (START)TLS? I
&gt; couldn't find a bug report for Thunderbird (only <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED INVALID - LogJam with TLS authentication (OpenSSL)"
   href="/show_bug.cgi?id=1175816">bug 1175816</a>, but this seems
&gt; to be invalid/duplicate).</span >

I assume TB will pick up the fix for this in their 38.1 build that is being built right now. They are included in the advisory but haven't shipped it yet.</pre></div><div class="change-set" id="a11066492_1689"><div class="change" id="aa11066492_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a11066492_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a11066492_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a11066492_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a11066492_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#a11066492_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-08 13:13 PDT" data-time="1436386387">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Summary: NSS accepts export-length DHE keys with regular DHE cipher suites &rarr; NSS accepts export-length DHE keys with regular DHE cipher suites (&quot;Logjam&quot;)</div></div></div><div class="change-set" id="a11788126_254728"><div class="change" id="aa11788126_254728">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_254728" id="a11788126_254728"><img src="https://secure.gravatar.com/avatar/844337f85b90db8baab206d5b2e1da8a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_254728" id="a11788126_254728"><a class="email " href="/user_profile?user_id=254728" > <span class="fna">Kent James (:rkent)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a11788126_254728"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a11788126_254728">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#a11788126_254728">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-16 21:40 PDT" data-time="1437108021">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED WONTFIX - Thunderbird 38.1.0+38.0.1: SMTP+IMAP with STARTTLS: no remaining auth method"
   href="/show_bug.cgi?id=1184488">1184488</a></div></div></div><div class="change-set" id="a12163000_29811"><div class="change" id="aa12163000_29811">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_29811" id="a12163000_29811"><img src="https://secure.gravatar.com/avatar/20697ca69672a5276f24a34382a1ddbd?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_29811" id="a12163000_29811"><a class="email " href="/user_profile?user_id=29811" > <span class="fna">Wayne Mery (:wsmwk)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a12163000_29811"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a12163000_29811">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#a12163000_29811">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-21 05:48 PDT" data-time="1437482895">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Blocks: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED WONTFIX - After upgrade to v38.1.0 cannot get emails (using self-signed SSL certificates with 512bit keys ) because of Logjam/weak Diffie-Hellman key mitigation"
   href="/show_bug.cgi?id=1185060">1185060</a></div></div></div><div class="change-set" id="a12660636_113380"><div class="change" id="aa12660636_113380">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_113380" id="a12660636_113380"><img src="https://secure.gravatar.com/avatar/7d826d9ec8638ece851b17b55a9d7b72?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_113380" id="a12660636_113380"><a class="email " href="/user_profile?user_id=113380" > <span class="fna">Rimas Kudelis</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a12660636_113380"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a12660636_113380">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#a12660636_113380">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-27 00:02 PDT" data-time="1437980531">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_NEW"
   title="NEW - Thunderbird UI should report rejected SSL/TLS connections"
   href="/show_bug.cgi?id=1187797">1187797</a></div></div></div><div class="change-set" id="a15399597_451704"><div class="change" id="aa15399597_451704">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_451704" id="a15399597_451704"><img src="https://secure.gravatar.com/avatar/6168ea97fda0cefa449331e59b24e8f7?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_451704" id="a15399597_451704"><a class="email " href="/user_profile?user_id=451704" > <span class="fna">Liz Henry (:lizzard Please n-i to RyanVM, jcristau, or pascal)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a15399597_451704"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a15399597_451704">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1138554#a15399597_451704">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-27 16:51 PDT" data-time="1440719492">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(lhenry)</span></div></div></div><div id="new-comment-notice">
          You need to <a href="/show_bug.cgi?id=1138554&amp;GoAheadAndLogIn=1">log in</a>
          before you can comment on or make changes to this bug.
        </div>



<div id="bottom-actions">
  <div id="bottom-right-actions">
    <button type="button" id="top-btn" class="secondary" aria-label="Go to Page Top">Top &uarr;</button>
  </div>
</div></div> 
</main> 
</div> 


</body>
</html>