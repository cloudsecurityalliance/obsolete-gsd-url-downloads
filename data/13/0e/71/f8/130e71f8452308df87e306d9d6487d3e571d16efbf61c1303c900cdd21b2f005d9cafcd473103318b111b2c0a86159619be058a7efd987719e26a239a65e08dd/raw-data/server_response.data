<!DOCTYPE html>
<html lang="en">
  <head>
    <title>103555 &ndash; media-video/mplayer: buffer overflow (CAN-2005-2718)</title>

      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<link href="data/assets/1dee87cdc229fb032852e53a39a3c8b5.css?1635279638" rel="stylesheet" type="text/css">



    
<script type="text/javascript" src="data/assets/a7c2f3a028f17a9aa60f56dc9d6e732d.js?1635279638"></script>

    <script type="text/javascript">
    <!--
        YAHOO.namespace('bugzilla');
        YAHOO.util.Event.addListener = function (el, sType, fn, obj, overrideContext) {
               if ( ("onpagehide" in window || YAHOO.env.ua.gecko) && sType === "unload") { sType = "pagehide"; };
               var capture = ((sType == "focusin" || sType == "focusout") && !YAHOO.env.ua.ie) ? true : false;
               return this._addListener(el, this._getType(sType), fn, obj, overrideContext, capture);
         };
        if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
            YAHOO.util.Event._simpleRemove(window, "unload", 
                                           YAHOO.util.Event._unload);
        }
        
        function unhide_language_selector() { 
            YAHOO.util.Dom.removeClass(
                'lang_links_container', 'bz_default_hidden'
            ); 
        } 
        YAHOO.util.Event.onDOMReady(unhide_language_selector);

        
        var BUGZILLA = {
            param: {
                cookiepath: '\/',
                maxusermatches: 1000
            },
            constant: {
                COMMENT_COLS: 80
            },
            string: {
                

                attach_desc_required:
                    "You must enter a Description for this attachment.",
                component_required:
                    "You must select a Component for this bug.",
                description_required:
                    "You must enter a Description for this bug.",
                short_desc_required:
                    "You must enter a Summary for this bug.",
                version_required:
                    "You must select a Version for this bug."
            }
              , api_token: ''
        };

    if (history && history.replaceState) {
      if(!document.location.href.match(/show_bug\.cgi/)) {
        history.replaceState( null,
                             "103555 – media-video\/mplayer: buffer overflow (CAN-2005-2718)",
                             "show_bug.cgi?id=103555" );
        document.title = "103555 – media-video\/mplayer: buffer overflow (CAN-2005-2718)";
      }
      if (document.location.href.match(/show_bug\.cgi\?.*list_id=/)) {
        var href = document.location.href;
        href = href.replace(/[\?&]+list_id=(\d+|cookie)/, '');
        history.replaceState(null, "103555 – media-video\/mplayer: buffer overflow (CAN-2005-2718)", href);
      }
    }
    YAHOO.util.Event.onDOMReady(function() {
      initDirtyFieldTracking();

    });
    // -->
    </script>
<script type="text/javascript" src="data/assets/daf5e0fb6826e6a35280e622913f0c4a.js?1635279638"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Gentoo's Bugzilla" href="./search_plugin.cgi">
    <link rel="shortcut icon" href="images/favicon.ico"><script language="JavaScript" src="extensions/Gentoo/web/gentoo.js"></script>
  </head>

  <body 
        class="bugs-gentoo-org
                 bz_bug
                 bz_status_RESOLVED
                 bz_product_Gentoo_Security
                 bz_component_Vulnerabilities
                 bz_bug_103555 yui-skin-sam">
<div id="gentoo-bar">
	<a href="/" title="Go to the Gentoo Bugzilla homepage" class="home-link">
		<img src="extensions/Gentoo/web/gentoo_org.png" alt="Gentoo Websites Logo" />
	</a>

	<div>
		Go to: 
		<a href="https://www.gentoo.org/">Gentoo Home</a>
		<a href="https://www.gentoo.org/support/documentation/">Documentation</a>
		<a href="https://forums.gentoo.org/">Forums</a>
		<a href="https://www.gentoo.org/get-involved/mailing-lists/">Lists</a>
		<a href="/" class="active">Bugs</a>
		<a href="https://planet.gentoo.org/">Planet</a>
		<a href="https://www.gentoo.org/inside-gentoo/stores/">Store</a>
		<a href="https://wiki.gentoo.org/">Wiki</a>
		<strong><a href="https://www.gentoo.org/downloads/">Get Gentoo!</a></strong>
	</div>
</div>

  <div id="header"><div id="banner">
  </div>

    <div id="titles">
      <span id="title">Gentoo's Bugzilla &ndash; Bug&nbsp;103555</span>

        <span id="subtitle" class="subheader">media-video/mplayer: buffer overflow (CAN-2005-2718)</span>

        <span id="information" class="header_addl_info">Last modified: 2005-09-09 11:04:31 UTC node [gannet]</span>
    </div>


    <div id="common_links"><ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi?format=guided">New</a>&ndash;<a href="enter_bug.cgi">[Ex]</a></li>
  <li><span class="separator">| </span><a href="describecomponents.cgi">Browse</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>
  <li><span class="separator">| </span><a href="https://wiki.gentoo.org/wiki/Foundation:Privacy_Policy">Privacy Policy</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_top" name="no_redirect" value="0">
    <script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_top");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_top" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_top"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li>
      <span class="separator">| </span>
        <a href="request.cgi">Requests</a></li>


  <li>
        <span class="separator">| </span>
        <a href="https://bugzilla.readthedocs.org/en/5.0/using/understanding.html" target="_blank">Help</a>
      </li>
    
      <li id="new_account_container_top">
        <span class="separator">| </span>
        <a href="createaccount.cgi">New&nbsp;Account</a>
      </li>

    <li id="mini_login_container_top">
  <span class="separator">| </span>
  <a id="login_link_top" href="show_bug.cgi?id=103555&amp;GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('_top')">Log In</a>

  <form action="show_bug.cgi?id=103555" method="POST"
        class="mini_login bz_default_hidden"
        id="mini_login_top">
    <input id="Bugzilla_login_top" required
           name="Bugzilla_login" class="bz_login"
        type="email" placeholder="Email Address">
    <input class="bz_password" name="Bugzilla_password" type="password"
           id="Bugzilla_password_top" required
           placeholder="Password">
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
            id="log_in_top">
    <a href="#" onclick="return hide_mini_login_form('_top')">[x]</a>
  </form>
</li>


  <li id="forgot_container_top">
    <span class="separator">| </span>
    <a id="forgot_link_top" href="show_bug.cgi?id=103555&amp;GoAheadAndLogIn=1#forgot"
       onclick="return show_forgot_form('_top')">Forgot Password</a>
    <form action="token.cgi" method="post" id="forgot_form_top"
          class="mini_forgot bz_default_hidden">
      <label for="login_top">Login:</label>
      <input name="loginname" size="20" id="login_top" required
          type="email" placeholder="Your Email Address">
      <input id="forgot_button_top" value="Reset Password" type="submit">
      <input type="hidden" name="a" value="reqpw">
      <input type="hidden" id="token_top" name="token"
             value="1635619215-ocnhfrBnoHHxB1eJgDVUUPgTuV5FBHqfKviXlYht5eA">
      <a href="#" onclick="return hide_forgot_form('_top')">[x]</a>
    </form>
  </li>
</ul>
    </div>
  </div>

  <div id="bugzilla-body"><!--<div style="border: 1px solid #ebccd1; background-color: #f2dede; color: #a94442; padding: 0.4em; margin-bottom: 0.4em;">critical goes here ...</div>-->
<!--<div id="message">
Bugzilla DB migration completed. Please report issues to Infra team via email via infra@gentoo.org or IRC
</div>-->


<script type="text/javascript">
<!--

//-->
</script>

<form name="changeform" id="changeform" method="post" action="process_bug.cgi">

  <input type="hidden" name="delta_ts" value="2005-09-09 11:04:31">
  <input type="hidden" name="id" value="103555">
  <input type="hidden" name="token" value="1635619215-eZIxaCo1a-Noj_vIB7b9LK7N46giYHCl3QT0dYEmB1U">
<div class="bz_short_desc_container edit_form">
     <a href="show_bug.cgi?id=103555"><b>Bug&nbsp;103555</b></a> <span id="summary_container" class="bz_default_hidden">
      - <span id="short_desc_nonedit_display">media-video/mplayer: buffer overflow (CAN-2005-2718)</span>
     </span>

    <div id="summary_input"><span class="field_label "
    id="field_label_short_desc">


  <a 
      title="The bug summary is a short sentence which succinctly describes what the bug is about."
      class="field_help_link"
      href="page.cgi?id=fields.html#short_desc"
  >Summary:</a>

</span>media-video/mplayer: buffer overflow (CAN-2005-2718)
    </div>
  </div>
  <script type="text/javascript">
    hideEditableField('summary_container',
                      'summary_input',
                      'summary_edit_action',
                      'short_desc',
                      'media-video\/mplayer: buffer overflow (CAN-2005-2718)' );
  </script>
  <table class="edit_form">
    <tr>
      
      <td id="bz_show_bug_column_1" class="bz_show_bug_column">     
        <table>
          <tr>
    <th class="field_label">
      <a href="page.cgi?id=fields.html#bug_status">Status</a>:
    </th>
    <td id="bz_field_status">
      <span id="static_bug_status">RESOLVED
          FIXED
      </span>
    </td>
  </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_alias">


  <a 
      title="A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla."
      class="field_help_link"
      href="page.cgi?id=fields.html#alias"
  >Alias:</a>

</th>
    <td>
        None
    </td>
  </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_product">


  <a 
      title="Bugs are categorised into Products and Components."
      class="field_help_link"
      href="describecomponents.cgi"
  >Product:</a>

</th>
  <td class="field_value "
      id="field_container_product" >Gentoo Security

</td>
    </tr>

    
    <tr class="bz_default_hidden"><th class="field_label "
    id="field_label_classification">


  <a 
      title="Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation."
      class="field_help_link"
      href="page.cgi?id=fields.html#classification"
  >Classification:</a>

</th>
  <td class="field_value "
      id="field_container_classification" >Unclassified

</td>
    </tr>
        
    
    
    <tr><th class="field_label "
    id="field_label_component">


  <a 
      title="Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list."
      class="field_help_link"
      href="describecomponents.cgi?product=Gentoo Security"
  >Component:</a>

</th>
  <td class="field_value "
      id="field_container_component" >Vulnerabilities

  (<a href="buglist.cgi?component=Vulnerabilities&amp;product=Gentoo%20Security&amp;bug_status=__open__"
      target="_blank">show other bugs</a>)
</td>
    </tr>
        
    
        
    <tr><th class="field_label "
    id="field_label_rep_platform">


  <a 
      title="The hardware platform the bug was observed on. Note: When searching, selecting the option &quot;All&quot; only finds bugs whose value for this field is literally the word &quot;All&quot;."
      class="field_help_link"
      href="page.cgi?id=fields.html#rep_platform"
  >Hardware:</a>

</th>
      <td class="field_value">All
        Linux
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          
          <tr>
      <th class="field_label">
        <label  accesskey="i">
          <a href="page.cgi?id=fields.html#importance"><u>I</u>mportance</a></label>:
      </th>
      <td>High
       major<span id="votes_container">
    (<a href="page.cgi?id=voting/user.html&amp;bug_id=103555#vote_103555">vote</a>)
  </span>
      </td>
    </tr>
          
          <tr><th class="field_label "
    id="field_label_assigned_to">


  <a 
      title="The person in charge of resolving the bug."
      class="field_help_link"
      href="page.cgi?id=fields.html#assigned_to"
  >Assignee:</a>

</th>
      <td><span class="vcard"><span class="fn">Gentoo Security</span>
</span>
      </td>
    </tr>

    <script type="text/javascript">
      assignToDefaultOnChange(['product', 'component'],
        'security\x40gentoo.org',
        '');
    </script>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr><th class="field_label "
    id="field_label_bug_file_loc">


  <a 
      title="Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen."
      class="field_help_link"
      href="page.cgi?id=fields.html#bug_file_loc"
  >URL:</a>

</th>
    <td>
      <span id="bz_url_input_area">
      </span>
    </td>
  </tr>

    <tr><th class="field_label "
    id="field_label_status_whiteboard">


  <a 
      title="Each bug has a free-form single line text entry box for adding tags and status information."
      class="field_help_link"
      href="page.cgi?id=fields.html#status_whiteboard"
  >Whiteboard:</a>

</th><td>A2 [glsa] jaervosz  
  </td>
    </tr>

    <tr><th class="field_label "
    id="field_label_keywords">


  <a 
      title="You can add keywords from a defined list to bugs, in order to easily identify and group them."
      class="field_help_link"
      href="describekeywords.cgi"
  >Keywords:</a>

</th>
  <td class="field_value "
      id="field_container_keywords" >

</td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>

          <tr>
    <th class="field_label">
      <label>Duplicates (2)</label>:
    </th>
    <td class="field_value">
      <span id="duplicates"><a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - media-video/mplayer: buffer overflow"
   href="show_bug.cgi?id=103690">103690</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Mplayer 1.0-pre7 and 1.0-pre6 buffer overflow vulnerability"
   href="show_bug.cgi?id=103842">103842</a> 
      </span>
      (<a href="buglist.cgi?bug_id=103690,103842">view as bug list</a>)
    </td>
  </tr>
<tr><th class="field_label "
    id="field_label_dependson">


  <a 
      title="The bugs listed here must be resolved before this bug can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#dependson"
  >Depends on:</a>

</th>

  <td>
    <span id="dependson_input_area">
    </span>

  </td>
  </tr>
  
  <tr><th class="field_label "
    id="field_label_blocked">


  <a 
      title="This bug must be resolved before the bugs listed in this field can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#blocked"
  >Blocks:</a>

</th>

  <td>
    <span id="blocked_input_area">
    </span>

  </td>
  </tr>
          
        </table>
      </td>
      <td>
        <div class="bz_column_spacer">&nbsp;</div>
      </td>
      
      <td id="bz_show_bug_column_2" class="bz_show_bug_column">
        <table>
        <tr>
    <th class="field_label">
      Reported:
    </th>
    <td>2005-08-23 22:20 UTC by <span class="vcard"><span class="fn">Sune Kloppenborg Jeppesen (RETIRED)</span>
</span>
    </td>
  </tr>
  
  <tr>
    <th class="field_label">
      Modified:
    </th>
    <td>2005-09-09 11:04 UTC
      (<a href="show_activity.cgi?id=103555">History</a>)
    </td>
  
  </tr>
<tr>
      <th class="field_label">
        <label  accesskey="a">
          CC List:
        </label>
      </th>
      <td>4 
          users
          <span id="cc_edit_area_showhide_container" class="bz_default_hidden">
            (<a href="#" id="cc_edit_area_showhide">show</a>)
          </span>
        <div id="cc_edit_area">
          <br>
            <select id="cc" multiple="multiple" size="5" >
                <option value="carlo">carlo</option>
                <option value="media-video">media-video</option>
                <option value="ogolberg">ogolberg</option>
                <option value="rockoo">rockoo</option>
            </select>
        </div>
          <script type="text/javascript">
            hideEditableField( 'cc_edit_area_showhide_container', 
                               'cc_edit_area', 
                               'cc_edit_area_showhide', 
                               '', 
                               '');  
          </script>
      </td>
    </tr>

<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_see_also">


  <a 
      title="This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields."
      class="field_help_link"
      href="page.cgi?id=fields.html#see_also"
  >See Also:</a>

</th>
  <td class="field_value "
      id="field_container_see_also" >

</td>
    </tr> 
<tr>
      <th class="field_label "
    id="field_label_cf_stabilisation_atoms">


  <a 
      title="Contains a list of packages (and optionally, architectures) to keyword or stabilize. One fully qualified package per line, optionally followed by a space-delimited list of architectures for that package."
      class="field_help_link"
      href="page.cgi?id=fields.html#cf_stabilisation_atoms"
  >Package list:</a>

</th>
  <td class="field_value "
      id="field_container_cf_stabilisation_atoms" >
      <div class="uneditable_textarea"></div>

</td>
    </tr>
    <tr>
      <th class="field_label "
    id="field_label_cf_runtime_testing_required">


  <a 
      title="Indicate if runtime testing is required for this stabilisation request, or if it is sufficient to stabilised with a build/tests/qa test."
      class="field_help_link"
      href="page.cgi?id=fields.html#cf_runtime_testing_required"
  >Runtime testing required:</a>

</th>
  <td class="field_value "
      id="field_container_cf_runtime_testing_required" >---

</td>
    </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>



        </table>
      </td>
    </tr>
    <tr>
      <td colspan="3">
          <hr id="bz_top_half_spacer">
      </td>
    </tr>
  </table>

  <table id="bz_big_form_parts">
  <tr>
  <td>

    
<script type="text/javascript">
<!--
function toggle_display(link) {
    var table = document.getElementById("attachment_table");
    var view_all = document.getElementById("view_all");
    var hide_obsolete_url_parameter = "&hide_obsolete=1";
    // Store current height for scrolling later
    var originalHeight = table.offsetHeight;
    var rows = YAHOO.util.Dom.getElementsByClassName(
        'bz_tr_obsolete', 'tr', table);

    for (var i = 0; i < rows.length; i++) {
        bz_toggleClass(rows[i], 'bz_default_hidden');
    }

    if (YAHOO.util.Dom.hasClass(rows[0], 'bz_default_hidden')) {
        link.innerHTML = "Show Obsolete";
        view_all.href = view_all.href + hide_obsolete_url_parameter 
    }
    else {
        link.innerHTML = "Hide Obsolete";
        view_all.href = view_all.href.replace(hide_obsolete_url_parameter,"");
    }

    var newHeight = table.offsetHeight;
    // This scrolling makes the window appear to not move at all.
    window.scrollBy(0, newHeight - originalHeight);

    return false;
}
//-->
</script>

<br>
<table id="attachment_table">
  <tr id="a0">
    <th colspan="3" class="left">
      Attachments
    </th>
  </tr>


      <tr id="a1" class="bz_contenttype_text_plain">
        <td>
            <a href="attachment.cgi?id=66878"
               title="View the content of the attachment">
          <b>poc</b></a>

          <span class="bz_attach_extra_info">
              (mplayer.c,2.44 KB,
                text/plain)

            <br>
            <a href="#attach_66878"
               title="Go to the comment associated with the attachment">2005-08-25 10:38 UTC</a>,

            <span class="vcard"><span class="fn">Tavis Ormandy (RETIRED)</span>
</span>
          </span>
        </td>

          <td class="bz_attach_flags">
              <i>no flags</i>
          </td>

        <td>
          <a href="attachment.cgi?id=66878&amp;action=edit">Details</a>
        </td>
      </tr>

  <tr class="bz_attach_footer">
    <td colspan="3">
        <span class="bz_attach_view_hide">
            <a id="view_all" href="attachment.cgi?bugid=103555&amp;action=viewall">View All</a>
        </span>
        <a href="attachment.cgi?bugid=103555&amp;action=enter">Add an attachment</a>
        (proposed patch, testcase, etc.)
    </td>
  </tr>
</table>
<br>
<div id="add_comment" class="bz_section_additional_comments">
      <table>
        <tr>
          <td>
            <fieldset>
              <legend>Note</legend>
              You need to
              <a href="show_bug.cgi?id=103555&amp;GoAheadAndLogIn=1">log in</a>
              before you can comment on or make changes to this bug.
            </fieldset>
          </td>
        </tr> 
      </table>
  </div>
  </td>
  <td>
  </td>
  </tr></table>

  
  <div id="comments"><script src="js/comments.js?1635279621" type="text/javascript">
</script>

<script type="text/javascript">
<!--
  /* Adds the reply text to the 'comment' textarea */
  function replyToComment(id, real_id, name) {
      var prefix = "(In reply to " + name + " from comment #" + id + ")\n";
      var replytext = "";
        /* pre id="comment_name_N" */
        var text_elem = document.getElementById('comment_text_'+id);
        var text = getText(text_elem);
        replytext = prefix + wrapReplyText(text);


      /* <textarea id="comment"> */
      var textarea = document.getElementById('comment');
      if (textarea.value != replytext) {
          textarea.value += replytext;
      }

      textarea.focus();
  } 
//-->
</script>


<!-- This auto-sizes the comments and positions the collapse/expand links 
     to the right. -->
<table class="bz_comment_table">
<tr>
<td>
<div id="c0" class="bz_comment bz_first_comment">

      <div class="bz_first_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c0">Description</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Sune Kloppenborg Jeppesen (RETIRED)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
        </span>

        <span class="bz_comment_time">
          2005-08-23 22:20:02 UTC
        </span>

      </div>




<pre class="bz_comment_text">Not sure this one is valid. Auditors please confirm: 
 
Advisory: mplayer buffer overflow 
 
Product:          mplayer 
Affected Version: 1.0_pre7 (tested), 1.0_pre6-r4 (tested), 
1.0pre6-3.3.5-20050130 (confirmed) 
OS affected:      Linux 2.4.* (tested), 2.6.* (confirmed), other OS not 
tested 
Date:             24.08.2005 
Author:           Sven Tantau - <a href="http://www.sven-tantau.de/">http://www.sven-tantau.de/</a> 
Advisory-URL: 
<a href="http://www.sven-tantau.de/public_files/mplayer/mplayer_20050824.txt">http://www.sven-tantau.de/public_files/mplayer/mplayer_20050824.txt</a> 
Vendor-URL:       <a href="http://www.mplayerhq.hu/">http://www.mplayerhq.hu/</a> 
Vendor-Status:    informed 
 
 
Product 
======= 
 
<span class="quote">&gt;&gt; man mplayer </span >
 
DESCRIPTION 
mplayer  is  a movie player for Linux (runs on many other platforms and 
CPU architectures, see the documentation).  It plays most 
MPEG/VOB, AVI, ASF/WMA/WMV, RM, QT/MOV/MP4, OGG/OGM, MKV, VIVO, FLI, 
NuppelVideo, yuv4mpeg, FILM and RoQ files, supported by many 
native and binary codecs.  You can watch VideoCD, SVCD, DVD, 3ivx, DivX 
3/4/5 and even WMV movies, too. 
 
... 
 
Details 
======= 
 
For high values of the 2 bytes strf parameter in the audio header of a 
video file, it is possible to overflow sh_audio-&gt;a_buffer, overwrite the 
instruction pointer and execute arbitrary code. 
 
Not sure, but I think the problem is in: 
 
af.c: int af_calc_insize_constrained(af_stream_t* s, int len,int 
max_outsize,int max_insize); 
 
...as this function is used to calculate declen in dec_audio.c, and 
declen is supposed to prevent an overflow. 
 
Instruction pointer gets overwritten in: 
libmpdemux/demuxer.c: int demux_read_data(demux_stream_t *ds,unsigned 
char* mem,int len); 
 
If would like to reproduce this or write an exploit: 
Get a copy of 'Animaniacs - Nations of the World.avi'. 
(md5: 5ef6428a55c7b00095e2cb5554490acf sha1: 
1deeb9640f9864cd5b3db04ffc9a660039a172e4) 
Watch it.  :) 
Patch offset 0x12B to 0xFF. Use gdb. Have fun. 
 
 
History 
======= 
 
2005-08-10 issue found by Sven Tantau 
2005-08-16 vendor contacted and public disclosure 
2005-08-24 no reaction from mplayer team, posting to full disclosure</pre>
    </div>

    <div id="c1" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c1">Comment 1</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Thierry Carrez (RETIRED)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
        </span>

        <span class="bz_comment_time">
          2005-08-24 07:13:12 UTC
        </span>

      </div>




<pre class="bz_comment_text">Setting to Auditing pending a confirmation.</pre>
    </div>

    <div id="c2" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c2">Comment 2</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Tavis Ormandy (RETIRED)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
        </span>

        <span class="bz_comment_time">
          2005-08-25 07:19:00 UTC
        </span>

      </div>




<pre class="bz_comment_text">*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - media-video/mplayer: buffer overflow"
   href="show_bug.cgi?id=103690">Bug 103690</a> has been marked as a duplicate of this bug. ***</pre>
    </div>

    <div id="c3" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c3">Comment 3</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Tavis Ormandy (RETIRED)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
        </span>

        <span class="bz_comment_time">
          2005-08-25 07:19:25 UTC
        </span>

      </div>




<pre class="bz_comment_text">confirmed, definitely exploitable.</pre>
    </div>

    <div id="c4" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c4">Comment 4</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Tavis Ormandy (RETIRED)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
        </span>

        <span class="bz_comment_time">
          2005-08-25 10:38:12 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class=""><a href="attachment.cgi?id=66878" name="attach_66878" title="poc">attachment 66878</a> [<a href="attachment.cgi?id=66878&amp;action=edit" title="poc">details</a>]</span>
poc

the quick code I wrote to confirm vulnerability.</pre>
    </div>

    <div id="c5" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c5">Comment 5</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Reimar Döffinger</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-08-26 05:44:49 UTC
        </span>

      </div>




<pre class="bz_comment_text">This should fix it: <a href="http://www1.mplayerhq.hu/cgi-bin/cvsweb.cgi/main/">http://www1.mplayerhq.hu/cgi-bin/cvsweb.cgi/main/</a>
libmpcodecs/ad_pcm.c.diff?r1=1.18&amp;r2=1.19
A workaround without recompiling should be adding &quot;ac=-pcm,&quot; to the config file.
Exploiting this in more recent version should be more difficult due to a 
behaviour change that causes audio not to be played.</pre>
    </div>

    <div id="c6" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c6">Comment 6</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Tavis Ormandy (RETIRED)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
        </span>

        <span class="bz_comment_time">
          2005-08-26 10:34:48 UTC
        </span>

      </div>




<pre class="bz_comment_text">*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Mplayer 1.0-pre7 and 1.0-pre6 buffer overflow vulnerability"
   href="show_bug.cgi?id=103842">Bug 103842</a> has been marked as a duplicate of this bug. ***</pre>
    </div>

    <div id="c7" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c7">Comment 7</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Luca Barbato</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
        </span>

        <span class="bz_comment_time">
          2005-08-26 18:58:37 UTC
        </span>

      </div>




<pre class="bz_comment_text">pre7-r1 in cvs waiting for stabilization</pre>
    </div>

    <div id="c8" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c8">Comment 8</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Thierry Carrez (RETIRED)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
        </span>

        <span class="bz_comment_time">
          2005-08-27 01:33:33 UTC
        </span>

      </div>




<pre class="bz_comment_text">Arches, please test and mark stable.
Target KEYWORDS=&quot;alpha amd64 hppa ia64 ppc ppc64 sparc x86&quot;

Let the maintainer know if some of you need a backport on pre6...</pre>
    </div>

    <div id="c9" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c9">Comment 9</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Reimar Döffinger</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-08-27 01:46:11 UTC
        </span>

      </div>




<pre class="bz_comment_text">Who can reproduce the exploit? Because I compiled pre7 on Debian and it did have 
no effect at all on eip (but it seemed to break the X Display info, so it 
crashed later on). My Gentoo system is 64bit, so it won't work there either...</pre>
    </div>

    <div id="c10" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c10">Comment 10</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Tavis Ormandy (RETIRED)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
        </span>

        <span class="bz_comment_time">
          2005-08-27 02:23:23 UTC
        </span>

      </div>




<pre class="bz_comment_text">(In reply to <a href="show_bug.cgi?id=103555#c9">comment #9</a>)
<span class="quote">&gt; Who can reproduce the exploit? Because I compiled pre7 on Debian and it did </span >
have 
<span class="quote">&gt; no effect at all on eip (but it seemed to break the X Display info, so it 
&gt; crashed later on). My Gentoo system is 64bit, so it won't work there either...</span >

Reimar, it was only a quick example to reproduce the crash as the instructions 
provided in the original advisory were not very helpful. It would take much more 
work to make a general purpose, work everywhere exploit and my motivation was 
simply to satisfy myself that this issue could be exploited. If you want to 
confirm it can be exploited, you will have to modify it to work on your system:

run mplayer on the exploit.avi in gdb, and break on the decode_video function:

$ gdb -q
(gdb) file mplayer
Reading symbols from /usr/bin/mplayer...done.
Using host libthread_db library &quot;/lib/tls/libthread_db.so.1&quot;.
(gdb) break decode_video
Breakpoint 1 at 0x80ed814: file dec_video.c, line 303.
(gdb) r -really-quiet -vo sdl exploit.avi 
[Thread debugging using libthread_db enabled]
[New Thread 1091755168 (LWP 8887)]
[Switching to Thread 1091755168 (LWP 8887)]

Breakpoint 1, decode_video (sh_video=0x86949d8, 
    start=0x8715d58 '\220' &lt;repeats 200 times&gt;..., in_size=141647192, 
    drop_frame=0) at dec_video.c:303
303     unsigned int t=GetTimer();

confirm the buffer at *start contains the exploit code:

(gdb) x/10x 0x8715d58
0x8715d58:      0x90909090      0x90909090      0x90909090      0x90909090
0x8715d68:      0x90909090      0x90909090      0x90909090      0x90909090
0x8715d78:      0x90909090      0x90909090

yes, this is the nop sled..

now recompile the exploit with the ADDR defined as somewhere in this buffer.

$ mplayer -really-quiet -vo sdl /home/taviso/exploit.avi 
SDL: Using driver: x11
SDL: deactivating XScreensaver/DPMS
SDL: X11 Resolution 1280x1024
SDL: Using 0x32315659 (Planar YV12) image format
SDL: using hardware-surface
uid=1000(taviso) gid=100(users) groups=5(tty),6(disk),10(wheel)

You must use sdl, as the exploit overwrites one of libsdl's function pointers 
that gets executed via vo_sdl, there are other targets, but this was only a 
quick demonstration. If I set the exploit to use 0xdeadbeef, you can see how it 
reaches the sdl function pointer:

Program received signal SIGSEGV, Segmentation fault.
[Switching to Thread 1091755168 (LWP 9195)]
0xdeadbeef in ?? ()
(gdb) bt
#0  0xdeadbeef in ?? ()
#1  0x407f19c2 in SDL_ListModes (format=0xdeadbeef, flags=3221225473)
    at SDL_video.c:341
#2  0x080d6615 in sdl_open (plugin=0x0, name=0x0) at vo_sdl.c:478
#3  0x080d6c60 in config (width=156, height=88, d_width=156, d_height=88, 
    flags=0, title=0xc0000001 &lt;Address 0xc0000001 out of bounds&gt;, 
    format=842094169) at vo_sdl.c:850
#4  0x080f6ba4 in config (vf=0x873e270, width=156, height=88, d_width=156, 
    d_height=88, flags=0, outfmt=842094169) at vf_vo.c:48
#5  0x080edd6c in mpcodecs_config_vo (sh=0x86949d8, w=88, h=156, 
    preferred_outfmt=3221225473) at vd.c:312
#6  0x080f0d63 in init_vo (sh=0x86949d8, pix_fmt=PIX_FMT_YUV420P)
    at vd_ffmpeg.c:512
#7  0x080f0ea4 in get_buffer (avctx=0x873d3a0, pic=0x8745028)
    at vd_ffmpeg.c:563
#8  0x083049e5 in cinepak_decode_frame (avctx=0x873d3a0, data=0x873e390, 
    data_size=0xc0000001, buf=0xc0000001 &lt;Address 0xc0000001 out of bounds&gt;, 
    buf_size=8192) at cinepak.c:396
#9  0x081d5f80 in avcodec_decode_video (avctx=0x873d3a0, picture=0xc0000001, 
    got_picture_ptr=0xbfffc3fc, 
    buf=0xc0000001 &lt;Address 0xc0000001 out of bounds&gt;, buf_size=-1073741823)
    at utils.c:536
#10 0x080f12db in decode (sh=0x86949d8, data=0x8715d60, len=8192, flags=0)
    at vd_ffmpeg.c:765
#11 0x080ed83e in decode_video (sh_video=0x86949d8, 
    start=0xc0000001 &lt;Address 0xc0000001 out of bounds&gt;, in_size=-1073741823, 
    drop_frame=0) at dec_video.c:309
#12 0x080a0a90 in main (argc=2, argv=0xbfffd804) at mplayer.c:2302
(gdb) ptype current_video 
type = struct SDL_VideoDevice {
    const char *name;
    int (*VideoInit)(SDL_VideoDevice *, SDL_PixelFormat *);
    SDL_Rect **(*ListModes)(SDL_VideoDevice *, SDL_PixelFormat *, Uint32);
...
(gdb) info addr current_video
Symbol &quot;current_video&quot; is static storage at address 0x4081a400.
(gdb) info symbol 0x4081a400
current_video in section .bss

The function pointer overwritten is part of the `current_video` struct owned by 
libSDL. It's possible you're using different features or configuration that 
means something else gets interrupted before sdl gets a chance to init, if so 
you will just have to take my word that this is definitely a serious security 
issue that could be exploited by someone willing to put some work into 
developing a reliable exploit.

SDL_Rect ** SDL_ListModes (SDL_PixelFormat *format, Uint32 flags)
{
    SDL_VideoDevice *video = current_video;
    SDL_VideoDevice *this  = current_video;
    SDL_Rect **modes;

    modes = NULL;
    if ( SDL_VideoSurface ) {
        if ( format == NULL ) {
            format = SDL_VideoSurface-&gt;format;
        }
        modes = video-&gt;ListModes(this, format, flags); /* &lt;--- */
    }
    return(modes);
}
</pre>
    </div>

    <div id="c11" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c11">Comment 11</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Reimar Döffinger</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-08-27 04:31:12 UTC
        </span>

      </div>




<pre class="bz_comment_text">Thanks for that extensive reply, I asked mostly out of personal interest.
And also because I wanted to know what we have lying around on the heap, maybe 
some of it can be moved to read-only places, making exploits more difficult.
Would be an interesting project if I happen to have too much time somewhen *g*.</pre>
    </div>

    <div id="c12" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c12">Comment 12</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Luca Barbato</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
        </span>

        <span class="bz_comment_time">
          2005-08-27 05:16:09 UTC
        </span>

      </div>




<pre class="bz_comment_text">hppa and ia64 were already pre7
ppc marked.

Removing them.</pre>
    </div>

    <div id="c13" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c13">Comment 13</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Markus Rothe (RETIRED)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
        </span>

        <span class="bz_comment_time">
          2005-08-27 05:37:46 UTC
        </span>

      </div>




<pre class="bz_comment_text">stable on ppc64</pre>
    </div>

    <div id="c14" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c14">Comment 14</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Marcus D. Hanwell (RETIRED)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
        </span>

        <span class="bz_comment_time">
          2005-08-27 17:28:01 UTC
        </span>

      </div>




<pre class="bz_comment_text">Stable on amd64. </pre>
    </div>

    <div id="c15" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c15">Comment 15</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Thierry Carrez (RETIRED)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
        </span>

        <span class="bz_comment_time">
          2005-08-29 00:45:53 UTC
        </span>

      </div>




<pre class="bz_comment_text">CAN number was asked.</pre>
    </div>

    <div id="c16" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c16">Comment 16</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Thierry Carrez (RETIRED)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
        </span>

        <span class="bz_comment_time">
          2005-08-30 00:22:34 UTC
        </span>

      </div>




<pre class="bz_comment_text">======================================================
Candidate: CAN-2005-2718
URL: <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2005-2718">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2005-2718</a>
Reference: FULLDISC:20050824 mplayer overflow
Reference: URL:<a href="http://marc.theaimsgroup.com/?l=full-disclosure&amp;m=112484733122809&amp;w=2">http://marc.theaimsgroup.com/?l=full-disclosure&amp;m=112484733122809&amp;w=2</a>
Reference: MISC:<a href="http://www.sven-tantau.de/public_files/mplayer/mplayer_20050824.txt">http://www.sven-tantau.de/public_files/mplayer/mplayer_20050824.txt</a>
Reference: CONFIRM:<a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED FIXED - media-video/mplayer: buffer overflow (CAN-2005-2718)"
   href="show_bug.cgi?id=103555">https://bugs.gentoo.org/show_bug.cgi?id=103555</a>

Buffer overflow in ad_pcm.c in MPlayer 1.0pre7 and earlier allows
remote attackers to execute arbitrary code via a video file with an
audio header containing a large value in a strf parameter.</pre>
    </div>

    <div id="c17" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c17">Comment 17</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Gustavo Zacarias (RETIRED)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
        </span>

        <span class="bz_comment_time">
          2005-08-30 06:09:22 UTC
        </span>

      </div>




<pre class="bz_comment_text">Stable on sparc - not flawless but it never was anyway.
</pre>
    </div>

    <div id="c18" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c18">Comment 18</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Ian Leitch (RETIRED)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
        </span>

        <span class="bz_comment_time">
          2005-08-30 06:30:40 UTC
        </span>

      </div>




<pre class="bz_comment_text">Sorry about the wait, x86 will be done in a few houres.</pre>
    </div>

    <div id="c19" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c19">Comment 19</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Ian Leitch (RETIRED)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
        </span>

        <span class="bz_comment_time">
          2005-08-30 10:53:18 UTC
        </span>

      </div>




<pre class="bz_comment_text">Stable on x86.</pre>
    </div>

    <div id="c20" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c20">Comment 20</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Thierry Carrez (RETIRED)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
        </span>

        <span class="bz_comment_time">
          2005-09-01 01:07:53 UTC
        </span>

      </div>




<pre class="bz_comment_text">Alpha was apparently marked stable without comment.</pre>
    </div>

    <div id="c21" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c21">Comment 21</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Thierry Carrez (RETIRED)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
        </span>

        <span class="bz_comment_time">
          2005-09-01 04:48:10 UTC
        </span>

      </div>




<pre class="bz_comment_text">GLSA 200509-01</pre>
    </div>

    <div id="c22" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c22">Comment 22</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Reimar Döffinger</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-09-08 07:20:14 UTC
        </span>

      </div>




<pre class="bz_comment_text">IMHO none of the advisories/whatever describes the issue 100% correctly.

<span class="quote">&gt; Buffer overflow in ad_pcm.c in MPlayer 1.0pre7 and earlier allows
&gt; remote attackers to execute arbitrary code via a video file with an
&gt; audio header containing a large value in a strf parameter.</span >

It is not a strf parameter, it is a strf chunk. And in this case the
one for the audio that contains the WAVEHEADEREX struct.
High values in nChannels and wBitsPerSample in that struct can be used
to exploit it.
Also it should be possible to exploit with any container, i.e. wav, mov,
etc. Anything that can contain raw PCM and allows to set either sample
size or channel count to arbitrary numbers.
Correct me if you think I'm wrong.</pre>
    </div>

    <div id="c23" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c23">Comment 23</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Thierry Carrez (RETIRED)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
            <img src="https://bugs.gentoo.org/images/ranks/bugs-rank-dev.png"
                 alt="gentoo-dev"
                 title="gentoo-dev - Gentoo Developers">
        </span>

        <span class="bz_comment_time">
          2005-09-08 07:55:46 UTC
        </span>

      </div>




<pre class="bz_comment_text">You must be correct, as I'm getting lost in chunks, structs and headers...
Would the following change in our GLSA describe the issue more correctly :

&quot;Sven Tantau discovered a heap overflow in the code handling the WAVEHEADEREX
struct of raw PCM audio streams.&quot;

Do you see any other needed change (like in the Title or Synopsis) ?</pre>
    </div>

    <div id="c24" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="#c24">Comment 24</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Reimar Döffinger</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-09-09 11:04:31 UTC
        </span>

      </div>




<pre class="bz_comment_text">I'd suggest
&quot;Sven Tantau discovered a heap overflow in the code handling raw PCM audio 
streams with large channel count or sample size.&quot;
Mentioning WAVEHEADEREX is confusing IMHO, since it does not really matter how 
the number of channels/samplesize was specified.</pre>
    </div>


  

</td>
<td>
</td>
</tr></table>
  </div>
        

</form>

<hr>
<ul class="related_actions">
    <li><a href="show_bug.cgi?format=multiple&amp;id=103555">Format For Printing</a></li>
    <li>&nbsp;-&nbsp;<a href="show_bug.cgi?ctype=xml&amp;id=103555">XML</a></li>
    <li>&nbsp;-&nbsp;<a href="enter_bug.cgi?cloned_bug_id=103555">Clone This Bug</a></li>
    <li>&nbsp;-&nbsp;<a href="enter_bug.cgi?cloned_bug_id=103555&product=Gentoo%20Security">Clone In The Same 
                        Product</a></li>
    
    <li>&nbsp;-&nbsp;<a href="#">Top of page </a></li>
    </ul>

<br>
</div>

    <div id="footer">
      <div class="intro"></div>
<ul id="useful-links">
  <li id="links-actions"><ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi?format=guided">New</a>&ndash;<a href="enter_bug.cgi">[Ex]</a></li>
  <li><span class="separator">| </span><a href="describecomponents.cgi">Browse</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>
  <li><span class="separator">| </span><a href="https://wiki.gentoo.org/wiki/Foundation:Privacy_Policy">Privacy Policy</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_bottom" name="no_redirect" value="0">
    <script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_bottom");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_bottom" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_bottom"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li>
      <span class="separator">| </span>
        <a href="request.cgi">Requests</a></li>


  <li>
        <span class="separator">| </span>
        <a href="https://bugzilla.readthedocs.org/en/5.0/using/understanding.html" target="_blank">Help</a>
      </li>
    
      <li id="new_account_container_bottom">
        <span class="separator">| </span>
        <a href="createaccount.cgi">New&nbsp;Account</a>
      </li>

    <li id="mini_login_container_bottom">
  <span class="separator">| </span>
  <a id="login_link_bottom" href="show_bug.cgi?id=103555&amp;GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('_bottom')">Log In</a>

  <form action="show_bug.cgi?id=103555" method="POST"
        class="mini_login bz_default_hidden"
        id="mini_login_bottom">
    <input id="Bugzilla_login_bottom" required
           name="Bugzilla_login" class="bz_login"
        type="email" placeholder="Email Address">
    <input class="bz_password" name="Bugzilla_password" type="password"
           id="Bugzilla_password_bottom" required
           placeholder="Password">
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
            id="log_in_bottom">
    <a href="#" onclick="return hide_mini_login_form('_bottom')">[x]</a>
  </form>
</li>


  <li id="forgot_container_bottom">
    <span class="separator">| </span>
    <a id="forgot_link_bottom" href="show_bug.cgi?id=103555&amp;GoAheadAndLogIn=1#forgot"
       onclick="return show_forgot_form('_bottom')">Forgot Password</a>
    <form action="token.cgi" method="post" id="forgot_form_bottom"
          class="mini_forgot bz_default_hidden">
      <label for="login_bottom">Login:</label>
      <input name="loginname" size="20" id="login_bottom" required
          type="email" placeholder="Your Email Address">
      <input id="forgot_button_bottom" value="Reset Password" type="submit">
      <input type="hidden" name="a" value="reqpw">
      <input type="hidden" id="token_bottom" name="token"
             value="1635619215-ocnhfrBnoHHxB1eJgDVUUPgTuV5FBHqfKviXlYht5eA">
      <a href="#" onclick="return hide_forgot_form('_bottom')">[x]</a>
    </form>
  </li>
</ul>
  </li>

  




  
</ul>

      <div class="outro"></div>
    </div>

  </body>
</html>