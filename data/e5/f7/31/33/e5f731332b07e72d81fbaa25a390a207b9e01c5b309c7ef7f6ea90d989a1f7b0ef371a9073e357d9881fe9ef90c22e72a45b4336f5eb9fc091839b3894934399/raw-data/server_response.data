<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>d77f1999ecece56c1cbb333f4ddc26f0b5bac2c5 - platform/system/bt - Git at Google</title><link rel="stylesheet" type="text/css" href="/+static/base.css"><!-- default customHeadTagPart --></head><body class="Site"><header class="Site-header"><div class="Header"><a class="Header-image" href="/"><img src="//www.gstatic.com/images/branding/lockups/2x/lockup_git_color_108x24dp.png" width="108" height="24" alt="Google Git"></a><div class="Header-menu"> <a class="Header-menuItem" href="https://accounts.google.com/AccountChooser?service=gerritcodereview&amp;continue=https://android.googlesource.com/login/platform/system/bt/%2B/d77f1999ecece56c1cbb333f4ddc26f0b5bac2c5">Sign in</a> </div></div></header><div class="Site-content"><div class="Container "><div class="Breadcrumbs"><a class="Breadcrumbs-crumb" href="/?format=HTML">android</a> / <a class="Breadcrumbs-crumb" href="/platform/">platform</a> / <a class="Breadcrumbs-crumb" href="/platform/system/">system</a> / <a class="Breadcrumbs-crumb" href="/platform/system/bt/">bt</a> / <span class="Breadcrumbs-crumb">d77f1999ecece56c1cbb333f4ddc26f0b5bac2c5</span></div><div class="u-monospace Metadata"><table><tr><th class="Metadata-title">commit</th><td>d77f1999ecece56c1cbb333f4ddc26f0b5bac2c5</td><td><span>[<a href="/platform/system/bt/+log/d77f1999ecece56c1cbb333f4ddc26f0b5bac2c5">log</a>]</span> <span>[<a href="/platform/system/bt/+archive/d77f1999ecece56c1cbb333f4ddc26f0b5bac2c5.tar.gz">tgz</a>]</span></td></tr><tr><th class="Metadata-title">author</th><td>Marie Janssen &lt;jamuraa@google.com&gt;</td><td>Wed Dec 09 10:08:25 2015 -0800</td></tr><tr><th class="Metadata-title">committer</th><td>Marie Janssen &lt;jamuraa@google.com&gt;</td><td>Thu Dec 10 01:26:43 2015 +0000</td></tr><tr><th class="Metadata-title">tree</th><td><a href="/platform/system/bt/+/d77f1999ecece56c1cbb333f4ddc26f0b5bac2c5/">b4902b8ba82ee98c28878ab62dff092858081560</a></td></tr><tr><th class="Metadata-title">parent</th><td><a href="/platform/system/bt/+/d77f1999ecece56c1cbb333f4ddc26f0b5bac2c5%5E">ade7583ddd1877d25d3605be111319e5d8d760e4</a> <span>[<a href="/platform/system/bt/+/d77f1999ecece56c1cbb333f4ddc26f0b5bac2c5%5E%21/">diff</a>]</span></td></tr></table></div><pre class="u-pre u-monospace MetadataMessage">Fix crashes with lots of discovered LE devices

When loads of devices are discovered a config file which is too large
can be written out, which causes the BT daemon to crash on startup.

This limits the number of config entries for unpaired devices which
are initialized, and prevents a large number from being saved to the
filesystem.

Bug: 26071376
Change-Id: <a href="https://android-review.googlesource.com/#/q/I4a74094f57a82b17f94e99a819974b8bc8082184">I4a74094f57a82b17f94e99a819974b8bc8082184</a>
</pre><ul class="DiffTree"><li><a href="/platform/system/bt/+/d77f1999ecece56c1cbb333f4ddc26f0b5bac2c5/btif/src/btif_config.c">btif/src/btif_config.c</a><span class="DiffTree-action DiffTree-action--modify">[<a href="/platform/system/bt/+/d77f1999ecece56c1cbb333f4ddc26f0b5bac2c5%5E%21/#F0">diff</a>]</span></li></ul><div class="DiffSummary">1 file changed</div><div class="TreeDetail"><div class="u-sha1 u-monospace TreeDetail-sha1">tree: b4902b8ba82ee98c28878ab62dff092858081560</div><ol class="FileList"><li class="FileList-item FileList-item--regularFile" title="Regular file - .gitignore"><a class="FileList-itemLink" href="/platform/system/bt/+/d77f1999ecece56c1cbb333f4ddc26f0b5bac2c5/.gitignore">.gitignore</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - .gn"><a class="FileList-itemLink" href="/platform/system/bt/+/d77f1999ecece56c1cbb333f4ddc26f0b5bac2c5/.gn">.gn</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - Android.mk"><a class="FileList-itemLink" href="/platform/system/bt/+/d77f1999ecece56c1cbb333f4ddc26f0b5bac2c5/Android.mk">Android.mk</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - BUILD.gn"><a class="FileList-itemLink" href="/platform/system/bt/+/d77f1999ecece56c1cbb333f4ddc26f0b5bac2c5/BUILD.gn">BUILD.gn</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - CleanSpec.mk"><a class="FileList-itemLink" href="/platform/system/bt/+/d77f1999ecece56c1cbb333f4ddc26f0b5bac2c5/CleanSpec.mk">CleanSpec.mk</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - HACKING"><a class="FileList-itemLink" href="/platform/system/bt/+/d77f1999ecece56c1cbb333f4ddc26f0b5bac2c5/HACKING">HACKING</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - MODULE_LICENSE_APACHE2"><a class="FileList-itemLink" href="/platform/system/bt/+/d77f1999ecece56c1cbb333f4ddc26f0b5bac2c5/MODULE_LICENSE_APACHE2">MODULE_LICENSE_APACHE2</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - NOTICE"><a class="FileList-itemLink" href="/platform/system/bt/+/d77f1999ecece56c1cbb333f4ddc26f0b5bac2c5/NOTICE">NOTICE</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - audio_a2dp_hw/"><a class="FileList-itemLink" href="/platform/system/bt/+/d77f1999ecece56c1cbb333f4ddc26f0b5bac2c5/audio_a2dp_hw/">audio_a2dp_hw/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - bta/"><a class="FileList-itemLink" href="/platform/system/bt/+/d77f1999ecece56c1cbb333f4ddc26f0b5bac2c5/bta/">bta/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - btcore/"><a class="FileList-itemLink" href="/platform/system/bt/+/d77f1999ecece56c1cbb333f4ddc26f0b5bac2c5/btcore/">btcore/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - btif/"><a class="FileList-itemLink" href="/platform/system/bt/+/d77f1999ecece56c1cbb333f4ddc26f0b5bac2c5/btif/">btif/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - build/"><a class="FileList-itemLink" href="/platform/system/bt/+/d77f1999ecece56c1cbb333f4ddc26f0b5bac2c5/build/">build/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - conf/"><a class="FileList-itemLink" href="/platform/system/bt/+/d77f1999ecece56c1cbb333f4ddc26f0b5bac2c5/conf/">conf/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - device/"><a class="FileList-itemLink" href="/platform/system/bt/+/d77f1999ecece56c1cbb333f4ddc26f0b5bac2c5/device/">device/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - doc/"><a class="FileList-itemLink" href="/platform/system/bt/+/d77f1999ecece56c1cbb333f4ddc26f0b5bac2c5/doc/">doc/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - embdrv/"><a class="FileList-itemLink" href="/platform/system/bt/+/d77f1999ecece56c1cbb333f4ddc26f0b5bac2c5/embdrv/">embdrv/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - hci/"><a class="FileList-itemLink" href="/platform/system/bt/+/d77f1999ecece56c1cbb333f4ddc26f0b5bac2c5/hci/">hci/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - include/"><a class="FileList-itemLink" href="/platform/system/bt/+/d77f1999ecece56c1cbb333f4ddc26f0b5bac2c5/include/">include/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - main/"><a class="FileList-itemLink" href="/platform/system/bt/+/d77f1999ecece56c1cbb333f4ddc26f0b5bac2c5/main/">main/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - osi/"><a class="FileList-itemLink" href="/platform/system/bt/+/d77f1999ecece56c1cbb333f4ddc26f0b5bac2c5/osi/">osi/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - profile/"><a class="FileList-itemLink" href="/platform/system/bt/+/d77f1999ecece56c1cbb333f4ddc26f0b5bac2c5/profile/">profile/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - service/"><a class="FileList-itemLink" href="/platform/system/bt/+/d77f1999ecece56c1cbb333f4ddc26f0b5bac2c5/service/">service/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - stack/"><a class="FileList-itemLink" href="/platform/system/bt/+/d77f1999ecece56c1cbb333f4ddc26f0b5bac2c5/stack/">stack/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - test/"><a class="FileList-itemLink" href="/platform/system/bt/+/d77f1999ecece56c1cbb333f4ddc26f0b5bac2c5/test/">test/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - tools/"><a class="FileList-itemLink" href="/platform/system/bt/+/d77f1999ecece56c1cbb333f4ddc26f0b5bac2c5/tools/">tools/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - udrv/"><a class="FileList-itemLink" href="/platform/system/bt/+/d77f1999ecece56c1cbb333f4ddc26f0b5bac2c5/udrv/">udrv/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - utils/"><a class="FileList-itemLink" href="/platform/system/bt/+/d77f1999ecece56c1cbb333f4ddc26f0b5bac2c5/utils/">utils/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - vendor_libs/"><a class="FileList-itemLink" href="/platform/system/bt/+/d77f1999ecece56c1cbb333f4ddc26f0b5bac2c5/vendor_libs/">vendor_libs/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - vnd/"><a class="FileList-itemLink" href="/platform/system/bt/+/d77f1999ecece56c1cbb333f4ddc26f0b5bac2c5/vnd/">vnd/</a></li></ol></div></div> <!-- Container --></div> <!-- Site-content --><footer class="Site-footer"><div class="Footer"><span class="Footer-poweredBy">Powered by <a href="https://gerrit.googlesource.com/gitiles/">Gitiles</a>| <a href="https://policies.google.com/privacy">Privacy</a></span><span class="Footer-formats"><a class="u-monospace Footer-formatsItem" href="?format=TEXT">txt</a> <a class="u-monospace Footer-formatsItem" href="?format=JSON">json</a></span></div></footer></body></html>