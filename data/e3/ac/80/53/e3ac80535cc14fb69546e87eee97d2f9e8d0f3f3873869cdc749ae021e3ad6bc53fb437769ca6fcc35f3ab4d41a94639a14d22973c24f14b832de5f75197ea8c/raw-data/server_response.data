<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
<title>#34238 - Assertion `num &gt;= 0&#39; failed at regexec.c:1363 - GNU bug report logs</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="robots" content="noindex, nofollow">
<link rel="stylesheet" href="/css/bugs.css" type="text/css">

<script type="text/javascript">
function toggle_infmessages()
{
        allDivs=document.getElementsByTagName("div");
        for (var i = 0 ; i < allDivs.length ; i++ )
        {
                if (allDivs[i].className == "infmessage")
                {
                        allDivs[i].style.display=(allDivs[i].style.display == 'none' | allDivs[i].style.display == '') ? 'block' : 'none';
                }
        }
}
</script>
</head>
<body>
<h1>GNU bug report logs - 
#34238<br/>
Assertion `num &gt;= 0&#39; failed at regexec.c:1363</h1>
<p><a href="bugreport.cgi?bug=34237">Previous</a> <a href="bugreport.cgi?bug=34239">Next</a></p>
<div class="versiongraph"></div>
<div class="pkginfo">
  <p>Package:
     <a class="submitter" href="pkgreport.cgi?package=grep">grep</a>;
</p>
</div>

<div class="buginfo">
  <p>Reported by: <a href="pkgreport.cgi?submitter=leftcopy.chx%40gmail.com">Hongxu Chen &lt;leftcopy.chx &lt;at&gt; gmail.com&gt;</a></p>
  <p>Date: Tue, 29 Jan 2019 02:58:02 UTC</p>

<p>Severity: normal</p>
<p></p>
<p>Merged with <a href="bugreport.cgi?bug=22793">22793</a>,
<a href="bugreport.cgi?bug=32806">32806</a>,
<a href="bugreport.cgi?bug=42946">42946</a></p>




</div>

<p>To reply to this bug, email your comments to 34238 AT debbugs.gnu.org.
<p><a href="javascript:toggle_infmessages();">Toggle</a> the display of automated, internal messages from the tracker.</p><div class="msgreceived"><p>View this report as an <a href="bugreport.cgi?bug=34238;mbox=yes" title="Folder with messages as they arrived at the tracker">mbox folder</a>, <a href="bugreport.cgi?mboxstat=yes;bug=34238" title="Folder with a status summary message at the start">status mbox</a>, <a href="bugreport.cgi?bug=34238;mboxmaint=yes;mbox=yes" title="Folder of messages as sent from the tracker to the maintainers">maintainer mbox</a></p></div>

<div class="infmessage"><hr>
<a name="1"></a>
<!-- request_addr: bug-grep &lt;at&gt; gnu.org -->
<!-- time:1548730682 -->
<strong>Report forwarded</strong>
to <code>bug-grep &lt;at&gt; gnu.org</code>:<br>
<code>bug#34238</code>; Package <code>grep</code>.
 (Tue, 29 Jan 2019 02:58:02 GMT) <a href="bugreport.cgi?bug=34238;msg=2">Full text</a> and <a href="bugreport.cgi?mbox=yes;msg=2;bug=34238">rfc822 format</a> available.</div>

<div class="infmessage"><hr>
<a name="3"></a>
<!-- request_addr: Hongxu Chen &lt;leftcopy.chx &lt;at&gt; gmail.com&gt; -->
<!-- time:1548730682 -->
<strong>Acknowledgement sent</strong>
to <code>Hongxu Chen &lt;leftcopy.chx &lt;at&gt; gmail.com&gt;</code>:<br>
New bug report received and forwarded.  Copy sent to <code>bug-grep &lt;at&gt; gnu.org</code>.
 (Tue, 29 Jan 2019 02:58:02 GMT) <a href="bugreport.cgi?msg=4;bug=34238">Full text</a> and <a href="bugreport.cgi?bug=34238;mbox=yes;msg=4">rfc822 format</a> available.</div>

<hr><p class="msgreceived"><a name="5"></a><a name="msg5"></a><a href="#5">Message #5</a> received at submit &lt;at&gt; debbugs.gnu.org (<a href="bugreport.cgi?msg=5;bug=34238">full text</a>, <a href="bugreport.cgi?bug=34238;mbox=yes;msg=5">mbox</a>):</p>
<pre class="headers">
<b>From:</b> Hongxu Chen &lt;leftcopy.chx &lt;at&gt; gmail.com&gt;
<b>To:</b> bug-grep &lt;at&gt; gnu.org
<b>Subject:</b> Assertion `num &gt;= 0&#39; failed at regexec.c:1363
<b>Date:</b> Tue, 29 Jan 2019 10:57:18 +0800
</pre>
<pre class="mime">[<a href="bugreport.cgi?bug=34238;att=0;msg=5">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message">Hi,

    GNU grep 3.3.7-8df7 (and other versions such as 3.1) may trigger an
assertion failure by executing the following command.

    echo | grep -f regex.grep

Reading symbols from ./grep...done.
gdb$ run
Starting program: /home/hongxu/FOT/grep-asan/install/bin/grep -q -f
assert_regexec.c:1363.grep assert_regexec.c:1363.input
[Thread debugging using libthread_db enabled]
Using host libthread_db library &quot;/lib/x86_64-linux-gnu/libthread_db.so.1&quot;.
grep: ./regexec.c:1363: Idx pop_fail_stack(struct re_fail_stack_t *, Idx *,
Idx, regmatch_t *, re_node_set *): Assertion `num &gt;= 0&#39; failed.

Program received signal SIGABRT, Aborted.
__GI_raise (sig=sig &lt;at&gt; entry=0x6) at ../sysdeps/unix/sysv/linux/raise.c:51
51      ../sysdeps/unix/sysv/linux/raise.c: No such file or directory.
gdb$ bt
#0  __GI_raise (sig=sig &lt;at&gt; entry=0x6) at ../sysdeps/unix/sysv/linux/raise.c:51
#1  0x00007ffff6bd1801 in __GI_abort () at abort.c:79
#2  0x00007ffff6bc139a in __assert_fail_base (fmt=0x7ffff6d487d8
&quot;%s%s%s:%u: %s%sAssertion `%s&#39; failed.\n%n&quot;, assertion=assertion &lt;at&gt; entry=0x5f8d20
&lt;.str.26&gt; &quot;num &gt;= 0&quot;, file=file &lt;at&gt; entry=0x5f8a60 &lt;.str.22&gt; &quot;./regexec.c&quot;,
line=line &lt;at&gt; entry=0x553, function=function &lt;at&gt; entry=0x5f8d60
&lt;__PRETTY_FUNCTION__.pop_fail_stack&gt; &quot;Idx pop_fail_stack(struct
re_fail_stack_t *, Idx *, Idx, regmatch_t *, re_node_set *)&quot;) at assert.c:92
#3  0x00007ffff6bc1412 in __GI___assert_fail (assertion=0x5f8d20 &lt;.str.26&gt;
&quot;num &gt;= 0&quot;, file=0x5f8a60 &lt;.str.22&gt; &quot;./regexec.c&quot;, line=0x553,
function=0x5f8d60 &lt;__PRETTY_FUNCTION__.pop_fail_stack&gt; &quot;Idx
pop_fail_stack(struct re_fail_stack_t *, Idx *, Idx, regmatch_t *,
re_node_set *)&quot;) at assert.c:101
#4  0x00000000005d08f3 in pop_fail_stack (fs=0x7fffffffa3c0,
pidx=0x7fffffffa360, nregs=0x4, regs=0x606000000740,
eps_via_nodes=0x7fffffffa380) at ./regexec.c:1363
#5  0x00000000005b691b in set_regs (preg=0x60c000000380,
mctx=0x7fffffffa6a0, nmatch=0x4, pmatch=0x606000000740, fl_backtrack=0x1)
at ./regexec.c:1467
#6  0x0000000000588820 in re_search_internal (preg=0x60c000000380,
string=0x7fffffffb8d1 &quot;\n&quot;, length=0x0, start=0x0, last_start=0x0,
stop=0x0, nmatch=0x4, pmatch=0x606000000740, eflags=0x0) at ./regexec.c:864
#7  0x0000000000589aa8 in re_search_stub (bufp=0x60c000000380,
string=0x7fffffffb8d1 &quot;\n&quot;, length=0x0, start=0x0, range=0x0, stop=0x0,
regs=0x607000000430, ret_len=0x0) at ./regexec.c:425
#8  0x0000000000589e32 in rpl_re_search (bufp=0x60c000000380,
string=0x7fffffffb8d1 &quot;\n&quot;, length=0x0, start=0x0, range=0x0,
regs=0x607000000430) at ./regexec.c:289
#9  0x00000000005160fe in EGexecute (vdc=0x607000000410, buf=0x7fffffffb8d1
&quot;\n&quot;, size=0x1, match_size=0x7fffffffb8e0, start_ptr=0x0) at dfasearch.c:357
#10 0x000000000051abec in main (argc=0x5, argv=0x7fffffffbee8) at
grep.c:2894


    regex.grep is attached.

Best Regards,
Hongxu
</pre>
<pre class="mime">[<a href="bugreport.cgi?msg=5;att=1;bug=34238">Message part 2</a> (text/html, inline)]</pre>
<pre class="mime">[<a href="bugreport.cgi?att=2;msg=5;filename=regex.grep;bug=34238">regex.grep</a> (application/octet-stream, attachment)]</pre>

<div class="infmessage"><hr>
<a name="6"></a>
<!-- request_addr: bug-grep &lt;at&gt; gnu.org -->
<!-- time:1548904921 -->
<strong>Information forwarded</strong>
to <code>bug-grep &lt;at&gt; gnu.org</code>:<br>
<code>bug#34238</code>; Package <code>grep</code>.
 (Thu, 31 Jan 2019 03:22:01 GMT) <a href="bugreport.cgi?msg=7;bug=34238">Full text</a> and <a href="bugreport.cgi?mbox=yes;msg=7;bug=34238">rfc822 format</a> available.</div>

<hr><p class="msgreceived"><a name="8"></a><a name="msg8"></a><a href="#8">Message #8</a> received at 34238 &lt;at&gt; debbugs.gnu.org (<a href="bugreport.cgi?bug=34238;msg=8">full text</a>, <a href="bugreport.cgi?bug=34238;mbox=yes;msg=8">mbox</a>):</p>
<pre class="headers">
<b>From:</b> Paul Eggert &lt;eggert &lt;at&gt; cs.ucla.edu&gt;
<b>To:</b> Hongxu Chen &lt;leftcopy.chx &lt;at&gt; gmail.com&gt;
<b>Cc:</b> 34238 &lt;at&gt; debbugs.gnu.org
<b>Subject:</b> Re: bug#34238: Assertion `num &gt;= 0&#39; failed at regexec.c:1363
<b>Date:</b> Wed, 30 Jan 2019 19:21:36 -0800
</pre>
<pre class="message">Thanks for the test case. This appears to be the same as bug#22793 so
I&#39;ll merge them.

<a href="https://debbugs.gnu.org/22793">https://debbugs.gnu.org/22793</a>



</pre>

<div class="msgreceived"><hr>
<a name="9"></a>
<!-- requester: Paul Eggert &lt;eggert &lt;at&gt; cs.ucla.edu&gt; -->
<!-- request_addr: control &lt;at&gt; debbugs.gnu.org -->
<!-- time:1548904982 -->
<strong>Merged <a href="bugreport.cgi?bug=22793">22793</a> <a href="bugreport.cgi?bug=32806">32806</a> <a href="bugreport.cgi?bug=34238">34238</a>.</strong>
Request was from <code>Paul Eggert &lt;eggert &lt;at&gt; cs.ucla.edu&gt;</code>
to <code>control &lt;at&gt; debbugs.gnu.org</code>.
 (Thu, 31 Jan 2019 03:23:02 GMT) <a href="bugreport.cgi?msg=10;bug=34238">Full text</a> and <a href="bugreport.cgi?msg=10;mbox=yes;bug=34238">rfc822 format</a> available.</div>

<div class="msgreceived"><hr>
<a name="11"></a>
<!-- requester: Paul Eggert &lt;eggert &lt;at&gt; cs.ucla.edu&gt; -->
<!-- request_addr: control &lt;at&gt; debbugs.gnu.org -->
<!-- time:1600717922 -->
<strong>Merged <a href="bugreport.cgi?bug=22793">22793</a> <a href="bugreport.cgi?bug=32806">32806</a> <a href="bugreport.cgi?bug=34238">34238</a> <a href="bugreport.cgi?bug=42946">42946</a>.</strong>
Request was from <code>Paul Eggert &lt;eggert &lt;at&gt; cs.ucla.edu&gt;</code>
to <code>control &lt;at&gt; debbugs.gnu.org</code>.
 (Mon, 21 Sep 2020 19:52:02 GMT) <a href="bugreport.cgi?bug=34238;msg=12">Full text</a> and <a href="bugreport.cgi?msg=12;mbox=yes;bug=34238">rfc822 format</a> available.</div>

<hr>
<div class="msgreceived">This bug report was last modified 1 year and 39 days ago.</div>

<hr>
<p><a href="bugreport.cgi?bug=34237">Previous</a> <a href="bugreport.cgi?bug=34239">Next</a></p>
<!--
<p class="msgreceived">Send a report that <a href="//debbugs.gnu.org/cgi/bugspam.cgi">this bug log contains spam</a>.</p> -->
<hr>
<P>
<A HREF="//debbugs.gnu.org/">GNU bug tracking system</A><BR>
Copyright (C) 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson.
</ADDRESS>

</body>
</html>
