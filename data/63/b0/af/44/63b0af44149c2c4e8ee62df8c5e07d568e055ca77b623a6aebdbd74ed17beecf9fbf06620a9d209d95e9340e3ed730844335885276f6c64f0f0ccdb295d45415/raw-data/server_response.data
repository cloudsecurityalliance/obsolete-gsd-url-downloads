<!DOCTYPE html>
<html lang="en">
  <head>
    <title>698024 &ndash; heap-buffer-overflow in Ins_MIRP(base/ttinterp.c)</title>

      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<link href="data/assets/f8d5c9f7a0816126b79f46c4e0a6ddf5.css?1625059054" rel="stylesheet" type="text/css">



    
<script type="text/javascript" src="data/assets/a7c2f3a028f17a9aa60f56dc9d6e732d.js?1625059054"></script>

    <script type="text/javascript">
    <!--
        YAHOO.namespace('bugzilla');
        YAHOO.util.Event.addListener = function (el, sType, fn, obj, overrideContext) {
               if ( ("onpagehide" in window || YAHOO.env.ua.gecko) && sType === "unload") { sType = "pagehide"; };
               var capture = ((sType == "focusin" || sType == "focusout") && !YAHOO.env.ua.ie) ? true : false;
               return this._addListener(el, this._getType(sType), fn, obj, overrideContext, capture);
         };
        if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
            YAHOO.util.Event._simpleRemove(window, "unload", 
                                           YAHOO.util.Event._unload);
        }
        
        function unhide_language_selector() { 
            YAHOO.util.Dom.removeClass(
                'lang_links_container', 'bz_default_hidden'
            ); 
        } 
        YAHOO.util.Event.onDOMReady(unhide_language_selector);

        
        var BUGZILLA = {
            param: {
                cookiepath: '\/',
                maxusermatches: 1000
            },
            constant: {
                COMMENT_COLS: 80
            },
            string: {
                

                attach_desc_required:
                    "You must enter a Description for this attachment.",
                component_required:
                    "You must select a Component for this bug.",
                description_required:
                    "You must enter a Description for this bug.",
                short_desc_required:
                    "You must enter a Summary for this bug.",
                version_required:
                    "You must select a Version for this bug."
            }
              , api_token: ''
        };

    if (history && history.replaceState) {
      if(!document.location.href.match(/show_bug\.cgi/)) {
        history.replaceState( null,
                             "698024 – heap-buffer-overflow in Ins_MIRP(base\/ttinterp.c)",
                             "show_bug.cgi?id=698024" );
        document.title = "698024 – heap-buffer-overflow in Ins_MIRP(base\/ttinterp.c)";
      }
      if (document.location.href.match(/show_bug\.cgi\?.*list_id=/)) {
        var href = document.location.href;
        href = href.replace(/[\?&]+list_id=(\d+|cookie)/, '');
        history.replaceState(null, "698024 – heap-buffer-overflow in Ins_MIRP(base\/ttinterp.c)", href);
      }
    }
    YAHOO.util.Event.onDOMReady(function() {
      initDirtyFieldTracking();

    });
    // -->
    </script>
<script type="text/javascript" src="data/assets/daf5e0fb6826e6a35280e622913f0c4a.js?1625059054"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla" href="./search_plugin.cgi">
    <link rel="shortcut icon" href="images/favicon.ico">
  </head>

  <body 
        class="bugs-ghostscript-com
                 bz_bug
                 bz_status_RESOLVED
                 bz_product_GhostXPS
                 bz_component_General
                 bz_bug_698024 yui-skin-sam">

  <div id="header"><div id="banner">
  </div>

    <div id="titles">
      <span id="title">Bugzilla &ndash; Bug&nbsp;698024</span>

        <span id="subtitle" class="subheader">heap-buffer-overflow in Ins_MIRP(base/ttinterp.c)</span>

        <span id="information" class="header_addl_info">Last modified: 2017-07-25 04:19:11 UTC</span>
    </div>


    <div id="common_links"><ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi">New</a></li>
  <li><span class="separator">| </span><a href="describecomponents.cgi">Browse</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_top" name="no_redirect" value="0">
    <script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_top");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_top" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_top"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li></li>


  <li>
        <span class="separator">| </span>
        <a href="docs/en/html/using/understanding.html" target="_blank">Help</a>
      </li>
    
      <li id="new_account_container_top">
        <span class="separator">| </span>
        <a href="createaccount.cgi">New&nbsp;Account</a>
      </li>

    <li id="mini_login_container_top">
  <span class="separator">| </span>
  <a id="login_link_top" href="show_bug.cgi?id=698024&amp;GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('_top')">Log In</a>

  <form action="show_bug.cgi?id=698024" method="POST"
        class="mini_login bz_default_hidden"
        id="mini_login_top">
    <input id="Bugzilla_login_top" required
           name="Bugzilla_login" class="bz_login"
        type="email" placeholder="Email Address">
    <input class="bz_password" name="Bugzilla_password" type="password"
           id="Bugzilla_password_top" required
           placeholder="Password">
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
            id="log_in_top">
    <a href="#" onclick="return hide_mini_login_form('_top')">[x]</a>
  </form>
</li>


  <li id="forgot_container_top">
    <span class="separator">| </span>
    <a id="forgot_link_top" href="show_bug.cgi?id=698024&amp;GoAheadAndLogIn=1#forgot"
       onclick="return show_forgot_form('_top')">Forgot Password</a>
    <form action="token.cgi" method="post" id="forgot_form_top"
          class="mini_forgot bz_default_hidden">
      <label for="login_top">Login:</label>
      <input name="loginname" size="20" id="login_top" required
          type="email" placeholder="Your Email Address">
      <input id="forgot_button_top" value="Reset Password" type="submit">
      <input type="hidden" name="a" value="reqpw">
      <input type="hidden" id="token_top" name="token"
             value="1635619316-yqQbHRTPC_OQXyEHdWOFG6qq_J9kieV5CP3zRxXOQFc">
      <a href="#" onclick="return hide_forgot_form('_top')">[x]</a>
    </form>
  </li>
</ul>
    </div>
  </div>

  <div id="bugzilla-body">


<script type="text/javascript">
<!--

//-->
</script>

<form name="changeform" id="changeform" method="post" action="process_bug.cgi">

  <input type="hidden" name="delta_ts" value="2017-07-25 04:19:11">
  <input type="hidden" name="id" value="698024">
  <input type="hidden" name="token" value="1635619316-D1q6UfXycye0_K-RMSdNmgHMHYrhO0Dmr6b8ibVR0TE">
<div class="bz_short_desc_container edit_form">
     <a href="show_bug.cgi?id=698024"><b>Bug&nbsp;698024</b></a> <span id="summary_container" class="bz_default_hidden">
      - <span id="short_desc_nonedit_display">heap-buffer-overflow in Ins_MIRP(base/ttinterp.c)</span>
     </span>

    <div id="summary_input"><span class="field_label "
    id="field_label_short_desc">


  <a 
      title="The bug summary is a short sentence which succinctly describes what the bug is about."
      class="field_help_link"
      href="page.cgi?id=fields.html#short_desc"
  >Summary:</a>

</span>heap-buffer-overflow in Ins_MIRP(base/ttinterp.c)
    </div>
  </div>
  <script type="text/javascript">
    hideEditableField('summary_container',
                      'summary_input',
                      'summary_edit_action',
                      'short_desc',
                      'heap-buffer-overflow in Ins_MIRP(base\/ttinterp.c)' );
  </script>
  <table class="edit_form">
    <tr>
      
      <td id="bz_show_bug_column_1" class="bz_show_bug_column">     
        <table>
          <tr>
    <th class="field_label">
      <a href="page.cgi?id=fields.html#bug_status">Status</a>:
    </th>
    <td id="bz_field_status">
      <span id="static_bug_status">RESOLVED
          FIXED
      </span>
    </td>
  </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_alias">


  <a 
      title="A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla."
      class="field_help_link"
      href="page.cgi?id=fields.html#alias"
  >Alias:</a>

</th>
    <td>
        None
    </td>
  </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_product">


  <a 
      title="Bugs are categorised into Products and Components."
      class="field_help_link"
      href="describecomponents.cgi"
  >Product:</a>

</th>
  <td class="field_value "
      id="field_container_product" >GhostXPS

</td>
    </tr>

    
    <tr class="bz_default_hidden"><th class="field_label "
    id="field_label_classification">


  <a 
      title="Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation."
      class="field_help_link"
      href="page.cgi?id=fields.html#classification"
  >Classification:</a>

</th>
  <td class="field_value "
      id="field_container_classification" >Unclassified

</td>
    </tr>
        
    
    
    <tr><th class="field_label "
    id="field_label_component">


  <a 
      title="Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list."
      class="field_help_link"
      href="describecomponents.cgi?product=GhostXPS"
  >Component:</a>

</th>
  <td class="field_value "
      id="field_container_component" >General

  (<a href="buglist.cgi?component=General&amp;product=GhostXPS&amp;bug_status=__open__"
      target="_blank">show other bugs</a>)
</td>
    </tr>
    <tr><th class="field_label "
    id="field_label_version">


  <a 
      title="The version field defines the version of the software the bug was found in."
      class="field_help_link"
      href="page.cgi?id=fields.html#version"
  >Version:</a>

</th>
<td>unspecified
  </td>
    </tr>
        
    
        
    <tr><th class="field_label "
    id="field_label_rep_platform">


  <a 
      title="The hardware platform the bug was observed on. Note: When searching, selecting the option &quot;All&quot; only finds bugs whose value for this field is literally the word &quot;All&quot;."
      class="field_help_link"
      href="page.cgi?id=fields.html#rep_platform"
  >Hardware:</a>

</th>
      <td class="field_value">PC
        Linux
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          
          <tr>
      <th class="field_label">
        <label  accesskey="i">
          <a href="page.cgi?id=fields.html#importance"><u>I</u>mportance</a></label>:
      </th>
      <td>P4
       normal
      </td>
    </tr>
          
          <tr><th class="field_label "
    id="field_label_assigned_to">


  <a 
      title="The person in charge of resolving the bug."
      class="field_help_link"
      href="page.cgi?id=fields.html#assigned_to"
  >Assignee:</a>

</th>
      <td><span class="vcard"><span class="fn">Chris Liddell (chrisl)</span>
</span>
      </td>
    </tr>

    <tr><th class="field_label "
    id="field_label_qa_contact">


  <a 
      title="The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#qa_contact"
  >QA Contact:</a>

</th>
      <td><span class="vcard">gs-security
</span>
      </td>
    </tr>
    <script type="text/javascript">
      assignToDefaultOnChange(['product', 'component'],
        'ghostpdl-bugs\x40artifex.com',
        'tech\x40artifex.com');
    </script>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr><th class="field_label "
    id="field_label_bug_file_loc">


  <a 
      title="Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen."
      class="field_help_link"
      href="page.cgi?id=fields.html#bug_file_loc"
  >URL:</a>

</th>
    <td>
      <span id="bz_url_input_area">
      </span>
    </td>
  </tr>


    <tr><th class="field_label "
    id="field_label_keywords">


  <a 
      title="You can add keywords from a defined list to bugs, in order to easily identify and group them."
      class="field_help_link"
      href="describekeywords.cgi"
  >Keywords:</a>

</th>
  <td class="field_value "
      id="field_container_keywords" >

</td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>

          
<tr><th class="field_label "
    id="field_label_dependson">


  <a 
      title="The bugs listed here must be resolved before this bug can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#dependson"
  >Depends on:</a>

</th>

  <td>
    <span id="dependson_input_area">
    </span>

  </td>
  </tr>
  
  <tr><th class="field_label "
    id="field_label_blocked">


  <a 
      title="This bug must be resolved before the bugs listed in this field can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#blocked"
  >Blocks:</a>

</th>

  <td>
    <span id="blocked_input_area">
    </span>

  </td>
  </tr>
          
        </table>
      </td>
      <td>
        <div class="bz_column_spacer">&nbsp;</div>
      </td>
      
      <td id="bz_show_bug_column_2" class="bz_show_bug_column">
        <table>
        <tr>
    <th class="field_label">
      Reported:
    </th>
    <td>2017-06-12 04:21 UTC by <span class="vcard"><span class="fn">Kim Gwan Yeong</span>
</span>
    </td>
  </tr>
  
  <tr>
    <th class="field_label">
      Modified:
    </th>
    <td>2017-07-25 04:19 UTC
      (<a href="show_activity.cgi?id=698024">History</a>)
    </td>
  
  </tr>
<tr>
      <th class="field_label">
        <label  accesskey="a">
          CC List:
        </label>
      </th>
      <td>0 
          users
        <div id="cc_edit_area">
          <br>
        </div>
      </td>
    </tr>

<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_see_also">


  <a 
      title="This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields."
      class="field_help_link"
      href="page.cgi?id=fields.html#see_also"
  >See Also:</a>

</th>
  <td class="field_value "
      id="field_container_see_also" >

</td>
    </tr> 
<tr>
      <th class="field_label "
    id="field_label_cf_customer">


  <a 
      title="A custom Free Text field in this installation of Bugzilla."
      class="field_help_link"
      href="page.cgi?id=fields.html#cf_customer"
  >Customer:</a>

</th>
  <td class="field_value "
      id="field_container_cf_customer" >

</td>
    </tr>
    <tr>
      <th class="field_label "
    id="field_label_cf_wordsize">


  <a 
      title="For example x86 would be 32 and x86_64 would be 64."
      class="field_help_link"
      href="page.cgi?id=fields.html#cf_wordsize"
  >Word Size:</a>

</th>
  <td class="field_value "
      id="field_container_cf_wordsize" >---

</td>
    </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>



        </table>
      </td>
    </tr>
    <tr>
      <td colspan="3">
          <hr id="bz_top_half_spacer">
      </td>
    </tr>
  </table>

  <table id="bz_big_form_parts">
  <tr>
  <td>

    
<script type="text/javascript">
<!--
function toggle_display(link) {
    var table = document.getElementById("attachment_table");
    var view_all = document.getElementById("view_all");
    var hide_obsolete_url_parameter = "&hide_obsolete=1";
    // Store current height for scrolling later
    var originalHeight = table.offsetHeight;
    var rows = YAHOO.util.Dom.getElementsByClassName(
        'bz_tr_obsolete', 'tr', table);

    for (var i = 0; i < rows.length; i++) {
        bz_toggleClass(rows[i], 'bz_default_hidden');
    }

    if (YAHOO.util.Dom.hasClass(rows[0], 'bz_default_hidden')) {
        link.innerHTML = "Show Obsolete";
        view_all.href = view_all.href + hide_obsolete_url_parameter 
    }
    else {
        link.innerHTML = "Hide Obsolete";
        view_all.href = view_all.href.replace(hide_obsolete_url_parameter,"");
    }

    var newHeight = table.offsetHeight;
    // This scrolling makes the window appear to not move at all.
    window.scrollBy(0, newHeight - originalHeight);

    return false;
}
//-->
</script>

<br>
<table id="attachment_table">
  <tr id="a0">
    <th colspan="2" class="left">
      Attachments
    </th>
  </tr>


      <tr id="a1" class="bz_contenttype_application_zip">
        <td>
            <a href="attachment.cgi?id=13773"
               title="View the content of the attachment">
          <b>PoC</b></a>

          <span class="bz_attach_extra_info">
              (37.22 KB,
                application/zip)

            <br>
            <a href="#attach_13773"
               title="Go to the comment associated with the attachment">2017-06-12 04:21 UTC</a>,

            <span class="vcard"><span class="fn">Kim Gwan Yeong</span>
</span>
          </span>
        </td>


        <td>
          <a href="attachment.cgi?id=13773&amp;action=edit">Details</a>
        </td>
      </tr>

  <tr class="bz_attach_footer">
    <td colspan="2">
        <span class="bz_attach_view_hide">
        </span>
        <a href="attachment.cgi?bugid=698024&amp;action=enter">Add an attachment</a>
        (proposed patch, testcase, etc.)
    </td>
  </tr>
</table>
<br>
<div id="add_comment" class="bz_section_additional_comments">
      <table>
        <tr>
          <td>
            <fieldset>
              <legend>Note</legend>
              You need to
              <a href="show_bug.cgi?id=698024&amp;GoAheadAndLogIn=1">log in</a>
              before you can comment on or make changes to this bug.
            </fieldset>
          </td>
        </tr> 
      </table>
  </div>
  </td>
  <td>
  </td>
  </tr></table>

  
  <div id="comments"><script src="js/comments.js?1519155687" type="text/javascript">
</script>

<script type="text/javascript">
<!--
  /* Adds the reply text to the 'comment' textarea */
  function replyToComment(id, real_id, name) {
      var prefix = "(In reply to " + name + " from comment #" + id + ")\n";
      var replytext = "";
        /* pre id="comment_name_N" */
        var text_elem = document.getElementById('comment_text_'+id);
        var text = getText(text_elem);
        replytext = prefix + wrapReplyText(text);


      /* <textarea id="comment"> */
      var textarea = document.getElementById('comment');
      if (textarea.value != replytext) {
          textarea.value += replytext;
      }

      textarea.focus();
  } 
//-->
</script>


<!-- This auto-sizes the comments and positions the collapse/expand links 
     to the right. -->
<table class="bz_comment_table">
<tr>
<td>
<div id="c0" class="bz_comment bz_first_comment">

      <div class="bz_first_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=698024#c0">Description</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Kim Gwan Yeong</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-06-12 04:21:40 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class=""><a href="attachment.cgi?id=13773" name="attach_13773" title="PoC">attachment 13773</a> <a href="attachment.cgi?id=13773&amp;action=edit" title="PoC">[details]</a></span>
PoC

POC to trigger heap buffer overflow (gxps)

I found a crashing test case.

Please confirm.

Version 9.22 and Git Head: <a href="http://www.ghostscript.com/cgi-bin/findgit.cgi?f6507e828ddfe1f60645bc925bff9bedfdb306ce">f6507e828ddfe1f60645bc925bff9bedfdb306ce</a>

OS: Ubuntu 16.04.2 x86_64

Command: ./gxps -sDEVICE=pdfwrite -sOutputFile=/dev/null -dNOPAUSE $FILE


---------------
GDB out:
---------------
[──────────────────────────────────REGISTERS───────────────────────────────────]
*RAX  0x4c07f1 (Project_y) &lt;- push   rbp
*RBX  0x15e4144 &lt;- 0x0
*RCX  0x132c0
*RDX  0x16506c0
*RDI  0x15aa120 -&gt; 0x15aa6c0 -&gt; 0x15aef68 -&gt; 0x4ca5da (gx_ttfReader__Eof) &lt;- ...
*RSI  0x15fb1c0 &lt;- 0x1554000000000
*R8   0x7fffffffbb78 &lt;- 0xffff0000015a060e
*R9   0x68a0
*R10  0x6890
*R11  0x7ffff7478390 &lt;- scasd  eax, dword ptr [rdi]
*R12  0x460ea0 (_start) &lt;- xor    ebp, ebp
*R13  0x7fffffffdd30 &lt;- 0x5
 R14  0x0
 R15  0x0
*RBP  0x7fffffffba10 -&gt; 0x7fffffffbb10 -&gt; 0x7fffffffbb40 -&gt; 0x7fffffffbd50 &lt;- ...
*RSP  0x7fffffffb9d0 -&gt; 0x15e3ba0 &lt;- 0x4
*RIP  0x4c51fe (Ins_MIRP+642) &lt;- mov    edx, dword ptr [rdx]
[────────────────────────────────────DISASM────────────────────────────────────]
 ► 0x4c51fe &lt;Ins_MIRP+642&gt;    mov    edx, dword ptr [rdx]
   0x4c5200 &lt;Ins_MIRP+644&gt;    mov    edi, ecx
   0x4c5202 &lt;Ins_MIRP+646&gt;    sub    edi, edx
   0x4c5204 &lt;Ins_MIRP+648&gt;    mov    rdx, qword ptr [rbp - 0x38]
   0x4c5208 &lt;Ins_MIRP+652&gt;    mov    rdx, qword ptr [rdx + 0x2b8]
   0x4c520f &lt;Ins_MIRP+659&gt;    mov    ecx, dword ptr [rbp - 0x20]
   0x4c5212 &lt;Ins_MIRP+662&gt;    movsxd rcx, ecx
   0x4c5215 &lt;Ins_MIRP+665&gt;    shl    rcx, 2
   0x4c5219 &lt;Ins_MIRP+669&gt;    add    rdx, rcx
   0x4c521c &lt;Ins_MIRP+672&gt;    mov    ecx, dword ptr [rdx]
   0x4c521e &lt;Ins_MIRP+674&gt;    mov    rdx, qword ptr [rbp - 0x38]
[────────────────────────────────────SOURCE────────────────────────────────────]
3895	
3896	      CUR.zp1.cur_x[point] = CUR.zp1.org_x[point];
3897	      CUR.zp1.cur_y[point] = CUR.zp1.org_y[point];
3898	    }
3899	
3900	    org_dist = CUR_Func_dualproj( CUR.zp1.org_x[point] -  &lt;-- Vulnerability
3901	                                    CUR.zp0.org_x[CUR.GS.rp0],
3902	                                  CUR.zp1.org_y[point] -
3903	                                    CUR.zp0.org_y[CUR.GS.rp0] );
3904	
[────────────────────────────────────STACK─────────────────────────────────────]
00:0000│ rsp  0x7fffffffb9d0 -&gt; 0x15e3ba0 &lt;- 0x4
01:0008│      0x7fffffffb9d8 -&gt; 0x15aa120 -&gt; 0x15aa6c0 -&gt; 0x15aef68 &lt;- ...
02:0010│      0x7fffffffb9e0 -&gt; 0x7fffffffba10 -&gt; 0x7fffffffbb10 -&gt; 0x7fffffffbb40 &lt;- ...
03:0018│      0x7fffffffb9e8 &lt;- 0x0
04:0020│      0x7fffffffb9f0 &lt;- 0x4
05:0028│      0x7fffffffb9f8 -&gt; 0x15aa120 -&gt; 0x15aa6c0 -&gt; 0x15aef68 &lt;- ...
06:0030│      0x7fffffffba00 -&gt; 0x15e4144 &lt;- 0x0
07:0038│      0x7fffffffba08 -&gt; 0x460ea0 (_start) &lt;- xor    ebp, ebp
[──────────────────────────────────BACKTRACE───────────────────────────────────]
 ► f 0           4c51fe Ins_MIRP+642
   f 1           4c7112 RunIns+1489
   f 2           4c905b Context_Run+555
   f 3           4bd8df ttfOutliner__BuildGlyphOutlineAux+7250
   f 4           4bdb7f ttfOutliner__BuildGlyphOutline+147
   f 5           4beb08 ttfOutliner__Outline+238
   f 6           4cc91f gx_ttf_outline+619
   f 7           4b8e3c append_outline_fitted+111
   f 8           4b7ecd gs_type42_glyph_outline+478
   f 9           8c7f76 gs_default_glyph_info+314
   f 10           4b803f gs_type42_glyph_info_by_gid+141
[────────BACKTRACE───────────────────]
#0  0x00000000004c51fe in Ins_MIRP (exc=0x15aa120, args=0x15e3ba0) at ./base/ttinterp.c:3900
#1  0x00000000004c7112 in RunIns (exc=0x15aa120) at ./base/ttinterp.c:5032
#2  0x00000000004c905b in Context_Run (exec=0x15aa120, debug=0) at ./base/ttobjs.c:457
#3  0x00000000004bd8df in ttfOutliner__BuildGlyphOutlineAux (self=0x7fffffffbf20, glyphIndex=36, m_orig=0x7fffffffbd80, gOutline=0x7fffffffbf58) at ./base/ttfmain.c:827
#4  0x00000000004bdb7f in ttfOutliner__BuildGlyphOutline (self=0x7fffffffbf20, glyphIndex=36, orig_x=0, orig_y=0, gOutline=0x7fffffffbf58) at ./base/ttfmain.c:874
#5  0x00000000004beb08 in ttfOutliner__Outline (self=0x7fffffffbf20, glyphIndex=36, orig_x=0, orig_y=0, m1=0x7fffffffbe90) at ./base/ttfmain.c:1033
#6  0x00000000004cc91f in gx_ttf_outline (ttf=0x15eea30, r=0x15aef68, pfont=0x15f30c8, glyph_index=36, m=0x7fffffffc400, pscale=0x7fffffffc080, path=0x7fffffffc180, design_grid=1) at ./base/gxttfb.c:787
#7  0x00000000004b8e3c in append_outline_fitted (glyph_index=36, pmat=0x7fffffffc400, ppath=0x7fffffffc180, pair=0x15ddf78, pscale=0x7fffffffc080, design_grid=1) at ./base/gstype42.c:1595
#8  0x00000000004b7ecd in gs_type42_glyph_outline (font=0x15f30c8, WMode=0, glyph=36, pmat=0x7fffffffc400, ppath=0x7fffffffc180, sbw=0x7fffffffc200) at ./base/gstype42.c:991
#9  0x00000000008c7f76 in gs_default_glyph_info (font=0x15f30c8, glyph=36, pmat=0x7fffffffc400, members=4, info=0x7fffffffc4e0) at ./base/gsfont.c:1036
#10 0x00000000004b803f in gs_type42_glyph_info_by_gid (font=0x15f30c8, glyph=36, pmat=0x7fffffffc400, members=13, info=0x7fffffffc4e0, glyph_index=36) at ./base/gstype42.c:1017
#11 0x00000000004b8401 in gs_type42_glyph_info (font=0x15f30c8, glyph=36, pmat=0x7fffffffc400, members=13, info=0x7fffffffc4e0) at ./base/gstype42.c:1088
#12 0x00000000007786b4 in pdf_compute_font_descriptor (pdev=0x15cc6e8, pfd=0x15f6128) at ./devices/vector/gdevpdtd.c:457
#13 0x0000000000779109 in pdf_finish_FontDescriptor (pdev=0x15cc6e8, pres=0x15f6128) at ./devices/vector/gdevpdtd.c:636
#14 0x0000000000793de3 in pdf_finish_resources (pdev=0x15cc6e8, type=resourceFontDescriptor, finish_proc=0x779090 &lt;pdf_finish_FontDescriptor&gt;) at ./devices/vector/gdevpdtw.c:677
#15 0x000000000071262a in do_pdf_close (dev=0x15cc6e8) at ./devices/vector/gdevpdf.c:2569
#16 0x00000000007150d6 in pdf_close (dev=0x15cc6e8) at ./devices/vector/gdevpdf.c:3281
#17 0x00000000008ba0be in gs_closedevice (dev=0x15cc6e8) at ./base/gsdevice.c:720
#18 0x0000000000aee98e in pl_main_universe_dnit (universe=0x15a23b8, mem=0x15a17a0) at ./pcl/pl/plmain.c:557
#19 0x0000000000aee5dd in pl_main_delete_instance (minst=0x15a1930) at ./pcl/pl/plmain.c:436
#20 0x0000000000a4662d in plapi_delete_instance (lib=0x15a11d0) at ./pcl/pl/plapi.c:89
#21 0x0000000000aedb60 in main (argc=5, argv=0x7fffffffdd38) at ./pcl/pl/realmain.c:50
#22 0x00007ffff7304830 in __libc_start_main (main=0xaeda69 &lt;main&gt;, argc=5, argv=0x7fffffffdd38, init=&lt;optimized out&gt;, fini=&lt;optimized out&gt;, rtld_fini=&lt;optimized out&gt;, stack_end=0x7fffffffdd28) at ../csu/libc-start.c:291
#23 0x0000000000460ec9 in _start ()
---------------
ASan out:
---------------
=================================================================
==2414==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x6310000b49d0 at pc 0x00000054ff14 bp 0x7ffe886dd5d0 sp 0x7ffe886dd5c0
READ of size 4 at 0x6310000b49d0 thread T0
    #0 0x54ff13 in Ins_MIRP base/ttinterp.c:3900
    #1 0x556503 in RunIns base/ttinterp.c:5032
    #2 0x55c9a1 in Context_Run base/ttobjs.c:457
    #3 0x537dc5 in ttfOutliner__BuildGlyphOutlineAux base/ttfmain.c:827
    #4 0x538466 in ttfOutliner__BuildGlyphOutline base/ttfmain.c:874
    #5 0x53aab1 in ttfOutliner__Outline base/ttfmain.c:1033
    #6 0x567314 in gx_ttf_outline base/gxttfb.c:787
    #7 0x52c811 in append_outline_fitted base/gstype42.c:1595
    #8 0x52a3d2 in gs_type42_glyph_outline base/gstype42.c:991
    #9 0xf3c43b in gs_default_glyph_info base/gsfont.c:1036
    #10 0x52a783 in gs_type42_glyph_info_by_gid base/gstype42.c:1017
    #11 0x52ae85 in gs_type42_glyph_info base/gstype42.c:1088
    #12 0xc22569 in pdf_compute_font_descriptor devices/vector/gdevpdtd.c:457
    #13 0xc236c9 in pdf_finish_FontDescriptor devices/vector/gdevpdtd.c:636
    #14 0xc66550 in pdf_finish_resources devices/vector/gdevpdtw.c:677
    #15 0xb3c918 in do_pdf_close devices/vector/gdevpdf.c:2569
    #16 0xb42674 in pdf_close devices/vector/gdevpdf.c:3281
    #17 0xf1c525 in gs_closedevice base/gsdevice.c:720
    #18 0x14aaadf in pl_main_universe_dnit pcl/pl/plmain.c:557
    #19 0x14aa339 in pl_main_delete_instance pcl/pl/plmain.c:436
    #20 0x1317967 in plapi_delete_instance pcl/pl/plapi.c:89
    #21 0x14a9095 in main pcl/pl/realmain.c:50
    #22 0x7f51c26ff82f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)
    #23 0x461a48 in _start (/home/karas/gwanyeong/ghostpdl/debugbin/gxps+0x461a48)

AddressSanitizer can not describe address in more detail (wild memory access suspected).
SUMMARY: AddressSanitizer: heap-buffer-overflow base/ttinterp.c:3900 Ins_MIRP
Shadow bytes around the buggy address:
  0x0c628000e8e0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c628000e8f0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c628000e900: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c628000e910: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c628000e920: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
=&gt;0x0c628000e930: fa fa fa fa fa fa fa fa fa fa[fa]fa fa fa fa fa
  0x0c628000e940: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c628000e950: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c628000e960: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c628000e970: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c628000e980: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Heap right redzone:      fb
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack partial redzone:   f4
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
==2414==ABORTING</pre>
    </div>

    <div id="c1" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=698024#c1">Comment 1</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Chris Liddell (chrisl)</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-06-13 07:52:59 UTC
        </span>

      </div>




<pre class="bz_comment_text">Fixed:
<a href="http://git.ghostscript.com/?p=ghostpdl.git;a=commitdiff;h=c7c559727">http://git.ghostscript.com/?p=ghostpdl.git;a=commitdiff;h=c7c559727</a></pre>
    </div>

    <div id="c2" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=698024#c2">Comment 2</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Kim Gwan Yeong</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-06-15 16:49:00 UTC
        </span>

      </div>




<pre class="bz_comment_text">This was assigned CVE-2017-9611</pre>
    </div>


  

</td>
<td>
</td>
</tr></table>
  </div>
        

</form>

<hr>
<ul class="related_actions">
    <li><a href="show_bug.cgi?format=multiple&amp;id=698024">Format For Printing</a></li>
    <li>&nbsp;-&nbsp;<a href="show_bug.cgi?ctype=xml&amp;id=698024">XML</a></li>
    <li>&nbsp;-&nbsp;<a href="enter_bug.cgi?cloned_bug_id=698024">Clone This Bug</a></li>
    
    <li>&nbsp;-&nbsp;<a href="#">Top of page </a></li>
    </ul>

<br>
</div>

    <div id="footer">
      <div class="intro"></div>
<ul id="useful-links">
  <li id="links-actions"><ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi">New</a></li>
  <li><span class="separator">| </span><a href="describecomponents.cgi">Browse</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_bottom" name="no_redirect" value="0">
    <script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_bottom");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_bottom" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_bottom"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li></li>


  <li>
        <span class="separator">| </span>
        <a href="docs/en/html/using/understanding.html" target="_blank">Help</a>
      </li>
    
      <li id="new_account_container_bottom">
        <span class="separator">| </span>
        <a href="createaccount.cgi">New&nbsp;Account</a>
      </li>

    <li id="mini_login_container_bottom">
  <span class="separator">| </span>
  <a id="login_link_bottom" href="show_bug.cgi?id=698024&amp;GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('_bottom')">Log In</a>

  <form action="show_bug.cgi?id=698024" method="POST"
        class="mini_login bz_default_hidden"
        id="mini_login_bottom">
    <input id="Bugzilla_login_bottom" required
           name="Bugzilla_login" class="bz_login"
        type="email" placeholder="Email Address">
    <input class="bz_password" name="Bugzilla_password" type="password"
           id="Bugzilla_password_bottom" required
           placeholder="Password">
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
            id="log_in_bottom">
    <a href="#" onclick="return hide_mini_login_form('_bottom')">[x]</a>
  </form>
</li>


  <li id="forgot_container_bottom">
    <span class="separator">| </span>
    <a id="forgot_link_bottom" href="show_bug.cgi?id=698024&amp;GoAheadAndLogIn=1#forgot"
       onclick="return show_forgot_form('_bottom')">Forgot Password</a>
    <form action="token.cgi" method="post" id="forgot_form_bottom"
          class="mini_forgot bz_default_hidden">
      <label for="login_bottom">Login:</label>
      <input name="loginname" size="20" id="login_bottom" required
          type="email" placeholder="Your Email Address">
      <input id="forgot_button_bottom" value="Reset Password" type="submit">
      <input type="hidden" name="a" value="reqpw">
      <input type="hidden" id="token_bottom" name="token"
             value="1635619316-yqQbHRTPC_OQXyEHdWOFG6qq_J9kieV5CP3zRxXOQFc">
      <a href="#" onclick="return hide_forgot_form('_bottom')">[x]</a>
    </form>
  </li>
</ul>
  </li>

  




  
</ul>

      <div class="outro"></div>
    </div>

  </body>
</html>