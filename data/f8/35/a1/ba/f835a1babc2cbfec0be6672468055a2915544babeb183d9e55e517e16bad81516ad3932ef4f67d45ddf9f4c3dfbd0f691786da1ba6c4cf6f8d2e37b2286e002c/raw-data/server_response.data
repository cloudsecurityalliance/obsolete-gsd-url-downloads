<!DOCTYPE html>
<html lang="ja">
<head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# website: http://ogp.me/ns/website#">
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-TRHZK5P');</script>
  <!-- End Google Tag Manager -->
  <meta charset="UTF-8">
  <script type="text/javascript">
  if ((navigator.userAgent.indexOf('iPhone') > 0) || navigator.userAgent.indexOf('iPod') > 0 || navigator.userAgent.indexOf('Android') > 0) {
          document.write('<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0">');
      } else {
          document.write('<meta name="viewport" content="width=1080">');
      }
  </script>
  <title>2018/05/18 コードインジェクションをはじめとする複数の脆弱性</title>
    <meta name="keywords" content="baser,CMS,メールフォーム,お問い合わせフォーム,ブログ,オープンソース,OSS,コンテンツマネジメントシステム,開発支援,無料,無償"/>
  <meta property="og:title" content="2018/05/18 コードインジェクションをはじめとする複数の脆弱性">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://basercms.net/security/JVN67881316">
  <meta property="og:image" content="https://basercms.net/theme/baserofficial-2020/img/common/logo_icon.svg">
        <meta property="og:description" content="">
  <meta property="og:site_name" content="国産オープンソースCMS baserCMS">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@basercms" />
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  <link href="https://fonts.googleapis.com/css?family=Noto+Sans+JP:400,700&display=swap&subset=japanese" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Josefin+Sans:300,400,700&display=swap" rel="stylesheet">
  <link href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" rel="stylesheet">
  <link rel="stylesheet" href="/theme/baserofficial-2020/css/style.css">
  <script src="/theme/baserofficial-2020/js/jquery-3.1.1.min.js"></script>
  <script src="/theme/baserofficial-2020/js/baser.min.js"></script>
  <script src="/theme/baserofficial-2020/js/vendors/jquery.colorbox-min.js"></script>
  <script src="/theme/baserofficial-2020/js/startup.js"></script>
  <script src="/theme/baserofficial-2020/js/script.js"></script>
  
<meta name="generator" content="basercms"/><link href="https://basercms.net/security/JVN67881316" rel="canonical"/><link rel="stylesheet" type="text/css" href="/burger_editor/css/bge_style_default.css"/><link rel="stylesheet" type="text/css" href="/theme/baserofficial-2020/css/bge_style.css"/><link rel="stylesheet" type="text/css" href="/burger_editor/css/colorbox.css"/><script type="text/javascript" src="/burger_editor/js/bge_modules/bge_functions.min.js" defer="defer"></script><script type="text/javascript" src="/burger_editor/js/bge_modules/jquery.colorbox-min.js" defer="defer"></script>  

<script async
src="https://www.googletagmanager.com/gtag/js?id=UA-526824-12"></script>
<script>
window.dataLayer = window.dataLayer || [];

function gtag() {
dataLayer.push(arguments);
}

gtag('js', new Date());
gtag('config', 'UA-526824-12');
</script>

</head>

<body id="SecurityJVN67881316">
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TRHZK5P"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->
<div class="wrapper wrapper--page" ontouchstart="" onclick="">
<!-- [ header ] -->
<header class="header" role="header" id="pageTop">
  <div class="header__inner">
    <div class="header__logo header__logo--icon"><a href="/"><img src="/theme/baserofficial-2020/img/common/logo_icon.svg" alt="baserCMS"></a></div>
    <div class="header__left">
      <div class="header__logo"><a href="/"><img src="/theme/baserofficial-2020/img/common/logo_icon.svg" alt="baserCMS"></a></div>
      <!-- [ gnavi ] -->
      <nav class="gnavi" role="navigation">
        <ul class="gnavi__list">
          <li class="gnavi__list__item"><a href="/about/">製品情報</a>
            <ul class="gnavi__sub-list">
            	<li class="gnavi__sub-list__item"><a href="/news/">NEWS</a></li>
            	<li class="gnavi__sub-list__item"><a href="/about/">baserCMSとは？</a></li>
              <li class="gnavi__sub-list__item"><a href="/about/functions">baserCMSの機能</a></li>
              <li class="gnavi__sub-list__item"><a href="/about/guide.html">始めてガイド</a></li>
              <li class="gnavi__sub-list__item"><a href="/demo/">デモサイト</a></li>
              <li class="gnavi__sub-list__item"><a href="/works/">導入事例</a></li>
            </ul>
          </li>
          <li class="gnavi__list__item"><a href="http://market.basercms.net/" target="_blank">マーケット</a></li>
          <li class="gnavi__list__item"><a href="https://forum.basercms.net" target="_blank">サポート</a>
            <ul class="gnavi__sub-list">
            	<li class="gnavi__sub-list__item"><a href="https://forum.basercms.net" target="_blank">ユーザーズフォーラム</a></li>
              <li class="gnavi__sub-list__item"><a href="/pdf/manual/usermanual.pdf" target="_blank">ユーザーマニュアル</a></li>
              <li class="gnavi__sub-list__item"><a href="/contact/">お問い合わせ</a></li>
            </ul>
          </li>
          <li class="gnavi__list__item"><a href="/partners/">制作会社を探す</a></li>
          <li class="gnavi__list__item"><a href="/hosting/">ホスティングを探す</a></li>
          <li class="gnavi__list__item"><a href="/download/">ダウンロード</a>
            <ul class="gnavi__sub-list">
            	<li class="gnavi__sub-list__item"><a href="/download/">baserCMS</a></li>
            	<li class="gnavi__sub-list__item"><a href="/download/design_data">デザインデータ</a></li>
            </ul>
          </li>
        </ul>
      </nav>
      <!-- /[ gnavi ] -->
    </div>
    <div class="header__right">
      <nav class="sub-navi" role="navigation">
        <ul class="sub-navi__list">
          <li class="sub-navi__list__item"><a href="/creator/">Web<br>クリエイター<br>の方へ</a></li>
          <li class="sub-navi__list__item"><a href="/community/">参加・貢献<br>（コミュニティ）</a></li>
        </ul>
      </nav>
      <!-- /[ sub-navi ] -->
    </div>
  </div>
  <!-- /[ header__inner ] -->

  <div class="pc-menu">
    <a href="javascript:void(0)" onclick="return false;" id="panel-btn-pc" class="panel-btn"><span id="panel-btn-icon-pc" class="panel-btn-icon"></span></a>
  </div>
  <div class="sp-menu">
    <a href="javascript:void(0)" onclick="return false;" id="panel-btn-sp" class="panel-btn"><span id="panel-btn-icon-sp" class="panel-btn-icon"></span></a>
  </div>

  <nav class="sp-navi">
    <ul class="sp-navi__list">
      <li class="sp-navi__list__item"><a href="/">TOP</a></li>
      <li class="sp-navi__list__item"><a href="/about/">製品情報</a>
        <ul class="sp-navi__sub-list">
        	<li class="sp-navi__sub-list__item"><a href="/news/">NEWS</a></li>
          <li class="sp-navi__sub-list__item"><a href="/about/">baserCMSとは？</a></li>
          <li class="sp-navi__sub-list__item"><a href="/about/functions">baserCMSの機能</a></li>
          <li class="sp-navi__sub-list__item"><a href="/about/guide.html">始めてガイド</a></li>
          <li class="sp-navi__sub-list__item"><a href="/demo/">デモサイト</a></li>
          <li class="sp-navi__sub-list__item"><a href="/works/">導入事例</a></li>
        </ul>
      </li>
      <li class="sp-navi__list__item"><a href="http://market.basercms.net/" target="_blank">マーケット</a></li>
      <li class="sp-navi__list__item"><a href="https://forum.basercms.net/" target="_blank">サポート</a>
        <ul class="sp-navi__sub-list">
          <li class="sp-navi__sub-list__item"><a href="https://forum.basercms.net" target="_blank">ユーザーズフォーラム</a></li>
          <li class="sp-navi__sub-list__item"><a href="/pdf/manual/usermanual.pdf" target="_blank">ユーザーマニュアル</a></li>
          <li class="sp-navi__sub-list__item"><a href="/contact/">お問い合わせ</a></li>
        </ul>
      </li>
      <li class="sp-navi__list__item"><a href="/partners/">制作会社を探す</a></li>
      <li class="sp-navi__list__item"><a href="/hosting/">ホスティングを探す</a></li>
      <li class="sp-navi__list__item"><a href="/download/">ダウンロード</a></li>
      <li class="sp-navi__list__item"><a href="/creator/">Webクリエイターの方へ</a></li>
      <li class="sp-navi__list__item"><a href="/community/">参加・貢献（コミュニティ）</a></li>
      <li class="sp-navi__list__item"><a href="/developer/">開発者の方へ</a></li>
    </ul>
  </nav>
  <!-- /[ sp-navi ] -->

  <div class="dl-bar">
    <p class="dl-bar__count"><span class="dl-bar__title">ダウンロード数/</span><b class="BaserDownLoad dl-bar__num">...</b><span class="dl-bar__unit"></span><span class="dl-bar__title">最新バージョン/</span><b class="BaserVersion dl-bar__num">...</b></p>
  </div>
  <div class="side-box">
    <div class="bnr-box">
      <a href="https://www.amazon.co.jp/dp/4863542976/" target="_blank" rel="noopener"><img src="/theme/baserofficial-2020/img/common/bnr_book_a.png" alt="基礎から学ぶ baserCMS"></a>
    </div>
    <div class="dl-box">
      <div class="dl-box__logo"><img src="/theme/baserofficial-2020/img/common/logo.svg" alt="baserCMS"></div>
      <dl class="dl-box__count">
        <dt>ダウンロード数/</dt>
        <dd class="BaserDownLoad">...<span class="unit">回</span></dd>
        <dt>最新バージョン/</dt>
        <dd class="BaserVersion">...</dd>
      </dl>
      <div class="dl-box__button"><a href="/download/index.html"><span>今すぐダウンロード</span></a></div>
    </div>
  </div>
</header>
<!-- /[ header ] -->  <!-- [ main ] -->
  <main class="main">
    <div class="bge-contents"><!-- BaserPageTagBegin -->
<!-- BaserPageTagEnd --><div class="page">
  <h1 class="title--01">
  	SECURITY  	<span>セキュリティ情報</span>
  </h1> 
  <div class="page__detail">
  	  		<h2 class="title--02">2018/05/18 コードインジェクションをはじめとする複数の脆弱性</h2>
  	  	<div class="bge_body">
    	

<div data-bgb="unknown" class="bgb-wysiwyg"><div data-bgt="ckeditor" data-bgt-ver="2.1.0" class="bgt-container bgt-ckeditor-container"><div class="bge-ckeditor" data-bge="ckeditor"><h1>コードインジェクションをはじめとする複数の脆弱性</h1>

<p style="text-align:right">2018年05月18日</p>

<p>baserCMSに、コードインジェクションをはじめとする複数の脆弱性があります。<br>
baserCMSの旧バージョンで運営されている方は必ずご対応をお願いいたします。</p>

<h2>影響を受けるシステム</h2>

<ul>
<li>baserCMS 3.0.15&nbsp;およびそれ以前のバージョン</li>
<li>baserCMS 4.1.0.1 およびそれ以前のバージョン</li>
</ul>

<h2>想定される影響</h2>

<ul>
<li><strong>(1)コマンドインジェクション</strong><br>
システム管理グループ以外のユーザーに管理システムへのログインを許可している場合、固定ページにおいて任意のコードを実行される可能性があります。</li>
<li><strong>(2)クロスサイトスクリプティング</strong><br>
システム管理グループ以外のユーザーに管理システムへのログインを許可している場合、パンくず、canonicalタグ、ニックネームにおいて任意のコードを実行される可能性があります。</li>
<li><strong>(3)アップロードファイル管理機能における危険なタイプのファイルの無制限アップロード</strong><br>
システム管理グループ以外のユーザーに管理システムへのログインを許可している場合、phpファイル等の危険なタイプのファイルがアップロードされる可能性があります。</li>
<li><strong>(4)コンテンツ管理機能におけるアクセス制限不備</strong><br>
システム管理グループ以外のユーザーに管理システムへのログインを許可している場合、コンテンツ一覧を制限していても、URLを直接入力する事により、各コンテンツの編集画面にアクセスされる可能性があります。</li>
<li><strong>(5)公開期限が過ぎたコンテンツに対するアクセス制限不備</strong><br>
インストールが正常に行われていない場合、URLを直接指定する事により、ファイルアップローダーでアップロードしたファイルについて公開期限外でもアクセスされる可能性があります。</li>
<li><strong>(6)テーマ管理機能におけるクロスサイトスクリプティング</strong><br>
システム管理グループ以外のユーザーに管理システムへのログインを許可している場合、テーマのファイル管理において任意のコードを実行される可能性があります。</li>
<li><strong>(7)メールフォームのファイル添付機能におけるアクセス制限不備</strong><br>
インストールが正常に行われていない場合、URLを直接指定する事により、メールフォームで送信したファイルについてアクセスされる可能性があります。</li>
</ul>

<h2>対策方法</h2>

<h3>最新バージョンにアップデートする</h3>

<p>最新バージョン 3.0.16&nbsp;/ 4.1.1 にアップデートすることで対応する事ができます。<br>
次のページより最新バージョンのダウンロードを行い、リリースノートに基づきバージョンアップ作業を行います。</p>

<ul>
<li><a href="/packages/download/basercms/3.0.16">baserCMS 3.0.16 ダウンロード</a></li>
<li><a href="/packages/download/basercms/4.1.1">baserCMS 4.1.1 ダウンロード</a></li>
</ul>

<p>&nbsp;</p>

<h3>修正プログラムを適用する</h3>

<p>早急に対応する場合には提供されている修正プログラムを適用します。</p>

<p><a href="/patch/20180518">2018年5月18日配布 修正パッチ一覧</a></p>

<p>なお、以前、8月23日に配布した修正プログラムを適用しておらず、そちらも適用する場合は、上記の修正プログラムの前に適用しておきます。</p>

<p><a href="https://basercms.net/patch/20170823">2017年8月23日配布 修正パッチ一覧</a></p>

<p>&nbsp;</p>

<h3>(1)コマンドインジェクションについての対策</h3>

<p>baserCMSでは、固定ページにおいて、PHPコードの登録を許容する仕様となっていますが、システム管理者グループ以外のユーザーへのPHPコード登録を許容しない場合は、最新版へのアップデート後、または、修正プログラムの適用後に、app/Config/install.php の一番最後の行に、下記のコードを記述し保存してください。</p>

<p><code>&lt;?php Configure::write('BcApp.allowedPhpOtherThanAdmins', false); ?&gt;</code></p>

<p>なお、最新版の新規インストールにおいては、初期状態にて、システム管理者グループ以外のユーザーへのPHPコード登録を許容しない設定となっています。</p>

<p>&nbsp;</p>

<h3>(2)クロスサイトスクリプティングについての対策</h3>

<p>現在利用しているテーマにおいて、下記のファイルが存在する場合は、最新版アップデート後、または、修正プログラムの適用後に、ファイルの修正が必要です。<br>
なお、ファイル内に対象コードが存在しない場合は対応は不要です。</p>

<p>Elements/crumbs.php</p>

<pre>$this-&gt;BcBaser-&gt;addCrumb($crumb['name']);
　　↓
$this-&gt;BcBaser-&gt;addCrumb(h($crumb['name']));</pre>

<pre>$this-&gt;BcBaser-&gt;addCrumb($crumb['name'], $crumb['url']);
　　↓
$this-&gt;BcBaser-&gt;addCrumb(h($crumb['name']), $crumb['url']);
</pre>

<p>Elements/widgets/blog_author_archives.php</p>

<pre>&lt;?php $this-&gt;BcBaser-&gt;link($title, $this-&gt;request-&gt;params['Content']['name'] . '/archives/author/' . $author['User']['name']) ?&gt;
　　↓
&lt;?php $this-&gt;BcBaser-&gt;link($title, $this-&gt;request-&gt;params['Content']['name'] . '/archives/author/' . $author['User']['name'], ['escape' =&gt; true]) ?&gt;
</pre>

<p>Elements/smartphone/widgets/blog_author_archives.php</p>

<pre>&lt;?php $this-&gt;BcBaser-&gt;link($title, $this-&gt;request-&gt;params['Content']['name'] . '/archives/author/' . $author['User']['name']) ?&gt;
　　↓
&lt;?php $this-&gt;BcBaser-&gt;link($title, $this-&gt;request-&gt;params['Content']['name'] . '/archives/author/' . $author['User']['name'], ['escape' =&gt; true]) ?&gt;</pre>

<p>&nbsp;</p>

<h3>(4)コンテンツ管理機能におけるアクセス制限不備についての対策</h3>

<p>コンテンツ管理機能でアクセス制限を行う際には、配下のコンテンツの詳細画面について、該当ページのURLを全て登録してください。</p>

<p>&nbsp;</p>

<h2>謝辞</h2>

<p>この脆弱性情報公表にあたり、IPA、JPCERT/CC に謝辞を申し上げます。</p>

<p>&nbsp;</p>

<p>&nbsp;</p></div>
</div></div>    </div>
  </div>
</div></div>  </main>
  <!-- /[ main ] -->

  <!-- [ footer ] -->
<footer class="footer" role="footer">
  <div class="footer__buttons">
    <div class="button--01"><a href="/demo/"><span>デモサイトを見る</span></a></div>
    <div class="button--01"><a href="/download/index.html"><span>今すぐダウンロード</span></a></div>
  </div>
  <!-- //.friend -->
  <div class="footer__merumaga">
    <div class="footer__merumaga__inner">
      <p class="footer__merumaga__text">baserCMSの最新ニュースをお届けします</p>
      <div class="footer__merumaga__form">
        <form action="https://member.basercms.net/magazine/regist" method="post">
          <input placeholder="youremail@example.com" name="data[BarketMailToken][email]" maxlength="255" type="text" id="BarketMailTokenEmail" required="required" title="受信可能なメールアドレスを入力してください。"><input type="submit" id="BtnSave" type="submit" value="登録">
        </form>
      </div>
    </div>
  </div>

  <!-- //.footer__merumaga -->
  <nav class="fnavi">
    <div class="fnavi__links">
      <ul class="fnavi__links__list">
        <li><a href="/">TOP</a></li>
        <li><a href="/news/">NEWS</a>
          <ul class="fnavi__links__list__items">
            <li><a href="/news/archives/category/news">お知らせ</a></li>
            <li><a href="/news/archives/category/release">リリースノート</a></li>
            <li><a href="/news/archives/category/press_release">プレスリリース</a></li>
            <li><a href="/news/archives/category/event">イベント情報</a></li>
            <li><a href="/news/archives/category/report">レポート</a></li>
            <li><a href="/news/archives/category/market">マーケット</a></li>
            <li><a href="/news/archives/category/magazine">マガジン</a></li>
          </ul>
        </li>
        <li><a href="/press_release/">プレスリリース</a></li>
        <li><a href="/about/">製品情報</a>
          <ul class="fnavi__links__list__items">
          	<li><a href="/about/">baserCMSとは？</a></li>
            <li><a href="/about/functions">baserCMSの機能</a></li>
            <li><a href="/about/guide.html">始めてガイド</a></li>
            <li><a href="/demo/">デモサイト</a></li>
            <li><a href="/works/">導入事例</a></li>
          </ul>
        </li>
      </ul>
      <ul class="fnavi__links__list">
        <li><a href="https://market.basercms.net/" target="_blank">マーケット</a></li>
        <li><a href="https://forum.basercms.net/" target="_blank">サポート</a>
          <ul class="fnavi__links__list__items">
          	<li><a href="https://forum.basercms.net/" target="_blank">ユーザーズフォーラム</a></li>
            <li><a href="/pdf/manual/usermanual.pdf" target="_blank">ユーザーマニュアル</a></li>
            <li><a href="/contact/">お問い合わせ</a></li>
          </ul>
        </li>
        <li><a href="/partners/">制作会社を探す</a></li>
        <li><a href="/hosting/">ホスティングを探す</a></li>
        <li><a href="/download/">baserCMSダウンロード</a>
          <ul class="fnavi__links__list__items">
            <li><a href="/download/design_data">デザインデータダウンロード</a></li>
          </ul>
        </li>
      </ul>
      <ul class="fnavi__links__list">
        <li><a href="/creator/">Webクリエイターの方へ</a>
          <ul class="fnavi__links__list__items">
            <li><a href="http://wiki.basercms.net/" target="_blank">baserCMS公式ガイド</a></li>
            <li><a href="/files/baser4tutorial.zip" target="_blank">テーマ制作チュートリアル</a></li>
          </ul>
        </li>
        <li><a href="/community/">参加・貢献（コミュニティ）</a>
          <ul class="fnavi__links__list__items">
            <li><a href="/community/concept">コンセプト</a></li>
            <li><a href="/community/history">コミュニティの歴史</a></li>
            <li><a href="/community/team/">baserCMSのチーム</a></li>
            <li><a href="/donate">プロジェクトに寄付</a></li>
            <li><a href="/projectmember/">プロジェクトメンバー申請フォーム</a></li>
            <li><a href="/developer/">開発者の方へ</a></li>
            <li><a href="/community/idomoku/">baser井戸端もくもく会</a></li>
            <li><a href="/thanks/">スペシャルサンクス</a></li>
          </ul>
        </li>
      </ul>
      <ul class="fnavi__links__list">
        <li><a href="/developer/">開発者の方へ</a>
        	<ul class="fnavi__links__list__items">
        		<li><a href="/about/system">ソフトウェア要件</a></li>
        		<li><a href="/about/license">ライセンス</a></li>
        		<li><a href="https://github.com/baserproject/basercms" target="_blank">baserCMSのGitHub</a></li>
        		<li><a href="http://api.basercms.net/" target="_blank">baserCMS API Document</a></li>
</ul>
        </li>
        <li><a href="/thanks/">支援企業</a>
          <ul class="fnavi__links__list__items">
            <li><a href="http://baserfoundation.org/" target="_blank">NPO法人ベーサー・ファウンデーション</a></li>
            <li><a href="https://www.d-zero.co.jp/" target="_blank">株式会社ディーゼロ</a></li>
            <li><a href="https://catchup.co.jp/" target="_blank">株式会社キャッチアップ</a></li>
          </ul>
        </li>
        <li><a href="https://www.facebook.com/groups/basercms.zatsudan/" target="_blank">baserCMS雑談広場</a></li>
        <li><a href="http://magazine.basercms.net/" target="_blank">baserマガジン</a></li>
      </ul>
    </div>
  </nav>
  <!-- //.fnavi -->
  <div class="copyright">
    <div class="copyright__inner">
      <ul class="sns-link">
        <li><a href="http://twitter.com/basercms" target="_blank"><img src="/theme/baserofficial-2020/img/common/icn_twitter.svg" alt="twitter"></a></li>
        <li><a href="https://www.facebook.com/basercms" target="_blank"><img src="/theme/baserofficial-2020/img/common/icn_facebook.svg" alt="facebook"></a></li>
        <li><a href="https://www.instagram.com/basercms/" target="_blank"><img src="/theme/baserofficial-2020/img/common/icn_instagram.svg" alt="instagram"></a></li>
      </ul>
      <p>&copy; 2009 - 2021 baserCMS All rights reserved.</p>
    </div>
  </div>
</footer>
<!-- /[ footer ] -->
</div>
</body>
</html>