<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
  "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>
    
    
      
    
    
      Issue 2103043004: Fix EditingStyle::mergeStyle()&#39;s handling of custom properties -
    
    Code Review
  </title>
  <link rel="icon" href="/static/favicon.ico" />
  <link type="text/css" rel="stylesheet"
  href="/static/styles.css?v=408576698
" />
  <script type="text/javascript" src="/static/autocomplete/lib/jquery.js"></script>
  <script type="text/javascript"
    src="/static/script.js?v=408576698
"></script>
   <!-- head block to insert js/css for forms processing -->
   
   <!-- /head -->
</head>
<body onunload="M_unloadPage();">

<!-- Begin help window -->
<script type="text/javascript"><!--
var xsrfToken = '35439bf0c70de387ebf258d6757e53fb';
var helpDisplayed = false;
document.onclick = M_clickCommon;
var media_url = "/static/";
var base_url = "/";
// -->
</script>
<div id="help" style="display: none;">

<div style="font-size: medium; text-align: center;">Keyboard Shortcuts</div>
<hr />
<table class="shortcuts">
  <tr valign="top">
    <td>
      <table>
        <tr>
          <td></td><th>File</th>
        </tr>
        <tr>
          <td><span>u</span> <b>:</b></td><td>up to issue</td>
        </tr>
        <tr>
          <td><span>j</span> / <span>k</span> <b>:</b></td><td>jump to file after / before current file</td>
        </tr>
        <tr>
          <td><span>J</span> / <span>K</span> <b>:</b></td><td>jump to next file with a comment after / before current file</td>
        </tr>
        <tr>
          <td></td><th>Side-by-side diff</th>
        </tr>
        <tr>
          <td><span>i</span> <b>:</b></td><td>toggle intra-line diffs</td>
        </tr>
        <tr>
          <td><span>e</span> <b>:</b></td><td>expand all comments</td>
        </tr>
        <tr>
          <td><span>c</span> <b>:</b></td><td>collapse all comments</td>
        </tr>
        <tr>
          <td><span>s</span> <b>:</b></td><td>toggle showing all comments</td>
        </tr>
        <tr>
          <td><span>n</span> / <span>p</span> <b>:</b></td><td>next / previous diff chunk or comment</td>
        </tr>
        <tr>
          <td><span>N</span> / <span>P</span> <b>:</b></td><td>next / previous comment</td>
        </tr>
        <tr>
          <td><span>&lt;Up&gt;</span> / <span>&lt;Down&gt;</span> <b>:</b></td><td>next / previous line</td>
        </tr>
      </table>
    </td>
    <td>
      <table>
        <tr>
          <td></td><th>Issue</th>
        </tr>
        <tr>
          <td><span>u</span> <b>:</b></td><td>up to list of issues</td>
        </tr>
        <tr>
          <td><span>j</span> / <span>k</span> <b>:</b></td><td>jump to patch after / before current patch</td>
        </tr>
        <tr>
          <td><span>o</span> / <span>&lt;Enter&gt;</span> <b>:</b></td><td>open current patch in side-by-side view</td>
        </tr>
        <tr>
          <td><span>i</span> <b>:</b></td><td>open current patch in unified diff view</td>
        </tr>
        <tr><td>&nbsp;</td></tr>
          <tr><td></td><th>Issue List</th></tr>
        <tr>
          <td><span>j</span> / <span>k</span> <b>:</b></td><td>jump to issue after / before current issue</td>
        </tr>
        <tr>
          <td><span>o</span> / <span>&lt;Enter&gt;</span> <b>:</b></td><td>open current issue</td>
        </tr>
      </table>
    </td>
  </tr>

</table>
</div>
<!-- End help window -->

<div align="right">

<div style="float:left; font-size:x-large"><img style="vertical-align:middle" src="/static/chromium-24.png" /> Chromium Code Reviews</div>




<b>chromiumcodereview-hr@appspot.gserviceaccount.com (chromiumcodereview-hr)</b>
|

<span style="color:red">Please choose your nickname with</span>
<a class="novisit" href="/settings">Settings</a>
|


<a class="novisit" target="_blank"
   href="http://code.google.com/p/rietveld/wiki/CodeReviewHelp">Help</a>

|
<a class="novisit" href="http://www.chromium.org/">Chromium Project</a>
|
<a class="novisit" href="https://chromium-review.googlesource.com/dashboard/self?polygerrit=1">Gerrit Changes</a>
|

<a class="novisit" href="https://codereview.chromium.org/_ah/logout?continue=https://accounts.google.com/Logout%3Fcontinue%3Dhttps://uc.appengine.google.com/_ah/logout%253Fcontinue%253Dhttps://google.com/url%25253Fsa%25253DD%252526q%25253Dhttps://codereview.chromium.org/2103043004%252526ust%25253D1608716337536137%252526usg%25253DAFQjCNFMpH9r6URYn2RL5ANa0hbxUGDfPA%26service%3Dah">Sign out</a>

</div>
<div class="counter">(199)</div>
<br />
<div class="mainmenu">
  
  <a href="/" class="active">Issues</a>
  <a href="/search">Search</a>

</div>
<div class="mainmenu2">
  
  
    &nbsp;&nbsp;&nbsp;
    <a href="/mine">My Issues</a>
    |
    <a href="/starred">Starred</a>
    &nbsp;&nbsp;&nbsp;
    <a href="/all?closed=0">Open</a>
    |
    <a href="/all?closed=1">Closed</a>
    |
    <a href="/all">All</a>
  

</div>

<div>

  <h2>
    <span id="issue-star-2103043004">
  
    
      <img src="/static/star-dark.gif" width="15" height="15" border="0">
    
  
</span>

    Issue <a href="/2103043004/"
               onmouseover="M_showPopUp(this, 'popup-issue');">
            2103043004</a>:
    Fix EditingStyle::mergeStyle()&#39;s handling of custom properties  (Closed) 
  </h2>

  <table class="issue-details" border="0" width="100%">
    <tr valign="top">

      <td class="meta" width="20%">
        <div class="issue_details_sidebar">
          <div><b>Created:</b><br/>
            4 years, 5 months ago by <a href="/user/Timothy%20Loh" onMouseOver="M_showUserInfoPopup(this)">Timothy Loh</a>
          </div>
          <div><b>Modified:</b><br/>
            4 years, 4 months ago
          </div>
          <div><b>Reviewers:</b><br/>
            <a href="/user/tkent" onMouseOver="M_showUserInfoPopup(this)">tkent</a>, <span class='approval'><a href="/user/yosin_UTC9" onMouseOver="M_showUserInfoPopup(this)">yosin_UTC9</a></span>, <span class='approval'><a href="/user/alancutter%20(OOO%20until%202018)" onMouseOver="M_showUserInfoPopup(this)">alancutter (OOO until 2018)</a></span>
          </div>
          
          <div><b>CC:</b><br/>
            darktears, apavlov+blink_chromium.org, blink-reviews, blink-reviews-css, blink-reviews-style_chromium.org, chromium-reviews, dglazkov+blink, rwlbuis
          </div>
          
          
          <div><b>Base URL:</b><br/>
            
            https://chromium.googlesource.com/chromium/src.git@master
            
          </div>
          
          
          <div><b>Target Ref:</b><br/>
            refs/pending/heads/master
          </div>
          
          
          <div><b>Project:</b><br/>
            <a href="/search?project=chromium">
              chromium
            </a>
          </div>
          
          <div><b>Visibility:</b><br/>
            
                Public.
            
          </div>
          
          <div><a title="Find reviews for the same repository ID - c14d891d44f0afff64e56ed7c9702df1d807b1ee"
               href="/search?repo_guid=c14d891d44f0afff64e56ed7c9702df1d807b1ee">
            <b>More Reviews</b></a>
          </div>
          
        </div>
      </td>

      <td style="padding-left: .8em; padding-right: .8em;" width="80%">
        




  <h3><a id="issue-description-pointer"
     href="javascript:M_toggleSection('issue-description')"
     class="toggled-section opentriangle">
    Description</a></h3>
  <div id="issue-description">Fix EditingStyle::mergeStyle()'s handling of custom properties

This patch fixes the logic of EditingStyle::mergeStyle() to correctly
handle custom properties. Currently it serializes the CSSValue and then
reparses it, which, aside from being inefficient, doesn't work for
custom properties as the custom property name is lost (since we only
have the enum value CSSPropertyVariable).

BUG=<a href="https://bugs.chromium.org/p/chromium/issues/detail?id=622420">622420</a>
Committed: <a href="https://crrev.com/aadb63893e4c1358d1e5139aa29552eb190682c8">https://crrev.com/aadb63893e4c1358d1e5139aa29552eb190682c8</a>
Cr-Commit-Position: refs/heads/master@{#410614}
  </div>




  <h3>
    <a id="ps-1-pointer"
       href="/2103043004/#ps1"
       onclick="M_toggleSectionForPS('2103043004', '1')"
       class="toggled-section ">
      Patch Set 1
      
      <span class="anchor">#</span>
    </a>
  </h3>

  
    <div>
      <i>Total comments:</i> 6
      
    </div>
  

  <div id="ps-1"
  
       style="display:none">
  
  </div>
  

  <h3>
    <a id="ps-20001-pointer"
       href="/2103043004/#ps20001"
       onclick="M_toggleSectionForPS('2103043004', '20001')"
       class="toggled-section ">
      Patch Set 2
      : test tweak
      <span class="anchor">#</span>
    </a>
  </h3>

  
    <div>
      <i>Total comments:</i> 8
      
    </div>
  

  <div id="ps-20001"
  
       style="display:none">
  
  </div>
  

  <h3>
    <a id="ps-40001-pointer"
       href="/2103043004/#ps40001"
       onclick="M_toggleSectionForPS('2103043004', '40001')"
       class="toggled-section ">
      Patch Set 3
      : test tweak
      <span class="anchor">#</span>
    </a>
  </h3>

  
    <div>
      <i>Total comments:</i> 3
      
    </div>
  

  <div id="ps-40001"
  
       style="display:none">
  
  </div>
  

  <h3>
    <a id="ps-60001-pointer"
       href="/2103043004/#ps60001"
       onclick="M_toggleSectionForPS('2103043004', '60001')"
       class="toggled-section opentriangle">
      Patch Set 4
      : gtest instead of layout test
      <span class="anchor">#</span>
    </a>
  </h3>

  

  <div id="ps-60001"
  
       style="">
    
<div class="issue-list">

  <div class="pagination">
    <div style="float: left;">
      <i>Created:</i> 4 years, 4 months ago
    </div>
    <div style="float: right;">
      
        Download
          <a href="/download/issue2103043004_60001.diff"
            title="Patchset in text format">[raw]</a>
          <a href="/tarball/2103043004/60001"
            title="Tarball containing the original and patched files">[tar.bz2]</a>
      
    </div>
    <div style="clear:both;"></div>
  </div>

  <table id="queues" style="clear:both;">
    <tr align="left">
      <th colspan="2"></th>
      <th>Unified diffs</th>
      <th>Side-by-side diffs</th>
      <th>Delta from patch set</th>
      <th colspan="3">Stats <font style='font-weight: normal'>(<i>+47 lines, -2 lines</i>)</font></th>
      <th>Patch</th>
    </tr>

    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2103043004/patch/60001/70001">
            third_party/WebKit/Source/core/core.gypi
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2103043004/diff/60001/third_party/WebKit/Source/core/core.gypi">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/2103043004/diff2/1:60001/third_party/WebKit/Source/core/core.gypi"
             title="Delta from patch set 1">1</a>
        
          <a href="/2103043004/diff2/20001:60001/third_party/WebKit/Source/core/core.gypi"
             title="Delta from patch set 2">2</a>
        
          <a href="/2103043004/diff2/40001:60001/third_party/WebKit/Source/core/core.gypi"
             title="Delta from patch set 3">3</a>
        
        </td>
        
          <td style="white-space: nowrap">1 chunk</td>
          <td style="white-space: nowrap">+1 line, -0 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2103043004_60001_70001.diff"
             title="Download patch for third_party/WebKit/Source/core/core.gypi">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2103043004/patch/60001/70002">
            third_party/WebKit/Source/core/css/StylePropertySet.cpp
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2103043004/diff/60001/third_party/WebKit/Source/core/css/StylePropertySet.cpp">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/2103043004/diff2/1:60001/third_party/WebKit/Source/core/css/StylePropertySet.cpp"
             title="Delta from patch set 1">1</a>
        
          <a href="/2103043004/diff2/20001:60001/third_party/WebKit/Source/core/css/StylePropertySet.cpp"
             title="Delta from patch set 2">2</a>
        
          <a href="/2103043004/diff2/40001:60001/third_party/WebKit/Source/core/css/StylePropertySet.cpp"
             title="Delta from patch set 3">3</a>
        
        </td>
        
          <td style="white-space: nowrap">1 chunk</td>
          <td style="white-space: nowrap">+2 lines, -0 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2103043004_60001_70002.diff"
             title="Download patch for third_party/WebKit/Source/core/css/StylePropertySet.cpp">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2103043004/patch/60001/70004">
            third_party/WebKit/Source/core/editing/EditingStyle.h
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2103043004/diff/60001/third_party/WebKit/Source/core/editing/EditingStyle.h">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/2103043004/diff2/1:60001/third_party/WebKit/Source/core/editing/EditingStyle.h"
             title="Delta from patch set 1">1</a>
        
          <a href="/2103043004/diff2/20001:60001/third_party/WebKit/Source/core/editing/EditingStyle.h"
             title="Delta from patch set 2">2</a>
        
          <a href="/2103043004/diff2/40001:60001/third_party/WebKit/Source/core/editing/EditingStyle.h"
             title="Delta from patch set 3">3</a>
        
        </td>
        
          <td style="white-space: nowrap">2 chunks</td>
          <td style="white-space: nowrap">+2 lines, -1 line</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2103043004_60001_70004.diff"
             title="Download patch for third_party/WebKit/Source/core/editing/EditingStyle.h">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2103043004/patch/60001/70003">
            third_party/WebKit/Source/core/editing/EditingStyle.cpp
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2103043004/diff/60001/third_party/WebKit/Source/core/editing/EditingStyle.cpp">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/2103043004/diff2/1:60001/third_party/WebKit/Source/core/editing/EditingStyle.cpp"
             title="Delta from patch set 1">1</a>
        
          <a href="/2103043004/diff2/20001:60001/third_party/WebKit/Source/core/editing/EditingStyle.cpp"
             title="Delta from patch set 2">2</a>
        
          <a href="/2103043004/diff2/40001:60001/third_party/WebKit/Source/core/editing/EditingStyle.cpp"
             title="Delta from patch set 3">3</a>
        
        </td>
        
          <td style="white-space: nowrap">1 chunk</td>
          <td style="white-space: nowrap">+1 line, -1 line</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2103043004_60001_70003.diff"
             title="Download patch for third_party/WebKit/Source/core/editing/EditingStyle.cpp">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">A</td>
        <td>
          <a class="noul"
             href="/2103043004/patch/60001/70005">
            third_party/WebKit/Source/core/editing/EditingStyleTest.cpp
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2103043004/diff/60001/third_party/WebKit/Source/core/editing/EditingStyleTest.cpp">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/2103043004/diff2/1:60001/third_party/WebKit/Source/core/editing/EditingStyleTest.cpp"
             title="Delta from patch set 1">1</a>
        
          <a href="/2103043004/diff2/20001:60001/third_party/WebKit/Source/core/editing/EditingStyleTest.cpp"
             title="Delta from patch set 2">2</a>
        
          <a href="/2103043004/diff2/40001:60001/third_party/WebKit/Source/core/editing/EditingStyleTest.cpp"
             title="Delta from patch set 3">3</a>
        
        </td>
        
          <td style="white-space: nowrap">1 chunk</td>
          <td style="white-space: nowrap">+41 lines, -0 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2103043004_60001_70005.diff"
             title="Download patch for third_party/WebKit/Source/core/editing/EditingStyleTest.cpp">
            Download
          </a>
        </td>
      </tr>
    
  </table>

  
  
</div>

  
  </div>
  
    <script language="JavaScript" type="text/javascript">
         <!--
         var lastPSId = 60001;
         // -->
       </script>
  




  <h3>
    <a id="messages-pointer"
       href="javascript:M_toggleSection('messages')"
       class="toggled-section opentriangle">
      Messages
    </a>
  </h3>

  
    <div><i>
    Total messages: 31 (11 generated)
    </i></div>
  

  <div id="messages">
    <div style="margin-bottom: .5em;">
      <a href="javascript:M_expandAllVisibleComments('cl', 31)">
        Expand Messages</a>
      |
      <a href="javascript:M_collapseAllVisibleComments('cl', 31)">
        Collapse Messages</a>
      
      |
      <a href="javascript:M_showGeneratedComments(31)">
        Show Generated Messages</a>
      |
      <a href="javascript:M_hideGeneratedComments(31)">
        Hide Generated Messages</a>
      
    </div>

    
      <div class="message    generated"
           style="display: none"
           id="generated-msg1"
           name="0">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(0)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Timothy Loh</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-0">
                          Description was changed from ========== ---------------------This line is 72 characters long-------------------- bla BUG=622420 ========== to ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 5 months ago
		(2016-06-29 04:00:18 UTC)
                <a href="#msg1">#1</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-0"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-0"
            >Description was changed from

==========
---------------------This line is 72 characters long--------------------
bla

BUG=622420
==========

to

==========
---------------------This line is 72 characters long--------------------
Fix EditingStyle::mergeStyle()&#39;s handling of custom properties

This patch fixes the logic of EditingStyle::mergeStyle() to correctly
handle custom properties. Currently it serializes the CSSValue and then
reparses it, which, aside from being inefficient, doesn&#39;t work for
custom properties as the custom property name is lost (since we only
have the enum value CSSPropertyVariable).

BUG=622420
==========</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    generated"
           style="display: none"
           id="generated-msg2"
           name="1">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(1)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Timothy Loh</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-1">
                          timloh@chromium.org changed reviewers: + alancutter@chromium.org
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 5 months ago
		(2016-06-29 04:00:18 UTC)
                <a href="#msg2">#2</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-1"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-1"
            ><a href="mailto:timloh@chromium.org">timloh@chromium.org</a> changed reviewers:
+ <a href="mailto:alancutter@chromium.org">alancutter@chromium.org</a></pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message issue_was_closed   generated"
           style="display: none"
           id="generated-msg3"
           name="2">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(2)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Timothy Loh</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-2">
                          Description was changed from ========== ---------------------This line is 72 characters long-------------------- Fix EditingStyle::mergeStyle()&#39;s handling of ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 5 months ago
		(2016-06-29 04:00:32 UTC)
                <a href="#msg3">#3</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-2"
             style="display: none;">
          <div class="message-body">
            
              <span class="extra-note">
                Message was sent while issue was closed.
              </span>
            
            <pre name="cl-message-2"
            >Description was changed from

==========
---------------------This line is 72 characters long--------------------
Fix EditingStyle::mergeStyle()&#39;s handling of custom properties

This patch fixes the logic of EditingStyle::mergeStyle() to correctly
handle custom properties. Currently it serializes the CSSValue and then
reparses it, which, aside from being inefficient, doesn&#39;t work for
custom properties as the custom property name is lost (since we only
have the enum value CSSPropertyVariable).

BUG=622420
==========

to

==========
Fix EditingStyle::mergeStyle()&#39;s handling of custom properties

This patch fixes the logic of EditingStyle::mergeStyle() to correctly
handle custom properties. Currently it serializes the CSSValue and then
reparses it, which, aside from being inefficient, doesn&#39;t work for
custom properties as the custom property name is lost (since we only
have the enum value CSSPropertyVariable).

BUG=622420
==========</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    generated"
           style="display: none"
           id="generated-msg4"
           name="3">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(3)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Timothy Loh</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-3">
                          timloh@chromium.org changed reviewers: + yosin@chromium.org
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 5 months ago
		(2016-06-29 04:30:05 UTC)
                <a href="#msg4">#4</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-3"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-3"
            ><a href="mailto:timloh@chromium.org">timloh@chromium.org</a> changed reviewers:
+ <a href="mailto:yosin@chromium.org">yosin@chromium.org</a></pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg5"
           name="4">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(4)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Timothy Loh</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-4">
                          I don&#39;t really know the surrounding context to this code, so the test is just ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 5 months ago
		(2016-06-29 04:30:06 UTC)
                <a href="#msg5">#5</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-4"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-4"
            >I don&#39;t really know the surrounding context to this code, so the test is just
copied from clusterfuzz as I couldn&#39;t work out how to simplify it. I couldn&#39;t
get a test to crash a local build, but the test does crash my dev and stable
chrome builds.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg6"
           name="5">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(5)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>yosin_UTC9</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-5">
                          I can&#39;t access crbug.com/622420. Could you add me CC in that bug? Thanks in advance. ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 5 months ago
		(2016-06-29 05:11:42 UTC)
                <a href="#msg6">#6</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-5"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-5"
            >I can&#39;t access crbug.com/622420. Could you add me CC in that bug?
Thanks in advance.

<a href="https://codereview.chromium.org/2103043004/diff/1/third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html" rel="nofollow">https://codereview.chromium.org/2103043004/diff/1/third_party/WebKit/LayoutTe...</a>
File
third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html
(right):

<a href="https://codereview.chromium.org/2103043004/diff/1/third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html#newcode15" rel="nofollow">https://codereview.chromium.org/2103043004/diff/1/third_party/WebKit/LayoutTe...</a>
third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html:15:
document.execCommand(&#39;RemoveFormat&#39;, &#39;true&#39;, &#39;true&#39;)
Could you put write HTML in the file rather than constructing by script?

<a href="https://codereview.chromium.org/2103043004/diff/1/third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html#newcode16" rel="nofollow">https://codereview.chromium.org/2103043004/diff/1/third_party/WebKit/LayoutTe...</a>
third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html:16:
window.testRunner &amp;&amp; testRunner.dumpAsText();
Could you use test w3c harness? Using |assert_selection()| is preferred in this
case.
Sample: crrev.com/396768</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg7"
           name="6">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(6)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Timothy Loh</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-6">
                          https://codereview.chromium.org/2103043004/diff/1/third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html File third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html (right): https://codereview.chromium.org/2103043004/diff/1/third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html#newcode15 third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html:15: document.execCommand(&#39;RemoveFormat&#39;, &#39;true&#39;, &#39;true&#39;) On 2016/06/29 05:11:41, Yosi_UTC9 wrote: &gt; ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 5 months ago
		(2016-06-29 05:22:04 UTC)
                <a href="#msg7">#7</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-6"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-6"
            ><a href="https://codereview.chromium.org/2103043004/diff/1/third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html" rel="nofollow">https://codereview.chromium.org/2103043004/diff/1/third_party/WebKit/LayoutTe...</a>
File
third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html
(right):

<a href="https://codereview.chromium.org/2103043004/diff/1/third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html#newcode15" rel="nofollow">https://codereview.chromium.org/2103043004/diff/1/third_party/WebKit/LayoutTe...</a>
third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html:15:
document.execCommand(&#39;RemoveFormat&#39;, &#39;true&#39;, &#39;true&#39;)
On 2016/06/29 05:11:41, Yosi_UTC9 wrote:
&gt; Could you put write HTML in the file rather than constructing by script?

I tried doing this sort of thing but it no longer reproduced the issue, and I
don&#39;t really know what&#39;s going on in the editing code to work out why. So I
ended up just leaving the code pretty much verbatim from the clusterfuzz case.

<a href="https://codereview.chromium.org/2103043004/diff/1/third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html#newcode16" rel="nofollow">https://codereview.chromium.org/2103043004/diff/1/third_party/WebKit/LayoutTe...</a>
third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html:16:
window.testRunner &amp;&amp; testRunner.dumpAsText();
On 2016/06/29 05:11:42, Yosi_UTC9 wrote:
&gt; Could you use test w3c harness? Using |assert_selection()| is preferred in
this
&gt; case.
&gt; Sample: crrev.com/396768

I&#39;ll try, but I might not be able to get it to repro with it.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message  approval  "
           
           id="msg8"
           name="7">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(7)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>alancutter (OOO until 2018)</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-7">
                          lgtm with test nit. https://codereview.chromium.org/2103043004/diff/1/third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html File third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html (right): https://codereview.chromium.org/2103043004/diff/1/third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html#newcode16 third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html:16: window.testRunner &amp;&amp; testRunner.dumpAsText(); On 2016/06/29 ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 5 months ago
		(2016-06-29 07:26:10 UTC)
                <a href="#msg8">#8</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-7"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-7"
            >lgtm with test nit.

<a href="https://codereview.chromium.org/2103043004/diff/1/third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html" rel="nofollow">https://codereview.chromium.org/2103043004/diff/1/third_party/WebKit/LayoutTe...</a>
File
third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html
(right):

<a href="https://codereview.chromium.org/2103043004/diff/1/third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html#newcode16" rel="nofollow">https://codereview.chromium.org/2103043004/diff/1/third_party/WebKit/LayoutTe...</a>
third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html:16:
window.testRunner &amp;&amp; testRunner.dumpAsText();
On 2016/06/29 at 05:22:04, Timothy Loh wrote:
&gt; On 2016/06/29 05:11:42, Yosi_UTC9 wrote:
&gt; &gt; Could you use test w3c harness? Using |assert_selection()| is preferred in
this
&gt; &gt; case.
&gt; &gt; Sample: crrev.com/396768
&gt; 
&gt; I&#39;ll try, but I might not be able to get it to repro with it.

testharness.js is desirable. You may need to wait a frame with async_test() if
an empty test(() =&gt; {}) doesn&#39;t work.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg9"
           name="8">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(8)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>yosin_UTC9</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-8">
                          https://codereview.chromium.org/2103043004/diff/20001/third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html File third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html (right): https://codereview.chromium.org/2103043004/diff/20001/third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html#newcode11 third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html:11: newElem.style.cssText = &#39;--AAAA: var(--BBBB)&#39;; I think this line should ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 5 months ago
		(2016-06-30 04:07:38 UTC)
                <a href="#msg9">#9</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-8"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-8"
            ><a href="https://codereview.chromium.org/2103043004/diff/20001/third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html" rel="nofollow">https://codereview.chromium.org/2103043004/diff/20001/third_party/WebKit/Layo...</a>
File
third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html
(right):

<a href="https://codereview.chromium.org/2103043004/diff/20001/third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html#newcode11" rel="nofollow">https://codereview.chromium.org/2103043004/diff/20001/third_party/WebKit/Layo...</a>
third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html:11:
newElem.style.cssText = &#39;--AAAA: var(--BBBB)&#39;;
I think this line should not affect test since it is meaningless style.

<a href="https://codereview.chromium.org/2103043004/diff/20001/third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html#newcode14" rel="nofollow">https://codereview.chromium.org/2103043004/diff/20001/third_party/WebKit/Layo...</a>
third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html:14:
eCite.style.cssText = &#39;float: var(--CCCC)&#39;;
I think this line should not affect test since it is meaningless style.

<a href="https://codereview.chromium.org/2103043004/diff/20001/third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html#newcode17" rel="nofollow">https://codereview.chromium.org/2103043004/diff/20001/third_party/WebKit/Layo...</a>
third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html:17:
document.execCommand(&#39;SelectAll&#39;, &#39;false&#39;, &#39;true&#39;);
nit: you don&#39;t need to have |, &#39;false&#39;, &#39;true&#39;|.

<a href="https://codereview.chromium.org/2103043004/diff/20001/third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html#newcode18" rel="nofollow">https://codereview.chromium.org/2103043004/diff/20001/third_party/WebKit/Layo...</a>
third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html:18:
document.execCommand(&#39;RemoveFormat&#39;, &#39;true&#39;, &#39;true&#39;);
nit: you don&#39;t need to have |, &#39;true&#39;, &#39;true&#39;|.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg10"
           name="9">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(9)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Timothy Loh</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-9">
                          https://codereview.chromium.org/2103043004/diff/1/third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html File third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html (right): https://codereview.chromium.org/2103043004/diff/1/third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html#newcode16 third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html:16: window.testRunner &amp;&amp; testRunner.dumpAsText(); On 2016/06/29 07:26:10, alancutter wrote: &gt; ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 5 months ago
		(2016-06-30 04:16:42 UTC)
                <a href="#msg10">#10</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-9"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-9"
            ><a href="https://codereview.chromium.org/2103043004/diff/1/third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html" rel="nofollow">https://codereview.chromium.org/2103043004/diff/1/third_party/WebKit/LayoutTe...</a>
File
third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html
(right):

<a href="https://codereview.chromium.org/2103043004/diff/1/third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html#newcode16" rel="nofollow">https://codereview.chromium.org/2103043004/diff/1/third_party/WebKit/LayoutTe...</a>
third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html:16:
window.testRunner &amp;&amp; testRunner.dumpAsText();
On 2016/06/29 07:26:10, alancutter wrote:
&gt; On 2016/06/29 at 05:22:04, Timothy Loh wrote:
&gt; &gt; On 2016/06/29 05:11:42, Yosi_UTC9 wrote:
&gt; &gt; &gt; Could you use test w3c harness? Using |assert_selection()| is preferred in
&gt; this
&gt; &gt; &gt; case.
&gt; &gt; &gt; Sample: crrev.com/396768
&gt; &gt; 
&gt; &gt; I&#39;ll try, but I might not be able to get it to repro with it.
&gt; 
&gt; testharness.js is desirable. You may need to wait a frame with async_test() if
&gt; an empty test(() =&gt; {}) doesn&#39;t work.

I updated the test with a test(() =&gt; {}) call, seems to still work. I&#39;m not
really sure how I should be using assert_selection() since I&#39;m just checking
whether the page crashes.

<a href="https://codereview.chromium.org/2103043004/diff/20001/third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html" rel="nofollow">https://codereview.chromium.org/2103043004/diff/20001/third_party/WebKit/Layo...</a>
File
third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html
(right):

<a href="https://codereview.chromium.org/2103043004/diff/20001/third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html#newcode11" rel="nofollow">https://codereview.chromium.org/2103043004/diff/20001/third_party/WebKit/Layo...</a>
third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html:11:
newElem.style.cssText = &#39;--AAAA: var(--BBBB)&#39;;
On 2016/06/30 04:07:38, Yosi_UTC9 wrote:
&gt; I think this line should not affect test since it is meaningless style.

This is necessary for the crash, since this results in the declaration which
mergeStyle doesn&#39;t correctly handle.

<a href="https://codereview.chromium.org/2103043004/diff/20001/third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html#newcode14" rel="nofollow">https://codereview.chromium.org/2103043004/diff/20001/third_party/WebKit/Layo...</a>
third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html:14:
eCite.style.cssText = &#39;float: var(--CCCC)&#39;;
On 2016/06/30 04:07:38, Yosi_UTC9 wrote:
&gt; I think this line should not affect test since it is meaningless style.

Seems to be required to repro the crash.

<a href="https://codereview.chromium.org/2103043004/diff/20001/third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html#newcode17" rel="nofollow">https://codereview.chromium.org/2103043004/diff/20001/third_party/WebKit/Layo...</a>
third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html:17:
document.execCommand(&#39;SelectAll&#39;, &#39;false&#39;, &#39;true&#39;);
On 2016/06/30 04:07:38, Yosi_UTC9 wrote:
&gt; nit: you don&#39;t need to have |, &#39;false&#39;, &#39;true&#39;|.

removed

<a href="https://codereview.chromium.org/2103043004/diff/20001/third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html#newcode18" rel="nofollow">https://codereview.chromium.org/2103043004/diff/20001/third_party/WebKit/Layo...</a>
third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html:18:
document.execCommand(&#39;RemoveFormat&#39;, &#39;true&#39;, &#39;true&#39;);
On 2016/06/30 04:07:38, Yosi_UTC9 wrote:
&gt; nit: you don&#39;t need to have |, &#39;true&#39;, &#39;true&#39;|.

removed</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg11"
           name="10">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(10)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>yosin_UTC9</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-10">
                          https://codereview.chromium.org/2103043004/diff/40001/third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html File third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html (right): https://codereview.chromium.org/2103043004/diff/40001/third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html#newcode1 third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html:1: &lt;!doctype html&gt; How about writing gTest for this case, ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 5 months ago
		(2016-07-01 09:28:49 UTC)
                <a href="#msg11">#11</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-10"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-10"
            ><a href="https://codereview.chromium.org/2103043004/diff/40001/third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html" rel="nofollow">https://codereview.chromium.org/2103043004/diff/40001/third_party/WebKit/Layo...</a>
File
third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html
(right):

<a href="https://codereview.chromium.org/2103043004/diff/40001/third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html#newcode1" rel="nofollow">https://codereview.chromium.org/2103043004/diff/40001/third_party/WebKit/Layo...</a>
third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html:1:
&lt;!doctype html&gt;
How about writing gTest for this case, e.g. EditingStyleTest?
This layout test script is rather cryptic and hard to understand &quot;flat:
var(--CCC)&quot; related to |mergeStyle()|.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg12"
           name="11">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(11)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Timothy Loh</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-11">
                          https://codereview.chromium.org/2103043004/diff/40001/third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html File third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html (right): https://codereview.chromium.org/2103043004/diff/40001/third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html#newcode1 third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html:1: &lt;!doctype html&gt; On 2016/07/01 09:28:49, Yosi_UTC9 wrote: &gt; How ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 5 months ago
		(2016-07-07 02:54:33 UTC)
                <a href="#msg12">#12</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-11"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-11"
            ><a href="https://codereview.chromium.org/2103043004/diff/40001/third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html" rel="nofollow">https://codereview.chromium.org/2103043004/diff/40001/third_party/WebKit/Layo...</a>
File
third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html
(right):

<a href="https://codereview.chromium.org/2103043004/diff/40001/third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html#newcode1" rel="nofollow">https://codereview.chromium.org/2103043004/diff/40001/third_party/WebKit/Layo...</a>
third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html:1:
&lt;!doctype html&gt;
On 2016/07/01 09:28:49, Yosi_UTC9 wrote:
&gt; How about writing gTest for this case, e.g. EditingStyleTest?
&gt; This layout test script is rather cryptic and hard to understand &quot;flat:
&gt; var(--CCC)&quot; related to |mergeStyle()|.

The test right now is just a copy of the clusterfuzz test with the changes that
reviewers have suggested. I&#39;m not familiar with editing code to write gTest test
for it. I&#39;m also not sure if using gTest is a good idea for tests where we just
want to verify that something doesn&#39;t crash.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg13"
           name="12">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(12)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>yosin_UTC9</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-12">
                          https://codereview.chromium.org/2103043004/diff/40001/third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html File third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html (right): https://codereview.chromium.org/2103043004/diff/40001/third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html#newcode1 third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html:1: &lt;!doctype html&gt; On 2016/07/07 at 02:54:32, Timothy Loh wrote: ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 5 months ago
		(2016-07-07 05:47:22 UTC)
                <a href="#msg13">#13</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-12"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-12"
            ><a href="https://codereview.chromium.org/2103043004/diff/40001/third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html" rel="nofollow">https://codereview.chromium.org/2103043004/diff/40001/third_party/WebKit/Layo...</a>
File
third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html
(right):

<a href="https://codereview.chromium.org/2103043004/diff/40001/third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html#newcode1" rel="nofollow">https://codereview.chromium.org/2103043004/diff/40001/third_party/WebKit/Layo...</a>
third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html:1:
&lt;!doctype html&gt;
On 2016/07/07 at 02:54:32, Timothy Loh wrote:
&gt; On 2016/07/01 09:28:49, Yosi_UTC9 wrote:
&gt; &gt; How about writing gTest for this case, e.g. EditingStyleTest?
&gt; &gt; This layout test script is rather cryptic and hard to understand &quot;flat:
&gt; &gt; var(--CCC)&quot; related to |mergeStyle()|.
&gt; 
&gt; The test right now is just a copy of the clusterfuzz test with the changes
that reviewers have suggested. I&#39;m not familiar with editing code to write gTest
test for it. I&#39;m also not sure if using gTest is a good idea for tests where we
just want to verify that something doesn&#39;t crash.

We would like to check result of the regressed function to avoid future
regression in addition to not crashing.
I write an example of gTest for test: <a href="http://crrev.com/2126143002" rel="nofollow">http://crrev.com/2126143002</a>
I think gTest is simpler and more specific in this case.

I hope you agree to using gTest rather than layout test.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg14"
           name="13">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(13)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>alancutter (OOO until 2018)</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-13">
                          On 2016/07/07 at 05:47:22, yosin wrote: &gt; https://codereview.chromium.org/2103043004/diff/40001/third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html &gt; File third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html (right): &gt; &gt; https://codereview.chromium.org/2103043004/diff/40001/third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html#newcode1 ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 5 months ago
		(2016-07-14 07:23:17 UTC)
                <a href="#msg14">#14</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-13"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-13"
            >On 2016/07/07 at 05:47:22, yosin wrote:
&gt;
<a href="https://codereview.chromium.org/2103043004/diff/40001/third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html" rel="nofollow">https://codereview.chromium.org/2103043004/diff/40001/third_party/WebKit/Layo...</a>
&gt; File
third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html
(right):
&gt; 
&gt;
<a href="https://codereview.chromium.org/2103043004/diff/40001/third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html#newcode1" rel="nofollow">https://codereview.chromium.org/2103043004/diff/40001/third_party/WebKit/Layo...</a>
&gt;
third_party/WebKit/LayoutTests/editing/execCommand/remove-format-variable-crash.html:1:
&lt;!doctype html&gt;
&gt; On 2016/07/07 at 02:54:32, Timothy Loh wrote:
&gt; &gt; On 2016/07/01 09:28:49, Yosi_UTC9 wrote:
&gt; &gt; &gt; How about writing gTest for this case, e.g. EditingStyleTest?
&gt; &gt; &gt; This layout test script is rather cryptic and hard to understand &quot;flat:
&gt; &gt; &gt; var(--CCC)&quot; related to |mergeStyle()|.
&gt; &gt; 
&gt; &gt; The test right now is just a copy of the clusterfuzz test with the changes
that reviewers have suggested. I&#39;m not familiar with editing code to write gTest
test for it. I&#39;m also not sure if using gTest is a good idea for tests where we
just want to verify that something doesn&#39;t crash.
&gt; 
&gt; We would like to check result of the regressed function to avoid future
regression in addition to not crashing.
&gt; I write an example of gTest for test: <a href="http://crrev.com/2126143002" rel="nofollow">http://crrev.com/2126143002</a>
&gt; I think gTest is simpler and more specific in this case.
&gt; 
&gt; I hope you agree to using gTest rather than layout test.

We should have a layout test to ensure the crash is no longer triggered just by
using the web platform API, gTests don&#39;t provide the same verification.
Stylistic decisions about whether the test should be cleaned up and whether a
gTest should be made should not block landing this crash fix, please see the
associated bug.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    generated"
           style="display: none"
           id="generated-msg15"
           name="14">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(14)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>yosin_UTC9</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-14">
                          yosin@chromium.org changed reviewers: + tkent@chromium.org
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 5 months ago
		(2016-07-14 07:49:54 UTC)
                <a href="#msg15">#15</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-14"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-14"
            ><a href="mailto:yosin@chromium.org">yosin@chromium.org</a> changed reviewers:
+ <a href="mailto:tkent@chromium.org">tkent@chromium.org</a></pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg16"
           name="15">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(15)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>yosin_UTC9</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-15">
                          +tkent@, WDYT?
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 5 months ago
		(2016-07-14 07:49:55 UTC)
                <a href="#msg16">#16</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-15"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-15"
            >+tkent@, WDYT?</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg17"
           name="16">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(16)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>tkent</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-16">
                          On 2016/07/14 at 07:49:55, yosin wrote: &gt; +tkent@, WDYT? IMO, we should make C++ unit ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 5 months ago
		(2016-07-14 08:14:13 UTC)
                <a href="#msg17">#17</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-16"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-16"
            >On 2016/07/14 at 07:49:55, yosin wrote:
&gt; +tkent@, WDYT?

IMO, we should make C++ unit tests for crash fixes. Crash bugs strongly depend
on internal code structure, and layout tests for crash bugs easily become
meaningless by internal code changes.  For example, Oilpan must make many tests
meaningless, but we have no good ways to know what tests we can remove.

Even if we write a layout test for a crash, we should minimize the test case
produced by ClusterFuzz in order to make the test robust.  We&#39;ll remove &quot;keygen&quot;
element soon.  Will the test make sense after that?</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg18"
           name="17">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(17)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Timothy Loh</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-17">
                          On 2016/07/07 05:47:22, Yosi_UTC9 wrote: &gt; We would like to check result of the regressed ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 4 months ago
		(2016-08-09 03:27:13 UTC)
                <a href="#msg18">#18</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-17"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-17"
            >On 2016/07/07 05:47:22, Yosi_UTC9 wrote:
&gt; We would like to check result of the regressed function to avoid future
&gt; regression in addition to not crashing.
&gt; I write an example of gTest for test: <a href="http://crrev.com/2126143002" rel="nofollow">http://crrev.com/2126143002</a>
&gt; I think gTest is simpler and more specific in this case.

I removed the LayoutTest and added the gTest you suggested without
modifications.

On 2016/07/14 08:14:13, tkent wrote:
&gt; On 2016/07/14 at 07:49:55, yosin wrote:
&gt; &gt; +tkent@, WDYT?
&gt; 
&gt; IMO, we should make C++ unit tests for crash fixes. Crash bugs strongly depend
&gt; on internal code structure, and layout tests for crash bugs easily become
&gt; meaningless by internal code changes.  For example, Oilpan must make many
tests
&gt; meaningless, but we have no good ways to know what tests we can remove.
&gt; 
&gt; Even if we write a layout test for a crash, we should minimize the test case
&gt; produced by ClusterFuzz in order to make the test robust.  We&#39;ll remove
&quot;keygen&quot;
&gt; element soon.  Will the test make sense after that?

In this case the test was by an *external* fuzzer and not ClusterFuzz. The crash
doesn&#39;t repro when I change &quot;keygen&quot; to a different element (I tried div, span,
button, select, and a few more) and I don&#39;t know about the editing codepaths
enough to understand why.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message  approval  "
           
           id="msg19"
           name="18">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(18)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>yosin_UTC9</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-18">
                          lgtm since it has a test. On 2016/08/09 at 03:27:13, timloh wrote: &gt; On 2016/07/07 ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 4 months ago
		(2016-08-09 05:15:59 UTC)
                <a href="#msg19">#19</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-18"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-18"
            >lgtm since it has a test.

On 2016/08/09 at 03:27:13, timloh wrote:
&gt; On 2016/07/07 05:47:22, Yosi_UTC9 wrote:
&gt; &gt; We would like to check result of the regressed function to avoid future
&gt; &gt; regression in addition to not crashing.
&gt; &gt; I write an example of gTest for test: <a href="http://crrev.com/2126143002" rel="nofollow">http://crrev.com/2126143002</a>
&gt; &gt; I think gTest is simpler and more specific in this case.
&gt; 
&gt; I removed the LayoutTest and added the gTest you suggested without
modifications.
&gt; 
&gt; On 2016/07/14 08:14:13, tkent wrote:
&gt; &gt; On 2016/07/14 at 07:49:55, yosin wrote:
&gt; &gt; &gt; +tkent@, WDYT?
&gt; &gt; 
&gt; &gt; IMO, we should make C++ unit tests for crash fixes. Crash bugs strongly
depend
&gt; &gt; on internal code structure, and layout tests for crash bugs easily become
&gt; &gt; meaningless by internal code changes.  For example, Oilpan must make many
tests
&gt; &gt; meaningless, but we have no good ways to know what tests we can remove.
&gt; &gt; 
&gt; &gt; Even if we write a layout test for a crash, we should minimize the test case
&gt; &gt; produced by ClusterFuzz in order to make the test robust.  We&#39;ll remove
&quot;keygen&quot;
&gt; &gt; element soon.  Will the test make sense after that?
&gt; 
&gt; In this case the test was by an *external* fuzzer and not ClusterFuzz. 

I don&#39;t understand your point of External or ClusterFuzz. Any fuzzers generates
cryptic script not friendly for human.

&gt; The crash doesn&#39;t repro when I change &quot;keygen&quot; to a different element (I tried
div, span, button, select, and a few more) and I don&#39;t know about the editing
codepaths enough to understand why.
I wrote gTest from your changes to infer how to hit the case without deep
understanding of code path.
In my experience, minimizing Fuzzer&#39;s generated script is difficult and identify
code path.
Using gTest allows us to directly call a function causing an issue with
parameters to reproduce.
It is an edge case and subject for unit test.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    generated"
           style="display: none"
           id="generated-msg20"
           name="19">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(19)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Timothy Loh</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-19">
                          The CQ bit was checked by timloh@chromium.org
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 4 months ago
		(2016-08-09 05:16:57 UTC)
                <a href="#msg20">#20</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-19"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-19"
            >The CQ bit was checked by <a href="mailto:timloh@chromium.org">timloh@chromium.org</a></pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    generated"
           style="display: none"
           id="generated-msg21"
           name="20">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(20)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Timothy Loh</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-20">
                          The patchset sent to the CQ was uploaded after l-g-t-m from alancutter@chromium.org Link to the ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 4 months ago
		(2016-08-09 05:16:58 UTC)
                <a href="#msg21">#21</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-20"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-20"
            >The patchset sent to the CQ was uploaded after l-g-t-m from
<a href="mailto:alancutter@chromium.org">alancutter@chromium.org</a>
Link to the patchset: <a href="https://codereview.chromium.org/2103043004/#ps60001" rel="nofollow">https://codereview.chromium.org/2103043004/#ps60001</a>
(title: &quot;gtest instead of layout test&quot;)</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg22"
           name="21">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(21)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>commit-bot: I haz the power</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-21">
                          CQ is trying da patch. Follow status at https://chromium-cq-status.appspot.com/v2/patch-status/codereview.chromium.org/2103043004/60001
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 4 months ago
		(2016-08-09 05:17:35 UTC)
                <a href="#msg22">#22</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-21"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-21"
            >CQ is trying da patch. Follow status at
 
<a href="https://chromium-cq-status.appspot.com/v2/patch-status/codereview.chromium.org/2103043004/60001" rel="nofollow">https://chromium-cq-status.appspot.com/v2/patch-status/codereview.chromium.or...</a></pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg23"
           name="22">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(22)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Timothy Loh</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-22">
                          On 2016/08/09 05:15:59, Yosi_UTC9 wrote: &gt; On 2016/08/09 at 03:27:13, timloh wrote: &gt; &gt; In ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 4 months ago
		(2016-08-09 05:21:43 UTC)
                <a href="#msg23">#23</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-22"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-22"
            >On 2016/08/09 05:15:59, Yosi_UTC9 wrote:
&gt; On 2016/08/09 at 03:27:13, timloh wrote:
&gt; &gt; In this case the test was by an *external* fuzzer and not ClusterFuzz. 
&gt; 
&gt; I don&#39;t understand your point of External or ClusterFuzz. Any fuzzers
generates
&gt; cryptic script not friendly for human.

The crash has been around for a while but was never identified by CF, so we
likely don&#39;t have coverage for this intersection of features in CF. If I
understand correctly, CF has fuzzers which take existing layout tests and mutate
them, so I wanted to have the test to help it.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    generated"
           style="display: none"
           id="generated-msg24"
           name="23">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(23)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>commit-bot: I haz the power</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-23">
                          The CQ bit was unchecked by commit-bot@chromium.org
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 4 months ago
		(2016-08-09 06:34:19 UTC)
                <a href="#msg24">#24</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-23"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-23"
            >The CQ bit was unchecked by <a href="mailto:commit-bot@chromium.org">commit-bot@chromium.org</a></pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg25"
           name="24">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(24)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>commit-bot: I haz the power</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-24">
                          Try jobs failed on following builders: win_chromium_rel_ng on master.tryserver.chromium.win (JOB_FAILED, http://build.chromium.org/p/tryserver.chromium.win/builders/win_chromium_rel_ng/builds/269625)
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 4 months ago
		(2016-08-09 06:34:20 UTC)
                <a href="#msg25">#25</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-24"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-24"
            >Try jobs failed on following builders:
  win_chromium_rel_ng on master.tryserver.chromium.win (JOB_FAILED,
<a href="http://build.chromium.org/p/tryserver.chromium.win/builders/win_chromium_rel_ng/builds/269625" rel="nofollow">http://build.chromium.org/p/tryserver.chromium.win/builders/win_chromium_rel_...</a>)</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    generated"
           style="display: none"
           id="generated-msg26"
           name="25">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(25)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>Timothy Loh</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-25">
                          The CQ bit was checked by timloh@chromium.org
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 4 months ago
		(2016-08-09 06:35:55 UTC)
                <a href="#msg26">#26</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-25"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-25"
            >The CQ bit was checked by <a href="mailto:timloh@chromium.org">timloh@chromium.org</a></pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg27"
           name="26">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(26)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>commit-bot: I haz the power</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-26">
                          CQ is trying da patch. Follow status at https://chromium-cq-status.appspot.com/v2/patch-status/codereview.chromium.org/2103043004/60001
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 4 months ago
		(2016-08-09 06:36:27 UTC)
                <a href="#msg27">#27</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-26"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-26"
            >CQ is trying da patch. Follow status at
 
<a href="https://chromium-cq-status.appspot.com/v2/patch-status/codereview.chromium.org/2103043004/60001" rel="nofollow">https://chromium-cq-status.appspot.com/v2/patch-status/codereview.chromium.or...</a></pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message issue_was_closed   generated"
           style="display: none"
           id="generated-msg28"
           name="27">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(27)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>commit-bot: I haz the power</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-27">
                          Description was changed from ========== Fix EditingStyle::mergeStyle()&#39;s handling of custom properties This patch fixes the ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 4 months ago
		(2016-08-09 08:19:41 UTC)
                <a href="#msg28">#28</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-27"
             style="display: none;">
          <div class="message-body">
            
              <span class="extra-note">
                Message was sent while issue was closed.
              </span>
            
            <pre name="cl-message-27"
            >Description was changed from

==========
Fix EditingStyle::mergeStyle()&#39;s handling of custom properties

This patch fixes the logic of EditingStyle::mergeStyle() to correctly
handle custom properties. Currently it serializes the CSSValue and then
reparses it, which, aside from being inefficient, doesn&#39;t work for
custom properties as the custom property name is lost (since we only
have the enum value CSSPropertyVariable).

BUG=622420
==========

to

==========
Fix EditingStyle::mergeStyle()&#39;s handling of custom properties

This patch fixes the logic of EditingStyle::mergeStyle() to correctly
handle custom properties. Currently it serializes the CSSValue and then
reparses it, which, aside from being inefficient, doesn&#39;t work for
custom properties as the custom property name is lost (since we only
have the enum value CSSPropertyVariable).

BUG=622420
==========</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message issue_was_closed   "
           
           id="msg29"
           name="28">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(28)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>commit-bot: I haz the power</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-28">
                          Committed patchset #4 (id:60001)
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 4 months ago
		(2016-08-09 08:19:46 UTC)
                <a href="#msg29">#29</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-28"
             style="display: none;">
          <div class="message-body">
            
              <span class="extra-note">
                Message was sent while issue was closed.
              </span>
            
            <pre name="cl-message-28"
            >Committed patchset #4 (id:60001)</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message issue_was_closed   generated"
           style="display: none"
           id="generated-msg30"
           name="29">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(29)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>commit-bot: I haz the power</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-29">
                          Description was changed from ========== Fix EditingStyle::mergeStyle()&#39;s handling of custom properties This patch fixes the ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 4 months ago
		(2016-08-09 08:21:54 UTC)
                <a href="#msg30">#30</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-29"
             style="display: none;">
          <div class="message-body">
            
              <span class="extra-note">
                Message was sent while issue was closed.
              </span>
            
            <pre name="cl-message-29"
            >Description was changed from

==========
Fix EditingStyle::mergeStyle()&#39;s handling of custom properties

This patch fixes the logic of EditingStyle::mergeStyle() to correctly
handle custom properties. Currently it serializes the CSSValue and then
reparses it, which, aside from being inefficient, doesn&#39;t work for
custom properties as the custom property name is lost (since we only
have the enum value CSSPropertyVariable).

BUG=622420
==========

to

==========
Fix EditingStyle::mergeStyle()&#39;s handling of custom properties

This patch fixes the logic of EditingStyle::mergeStyle() to correctly
handle custom properties. Currently it serializes the CSSValue and then
reparses it, which, aside from being inefficient, doesn&#39;t work for
custom properties as the custom property name is lost (since we only
have the enum value CSSPropertyVariable).

BUG=622420

Committed: <a href="https://crrev.com/aadb63893e4c1358d1e5139aa29552eb190682c8" rel="nofollow">https://crrev.com/aadb63893e4c1358d1e5139aa29552eb190682c8</a>
Cr-Commit-Position: refs/heads/master@{#410614}
==========</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message issue_was_closed   "
           
           id="msg31"
           name="30">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(30)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>commit-bot: I haz the power</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden; display: none;"
                           class="extra"
                           id="cl-preview-30">
                          Patchset 4 (id:??) landed as https://crrev.com/aadb63893e4c1358d1e5139aa29552eb190682c8 Cr-Commit-Position: refs/heads/master@{#410614}
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 4 months ago
		(2016-08-09 08:21:55 UTC)
                <a href="#msg31">#31</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-30"
             >
          <div class="message-body">
            
              <span class="extra-note">
                Message was sent while issue was closed.
              </span>
            
            <pre name="cl-message-30"
            >Patchset 4 (id:??) landed as
<a href="https://crrev.com/aadb63893e4c1358d1e5139aa29552eb190682c8" rel="nofollow">https://crrev.com/aadb63893e4c1358d1e5139aa29552eb190682c8</a>
Cr-Commit-Position: refs/heads/master@{#410614}</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    

    <div>
      <a href="javascript:M_expandAllVisibleComments('cl', 31)">
        Expand Messages</a>
      |
      <a href="javascript:M_collapseAllVisibleComments('cl', 31)">
        Collapse Messages</a>
      
      |
      <a href="javascript:M_showGeneratedComments(31)">
        Show Generated Messages</a>
      |
      <a href="javascript:M_hideGeneratedComments(31)">
        Hide Generated Messages</a>
      
    </div>

  </div>

<script language="JavaScript" type="text/javascript">
<!--
var lastMsgID = 31;
// -->
</script>




<script language="JavaScript" type="text/javascript">
  <!--
    document.onkeydown = M_changelistKeyDown;
    var dashboardState = new M_DashboardState(window, 'patch', 'M_CLPatchMarker');
    var issueId = 2103043004;
    M_toggleIssueOverviewByAnchor();
  // -->
</script>



      </td>
    </tr>
  </table>

</div>

  
    <div class="popup" id="popup-issue">
      <b>Issue 2103043004: Fix EditingStyle::mergeStyle()&#39;s handling of custom properties
     (Closed) </b><br/>
      Created 4 years, 5 months ago by Timothy Loh<br/>
      Modified 4 years, 4 months ago<br/>
      Reviewers: yosin_UTC9, alancutter (OOO until 2018), tkent<br/>
      Base URL: https://chromium.googlesource.com/chromium/src.git@master<br/>
      Comments: 17
      
    </div>
  


<p></p>
<div style="float: left;">
  <a target="_blank" href="http://code.google.com/appengine/"><img border="0"
   src="/static/appengine-noborder-120x30.gif"
   alt="Powered by Google App Engine" /></a>
</div>

<div class="extra" style="font-size: 9pt; float: right; text-align: right;">
  <div style="margin-top: .3em;">This is Rietveld <a href='http://code.google.com/p/rietveld/source/list'>408576698
</a></div>
</div>


<script>
  // Google Analytics.
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-55762617-11', {
    'allowLinker': true,
    'siteSpeedSampleRate': 100
  });
  ga('require', 'linker');
  ga('linker:autoLink',
     ['chromiumcodereview.appspot.com', 'codereview.chromium.org'] );
  ga('send', 'pageview');

  // CRDX Feedback button.
  (function(i,s,o,g,r,a,m){i['CrDXObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://storage.googleapis.com/crdx-feedback.appspot.com/feedback.js','crdx');

  crdx('setFeedbackButtonLink',
      'https://bugs.chromium.org/p/chromium/issues/entry?cc=andybons@chromium.org&components=Infra%3ECodereview%3ERietveld&labels=Infra-DX');
</script>


</body>
</html>
