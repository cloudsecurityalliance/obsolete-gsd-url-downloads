<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="UTF-8">
<meta property="og:type" content="website">
<meta property="og:title" content="1469916 - (CVE-2018-12402) SameSite Cookies leakage via &quot;Save Page As...&quot;">
<meta property="og:url" content="https://bugzilla.mozilla.org/show_bug.cgi?id=1469916">
<meta property="og:description"
      content="VERIFIED (gijskruitbosch+bugs) in Core - DOM: Security. Last updated 2020-05-24.">
<meta name="twitter:label1" value="Type">
<meta name="twitter:data1" value="defect">
<meta name="twitter:label2" value="Priority">
<meta name="twitter:data2" value="P2">

    <meta name="viewport" content="width=1024">
    <meta name="color-scheme" content="dark light">
    <meta name="generator" content="Bugzilla 20211025.1">
    <meta name="bugzilla-global" content="dummy"
        id="bugzilla-global" data-bugzilla="{&quot;api_token&quot;:&quot;&quot;,&quot;config&quot;:{&quot;basepath&quot;:&quot;\/&quot;},&quot;constant&quot;:{&quot;COMMENT_COLS&quot;:80},&quot;param&quot;:{&quot;maxattachmentsize&quot;:&quot;10240&quot;,&quot;maxusermatches&quot;:&quot;50&quot;,&quot;splinter_base&quot;:&quot;\/page.cgi?id=splinter.html&amp;ignore=\/&quot;},&quot;string&quot;:{&quot;bug_type_required&quot;:&quot;You must select a Type for this bug&quot;,&quot;component_required&quot;:&quot;You must select a Component for this bug&quot;,&quot;description_required&quot;:&quot;You must enter a Description for this bug&quot;,&quot;short_desc_required&quot;:&quot;You must enter a Summary for this bug&quot;,&quot;version_required&quot;:&quot;You must select a Version for this bug&quot;},&quot;user&quot;:{&quot;is_new&quot;:1,&quot;login&quot;:&quot;&quot;}}">
    <title>1469916 - (CVE-2018-12402) SameSite Cookies leakage via &quot;Save Page As...&quot;</title>

<link rel="Top" href="/">

  


  
    <link rel="Show" title="Dependency Tree"
          href="/showdependencytree.cgi?id=1469916&amp;hide_resolved=1">
      <link rel="Show" title="Dependency Graph"
            href="/showdependencygraph.cgi?id=1469916">

      <link rel="Show" title="Bug Activity"
            href="/show_activity.cgi?id=1469916">

<link href="/static/v20211025.1/skins/yui.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/standard/global.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BugModal/web/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BMO/web/styles/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/EditComments/web/styles/inline-editor.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-structure-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-theme-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/lib/prism.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Needinfo/web/styles/needinfo.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Review/web/styles/badge.css" rel="stylesheet" type="text/css">



    
<script nonce="jlwwB3FDA7LRrDKQLG8nqxyJOWEsvsgnVIZPwedSuhJj35FT" src="/static/v20211025.1/js/jquery/jquery-min.js"></script><script nonce="jlwwB3FDA7LRrDKQLG8nqxyJOWEsvsgnVIZPwedSuhJj35FT" src="/static/v20211025.1/js/jquery/ui/jquery-ui-min.js"></script><script nonce="jlwwB3FDA7LRrDKQLG8nqxyJOWEsvsgnVIZPwedSuhJj35FT" src="/static/v20211025.1/js/yui.js"></script><script nonce="jlwwB3FDA7LRrDKQLG8nqxyJOWEsvsgnVIZPwedSuhJj35FT" src="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu-min.js"></script><script nonce="jlwwB3FDA7LRrDKQLG8nqxyJOWEsvsgnVIZPwedSuhJj35FT" src="/static/v20211025.1/js/jquery/plugins/devbridgeAutocomplete/devbridgeAutocomplete-min.js"></script><script nonce="jlwwB3FDA7LRrDKQLG8nqxyJOWEsvsgnVIZPwedSuhJj35FT" src="/static/v20211025.1/js/global.js"></script><script nonce="jlwwB3FDA7LRrDKQLG8nqxyJOWEsvsgnVIZPwedSuhJj35FT" src="/static/v20211025.1/js/util.js"></script><script nonce="jlwwB3FDA7LRrDKQLG8nqxyJOWEsvsgnVIZPwedSuhJj35FT" src="/static/v20211025.1/js/dropdown.js"></script>

      <script nonce="jlwwB3FDA7LRrDKQLG8nqxyJOWEsvsgnVIZPwedSuhJj35FT">
          YAHOO.namespace('bugzilla');
          if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
              YAHOO.util.Event._simpleRemove(window, "unload",
                                             YAHOO.util.Event._unload);
          }BUGZILLA.value_descs = JSON.parse('{\"bug_status\":{},\"resolution\":{\"\":\"---\"}}');

  
    var tracking_flags_str = "{\"comments\":{\"cf_tracking_firefox_esr91\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_sumo\":{\"none-needed\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox_relnote\":{\"?\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_a11y_review_project_flag\":{\"requested\":\"Description:\\nPlease provide an explanation of the feature or change. Include a description of the user scenario in which it would be used and how the user would complete the task(s).\\nScreenshots and visual UI specs are welcome, but please include sufficient accompanying explanation so that blind members of the accessibility team are able to understand the feature\/change.\\n\\nHow do we test this?\\nIf there is an implementation to test, please provide instructions for testing it; e.g. setting preferences, other preparation, how to trigger the UI, etc.\\n\\nWhen will this ship?\\nTracking bug\/issue:\\nDesign documents (e.g. Product Requirements Document, UI spec):\\nEngineering lead:\\nProduct manager:\\n\\nThe accessibility team has developed the Mozilla Accessibility Release Guidelines which outline what is needed to make user interfaces accessible:\\nhttps:\/\/wiki.mozilla.org\/Accessibility\/Guidelines\\nPlease describe the accessibility guidelines you considered and what steps you\'ve taken to address them:\\n\\nDescribe any areas of concern to which you want the accessibility team to give special attention:\"},\"cf_tracking_firefox_esr78\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox95\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox93\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox94\":{\"?\":\"[Tracking Requested - why for this release]:\"}},\"flags\":{\"tracking\":{\"cf_status_firefox95\":\"---\",\"cf_status_firefox62\":\"wontfix\",\"cf_tracking_firefox93\":\"---\",\"cf_tracking_firefox95\":\"---\",\"cf_tracking_firefox94\":\"---\",\"cf_status_firefox_esr52\":\"wontfix\",\"cf_tracking_thunderbird_esr78\":\"---\",\"cf_status_firefox_esr91\":\"---\",\"cf_tracking_firefox_esr91\":\"---\",\"cf_status_firefox_esr78\":\"---\",\"cf_status_firefox94\":\"---\",\"cf_tracking_firefox_relnote\":\"---\",\"cf_status_thunderbird_esr78\":\"---\",\"cf_status_firefox63\":\"verified\",\"cf_tracking_firefox_esr78\":\"---\",\"cf_status_thunderbird_esr91\":\"---\",\"cf_tracking_thunderbird_esr91\":\"---\",\"cf_status_firefox61\":\"wontfix\",\"cf_status_firefox_esr60\":\"wontfix\",\"cf_status_firefox93\":\"---\"},\"project\":{\"cf_tracking_firefox_sumo\":\"---\",\"cf_root_cause\":\"---\",\"cf_fission_milestone\":\"---\",\"cf_a11y_review_project_flag\":\"---\",\"cf_webcompat_priority\":\"---\"}},\"types\":[\"tracking\"]}";
    var TrackingFlags = $.parseJSON(tracking_flags_str);

  

  
  BUGZILLA.bug_id = 1469916;
  BUGZILLA.bug_title = '1469916 - (CVE-2018-12402) SameSite Cookies leakage via \"Save Page As...\"';
  BUGZILLA.bug_summary = 'SameSite Cookies leakage via \"Save Page As...\"';
  BUGZILLA.bug_url = 'https:\/\/bugzilla.mozilla.org\/show_bug.cgi?id=1469916';
  BUGZILLA.bug_keywords = 'sec-low',
  BUGZILLA.user = {
    id: 0,
    login: '',
    is_insider: false,
    is_timetracker: false,
    can_tag: false,
    timezone: 'America\/Los_Angeles',
    settings: {
      quote_replies: 'quoted_reply',
      zoom_textareas: true,
      remember_collapsed: true,
      inline_attachments: true,
      autosize_comments: false
    }
  };

  BUGZILLA.bug_secure = false;
      </script>
<script nonce="jlwwB3FDA7LRrDKQLG8nqxyJOWEsvsgnVIZPwedSuhJj35FT" src="/static/v20211025.1/extensions/BugModal/web/autosize.min.js"></script><script nonce="jlwwB3FDA7LRrDKQLG8nqxyJOWEsvsgnVIZPwedSuhJj35FT" src="/static/v20211025.1/extensions/ProdCompSearch/web/js/prod_comp_search.js"></script><script nonce="jlwwB3FDA7LRrDKQLG8nqxyJOWEsvsgnVIZPwedSuhJj35FT" src="/static/v20211025.1/extensions/BugModal/web/bug_modal.js"></script><script nonce="jlwwB3FDA7LRrDKQLG8nqxyJOWEsvsgnVIZPwedSuhJj35FT" src="/static/v20211025.1/extensions/BugModal/web/comments.js"></script><script nonce="jlwwB3FDA7LRrDKQLG8nqxyJOWEsvsgnVIZPwedSuhJj35FT" src="/static/v20211025.1/extensions/ComponentWatching/web/js/overlay.js"></script><script nonce="jlwwB3FDA7LRrDKQLG8nqxyJOWEsvsgnVIZPwedSuhJj35FT" src="/static/v20211025.1/js/bugzilla-readable-status-min.js"></script><script nonce="jlwwB3FDA7LRrDKQLG8nqxyJOWEsvsgnVIZPwedSuhJj35FT" src="/static/v20211025.1/js/field.js"></script><script nonce="jlwwB3FDA7LRrDKQLG8nqxyJOWEsvsgnVIZPwedSuhJj35FT" src="/static/v20211025.1/js/comments.js"></script><script nonce="jlwwB3FDA7LRrDKQLG8nqxyJOWEsvsgnVIZPwedSuhJj35FT" src="/static/v20211025.1/extensions/TrackingFlags/web/js/flags.js"></script><script nonce="jlwwB3FDA7LRrDKQLG8nqxyJOWEsvsgnVIZPwedSuhJj35FT" src="/static/v20211025.1/extensions/BMO/web/js/firefox-crash-table.js"></script><script nonce="jlwwB3FDA7LRrDKQLG8nqxyJOWEsvsgnVIZPwedSuhJj35FT" src="/static/v20211025.1/extensions/MozChangeField/web/js/severity-s1-priority-p1.js"></script><script nonce="jlwwB3FDA7LRrDKQLG8nqxyJOWEsvsgnVIZPwedSuhJj35FT" src="/static/v20211025.1/extensions/MozChangeField/web/js/clear-tracking-priority-s1.js"></script><script nonce="jlwwB3FDA7LRrDKQLG8nqxyJOWEsvsgnVIZPwedSuhJj35FT" src="/static/v20211025.1/extensions/MozChangeField/web/js/set-tracking-severity-s1.js"></script><script nonce="jlwwB3FDA7LRrDKQLG8nqxyJOWEsvsgnVIZPwedSuhJj35FT" src="/static/v20211025.1/js/lib/prism.js"></script><script nonce="jlwwB3FDA7LRrDKQLG8nqxyJOWEsvsgnVIZPwedSuhJj35FT" src="/static/v20211025.1/extensions/GoogleAnalytics/web/js/analytics.js"></script><script nonce="jlwwB3FDA7LRrDKQLG8nqxyJOWEsvsgnVIZPwedSuhJj35FT" src="/static/v20211025.1/js/lib/md5.min.js"></script><script nonce="jlwwB3FDA7LRrDKQLG8nqxyJOWEsvsgnVIZPwedSuhJj35FT" src="/static/v20211025.1/extensions/Review/web/js/badge.js"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla@Mozilla" href="/search_plugin.cgi"><link rel="shortcut icon" href="/extensions/BMO/web/images/favicon.ico">
<link rel="canonical" href="https://bugzilla.mozilla.org/show_bug.cgi?id=1469916">
<link rel="shorturl" href="https://bugzilla.mozilla.org/1469916"><meta name="google-analytics" content="UA-36116321-3" data-location="https://bugzilla.mozilla.org/bug/show-modal" data-title="1469916 - (CVE-2018-12402) SameSite Cookies leakage via &amp;quot;Save Page As...&amp;quot;">
<script async src="https://www.google-analytics.com/analytics.js"></script><meta name="robots" content="noarchive">
  </head>



  <body
        class="bugzilla-mozilla-org
               skin-standard bug_modal yui-skin-sam">



<div id="wrapper">

<header id="header" role="banner">
  <div class="inner">
    <h1 id="header-title" class="title"><a href="https://bugzilla.mozilla.org/home" title="Go to home page">Bugzilla</a></h1>
    <form role="search" id="header-search" class="quicksearch" action="/buglist.cgi" data-no-csrf>
      <section class="searchbox-outer dropdown" role="combobox" aria-expanded="false" aria-haspopup="listbox"
               aria-labelledby="header-search-label" aria-owns="header-search-dropdown">
        <h2 id="header-search-label">Quick Search</h2>
        <span class="icon" aria-hidden="true"></span>
        <input role="searchbox" id="quicksearch_top" class="dropdown-button" name="quicksearch" autocomplete="off"
               value="" placeholder="Search Bugs"
               title="Enter a bug number or some search terms" aria-controls="header-search-dropdown"
               aria-label="Quick Search"><div id="header-search-dropdown" class="dropdown-content right" role="listbox" style="display: none;">
  <div id="header-search-dropdown-wrapper">
  </div>
</div>
      </section>
    </form>
    <nav id="header-nav">
      <ul class="links">
        <li class="link-browse">
          <a href="/describecomponents.cgi" title="Browse bugs by component">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Browse</span>
          </a>
        </li>
        <li class="link-search">
          <a href="/query.cgi?format=advanced" title="Search bugs using various criteria">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Advanced Search</span>
          </a>
        </li>
      </ul>
      <div class="dropdown">
        <button type="button" id="header-tools-menu-button" class="dropdown-button minor" title="More tools…"
                aria-label="More tools…" aria-expanded="false" aria-haspopup="true" aria-controls="header-tools-menu">
          <span class="icon" aria-hidden="true"></span>
        </button>
        <ul class="dropdown-content left" id="header-tools-menu" role="menu" style="display:none;">
          <li role="presentation">
            <a href="/report.cgi" role="menuitem" tabindex="-1">Reports</a>
          </li>
            <li role="separator"></li>
            <li role="presentation">
              <a href="https://bmo.readthedocs.io/en/latest/" role="menuitem" tabindex="-1">Documentation</a>
            </li>
        </ul>
      </div>
    </nav>
      <ul id="header-login" class="links">
          <li id="moz_new_account_container_top"><a href="/createaccount.cgi">New Account</a></li><li id="mini_login_container_top">
  <a id="login_link_top" href="/index.cgi?GoAheadAndLogIn=1"
     class='show_mini_login_form' data-qs-suffix="_top">Log In</a>

  <div id="mini_login_top" class="mini-popup mini_login bz_default_hidden"><span id="github_mini_login_top" class="mini_login_top">
    <form method="post" action="/github.cgi">
      <input type="hidden" name="github_secret" value="0dIo6lVfR1AGxA0hKg4yj02xJB7mw7hDsYVTqRlBwaAEjFpQYLitmA5CsLzlExs5r6BP7wgl6LDY2yHQl1uTWuVwB9REvcTbypK1wxgmna8YPgO7T1slZHwtOmxMvDPivddrPvrXNYsPBZpBQmhRm5MvUz8YmvsFi051KZbTVQvdNFXlc3drMPMyqnEXxYZ7Ovwnj88dW3KIXpylyCfAB6lQ321TjxHzz2J00ImfgUOvDYMopCcOh9Ijh93qJ4n7">
      <input type="hidden" name="target_uri" value="https://bugzilla.mozilla.org/show_bug.cgi">
      <input type="image" src="/extensions/GitHubAuth/web/images/sign_in.png" height="22" width="75" align="absmiddle"
             alt="Sign in with GitHub"
             title="Sign in with GitHub"> or
    </form>
  </span>

  <form action="/show_bug.cgi?id=1469916" method="POST"
        data-qs-suffix="_top">

    <input id="Bugzilla_login_top"
           class="bz_login"
           name="Bugzilla_login"
           title="Login"
           placeholder="Email"
           aria-label="Email"
           type="email"
           required
    >
    <input class="bz_password"
           id="Bugzilla_password_top"
           name="Bugzilla_password"
           type="password"
           title="Password"
           placeholder="Password"
           aria-label="Password"
           required
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text"
           id="Bugzilla_password_dummy_top" value="password"
           title="Password"
    >
      <input type="checkbox" id="Bugzilla_remember_top"
             name="Bugzilla_remember" value="on" class="bz_remember"
                 checked>
      <label for="Bugzilla_remember_top">Remember</label>
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
           class="check_mini_login_fields"
            id="log_in_top">
    <a href="#" id="hide_mini_login_top" aria-label="Close"
       class="close-button hide_mini_login_form" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
<li id="forgot_container_top">
  <a id="forgot_link_top" href="/index.cgi?GoAheadAndLogIn=1#forgot"
     class='show_forgot_form'
     data-qs-suffix="_top">Forgot Password</a>
  <div id="forgot_form_top" class="mini-popup mini_forgot bz_default_hidden">
  <form action="/token.cgi" method="post">
    <input type="email" name="loginname" size="20" placeholder="Email" aria-label="Email" required>
    <input id="forgot_button_top" value="Reset Password"
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <input type="hidden" id="token_top" name="token" value="1635623348-oeb_wEjtGQ9XkSij8gWfRAiAap8jCAi-Biaht72Vx6Y">
    <a href="#" class="close-button hide_forgot_form" aria-label="Close" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
      </ul><div id="header-external-links" class="dropdown first">
  <button type="button" id="header-external-menu-button" class="dropdown-button minor" title="Mozilla"
          aria-label="Mozilla" aria-expanded="false" aria-haspopup="true" aria-controls="header-external-menu">
    <img src="/static/v20211025.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg" width="32" height="32" alt="">
  </button>
  <ul class="dropdown-content right" id="header-external-menu" role="menu" style="display:none;">
    <li role="presentation">
      <a href="https://www.mozilla.org/" role="menuitem" tabindex="-1">Mozilla Home</a>
    </li>
    <li role="separator"></li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/" role="menuitem" tabindex="-1">Privacy</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/#cookies" role="menuitem" tabindex="-1">Cookies</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/about/legal/" role="menuitem" tabindex="-1">Legal</a>
    </li>
  </ul>
</div>
  </div>
</header> 


<main id="bugzilla-body" tabindex="-1">

<aside id="message-container" role="complementary">
  <noscript>
    <div class="noscript">
      <div class="inner">
        <p>Please enable JavaScript in your browser to use all the features on this site.</p>
      </div>
    </div>
  </noscript>
</aside>

<div id="main-inner">




<div role="toolbar" id="page-toolbar">
  <div role="group" class="buttons">
    <button type="button" id="copy-summary" class="secondary"
      title="Copy bug number and summary to your clipboard">Copy Summary</button>
    <div id="clip-container" style="display:none"><input type="text" id="clip"></div>
    <div class="dropdown">
      <button type="button" id="action-menu-btn" aria-haspopup="true" aria-label="View"
        aria-expanded="false" aria-controls="action-menu" class="dropdown-button secondary">View &#9662;</button>
      <ul class="dropdown-content left" id="action-menu" role="menu" style="display:none;">
        <li role="presentation">
          <a id="action-reset" role="menuitem" tabindex="-1">Reset Sections</a>
        </li>
        <li role="presentation">
          <a id="action-expand-all" role="menuitem" tabindex="-1">Expand All Sections</a>
        </li>
        <li role="presentation">
          <a id="action-collapse-all" role="menuitem" tabindex="-1">Collapse All Sections</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a id="action-history" role="menuitem" tabindex="-1">History</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a href="/rest/bug/1469916" role="menuitem" tabindex="-1">JSON</a>
        </li>
        <li role="presentation">
          <a href="/show_bug.cgi?ctype=xml&amp;id=1469916" role="menuitem" tabindex="-1">XML</a>
        </li>
      </ul>
    </div>
  </div>
</div>



<div role="status" id="io-error" style="display:none"></div>
<div role="status" id="floating-message" style="display:none">
  <div id="floating-message-text"></div>
</div>
<section class="module"
>
  <div class="module-content"
  >
  <div id="summary-container">
    <div class="field indent" id="field-status_summary"
>


  
    <div class=" container">
        <span id="field-value-status_summary">
      <span class="bug-status-label text" data-status="closed">Closed</span>
      <span id="field-value-bug_id">
        <a href="/show_bug.cgi?id=1469916">Bug 1469916</a>
          <span class="edit-hide">(CVE-2018-12402)</span>
      </span>
      <span>
        <span class="bug-time-label">Opened <span class="rel-time" title="2018-06-20 09:43 PDT" data-time="1529513038">3 years ago</span></span>
          <span class="bug-time-label">Closed <span class="rel-time" title="2018-07-04 03:14 PDT" data-time="1530699291">3 years ago</span></span>
      </span>
        </span>
    </div>

  
</div>
<div class="field indent edit-hide"
>


  
    <div class=" container">
      

      <h1 id="field-value-short_desc">Same<wbr>Site Cookies leakage via &quot;Save Page As<wbr>...&quot;</h1>
    </div>

  
</div>

    <div class="field edit-show" id="field-short_desc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc" id="short_desc-help-link" class="help">Summary:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-short_desc">
            SameSite Cookies leakage via &quot;Save Page As...&quot;

        </span>
    </div>

  
</div>
  </div>
  </div>
</section>


<section class="module" id="module-categories"
>
    <header id="module-categories-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Categories section"
           data-label-collapsed="Expand Categories section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-categories-content"
             aria-expanded="true"
             aria-labeledby="module-categories-title"
             aria-describedby="module-categories-subtitle"></div>
        <h2 class="module-title" id="module-categories-title">Categories</h2>
          <h3 class="module-subtitle" id="module-categories-subtitle">
            (Core :: DOM: Security, defect, P2)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-categories-content"
  ><div class="fields-lhs">

    <div class="field" id="field-product"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=Core" id="product-help-link" class="help">Product:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-product">
      <div class="name-info-outer dropdown">
        <span id="product-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="product-info">Core
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="product-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Product description and actions">
          <header>
            <div class="title">Core</div>
            <div class="description">Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the <a href="https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox">Firefox</a> product. (<a href="https://wiki.mozilla.org/Modules/All#Core">More info</a>)</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=Core&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Product</a></div>
            <div><a href="/enter_bug.cgi?product=Core"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Product</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="Core"
                         data-label-watch="Watch This Product" data-label-unwatch="Unwatch This Product"
                         data-source="BugModal">Watch This Product</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-component"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=Core&component=DOM%3A%20Security#DOM%3A%20Security" id="component-help-link" class="help">Component:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-component">
      <div class="name-info-outer dropdown">
        <span id="component-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="component-info">DOM: Security
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="component-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Component description and actions">
          <header>
            <div class="title">Core :: DOM: Security</div>
            <div class="description">Native content-based security features including: Content Security Policy (CSP), Mixed Content Blocker (MCB), and Safe Browsing.</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=Core&amp;component=DOM%3A%20Security&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Component</a></div>
            <div><a href="/buglist.cgi?product=Core&amp;component=DOM%3A%20Security&amp;chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__"
                    target="_blank" role="menuitem" tabindex="-1">Recently Fixed Bugs in This Component</a></div>
            <div><a href="/enter_bug.cgi?product=Core&amp;component=DOM%3A%20Security"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Component</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="Core" data-component="DOM: Security"
                         data-label-watch="Watch This Component" data-label-unwatch="Unwatch This Component"
                         data-source="BugModal">Watch This Component</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-version"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#version" id="version-help-link" class="help">Version:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-version">
            61 Branch

        </span>
    </div>

  
</div>

    <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform" id="-help-link" class="help">Platform:
        </a>
    </div>


  
    <div class=" container"><div class="field inline" id="field-rep_platform"
>


  
    <div class="value">
        <span id="field-value-rep_platform">
            Unspecified

        </span>
    </div>

  
</div><div class="field indent inline" id="field-op_sys"
>


  
    <div class="value">
        <span id="field-value-op_sys">
            Unspecified

        </span>
    </div>

  
</div><div class="field indent inline"
>


  
    <div class=" container">
    </div>

  
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field contains-buttons" id="field-bug_type"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type" id="bug_type-help-link" class="help">Type:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_type">
      <span class="bug-type-label iconic-text" data-type="defect">
        <span class="icon" aria-hidden="true"></span>defect</span>
        </span>
    </div>

  
</div>

    <div class="field" id="field-importance"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority" id="importance-help-link" class="help">Priority:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-importance"><div class="field inline" id="field-priority"
>


  
    <div class="value">
        <span id="field-value-priority">P2
        </span>
    </div>

  
</div><div class="field inline" id="field-bug_severity"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity" id="bug_severity-help-link" class="help">Severity:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_severity">
            normal

        </span>
    </div>

  
</div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-cf_fx_points" style="display:none"
>
    <div class="name">Points:
    </div>


  
    <div class="value">
        <span id="field-value-cf_fx_points">
            ---

        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-tracking"
>
    <header id="module-tracking-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Tracking section"
           data-label-collapsed="Expand Tracking section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-tracking-content"
             aria-expanded="true"
             aria-labeledby="module-tracking-title"
             aria-describedby="module-tracking-subtitle"></div>
        <h2 class="module-title" id="module-tracking-title">Tracking</h2>
          <h3 class="module-subtitle" id="module-tracking-subtitle">
            (<span id="readable-bug-status" data-readable-bug-status="{&quot;cf_tracking_firefox94&quot;:&quot;---&quot;,&quot;dupe_of&quot;:null,&quot;cf_status_firefox95&quot;:&quot;---&quot;,&quot;cf_fission_milestone&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_relnote&quot;:&quot;---&quot;,&quot;cf_status_firefox_esr78&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_esr91&quot;:&quot;---&quot;,&quot;cf_status_firefox_esr52&quot;:&quot;wontfix&quot;,&quot;cf_status_thunderbird_esr91&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_esr78&quot;:&quot;---&quot;,&quot;cf_status_firefox63&quot;:&quot;verified&quot;,&quot;cf_status_thunderbird_esr78&quot;:&quot;---&quot;,&quot;status&quot;:&quot;VERIFIED&quot;,&quot;cf_root_cause&quot;:&quot;---&quot;,&quot;cf_status_firefox93&quot;:&quot;---&quot;,&quot;target_milestone&quot;:&quot;mozilla63&quot;,&quot;cf_tracking_thunderbird_esr91&quot;:&quot;---&quot;,&quot;keywords&quot;:[&quot;sec-low&quot;],&quot;cf_tracking_firefox93&quot;:&quot;---&quot;,&quot;cf_tracking_firefox95&quot;:&quot;---&quot;,&quot;cf_status_firefox62&quot;:&quot;wontfix&quot;,&quot;id&quot;:1469916,&quot;flags&quot;:[{&quot;name&quot;:&quot;sec-bounty&quot;,&quot;status&quot;:&quot;-&quot;},{&quot;status&quot;:&quot;+&quot;,&quot;name&quot;:&quot;sec-bounty-hof&quot;}],&quot;cf_a11y_review_project_flag&quot;:&quot;---&quot;,&quot;cf_status_firefox94&quot;:&quot;---&quot;,&quot;cf_tracking_thunderbird_esr78&quot;:&quot;---&quot;,&quot;cf_status_firefox_esr91&quot;:&quot;---&quot;,&quot;resolution&quot;:&quot;FIXED&quot;,&quot;priority&quot;:&quot;P2&quot;,&quot;cf_tracking_firefox_sumo&quot;:&quot;---&quot;,&quot;cf_status_firefox_esr60&quot;:&quot;wontfix&quot;,&quot;cf_status_firefox61&quot;:&quot;wontfix&quot;,&quot;cf_webcompat_priority&quot;:&quot;---&quot;}"></span>)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-tracking-content"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-status-view"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-view-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-view">VERIFIED
        FIXED
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-status-edit" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-edit-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-edit"><div class="field inline" id="field-bug_status"
>


  
    <div class="value">
        <span id="field-value-bug_status">
            VERIFIED

        </span>
    </div>

  
</div><div class="field indent inline" id="field-resolution"
>


  
    <div class="value">
        <span id="field-value-resolution">
            FIXED

        </span>
    </div>

  
</div>
  <div id="status-action-buttons">
      <div id="assigned-container" style="display:none">
        <button type="button" class="secondary" id="mark-as-assigned-btn">
          Mark as Assigned
        </button>
      </div>
  </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-target_milestone"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone" id="target_milestone-help-link" class="help">Milestone:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-target_milestone">
            mozilla63

        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-cf_fx_iteration" style="display:none"
>
    <div class="name">Iteration:
    </div>


  
    <div class="value">
        <span id="field-value-cf_fx_iteration">
            ---

        </span>
    </div>

  
</div>


      <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Project Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <td class="tracking-flag-name">a11y-review</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_a11y_review_project_flag-dirty">
  <select id="cf_a11y_review_project_flag" name="cf_a11y_review_project_flag">
        <option value="---"
          id="v4876_cf_a11y_review_project_flag" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Webcompat Priority</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_webcompat_priority-dirty">
  <select id="cf_webcompat_priority" name="cf_webcompat_priority">
        <option value="---"
          id="v4274_cf_webcompat_priority" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Root Cause</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_root_cause-dirty">
  <select id="cf_root_cause" name="cf_root_cause">
        <option value="---"
          id="v4701_cf_root_cause" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">user-doc-firefox</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_sumo-dirty">
  <select id="cf_tracking_firefox_sumo" name="cf_tracking_firefox_sumo">
        <option value="---"
          id="v4660_cf_tracking_firefox_sumo" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Fission Milestone</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_fission_milestone-dirty">
  <select id="cf_fission_milestone" name="cf_fission_milestone">
        <option value="---"
          id="v4222_cf_fission_milestone" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

      <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Tracking Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-hide">
    <table class="layout-table tracking-flags">
        <tr>
          <th></th>
          <th>Tracking</th>
          <th>Status</th>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox-esr52</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox_esr52&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox-esr60</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox_esr60&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox61</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox61&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox62</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox62&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox63</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox63&amp;o1=equals&amp;v1=verified">verified</a>
          </td>
        </tr>
    </table>
  </div>


<div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <th></th>
        <th>Tracking</th>
        <th>Status</th>
      </tr>
      <tr>
        <td class="tracking-flag-name">relnote-firefox</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_relnote-dirty">
  <select id="cf_tracking_firefox_relnote" name="cf_tracking_firefox_relnote">
        <option value="---"
          id="v539_cf_tracking_firefox_relnote" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr78-dirty">
  <select id="cf_tracking_thunderbird_esr78" name="cf_tracking_thunderbird_esr78">
        <option value="---"
          id="v4823_cf_tracking_thunderbird_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr78-dirty">
  <select id="cf_status_thunderbird_esr78" name="cf_status_thunderbird_esr78">
        <option value="---"
          id="v4829_cf_status_thunderbird_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr91-dirty">
  <select id="cf_tracking_thunderbird_esr91" name="cf_tracking_thunderbird_esr91">
        <option value="---"
          id="v5236_cf_tracking_thunderbird_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr91-dirty">
  <select id="cf_status_thunderbird_esr91" name="cf_status_thunderbird_esr91">
        <option value="---"
          id="v5242_cf_status_thunderbird_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr52</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr52-dirty">
  <select id="cf_status_firefox_esr52" name="cf_status_firefox_esr52">
        <option value="wontfix"
          id="v3142_cf_status_firefox_esr52" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr60</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr60-dirty">
  <select id="cf_status_firefox_esr60" name="cf_status_firefox_esr60">
        <option value="wontfix"
          id="v3641_cf_status_firefox_esr60" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr78-dirty">
  <select id="cf_tracking_firefox_esr78" name="cf_tracking_firefox_esr78">
        <option value="---"
          id="v4808_cf_tracking_firefox_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr78-dirty">
  <select id="cf_status_firefox_esr78" name="cf_status_firefox_esr78">
        <option value="---"
          id="v4813_cf_status_firefox_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr91-dirty">
  <select id="cf_tracking_firefox_esr91" name="cf_tracking_firefox_esr91">
        <option value="---"
          id="v5194_cf_tracking_firefox_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr91-dirty">
  <select id="cf_status_firefox_esr91" name="cf_status_firefox_esr91">
        <option value="---"
          id="v5199_cf_status_firefox_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox61</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox61-dirty">
  <select id="cf_status_firefox61" name="cf_status_firefox61">
        <option value="wontfix"
          id="v3654_cf_status_firefox61" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox62</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox62-dirty">
  <select id="cf_status_firefox62" name="cf_status_firefox62">
        <option value="wontfix"
          id="v3743_cf_status_firefox62" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox63</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox63-dirty">
  <select id="cf_status_firefox63" name="cf_status_firefox63">
        <option value="verified"
          id="v3806_cf_status_firefox63" selected
        >verified
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox93</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox93-dirty">
  <select id="cf_tracking_firefox93" name="cf_tracking_firefox93">
        <option value="---"
          id="v5266_cf_tracking_firefox93" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox93-dirty">
  <select id="cf_status_firefox93" name="cf_status_firefox93">
        <option value="---"
          id="v5271_cf_status_firefox93" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox94</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox94-dirty">
  <select id="cf_tracking_firefox94" name="cf_tracking_firefox94">
        <option value="---"
          id="v5284_cf_tracking_firefox94" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox94-dirty">
  <select id="cf_status_firefox94" name="cf_status_firefox94">
        <option value="---"
          id="v5289_cf_status_firefox94" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox95</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox95-dirty">
  <select id="cf_tracking_firefox95" name="cf_tracking_firefox95">
        <option value="---"
          id="v5311_cf_tracking_firefox95" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox95-dirty">
  <select id="cf_status_firefox95" name="cf_status_firefox95">
        <option value="---"
          id="v5316_cf_status_firefox95" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>

</div>
  </div>
</section>



<section class="module" id="module-people"
>
    <header id="module-people-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse People section"
           data-label-collapsed="Expand People section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-people-content"
             aria-expanded="false"
             aria-labeledby="module-people-title"
             aria-describedby="module-people-subtitle"></div>
        <h2 class="module-title" id="module-people-title">People</h2>
          <h3 class="module-subtitle" id="module-people-subtitle">
            (Reporter: prakashsharma97, Assigned: Gijs)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-people-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-assigned_to"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to"><div class="vcard vcard_159069" ><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=159069" > <span class="fna">Gijs</span></a>
</div>
        </span>
    </div>

  
</div><div class="field edit-show" id="field-assigned_to" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-assignee" name="set_default_assignee" class="set-default"
          value="1" data-for="assigned_to">
        <label for="set-default-assignee">Reset Assignee to default</label>
      </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-bug_mentors" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor" id="bug_mentors-help-link" class="help">Mentors:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_mentors">---
        </span>
    </div>

  
</div>

    <div class="field edit-hide" id="field-qa_contact"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact" id="qa_contact-help-link" class="help">QA Contact:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-qa_contact"><div class="vcard vcard_363267" ><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=363267" > <span class="fna">ckerschb</span></a>
</div>
        </span>
    </div>

  
</div><div class="field edit-show" id="field-qa_contact" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact" id="qa_contact-help-link" class="help">QA Contact:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-qa_contact">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-qa-contact" name="set_default_qa_contact" class="set-default"
          value="1" data-for="qa_contact">
        <label for="set-default-qa-contact">Reset QA Contact to default</label>
      </div>
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-reporter"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter" id="reporter-help-link" class="help">Reporter:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-reporter">
            <div class="vcard vcard_534567" ><img src="https://secure.gravatar.com/avatar/30ed3b0b86b55506949fb1eca087ed71?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=534567" > <span class="fna">prakashsharma97</span></a>
</div>

        </span>
    </div>

  
</div>

    <div class="field" id="field-triage_owner"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner" id="triage_owner-help-link" class="help">Triage Owner:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-triage_owner">
            <div class="vcard vcard_363267" ><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=363267" > <span class="fna">ckerschb</span></a>
</div>

        </span>
    </div>

  
</div>

    

    <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc" id="-help-link" class="help">CC:
        </a>
    </div>


  
    <div class=" container">


        <span aria-owns="cc-summary cc-latch">
          <span role="button" tabindex="0" id="cc-summary" data-count="26">26 people
          </span>
        </span>


        <div id="cc-list" style="display:none"></div>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-references"
>
    <header id="module-references-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse References section"
           data-label-collapsed="Expand References section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-references-content"
             aria-expanded="false"
             aria-labeledby="module-references-title"
             aria-describedby="module-references-subtitle"></div>
        <h2 class="module-title" id="module-references-title">References</h2>
          <h3 class="module-subtitle" id="module-references-subtitle">
            (Depends on 1 open bug)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-references-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field bug-list" id="field-dependson"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson" id="dependson-help-link" class="help">Depends on:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-dependson">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Crash in nsILoadInfo::GetOriginAttributes"
   href="/show_bug.cgi?id=1473507">1473507</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Crash in InvalidArrayIndex_CRASH | nsTArray_Impl&lt;T&gt;::operator[] | nsWebBrowserPersist::SerializeNextFile"
   href="/show_bug.cgi?id=1473509">1473509</a>, <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - &quot;Save Image As..&quot; doesn't work for mixed content images"
   href="/show_bug.cgi?id=1504159">1504159</a>
      </div>
      <div class="bug-list">
        <span class="bug-type-label iconic" title="enhancement"
              aria-label="enhancement" data-type="enhancement">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_NEW"
   title="NEW - Use resource: or other non-system principal for saving blobs of pretty-printed data from json viewer"
   href="/show_bug.cgi?id=1473285">1473285</a>
      </div>

        </span>
    </div>

  
</div><div class="field bug-list" id="field-blocked"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks" id="blocked-help-link" class="help">Blocks:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-blocked">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - &quot;Save as complete&quot; gives access to content from other domains"
   href="/show_bug.cgi?id=332676">332676</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Saving web page embedding file: resources allows accessing SMB resources"
   href="/show_bug.cgi?id=1447087">1447087</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED WORKSFORME - File -&gt; Save Page As... from inside a container saves an out-of-container version"
   href="/show_bug.cgi?id=1463365">1463365</a>, <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - save pdf issue with pdf viewer"
   href="/show_bug.cgi?id=1502448">1502448</a>
      </div>

        </span>
    </div>

  
</div><div class="field" id="field-dependencytree"
>
    <div class="name">
    </div>


  
    <div class=" container">
        <span id="field-value-dependencytree">
        Dependency <a href="/showdependencytree.cgi?id=1469916&amp;hide_resolved=1">tree</a>
        / <a href="/showdependencygraph.cgi?id=1469916">graph</a>
        </span>
    </div>

  
</div>

    <div class="field bug-list" id="field-regresses"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses" id="regresses-help-link" class="help">Regressions:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regresses">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Dragging a photo onto an address book card doesn't work any more in TB 65 and trunk"
   href="/show_bug.cgi?id=1519732">1519732</a>
      </div>

        </span>
    </div>

  
</div><div class="field bug-list edit-show" id="field-regressed_by" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by" id="regressed_by-help-link" class="help">Regressed by:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regressed_by">
        ---
        </span>
    </div>

  
</div>

    
</div><div class="fields-rhs">

    <div class="field edit-show" id="field-bug_file_loc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc" id="bug_file_loc-help-link" class="help">URL:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_file_loc"><div class="link">
    <a href="" target="_blank"
      rel="noreferrer" title=""
      class="bug-url" data-safe="0"></a>
  </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-see_also" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also" id="see_also-help-link" class="help">See Also:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-see_also">
        ---
        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-details"
>
    <header id="module-details-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Details section"
           data-label-collapsed="Expand Details section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-details-content"
             aria-expanded="false"
             aria-labeledby="module-details-title"
             aria-describedby="module-details-subtitle"></div>
        <h2 class="module-title" id="module-details-title">Details</h2>
          <h3 class="module-subtitle" id="module-details-subtitle">
            (Keywords: sec-low, Whiteboard: [domsecurity-active][post-critsmash-triage][adv-main63+][tor 22343])
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-details-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-show" id="field-alias" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias" id="alias-help-link" class="help">Alias:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-alias">
            CVE-2018-12402

        </span>
    </div>

  
</div>

    <div class="field" id="field-keywords"
>
    <div class="name">
        <a href="/describekeywords.cgi" id="keywords-help-link" class="help">Keywords:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-keywords">
          <a href="/buglist.cgi?keywords=sec-low&amp;resolution=---">sec-low</a>
        </span>
    </div>

  
</div>

    <div class="field" id="field-status_whiteboard"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/Whiteboard" id="status_whiteboard-help-link" class="help">Whiteboard:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-status_whiteboard">[domsecurity-active][post-critsmash-triage][adv-main63+][tor 22343]
        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_qa_whiteboard" style="display:none"
>
    <div class="name">QA Whiteboard:
    </div>


  
    <div class="value">
        <span id="field-value-cf_qa_whiteboard">
        ---
        </span>
    </div>

  
</div>

    

    <div class="field edit-show" id="field-cf_has_regression_range" style="display:none"
>
    <div class="name">Has Regression Range:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_regression_range">
            ---

        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_has_str" style="display:none"
>
    <div class="name">Has STR:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_str">
            ---

        </span>
    </div>

  
</div>

    <div class="field" id="field-votes"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes" id="votes-help-link" class="help">Votes:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-votes">0
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-bug_flags"
>
    <div class="name">Bug Flags:
    </div>


  
    <div class=" container">
        <span id="field-value-bug_flags"><div id="bug-flags" class="flags">
  <table class="layout-table">
          <tbody class="edit-hide"><tr>
    <td class="flag-setter"><div class="vcard vcard_1689" ><a class="email " href="/user_profile?user_id=1689" > <span class="fna">dveditz</span></a>
</div>
    </td>

    <td class="flag-name">
        <a href="#c32"
            class="rel-time-title activity-ref"
            title="3 years ago"
        data-time="1531410335"
      >sec-bounty</a>
    </td>

    <td class="flag-value">-
    </td>

  </tr>
          </tbody>
          <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter"><div class="vcard vcard_1689" ><a class="email " href="/user_profile?user_id=1689" > <span class="fna">dveditz</span></a>
</div>
    </td>

    <td class="flag-name">
      <label title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug." for="flag-1779348">sec-bounty</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag-1779348-dirty">
      <select id="flag-1779348" name="flag-1779348"
        title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug."
        class="bug-flag">
            <option value="-" selected>-</option>
      </select>
    </td>


  </tr>
          </tbody>
          <tbody class="edit-hide"><tr>
    <td class="flag-setter"><div class="vcard vcard_578488" ><a class="email " href="/user_profile?user_id=578488" > <span class="fna">tjr</span></a>
</div>
    </td>

    <td class="flag-name">
        <a href="#a60858476_578488"
            class="rel-time-title activity-ref"
            title="1 year ago"
        data-time="1590371514"
      >sec-bounty-hof</a>
    </td>

    <td class="flag-value">+
    </td>

  </tr>
          </tbody>
          <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter"><div class="vcard vcard_578488" ><a class="email " href="/user_profile?user_id=578488" > <span class="fna">tjr</span></a>
</div>
    </td>

    <td class="flag-name">
      <label title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame." for="flag-1975122">sec-bounty-hof</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag-1975122-dirty">
      <select id="flag-1975122" name="flag-1975122"
        title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame."
          disabled
        class="bug-flag">
            <option value="+" selected>+</option>
      </select>
    </td>


  </tr>
          </tbody>
    <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?" for="flag_type-930">behind-pref</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-930-dirty">
      <select id="flag_type-930" name="flag_type-930"
        title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?"
        class="bug-flag">
          <option value="X"></option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag tracking inclusion in the desktop Firefox product backlog." for="flag_type-846">firefox-backlog</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-846-dirty">
      <select id="flag_type-846" name="flag_type-846"
        title="Flag tracking inclusion in the desktop Firefox product backlog."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-787">in-qa-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-787-dirty">
      <select id="flag_type-787" name="flag_type-787"
        title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>

      <td class="flag-requestee">
        <div id="requestee_type-787-container" style="display:none"><input
    name="requestee_type-787"
    value="" class="requestee bz_autocomplete_user"  id="requestee_type-787" 
  >
        </div>
      <td>

  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-37">in-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-37-dirty">
      <select id="flag_type-37" name="flag_type-37"
        title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually" for="flag_type-864">qe-verify</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-864-dirty">
      <select id="flag_type-864" name="flag_type-864"
        title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually"
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr>
    </tbody>
  </table>
</div>
        </span>
    </div>

  
</div>
</div>

  
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-crash-data"
>
    <header id="module-crash-data-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Crash Data section"
           data-label-collapsed="Expand Crash Data section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-crash-data-content"
             aria-expanded="false"
             aria-labeledby="module-crash-data-title"
             aria-describedby="module-crash-data-subtitle"></div>
        <h2 class="module-title" id="module-crash-data-title">Crash Data</h2>
      </div>
    </header>
  <div class="module-content" id="module-crash-data-content" style="display:none"
  ><div class="field edit-show" id="field-cf_crash_signature" style="display:none"
>
    <div class="name">Signature:
    </div>


  
    <div class="value">
        <span id="field-value-cf_crash_signature">
        </span>
    </div>

  
</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-security"
>
    <header id="module-security-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Security section"
           data-label-collapsed="Expand Security section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-security-content"
             aria-expanded="false"
             aria-labeledby="module-security-title"
             aria-describedby="module-security-subtitle"></div>
        <h2 class="module-title" id="module-security-title">Security</h2>
          <h3 class="module-subtitle" id="module-security-subtitle">
            (public)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-security-content" style="display:none"
  ><div class="groups edit-hide">
    This bug is publicly visible.
</div>

<div class="groups edit-show" style="display:none">


</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-user-story" data-non-stick="1"
>
    <header id="module-user-story-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse User Story section"
           data-label-collapsed="Expand User Story section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-user-story-content"
             aria-expanded="false"
             aria-labeledby="module-user-story-title"
             aria-describedby="module-user-story-subtitle"></div>
        <h2 class="module-title" id="module-user-story-title">User Story</h2>
      </div>
    </header>
  <div class="module-content" id="module-user-story-content" style="display:none"
  >
    <pre id="user-story"></pre>
  </div>
</section>







<section class="module" id="module-attachments"
>
    <header id="module-attachments-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Attachments section"
           data-label-collapsed="Expand Attachments section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-attachments-content"
             aria-expanded="true"
             aria-labeledby="module-attachments-title"
             aria-describedby="module-attachments-subtitle"></div>
        <h2 class="module-title" id="module-attachments-title">Attachments</h2>
          <h3 class="module-subtitle" id="module-attachments-subtitle">
            (3 files)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-attachments-content"
  ><table role="table" class="layout-table" id="attachments">
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8986497">Contains php files for easier reproduction</a>
        </div>
        <div>
            <a href="#c0" class="attach-time activity-ref"><span class="rel-time" title="2018-06-20 09:43 PDT" data-time="1529513038">3 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_534567" ><a class="email " href="/user_profile?user_id=534567" > <span class="fna">1lastBr3ath</span></a>
</div></span>
        </div>
        <div class="attach-info">1.07 KB,
          application/gzip        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8986497&amp;action=edit">Details</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8987073">Bug 1469916 - use principals in webbrowserpersist code, r?ckerschb,jkt</a>
        </div>
        <div>
            <a href="#c5" class="attach-time activity-ref"><span class="rel-time" title="2018-06-22 07:46 PDT" data-time="1529678775">3 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_600971" ><a class="email " href="/user_profile?user_id=600971" > <span class="fna">Phabricator Automation</span></a>
</div></span>
        </div>
        <div class="attach-info">46 bytes,
          text/x-phabricator-request        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_363267" ><span class="fn">ckerschb</span>
</div>:
              <a href="#c21"
                  class="flag-name-status rel-time-title activity-ref"
                  title="3 years ago"
              data-time="1530202064"
            >
              review+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_363267" ><span class="fn">ckerschb</span>
</div>:
              <a href="#c0"
                  class="flag-name-status rel-time-title activity-ref"
                  title="3 years ago"
              data-time="1530285475"
            >
              review+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_563455" ><span class="fn">jkt</span>
</div>:
              <a href="#c0"
                  class="flag-name-status rel-time-title activity-ref"
                  title="3 years ago"
              data-time="1530527493"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8987073&amp;action=edit">Details</a>&#x0020; |
  <a href="/attachment.cgi?id=8987073">Review</a>
    </tr>
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8988232">poc.html</a>
        </div>
        <div>
            <a href="#c14" class="attach-time activity-ref"><span class="rel-time" title="2018-06-27 08:54 PDT" data-time="1530114854">3 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_534567" ><a class="email " href="/user_profile?user_id=534567" > <span class="fna">1lastBr3ath</span></a>
</div></span>
        </div>
        <div class="attach-info">840 bytes,
          text/html        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8988232&amp;action=edit">Details</a>
    </tr>
</table>

<footer id="attachments-footer">
  <div id="attachments-actions">
  </div>
  
</footer>
  </div>
</section>



<script nonce="jlwwB3FDA7LRrDKQLG8nqxyJOWEsvsgnVIZPwedSuhJj35FT">
  init_module_visibility();
</script>



<meta name="firefox-versions" content="{&quot;FIREFOX_AURORA&quot;:&quot;&quot;,&quot;FIREFOX_DEVEDITION&quot;:&quot;94.0b9&quot;,&quot;FIREFOX_ESR&quot;:&quot;78.15.0esr&quot;,&quot;FIREFOX_ESR_NEXT&quot;:&quot;91.2.0esr&quot;,&quot;FIREFOX_NIGHTLY&quot;:&quot;95.0a1&quot;,&quot;FIREFOX_PINEBUILD&quot;:&quot;&quot;,&quot;LAST_MERGE_DATE&quot;:&quot;2021-10-04&quot;,&quot;LAST_RELEASE_DATE&quot;:&quot;2021-10-05&quot;,&quot;LAST_SOFTFREEZE_DATE&quot;:&quot;2021-09-30&quot;,&quot;LATEST_FIREFOX_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_OLDER_VERSION&quot;:&quot;3.6.28&quot;,&quot;LATEST_FIREFOX_RELEASED_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_VERSION&quot;:&quot;93.0&quot;,&quot;NEXT_MERGE_DATE&quot;:&quot;2021-11-01&quot;,&quot;NEXT_RELEASE_DATE&quot;:&quot;2021-11-02&quot;,&quot;NEXT_SOFTFREEZE_DATE&quot;:&quot;2021-10-28&quot;}">


<div id="comment-actions">
    <button type="button" id="bottom-btn" class="secondary" aria-label="Go to Page Bottom">Bottom &darr;</button>
  <div class="dropdown">
    <button type="button" id="comment-tags-btn" aria-haspopup="true" aria-label="Tags"
      aria-expanded="false" aria-controls="comment-tags-menu" class="dropdown-button minor">Tags &#9662;</button>
    <ul id="comment-tags-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a role="menuitem" tabindex="-1" data-comment-tag="">Reset</a>
      </li>
    </ul>
  </div>
  <div class="dropdown">
    <button type="button" id="view-menu-btn" aria-haspopup="true" aria-label="Timeline"
      aria-expanded="false" aria-controls="view-menu" class="dropdown-button minor">Timeline &#9662;</button>
    <ul id="view-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a id="view-reset" role="menuitem" tabindex="-1">Reset</a>
      </li>
      <li role="separator"></li>
      <li role="presentation">
        <a id="view-collapse-all" role="menuitem" tabindex="-1">Collapse All</a>
      </li>
      <li role="presentation">
        <a id="view-expand-all" role="menuitem" tabindex="-1">Expand All</a>
      </li>
      <li role="presentation">
        <a id="view-comments-only" role="menuitem" tabindex="-1">Comments Only</a>
      </li>
    </ul>
   </div>
</div>
<div class="change-set" id="c0"><div class="comment" data-id="13415365" data-no="0"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-0" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_534567" ><img src="https://secure.gravatar.com/avatar/30ed3b0b86b55506949fb1eca087ed71?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_534567" ><a class="email " href="/user_profile?user_id=534567" > <span class="fna">1lastBr3ath</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-0"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-0" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#c0">Description</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-20 09:43 PDT" data-time="1529513038">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-0">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8986497"
         class="attachment"
         data-id="8986497" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="save.tar.gz">
      <meta itemprop="contentSize" content="1099">
      <meta itemprop="encodingFormat" content="application/gzip">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=8986497" itemprop="contentUrl">
        <span id="att-8986497-description" itemprop="description">Contains php files for easier reproduction</span></a>
        — <a href="attachment.cgi?id=8986497&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-0" data-comment-id="13415365">User Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.87 Safari/537.36

Steps to reproduce:

1. Download the attached file and host it locally under &quot;save&quot; directory
2. Make request.log world writable (i.e. chmod 666 request.log)
3. Run the following bash command to follow requests coming in;
$ tail -f request.log| sed -En '/GET|Cookie:/p'
3. Open <a rel="nofollow" href="http://localhost/save/cookies.php?url=http://127.0.0.1/save/save.php">http://localhost/save/cookies.php?url=http://127.0.0.1/save/save.php</a>
4. Observe cookies received, only cookies with no SameSite attributes are received
5. Save the page with Ctrl+S or via Context menu &gt; Save Page As...
6. Observe received cookies, all cookies are received

Note:
Only those tags  (with external reference) in &quot;save.php&quot; leak cookies


Actual results:

SameSite cookies sent for crossdomain requests


Expected results:

SameSite cookies shouldn't have been sent</pre></div><div class="change-set" id="c1"><div class="comment" data-id="13415561" data-no="1"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-1" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" ><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" ><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-1"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-1" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#c1">Comment 1</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-20 10:47 PDT" data-time="1529516868">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-1">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-1" data-comment-id="13415561">Mark, just flagging this up to you as well... :-)</pre><div class="activity"><div class="change">Flags: needinfo?(mgoodwin)</div></div></div><div class="change-set" id="c2"><div class="comment" data-id="13417515" data-no="2"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-2" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" ><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" ><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-2"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-2" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#c2">Comment 2</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-21 07:07 PDT" data-time="1529590077">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-2">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-2" data-comment-id="13417515">file: urls have no referrer, I wonder if we mess up on whether the sub-resources are 3rd party requests or not? I'm not sure how we could (comparing &quot;&quot; to any host shouldn't be true), but if that's the problem we might also be sending cookies when the user has disabled 3rd-party cookies.</pre><div class="activity"><div class="change">Group: firefox-core-security &rarr; network-core-security</div><div class="change">Component: Untriaged &rarr; Networking: Cookies</div><div class="change">Keywords: <a href="/buglist.cgi?keywords=sec-low&amp;resolution=---">sec-low</a></div><div class="change">Product: Firefox &rarr; Core</div></div></div><div class="change-set" id="a77499_1689"><div class="change" id="aa77499_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a77499_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a77499_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a77499_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a77499_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#a77499_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-21 07:15 PDT" data-time="1529590537">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: network-core-security &rarr; dom-core-security</div><div class="change">Component: Networking: Cookies &rarr; DOM: Security</div></div></div><div class="change-set" id="c3"><div class="comment" data-id="13417809" data-no="3"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-3" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_534567" id="a77499_1689"><img src="https://secure.gravatar.com/avatar/30ed3b0b86b55506949fb1eca087ed71?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_534567" id="a77499_1689"><a class="email " href="/user_profile?user_id=534567" > <span class="fna">1lastBr3ath</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-3"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-3" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#c3">Comment 3</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-21 08:39 PDT" data-time="1529595584">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-3">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-3" data-comment-id="13417809">I don't think that's what the issue is because if I browse file URL directly, it doesn't send SameSite cookies at all. It only happens when saving the page and only with those 4 tags.</pre></div><div class="change-set" id="c4"><div class="comment" data-id="13419637" data-no="4"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-4" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a77499_1689"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a77499_1689"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-4"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-4" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#c4">Comment 4</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-22 04:57 PDT" data-time="1529668626">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-4">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-4" data-comment-id="13419637">This is all because nsIWebBrowserPersist is a giant mess. We have other bugs about this. They're all not particularly severe, but there's a bunch of them and we should just clean it up. I'll give this a poke.</pre><div class="activity"><div class="change">Assignee: nobody &rarr; gijskruitbosch+bugs</div><div class="change">Status: UNCONFIRMED &rarr; ASSIGNED</div><div class="change">Ever confirmed: true</div><div class="change">Flags: <span class="activity-deleted">needinfo?(mgoodwin)</span></div></div></div><div class="change-set" id="c5"><div class="comment" data-id="13419970" data-no="5"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-5" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_600971" id="a77499_1689"><img src="https://secure.gravatar.com/avatar/a088418052679d9583556d277e6774ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_600971" id="a77499_1689"><a class="email " href="/user_profile?user_id=600971" > <span class="fna">Phabricator Automation</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-5"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-5" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#c5">Comment 5</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-22 07:46 PDT" data-time="1529678775">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-5">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8987073"
         class="attachment"
         data-id="8987073" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="phabricator-D1766-url.txt">
      <meta itemprop="contentSize" content="46">
      <meta itemprop="encodingFormat" content="text/x-phabricator-request">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=8987073" itemprop="contentUrl">
        <span id="att-8987073-description" itemprop="description">Bug 1469916 - use principals in webbrowserpersist code, r?ckerschb,jkt</span></a>
        — <a href="attachment.cgi?id=8987073&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-5" data-comment-id="13419970"><a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - SameSite Cookies leakage via &quot;Save Page As...&quot;"
   href="/show_bug.cgi?id=1469916">Bug 1469916</a> - use principals in webbrowserpersist code to ensure proper OA, samesite cookie behavior, etc.</pre></div><div class="change-set" id="c6"><div class="comment" data-id="13419994" data-no="6"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-6" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a77499_1689"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a77499_1689"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-6"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-6" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#c6">Comment 6</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-22 07:56 PDT" data-time="1529679388">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-6">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-6" data-comment-id="13419994">So... I wrote up a fairly ugly big patch to try to teach webbrowserpersist some manners about principals. I think this will also fix some other issues we have on file, like how we fetch URLs outside of containers when saving pages from a container tab etc...

The problem I'm having is that although with the patch we pass a loading principal to the load triggered by webbrowserpersist, it seems we end up calling <a rel="nofollow" href="https://dxr.mozilla.org/mozilla-central/rev/681eb7dfa324dd50403c382888929ea8b8b11b00/netwerk/protocol/http/HttpBaseChannel.cpp#3424-3439">https://dxr.mozilla.org/mozilla-central/rev/681eb7dfa324dd50403c382888929ea8b8b11b00/netwerk/protocol/http/HttpBaseChannel.cpp#3424-3439</a>

(HttpBaseChannel::AddCookiesToRequest), which via GetCookieStringFromHttp and GetCookieStringCommon calls

  mThirdPartyUtil-&gt;IsThirdPartyChannel(aChannel, aHostURI, &amp;isForeign);

with aChannel == e.g. the channel for the alternate stylesheet in the testcase, and aHostURI... is the URI for that channel! Understandably, the third party util code then declares that we can send samesite cookies, because the host uri matches the channel URI. I don't really see how this is happening yet works fine &quot;normally&quot;, ie I'm not sure what webbrowserpersist is doing differently/wrong in how it creates a channel (once it has a loading principal like with this patch). Mark/Christoph, can either of you take a look?</pre><div class="activity"><div class="change">Assignee: gijskruitbosch+bugs &rarr; nobody</div><div class="change">Status: ASSIGNED &rarr; UNCONFIRMED</div><div class="change">Ever confirmed: false</div><div class="change">Flags: needinfo?(mgoodwin)</div><div class="change">Flags: needinfo?(ckerschb)</div></div></div><div class="change-set" id="c7"><div class="comment" data-id="13419995" data-no="7"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-7" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a77499_1689"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a77499_1689"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-7"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-7" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#c7">Comment 7</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-22 07:56 PDT" data-time="1529679412">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-7">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-7" data-comment-id="13419995">Egh, didn't mean to unassign.</pre><div class="activity"><div class="change">Assignee: nobody &rarr; gijskruitbosch+bugs</div><div class="change">Status: UNCONFIRMED &rarr; ASSIGNED</div><div class="change">Ever confirmed: true</div></div></div><div class="change-set" id="c8"><div class="comment" data-id="13424039" data-no="8"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-8" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a77499_1689"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a77499_1689"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-8"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-8" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#c8">Comment 8</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-24 23:48 PDT" data-time="1529909314">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-8">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-8" data-comment-id="13424039">(In reply to :Gijs (he/him) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - SameSite Cookies leakage via &quot;Save Page As...&quot;"
   href="/show_bug.cgi?id=1469916#c6">comment #6</a>)
<span class="quote">&gt; So... I wrote up a fairly ugly big patch to try to teach webbrowserpersist
&gt; some manners about principals. I think this will also fix some other issues
&gt; we have on file, like how we fetch URLs outside of containers when saving
&gt; pages from a container tab etc...</span >

Thanks for updating this part of the code - I didn't like falling back to using the systemPrincipal within WebBrowserPersist in the first place. One tiny nit, could we call this principal &quot;triggeringPrincipal&quot;, because that's what it really is in the end - it's the principal that triggered the load for those cases.

Bonus points for adding an assertion within saveURI: If saveURI gets passed a referrer, the triggeringPrincipal must be a CodebasePrincipal that matches the URI of the referrer. But we could do that in a follow up of course. Thomas is working on referrer policy, maybe I'll just file another bug and have him take a look.

<span class="quote">&gt; The problem I'm having is that although with the patch we pass a loading
&gt; principal to the load triggered by webbrowserpersist, it seems we end up
&gt; calling
&gt; <a rel="nofollow" href="https://dxr.mozilla.org/mozilla-central/rev/">https://dxr.mozilla.org/mozilla-central/rev/</a>
&gt; 681eb7dfa324dd50403c382888929ea8b8b11b00/netwerk/protocol/http/
&gt; HttpBaseChannel.cpp#3424-3439
&gt; 
&gt; (HttpBaseChannel::AddCookiesToRequest), which via GetCookieStringFromHttp
&gt; and GetCookieStringCommon calls
&gt; 
&gt;   mThirdPartyUtil-&gt;IsThirdPartyChannel(aChannel, aHostURI, &amp;isForeign);
&gt; 
&gt; with aChannel == e.g. the channel for the alternate stylesheet in the
&gt; testcase, and aHostURI... is the URI for that channel!</span >

Shouldn't aHostURI be the URI of the document in that case? Or is that only the problem for stylesheets that aHostURI matches the URI of the stylesheet itself? I couldn't find precisely the code where we end up calling |mThirdPartyUtil-&gt;IsThirdPartyChannel(aChannel, aHostURI, &amp;isForeign);|, do you have a stacktrace for that? Or can you provide a DXR link? Then I could take another look.

Besides the principal changes here, I suppose that never worked in the first place and most likely we have a bug where aHostURI is the URI of the stylesheet instead of the document.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(ckerschb)</span></div></div></div><div class="change-set" id="c9"><div class="comment" data-id="13424801" data-no="9"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-9" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a77499_1689"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a77499_1689"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-9"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-9" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#c9">Comment 9</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-25 07:55 PDT" data-time="1529938541">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-9">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-9" data-comment-id="13424801">(In reply to Christoph Kerschbaumer [:ckerschb] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - SameSite Cookies leakage via &quot;Save Page As...&quot;"
   href="/show_bug.cgi?id=1469916#c8">comment #8</a>)
<span class="quote">&gt; (In reply to :Gijs (he/him) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - SameSite Cookies leakage via &quot;Save Page As...&quot;"
   href="/show_bug.cgi?id=1469916#c6">comment #6</a>)
&gt; &gt; The problem I'm having is that although with the patch we pass a loading
&gt; &gt; principal to the load triggered by webbrowserpersist, it seems we end up
&gt; &gt; calling
&gt; &gt; <a rel="nofollow" href="https://dxr.mozilla.org/mozilla-central/rev/">https://dxr.mozilla.org/mozilla-central/rev/</a>
&gt; &gt; 681eb7dfa324dd50403c382888929ea8b8b11b00/netwerk/protocol/http/
&gt; &gt; HttpBaseChannel.cpp#3424-3439
&gt; &gt; 
&gt; &gt; (HttpBaseChannel::AddCookiesToRequest), which via GetCookieStringFromHttp
&gt; &gt; and GetCookieStringCommon calls
&gt; &gt; 
&gt; &gt;   mThirdPartyUtil-&gt;IsThirdPartyChannel(aChannel, aHostURI, &amp;isForeign);
&gt; &gt; 
&gt; &gt; with aChannel == e.g. the channel for the alternate stylesheet in the
&gt; &gt; testcase, and aHostURI... is the URI for that channel!
&gt; 
&gt; Shouldn't aHostURI be the URI of the document in that case? Or is that only
&gt; the problem for stylesheets that aHostURI matches the URI of the stylesheet
&gt; itself? I couldn't find precisely the code where we end up calling
&gt; |mThirdPartyUtil-&gt;IsThirdPartyChannel(aChannel, aHostURI, &amp;isForeign);|, do
&gt; you have a stacktrace for that? Or can you provide a DXR link? Then I could
&gt; take another look.</span >

I think it *should* be but it isn't, yeah. The DXR link for the IsTPC channel is:

<a rel="nofollow" href="https://dxr.mozilla.org/mozilla-central/rev/681eb7dfa324dd50403c382888929ea8b8b11b00/netwerk/cookie/nsCookieService.cpp#2034-2036">https://dxr.mozilla.org/mozilla-central/rev/681eb7dfa324dd50403c382888929ea8b8b11b00/netwerk/cookie/nsCookieService.cpp#2034-2036</a>

<span class="quote">&gt; Besides the principal changes here, I suppose that never worked in the first
&gt; place and most likely we have a bug where aHostURI is the URI of the
&gt; stylesheet instead of the document.</span >

This would seem to be surprising to me, but I suppose it's possible. Should be easy to test?</pre></div><div class="change-set" id="c10"><div class="comment" data-id="13426759" data-no="10"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-10" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a77499_1689"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a77499_1689"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-10"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-10" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#c10">Comment 10</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-26 00:47 PDT" data-time="1529999230">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-10">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-10" data-comment-id="13426759">(In reply to :Gijs (he/him) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - SameSite Cookies leakage via &quot;Save Page As...&quot;"
   href="/show_bug.cgi?id=1469916#c6">comment #6</a>)
<span class="quote">&gt; (HttpBaseChannel::AddCookiesToRequest), which via GetCookieStringFromHttp
&gt; and GetCookieStringCommon calls
&gt; 
&gt;   mThirdPartyUtil-&gt;IsThirdPartyChannel(aChannel, aHostURI, &amp;isForeign);
&gt; 
&gt; with aChannel == e.g. the channel for the alternate stylesheet in the
&gt; testcase, and aHostURI... is the URI for that channel! Understandably, the
&gt; third party util code then declares that we can send samesite cookies,
&gt; because the host uri matches the channel URI. I don't really see how this is
&gt; happening yet works fine &quot;normally&quot;, ie I'm not sure what webbrowserpersist
&gt; is doing differently/wrong in how it creates a channel (once it has a
&gt; loading principal like with this patch). Mark/Christoph, can either of you
&gt; take a look?</span >

Hey Gijs,

I haven't debugged this, but I just started to look at the code and already realized, it's not the mThirdPartyUtil-&gt;IsThirdPartyChannel() check within GetCookieStringCommon, but the NS_IsSameSiteForeign() [0] that determines whether a request is foreign with respect to same-site cookies.

Now, NS_IsSameSiteForeign() only does special things for TYPE_DOCUMENT and TYPE_SUBDOCUMENT [1], but not for TYPE_OTHER. Question is, the channel we create within nsWebBrowserPersist::SaveURIInternal is that only for loads of TYPE_DOCUMENT, right? If so, then I guess we could change the type from TYPE_OTHER to TYPE_DOCUMENT and presumably NS_IsSameSiteForeign() returns the correct result then.

What do you think?

[0] <a rel="nofollow" href="https://dxr.mozilla.org/mozilla-central/source/netwerk/cookie/nsCookieService.cpp#2045">https://dxr.mozilla.org/mozilla-central/source/netwerk/cookie/nsCookieService.cpp#2045</a>
[1] <a rel="nofollow" href="https://dxr.mozilla.org/mozilla-central/source/netwerk/base/nsNetUtil.cpp#2117-2190">https://dxr.mozilla.org/mozilla-central/source/netwerk/base/nsNetUtil.cpp#2117-2190</a></pre><div class="activity"><div class="change">Flags: needinfo?(gijskruitbosch+bugs)</div></div></div><div class="change-set" id="a487521_363267"><div class="change" id="aa487521_363267">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a487521_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_363267" id="a487521_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a487521_363267"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a487521_363267">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#a487521_363267">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-26 01:09 PDT" data-time="1530000559">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Priority: -- &rarr; P2</div><div class="change">Whiteboard: [domsecurity-active]</div></div></div><div class="change-set" id="c11"><div class="comment" data-id="13427059" data-no="11"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-11" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a487521_363267"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a487521_363267"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-11"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-11" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#c11">Comment 11</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-26 03:37 PDT" data-time="1530009436">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-11">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-11" data-comment-id="13427059">(In reply to Christoph Kerschbaumer [:ckerschb] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - SameSite Cookies leakage via &quot;Save Page As...&quot;"
   href="/show_bug.cgi?id=1469916#c10">comment #10</a>)
<span class="quote">&gt; (In reply to :Gijs (he/him) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - SameSite Cookies leakage via &quot;Save Page As...&quot;"
   href="/show_bug.cgi?id=1469916#c6">comment #6</a>)
&gt; &gt; (HttpBaseChannel::AddCookiesToRequest), which via GetCookieStringFromHttp
&gt; &gt; and GetCookieStringCommon calls
&gt; &gt; 
&gt; &gt;   mThirdPartyUtil-&gt;IsThirdPartyChannel(aChannel, aHostURI, &amp;isForeign);
&gt; &gt; 
&gt; &gt; with aChannel == e.g. the channel for the alternate stylesheet in the
&gt; &gt; testcase, and aHostURI... is the URI for that channel! Understandably, the
&gt; &gt; third party util code then declares that we can send samesite cookies,
&gt; &gt; because the host uri matches the channel URI. I don't really see how this is
&gt; &gt; happening yet works fine &quot;normally&quot;, ie I'm not sure what webbrowserpersist
&gt; &gt; is doing differently/wrong in how it creates a channel (once it has a
&gt; &gt; loading principal like with this patch). Mark/Christoph, can either of you
&gt; &gt; take a look?
&gt; 
&gt; Hey Gijs,
&gt; 
&gt; I haven't debugged this, but I just started to look at the code and already
&gt; realized, it's not the mThirdPartyUtil-&gt;IsThirdPartyChannel() check within
&gt; GetCookieStringCommon, but the NS_IsSameSiteForeign() [0] that determines
&gt; whether a request is foreign with respect to same-site cookies.
&gt; 
&gt; Now, NS_IsSameSiteForeign() only does special things for TYPE_DOCUMENT and
&gt; TYPE_SUBDOCUMENT [1], but not for TYPE_OTHER. Question is, the channel we
&gt; create within nsWebBrowserPersist::SaveURIInternal is that only for loads of
&gt; TYPE_DOCUMENT, right? If so, then I guess we could change the type from
&gt; TYPE_OTHER to TYPE_DOCUMENT and presumably NS_IsSameSiteForeign() returns
&gt; the correct result then.
&gt; 
&gt; What do you think?
&gt; 
&gt; [0]
&gt; <a rel="nofollow" href="https://dxr.mozilla.org/mozilla-central/source/netwerk/cookie/">https://dxr.mozilla.org/mozilla-central/source/netwerk/cookie/</a>
&gt; nsCookieService.cpp#2045
&gt; [1]
&gt; <a rel="nofollow" href="https://dxr.mozilla.org/mozilla-central/source/netwerk/base/nsNetUtil">https://dxr.mozilla.org/mozilla-central/source/netwerk/base/nsNetUtil</a>.
&gt; cpp#2117-2190</span >

SaveURIInternal gets used both for the actual document and for anything required by the document. In this case the problematic request that has cookies is for a stylesheet &lt;link&gt; element, so I would think that a non-document type is correct... and I'd expect aHostURI to be the document URI, with the channel using the &lt;link&gt; element's URI, and thus those 2 not matching...</pre><div class="activity"><div class="change">Flags: needinfo?(gijskruitbosch+bugs) &rarr; needinfo?(ckerschb)</div></div></div><div class="change-set" id="c12"><div class="comment" data-id="13429833" data-no="12"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-12" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a487521_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a487521_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-12"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-12" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#c12">Comment 12</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-27 02:00 PDT" data-time="1530090029">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-12">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-12" data-comment-id="13429833">(In reply to :Gijs (he/him) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - SameSite Cookies leakage via &quot;Save Page As...&quot;"
   href="/show_bug.cgi?id=1469916#c11">comment #11</a>)
<span class="quote">&gt; SaveURIInternal gets used both for the actual document and for anything
&gt; required by the document. In this case the problematic request that has
&gt; cookies is for a stylesheet &lt;link&gt; element, so I would think that a
&gt; non-document type is correct... and I'd expect aHostURI to be the document
&gt; URI, with the channel using the &lt;link&gt; element's URI, and thus those 2 not
&gt; matching...</span >

It took me a while to page all of that stuff back in. Here is the info you were looking for:

1) Really the information whether a channel is third party or not does not 'really' depend on the provided HostURI, but is computed from the loadinfo. In particular, the URI of the loadingPrincipal (which refelcts the actual hostURI) is compared to the channelURI within IsThirdPartyChannel here [1].

2) What you pointed out in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - SameSite Cookies leakage via &quot;Save Page As...&quot;"
   href="/show_bug.cgi?id=1469916#c6">comment 6</a> however does not really make sense to me, we are passing mURI as the hostURI to GetCookieStringFromHttp() within the HttpBaseChannel [2]. Please note that channel::GetURI() also return mURI, so the hostURI and the channelURI are always identical. In my opinion there is a bug here and we should pass mDocumentURI instead of mURI within HttpBaseChannel [2].

Honza (I guess he is out) or Valentin, what do you think regarding point (2) here?


[1] <a rel="nofollow" href="https://dxr.mozilla.org/mozilla-central/source/dom/base/ThirdPartyUtil.cpp#224-239">https://dxr.mozilla.org/mozilla-central/source/dom/base/ThirdPartyUtil.cpp#224-239</a>
[2] <a rel="nofollow" href="https://dxr.mozilla.org/mozilla-central/source/netwerk/protocol/http/HttpBaseChannel.cpp#3436">https://dxr.mozilla.org/mozilla-central/source/netwerk/protocol/http/HttpBaseChannel.cpp#3436</a></pre><div class="activity"><div class="change">Flags: needinfo?(ckerschb) &rarr; needinfo?(valentin.gosu)</div></div></div><div class="change-set" id="c13"><div class="comment" data-id="13430118" data-no="13"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-13" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_415378" id="a487521_363267"><img src="https://secure.gravatar.com/avatar/dedff9d4500fcbc5cdd1cd270f044b33?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_415378" id="a487521_363267"><a class="email " href="/user_profile?user_id=415378" > <span class="fna">Valentin Gosu [:valentin] (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-13"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-13" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#c13">Comment 13</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-27 04:23 PDT" data-time="1530098607">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-13">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-13" data-comment-id="13430118">I think you're right. Even in the IDL it's specified that first argument is supposed to be the URI of the document.

<a rel="nofollow" href="https://searchfox.org/mozilla-central/rev/14cb8f1c238735ba1abe18ad44e39808983c2572/netwerk/cookie/nsICookieService.idl#126-127,143">https://searchfox.org/mozilla-central/rev/14cb8f1c238735ba1abe18ad44e39808983c2572/netwerk/cookie/nsICookieService.idl#126-127,143</a></pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(valentin.gosu)</span></div></div></div><div class="change-set" id="c14"><div class="comment" data-id="13430798" data-no="14"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-14" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_534567" id="a487521_363267"><img src="https://secure.gravatar.com/avatar/30ed3b0b86b55506949fb1eca087ed71?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_534567" id="a487521_363267"><a class="email " href="/user_profile?user_id=534567" > <span class="fna">1lastBr3ath</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-14"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-14" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#c14">Comment 14</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-27 08:54 PDT" data-time="1530114854">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-14">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8988232"
         class="attachment"
         data-id="8988232" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="poc.html">
      <meta itemprop="contentSize" content="840">
      <meta itemprop="encodingFormat" content="text/html">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=8988232" itemprop="contentUrl">
        <span id="att-8988232-description" itemprop="description">poc.html</span></a>
        — <a href="attachment.cgi?id=8988232&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-14" data-comment-id="13430798">Sorry to interrupt again but the issue doesn't seem to affect only those 4 tags, rather all tags. It's hard to reproduce consistently. The attached HTML should trigger requests for all tags when saved. Please refer to reproduction steps given in my initial report.</pre></div><div class="change-set" id="c15"><div class="comment" data-id="13430944" data-no="15"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-15" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a487521_363267"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a487521_363267"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-15"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-15" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#c15">Comment 15</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-27 09:54 PDT" data-time="1530118472">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-15">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-15" data-comment-id="13430944">(In reply to Christoph Kerschbaumer [:ckerschb] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - SameSite Cookies leakage via &quot;Save Page As...&quot;"
   href="/show_bug.cgi?id=1469916#c12">comment #12</a>)
<span class="quote">&gt; 2) What you pointed out in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - SameSite Cookies leakage via &quot;Save Page As...&quot;"
   href="/show_bug.cgi?id=1469916#c6">comment 6</a> however does not really make sense to
&gt; me, we are passing mURI as the hostURI to GetCookieStringFromHttp() within
&gt; the HttpBaseChannel [2]. Please note that channel::GetURI() also return
&gt; mURI, so the hostURI and the channelURI are always identical. In my opinion
&gt; there is a bug here and we should pass mDocumentURI instead of mURI within
&gt; HttpBaseChannel [2].</span >

So the next question I'm wondering about is... why isn't this broken all the time? i.e. step 4 in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - SameSite Cookies leakage via &quot;Save Page As...&quot;"
   href="/show_bug.cgi?id=1469916#c0">comment 0</a> is also what I see - when the page is loaded without using 'save page as' the correct cookies are sent. But the URLs should be the same, right? (Unfortunately I don't have a build to hand so I can't easily check at the moment - will try to do this later today or tomorrow if nobody else gets there before me...)</pre></div><div class="change-set" id="c16"><div class="comment" data-id="13432681" data-no="16"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-16" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a487521_363267"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a487521_363267"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-16"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-16" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#c16">Comment 16</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-28 01:54 PDT" data-time="1530176094">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-16">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-16" data-comment-id="13432681">(In reply to :Gijs (he/him) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - SameSite Cookies leakage via &quot;Save Page As...&quot;"
   href="/show_bug.cgi?id=1469916#c15">comment #15</a>)
<span class="quote">&gt; (In reply to Christoph Kerschbaumer [:ckerschb] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - SameSite Cookies leakage via &quot;Save Page As...&quot;"
   href="/show_bug.cgi?id=1469916#c12">comment #12</a>)
&gt; &gt; 2) What you pointed out in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - SameSite Cookies leakage via &quot;Save Page As...&quot;"
   href="/show_bug.cgi?id=1469916#c6">comment 6</a> however does not really make sense to
&gt; &gt; me, we are passing mURI as the hostURI to GetCookieStringFromHttp() within
&gt; &gt; the HttpBaseChannel [2]. Please note that channel::GetURI() also return
&gt; &gt; mURI, so the hostURI and the channelURI are always identical. In my opinion
&gt; &gt; there is a bug here and we should pass mDocumentURI instead of mURI within
&gt; &gt; HttpBaseChannel [2].
&gt; 
&gt; So the next question I'm wondering about is... why isn't this broken all the
&gt; time? i.e. step 4 in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - SameSite Cookies leakage via &quot;Save Page As...&quot;"
   href="/show_bug.cgi?id=1469916#c0">comment 0</a> is also what I see - when the page is loaded
&gt; without using 'save page as' the correct cookies are sent. But the URLs
&gt; should be the same, right? (Unfortunately I don't have a build to hand so I
&gt; can't easily check at the moment - will try to do this later today or
&gt; tomorrow if nobody else gets there before me...)</span >

As usual the answer to seemingly confusing states is more mundane than one might expect.

First off, the reason we block cookies in the normal pageload case isn't the checks referenced here so far, but these:

<a rel="nofollow" href="https://dxr.mozilla.org/mozilla-central/rev/681eb7dfa324dd50403c382888929ea8b8b11b00/dom/base/ThirdPartyUtil.cpp#226-235">https://dxr.mozilla.org/mozilla-central/rev/681eb7dfa324dd50403c382888929ea8b8b11b00/dom/base/ThirdPartyUtil.cpp#226-235</a>

copy-paste for convenience:

  if (!doForce) {
    if (nsCOMPtr&lt;nsILoadInfo&gt; loadInfo = aChannel-&gt;GetLoadInfo()) {
      parentIsThird = loadInfo-&gt;GetIsInThirdPartyContext();
      if (!parentIsThird &amp;&amp;
          loadInfo-&gt;GetExternalContentPolicyType() != nsIContentPolicy::TYPE_DOCUMENT) {
        // Check if the channel itself is third-party to its own requestor.
        // Unforunately, we have to go through the loading principal.
        nsCOMPtr&lt;nsIURI&gt; parentURI;
        loadInfo-&gt;LoadingPrincipal()-&gt;GetURI(getter_AddRefs(parentURI));
        rv = IsThirdPartyInternal(channelDomain, parentURI, &amp;parentIsThird);
        if (NS_FAILED(rv))
          return rv;
      }

... and then we return true (for &quot;is this a third party channel&quot;) if parentIsThird is true.

Now, the reason this doesn't help with 'save as' is also trivial, it turns out - doForce is true, so we skip this check.

Why? Well, nsWebBrowserPersist code has had this flag since <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Disabling 3rd party cookies breaks sending cookies for channels with no docshell"
   href="/show_bug.cgi?id=437174">https://bugzilla.mozilla.org/show_bug.cgi?id=437174</a> got fixed (so that people could use the &quot;disable third party cookies&quot; pref and still get cookies in background requests, ie requests without a window), 9 years ago, and since then we've not really updated this stuff...

The last few comments seem to suggest this flag was no longer necessary a few months later. :-\

In any case, I would expect our new principal work to mean that you shouldn't need a docshell for us to make the correct third party cookie decisions, and clearly here the flag is messing with the desired outcome. I'll experiment with fixing this, rather than fixing the mURI/mDocumentURI confusion in the cookie code (which I expect has more fallout - there's not a lot of in-tree usage of the THIRD_PARTY_FORCE_ALLOW flag, it looks like.</pre></div><div class="change-set" id="c17"><div class="comment" data-id="13432852" data-no="17"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-17" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a487521_363267"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a487521_363267"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-17"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-17" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#c17">Comment 17</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-28 03:15 PDT" data-time="1530180933">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-17">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-17" data-comment-id="13432852">(In reply to :Gijs (he/him) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - SameSite Cookies leakage via &quot;Save Page As...&quot;"
   href="/show_bug.cgi?id=1469916#c16">comment #16</a>)
<span class="quote">&gt; In any case, I would expect our new principal work to mean that you
&gt; shouldn't need a docshell for us to make the correct third party cookie
&gt; decisions, and clearly here the flag is messing with the desired outcome.
&gt; I'll experiment with fixing this, rather than fixing the mURI/mDocumentURI
&gt; confusion in the cookie code (which I expect has more fallout - there's not
&gt; a lot of in-tree usage of the THIRD_PARTY_FORCE_ALLOW flag, it looks like.</span >

This turns out to *also* not be trivial to just get rid of this flag everywhere, because we use a system principal for some of these loads, and the third party cookie code tries to get a URI off it, which fails and therefore leaves the cookie code deciding this is a third-party load (safe defaults) and doesn't send cookies (if you disable third party cookies, per <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Disabling 3rd party cookies breaks sending cookies for channels with no docshell"
   href="/show_bug.cgi?id=437174">bug 437174</a>). I tested this with the InstallTrigger code by uploading a self-hosted add-on on AMO and disabling 3rd party cookies, and then manually running InstallTrigger.install() fails. It seems it'd need to have its principal fixed, too, in order for that to work.

The original rationale here (cf. <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Disabling 3rd party cookies breaks sending cookies for channels with no docshell"
   href="/show_bug.cgi?id=437174#c27">bug 437174 comment 27</a> and further, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - reimplement third party cookie blocking"
   href="/show_bug.cgi?id=421494">bug 421494</a>) seems to also include the idea that system loads (sometimes from add-ons) can't be trusted to always send third party cookies. I don't know how that works these days, I don't see any webextension-related code using this flag... It's also interesting that we made the default behavior break all cookies for privileged requests, but privileged requests can work around with a flag (which add-ons could of course also use if they wanted...) which then results in *all* cookies being sent, even the ones it really shouldn't send. Feels like the cure is worse than the disease. :-(

Thankfully, favicons (which is a case that's cited repeatedly in the discussion about sending samesite cookies) is being fixed in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Favicons should only be loaded once"
   href="/show_bug.cgi?id=1453751">bug 1453751</a>. So with that, I think the &quot;force cookies&quot; flag should be kill-able.

In any case... hopefully with the fixes in this patch I can ensure that we pass a non-system-principal in all the browser callsites of webbrowserpersist, and get rid of the flag there. Once patches in this bug are finished, reviewed and landed, I'll file a follow-up bug to get the cookie service to use mDocumentURI, and a follow-up bug to kill off this footgun flag - pretty sure we can just pass better principals instead of system principal in the other callsites eventually, and then we can kill the flag.</pre></div><div class="change-set" id="c18"><div class="comment" data-id="13433671" data-no="18"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-18" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a487521_363267"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a487521_363267"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-18"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-18" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#c18">Comment 18</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-28 09:07 PDT" data-time="1530202064">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-18">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-18" data-comment-id="13433671">Comment on <span class=""><a href="/attachment.cgi?id=8987073" name="attach_8987073" title="Bug 1469916 - use principals in webbrowserpersist code, r?ckerschb,jkt">attachment 8987073</a> <a href="/attachment.cgi?id=8987073&amp;action=edit" title="Bug 1469916 - use principals in webbrowserpersist code, r?ckerschb,jkt">[details]</a></span>
<a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - SameSite Cookies leakage via &quot;Save Page As...&quot;"
   href="/show_bug.cgi?id=1469916">Bug 1469916</a> - use principals in webbrowserpersist code, r?ckerschb,jkt

Setting flags here to make sure people see the requests.

This should be ready for review now. :-)</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(mgoodwin)</span></div><div class="change">
        <a href="/attachment.cgi?id=8987073&amp;action=edit"
           title="Bug 1469916 - use principals in webbrowserpersist code, r?ckerschb,jkt"
           class=""
        >Attachment #8987073</a> -
        Flags: review?(jkt)</div><div class="change">
        <a href="/attachment.cgi?id=8987073&amp;action=edit"
           title="Bug 1469916 - use principals in webbrowserpersist code, r?ckerschb,jkt"
           class=""
        >Attachment #8987073</a> -
        Flags: review?(ckerschb)</div></div></div><div class="change-set" id="c19"><div class="comment" data-id="13438163" data-no="19"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-19" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a487521_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a487521_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-19"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-19" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#c19">Comment 19</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-29 08:12 PDT" data-time="1530285140">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-19">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-19" data-comment-id="13438163">(In reply to :Gijs (he/him) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - SameSite Cookies leakage via &quot;Save Page As...&quot;"
   href="/show_bug.cgi?id=1469916#c17">comment #17</a>)
<span class="quote">&gt; In any case... hopefully with the fixes in this patch I can ensure that we
&gt; pass a non-system-principal in all the browser callsites of
&gt; webbrowserpersist, and get rid of the flag there. Once patches in this bug
&gt; are finished, reviewed and landed, I'll file a follow-up bug to get the
&gt; cookie service to use mDocumentURI, and a follow-up bug to kill off this
&gt; footgun flag - pretty sure we can just pass better principals instead of
&gt; system principal in the other callsites eventually, and then we can kill the
&gt; flag.</span >

Thanks Gijs, that sounds like a good path forward to me. It's still surprising to me that using mURI instead of mDocumentURI has been there for so many years.</pre></div><div class="change-set" id="c20"><div class="comment" data-id="13438193" data-no="20"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-20" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_600971" id="a487521_363267"><img src="https://secure.gravatar.com/avatar/a088418052679d9583556d277e6774ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_600971" id="a487521_363267"><a class="email " href="/user_profile?user_id=600971" > <span class="fna">Phabricator Automation</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-20"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-20" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#c20">Comment 20</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-29 08:17 PDT" data-time="1530285475">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-20">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-20" data-comment-id="13438193">Comment on <span class=""><a href="/attachment.cgi?id=8987073" name="attach_8987073" title="Bug 1469916 - use principals in webbrowserpersist code, r?ckerschb,jkt">attachment 8987073</a> <a href="/attachment.cgi?id=8987073&amp;action=edit" title="Bug 1469916 - use principals in webbrowserpersist code, r?ckerschb,jkt">[details]</a></span>
<a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - SameSite Cookies leakage via &quot;Save Page As...&quot;"
   href="/show_bug.cgi?id=1469916">Bug 1469916</a> - use principals in webbrowserpersist code, r?ckerschb,jkt

Christoph Kerschbaumer [:ckerschb] has approved the revision.

<a rel="nofollow" href="https://phabricator.services.mozilla.com/D1766">https://phabricator.services.mozilla.com/D1766</a></pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8987073&amp;action=edit"
           title="Bug 1469916 - use principals in webbrowserpersist code, r?ckerschb,jkt"
           class=""
        >Attachment #8987073</a> -
        Flags: review+</div></div></div><div class="change-set" id="c21"><div class="comment" data-id="13438196" data-no="21"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-21" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_363267" id="a487521_363267"><img src="https://secure.gravatar.com/avatar/72977b89c86da4a19d3cf1d5920ea341?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_363267" id="a487521_363267"><a class="email " href="/user_profile?user_id=363267" > <span class="fna">Christoph Kerschbaumer [:ckerschb]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-21"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-21" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#c21">Comment 21</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-29 08:18 PDT" data-time="1530285513">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-21">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-21" data-comment-id="13438196">Comment on <span class=""><a href="/attachment.cgi?id=8987073" name="attach_8987073" title="Bug 1469916 - use principals in webbrowserpersist code, r?ckerschb,jkt">attachment 8987073</a> <a href="/attachment.cgi?id=8987073&amp;action=edit" title="Bug 1469916 - use principals in webbrowserpersist code, r?ckerschb,jkt">[details]</a></span>
<a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - SameSite Cookies leakage via &quot;Save Page As...&quot;"
   href="/show_bug.cgi?id=1469916">Bug 1469916</a> - use principals in webbrowserpersist code, r?ckerschb,jkt

Phabricator and bugzilla r+ ;-)</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8987073&amp;action=edit"
           title="Bug 1469916 - use principals in webbrowserpersist code, r?ckerschb,jkt"
           class=""
        >Attachment #8987073</a> -
        Flags: review?(ckerschb) &rarr; review+</div></div></div><div class="change-set" id="c22"><div class="comment" data-id="13442965" data-no="22"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-22" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_600971" id="a487521_363267"><img src="https://secure.gravatar.com/avatar/a088418052679d9583556d277e6774ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_600971" id="a487521_363267"><a class="email " href="/user_profile?user_id=600971" > <span class="fna">Phabricator Automation</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-22"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-22" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#c22">Comment 22</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-07-02 03:31 PDT" data-time="1530527493">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-22">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-22" data-comment-id="13442965">Comment on <span class=""><a href="/attachment.cgi?id=8987073" name="attach_8987073" title="Bug 1469916 - use principals in webbrowserpersist code, r?ckerschb,jkt">attachment 8987073</a> <a href="/attachment.cgi?id=8987073&amp;action=edit" title="Bug 1469916 - use principals in webbrowserpersist code, r?ckerschb,jkt">[details]</a></span>
<a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - SameSite Cookies leakage via &quot;Save Page As...&quot;"
   href="/show_bug.cgi?id=1469916">Bug 1469916</a> - use principals in webbrowserpersist code, r?ckerschb,jkt

Jonathan Kingston [:jkt] has approved the revision.

<a rel="nofollow" href="https://phabricator.services.mozilla.com/D1766">https://phabricator.services.mozilla.com/D1766</a></pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8987073&amp;action=edit"
           title="Bug 1469916 - use principals in webbrowserpersist code, r?ckerschb,jkt"
           class=""
        >Attachment #8987073</a> -
        Flags: review+</div></div></div><div class="change-set" id="a1051230_159069"><div class="change" id="aa1051230_159069">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a1051230_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_159069" id="a1051230_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1051230_159069"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1051230_159069">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#a1051230_159069">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-07-02 13:44 PDT" data-time="1530564268">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8987073&amp;action=edit"
           title="Bug 1469916 - use principals in webbrowserpersist code, r?ckerschb,jkt"
           class=""
        >Attachment #8987073</a> -
        Flags: <span class="activity-deleted">review?(jkt)</span></div></div></div><div class="change-set" id="c23"><div class="comment" data-id="13445951" data-no="23"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-23" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a1051230_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a1051230_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-23"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-23" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#c23">Comment 23</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-07-03 06:57 PDT" data-time="1530626222">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-23">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-23" data-comment-id="13445951"><a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/be11a32900298eb6fd4d18ad21b9a699995254c3">https://hg.mozilla.org/integration/mozilla-inbound/rev/be11a32900298eb6fd4d18ad21b9a699995254c3</a></pre></div><div class="change-set" id="c24"><div class="comment" data-id="13445995" data-no="24"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-24" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a1051230_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a1051230_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-24"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-24" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#c24">Comment 24</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-07-03 07:14 PDT" data-time="1530627244">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-24">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-24" data-comment-id="13445995">Filed <a class="bz_bug_link
          bz_status_NEW"
   title="NEW - Remove &quot;force sending cookies&quot; flag"
   href="/show_bug.cgi?id=1473012">bug 1473012</a> to remove the cookie forcing flags from docshell/webnavigation, and <a class="bz_bug_link
          bz_status_NEW"
   title="NEW - Cookies code should pass mDocumentURI instead of mURI to ThirdPartyUtil third party checks"
   href="/show_bug.cgi?id=1473011">bug 1473011</a> to change the http/cookie code to use mDocumentURI.</pre></div><div class="change-set" id="c25"><div class="comment" data-id="13446865" data-no="25"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-25" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a1051230_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a1051230_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-25"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-25" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#c25">Comment 25</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-07-03 13:05 PDT" data-time="1530648350">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-25">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-25" data-comment-id="13446865">(In reply to :Gijs (he/him) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - SameSite Cookies leakage via &quot;Save Page As...&quot;"
   href="/show_bug.cgi?id=1469916#c23">comment #23</a>)
<span class="quote">&gt; <a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/">https://hg.mozilla.org/integration/mozilla-inbound/rev/</a>
&gt; be11a32900298eb6fd4d18ad21b9a699995254c3</span >

Backed out for orange in any tests that touched lightweight themes (forgot to update LWTManager which calls nsIWebBrowserPersist.saveURI() ) as well as browser_jsonview_save_json.js (which ended up trying to use a null principal in the parent for a blob URI created in the child for that null principal), and clean-up errors from the new tests that were windows only and seemed to be a race condition with deleting the temporarily-saved file created by the test. Fixed, pushed to try ( <a rel="nofollow" href="https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=1e4b3c5f27825008069bf58cd1e6d96db6e01c64">https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=1e4b3c5f27825008069bf58cd1e6d96db6e01c64</a> - green, except for the mochitest-plain-1 chunks that are from pre-existing orange from another cset on inbound - forgot to rebase onto m-c for the trypush).

Re-pushing:

<a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/9a2b02fe351bd65f6850a5c80b91dd0eec4a878a">https://hg.mozilla.org/integration/mozilla-inbound/rev/9a2b02fe351bd65f6850a5c80b91dd0eec4a878a</a>

Also, I think this will fix <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED WORKSFORME - File -&gt; Save Page As... from inside a container saves an out-of-container version"
   href="/show_bug.cgi?id=1463365">bug 1463365</a> so marking that as a dep.</pre><div class="activity"><div class="change">Blocks: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED WORKSFORME - File -&gt; Save Page As... from inside a container saves an out-of-container version"
   href="/show_bug.cgi?id=1463365">1463365</a></div></div></div><div class="change-set" id="a1135738_159069"><div class="change" id="aa1135738_159069">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a1135738_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_159069" id="a1135738_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1135738_159069"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1135738_159069">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#a1135738_159069">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-07-03 13:12 PDT" data-time="1530648776">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Blocks: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - &quot;Save as complete&quot; gives access to content from other domains"
   href="/show_bug.cgi?id=332676">332676</a></div></div></div><div class="change-set" id="c26"><div class="comment" data-id="13448127" data-no="26"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-26" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_258347" id="a1135738_159069"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_258347" id="a1135738_159069"><a class="email " href="/user_profile?user_id=258347" > <span class="fna">Sebastian Hengst [:aryx] (needinfo on intermittent or backout)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-26"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-26" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#c26">Comment 26</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-07-04 03:14 PDT" data-time="1530699291">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-26">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-26" data-comment-id="13448127"><a rel="nofollow" href="https://hg.mozilla.org/mozilla-central/rev/9a2b02fe351b">https://hg.mozilla.org/mozilla-central/rev/9a2b02fe351b</a></pre><div class="activity"><div class="change">Group: dom-core-security &rarr; core-security-release</div><div class="change">Status: ASSIGNED &rarr; RESOLVED</div><div class="change">Closed: <span class="rel-time" title="2018-07-04 03:14 PDT" data-time="1530699291">3 years ago</span></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox63&amp;o1=isnotempty">status-firefox63</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox63&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">Resolution: --- &rarr; FIXED</div><div class="change">Target Milestone: --- &rarr; mozilla63</div></div></div><div class="change-set" id="a1193425_159069"><div class="change" id="aa1193425_159069">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a1193425_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_159069" id="a1193425_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1193425_159069"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1193425_159069">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#a1193425_159069">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-07-04 05:14 PDT" data-time="1530706463">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_NEW"
   title="NEW - Use resource: or other non-system principal for saving blobs of pretty-printed data from json viewer"
   href="/show_bug.cgi?id=1473285">1473285</a></div></div></div><div class="change-set" id="c27"><div class="comment" data-id="13449822" data-no="27"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-27" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_534567" id="a1193425_159069"><img src="https://secure.gravatar.com/avatar/30ed3b0b86b55506949fb1eca087ed71?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_534567" id="a1193425_159069"><a class="email " href="/user_profile?user_id=534567" > <span class="fna">1lastBr3ath</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-27"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-27" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#c27">Comment 27</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-07-04 23:30 PDT" data-time="1530772257">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-27">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-27" data-comment-id="13449822">Is this eligible for bounty? And CVE?</pre></div><div class="change-set" id="a1268939_560431"><div class="change" id="aa1268939_560431">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_560431" id="a1268939_560431"><img src="https://secure.gravatar.com/avatar/1c26d49ffb62a4106644da39c7e6fb4c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_560431" id="a1268939_560431"><a class="email " href="/user_profile?user_id=560431" > <span class="fna">Calixte Denizet (:calixte)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1268939_560431"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1268939_560431">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#a1268939_560431">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-07-05 02:12 PDT" data-time="1530781977">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Crash in nsILoadInfo::GetOriginAttributes"
   href="/show_bug.cgi?id=1473507">1473507</a></div></div></div><div class="change-set" id="a1269122_560431"><div class="change" id="aa1269122_560431">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_560431" id="a1269122_560431"><img src="https://secure.gravatar.com/avatar/1c26d49ffb62a4106644da39c7e6fb4c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_560431" id="a1269122_560431"><a class="email " href="/user_profile?user_id=560431" > <span class="fna">Calixte Denizet (:calixte)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1269122_560431"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1269122_560431">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#a1269122_560431">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-07-05 02:16 PDT" data-time="1530782160">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Crash in InvalidArrayIndex_CRASH | nsTArray_Impl&lt;T&gt;::operator[] | nsWebBrowserPersist::SerializeNextFile"
   href="/show_bug.cgi?id=1473509">1473509</a></div></div></div><div class="change-set" id="c28"><div class="comment" data-id="13461862" data-no="28"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-28" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a1269122_560431"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a1269122_560431"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-28"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-28" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#c28">Comment 28</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-07-10 18:51 PDT" data-time="1531273893">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-28">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-28" data-comment-id="13461862">Gijs, I assume we want to let this ride the trains? :)

(In reply to 1lastBr3ath from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - SameSite Cookies leakage via &quot;Save Page As...&quot;"
   href="/show_bug.cgi?id=1469916#c27">comment #27</a>)
<span class="quote">&gt; Is this eligible for bounty? And CVE?</span >

If you want to nominate this bug for bounty consideration, please follow the directions from the page below:
<a rel="nofollow" href="https://www.mozilla.org/security/client-bug-bounty/">https://www.mozilla.org/security/client-bug-bounty/</a></pre><div class="activity"><div class="change">Flags: needinfo?(gijskruitbosch+bugs)</div></div></div><div class="change-set" id="c29"><div class="comment" data-id="13462575" data-no="29"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-29" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a1269122_560431"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a1269122_560431"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-29"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-29" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#c29">Comment 29</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-07-11 01:40 PDT" data-time="1531298422">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-29">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-29" data-comment-id="13462575">(In reply to Ryan VanderMeulen [:RyanVM] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - SameSite Cookies leakage via &quot;Save Page As...&quot;"
   href="/show_bug.cgi?id=1469916#c28">comment #28</a>)
<span class="quote">&gt; Gijs, I assume we want to let this ride the trains? :)</span >

Yeah, there was enough fallout (that should be fixed now...) which didn't trigger any unittest failures, and it's a big enough patch, that I'd be pretty wary of uplifting this, esp. given it's sec-low.

I could be convinced about taking a roll-up of all of this on ESR as a correctness fix once this has made it to release without incidents. I *think* I set the flags right for this, let me know if you need anything else for that.</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox61&amp;o1=isnotempty">status-firefox61</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox61&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox62&amp;o1=isnotempty">status-firefox62</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox62&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr52&amp;o1=isnotempty">status-firefox-esr52</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr52&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr60&amp;o1=isnotempty">status-firefox-esr60</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr60&amp;o1=equals&amp;v1=fix-optional">fix-optional</a></div><div class="change">Flags: needinfo?(gijskruitbosch+bugs) &rarr; needinfo?(ryanvm)</div></div></div><div class="change-set" id="c30"><div class="comment" data-id="13462819" data-no="30"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-30" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_534567" id="a1269122_560431"><img src="https://secure.gravatar.com/avatar/30ed3b0b86b55506949fb1eca087ed71?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_534567" id="a1269122_560431"><a class="email " href="/user_profile?user_id=534567" > <span class="fna">1lastBr3ath</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-30"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-30" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#c30">Comment 30</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-07-11 03:44 PDT" data-time="1531305878">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-30">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-30" data-comment-id="13462819">I don't really understand what you guys are talking about. Should I assume that it's not eligible because it's sec-low?</pre></div><div class="change-set" id="c31"><div class="comment" data-id="13462982" data-no="31"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-31" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a1269122_560431"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a1269122_560431"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-31"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-31" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#c31">Comment 31</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-07-11 05:41 PDT" data-time="1531312863">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-31">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-31" data-comment-id="13462982">(In reply to :Gijs (he/him) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - SameSite Cookies leakage via &quot;Save Page As...&quot;"
   href="/show_bug.cgi?id=1469916#c29">comment #29</a>)
<span class="quote">&gt; I could be convinced about taking a roll-up of all of this on ESR as a
&gt; correctness fix once this has made it to release without incidents. I
&gt; *think* I set the flags right for this, let me know if you need anything
&gt; else for that.</span >

Yes, fix-optional will keep it on the radar.

(In reply to 1lastBr3ath from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - SameSite Cookies leakage via &quot;Save Page As...&quot;"
   href="/show_bug.cgi?id=1469916#c30">comment #30</a>)
<span class="quote">&gt; I don't really understand what you guys are talking about. Should I assume
&gt; that it's not eligible because it's sec-low?</span >

That's not a decision Gijs or myself makes. Follow the directions linked from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - SameSite Cookies leakage via &quot;Save Page As...&quot;"
   href="/show_bug.cgi?id=1469916#c28">comment 28</a> if you want bounty consideration.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(ryanvm)</span></div></div></div><div class="change-set" id="a1897297_1689"><div class="change" id="aa1897297_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a1897297_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a1897297_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1897297_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1897297_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#a1897297_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-07-12 08:45 PDT" data-time="1531410335">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: sec-bounty?</div></div></div><div class="change-set" id="a3169443_488993"><div class="change" id="aa3169443_488993">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_488993" id="a3169443_488993"><img src="https://secure.gravatar.com/avatar/42f2a9436bbaefa7e0028e214f2b9350?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_488993" id="a3169443_488993"><a class="email " href="/user_profile?user_id=488993" > <span class="fna">Andrei Vaida [:avaida]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a3169443_488993"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a3169443_488993">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#a3169443_488993">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-07-27 02:08 PDT" data-time="1532682481">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: qe-verify+</div><div class="change">Whiteboard: [domsecurity-active] &rarr; [domsecurity-active][post-critsmash-triage]</div></div></div><div class="change-set" id="c32"><div class="comment" data-id="13510909" data-no="32"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-32" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a3169443_488993"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a3169443_488993"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-32"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-32" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#c32">Comment 32</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-07-30 10:17 PDT" data-time="1532971056">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-32">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-32" data-comment-id="13510909">Does not meet the severity requirements for the bug bounty.</pre><div class="activity"><div class="change">Flags: sec-bounty? &rarr; sec-bounty-</div></div></div><div class="change-set" id="c33"><div class="comment" data-id="13518510" data-no="33"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-33" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_616174" id="a3169443_488993"><img src="https://secure.gravatar.com/avatar/16657a20d96588b511a6e731b5d91c3f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_616174" id="a3169443_488993"><a class="email disabled" href="/user_profile?user_id=616174" > <span class="fna">Cristian Craciun</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-33"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-33" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#c33">Comment 33</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-08-02 07:11 PDT" data-time="1533219090">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-33">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-33" data-comment-id="13518510">Hello, 

I'm the QA assigned to verify this issue and I've encountered some difficulties when trying to test it. I've followed the steps from the description but I don't have any information written in the request.log file even though I've made the file writable. 

Could you please provide some extra information regarding the STR or can you aid into verifying the fix?</pre><div class="activity"><div class="change">Flags: needinfo?(prakashsharma97)</div></div></div><div class="change-set" id="c34"><div class="comment" data-id="13523328" data-no="34"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-34" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_534567" id="a3169443_488993"><img src="https://secure.gravatar.com/avatar/30ed3b0b86b55506949fb1eca087ed71?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_534567" id="a3169443_488993"><a class="email " href="/user_profile?user_id=534567" > <span class="fna">1lastBr3ath</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-34"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-34" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#c34">Comment 34</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-08-05 02:33 PDT" data-time="1533461591">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-34">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-34" data-comment-id="13523328">Hi,
I'm not sure why it wouldn't work. Are you using same Firefox that I and others used? If not, probably, it's already fixed.
Or can you please check your server log for any errors? Or you can also use requestbin (<a rel="nofollow" href="https://requestbin.fullcontact.com/">https://requestbin.fullcontact.com/</a>) to log requests and see if it gets the cookies or receives any requests at all.

Let me know if you need any further help.
Thanks,
Prakash</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(prakashsharma97)</span></div></div></div><div class="change-set" id="c35"><div class="comment" data-id="13664072" data-no="35"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-35" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a3169443_488993"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a3169443_488993"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-35"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-35" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#c35">Comment 35</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-10-04 19:14 PDT" data-time="1538705668">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-35">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-35" data-comment-id="13664072">Did you want to consider taking this for ESR 60.3 or wait until the 60.4 cycle?</pre><div class="activity"><div class="change">Flags: needinfo?(gijskruitbosch+bugs)</div></div></div><div class="change-set" id="c36"><div class="comment" data-id="13664513" data-no="36"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-36" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a3169443_488993"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a3169443_488993"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-36"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-36" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#c36">Comment 36</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-10-05 03:06 PDT" data-time="1538733991">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-36">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-36" data-comment-id="13664513">(In reply to Ryan VanderMeulen [:RyanVM] from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - SameSite Cookies leakage via &quot;Save Page As...&quot;"
   href="/show_bug.cgi?id=1469916#c35">comment #35</a>)
<span class="quote">&gt; Did you want to consider taking this for ESR 60.3 or wait until the 60.4
&gt; cycle?</span >

Hm. Let's wait for now. Note that the dep tree of this bug is significant, we'd want to land this + <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Crash in InvalidArrayIndex_CRASH | nsTArray_Impl&lt;T&gt;::operator[] | nsWebBrowserPersist::SerializeNextFile"
   href="/show_bug.cgi?id=1473509">bug 1473509</a> + <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Crash in nsILoadInfo::GetOriginAttributes"
   href="/show_bug.cgi?id=1473507">bug 1473507</a> + <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - [macOS] Drag and drop images saves 0kb file"
   href="/show_bug.cgi?id=1487263">bug 1487263</a></pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(gijskruitbosch+bugs)</span></div><div class="change">QA Contact: ckerschb</div></div></div><div class="change-set" id="c37"><div class="comment" data-id="13664966" data-no="37"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-37" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_588744" id="a3169443_488993"><img src="https://secure.gravatar.com/avatar/8641c9f2c9af8263df2208974cf26aab?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_588744" id="a3169443_488993"><a class="email " href="/user_profile?user_id=588744" > <span class="fna">Emil Ghitta, QA [:emilghitta]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-37"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-37" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#c37">Comment 37</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-10-05 07:05 PDT" data-time="1538748335">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-37">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-37" data-comment-id="13664966">Hi 1lastBr3ath,

We didn't managed to reproduce this issue (in order to confirm if this is fixed or not). Could you help us by confirming that this is fixed using Firefox beta 63 ? 

Thank you!</pre><div class="activity"><div class="change">Flags: needinfo?(prakashsharma97)</div></div></div><div class="change-set" id="a10306466_280903"><div class="change" id="aa10306466_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a10306466_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a10306466_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a10306466_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a10306466_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#a10306466_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-10-17 16:38 PDT" data-time="1539819504">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: [domsecurity-active][post-critsmash-triage] &rarr; [domsecurity-active][post-critsmash-triage][adv-main63+]</div></div></div><div class="change-set" id="a10373355_280903"><div class="change" id="aa10373355_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a10373355_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a10373355_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a10373355_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a10373355_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#a10373355_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-10-18 11:13 PDT" data-time="1539886393">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Alias: CVE-2018-12402</div></div></div><div class="change-set" id="c38"><div class="comment" data-id="13697947" data-no="38"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-38" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_534567" id="a10373355_280903"><img src="https://secure.gravatar.com/avatar/30ed3b0b86b55506949fb1eca087ed71?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_534567" id="a10373355_280903"><a class="email " href="/user_profile?user_id=534567" > <span class="fna">1lastBr3ath</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-38"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-38" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#c38">Comment 38</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-10-18 19:00 PDT" data-time="1539914403">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-38">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-38" data-comment-id="13697947">Yeah, I cannot reproduce it either, must have been fixed. Tested and verified on Windows 10, Firefox 63.0 beta.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(prakashsharma97)</span></div></div></div><div class="change-set" id="c39"><div class="comment" data-id="13698438" data-no="39"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-39" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a10373355_280903"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a10373355_280903"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-39"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-39" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#c39">Comment 39</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-10-19 02:17 PDT" data-time="1539940621">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-39">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-39" data-comment-id="13698438">Marking verified per <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - SameSite Cookies leakage via &quot;Save Page As...&quot;"
   href="/show_bug.cgi?id=1469916#c38">comment #38</a>.</pre><div class="activity"><div class="change">Status: RESOLVED &rarr; VERIFIED</div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox63&amp;o1=isnotempty">status-firefox63</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox63&amp;o1=equals&amp;v1=fixed">fixed</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox63&amp;o1=equals&amp;v1=verified">verified</a></div></div></div><div class="change-set" id="a11064023_14534"><div class="change" id="aa11064023_14534">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14534" id="a11064023_14534"><img src="https://secure.gravatar.com/avatar/e5f97d33683797ab997351993a109030?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_14534" id="a11064023_14534"><a class="email " href="/user_profile?user_id=14534" > <span class="fna">Matthias Versen [:Matti]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a11064023_14534"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a11064023_14534">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#a11064023_14534">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-10-26 11:04 PDT" data-time="1540577061">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Blocks: <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - save pdf issue with pdf viewer"
   href="/show_bug.cgi?id=1502448">1502448</a></div></div></div><div class="change-set" id="a12018422_1689"><div class="change" id="aa12018422_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a12018422_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a12018422_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a12018422_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a12018422_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#a12018422_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-11-06 11:11 PST" data-time="1541531460">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - &quot;Save Image As..&quot; doesn't work for mixed content images"
   href="/show_bug.cgi?id=1504159">1504159</a></div></div></div><div class="change-set" id="a12030169_1689"><div class="change" id="aa12030169_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a12030169_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a12030169_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a12030169_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a12030169_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#a12030169_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-11-06 14:26 PST" data-time="1541543207">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Blocks: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Saving web page embedding file: resources allows accessing SMB resources"
   href="/show_bug.cgi?id=1447087">1447087</a></div></div></div><div class="change-set" id="a12069458_24572"><div class="change" id="aa12069458_24572">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_24572" id="a12069458_24572"><img src="https://secure.gravatar.com/avatar/5293fe8fb106a442d842757758d07c56?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_24572" id="a12069458_24572"><a class="email " href="/user_profile?user_id=24572" > <span class="fna">Pascal Chevrel:pascalc (pto until November 2)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a12069458_24572"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a12069458_24572">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#a12069458_24572">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-11-07 01:21 PST" data-time="1541582496">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE - Image saved in toutiao.com failed"
   href="/show_bug.cgi?id=1504609">1504609</a></div></div></div><div class="change-set" id="a12075903_159069"><div class="change" id="aa12075903_159069">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a12075903_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_159069" id="a12075903_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a12075903_159069"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a12075903_159069">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#a12075903_159069">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-11-07 03:09 PST" data-time="1541588941">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">No longer depends on: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE - Image saved in toutiao.com failed"
   href="/show_bug.cgi?id=1504609">1504609</a></div></div></div><div class="change-set" id="a12078151_588744"><div class="change" id="aa12078151_588744">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_588744" id="a12078151_588744"><img src="https://secure.gravatar.com/avatar/8641c9f2c9af8263df2208974cf26aab?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_588744" id="a12078151_588744"><a class="email " href="/user_profile?user_id=588744" > <span class="fna">Emil Ghitta, QA [:emilghitta]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a12078151_588744"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a12078151_588744">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#a12078151_588744">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-11-07 03:46 PST" data-time="1541591189">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: <span class="activity-deleted">qe-verify+</span></div></div></div><div class="change-set" id="c40"><div class="comment" data-id="13779596" data-no="40"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-40" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_451704" id="a12078151_588744"><img src="https://secure.gravatar.com/avatar/6168ea97fda0cefa449331e59b24e8f7?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_451704" id="a12078151_588744"><a class="email " href="/user_profile?user_id=451704" > <span class="fna">Liz Henry (:lizzard Please n-i to RyanVM, jcristau, or pascal)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-40"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-40" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#c40">Comment 40</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-11-26 10:32 PST" data-time="1543257169">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-40">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-40" data-comment-id="13779596">I'd rather let this wait for the next major ESR. Unless someone wants to argue strongly for taking all these patches from here and the ones mentioned in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - SameSite Cookies leakage via &quot;Save Page As...&quot;"
   href="/show_bug.cgi?id=1469916#c36">comment 36</a> for ESR 60.4.0.</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr60&amp;o1=isnotempty">status-firefox-esr60</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox_esr60&amp;o1=equals&amp;v1=fix-optional">fix-optional</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr60&amp;o1=equals&amp;v1=wontfix">wontfix</a></div></div></div><div class="change-set" id="a16934361_474980"><div class="change" id="aa16934361_474980">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_474980" id="a16934361_474980"><img src="https://secure.gravatar.com/avatar/dfcd4ae2df9a810044e19c011304881e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_474980" id="a16934361_474980"><a class="email " href="/user_profile?user_id=474980" > <span class="fna">Arthur Edelstein [:arthur]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a16934361_474980"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a16934361_474980">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#a16934361_474980">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-01-02 08:43 PST" data-time="1546447399">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: [domsecurity-active][post-critsmash-triage][adv-main63+] &rarr; [domsecurity-active][post-critsmash-triage][adv-main63+][tor 22343]</div></div></div><div class="change-set" id="a38931964_176914"><div class="change" id="aa38931964_176914">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a38931964_176914"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_176914" id="a38931964_176914"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a38931964_176914"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a38931964_176914">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#a38931964_176914">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-09-14 00:10 PDT" data-time="1568445002">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Regressions: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Unable to change Photo in Address Book New Contact dialog"
   href="/show_bug.cgi?id=1581253">1581253</a></div></div></div><div class="change-set" id="a38973046_159069"><div class="change" id="aa38973046_159069">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a38973046_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_159069" id="a38973046_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a38973046_159069"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a38973046_159069">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#a38973046_159069">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-09-14 11:34 PDT" data-time="1568486084">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Regressions: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Dragging a photo onto an address book card doesn't work any more in TB 65 and trunk"
   href="/show_bug.cgi?id=1519732">1519732</a></div></div></div><div class="change-set" id="c41"><div class="comment" data-id="14361522" data-no="41"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-41" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a38973046_159069"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a38973046_159069"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-41"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-41" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#c41">Comment 41</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-09-14 14:42 PDT" data-time="1568497369">2 years ago</span>
          </div>&bull;
<div class="change-revisions">
  <a href="/page.cgi?id=comment-revisions.html&amp;bug_id=1469916&amp;comment_id=14361522"
     title="1 revision">Edited</a>
</div>
        </td>
      </tr>

      <tr id="ctag-41">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-41" data-comment-id="14361522" data-ismarkdown="true" ><p><del>Gijs, did you mean to remove bug 1581253 from the list of regressions? You took off bug 1519732 which was certainly caused here.</del><br>
EDIT: Scrap that, you did add <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1519732" title="RESOLVED FIXED - Dragging a photo onto an address book card doesn&#39;t work any more in TB 65 and trunk">bug 1519732</a>, but it&#39;s crossed out since we fixed it. Sorry about the noise.</p>
</div></div><div class="change-set" id="c42"><div class="comment" data-id="14361933" data-no="42"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-42" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a38973046_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a38973046_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-42"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-42" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#c42">Comment 42</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-09-15 13:36 PDT" data-time="1568579761">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-42">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-42" data-comment-id="14361933" data-ismarkdown="true" ><p>(In reply to Jorg K (GMT+2) (reduced availability 14-19 of Sept.) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1469916#c41" title="VERIFIED FIXED - SameSite Cookies leakage via &quot;Save Page As...&quot;">comment #41</a>)</p>
<blockquote>
<p><del>Gijs, did you mean to remove bug 1581253 from the list of regressions? You took off bug 1519732 which was certainly caused here.</del><br>
EDIT: Scrap that, you did add <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1519732" title="RESOLVED FIXED - Dragging a photo onto an address book card doesn&#39;t work any more in TB 65 and trunk">bug 1519732</a>, but it&#39;s crossed out since we fixed it. Sorry about the noise.</p>
</blockquote>
<p>Indeed, though I now think it&#39;s sufficiently clear that though the dialog in question was broken earlier by this bug (which is/was filed and fixed in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1519732" title="RESOLVED FIXED - Dragging a photo onto an address book card doesn&#39;t work any more in TB 65 and trunk">bug 1519732</a>), the new incarnation was not in fact a regression from this bug, so I&#39;m going to remove the newer bug after all. :-)</p>
</div><div class="activity"><div class="change">No longer regressions: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Unable to change Photo in Address Book New Contact dialog"
   href="/show_bug.cgi?id=1581253">1581253</a></div></div></div><div class="change-set" id="a52390562_1689"><div class="change" id="aa52390562_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a52390562_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a52390562_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a52390562_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a52390562_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#a52390562_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-02-16 17:40 PST" data-time="1581903600">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: <span class="activity-deleted">core-security-release</span></div></div></div><div class="change-set" id="a60858476_578488"><div class="change" id="aa60858476_578488">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_578488" id="a60858476_578488"><img src="https://secure.gravatar.com/avatar/6822db445808be789b12cfae22d118dc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_578488" id="a60858476_578488"><a class="email " href="/user_profile?user_id=578488" > <span class="fna">Tom Ritter [:tjr] (ni? for response to CVE/sec-approval/advisories/etc)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a60858476_578488"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a60858476_578488">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1469916#a60858476_578488">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-05-24 18:51 PDT" data-time="1590371514">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: sec-bounty-hof+</div></div></div><div id="new-comment-notice">
          You need to <a href="/show_bug.cgi?id=1469916&amp;GoAheadAndLogIn=1">log in</a>
          before you can comment on or make changes to this bug.
        </div>



<div id="bottom-actions">
  <div id="bottom-right-actions">
    <button type="button" id="top-btn" class="secondary" aria-label="Go to Page Top">Top &uarr;</button>
  </div>
</div></div> 
</main> 
</div> 


</body>
</html>