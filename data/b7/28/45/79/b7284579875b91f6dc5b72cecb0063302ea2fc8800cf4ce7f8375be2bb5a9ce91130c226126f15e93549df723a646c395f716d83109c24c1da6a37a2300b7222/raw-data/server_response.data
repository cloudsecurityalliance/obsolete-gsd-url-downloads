<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="UTF-8">
<meta property="og:type" content="website">
<meta property="og:title" content="1064670 - (CVE-2014-1569) ASN.1 DER decoding of lengths is too permissive, allowing undetected smuggling of arbitrary data">
<meta property="og:url" content="https://bugzilla.mozilla.org/show_bug.cgi?id=1064670">
<meta property="og:description"
      content="RESOLVED (jc) in NSS - Libraries. Last updated 2020-05-24.">
<meta name="twitter:label1" value="Type">
<meta name="twitter:data1" value="defect">
<meta name="twitter:label2" value="Priority">
<meta name="twitter:data2" value="--">

    <meta name="viewport" content="width=1024">
    <meta name="color-scheme" content="dark light">
    <meta name="generator" content="Bugzilla 20211025.1">
    <meta name="bugzilla-global" content="dummy"
        id="bugzilla-global" data-bugzilla="{&quot;api_token&quot;:&quot;&quot;,&quot;config&quot;:{&quot;basepath&quot;:&quot;\/&quot;},&quot;constant&quot;:{&quot;COMMENT_COLS&quot;:80},&quot;param&quot;:{&quot;maxattachmentsize&quot;:&quot;10240&quot;,&quot;maxusermatches&quot;:&quot;50&quot;,&quot;splinter_base&quot;:&quot;\/page.cgi?id=splinter.html&amp;ignore=\/&quot;},&quot;string&quot;:{&quot;bug_type_required&quot;:&quot;You must select a Type for this bug&quot;,&quot;component_required&quot;:&quot;You must select a Component for this bug&quot;,&quot;description_required&quot;:&quot;You must enter a Description for this bug&quot;,&quot;short_desc_required&quot;:&quot;You must enter a Summary for this bug&quot;,&quot;version_required&quot;:&quot;You must select a Version for this bug&quot;},&quot;user&quot;:{&quot;is_new&quot;:1,&quot;login&quot;:&quot;&quot;}}">
    <title>1064670 - (CVE-2014-1569) ASN.1 DER decoding of lengths is too permissive, allowing undetected smuggling of arbitrary data</title>

<link rel="Top" href="/">

  


  
    <link rel="Show" title="Dependency Tree"
          href="/showdependencytree.cgi?id=1064670&amp;hide_resolved=1">
      <link rel="Show" title="Dependency Graph"
            href="/showdependencygraph.cgi?id=1064670">

      <link rel="Show" title="Bug Activity"
            href="/show_activity.cgi?id=1064670">

<link href="/static/v20211025.1/skins/yui.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/standard/global.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BugModal/web/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BMO/web/styles/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/EditComments/web/styles/inline-editor.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-structure-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-theme-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/lib/prism.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Needinfo/web/styles/needinfo.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Review/web/styles/badge.css" rel="stylesheet" type="text/css">



    
<script nonce="Pf1g8uCTYRz8dsx4EJ6NZqjr9Js34gjillJKw6UKMscwZQcK" src="/static/v20211025.1/js/jquery/jquery-min.js"></script><script nonce="Pf1g8uCTYRz8dsx4EJ6NZqjr9Js34gjillJKw6UKMscwZQcK" src="/static/v20211025.1/js/jquery/ui/jquery-ui-min.js"></script><script nonce="Pf1g8uCTYRz8dsx4EJ6NZqjr9Js34gjillJKw6UKMscwZQcK" src="/static/v20211025.1/js/yui.js"></script><script nonce="Pf1g8uCTYRz8dsx4EJ6NZqjr9Js34gjillJKw6UKMscwZQcK" src="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu-min.js"></script><script nonce="Pf1g8uCTYRz8dsx4EJ6NZqjr9Js34gjillJKw6UKMscwZQcK" src="/static/v20211025.1/js/jquery/plugins/devbridgeAutocomplete/devbridgeAutocomplete-min.js"></script><script nonce="Pf1g8uCTYRz8dsx4EJ6NZqjr9Js34gjillJKw6UKMscwZQcK" src="/static/v20211025.1/js/global.js"></script><script nonce="Pf1g8uCTYRz8dsx4EJ6NZqjr9Js34gjillJKw6UKMscwZQcK" src="/static/v20211025.1/js/util.js"></script><script nonce="Pf1g8uCTYRz8dsx4EJ6NZqjr9Js34gjillJKw6UKMscwZQcK" src="/static/v20211025.1/js/dropdown.js"></script>

      <script nonce="Pf1g8uCTYRz8dsx4EJ6NZqjr9Js34gjillJKw6UKMscwZQcK">
          YAHOO.namespace('bugzilla');
          if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
              YAHOO.util.Event._simpleRemove(window, "unload",
                                             YAHOO.util.Event._unload);
          }BUGZILLA.value_descs = JSON.parse('{\"bug_status\":{},\"resolution\":{\"\":\"---\"}}');

  
    var tracking_flags_str = "{\"comments\":{\"cf_tracking_firefox36\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr78\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox93\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox34\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox35\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox94\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox33\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox95\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_relnote\":{\"?\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox_sumo\":{\"none-needed\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox32\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr91\":{\"?\":\"[Tracking Requested - why for this release]:\"}},\"flags\":{\"project\":{\"cf_tracking_firefox_sumo\":\"---\",\"cf_fission_milestone\":\"---\",\"cf_root_cause\":\"---\"},\"tracking\":{\"cf_tracking_firefox94\":\"---\",\"cf_status_firefox37\":\"fixed\",\"cf_tracking_firefox32\":\"+\",\"cf_status_firefox_esr78\":\"---\",\"cf_tracking_firefox_esr91\":\"---\",\"cf_tracking_firefox_esr78\":\"---\",\"cf_tracking_firefox36\":\"+\",\"cf_status_firefox94\":\"---\",\"cf_status_firefox34\":\"wontfix\",\"cf_tracking_firefox93\":\"---\",\"cf_tracking_firefox35\":\"+\",\"cf_status_b2g_1_4\":\"wontfix\",\"cf_status_firefox93\":\"---\",\"cf_status_firefox35\":\"wontfix\",\"cf_tracking_firefox33\":\"+\",\"cf_tracking_firefox_relnote\":\"---\",\"cf_tracking_firefox95\":\"---\",\"cf_status_b2g_2_2\":\"fixed\",\"cf_status_b2g_2_0\":\"affected\",\"cf_status_b2g_2_1_s\":\"affected\",\"cf_status_firefox95\":\"---\",\"cf_status_firefox33\":\"wontfix\",\"cf_status_b2g_2_1\":\"affected\",\"cf_status_b2g_2_0m\":\"affected\",\"cf_status_firefox_esr31\":\"affected\",\"cf_status_firefox36\":\"fixed\",\"cf_status_firefox32\":\"wontfix\",\"cf_tracking_firefox34\":\"+\",\"cf_status_firefox_esr91\":\"---\"}},\"types\":[\"tracking\"]}";
    var TrackingFlags = $.parseJSON(tracking_flags_str);

  

  
  BUGZILLA.bug_id = 1064670;
  BUGZILLA.bug_title = '1064670 - (CVE-2014-1569) ASN.1 DER decoding of lengths is too permissive, allowing undetected smuggling of arbitrary data';
  BUGZILLA.bug_summary = 'ASN.1 DER decoding of lengths is too permissive, allowing undetected smuggling of arbitrary data';
  BUGZILLA.bug_url = 'https:\/\/bugzilla.mozilla.org\/show_bug.cgi?id=1064670';
  BUGZILLA.bug_keywords = 'sec-critical',
  BUGZILLA.user = {
    id: 0,
    login: '',
    is_insider: false,
    is_timetracker: false,
    can_tag: false,
    timezone: 'America\/Los_Angeles',
    settings: {
      quote_replies: 'quoted_reply',
      zoom_textareas: true,
      remember_collapsed: true,
      inline_attachments: true,
      autosize_comments: false
    }
  };

  BUGZILLA.bug_secure = false;
      </script>
<script nonce="Pf1g8uCTYRz8dsx4EJ6NZqjr9Js34gjillJKw6UKMscwZQcK" src="/static/v20211025.1/extensions/BugModal/web/autosize.min.js"></script><script nonce="Pf1g8uCTYRz8dsx4EJ6NZqjr9Js34gjillJKw6UKMscwZQcK" src="/static/v20211025.1/extensions/ProdCompSearch/web/js/prod_comp_search.js"></script><script nonce="Pf1g8uCTYRz8dsx4EJ6NZqjr9Js34gjillJKw6UKMscwZQcK" src="/static/v20211025.1/extensions/BugModal/web/bug_modal.js"></script><script nonce="Pf1g8uCTYRz8dsx4EJ6NZqjr9Js34gjillJKw6UKMscwZQcK" src="/static/v20211025.1/extensions/BugModal/web/comments.js"></script><script nonce="Pf1g8uCTYRz8dsx4EJ6NZqjr9Js34gjillJKw6UKMscwZQcK" src="/static/v20211025.1/extensions/ComponentWatching/web/js/overlay.js"></script><script nonce="Pf1g8uCTYRz8dsx4EJ6NZqjr9Js34gjillJKw6UKMscwZQcK" src="/static/v20211025.1/js/bugzilla-readable-status-min.js"></script><script nonce="Pf1g8uCTYRz8dsx4EJ6NZqjr9Js34gjillJKw6UKMscwZQcK" src="/static/v20211025.1/js/field.js"></script><script nonce="Pf1g8uCTYRz8dsx4EJ6NZqjr9Js34gjillJKw6UKMscwZQcK" src="/static/v20211025.1/js/comments.js"></script><script nonce="Pf1g8uCTYRz8dsx4EJ6NZqjr9Js34gjillJKw6UKMscwZQcK" src="/static/v20211025.1/extensions/TrackingFlags/web/js/flags.js"></script><script nonce="Pf1g8uCTYRz8dsx4EJ6NZqjr9Js34gjillJKw6UKMscwZQcK" src="/static/v20211025.1/extensions/BMO/web/js/firefox-crash-table.js"></script><script nonce="Pf1g8uCTYRz8dsx4EJ6NZqjr9Js34gjillJKw6UKMscwZQcK" src="/static/v20211025.1/extensions/MozChangeField/web/js/severity-s1-priority-p1.js"></script><script nonce="Pf1g8uCTYRz8dsx4EJ6NZqjr9Js34gjillJKw6UKMscwZQcK" src="/static/v20211025.1/extensions/MozChangeField/web/js/clear-tracking-priority-s1.js"></script><script nonce="Pf1g8uCTYRz8dsx4EJ6NZqjr9Js34gjillJKw6UKMscwZQcK" src="/static/v20211025.1/extensions/MozChangeField/web/js/set-tracking-severity-s1.js"></script><script nonce="Pf1g8uCTYRz8dsx4EJ6NZqjr9Js34gjillJKw6UKMscwZQcK" src="/static/v20211025.1/js/lib/prism.js"></script><script nonce="Pf1g8uCTYRz8dsx4EJ6NZqjr9Js34gjillJKw6UKMscwZQcK" src="/static/v20211025.1/extensions/GoogleAnalytics/web/js/analytics.js"></script><script nonce="Pf1g8uCTYRz8dsx4EJ6NZqjr9Js34gjillJKw6UKMscwZQcK" src="/static/v20211025.1/js/lib/md5.min.js"></script><script nonce="Pf1g8uCTYRz8dsx4EJ6NZqjr9Js34gjillJKw6UKMscwZQcK" src="/static/v20211025.1/extensions/Review/web/js/badge.js"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla@Mozilla" href="/search_plugin.cgi"><link rel="shortcut icon" href="/extensions/BMO/web/images/favicon.ico">
<link rel="canonical" href="https://bugzilla.mozilla.org/show_bug.cgi?id=1064670">
<link rel="shorturl" href="https://bugzilla.mozilla.org/1064670"><meta name="google-analytics" content="UA-36116321-3" data-location="https://bugzilla.mozilla.org/bug/show-modal" data-title="1064670 - (CVE-2014-1569) ASN.1 DER decoding of lengths is too permissive, allowing undetected smuggling of arbitrary data">
<script async src="https://www.google-analytics.com/analytics.js"></script><meta name="robots" content="noarchive">
  </head>



  <body
        class="bugzilla-mozilla-org
               skin-standard bug_modal yui-skin-sam">



<div id="wrapper">

<header id="header" role="banner">
  <div class="inner">
    <h1 id="header-title" class="title"><a href="https://bugzilla.mozilla.org/home" title="Go to home page">Bugzilla</a></h1>
    <form role="search" id="header-search" class="quicksearch" action="/buglist.cgi" data-no-csrf>
      <section class="searchbox-outer dropdown" role="combobox" aria-expanded="false" aria-haspopup="listbox"
               aria-labelledby="header-search-label" aria-owns="header-search-dropdown">
        <h2 id="header-search-label">Quick Search</h2>
        <span class="icon" aria-hidden="true"></span>
        <input role="searchbox" id="quicksearch_top" class="dropdown-button" name="quicksearch" autocomplete="off"
               value="" placeholder="Search Bugs"
               title="Enter a bug number or some search terms" aria-controls="header-search-dropdown"
               aria-label="Quick Search"><div id="header-search-dropdown" class="dropdown-content right" role="listbox" style="display: none;">
  <div id="header-search-dropdown-wrapper">
  </div>
</div>
      </section>
    </form>
    <nav id="header-nav">
      <ul class="links">
        <li class="link-browse">
          <a href="/describecomponents.cgi" title="Browse bugs by component">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Browse</span>
          </a>
        </li>
        <li class="link-search">
          <a href="/query.cgi?format=advanced" title="Search bugs using various criteria">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Advanced Search</span>
          </a>
        </li>
      </ul>
      <div class="dropdown">
        <button type="button" id="header-tools-menu-button" class="dropdown-button minor" title="More tools…"
                aria-label="More tools…" aria-expanded="false" aria-haspopup="true" aria-controls="header-tools-menu">
          <span class="icon" aria-hidden="true"></span>
        </button>
        <ul class="dropdown-content left" id="header-tools-menu" role="menu" style="display:none;">
          <li role="presentation">
            <a href="/report.cgi" role="menuitem" tabindex="-1">Reports</a>
          </li>
            <li role="separator"></li>
            <li role="presentation">
              <a href="https://bmo.readthedocs.io/en/latest/" role="menuitem" tabindex="-1">Documentation</a>
            </li>
        </ul>
      </div>
    </nav>
      <ul id="header-login" class="links">
          <li id="moz_new_account_container_top"><a href="/createaccount.cgi">New Account</a></li><li id="mini_login_container_top">
  <a id="login_link_top" href="/index.cgi?GoAheadAndLogIn=1"
     class='show_mini_login_form' data-qs-suffix="_top">Log In</a>

  <div id="mini_login_top" class="mini-popup mini_login bz_default_hidden"><span id="github_mini_login_top" class="mini_login_top">
    <form method="post" action="/github.cgi">
      <input type="hidden" name="github_secret" value="WusJOgx0OHIBS1UfTrfaxm4FwjODUkteLn0kDH1CCQHD3IfyFQ0oD71hD6tFvYrsNGlv7S6x2BfkC15EZjWzqBtGLqJTJykcEgEOfJy9yPetBxKrzcsTcEZF4cyOUHHfiwWU7iMFUc4cYu3zBK9Er2Gtzhwlnrzq2xNuJkRZxwSQdwCwtoCU6gMcqCl7mDwSTqdsbfQKRhp34Skm4ZKhu0s9r1LyLIJAJyDMRI1EYmP2GDuiY6GQHsyqwe8MEz2B">
      <input type="hidden" name="target_uri" value="https://bugzilla.mozilla.org/show_bug.cgi">
      <input type="image" src="/extensions/GitHubAuth/web/images/sign_in.png" height="22" width="75" align="absmiddle"
             alt="Sign in with GitHub"
             title="Sign in with GitHub"> or
    </form>
  </span>

  <form action="/show_bug.cgi?id=1064670" method="POST"
        data-qs-suffix="_top">

    <input id="Bugzilla_login_top"
           class="bz_login"
           name="Bugzilla_login"
           title="Login"
           placeholder="Email"
           aria-label="Email"
           type="email"
           required
    >
    <input class="bz_password"
           id="Bugzilla_password_top"
           name="Bugzilla_password"
           type="password"
           title="Password"
           placeholder="Password"
           aria-label="Password"
           required
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text"
           id="Bugzilla_password_dummy_top" value="password"
           title="Password"
    >
      <input type="checkbox" id="Bugzilla_remember_top"
             name="Bugzilla_remember" value="on" class="bz_remember"
                 checked>
      <label for="Bugzilla_remember_top">Remember</label>
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
           class="check_mini_login_fields"
            id="log_in_top">
    <a href="#" id="hide_mini_login_top" aria-label="Close"
       class="close-button hide_mini_login_form" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
<li id="forgot_container_top">
  <a id="forgot_link_top" href="/index.cgi?GoAheadAndLogIn=1#forgot"
     class='show_forgot_form'
     data-qs-suffix="_top">Forgot Password</a>
  <div id="forgot_form_top" class="mini-popup mini_forgot bz_default_hidden">
  <form action="/token.cgi" method="post">
    <input type="email" name="loginname" size="20" placeholder="Email" aria-label="Email" required>
    <input id="forgot_button_top" value="Reset Password"
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <input type="hidden" id="token_top" name="token" value="1635622488-4R7cmrLqeTZS9sx3sidZB2rrFCr7MgUCUyGY8EFvTgY">
    <a href="#" class="close-button hide_forgot_form" aria-label="Close" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
      </ul><div id="header-external-links" class="dropdown first">
  <button type="button" id="header-external-menu-button" class="dropdown-button minor" title="Mozilla"
          aria-label="Mozilla" aria-expanded="false" aria-haspopup="true" aria-controls="header-external-menu">
    <img src="/static/v20211025.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg" width="32" height="32" alt="">
  </button>
  <ul class="dropdown-content right" id="header-external-menu" role="menu" style="display:none;">
    <li role="presentation">
      <a href="https://www.mozilla.org/" role="menuitem" tabindex="-1">Mozilla Home</a>
    </li>
    <li role="separator"></li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/" role="menuitem" tabindex="-1">Privacy</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/#cookies" role="menuitem" tabindex="-1">Cookies</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/about/legal/" role="menuitem" tabindex="-1">Legal</a>
    </li>
  </ul>
</div>
  </div>
</header> 


<main id="bugzilla-body" tabindex="-1">

<aside id="message-container" role="complementary">
  <noscript>
    <div class="noscript">
      <div class="inner">
        <p>Please enable JavaScript in your browser to use all the features on this site.</p>
      </div>
    </div>
  </noscript>
</aside>

<div id="main-inner">




<div role="toolbar" id="page-toolbar">
  <div role="group" class="buttons">
    <button type="button" id="copy-summary" class="secondary"
      title="Copy bug number and summary to your clipboard">Copy Summary</button>
    <div id="clip-container" style="display:none"><input type="text" id="clip"></div>
    <div class="dropdown">
      <button type="button" id="action-menu-btn" aria-haspopup="true" aria-label="View"
        aria-expanded="false" aria-controls="action-menu" class="dropdown-button secondary">View &#9662;</button>
      <ul class="dropdown-content left" id="action-menu" role="menu" style="display:none;">
        <li role="presentation">
          <a id="action-reset" role="menuitem" tabindex="-1">Reset Sections</a>
        </li>
        <li role="presentation">
          <a id="action-expand-all" role="menuitem" tabindex="-1">Expand All Sections</a>
        </li>
        <li role="presentation">
          <a id="action-collapse-all" role="menuitem" tabindex="-1">Collapse All Sections</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a id="action-history" role="menuitem" tabindex="-1">History</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a href="/rest/bug/1064670" role="menuitem" tabindex="-1">JSON</a>
        </li>
        <li role="presentation">
          <a href="/show_bug.cgi?ctype=xml&amp;id=1064670" role="menuitem" tabindex="-1">XML</a>
        </li>
      </ul>
    </div>
  </div>
</div>



<div role="status" id="io-error" style="display:none"></div>
<div role="status" id="floating-message" style="display:none">
  <div id="floating-message-text"></div>
</div>
<section class="module"
>
  <div class="module-content"
  >
  <div id="summary-container">
    <div class="field indent" id="field-status_summary"
>


  
    <div class=" container">
        <span id="field-value-status_summary">
      <span class="bug-status-label text" data-status="closed">Closed</span>
      <span id="field-value-bug_id">
        <a href="/show_bug.cgi?id=1064670">Bug 1064670</a>
          <span class="edit-hide">(CVE-2014-1569)</span>
      </span>
      <span>
        <span class="bug-time-label">Opened <span class="rel-time" title="2014-09-08 20:25 PDT" data-time="1410233130">7 years ago</span></span>
          <span class="bug-time-label">Closed <span class="rel-time" title="2014-11-07 20:47 PST" data-time="1415422075">7 years ago</span></span>
      </span>
        </span>
    </div>

  
</div>
<div class="field indent edit-hide"
>


  
    <div class=" container">
      

      <h1 id="field-value-short_desc">ASN<wbr>.1 DER decoding of lengths is too permissive, allowing undetected smuggling of arbitrary data</h1>
    </div>

  
</div>

    <div class="field edit-show" id="field-short_desc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc" id="short_desc-help-link" class="help">Summary:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-short_desc">
            ASN.1 DER decoding of lengths is too permissive, allowing undetected smuggling of arbitrary data

        </span>
    </div>

  
</div>
  </div>
  </div>
</section>


<section class="module" id="module-categories"
>
    <header id="module-categories-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Categories section"
           data-label-collapsed="Expand Categories section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-categories-content"
             aria-expanded="true"
             aria-labeledby="module-categories-title"
             aria-describedby="module-categories-subtitle"></div>
        <h2 class="module-title" id="module-categories-title">Categories</h2>
          <h3 class="module-subtitle" id="module-categories-subtitle">
            (NSS :: Libraries, defect)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-categories-content"
  ><div class="fields-lhs">

    <div class="field" id="field-product"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=NSS" id="product-help-link" class="help">Product:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-product">
      <div class="name-info-outer dropdown">
        <span id="product-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="product-info">NSS
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="product-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Product description and actions">
          <header>
            <div class="title">NSS</div>
            <div class="description">Network Security Services - a cross-platform
security library (<a href="http://www.mozilla.org/projects/security/pki/nss/">more info</a>)</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=NSS&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Product</a></div>
            <div><a href="/enter_bug.cgi?product=NSS"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Product</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="NSS"
                         data-label-watch="Watch This Product" data-label-unwatch="Unwatch This Product"
                         data-source="BugModal">Watch This Product</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-component"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=NSS&component=Libraries#Libraries" id="component-help-link" class="help">Component:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-component">
      <div class="name-info-outer dropdown">
        <span id="component-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="component-info">Libraries
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="component-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Component description and actions">
          <header>
            <div class="title">NSS :: Libraries</div>
            <div class="description">Libraries for client support of SSL v2 and v3, TLS, PKCS #5,
PKCS #7, PKCS #11, PKCS #12, S/MIME, X.509 v3 certificates,
and other security standards</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=NSS&amp;component=Libraries&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Component</a></div>
            <div><a href="/buglist.cgi?product=NSS&amp;component=Libraries&amp;chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__"
                    target="_blank" role="menuitem" tabindex="-1">Recently Fixed Bugs in This Component</a></div>
            <div><a href="/enter_bug.cgi?product=NSS&amp;component=Libraries"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Component</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="NSS" data-component="Libraries"
                         data-label-watch="Watch This Component" data-label-unwatch="Unwatch This Component"
                         data-source="BugModal">Watch This Component</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-version" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#version" id="version-help-link" class="help">Version:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-version">
            trunk

        </span>
    </div>

  
</div>

    <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform" id="-help-link" class="help">Platform:
        </a>
    </div>


  
    <div class=" container"><div class="field inline" id="field-rep_platform"
>


  
    <div class="value">
        <span id="field-value-rep_platform">
            All

        </span>
    </div>

  
</div><div class="field indent inline" id="field-op_sys"
>


  
    <div class="value">
        <span id="field-value-op_sys">
            All

        </span>
    </div>

  
</div><div class="field indent inline"
>


  
    <div class=" container">
    </div>

  
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field contains-buttons" id="field-bug_type"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type" id="bug_type-help-link" class="help">Type:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_type">
      <span class="bug-type-label iconic-text" data-type="defect">
        <span class="icon" aria-hidden="true"></span>defect</span>
        </span>
    </div>

  
</div>

    <div class="field" id="field-importance"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority" id="importance-help-link" class="help">Priority:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-importance"><div class="field inline" id="field-priority"
>


  
    <div class="value">
        <span id="field-value-priority">
          <em>Not set</em>
        </span>
    </div>

  
</div><div class="field inline" id="field-bug_severity"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity" id="bug_severity-help-link" class="help">Severity:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_severity">
            critical

        </span>
    </div>

  
</div>
        </span>
    </div>

  
</div>

    
</div>
  </div>
</section>


<section class="module" id="module-tracking"
>
    <header id="module-tracking-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Tracking section"
           data-label-collapsed="Expand Tracking section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-tracking-content"
             aria-expanded="true"
             aria-labeledby="module-tracking-title"
             aria-describedby="module-tracking-subtitle"></div>
        <h2 class="module-title" id="module-tracking-title">Tracking</h2>
          <h3 class="module-subtitle" id="module-tracking-subtitle">
            (firefox32+ wontfix, firefox33+ wontfix, firefox34+ wontfix, firefox35+ wontfix, firefox36+ fixed, firefox37 fixed, firefox-esr31 affected, b2g-v1.4 wontfix, b2g-v2.0 affected, b2g-v2.0M affected, b2g-v2.1 affected, b2g-v2.1S affected, b2g-v2.2 fixed)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-tracking-content"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-status-view"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-view-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-view">RESOLVED
        FIXED
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-status-edit" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-edit-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-edit"><div class="field inline" id="field-bug_status"
>


  
    <div class="value">
        <span id="field-value-bug_status">
            RESOLVED

        </span>
    </div>

  
</div><div class="field indent inline" id="field-resolution"
>


  
    <div class="value">
        <span id="field-value-resolution">
            FIXED

        </span>
    </div>

  
</div>
  <div id="status-action-buttons">
      <div id="assigned-container" style="display:none">
        <button type="button" class="secondary" id="mark-as-assigned-btn">
          Mark as Assigned
        </button>
      </div>
  </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-target_milestone"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone" id="target_milestone-help-link" class="help">Milestone:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-target_milestone">
            3.17.3

        </span>
    </div>

  
</div>

    


      <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Project Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <td class="tracking-flag-name">Root Cause</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_root_cause-dirty">
  <select id="cf_root_cause" name="cf_root_cause">
        <option value="---"
          id="v4701_cf_root_cause" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">user-doc-firefox</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_sumo-dirty">
  <select id="cf_tracking_firefox_sumo" name="cf_tracking_firefox_sumo">
        <option value="---"
          id="v4660_cf_tracking_firefox_sumo" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Fission Milestone</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_fission_milestone-dirty">
  <select id="cf_fission_milestone" name="cf_fission_milestone">
        <option value="---"
          id="v4222_cf_fission_milestone" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

      <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Tracking Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-hide">
    <table class="layout-table tracking-flags">
        <tr>
          <th></th>
          <th>Tracking</th>
          <th>Status</th>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox32</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox32&amp;o1=equals&amp;v1=%2B">+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox32&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox33</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox33&amp;o1=equals&amp;v1=%2B">+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox33&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox34</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox34&amp;o1=equals&amp;v1=%2B">+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox34&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox35</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox35&amp;o1=equals&amp;v1=%2B">+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox35&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox36</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox36&amp;o1=equals&amp;v1=%2B">+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox36&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox37</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox37&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox-esr31</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox_esr31&amp;o1=equals&amp;v1=affected">affected</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">b2g-v1.4</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_b2g_1_4&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">b2g-v2.0</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_b2g_2_0&amp;o1=equals&amp;v1=affected">affected</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">b2g-v2.0M</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_b2g_2_0m&amp;o1=equals&amp;v1=affected">affected</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">b2g-v2.1</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_b2g_2_1&amp;o1=equals&amp;v1=affected">affected</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">b2g-v2.1S</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_b2g_2_1_s&amp;o1=equals&amp;v1=affected">affected</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">b2g-v2.2</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_b2g_2_2&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
    </table>
  </div>


<div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <th></th>
        <th>Tracking</th>
        <th>Status</th>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox32</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox32-dirty">
  <select id="cf_tracking_firefox32" name="cf_tracking_firefox32">
        <option value="+"
          id="v1633_cf_tracking_firefox32" selected
        >+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox32-dirty">
  <select id="cf_status_firefox32" name="cf_status_firefox32">
        <option value="wontfix"
          id="v1640_cf_status_firefox32" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox33</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox33-dirty">
  <select id="cf_tracking_firefox33" name="cf_tracking_firefox33">
        <option value="+"
          id="v1720_cf_tracking_firefox33" selected
        >+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox33-dirty">
  <select id="cf_status_firefox33" name="cf_status_firefox33">
        <option value="wontfix"
          id="v1714_cf_status_firefox33" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox34</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox34-dirty">
  <select id="cf_tracking_firefox34" name="cf_tracking_firefox34">
        <option value="+"
          id="v1778_cf_tracking_firefox34" selected
        >+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox34-dirty">
  <select id="cf_status_firefox34" name="cf_status_firefox34">
        <option value="wontfix"
          id="v1785_cf_status_firefox34" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox35</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox35-dirty">
  <select id="cf_tracking_firefox35" name="cf_tracking_firefox35">
        <option value="+"
          id="v1841_cf_tracking_firefox35" selected
        >+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox35-dirty">
  <select id="cf_status_firefox35" name="cf_status_firefox35">
        <option value="wontfix"
          id="v1848_cf_status_firefox35" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox36</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox36-dirty">
  <select id="cf_tracking_firefox36" name="cf_tracking_firefox36">
        <option value="+"
          id="v1948_cf_tracking_firefox36" selected
        >+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox36-dirty">
  <select id="cf_status_firefox36" name="cf_status_firefox36">
        <option value="fixed"
          id="v1954_cf_status_firefox36" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox37</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox37-dirty">
  <select id="cf_status_firefox37" name="cf_status_firefox37">
        <option value="fixed"
          id="v1990_cf_status_firefox37" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr31</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr31-dirty">
  <select id="cf_status_firefox_esr31" name="cf_status_firefox_esr31">
        <option value="affected"
          id="v1765_cf_status_firefox_esr31" selected
        >affected
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">b2g-v1.4</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_b2g_1_4-dirty">
  <select id="cf_status_b2g_1_4" name="cf_status_b2g_1_4">
        <option value="wontfix"
          id="v1467_cf_status_b2g_1_4" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">b2g-v2.0</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_b2g_2_0-dirty">
  <select id="cf_status_b2g_2_0" name="cf_status_b2g_2_0">
        <option value="affected"
          id="v1602_cf_status_b2g_2_0" selected
        >affected
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">b2g-v2.0M</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_b2g_2_0m-dirty">
  <select id="cf_status_b2g_2_0m" name="cf_status_b2g_2_0m">
        <option value="affected"
          id="v1913_cf_status_b2g_2_0m" selected
        >affected
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">b2g-v2.1</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_b2g_2_1-dirty">
  <select id="cf_status_b2g_2_1" name="cf_status_b2g_2_1">
        <option value="affected"
          id="v1736_cf_status_b2g_2_1" selected
        >affected
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">b2g-v2.1S</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_b2g_2_1_s-dirty">
  <select id="cf_status_b2g_2_1_s" name="cf_status_b2g_2_1_s">
        <option value="affected"
          id="v2120_cf_status_b2g_2_1_s" selected
        >affected
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">b2g-v2.2</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_b2g_2_2-dirty">
  <select id="cf_status_b2g_2_2" name="cf_status_b2g_2_2">
        <option value="fixed"
          id="v1878_cf_status_b2g_2_2" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">relnote-firefox</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_relnote-dirty">
  <select id="cf_tracking_firefox_relnote" name="cf_tracking_firefox_relnote">
        <option value="---"
          id="v539_cf_tracking_firefox_relnote" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr78-dirty">
  <select id="cf_tracking_firefox_esr78" name="cf_tracking_firefox_esr78">
        <option value="---"
          id="v4808_cf_tracking_firefox_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr78-dirty">
  <select id="cf_status_firefox_esr78" name="cf_status_firefox_esr78">
        <option value="---"
          id="v4813_cf_status_firefox_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr91-dirty">
  <select id="cf_tracking_firefox_esr91" name="cf_tracking_firefox_esr91">
        <option value="---"
          id="v5194_cf_tracking_firefox_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr91-dirty">
  <select id="cf_status_firefox_esr91" name="cf_status_firefox_esr91">
        <option value="---"
          id="v5199_cf_status_firefox_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox93</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox93-dirty">
  <select id="cf_tracking_firefox93" name="cf_tracking_firefox93">
        <option value="---"
          id="v5266_cf_tracking_firefox93" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox93-dirty">
  <select id="cf_status_firefox93" name="cf_status_firefox93">
        <option value="---"
          id="v5271_cf_status_firefox93" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox94</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox94-dirty">
  <select id="cf_tracking_firefox94" name="cf_tracking_firefox94">
        <option value="---"
          id="v5284_cf_tracking_firefox94" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox94-dirty">
  <select id="cf_status_firefox94" name="cf_status_firefox94">
        <option value="---"
          id="v5289_cf_status_firefox94" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox95</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox95-dirty">
  <select id="cf_tracking_firefox95" name="cf_tracking_firefox95">
        <option value="---"
          id="v5311_cf_tracking_firefox95" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox95-dirty">
  <select id="cf_status_firefox95" name="cf_status_firefox95">
        <option value="---"
          id="v5316_cf_status_firefox95" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>

</div>
  </div>
</section>



<section class="module" id="module-people"
>
    <header id="module-people-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse People section"
           data-label-collapsed="Expand People section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-people-content"
             aria-expanded="false"
             aria-labeledby="module-people-title"
             aria-describedby="module-people-subtitle"></div>
        <h2 class="module-title" id="module-people-title">People</h2>
          <h3 class="module-subtitle" id="module-people-subtitle">
            (Reporter: briansmith, Assigned: jcj)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-people-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-assigned_to"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to"><div class="vcard vcard_520206" ><img src="https://secure.gravatar.com/avatar/078db09f952a32d7a60ed0a6d149c40d?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=520206" > <span class="fna">jcj</span></a>
</div>
        </span>
    </div>

  
</div><div class="field edit-show" id="field-assigned_to" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-assignee" name="set_default_assignee" class="set-default"
          value="1" data-for="assigned_to">
        <label for="set-default-assignee">Reset Assignee to default</label>
      </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-bug_mentors" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor" id="bug_mentors-help-link" class="help">Mentors:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_mentors">---
        </span>
    </div>

  
</div>

    <div class="field edit-hide" id="field-qa_contact"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact" id="qa_contact-help-link" class="help">QA Contact:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-qa_contact"><div class="vcard vcard_520206" ><img src="https://secure.gravatar.com/avatar/078db09f952a32d7a60ed0a6d149c40d?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=520206" > <span class="fna">jcj</span></a>
</div>
        </span>
    </div>

  
</div><div class="field edit-show" id="field-qa_contact" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact" id="qa_contact-help-link" class="help">QA Contact:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-qa_contact">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-qa-contact" name="set_default_qa_contact" class="set-default"
          value="1" data-for="qa_contact">
        <label for="set-default-qa-contact">Reset QA Contact to default</label>
      </div>
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-reporter"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter" id="reporter-help-link" class="help">Reporter:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-reporter">
            <div class="vcard vcard_14661" ><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=14661" > <span class="fna">briansmith</span></a>
</div>

        </span>
    </div>

  
</div>

    <div class="field" id="field-triage_owner"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner" id="triage_owner-help-link" class="help">Triage Owner:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-triage_owner">
            <div class="vcard vcard_622637" ><img src="https://secure.gravatar.com/avatar/38f561698d679a724938d4600c0f8b52?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=622637" > <span class="fna">beurdouche</span></a>
</div>

        </span>
    </div>

  
</div>

    

    <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc" id="-help-link" class="help">CC:
        </a>
    </div>


  
    <div class=" container">


        <span aria-owns="cc-summary cc-latch">
          <span role="button" tabindex="0" id="cc-summary" data-count="26">26 people
          </span>
        </span>


        <div id="cc-list" style="display:none"></div>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-references"
>
    <header id="module-references-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse References section"
           data-label-collapsed="Expand References section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-references-content"
             aria-expanded="false"
             aria-labeledby="module-references-title"
             aria-describedby="module-references-subtitle"></div>
        <h2 class="module-title" id="module-references-title">References</h2>
      </div>
    </header>
  <div class="module-content" id="module-references-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field bug-list edit-show" id="field-dependson" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson" id="dependson-help-link" class="help">Depends on:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-dependson">
        ---
        </span>
    </div>

  
</div><div class="field bug-list" id="field-blocked"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks" id="blocked-help-link" class="help">Blocks:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-blocked">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE - PKCS#1 v1.5 RSA signature verification vulnerabilities due to ASN.1 parsing of DigestInfo"
   href="/show_bug.cgi?id=1069405">1069405</a>
      </div>

        </span>
    </div>

  
</div><div class="field" id="field-dependencytree"
>
    <div class="name">
    </div>


  
    <div class=" container">
        <span id="field-value-dependencytree">
        Dependency <a href="/showdependencytree.cgi?id=1064670&amp;hide_resolved=1">tree</a>
        / <a href="/showdependencygraph.cgi?id=1064670">graph</a>
        </span>
    </div>

  
</div>

    <div class="field bug-list edit-show" id="field-regresses" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses" id="regresses-help-link" class="help">Regressions:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regresses">
        ---
        </span>
    </div>

  
</div><div class="field bug-list edit-show" id="field-regressed_by" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by" id="regressed_by-help-link" class="help">Regressed by:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regressed_by">
        ---
        </span>
    </div>

  
</div>

    
</div><div class="fields-rhs">

    <div class="field edit-show" id="field-bug_file_loc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc" id="bug_file_loc-help-link" class="help">URL:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_file_loc"><div class="link">
    <a href="" target="_blank"
      rel="noreferrer" title=""
      class="bug-url" data-safe="0"></a>
  </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-see_also"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also" id="see_also-help-link" class="help">See Also:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-see_also">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636">CVE-2014-1568</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Certificate (and other) RSA PKCS#1 signature verification doesn't enforce a minimum of 8 padding bytes"
   href="/show_bug.cgi?id=1067214">CVE-2014-1570</a>
      </div>

        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-details"
>
    <header id="module-details-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Details section"
           data-label-collapsed="Expand Details section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-details-content"
             aria-expanded="false"
             aria-labeledby="module-details-title"
             aria-describedby="module-details-subtitle"></div>
        <h2 class="module-title" id="module-details-title">Details</h2>
          <h3 class="module-subtitle" id="module-details-subtitle">
            (Keywords: sec-critical, Whiteboard: [adv-main36-] sec-low/moderate after fix in bug 1064636, we don't know of any other exploitable paths)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-details-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-show" id="field-alias" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias" id="alias-help-link" class="help">Alias:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-alias">
            CVE-2014-1569

        </span>
    </div>

  
</div>

    <div class="field" id="field-keywords"
>
    <div class="name">
        <a href="/describekeywords.cgi" id="keywords-help-link" class="help">Keywords:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-keywords">
          <a href="/buglist.cgi?keywords=sec-critical&amp;resolution=---">sec-critical</a>
        </span>
    </div>

  
</div>

    <div class="field" id="field-status_whiteboard"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/Whiteboard" id="status_whiteboard-help-link" class="help">Whiteboard:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-status_whiteboard">[adv-main36-] sec-low/moderate after fix in bug 1064636, we don't know of any other exploitable paths
        </span>
    </div>

  
</div>

    

    <div class="field edit-show" id="field-cf_has_regression_range" style="display:none"
>
    <div class="name">Has Regression Range:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_regression_range">
            ---

        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_has_str" style="display:none"
>
    <div class="name">Has STR:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_str">
            ---

        </span>
    </div>

  
</div>

    <div class="field" id="field-votes"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes" id="votes-help-link" class="help">Votes:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-votes">0
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-bug_flags"
>
    <div class="name">Bug Flags:
    </div>


  
    <div class=" container">
        <span id="field-value-bug_flags"><div id="bug-flags" class="flags">
  <table class="layout-table">
          <tbody class="edit-hide"><tr>
    <td class="flag-setter"><div class="vcard vcard_1689" ><a class="email " href="/user_profile?user_id=1689" > <span class="fna">dveditz</span></a>
</div>
    </td>

    <td class="flag-name">
        <a href="#a2999020_1689"
            class="rel-time-title activity-ref"
            title="7 years ago"
        data-time="1411417019"
      >sec-bounty</a>
    </td>

    <td class="flag-value">+
    </td>

  </tr>
          </tbody>
          <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter"><div class="vcard vcard_1689" ><a class="email " href="/user_profile?user_id=1689" > <span class="fna">dveditz</span></a>
</div>
    </td>

    <td class="flag-name">
      <label title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug." for="flag-984341">sec-bounty</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag-984341-dirty">
      <select id="flag-984341" name="flag-984341"
        title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug."
        class="bug-flag">
            <option value="+" selected>+</option>
      </select>
    </td>


  </tr>
          </tbody>
          <tbody class="edit-hide"><tr>
    <td class="flag-setter"><div class="vcard vcard_578488" ><a class="email " href="/user_profile?user_id=578488" > <span class="fna">tjr</span></a>
</div>
    </td>

    <td class="flag-name">
        <a href="#a180138737_578488"
            class="rel-time-title activity-ref"
            title="1 year ago"
        data-time="1590371867"
      >sec-bounty-hof</a>
    </td>

    <td class="flag-value">+
    </td>

  </tr>
          </tbody>
          <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter"><div class="vcard vcard_578488" ><a class="email " href="/user_profile?user_id=578488" > <span class="fna">tjr</span></a>
</div>
    </td>

    <td class="flag-name">
      <label title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame." for="flag-1975134">sec-bounty-hof</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag-1975134-dirty">
      <select id="flag-1975134" name="flag-1975134"
        title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame."
          disabled
        class="bug-flag">
            <option value="+" selected>+</option>
      </select>
    </td>


  </tr>
          </tbody>
    <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?" for="flag_type-930">behind-pref</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-930-dirty">
      <select id="flag_type-930" name="flag_type-930"
        title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?"
        class="bug-flag">
          <option value="X"></option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-787">in-qa-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-787-dirty">
      <select id="flag_type-787" name="flag_type-787"
        title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>

      <td class="flag-requestee">
        <div id="requestee_type-787-container" style="display:none"><input
    name="requestee_type-787"
    value="" class="requestee bz_autocomplete_user"  id="requestee_type-787" 
  >
        </div>
      <td>

  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-37">in-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-37-dirty">
      <select id="flag_type-37" name="flag_type-37"
        title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually" for="flag_type-864">qe-verify</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-864-dirty">
      <select id="flag_type-864" name="flag_type-864"
        title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually"
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr>
    </tbody>
  </table>
</div>
        </span>
    </div>

  
</div>
</div>

  
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-crash-data"
>
    <header id="module-crash-data-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Crash Data section"
           data-label-collapsed="Expand Crash Data section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-crash-data-content"
             aria-expanded="false"
             aria-labeledby="module-crash-data-title"
             aria-describedby="module-crash-data-subtitle"></div>
        <h2 class="module-title" id="module-crash-data-title">Crash Data</h2>
      </div>
    </header>
  <div class="module-content" id="module-crash-data-content" style="display:none"
  ><div class="field edit-show" id="field-cf_crash_signature" style="display:none"
>
    <div class="name">Signature:
    </div>


  
    <div class="value">
        <span id="field-value-cf_crash_signature">
        </span>
    </div>

  
</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-security"
>
    <header id="module-security-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Security section"
           data-label-collapsed="Expand Security section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-security-content"
             aria-expanded="false"
             aria-labeledby="module-security-title"
             aria-describedby="module-security-subtitle"></div>
        <h2 class="module-title" id="module-security-title">Security</h2>
          <h3 class="module-subtitle" id="module-security-subtitle">
            (public)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-security-content" style="display:none"
  ><div class="groups edit-hide">
    This bug is publicly visible.
</div>

<div class="groups edit-show" style="display:none">


</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-user-story" data-non-stick="1"
>
    <header id="module-user-story-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse User Story section"
           data-label-collapsed="Expand User Story section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-user-story-content"
             aria-expanded="false"
             aria-labeledby="module-user-story-title"
             aria-describedby="module-user-story-subtitle"></div>
        <h2 class="module-title" id="module-user-story-title">User Story</h2>
      </div>
    </header>
  <div class="module-content" id="module-user-story-content" style="display:none"
  >
    <pre id="user-story"></pre>
  </div>
</section>







<section class="module" id="module-attachments"
>
    <header id="module-attachments-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Attachments section"
           data-label-collapsed="Expand Attachments section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-attachments-content"
             aria-expanded="true"
             aria-labeledby="module-attachments-title"
             aria-describedby="module-attachments-subtitle"></div>
        <h2 class="module-title" id="module-attachments-title">Attachments</h2>
          <h3 class="module-subtitle" id="module-attachments-subtitle">
            (1 file, 7 obsolete files)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-attachments-content"
  ><table role="table" class="layout-table" id="attachments">
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8486180">Test demonstrating the problem (GTest)</a>
        </div>
        <div>
            <a href="#c0" class="attach-time activity-ref"><span class="rel-time" title="2014-09-08 20:25 PDT" data-time="1410233130">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_14661" ><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div></span>
        </div>
        <div class="attach-info">3.68 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8486180&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8486180&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1064670&attachment=8486180">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8510691">This patch intends to handle Brian Smith's original findings; it does not address the other DER-correctness issues for INTEGER, BOOL and such.</a>
        </div>
        <div>
            <a href="#c20" class="attach-time activity-ref"><span class="rel-time" title="2014-10-23 16:18 PDT" data-time="1414106320">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_520206" ><a class="email " href="/user_profile?user_id=520206" > <span class="fna">J.C. Jones [:jcj] (he/him) [taking a break]</span></a>
</div></span>
        </div>
        <div class="attach-info">5.17 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_1584" ><span class="fn">wtc</span>
</div>:
              <a href="#c24"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1414106320"
            >
              feedback-</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8510691&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8510691&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1064670&attachment=8510691">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8513137">bug_1064670</a>
        </div>
        <div>
            <a href="#c26" class="attach-time activity-ref"><span class="rel-time" title="2014-10-28 18:34 PDT" data-time="1414546454">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_520206" ><a class="email " href="/user_profile?user_id=520206" > <span class="fna">J.C. Jones [:jcj] (he/him) [taking a break]</span></a>
</div></span>
        </div>
        <div class="attach-info">4.75 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_1584" ><span class="fn">wtc</span>
</div>:
              <a href="#c28"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1414546454"
            >
              feedback-</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8513137&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8513137&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1064670&attachment=8513137">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8513644">More tests, and more DER-compliance checks to quickder.c</a>
        </div>
        <div>
            <a href="#c27" class="attach-time activity-ref"><span class="rel-time" title="2014-10-29 10:39 PDT" data-time="1414604376">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_520206" ><a class="email " href="/user_profile?user_id=520206" > <span class="fna">J.C. Jones [:jcj] (he/him) [taking a break]</span></a>
</div></span>
        </div>
        <div class="attach-info">14.42 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8513644&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8513644&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1064670&attachment=8513644">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8514717">bug_1064670 test and quickder changes for NSS</a>
        </div>
        <div>
            <a href="#c36" class="attach-time activity-ref"><span class="rel-time" title="2014-10-30 18:01 PDT" data-time="1414717316">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_520206" ><a class="email " href="/user_profile?user_id=520206" > <span class="fna">J.C. Jones [:jcj] (he/him) [taking a break]</span></a>
</div></span>
        </div>
        <div class="attach-info">7.78 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_1584" ><span class="fn">wtc</span>
</div>:
              <a href="#c39"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1414717316"
            >
              review-</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8514717&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8514717&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1064670&attachment=8514717">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8515145">bug_1064670_part_2  More DER-compliance checks to quickder.c</a>
        </div>
        <div>
            <a href="#c38" class="attach-time activity-ref"><span class="rel-time" title="2014-10-31 11:30 PDT" data-time="1414780241">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_520206" ><a class="email " href="/user_profile?user_id=520206" > <span class="fna">J.C. Jones [:jcj] (he/him) [taking a break]</span></a>
</div></span>
        </div>
        <div class="attach-info">11.23 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8515145&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8515145&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1064670&attachment=8515145">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8516274">8514717: bug_1064670 test and quickder changes for NSS; restructure gtests</a>
        </div>
        <div>
            <a href="#c40" class="attach-time activity-ref"><span class="rel-time" title="2014-11-03 14:20 PST" data-time="1415053226">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_520206" ><a class="email " href="/user_profile?user_id=520206" > <span class="fna">J.C. Jones [:jcj] (he/him) [taking a break]</span></a>
</div></span>
        </div>
        <div class="attach-info">22.20 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_1584" ><span class="fn">wtc</span>
</div>:
              <a href="#c42"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1415053226"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8516274&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8516274&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1064670&attachment=8516274">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8518918">bug_1064670 - be more strict on DER length decoding in quickder.c</a>
        </div>
        <div>
            <a href="#c44" class="attach-time activity-ref"><span class="rel-time" title="2014-11-07 06:36 PST" data-time="1415371012">7 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_520206" ><a class="email " href="/user_profile?user_id=520206" > <span class="fna">J.C. Jones [:jcj] (he/him) [taking a break]</span></a>
</div></span>
        </div>
        <div class="attach-info">4.35 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_520206" ><span class="fn">jcj</span>
</div>:
              <a href="#c44"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1415371012"
            >
              review+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_438654" ><span class="fn">mt</span>
</div>:
              <a href="#a5188957_438654"
                  class="flag-name-status rel-time-title activity-ref"
                  title="7 years ago"
              data-time="1415422087"
            >
              checked-in+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8518918&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8518918&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1064670&attachment=8518918">Splinter Review</a>
    </tr>
</table>

<footer id="attachments-footer">
  <div id="attachments-actions">
      <button type="button" id="attachments-obsolete-btn" class="secondary">Show Obsolete</button>
  </div>
  
</footer>
  </div>
</section>



<script nonce="Pf1g8uCTYRz8dsx4EJ6NZqjr9Js34gjillJKw6UKMscwZQcK">
  init_module_visibility();
</script>



<meta name="firefox-versions" content="{&quot;FIREFOX_AURORA&quot;:&quot;&quot;,&quot;FIREFOX_DEVEDITION&quot;:&quot;94.0b9&quot;,&quot;FIREFOX_ESR&quot;:&quot;78.15.0esr&quot;,&quot;FIREFOX_ESR_NEXT&quot;:&quot;91.2.0esr&quot;,&quot;FIREFOX_NIGHTLY&quot;:&quot;95.0a1&quot;,&quot;FIREFOX_PINEBUILD&quot;:&quot;&quot;,&quot;LAST_MERGE_DATE&quot;:&quot;2021-10-04&quot;,&quot;LAST_RELEASE_DATE&quot;:&quot;2021-10-05&quot;,&quot;LAST_SOFTFREEZE_DATE&quot;:&quot;2021-09-30&quot;,&quot;LATEST_FIREFOX_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_OLDER_VERSION&quot;:&quot;3.6.28&quot;,&quot;LATEST_FIREFOX_RELEASED_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_VERSION&quot;:&quot;93.0&quot;,&quot;NEXT_MERGE_DATE&quot;:&quot;2021-11-01&quot;,&quot;NEXT_RELEASE_DATE&quot;:&quot;2021-11-02&quot;,&quot;NEXT_SOFTFREEZE_DATE&quot;:&quot;2021-10-28&quot;}">


<div id="comment-actions">
    <button type="button" id="bottom-btn" class="secondary" aria-label="Go to Page Bottom">Bottom &darr;</button>
  <div class="dropdown">
    <button type="button" id="comment-tags-btn" aria-haspopup="true" aria-label="Tags"
      aria-expanded="false" aria-controls="comment-tags-menu" class="dropdown-button minor">Tags &#9662;</button>
    <ul id="comment-tags-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a role="menuitem" tabindex="-1" data-comment-tag="">Reset</a>
      </li>
    </ul>
  </div>
  <div class="dropdown">
    <button type="button" id="view-menu-btn" aria-haspopup="true" aria-label="Timeline"
      aria-expanded="false" aria-controls="view-menu" class="dropdown-button minor">Timeline &#9662;</button>
    <ul id="view-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a id="view-reset" role="menuitem" tabindex="-1">Reset</a>
      </li>
      <li role="separator"></li>
      <li role="presentation">
        <a id="view-collapse-all" role="menuitem" tabindex="-1">Collapse All</a>
      </li>
      <li role="presentation">
        <a id="view-expand-all" role="menuitem" tabindex="-1">Expand All</a>
      </li>
      <li role="presentation">
        <a id="view-comments-only" role="menuitem" tabindex="-1">Comments Only</a>
      </li>
    </ul>
   </div>
</div>
<div class="change-set" id="c0"><div class="comment" data-id="9285901" data-no="0"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-0" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" ><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" ><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-0"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-0" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c0">Description</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-08 20:25 PDT" data-time="1410233130">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-0">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8486180"
         class="attachment patch obsolete"
         data-id="8486180" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="QuickDER-length.patch">
      <meta itemprop="contentSize" content="3765">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8486180">
          <a class="link" href="attachment.cgi?id=8486180&amp;action=diff">
        <span id="att-8486180-description" itemprop="description">Test demonstrating the problem (GTest)</span></a> (obsolete)
        — <a href="attachment.cgi?id=8486180&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1064670&attachment=8486180">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-0" data-comment-id="9285901">+++ This bug was initially created as a clone of <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636">Bug #1064636</a> +++

In some contexts, such as when decoding the AlgorithmIdentifier within a PKCS#1 signature, it is critical that we minimize the variance of possible encodings that are accepted when we parse a DER-encoded data stream. Usually &quot;minimize the variance&quot; means &quot;only accept the legal DER encoding of the data, and reject any overly-long encodings or any other variant.&quot; In some contexts, failing to restrict variance in accepted encodings completely undoes the cryptography. See <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636">bug 1064636</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA signature DigestInfo not checked properly in NSS (CVE-2006-4340)"
   href="/show_bug.cgi?id=351079">bug 351079</a>, and <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - rsa signature verification ignores garbage bytes (CVE-2006-4340)"
   href="/show_bug.cgi?id=350640">bug 350640</a>, for example.

See the attached test, where I demonstrate that SEC_QuickDERDecodeItem (a.k.a. QuickDER) accepts many malformed encodings of ASN.1 lengths. Note, in particular the test case where the length of the NULL item is encoded as { 0x90, &lt;arbitrary junk&gt;, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 }, which is wrongly interpreted by QuickDER as equivalent to { 0x00 } on both 32-bit and 64-bit platforms. I believe it is likely that this would facilitate the same types of attacks as described in the aforementioned bugs.

In quickder.c, the function definite_length_decoder is used to decode tags and lengths. It decodes the length as follows:

    unsigned int data_len;

    // [...]

    data_len = buf[used_length++];

    if (data_len&amp;0x80)
    {
        int  len_count = data_len &amp; 0x7f;

        data_len = 0;

        while (len_count-- &gt; 0)
        {
            if (used_length &gt;= length)
            {
                return NULL;
            }
            data_len = (data_len &lt;&lt; 8) | buf[used_length++];
        }
    }

Note that there is no check that the encoding of the length is the shortest necssary encoding. And also note the integer overflow of data_len.

In the case of PKCS#1 (i.e. the aforementioned bugs), we shouldn't even be doing DER decoding in the first place. However, it isn't obvious to me yet what contexts besides PKCS#1 are also problematic, so it prudent to fix QuickDER, regardless of the fix for the PKCS#1 decoder in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636">bug 1064636</a>.

The attached GTest integrates into Gecko's mozilla::pkix test suite, for my own convenience. However, it doesn't use any of the mozilla::pkix or Gecko GTest utilities, so it should be easy to integrate it into other GTest-based test suites.</pre></div><div class="change-set" id="a52601_1689"><div class="change" id="aa52601_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a52601_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a52601_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a52601_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a52601_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#a52601_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-09 11:02 PDT" data-time="1410285731">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: needinfo?(dkeeler)</div></div></div><div class="change-set" id="c1"><div class="comment" data-id="9296445" data-no="1"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-1" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a52601_1689"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a52601_1689"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-1"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-1" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c1">Comment 1</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-10 16:22 PDT" data-time="1410391373">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-1">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-1" data-comment-id="9296445">[Tracking Requested - why for this release]: If <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636">bug 1064636</a> is a exploitable, critical security vulnerability then this one almost definitely is too, because these bugs (this one, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636">bug 1064636</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA signature DigestInfo not checked properly in NSS (CVE-2006-4340)"
   href="/show_bug.cgi?id=351079">bug 351079</a>, and <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - rsa signature verification ignores garbage bytes (CVE-2006-4340)"
   href="/show_bug.cgi?id=350640">bug 350640</a>) are all instances of the same general problem.</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox32&amp;o1=isnotempty">status-firefox32</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox32&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox33&amp;o1=isnotempty">status-firefox33</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox33&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox34&amp;o1=isnotempty">status-firefox34</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox34&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox35&amp;o1=isnotempty">status-firefox35</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox35&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox33&amp;o1=isnotempty">tracking-firefox33</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox33&amp;o1=equals&amp;v1=%3F">?</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox34&amp;o1=isnotempty">tracking-firefox34</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox34&amp;o1=equals&amp;v1=%3F">?</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox35&amp;o1=isnotempty">tracking-firefox35</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox35&amp;o1=equals&amp;v1=%3F">?</a></div><div class="change">Keywords: <a href="/buglist.cgi?keywords=sec-critical&amp;resolution=---">sec-critical</a></div></div></div><div class="change-set" id="c2"><div class="comment" data-id="9296551" data-no="2"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-2" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_349244" id="a52601_1689"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_349244" id="a52601_1689"><a class="email " href="/user_profile?user_id=349244" > <span class="fna">Dana Keeler (she/her) (use needinfo) (:keeler for reviews) (out of office)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-2"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-2" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c2">Comment 2</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-10 16:44 PDT" data-time="1410392642">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-2">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-2" data-comment-id="9296551">My understanding is Dan's looking for an explanation of what kinds of attacks this enables. I'm not familiar with the details here, so Brian, could you give a quick run-down of the consequences of this bug?</pre><div class="activity"><div class="change">Flags: needinfo?(dkeeler) &rarr; needinfo?(brian)</div></div></div><div class="change-set" id="a217317_424995"><div class="change" id="aa217317_424995">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_424995" id="a217317_424995"><img src="https://secure.gravatar.com/avatar/44db89c3c0e0ff5a5bff6afac6e68a17?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_424995" id="a217317_424995"><a class="email disabled" href="/user_profile?user_id=424995" > <span class="fna">Lawrence Mandel [:lmandel] (use needinfo)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a217317_424995"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a217317_424995">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#a217317_424995">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-11 08:47 PDT" data-time="1410450447">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox32&amp;o1=isnotempty">tracking-firefox32</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox32&amp;o1=equals&amp;v1=%2B">+</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox33&amp;o1=isnotempty">tracking-firefox33</a>:
          <a href="/buglist.cgi?f1=cf_tracking_firefox33&amp;o1=equals&amp;v1=%3F">?</a> &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox33&amp;o1=equals&amp;v1=%2B">+</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox34&amp;o1=isnotempty">tracking-firefox34</a>:
          <a href="/buglist.cgi?f1=cf_tracking_firefox34&amp;o1=equals&amp;v1=%3F">?</a> &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox34&amp;o1=equals&amp;v1=%2B">+</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox35&amp;o1=isnotempty">tracking-firefox35</a>:
          <a href="/buglist.cgi?f1=cf_tracking_firefox35&amp;o1=equals&amp;v1=%3F">?</a> &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox35&amp;o1=equals&amp;v1=%2B">+</a></div></div></div><div class="change-set" id="c3"><div class="comment" data-id="9308432" data-no="3"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-3" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a217317_424995"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a217317_424995"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-3"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-3" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c3">Comment 3</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-13 21:30 PDT" data-time="1410669011">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-3">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-3" data-comment-id="9308432">See <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636#c11">bug 1064636 comment 11</a>, where Antoine is actually exploiting *THIS* bug (<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - ASN.1 DER decoding of lengths is too permissive, allowing undetected smuggling of arbitrary data"
   href="/show_bug.cgi?id=1064670">bug 1064670</a>), not that bug (<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636">bug 1064636</a>). In particular, here is the encoded DigestInfo from Antoine's forged certificate's forged signature:

30 7b 30 07 06 05 2b 0e 03 02 1a 04 dc 00 00 00
03 64 1c cb 7e 65 53 c9 91 55 21 91 9b 3c 45 1e
07 1a 25 0d 2f 7a ac ce 7f 16 0d e8 61 ed c3 1c
af 7a e6 14 06 9f 31 eb 7c a2 b3 e7 c3 3a ed 78
b8 ab 00 3f 1c 5c 25 b2 c7 06 31 f1 db 2e cd 64
53 96 2c a6 53 c7 1e 1e ee f1 41 59 36 1f 85 29
7b 72 88 a0 83 00 00 00 14 6f 9f 54 4f 35 45 f8
49 77 54 9d 01 ef cf 66 4c c4 c1 b6 03

which decodes to:

tag:  30 (sequence DigestInfo)
len:  7b
data:
  { tag:  30 (sequence DigestInfo.AlgorithmIdentifier)
    len:  07 (length 7)
    data: { tag: 06 (OID DigestInfo.AlgorithmIdentifier.algorithm)
            len: 05 (length 5)
            data: 2b 0e 03 02 1a
          }
  }
  
  { tag:  04
    len:  dc
          00 00 00 03 64 1c cb 7e 65 53 c9 91 55 21 91 9b
          3c 45 1e 07 1a 25 0d 2f 7a ac ce 7f 16 0d e8 61
          ed c3 1c af 7a e6 14 06 9f 31 eb 7c a2 b3 e7 c3
          3a ed 78 b8 ab 00 3f 1c 5c 25 b2 c7 06 31 f1 db
          2e cd 64 53 96 2c a6 53 c7 1e 1e ee f1 41 59 36
          1f 85 29 7b 72 88 a0 83 00 00 00 14
          (length 20, ***OVER-LONG ENCODING***)
    data: 6f 9f 54 4f 35 45 f8 49 77 54 9d 01 ef cf 66 4c
          c4 c1 b6 03
  }

Notice that Antoine's test certificate doesn't even include parameters in the AlgorithmIdentifier. So, Antoine Delignat-Lavaud has demonstrated that this is this bug (<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - ASN.1 DER decoding of lengths is too permissive, allowing undetected smuggling of arbitrary data"
   href="/show_bug.cgi?id=1064670">bug 1064670</a>) is actually exploitable in a way that will allow people to forge certificates that Firefox will then trust.

Note that even if we have removed all the 1024-bit root CAs with e=3 RSA keys, there are unknown numbers of sub-CA certificates issued by them with e=3. Also, note that any end-entity certificates may also have e=3, and so ServerKeyExchange messages in TLS are also an issue. Similarly, S/MIME. Also, the signed packaged apps CA uses e=3. Finally, note that Antoine claimed that he also created a PoC for an e=65537 public key in the other bug.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(brian)</span></div></div></div><div class="change-set" id="a518019_14661"><div class="change" id="aa518019_14661">
    <table class="layout-table change-head reporter" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a518019_14661"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_14661" id="a518019_14661"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
            <span class="user-role">Reporter</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a518019_14661"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a518019_14661">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#a518019_14661">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-14 20:19 PDT" data-time="1410751149">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">See Also:  &rarr; <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Certificate (and other) RSA PKCS#1 signature verification doesn't enforce a minimum of 8 padding bytes"
   href="/show_bug.cgi?id=1067214">CVE-2014-1570</a></div></div></div><div class="change-set" id="c4"><div class="comment" data-id="9323954" data-no="4"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-4" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_424995" id="a518019_14661"><img src="https://secure.gravatar.com/avatar/44db89c3c0e0ff5a5bff6afac6e68a17?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_424995" id="a518019_14661"><a class="email disabled" href="/user_profile?user_id=424995" > <span class="fna">Lawrence Mandel [:lmandel] (use needinfo)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-4"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-4" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c4">Comment 4</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-17 11:23 PDT" data-time="1410978238">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-4">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-4" data-comment-id="9323954">I don't see a lot of action here. We're very likely going to be releasing Firefox 32.0.2 this week. Wanted to poke this bug as it may be able to ride along in 32.0.2 if we can get a patch together in time.</pre></div><div class="change-set" id="c5"><div class="comment" data-id="9324173" data-no="5"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-5" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a518019_14661"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a518019_14661"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-5"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-5" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c5">Comment 5</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-17 11:41 PDT" data-time="1410979262">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-5">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-5" data-comment-id="9324173">(In reply to Lawrence Mandel [:lmandel] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - ASN.1 DER decoding of lengths is too permissive, allowing undetected smuggling of arbitrary data"
   href="/show_bug.cgi?id=1064670#c4">comment #4</a>)
<span class="quote">&gt; I don't see a lot of action here. We're very likely going to be releasing
&gt; Firefox 32.0.2 this week. Wanted to poke this bug as it may be able to ride
&gt; along in 32.0.2 if we can get a patch together in time.</span >

The patches in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636">bug 1064636</a> will fix this bug and will make <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Certificate (and other) RSA PKCS#1 signature verification doesn't enforce a minimum of 8 padding bytes"
   href="/show_bug.cgi?id=1067214">bug 1067214</a> less urgent to fix.</pre></div><div class="change-set" id="c6"><div class="comment" data-id="9324213" data-no="6"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-6" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a518019_14661"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a518019_14661"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-6"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-6" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c6">Comment 6</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-17 11:45 PDT" data-time="1410979550">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-6">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-6" data-comment-id="9324213">(In reply to Brian Smith (:briansmith, :bsmith, use NEEDINFO?) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - ASN.1 DER decoding of lengths is too permissive, allowing undetected smuggling of arbitrary data"
   href="/show_bug.cgi?id=1064670#c5">comment #5</a>)
<span class="quote">&gt; (In reply to Lawrence Mandel [:lmandel] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - ASN.1 DER decoding of lengths is too permissive, allowing undetected smuggling of arbitrary data"
   href="/show_bug.cgi?id=1064670#c4">comment #4</a>)
&gt; &gt; I don't see a lot of action here. We're very likely going to be releasing
&gt; &gt; Firefox 32.0.2 this week. Wanted to poke this bug as it may be able to ride
&gt; &gt; along in 32.0.2 if we can get a patch together in time.
&gt; 
&gt; The patches in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636">bug 1064636</a> will fix this bug and will make <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Certificate (and other) RSA PKCS#1 signature verification doesn't enforce a minimum of 8 padding bytes"
   href="/show_bug.cgi?id=1067214">bug 1067214</a> less
&gt; urgent to fix.</span >

Oops, sorry. The patches in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636">bug 1064636</a> will NOT fix this bug, but they will reduce the severity of this issue.

To fix this bug, NSS can copy the logic that mozilla::pkix's DER decoder uses:
<a rel="nofollow" href="https://mxr.mozilla.org/mozilla-central/source/security/pkix/lib/pkixder.cpp?rev=88c41feb981d#48">https://mxr.mozilla.org/mozilla-central/source/security/pkix/lib/pkixder.cpp?rev=88c41feb981d#48</a>

Note that mozilla::pkix's decoder only handles lengths up to 2^16-1, so the logic would need to be extended to handle longer lengths.</pre></div><div class="change-set" id="c7"><div class="comment" data-id="9324274" data-no="7"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-7" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_454174" id="a518019_14661"><img src="https://secure.gravatar.com/avatar/4c06a4d3a635c54ccd22b05c3b3d6a41?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_454174" id="a518019_14661"><a class="email disabled" href="/user_profile?user_id=454174" > <span class="fna">Antoine Delignat-Lavaud</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-7"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-7" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c7">Comment 7</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-17 11:50 PDT" data-time="1410979858">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-7">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-7" data-comment-id="9324274">That brings up an interesting question, what else is the QuickDER decoder used for in NSS? I wonder if there  may be some other more exciting (or at least novel) exploit to make.</pre></div><div class="change-set" id="a825095_14661"><div class="change" id="aa825095_14661">
    <table class="layout-table change-head reporter" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a825095_14661"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_14661" id="a825095_14661"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
            <span class="user-role">Reporter</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a825095_14661"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a825095_14661">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#a825095_14661">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-18 09:37 PDT" data-time="1411058225">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Blocks: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE - PKCS#1 v1.5 RSA signature verification vulnerabilities due to ASN.1 parsing of DigestInfo"
   href="/show_bug.cgi?id=1069405">1069405</a></div></div></div><div class="change-set" id="c8"><div class="comment" data-id="9335914" data-no="8"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-8" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a825095_14661"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a825095_14661"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-8"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-8" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c8">Comment 8</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-19 14:18 PDT" data-time="1411161527">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-8">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-8" data-comment-id="9335914">(In reply to Antoine Delignat-Lavaud from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - ASN.1 DER decoding of lengths is too permissive, allowing undetected smuggling of arbitrary data"
   href="/show_bug.cgi?id=1064670#c7">comment #7</a>)
<span class="quote">&gt; That brings up an interesting question, what else is the QuickDER decoder
&gt; used for in NSS? I wonder if there  may be some other more exciting (or at
&gt; least novel) exploit to make.</span >

It's used quite a bit:
<a rel="nofollow" href="https://mxr.mozilla.org/mozilla-central/search?string=quickderdecodeitem&amp;find=&amp;findi=&amp;filter=^%5B^\0%5D*%24&amp;hitlimit=&amp;tree=mozilla-central">https://mxr.mozilla.org/mozilla-central/search?string=quickderdecodeitem&amp;find=&amp;findi=&amp;filter=^%5B^\0%5D*%24&amp;hitlimit=&amp;tree=mozilla-central</a></pre></div><div class="change-set" id="a1183889_1689"><div class="change" id="aa1183889_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a1183889_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a1183889_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1183889_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1183889_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#a1183889_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-22 13:16 PDT" data-time="1411417019">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: sec-bounty?</div></div></div><div class="change-set" id="a1195798_280903"><div class="change" id="aa1195798_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a1195798_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a1195798_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1195798_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1195798_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#a1195798_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-22 16:35 PDT" data-time="1411428928">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Alias: CVE-2014-1569</div></div></div><div class="change-set" id="c9"><div class="comment" data-id="9364566" data-no="9"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-9" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a1195798_280903"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a1195798_280903"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-9"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-9" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c9">Comment 9</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-25 21:55 PDT" data-time="1411707354">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-9">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-9" data-comment-id="9364566">This has now been publicly disclosed:
<a rel="nofollow" href="https://www.reddit.com/r/netsec/comments/2hd1m8/rsa_signature_forgery_in_nss/cksnr02">https://www.reddit.com/r/netsec/comments/2hd1m8/rsa_signature_forgery_in_nss/cksnr02</a></pre></div><div class="change-set" id="c10"><div class="comment" data-id="9373049" data-no="10"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-10" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_495955" id="a1195798_280903"><img src="https://secure.gravatar.com/avatar/5aa2e382197a147b42d020b6878f8623?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_495955" id="a1195798_280903"><a class="email " href="/user_profile?user_id=495955" > <span class="fna">Sylvestre Ledru [:Sylvestre]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-10"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-10" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c10">Comment 10</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-29 03:18 PDT" data-time="1411985905">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-10">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-10" data-comment-id="9373049">Brian, do we have an ETA for a fix for this issue? thanks

By the way, do we know if ESR is affected?</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox32&amp;o1=isnotempty">status-firefox32</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox32&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox32&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr31&amp;o1=isnotempty">status-firefox-esr31</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr31&amp;o1=equals&amp;v1=%3F">?</a></div><div class="change">Flags: needinfo?(brian)</div></div></div><div class="change-set" id="c11"><div class="comment" data-id="9375909" data-no="11"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-11" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a1195798_280903"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a1195798_280903"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-11"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-11" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c11">Comment 11</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-29 12:00 PDT" data-time="1412017226">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-11">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-11" data-comment-id="9375909">(In reply to Sylvestre Ledru [:sylvestre] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - ASN.1 DER decoding of lengths is too permissive, allowing undetected smuggling of arbitrary data"
   href="/show_bug.cgi?id=1064670#c10">comment #10</a>)
<span class="quote">&gt; Brian, do we have an ETA for a fix for this issue? thanks
&gt; 
&gt; By the way, do we know if ESR is affected?</span >

Somebody needs to be assigned to this bug.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(brian)</span></div></div></div><div class="change-set" id="c12"><div class="comment" data-id="9380881" data-no="12"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-12" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_454174" id="a1195798_280903"><img src="https://secure.gravatar.com/avatar/4c06a4d3a635c54ccd22b05c3b3d6a41?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_454174" id="a1195798_280903"><a class="email disabled" href="/user_profile?user_id=454174" > <span class="fna">Antoine Delignat-Lavaud</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-12"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-12" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c12">Comment 12</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-09-30 07:48 PDT" data-time="1412088508">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-12">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-12" data-comment-id="9380881">Please note that there were other DER failures mentioned in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing"
   href="/show_bug.cgi?id=1064636">bug 1064636</a> that need to be fixed in the patch for this bug, either that I noticed when building an exploit or from the test cases Adam provided. From the top of my head:

- length encoding can be overlong regardless of the overflow problem (03 == 81 03 == 82 00 03), i.e. this bug
- INTEGER can have arbitrary many null bytes of padding. This is wrong, there can only be one byte of padding to distinguish between negative and positive values
- BITSTRING: the unused bits are not checked, and the computed length in bits is not verified either.
- the method check for non-universal tags is probably too weak
- I don't think there is support for default values in optional components. This is required to implement DER as optional fields that are equal to their default values must be omitted
- many checks are missing for primitive types. For instance, BOOL must be either 00 of FF; object identifiers must satisfy certain requirements, TIME types must be validated...

Overall, the DER parser in PKIX appears a lot more robust, and it would make sense to port other parts of NSS that rely on DER for non-malleability to use that instead of QuickDER.</pre></div><div class="change-set" id="c13"><div class="comment" data-id="9401017" data-no="13"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-13" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a1195798_280903"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a1195798_280903"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-13"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-13" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c13">Comment 13</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-03 12:28 PDT" data-time="1412364527">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-13">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-13" data-comment-id="9401017">All the sensitive information in this bug has been publicly disclosed:
<a rel="nofollow" href="https://www.imperialviolet.org/2014/09/26/pkcs1.html">https://www.imperialviolet.org/2014/09/26/pkcs1.html</a>
<a rel="nofollow" href="https://www.reddit.com/r/netsec/comments/2hd1m8/rsa_signature_forgery_in_nss/cksnr02">https://www.reddit.com/r/netsec/comments/2hd1m8/rsa_signature_forgery_in_nss/cksnr02</a>
<a rel="nofollow" href="http://www.intelsecurity.com/resources/wp-berserk-analysis-part-1.pdf">http://www.intelsecurity.com/resources/wp-berserk-analysis-part-1.pdf</a>

I'd like to open up the bug today or sometime this weekend. Let me know if (and how) it would be problematic to do so.</pre></div><div class="change-set" id="c14"><div class="comment" data-id="9402028" data-no="14"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-14" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a1195798_280903"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a1195798_280903"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-14"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-14" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c14">Comment 14</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-03 16:12 PDT" data-time="1412377936">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-14">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-14" data-comment-id="9402028">(In reply to Brian Smith (:briansmith, :bsmith, use NEEDINFO?) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - ASN.1 DER decoding of lengths is too permissive, allowing undetected smuggling of arbitrary data"
   href="/show_bug.cgi?id=1064670#c13">comment #13</a>)
<span class="quote">&gt; I'd like to open up the bug today or sometime this weekend. Let me know if
&gt; (and how) it would be problematic to do so.</span >

A comment in the bug isn't the right approach this, for reasons someone with &quot;use NEEDINFO?&quot; in their user name ought to realize. Mailing nss-dev or security-group would be a better approach.</pre></div><div class="change-set" id="a2470876_1689"><div class="change" id="aa2470876_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a2470876_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a2470876_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a2470876_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a2470876_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#a2470876_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-07 10:46 PDT" data-time="1412704006">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: <span class="activity-deleted">crypto-core-security, core-security</span></div></div></div><div class="change-set" id="a2999020_1689"><div class="change" id="aa2999020_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a2999020_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a2999020_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a2999020_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a2999020_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#a2999020_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-13 13:29 PDT" data-time="1413232150">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: sec-bounty? &rarr; sec-bounty+</div></div></div><div class="change-set" id="c15"><div class="comment" data-id="9440347" data-no="15"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-15" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a2999020_1689"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_280903" id="a2999020_1689"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-15"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-15" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c15">Comment 15</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-13 13:30 PDT" data-time="1413232238">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-15">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8504265"
         class="attachment"
         data-id="8504265" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bugbounty.data">
      <meta itemprop="contentSize" content="7">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=8504265" itemprop="contentUrl">
        <span id="att-8504265-description" itemprop="description">brian&#64;briansmith.org,3000?,2014-09-08,,2014-10-13,true,</span></a>
        — <a href="attachment.cgi?id=8504265&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div></div><div class="change-set" id="c16"><div class="comment" data-id="9451899" data-no="16"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-16" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_452604" id="a2999020_1689"><img src="https://secure.gravatar.com/avatar/7bb698c4991c5af83adabe3c3b8ee8aa?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_452604" id="a2999020_1689"><a class="email disabled" href="/user_profile?user_id=452604" > <span class="fna">Matt Wobensmith [:mwobensmith][:matt:]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-16"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-16" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c16">Comment 16</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-15 11:40 PDT" data-time="1413398434">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-16">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-16" data-comment-id="9451899">David, do you know who might own this on the developer side?</pre><div class="activity"><div class="change">Flags: needinfo?(dkeeler)</div></div></div><div class="change-set" id="c17"><div class="comment" data-id="9452709" data-no="17"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-17" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_349244" id="a2999020_1689"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_349244" id="a2999020_1689"><a class="email " href="/user_profile?user_id=349244" > <span class="fna">Dana Keeler (she/her) (use needinfo) (:keeler for reviews) (out of office)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-17"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-17" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c17">Comment 17</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-15 13:59 PDT" data-time="1413406777">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-17">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-17" data-comment-id="9452709">(In reply to Matt Wobensmith from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - ASN.1 DER decoding of lengths is too permissive, allowing undetected smuggling of arbitrary data"
   href="/show_bug.cgi?id=1064670#c16">comment #16</a>)
<span class="quote">&gt; David, do you know who might own this on the developer side?</span >

Looking at hg annotate for quickder.c, I would ask Wan-Teh.</pre><div class="activity"><div class="change">Flags: needinfo?(dkeeler) &rarr; needinfo?(wtc)</div></div></div><div class="change-set" id="c18"><div class="comment" data-id="9486423" data-no="18"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-18" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1584" id="a2999020_1689"><img src="https://secure.gravatar.com/avatar/3e0b23cde901a6405f541eed3973331c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1584" id="a2999020_1689"><a class="email " href="/user_profile?user_id=1584" > <span class="fna">Wan-Teh Chang</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-18"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-18" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c18">Comment 18</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-22 12:10 PDT" data-time="1414005058">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-18">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-18" data-comment-id="9486423">It should not be hard to implement the fix that Brian described
in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - ASN.1 DER decoding of lengths is too permissive, allowing undetected smuggling of arbitrary data"
   href="/show_bug.cgi?id=1064670#c6">comment 6</a>.

Some of the problems that Antoine described in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - ASN.1 DER decoding of lengths is too permissive, allowing undetected smuggling of arbitrary data"
   href="/show_bug.cgi?id=1064670#c12">comment 12</a> don't
seem hard. Some of them may require deeper knowledge of ASN.1
than I have now.</pre><div class="activity"><div class="change">Assignee: nobody &rarr; wtc</div><div class="change">Flags: <span class="activity-deleted">needinfo?(wtc)</span></div></div></div><div class="change-set" id="c19"><div class="comment" data-id="9487395" data-no="19"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-19" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_520206" id="a2999020_1689"><img src="https://secure.gravatar.com/avatar/078db09f952a32d7a60ed0a6d149c40d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_520206" id="a2999020_1689"><a class="email " href="/user_profile?user_id=520206" > <span class="fna">J.C. Jones [:jcj] (he/him) [taking a break]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-19"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-19" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c19">Comment 19</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-22 14:38 PDT" data-time="1414013909">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-19">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-19" data-comment-id="9487395">I'm going to take a shot at fixing this bug. I'll get the length fix in place from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - ASN.1 DER decoding of lengths is too permissive, allowing undetected smuggling of arbitrary data"
   href="/show_bug.cgi?id=1064670#c6">comment 6</a> and get feedback from you, Wan-Teh (if that's alright), and then move on to the other parsing issues in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - ASN.1 DER decoding of lengths is too permissive, allowing undetected smuggling of arbitrary data"
   href="/show_bug.cgi?id=1064670#c12">comment 12</a>.

If anyone wants to gin up some tests for the issues in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - ASN.1 DER decoding of lengths is too permissive, allowing undetected smuggling of arbitrary data"
   href="/show_bug.cgi?id=1064670#c12">comment 12</a>, that'd be swell, but I'll see what I can do.</pre><div class="activity"><div class="change">Assignee: wtc &rarr; jjones</div><div class="change">Status: NEW &rarr; ASSIGNED</div></div></div><div class="change-set" id="c20"><div class="comment" data-id="9494153" data-no="20"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-20" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_520206" id="a2999020_1689"><img src="https://secure.gravatar.com/avatar/078db09f952a32d7a60ed0a6d149c40d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_520206" id="a2999020_1689"><a class="email " href="/user_profile?user_id=520206" > <span class="fna">J.C. Jones [:jcj] (he/him) [taking a break]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-20"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-20" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c20">Comment 20</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-23 16:18 PDT" data-time="1414106320">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-20">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8510691"
         class="attachment patch obsolete"
         data-id="8510691" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug_1064670">
      <meta itemprop="contentSize" content="5292">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8510691">
          <a class="link" href="attachment.cgi?id=8510691&amp;action=diff">
        <span id="att-8510691-description" itemprop="description">This patch intends to handle Brian Smith's original findings; it does not address the other DER-correctness issues for INTEGER, BOOL and such.</span></a> (obsolete)
        — <a href="attachment.cgi?id=8510691&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1064670&attachment=8510691">Splinter Review</a>
      </div>
    </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8510691&amp;action=edit"
           title="This patch intends to handle Brian Smith's original findings; it does not address the other DER-correctness issues for INTEGER, BOOL and such."
           class=""
        >Attachment #8510691</a> -
        Flags: feedback?(wtc)</div></div></div><div class="change-set" id="c21"><div class="comment" data-id="9513171" data-no="21"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-21" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_520206" id="a2999020_1689"><img src="https://secure.gravatar.com/avatar/078db09f952a32d7a60ed0a6d149c40d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_520206" id="a2999020_1689"><a class="email " href="/user_profile?user_id=520206" > <span class="fna">J.C. Jones [:jcj] (he/him) [taking a break]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-21"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-21" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c21">Comment 21</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-28 13:33 PDT" data-time="1414528439">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-21">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-21" data-comment-id="9513171">I've found an interesting thing: after writing a routine to catch padded ASN.1 integers that aren't DER-compliant, apparently they are moderately common. There's a comment in quickder.c's DecodeItem() that says:

<span class="quote">&gt; /* remove leading zeroes if the caller requested
&gt;  siUnsignedInteger
&gt;  This is to allow RSA key operations to work */</span >

Assuming that to be true and unavoidable, I added an else that checks for over-long (padded) integers. A simple check of
 
 if ( item length &gt; 1 &amp;&amp; ( byte[0] == 0x00 || byte[0] == 0xFF ))
 {
    abort
 }

aborts on Firefox startup with an error that an EV certificate wasn't available; I'm not certain what certificate is the source of the problem at this point, but clearly there are some compatibility issues.

Specifically for the INTEGER type, one way through this is to look for more than one padding byte at the front (0x00 or 0xFF) and to only fail if someone is padding more than a single byte. That would still limit the danger of a malicious certificate while not breaking the apparently common single-byte padding that I'm seeing.

That's how I'll move forward for part 2 of this patch until I hear otherwise.</pre></div><div class="change-set" id="c22"><div class="comment" data-id="9513387" data-no="22"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-22" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a2999020_1689"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a2999020_1689"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-22"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-22" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c22">Comment 22</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-28 14:07 PDT" data-time="1414530447">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-22">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-22" data-comment-id="9513387">(In reply to J.C. Jones [:jcj] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - ASN.1 DER decoding of lengths is too permissive, allowing undetected smuggling of arbitrary data"
   href="/show_bug.cgi?id=1064670#c21">comment #21</a>)
<span class="quote">&gt; I've found an interesting thing: after writing a routine to catch padded
&gt; ASN.1 integers that aren't DER-compliant, apparently they are moderately
&gt; common.</span >

Please see pkixder.cpp and pkixder.h to get an idea of what workarounds you need to do to deal with invalid DER in order to be backward compatible with existing certificates. If you implement workarounds that are different than the mozilla::pkix workarounds then please highlight them, as one of the goals of the mozilla::pkix project is to serve as a reference implementation for these types of things.</pre></div><div class="change-set" id="c23"><div class="comment" data-id="9513701" data-no="23"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-23" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_520206" id="a2999020_1689"><img src="https://secure.gravatar.com/avatar/078db09f952a32d7a60ed0a6d149c40d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_520206" id="a2999020_1689"><a class="email " href="/user_profile?user_id=520206" > <span class="fna">J.C. Jones [:jcj] (he/him) [taking a break]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-23"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-23" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c23">Comment 23</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-28 15:00 PDT" data-time="1414533644">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-23">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-23" data-comment-id="9513701">Brian,

As far as I can tell, the pkixder.h implementation of Integer right now only supports parsing positive numbers between 0 and 127 (<a rel="nofollow" href="http://dxr.mozilla.org/mozilla-central/source/security/pkix/lib/pkixder.h?from=pkixder.h#258">http://dxr.mozilla.org/mozilla-central/source/security/pkix/lib/pkixder.h?from=pkixder.h#258</a>), so that's a substantially different constraint than the quickder parser. 

I haven't run into anything putting constraints on INTEGER types elsewhere yet, but I will keep my eyes open.</pre></div><div class="change-set" id="c24"><div class="comment" data-id="9514223" data-no="24"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-24" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1584" id="a2999020_1689"><img src="https://secure.gravatar.com/avatar/3e0b23cde901a6405f541eed3973331c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1584" id="a2999020_1689"><a class="email " href="/user_profile?user_id=1584" > <span class="fna">Wan-Teh Chang</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-24"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-24" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c24">Comment 24</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-28 16:51 PDT" data-time="1414540292">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-24">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-24" data-comment-id="9514223">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8510691" name="attach_8510691" title="This patch intends to handle Brian Smith's original findings; it does not address the other DER-correctness issues for INTEGER, BOOL and such.">attachment 8510691</a> <a href="/attachment.cgi?id=8510691&amp;action=edit" title="This patch intends to handle Brian Smith's original findings; it does not address the other DER-correctness issues for INTEGER, BOOL and such.">[details]</a> <a href="/attachment.cgi?id=8510691&amp;action=diff" title="This patch intends to handle Brian Smith's original findings; it does not address the other DER-correctness issues for INTEGER, BOOL and such.">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064670&amp;attachment=8510691'>[review]</a>
This patch intends to handle Brian Smith's original findings; it does not address the other DER-correctness issues for INTEGER, BOOL and such.

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8510691" name="attach_8510691" title="This patch intends to handle Brian Smith's original findings; it does not address the other DER-correctness issues for INTEGER, BOOL and such.">attachment 8510691</a> <a href="/attachment.cgi?id=8510691&amp;action=edit" title="This patch intends to handle Brian Smith's original findings; it does not address the other DER-correctness issues for INTEGER, BOOL and such.">[details]</a> <a href="/attachment.cgi?id=8510691&amp;action=diff" title="This patch intends to handle Brian Smith's original findings; it does not address the other DER-correctness issues for INTEGER, BOOL and such.">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064670&amp;attachment=8510691'>[review]</a>:
-----------------------------------------------------------------

CJ: thanks a lot for writing the patch quickly, and sorry about the late review.
I reviewed your patch carefully. I believe your sanity check on the long-form
length field has an off-by-one error. Most of my other review comments are
about coding style nits.

::: security/nss/lib/util/quickder.c
&#64;&#64; +20,4 &#64;&#64;
<span class="quote">&gt;                                                PRBool includeTag)
&gt;  {
&gt;      unsigned char tag;
&gt; +    unsigned int buf_idx = 0;</span >

Nit: I think the original variable name 'used_length' is easier to understand in comparisons with buf_length.

&#64;&#64; +27,2 &#64;&#64;
<span class="quote">&gt;  
&gt; +    if (buf_idx &gt;= buf_length) {</span >

Please don't change the braces style unless you change it throughout the
file. Consistency is important.

&#64;&#64; +27,3 &#64;&#64;
<span class="quote">&gt;  
&gt; +    if (buf_idx &gt;= buf_length) {
&gt; +        // Tag field was not found!</span >

Please use old-style C comment delimiters /* */ for consistency.

&#64;&#64; +33,3 &#64;&#64;
<span class="quote">&gt;  
&gt; +    // Exit out when we come to the end of the object
&gt; +    if (tag == 0) {</span >

Do you know what a tag value of 0 means? Is it the end-of-content marker?

&#64;&#64; +36,5 &#64;&#64;
<span class="quote">&gt;          return NULL;
&gt;      }
&gt;  
&gt; +    if ((tag &amp; 0x1F) == 0x1F) {
&gt; +        // TODO: Allow high tag number form?</span >

Nit: should we call this &quot;long tag number form&quot; or &quot;long-form tag number&quot;?

&#64;&#64; +56,3 &#64;&#64;
<span class="quote">&gt;  
&gt; +        // Extract the field length
&gt; +        length_field_len += (byte &amp; 0x7F);</span >

Use = instead of +=.

&#64;&#64; +61,5 &#64;&#64;
<span class="quote">&gt; +            // This is the definite length decoder, after all.
&gt; +            return NULL;
&gt; +        }
&gt; +
&gt; +        if (length_field_len &gt; 4) {</span >

Nit: it may be good to replace 4 with sizeof(data_length), because
that is one reason we allow at most 4 bytes.

&#64;&#64; +67,5 &#64;&#64;
<span class="quote">&gt; +            return NULL;
&gt; +        }
&gt; +
&gt; +        // Iterate across the extended length field
&gt; +        for (size_t i = 0; i &lt; length_field_len; i++) {</span >

Nit: 'i' can be unsigned int.

&#64;&#64; +68,5 &#64;&#64;
<span class="quote">&gt; +        }
&gt; +
&gt; +        // Iterate across the extended length field
&gt; +        for (size_t i = 0; i &lt; length_field_len; i++) {
&gt; +            if (buf_idx &gt;= buf_length) {</span >

You can do a single length check before the for loop:

    if (length_field_len &gt; buf_length - buf_idx)
    {
        /* Extended length field was not found */
        return NULL;
    }

&#64;&#64; +74,4 &#64;&#64;
<span class="quote">&gt;                  return NULL;
&gt;              }
&gt; +            byte = buf[buf_idx++];
&gt; +            // Shift the previous byte left</span >

Nit: this comment can be omitted.

&#64;&#64; +83,5 &#64;&#64;
<span class="quote">&gt; +    // Sanity checks
&gt; +    //
&gt; +
&gt; +    // Determine if the ASN.1 length is longer than needed.
&gt; +    // Add 1 to the minimum sizes so we can do less-than</span >

1. IMPORTANT: adding 1 to the minimum size seems wrong.

For example, if length_field_len is 1, then your check disallow a data_length of 128 (0x80). But I think 128 (0x80) should be allowed.

2. I think we should just do this:

    /* Sanity-check that the long form uses the shortest possible length. */
    if (length_field_len != 0)
    {
        if (length_field_len == 1)
            minimum_size = 1 &lt;&lt; 7;
        else
            minimum_size = 1 &lt;&lt; (8 * (length_field_len - 1));
        if (data_length &lt; minimum_size)
            return NULL;
    }length_field_len

&#64;&#64; +86,5 &#64;&#64;
<span class="quote">&gt; +    // Determine if the ASN.1 length is longer than needed.
&gt; +    // Add 1 to the minimum sizes so we can do less-than
&gt; +    // comparison and properly treat zero-lengths.
&gt; +    unsigned int minimum_size;
&gt; +    switch(length_field_len) {</span >

Nit: add a space after 'switch'.

&#64;&#64; +101,5 &#64;&#64;
<span class="quote">&gt; +            break;
&gt; +    }
&gt; +
&gt; +    if (data_length &lt; minimum_size) {
&gt; +        // (Note: Zero length is OK if length_field_len was 0.)</span >

Nit: this comment should be moved to the case 0 above.

&#64;&#64; +110,2 &#64;&#64;
<span class="quote">&gt;  
&gt; +    if (data_length &gt; (buf_length-buf_idx)) {</span >

Nit: add spaces around '-'.

&#64;&#64; +113,5 &#64;&#64;
<span class="quote">&gt; +        return NULL;
&gt; +    }
&gt; +
&gt; +    if (includeTag) {
&gt; +        // We want to count the tag in the length</span >

Nit: this comment is a little inaccurate -- we also include the length field in *out_data_length. I would just omit this comment. Or you can say if includeTag is true, the returned pointer starts from the tag.

&#64;&#64; +118,5 &#64;&#64;
<span class="quote">&gt; +       data_length += buf_idx;
&gt; +    }
&gt; +
&gt; +    // The length goes into the outpointer data_length; we
&gt; +    // directly return an updated pointer in the buffer.</span >

This comment can be omitted. In general avoid comments that describe the obvious.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8510691&amp;action=edit"
           title="This patch intends to handle Brian Smith's original findings; it does not address the other DER-correctness issues for INTEGER, BOOL and such."
           class=""
        >Attachment #8510691</a> -
        Flags: feedback?(wtc) &rarr; feedback-</div></div></div><div class="change-set" id="c25"><div class="comment" data-id="9514598" data-no="25"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-25" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_520206" id="a2999020_1689"><img src="https://secure.gravatar.com/avatar/078db09f952a32d7a60ed0a6d149c40d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_520206" id="a2999020_1689"><a class="email " href="/user_profile?user_id=520206" > <span class="fna">J.C. Jones [:jcj] (he/him) [taking a break]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-25"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-25" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c25">Comment 25</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-28 18:25 PDT" data-time="1414545934">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-25">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-25" data-comment-id="9514598">(In reply to Wan-Teh Chang from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - ASN.1 DER decoding of lengths is too permissive, allowing undetected smuggling of arbitrary data"
   href="/show_bug.cgi?id=1064670#c24">comment #24</a>)
<span class="quote">&gt; I reviewed your patch carefully. I believe your sanity check on the long-form
&gt; length field has an off-by-one error. Most of my other review comments are
&gt; about coding style nits.</span >

Wan-Teh, thank you! This is why we code review. And also, I'm still getting used to there being different styles in different places. Sorry for the poor style hygiene. It will improve. Unless otherwise noted below, I took all of your changes.

<span class="quote">&gt; &#64;&#64; +33,3 &#64;&#64;
&gt; &gt;  
&gt; &gt; +    // Exit out when we come to the end of the object
&gt; &gt; +    if (tag == 0) {
&gt; 
&gt; Do you know what a tag value of 0 means? Is it the end-of-content marker?</span >

It appears to be how the rest of NSS finds delineates the end-of-content, that all ASN.1 strings end with a NULL that will be read as the next tag.

<span class="quote">&gt; 
&gt; &#64;&#64; +36,5 &#64;&#64;
&gt; &gt;          return NULL;
&gt; &gt;      }
&gt; &gt;  
&gt; &gt; +    if ((tag &amp; 0x1F) == 0x1F) {
&gt; &gt; +        // TODO: Allow high tag number form?
&gt; 
&gt; Nit: should we call this &quot;long tag number form&quot; or &quot;long-form tag number&quot;?</span >

It seems to appear both ways on the Internet. FWIW, Moz::pkix denies the high tags, but to-date NSS allows them. The safe way to resolve the TOODO is to remove this block. In the updated patch it will be gone (for now). Thoughts?

<span class="quote">&gt; 1. IMPORTANT: adding 1 to the minimum size seems wrong.
&gt; 
&gt; For example, if length_field_len is 1, then your check disallow a
&gt; data_length of 128 (0x80). But I think 128 (0x80) should be allowed.</span >

You are absolutely correct. Thank you.</pre></div><div class="change-set" id="c26"><div class="comment" data-id="9514644" data-no="26"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-26" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_520206" id="a2999020_1689"><img src="https://secure.gravatar.com/avatar/078db09f952a32d7a60ed0a6d149c40d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_520206" id="a2999020_1689"><a class="email " href="/user_profile?user_id=520206" > <span class="fna">J.C. Jones [:jcj] (he/him) [taking a break]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-26"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-26" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c26">Comment 26</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-28 18:34 PDT" data-time="1414546454">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-26">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8513137"
         class="attachment patch obsolete"
         data-id="8513137" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug_1064670">
      <meta itemprop="contentSize" content="4862">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8513137">
          <a class="link" href="attachment.cgi?id=8513137&amp;action=diff">
        <span id="att-8513137-description" itemprop="description">bug_1064670</span></a> (obsolete)
        — <a href="attachment.cgi?id=8513137&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1064670&attachment=8513137">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-26" data-comment-id="9514644">Updates per wtc's review.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8510691&amp;action=edit"
           title="This patch intends to handle Brian Smith's original findings; it does not address the other DER-correctness issues for INTEGER, BOOL and such."
           class=""
        >Attachment #8510691</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8513137&amp;action=edit"
           title="bug_1064670"
           class=""
        >Attachment #8513137</a> -
        Flags: feedback?(wtc)</div></div></div><div class="change-set" id="a4369002_152868"><div class="change" id="aa4369002_152868">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_152868" id="a4369002_152868"><img src="https://secure.gravatar.com/avatar/d306c2d94128ba9f5f1830321f99e9c2?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_152868" id="a4369002_152868"><a class="email " href="/user_profile?user_id=152868" > <span class="fna">David Bolter [:davidb] (NeedInfo me for attention)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a4369002_152868"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a4369002_152868">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#a4369002_152868">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-29 10:02 PDT" data-time="1414602132">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox36&amp;o1=isnotempty">status-firefox36</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox36&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox36&amp;o1=isnotempty">tracking-firefox36</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox36&amp;o1=equals&amp;v1=%2B">+</a></div></div></div><div class="change-set" id="c27"><div class="comment" data-id="9518849" data-no="27"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-27" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_520206" id="a4369002_152868"><img src="https://secure.gravatar.com/avatar/078db09f952a32d7a60ed0a6d149c40d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_520206" id="a4369002_152868"><a class="email " href="/user_profile?user_id=520206" > <span class="fna">J.C. Jones [:jcj] (he/him) [taking a break]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-27"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-27" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c27">Comment 27</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-29 10:39 PDT" data-time="1414604376">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-27">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8513644"
         class="attachment patch obsolete"
         data-id="8513644" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug_1064670_part2">
      <meta itemprop="contentSize" content="14770">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8513644">
          <a class="link" href="attachment.cgi?id=8513644&amp;action=diff">
        <span id="att-8513644-description" itemprop="description">More tests, and more DER-compliance checks to quickder.c</span></a> (obsolete)
        — <a href="attachment.cgi?id=8513644&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1064670&attachment=8513644">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-27" data-comment-id="9518849">This patch intends to cover what Antoine brought up in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - ASN.1 DER decoding of lengths is too permissive, allowing undetected smuggling of arbitrary data"
   href="/show_bug.cgi?id=1064670#c12">comment 12</a>, particularly DER-compliance for INTEGER, BIT STRING and BOOLEAN. It's a follow-on to the first patch,  8513137: bug_1064670 (not folded).

Note that per <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - ASN.1 DER decoding of lengths is too permissive, allowing undetected smuggling of arbitrary data"
   href="/show_bug.cgi?id=1064670#c21">comment 21</a>, this patch has a weakened check for INTEGER DER-compliance, allowing one extra padding byte. I chose this by experimentation (since single-byte padding seems to readily exist). I worry that allowing one byte may even not be flexible enough. It may be that we need to do some certificate analysis in the population before choosing a strategy on the INTEGER validation.

The BIT STRING and BOOLEAN validations are equivalent to mozilla::pkix's approaches.</pre><div class="activity"><div class="change">Flags: needinfo?(brian)</div></div></div><div class="change-set" id="c28"><div class="comment" data-id="9519665" data-no="28"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-28" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1584" id="a4369002_152868"><img src="https://secure.gravatar.com/avatar/3e0b23cde901a6405f541eed3973331c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1584" id="a4369002_152868"><a class="email " href="/user_profile?user_id=1584" > <span class="fna">Wan-Teh Chang</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-28"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-28" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c28">Comment 28</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-29 12:45 PDT" data-time="1414611920">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-28">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-28" data-comment-id="9519665">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8513137" name="attach_8513137" title="bug_1064670">attachment 8513137</a> <a href="/attachment.cgi?id=8513137&amp;action=edit" title="bug_1064670">[details]</a> <a href="/attachment.cgi?id=8513137&amp;action=diff" title="bug_1064670">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064670&amp;attachment=8513137'>[review]</a>
bug_1064670

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8513137" name="attach_8513137" title="bug_1064670">attachment 8513137</a> <a href="/attachment.cgi?id=8513137&amp;action=edit" title="bug_1064670">[details]</a> <a href="/attachment.cgi?id=8513137&amp;action=diff" title="bug_1064670">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064670&amp;attachment=8513137'>[review]</a>:
-----------------------------------------------------------------

J.C.: this patch is much better. I'm sorry a suggestion of mine misled you
into avoiding +=. I suggest some other changes.

Nit: you tend to comment every step, a style common in assembly code.
In general try to be more concise, by only summarizing a longer block
of code and only explaining subtle points. Note there are exceptions
to these guidelines. For example, when documenting a function in the
style of a man page it is often required to document the obvious.

::: security/nss/lib/util/quickder.c
&#64;&#64; +30,3 &#64;&#64;
<span class="quote">&gt;          return NULL;
&gt;      }
&gt;      tag = buf[used_length++];</span >

I like your high tag number check. Please add it back.

Note: in your comment for the check, please say something like
&quot;high tag number (a tag number &gt; 30)&quot;. I found that &quot;high tag nunber&quot;
is the term used in the X.690 standard. It would be good to define
that term concisely in the comment.

&#64;&#64; +34,2 &#64;&#64;
<span class="quote">&gt;      if (tag == 0)
&gt; +    {   /* Exit out when we come to the end of the object */</span >

Let's change this comment to something like &quot;End-of-contents octets
should not be present in DER because DER doesn't use the indefinite
length form&quot;.

&#64;&#64; +47,5 &#64;&#64;
<span class="quote">&gt; +        data_length = byte; /* clarity; we're returning a 32-bit int. */
&gt; +    }
&gt; +    else
&gt; +    {   /* Long form, of some manner.
&gt; +           Extract the field length */</span >

Nit: this comment fits in one line.

&#64;&#64; +48,5 &#64;&#64;
<span class="quote">&gt; +    }
&gt; +    else
&gt; +    {   /* Long form, of some manner.
&gt; +           Extract the field length */
&gt; +        length_field_len = length_field_len + (byte &amp; 0x7F);</span >

This should be
    length_field_len = byte &amp; 0x7F;
because we don't need to use the (dummy) initial value of 0.

&#64;&#64; +50,5 &#64;&#64;
<span class="quote">&gt; +    {   /* Long form, of some manner.
&gt; +           Extract the field length */
&gt; +        length_field_len = length_field_len + (byte &amp; 0x7F);
&gt; +        if (length_field_len == 0)
&gt; +        {   /* We don't support the indefinite long form.</span >

Change &quot;indefinite long form&quot; to &quot;indefinite form&quot; or &quot;indefinite length form&quot;.

&#64;&#64; +51,5 &#64;&#64;
<span class="quote">&gt; +           Extract the field length */
&gt; +        length_field_len = length_field_len + (byte &amp; 0x7F);
&gt; +        if (length_field_len == 0)
&gt; +        {   /* We don't support the indefinite long form.
&gt; +               This is the definite length decoder, after all. */</span >

Nit: this entire comment can just say &quot;DER doesn't use the indefinite length form.&quot;

&#64;&#64; +71,2 &#64;&#64;
<span class="quote">&gt;          {
&gt; +            byte = buf[used_length++];</span >

Another way to do the length sanity check is to do it here.
We check the first length byte.

    if (i == 0)
    {
        PRBool too_long = PR_FALSE;
        if (length_field_len == 1)
        {
            too_long = ((byte &amp; 0x80) == 0); /* Short form suffices */
        }
        else
        {
            too_long = (byte == 0); /* This zero byte can be omitted */
        }
        if (too_long)
        {
            /* The length is longer than needed. */
            return NULL;
        }
    }

&#64;&#64; +77,5 &#64;&#64;
<span class="quote">&gt; +    /* Sanity checks */
&gt; +
&gt; +    /* Determine if the ASN.1 length is longer than needed.
&gt; +       Add 1 to the minimum sizes so we can do less-than
&gt; +       comparison and properly treat zero-lengths. */</span >

Delete this stale comment.

&#64;&#64; +78,5 &#64;&#64;
<span class="quote">&gt; +
&gt; +    /* Determine if the ASN.1 length is longer than needed.
&gt; +       Add 1 to the minimum sizes so we can do less-than
&gt; +       comparison and properly treat zero-lengths. */
&gt; +    unsigned int minimum_size;</span >

Move this declaration into the if statement.

NSS still needs to support C compilers that require declaring variables
at the beginning of a block. (We may remove this restriction soon.)

&#64;&#64; +106,4 &#64;&#64;
<span class="quote">&gt;  
&gt; +    if (includeTag)
&gt; +    {
&gt; +        data_length = data_length + used_length;</span >

Use += here.

You misunderstood an earlier suggestion of mine. I suggested replacing += with =
in that case because we don't need to use the initial value of that variable there.
Here we need to increment the variable, so += is more concise.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8513137&amp;action=edit"
           title="bug_1064670"
           class=""
        >Attachment #8513137</a> -
        Flags: feedback?(wtc) &rarr; feedback-</div></div></div><div class="change-set" id="c29"><div class="comment" data-id="9520332" data-no="29"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-29" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_520206" id="a4369002_152868"><img src="https://secure.gravatar.com/avatar/078db09f952a32d7a60ed0a6d149c40d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_520206" id="a4369002_152868"><a class="email " href="/user_profile?user_id=520206" > <span class="fna">J.C. Jones [:jcj] (he/him) [taking a break]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-29"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-29" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c29">Comment 29</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-29 14:26 PDT" data-time="1414618018">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-29">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-29" data-comment-id="9520332">(In reply to Wan-Teh Chang from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - ASN.1 DER decoding of lengths is too permissive, allowing undetected smuggling of arbitrary data"
   href="/show_bug.cgi?id=1064670#c28">comment #28</a>)
<span class="quote">&gt; J.C.: this patch is much better. I'm sorry a suggestion of mine misled you
&gt; into avoiding +=. I suggest some other changes.</span >

Sorry! I've found enough style differences that I didn't blink an eye, I just assumed that was one of them, too.
 
<span class="quote">&gt; Nit: you tend to comment every step, a style common in assembly code.
&gt; In general try to be more concise, by only summarizing a longer block
&gt; of code and only explaining subtle points. Note there are exceptions
&gt; to these guidelines. For example, when documenting a function in the
&gt; style of a man page it is often required to document the obvious.</span >

My apologies; practically all of my C, C++ (and assembly) code has been for US gov't high assurance projects, where high comment-to-code ratios are mandatory. Habits die hard, as they say. I'll be less comment heavy in the future.

Thanks for taking the time to go through this with me. I appreciate your patience!

I'll be back with another updated review probably early AM tomorrow (interrupted for the afternoon).</pre></div><div class="change-set" id="c30"><div class="comment" data-id="9520623" data-no="30"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-30" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a4369002_152868"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a4369002_152868"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-30"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-30" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c30">Comment 30</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-29 15:23 PDT" data-time="1414621407">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-30">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-30" data-comment-id="9520623">NSS and Gecko (including mozilla::pkix) are separate products. Please file another bug in the &quot;Core: Security:PSM&quot; product:component for the changes to pkixder_input_tests.cpp, which are much appreciated. Also, please move the NSS tests from security/pkix/test/gtest to security/nss/test/&lt;something&gt;, for the same reason.

<span class="quote">&gt; I've found an interesting thing: after writing a routine to catch padded
&gt; ASN.1 integers that aren't DER-compliant, apparently they are moderately
&gt; common. There's a comment in quickder.c's DecodeItem() that says:
&gt; 
&gt; &gt; /* remove leading zeroes if the caller requested
&gt; &gt;  siUnsignedInteger
&gt; &gt;  This is to allow RSA key operations to work */
&gt; 
&gt; Assuming that to be true and unavoidable, I added an else that checks for
&gt; over-long (padded) integers. A simple check of
&gt;  
&gt;  if ( item length &gt; 1 &amp;&amp; ( byte[0] == 0x00 || byte[0] == 0xFF ))
&gt;  {
&gt;     abort
&gt;  }
&gt; 
&gt; aborts on Firefox startup with an error that an EV certificate wasn't
&gt; available; I'm not certain what certificate is the source of the problem at
&gt; this point, but clearly there are some compatibility issues.</span >

1. Please identify which certificate is causing the check to fail. You should be able to do this by setting a breakpoint where you put your abort(), and then looking at the stack trace to find which certificate is being parsed.

2. If the most significant bit of the first byte of a positive integer would be set (i.e. that byte's value is 0x80 or higher) then there must be a leading 0x00 to disambiguate it from a negative number. So a leading 0x00 is sometimes necessary.

<span class="quote">&gt; Specifically for the INTEGER type, one way through this is to look for more
&gt; than one padding byte at the front (0x00 or 0xFF) and to only fail if
&gt; someone is padding more than a single byte. That would still limit the
&gt; danger of a malicious certificate while not breaking the apparently common
&gt; single-byte padding that I'm seeing.</span >

I think that a stricter check will probably work: check that there's a leading zero only if the high bit of the second byte is set. See the function CertificateSerialNumber in pkixder.h:

  // Check for overly-long encodings. If the first byte is 0x00 then the high
  // bit on the second byte must be 1; otherwise the same *positive* value
  // could be encoded without the leading 0x00 byte. If the first byte is 0xFF
  // then the second byte must NOT have its high bit set; otherwise the same
  // *negative* value could be encoded without the leading 0xFF byte.
  if (value.GetLength() &gt; 1) {
    Reader valueInput(value);
    uint8_t firstByte;
    rv = valueInput.Read(firstByte);
    if (rv != Success) {
      return rv;
    }
    uint8_t secondByte;
    rv = valueInput.Read(secondByte);
    if (rv != Success) {
      return rv;
    }
    if ((firstByte == 0x00 &amp;&amp; (secondByte &amp; 0x80) == 0) ||
        (firstByte == 0xff &amp;&amp; (secondByte &amp; 0x80) != 0)) {
      return Result::ERROR_BAD_DER;
    }
  }

(In reply to J.C. Jones [:jcj] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - ASN.1 DER decoding of lengths is too permissive, allowing undetected smuggling of arbitrary data"
   href="/show_bug.cgi?id=1064670#c23">comment #23</a>)
<span class="quote">&gt; As far as I can tell, the pkixder.h implementation of Integer right now only
&gt; supports parsing positive numbers between 0 and 127
&gt; (<a rel="nofollow" href="http://dxr.mozilla.org/mozilla-central/source/security/pkix/lib/pkixder">http://dxr.mozilla.org/mozilla-central/source/security/pkix/lib/pkixder</a>.
&gt; h?from=pkixder.h#258), so that's a substantially different constraint than
&gt; the quickder parser. </span >

Right. It turns out that the Integer values we care about in certificates are all very small, so I didn't bother trying to parse bigger integers in that function. Because QuickDER needs to be more general, it needs to support a larger range of values. But, other than the expanded range, I expect that it should be made to work like the functions in pkixder.h/pkixder.cpp.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(brian)</span></div></div></div><div class="change-set" id="c31"><div class="comment" data-id="9520671" data-no="31"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-31" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a4369002_152868"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a4369002_152868"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-31"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-31" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c31">Comment 31</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-29 15:35 PDT" data-time="1414622124">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-31">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-31" data-comment-id="9520671">I highly recommend this document for learning the details of ASN.1 DER encoding/decoding: <a rel="nofollow" href="http://luca.ntop.org/Teaching/Appunti/asn1.html">http://luca.ntop.org/Teaching/Appunti/asn1.html</a>. Also, the ASN.1 reference information on Microsoft's MSDN site was very helpful to me. As a final fallback, the actual specifications for ASN.1 and DER are available for free online, but they are not as accessible as the first two. If you diverge in any way from what the Layman's Guide says, please document that divergence very clearly, as we've done in pkixder.h. I believe the main divergences that are needed are about DEFAULT values (they are not supposed to be explicitly encoded, but they often are in real-world certificates) and empty SEQUENCEs/SETs (some SEQUENCEs/SETs are defined as not being allowed to be empty, but some certificates have encoded them as empty anyway).</pre></div><div class="change-set" id="c32"><div class="comment" data-id="9520698" data-no="32"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-32" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_14661" id="a4369002_152868"><img src="https://secure.gravatar.com/avatar/708ad4f6494aae9c1711a823f447d415?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_14661" id="a4369002_152868"><a class="email " href="/user_profile?user_id=14661" > <span class="fna">Brian Smith (:briansmith, :bsmith, use NEEDINFO?)</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-32"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-32" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c32">Comment 32</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-29 15:39 PDT" data-time="1414622392">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-32">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-32" data-comment-id="9520698">As for the high tag number form and indefinite encoding (which isn't even allowed in DER): I believe that it is likely that none that use QuickDER have any need for the high tag number form or indefinite encoding, so I agree that you can just hard-code simple logic to always forbid them, as we've done in mozilla::pkix.</pre></div><div class="change-set" id="c33"><div class="comment" data-id="9520726" data-no="33"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-33" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1584" id="a4369002_152868"><img src="https://secure.gravatar.com/avatar/3e0b23cde901a6405f541eed3973331c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1584" id="a4369002_152868"><a class="email " href="/user_profile?user_id=1584" > <span class="fna">Wan-Teh Chang</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-33"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-33" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c33">Comment 33</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-29 15:44 PDT" data-time="1414622650">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-33">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-33" data-comment-id="9520726">QuickDER must forbid the indefinite length form. As for high
tag numbers, I don't think QuickDER needs to support them, but
we should detect them and return an (unsupported) error.</pre></div><div class="change-set" id="c34"><div class="comment" data-id="9523179" data-no="34"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-34" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_495955" id="a4369002_152868"><img src="https://secure.gravatar.com/avatar/5aa2e382197a147b42d020b6878f8623?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_495955" id="a4369002_152868"><a class="email " href="/user_profile?user_id=495955" > <span class="fna">Sylvestre Ledru [:Sylvestre]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-34"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-34" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c34">Comment 34</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-30 05:34 PDT" data-time="1414672456">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-34">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-34" data-comment-id="9523179">J.C. any eta for this? Go to build of 33.1 is going to be very soon. Thanks</pre><div class="activity"><div class="change">Flags: needinfo?(jjones)</div></div></div><div class="change-set" id="c35"><div class="comment" data-id="9525272" data-no="35"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-35" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_520206" id="a4369002_152868"><img src="https://secure.gravatar.com/avatar/078db09f952a32d7a60ed0a6d149c40d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_520206" id="a4369002_152868"><a class="email " href="/user_profile?user_id=520206" > <span class="fna">J.C. Jones [:jcj] (he/him) [taking a break]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-35"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-35" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c35">Comment 35</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-30 11:19 PDT" data-time="1414693148">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-35">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-35" data-comment-id="9525272">(In reply to Sylvestre Ledru [:sylvestre] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - ASN.1 DER decoding of lengths is too permissive, allowing undetected smuggling of arbitrary data"
   href="/show_bug.cgi?id=1064670#c34">comment #34</a>)
<span class="quote">&gt; J.C. any eta for this? Go to build of 33.1 is going to be very soon. Thanks</span >

Sylvestre - I'm not entirely sure; I'm doing the newbie thing with moving the new unit test to NSS currently. It's my top priority, but my lack of familiarity (e.g., fighting with even the NSS/gtest build environment) is hindering making an estimate.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(jjones)</span></div></div></div><div class="change-set" id="c36"><div class="comment" data-id="9527329" data-no="36"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-36" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_520206" id="a4369002_152868"><img src="https://secure.gravatar.com/avatar/078db09f952a32d7a60ed0a6d149c40d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_520206" id="a4369002_152868"><a class="email " href="/user_profile?user_id=520206" > <span class="fna">J.C. Jones [:jcj] (he/him) [taking a break]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-36"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-36" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c36">Comment 36</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-30 18:01 PDT" data-time="1414717316">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-36">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8514717"
         class="attachment patch obsolete"
         data-id="8514717" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug_1064670">
      <meta itemprop="contentSize" content="7962">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8514717">
          <a class="link" href="attachment.cgi?id=8514717&amp;action=diff">
        <span id="att-8514717-description" itemprop="description">bug_1064670 test and quickder changes for NSS</span></a> (obsolete)
        — <a href="attachment.cgi?id=8514717&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1064670&attachment=8514717">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-36" data-comment-id="9527329">This patch moves the quickder code and test to properly apply to the tip of NSS as of now, and uses the ssl_gtest to validate it. I folded Brian's test into this patch to move it to NSS as well.

I rolled in all of Wan-Teh's comments from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - ASN.1 DER decoding of lengths is too permissive, allowing undetected smuggling of arbitrary data"
   href="/show_bug.cgi?id=1064670#c28">comment #28</a>. 

I am afraid I haven't addressed the INTEGER, BIT STRING or BOOLEAN issues in this patch. I still need to go through Brian's <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - ASN.1 DER decoding of lengths is too permissive, allowing undetected smuggling of arbitrary data"
   href="/show_bug.cgi?id=1064670#c30">comment 30</a> and handle the issues he identified in the &quot;part 2&quot;, so that is not ready. Since Sylvestre is asking after the original bug, I hope this &quot;part 1&quot; will be close to ready to apply, and maybe I can open follow-up bugs for the new PKIX tests and the other DER compliance issues.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8486180&amp;action=edit"
           title="Test demonstrating the problem (GTest)"
           class=""
        >Attachment #8486180</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8513137&amp;action=edit"
           title="bug_1064670"
           class=""
        >Attachment #8513137</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8514717&amp;action=edit"
           title="bug_1064670 test and quickder changes for NSS"
           class=""
        >Attachment #8514717</a> -
        Flags: review?(wtc)</div></div></div><div class="change-set" id="c37"><div class="comment" data-id="9527993" data-no="37"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-37" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_495955" id="a4369002_152868"><img src="https://secure.gravatar.com/avatar/5aa2e382197a147b42d020b6878f8623?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_495955" id="a4369002_152868"><a class="email " href="/user_profile?user_id=495955" > <span class="fna">Sylvestre Ledru [:Sylvestre]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-37"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-37" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c37">Comment 37</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-31 00:02 PDT" data-time="1414738946">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-37">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-37" data-comment-id="9527993">ok, thanks.
This is probably going to be too late for 33.1.</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox33&amp;o1=isnotempty">status-firefox33</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox33&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox33&amp;o1=equals&amp;v1=wontfix">wontfix</a></div></div></div><div class="change-set" id="a4544354_520206"><div class="change" id="aa4544354_520206">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_520206" id="a4544354_520206"><img src="https://secure.gravatar.com/avatar/078db09f952a32d7a60ed0a6d149c40d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_520206" id="a4544354_520206"><a class="email " href="/user_profile?user_id=520206" > <span class="fna">J.C. Jones [:jcj] (he/him) [taking a break]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a4544354_520206"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a4544354_520206">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#a4544354_520206">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-31 10:44 PDT" data-time="1414777484">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Blocks: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED WONTFIX - Additional tests for ASN.1 non-DER compliant decode errors"
   href="/show_bug.cgi?id=1092241">1092241</a></div></div></div><div class="change-set" id="a4544936_520206"><div class="change" id="aa4544936_520206">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_520206" id="a4544936_520206"><img src="https://secure.gravatar.com/avatar/078db09f952a32d7a60ed0a6d149c40d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_520206" id="a4544936_520206"><a class="email " href="/user_profile?user_id=520206" > <span class="fna">J.C. Jones [:jcj] (he/him) [taking a break]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a4544936_520206"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a4544936_520206">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#a4544936_520206">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-31 10:54 PDT" data-time="1414778066">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">No longer blocks: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED WONTFIX - Additional tests for ASN.1 non-DER compliant decode errors"
   href="/show_bug.cgi?id=1092241">1092241</a></div></div></div><div class="change-set" id="c38"><div class="comment" data-id="9530543" data-no="38"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-38" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_520206" id="a4544936_520206"><img src="https://secure.gravatar.com/avatar/078db09f952a32d7a60ed0a6d149c40d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_520206" id="a4544936_520206"><a class="email " href="/user_profile?user_id=520206" > <span class="fna">J.C. Jones [:jcj] (he/him) [taking a break]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-38"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-38" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c38">Comment 38</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-31 11:30 PDT" data-time="1414780241">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-38">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8515145"
         class="attachment patch obsolete"
         data-id="8515145" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug_1064670_part_2">
      <meta itemprop="contentSize" content="11504">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8515145">
          <a class="link" href="attachment.cgi?id=8515145&amp;action=diff">
        <span id="att-8515145-description" itemprop="description">bug_1064670_part_2  More DER-compliance checks to quickder.c</span></a> (obsolete)
        — <a href="attachment.cgi?id=8515145&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1064670&attachment=8515145">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-38" data-comment-id="9530543">Brian, thank you for the helpful links on ASN.1. You're totally correct, I had forgotten about the need for a leading zero. I've verified the issues I saw with Firefox are all from certificates that needed a leading zero to indicate they were positive, so all is well.

I've adjusted the implementation of the INTEGER checks per your suggestion in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - ASN.1 DER decoding of lengths is too permissive, allowing undetected smuggling of arbitrary data"
   href="/show_bug.cgi?id=1064670#c30">comment 30</a>, and this patch applies on top of the one from earlier today in NSS.

Thanks again Brian and Wah-Teh for all the help as I fumble my way around here.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8513644&amp;action=edit"
           title="More tests, and more DER-compliance checks to quickder.c"
           class=""
        >Attachment #8513644</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8515145&amp;action=edit"
           title="bug_1064670_part_2  More DER-compliance checks to quickder.c"
           class=""
        >Attachment #8515145</a> -
        Flags: review?(wtc)</div></div></div><div class="change-set" id="c39"><div class="comment" data-id="9531174" data-no="39"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-39" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1584" id="a4544936_520206"><img src="https://secure.gravatar.com/avatar/3e0b23cde901a6405f541eed3973331c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1584" id="a4544936_520206"><a class="email " href="/user_profile?user_id=1584" > <span class="fna">Wan-Teh Chang</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-39"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-39" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c39">Comment 39</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-10-31 13:22 PDT" data-time="1414786961">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-39">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-39" data-comment-id="9531174">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8514717" name="attach_8514717" title="bug_1064670 test and quickder changes for NSS">attachment 8514717</a> <a href="/attachment.cgi?id=8514717&amp;action=edit" title="bug_1064670 test and quickder changes for NSS">[details]</a> <a href="/attachment.cgi?id=8514717&amp;action=diff" title="bug_1064670 test and quickder changes for NSS">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064670&amp;attachment=8514717'>[review]</a>
bug_1064670 test and quickder changes for NSS

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8514717" name="attach_8514717" title="bug_1064670 test and quickder changes for NSS">attachment 8514717</a> <a href="/attachment.cgi?id=8514717&amp;action=edit" title="bug_1064670 test and quickder changes for NSS">[details]</a> <a href="/attachment.cgi?id=8514717&amp;action=diff" title="bug_1064670 test and quickder changes for NSS">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064670&amp;attachment=8514717'>[review]</a>:
-----------------------------------------------------------------

J.C.: you can check in your quickder.c changes first. I only
ask for some small changes to the comments.

The quickder_unittest.cc file needs a bit more work. In
particular, I need to know which coding style it should follow.
I only comment on the non-stylistic issues for now.

::: external_tests/ssl_gtest/manifest.mn
&#64;&#64; +6,5 &#64;&#64;
<span class="quote">&gt;  DEPTH      = ../..
&gt;  MODULE = nss
&gt;  
&gt;  CPPSRCS = \
&gt; +      quickder_unittest.cc \</span >

This directory is external_tests/ssl_gtest. We probably
should rename the directory so that it is not SSL specific.
Or create subdirectories for ssl, cert, util, etc.

::: external_tests/ssl_gtest/quickder_unittest.cc
&#64;&#64; +1,1 &#64;&#64;
<span class="quote">&gt; +#include &quot;gtest/gtest.h&quot;</span >

You need to add an MPL 2 header to this file.

&#64;&#64; +3,5 &#64;&#64;
<span class="quote">&gt; +#include &quot;prerror.h&quot;
&gt; +#include &quot;secasn1.h&quot;
&gt; +#include &quot;secerr.h&quot;
&gt; +#include &quot;secitem.h&quot;
&gt; +#include &quot;stdint.h&quot;</span >

stdint.h is a standard library header, so we should use &lt;stdint.h&gt; instead of &quot;stdint.h&quot;.

&#64;&#64; +9,5 &#64;&#64;
<span class="quote">&gt; +class quickder_tests
&gt; +  : public ::testing::Test
&gt; +  , public ::testing::WithParamInterface&lt;SECItem&gt;
&gt; +
&gt; +{</span >

I seem to remember we are following Google's C++ Style Guide for
the C++ test files in NSS. Can you please find out which Style
Guide these files should follow?

&#64;&#64; +38,5 &#64;&#64;
<span class="quote">&gt; +
&gt; +// Length of zero wrongly encoded as:
&gt; +//
&gt; +//     { 0x90, &lt;arbitrary junk&gt;,
&gt; +//       0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 }</span >

0x90 means the long length should be 16 (decimal) bytes long.
So you may want to point out &lt;arbitrary junk&gt; is 8 bytes long.

&#64;&#64; +48,5 &#64;&#64;
<span class="quote">&gt; +// parser would ignore.
&gt; +static uint8_t OVERLONG_LENGTH_16_0[] = {
&gt; +  NULL_TAG,
&gt; +  LONG_LENGTH | 0x10,
&gt; +  0x11, 0x22, 0x33, 0x44, 0x55, 0x65, 0x77, 0x88,</span >

Nit: I guess you meant to type 0x66.

&#64;&#64; +64,5 &#64;&#64;
<span class="quote">&gt; +{
&gt; +  const SECItem&amp; originalInput(GetParam());
&gt; +
&gt; +  // Mozilla's version of the NSS shared library on Windows doesn't export
&gt; +  // the function needed by SEC_ASN1_GET(SEC_NullTemplate), so I've just</span >

SEC_NullTemplate is exported. But you need to access it
using the SEC_ASN1_MKSUB and SEC_ASN1_SUB macros.

Look at lib/certhigh/ocsp.c as an example:
<a rel="nofollow" href="http://mxr.mozilla.org/nss/ident?i=SEC_NullTemplate">http://mxr.mozilla.org/nss/ident?i=SEC_NullTemplate</a>

::: lib/util/quickder.c
&#64;&#64; +29,3 &#64;&#64;
<span class="quote">&gt;  
&gt; +    if (used_length &gt;= buf_length)
&gt; +    {   /* Tag field was not found! */</span >

Nit: we don't usually put a comment at this location (after an
opening curly brace).

In general look around in the file you are modifying and try
to imitate the prevalent style in that file.

I can tell you are trying to conserve the vertical space. But
we value consistency very much. If necessary, we can run this
file through a source code pretty printer first.

&#64;&#64; +39,5 &#64;&#64;
<span class="quote">&gt;          return NULL;
&gt;      }
&gt;  
&gt; +    if ((tag &amp; 0x1F) == 0x1F)
&gt; +    {   /* high tag number (a tag number &gt; 30) */</span >

Nit: please add something like &quot;is not supported&quot; or &quot;is not implemented&quot;
to this comment.

&#64;&#64; +52,4 &#64;&#64;
<span class="quote">&gt;  
&gt; +    if (!(byte &amp; 0x80))
&gt; +    {   /* Short form: The high bit is not set, so the length is the value. */
&gt; +        data_length = byte; /* clarity; we're returning a 32-bit int. */</span >

Nit: this comment isn't that useful... we need to put the value
in data_length in both the short form and long form cases. So
this seems like something we have to do anyway.

Also, it is actually OK to read a byte (unsigned char) into an
unsigned int variable.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8514717&amp;action=edit"
           title="bug_1064670 test and quickder changes for NSS"
           class=""
        >Attachment #8514717</a> -
        Flags: review?(wtc) &rarr; review-</div></div></div><div class="change-set" id="c40"><div class="comment" data-id="9539874" data-no="40"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-40" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_520206" id="a4544936_520206"><img src="https://secure.gravatar.com/avatar/078db09f952a32d7a60ed0a6d149c40d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_520206" id="a4544936_520206"><a class="email " href="/user_profile?user_id=520206" > <span class="fna">J.C. Jones [:jcj] (he/him) [taking a break]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-40"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-40" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c40">Comment 40</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-11-03 14:20 PST" data-time="1415053226">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-40">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8516274"
         class="attachment patch obsolete"
         data-id="8516274" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug_1064670">
      <meta itemprop="contentSize" content="22737">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8516274">
          <a class="link" href="attachment.cgi?id=8516274&amp;action=diff">
        <span id="att-8516274-description" itemprop="description">8514717: bug_1064670 test and quickder changes for NSS; restructure gtests</span></a> (obsolete)
        — <a href="attachment.cgi?id=8516274&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1064670&attachment=8516274">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-40" data-comment-id="9539874">Following up Wah-Teh's review, I've restructured the tests a little bit than Kai had them in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Add gtest framework and initial tests optionally compiled"
   href="/show_bug.cgi?id=1057584#c37">https://bugzilla.mozilla.org/show_bug.cgi?id=1057584#c37</a> .

Specifically, I've renamed external_tests/ssl_gtest to external_tests/gtests/  and created subdirs ssl/ and asn1/. All associated scripts are updated, and I've also edited and updated the tests' README.

<span class="quote">&gt; I seem to remember we are following Google's C++ Style Guide for
&gt; the C++ test files in NSS. Can you please find out which Style
&gt; Guide these files should follow?</span >

That appears to be the intention, per the above <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Add gtest framework and initial tests optionally compiled"
   href="/show_bug.cgi?id=1057584">bug 1057584</a> which I hadn't found until this morning. I've adjusted quickder_unittest.cc and made minor adjustments for compliance into ssl_loopback_unittest.cc. (Technically, clang-format wants to adjust a bunch of spacing too).

I've addressed the other nits as well. Thanks a lot for the pointer to SEC_ASN1_SUB -- I had no idea that's what that did.

At this point should I open a follow-on for the INTEGER, BIT STRING and BOOLEAN compliance checks?</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8514717&amp;action=edit"
           title="bug_1064670 test and quickder changes for NSS"
           class=""
        >Attachment #8514717</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8516274&amp;action=edit"
           title="8514717: bug_1064670 test and quickder changes for NSS; restructure gtests"
           class=""
        >Attachment #8516274</a> -
        Flags: review?(wtc)</div></div></div><div class="change-set" id="c41"><div class="comment" data-id="9555837" data-no="41"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-41" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1584" id="a4544936_520206"><img src="https://secure.gravatar.com/avatar/3e0b23cde901a6405f541eed3973331c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1584" id="a4544936_520206"><a class="email " href="/user_profile?user_id=1584" > <span class="fna">Wan-Teh Chang</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-41"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-41" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c41">Comment 41</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-11-06 10:17 PST" data-time="1415297858">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-41">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-41" data-comment-id="9555837">(In reply to J.C. Jones [:jcj] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - ASN.1 DER decoding of lengths is too permissive, allowing undetected smuggling of arbitrary data"
   href="/show_bug.cgi?id=1064670#c40">comment #40</a>)
<span class="quote">&gt; 
&gt; Specifically, I've renamed external_tests/ssl_gtest to
&gt; external_tests/gtests/  and created subdirs ssl/ and asn1/.</span >

Please name the new directory &quot;gtest&quot; (singular) because &quot;gtest&quot; is
the name of the test framework.

<span class="quote">&gt; At this point should I open a follow-on for the INTEGER, BIT STRING and
&gt; BOOLEAN compliance checks?</span >

That's a good idea. Your current patch should focus on the tag and length
decoding function.</pre></div><div class="change-set" id="c42"><div class="comment" data-id="9556142" data-no="42"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-42" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1584" id="a4544936_520206"><img src="https://secure.gravatar.com/avatar/3e0b23cde901a6405f541eed3973331c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1584" id="a4544936_520206"><a class="email " href="/user_profile?user_id=1584" > <span class="fna">Wan-Teh Chang</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-42"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-42" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c42">Comment 42</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-11-06 11:09 PST" data-time="1415300986">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-42">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-42" data-comment-id="9556142">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8516274" name="attach_8516274" title="8514717: bug_1064670 test and quickder changes for NSS; restructure gtests">attachment 8516274</a> <a href="/attachment.cgi?id=8516274&amp;action=edit" title="8514717: bug_1064670 test and quickder changes for NSS; restructure gtests">[details]</a> <a href="/attachment.cgi?id=8516274&amp;action=diff" title="8514717: bug_1064670 test and quickder changes for NSS; restructure gtests">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064670&amp;attachment=8516274'>[review]</a>
8514717: bug_1064670 test and quickder changes for NSS; restructure gtests

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8516274" name="attach_8516274" title="8514717: bug_1064670 test and quickder changes for NSS; restructure gtests">attachment 8516274</a> <a href="/attachment.cgi?id=8516274&amp;action=edit" title="8514717: bug_1064670 test and quickder changes for NSS; restructure gtests">[details]</a> <a href="/attachment.cgi?id=8516274&amp;action=diff" title="8514717: bug_1064670 test and quickder changes for NSS; restructure gtests">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064670&amp;attachment=8516274'>[review]</a>:
-----------------------------------------------------------------

r=wtc. Please make the suggested changes and attach a new patch.
You can check in the new patch without waiting for my review. I
will review it after the checkin.

Please refrain from making big changes or adding new changes to
this patch. At this point we need to stabilize this patch.

::: external_tests/README
&#64;&#64; +2,5 &#64;&#64;
<span class="quote">&gt;  
&gt;  This directory contains GTest-based unit tests for NSS.
&gt;  
&gt; +Currently, these are broken into TLS-based tests in the tls/ subdirectory,
&gt; +and ASN.1 tests in the asn1/ directory. To make these work:</span >

Just say tests are broken into subdirectories, so that we don't need
to update this comment when a new subdirectory is added.

&#64;&#64; +8,5 &#64;&#64;
<span class="quote">&gt;  - Set NSS_BUILD_GTESTS=1 before starting your build
&gt;  
&gt;  - cd tests/
&gt;  
&gt; +- Set NSS_TESTS=nss_gtests and NSS_CYCLES=standard</span >

Nit: perhaps &quot;nss_gtests&quot; can be shortened to just &quot;gtest&quot;? The &quot;nss_&quot; part is implied.

Or is this referring to the name of the nss_gtest executable program?

Update: after reading the entire patch, I think this should be named &quot;nss_gtest&quot;. This
requires renaming the nss_gtests.sh script to nss_gtest.sh as well.

&#64;&#64; +18,4 &#64;&#64;
<span class="quote">&gt;  
&gt;  You should be able to run the unit tests manually as:
&gt;  
&gt; +  nss_gtest -d ${NSSGTESTDIR}</span >

On the other hand, it is good to keep &quot;NSS&quot; in this environment variable name.

&#64;&#64; +22,2 &#64;&#64;
<span class="quote">&gt;  
&gt; +Where $NSSGTESTDIR the directory created by ./all.sh or a manually</span >

Nit: lowercase &quot;where&quot;

Nit: I think we're missing &quot;is&quot; before &quot;the directory created by&quot;?

&#64;&#64; +29,3 &#64;&#64;
<span class="quote">&gt;  
&gt; +  cd dist/Linux3.16_x86_glibc_PTH_DBG.OBJ/bin
&gt; +  LD_LIBRARY_PATH=../lib/ ./nss_gtest --gtest_filter=&quot;quickder*&quot;</span >

Nit: it is not necessary to quote the argument to --gtest_filter=.

::: external_tests/gtests/asn1/quickder_unittest.cc
&#64;&#64; +1,5 &#64;&#64;
<span class="quote">&gt; +/* -*- Mode: C++; tab-width: 8; indent-tabs-mode: nil; c-basic-offset: 2 -*- */
&gt; +/* vim: set ts=2 et sw=2 tw=80: */
&gt; +/* This Source Code Form is subject to the terms of the Mozilla Public
&gt; + * License, v. 2.0. If a copy of the MPL was not distributed with this file,
&gt; + * You can obtain one at <a rel="nofollow" href="http://mozilla.org/MPL/2.0/">http://mozilla.org/MPL/2.0/</a>. */</span >

Nit: add a blank line after this line.

&#64;&#64; +14,5 &#64;&#64;
<span class="quote">&gt; +#include &quot;secitem.h&quot;
&gt; +
&gt; +namespace nss_test {
&gt; +
&gt; +class quickderTests : public ::testing::Test,</span >

This class should be named QuickDerTest (singular) or QuickDERTest.

&#64;&#64; +25,5 &#64;&#64;
<span class="quote">&gt; +  }
&gt; +};
&gt; +
&gt; +static const uint8_t NULL_TAG = 0x05;
&gt; +static const uint8_t LONG_LENGTH = 0x80;</span >

Nit: in the Google Style Guide, constants should be named as kFooBar.
So these should be named kNullTag and kLongLength.

&#64;&#64; +28,5 &#64;&#64;
<span class="quote">&gt; +static const uint8_t NULL_TAG = 0x05;
&gt; +static const uint8_t LONG_LENGTH = 0x80;
&gt; +
&gt; +// Length of zero wrongly encoded as 0x80 instead of 0x00.
&gt; +static uint8_t OVERLONG_LENGTH_0_0[] = {NULL_TAG, LONG_LENGTH | 0};</span >

Nit: this constant should be named kOverlongLength_0_0.

Similarly for the other OVERLONG_LENGTH_x_y constants.

&#64;&#64; +36,5 &#64;&#64;
<span class="quote">&gt; +
&gt; +// Length of zero wrongly encoded as:
&gt; +//
&gt; +//     { 0x90, &lt;arbitrary junk of 8 bytes&gt;,
&gt; +//       0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 }</span >

Now that I understand what this test case is testing, I suggest
you use exactly four 0x00 bytes at the end, because that's
sufficient to make the original quickder.c code compute a
data length of 0. (The 'data_len' local variable is four bytes
long.)

&#64;&#64; +45,5 &#64;&#64;
<span class="quote">&gt; +// smuggle arbitrary input into DER-encoded data in a way that an non-careful
&gt; +// parser would ignore.
&gt; +static uint8_t OVERLONG_LENGTH_16_0[] = {
&gt; +    NULL_TAG, LONG_LENGTH | 0x10, 0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77,
&gt; +    0x88,     0x00,               0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};</span >

I suggest only four 0x00 bytes at the end. You can use change the other 0x00
bytes to 0x99, 0xaa, 0xbb, etc.

&#64;&#64; +47,5 &#64;&#64;
<span class="quote">&gt; +static uint8_t OVERLONG_LENGTH_16_0[] = {
&gt; +    NULL_TAG, LONG_LENGTH | 0x10, 0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77,
&gt; +    0x88,     0x00,               0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};
&gt; +
&gt; +static const SECItem INVALID_DER[] = {</span >

This constant array should be named kInvalidDer or kInvalidDER.

&#64;&#64; +54,5 &#64;&#64;
<span class="quote">&gt; +    {siBuffer, OVERLONG_LENGTH_16_0, sizeof(OVERLONG_LENGTH_16_0)},
&gt; +};
&gt; +
&gt; +TEST_P(quickderTests, InvalidLengths) {
&gt; +  const SECItem&amp; originalInput(GetParam());</span >

This local variable should be named original_input.

Similarly for the other local variables: copy_of_input, parsed_value, etc.

::: external_tests/gtests/gtest_utils.h
&#64;&#64; +6,5 &#64;&#64;
<span class="quote">&gt;  
&gt;  #ifndef gtest_utils_h__
&gt;  #define gtest_utils_h__
&gt;  
&gt; +#include &quot;test_io.h&quot;</span >

Just wanted to double check that you meant to add this header #include.

In general we should include &quot;test_io.h&quot; only if something inside this
header file needs &quot;test_io.h&quot;.

::: external_tests/gtests/manifest.mn
&#64;&#64; +9,5 &#64;&#64;
<span class="quote">&gt;  CPPSRCS = \
&gt; +      asn1/quickder_unittest.cc \
&gt; +      nss_gtest.cc \
&gt; +      tls/ssl_loopback_unittest.cc \
&gt; +      tls/tls_parser.cc \</span >

Our makefiles are usually hierarchical. That is, we would add
makefiles inside asn1/ and tls/ to compile the source files in
those directories. You can deal with this later.

::: external_tests/gtests/tls/ssl_loopback_unittest.cc
&#64;&#64; +1,5 &#64;&#64;
<span class="quote">&gt; +/* -*- Mode: C++; tab-width: 8; indent-tabs-mode: nil; c-basic-offset: 2 -*- */
&gt; +/* vim: set ts=2 et sw=2 tw=80: */
&gt; +/* This Source Code Form is subject to the terms of the Mozilla Public
&gt; + * License, v. 2.0. If a copy of the MPL was not distributed with this file,
&gt; + * You can obtain one at <a rel="nofollow" href="http://mozilla.org/MPL/2.0/">http://mozilla.org/MPL/2.0/</a>. */</span >

Nit: add a blank line after this line.

&#64;&#64; +21,2 &#64;&#64;
<span class="quote">&gt;  #include &quot;test_io.h&quot;
&gt; +#include &quot;tls/tls_parser.h&quot;</span >

Nit: &quot;tls/&quot; can be omitted because tls_parser.h is in the same directory.
But it may be good style to include &quot;tls/&quot;.

::: external_tests/manifest.mn
&#64;&#64; +6,5 &#64;&#64;
<span class="quote">&gt;  DEPTH      = ..
&gt;  
&gt;  DIRS = \
&gt;  	google_test \
&gt; +  gtests \</span >

Nit: the indentation seems wrong.

::: lib/util/quickder.c
&#64;&#64; +16,5 &#64;&#64;
<span class="quote">&gt;   */
&gt;  
&gt;  static unsigned char* definite_length_decoder(const unsigned char *buf,
&gt; +                                              const unsigned int buf_length,
&gt; +                                              unsigned int *out_data_length,</span >

Just a side note: in general output parameters in NSS don't need to have &quot;out&quot;
in their names. Here I know it is useful for telling it apart from the local
variable &quot;data_length&quot;.

&#64;&#64; +45,2 &#64;&#64;
<span class="quote">&gt;      {
&gt; +        /* high tag number (a tag number &gt; 30) is not supported */</span >

Nit: capitalize &quot;High&quot;.

&#64;&#64; +56,5 &#64;&#64;
<span class="quote">&gt;  
&gt; +    if (!(byte &amp; 0x80))
&gt; +    {
&gt; +        /* Short form: The high bit is not set, so the length is the value. */
&gt; +        data_length = byte; /* clarity; we're returning a 32-bit int. */</span >

Nit: remove this comment. &quot;the length is the value&quot; already describes the
code &quot;data_length = byte&quot;.

&#64;&#64; +60,5 &#64;&#64;
<span class="quote">&gt; +        data_length = byte; /* clarity; we're returning a 32-bit int. */
&gt; +    }
&gt; +    else
&gt; +    {
&gt; +        /* Long form, of some manner. Extract the field length */</span >

Nit: remove &quot;, of some manner&quot;.

&#64;&#64; +73,2 &#64;&#64;
<span class="quote">&gt;          {
&gt; +            /* We don't support longer forms than 4 bytes (2^32) */</span >

Nit: change &quot;longer forms than&quot; to &quot;a long-form length longer than&quot;
or &quot;an extended length field longer than&quot;.

&#64;&#64; +74,5 &#64;&#64;
<span class="quote">&gt; +            /* We don't support longer forms than 4 bytes (2^32) */
&gt; +            return NULL;
&gt; +        }
&gt; +
&gt; +        if (length_field_len &gt; buf_length - used_length)</span >

Nit: let's also parenthesize &quot;buf_length - used_length&quot; to match
the style used on line 110.

::: tests/common/init.sh
&#64;&#64; +75,5 &#64;&#64;
<span class="quote">&gt;          IOPR_OCSP_CLIENTDIR=${HOSTDIR}/client_ocsp_iopr
&gt;  
&gt;          CERT_EXTENSIONS_DIR=${HOSTDIR}/cert_extensions
&gt;          STAPLINGDIR=${HOSTDIR}/stapling
&gt; +        SSLGTESTDIR=${HOSTDIR}/nss_gtests</span >

This shell script variable should be renamed &quot;NSSGTESTDIR&quot;, right?

&#64;&#64; +538,5 &#64;&#64;
<span class="quote">&gt;      R_EXT_SERVERDIR=../ext_server
&gt;      R_EXT_CLIENTDIR=../ext_client
&gt;      R_CERT_EXT=../cert_extensions
&gt;      R_STAPLINGDIR=../stapling
&gt; +    R_SSLGTESTDIR=../nss_gtests</span >

This variable should be renamed &quot;R_NSSGTESTDIR&quot;.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8516274&amp;action=edit"
           title="8514717: bug_1064670 test and quickder changes for NSS; restructure gtests"
           class=""
        >Attachment #8516274</a> -
        Flags: review?(wtc) &rarr; review+</div></div></div><div class="change-set" id="c43"><div class="comment" data-id="9556178" data-no="43"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-43" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1584" id="a4544936_520206"><img src="https://secure.gravatar.com/avatar/3e0b23cde901a6405f541eed3973331c?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1584" id="a4544936_520206"><a class="email " href="/user_profile?user_id=1584" > <span class="fna">Wan-Teh Chang</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-43"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-43" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c43">Comment 43</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-11-06 11:14 PST" data-time="1415301285">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-43">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-43" data-comment-id="9556178">(In reply to Wan-Teh Chang from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - ASN.1 DER decoding of lengths is too permissive, allowing undetected smuggling of arbitrary data"
   href="/show_bug.cgi?id=1064670#c42">comment #42</a>)
<span class="quote">&gt; Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8516274" name="attach_8516274" title="8514717: bug_1064670 test and quickder changes for NSS; restructure gtests">attachment 8516274</a> <a href="/attachment.cgi?id=8516274&amp;action=edit" title="8514717: bug_1064670 test and quickder changes for NSS; restructure gtests">[details]</a> <a href="/attachment.cgi?id=8516274&amp;action=diff" title="8514717: bug_1064670 test and quickder changes for NSS; restructure gtests">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1064670&amp;attachment=8516274'>[review]</a>
&gt; 8514717: bug_1064670 test and quickder changes for NSS; restructure gtests</span >
&gt;
[...]
<span class="quote">&gt; Please refrain from making big changes or adding new changes to
&gt; this patch. At this point we need to stabilize this patch.</span >

Just wanted to stress this point: I am fine with you not renaming the
directories and scripts as I suggested in my review comments. If you
agree with the new names, you can rename them later.</pre></div><div class="change-set" id="c44"><div class="comment" data-id="9560500" data-no="44"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-44" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_520206" id="a4544936_520206"><img src="https://secure.gravatar.com/avatar/078db09f952a32d7a60ed0a6d149c40d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_520206" id="a4544936_520206"><a class="email " href="/user_profile?user_id=520206" > <span class="fna">J.C. Jones [:jcj] (he/him) [taking a break]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-44"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-44" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c44">Comment 44</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-11-07 06:36 PST" data-time="1415371012">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-44">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8518918"
         class="attachment patch"
         data-id="8518918" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug_1064670">
      <meta itemprop="contentSize" content="4455">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8518918">
          <a class="link" href="attachment.cgi?id=8518918&amp;action=diff">
        <span id="att-8518918-description" itemprop="description">bug_1064670 - be more strict on DER length decoding in quickder.c</span></a>
        — <a href="attachment.cgi?id=8518918&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1064670&attachment=8518918">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-44" data-comment-id="9560500">(Carrying forward r=wtc from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - ASN.1 DER decoding of lengths is too permissive, allowing undetected smuggling of arbitrary data"
   href="/show_bug.cgi?id=1064670#c42">comment 42</a>)

Wan-Teh: I accepted all of your changes on quickder.c, they're here in the patch. 

Per wtc's last <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - ASN.1 DER decoding of lengths is too permissive, allowing undetected smuggling of arbitrary data"
   href="/show_bug.cgi?id=1064670#c43">comment 43</a>, I've moved everything that isn't the quickder.c changes into <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Add ASN.1 GTest for non-DER complaint lengths"
   href="/show_bug.cgi?id=1095118">Bug 1095118</a>. Doing that last env variable rename spilled out to yet more files (init.sh and cert.sh), so it seemed best to just stabilize the real important part here.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8515145&amp;action=edit"
           title="bug_1064670_part_2  More DER-compliance checks to quickder.c"
           class=""
        >Attachment #8515145</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8516274&amp;action=edit"
           title="8514717: bug_1064670 test and quickder changes for NSS; restructure gtests"
           class=""
        >Attachment #8516274</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8515145&amp;action=edit"
           title="bug_1064670_part_2  More DER-compliance checks to quickder.c"
           class=""
        >Attachment #8515145</a> -
        Flags: <span class="activity-deleted">review?(wtc)</span></div><div class="change">
        <a href="/attachment.cgi?id=8518918&amp;action=edit"
           title="bug_1064670 - be more strict on DER length decoding in quickder.c"
           class=""
        >Attachment #8518918</a> -
        Flags: review+</div></div></div><div class="change-set" id="c45"><div class="comment" data-id="9561119" data-no="45"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-45" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_520206" id="a4544936_520206"><img src="https://secure.gravatar.com/avatar/078db09f952a32d7a60ed0a6d149c40d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_520206" id="a4544936_520206"><a class="email " href="/user_profile?user_id=520206" > <span class="fna">J.C. Jones [:jcj] (he/him) [taking a break]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-45"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-45" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c45">Comment 45</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-11-07 08:43 PST" data-time="1415378607">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-45">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-45" data-comment-id="9561119">Marking checkin-needed.</pre><div class="activity"><div class="change">Keywords: <a href="/buglist.cgi?keywords=checkin-needed&amp;resolution=---">checkin-needed</a></div></div></div><div class="change-set" id="c46"><div class="comment" data-id="9563990" data-no="46"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-46" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a4544936_520206"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a4544936_520206"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-46"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-46" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c46">Comment 46</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-11-07 20:47 PST" data-time="1415422075">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-46">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-46" data-comment-id="9563990"><a rel="nofollow" href="https://hg.mozilla.org/projects/nss/rev/a163e09dc4d5">https://hg.mozilla.org/projects/nss/rev/a163e09dc4d5</a></pre><div class="activity"><div class="change">Status: ASSIGNED &rarr; RESOLVED</div><div class="change">Closed: <span class="rel-time" title="2014-11-07 20:47 PST" data-time="1415422075">7 years ago</span></div><div class="change">Keywords: <span class="activity-deleted"><a href="/buglist.cgi?keywords=checkin-needed&amp;resolution=---">checkin-needed</a></span></div><div class="change">Resolution: --- &rarr; FIXED</div></div></div><div class="change-set" id="a5188957_438654"><div class="change" id="aa5188957_438654">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a5188957_438654"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_438654" id="a5188957_438654"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a5188957_438654"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a5188957_438654">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#a5188957_438654">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-11-07 20:48 PST" data-time="1415422087">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8518918&amp;action=edit"
           title="bug_1064670 - be more strict on DER length decoding in quickder.c"
           class=""
        >Attachment #8518918</a> -
        Flags: checked-in+</div></div></div><div class="change-set" id="c47"><div class="comment" data-id="9569086" data-no="47"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-47" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a5188957_438654"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a5188957_438654"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-47"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-47" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c47">Comment 47</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-11-10 10:24 PST" data-time="1415643892">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-47">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-47" data-comment-id="9569086">This appears to have landed on the wrong branch, &quot;tip&quot; (3.16.2.3) vs &quot;default&quot; (3.18 beta). Is that what you intended, Martin?</pre><div class="activity"><div class="change">Flags: needinfo?(martin.thomson)</div></div></div><div class="change-set" id="c48"><div class="comment" data-id="9569102" data-no="48"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-48" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_424995" id="a5188957_438654"><img src="https://secure.gravatar.com/avatar/44db89c3c0e0ff5a5bff6afac6e68a17?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_424995" id="a5188957_438654"><a class="email disabled" href="/user_profile?user_id=424995" > <span class="fna">Lawrence Mandel [:lmandel] (use needinfo)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-48"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-48" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c48">Comment 48</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-11-10 10:29 PST" data-time="1415644143">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-48">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-48" data-comment-id="9569102">dveditz confirmed that this issue is not critical enough to take this late in 34. As such, I'm marking 34 as wontfix.</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox34&amp;o1=isnotempty">status-firefox34</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox34&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox34&amp;o1=equals&amp;v1=wontfix">wontfix</a></div></div></div><div class="change-set" id="a5412283_1689"><div class="change" id="aa5412283_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a5412283_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a5412283_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a5412283_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a5412283_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#a5412283_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-11-10 10:50 PST" data-time="1415645413">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox34&amp;o1=isnotempty">status-firefox34</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox34&amp;o1=equals&amp;v1=wontfix">wontfix</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox34&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">Whiteboard: sec-low/moderate after fix in bug 1064636, we don't know of any other exploitable paths</div></div></div><div class="change-set" id="a5412310_1689"><div class="change" id="aa5412310_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a5412310_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a5412310_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a5412310_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a5412310_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#a5412310_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-11-10 10:50 PST" data-time="1415645440">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox34&amp;o1=isnotempty">status-firefox34</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox34&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox34&amp;o1=equals&amp;v1=wontfix">wontfix</a></div></div></div><div class="change-set" id="c49"><div class="comment" data-id="9569268" data-no="49"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-49" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a5412310_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a5412310_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-49"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-49" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c49">Comment 49</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-11-10 10:51 PST" data-time="1415645514">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-49">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-49" data-comment-id="9569268">(In reply to Daniel Veditz [:dveditz] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - ASN.1 DER decoding of lengths is too permissive, allowing undetected smuggling of arbitrary data"
   href="/show_bug.cgi?id=1064670#c47">comment #47</a>)
<span class="quote">&gt; This appears to have landed on the wrong branch, &quot;tip&quot; (3.16.2.3)</span >

I guess it doesn't hurt to have it on that branch since we may want this fixed on ESR31, but it needs to land on the 3.18 mainline for sure.</pre></div><div class="change-set" id="c50"><div class="comment" data-id="9569546" data-no="50"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-50" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a5412310_1689"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a5412310_1689"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-50"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-50" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c50">Comment 50</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-11-10 11:27 PST" data-time="1415647647">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-50">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-50" data-comment-id="9569546">Thanks for catching that Dan.  I'll land it on default.  (another reason that I shouldn't be allowed access to hg).</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(martin.thomson)</span></div></div></div><div class="change-set" id="c51"><div class="comment" data-id="9569560" data-no="51"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-51" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_438654" id="a5412310_1689"><img src="https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_438654" id="a5412310_1689"><a class="email " href="/user_profile?user_id=438654" > <span class="fna">Martin Thomson [:mt:]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-51"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-51" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c51">Comment 51</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-11-10 11:29 PST" data-time="1415647789">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-51">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-51" data-comment-id="9569560"><a rel="nofollow" href="https://hg.mozilla.org/projects/nss/rev/e9a7991380db">https://hg.mozilla.org/projects/nss/rev/e9a7991380db</a></pre></div><div class="change-set" id="a5973559_36541"><div class="change" id="aa5973559_36541">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a5973559_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_36541" id="a5973559_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a5973559_36541"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a5973559_36541">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#a5973559_36541">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-11-16 22:44 PST" data-time="1416206689">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Target Milestone: --- &rarr; 3.18</div></div></div><div class="change-set" id="a7204081_36541"><div class="change" id="aa7204081_36541">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a7204081_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_36541" id="a7204081_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a7204081_36541"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a7204081_36541">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#a7204081_36541">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-12-01 04:33 PST" data-time="1417437211">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Target Milestone: 3.18 &rarr; 3.17.3</div></div></div><div class="change-set" id="c52"><div class="comment" data-id="9659902" data-no="52"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-52" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a7204081_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a7204081_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-52"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-52" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c52">Comment 52</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-12-04 03:15 PST" data-time="1417691723">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-52">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-52" data-comment-id="9659902"><span class="quote">&gt; This appears to have landed on the wrong branch, &quot;tip&quot; (3.16.2.3)</span >

Clarification:

The patch was added to the 3.16.2 branch, but it was added on the branch after the creation of the 3.16.2.3 release.

It could potentially become part of a 3.16.2.4 release, if we decided to create one.</pre></div><div class="change-set" id="c53"><div class="comment" data-id="9663614" data-no="53"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-53" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a7204081_36541"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a7204081_36541"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-53"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-53" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c53">Comment 53</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-12-05 06:43 PST" data-time="1417790612">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-53">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-53" data-comment-id="9663614">Should we update b2g32/b2g34/beta35 from 3.17.2 to 3.17.3 for this fix?</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_1_4&amp;o1=isnotempty">status-b2g-v1.4</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_1_4&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_2_0&amp;o1=isnotempty">status-b2g-v2.0</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_2_0&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_2_0m&amp;o1=isnotempty">status-b2g-v2.0M</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_2_0m&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_2_1&amp;o1=isnotempty">status-b2g-v2.1</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_2_1&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_2_2&amp;o1=isnotempty">status-b2g-v2.2</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_2_2&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox36&amp;o1=isnotempty">status-firefox36</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox36&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox36&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox37&amp;o1=isnotempty">status-firefox37</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox37&amp;o1=equals&amp;v1=fixed">fixed</a></div></div></div><div class="change-set" id="c54"><div class="comment" data-id="9716350" data-no="54"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-54" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_272375" id="a7204081_36541"><img src="https://secure.gravatar.com/avatar/d5497c1ef1eb10029cff0fef1764e7fa?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_272375" id="a7204081_36541"><a class="email " href="/user_profile?user_id=272375" > <span class="fna">Lukas Blakk [:lsblakk] use ?needinfo</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-54"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-54" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c54">Comment 54</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-12-19 11:11 PST" data-time="1419016262">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-54">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-54" data-comment-id="9716350">Is this safe to uplift?  If it's going to get into 35, it should get nominated by Dec 22.</pre><div class="activity"><div class="change">Flags: needinfo?(jjones)</div></div></div><div class="change-set" id="c55"><div class="comment" data-id="9717079" data-no="55"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-55" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_520206" id="a7204081_36541"><img src="https://secure.gravatar.com/avatar/078db09f952a32d7a60ed0a6d149c40d?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_520206" id="a7204081_36541"><a class="email " href="/user_profile?user_id=520206" > <span class="fna">J.C. Jones [:jcj] (he/him) [taking a break]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-55"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-55" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c55">Comment 55</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-12-19 13:11 PST" data-time="1419023463">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-55">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-55" data-comment-id="9717079">Lukas: It's included in NSS 3.173 (<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Upgrade Mozilla 36 to use NSS 3.17.3"
   href="/show_bug.cgi?id=1088969">bug 1088969</a>) but that has larger changes that we probably don't want to uplift. After consulting with keeler, it seems that if we want to include this in 35 we'd need to private patch it in. This patch on its own is not dependent on anything else, and should be safe to uplift.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(jjones)</span></div></div></div><div class="change-set" id="c56"><div class="comment" data-id="9744276" data-no="56"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-56" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_272375" id="a7204081_36541"><img src="https://secure.gravatar.com/avatar/d5497c1ef1eb10029cff0fef1764e7fa?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_272375" id="a7204081_36541"><a class="email " href="/user_profile?user_id=272375" > <span class="fna">Lukas Blakk [:lsblakk] use ?needinfo</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-56"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-56" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c56">Comment 56</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2014-12-31 10:06 PST" data-time="1420049170">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-56">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-56" data-comment-id="9744276">Thanks JC. Given that we've wontfixed it for several cycles and we're very late in the 35 cycle, it's not worth the risk to mess around here and instead let it ride to general release in 36.</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox35&amp;o1=isnotempty">status-firefox35</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox35&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox35&amp;o1=equals&amp;v1=wontfix">wontfix</a></div></div></div><div class="change-set" id="c57"><div class="comment" data-id="9929554" data-no="57"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-57" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a7204081_36541"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_280903" id="a7204081_36541"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-57"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-57" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c57">Comment 57</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-02-17 17:53 PST" data-time="1424224383">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-57">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-57" data-comment-id="9929554">Did we ever make a 3.16.2.4 release of NSS for ESR31?</pre><div class="activity"><div class="change">Whiteboard: sec-low/moderate after fix in bug 1064636, we don't know of any other exploitable paths &rarr; [adv-main36+] sec-low/moderate after fix in bug 1064636, we don't know of any other exploitable paths</div></div></div><div class="change-set" id="a14240801_280903"><div class="change" id="aa14240801_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a14240801_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a14240801_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a14240801_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a14240801_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#a14240801_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-02-20 15:12 PST" data-time="1424473931">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: [adv-main36+] sec-low/moderate after fix in bug 1064636, we don't know of any other exploitable paths &rarr; [adv-main36-] sec-low/moderate after fix in bug 1064636, we don't know of any other exploitable paths</div></div></div><div class="change-set" id="c58"><div class="comment" data-id="9942354" data-no="58"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-58" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a14240801_280903"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a14240801_280903"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-58"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-58" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#c58">Comment 58</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-02-20 15:21 PST" data-time="1424474460">7 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-58">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-58" data-comment-id="9942354">(In reply to Al Billings [:abillings] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - ASN.1 DER decoding of lengths is too permissive, allowing undetected smuggling of arbitrary data"
   href="/show_bug.cgi?id=1064670#c57">comment #57</a>)
<span class="quote">&gt; Did we ever make a 3.16.2.4 release of NSS for ESR31?</span >

No, nobody asked for it, after I offered it in the above comment.</pre></div><div class="change-set" id="a22096668_75935"><div class="change" id="aa22096668_75935">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a22096668_75935"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_75935" id="a22096668_75935"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a22096668_75935"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a22096668_75935">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#a22096668_75935">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-05-22 14:23 PDT" data-time="1432329798">7 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_1_4&amp;o1=isnotempty">status-b2g-v1.4</a>:
          <a href="/buglist.cgi?f1=cf_status_b2g_1_4&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_1_4&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_2_1_s&amp;o1=isnotempty">status-b2g-v2.1S</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_2_1_s&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr31&amp;o1=isnotempty">status-firefox-esr31</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox_esr31&amp;o1=equals&amp;v1=%3F">?</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr31&amp;o1=equals&amp;v1=affected">affected</a></div></div></div><div class="change-set" id="a180138737_578488"><div class="change" id="aa180138737_578488">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_578488" id="a180138737_578488"><img src="https://secure.gravatar.com/avatar/6822db445808be789b12cfae22d118dc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_578488" id="a180138737_578488"><a class="email " href="/user_profile?user_id=578488" > <span class="fna">Tom Ritter [:tjr] (ni? for response to CVE/sec-approval/advisories/etc)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a180138737_578488"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a180138737_578488">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1064670#a180138737_578488">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-05-24 18:57 PDT" data-time="1590371867">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: sec-bounty-hof+</div><div class="change">QA Contact: jjones</div></div></div><div id="new-comment-notice">
          You need to <a href="/show_bug.cgi?id=1064670&amp;GoAheadAndLogIn=1">log in</a>
          before you can comment on or make changes to this bug.
        </div>



<div id="bottom-actions">
  <div id="bottom-right-actions">
    <button type="button" id="top-btn" class="secondary" aria-label="Go to Page Top">Top &uarr;</button>
  </div>
</div></div> 
</main> 
</div> 


</body>
</html>