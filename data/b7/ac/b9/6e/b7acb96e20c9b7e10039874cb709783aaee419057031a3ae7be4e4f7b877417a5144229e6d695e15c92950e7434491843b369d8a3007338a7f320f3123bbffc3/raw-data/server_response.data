<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
  "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>
    
    
      
    
    
      Issue 2067933002: Use correct origin when prompting for proxy authentication. -
    
    Code Review
  </title>
  <link rel="icon" href="/static/favicon.ico" />
  <link type="text/css" rel="stylesheet"
  href="/static/styles.css?v=408576698
" />
  <script type="text/javascript" src="/static/autocomplete/lib/jquery.js"></script>
  <script type="text/javascript"
    src="/static/script.js?v=408576698
"></script>
   <!-- head block to insert js/css for forms processing -->
   
   <!-- /head -->
</head>
<body onunload="M_unloadPage();">

<!-- Begin help window -->
<script type="text/javascript"><!--
var xsrfToken = '2d2e2df6b4ded35a8e7bedfddaf197d6';
var helpDisplayed = false;
document.onclick = M_clickCommon;
var media_url = "/static/";
var base_url = "/";
// -->
</script>
<div id="help" style="display: none;">

<div style="font-size: medium; text-align: center;">Keyboard Shortcuts</div>
<hr />
<table class="shortcuts">
  <tr valign="top">
    <td>
      <table>
        <tr>
          <td></td><th>File</th>
        </tr>
        <tr>
          <td><span>u</span> <b>:</b></td><td>up to issue</td>
        </tr>
        <tr>
          <td><span>j</span> / <span>k</span> <b>:</b></td><td>jump to file after / before current file</td>
        </tr>
        <tr>
          <td><span>J</span> / <span>K</span> <b>:</b></td><td>jump to next file with a comment after / before current file</td>
        </tr>
        <tr>
          <td></td><th>Side-by-side diff</th>
        </tr>
        <tr>
          <td><span>i</span> <b>:</b></td><td>toggle intra-line diffs</td>
        </tr>
        <tr>
          <td><span>e</span> <b>:</b></td><td>expand all comments</td>
        </tr>
        <tr>
          <td><span>c</span> <b>:</b></td><td>collapse all comments</td>
        </tr>
        <tr>
          <td><span>s</span> <b>:</b></td><td>toggle showing all comments</td>
        </tr>
        <tr>
          <td><span>n</span> / <span>p</span> <b>:</b></td><td>next / previous diff chunk or comment</td>
        </tr>
        <tr>
          <td><span>N</span> / <span>P</span> <b>:</b></td><td>next / previous comment</td>
        </tr>
        <tr>
          <td><span>&lt;Up&gt;</span> / <span>&lt;Down&gt;</span> <b>:</b></td><td>next / previous line</td>
        </tr>
      </table>
    </td>
    <td>
      <table>
        <tr>
          <td></td><th>Issue</th>
        </tr>
        <tr>
          <td><span>u</span> <b>:</b></td><td>up to list of issues</td>
        </tr>
        <tr>
          <td><span>j</span> / <span>k</span> <b>:</b></td><td>jump to patch after / before current patch</td>
        </tr>
        <tr>
          <td><span>o</span> / <span>&lt;Enter&gt;</span> <b>:</b></td><td>open current patch in side-by-side view</td>
        </tr>
        <tr>
          <td><span>i</span> <b>:</b></td><td>open current patch in unified diff view</td>
        </tr>
        <tr><td>&nbsp;</td></tr>
          <tr><td></td><th>Issue List</th></tr>
        <tr>
          <td><span>j</span> / <span>k</span> <b>:</b></td><td>jump to issue after / before current issue</td>
        </tr>
        <tr>
          <td><span>o</span> / <span>&lt;Enter&gt;</span> <b>:</b></td><td>open current issue</td>
        </tr>
      </table>
    </td>
  </tr>

</table>
</div>
<!-- End help window -->

<div align="right">

<div style="float:left; font-size:x-large"><img style="vertical-align:middle" src="/static/chromium-24.png" /> Chromium Code Reviews</div>




<b>chromiumcodereview-hr@appspot.gserviceaccount.com (chromiumcodereview-hr)</b>
|

<span style="color:red">Please choose your nickname with</span>
<a class="novisit" href="/settings">Settings</a>
|


<a class="novisit" target="_blank"
   href="http://code.google.com/p/rietveld/wiki/CodeReviewHelp">Help</a>

|
<a class="novisit" href="http://www.chromium.org/">Chromium Project</a>
|
<a class="novisit" href="https://chromium-review.googlesource.com/dashboard/self?polygerrit=1">Gerrit Changes</a>
|

<a class="novisit" href="https://codereview.chromium.org/_ah/logout?continue=https://accounts.google.com/Logout%3Fcontinue%3Dhttps://uc.appengine.google.com/_ah/logout%253Fcontinue%253Dhttps://google.com/url%25253Fsa%25253DD%252526q%25253Dhttps://codereview.chromium.org/2067933002%252526ust%25253D1608650137300151%252526usg%25253DAFQjCNHaud15-jt19b9h0ctXwjVoZiEPFQ%26service%3Dah">Sign out</a>

</div>
<div class="counter">(43)</div>
<br />
<div class="mainmenu">
  
  <a href="/" class="active">Issues</a>
  <a href="/search">Search</a>

</div>
<div class="mainmenu2">
  
  
    &nbsp;&nbsp;&nbsp;
    <a href="/mine">My Issues</a>
    |
    <a href="/starred">Starred</a>
    &nbsp;&nbsp;&nbsp;
    <a href="/all?closed=0">Open</a>
    |
    <a href="/all?closed=1">Closed</a>
    |
    <a href="/all">All</a>
  

</div>

<div>

  <h2>
    <span id="issue-star-2067933002">
  
    
      <img src="/static/star-dark.gif" width="15" height="15" border="0">
    
  
</span>

    Issue <a href="/2067933002/"
               onmouseover="M_showPopUp(this, 'popup-issue');">
            2067933002</a>:
    Use correct origin when prompting for proxy authentication.  (Closed) 
  </h2>

  <table class="issue-details" border="0" width="100%">
    <tr valign="top">

      <td class="meta" width="20%">
        <div class="issue_details_sidebar">
          <div><b>Created:</b><br/>
            4 years, 6 months ago by <a href="/user/asanka" onMouseOver="M_showUserInfoPopup(this)">asanka</a>
          </div>
          <div><b>Modified:</b><br/>
            4 years, 6 months ago
          </div>
          <div><b>Reviewers:</b><br/>
            <span class='approval'><a href="/user/vabr%20(Chromium)" onMouseOver="M_showUserInfoPopup(this)">vabr (Chromium)</a></span>, <span class='approval'><a href="/user/jam" onMouseOver="M_showUserInfoPopup(this)">jam</a></span>, <span class='approval'><a href="/user/meacer" onMouseOver="M_showUserInfoPopup(this)">meacer</a></span>
          </div>
          
          <div><b>CC:</b><br/>
            achuith+watch_chromium.org, cbentzel+watch_chromium.org, dzhioev+watch_chromium.org, Pawe≈Ç Hajdan Jr., vabr+watchlistlogin_chromium.org
          </div>
          
          
          <div><b>Base URL:</b><br/>
            
            https://chromium.googlesource.com/chromium/src.git@master
            
          </div>
          
          
          <div><b>Target Ref:</b><br/>
            refs/pending/heads/master
          </div>
          
          
          <div><b>Project:</b><br/>
            <a href="/search?project=chromium">
              chromium
            </a>
          </div>
          
          <div><b>Visibility:</b><br/>
            
                Public.
            
          </div>
          
          <div><a title="Find reviews for the same repository ID - c14d891d44f0afff64e56ed7c9702df1d807b1ee"
               href="/search?repo_guid=c14d891d44f0afff64e56ed7c9702df1d807b1ee">
            <b>More Reviews</b></a>
          </div>
          
        </div>
      </td>

      <td style="padding-left: .8em; padding-right: .8em;" width="80%">
        




  <h3><a id="issue-description-pointer"
     href="javascript:M_toggleSection('issue-description')"
     class="toggled-section opentriangle">
    Description</a></h3>
  <div id="issue-description">Use correct origin when prompting for proxy authentication.

Since M49, Chrome has been prompting for proxy authentication
credentials using the target origin instead of the origin of the proxy
server. Even if the proxy origin was displayed correctly, a mischievous
network operator could still spoof the proxy server origin. To mitigate
these problems, this CL:

* Fixes the origin used in the proxy authentication login prompt to use
  the origin of the proxy server.

* Indicate if the proxy server connection is insecure.

* Always throw up an interstitial and clear the omnibox when showing a
  proxy auth prompt.

* Use the correct origin when saving proxy authentication credentials.

BUG=<a href="https://bugs.chromium.org/p/chromium/issues/detail?id=613626">613626</a>, <a href="https://bugs.chromium.org/p/chromium/issues/detail?id=620737">620737</a>
Committed: <a href="https://crrev.com/098c009df7a4ddc5c23d4d3c9dccf5eff1f24c98">https://crrev.com/098c009df7a4ddc5c23d4d3c9dccf5eff1f24c98</a>
Cr-Commit-Position: refs/heads/master@{#400247}
  </div>




  <h3>
    <a id="ps-1-pointer"
       href="/2067933002/#ps1"
       onclick="M_toggleSectionForPS('2067933002', '1')"
       class="toggled-section ">
      Patch Set 1
      
      <span class="anchor">#</span>
    </a>
  </h3>

  
    <div>
      <i>Total comments:</i> 19
      
    </div>
  

  <div id="ps-1"
  
       style="display:none">
  
  </div>
  

  <h3>
    <a id="ps-20001-pointer"
       href="/2067933002/#ps20001"
       onclick="M_toggleSectionForPS('2067933002', '20001')"
       class="toggled-section ">
      Patch Set 2
      : Address comments. Remove no-op string change and origin.h change.
      <span class="anchor">#</span>
    </a>
  </h3>

  

  <div id="ps-20001"
  
       style="display:none">
  
  </div>
  

  <h3>
    <a id="ps-40001-pointer"
       href="/2067933002/#ps40001"
       onclick="M_toggleSectionForPS('2067933002', '40001')"
       class="toggled-section opentriangle">
      Patch Set 3
      : Fix content_shell build.
      <span class="anchor">#</span>
    </a>
  </h3>

  

  <div id="ps-40001"
  
       style="">
    
<div class="issue-list">

  <div class="pagination">
    <div style="float: left;">
      <i>Created:</i> 4 years, 6 months ago
    </div>
    <div style="float: right;">
      
        Download
          <a href="/download/issue2067933002_40001.diff"
            title="Patchset in text format">[raw]</a>
          <a href="/tarball/2067933002/40001"
            title="Tarball containing the original and patched files">[tar.bz2]</a>
      
    </div>
    <div style="clear:both;"></div>
  </div>

  <table id="queues" style="clear:both;">
    <tr align="left">
      <th colspan="2"></th>
      <th>Unified diffs</th>
      <th>Side-by-side diffs</th>
      <th>Delta from patch set</th>
      <th colspan="3">Stats <font style='font-weight: normal'>(<i>+359 lines, -186 lines</i>)</font></th>
      <th>Patch</th>
    </tr>

    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2067933002/patch/40001/50002">
            chrome/browser/ui/login/login_handler.h
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2067933002/diff/40001/chrome/browser/ui/login/login_handler.h">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/2067933002/diff2/1:40001/chrome/browser/ui/login/login_handler.h"
             title="Delta from patch set 1">1</a>
        
        </td>
        
          <td style="white-space: nowrap">5 chunks</td>
          <td style="white-space: nowrap">+45 lines, -6 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2067933002_40001_50002.diff"
             title="Download patch for chrome/browser/ui/login/login_handler.h">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2067933002/patch/40001/50001">
            chrome/browser/ui/login/login_handler.cc
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2067933002/diff/40001/chrome/browser/ui/login/login_handler.cc">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/2067933002/diff2/1:40001/chrome/browser/ui/login/login_handler.cc"
             title="Delta from patch set 1">1</a>
        
        </td>
        
          <td style="white-space: nowrap">6 chunks</td>
          <td style="white-space: nowrap">+155 lines, -130 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2067933002_40001_50001.diff"
             title="Download patch for chrome/browser/ui/login/login_handler.cc">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2067933002/patch/40001/50003">
            chrome/browser/ui/login/login_handler_unittest.cc
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2067933002/diff/40001/chrome/browser/ui/login/login_handler_unittest.cc">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/2067933002/diff2/1:40001/chrome/browser/ui/login/login_handler_unittest.cc"
             title="Delta from patch set 1">1</a>
        
        </td>
        
          <td style="white-space: nowrap">1 chunk</td>
          <td style="white-space: nowrap">+127 lines, -29 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2067933002_40001_50003.diff"
             title="Download patch for chrome/browser/ui/login/login_handler_unittest.cc">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2067933002/patch/40001/50004">
            content/shell/browser/shell_login_dialog.cc
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2067933002/diff/40001/content/shell/browser/shell_login_dialog.cc">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/2067933002/diff2/1:40001/content/shell/browser/shell_login_dialog.cc"
             title="Delta from patch set 1">1</a>
        
          <a href="/2067933002/diff2/20001:40001/content/shell/browser/shell_login_dialog.cc"
             title="Delta from patch set 2">2</a>
        
        </td>
        
          <td style="white-space: nowrap">2 chunks</td>
          <td style="white-space: nowrap">+5 lines, -3 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2067933002_40001_50004.diff"
             title="Download patch for content/shell/browser/shell_login_dialog.cc">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2067933002/patch/40001/50006">
            net/base/auth.h
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2067933002/diff/40001/net/base/auth.h">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
        </td>
        
          <td style="white-space: nowrap">2 chunks</td>
          <td style="white-space: nowrap">+2 lines, -2 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2067933002_40001_50006.diff"
             title="Download patch for net/base/auth.h">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2067933002/patch/40001/50005">
            net/base/auth.cc
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2067933002/diff/40001/net/base/auth.cc">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
        </td>
        
          <td style="white-space: nowrap">1 chunk</td>
          <td style="white-space: nowrap">+1 line, -2 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2067933002_40001_50005.diff"
             title="Download patch for net/base/auth.cc">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2067933002/patch/40001/50007">
            net/http/http_auth_controller.cc
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2067933002/diff/40001/net/http/http_auth_controller.cc">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
        </td>
        
          <td style="white-space: nowrap">1 chunk</td>
          <td style="white-space: nowrap">+1 line, -1 line</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2067933002_40001_50007.diff"
             title="Download patch for net/http/http_auth_controller.cc">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2067933002/patch/40001/50008">
            net/http/http_network_transaction_unittest.cc
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2067933002/diff/40001/net/http/http_network_transaction_unittest.cc">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
          <a href="/2067933002/diff2/1:40001/net/http/http_network_transaction_unittest.cc"
             title="Delta from patch set 1">1</a>
        
          <a href="/2067933002/diff2/20001:40001/net/http/http_network_transaction_unittest.cc"
             title="Delta from patch set 2">2</a>
        
        </td>
        
          <td style="white-space: nowrap">11 chunks</td>
          <td style="white-space: nowrap">+22 lines, -12 lines</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2067933002_40001_50008.diff"
             title="Download patch for net/http/http_network_transaction_unittest.cc">
            Download
          </a>
        </td>
      </tr>
    
      <tr name="patch">
        <td class="first" width="14"><img src="/static/closedtriangle.gif"
    style="visibility: hidden;" width="12" height="9" /></td>
        <td style="white-space: nowrap">M</td>
        <td>
          <a class="noul"
             href="/2067933002/patch/40001/50009">
            net/url_request/url_request_ftp_job.cc
          </a>
        </td>
        <td>
          <a class="noul"
             href="/2067933002/diff/40001/net/url_request/url_request_ftp_job.cc">
            View
          </a>
        </td>
        <td style="white-space: nowrap">
        
        </td>
        
          <td style="white-space: nowrap">1 chunk</td>
          <td style="white-space: nowrap">+1 line, -1 line</td>
        
        <td style="white-space: nowrap">
          
            0 comments
            
            
          
        </td>
        <td>
          <a href="/download/issue2067933002_40001_50009.diff"
             title="Download patch for net/url_request/url_request_ftp_job.cc">
            Download
          </a>
        </td>
      </tr>
    
  </table>

  
  
</div>

  
  </div>
  
    <script language="JavaScript" type="text/javascript">
         <!--
         var lastPSId = 40001;
         // -->
       </script>
  




  <h3>
    <a id="messages-pointer"
       href="javascript:M_toggleSection('messages')"
       class="toggled-section opentriangle">
      Messages
    </a>
  </h3>

  
    <div><i>
    Total messages: 29 (12 generated)
    </i></div>
  

  <div id="messages">
    <div style="margin-bottom: .5em;">
      <a href="javascript:M_expandAllVisibleComments('cl', 29)">
        Expand Messages</a>
      |
      <a href="javascript:M_collapseAllVisibleComments('cl', 29)">
        Collapse Messages</a>
      
      |
      <a href="javascript:M_showGeneratedComments(29)">
        Show Generated Messages</a>
      |
      <a href="javascript:M_hideGeneratedComments(29)">
        Hide Generated Messages</a>
      
    </div>

    
      <div class="message    generated"
           style="display: none"
           id="generated-msg1"
           name="0">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(0)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>asanka</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-0">
                          asanka@chromium.org changed reviewers: + meacer@chromium.org, vabr@chromium.org
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-14 18:29:42 UTC)
                <a href="#msg1">#1</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-0"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-0"
            ><a href="mailto:asanka@chromium.org">asanka@chromium.org</a> changed reviewers:
+ <a href="mailto:meacer@chromium.org">meacer@chromium.org</a>, <a href="mailto:vabr@chromium.org">vabr@chromium.org</a></pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg2"
           name="1">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(1)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>asanka</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-1">
                          https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/login_handler.cc File chrome/browser/ui/login/login_handler.cc (left): https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/login_handler.cc#oldcode86 chrome/browser/ui/login/login_handler.cc:86: origin = std::string(&quot;http://&quot;) + origin; vabr: This logic doesn&#39;t ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-14 18:50:48 UTC)
                <a href="#msg2">#2</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-1"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-1"
            ><a href="https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/login_handler.cc" rel="nofollow">https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/log...</a>
File chrome/browser/ui/login/login_handler.cc (left):

<a href="https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/login_handler.cc#oldcode86" rel="nofollow">https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/log...</a>
chrome/browser/ui/login/login_handler.cc:86: origin = std::string(&quot;http://&quot;) +
origin;
vabr: This logic doesn&#39;t distinguish between http and https proxies. I.e. a
password stored for an https proxy will be automatically provided to a http
proxy. In the new logic, we are passing up the origin of the proxy server up to
this layer. So we are using the correct origin here when populating
dialog_form.origin.

This will cause existing stored password entries for https proxies to become
orphaned and users will be prompted again after this change. I think this is OK
given that we really don&#39;t want to share passwords between secure and insecure
proxies. WDYT?

<a href="https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/login_handler.cc#oldcode93" rel="nofollow">https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/log...</a>
chrome/browser/ui/login/login_handler.cc:93: dialog_form.origin =
GURL(request_url.scheme() + &quot;://&quot; + host_and_port);
vabr: Note that host_and_port will always contain a port even if the port is
standard. Hence dialog_form.origin = GURL(&quot;http://example.com:80&quot;) when
authenticating against &quot;http://example.com&quot;.

After this CL, dialog_form.origin would be GURL(&quot;http://example.com&quot;). Since
GURL canonicalizes the URL there should be no observable change in behavior
before and after this change.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    generated"
           style="display: none"
           id="generated-msg3"
           name="2">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(2)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>asanka</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-2">
                          asanka@chromium.org changed reviewers: + brettw@chromium.org
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-14 18:51:26 UTC)
                <a href="#msg3">#3</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-2"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-2"
            ><a href="mailto:asanka@chromium.org">asanka@chromium.org</a> changed reviewers:
+ <a href="mailto:brettw@chromium.org">brettw@chromium.org</a></pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    generated"
           style="display: none"
           id="generated-msg4"
           name="3">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(3)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>asanka</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-3">
                          Description was changed from ========== Use correct origin when prompting for proxy authentication. Since M49, ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-14 18:52:08 UTC)
                <a href="#msg4">#4</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-3"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-3"
            >Description was changed from

==========
Use correct origin when prompting for proxy authentication.

Since M49, Chrome has been prompting for proxy authentication
credentials using the target origin instead of the origin of the proxy
server. Even if the proxy origin was displayed correctly, a mischievous
network operator could still spoof the proxy server origin. To mitigate
these problems, this CL:

* Fixes the origin used in the proxy authentication login prompt to use
  the origin of the proxy server.

* Indicate if the proxy server connection is insecure.

* Always throw up an interstitial when showing a proxy auth prompt.

BUG=613626
==========

to

==========
Use correct origin when prompting for proxy authentication.

Since M49, Chrome has been prompting for proxy authentication
credentials using the target origin instead of the origin of the proxy
server. Even if the proxy origin was displayed correctly, a mischievous
network operator could still spoof the proxy server origin. To mitigate
these problems, this CL:

* Fixes the origin used in the proxy authentication login prompt to use
  the origin of the proxy server.

* Indicate if the proxy server connection is insecure.

* Always throw up an interstitial and clear the omnibox when showing a
  proxy auth prompt.

BUG=613626
==========</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg5"
           name="4">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(4)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>asanka</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-4">
                          +brettw: for components/login_dialog_strings.grdp and url/origin.h meacer: Everything. Also, I need to get a second opinion ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-14 18:58:38 UTC)
                <a href="#msg5">#5</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-4"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-4"
            >+brettw: for components/login_dialog_strings.grdp and url/origin.h

meacer: Everything. Also, I need to get a second opinion on the use of the
interstitial. I&#39;m doing it in part to prevent the URL and lock icon that might
already be displayed in the omnibox from being abused to mislead users.

vabr: login_handler{.cc, _unittest.cc}

   I&#39;ve noted the places where I&#39;d like you to scrutinize. I&#39;d like to make sure
we don&#39;t orphan any stored passwords unnecessarily.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message  approval  "
           
           id="msg6"
           name="5">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(5)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>vabr (Chromium)</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-5">
                          LGTM, thanks! Vaclav https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/login_handler.cc File chrome/browser/ui/login/login_handler.cc (left): https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/login_handler.cc#oldcode86 chrome/browser/ui/login/login_handler.cc:86: origin = std::string(&quot;http://&quot;) + origin; On ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-15 08:50:06 UTC)
                <a href="#msg6">#6</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-5"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-5"
            >LGTM, thanks!
Vaclav

<a href="https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/login_handler.cc" rel="nofollow">https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/log...</a>
File chrome/browser/ui/login/login_handler.cc (left):

<a href="https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/login_handler.cc#oldcode86" rel="nofollow">https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/log...</a>
chrome/browser/ui/login/login_handler.cc:86: origin = std::string(&quot;http://&quot;) +
origin;
On 2016/06/14 18:50:48, asanka wrote:
&gt; vabr: This logic doesn&#39;t distinguish between http and https proxies. I.e. a
&gt; password stored for an https proxy will be automatically provided to a http
&gt; proxy. In the new logic, we are passing up the origin of the proxy server up
to
&gt; this layer. So we are using the correct origin here when populating
&gt; dialog_form.origin.
&gt; 
&gt; This will cause existing stored password entries for https proxies to become
&gt; orphaned and users will be prompted again after this change. I think this is
OK
&gt; given that we really don&#39;t want to share passwords between secure and insecure
&gt; proxies. WDYT?

Thanks for the heads-up. I agree with your arguments. If we see a surge of bug
reports we will be able to direct users to chrome://passwords/settings to look
up the old passwords.

<a href="https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/login_handler.cc#oldcode93" rel="nofollow">https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/log...</a>
chrome/browser/ui/login/login_handler.cc:93: dialog_form.origin =
GURL(request_url.scheme() + &quot;://&quot; + host_and_port);
On 2016/06/14 18:50:48, asanka wrote:
&gt; vabr: Note that host_and_port will always contain a port even if the port is
&gt; standard. Hence dialog_form.origin = GURL(&quot;http://example.com:80&quot;) when
&gt; authenticating against &quot;http://example.com&quot;.
&gt; 
&gt; After this CL, dialog_form.origin would be GURL(&quot;http://example.com&quot;). Since
&gt; GURL canonicalizes the URL there should be no observable change in behavior
&gt; before and after this change.

Acknowledged.

<a href="https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/login_handler.cc" rel="nofollow">https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/log...</a>
File chrome/browser/ui/login/login_handler.cc (right):

<a href="https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/login_handler.cc#newcode494" rel="nofollow">https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/log...</a>
chrome/browser/ui/login/login_handler.cc:494: // TODO(asanka): The string should
be different for proxies and servers.
nit: Could you please make this a TODO(crbug.com/XXX) where XXX is the number of
the bug having the details for what is the issue and plans to fix it?

<a href="https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/login_handler.h" rel="nofollow">https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/log...</a>
File chrome/browser/ui/login/login_handler.h (right):

<a href="https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/login_handler.h#newcode227" rel="nofollow">https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/log...</a>
chrome/browser/ui/login/login_handler.h:227: // The PasswordForm sent to the
PasswordManager. This is so we can refer to
nit: Seems like these two lines could have stayed as they were? Or at least
please reindent to use as much as possible of the available line character
limit.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg7"
           name="6">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(6)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>meacer</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-6">
                          Sorry for the delay. Could you also update the comment in login_interstitial_delegate.h to mention proxies? ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-16 01:12:15 UTC)
                <a href="#msg7">#7</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-6"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-6"
            >Sorry for the delay. Could you also update the comment in
login_interstitial_delegate.h to mention proxies?

<a href="https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/login_handler.cc" rel="nofollow">https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/log...</a>
File chrome/browser/ui/login/login_handler.cc (right):

<a href="https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/login_handler.cc#newcode463" rel="nofollow">https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/log...</a>
chrome/browser/ui/login/login_handler.cc:463: } else if (auth_info.challenger !=
url::Origin(request_url)) {
Why not use !IsSameOrigin here? It sounds a bit heavy handed to add an overload
just for a single call.

<a href="https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/login_handler.cc#newcode587" rel="nofollow">https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/log...</a>
chrome/browser/ui/login/login_handler.cc:587:
(parent_contents-&gt;ShowingInterstitialPage() || auth_info-&gt;is_proxy ||
nit: Can you update the comment above and add the proxy case?

<a href="https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/login_handler.h" rel="nofollow">https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/log...</a>
File chrome/browser/ui/login/login_handler.h (right):

<a href="https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/login_handler.h#newcode205" rel="nofollow">https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/log...</a>
chrome/browser/ui/login/login_handler.h:205: // directly in this callback. In
both cases, the response will be sent to
directly -&gt; created directly

<a href="https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/login_handler_unittest.cc" rel="nofollow">https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/log...</a>
File chrome/browser/ui/login/login_handler_unittest.cc (right):

<a href="https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/login_handler_unittest.cc#newcode23" rel="nofollow">https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/log...</a>
chrome/browser/ui/login/login_handler_unittest.cc:23: struct TestCase {
const?

<a href="https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/login_handler_unittest.cc#newcode112" rel="nofollow">https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/log...</a>
chrome/browser/ui/login/login_handler_unittest.cc:112: TEST(LoginHandlerTest,
Outputs) {
nit: rename to DialogStringsAndRealm?</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg8"
           name="7">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(7)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>asanka</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-7">
                          https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/login_handler.cc File chrome/browser/ui/login/login_handler.cc (right): https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/login_handler.cc#newcode463 chrome/browser/ui/login/login_handler.cc:463: } else if (auth_info.challenger != url::Origin(request_url)) { On 2016/06/16 ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-16 16:25:47 UTC)
                <a href="#msg8">#8</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-7"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-7"
            ><a href="https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/login_handler.cc" rel="nofollow">https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/log...</a>
File chrome/browser/ui/login/login_handler.cc (right):

<a href="https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/login_handler.cc#newcode463" rel="nofollow">https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/log...</a>
chrome/browser/ui/login/login_handler.cc:463: } else if (auth_info.challenger !=
url::Origin(request_url)) {
On 2016/06/16 at 01:12:14, Mustafa Emre Acer wrote:
&gt; Why not use !IsSameOrigin here? It sounds a bit heavy handed to add an
overload just for a single call.

The addition of the operator follows the style guidelines to overload related
operators, which is why I didn&#39;t think much about it. However I&#39;ll remove it
from the CL since IsSameOriginWith() is clearer in its intent.

<a href="https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/login_handler.cc#newcode494" rel="nofollow">https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/log...</a>
chrome/browser/ui/login/login_handler.cc:494: // TODO(asanka): The string should
be different for proxies and servers.
On 2016/06/15 at 08:50:06, vabr (Chromium) wrote:
&gt; nit: Could you please make this a TODO(crbug.com/XXX) where XXX is the number
of the bug having the details for what is the issue and plans to fix it?

Added one. The plan is to pretty much fix it immediately. The string change is
not part of this CL because we may need to merge to the release branches and
such changes can&#39;t contain string changes.

I also removed the no-op change I was making to the .grdp file since that&#39;ll
probably be disconcerting during merge consideration.

<a href="https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/login_handler.cc#newcode587" rel="nofollow">https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/log...</a>
chrome/browser/ui/login/login_handler.cc:587:
(parent_contents-&gt;ShowingInterstitialPage() || auth_info-&gt;is_proxy ||
On 2016/06/16 at 01:12:14, Mustafa Emre Acer wrote:
&gt; nit: Can you update the comment above and add the proxy case?

Done. Thanks, missed the comment in the first pass.

<a href="https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/login_handler.h" rel="nofollow">https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/log...</a>
File chrome/browser/ui/login/login_handler.h (right):

<a href="https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/login_handler.h#newcode205" rel="nofollow">https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/log...</a>
chrome/browser/ui/login/login_handler.h:205: // directly in this callback. In
both cases, the response will be sent to
On 2016/06/16 at 01:12:15, Mustafa Emre Acer wrote:
&gt; directly -&gt; created directly

Done.

<a href="https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/login_handler.h#newcode227" rel="nofollow">https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/log...</a>
chrome/browser/ui/login/login_handler.h:227: // The PasswordForm sent to the
PasswordManager. This is so we can refer to
On 2016/06/15 at 08:50:06, vabr (Chromium) wrote:
&gt; nit: Seems like these two lines could have stayed as they were? Or at least
please reindent to use as much as possible of the available line character
limit.

Reformatted.

<a href="https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/login_handler_unittest.cc" rel="nofollow">https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/log...</a>
File chrome/browser/ui/login/login_handler_unittest.cc (right):

<a href="https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/login_handler_unittest.cc#newcode23" rel="nofollow">https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/log...</a>
chrome/browser/ui/login/login_handler_unittest.cc:23: struct TestCase {
On 2016/06/16 at 01:12:15, Mustafa Emre Acer wrote:
&gt; const?

Done.

<a href="https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/login_handler_unittest.cc#newcode112" rel="nofollow">https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/log...</a>
chrome/browser/ui/login/login_handler_unittest.cc:112: TEST(LoginHandlerTest,
Outputs) {
On 2016/06/16 at 01:12:15, Mustafa Emre Acer wrote:
&gt; nit: rename to DialogStringsAndRealm?

Done.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    generated"
           style="display: none"
           id="generated-msg9"
           name="8">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(8)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>asanka</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-8">
                          asanka@chromium.org changed reviewers: - brettw@chromium.org
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-16 16:26:21 UTC)
                <a href="#msg9">#9</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-8"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-8"
            ><a href="mailto:asanka@chromium.org">asanka@chromium.org</a> changed reviewers:
- <a href="mailto:brettw@chromium.org">brettw@chromium.org</a></pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg10"
           name="9">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(9)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>asanka</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-9">
                          Also -brettw since both changes owned by them are no longer part of the CL.
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-16 16:26:22 UTC)
                <a href="#msg10">#10</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-9"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-9"
            >Also -brettw since both changes owned by them are no longer part of the CL.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    generated"
           style="display: none"
           id="generated-msg11"
           name="10">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(10)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>asanka</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-10">
                          Description was changed from ========== Use correct origin when prompting for proxy authentication. Since M49, ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-16 16:28:23 UTC)
                <a href="#msg11">#11</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-10"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-10"
            >Description was changed from

==========
Use correct origin when prompting for proxy authentication.

Since M49, Chrome has been prompting for proxy authentication
credentials using the target origin instead of the origin of the proxy
server. Even if the proxy origin was displayed correctly, a mischievous
network operator could still spoof the proxy server origin. To mitigate
these problems, this CL:

* Fixes the origin used in the proxy authentication login prompt to use
  the origin of the proxy server.

* Indicate if the proxy server connection is insecure.

* Always throw up an interstitial and clear the omnibox when showing a
  proxy auth prompt.

BUG=613626
==========

to

==========
Use correct origin when prompting for proxy authentication.

Since M49, Chrome has been prompting for proxy authentication
credentials using the target origin instead of the origin of the proxy
server. Even if the proxy origin was displayed correctly, a mischievous
network operator could still spoof the proxy server origin. To mitigate
these problems, this CL:

* Fixes the origin used in the proxy authentication login prompt to use
  the origin of the proxy server.

* Indicate if the proxy server connection is insecure.

* Always throw up an interstitial and clear the omnibox when showing a
  proxy auth prompt.

BUG=613626, 620737
==========</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message  approval  "
           
           id="msg12"
           name="11">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(11)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>vabr (Chromium)</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-11">
                          Still LGTM, thanks! Vaclav https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/login_handler.cc File chrome/browser/ui/login/login_handler.cc (right): https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/login_handler.cc#newcode494 chrome/browser/ui/login/login_handler.cc:494: // TODO(asanka): The string should ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-16 16:43:21 UTC)
                <a href="#msg12">#12</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-11"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-11"
            >Still LGTM, thanks!
Vaclav

<a href="https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/login_handler.cc" rel="nofollow">https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/log...</a>
File chrome/browser/ui/login/login_handler.cc (right):

<a href="https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/login_handler.cc#newcode494" rel="nofollow">https://codereview.chromium.org/2067933002/diff/1/chrome/browser/ui/login/log...</a>
chrome/browser/ui/login/login_handler.cc:494: // TODO(asanka): The string should
be different for proxies and servers.
On 2016/06/16 16:25:47, asanka wrote:
&gt; On 2016/06/15 at 08:50:06, vabr (Chromium) wrote:
&gt; &gt; nit: Could you please make this a TODO(crbug.com/XXX) where XXX is the
number
&gt; of the bug having the details for what is the issue and plans to fix it?
&gt; 
&gt; Added one. The plan is to pretty much fix it immediately. The string change is
&gt; not part of this CL because we may need to merge to the release branches and
&gt; such changes can&#39;t contain string changes.
&gt; 
&gt; I also removed the no-op change I was making to the .grdp file since that&#39;ll
&gt; probably be disconcerting during merge consideration.

Acknowledged.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message  approval  "
           
           id="msg13"
           name="12">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(12)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>meacer</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-12">
                          Thanks! LGTM.
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-16 17:26:58 UTC)
                <a href="#msg13">#13</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-12"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-12"
            >Thanks! LGTM.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg14"
           name="13">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(13)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>asanka</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-13">
                          Thanks everyone!
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-16 17:51:26 UTC)
                <a href="#msg14">#14</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-13"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-13"
            >Thanks everyone!</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    generated"
           style="display: none"
           id="generated-msg15"
           name="14">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(14)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>asanka</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-14">
                          The CQ bit was checked by asanka@chromium.org to run a CQ dry run
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-16 17:52:23 UTC)
                <a href="#msg15">#15</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-14"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-14"
            >The CQ bit was checked by <a href="mailto:asanka@chromium.org">asanka@chromium.org</a> to run a CQ dry run</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg16"
           name="15">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(15)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>commit-bot: I haz the power</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-15">
                          Dry run: CQ is trying da patch. Follow status at https://chromium-cq-status.appspot.com/patch-status/2067933002/20001
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-16 17:53:05 UTC)
                <a href="#msg16">#16</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-15"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-15"
            >Dry run: CQ is trying da patch. Follow status at
 <a href="https://chromium-cq-status.appspot.com/patch-status/2067933002/20001" rel="nofollow">https://chromium-cq-status.appspot.com/patch-status/2067933002/20001</a></pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    generated"
           style="display: none"
           id="generated-msg17"
           name="16">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(16)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>asanka</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-16">
                          Description was changed from ========== Use correct origin when prompting for proxy authentication. Since M49, ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-16 17:58:13 UTC)
                <a href="#msg17">#17</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-16"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-16"
            >Description was changed from

==========
Use correct origin when prompting for proxy authentication.

Since M49, Chrome has been prompting for proxy authentication
credentials using the target origin instead of the origin of the proxy
server. Even if the proxy origin was displayed correctly, a mischievous
network operator could still spoof the proxy server origin. To mitigate
these problems, this CL:

* Fixes the origin used in the proxy authentication login prompt to use
  the origin of the proxy server.

* Indicate if the proxy server connection is insecure.

* Always throw up an interstitial and clear the omnibox when showing a
  proxy auth prompt.

BUG=613626, 620737
==========

to

==========
Use correct origin when prompting for proxy authentication.

Since M49, Chrome has been prompting for proxy authentication
credentials using the target origin instead of the origin of the proxy
server. Even if the proxy origin was displayed correctly, a mischievous
network operator could still spoof the proxy server origin. To mitigate
these problems, this CL:

* Fixes the origin used in the proxy authentication login prompt to use
  the origin of the proxy server.

* Indicate if the proxy server connection is insecure.

* Always throw up an interstitial and clear the omnibox when showing a
  proxy auth prompt.

* Use the correct origin when saving proxy authentication credentials.

BUG=613626, 620737
==========</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    generated"
           style="display: none"
           id="generated-msg18"
           name="17">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(17)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>commit-bot: I haz the power</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-17">
                          The CQ bit was unchecked by commit-bot@chromium.org
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-16 18:10:54 UTC)
                <a href="#msg18">#18</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-17"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-17"
            >The CQ bit was unchecked by <a href="mailto:commit-bot@chromium.org">commit-bot@chromium.org</a></pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg19"
           name="18">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(18)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>commit-bot: I haz the power</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-18">
                          Dry run: Try jobs failed on following builders: mac_chromium_rel_ng on tryserver.chromium.mac (JOB_FAILED, http://build.chromium.org/p/tryserver.chromium.mac/builders/mac_chromium_rel_ng/builds/245457)
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-16 18:10:56 UTC)
                <a href="#msg19">#19</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-18"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-18"
            >Dry run: Try jobs failed on following builders:
  mac_chromium_rel_ng on tryserver.chromium.mac (JOB_FAILED,
<a href="http://build.chromium.org/p/tryserver.chromium.mac/builders/mac_chromium_rel_ng/builds/245457" rel="nofollow">http://build.chromium.org/p/tryserver.chromium.mac/builders/mac_chromium_rel_...</a>)</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    generated"
           style="display: none"
           id="generated-msg20"
           name="19">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(19)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>asanka</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-19">
                          asanka@chromium.org changed reviewers: + jam@chromium.org
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-16 18:36:31 UTC)
                <a href="#msg20">#20</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-19"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-19"
            ><a href="mailto:asanka@chromium.org">asanka@chromium.org</a> changed reviewers:
+ <a href="mailto:jam@chromium.org">jam@chromium.org</a></pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg21"
           name="20">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(20)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>asanka</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-20">
                          +jam: for content/shell/browser/shell_login_dialog.cc The file was updated to derive a safe display string for the ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-16 18:38:07 UTC)
                <a href="#msg21">#21</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-20"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-20"
            >+jam: for content/shell/browser/shell_login_dialog.cc

   The file was updated to derive a safe display string for the &#39;challenger&#39;
field for the HTTP auth prompt.</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message  approval  "
           
           id="msg22"
           name="21">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(21)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>jam</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-21">
                          On 2016/06/16 18:38:07, asanka wrote: &gt; +jam: for content/shell/browser/shell_login_dialog.cc &gt; &gt; The file was updated ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-16 19:58:07 UTC)
                <a href="#msg22">#22</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-21"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-21"
            >On 2016/06/16 18:38:07, asanka wrote:
&gt; +jam: for content/shell/browser/shell_login_dialog.cc
&gt; 
&gt;    The file was updated to derive a safe display string for the &#39;challenger&#39;
&gt; field for the HTTP auth prompt.

lgtm</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg23"
           name="22">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(22)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>asanka</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-22">
                          On 2016/06/16 at 19:58:07, jam wrote: &gt; On 2016/06/16 18:38:07, asanka wrote: &gt; &gt; +jam: ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-16 20:11:56 UTC)
                <a href="#msg23">#23</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-22"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-22"
            >On 2016/06/16 at 19:58:07, jam wrote:
&gt; On 2016/06/16 18:38:07, asanka wrote:
&gt; &gt; +jam: for content/shell/browser/shell_login_dialog.cc
&gt; &gt; 
&gt; &gt;    The file was updated to derive a safe display string for the &#39;challenger&#39;
&gt; &gt; field for the HTTP auth prompt.
&gt; 
&gt; lgtm

Thanks!</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    generated"
           style="display: none"
           id="generated-msg24"
           name="23">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(23)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>asanka</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-23">
                          The CQ bit was checked by asanka@chromium.org
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-16 20:12:01 UTC)
                <a href="#msg24">#24</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-23"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-23"
            >The CQ bit was checked by <a href="mailto:asanka@chromium.org">asanka@chromium.org</a></pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    generated"
           style="display: none"
           id="generated-msg25"
           name="24">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(24)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>asanka</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-24">
                          The patchset sent to the CQ was uploaded after l-g-t-m from vabr@chromium.org, meacer@chromium.org Link to ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-16 20:12:01 UTC)
                <a href="#msg25">#25</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-24"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-24"
            >The patchset sent to the CQ was uploaded after l-g-t-m from <a href="mailto:vabr@chromium.org">vabr@chromium.org</a>,
<a href="mailto:meacer@chromium.org">meacer@chromium.org</a>
Link to the patchset: <a href="https://codereview.chromium.org/2067933002/#ps40001" rel="nofollow">https://codereview.chromium.org/2067933002/#ps40001</a>
(title: &quot;Fix content_shell build.&quot;)</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message    "
           
           id="msg26"
           name="25">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(25)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>commit-bot: I haz the power</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-25">
                          CQ is trying da patch. Follow status at https://chromium-cq-status.appspot.com/patch-status/2067933002/40001
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-16 20:12:59 UTC)
                <a href="#msg26">#26</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-25"
             style="display: none;">
          <div class="message-body">
            
            <pre name="cl-message-25"
            >CQ is trying da patch. Follow status at
 <a href="https://chromium-cq-status.appspot.com/patch-status/2067933002/40001" rel="nofollow">https://chromium-cq-status.appspot.com/patch-status/2067933002/40001</a></pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message issue_was_closed   "
           
           id="msg27"
           name="26">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(26)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>commit-bot: I haz the power</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-26">
                          Committed patchset #3 (id:40001)
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-16 20:18:58 UTC)
                <a href="#msg27">#27</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-26"
             style="display: none;">
          <div class="message-body">
            
              <span class="extra-note">
                Message was sent while issue was closed.
              </span>
            
            <pre name="cl-message-26"
            >Committed patchset #3 (id:40001)</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message issue_was_closed   generated"
           style="display: none"
           id="generated-msg28"
           name="27">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(27)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>commit-bot: I haz the power</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden;"
                           class="extra"
                           id="cl-preview-27">
                          Description was changed from ========== Use correct origin when prompting for proxy authentication. Since M49, ...
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-16 20:20:16 UTC)
                <a href="#msg28">#28</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-27"
             style="display: none;">
          <div class="message-body">
            
              <span class="extra-note">
                Message was sent while issue was closed.
              </span>
            
            <pre name="cl-message-27"
            >Description was changed from

==========
Use correct origin when prompting for proxy authentication.

Since M49, Chrome has been prompting for proxy authentication
credentials using the target origin instead of the origin of the proxy
server. Even if the proxy origin was displayed correctly, a mischievous
network operator could still spoof the proxy server origin. To mitigate
these problems, this CL:

* Fixes the origin used in the proxy authentication login prompt to use
  the origin of the proxy server.

* Indicate if the proxy server connection is insecure.

* Always throw up an interstitial and clear the omnibox when showing a
  proxy auth prompt.

* Use the correct origin when saving proxy authentication credentials.

BUG=613626, 620737
==========

to

==========
Use correct origin when prompting for proxy authentication.

Since M49, Chrome has been prompting for proxy authentication
credentials using the target origin instead of the origin of the proxy
server. Even if the proxy origin was displayed correctly, a mischievous
network operator could still spoof the proxy server origin. To mitigate
these problems, this CL:

* Fixes the origin used in the proxy authentication login prompt to use
  the origin of the proxy server.

* Indicate if the proxy server connection is insecure.

* Always throw up an interstitial and clear the omnibox when showing a
  proxy auth prompt.

* Use the correct origin when saving proxy authentication credentials.

BUG=613626, 620737

Committed: <a href="https://crrev.com/098c009df7a4ddc5c23d4d3c9dccf5eff1f24c98" rel="nofollow">https://crrev.com/098c009df7a4ddc5c23d4d3c9dccf5eff1f24c98</a>
Cr-Commit-Position: refs/heads/master@{#400247}
==========</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    
      <div class="message issue_was_closed   "
           
           id="msg29"
           name="28">
        <div class="header">
          <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tr class="comment_title"
                onclick="M_switchChangelistComment(28)">
              <td style="padding-left: 5px; white-space: nowrap;">
                <b>commit-bot: I haz the power</b>
              </td>
              <td width="100%" style="overflow:hidden;">
                <table style="table-layout:fixed; white-space: nowrap;"
                       width="100%">
                  <tr>
                    <td>
                      <span style="white-space: nowrap; overflow: hidden; display: none;"
                           class="extra"
                           id="cl-preview-28">
                          Patchset 3 (id:??) landed as https://crrev.com/098c009df7a4ddc5c23d4d3c9dccf5eff1f24c98 Cr-Commit-Position: refs/heads/master@{#400247}
                      </span>
                    </td>
                  </tr>
                </table>
              </td>
              <td align="right"
                  style="white-space: nowrap; padding-right: 5px; padding-left: 3px;">
                4 years, 6 months ago
		(2016-06-16 20:20:17 UTC)
                <a href="#msg29">#29</a>
              </td>
            </tr>
          </table>
        </div>

        <div id="cl-comment-28"
             >
          <div class="message-body">
            
              <span class="extra-note">
                Message was sent while issue was closed.
              </span>
            
            <pre name="cl-message-28"
            >Patchset 3 (id:??) landed as
<a href="https://crrev.com/098c009df7a4ddc5c23d4d3c9dccf5eff1f24c98" rel="nofollow">https://crrev.com/098c009df7a4ddc5c23d4d3c9dccf5eff1f24c98</a>
Cr-Commit-Position: refs/heads/master@{#400247}</pre>
          </div>
          <div class="message-footer"></div>
        </div>

      </div>
    

    <div>
      <a href="javascript:M_expandAllVisibleComments('cl', 29)">
        Expand Messages</a>
      |
      <a href="javascript:M_collapseAllVisibleComments('cl', 29)">
        Collapse Messages</a>
      
      |
      <a href="javascript:M_showGeneratedComments(29)">
        Show Generated Messages</a>
      |
      <a href="javascript:M_hideGeneratedComments(29)">
        Hide Generated Messages</a>
      
    </div>

  </div>

<script language="JavaScript" type="text/javascript">
<!--
var lastMsgID = 29;
// -->
</script>




<script language="JavaScript" type="text/javascript">
  <!--
    document.onkeydown = M_changelistKeyDown;
    var dashboardState = new M_DashboardState(window, 'patch', 'M_CLPatchMarker');
    var issueId = 2067933002;
    M_toggleIssueOverviewByAnchor();
  // -->
</script>



      </td>
    </tr>
  </table>

</div>

  
    <div class="popup" id="popup-issue">
      <b>Issue 2067933002: Use correct origin when prompting for proxy authentication.
     (Closed) </b><br/>
      Created 4 years, 6 months ago by asanka<br/>
      Modified 4 years, 6 months ago<br/>
      Reviewers: jam, meacer, vabr (Chromium)<br/>
      Base URL: https://chromium.googlesource.com/chromium/src.git@master<br/>
      Comments: 19
      
    </div>
  


<p></p>
<div style="float: left;">
  <a target="_blank" href="http://code.google.com/appengine/"><img border="0"
   src="/static/appengine-noborder-120x30.gif"
   alt="Powered by Google App Engine" /></a>
</div>

<div class="extra" style="font-size: 9pt; float: right; text-align: right;">
  <div style="margin-top: .3em;">This is Rietveld <a href='http://code.google.com/p/rietveld/source/list'>408576698
</a></div>
</div>


<script>
  // Google Analytics.
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-55762617-11', {
    'allowLinker': true,
    'siteSpeedSampleRate': 100
  });
  ga('require', 'linker');
  ga('linker:autoLink',
     ['chromiumcodereview.appspot.com', 'codereview.chromium.org'] );
  ga('send', 'pageview');

  // CRDX Feedback button.
  (function(i,s,o,g,r,a,m){i['CrDXObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://storage.googleapis.com/crdx-feedback.appspot.com/feedback.js','crdx');

  crdx('setFeedbackButtonLink',
      'https://bugs.chromium.org/p/chromium/issues/entry?cc=andybons@chromium.org&components=Infra%3ECodereview%3ERietveld&labels=Infra-DX');
</script>


</body>
</html>
