<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>
<title>ares_create_query single byte out of buffer write</title>
<link rel="STYLESHEET" type="text/css" href="/cares.css">
</head>
<body>
<div class="menu">
<a href="/">c-ares home</a> &middot;
<a href="/docs.html">docs</a> &middot;
<a href="/license.html">license</a> &middot;
<a href="/daily-snapshot/">daily snapshots</a> &middot;
<a href="/mail.cgi">mail archive</a> &middot;
<a href="/why.html">why</a> &middot;
<a href="/otherlibs.html">other libs</a> &middot;
<a href="https://github.com/c-ares/c-ares">github</a>

</div>
<div class=title align=left> CVE-2017-1000381 </div>
<div class="box">
<h1>c-ares NAPTR parser out of bounds access</h1>
<p>Project c-ares Security Advisory, June 20, 2017 -
<a href="https://c-ares.org/adv_20170620.html">Permalink</a></p>

<h2>VULNERABILITY</h2>
<p>The c-ares function <code>ares_parse_naptr_reply()</code>, which is used for parsing
NAPTR responses, could be triggered to read memory outside of the given input
buffer if the passed in DNS response packet was crafted in a particular way.</p>
<p>We are not aware of any exploits of this flaw.</p>
<h2>INFO</h2>
<p>The Common Vulnerabilities and Exposures (CVE) project has assigned the name
CVE-2017-1000381 to this issue.</p>
<h2>AFFECTED VERSIONS</h2>
<p>This flaw exists in the following c-ares versions.</p>
<ul>
<li>Affected versions: c-ares 1.8.0 to and including 1.12.0</li>
<li>Not affected versions: c-ares >= 1.13.0</li>
</ul>
<h2>THE SOLUTION</h2>
<p>In version 1.13.0, the <code>RR_len</code> value gets checked properly and the function
is also added to the fuzz testing. It was previously accidentally left out
from that.</p>
<p>A <a href="https://c-ares.org/CVE-2017-1000381.patch">patch for CVE-2017-1000381</a>

is available.</p>
<h2>RECOMMENDATIONS</h2>
<p>We suggest you take one of the following actions immediately, in order of
preference:</p>
<p>A - Upgrade c-ares to version 1.13.0</p>
<p>B - Apply the patch to your version and rebuild</p>
<p>C - Do not use <code>ares_parse_naptr_reply()</code>.</p>
<h2>TIME LINE</h2>
<p>It was reported to the c-ares project on May 20. We contacted distros@openall
on June 16.</p>
<p>c-ares 1.13.0 was released on June 20 2017, coordinated with the publication
of this advisory.</p>
<h2>CREDITS</h2>
<p>Thanks to LCatro for the report and to David Drysdale for the fix.</p>
</div>
</body></html>
