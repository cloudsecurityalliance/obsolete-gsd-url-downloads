<!DOCTYPE html>
<html lang="en">
  <head>
    <title>219985 &ndash; Konversation crash when certain strings received</title>

      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<link href="data/assets/23ebf435e712b8c1688f186151fcc60c.css?1626941475" rel="stylesheet" type="text/css">



    
<script type="text/javascript" src="data/assets/a7c2f3a028f17a9aa60f56dc9d6e732d.js?1626941475"></script>

    <script type="text/javascript">
    <!--
        YAHOO.namespace('bugzilla');
        YAHOO.util.Event.addListener = function (el, sType, fn, obj, overrideContext) {
               if ( ("onpagehide" in window || YAHOO.env.ua.gecko) && sType === "unload") { sType = "pagehide"; };
               var capture = ((sType == "focusin" || sType == "focusout") && !YAHOO.env.ua.ie) ? true : false;
               return this._addListener(el, this._getType(sType), fn, obj, overrideContext, capture);
         };
        if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
            YAHOO.util.Event._simpleRemove(window, "unload", 
                                           YAHOO.util.Event._unload);
        }
        
        function unhide_language_selector() { 
            YAHOO.util.Dom.removeClass(
                'lang_links_container', 'bz_default_hidden'
            ); 
        } 
        YAHOO.util.Event.onDOMReady(unhide_language_selector);

        
        var BUGZILLA = {
            param: {
                cookiepath: '\/',
                maxusermatches: 5
            },
            constant: {
                COMMENT_COLS: 80
            },
            string: {
                

                attach_desc_required:
                    "You must enter a Description for this attachment.",
                component_required:
                    "You must select a Component for this bug.",
                description_required:
                    "You must enter a Description for this bug.",
                short_desc_required:
                    "You must enter a Summary for this bug.",
                version_required:
                    "You must select a Version for this bug."
            }
              , api_token: ''
        };

    if (history && history.replaceState) {
      if(!document.location.href.match(/show_bug\.cgi/)) {
        history.replaceState( null,
                             "219985 – Konversation crash when certain strings received",
                             "show_bug.cgi?id=219985" );
        document.title = "219985 – Konversation crash when certain strings received";
      }
      if (document.location.href.match(/show_bug\.cgi\?.*list_id=/)) {
        var href = document.location.href;
        href = href.replace(/[\?&]+list_id=(\d+|cookie)/, '');
        history.replaceState(null, "219985 – Konversation crash when certain strings received", href);
      }
    }
    YAHOO.util.Event.onDOMReady(function() {
      initDirtyFieldTracking();

    });
    // -->
    </script>
<script type="text/javascript" src="data/assets/daf5e0fb6826e6a35280e622913f0c4a.js?1626941475"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="KDE Bugtracking System" href="./search_plugin.cgi">
    <link rel="apple-touch-icon" sizes="180x180" href="https://kde.org/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://kde.org/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://kde.org/favicon-16x16.png">
    <link rel="mask-icon" href="https://kde.org/safari-pinned-tab.svg" color="#1f99f3">
  </head>

  <body 
        class="bugs-kde-org
                 bz_bug
                 bz_status_RESOLVED
                 bz_product_kdelibs
                 bz_component_knotify
                 bz_bug_219985 yui-skin-sam">

  <div id="header"><div id="banner">
  </div>

    <div id="titles">
      <span id="title">KDE Bugtracking System &ndash; Bug&nbsp;219985</span>

        <span id="subtitle" class="subheader">Konversation crash when certain strings received</span>

        <span id="information" class="header_addl_info">Last modified: 2010-03-23 12:55:02 UTC</span>
    </div>


    <div id="common_links"><ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi">New</a></li>
  <li><span class="separator">| </span><a href="describecomponents.cgi">Browse</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_top" name="no_redirect" value="0">
    <script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_top");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_top" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_top"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li>
      <span class="separator">| </span>
        <a href="request.cgi">Requests</a></li>


  <li>
        <span class="separator">| </span>
        <a href="https://bugzilla.readthedocs.org/en/5.0/using/understanding.html" target="_blank">Help</a>
      </li>
    
      <li id="new_account_container_top">
        <span class="separator">| </span>
        <a href="createaccount.cgi">New&nbsp;Account</a>
      </li>

    <li id="mini_login_container_top">
  <span class="separator">| </span>
  <a id="login_link_top" href="show_bug.cgi?id=219985&amp;GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('_top')">Log In</a>

  <form action="show_bug.cgi?id=219985" method="POST"
        class="mini_login bz_default_hidden"
        id="mini_login_top">
    <input id="Bugzilla_login_top" required
           name="Bugzilla_login" class="bz_login"
        type="email" placeholder="Email Address">
    <input class="bz_password" name="Bugzilla_password" type="password"
           id="Bugzilla_password_top" required
           placeholder="Password">
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
            id="log_in_top">
    <a href="#" onclick="return hide_mini_login_form('_top')">[x]</a>
  </form>
</li>


  <li id="forgot_container_top">
    <span class="separator">| </span>
    <a id="forgot_link_top" href="show_bug.cgi?id=219985&amp;GoAheadAndLogIn=1#forgot"
       onclick="return show_forgot_form('_top')">Forgot Password</a>
    <form action="token.cgi" method="post" id="forgot_form_top"
          class="mini_forgot bz_default_hidden">
      <label for="login_top">Login:</label>
      <input name="loginname" size="20" id="login_top" required
          type="email" placeholder="Your Email Address">
      <input id="forgot_button_top" value="Reset Password" type="submit">
      <input type="hidden" name="a" value="reqpw">
      <input type="hidden" id="token_top" name="token"
             value="1635619431-BWio6QK0YzQ1if1Yddu89pConOsD2O5rLXjv5WX40xw">
      <a href="#" onclick="return hide_forgot_form('_top')">[x]</a>
    </form>
  </li>
</ul>
    </div>
  </div>

  <div id="bugzilla-body">


<script type="text/javascript">
<!--

//-->
</script>

<form name="changeform" id="changeform" method="post" action="process_bug.cgi">

  <input type="hidden" name="delta_ts" value="2010-03-23 12:55:02">
  <input type="hidden" name="id" value="219985">
  <input type="hidden" name="token" value="1635619431-pOvlvLIWsgW68AuW9Oklbqo79qAzU87MpStvlhDbrkU">
<div class="bz_short_desc_container edit_form">
     <a href="show_bug.cgi?id=219985"><b>Bug&nbsp;219985</b></a> <span id="summary_container" class="bz_default_hidden">
      - <span id="short_desc_nonedit_display">Konversation crash when certain strings received</span>
     </span>

    <div id="summary_input"><span class="field_label "
    id="field_label_short_desc">


  <a 
      title="The bug summary is a short sentence which succinctly describes what the bug is about."
      class="field_help_link"
      href="page.cgi?id=fields.html#short_desc"
  >Summary:</a>

</span>Konversation crash when certain strings received
    </div>
  </div>
  <script type="text/javascript">
    hideEditableField('summary_container',
                      'summary_input',
                      'summary_edit_action',
                      'short_desc',
                      'Konversation crash when certain strings received' );
  </script>
  <table class="edit_form">
    <tr>
      
      <td id="bz_show_bug_column_1" class="bz_show_bug_column">     
        <table>
          <tr>
    <th class="field_label">
      <a href="page.cgi?id=fields.html#bug_status">Status</a>:
    </th>
    <td id="bz_field_status">
      <span id="static_bug_status">RESOLVED
          FIXED
      </span>
    </td>
  </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_alias">


  <a 
      title="A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla."
      class="field_help_link"
      href="page.cgi?id=fields.html#alias"
  >Alias:</a>

</th>
    <td>
        None
    </td>
  </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_product">


  <a 
      title="Bugs are categorised into Products and Components."
      class="field_help_link"
      href="describecomponents.cgi"
  >Product:</a>

</th>
  <td class="field_value "
      id="field_container_product" >kdelibs

</td>
    </tr>

    
    <tr class="bz_default_hidden"><th class="field_label "
    id="field_label_classification">


  <a 
      title="Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation."
      class="field_help_link"
      href="page.cgi?id=fields.html#classification"
  >Classification:</a>

</th>
  <td class="field_value "
      id="field_container_classification" >Unclassified

</td>
    </tr>
        
    
    
    <tr><th class="field_label "
    id="field_label_component">


  <a 
      title="Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list."
      class="field_help_link"
      href="describecomponents.cgi?product=kdelibs"
  >Component:</a>

</th>
  <td class="field_value "
      id="field_container_component" >knotify

  (<a href="buglist.cgi?component=knotify&amp;product=kdelibs&amp;bug_status=__open__"
      target="_blank">show other bugs</a>)
</td>
    </tr>
    <tr><th class="field_label "
    id="field_label_version">


  <a 
      title="The version field defines the version of the software the bug was found in."
      class="field_help_link"
      href="page.cgi?id=fields.html#version"
  >Version:</a>

</th>
<td>unspecified
  </td>
    </tr>
        
    
        
    <tr><th class="field_label "
    id="field_label_rep_platform">


  <a 
      title="The hardware platform the bug was observed on. Note: When searching, selecting the option &quot;All&quot; only finds bugs whose value for this field is literally the word &quot;All&quot;."
      class="field_help_link"
      href="page.cgi?id=fields.html#rep_platform"
  >Platform:</a>

</th>
      <td class="field_value">Unlisted Binaries
        Linux
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          
          <tr>
      <th class="field_label">
        <label  accesskey="i">
          <a href="page.cgi?id=fields.html#importance"><u>I</u>mportance</a></label>:
      </th>
      <td>NOR
       crash<span id="votes_container">
      with
      <a href="page.cgi?id=voting/bug.html&amp;bug_id=219985">20 
            votes</a>
    (<a href="page.cgi?id=voting/user.html&amp;bug_id=219985#vote_219985">vote</a>)
  </span>
      </td>
    </tr>

      <tr><th class="field_label "
    id="field_label_target_milestone">


  <a 
      title="The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it."
      class="field_help_link"
      href="page.cgi?id=fields.html#target_milestone"
  >Target Milestone:</a>

</th><td>---
  </td>
      </tr>
          
          <tr><th class="field_label "
    id="field_label_assigned_to">


  <a 
      title="The person in charge of resolving the bug."
      class="field_help_link"
      href="page.cgi?id=fields.html#assigned_to"
  >Assignee:</a>

</th>
      <td><span class="vcard"><span class="fn">Olivier Goffart</span>
</span>
      </td>
    </tr>

    <script type="text/javascript">
      assignToDefaultOnChange(['product', 'component'],
        'ogoffart\x40kde.org',
        '');
    </script>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr><th class="field_label "
    id="field_label_bug_file_loc">


  <a 
      title="Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen."
      class="field_help_link"
      href="page.cgi?id=fields.html#bug_file_loc"
  >URL:</a>

</th>
    <td>
      <span id="bz_url_input_area">
      </span>
    </td>
  </tr>


    <tr><th class="field_label "
    id="field_label_keywords">


  <a 
      title="You can add keywords from a defined list to bugs, in order to easily identify and group them."
      class="field_help_link"
      href="describekeywords.cgi"
  >Keywords:</a>

</th>
  <td class="field_value "
      id="field_container_keywords" >

</td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>

          <tr>
    <th class="field_label">
      <label>Duplicates (1)</label>:
    </th>
    <td class="field_value">
      <span id="duplicates"><a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - konversation crashed after several days"
   href="show_bug.cgi?id=225690">225690</a> 
      </span>
      (<a href="buglist.cgi?bug_id=225690">view as bug list</a>)
    </td>
  </tr>
<tr><th class="field_label "
    id="field_label_dependson">


  <a 
      title="The bugs listed here must be resolved before this bug can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#dependson"
  >Depends on:</a>

</th>

  <td>
    <span id="dependson_input_area">
    </span>

  </td>
  </tr>
  
  <tr><th class="field_label "
    id="field_label_blocked">


  <a 
      title="This bug must be resolved before the bugs listed in this field can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#blocked"
  >Blocks:</a>

</th>

  <td>
    <span id="blocked_input_area">
    </span>

  </td>
  </tr>
          
        </table>
      </td>
      <td>
        <div class="bz_column_spacer">&nbsp;</div>
      </td>
      
      <td id="bz_show_bug_column_2" class="bz_show_bug_column">
        <table>
        <tr>
    <th class="field_label">
      Reported:
    </th>
    <td>2009-12-24 19:48 UTC by <span class="vcard"><span class="fn">Ken Rushia</span>
</span>
    </td>
  </tr>
  
  <tr>
    <th class="field_label">
      Modified:
    </th>
    <td>2010-03-23 12:55 UTC
      (<a href="show_activity.cgi?id=219985">History</a>)
    </td>
  
  </tr>
<tr>
      <th class="field_label">
        <label  accesskey="a">
          CC List:
        </label>
      </th>
      <td>7 
          users
          <span id="cc_edit_area_showhide_container" class="bz_default_hidden">
            (<a href="#" id="cc_edit_area_showhide">show</a>)
          </span>
        <div id="cc_edit_area">
          <br>
            <select id="cc" multiple="multiple" size="5" >
                <option value="ais523">ais523</option>
                <option value="andresbajotierra">andresbajotierra</option>
                <option value="argonel">argonel</option>
                <option value="hein">hein</option>
                <option value="kde">kde</option>
                <option value="nalvarez">nalvarez</option>
                <option value="ogoffart">ogoffart</option>
            </select>
        </div>
          <script type="text/javascript">
            hideEditableField( 'cc_edit_area_showhide_container', 
                               'cc_edit_area', 
                               'cc_edit_area_showhide', 
                               '', 
                               '');  
          </script>
      </td>
    </tr>

<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_see_also">


  <a 
      title="This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields."
      class="field_help_link"
      href="page.cgi?id=fields.html#see_also"
  >See Also:</a>

</th>
  <td class="field_value "
      id="field_container_see_also" >

</td>
    </tr> 
<tr>
      <th class="field_label "
    id="field_label_cf_commitlink">


  <a 
      title="A custom Free Text field in this installation of Bugzilla."
      class="field_help_link"
      href="page.cgi?id=fields.html#cf_commitlink"
  >Latest Commit:</a>

</th>
  <td class="field_value "
      id="field_container_cf_commitlink" >

</td>
    </tr>
    <tr>
      <th class="field_label "
    id="field_label_cf_versionfixedin">


  <a 
      title="A custom Free Text field in this installation of Bugzilla."
      class="field_help_link"
      href="page.cgi?id=fields.html#cf_versionfixedin"
  >Version Fixed In:</a>

</th>
  <td class="field_value "
      id="field_container_cf_versionfixedin" >

</td>
    </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>



        </table>
      </td>
    </tr>
    <tr>
      <td colspan="3">
          <hr id="bz_top_half_spacer">
      </td>
    </tr>
  </table>

  <table id="bz_big_form_parts">
  <tr>
  <td>

    
<script type="text/javascript">
<!--
function toggle_display(link) {
    var table = document.getElementById("attachment_table");
    var view_all = document.getElementById("view_all");
    var hide_obsolete_url_parameter = "&hide_obsolete=1";
    // Store current height for scrolling later
    var originalHeight = table.offsetHeight;
    var rows = YAHOO.util.Dom.getElementsByClassName(
        'bz_tr_obsolete', 'tr', table);

    for (var i = 0; i < rows.length; i++) {
        bz_toggleClass(rows[i], 'bz_default_hidden');
    }

    if (YAHOO.util.Dom.hasClass(rows[0], 'bz_default_hidden')) {
        link.innerHTML = "Show Obsolete";
        view_all.href = view_all.href + hide_obsolete_url_parameter 
    }
    else {
        link.innerHTML = "Hide Obsolete";
        view_all.href = view_all.href.replace(hide_obsolete_url_parameter,"");
    }

    var newHeight = table.offsetHeight;
    // This scrolling makes the window appear to not move at all.
    window.scrollBy(0, newHeight - originalHeight);

    return false;
}
//-->
</script>

<br>
<table id="attachment_table">
  <tr id="a0">
    <th colspan="2" class="left">
      Attachments
    </th>
  </tr>


      <tr id="a1" class="bz_contenttype_application_octet-stream">
        <td>
            <a href="attachment.cgi?id=39319"
               title="View the content of the attachment">
          <b>IRC protocol dump</b></a>

          <span class="bz_attach_extra_info">
              (17.27 KB,
                application/octet-stream)

            <br>
            <a href="#attach_39319"
               title="Go to the comment associated with the attachment">2009-12-24 21:10 UTC</a>,

            <span class="vcard"><span class="fn">Nicolás Alvarez</span>
</span>
          </span>
        </td>


        <td>
          <a href="attachment.cgi?id=39319&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a2" class="bz_contenttype_text_plain">
        <td>
            <a href="attachment.cgi?id=39329"
               title="View the content of the attachment">
          <b>Crash backtrace</b></a>

          <span class="bz_attach_extra_info">
              (5.31 KB,
                text/plain)

            <br>
            <a href="#attach_39329"
               title="Go to the comment associated with the attachment">2009-12-25 13:52 UTC</a>,

            <span class="vcard"><span class="fn">Eike Hein</span>
</span>
          </span>
        </td>


        <td>
          <a href="attachment.cgi?id=39329&amp;action=edit">Details</a>
        </td>
      </tr>
      <tr id="a3" class="bz_contenttype_text_plain">
        <td>
            <a href="attachment.cgi?id=39330"
               title="View the content of the attachment">
          <b>Crash backtrace with config dialog involvement</b></a>

          <span class="bz_attach_extra_info">
              (7.84 KB,
                text/plain)

            <br>
            <a href="#attach_39330"
               title="Go to the comment associated with the attachment">2009-12-25 13:54 UTC</a>,

            <span class="vcard"><span class="fn">Eike Hein</span>
</span>
          </span>
        </td>


        <td>
          <a href="attachment.cgi?id=39330&amp;action=edit">Details</a>
        </td>
      </tr>

  <tr class="bz_attach_footer">
    <td colspan="2">
        <span class="bz_attach_view_hide">
            <a id="view_all" href="attachment.cgi?bugid=219985&amp;action=viewall">View All</a>
        </span>
        <a href="attachment.cgi?bugid=219985&amp;action=enter">Add an attachment</a>
    </td>
  </tr>
</table>
<br>
<div id="add_comment" class="bz_section_additional_comments">
      <table>
        <tr>
          <td>
            <fieldset>
              <legend>Note</legend>
              You need to
              <a href="show_bug.cgi?id=219985&amp;GoAheadAndLogIn=1">log in</a>
              before you can comment on or make changes to this bug.
            </fieldset>
          </td>
        </tr> 
      </table>
  </div>
  </td>
  <td>
  </td>
  </tr></table>

  
  <div id="comments"><script src="js/comments.js?1477425084" type="text/javascript">
</script>

<script type="text/javascript">
<!--
  /* Adds the reply text to the 'comment' textarea */
  function replyToComment(id, real_id, name) {
      var prefix = "(In reply to " + name + " from comment #" + id + ")\n";
      var replytext = "";
        /* pre id="comment_name_N" */
        var text_elem = document.getElementById('comment_text_'+id);
        var text = getText(text_elem);
        replytext = prefix + wrapReplyText(text);


      /* <textarea id="comment"> */
      var textarea = document.getElementById('comment');
      if (textarea.value != replytext) {
          textarea.value += replytext;
      }

      textarea.focus();
  } 
//-->
</script>


<!-- This auto-sizes the comments and positions the collapse/expand links 
     to the right. -->
<table class="bz_comment_table">
<tr>
<td>
<div id="c0" class="bz_comment bz_first_comment">

      <div class="bz_first_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=219985#c0">Description</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Ken Rushia</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-12-24 19:48:45 UTC
        </span>

      </div>




<pre class="bz_comment_text">Application that crashed: konversation
Version of the application: 1.2.1
KDE Version: 4.3.4 (KDE 4.3.4)
Qt Version: 4.6.0
Operating System: Linux 2.6.31-gentoo-r1 x86_64
Distribution: &quot;Funtoo Linux - baselayout 2.1.6&quot;

What I was doing when the application crashed:
Konversation crashes shortly after strings such as the example below are received. Note it is copied from log file so may not be 100% exact.

[Thursday 24 December 2009] [13:45:07] &lt;kama&gt;   yes?
[Thursday 24 December 2009] [13:45:11] &lt;krushia&gt;        crash me
[Thursday 24 December 2009] [13:45:14] &lt;krushia&gt;        please :)
[Thursday 24 December 2009] [13:45:25] &lt;kama&gt;   are you sure?
[Thursday 24 December 2009] [13:45:26] &lt;kama&gt;   ok..
[Thursday 24 December 2009] [13:45:31] &lt;kama&gt;   UniSearch &lt;e&gt;: EeÃ¨Ã©ÃªÃ«ÄÄÄÄÄÈÈ©áµá¸á¸º¹áº»áº½ââ¯ââ âããï½ðððð®ð¢ððð¾ð²ð¦ððó ¥

 -- Backtrace:
Application: Konversation (konversation), signal: Segmentation fault
[Current thread is 1 (Thread 0x7f43e1f96740 (LWP 19552))]

Thread 2 (Thread 0x7f43d10c7950 (LWP 19553)):
#0  0x00007f43dcfc7dc9 in pthread_cond_wait&#64;&#64;GLIBC_2.3.2 () from /lib/libpthread.so.0
#1  0x00007f43de425ce9 in QWaitConditionPrivate::wait (this=0x2253280, mutex=0x2253278, time=18446744073709551615) at thread/qwaitcondition_unix.cpp:87
#2  QWaitCondition::wait (this=0x2253280, mutex=0x2253278, time=18446744073709551615) at thread/qwaitcondition_unix.cpp:159
#3  0x00007f43df80674c in QHostInfoAgent::run (this=0x2253260) at kernel/qhostinfo.cpp:252
#4  0x00007f43de424e25 in QThreadPrivate::start (arg=0x2253260) at thread/qthread_unix.cpp:244
#5  0x00007f43dcfc4017 in start_thread () from /lib/libpthread.so.0
#6  0x00007f43dd2a8f4d in clone () from /lib/libc.so.6
#7  0x0000000000000000 in ?? ()

Thread 1 (Thread 0x7f43e1f96740 (LWP 19552)):
[KCrash Handler]
#5  QObject::d_func (sender=0x0, m=&lt;value optimized out&gt;, local_signal_index=1, argv=0x7fff9ec34050) at kernel/qobject.h:121
#6  QMetaObject::activate (sender=0x0, m=&lt;value optimized out&gt;, local_signal_index=1, argv=0x7fff9ec34050) at kernel/qobject.cpp:3209
#7  0x00007f43de8844ba in QDBusConnectionPrivate::callWithCallbackFailed (this=0x2, _t1=&lt;value optimized out&gt;, _t2=&lt;value optimized out&gt;) at .moc/release-shared/moc_qdbusconnection_p.cpp:118
#8  0x00007f43de852ae8 in QDBusConnectionPrivate::processFinishedCall (call=0x3d960a0) at qdbusintegrator.cpp:1724
#9  0x00007f43de857633 in QDBusConnectionPrivate::sendWithReplyAsync (this=0x1c43f20, message=&lt;value optimized out&gt;, receiver=0x23d9dd0, returnMethod=0x7f43df2a3ee2 &quot;1slotReceivedId(int)&quot;, 
    errorMethod=0x7f43df2a3f78 &quot;1slotReceivedIdError(QDBusError)&quot;, timeout=&lt;value optimized out&gt;) at qdbusintegrator.cpp:1946
#10 0x00007f43de844f6d in QDBusConnection::callWithCallback (this=0x22f5780, message=..., receiver=0x3, returnMethod=0x3 &lt;Address 0x3 out of bounds&gt;, errorMethod=0x7f43de5c0020 &quot;\004&quot;, timeout=4)
    at qdbusconnection.cpp:461
#11 0x00007f43de85d535 in QDBusAbstractInterface::callWithCallback (this=&lt;value optimized out&gt;, method=..., args=..., receiver=0x23d9dd0, returnMethod=0x7f43df2a3ee2 &quot;1slotReceivedId(int)&quot;, 
    errorMethod=0x7f43df2a3f78 &quot;1slotReceivedIdError(QDBusError)&quot;) at qdbusabstractinterface.cpp:518
#12 0x00007f43df1a7ba7 in KNotificationManager::notify (this=0x2298130, n=0x23d9dd0, pix=&lt;value optimized out&gt;, actions=..., contexts=&lt;value optimized out&gt;, appname=...)
    at /var/tmp/portage/kde-base/kdelibs-4.3.4/work/kdelibs-4.3.4/kdeui/util/knotificationmanager.cpp:139
#13 0x00007f43df1a527d in KNotification::sendEvent (this=0x23d9dd0) at /var/tmp/portage/kde-base/kdelibs-4.3.4/work/kdelibs-4.3.4/kdeui/util/knotification.cpp:345
#14 0x00007f43df1a63e8 in KNotification::qt_metacall (this=0x23d9dd0, _c=QMetaObject::InvokeMetaMethod, _id=&lt;value optimized out&gt;, _a=0x7fff9ec34660)
    at /var/tmp/portage/kde-base/kdelibs-4.3.4/work/kdelibs-4.3.4_build/kdeui/knotification.moc:109
#15 0x00007f43de52c72f in QMetaObject::activate (sender=0x3b18430, m=&lt;value optimized out&gt;, local_signal_index=&lt;value optimized out&gt;, argv=0x3) at kernel/qobject.cpp:3286
#16 0x00007f43de53346f in QSingleShotTimer::timerEvent (this=0x3b18430) at kernel/qtimer.cpp:308
#17 0x00007f43de528b33 in QObject::event (this=0x3b18430, e=0x0) at kernel/qobject.cpp:1216
#18 0x00007f43dd9f3c7d in QApplicationPrivate::notify_helper (this=0x1c58880, receiver=0x3b18430, e=0x7fff9ec34e30) at kernel/qapplication.cpp:4242
#19 0x00007f43dd9fc493 in QApplication::notify (this=0x7fff9ec35170, receiver=0x3b18430, e=0x7fff9ec34e30) at kernel/qapplication.cpp:3661
#20 0x00007f43df137f1b in KApplication::notify (this=0x7fff9ec35170, receiver=0x3b18430, event=0x7fff9ec34e30)
    at /var/tmp/portage/kde-base/kdelibs-4.3.4/work/kdelibs-4.3.4/kdeui/kernel/kapplication.cpp:302
#21 0x00007f43de518bb3 in QCoreApplication::notifyInternal (this=0x7fff9ec35170, receiver=0x3b18430, event=0x7fff9ec34e30) at kernel/qcoreapplication.cpp:704
#22 0x00007f43de5465a4 in QCoreApplication::sendEvent (this=0x1c74ce0) at kernel/qcoreapplication.h:215
#23 QTimerInfoList::activateTimers (this=0x1c74ce0) at kernel/qeventdispatcher_unix.cpp:603
#24 0x00007f43de542eb8 in timerSourceDispatch (source=&lt;value optimized out&gt;) at kernel/qeventdispatcher_glib.cpp:184
#25 idleTimerSourceDispatch (source=&lt;value optimized out&gt;) at kernel/qeventdispatcher_glib.cpp:231
#26 0x00007f43d95e0001 in g_main_dispatch (context=0x1c5b020) at gmain.c:1960
#27 IA__g_main_context_dispatch (context=0x1c5b020) at gmain.c:2513
#28 0x00007f43d95e38c8 in g_main_context_iterate (context=0x1c5b020, block=1, dispatch=1, self=&lt;value optimized out&gt;) at gmain.c:2591
#29 0x00007f43d95e3a8c in IA__g_main_context_iteration (context=0x1c5b020, may_block=1) at gmain.c:2654
#30 0x00007f43de542b8c in QEventDispatcherGlib::processEvents (this=0x1c4d550, flags=&lt;value optimized out&gt;) at kernel/qeventdispatcher_glib.cpp:407
#31 0x00007f43dda8ff3f in QGuiEventDispatcherGlib::processEvents (this=0x2, flags=&lt;value optimized out&gt;) at kernel/qguieventdispatcher_glib.cpp:202
#32 0x00007f43de5174e2 in QEventLoop::processEvents (this=&lt;value optimized out&gt;, flags=...) at kernel/qeventloop.cpp:149
#33 0x00007f43de5178b4 in QEventLoop::exec (this=0x7fff9ec350e0, flags=...) at kernel/qeventloop.cpp:201
#34 0x00007f43de519d26 in QCoreApplication::exec () at kernel/qcoreapplication.cpp:981
#35 0x0000000000466401 in main (argc=5, argv=0x7fff9ec35e88) at /var/tmp/portage/net-irc/konversation-1.2.1/work/konversation-1.2.1/src/main.cpp:98

Reported using DrKonqi</pre>
    </div>

    <div id="c1" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=219985#c1">Comment 1</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Dario Andres</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-12-24 20:09:56 UTC
        </span>

      </div>




<pre class="bz_comment_text">This is likely to be <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED UPSTREAM - KRunner crashed when I tried to launch Konsole (QMetaObject::activate, QDBusConnectionPrivate::callWithCallbackFailed , QDBusConnectionPrivate::processFinishedCall, ..KNotificationManager::notify)"
   href="show_bug.cgi?id=199485">bug 199485</a>. Regards</pre>
    </div>

    <div id="c2" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=219985#c2">Comment 2</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Nicolás Alvarez</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-12-24 21:02:57 UTC
        </span>

      </div>




<pre class="bz_comment_text">I did some more tests, getting my konversation crashed while I logged the incoming IRC data from netcat. Attaching the log.

Every time PovAdct_crash quits, it crashed.

I edited the log a bit to show lines I manually sent from netcat, so the conversation makes sense. Everything else is what I received from the IRC server directly.</pre>
    </div>

    <div id="c3" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=219985#c3">Comment 3</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Nicolás Alvarez</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-12-24 21:10:49 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class=""><a href="attachment.cgi?id=39319" name="attach_39319" title="IRC protocol dump">attachment 39319</a> <a href="attachment.cgi?id=39319&amp;action=edit" title="IRC protocol dump">[details]</a></span>
IRC protocol dump</pre>
    </div>

    <div id="c4" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=219985#c4">Comment 4</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Eike Hein</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-12-25 13:52:34 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class=""><a href="attachment.cgi?id=39329" name="attach_39329" title="Crash backtrace">attachment 39329</a> <a href="attachment.cgi?id=39329&amp;action=edit" title="Crash backtrace">[details]</a></span>
Crash backtrace

A better backtrace, after sending a few messages with the magic chars and a few with plain ASCII in a query from irssi to Konvi.</pre>
    </div>

    <div id="c5" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=219985#c5">Comment 5</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Eike Hein</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-12-25 13:54:50 UTC
        </span>

      </div>




<pre class="bz_comment_text">Created <span class=""><a href="attachment.cgi?id=39330" name="attach_39330" title="Crash backtrace with config dialog involvement">attachment 39330</a> <a href="attachment.cgi?id=39330&amp;action=edit" title="Crash backtrace with config dialog involvement">[details]</a></span>
Crash backtrace with config dialog involvement

Another, somewhat more interesting backtrace. This happens when opening the Konversation settings dialog after sending a few messages containing the magic chars and sending a few messages containing plan ASCII in a query from irssi to Konvi. It crashes immediately after clicking &quot;Configure Konversation&quot; in the menu.

According to the backtrace, it hits a Q_ASSERT(false) in qdbusintegrator.cpp:2033.</pre>
    </div>

    <div id="c6" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=219985#c6">Comment 6</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Eike Hein</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-12-25 13:55:55 UTC
        </span>

      </div>




<pre class="bz_comment_text">Since all the backtraces end up in QDbus code I'm adding Thiago to the CC list.

Thiago, any ideas?</pre>
    </div>

    <div id="c7" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=219985#c7">Comment 7</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Eike Hein</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-12-25 14:05:43 UTC
        </span>

      </div>




<pre class="bz_comment_text">Valgrind:

==12162== Invalid read of size 4
==12162==    at 0x551BEEE: QScopedPointer&lt;QObjectData, QScopedPointerDeleter&lt;QObjectData&gt; &gt;::data() const (qscopedpointer.h:135)
==12162==    by 0x5534308: QScopedPointer&lt;QObjectData, QScopedPointerDeleter&lt;QObjectData&gt; &gt;::pointer qGetPtrHelper&lt;QScopedPointer&lt;QObjectData, QScopedPointerDeleter&lt;QObjectData&gt; &gt; &gt;(QScopedPointer&lt;QObjectData, QScopedPointerDeleter&lt;QObjectData&gt; &gt; const&amp;) (qglobal.h:2317)
==12162==    by 0x55343AD: QObject::d_func() (qobject.h:125)
==12162==    by 0x566F3E0: QMetaObject::activate(QObject*, QMetaObject const*, int, void**) (qobject.cpp:3188)
==12162==    by 0x54AB916: QDBusConnectionPrivate::callWithCallbackFailed(QDBusError const&amp;, QDBusMessage const&amp;) (moc_qdbusconnection_p.cpp:124)
==12162==    by 0x5474BF1: QDBusConnectionPrivate::processFinishedCall(QDBusPendingCallPrivate*) (qdbusintegrator.cpp:1725)
==12162==    by 0x54766DC: QDBusConnectionPrivate::sendWithReplyAsync(QDBusMessage const&amp;, QObject*, char const*, char const*, int) (qdbusintegrator.cpp:1947)
==12162==    by 0x5466723: QDBusConnection::callWithCallback(QDBusMessage const&amp;, QObject*, char const*, char const*, int) const (qdbusconnection.cpp:461)
==12162==    by 0x5484E24: QDBusAbstractInterface::callWithCallback(QString const&amp;, QList&lt;QVariant&gt; const&amp;, QObject*, char const*, char const*) (qdbusabstractinterface.cpp:518)
==12162==    by 0x4D7D33D: KNotificationManager::notify(KNotification*, QPixmap const&amp;, QStringList const&amp;, QList&lt;QPair&lt;QString, QString&gt; &gt; const&amp;, QString const&amp;) (knotificationmanager.cpp:143)
==12162==    by 0x4D7ABAF: KNotification::sendEvent() (knotification.cpp:368)
==12162==    by 0x4D7B110: KNotification::qt_metacall(QMetaObject::Call, int, void**) (knotification.moc:109)
==12162==  Address 0xad is not stack'd, malloc'd or (recently) free'd</pre>
    </div>

    <div id="c8" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=219985#c8">Comment 8</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Eike Hein</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-12-25 14:08:05 UTC
        </span>

      </div>




<pre class="bz_comment_text">Actually, this block before the one in <a href="show_bug.cgi?id=219985#c7">comment #7</a> looks relevant as well:

==12162== Use of uninitialised value of size 4
==12162==    at 0x551BEEE: QScopedPointer&lt;QObjectData, QScopedPointerDeleter&lt;QObjectData&gt; &gt;::data() const (qscopedpointer.h:135)
==12162==    by 0x5534308: QScopedPointer&lt;QObjectData, QScopedPointerDeleter&lt;QObjectData&gt; &gt;::pointer qGetPtrHelper&lt;QScopedPointer&lt;QObjectData, QScopedPointerDeleter&lt;QObjectData&gt; &gt; &gt;(QScopedPointer&lt;QObjectData, QScopedPointerDeleter&lt;QObjectData&gt; &gt; const&amp;) (qglobal.h:2317)
==12162==    by 0x55343AD: QObject::d_func() (qobject.h:125)
==12162==    by 0x566F3E0: QMetaObject::activate(QObject*, QMetaObject const*, int, void**) (qobject.cpp:3188)
==12162==    by 0x54AB916: QDBusConnectionPrivate::callWithCallbackFailed(QDBusError const&amp;, QDBusMessage const&amp;) (moc_qdbusconnection_p.cpp:124)
==12162==    by 0x5474BF1: QDBusConnectionPrivate::processFinishedCall(QDBusPendingCallPrivate*) (qdbusintegrator.cpp:1725)
==12162==    by 0x54766DC: QDBusConnectionPrivate::sendWithReplyAsync(QDBusMessage const&amp;, QObject*, char const*, char const*, int) (qdbusintegrator.cpp:1947)
==12162==    by 0x5466723: QDBusConnection::callWithCallback(QDBusMessage const&amp;, QObject*, char const*, char const*, int) const (qdbusconnection.cpp:461)
==12162==    by 0x5484E24: QDBusAbstractInterface::callWithCallback(QString const&amp;, QList&lt;QVariant&gt; const&amp;, QObject*, char const*, char const*) (qdbusabstractinterface.cpp:518)
==12162==    by 0x4D7D33D: KNotificationManager::notify(KNotification*, QPixmap const&amp;, QStringList const&amp;, QList&lt;QPair&lt;QString, QString&gt; &gt; const&amp;, QString const&amp;) (knotificationmanager.cpp:143)
==12162==    by 0x4D7ABAF: KNotification::sendEvent() (knotification.cpp:368)
==12162==    by 0x4D7B110: KNotification::qt_metacall(QMetaObject::Call, int, void**) (knotification.moc:109)</pre>
    </div>

    <div id="c9" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=219985#c9">Comment 9</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Thiago Macieira</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-12-25 14:42:58 UTC
        </span>

      </div>




<pre class="bz_comment_text">The backtrace in the original post is missing key information in frames 10 and 11. Please rebuild Qt in debug mode or 32-bit.</pre>
    </div>

    <div id="c10" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=219985#c10">Comment 10</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Thiago Macieira</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-12-25 14:47:47 UTC
        </span>

      </div>




<pre class="bz_comment_text">The crash in <a href="show_bug.cgi?id=219985#c4">comment 4</a> (<span class=""><a href="attachment.cgi?id=39329" name="attach_39329" title="Crash backtrace">attachment 39329</a> <a href="attachment.cgi?id=39329&amp;action=edit" title="Crash backtrace">[details]</a></span> -- please don't attach backtraces) is 32-bit. However, it's ending in a condition which is impossible: the d-pointer of a QObject is 0. The line numbers in qobject.cpp are not valid too -- they point to a line without code in Qt 4.6.0. 

Please use a PRISTINE version of Qt -- if you patch it, you take the blame for any crashes.</pre>
    </div>

    <div id="c11" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=219985#c11">Comment 11</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Thiago Macieira</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-12-25 14:50:52 UTC
        </span>

      </div>




<pre class="bz_comment_text">The crash in <a href="show_bug.cgi?id=219985#c5">comment 5</a> is caused by a D-Bus error in the daemon. Please check your output log. It's probably the known issue in the daemon reporting that this program has exceeded the allowed number of rules.

I also see no reason to think it's related to the other crashes.</pre>
    </div>

    <div id="c12" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=219985#c12">Comment 12</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Thiago Macieira</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-12-25 14:57:31 UTC
        </span>

      </div>




<pre class="bz_comment_text">Both valgrind traces match the first two crash backtraces. They both point to the same impossible situation: the QDBusConnectionPrivate is invalid. The d-pointer is null in the crashes and in one of the valgrind traces, uninitialised in the other.

I cannot proceed. I need a testcase.</pre>
    </div>

    <div id="c13" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=219985#c13">Comment 13</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Eike Hein</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-12-25 15:26:15 UTC
        </span>

      </div>




<pre class="bz_comment_text">The Qt used for the backtrace in <a href="show_bug.cgi?id=219985#c4">comment #4</a> was an unpatched 4.6 git from ~10 days ago or so. Unfortunately I can't post git describe output however (the clone is gone).

Considering that this apparently dropped around two dozen clients from #konversation yesterday and that it's relatively unlikely all of those were running a deviously patched Qt, I doubt it's a patch issue.

As for the valgrind output from comments #7 and #8, they're both from the same trace, actually, sorry, with #8 preceeding #7 in the original log.

Regarding producing a backtrace using Qt 4.6.0, it might be some time before I get a chance to generate one, so to everyone listening in please don't hesitate to beat me to it.</pre>
    </div>

    <div id="c14" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=219985#c14">Comment 14</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Eike Hein</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-12-25 15:29:55 UTC
        </span>

      </div>




<pre class="bz_comment_text"><span class="quote">&gt; I also see no reason to think it's related to the other crashes.</span >

Well, it's reproducable every time with Konversation in the state of having received messages containing the magic chars, and I can't reproduce it otherwise, so while I have no harder info to go on, it'd be a pretty big coincidence if there wasn't a link there.</pre>
    </div>

    <div id="c15" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=219985#c15">Comment 15</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Nicolás Alvarez</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-12-25 20:43:40 UTC
        </span>

      </div>




<pre class="bz_comment_text">I looked at konversation after a crash in gdb. The PendingCall parameter passed to QDBusConnectionPrivate::processFinishedCall seems corrupted, call-&gt;connection is an invalid pointer (0x6f006900740061). So the &quot;emit connection-&gt;callWithCallbackFailed&quot; call crashes right afterwards.</pre>
    </div>

    <div id="c16" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=219985#c16">Comment 16</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Eike Hein</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-12-25 21:19:57 UTC
        </span>

      </div>




<pre class="bz_comment_text">As requested, here's a crash backtrace using Qt 4.6.0:

Application: Konversation (konversation), signal: Segmentation fault
[Current thread is 1 (Thread 0xb4d7b700 (LWP 27593))]

Thread 2 (Thread 0xb2e86b70 (LWP 27598)):
#0  0xb7816424 in __kernel_vsyscall ()
#1  0xb6142f65 in pthread_cond_wait&#64;&#64;GLIBC_2.3.2 () at ../nptl/sysdeps/unix/sysv/linux/i386/i686/../i486/pthread_cond_wait.S:122
#2  0xb61ba2da in QWaitConditionPrivate::wait (this=0x8d1d210, mutex=0x8d1d20c, time=4294967295) at thread/qwaitcondition_unix.cpp:87
#3  QWaitCondition::wait (this=0x8d1d210, mutex=0x8d1d20c, time=4294967295) at thread/qwaitcondition_unix.cpp:159
#4  0xb67a726d in QHostInfoAgent::run (this=0x8d1d200) at kernel/qhostinfo.cpp:252
#5  0xb61b92f8 in QThreadPrivate::start (arg=0x8d1d200) at thread/qthread_unix.cpp:244
#6  0xb613e8df in start_thread (arg=0xb2e86b70) at pthread_create.c:297
#7  0xb55f519e in clone () at ../sysdeps/unix/sysv/linux/i386/clone.S:130

Thread 1 (Thread 0xb4d7b700 (LWP 27593)):
[KCrash Handler]
#6  0xb62cb546 in QMetaObject::activate (sender=0x8d601a0, m=0xb6435d64, local_signal_index=5, argv=0xbfe048b4) at kernel/qobject.cpp:3236
#7  0xb6425ee3 in QDBusConnectionPrivate::callWithCallbackFailed (this=0x8d601a0, _t1=..., _t2=...) at .moc/debug-shared/moc_qdbusconnection_p.cpp:118
#8  0xb63f4016 in QDBusConnectionPrivate::processFinishedCall (call=0x8d97748) at qdbusintegrator.cpp:1724
#9  0xb63f8bcf in QDBusConnectionPrivate::sendWithReplyAsync (this=0x82e2580, message=..., receiver=0x84bfd08, returnMethod=0xb6c12730 &quot;1slotReceivedId(int)&quot;,
    errorMethod=0xb6c126bc &quot;1slotReceivedIdError(QDBusError)&quot;, timeout=-1) at qdbusintegrator.cpp:1946
#10 0xb63e6c1a in QDBusConnection::callWithCallback (this=0x8d6e078, message=..., receiver=0x84bfd08, returnMethod=0xb6c12730 &quot;1slotReceivedId(int)&quot;,
    errorMethod=0xb6c126bc &quot;1slotReceivedIdError(QDBusError)&quot;, timeout=-1) at qdbusconnection.cpp:461
#11 0xb640108f in QDBusAbstractInterface::callWithCallback (this=0x8ccf418, method=..., args=..., receiver=0x84bfd08, returnMethod=0xb6c12730 &quot;1slotReceivedId(int)&quot;,
    errorMethod=0xb6c126bc &quot;1slotReceivedIdError(QDBusError)&quot;) at qdbusabstractinterface.cpp:518
#12 0xb6aaf1d2 in KNotificationManager::notify (this=0x8d4ceb0, n=0x84bfd08, pix=..., actions=..., contexts=..., appname=...)
    at /home/kdedev/kde/src/KDE/kdelibs/kdeui/notifications/knotificationmanager.cpp:143
#13 0xb6aaca44 in KNotification::sendEvent (this=0x84bfd08) at /home/kdedev/kde/src/KDE/kdelibs/kdeui/notifications/knotification.cpp:368
#14 0xb6aacfa5 in KNotification::qt_metacall (this=0x84bfd08, _c=QMetaObject::InvokeMetaMethod, _id=13, _a=0xbfe04ce4) at /home/kdedev/kde/build/KDE/kdelibs/kdeui/knotification.moc:109
#15 0xb62bccdb in QMetaObject::metacall (object=0x84bfd08, cl=QMetaObject::InvokeMetaMethod, idx=17, argv=0xbfe04ce4) at kernel/qmetaobject.cpp:237
#16 0xb62cb802 in QMetaObject::activate (sender=0x8d97cb8, m=0xb63d21a4, local_signal_index=&lt;value optimized out&gt;, argv=&lt;value optimized out&gt;) at kernel/qobject.cpp:3286
#17 0xb62d3801 in QSingleShotTimer::timeout (this=0x8d97cb8) at .moc/debug-shared/qtimer.moc:82
#18 0xb62d3994 in QSingleShotTimer::timerEvent (this=0x8d97cb8) at kernel/qtimer.cpp:308
#19 0xb62c7e57 in QObject::event (this=0x8d97cb8, e=0xbfe050f0) at kernel/qobject.cpp:1216
#20 0xb58ec6fd in QApplicationPrivate::notify_helper (this=0x82f0690, receiver=0x8d97cb8, e=0xbfe050f0) at kernel/qapplication.cpp:4242
#21 0xb58f47fe in QApplication::notify (this=0xbfe05428, receiver=0x8d97cb8, e=0xbfe050f0) at kernel/qapplication.cpp:3661
#22 0xb6a6c1d4 in KApplication::notify (this=0xbfe05428, receiver=0x8d97cb8, event=0xbfe050f0) at /home/kdedev/kde/src/KDE/kdelibs/kdeui/kernel/kapplication.cpp:302
#23 0xb62b63ee in QCoreApplication::notifyInternal (this=0xbfe05428, receiver=0x8d97cb8, event=0xbfe050f0) at kernel/qcoreapplication.cpp:704
#24 0xb62e636d in QCoreApplication::sendEvent (this=0x82f60a4) at kernel/qcoreapplication.h:215
#25 QTimerInfoList::activateTimers (this=0x82f60a4) at kernel/qeventdispatcher_unix.cpp:603
#26 0xb62e429f in timerSourceDispatch (source=0x82f6070) at kernel/qeventdispatcher_glib.cpp:184
#27 0xb62e42ce in idleTimerSourceDispatch (source=0x82f6500) at kernel/qeventdispatcher_glib.cpp:231
#28 0xb50fda04 in g_main_dispatch (context=0x82f5a98) at gmain.c:1960
#29 IA__g_main_context_dispatch (context=0x82f5a98) at gmain.c:2513
#30 0xb5100ad9 in g_main_context_iterate (context=0x82f5a98, block=&lt;value optimized out&gt;, dispatch=1, self=0x82f0528) at gmain.c:2591
#31 0xb5100bb8 in IA__g_main_context_iteration (context=0x82f5a98, may_block=1) at gmain.c:2654
#32 0xb62e3e4a in QEventDispatcherGlib::processEvents (this=0x82e80c8, flags=) at kernel/qeventdispatcher_glib.cpp:407
#33 0xb59959d5 in QGuiEventDispatcherGlib::processEvents (this=0x82e80c8, flags=...) at kernel/qguieventdispatcher_glib.cpp:202
#34 0xb62b4b1a in QEventLoop::processEvents (this=0xbfe053a4, flags=) at kernel/qeventloop.cpp:149
#35 0xb62b4f11 in QEventLoop::exec (this=0xbfe053a4, flags=) at kernel/qeventloop.cpp:201
#36 0xb62b752d in QCoreApplication::exec () at kernel/qcoreapplication.cpp:981
#37 0xb58eb52f in QApplication::exec () at kernel/qapplication.cpp:3570
#38 0x080a53dd in main (argc=1, argv=0xbfe05834) at /home/kdedev/devel/src/konversation/src/main.cpp:101</pre>
    </div>

    <div id="c17" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=219985#c17">Comment 17</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Thiago Macieira</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-12-25 21:47:39 UTC
        </span>

      </div>




<pre class="bz_comment_text">Thanks Eike. But the backtrace didn't help. The crash is simply not possible at that point, short of memory corruption.

The pointer that Nicolás posted actually corroborates that hypothesis: memory smashing. Note how the pointer contains exactly 4 legal UTF-16 characters: 0x6f006900740061 (that is, the string &quot;atio&quot;).

If this problem happens only when that string is sent, I recommend you do a step-by-step debugging of the string decoding, to see where things went wrong.

Nothing here has proved a D-Bus error, nor even a Qt bug. If you can reduce it to a Qt-only testcase, I'll take a look.</pre>
    </div>

    <div id="c18" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=219985#c18">Comment 18</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Eike Hein</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-12-25 22:43:58 UTC
        </span>

      </div>




<pre class="bz_comment_text">Alrighty -- thanks for the analysis, Thiago.

Due to the usual Christmas stuff I haven't had any time to look at this more closely yet beyond firing off the compile jobs and crashing it a few times. I guess a good approach here would be to try and write a minimal test app next that exhibits the same problem, to get the bulk of the Konvi codebase out of the way and have something easier to pass around. Since that'd probably use KNotify to mimic things it wouldn't be Qt-only straight away either, however.

The list of dupes on <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Edit file with Kate"
   href="show_bug.cgi?id=213302">bug 213302</a> is pretty scary, however for Konvi it's especially dire of course ...

Gotta run for now unfortunately. Hope I can have a go at this at some point in the next days.</pre>
    </div>

    <div id="c19" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=219985#c19">Comment 19</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Olivier Goffart</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-01-05 16:06:28 UTC
        </span>

      </div>




<pre class="bz_comment_text">SVN commit 1070404 by ogoffart:

Fixes crash when calling KNotification::sendEvent while still waiting for id from dbus.

In that case, it could assign two id to the same notifications, resulting in crashes later.

BUG: 199485
BUG: 219985



 M  +16 -6     knotification.cpp  


WebSVN link: <a href="http://websvn.kde.org/?view=rev&amp;revision=1070404">http://websvn.kde.org/?view=rev&amp;revision=1070404</a></pre>
    </div>

    <div id="c20" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=219985#c20">Comment 20</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">argonel</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-02-06 06:57:21 UTC
        </span>

      </div>




<pre class="bz_comment_text">*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - konversation crashed after several days"
   href="show_bug.cgi?id=225690">Bug 225690</a> has been marked as a duplicate of this bug. ***</pre>
    </div>

    <div id="c21" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=219985#c21">Comment 21</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">argonel</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-02-06 07:05:08 UTC
        </span>

      </div>




<pre class="bz_comment_text">It looks like this is not solved. Konversation itself doesn't die immediately upon receipt of the message, it dies because the dbus socket is closed.

In the konsole from which konversation was launched, this message was repeated 4 times:

konversation(1531)/kdeui (KNotification) KNotification::slotReceivedIdError: Error while contacting notify daemon &quot;Not connected to server&quot;

I was using Qt: 4.6.1 KDE Development Platform: 4.4.60 (KDE 4.4.60 (KDE 4.5 &gt;= 20100120)) during testing, but the original instance mentioned in bug It looks like this is not solved. Konversation itself doesn't die immediately upon receipt of the message, it dies because the dbus socket is closed.

In the konsole from which konversation was launched, this message was repeated 4 times:

konversation(1531)/kdeui (KNotification) KNotification::slotReceivedIdError: Error while contacting notify daemon &quot;Not connected to server&quot;

I was using Qt: 4.6.1 KDE Development Platform: 4.4.60 (KDE 4.4.60 (KDE 4.5 &gt;= 20100120)) during testing, but the original instance mentioned in <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - konversation crashed after several days"
   href="show_bug.cgi?id=225690">bug 225690</a> I was running 4.3.4 with qt 4.5.3.</pre>
    </div>

    <div id="c22" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=219985#c22">Comment 22</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">argonel</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-02-06 07:13:43 UTC
        </span>

      </div>




<pre class="bz_comment_text">commit 55356dac14ebed7eed93785f046f71318653d2b4
Author: eli mackenzie &lt;<a href="mailto:argonel&#64;gmail.com">argonel&#64;gmail.com</a>&gt;
Date:   Sat Feb 6 01:06:39 2010 -0500

    Disable Unicode in KNotify messages due to underlying KDE bug.
    
    CCBUG:219985

diff --git a/src/notificationhandler.cpp b/src/notificationhandler.cpp
index 9f913ca..1e0cdb7 100644
--- a/src/notificationhandler.cpp
+++ b/src/notificationhandler.cpp
&#64;&#64; -37,6 +37,12 &#64;&#64; namespace Konversation
     {
     }
 
+    QString cleanMessage(QString message)
+    {
+        QString cleanedMessage = Qt::escape(Konversation::removeIrcMarkup(message));
+        return cleanedMessage.toAscii();
+    }
+
     void NotificationHandler::message(ChatWindow* chatWin, const QString&amp; fromNick, const QString&amp; message)
     {
         if (!chatWin || !chatWin-&gt;notificationsEnabled())
&#64;&#64; -45,7 +51,7 &#64;&#64; namespace Konversation
         if (Preferences::self()-&gt;disableNotifyWhileAway() &amp;&amp; chatWin-&gt;getServer() &amp;&amp; chatWin-&gt;getServer()-&gt;isAway())
             return;
 
-        QString cleanedMessage = Qt::escape(Konversation::removeIrcMarkup(message));
+        QString cleanedMessage = cleanMessage(message);
         QString cutup = addLineBreaks(cleanedMessage);
 
         KNotification::event(QString::fromLatin1(&quot;message&quot;), QString(&quot;&lt;qt&gt;&amp;lt;%1&amp;gt; %2&lt;/qt&gt;&quot;).arg(fromNick).arg(cutup), QPixmap(), m_mainWindow);
&#64;&#64; -73,7 +79,7 &#64;&#64; namespace Konversation
         if (Preferences::self()-&gt;disableNotifyWhileAway() &amp;&amp; chatWin-&gt;getServer() &amp;&amp; chatWin-&gt;getServer()-&gt;isAway())
             return;
 
-        QString cleanedMessage = Qt::escape(Konversation::removeIrcMarkup(message));
+        QString cleanedMessage = cleanMessage(message);
         QString cutup = addLineBreaks(cleanedMessage);
 
         KNotification::event(QString::fromLatin1(&quot;nick&quot;), QString(&quot;&lt;qt&gt;&amp;lt;%1&amp;gt; %2&lt;/qt&gt;&quot;).arg(fromNick).arg(cutup), QPixmap(), m_mainWindow);
&#64;&#64; -99,7 +105,7 &#64;&#64; namespace Konversation
         if (Preferences::self()-&gt;disableNotifyWhileAway() &amp;&amp; chatWin-&gt;getServer() &amp;&amp; chatWin-&gt;getServer()-&gt;isAway())
             return;
 
-        QString cleanedMessage = Qt::escape(Konversation::removeIrcMarkup(message));
+        QString cleanedMessage = cleanMessage(message);
         QString cutup = addLineBreaks(cleanedMessage);
 
         KNotification::event(QString::fromLatin1(&quot;queryMessage&quot;), QString(&quot;&lt;qt&gt;&amp;lt;%1&amp;gt; %2&lt;/qt&gt;&quot;).arg(fromNick).arg(cutup), QPixmap(), m_mainWindow);
&#64;&#64; -314,7 +320,7 &#64;&#64; namespace Konversation
 
         startTrayNotification(chatWin);
 
-        QString cleanedMessage = Qt::escape(Konversation::removeIrcMarkup(message));
+        QString cleanedMessage = cleanMessage(message);
         QString cutup = addLineBreaks(cleanedMessage);
 
         if(fromNick.isEmpty())</pre>
    </div>

    <div id="c23" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=219985#c23">Comment 23</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">argonel</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-02-06 11:55:50 UTC
        </span>

      </div>




<pre class="bz_comment_text">commit 55356dac14ebed7eed93785f046f71318653d2b4
Author: eli mackenzie &lt;<a href="mailto:argonel&#64;gmail.com">argonel&#64;gmail.com</a>&gt;
Date:   Sat Feb 6 01:06:39 2010 -0500

    Disable Unicode in KNotify messages due to underlying KDE bug.
    
    CCBUG:219985

diff --git a/src/notificationhandler.cpp b/src/notificationhandler.cpp
index 9f913ca..1e0cdb7 100644
--- a/src/notificationhandler.cpp
+++ b/src/notificationhandler.cpp
&#64;&#64; -37,6 +37,12 &#64;&#64; namespace Konversation
     {
     }
 
+    QString cleanMessage(QString message)
+    {
+        QString cleanedMessage = Qt::escape(Konversation::removeIrcMarkup(message));
+        return cleanedMessage.toAscii();
+    }
+
     void NotificationHandler::message(ChatWindow* chatWin, const QString&amp; fromNick, const QString&amp; message)
     {
         if (!chatWin || !chatWin-&gt;notificationsEnabled())
&#64;&#64; -45,7 +51,7 &#64;&#64; namespace Konversation
         if (Preferences::self()-&gt;disableNotifyWhileAway() &amp;&amp; chatWin-&gt;getServer() &amp;&amp; chatWin-&gt;getServer()-&gt;isAway())
             return;
 
-        QString cleanedMessage = Qt::escape(Konversation::removeIrcMarkup(message));
+        QString cleanedMessage = cleanMessage(message);
         QString cutup = addLineBreaks(cleanedMessage);
 
         KNotification::event(QString::fromLatin1(&quot;message&quot;), QString(&quot;&lt;qt&gt;&amp;lt;%1&amp;gt; %2&lt;/qt&gt;&quot;).arg(fromNick).arg(cutup), QPixmap(), m_mainWindow);
&#64;&#64; -73,7 +79,7 &#64;&#64; namespace Konversation
         if (Preferences::self()-&gt;disableNotifyWhileAway() &amp;&amp; chatWin-&gt;getServer() &amp;&amp; chatWin-&gt;getServer()-&gt;isAway())
             return;
 
-        QString cleanedMessage = Qt::escape(Konversation::removeIrcMarkup(message));
+        QString cleanedMessage = cleanMessage(message);
         QString cutup = addLineBreaks(cleanedMessage);
 
         KNotification::event(QString::fromLatin1(&quot;nick&quot;), QString(&quot;&lt;qt&gt;&amp;lt;%1&amp;gt; %2&lt;/qt&gt;&quot;).arg(fromNick).arg(cutup), QPixmap(), m_mainWindow);
&#64;&#64; -99,7 +105,7 &#64;&#64; namespace Konversation
         if (Preferences::self()-&gt;disableNotifyWhileAway() &amp;&amp; chatWin-&gt;getServer() &amp;&amp; chatWin-&gt;getServer()-&gt;isAway())
             return;
 
-        QString cleanedMessage = Qt::escape(Konversation::removeIrcMarkup(message));
+        QString cleanedMessage = cleanMessage(message);
         QString cutup = addLineBreaks(cleanedMessage);
 
         KNotification::event(QString::fromLatin1(&quot;queryMessage&quot;), QString(&quot;&lt;qt&gt;&amp;lt;%1&amp;gt; %2&lt;/qt&gt;&quot;).arg(fromNick).arg(cutup), QPixmap(), m_mainWindow);
&#64;&#64; -314,7 +320,7 &#64;&#64; namespace Konversation
 
         startTrayNotification(chatWin);
 
-        QString cleanedMessage = Qt::escape(Konversation::removeIrcMarkup(message));
+        QString cleanedMessage = cleanMessage(message);
         QString cutup = addLineBreaks(cleanedMessage);
 
         if(fromNick.isEmpty())</pre>
    </div>

    <div id="c24" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=219985#c24">Comment 24</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Eike Hein</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-02-06 18:37:53 UTC
        </span>

      </div>




<pre class="bz_comment_text">Thiago has kindly investigated this further, and it turns out that D-Bus currently doesn't allow a range of Utf-8 characters that are reserved by the Unicode specification and not permitted for interchange. This range is U+FDD0 through U+FDEF. More information can be found here: <a href="http://www.unicode.org/charts/PDF/UFB50.pdf">http://www.unicode.org/charts/PDF/UFB50.pdf</a>

There are multiple avenues to fix this:

a) QString could reject those characters.
b) QtDbus could filter out these characters.
c) KNotify could filter out these characters.
d) Konversation could filter out these characters.
e) D-Bus could not close the connection when it sees these characters.

Whether or not 'a' and 'b' are realized or not, any such change will show up in Qt 4.6.3 at the earliest, which is still some time out seeing as 4.6.2 is not yet released.

'c' might thus be a good idea for now. However, seeing how KDE 4.4.0 is already tagged, it might be too late for that release.

That means Konversation should likely do 'd' for the impending 1.2.2 release. It certainly beats the heavy-handed toAscii() call.

We should however probably not limit this filter to Qt versions older than 4.6.3, since instead of the fix being made in Qt, it might instead be made in D-Bus. Thiago has written a mail to the D-Bus mailing list where he is pursueing 'e'. See here: <a href="http://lists.freedesktop.org/archives/dbus/2010-February/012182.html">http://lists.freedesktop.org/archives/dbus/2010-February/012182.html</a></pre>
    </div>

    <div id="c25" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=219985#c25">Comment 25</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Eike Hein</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-02-06 18:44:43 UTC
        </span>

      </div>




<pre class="bz_comment_text">I have flagged the primary bug, <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED UPSTREAM - KRunner crashed when I tried to launch Konsole (QMetaObject::activate, QDBusConnectionPrivate::callWithCallbackFailed , QDBusConnectionPrivate::processFinishedCall, ..KNotificationManager::notify)"
   href="show_bug.cgi?id=199485">bug #199485</a>, as a KDE 4.4.0 blocker, but I think we should still go ahead on developing a filter for Konversation given our own release timeline and that it might be too late for 4.4.0 already. Not to mention that this also affects KDE 4.3 anyway.</pre>
    </div>

    <div id="c26" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=219985#c26">Comment 26</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">argonel</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-02-11 06:38:11 UTC
        </span>

      </div>




<pre class="bz_comment_text">commit 9d90018b2bc78b22bac483861abcbad742ac7997
Author:     eli mackenzie &lt;<a href="mailto:argonel&#64;gmail.com">argonel&#64;gmail.com</a>&gt;
AuthorDate: Tue Feb 9 02:43:58 2010 -0500
Commit:     eli mackenzie &lt;<a href="mailto:argonel&#64;gmail.com">argonel&#64;gmail.com</a>&gt;
CommitDate: Thu Feb 11 00:27:09 2010 -0500

    Strip unusable Unicode code points because QString doesn't.
    
    Seems D-Bus closes the socket if it receives a Utf8 stream
    that it doesn't like. Presumably Qt will do this in the
    future.
    
    See <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED FIXED - Konversation crash when certain strings received"
   href="show_bug.cgi?id=219985">bug 219985</a>.

<a href="http://gitorious.org/konversation/konversation/commit/9d90018">http://gitorious.org/konversation/konversation/commit/9d90018</a></pre>
    </div>

    <div id="c27" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=219985#c27">Comment 27</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard">ais523
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-03-09 20:08:34 UTC
        </span>

      </div>




<pre class="bz_comment_text">In case it helps, I think I just came across this bug; here's the backtrace (produced by DrKonqui, but it doesn't seem to be able to report it itself for some reason):

Application that crashed: konversation
Version of the application: 1.2
KDE Version: 4.3.2 (KDE 4.3.2)
Qt Version: 4.5.2
Operating System: Linux 2.6.31-20-generic i686
Distribution: Ubuntu 9.10

 -- Backtrace:
Application: Konversation (konversation), signal: Segmentation fault
[Current thread is 1 (Thread 0xb7804760 (LWP 27581))]

Thread 2 (Thread 0xb59b1b70 (LWP 27701)):
#0  0x00ad2422 in __kernel_vsyscall ()
#1  0x00ba1e15 in pthread_cond_wait&#64;&#64;GLIBC_2.3.2 () at ../nptl/sysdeps/unix/sysv/linux/i386/i686/../i486/pthread_cond_wait.S:122
#2  0x0635e87d in __pthread_cond_wait (cond=0xa178f20, mutex=0xa178f08) at forward.c:139
#3  0x032e2e67 in QWaitConditionPrivate::wait (this=0xa06af30, mutex=0xa06af2c, time=4294967295) at thread/qwaitcondition_unix.cpp:87
#4  QWaitCondition::wait (this=0xa06af30, mutex=0xa06af2c, time=4294967295) at thread/qwaitcondition_unix.cpp:159
#5  0x0104f922 in QHostInfoAgent::run (this=0xa06af20) at kernel/qhostinfo.cpp:260
#6  0x032e1e32 in QThreadPrivate::start (arg=0xa06af20) at thread/qthread_unix.cpp:188
#7  0x00b9d80e in start_thread (arg=0xb59b1b70) at pthread_create.c:300
#8  0x063518de in clone () at ../sysdeps/unix/sysv/linux/i386/clone.S:130

Thread 1 (Thread 0xb7804760 (LWP 27581)):
[KCrash Handler]
#6  0x033e8ee1 in QMetaObject::activate (sender=0x31005b, m=0xa3adc4, local_signal_index=1, argv=0xbfaec304) at kernel/qobject.cpp:3183
#7  0x00a24bc9 in QDBusConnectionPrivate::callWithCallbackFailed (this=0x31005b, _t1=..., _t2=...) at .moc/release-shared/moc_qdbusconnection_p.cpp:112
#8  0x009eab85 in QDBusConnectionPrivate::processFinishedCall (call=0xace7050) at qdbusintegrator.cpp:1689
#9  0x009f0261 in QDBusConnectionPrivate::sendWithReplyAsync (this=0x9d87258, message=..., receiver=0xa861080, returnMethod=0x785f226 &quot;1slotReceivedId(int)&quot;, 
    errorMethod=0x785f2e0 &quot;1slotReceivedIdError(QDBusError)&quot;, timeout=-1) at qdbusintegrator.cpp:1899
#10 0x009d9ac5 in QDBusConnection::callWithCallback (this=0xa5f099c, message=..., receiver=0xa861080, returnMethod=0x785f226 &quot;1slotReceivedId(int)&quot;, 
    errorMethod=0x785f2e0 &quot;1slotReceivedIdError(QDBusError)&quot;, timeout=-1) at qdbusconnection.cpp:461
#11 0x009f8290 in QDBusAbstractInterface::callWithCallback (this=0xa5ee1d8, method=..., args=..., receiver=0xa861080, returnMethod=0x785f226 &quot;1slotReceivedId(int)&quot;, 
    errorMethod=0x785f2e0 &quot;1slotReceivedIdError(QDBusError)&quot;) at qdbusabstractinterface.cpp:471
#12 0x07749d22 in KNotificationManager::notify (this=0xa5e0b80, n=0xa861080, pix=..., actions=..., contexts=..., appname=...) at ../../kdeui/util/knotificationmanager.cpp:143
#13 0x077473c1 in KNotification::sendEvent (this=0xa861080) at ../../kdeui/util/knotification.cpp:341
#14 0x077487a3 in KNotification::qt_metacall (this=0xa861080, _c=QMetaObject::InvokeMetaMethod, _id=17, _a=0xbfaec74c) at ./knotification.moc:103
#15 0x033e8263 in QMetaObject::activate (sender=0xae26050, from_signal_index=4, to_signal_index=4, argv=0x0) at kernel/qobject.cpp:3113
#16 0x033e8ec2 in QMetaObject::activate (sender=0xae26050, m=0x34c2908, local_signal_index=0, argv=0x0) at kernel/qobject.cpp:3187
#17 0x033ed387 in QSingleShotTimer::timeout (this=0xae26050) at .moc/release-shared/qtimer.moc:76
#18 0x033ed49c in QSingleShotTimer::timerEvent (this=0xae26050) at kernel/qtimer.cpp:298
#19 0x033e23bf in QObject::event (this=0xae26050, e=0xbfaecbe0) at kernel/qobject.cpp:1075
#20 0x01b31f54 in QApplicationPrivate::notify_helper (this=0x9dac470, receiver=0xae26050, e=0xbfaecbe0) at kernel/qapplication.cpp:4056
#21 0x01b3967c in QApplication::notify (this=0xbfaecf40, receiver=0xae26050, e=0xbfaecbe0) at kernel/qapplication.cpp:3603
#22 0x076cebfa in KApplication::notify (this=0xbfaecf40, receiver=0xae26050, event=0xbfaecbe0) at ../../kdeui/kernel/kapplication.cpp:302
#23 0x033d26cb in QCoreApplication::notifyInternal (this=0xbfaecf40, receiver=0xae26050, event=0xbfaecbe0) at kernel/qcoreapplication.cpp:610
#24 0x033ff7ce in QCoreApplication::sendEvent (this=0x9d9f99c) at ../../include/QtCore/../../src/corelib/kernel/qcoreapplication.h:213
#25 QTimerInfoList::activateTimers (this=0x9d9f99c) at kernel/qeventdispatcher_unix.cpp:572
#26 0x033fd0e0 in timerSourceDispatch (source=0x9d9f968) at kernel/qeventdispatcher_glib.cpp:165
#27 0x05301e88 in g_main_context_dispatch () from /lib/libglib-2.0.so.0
#28 0x05305730 in ?? () from /lib/libglib-2.0.so.0
#29 0x05305863 in g_main_context_iteration () from /lib/libglib-2.0.so.0
#30 0x033fd02c in QEventDispatcherGlib::processEvents (this=0x9d6da78, flags=...) at kernel/qeventdispatcher_glib.cpp:327
#31 0x01bd2be5 in QGuiEventDispatcherGlib::processEvents (this=0x9d6da78, flags=...) at kernel/qguieventdispatcher_glib.cpp:202
#32 0x033d0c79 in QEventLoop::processEvents (this=0xbfaecea4, flags=) at kernel/qeventloop.cpp:149
#33 0x033d10ca in QEventLoop::exec (this=0xbfaecea4, flags=...) at kernel/qeventloop.cpp:201
#34 0x033d353f in QCoreApplication::exec () at kernel/qcoreapplication.cpp:888
#35 0x01b31dd7 in QApplication::exec () at kernel/qapplication.cpp:3525
#36 0x080a4e09 in main (argc=5, argv=0xbfaed354) at /build/buildd/konversation-1.2/src/main.cpp:98

I think it's probably the same bug because the backtrace is similar to those in duplicates of this bug (such as <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - konversation crashed after several days"
   href="show_bug.cgi?id=225690">bug 225690</a>), and the only unusual thing I noticed was that someone had just pasted a bunch of unusual characters to the channel I was viewing; here's a hexdump of the relevant part of my logs (the channel is publically logged, so this isn't a privacy problem):

00444c40: 7465 3e09 2174 656c 6c20 6772 6565 6e73  te&gt;.!tell greens
00444c50: 6e61 726b 20f0 908c 81f0 908c 84f0 908c  nark ...........
00444c60: b3f0 908c b1f0 908c 98f0 908c 9520 f090  ............. ..
00444c70: 8e81 f090 8e85 f090 8e8c f090 8eb4 f090  ................
00444c80: 8f88 2020 20f0 9d95 8420 f09d 9596 20f0  ..   .... .... .
00444c90: 9d95 a020 f09d 95a8 0a5b 5475 6573 6461  ... .....[Tuesda

It looks from this bug report like you've found the cause already, but I'm attaching this in case it turns out to be helpful.</pre>
    </div>

    <div id="c28" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=219985#c28">Comment 28</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Eike Hein</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-03-09 23:45:48 UTC
        </span>

      </div>




<pre class="bz_comment_text">Yeah, it's fixed as of Konversation 1.2.3.</pre>
    </div>

    <div id="c29" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=219985#c29">Comment 29</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Dario Andres</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-03-23 12:48:15 UTC
        </span>

      </div>




<pre class="bz_comment_text">- Should this be marked as fixed (considering the in-house fix on Konversation) and leave <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED UPSTREAM - KRunner crashed when I tried to launch Konsole (QMetaObject::activate, QDBusConnectionPrivate::callWithCallbackFailed , QDBusConnectionPrivate::processFinishedCall, ..KNotificationManager::notify)"
   href="show_bug.cgi?id=199485">bug 199485</a> opened (for a global fix) ?</pre>
    </div>

    <div id="c30" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=219985#c30">Comment 30</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Eike Hein</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2010-03-23 12:52:44 UTC
        </span>

      </div>




<pre class="bz_comment_text">Sounds ok.</pre>
    </div>


  

</td>
<td>
</td>
</tr></table>
  </div>
        

</form>

<hr>
<ul class="related_actions">
    <li><a href="show_bug.cgi?format=multiple&amp;id=219985">Format For Printing</a></li>
    <li>&nbsp;-&nbsp;<a href="show_bug.cgi?ctype=xml&amp;id=219985">XML</a></li>
    <li>&nbsp;-&nbsp;<a href="enter_bug.cgi?cloned_bug_id=219985">Clone This Bug</a></li>
    
    <li>&nbsp;-&nbsp;<a href="#">Top of page </a></li>
    </ul>

<br>
</div>

    <div id="footer">
      <div class="intro"></div>
<ul id="useful-links">
  <li id="links-actions"><ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi">New</a></li>
  <li><span class="separator">| </span><a href="describecomponents.cgi">Browse</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_bottom" name="no_redirect" value="0">
    <script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_bottom");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_bottom" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_bottom"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li>
      <span class="separator">| </span>
        <a href="request.cgi">Requests</a></li>


  <li>
        <span class="separator">| </span>
        <a href="https://bugzilla.readthedocs.org/en/5.0/using/understanding.html" target="_blank">Help</a>
      </li>
    
      <li id="new_account_container_bottom">
        <span class="separator">| </span>
        <a href="createaccount.cgi">New&nbsp;Account</a>
      </li>

    <li id="mini_login_container_bottom">
  <span class="separator">| </span>
  <a id="login_link_bottom" href="show_bug.cgi?id=219985&amp;GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('_bottom')">Log In</a>

  <form action="show_bug.cgi?id=219985" method="POST"
        class="mini_login bz_default_hidden"
        id="mini_login_bottom">
    <input id="Bugzilla_login_bottom" required
           name="Bugzilla_login" class="bz_login"
        type="email" placeholder="Email Address">
    <input class="bz_password" name="Bugzilla_password" type="password"
           id="Bugzilla_password_bottom" required
           placeholder="Password">
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
            id="log_in_bottom">
    <a href="#" onclick="return hide_mini_login_form('_bottom')">[x]</a>
  </form>
</li>


  <li id="forgot_container_bottom">
    <span class="separator">| </span>
    <a id="forgot_link_bottom" href="show_bug.cgi?id=219985&amp;GoAheadAndLogIn=1#forgot"
       onclick="return show_forgot_form('_bottom')">Forgot Password</a>
    <form action="token.cgi" method="post" id="forgot_form_bottom"
          class="mini_forgot bz_default_hidden">
      <label for="login_bottom">Login:</label>
      <input name="loginname" size="20" id="login_bottom" required
          type="email" placeholder="Your Email Address">
      <input id="forgot_button_bottom" value="Reset Password" type="submit">
      <input type="hidden" name="a" value="reqpw">
      <input type="hidden" id="token_bottom" name="token"
             value="1635619431-BWio6QK0YzQ1if1Yddu89pConOsD2O5rLXjv5WX40xw">
      <a href="#" onclick="return hide_forgot_form('_bottom')">[x]</a>
    </form>
  </li>
</ul>
  </li>

  




  
</ul>

      <div class="outro"></div>
    </div>

  </body>
</html>