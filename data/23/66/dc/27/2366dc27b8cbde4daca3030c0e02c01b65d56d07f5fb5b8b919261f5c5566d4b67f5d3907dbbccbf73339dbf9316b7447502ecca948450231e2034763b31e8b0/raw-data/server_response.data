-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

IBM SECURITY ADVISORY

First Issued: Fri Mar  5 10:04:00 CST 2010

The most recent version of this document is available here:

http://aix.software.ibm.com/aix/efixes/security/qoslist_advisory.asc

                           VULNERABILITY SUMMARY

VULNERABILITY:   AIX qoslist buffer overflow vulnerability

PLATFORMS:       AIX 6.1
                 VIOS 2.1

SOLUTION:        Apply the fix or workaround as described below.

THREAT:          A local authenticated attacker may be able to
                 gain the privileges of the qoslist command

CERT VU Number:  n/a
CVE Number:      n/a

Reboot required?    NO
Workarounds?        YES
Protected by FPM?   NO
Protected by SED?   YES

                           DETAILED INFORMATION

I. DESCRIPTION

    There is a buffer overflow vulnerability in the qoslist command.
    A locally authenticated attacker can exploit this vulnerability if
    they have they have been assigned the aix.network.status or
    aix.network.config.no role-based access control authorizations.

    The successful exploitation of this vulnerability allows a local
    attacker to execute arbitrary code with the innate privileges of
    the qoslist command.

    The following executable is vulnerable:

        /usr/sbin/qoslist 

II. PLATFORM VULNERABILITY ASSESSMENT

    Note: To use the following commands on VIOS you must first
    execute:

    oem_setup_env

    To determine if your system is vulnerable, execute the following
    command:

    lslpp -L bos.net.tcp.server

    The following fileset levels are vulnerable:

    AIX Fileset        Lower Level     Upper Level
    ------------------------------------------------
    bos.net.tcp.server 06.01.0001.0000 06.01.0001.0007
    bos.net.tcp.server 06.01.0002.0000 06.01.0002.0004
    bos.net.tcp.server 06.01.0003.0000 06.01.0003.0002
    bos.net.tcp.server 06.01.0004.0000 06.01.0004.0001

III. SOLUTION

    A. FIXES

        Fixes are now available.  The fixes can be downloaded from:

        http://aix.software.ibm.com/aix/efixes/security/qoslist_fix.tar

        The links above are to a tar file containing this signed
        advisory, fix packages, and PGP signatures for each package.

        AIX Level    VIOS Level       Fix
        ------------------------------------------------------
        6.1.1                         IZ71869_01.100305.epkg.Z
        6.1.2        2.1.0            IZ71590_02.100305.epkg.Z
        6.1.3        2.1.1            IZ71554_03.100305.epkg.Z
        6.1.4        2.1.2            IZ68194_04.100305.epkg.Z

        To extract the fixes from the tar file:

        tar xvf qoslist_fix.tar
        cd qoslist_fix

        Verify you have retrieved the fixes intact:

        The checksums below were generated using the "csum -h SHA1"
        (sha1sum) commands and are as follows:

        csum -h SHA1 (sha1sum)                    filename
        ------------------------------------------------------------------
        1e938b53ee9b1871f85e15dd07485ab9ddd06887  IZ68194_04.100305.epkg.Z
        b2d48f4b5c39deb2e92b6f777764b2063af5d3f0  IZ71554_03.100305.epkg.Z
        752203825fa1b696670d4bec6f8e83e5d6b2372a  IZ71590_02.100305.epkg.Z
        ff3ab43a1144d82840df9a948d920f26e393da62  IZ71869_01.100305.epkg.Z

        To verify the sums, use the text of this advisory as input to
        csum or sha1sum. For example:

        csum -h SHA1 -i qoslist_advisory.asc
        sha1sum -c qoslist_advisory.asc

        These sums should match exactly. The PGP signatures in the tar
        file and on this advisory can also be used to verify the
        integrity of the fixes.  If the sums or signatures cannot be
        confirmed, contact IBM AIX Security and describe the
        discrepancy at the following addresses:

            security-alert@austin.ibm.com
            ahazlewo@us.ibm.com (Andy Hazlewood)

     B. FIX INSTALLATION

        IMPORTANT: If possible, it is recommended that a mksysb backup
        of the system be created.  Verify it is both bootable and
        readable before proceeding.

        Fix management documentation can be found at:

        http://www14.software.ibm.com/webapp/set2/sas/f/aix.efixmgmt/home.html

        To preview fix installation:

        emgr -e fix_name -p         # where fix_name is the name of the  
                                    # fix being previewed.

        To install fix package:

        emgr -e fix_name -X         # where fix_name is the name of the  
                                    # fix being installed.

    C. APARS

        IBM has assigned the following APARs to this problem:

        AIX Level           APAR number        Service pack date
        --------------------------------------------------------
        6.1.1               IZ71869            4/21/10 sp8
        6.1.2               IZ71590            4/21/10 sp7
        6.1.3               IZ71554            4/21/10 sp4
        6.1.4               IZ68194            2/5/10  sp3

        Subscribe to the APARs here:

        http://www.ibm.com/support/docview.wss?uid=isg1IZ71869
        http://www.ibm.com/support/docview.wss?uid=isg1IZ71590
        http://www.ibm.com/support/docview.wss?uid=isg1IZ71554
        http://www.ibm.com/support/docview.wss?uid=isg1IZ68194

        By subscribing, you will receive periodic email alerting you
        to the status of the APAR, and a link to download the service
        pack when it becomes available.

IV. WORKAROUND

    Remove the entry for qoslist from /etc/security/privcmds and update
    the kernel security tables by running 'setkst'.

VI. CONTACT INFORMATION

    If you would like to receive AIX Security Advisories via email,
    please visit:
 
        http://www.ibm.com/systems/support
 
    and click on the "My notifications" link.
 
    To view previously issued advisories, please visit:
 
        http://www14.software.ibm.com/webapp/set2/subscriptions/pqvcmjd
 
    Comments regarding the content of this announcement can be
    directed to:

        security-alert@austin.ibm.com
        ahazlewo@us.ibm.com (Andy Hazlewood)
 
    To obtain the PGP public key that can be used to communicate
    securely with the AIX Security Team you can either:

        A. Send an email with "get key" in the subject line to:

            security-alert@austin.ibm.com

        B. Download the key from our web page:

  http://www.ibm.com/systems/resources/systems_p_os_aix_security_pgpkey.txt

        C. Download the key from a PGP Public Key Server. The key ID is:

            0xF3807ECD
 
    Please contact your local IBM AIX support center for any
    assistance.
 
    eServer is a trademark of International Business Machines
    Corporation.  IBM, AIX and pSeries are registered trademarks of
    International Business Machines Corporation.  All other trademarks
    are property of their respective holders.

VII. ACKNOWLEDGMENTS

    This vulnerability was reported by IBM.
    This advisory was written by Andy Hazlewood (ahazlewo@us.ibm.com).

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.7 (AIX)

iD8DBQFLlRp2xvGNyvOAfs0RAojbAKCvN81bRPJFWDNu0g2+39RwDFr4zwCeKo1M
1xyg+NiATeQeQfs9MYZoY3M=
=qbxY
-----END PGP SIGNATURE-----
