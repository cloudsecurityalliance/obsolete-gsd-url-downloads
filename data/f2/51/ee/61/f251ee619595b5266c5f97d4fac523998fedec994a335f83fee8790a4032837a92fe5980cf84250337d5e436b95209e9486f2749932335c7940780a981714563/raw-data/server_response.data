<!DOCTYPE html>
<html lang="en-us">

  <head>
  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-164212227-2"></script>
  <script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-164212227-2');
  </script>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" /><![endif]-->
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Doyensec's Blog :: Doyensec is an independent security research and development company focused on vulnerability discovery and remediation." />
  <meta name="keywords" content="doyensec, doyensecurity, security, infosec, vulnerability, exploit, offensive, pentest, pentester, hacking, auditing, reverse engineering, automation" />
  <meta name="robots" content="index, follow" />
  <meta name="robots" content="noodp" />
  <meta name="robots" content="noydir" />

  <title>
    
      Modern Alchemy: Turning XSS into RCE &middot; Doyensec's Blog
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/images/apple-touch-icon-144-precomposed.png">
                                 <link rel="shortcut icon" href="/public/images/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body class="theme-base-doyensec">

    <div class="sidebar">
  <div class="navbar-brand"><a href="/index.html"><img src="/public/images/logo.png" class="navbar-brand__image"></a></div>
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <p class="lead">We are <a href="https://doyensec.com" target="_blank">security engineers</a> who break bits and tell stories.<br><br>Visit us<br><a href="https://doyensec.com" target="_blank">doyensec.com</a><br><br>Follow us<br><a href="https://twitter.com/doyensec" target="_blank">@doyensec</a><br><br>Engage us<br><a href="mailto:info@doyensec.com" target="_blank">info@doyensec.com</a><br><br></p>
    </div>

    <nav class="sidebar-nav">
      

      
      
        
          
        
      
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
    </nav>
    <h4 id="archive-header">Blog Archive</h4>
    <ul class="posts-archive">
            
            
            
              <li>
                <a class="yearBtn" data-year="2017" href="#">2017</a>
                <div class="postsMonths" id="posts-in-2017" style="display:none">
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                      <span class="post-entry" data-date="1511737200" data-url="/2017/11/27/we-are-hiring.html" data-title="We're hiring - Join Doyensec!"></span>
                    
                  
                    
                    
                    
                      <span class="post-entry" data-date="1510700400" data-url="/2017/11/15/osx-spotlight.html" data-title="Staring into the Spotlight"></span>
                    
                  
                    
                    
                    
                      <span class="post-entry" data-date="1501711200" data-url="/2017/08/03/electron-framework-security.html" data-title="Modern Alchemy: Turning XSS into RCE"></span>
                    
                  
                    
                    
                    
                      <span class="post-entry" data-date="1488409200" data-url="/2017/03/02/training-burp.html" data-title="Developing Burp Suite Extensions training"></span>
                    
                  
                </div>
              </li>
            
              <li>
                <a class="yearBtn" data-year="2018" href="#">2018</a>
                <div class="postsMonths" id="posts-in-2018" style="display:none">
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                      <span class="post-entry" data-date="1541372400" data-url="/2018/11/05/burp-rest-api-v2.html" data-title="Introducing burp-rest-api v2"></span>
                    
                  
                    
                    
                    
                      <span class="post-entry" data-date="1531951200" data-url="/2018/07/19/instrumenting-electron-app.html" data-title="Instrumenting Electron Apps for Security Testing"></span>
                    
                  
                    
                    
                    
                      <span class="post-entry" data-date="1527112800" data-url="/2018/05/24/electron-win-protocol-handler-bug-bypass.html" data-title="Electron Windows Protocol Handler MITM/RCE (bypass for CVE-2018-1000006 fix)"></span>
                    
                  
                    
                    
                    
                      <span class="post-entry" data-date="1526508000" data-url="/2018/05/17/graphql-security-overview.html" data-title="GraphQL - Security Overview and Testing Tips"></span>
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                </div>
              </li>
            
              <li>
                <a class="yearBtn" data-year="2019" href="#">2019</a>
                <div class="postsMonths" id="posts-in-2019" style="display:none">
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                      <span class="post-entry" data-date="1572908400" data-url="/2019/11/05/internship-at-doyensec.html" data-title="Internship at Doyensec"></span>
                    
                  
                    
                    
                    
                      <span class="post-entry" data-date="1566424800" data-url="/2019/08/22/modern-password-managers-flag-secure.html" data-title="One Bug To Rule Them All: Modern Android Password Managers and FLAG_SECURE Misuse"></span>
                    
                  
                    
                    
                    
                      <span class="post-entry" data-date="1564610400" data-url="/2019/08/01/common-crypto-bugs.html" data-title="Lessons in auditing cryptocurrency wallets, systems, and infrastructures"></span>
                    
                  
                    
                    
                    
                      <span class="post-entry" data-date="1563746400" data-url="/2019/07/22/jackson-gadgets.html" data-title="Jackson gadgets - Anatomy of a vulnerability"></span>
                    
                  
                    
                    
                    
                      <span class="post-entry" data-date="1562104800" data-url="/2019/07/03/electron-security-workshop.html" data-title="Electron Security Workshop"></span>
                    
                  
                    
                    
                    
                      <span class="post-entry" data-date="1560204000" data-url="/2019/06/11/electronegativity-1.3.html" data-title="Electronegativity 1.3.0 released!"></span>
                    
                  
                    
                    
                    
                      <span class="post-entry" data-date="1556056800" data-url="/2019/04/24/rubyzip-bug.html" data-title="On insecure zip handling, Rubyzip and Metasploit RCE (CVE-2019-5624)"></span>
                    
                  
                    
                    
                    
                      <span class="post-entry" data-date="1554242400" data-url="/2019/04/03/subverting-electron-apps-via-insecure-preload.html" data-title="Subverting Electron Apps via Insecure Preload"></span>
                    
                  
                    
                    
                    
                      <span class="post-entry" data-date="1548284400" data-url="/2019/01/24/electronegativity.html" data-title="Electronegativity is finally out!"></span>
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                </div>
              </li>
            
              <li>
                <a class="yearBtn" data-year="2020" href="#">2020</a>
                <div class="postsMonths" id="posts-in-2020" style="display:none">
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                      <span class="post-entry" data-date="1608159600" data-url="/2020/12/17/psychology-of-remote-work.html" data-title="Psychology of Remote Work"></span>
                    
                  
                    
                    
                    
                      <span class="post-entry" data-date="1607554800" data-url="/2020/12/10/novel-abuses-wifi-direct-mobile-file-transfers.html" data-title="Novel Abuses On Wi-Fi Direct Mobile File Transfers"></span>
                    
                  
                    
                    
                    
                      <span class="post-entry" data-date="1605740400" data-url="/2020/11/19/inql-scanner-v3.html" data-title="InQL Scanner v3 - Just Released!"></span>
                    
                  
                    
                    
                    
                      <span class="post-entry" data-date="1599602400" data-url="/2020/09/09/fuzzilli-jerryscript.html" data-title="Fuzzing JavaScript Engines with Fuzzilli"></span>
                    
                  
                    
                    
                    
                      <span class="post-entry" data-date="1597874400" data-url="/2020/08/20/playframework-csrf-bypass.html" data-title="CSRF Protection Bypass in Play Framework"></span>
                    
                  
                    
                    
                    
                      <span class="post-entry" data-date="1591826400" data-url="/2020/06/11/inql-scanner-v2.html" data-title="InQL Scanner v2 is out!"></span>
                    
                  
                    
                    
                    
                      <span class="post-entry" data-date="1589407200" data-url="/2020/05/14/asn1fuzz.html" data-title="Fuzzing TLS certificates from their ASN.1 grammar"></span>
                    
                  
                    
                    
                    
                      <span class="post-entry" data-date="1588197600" data-url="/2020/04/30/polymorphic-images-for-xss.html" data-title="Researching Polymorphic Images for XSS on Google Scholar"></span>
                    
                  
                    
                    
                    
                      <span class="post-entry" data-date="1586296800" data-url="/2020/04/08/libressl-fuzzer.html" data-title="LibreSSL and OSS-Fuzz"></span>
                    
                  
                    
                    
                    
                      <span class="post-entry" data-date="1585177200" data-url="/2020/03/26/graphql-scanner.html" data-title="InQL Scanner"></span>
                    
                  
                    
                    
                    
                      <span class="post-entry" data-date="1584313200" data-url="/2020/03/16/vscode_codeexec.html" data-title="Don't Clone That Repo: Visual Studio Code^2 Execution"></span>
                    
                  
                    
                    
                    
                      <span class="post-entry" data-date="1583103600" data-url="/2020/03/02/gravitational-audit.html" data-title="2019 Gravitational Security Audit Results"></span>
                    
                  
                    
                    
                    
                      <span class="post-entry" data-date="1582498800" data-url="/2020/02/24/electron-updater-update-signature-bypass.html" data-title="Signature Validation Bypass Leading to RCE In Electron-Updater"></span>
                    
                  
                    
                    
                    
                      <span class="post-entry" data-date="1582066800" data-url="/2020/02/19/solokeys-audit.html" data-title="Security Analysis of the Solo Firmware"></span>
                    
                  
                    
                    
                    
                      <span class="post-entry" data-date="1580684400" data-url="/2020/02/03/heap-exploit.html" data-title="Heap Overflow in F-Secure Internet Gatekeeper"></span>
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                </div>
              </li>
            
              <li>
                <a class="yearBtn" data-year="2021" href="#">2021</a>
                <div class="postsMonths" id="posts-in-2021" style="display:none">
                  
                    
                    
                    
                      <span class="post-entry" data-date="1621461600" data-url="/2021/05/20/graphql-csrf.html" data-title="That single GraphQL issue that you keep missing"></span>
                    
                  
                    
                    
                    
                      <span class="post-entry" data-date="1615417200" data-url="/2021/03/11/regexploit.html" data-title="Regexploit: DoS-able Regular Expressions"></span>
                    
                  
                    
                    
                    
                      <span class="post-entry" data-date="1613430000" data-url="/2021/02/16/electron-apis-misuse.html" data-title="Electron APIs Misuse: An Attacker’s First Choice"></span>
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                    
                    
                    
                  
                </div>
              </li>
            
    </ul>
    <p>&copy; 2021 <a href="https://doyensec.com" target="_blank">Doyensec LLC.</a></p>
  </div>
</div>


    <div class="content container">
      <div class="post">
  <h1 class="post-title">Modern Alchemy: Turning XSS into RCE</h1>
  <span class="post-date">03 Aug 2017 - Posted by Luca Carettoni</span>
  <h3 id="tldr">TL;DR</h3>

<p>At the recent <a href="https://www.blackhat.com/us-17/briefings.html#electronegativity-a-study-of-electron-security">Black Hat Briefings 2017</a>, Doyensec’s co-founder <a href="https://twitter.com/lucacarettoni">Luca Carettoni</a> presented a new research on <a href="https://electron.atom.io">Electron</a> security. 
	After a quick overview of Electron’s security model, we disclosed design weaknesses and implementation bugs that can be leveraged to compromise <em>any</em> Electron-based application. In particular, we discussed a bypass that would allow reliable Remote Code Execution (RCE) when rendering untrusted content (for example via Cross-Site Scripting) even with framework-level protections in place.</p>

<p>In this blog post, we would like to provide insight into the bug (CVE-2017-12581) and remediations.</p>

<h3 id="whats-electron">What’s Electron?</h3>

<p>While you may not recognize the name, it is likely that you’re already using Electron since it’s running on millions of computers. <a href="https://electron.atom.io/apps/">Slack, Atom, Visual Studio Code, WordPress Desktop, Github Desktop, Basecamp3, Mattermost</a> are just few examples of applications built using this framework. Any time that a traditional web application is ported to desktop, it is likely that the developers used Electron.</p>

<p><img src="../../../public/images/electron1.png" width="550" alt="Electron Motto" align="center" /></p>

<h3 id="understanding-the-nodeintegration-flag">Understanding the <em>nodeIntegration</em> flag</h3>

<p>While Electron is based on Chromium’s Content module, it is not a browser. Since it facilitates the construction of complex desktop applications, Electron gives the developer a lot of power. In fact, thanks to the integration with Node.js, JavaScript can access operating system primitives to take full advantage of native desktop mechanisms.</p>

<p><a href="https://electron.atom.io/docs/tutorial/security/">It is well understood</a> that rendering untrusted remote/local content with Node integration enabled is dangerous. For this reason, Electron provides two mechanisms to “sandbox” untrusted resources:</p>

<p><em>BrowserWindow</em></p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">mainWindow</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">BrowserWindow</span><span class="p">({</span>  
	<span class="dl">"</span><span class="s2">webPreferences</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span> 
		<span class="dl">"</span><span class="s2">nodeIntegration</span><span class="dl">"</span> <span class="p">:</span> <span class="kc">false</span><span class="p">,</span>  
		<span class="dl">"</span><span class="s2">nodeIntegrationInWorker</span><span class="dl">"</span> <span class="p">:</span> <span class="kc">false</span> 
	<span class="p">}</span>
<span class="p">});</span>

<span class="nx">mainWindow</span><span class="p">.</span><span class="nx">loadURL</span><span class="p">(</span><span class="dl">'</span><span class="s1">https://www.doyensec.com/</span><span class="dl">'</span><span class="p">);</span>
</code></pre></div></div>

<p><em>WebView</em></p>
<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;webview</span> <span class="na">src=</span><span class="s">"https://www.doyensec.com/"</span><span class="nt">&gt;&lt;/webview&gt;</span>
</code></pre></div></div>

<p>In above examples, the <strong>nodeIntegration</strong> flag is set to false. JavaScript running in the page won’t have access to global references despite having a Node.js engine running in the renderer process.</p>

<h3 id="hunting-for-nodeintegration-bypasses">Hunting for <em>nodeIntegration</em> bypasses</h3>

<p>It should now be clear why <em>nodeIntegration</em> is a critical security-relevant setting for the framework. A vulnerability in this mechanism could lead to full host compromise from simply rendering untrusted web pages. As modern alchemists, we use this type of flaws to turn traditional XSS into RCE. Since all Electron applications are bundled with the framework code, it is also complicated to fix these issues across the entire ecosystem.</p>

<p>During our research, we have extensively analyzed all project code changes to uncover previously discovered bypasses (we counted 6 before v1.6.1) with the goal of studying Electron’s design and weaknesses. Armed with that knowledge, we went for a hunt.</p>

<p>By studying the <a href="https://electron.atom.io/docs/all/">official documentation</a>, we quickly identified a significant deviation from standard browsers caused by Electron’s “glorified” JavaScript APIs.</p>

<p>When a new window is created, Electron returns an instance of <a href="https://electron.atom.io/docs/all/#class-browserwindowproxy">BrowserWindowProxy</a>. This class can be used to manipulate the child browser window, thus subverting the Same-Origin Policy (SOP).</p>

<p><em>SOP Bypass #1</em></p>
<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script&gt;</span>
<span class="kd">const</span> <span class="nx">win</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">https://www.doyensec.com</span><span class="dl">"</span><span class="p">);</span> 
<span class="nx">win</span><span class="p">.</span><span class="nx">location</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">javascript:alert(document.domain)</span><span class="dl">"</span><span class="p">;</span> 
<span class="nt">&lt;/script&gt;</span> 
</code></pre></div></div>

<p><em>SOP Bypass #2</em></p>
<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script&gt;</span>
<span class="kd">const</span> <span class="nx">win</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">https://www.doyensec.com</span><span class="dl">"</span><span class="p">);</span> 
<span class="nx">win</span><span class="p">.</span><span class="nb">eval</span><span class="p">(</span><span class="dl">"</span><span class="s2">alert(document.domain)</span><span class="dl">"</span><span class="p">);</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre></div></div>
<p>The <em>eval</em> mechanism used by the SOP Bypass #2 can be explained with the following diagram:</p>

<p><img src="../../../public/images/electron2.png" width="550" alt="BrowserWindowProxy's Eval" align="center" /></p>

<p>Additional source code review revealed the presence of privileged URLs (similar to browsers’ privileged zones). Combining the SOP-bypass by design with a specific privileged url defined in <em>lib/renderer/init.js</em>, we realized that we could override the nodeIntegration setting.</p>

<p><img src="../../../public/images/electron3.png" alt="Chrome DevTools in Electron, prior to 1.6.8" title="Chrome DevTools in Electron, prior to 1.6.8" /></p>

<p>A simple, yet reliable, proof-of-concept of the nodeIntegration bypass affecting all Electron releases prior to 1.6.7 is hereby included:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;nodeIntegration bypass (SOP2RCE)&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
  	&lt;script&gt;
    	document.write("Current location:" + window.location.href + "&lt;br&gt;");

    	const win = window.open("chrome-devtools://devtools/bundled/inspector.html");
    	win.eval("const {shell} = require('electron'); 
    	shell.openExternal('file:///Applications/Calculator.app');");
       &lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre></div></div>

<p>On May 10, 2017 we reported this issue to the maintainers via email. In a matter of hours, we received a reply that they were already working on a fix since the privileged <em>chrome-devtools://</em> was discovered during an internal security activity just few days before our report. In fact, while the latest release on the official website at that time was 1.6.7, the <a href="https://github.com/electron/electron/commit/05b6d91bf4c1e0ee65eeef70cd5d1bd1df125644">git commit</a> that fixes the privileged url is dated April 24, 2017.</p>

<p>The issue was fixed in 1.6.8 (officially released around the 15th of May). All previous versions of Electron and consequently all Electron-based apps were affected. Mitre assigned CVE-2017-12581 for this issue.</p>

<h3 id="mitigating-nodeintegration-bypass-vulnerabilities">Mitigating nodeIntegration bypass vulnerabilities</h3>

<ul>
  <li>
    <p><strong>Keep your application in sync with the latest Electron framework release.</strong> When releasing your product, you’re also shipping a bundle composed of Electron, Chromium shared library and Node. Vulnerabilities affecting these components may impact the security of your application. By updating Electron to the latest version, you ensure that critical vulnerabilities (such as nodeIntegration bypasses) are already patched and cannot be exploited to abuse your application.</p>
  </li>
  <li>
    <p><strong>Adopt secure coding practices.</strong> The first line of defense for your application is your own code. Common web vulnerabilities, such as Cross-Site Scripting (XSS), have a higher security impact on Electron hence it is highly recommend to adopt secure software development best practices and perform periodic security testing.</p>
  </li>
  <li>
    <p><strong>Know your framework (and its limitations).</strong> Certain principles and security mechanisms implemented by modern browsers are not enforced in Electron (e.g. SOP enforcement). Adopt defense in depth mechanisms to mitigate those deficiencies. For more details, please refer to our <a href="https://doyensec.com/resources/us-17-Carettoni-Electronegativity-A-Study-Of-Electron-Security.pdf">Electronegativity, A study of Electron Security</a> presentation and <a href="https://doyensec.com/resources/us-17-Carettoni-Electronegativity-A-Study-Of-Electron-Security-wp.pdf">Electron Security Checklist</a> white-paper.</p>
  </li>
  <li>
    <p><strong>Use the recent “sandbox” experimental feature.</strong> Even with nodeIntegration disabled, the current implementation of Electron does not completely mitigate all risks introduced by loading untrusted resources. As such, it is recommended to enable <a href="https://electron.atom.io/docs/api/sandbox-option/">sandboxing</a> which leverages the native Chromium sandbox. A sandboxed renderer does not have a Node.js environment running (with the exception of preload scripts) and the renderers can only make changes to the system by delegating tasks to the main process via IPC. While still not perfect at the time of writing (there are known security issues, sandbox is not supported for the <code class="language-plaintext highlighter-rouge">&lt;webview&gt;</code> tag, etc.) this option should be enabled to provide additional isolation.</p>
  </li>
</ul>

</div>
<div class="related">
  <h3>Other relevant posts:</h3> 
  <ul class="related-posts">
    
    
    
                           
    
    
    
                           
    
    
    
    
      
      <li>
        <h3>
          <a href="/2021/02/16/electron-apis-misuse.html">
            Electron APIs Misuse: An Attacker’s First Choice
            <small>16 Feb 2021</small>
          </a>
        </h3>
      </li>
       
                           
    
    
    
                           
    
    
    
                           
    
    
    
                           
    
    
    
                           
    
    
    
                           
    
    
    
                           
    
    
    
                           
    
    
    
                           
    
    
    
                           
    
    
    
                           
    
    
    
                           
    
    
    
                           
    
    
    
    
      
      <li>
        <h3>
          <a href="/2020/02/24/electron-updater-update-signature-bypass.html">
            Signature Validation Bypass Leading to RCE In Electron-Updater
            <small>24 Feb 2020</small>
          </a>
        </h3>
      </li>
       
                           
    
    
    
                           
    
    
    
                           
    
    
    
                           
    
    
    
                           
    
    
    
                           
    
    
    
                           
    
    
    
    
      
      <li>
        <h3>
          <a href="/2019/07/03/electron-security-workshop.html">
            Electron Security Workshop
            <small>03 Jul 2019</small>
          </a>
        </h3>
      </li>
       
                           
    
    
    
    
      
      <li>
        <h3>
          <a href="/2019/06/11/electronegativity-1.3.html">
            Electronegativity 1.3.0 released!
            <small>11 Jun 2019</small>
          </a>
        </h3>
      </li>
       
                           
    
    
    
                           
    
    
    
    
      
      <li>
        <h3>
          <a href="/2019/04/03/subverting-electron-apps-via-insecure-preload.html">
            Subverting Electron Apps via Insecure Preload
            <small>03 Apr 2019</small>
          </a>
        </h3>
      </li>
       
                           
    
    
    
    
      
      <li>
        <h3>
          <a href="/2019/01/24/electronegativity.html">
            Electronegativity is finally out!
            <small>24 Jan 2019</small>
          </a>
        </h3>
      </li>
       
                           
    
    
    
                           
    
    
    
    
      
      <li>
        <h3>
          <a href="/2018/07/19/instrumenting-electron-app.html">
            Instrumenting Electron Apps for Security Testing
            <small>19 Jul 2018</small>
          </a>
        </h3>
      </li>
       
                           
    
    
    
    
      
      <li>
        <h3>
          <a href="/2018/05/24/electron-win-protocol-handler-bug-bypass.html">
            Electron Windows Protocol Handler MITM/RCE (bypass for CVE-2018-1000006 fix)
            <small>24 May 2018</small>
          </a>
        </h3>
      </li>
       
                           
    
    
    
                           
    
    
    
                           
    
    
    
                           
    
    
    
    
       
                           
    
    
    
                           
    
  </ul>
</div>

    </div>

  <script src="/public/js/jquery.min.js"></script>
  <script src="/public/js/main.js"></script>
  </body>
</html>
