<!DOCTYPE html>
















































<html class="hasSidebar hasPageActions hasBreadcrumb conceptual has-default-focus theme-light" lang="en-us" dir="ltr" data-css-variable-support="true" data-authenticated="false" data-auth-status-determined="false" data-target="docs" x-ms-format-detection="none">

<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<meta property="og:title" content="Microsoft Security Bulletin MS02-051 - Moderate" />
	<meta property="og:type" content="website" />
	<meta property="og:url" content="https://docs.microsoft.com/en-us/security-updates/securitybulletins/2002/ms02-051" />

	<meta name="twitter:card" content="summary" />

	<meta name="twitter:site" content="@docsmsft" />

	<meta name="color-scheme" content="light dark">


	<meta name="author" content="BetaFred" />
<meta name="breadcrumb_path" content="/security-updates/breadcrumb/toc.json" />
<meta name="depot_name" content="Security.security-updates" />
<meta name="document_id" content="0658114a-5020-f6a1-1710-e6b71f1c60f8" />
<meta name="document_version_independent_id" content="5d58b966-ff25-139b-cffc-8a079fd9a03d" />
<meta name="gitcommit" content="https://github.com/MicrosoftDocs/security-updates/blob/df90e84771fe2a477f4e352e78bc7c2899ef1116/security-updates/SecurityBulletins/2002/ms02-051.md" />
<meta name="locale" content="en-us" />
<meta name="ms.author" content="BetaFred" />
<meta name="ms.date" content="10/11/2017" />
<meta name="ms.service" content="security-updates" />
<meta name="ms.topic" content="article" />
<meta name="ms:assetid" content="ms02-051" />
<meta name="ms:contentKeyID" content="61221945" />
<meta name="ms:mtpsurl" content="https://technet.microsoft.com/en-us/library/ms02-051(v=Security.10)" />
<meta name="original_content_git_url" content="https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletins/2002/ms02-051.md" />
<meta name="schema" content="Conceptual" />
<meta name="site_name" content="Docs" />
<meta name="Title" content="Microsoft Security Bulletin MS02-051 - Moderate" />
<meta name="TOCTitle" content="MS02-051" />
<meta name="updated_at" content="2019-12-03 01:16 AM" />
<meta name="page_type" content="conceptual" />
<meta name="toc_rel" content="../../toc.json" />
<meta name="word_count" content="2501" />


<link href="https://docs.microsoft.com/en-us/security-updates/securitybulletins/2002/ms02-051" rel="canonical">
	<title>Microsoft Security Bulletin MS02-051 - Moderate | Microsoft Docs</title>

		<link rel="stylesheet" href="/_themes/docs.theme/master/en-us/_themes/styles/46dad2a9.site-ltr.css ">

	

	<script id="msdocs-script">
	var msDocs = {
		data: {
			timeOrigin: Date.now(),
			contentLocale: 'en-us',
			contentDir: 'ltr',
			userLocale: 'en-us',
			userDir: 'ltr',
			pageTemplate: 'Conceptual',
			brand: '',
			context: {

			},
			hasBinaryRating: true,
			hasGithubIssues: false,
			showFeedbackReport: false,
			enableTutorialFeedback: false,
			feedbackSystem: 'None',
			feedbackGitHubRepo: '',
			feedbackProductUrl: '',
			contentGitUrl: 'https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletins/2002/ms02-051.md',
			extendBreadcrumb: true,
			isEditDisplayable: false,
			hideViewSource: false,
			hasPageActions: true,
			hasBookmark: true,
			hasShare: true,
			hasRecommendations: true,
			contributors: [
						{ name: "BetaFred", url: "https://github.com/BetaFred" },
						{ name: "mdressman", url: "https://github.com/mdressman" },
						{ name: "Santoshtambe", url: "https://github.com/Santoshtambe" }
],
		},
		functions:{}
	};
	</script>
	<script src="https://wcpstatic.microsoft.com/mscc/lib/v2/wcp-consent.js"></script>
	<script src="https://js.monitor.azure.com/scripts/c/ms.jsll-3.min.js"></script>

	<script src="/_themes/docs.theme/master/en-us/_themes/global/5cce29c0.deprecation.js"></script>
		<script src="/_themes/docs.theme/master/en-us/_themes/scripts/bb2ae21c.index-docs.js"></script>
</head>

<body lang="en-us" dir="ltr">
	<div class="header-holder has-default-focus">
		<a href="#main" class="skip-to-main-link has-outline-color-text visually-hidden-until-focused position-fixed has-inner-focus focus-visible top-0 left-0 right-0 padding-xs has-text-centered has-body-background" tabindex="1">Skip to main content</a>

		<div hidden id="cookie-consent-holder"></div>

		<div id="unsupported-browser" style="
			background-color: white;
			color: black;
			padding: 16px;
			border-bottom: 1px solid grey;"
			hidden
		>
			<div style="max-width: 800px; margin: 0 auto;">
				<p style="font-size: 24px">This browser is no longer supported.</p>
				<p style="font-size: 16px; margin-top: 16px;">Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.</p>
				<div style="margin-top: 12px;">
					<a href="https://go.microsoft.com/fwlink/p/?LinkID=2092881 "
						style="
						background-color: #0078d4;
						border: 1px solid #0078d4;
						color: white;
						padding: 6px 12px;
						border-radius: 2px;
						display: inline-block;
						">
Download Microsoft Edge					</a>
					<a href="https://docs.microsoft.com/en-US/lifecycle/faq/internet-explorer-microsoft-edge"
						style="
							background-color: white;
							padding: 6px 12px;
							border: 1px solid #505050;
							color: #171717;
							border-radius: 2px;
							display: inline-block;
							">
More info					</a>
				</div>
			</div>

		</div>
		<!-- liquid-tag banners global -->
		<div id="headerAreaHolder" data-bi-name="header">
<header role="banner" itemscope="itemscope" itemtype="http://schema.org/Organization">
	<div class="nav-bar">
		<div class="nav-bar-brand">
			<a itemprop="url" href="https://www.microsoft.com" aria-label="Microsoft" class="nav-bar-button">
				<div class="nav-bar-logo has-background-image theme-display is-light" role="presentation" aria-hidden="true" itemprop="logo" itemscope="itemscope"></div>
				<div class="nav-bar-logo has-background-image theme-display is-dark is-high-contrast" role="presentation" aria-hidden="true" itemprop="logo" itemscope="itemscope"></div>
			</a>
		</div>
	</div>
	<div class="is-hidden"></div>
</header>		</div>

						<div class="content-header uhf-container has-padding has-default-focus border-bottom-none" data-bi-name="content-header">
					<nav class="breadcrumb-holder has-padding-none has-padding-left-medium-tablet has-padding-right-medium-tablet has-padding-left-none-uhf-tablet has-padding-left-none-uhf-tablet has-padding-none-desktop flex-grow-1" data-bi-name="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList" role="navigation" aria-label="Breadcrumb">
						<ul id="page-breadcrumbs" class="breadcrumbs">
						</ul>
					</nav>
				<div class="content-header-controls">
					<button type="button" class="contents-button button" data-bi-name="contents-expand" aria-haspopup="true">
						<span class="icon"><span class="docon docon-menu" aria-hidden="true"></span></span>
						<span class="contents-expand-title">Contents</span>
					</button>
					<button type="button" class="ap-collapse-behavior ap-expanded button" data-bi-name="ap-collapse" aria-controls="action-panel">
						<span class="icon"><span class="docon docon-exit-mode" aria-hidden="true"></span></span>
						<span>Exit focus mode</span>
					</button>
				</div>
				<div class="has-padding-none-tablet padding-xs font-size-sm display-flex justify-content-space-between flex-grow-1 page-action-holder">
					<ul class="is-hidden-mobile action-list justify-content-flex-start has-flex-justify-content-end-tablet display-flex flex-wrap-wrap flex-grow-1 is-unstyled">
						<li hidden>
							<a id="lang-link" class="button button button-clear button-sm" title="Read in English" data-bi-name="language-toggle">
								<span id="lang-link-icon" class="icon docon docon-locale-globe" aria-hidden="true"></span>
								<span id="lang-link-text" class="is-visually-hidden-touch is-hidden-portrait"></span>
							</a>
						</li>
						<li>
							<button type="button" class="collection button button-clear button-sm has-inner-focus" data-list-type="collection" data-bi-name="collection" title="Add to collection">
								<span class="icon" aria-hidden="true">
									<span class="docon docon-circle-addition has-text-primary"></span>
								</span>
								<span class="collection-status is-visually-hidden-touch is-hidden-portrait">Save</span>
							</button>
						</li>
								<li id="contenteditbtn" hidden>
									<a href="https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletins/2002/ms02-051.md"  class=" button button-clear button-sm has-inner-focus" title="Edit This Document" data-bi-name="edit">
									<span class="icon" aria-hidden="true">
										<span class="docon docon-edit-outline"></span>
									</span>
									<span class="is-visually-hidden-touch is-hidden-portrait">Edit</span>
								</a>
							</li>
						<li>
<div class="sharing dropdown has-caret">
	<button class="dropdown-trigger button button-clear button-sm button-block justify-content-flex-start has-inner-focus" aria-controls="sharing-menu" aria-expanded="false" title="Share This Document" data-bi-name="share">
		<span class="icon" aria-hidden="true">
			<span class="docon docon-sharing"></span>
		</span>
		<span class="is-visually-hidden-touch is-hidden-portrait">Share</span>
	</button>
	<div class="dropdown-menu has-padding-small" id="sharing-menu">
		<ul data-bi-name="share-links">
			<li>
				<a class="button button-clear button-sm button-block justify-content-flex-start has-inner-focus share-twitter" data-bi-name="twitter">
					<span class="icon">
						<span class="docon docon-brand-twitter has-text-primary" aria-hidden="true"></span>
					</span>
					<span>Twitter</span>
				</a>
			</li>
			<li>
				<a class="button button-clear button-sm button-block justify-content-flex-start has-inner-focus share-linkedin" data-bi-name="linkedin">
					<span class="icon">
						<span class="docon docon-brand-linkedin has-text-primary" aria-hidden="true"></span>
					</span>
					<span>LinkedIn</span>
				</a>
			</li>
			<li>
				<a class="button button-clear button-sm button-block justify-content-flex-start has-inner-focus share-facebook" data-bi-name="facebook">
					<span class="icon">
						<span class="docon docon-brand-facebook has-text-primary" aria-hidden="true"></span>
					</span>
					<span>Facebook</span>
				</a>
			</li>
			<li>
				<a class="button button-clear button-sm button-block justify-content-flex-start has-inner-focus share-email" data-bi-name="email">
					<span class="icon">
						<span class="docon docon-mail-message-fill has-text-primary" aria-hidden="true"></span>
					</span>
					<span>Email</span>
				</a>
			</li>
		</ul>
	</div>
</div>						</li>
					</ul>
					<button type="button" class="border contents-button  button button-clear button-sm is-hidden-tablet has-inner-focus" aria-label="Contents" data-bi-name="contents-expand">
						<span class="icon">
							<span class="docon docon-editor-list-bullet" aria-hidden="true"></span>
						</span>
						<span class="contents-expand-title">Table of contents</span>
					</button>
					<div class="is-invisible"></div>
					<div class="is-hidden-tablet level-item is-flexible level-right">
						<button type="button" class="page-actions-button  button button-clear button-sm is-hidden-tablet has-inner-focus border is-full-height  has-margin-left-small" aria-label="Page Actions" data-bi-name="pageactions">
							<span class="icon">
								<span class="docon docon-more-vertical" aria-hidden="true"></span>
							</span>
						</button>
					</div>
				</div>
			</div>



		<div id="disclaimer-holder" class="has-overflow-hidden has-default-focus">
			<!-- liquid-tag banners sectional -->
		</div>
	</div>

	<div class="mainContainer  uhf-container has-top-padding  has-default-focus" data-bi-name="body">

		<div class="columns has-large-gaps is-gapless-mobile ">

			<div id="left-container" class="left-container is-hidden-mobile column is-one-third-tablet is-one-quarter-desktop">
				<nav id="affixed-left-container" class="position-fixed display-flex flex-direction-column" role="navigation" aria-label="Primary"></nav>
			</div>

			<!-- .primary-holder -->
			<section class="primary-holder column is-two-thirds-tablet is-three-quarters-desktop">
				<!--div.columns -->
				<div class="columns is-gapless-mobile has-large-gaps ">


					<div id="main-column" class="column  is-full is-8-desktop">

						<main id="main" role="main" class="content " data-bi-name="content" lang="en-us" dir="ltr">



							

								<ul class="metadata page-metadata" data-bi-name="page info" lang="en-us" dir="ltr">
									<li>
										<time class="is-invisible" data-article-date aria-label="Article review date" datetime="2019-12-03T01:16:00Z" data-article-date-source="git">12/03/2019</time>
									</li>
											<li class="readingTime">12 minutes to read</li>
										<li class="contributors-holder">
											<ul class="facepile has-margin-left-none is-small" data-bi-name="contributors">
																<li class="facepile-item">
																	<a href="https://github.com/BetaFred" title="BetaFred" aria-label="BetaFredGithub profile" data-src="https://github.com/BetaFred.png?size=32" data-contributor-name="BetaFred" class="facepile-item-coin"
																	>
																		<img class="facepile-item-coin-image durable-image" aria-hidden="true" src="https://github.com/BetaFred.png?size=32" role="presentation" onerror="this.className='facepile-item-coin-image durable-image has-error';"/>
																		<span class="facepile-item-coin-text durable-image-fallback facepile-item-teal"aria-hidden="true">B</span>
																	</a>
																</li>
																<li class="facepile-item">
																	<a href="https://github.com/mdressman" title="mdressman" aria-label="mdressmanGithub profile" data-src="https://github.com/mdressman.png?size=32" data-contributor-name="mdressman" class="facepile-item-coin"
																	>
																		<img class="facepile-item-coin-image durable-image" aria-hidden="true" src="https://github.com/mdressman.png?size=32" role="presentation" onerror="this.className='facepile-item-coin-image durable-image has-error';"/>
																		<span class="facepile-item-coin-text durable-image-fallback facepile-item-red"aria-hidden="true">m</span>
																	</a>
																</li>
																<li class="facepile-item">
																	<a href="https://github.com/Santoshtambe" title="Santoshtambe" aria-label="SantoshtambeGithub profile" data-src="https://github.com/Santoshtambe.png?size=32" data-contributor-name="Santoshtambe" class="facepile-item-coin"
																	>
																		<img class="facepile-item-coin-image durable-image" aria-hidden="true" src="https://github.com/Santoshtambe.png?size=32" role="presentation" onerror="this.className='facepile-item-coin-image durable-image has-error';"/>
																		<span class="facepile-item-coin-text durable-image-fallback facepile-item-blue"aria-hidden="true">S</span>
																	</a>
																</li>
											</ul>
										</li>
								</ul>

								<nav id="center-doc-outline" class="doc-outline is-hidden-desktop" data-bi-name="intopic toc" role="navigation" aria-label="Article Outline">
									<h3>In this article</h3>
								</nav>


							<!-- <content> -->
								<p>Security Bulletin</p>
<h1 id="microsoft-security-bulletin-ms02-051---moderate">Microsoft Security Bulletin MS02-051 - Moderate</h1>
<h2 id="cryptographic-flaw-in-rdp-protocol-can-lead-to-information-disclosure-q324380">Cryptographic Flaw in RDP Protocol can Lead to Information Disclosure (Q324380)</h2>
<p>Published: September 18, 2002</p>
<p><strong>Version:</strong> 1.0</p>
<p><strong>Originally posted:</strong> September 18, 2002</p>
<h4 id="summary">Summary</h4>
<p><strong>Who should read this bulletin:</strong>
System administrators who operate terminal servers using Microsoft® Windows® 2000, or Windows XP users who have enabled Remote Desktop.</p>
<p><strong>Impact of vulnerability:</strong>
Two vulnerabilities: information disclosure, denial of service.</p>
<p><strong>Maximum Severity Rating:</strong>
Moderate.</p>
<p><strong>Recommendation:</strong>
Administrators of Windows 2000 terminal servers and Windows XP users who have enabled Remote Desktop should apply the patch.</p>
<p><strong>Affected Software:</strong></p>
<ul>
<li>Microsoft Windows 2000</li>
<li>Microsoft Windows XP</li>
</ul>
<h3 id="general-information">General Information</h3>
<h2 id="technical-details">Technical details</h2>
<p><strong>Technical description:</strong></p>
<p>The Remote Data Protocol (RDP) provides the means by which Windows systems can provide remote terminal sessions to clients. The protocol transmits information regarding a terminal sessions' keyboard, mouse and video to the remote client, and is used by Terminal Services in Windows NT 4.0 and Windows 2000, and by Remote Desktop in Windows XP. Two security vulnerabilities, both of which are eliminated by this patch, have been discovered in various RDP implementations.</p>
<p>The first involves how session encryption is implemented in certain versions of RDP. All RDP implementations allow the data in an RDP session to be encrypted. However, in the versions in Windows 2000 and Windows XP, the checksums of the plaintext session data are sent without being encrypted themselves. An attacker who was able to eavesdrop on and record an RDP session could conduct a straightforward cryptanalytic attack against the checksums and recover the session traffic.</p>
<p>The second involves how the RDP implementation in Windows XP handles data packets that are malformed in a particular way. Upon receiving such packets, the Remote Desktop service would fail, and with it would fail the operating system. It would not be necessary for an attacker to authenticate to an affected system in order to deliver packets of this type to an affected system.</p>
<p><strong>Mitigating factors:</strong></p>
<p>Cryptographic Flaw in RDP Protocol:</p>
<ul>
<li>An attacker would need the ability to capture an RDP session in order to exploit this vulnerability. In most cases, this would require that the attacker have physical access to the network media.</li>
<li>Because encryption keys are negotiated on a per-session basis, a successful attack would allow an attacker to decrypt only a single session and not multiple sessions. Thus, the attacker would need to conduct a separate cryptanalytic attack against each session he or she wished to compromise.</li>
</ul>
<p>Denial of Service in Remote Desktop:</p>
<ul>
<li>Remote Desktop service in Windows XP is not enabled by default.</li>
<li>Even if Remote Desktop service were enabled, a successful attack would require that the attacker be able to deliver packets to the Remote Desktop port on an affected system. Customers who block port 3389 at the firewall would be protected against attempts to exploit this vulnerability. (By default Internet Connection Firewall does block port 3389).</li>
</ul>
<p><strong>Severity Rating:</strong></p>
<table>
<thead>
<tr>
<th></th>
<th>Internet Servers</th>
<th>Intranet Servers</th>
<th>Client Systems</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Cryptographic Flaw in RDP Protocol</strong></td>
<td>Moderate</td>
<td>Moderate</td>
<td>Moderate</td>
</tr>
<tr>
<td><strong>Denial of Service in Remote Desktop</strong></td>
<td>None</td>
<td>None</td>
<td>Moderate</td>
</tr>
</tbody>
</table>
<p>The above <a href="http://technet.microsoft.com/security/bulletin/rating" data-linktype="external">assessment</a> is based on the types of systems affected by the vulnerability, their typical deployment patterns, and the effect that exploiting the vulnerability would have on them. Successfully exploiting the encryption vulnerability requires the attacker to have access to the network media; the denial of service vulnerability only affects Windows XP systems, and only if Remote Desktop Sharing has been enabled.</p>
<p><strong>Vulnerability identifier:</strong></p>
<ul>
<li>Weak Encryption in RDP Protocol:<a href="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0863" data-linktype="external">CVE-CAN-2002-0863</a></li>
<li>Denial of Service in Remote Desktop:<a href="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0864" data-linktype="external">CVE-CAN-2002-0864</a></li>
</ul>
<p><strong>Tested Versions:</strong></p>
<p>Microsoft tested Windows NT 4.0 Terminal Services Edition, Windows 2000 and Windows XP to assess whether they are affected by these vulnerabilities. Previous versions are no longer <a href="http://support.microsoft.com/directory/discontinue.asp" data-linktype="external">supported</a>, and may or may not be affected by these vulnerabilities.</p>
<h2 id="frequently-asked-questions">Frequently asked questions</h2>
<p><strong>What vulnerabilities are eliminated by this patch?</strong><br/>
This patch eliminates two vulnerabilities affecting the implementation of the RDP protocol:</p>
<ul>
<li>The first involves a cryptographic flaw affecting the Windows 2000 and Windows XP implementations.</li>
<li>The second involves denial of service vulnerability affecting the Windows XP implementation only.</li>
</ul>
<p><strong>What is the RDP protocol?</strong><br/>
<a href="http://www.microsoft.com/windowsxp/using/networking/security/winfirewall.mspx" data-linktype="external">Remote Desktop Protocol</a> is a networking protocol that supports remote Windows terminal sessions between a client and a server. It transmit all of the information usually associated with a local console session - keystrokes, video and mouse data, and so forth - across a network, allowing users to have full, interactive logon sessions with remote systems. Microsoft Knowledge Base article <a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;q186607" data-linktype="external">Q186607</a> provides detailed technical information about the protocol.</p>
<p><strong>In which Microsoft products is RDP implemented?</strong><br/>
In general, RDP is the underlying protocol for Windows features that allow remote desktop sessions. For instance:</p>
<ul>
<li>Windows NT 4.0, Terminal Server Edition implements RDP 4.0.</li>
<li>Terminal Services in Windows 2000 implements RDP 5.0</li>
<li><a href="http://www.microsoft.com/windowsxp/using/mobility/getstarted/remoteintro.mspx" data-linktype="external">Remote Desktop Sharing</a> in Windows XP implements RDP 5.1</li>
</ul>
<p><strong>Are RDP sessions enabled by default in Windows?</strong><br/>
RDP sessions are enabled by default in Windows NT 4.0, Terminal Server Edition, but not in any other version of Windows. (Please note, however, that neither of these vulnerabilities occur in Windows NT 4.0 Terminal Server Edition).</p>
<p><strong>Cryptographic Flaw in RDP Protocol (CAN-2002-0863):</strong></p>
<p><strong>What's the scope of first vulnerability?</strong><br/>
This vulnerability could enable an attacker to read the contents of an encrypted RDP session, thereby compromising any data within it. This could include information such as usernames and passwords, as well as any data the user entered into an application or which an application displayed for the user.
To exploit the vulnerability, the attacker would need the ability to eavesdrop on and record an RDP session. In most cases, this would require the attacker to have physical access to the network media itself. It would also require the attacker to have the technical ability to mount a cryptanalytic attack on the recorded data (the attack is, however, straightforward). Only the RDP implementations in Windows 2000 and Windows XP are affected.</p>
<p><strong>What causes the vulnerability?</strong><br/>
The vulnerability results because, although session data is encrypted in RDP 5.0 (the version that ships with Windows 2000) and RDP 5.1 (the version that ships with Windows XP), the checksums of the session data are not.</p>
<p><strong>What is RDP Encryption?</strong><br/>
Because RDP packets can sometimes be sent across uncontrolled or untrusted networks like the Internet or an extranet, <a href="http://msdn2.microsoft.com/en-us/library/aa383015" data-linktype="external">RDP</a> encrypts the data in a remote session using the RC4 cryptoalgorithm. In versions prior to Windows XP, the server administrator could select the key size to use; in Windows XP, all sessions are protected using 128-bit key.
The vulnerability, however, has nothing to do with the cryptoalgorithm used by RDP, nor with the key size. Instead, it results because of an implementation error involving the handling of checksum data.</p>
<p><strong>What is checksum data?</strong><br/>
Checksums are frequently used in networking applications as a way of detecting and correcting errors that occur during transmission. Before one computer sends a data packet, it performs a mathematical operation on the data, and sends the result of the operation along with the data itself. Upon receiving the data and checksum, the other computer performs the same mathematical operation on the data it received, and confirms that the result matches what it received. If they match, it's a good indicator that the data wasn't corrupted in transit.</p>
<p><strong>What's wrong with the way checksums are handled in encrypted RDP sessions?</strong><br/>
The checksums, like the session data itself, should be encrypted. However, in the Windows 2000 and Windows XP implementations of RDP, they aren't. The session data is encrypted, but before it's encrypted a checksum is calculated - and that checksum is sent in plaintext.</p>
<p><strong>Why does this constitute a security vulnerability? After all, the checksums aren't the same as the session data, they're just information about the session data.</strong>
True, but there are straightforward cryptanalytic techniques that would enable an attacker to recover the session data from the checksums. Having broken the encryption, the attacker would be able to see the user's entire RDP session. Any information - from the information the user entered at the keyboard, to the movements of his or her mouse, to the information displayed on the screen - could be read.</p>
<p><strong>How could an attacker exploit this vulnerability?</strong><br/>
To exploit this vulnerability, an attacker would first have to have the means to capture a user's encrypted network traffic, most likely through the use of a network packet tracer. This is an important point, because in most cases it would require the attacker to have physical access to the network cabling that carries the session data.
Having captured the data, the attacker would need to subject it to a cryptanalytic attack in order to &quot;crack&quot; the encryption on the session data. This would require some technical knowledge about the RDP data format and cryptanalytic techniques, but these are not insurmountable hurdles.</p>
<p><strong>If an attacker managed to decrypt one session, would that make it easier to decrypt future ones?</strong><br/>
No. Unique session keys are negotiated at the start of every RDP session, so each attempt to compromise a session would need to start from scratch.</p>
<p><strong>Does the vulnerability affect Windows NT 4.0?</strong><br/>
No. Only the RDP implementations in Windows 2000 and Windows XP are affected.</p>
<p><strong>What does the patch do?</strong><br/>
The patch eliminates the vulnerability by encrypting the checksums as well as the session data.</p>
<p><strong>Denial of Service in Remote Desktop (CAN-2002-0864):</strong></p>
<p><strong>What's the scope of the second vulnerability?</strong><br/>
This is a <a href="http://technet.microsoft.com/security/bulletin/glossary" data-linktype="external">denial of service</a> vulnerability. An attacker who successfully exploited this vulnerability could cause a system hosting remote sessions to fail, with the loss of any unsaved data.
This vulnerability only affects Windows XP, but even then, the affected feature is not enabled by default. Even if it were enabled, an attacker would need the ability to deliver data to an affected system in order to exploit the vulnerability, so users who have observed normal firewalling precautions would not at risk from Internet-based attacks.</p>
<p><strong>What causes the vulnerability?</strong><br/>
The vulnerability results because of a flaw in the way RDP 5.1 (the version implemented in Windows XP) handles certain types of invalid data packets. Instead of handling them gracefully, RDP - and with the operating system itself - would fail upon processing them.</p>
<p><strong>What's wrong with the way the RDP implementation in Windows XP handles the invalid data involved in the vulnerability?</strong><br/>
By design, RDP should always check the validity of all incoming data packets before trying to act upon them. However, the RDP implementation in Windows XP doesn't check for one particular type of flaw in the incoming packets. Because of this, it would be possible to create a packet that, when processed, would create a series of failures that would culminate in the failure of the operating system itself.</p>
<p><strong>What could an attacker do via this vulnerability?</strong><br/>
An attacker could cause a Windows XP system to fail, if it's been configured to allow Remote Desktop sessions. The operator would need to reboot the machine in order to restore normal service.</p>
<p><strong>Who could exploit the vulnerability?</strong><br/>
Any user who could deliver the specific type of packets involved in this vulnerability to an affected Windows XP system could exploit it.</p>
<p><strong>Are default installations of Windows XP affected by the vulnerability?</strong><br/>
No. Remote Desktop Service does not run by default.</p>
<p><strong>I don't know if I've enabled Remote Desktop. How can I tell?</strong><br/>
Select Start, then Control Panel, then System. In the System Properties dialog, select the Remote tab, and inspect the checkbox in the Remote Desktop section. If it's selected, Remote Desktop is enabled; if it's not, Remote Desktop is disabled.</p>
<p><strong>Would the attacker need to be able to establish a Remote Desktop session in order to exploit this vulnerability?</strong><br/>
No. The attacker would only need to send the correct set of packets to the correct port.</p>
<p><strong>Could the vulnerability be exploited from the Internet?</strong><br/>
It depends on whether the attacker were able to deliver packets to the port on which RDP operates, port 3389. If standard best practices have been followed, this port will be blocked at the firewall. (For instance, this port is blocked by default by <a href="http://www.microsoft.com/windowsxp/using/networking/security/winfirewall.mspx" data-linktype="external">Internet Connection Firewall</a>).</p>
<p><strong>Could a user inadvertently exploit this vulnerability?</strong><br/>
No. The specific series of packets needed to cause the server to fail cannot be generated as part of a normal Remote Desktop session.</p>
<p><strong>What does the patch do?</strong><br/>
The patch addresses the vulnerability by ensuring that the Remote Desktop service handles malformed packets gracefully.</p>
<h2 id="patch-availability">Patch availability</h2>
<p><strong>Download locations for this patch</strong></p>
<ul>
<li><p>Windows 2000:</p>
<p><a href="https://www.microsoft.com/download/details.aspx?familyid=c9a38d45-5145-4844-b62e-c69d32ac929b&amp;displaylang=en" data-linktype="external">https://www.microsoft.com/download/details.aspx?FamilyId=C9A38D45-5145-4844-B62E-C69D32AC929B&amp;displaylang=en</a></p>
</li>
<li><p>Windows XP:</p>
<p><a href="https://www.microsoft.com/download/details.aspx?familyid=84fc577d-f2d5-47b8-ab98-77ba7501b00b&amp;displaylang=en" data-linktype="external">https://www.microsoft.com/download/details.aspx?FamilyId=84FC577D-F2D5-47B8-AB98-77BA7501B00B&amp;displaylang=en</a></p>
</li>
<li><p>Windows XP 64 bit Edition:</p>
<p><a href="https://www.microsoft.com/download/details.aspx?familyid=97945a5d-db0b-40f8-9a2e-de93cbb5cb3a&amp;displaylang=en" data-linktype="external">https://www.microsoft.com/download/details.aspx?FamilyId=97945A5D-DB0B-40F8-9A2E-DE93CBB5CB3A&amp;displaylang=en</a></p>
</li>
</ul>
<h4 id="additional-information-about-this-patch">Additional information about this patch</h4>
<p><strong>Installation platforms:</strong></p>
<ul>
<li>The patch for Windows 2000 can be installed on systems running Windows 2000 <a href="http://www.microsoft.com/windows2000/downloads/servicepacks/sp2/default.mspx" data-linktype="external">Service Pack 2</a> or Windows 2000 <a href="http://www.microsoft.com/windows2000/downloads/servicepacks/sp3/default.mspx" data-linktype="external">Service Pack 3</a>.</li>
<li>The patch for Windows XP can be installed on systems running Windows XP Gold.</li>
</ul>
<p><strong>Inclusion in future service packs:</strong></p>
<ul>
<li>The fix for this issue will be included in Windows 2000 Service Pack 4.</li>
<li>The fix for this issue is included in Windows XP Service Pack 1.</li>
</ul>
<p><strong>Reboot needed:</strong> Yes</p>
<p><strong>Patch can be uninstalled:</strong> Yes</p>
<p><strong>Superseded patches:</strong> None.</p>
<p><strong>Verifying patch installation:</strong> Windows 2000:</p>
<ul>
<li><p>To verify that the patch has been installed on the machine, confirm that the following registry key has been created on the machine:</p>
<p>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Updates\Windows 2000\SP4\Q324380.</p>
</li>
<li><p>To verify the individual files, use the date/time and version information provided in the following registry key:</p>
<p>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Updates\Windows 2000\SP4\Q324380\Filelist</p>
</li>
</ul>
<p>Windows XP:</p>
<ul>
<li><p>To verify that the patch has been installed on the machine, confirm that the following registry key has been created on the machine:</p>
<p>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Updates\Windows XP\SP1\Q324380.</p>
</li>
<li><p>To verify the individual files, use the date/time and version information provided in the following registry key:</p>
<p>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Updates\Windows XP\SP1\Q324380\Filelist.</p>
</li>
</ul>
<p><strong>Caveats:</strong></p>
<p>None</p>
<p><strong>Localization:</strong></p>
<p>Localized versions of this patch are available at the locations discussed in &quot;Patch Availability&quot;.</p>
<p><strong>Obtaining other security patches:</strong></p>
<p>Patches for other security issues are available from the following locations:</p>
<ul>
<li>Security patches are available from the <a href="http://go.microsoft.com/fwlink/?linkid=21129" data-linktype="external">Microsoft Download Center</a>, and can be most easily found by doing a keyword search for &quot;security_patch&quot;.</li>
<li>Patches for consumer platforms are available from the <a href="http://windowsupdate.microsoft.com/" data-linktype="external">WindowsUpdate</a> web site</li>
</ul>
<h4 id="other-information">Other information:</h4>
<p><strong>Support:</strong></p>
<ul>
<li>Microsoft Knowledge Base article Q324380 discusses this issue and will be available approximately 24 hours after the release of this bulletin. Knowledge Base articles can be found on the <a href="http://support.microsoft.com/?scid=fh;en-us;kbhowto" data-linktype="external">Microsoft Online Support</a> web site.</li>
<li>Technical support is available from <a href="http://support.microsoft.com/directory/question.asp?sd=gn&amp;fr=0" data-linktype="external">Microsoft Product Support Services</a>. There is no charge for support calls associated with security patches.</li>
</ul>
<p><strong>Security Resources:</strong> The <a href="http://www.microsoft.com/technet/security/default.mspx" data-linktype="external">Microsoft TechNet Security</a> Web Site provides additional information about security in Microsoft products.</p>
<p><strong>Disclaimer:</strong></p>
<p>The information provided in the Microsoft Knowledge Base is provided &quot;as is&quot; without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.</p>
<p><strong>Revisions:</strong></p>
<ul>
<li>V1.0 (September 18, 2002): Bulletin Created.</li>
</ul>
<p><em>Built at 2014-04-18T13:49:36Z-07:00</em></p>

							<!-- </content> -->

						</main>

						<!-- page rating section -->
								<div class="is-hidden-desktop border-top has-margin-top-large has-padding-top-large binary-rating-holder">
									
	
	

	<div class="feedback-verbatim border-bottom has-padding-bottom-large has-margin-bottom-small" data-bi-name="rating">
    <div class="binary-rating">
        <div class="binary-rating-buttons">
				<h3 class="font-weight-semibold has-margin-top-none font-size-h4 margin-bottom-xs">Is this page helpful?</h3>
			<div>
                <button class="thumb-rating like has-inner-focus" title="Yes" data-bi-name="rating-yes" aria-expanded="false" data-bi-sat="1" aria-controls="rating-container-desktop">
                    <span aria-hidden="true" class="icon docon docon-like"></span>
                    <span>Yes</span>
                </button>
                <button class="thumb-rating dislike has-inner-focus" title="No" data-bi-name="rating-no" data-bi-sat="0" aria-expanded="false" aria-controls="rating-container-desktop">
                    <span aria-hidden="true" class="icon docon docon-dislike"></span>
                    <span>No</span>
                </button>
            </div>
        </div>
        <form class="feedback-verbatim-form is-hidden" id="rating-container-desktop">
            <div class="verbatim-textarea box position-relative box-shadow-none border has-margin-top-small has-padding-extra-small font-size-xs">
                <label for="rating-textarea-desktop" class="visually-hidden">Any additional feedback?</label>
                <textarea id="rating-textarea-desktop" rows="4" maxlength="999" placeholder="Any additional feedback?" required class="textarea border-none box-shadow-none has-inner-focus"></textarea>
		    </div>
			<p class="font-size-xs has-line-height-reset">Feedback will be sent to Microsoft: By pressing the submit button, your feedback will be used to improve Microsoft products and services. <a href="https://privacy.microsoft.com/en-us/privacystatement">Privacy policy.</a></p>
            <div class="buttons buttons-right margin-top-xs has-margin-right-extra-small">
                <button class="skip-rating button button-clear button-primary button-sm" type="button">Skip</button>
                <button class="submit-rating button button-primary button-filled button-sm" data-bi-name="rating-verbatim" disabled type="submit">Submit</button>
            </div>
        </form>
    </div>
    <div class="thankyou-rating is-hidden" tabindex="-1">
        <p>Thank you.</p>
    </div>
</div>								</div>
						<!-- end page rating section -->



						<!-- recommendations section -->
							<section id="recommendations-section" data-bi-name="recommendations"></section>
						<!-- end recommendations section -->

						<!-- feedback section -->
						<!-- end feedback section -->

						<!-- feedback report section -->
						<!-- end feedback report section -->

						<div class="border-top is-visible-interactive has-default-focus has-margin-top-large ">



	<footer id="footer-interactive" data-bi-name="footer" class="footer-layout">
	<div class="display-flex is-full-height has-padding-right-extra-large-desktop">
			<a
				data-mscc-ic="false"
				class="locale-selector-link button button-clear flex-shrink-0"
				href="#"
				data-bi-name="select-locale">
					<span class="icon" aria-hidden="true">
						<span class="docon docon-world"></span>
					</span>
					<span class="local-selector-link-text"></span></a>
		<div class="margin-inline-xs flex-shrink-0">
<div class="dropdown has-caret-up">
	<button class="dropdown-trigger button button-clear button-sm has-inner-focus theme-dropdown-trigger"
		aria-controls="theme-menu-interactive" aria-expanded="false" title="Theme" data-bi-name="theme">
		<span class="icon">
			<span class="docon docon-sun" aria-hidden="true"></span>
		</span>
		<span>Theme</span>
	</button>
	<div class="dropdown-menu" id="theme-menu-interactive" role="menu">
		<ul class="theme-selector has-padding-small">
			<li class="theme is-block">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="light">
					<span class="theme-light has-margin-right-small">
						<span
							class="theme-selector-icon css-variable-support border is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
Light					</span>
				</button>
			</li>
			<li class="theme is-block">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="dark">
					<span class="theme-dark has-margin-right-small">
						<span
							class="border theme-selector-icon css-variable-support is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
Dark					</span>
				</button>
			</li>
			<li class="theme is-block">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="high-contrast">
					<span class="theme-high-contrast has-margin-right-small">
						<span
							class="border theme-selector-icon css-variable-support is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
High contrast					</span>
				</button>
			</li>
		</ul>
	</div>
</div>		</div>
	</div>
	<ul class="links" data-bi-name="footerlinks">
		<li class="manage-cookies-holder" hidden></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/previous-versions/" data-bi-name="archivelink">Previous Version Docs</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/teamblog" data-bi-name="bloglink">Blog</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/contribute" data-bi-name="contributorGuide">Contribute</a></li>
					<li><a data-mscc-ic="false" href="https://go.microsoft.com/fwlink/?LinkId=521839" data-bi-name="privacy">Privacy &amp; Cookies</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/legal/termsofuse" data-bi-name="termsofuse">Terms of Use</a></li>
				<li><a data-mscc-ic="false" href="https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/EN-US.aspx" data-bi-name="trademarks">Trademarks</a></li>
		<li>&copy; Microsoft 2021</li>
	</ul>
</footer>
						</div>
					</div>

						<div
							class="font-size-sm right-container column is-4-desktop display-none display-block-desktop"
							data-bi-name="pageactions"
							role="complementary"
							aria-label="Page Actions">

							<div id="affixed-right-container" class="doc-outline is-vertically-scrollable">
									
	
	

	<div class="feedback-verbatim border-bottom has-padding-bottom-small has-margin-bottom-small" data-bi-name="rating">
    <div class="binary-rating">
        <div class="binary-rating-buttons">
				<h3 class="font-weight-semibold has-margin-top-none has-margin-bottom-small">Is this page helpful?</h3>
			<div>
                <button class="thumb-rating like has-inner-focus" title="Yes" data-bi-name="rating-yes" aria-expanded="false" data-bi-sat="1" aria-controls="rating-container-mobile">
                    <span aria-hidden="true" class="icon docon docon-like"></span>
                    <span>Yes</span>
                </button>
                <button class="thumb-rating dislike has-inner-focus" title="No" data-bi-name="rating-no" data-bi-sat="0" aria-expanded="false" aria-controls="rating-container-mobile">
                    <span aria-hidden="true" class="icon docon docon-dislike"></span>
                    <span>No</span>
                </button>
            </div>
        </div>
        <form class="feedback-verbatim-form is-hidden" id="rating-container-mobile">
            <div class="verbatim-textarea box position-relative box-shadow-none border has-margin-top-small has-padding-extra-small font-size-xs">
                <label for="rating-textarea-mobile" class="visually-hidden">Any additional feedback?</label>
                <textarea id="rating-textarea-mobile" rows="4" maxlength="999" placeholder="Any additional feedback?" required class="textarea border-none box-shadow-none has-inner-focus"></textarea>
		    </div>
			<p class="font-size-xs has-line-height-reset">Feedback will be sent to Microsoft: By pressing the submit button, your feedback will be used to improve Microsoft products and services. <a href="https://privacy.microsoft.com/en-us/privacystatement">Privacy policy.</a></p>
            <div class="buttons buttons-right margin-top-xs has-margin-right-extra-small">
                <button class="skip-rating button button-clear button-primary button-sm" type="button">Skip</button>
                <button class="submit-rating button button-primary button-filled button-sm" data-bi-name="rating-verbatim" disabled type="submit">Submit</button>
            </div>
        </form>
    </div>
    <div class="thankyou-rating is-hidden" tabindex="-1">
        <p>Thank you.</p>
    </div>
</div>								<nav id="side-doc-outline" data-bi-name="intopic toc" role="navigation" aria-label="Article Outline">
									<h3>In this article</h3>
								</nav>
							</div>
						</div>

				</div>
				<!--end of div.columns -->

			</section>
			<!--end of .primary-holder -->

			<!-- interactive container -->
			<aside id="interactive-container" class="interactive-container is-visible-interactive column has-body-background-dark ">
			</aside>
			<!-- end of interactive container -->
		</div>

	</div>
	<!--end of .mainContainer -->

	<section class="border-top has-default-focus is-hidden-interactive has-margin-top-large ">



	<footer id="footer" data-bi-name="footer" class="footer-layout uhf-container has-padding" role="contentinfo">
	<div class="display-flex is-full-height has-padding-right-extra-large-desktop">
			<a
				data-mscc-ic="false"
				class="locale-selector-link button button-clear flex-shrink-0"
				href="#"
				data-bi-name="select-locale">
					<span class="icon" aria-hidden="true">
						<span class="docon docon-world"></span>
					</span>
					<span class="local-selector-link-text"></span></a>
		<div class="margin-inline-xs flex-shrink-0">
<div class="dropdown has-caret-up">
	<button class="dropdown-trigger button button-clear button-sm has-inner-focus theme-dropdown-trigger"
		aria-controls="theme-menu" aria-expanded="false" title="Theme" data-bi-name="theme">
		<span class="icon">
			<span class="docon docon-sun" aria-hidden="true"></span>
		</span>
		<span>Theme</span>
	</button>
	<div class="dropdown-menu" id="theme-menu" role="menu">
		<ul class="theme-selector has-padding-small">
			<li class="theme is-block">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="light">
					<span class="theme-light has-margin-right-small">
						<span
							class="theme-selector-icon css-variable-support border is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
Light					</span>
				</button>
			</li>
			<li class="theme is-block">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="dark">
					<span class="theme-dark has-margin-right-small">
						<span
							class="border theme-selector-icon css-variable-support is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
Dark					</span>
				</button>
			</li>
			<li class="theme is-block">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="high-contrast">
					<span class="theme-high-contrast has-margin-right-small">
						<span
							class="border theme-selector-icon css-variable-support is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
High contrast					</span>
				</button>
			</li>
		</ul>
	</div>
</div>		</div>
	</div>
	<ul class="links" data-bi-name="footerlinks">
		<li class="manage-cookies-holder" hidden></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/previous-versions/" data-bi-name="archivelink">Previous Version Docs</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/teamblog" data-bi-name="bloglink">Blog</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/contribute" data-bi-name="contributorGuide">Contribute</a></li>
					<li><a data-mscc-ic="false" href="https://go.microsoft.com/fwlink/?LinkId=521839" data-bi-name="privacy">Privacy &amp; Cookies</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/legal/termsofuse" data-bi-name="termsofuse">Terms of Use</a></li>
				<li><a data-mscc-ic="false" href="https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/EN-US.aspx" data-bi-name="trademarks">Trademarks</a></li>
		<li>&copy; Microsoft 2021</li>
	</ul>
</footer>
	</section>

	<div id="action-panel" role="region" aria-label="Action Panel" class="action-panel has-default-focus" tabindex="-1"></div>
</body>
</html>
