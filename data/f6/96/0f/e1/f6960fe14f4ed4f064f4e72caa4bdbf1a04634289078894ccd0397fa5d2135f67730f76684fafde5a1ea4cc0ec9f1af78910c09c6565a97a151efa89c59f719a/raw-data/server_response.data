<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="UTF-8">
<meta property="og:type" content="website">
<meta property="og:title" content="1282076 - (CVE-2016-5274) use-after-poison in nsFrameManager::CaptureFrameState">
<meta property="og:url" content="https://bugzilla.mozilla.org/show_bug.cgi?id=1282076">
<meta property="og:description"
      content="VERIFIED (hikezoe.birchill) in Core - DOM: Animation. Last updated 2017-03-29.">
<meta name="twitter:label1" value="Type">
<meta name="twitter:data1" value="defect">
<meta name="twitter:label2" value="Priority">
<meta name="twitter:data2" value="P1">

    <meta name="viewport" content="width=1024">
    <meta name="color-scheme" content="dark light">
    <meta name="generator" content="Bugzilla 20211025.1">
    <meta name="bugzilla-global" content="dummy"
        id="bugzilla-global" data-bugzilla="{&quot;api_token&quot;:&quot;&quot;,&quot;config&quot;:{&quot;basepath&quot;:&quot;\/&quot;},&quot;constant&quot;:{&quot;COMMENT_COLS&quot;:80},&quot;param&quot;:{&quot;maxattachmentsize&quot;:&quot;10240&quot;,&quot;maxusermatches&quot;:&quot;50&quot;,&quot;splinter_base&quot;:&quot;\/page.cgi?id=splinter.html&amp;ignore=\/&quot;},&quot;string&quot;:{&quot;bug_type_required&quot;:&quot;You must select a Type for this bug&quot;,&quot;component_required&quot;:&quot;You must select a Component for this bug&quot;,&quot;description_required&quot;:&quot;You must enter a Description for this bug&quot;,&quot;short_desc_required&quot;:&quot;You must enter a Summary for this bug&quot;,&quot;version_required&quot;:&quot;You must select a Version for this bug&quot;},&quot;user&quot;:{&quot;is_new&quot;:1,&quot;login&quot;:&quot;&quot;}}">
    <title>1282076 - (CVE-2016-5274) use-after-poison in nsFrameManager::CaptureFrameState</title>

<link rel="Top" href="/">

  


  
    <link rel="Show" title="Dependency Tree"
          href="/showdependencytree.cgi?id=1282076&amp;hide_resolved=1">
      <link rel="Show" title="Dependency Graph"
            href="/showdependencygraph.cgi?id=1282076">

      <link rel="Show" title="Bug Activity"
            href="/show_activity.cgi?id=1282076">

<link href="/static/v20211025.1/skins/yui.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/standard/global.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BugModal/web/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BMO/web/styles/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/EditComments/web/styles/inline-editor.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-structure-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-theme-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/lib/prism.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Needinfo/web/styles/needinfo.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Review/web/styles/badge.css" rel="stylesheet" type="text/css">



    
<script nonce="hXy0uqRl2oOFJwsqrHLiFgThhfpY7tIX3XlgRD5W0KlkRBoi" src="/static/v20211025.1/js/jquery/jquery-min.js"></script><script nonce="hXy0uqRl2oOFJwsqrHLiFgThhfpY7tIX3XlgRD5W0KlkRBoi" src="/static/v20211025.1/js/jquery/ui/jquery-ui-min.js"></script><script nonce="hXy0uqRl2oOFJwsqrHLiFgThhfpY7tIX3XlgRD5W0KlkRBoi" src="/static/v20211025.1/js/yui.js"></script><script nonce="hXy0uqRl2oOFJwsqrHLiFgThhfpY7tIX3XlgRD5W0KlkRBoi" src="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu-min.js"></script><script nonce="hXy0uqRl2oOFJwsqrHLiFgThhfpY7tIX3XlgRD5W0KlkRBoi" src="/static/v20211025.1/js/jquery/plugins/devbridgeAutocomplete/devbridgeAutocomplete-min.js"></script><script nonce="hXy0uqRl2oOFJwsqrHLiFgThhfpY7tIX3XlgRD5W0KlkRBoi" src="/static/v20211025.1/js/global.js"></script><script nonce="hXy0uqRl2oOFJwsqrHLiFgThhfpY7tIX3XlgRD5W0KlkRBoi" src="/static/v20211025.1/js/util.js"></script><script nonce="hXy0uqRl2oOFJwsqrHLiFgThhfpY7tIX3XlgRD5W0KlkRBoi" src="/static/v20211025.1/js/dropdown.js"></script>

      <script nonce="hXy0uqRl2oOFJwsqrHLiFgThhfpY7tIX3XlgRD5W0KlkRBoi">
          YAHOO.namespace('bugzilla');
          if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
              YAHOO.util.Event._simpleRemove(window, "unload",
                                             YAHOO.util.Event._unload);
          }BUGZILLA.value_descs = JSON.parse('{\"bug_status\":{},\"resolution\":{\"\":\"---\"}}');

  
    var tracking_flags_str = "{\"flags\":{\"project\":{\"cf_a11y_review_project_flag\":\"---\",\"cf_webcompat_priority\":\"---\",\"cf_tracking_firefox_sumo\":\"---\",\"cf_root_cause\":\"---\",\"cf_fission_milestone\":\"---\"},\"tracking\":{\"cf_tracking_firefox_esr45\":\"49+\",\"cf_status_firefox_esr91\":\"---\",\"cf_tracking_firefox95\":\"---\",\"cf_tracking_firefox49\":\"+\",\"cf_status_firefox48\":\"wontfix\",\"cf_status_firefox50\":\"verified\",\"cf_status_firefox_esr45\":\"verified\",\"cf_status_thunderbird_esr91\":\"---\",\"cf_status_firefox49\":\"verified\",\"cf_tracking_firefox_esr91\":\"---\",\"cf_status_firefox47\":\"wontfix\",\"cf_status_firefox95\":\"---\",\"cf_tracking_firefox94\":\"---\",\"cf_tracking_thunderbird_esr91\":\"---\",\"cf_status_firefox_esr78\":\"---\",\"cf_tracking_firefox93\":\"---\",\"cf_tracking_firefox48\":\"+\",\"cf_tracking_firefox_esr78\":\"---\",\"cf_status_thunderbird_esr78\":\"---\",\"cf_status_firefox93\":\"---\",\"cf_tracking_firefox_relnote\":\"---\",\"cf_tracking_firefox47\":\"+\",\"cf_tracking_firefox50\":\"+\",\"cf_tracking_thunderbird_esr78\":\"---\",\"cf_status_firefox94\":\"---\"}},\"types\":[\"tracking\"],\"comments\":{\"cf_tracking_firefox_sumo\":{\"none-needed\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox_relnote\":{\"?\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox49\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox47\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox50\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr91\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox94\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr45\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_a11y_review_project_flag\":{\"requested\":\"Description:\\nPlease provide an explanation of the feature or change. Include a description of the user scenario in which it would be used and how the user would complete the task(s).\\nScreenshots and visual UI specs are welcome, but please include sufficient accompanying explanation so that blind members of the accessibility team are able to understand the feature\/change.\\n\\nHow do we test this?\\nIf there is an implementation to test, please provide instructions for testing it; e.g. setting preferences, other preparation, how to trigger the UI, etc.\\n\\nWhen will this ship?\\nTracking bug\/issue:\\nDesign documents (e.g. Product Requirements Document, UI spec):\\nEngineering lead:\\nProduct manager:\\n\\nThe accessibility team has developed the Mozilla Accessibility Release Guidelines which outline what is needed to make user interfaces accessible:\\nhttps:\/\/wiki.mozilla.org\/Accessibility\/Guidelines\\nPlease describe the accessibility guidelines you considered and what steps you\'ve taken to address them:\\n\\nDescribe any areas of concern to which you want the accessibility team to give special attention:\"},\"cf_tracking_firefox95\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox93\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox48\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr78\":{\"?\":\"[Tracking Requested - why for this release]:\"}}}";
    var TrackingFlags = $.parseJSON(tracking_flags_str);

  

  
  BUGZILLA.bug_id = 1282076;
  BUGZILLA.bug_title = '1282076 - (CVE-2016-5274) use-after-poison in nsFrameManager::CaptureFrameState';
  BUGZILLA.bug_summary = 'use-after-poison in nsFrameManager::CaptureFrameState';
  BUGZILLA.bug_url = 'https:\/\/bugzilla.mozilla.org\/show_bug.cgi?id=1282076';
  BUGZILLA.bug_keywords = 'crash, csectype-uaf, regression, sec-high, testcase',
  BUGZILLA.user = {
    id: 0,
    login: '',
    is_insider: false,
    is_timetracker: false,
    can_tag: false,
    timezone: 'America\/Los_Angeles',
    settings: {
      quote_replies: 'quoted_reply',
      zoom_textareas: true,
      remember_collapsed: true,
      inline_attachments: true,
      autosize_comments: false
    }
  };

  BUGZILLA.bug_secure = false;
      </script>
<script nonce="hXy0uqRl2oOFJwsqrHLiFgThhfpY7tIX3XlgRD5W0KlkRBoi" src="/static/v20211025.1/extensions/BugModal/web/autosize.min.js"></script><script nonce="hXy0uqRl2oOFJwsqrHLiFgThhfpY7tIX3XlgRD5W0KlkRBoi" src="/static/v20211025.1/extensions/ProdCompSearch/web/js/prod_comp_search.js"></script><script nonce="hXy0uqRl2oOFJwsqrHLiFgThhfpY7tIX3XlgRD5W0KlkRBoi" src="/static/v20211025.1/extensions/BugModal/web/bug_modal.js"></script><script nonce="hXy0uqRl2oOFJwsqrHLiFgThhfpY7tIX3XlgRD5W0KlkRBoi" src="/static/v20211025.1/extensions/BugModal/web/comments.js"></script><script nonce="hXy0uqRl2oOFJwsqrHLiFgThhfpY7tIX3XlgRD5W0KlkRBoi" src="/static/v20211025.1/extensions/ComponentWatching/web/js/overlay.js"></script><script nonce="hXy0uqRl2oOFJwsqrHLiFgThhfpY7tIX3XlgRD5W0KlkRBoi" src="/static/v20211025.1/js/bugzilla-readable-status-min.js"></script><script nonce="hXy0uqRl2oOFJwsqrHLiFgThhfpY7tIX3XlgRD5W0KlkRBoi" src="/static/v20211025.1/js/field.js"></script><script nonce="hXy0uqRl2oOFJwsqrHLiFgThhfpY7tIX3XlgRD5W0KlkRBoi" src="/static/v20211025.1/js/comments.js"></script><script nonce="hXy0uqRl2oOFJwsqrHLiFgThhfpY7tIX3XlgRD5W0KlkRBoi" src="/static/v20211025.1/extensions/TrackingFlags/web/js/flags.js"></script><script nonce="hXy0uqRl2oOFJwsqrHLiFgThhfpY7tIX3XlgRD5W0KlkRBoi" src="/static/v20211025.1/extensions/BMO/web/js/firefox-crash-table.js"></script><script nonce="hXy0uqRl2oOFJwsqrHLiFgThhfpY7tIX3XlgRD5W0KlkRBoi" src="/static/v20211025.1/extensions/MozChangeField/web/js/severity-s1-priority-p1.js"></script><script nonce="hXy0uqRl2oOFJwsqrHLiFgThhfpY7tIX3XlgRD5W0KlkRBoi" src="/static/v20211025.1/extensions/MozChangeField/web/js/clear-tracking-priority-s1.js"></script><script nonce="hXy0uqRl2oOFJwsqrHLiFgThhfpY7tIX3XlgRD5W0KlkRBoi" src="/static/v20211025.1/extensions/MozChangeField/web/js/set-tracking-severity-s1.js"></script><script nonce="hXy0uqRl2oOFJwsqrHLiFgThhfpY7tIX3XlgRD5W0KlkRBoi" src="/static/v20211025.1/js/lib/prism.js"></script><script nonce="hXy0uqRl2oOFJwsqrHLiFgThhfpY7tIX3XlgRD5W0KlkRBoi" src="/static/v20211025.1/extensions/GoogleAnalytics/web/js/analytics.js"></script><script nonce="hXy0uqRl2oOFJwsqrHLiFgThhfpY7tIX3XlgRD5W0KlkRBoi" src="/static/v20211025.1/js/lib/md5.min.js"></script><script nonce="hXy0uqRl2oOFJwsqrHLiFgThhfpY7tIX3XlgRD5W0KlkRBoi" src="/static/v20211025.1/extensions/Review/web/js/badge.js"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla@Mozilla" href="/search_plugin.cgi"><link rel="shortcut icon" href="/extensions/BMO/web/images/favicon.ico">
<link rel="canonical" href="https://bugzilla.mozilla.org/show_bug.cgi?id=1282076">
<link rel="shorturl" href="https://bugzilla.mozilla.org/1282076"><meta name="google-analytics" content="UA-36116321-3" data-location="https://bugzilla.mozilla.org/bug/show-modal" data-title="1282076 - (CVE-2016-5274) use-after-poison in nsFrameManager::CaptureFrameState">
<script async src="https://www.google-analytics.com/analytics.js"></script><meta name="robots" content="noarchive">
  </head>



  <body
        class="bugzilla-mozilla-org
               skin-standard bug_modal yui-skin-sam">



<div id="wrapper">

<header id="header" role="banner">
  <div class="inner">
    <h1 id="header-title" class="title"><a href="https://bugzilla.mozilla.org/home" title="Go to home page">Bugzilla</a></h1>
    <form role="search" id="header-search" class="quicksearch" action="/buglist.cgi" data-no-csrf>
      <section class="searchbox-outer dropdown" role="combobox" aria-expanded="false" aria-haspopup="listbox"
               aria-labelledby="header-search-label" aria-owns="header-search-dropdown">
        <h2 id="header-search-label">Quick Search</h2>
        <span class="icon" aria-hidden="true"></span>
        <input role="searchbox" id="quicksearch_top" class="dropdown-button" name="quicksearch" autocomplete="off"
               value="" placeholder="Search Bugs"
               title="Enter a bug number or some search terms" aria-controls="header-search-dropdown"
               aria-label="Quick Search"><div id="header-search-dropdown" class="dropdown-content right" role="listbox" style="display: none;">
  <div id="header-search-dropdown-wrapper">
  </div>
</div>
      </section>
    </form>
    <nav id="header-nav">
      <ul class="links">
        <li class="link-browse">
          <a href="/describecomponents.cgi" title="Browse bugs by component">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Browse</span>
          </a>
        </li>
        <li class="link-search">
          <a href="/query.cgi?format=advanced" title="Search bugs using various criteria">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Advanced Search</span>
          </a>
        </li>
      </ul>
      <div class="dropdown">
        <button type="button" id="header-tools-menu-button" class="dropdown-button minor" title="More tools…"
                aria-label="More tools…" aria-expanded="false" aria-haspopup="true" aria-controls="header-tools-menu">
          <span class="icon" aria-hidden="true"></span>
        </button>
        <ul class="dropdown-content left" id="header-tools-menu" role="menu" style="display:none;">
          <li role="presentation">
            <a href="/report.cgi" role="menuitem" tabindex="-1">Reports</a>
          </li>
            <li role="separator"></li>
            <li role="presentation">
              <a href="https://bmo.readthedocs.io/en/latest/" role="menuitem" tabindex="-1">Documentation</a>
            </li>
        </ul>
      </div>
    </nav>
      <ul id="header-login" class="links">
          <li id="moz_new_account_container_top"><a href="/createaccount.cgi">New Account</a></li><li id="mini_login_container_top">
  <a id="login_link_top" href="/index.cgi?GoAheadAndLogIn=1"
     class='show_mini_login_form' data-qs-suffix="_top">Log In</a>

  <div id="mini_login_top" class="mini-popup mini_login bz_default_hidden"><span id="github_mini_login_top" class="mini_login_top">
    <form method="post" action="/github.cgi">
      <input type="hidden" name="github_secret" value="hVfkH0nVSvMbVJbdPb0zJYAZe6TNZxsbLNUrE7rfIYsfuDoqUHZYIOHuQpTDmA1ZAOtG86TLBykczY8TLkQLiBcOrZeKdKhKV31cjCFDVidtpxuc7tMRHaJZGCYoLQEeOzMtBSBAsgAlWR0duVBKdoNbPd6f0WoTSzoHWYQp46UKzevp6ySfe5utDyPZHJ7yZ3MSW0GbEEquWzUnLN8pdduvACVUqP9fysl2sQOFKFtQoxHdWiV5V6rWTkEyAHZf">
      <input type="hidden" name="target_uri" value="https://bugzilla.mozilla.org/show_bug.cgi">
      <input type="image" src="/extensions/GitHubAuth/web/images/sign_in.png" height="22" width="75" align="absmiddle"
             alt="Sign in with GitHub"
             title="Sign in with GitHub"> or
    </form>
  </span>

  <form action="/show_bug.cgi?id=1282076" method="POST"
        data-qs-suffix="_top">

    <input id="Bugzilla_login_top"
           class="bz_login"
           name="Bugzilla_login"
           title="Login"
           placeholder="Email"
           aria-label="Email"
           type="email"
           required
    >
    <input class="bz_password"
           id="Bugzilla_password_top"
           name="Bugzilla_password"
           type="password"
           title="Password"
           placeholder="Password"
           aria-label="Password"
           required
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text"
           id="Bugzilla_password_dummy_top" value="password"
           title="Password"
    >
      <input type="checkbox" id="Bugzilla_remember_top"
             name="Bugzilla_remember" value="on" class="bz_remember"
                 checked>
      <label for="Bugzilla_remember_top">Remember</label>
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
           class="check_mini_login_fields"
            id="log_in_top">
    <a href="#" id="hide_mini_login_top" aria-label="Close"
       class="close-button hide_mini_login_form" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
<li id="forgot_container_top">
  <a id="forgot_link_top" href="/index.cgi?GoAheadAndLogIn=1#forgot"
     class='show_forgot_form'
     data-qs-suffix="_top">Forgot Password</a>
  <div id="forgot_form_top" class="mini-popup mini_forgot bz_default_hidden">
  <form action="/token.cgi" method="post">
    <input type="email" name="loginname" size="20" placeholder="Email" aria-label="Email" required>
    <input id="forgot_button_top" value="Reset Password"
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <input type="hidden" id="token_top" name="token" value="1635622999-qVlIN6YKbIhvW5AQT__E86YyrFd55KU-GKbMWKSQLtU">
    <a href="#" class="close-button hide_forgot_form" aria-label="Close" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
      </ul><div id="header-external-links" class="dropdown first">
  <button type="button" id="header-external-menu-button" class="dropdown-button minor" title="Mozilla"
          aria-label="Mozilla" aria-expanded="false" aria-haspopup="true" aria-controls="header-external-menu">
    <img src="/static/v20211025.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg" width="32" height="32" alt="">
  </button>
  <ul class="dropdown-content right" id="header-external-menu" role="menu" style="display:none;">
    <li role="presentation">
      <a href="https://www.mozilla.org/" role="menuitem" tabindex="-1">Mozilla Home</a>
    </li>
    <li role="separator"></li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/" role="menuitem" tabindex="-1">Privacy</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/#cookies" role="menuitem" tabindex="-1">Cookies</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/about/legal/" role="menuitem" tabindex="-1">Legal</a>
    </li>
  </ul>
</div>
  </div>
</header> 


<main id="bugzilla-body" tabindex="-1">

<aside id="message-container" role="complementary">
  <noscript>
    <div class="noscript">
      <div class="inner">
        <p>Please enable JavaScript in your browser to use all the features on this site.</p>
      </div>
    </div>
  </noscript>
</aside>

<div id="main-inner">




<div role="toolbar" id="page-toolbar">
  <div role="group" class="buttons">
    <button type="button" id="copy-summary" class="secondary"
      title="Copy bug number and summary to your clipboard">Copy Summary</button>
    <div id="clip-container" style="display:none"><input type="text" id="clip"></div>
    <div class="dropdown">
      <button type="button" id="action-menu-btn" aria-haspopup="true" aria-label="View"
        aria-expanded="false" aria-controls="action-menu" class="dropdown-button secondary">View &#9662;</button>
      <ul class="dropdown-content left" id="action-menu" role="menu" style="display:none;">
        <li role="presentation">
          <a id="action-reset" role="menuitem" tabindex="-1">Reset Sections</a>
        </li>
        <li role="presentation">
          <a id="action-expand-all" role="menuitem" tabindex="-1">Expand All Sections</a>
        </li>
        <li role="presentation">
          <a id="action-collapse-all" role="menuitem" tabindex="-1">Collapse All Sections</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a id="action-history" role="menuitem" tabindex="-1">History</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a href="/rest/bug/1282076" role="menuitem" tabindex="-1">JSON</a>
        </li>
        <li role="presentation">
          <a href="/show_bug.cgi?ctype=xml&amp;id=1282076" role="menuitem" tabindex="-1">XML</a>
        </li>
      </ul>
    </div>
  </div>
</div>



<div role="status" id="io-error" style="display:none"></div>
<div role="status" id="floating-message" style="display:none">
  <div id="floating-message-text"></div>
</div>
<section class="module"
>
  <div class="module-content"
  >
  <div id="summary-container">
    <div class="field indent" id="field-status_summary"
>


  
    <div class=" container">
        <span id="field-value-status_summary">
      <span class="bug-status-label text" data-status="closed">Closed</span>
      <span id="field-value-bug_id">
        <a href="/show_bug.cgi?id=1282076">Bug 1282076</a>
          <span class="edit-hide">(CVE-2016-5274)</span>
      </span>
      <span>
        <span class="bug-time-label">Opened <span class="rel-time" title="2016-06-24 07:10 PDT" data-time="1466777448">5 years ago</span></span>
          <span class="bug-time-label">Closed <span class="rel-time" title="2016-07-21 07:42 PDT" data-time="1469112146">5 years ago</span></span>
      </span>
        </span>
    </div>

  
</div>
<div class="field indent edit-hide"
>


  
    <div class=" container">
      

      <h1 id="field-value-short_desc">use-after-poison in ns<wbr>Frame<wbr>Manager::Capture<wbr>Frame<wbr>State</h1>
    </div>

  
</div>

    <div class="field edit-show" id="field-short_desc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc" id="short_desc-help-link" class="help">Summary:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-short_desc">
            use-after-poison in nsFrameManager::CaptureFrameState

        </span>
    </div>

  
</div>
  </div>
  </div>
</section>


<section class="module" id="module-categories"
>
    <header id="module-categories-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Categories section"
           data-label-collapsed="Expand Categories section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-categories-content"
             aria-expanded="true"
             aria-labeledby="module-categories-title"
             aria-describedby="module-categories-subtitle"></div>
        <h2 class="module-title" id="module-categories-title">Categories</h2>
          <h3 class="module-subtitle" id="module-categories-subtitle">
            (Core :: DOM: Animation, defect, P1)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-categories-content"
  ><div class="fields-lhs">

    <div class="field" id="field-product"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=Core" id="product-help-link" class="help">Product:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-product">
      <div class="name-info-outer dropdown">
        <span id="product-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="product-info">Core
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="product-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Product description and actions">
          <header>
            <div class="title">Core</div>
            <div class="description">Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the <a href="https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox">Firefox</a> product. (<a href="https://wiki.mozilla.org/Modules/All#Core">More info</a>)</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=Core&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Product</a></div>
            <div><a href="/enter_bug.cgi?product=Core"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Product</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="Core"
                         data-label-watch="Watch This Product" data-label-unwatch="Unwatch This Product"
                         data-source="BugModal">Watch This Product</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-component"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=Core&component=DOM%3A%20Animation#DOM%3A%20Animation" id="component-help-link" class="help">Component:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-component">
      <div class="name-info-outer dropdown">
        <span id="component-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="component-info">DOM: Animation
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="component-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Component description and actions">
          <header>
            <div class="title">Core :: DOM: Animation</div>
            <div class="description">This component covers the <a href="https://w3c.github.io/web-animations/">Web Animations</a> implementation in Gecko.</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=Core&amp;component=DOM%3A%20Animation&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Component</a></div>
            <div><a href="/buglist.cgi?product=Core&amp;component=DOM%3A%20Animation&amp;chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__"
                    target="_blank" role="menuitem" tabindex="-1">Recently Fixed Bugs in This Component</a></div>
            <div><a href="/enter_bug.cgi?product=Core&amp;component=DOM%3A%20Animation"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Component</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="Core" data-component="DOM: Animation"
                         data-label-watch="Watch This Component" data-label-unwatch="Unwatch This Component"
                         data-source="BugModal">Watch This Component</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-version"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#version" id="version-help-link" class="help">Version:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-version">
            47 Branch

        </span>
    </div>

  
</div>

    <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform" id="-help-link" class="help">Platform:
        </a>
    </div>


  
    <div class=" container"><div class="field inline" id="field-rep_platform"
>


  
    <div class="value">
        <span id="field-value-rep_platform">
            Unspecified

        </span>
    </div>

  
</div><div class="field indent inline" id="field-op_sys"
>


  
    <div class="value">
        <span id="field-value-op_sys">
            Unspecified

        </span>
    </div>

  
</div><div class="field indent inline"
>


  
    <div class=" container">
    </div>

  
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field contains-buttons" id="field-bug_type"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type" id="bug_type-help-link" class="help">Type:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_type">
      <span class="bug-type-label iconic-text" data-type="defect">
        <span class="icon" aria-hidden="true"></span>defect</span>
        </span>
    </div>

  
</div>

    <div class="field" id="field-importance"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority" id="importance-help-link" class="help">Priority:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-importance"><div class="field inline" id="field-priority"
>


  
    <div class="value">
        <span id="field-value-priority">P1
        </span>
    </div>

  
</div><div class="field inline" id="field-bug_severity"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity" id="bug_severity-help-link" class="help">Severity:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_severity">
            normal

        </span>
    </div>

  
</div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-cf_fx_points" style="display:none"
>
    <div class="name">Points:
    </div>


  
    <div class="value">
        <span id="field-value-cf_fx_points">
            ---

        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-tracking"
>
    <header id="module-tracking-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Tracking section"
           data-label-collapsed="Expand Tracking section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-tracking-content"
             aria-expanded="true"
             aria-labeledby="module-tracking-title"
             aria-describedby="module-tracking-subtitle"></div>
        <h2 class="module-title" id="module-tracking-title">Tracking</h2>
          <h3 class="module-subtitle" id="module-tracking-subtitle">
            (<span id="readable-bug-status" data-readable-bug-status="{&quot;cf_status_firefox_esr91&quot;:&quot;---&quot;,&quot;cf_tracking_firefox95&quot;:&quot;---&quot;,&quot;status&quot;:&quot;VERIFIED&quot;,&quot;cf_tracking_firefox_esr45&quot;:&quot;49+&quot;,&quot;cf_a11y_review_project_flag&quot;:&quot;---&quot;,&quot;cf_root_cause&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_esr91&quot;:&quot;---&quot;,&quot;cf_status_firefox49&quot;:&quot;verified&quot;,&quot;cf_status_firefox47&quot;:&quot;wontfix&quot;,&quot;cf_status_firefox95&quot;:&quot;---&quot;,&quot;cf_status_firefox48&quot;:&quot;wontfix&quot;,&quot;cf_tracking_firefox49&quot;:&quot;+&quot;,&quot;cf_status_firefox50&quot;:&quot;verified&quot;,&quot;cf_status_firefox_esr45&quot;:&quot;verified&quot;,&quot;cf_status_thunderbird_esr91&quot;:&quot;---&quot;,&quot;target_milestone&quot;:&quot;mozilla50&quot;,&quot;resolution&quot;:&quot;FIXED&quot;,&quot;cf_tracking_firefox93&quot;:&quot;---&quot;,&quot;cf_tracking_firefox48&quot;:&quot;+&quot;,&quot;cf_tracking_firefox_esr78&quot;:&quot;---&quot;,&quot;priority&quot;:&quot;P1&quot;,&quot;id&quot;:1282076,&quot;cf_status_thunderbird_esr78&quot;:&quot;---&quot;,&quot;cf_tracking_firefox94&quot;:&quot;---&quot;,&quot;dupe_of&quot;:null,&quot;cf_tracking_thunderbird_esr91&quot;:&quot;---&quot;,&quot;cf_status_firefox_esr78&quot;:&quot;---&quot;,&quot;keywords&quot;:[&quot;crash&quot;,&quot;csectype-uaf&quot;,&quot;regression&quot;,&quot;sec-high&quot;,&quot;testcase&quot;],&quot;cf_webcompat_priority&quot;:&quot;---&quot;,&quot;flags&quot;:[{&quot;name&quot;:&quot;sec-bounty&quot;,&quot;status&quot;:&quot;+&quot;},{&quot;name&quot;:&quot;in-testsuite&quot;,&quot;status&quot;:&quot;+&quot;},{&quot;status&quot;:&quot;+&quot;,&quot;name&quot;:&quot;qe-verify&quot;}],&quot;cf_tracking_firefox_sumo&quot;:&quot;---&quot;,&quot;cf_status_firefox93&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_relnote&quot;:&quot;---&quot;,&quot;cf_tracking_firefox47&quot;:&quot;+&quot;,&quot;cf_tracking_firefox50&quot;:&quot;+&quot;,&quot;cf_fission_milestone&quot;:&quot;---&quot;,&quot;cf_tracking_thunderbird_esr78&quot;:&quot;---&quot;,&quot;cf_status_firefox94&quot;:&quot;---&quot;}"></span>)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-tracking-content"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-status-view"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-view-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-view">VERIFIED
        FIXED
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-status-edit" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-edit-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-edit"><div class="field inline" id="field-bug_status"
>


  
    <div class="value">
        <span id="field-value-bug_status">
            VERIFIED

        </span>
    </div>

  
</div><div class="field indent inline" id="field-resolution"
>


  
    <div class="value">
        <span id="field-value-resolution">
            FIXED

        </span>
    </div>

  
</div>
  <div id="status-action-buttons">
      <div id="assigned-container" style="display:none">
        <button type="button" class="secondary" id="mark-as-assigned-btn">
          Mark as Assigned
        </button>
      </div>
  </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-target_milestone"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone" id="target_milestone-help-link" class="help">Milestone:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-target_milestone">
            mozilla50

        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-cf_fx_iteration" style="display:none"
>
    <div class="name">Iteration:
    </div>


  
    <div class="value">
        <span id="field-value-cf_fx_iteration">
            ---

        </span>
    </div>

  
</div>


      <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Project Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <td class="tracking-flag-name">Webcompat Priority</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_webcompat_priority-dirty">
  <select id="cf_webcompat_priority" name="cf_webcompat_priority">
        <option value="---"
          id="v4274_cf_webcompat_priority" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Root Cause</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_root_cause-dirty">
  <select id="cf_root_cause" name="cf_root_cause">
        <option value="---"
          id="v4701_cf_root_cause" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">a11y-review</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_a11y_review_project_flag-dirty">
  <select id="cf_a11y_review_project_flag" name="cf_a11y_review_project_flag">
        <option value="---"
          id="v4876_cf_a11y_review_project_flag" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">user-doc-firefox</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_sumo-dirty">
  <select id="cf_tracking_firefox_sumo" name="cf_tracking_firefox_sumo">
        <option value="---"
          id="v4660_cf_tracking_firefox_sumo" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Fission Milestone</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_fission_milestone-dirty">
  <select id="cf_fission_milestone" name="cf_fission_milestone">
        <option value="---"
          id="v4222_cf_fission_milestone" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

      <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Tracking Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-hide">
    <table class="layout-table tracking-flags">
        <tr>
          <th></th>
          <th>Tracking</th>
          <th>Status</th>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox47</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox47&amp;o1=equals&amp;v1=%2B">+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox47&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox48</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox48&amp;o1=equals&amp;v1=%2B">+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox48&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox49</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox49&amp;o1=equals&amp;v1=%2B">+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox49&amp;o1=equals&amp;v1=verified">verified</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox-esr45</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox_esr45&amp;o1=equals&amp;v1=49%2B">49+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=equals&amp;v1=verified">verified</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox50</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox50&amp;o1=equals&amp;v1=%2B">+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox50&amp;o1=equals&amp;v1=verified">verified</a>
          </td>
        </tr>
    </table>
  </div>


<div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <th></th>
        <th>Tracking</th>
        <th>Status</th>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox47</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox47-dirty">
  <select id="cf_tracking_firefox47" name="cf_tracking_firefox47">
        <option value="+"
          id="v2603_cf_tracking_firefox47" selected
        >+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox47-dirty">
  <select id="cf_status_firefox47" name="cf_status_firefox47">
        <option value="wontfix"
          id="v2611_cf_status_firefox47" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox48</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox48-dirty">
  <select id="cf_tracking_firefox48" name="cf_tracking_firefox48">
        <option value="+"
          id="v2669_cf_tracking_firefox48" selected
        >+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox48-dirty">
  <select id="cf_status_firefox48" name="cf_status_firefox48">
        <option value="wontfix"
          id="v2677_cf_status_firefox48" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox49</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox49-dirty">
  <select id="cf_tracking_firefox49" name="cf_tracking_firefox49">
        <option value="+"
          id="v2778_cf_tracking_firefox49" selected
        >+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox49-dirty">
  <select id="cf_status_firefox49" name="cf_status_firefox49">
        <option value="verified"
          id="v2787_cf_status_firefox49" selected
        >verified
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr45</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr45-dirty">
  <select id="cf_tracking_firefox_esr45" name="cf_tracking_firefox_esr45">
        <option value="49+"
          id="v2628_cf_tracking_firefox_esr45" selected
        >49+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr45-dirty">
  <select id="cf_status_firefox_esr45" name="cf_status_firefox_esr45">
        <option value="verified"
          id="v2549_cf_status_firefox_esr45" selected
        >verified
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">relnote-firefox</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_relnote-dirty">
  <select id="cf_tracking_firefox_relnote" name="cf_tracking_firefox_relnote">
        <option value="---"
          id="v539_cf_tracking_firefox_relnote" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr78-dirty">
  <select id="cf_tracking_thunderbird_esr78" name="cf_tracking_thunderbird_esr78">
        <option value="---"
          id="v4823_cf_tracking_thunderbird_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr78-dirty">
  <select id="cf_status_thunderbird_esr78" name="cf_status_thunderbird_esr78">
        <option value="---"
          id="v4829_cf_status_thunderbird_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr91-dirty">
  <select id="cf_tracking_thunderbird_esr91" name="cf_tracking_thunderbird_esr91">
        <option value="---"
          id="v5236_cf_tracking_thunderbird_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr91-dirty">
  <select id="cf_status_thunderbird_esr91" name="cf_status_thunderbird_esr91">
        <option value="---"
          id="v5242_cf_status_thunderbird_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox50</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox50-dirty">
  <select id="cf_tracking_firefox50" name="cf_tracking_firefox50">
        <option value="+"
          id="v2833_cf_tracking_firefox50" selected
        >+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox50-dirty">
  <select id="cf_status_firefox50" name="cf_status_firefox50">
        <option value="verified"
          id="v2842_cf_status_firefox50" selected
        >verified
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr78-dirty">
  <select id="cf_tracking_firefox_esr78" name="cf_tracking_firefox_esr78">
        <option value="---"
          id="v4808_cf_tracking_firefox_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr78-dirty">
  <select id="cf_status_firefox_esr78" name="cf_status_firefox_esr78">
        <option value="---"
          id="v4813_cf_status_firefox_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr91-dirty">
  <select id="cf_tracking_firefox_esr91" name="cf_tracking_firefox_esr91">
        <option value="---"
          id="v5194_cf_tracking_firefox_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr91-dirty">
  <select id="cf_status_firefox_esr91" name="cf_status_firefox_esr91">
        <option value="---"
          id="v5199_cf_status_firefox_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox93</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox93-dirty">
  <select id="cf_tracking_firefox93" name="cf_tracking_firefox93">
        <option value="---"
          id="v5266_cf_tracking_firefox93" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox93-dirty">
  <select id="cf_status_firefox93" name="cf_status_firefox93">
        <option value="---"
          id="v5271_cf_status_firefox93" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox94</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox94-dirty">
  <select id="cf_tracking_firefox94" name="cf_tracking_firefox94">
        <option value="---"
          id="v5284_cf_tracking_firefox94" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox94-dirty">
  <select id="cf_status_firefox94" name="cf_status_firefox94">
        <option value="---"
          id="v5289_cf_status_firefox94" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox95</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox95-dirty">
  <select id="cf_tracking_firefox95" name="cf_tracking_firefox95">
        <option value="---"
          id="v5311_cf_tracking_firefox95" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox95-dirty">
  <select id="cf_status_firefox95" name="cf_status_firefox95">
        <option value="---"
          id="v5316_cf_status_firefox95" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>

</div>
  </div>
</section>



<section class="module" id="module-people"
>
    <header id="module-people-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse People section"
           data-label-collapsed="Expand People section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-people-content"
             aria-expanded="false"
             aria-labeledby="module-people-title"
             aria-describedby="module-people-subtitle"></div>
        <h2 class="module-title" id="module-people-title">People</h2>
          <h3 class="module-subtitle" id="module-people-subtitle">
            (Reporter: nils, Assigned: hiro)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-people-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-assigned_to"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to"><div class="vcard vcard_131213" ><img src="https://secure.gravatar.com/avatar/9ec516861853d265a973cd0ef66735cf?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=131213" > <span class="fna">hiro</span></a>
</div>
        </span>
    </div>

  
</div><div class="field edit-show" id="field-assigned_to" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-assignee" name="set_default_assignee" class="set-default"
          value="1" data-for="assigned_to">
        <label for="set-default-assignee">Reset Assignee to default</label>
      </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-bug_mentors" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor" id="bug_mentors-help-link" class="help">Mentors:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_mentors">---
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-qa_contact" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact" id="qa_contact-help-link" class="help">QA Contact:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-qa_contact">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-qa-contact" name="set_default_qa_contact" class="set-default"
          value="1" data-for="qa_contact">
        <label for="set-default-qa-contact">Reset QA Contact to default</label>
      </div>
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-reporter"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter" id="reporter-help-link" class="help">Reporter:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-reporter">
            <div class="vcard vcard_344130" ><img src="https://secure.gravatar.com/avatar/1ac8e01cc88bca015e51fbd49a0b2df5?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=344130" > <span class="fna">nils</span></a>
</div>

        </span>
    </div>

  
</div>

    <div class="field" id="field-triage_owner"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner" id="triage_owner-help-link" class="help">Triage Owner:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-triage_owner">
            <div class="vcard vcard_500786" ><img src="https://secure.gravatar.com/avatar/8a1a07330c4b233b669577673bc47748?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=500786" > <span class="fna">boris</span></a>
</div>

        </span>
    </div>

  
</div>

    

    <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc" id="-help-link" class="help">CC:
        </a>
    </div>


  
    <div class=" container">


        <span aria-owns="cc-summary cc-latch">
          <span role="button" tabindex="0" id="cc-summary" data-count="19">19 people
          </span>
        </span>


        <div id="cc-list" style="display:none"></div>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-references"
>
    <header id="module-references-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse References section"
           data-label-collapsed="Expand References section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-references-content"
             aria-expanded="false"
             aria-labeledby="module-references-title"
             aria-describedby="module-references-subtitle"></div>
        <h2 class="module-title" id="module-references-title">References</h2>
      </div>
    </header>
  <div class="module-content" id="module-references-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field bug-list edit-show" id="field-dependson" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson" id="dependson-help-link" class="help">Depends on:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-dependson">
        ---
        </span>
    </div>

  
</div><div class="field bug-list" id="field-blocked"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks" id="blocked-help-link" class="help">Blocks:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-blocked">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Heap-use-after-free in nsFrame::DidSetStyleContext"
   href="/show_bug.cgi?id=1181011">1181011</a>, <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - nsAnimationManager::CheckAnimationRule should not create temporary animations"
   href="/show_bug.cgi?id=1242872">1242872</a>
      </div>

        </span>
    </div>

  
</div><div class="field" id="field-dependencytree"
>
    <div class="name">
    </div>


  
    <div class=" container">
        <span id="field-value-dependencytree">
        Dependency <a href="/showdependencytree.cgi?id=1282076&amp;hide_resolved=1">tree</a>
        / <a href="/showdependencygraph.cgi?id=1282076">graph</a>
        </span>
    </div>

  
</div>

    <div class="field bug-list edit-show" id="field-regresses" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses" id="regresses-help-link" class="help">Regressions:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regresses">
        ---
        </span>
    </div>

  
</div><div class="field bug-list edit-show" id="field-regressed_by" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by" id="regressed_by-help-link" class="help">Regressed by:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regressed_by">
        ---
        </span>
    </div>

  
</div>

    
</div><div class="fields-rhs">

    <div class="field edit-show" id="field-bug_file_loc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc" id="bug_file_loc-help-link" class="help">URL:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_file_loc"><div class="link">
    <a href="" target="_blank"
      rel="noreferrer" title=""
      class="bug-url" data-safe="0"></a>
  </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-see_also" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also" id="see_also-help-link" class="help">See Also:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-see_also">
        ---
        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-details"
>
    <header id="module-details-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Details section"
           data-label-collapsed="Expand Details section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-details-content"
             aria-expanded="false"
             aria-labeledby="module-details-title"
             aria-describedby="module-details-subtitle"></div>
        <h2 class="module-title" id="module-details-title">Details</h2>
          <h3 class="module-subtitle" id="module-details-subtitle">
            (5 keywords, Whiteboard: [adv-main49+][adv-esr45.4+])
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-details-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-show" id="field-alias" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias" id="alias-help-link" class="help">Alias:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-alias">
            CVE-2016-5274

        </span>
    </div>

  
</div>

    <div class="field" id="field-keywords"
>
    <div class="name">
        <a href="/describekeywords.cgi" id="keywords-help-link" class="help">Keywords:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-keywords">
          <a href="/buglist.cgi?keywords=crash&amp;resolution=---">crash</a>, 
          <a href="/buglist.cgi?keywords=csectype-uaf&amp;resolution=---">csectype-uaf</a>, 
          <a href="/buglist.cgi?keywords=regression&amp;resolution=---">regression</a>, 
          <a href="/buglist.cgi?keywords=sec-high&amp;resolution=---">sec-high</a>, 
          <a href="/buglist.cgi?keywords=testcase&amp;resolution=---">testcase</a>
        </span>
    </div>

  
</div>

    <div class="field" id="field-status_whiteboard"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/Whiteboard" id="status_whiteboard-help-link" class="help">Whiteboard:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-status_whiteboard">[adv-main49+][adv-esr45.4+]
        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_qa_whiteboard" style="display:none"
>
    <div class="name">QA Whiteboard:
    </div>


  
    <div class="value">
        <span id="field-value-cf_qa_whiteboard">
        ---
        </span>
    </div>

  
</div>

    

    <div class="field edit-show" id="field-cf_has_regression_range" style="display:none"
>
    <div class="name">Has Regression Range:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_regression_range">
            ---

        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_has_str" style="display:none"
>
    <div class="name">Has STR:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_str">
            ---

        </span>
    </div>

  
</div>

    <div class="field" id="field-votes"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes" id="votes-help-link" class="help">Votes:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-votes">0
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-bug_flags"
>
    <div class="name">Bug Flags:
    </div>


  
    <div class=" container">
        <span id="field-value-bug_flags"><div id="bug-flags" class="flags">
  <table class="layout-table">
          <tbody class="edit-hide"><tr>
    <td class="flag-setter"><div class="vcard vcard_1689" ><a class="email " href="/user_profile?user_id=1689" > <span class="fna">dveditz</span></a>
</div>
    </td>

    <td class="flag-name">
        <a href="#a3900541_1689"
            class="rel-time-title activity-ref"
            title="5 years ago"
        data-time="1470175337"
      >sec-bounty</a>
    </td>

    <td class="flag-value">+
    </td>

  </tr>
          </tbody>
          <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter"><div class="vcard vcard_1689" ><a class="email " href="/user_profile?user_id=1689" > <span class="fna">dveditz</span></a>
</div>
    </td>

    <td class="flag-name">
      <label title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug." for="flag-1432836">sec-bounty</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag-1432836-dirty">
      <select id="flag-1432836" name="flag-1432836"
        title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug."
        class="bug-flag">
            <option value="+" selected>+</option>
      </select>
    </td>


  </tr>
          </tbody>
          <tbody class="edit-hide"><tr>
    <td class="flag-setter"><div class="vcard vcard_277293" ><a class="email disabled" href="/user_profile?user_id=277293" > <span class="fna">cbook</span></a>
</div>
    </td>

    <td class="flag-name">
        <a href="#c57"
            class="rel-time-title activity-ref"
            title="5 years ago"
        data-time="1467312131"
      >in-testsuite</a>
    </td>

    <td class="flag-value">+
    </td>

  </tr>
          </tbody>
          <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter"><div class="vcard vcard_277293" ><a class="email disabled" href="/user_profile?user_id=277293" > <span class="fna">cbook</span></a>
</div>
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag-1416880">in-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag-1416880-dirty">
      <select id="flag-1416880" name="flag-1416880"
        title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" selected>+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr>
          </tbody>
          <tbody class="edit-hide"><tr>
    <td class="flag-setter"><div class="vcard vcard_488993" ><a class="email " href="/user_profile?user_id=488993" > <span class="fna">avaida</span></a>
</div>
    </td>

    <td class="flag-name">
        <a href="#a6374325_488993"
            class="rel-time-title activity-ref"
            title="5 years ago"
        data-time="1473151773"
      >qe-verify</a>
    </td>

    <td class="flag-value">+
    </td>

  </tr>
          </tbody>
          <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter"><div class="vcard vcard_488993" ><a class="email " href="/user_profile?user_id=488993" > <span class="fna">avaida</span></a>
</div>
    </td>

    <td class="flag-name">
      <label title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually" for="flag-1450825">qe-verify</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag-1450825-dirty">
      <select id="flag-1450825" name="flag-1450825"
        title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually"
          disabled
        class="bug-flag">
            <option value="+" selected>+</option>
      </select>
    </td>


  </tr>
          </tbody>
    <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?" for="flag_type-930">behind-pref</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-930-dirty">
      <select id="flag_type-930" name="flag_type-930"
        title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?"
        class="bug-flag">
          <option value="X"></option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag tracking inclusion in the desktop Firefox product backlog." for="flag_type-846">firefox-backlog</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-846-dirty">
      <select id="flag_type-846" name="flag_type-846"
        title="Flag tracking inclusion in the desktop Firefox product backlog."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame." for="flag_type-913">sec-bounty-hof</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-913-dirty">
      <select id="flag_type-913" name="flag_type-913"
        title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-787">in-qa-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-787-dirty">
      <select id="flag_type-787" name="flag_type-787"
        title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>

      <td class="flag-requestee">
        <div id="requestee_type-787-container" style="display:none"><input
    name="requestee_type-787"
    value="" class="requestee bz_autocomplete_user"  id="requestee_type-787" 
  >
        </div>
      <td>

  </tr>
    </tbody>
  </table>
</div>
        </span>
    </div>

  
</div>
</div>

  
  </div>
</section>


<section class="module" id="module-crash-data"
>
    <header id="module-crash-data-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Crash Data section"
           data-label-collapsed="Expand Crash Data section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-crash-data-content"
             aria-expanded="false"
             aria-labeledby="module-crash-data-title"
             aria-describedby="module-crash-data-subtitle"></div>
        <h2 class="module-title" id="module-crash-data-title">Crash Data</h2>
      </div>
    </header>
  <div class="module-content" id="module-crash-data-content" style="display:none"
  ><div class="field" id="field-cf_crash_signature"
>
    <div class="name">Signature:
    </div>


  
    <div class="value">
        <span id="field-value-cf_crash_signature">
      <div>
          <a href="https://crash-stats.mozilla.org/signature/?signature=nsFrameManager%3A%3ACaptureFrameState" target="_blank" rel="noopener noreferrer">
            [@ nsFrameManager::CaptureFrameState ]
          </a>
      </div>
    
      <iframe src="https://bugzilla.mozilla.org/page.cgi?id=socorro-lens.html&amp;s=nsFrameManager%3A%3ACaptureFrameState" style="border:0; width:300px; height:200px; max-width:600px; max-height:300px; float:left;" id="chart" scrolling="no"></iframe>
        </span>
    </div>

  
</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-security"
>
    <header id="module-security-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Security section"
           data-label-collapsed="Expand Security section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-security-content"
             aria-expanded="false"
             aria-labeledby="module-security-title"
             aria-describedby="module-security-subtitle"></div>
        <h2 class="module-title" id="module-security-title">Security</h2>
          <h3 class="module-subtitle" id="module-security-subtitle">
            (public)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-security-content" style="display:none"
  ><div class="groups edit-hide">
    This bug is publicly visible.
</div>

<div class="groups edit-show" style="display:none">


</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-user-story" data-non-stick="1"
>
    <header id="module-user-story-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse User Story section"
           data-label-collapsed="Expand User Story section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-user-story-content"
             aria-expanded="false"
             aria-labeledby="module-user-story-title"
             aria-describedby="module-user-story-subtitle"></div>
        <h2 class="module-title" id="module-user-story-title">User Story</h2>
      </div>
    </header>
  <div class="module-content" id="module-user-story-content" style="display:none"
  >
    <pre id="user-story"></pre>
  </div>
</section>







<section class="module" id="module-attachments"
>
    <header id="module-attachments-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Attachments section"
           data-label-collapsed="Expand Attachments section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-attachments-content"
             aria-expanded="true"
             aria-labeledby="module-attachments-title"
             aria-describedby="module-attachments-subtitle"></div>
        <h2 class="module-title" id="module-attachments-title">Attachments</h2>
          <h3 class="module-subtitle" id="module-attachments-subtitle">
            (3 files, 4 obsolete files)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-attachments-content"
  ><table role="table" class="layout-table" id="attachments">
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8767517">Web animations' test case</a>
        </div>
        <div>
            <a href="#c5" class="attach-time activity-ref"><span class="rel-time" title="2016-07-03 14:40 PDT" data-time="1467582044">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_131213" ><a class="email " href="/user_profile?user_id=131213" > <span class="fna">Hiroyuki Ikezoe (:hiro)</span></a>
</div></span>
        </div>
        <div class="attach-info">1.63 KB,
          text/html        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8767517&amp;action=edit">Details</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8768286">Force to call RequestRestyle when we have animations inside an pseudo element</a>
        </div>
        <div>
            <a href="#c11" class="attach-time activity-ref"><span class="rel-time" title="2016-07-05 23:16 PDT" data-time="1467785808">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_131213" ><a class="email " href="/user_profile?user_id=131213" > <span class="fna">Hiroyuki Ikezoe (:hiro)</span></a>
</div></span>
        </div>
        <div class="attach-info">1.62 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_54040" ><span class="fn">heycam</span>
</div>:
              <a href="#c15"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1468194941"
            >
              review-</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8768286&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8768286&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1282076&attachment=8768286">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8771809">Store the struct on the style context when we find the struct in cache inside WalkRuleTree</a>
        </div>
        <div>
            <a href="#c26" class="attach-time activity-ref"><span class="rel-time" title="2016-07-17 17:12 PDT" data-time="1468800741">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_131213" ><a class="email " href="/user_profile?user_id=131213" > <span class="fna">Hiroyuki Ikezoe (:hiro)</span></a>
</div></span>
        </div>
        <div class="attach-info">1.45 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8771809&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8771809&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1282076&attachment=8771809">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8772596">Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data</a>
        </div>
        <div>
            <a href="#c31" class="attach-time activity-ref"><span class="rel-time" title="2016-07-19 15:08 PDT" data-time="1468966112">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_131213" ><a class="email " href="/user_profile?user_id=131213" > <span class="fna">Hiroyuki Ikezoe (:hiro)</span></a>
</div></span>
        </div>
        <div class="attach-info">4.40 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_54040" ><span class="fn">heycam</span>
</div>:
              <a href="#c32"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1468966112"
            >
              review-</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8772596&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8772596&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1282076&attachment=8772596">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8772662">Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data</a>
        </div>
        <div>
            <a href="#c34" class="attach-time activity-ref"><span class="rel-time" title="2016-07-19 20:03 PDT" data-time="1468983787">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_131213" ><a class="email " href="/user_profile?user_id=131213" > <span class="fna">Hiroyuki Ikezoe (:hiro)</span></a>
</div></span>
        </div>
        <div class="attach-info">8.00 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_54040" ><span class="fn">heycam</span>
</div>:
              <a href="#c35"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1468983787"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8772662&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8772662&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1282076&attachment=8772662">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8772704">Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data</a>
        </div>
        <div>
            <a href="#c37" class="attach-time activity-ref"><span class="rel-time" title="2016-07-19 23:29 PDT" data-time="1468996174">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_131213" ><a class="email " href="/user_profile?user_id=131213" > <span class="fna">Hiroyuki Ikezoe (:hiro)</span></a>
</div></span>
        </div>
        <div class="attach-info">7.71 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_131213" ><span class="fn">hiro</span>
</div>:
              <a href="#c37"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1468996174"
            >
              review+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_280903" ><span class="fn">abillings</span>
</div>:
              <a href="#a2361133_280903"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1469070351"
            >
              approval-mozilla-aurora+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_495955" ><span class="fn">Sylvestre</span>
</div>:
              <a href="#c51"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1472466044"
            >
              approval-mozilla-esr45+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_280903" ><span class="fn">abillings</span>
</div>:
              <a href="#c40"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1468996174"
            >
              sec-approval+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8772704&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8772704&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1282076&attachment=8772704">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8793634">Crash tests</a>
        </div>
        <div>
            <a href="#c54" class="attach-time activity-ref"><span class="rel-time" title="2016-09-21 23:46 PDT" data-time="1474526781">5 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_131213" ><a class="email " href="/user_profile?user_id=131213" > <span class="fna">Hiroyuki Ikezoe (:hiro)</span></a>
</div></span>
        </div>
        <div class="attach-info">4.59 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_54040" ><span class="fn">heycam</span>
</div>:
              <a href="#c55"
                  class="flag-name-status rel-time-title activity-ref"
                  title="5 years ago"
              data-time="1474526781"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8793634&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8793634&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1282076&attachment=8793634">Splinter Review</a>
    </tr>
</table>

<footer id="attachments-footer">
  <div id="attachments-actions">
      <button type="button" id="attachments-obsolete-btn" class="secondary">Show Obsolete</button>
  </div>
  
</footer>
  </div>
</section>



<script nonce="hXy0uqRl2oOFJwsqrHLiFgThhfpY7tIX3XlgRD5W0KlkRBoi">
  init_module_visibility();
</script>



<meta name="firefox-versions" content="{&quot;FIREFOX_AURORA&quot;:&quot;&quot;,&quot;FIREFOX_DEVEDITION&quot;:&quot;94.0b9&quot;,&quot;FIREFOX_ESR&quot;:&quot;78.15.0esr&quot;,&quot;FIREFOX_ESR_NEXT&quot;:&quot;91.2.0esr&quot;,&quot;FIREFOX_NIGHTLY&quot;:&quot;95.0a1&quot;,&quot;FIREFOX_PINEBUILD&quot;:&quot;&quot;,&quot;LAST_MERGE_DATE&quot;:&quot;2021-10-04&quot;,&quot;LAST_RELEASE_DATE&quot;:&quot;2021-10-05&quot;,&quot;LAST_SOFTFREEZE_DATE&quot;:&quot;2021-09-30&quot;,&quot;LATEST_FIREFOX_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_OLDER_VERSION&quot;:&quot;3.6.28&quot;,&quot;LATEST_FIREFOX_RELEASED_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_VERSION&quot;:&quot;93.0&quot;,&quot;NEXT_MERGE_DATE&quot;:&quot;2021-11-01&quot;,&quot;NEXT_RELEASE_DATE&quot;:&quot;2021-11-02&quot;,&quot;NEXT_SOFTFREEZE_DATE&quot;:&quot;2021-10-28&quot;}">


<div id="comment-actions">
    <button type="button" id="bottom-btn" class="secondary" aria-label="Go to Page Bottom">Bottom &darr;</button>
  <div class="dropdown">
    <button type="button" id="comment-tags-btn" aria-haspopup="true" aria-label="Tags"
      aria-expanded="false" aria-controls="comment-tags-menu" class="dropdown-button minor">Tags &#9662;</button>
    <ul id="comment-tags-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a role="menuitem" tabindex="-1" data-comment-tag="">Reset</a>
      </li>
    </ul>
  </div>
  <div class="dropdown">
    <button type="button" id="view-menu-btn" aria-haspopup="true" aria-label="Timeline"
      aria-expanded="false" aria-controls="view-menu" class="dropdown-button minor">Timeline &#9662;</button>
    <ul id="view-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a id="view-reset" role="menuitem" tabindex="-1">Reset</a>
      </li>
      <li role="separator"></li>
      <li role="presentation">
        <a id="view-collapse-all" role="menuitem" tabindex="-1">Collapse All</a>
      </li>
      <li role="presentation">
        <a id="view-expand-all" role="menuitem" tabindex="-1">Expand All</a>
      </li>
      <li role="presentation">
        <a id="view-comments-only" role="menuitem" tabindex="-1">Comments Only</a>
      </li>
    </ul>
   </div>
</div>
<div class="change-set" id="c0"><div class="comment" data-id="11500642" data-no="0"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-0" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_344130" ><img src="https://secure.gravatar.com/avatar/1ac8e01cc88bca015e51fbd49a0b2df5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_344130" ><a class="email " href="/user_profile?user_id=344130" > <span class="fna">Nils</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-0"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-0" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c0">Description</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-24 07:10 PDT" data-time="1466777448">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-0">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-0" data-comment-id="11500642">The testcase crashes the latest Firefox ASAN build (BuildID=20160624030212) as follows:

&lt;script&gt;
function start() {
        o0=document;
        o24=document.createElement('table');
        o35=window;
        o60=document.createElement('input');
        o24.appendChild(o60);
        o62=document.body;
        o66=document.createElement('input');
        o62.appendChild(o66);
        o60.innerHTML=&quot;&lt;svg&gt;&lt;color-profile&gt;&lt;script&gt;&lt;rect&gt;&lt;animateColor&gt;&lt;style&gt;&lt;style&gt;*{ all: unset&lt;script&gt;&lt;style&gt;div&lt;style&gt;&quot;;
        o93=o60.querySelectorAll('*')[5];
        o97=o60.querySelectorAll('*')[9];
        document.body.appendChild(o24);
        o305=document.createTextNode(&quot;{}:first-line{&quot;);
        o93.appendChild(o305);
        o318=(new DOMParser()).parseFromString('','text/html');
        o320=o318.all[1];
        o355=document.createElement('style');
        o356=document.createTextNode(&quot;&#64;keyframes key2{ from{ box-shadow: none}}#id2{ animation-name: key2; animation-duration: 0.01s&quot;);
        o355.appendChild(o356);
        o97.appendChild(o355);
        o66.style.display='list-item';
        o473=document.createElement('script');
        o24.appendChild(o473);
        o577=document.createElement('style');
        o320.appendChild(o577);
        o577.style.position='fixed';
        document.replaceChild(o318.documentElement,document.documentElement);
        o908=(new DOMParser()).parseFromString('','text/html');
        o911=o908.all[2];
        o911.style.display='inline';
        o577.id='id2';
        o1202=document.createElement('table');
        document.body=o911;
        document.body.appendChild(o1202);
        document.replaceChild(o0.documentElement,document.documentElement);
        o1232=o473.parentNode;
        o1233=o1232.parentNode;
        document.body=o1233;
        o35.scrollByLines(1);
        o577.style.position='absolute';
        setTimeout(f2, 4);
}
function f2() {
        o0.designMode='on';
        o0.execCommand('insertparagraph',false,null);
}
&lt;/script&gt;
&lt;body onload=&quot;start()&quot;&gt;&lt;/body&gt;


ASAN ouput:

=================================================================
==30757==ERROR: AddressSanitizer: use-after-poison on address 0x6250002eab58 at pc 0x7fcd17c53104 bp 0x7ffc2eca31b0 sp 0x7ffc2eca31a8
READ of size 8 at 0x6250002eab58 thread T0 (Web Content)
    #0 0x7fcd17c53103 in GetStateBits /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/layout/generic/nsIFrame.h:1565:46
    #1 0x7fcd17c53103 in nsFrameManager::CaptureFrameState(nsIFrame*, nsILayoutHistoryState*) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/layout/base/nsFrameManager.cpp:580
    #2 0x7fcd17aa8070 in CaptureStateForFramesOf /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/layout/base/nsCSSFrameConstructor.cpp:9144:5
    #3 0x7fcd17aa8070 in nsCSSFrameConstructor::RecreateFramesForContent(nsIContent*, bool, nsCSSFrameConstructor::RemoveFlags, nsIContent**) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/layout/base/nsCSSFrameConstructor.cpp:9563
    #4 0x7fcd17aa8d23 in mozilla::RestyleManager::RestyleElement(mozilla::dom::Element*, nsIFrame*, nsChangeHint, mozilla::RestyleTracker&amp;, nsRestyleHint, mozilla::RestyleHintData const&amp;) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/layout/base/RestyleManager.cpp:1077:5
    #5 0x7fcd17ac8d0f in ProcessOneRestyle /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/layout/base/RestyleTracker.cpp:94:5
    #6 0x7fcd17ac8d0f in mozilla::RestyleTracker::DoProcessRestyles() /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/layout/base/RestyleTracker.cpp:262
    #7 0x7fcd17ab03af in ProcessRestyles /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/obj-firefox/dist/include/mozilla/RestyleManager.h:536:7
    #8 0x7fcd17ab03af in mozilla::RestyleManager::ProcessPendingRestyles() /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/layout/base/RestyleManager.cpp:1807
    #9 0x7fcd17cdb6ca in ProcessPendingRestyles /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/obj-firefox/dist/include/mozilla/RestyleManagerHandleInlines.h:74:3
    #10 0x7fcd17cdb6ca in PresShell::FlushPendingNotifications(mozilla::ChangesToFlush) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/layout/base/nsPresShell.cpp:4119
    #11 0x7fcd138be6be in nsDocument::FlushPendingNotifications(mozFlushType) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/dom/base/nsDocument.cpp:8393:7
    #12 0x7fcd177eee46 in nsComputedDOMStyle::UpdateCurrentStyleSources(bool) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/layout/style/nsComputedDOMStyle.cpp:633:3
    #13 0x7fcd177f005b in nsComputedDOMStyle::GetPropertyCSSValue(nsAString_internal const&amp;, mozilla::ErrorResult&amp;) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/layout/style/nsComputedDOMStyle.cpp:796:3
    #14 0x7fcd177ee507 in nsComputedDOMStyle::GetPropertyValue(nsAString_internal const&amp;, nsAString_internal&amp;) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/layout/style/nsComputedDOMStyle.cpp:379:26
    #15 0x7fcd17500cde in nsHTMLCSSUtils::GetCSSInlinePropertyBase(nsINode*, nsIAtom*, nsAString_internal&amp;, nsHTMLCSSUtils::StyleType) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/editor/libeditor/nsHTMLCSSUtils.cpp:511:5
    #16 0x7fcd174e9e89 in GetComputedProperty /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/editor/libeditor/nsHTMLCSSUtils.cpp:491:10
    #17 0x7fcd174e9e89 in nsHTMLEditor::GetAbsolutelyPositionedSelectionContainer(nsIDOMElement**) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/editor/libeditor/nsHTMLAbsPosition.cpp:91
    #18 0x7fcd174f4486 in nsHTMLEditor::CheckSelectionStateForAnonymousButtons(nsISelection*) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/editor/libeditor/nsHTMLAnonymousUtils.cpp:307:11
    #19 0x7fcd175e8495 in nsHTMLEditor::EndUpdateViewBatch() /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/editor/libeditor/nsHTMLEditor.cpp:4802:11
    #20 0x7fcd174b04ae in nsEditor::EndPlaceHolderTransaction() /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/editor/libeditor/nsEditor.cpp:965:7
    #21 0x7fcd175d381c in ~nsAutoPlaceHolderBatch /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/editor/libeditor/nsEditorUtils.h:51:9
    #22 0x7fcd175d381c in nsHTMLEditor::InsertBasicBlock(nsAString_internal const&amp;) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/editor/libeditor/nsHTMLEditor.cpp:2126
    #23 0x7fcd175d2216 in nsHTMLEditor::SetParagraphFormat(nsAString_internal const&amp;) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/editor/libeditor/nsHTMLEditor.cpp:1709:12
    #24 0x7fcd1768a384 in nsParagraphStateCommand::SetState(nsIEditor*, nsString&amp;) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/editor/composer/nsComposerCommands.cpp:654:10
    #25 0x7fcd176897b0 in nsMultiStateCommand::DoCommandParams(char const*, nsICommandParams*, nsISupports*) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/editor/composer/nsComposerCommands.cpp:599:12
    #26 0x7fcd18a65bd3 in nsControllerCommandTable::DoCommandParams(char const*, nsICommandParams*, nsISupports*) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/embedding/components/commandhandler/nsControllerCommandTable.cpp:162:10
    #27 0x7fcd18a5ca8e in DoCommandWithParams /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/embedding/components/commandhandler/nsBaseCommandController.cpp:152:10
    #28 0x7fcd18a5ca8e in non-virtual thunk to nsBaseCommandController::DoCommandWithParams(char const*, nsICommandParams*) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/embedding/components/commandhandler/nsBaseCommandController.cpp:140
    #29 0x7fcd18a62caa in nsCommandManager::DoCommand(char const*, nsICommandParams*, mozIDOMWindowProxy*) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/embedding/components/commandhandler/nsCommandManager.cpp:212:10
    #30 0x7fcd15f1ec29 in nsHTMLDocument::ExecCommand(nsAString_internal const&amp;, bool, nsAString_internal const&amp;, mozilla::ErrorResult&amp;) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/dom/html/nsHTMLDocument.cpp:3249:10
    #31 0x7fcd154dcc76 in mozilla::dom::HTMLDocumentBinding::execCommand(JSContext*, JS::Handle&lt;JSObject*&gt;, nsHTMLDocument*, JSJitMethodCallArgs const&amp;) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/obj-firefox/dom/bindings/HTMLDocumentBinding.cpp:816:15
    #32 0x7fcd15753157 in mozilla::dom::GenericBindingMethod(JSContext*, unsigned int, JS::Value*) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/dom/bindings/BindingUtils.cpp:2784:13
    #33 0x7fcd1b5d66c0 in CallJSNative /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/js/src/jscntxtinlines.h:235:15
    #34 0x7fcd1b5d66c0 in js::InternalCallOrConstruct(JSContext*, JS::CallArgs const&amp;, js::MaybeConstruct) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/js/src/vm/Interpreter.cpp:452
    #35 0x7fcd1b5bd8c0 in CallFromStack /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/js/src/vm/Interpreter.cpp:503:12
    #36 0x7fcd1b5bd8c0 in Interpret(JSContext*, js::RunState&amp;) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/js/src/vm/Interpreter.cpp:2873
    #37 0x7fcd1b5a3858 in js::RunScript(JSContext*, js::RunState&amp;) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/js/src/vm/Interpreter.cpp:398:12
    #38 0x7fcd1b5d6d88 in js::InternalCallOrConstruct(JSContext*, JS::CallArgs const&amp;, js::MaybeConstruct) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/js/src/vm/Interpreter.cpp:470:15
    #39 0x7fcd1b5d7461 in js::Call(JSContext*, JS::Handle&lt;JS::Value&gt;, JS::Handle&lt;JS::Value&gt;, js::AnyInvokeArgs const&amp;, JS::MutableHandle&lt;JS::Value&gt;) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/js/src/vm/Interpreter.cpp:516:10
    #40 0x7fcd1b1211a8 in JS::Call(JSContext*, JS::Handle&lt;JS::Value&gt;, JS::Handle&lt;JS::Value&gt;, JS::HandleValueArray const&amp;, JS::MutableHandle&lt;JS::Value&gt;) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/js/src/jsapi.cpp:2890:12
    #41 0x7fcd153a9c6d in mozilla::dom::Function::Call(JSContext*, JS::Handle&lt;JS::Value&gt;, nsTArray&lt;JS::Value&gt; const&amp;, JS::MutableHandle&lt;JS::Value&gt;, mozilla::ErrorResult&amp;) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/obj-firefox/dom/bindings/FunctionBinding.cpp:36:8
    #42 0x7fcd135d07bb in Call&lt;nsCOMPtr&lt;nsISupports&gt; &gt; /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/obj-firefox/dist/include/mozilla/dom/FunctionBinding.h:70:12
    #43 0x7fcd135d07bb in nsGlobalWindow::RunTimeoutHandler(nsTimeout*, nsIScriptContext*) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/dom/base/nsGlobalWindow.cpp:12271
    #44 0x7fcd135ae64c in nsGlobalWindow::RunTimeout(nsTimeout*) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/dom/base/nsGlobalWindow.cpp:12520:32
    #45 0x7fcd13546d61 in nsGlobalWindow::TimerCallback(nsITimer*, void*) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/dom/base/nsGlobalWindow.cpp:12766:3
    #46 0x7fcd10c4fdf7 in nsTimerImpl::Fire() /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/xpcom/threads/nsTimerImpl.cpp:524:7
    #47 0x7fcd10c270fc in nsTimerEvent::Run() /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/xpcom/threads/TimerThread.cpp:286:3
    #48 0x7fcd10c33eb8 in nsThread::ProcessNextEvent(bool, bool*) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/xpcom/threads/nsThread.cpp:1067:7
    #49 0x7fcd10cb26bc in NS_ProcessNextEvent(nsIThread*, bool) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/xpcom/glue/nsThreadUtils.cpp:290:10
    #50 0x7fcd11a17eff in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/ipc/glue/MessagePump.cpp:100:21
    #51 0x7fcd119862f8 in RunInternal /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/ipc/chromium/src/base/message_loop.cc:235:3
    #52 0x7fcd119862f8 in RunHandler /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/ipc/chromium/src/base/message_loop.cc:228
    #53 0x7fcd119862f8 in MessageLoop::Run() /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/ipc/chromium/src/base/message_loop.cc:208
    #54 0x7fcd1737915f in nsBaseAppShell::Run() /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/widget/nsBaseAppShell.cpp:156:3
    #55 0x7fcd194050a7 in XRE_RunAppShell /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/toolkit/xre/nsEmbedFunctions.cpp:834:12
    #56 0x7fcd119862f8 in RunInternal /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/ipc/chromium/src/base/message_loop.cc:235:3
    #57 0x7fcd119862f8 in RunHandler /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/ipc/chromium/src/base/message_loop.cc:228
    #58 0x7fcd119862f8 in MessageLoop::Run() /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/ipc/chromium/src/base/message_loop.cc:208
    #59 0x7fcd19404712 in XRE_InitChildProcess /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/toolkit/xre/nsEmbedFunctions.cpp:664:7
    #60 0x4e2bc5 in content_process_main(int, char**) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/ipc/app/../contentproc/plugin-container.cpp:224:19
    #61 0x7fcd0dd1282f in __libc_start_main /build/glibc-GKVZIf/glibc-2.23/csu/../csu/libc-start.c:291
    #62 0x41e778 in _start (/home/nils/fuzzer3/firefox/plugin-container+0x41e778)

0x6250002eab58 is located 6744 bytes inside of 8192-byte region [0x6250002e9100,0x6250002eb100)
allocated by thread T0 (Web Content) here:
    #0 0x4b51eb in __interceptor_malloc /builds/slave/moz-toolchain/src/llvm/projects/compiler-rt/lib/asan/asan_malloc_linux.cc:52:3
    #1 0x7fcd1ef7bdd6 in PL_ArenaAllocate /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/nsprpub/lib/ds/plarena.c:210:27
    #2 0x7fcd179fbe99 in nsPresArena::Allocate(unsigned int, unsigned long) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/layout/base/nsPresArena.cpp:165:3
    #3 0x7fcd17926c12 in AllocateByObjectID /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/layout/base/nsPresArena.h:65:12
    #4 0x7fcd17926c12 in AllocateByObjectID /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/layout/base/nsIPresShell.h:250
    #5 0x7fcd17926c12 in operator new /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/layout/style/nsStyleStruct.h:2475
    #6 0x7fcd17926c12 in nsRuleNode::ComputeDisplayData(void*, nsRuleData const*, nsStyleContext*, nsRuleNode*, nsRuleNode::RuleDetail, mozilla::RuleNodeCacheConditions) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/layout/style/nsRuleNode.cpp:5327
    #7 0x7fcd178fb8ce in nsRuleNode::WalkRuleTree(nsStyleStructID, nsStyleContext*) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/layout/style/nsRuleNode.cpp:2491:10
    #8 0x7fcd179eea5f in GetStyleDisplay&lt;true&gt; /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/obj-firefox/layout/style/nsStyleStructList.h:98:1
    #9 0x7fcd179eea5f in nsStyleDisplay const* nsStyleContext::DoGetStyleDisplay&lt;true&gt;() /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/obj-firefox/layout/style/nsStyleStructList.h:98
    #10 0x7fcd1797723b in StyleDisplay /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/obj-firefox/layout/style/nsStyleStructList.h:98:1
    #11 0x7fcd1797723b in nsStyleContext::SetStyleBits() /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/layout/style/nsStyleContext.cpp:687
    #12 0x7fcd17976fc6 in FinishConstruction /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/layout/style/nsStyleContext.cpp:163:3
    #13 0x7fcd17976fc6 in nsStyleContext::nsStyleContext(nsStyleContext*, nsIAtom*, mozilla::CSSPseudoElementType, already_AddRefed&lt;nsRuleNode&gt;, bool) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/layout/style/nsStyleContext.cpp:121
    #14 0x7fcd1799a02c in NS_NewStyleContext(nsStyleContext*, nsIAtom*, mozilla::CSSPseudoElementType, nsRuleNode*, bool) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/layout/style/nsStyleContext.cpp:1316:5
    #15 0x7fcd179a57ee in nsStyleSet::GetContext(nsStyleContext*, nsRuleNode*, nsRuleNode*, nsIAtom*, mozilla::CSSPseudoElementType, mozilla::dom::Element*, unsigned int) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/layout/style/nsStyleSet.cpp:918:14
    #16 0x7fcd179aa6f3 in nsStyleSet::ResolveStyleFor(mozilla::dom::Element*, nsStyleContext*, TreeMatchContext&amp;) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/layout/style/nsStyleSet.cpp:1366:10
    #17 0x7fcd17b1d612 in ResolveStyleFor /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/obj-firefox/dist/include/mozilla/StyleSetHandleInlines.h:93:3
    #18 0x7fcd17b1d612 in nsCSSFrameConstructor::ResolveStyleContext(nsStyleContext*, nsIContent*, nsFrameConstructorState*) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/layout/base/nsCSSFrameConstructor.cpp:4959
    #19 0x7fcd17b19630 in ResolveStyleContext /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/layout/base/nsCSSFrameConstructor.cpp:4928:10
    #20 0x7fcd17b19630 in ResolveStyleContext /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/layout/base/nsCSSFrameConstructor.cpp:4944
    #21 0x7fcd17b19630 in nsCSSFrameConstructor::AddFrameConstructionItems(nsFrameConstructorState&amp;, nsIContent*, bool, nsCSSFrameConstructor::InsertionPoint const&amp;, nsCSSFrameConstructor::FrameConstructionItemList&amp;) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/layout/base/nsCSSFrameConstructor.cpp:5574
    #22 0x7fcd17b00233 in nsCSSFrameConstructor::ProcessChildren(nsFrameConstructorState&amp;, nsIContent*, nsStyleContext*, nsContainerFrame*, bool, nsFrameItems&amp;, bool, PendingBinding*, nsIFrame*) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/layout/base/nsCSSFrameConstructor.cpp:10685:9
    #23 0x7fcd17b1712f in nsCSSFrameConstructor::ConstructFrameFromItemInternal(nsCSSFrameConstructor::FrameConstructionItem&amp;, nsFrameConstructorState&amp;, nsContainerFrame*, nsFrameItems&amp;) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/layout/base/nsCSSFrameConstructor.cpp:3998:9
    #24 0x7fcd17b2284c in nsCSSFrameConstructor::ConstructFramesFromItem(nsFrameConstructorState&amp;, nsCSSFrameConstructor::FrameConstructionItemList::Iterator&amp;, nsContainerFrame*, nsFrameItems&amp;) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/layout/base/nsCSSFrameConstructor.cpp:6085:3
    #25 0x7fcd17b0f272 in ConstructFramesFromItemList /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/layout/base/nsCSSFrameConstructor.cpp:10502:5
    #26 0x7fcd17b0f272 in nsCSSFrameConstructor::CreateAnonymousFrames(nsFrameConstructorState&amp;, nsIContent*, nsContainerFrame*, PendingBinding*, nsFrameItems&amp;) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/layout/base/nsCSSFrameConstructor.cpp:4132
    #27 0x7fcd17b0b8b7 in nsCSSFrameConstructor::BeginBuildingScrollFrame(nsFrameConstructorState&amp;, nsIContent*, nsStyleContext*, nsContainerFrame*, nsIAtom*, bool, nsContainerFrame*&amp;) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/layout/base/nsCSSFrameConstructor.cpp:4546:3
    #28 0x7fcd17b083d5 in nsCSSFrameConstructor::SetUpDocElementContainingBlock(nsIContent*) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/layout/base/nsCSSFrameConstructor.cpp:2875:25
    #29 0x7fcd17b04852 in nsCSSFrameConstructor::ConstructDocElementFrame(mozilla::dom::Element*, nsILayoutHistoryState*) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/layout/base/nsCSSFrameConstructor.cpp:2411:3
    #30 0x7fcd17b28a17 in nsCSSFrameConstructor::ContentRangeInserted(nsIContent*, nsIContent*, nsIContent*, nsILayoutHistoryState*, bool) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/layout/base/nsCSSFrameConstructor.cpp:7635:7
    #31 0x7fcd17cc31a7 in PresShell::Initialize(int, int) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/layout/base/nsPresShell.cpp:1728:7
    #32 0x7fcd137f38ef in nsContentSink::StartLayout(bool) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/dom/base/nsContentSink.cpp:1210:19
    #33 0x7fcd12c02086 in nsHtml5TreeOpExecutor::StartLayout() /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/parser/html/nsHtml5TreeOpExecutor.cpp:612:3
    #34 0x7fcd12c0e83e in nsHtml5TreeOperation::Perform(nsHtml5TreeOpExecutor*, nsIContent**) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/parser/html/nsHtml5TreeOperation.cpp:990:7
    #35 0x7fcd12bff9d7 in nsHtml5TreeOpExecutor::RunFlushLoop() /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/parser/html/nsHtml5TreeOpExecutor.cpp:448:21
    #36 0x7fcd12c044cb in nsHtml5ExecutorFlusher::Run() /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/parser/html/nsHtml5StreamParser.cpp:128:9
    #37 0x7fcd10c33eb8 in nsThread::ProcessNextEvent(bool, bool*) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/xpcom/threads/nsThread.cpp:1067:7
    #38 0x7fcd10cb26bc in NS_ProcessNextEvent(nsIThread*, bool) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/xpcom/glue/nsThreadUtils.cpp:290:10
    #39 0x7fcd11a17eff in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/ipc/glue/MessagePump.cpp:100:21

SUMMARY: AddressSanitizer: use-after-poison /builds/slave/m-cen-l64-asan-ntly-0000000000/build/src/layout/generic/nsIFrame.h:1565:46 in GetStateBits
Shadow bytes around the buggy address:
  0x0c4a80055510: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c4a80055520: 00 00 00 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7
  0x0c4a80055530: f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7
  0x0c4a80055540: f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7
  0x0c4a80055550: f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7
=&gt;0x0c4a80055560: f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7[f7]f7 f7 f7 f7
  0x0c4a80055570: f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7
  0x0c4a80055580: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c4a80055590: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c4a800555a0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c4a800555b0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Heap right redzone:      fb
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack partial redzone:   f4
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==30757==ABORTING</pre></div><div class="change-set" id="c1"><div class="comment" data-id="11506124" data-no="1"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-1" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" ><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" ><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-1"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-1" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c1">Comment 1</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-27 15:47 PDT" data-time="1467067622">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-1">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-1" data-comment-id="11506124">Also crashes opt builds: <a href="https://crash-stats.mozilla.org/report/index/70a68fd7-cca6-48eb-8a61-72c152160627">bp-70a68fd7-cca6-48eb-8a61-72c152160627</a>

I reproduced the opt crash in Release and Beta, but not in ESR-45. It's possible the UAF is still there lurking in older builds -- we won't know until we find out what's actually wrong here. CC'ing jwatt and heycam because they've touched the crashing file, but the cause of the problem might be elsewhere.</pre><div class="activity"><div class="change">Group: core-security &rarr; layout-core-security</div><div class="change">Crash Signature: [&#64; nsFrameManager::CaptureFrameState ]</div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox47&amp;o1=isnotempty">status-firefox47</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox47&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox48&amp;o1=isnotempty">status-firefox48</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox48&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox49&amp;o1=isnotempty">status-firefox49</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox49&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=isnotempty">status-firefox-esr45</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=equals&amp;v1=unaffected">unaffected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox48&amp;o1=isnotempty">tracking-firefox48</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox48&amp;o1=equals&amp;v1=%2B">+</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox49&amp;o1=isnotempty">tracking-firefox49</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox49&amp;o1=equals&amp;v1=%2B">+</a></div><div class="change">Keywords: <a href="/buglist.cgi?keywords=crash&amp;resolution=---">crash</a>, 
          
            <a href="/buglist.cgi?keywords=csectype-uaf&amp;resolution=---">csectype-uaf</a>, 
          
            <a href="/buglist.cgi?keywords=regression&amp;resolution=---">regression</a>, 
          
            <a href="/buglist.cgi?keywords=regressionwindow-wanted&amp;resolution=---">regressionwindow-wanted</a>, 
          
            <a href="/buglist.cgi?keywords=sec-high&amp;resolution=---">sec-high</a>, 
          
            <a href="/buglist.cgi?keywords=testcase&amp;resolution=---">testcase</a></div></div></div><div class="change-set" id="c2"><div class="comment" data-id="11515002" data-no="2"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-2" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" ><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" ><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-2"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-2" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c2">Comment 2</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-30 11:42 PDT" data-time="1467312131">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-2">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-2" data-comment-id="11515002">Last good revision: 43f67d61062ac9e7d4202ef49a89d30f18583f84
First bad revision: c5153ecb53ba4c2a484a17f93d701881f280bfc8
Pushlog: <a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/pushloghtml?fromchange=43f67d61062ac9e7d4202ef49a89d30f18583f84&amp;tochange=c5153ecb53ba4c2a484a17f93d701881f280bfc8">https://hg.mozilla.org/integration/mozilla-inbound/pushloghtml?fromchange=43f67d61062ac9e7d4202ef49a89d30f18583f84&amp;tochange=c5153ecb53ba4c2a484a17f93d701881f280bfc8</a>

So caused by either <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - nsAnimationManager::CheckAnimationRule should not create temporary animations"
   href="/show_bug.cgi?id=1242872">bug 1242872</a> or <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Clean up animation code in layout/style"
   href="/show_bug.cgi?id=1239945">bug 1239945</a>.</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox47&amp;o1=isnotempty">tracking-firefox47</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox47&amp;o1=equals&amp;v1=%3F">?</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox50&amp;o1=isnotempty">tracking-firefox50</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox50&amp;o1=equals&amp;v1=%3F">?</a></div><div class="change">Flags: in-testsuite?</div><div class="change">Keywords: <span class="activity-deleted"><a href="/buglist.cgi?keywords=regressionwindow-wanted&amp;resolution=---">regressionwindow-wanted</a></span></div></div></div><div class="change-set" id="c3"><div class="comment" data-id="11515728" data-no="3"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-3" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_131213" ><img src="https://secure.gravatar.com/avatar/9ec516861853d265a973cd0ef66735cf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_131213" ><a class="email " href="/user_profile?user_id=131213" > <span class="fna">Hiroyuki Ikezoe (:hiro)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-3"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-3" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c3">Comment 3</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-06-30 15:47 PDT" data-time="1467326830">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-3">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-3" data-comment-id="11515728">Thank you, Ryan.  I confirmed the culprit changeset is;
<a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/c920a4fb4664">https://hg.mozilla.org/integration/mozilla-inbound/rev/c920a4fb4664</a></pre><div class="activity"><div class="change">Assignee: nobody &rarr; hiikezoe</div><div class="change">Status: NEW &rarr; ASSIGNED</div></div></div><div class="change-set" id="c4"><div class="comment" data-id="11516925" data-no="4"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-4" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_131213" ><img src="https://secure.gravatar.com/avatar/9ec516861853d265a973cd0ef66735cf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_131213" ><a class="email " href="/user_profile?user_id=131213" > <span class="fna">Hiroyuki Ikezoe (:hiro)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-4"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-4" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c4">Comment 4</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-01 04:08 PDT" data-time="1467371283">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-4">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-4" data-comment-id="11516925">This seems to be a case that we need to call RequestRestyle(Layer) even if there is no animation properties changes.  The trigger line which we need to call RequestRestyle(Layer) if there is no animation properties changes is 
 o577.style.position='absolute';

Before changeset c920a4fb4664, we had called RequestRestyle(Layer) (moreover we called SchedulePaint) whenever we call UpdateAnimations with old animations,  but after the changeset, we don't call RequestRestyle(Layer) if there is no animation properties changes.  As a result, nsCSSFrameConstructor::RecreateFramesForContent is not called when needed.

Yes, this bug, of course, is caused by web-animation.  You can confirm it if you change 'o577.id='id2' to 'o577.animate({ opacity: [0, 1] }, 100)'.</pre></div><div class="change-set" id="a596197_75935"><div class="change" id="aa596197_75935">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a596197_75935"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_75935" id="a596197_75935"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a596197_75935"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a596197_75935">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#a596197_75935">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-01 04:47 PDT" data-time="1467373645">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Blocks: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - nsAnimationManager::CheckAnimationRule should not create temporary animations"
   href="/show_bug.cgi?id=1242872">1242872</a></div><div class="change">Component: Layout &rarr; DOM: Animation</div></div></div><div class="change-set" id="c5"><div class="comment" data-id="11519532" data-no="5"
       data-tags="testcase">
    
    <table class="layout-table change-head assignee" id="ch-5" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_131213" id="a596197_75935"><img src="https://secure.gravatar.com/avatar/9ec516861853d265a973cd0ef66735cf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_131213" id="a596197_75935"><a class="email " href="/user_profile?user_id=131213" > <span class="fna">Hiroyuki Ikezoe (:hiro)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-5"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-5" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c5">Comment 5</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-03 14:40 PDT" data-time="1467582044">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-5">
        <td colspan="2" class="comment-tags"><span class="comment-tag">testcase</span>
        </td>
      </tr>
    </table>

    
  </div><div id="att-8767517"
         class="attachment"
         data-id="8767517" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="web-animation.html">
      <meta itemprop="contentSize" content="1669">
      <meta itemprop="encodingFormat" content="text/html">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=8767517" itemprop="contentUrl">
        <span id="att-8767517-description" itemprop="description">Web animations' test case</span></a>
        — <a href="attachment.cgi?id=8767517&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-5" data-comment-id="11519532">Here is a test case for web-animations.
It seems that the trigger is this changeset, especially GetAnimationRule call.
<a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/ab454c4469b7">https://hg.mozilla.org/integration/mozilla-inbound/rev/ab454c4469b7</a>
I am looking into it.</pre></div><div class="change-set" id="c6"><div class="comment" data-id="11519572" data-no="6"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-6" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_165012" id="a596197_75935"><img src="https://secure.gravatar.com/avatar/b21107bc66be7d2aefff1fb59d5d8bae?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_165012" id="a596197_75935"><a class="email " href="/user_profile?user_id=165012" > <span class="fna">Brian Birtles (:birtles)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-6"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-6" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c6">Comment 6</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-03 15:58 PDT" data-time="1467586738">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-6">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-6" data-comment-id="11519572">(In reply to Hiroyuki Ikezoe (:hiro) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - use-after-poison in nsFrameManager::CaptureFrameState"
   href="/show_bug.cgi?id=1282076#c4">comment #4</a>)
<span class="quote">&gt; This seems to be a case that we need to call RequestRestyle(Layer) even if
&gt; there is no animation properties changes.  The trigger line which we need to
&gt; call RequestRestyle(Layer) if there is no animation properties changes is 
&gt;  o577.style.position='absolute';</span >

I'm curious why we need to call RequestRestyle in this case?</pre></div><div class="change-set" id="c7"><div class="comment" data-id="11519579" data-no="7"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-7" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_131213" id="a596197_75935"><img src="https://secure.gravatar.com/avatar/9ec516861853d265a973cd0ef66735cf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_131213" id="a596197_75935"><a class="email " href="/user_profile?user_id=131213" > <span class="fna">Hiroyuki Ikezoe (:hiro)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-7"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-7" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c7">Comment 7</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-03 16:08 PDT" data-time="1467587324">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-7">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-7" data-comment-id="11519579">(In reply to Brian Birtles (:birtles) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - use-after-poison in nsFrameManager::CaptureFrameState"
   href="/show_bug.cgi?id=1282076#c6">comment #6</a>)
<span class="quote">&gt; (In reply to Hiroyuki Ikezoe (:hiro) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - use-after-poison in nsFrameManager::CaptureFrameState"
   href="/show_bug.cgi?id=1282076#c4">comment #4</a>)
&gt; &gt; This seems to be a case that we need to call RequestRestyle(Layer) even if
&gt; &gt; there is no animation properties changes.  The trigger line which we need to
&gt; &gt; call RequestRestyle(Layer) if there is no animation properties changes is 
&gt; &gt;  o577.style.position='absolute';
&gt; 
&gt; I'm curious why we need to call RequestRestyle in this case?</span >

I don't quite understand it yet.  I just knew before that changeset, we called RequestRestyle(Layer), and this bug does not happen.  So, I might be wrong.

Anyway, I think reframing process (I am not sure this word is right here) without RequestRestyle(Layer) does not invoked when needed in failure cases.</pre></div><div class="change-set" id="c8"><div class="comment" data-id="11522128" data-no="8"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-8" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_131213" id="a596197_75935"><img src="https://secure.gravatar.com/avatar/9ec516861853d265a973cd0ef66735cf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_131213" id="a596197_75935"><a class="email " href="/user_profile?user_id=131213" > <span class="fna">Hiroyuki Ikezoe (:hiro)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-8"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-8" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c8">Comment 8</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-04 17:09 PDT" data-time="1467677364">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-8">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-8" data-comment-id="11522128">On debug build the test case causes an assertion:

Assertion failure: aListID == kPrincipalList || aListID == kNoReflowPrincipalList (unexpected child list), at /home/ikezoe/mozilla-central/layout/generic/nsContainerFrame.cpp:150
<a rel="nofollow" href="http://hg.mozilla.org/mozilla-central/file/c9a70b64f2fa/layout/generic/nsContainerFrame.cpp#l149">http://hg.mozilla.org/mozilla-central/file/c9a70b64f2fa/layout/generic/nsContainerFrame.cpp#l149</a>

When I checked the listID of the parent frame;

0x00007fa7ed7ab43c in nsContainerFrame::RemoveFrame (this=&lt;optimized out&gt;, aListID=&lt;optimized out&gt;, aOldFrame=0x7fa7bf74da68) at /home/ikezoe/mozilla-central/layout/generic/nsContainerFrame.cpp:149
149	  MOZ_ASSERT(aListID == kPrincipalList || aListID == kNoReflowPrincipalList,
(rr) up
#1  0x00007fa7ed7213b1 in nsFrameManager::RemoveFrame (this=this&#64;entry=0x7fa7c8f77cc0, aListID=mozilla::layout::kAbsoluteList, aOldFrame=aOldFrame&#64;entry=0x7fa7bf74da68)
    at /home/ikezoe/mozilla-central/layout/base/nsFrameManager.cpp:510
510	    parentFrame-&gt;RemoveFrame(aListID, aOldFrame);
(rr) p aListID
$1 = mozilla::layout::kAbsoluteList
(rr) up
#2  0x00007fa7ed7fcd4e in nsPlaceholderFrame::DestroyFrom (this=0x7fa7beb3d6c0, aDestructRoot=0x7fa7c85f4480) at /home/ikezoe/mozilla-central/layout/generic/nsPlaceholderFrame.cpp:168
168	      fm-&gt;RemoveFrame(listId, oof);
(rr) p oof-&gt;mParent-&gt;HasAbsolutelyPositionedChildren()
$2 = true
(rr) p oof-&gt;mParent-&gt;GetAbsoluteContainingBlock()-&gt;mChildListID
$3 = mozilla::layout::kFixedList

This frame's child id was actually kFixedList but nsLayoutUtils::GetChildListNameFor() returned kAbsoluteList.

A problem in this failure case in nsLayoutUtils::GetChildListNameFor is StyleDisplay() against the frame.
<a rel="nofollow" href="http://hg.mozilla.org/mozilla-central/file/c9a70b64f2fa/layout/base/nsLayoutUtils.cpp#l1413">http://hg.mozilla.org/mozilla-central/file/c9a70b64f2fa/layout/base/nsLayoutUtils.cpp#l1413</a>

The disp-&gt;mPosition was NS_STYLE_POSITION_ABSOLUTE, it did not match what the frame has child id itself.</pre></div><div class="change-set" id="c9"><div class="comment" data-id="11525250" data-no="9"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-9" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_131213" id="a596197_75935"><img src="https://secure.gravatar.com/avatar/9ec516861853d265a973cd0ef66735cf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_131213" id="a596197_75935"><a class="email " href="/user_profile?user_id=131213" > <span class="fna">Hiroyuki Ikezoe (:hiro)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-9"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-9" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c9">Comment 9</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-05 16:30 PDT" data-time="1467761438">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-9">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-9" data-comment-id="11525250">I found the reason why calling RequestRestyle(Layer) does not cause this issue.  
In restyling process between setTimeout() and 'o0.designMode='on'', CalcSyleDifference in CaptureChange returns NS_STYLE_HINT_NONE instead of nsChangeHint_ReconstructFrame, as a result, reframing is skipped, then the child id mismatch in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - use-after-poison in nsFrameManager::CaptureFrameState"
   href="/show_bug.cgi?id=1282076#c8">comment 8</a> happens.

[1] <a rel="nofollow" href="http://hg.mozilla.org/mozilla-central/file/9b428173a088/layout/base/RestyleManager.cpp#l2780">http://hg.mozilla.org/mozilla-central/file/9b428173a088/layout/base/RestyleManager.cpp#l2780</a>

The reason why CalcSyleDifference returns NS_STYLE_HINT_NONE is that PeekStyleDisplay() for the old style context is nullptr there.  Actually the difference should be from position:fixed to position:absolute there (i.e.,  nsChangeHint_ReconstructFrame).  I don't know why the display is null yet.</pre></div><div class="change-set" id="a995902_165012"><div class="change" id="aa995902_165012">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_165012" id="a995902_165012"><img src="https://secure.gravatar.com/avatar/b21107bc66be7d2aefff1fb59d5d8bae?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_165012" id="a995902_165012"><a class="email " href="/user_profile?user_id=165012" > <span class="fna">Brian Birtles (:birtles)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a995902_165012"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a995902_165012">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#a995902_165012">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-05 19:49 PDT" data-time="1467773350">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Priority: -- &rarr; P1</div></div></div><div class="change-set" id="c10"><div class="comment" data-id="11525944" data-no="10"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-10" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_131213" id="a995902_165012"><img src="https://secure.gravatar.com/avatar/9ec516861853d265a973cd0ef66735cf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_131213" id="a995902_165012"><a class="email " href="/user_profile?user_id=131213" > <span class="fna">Hiroyuki Ikezoe (:hiro)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-10"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-10" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c10">Comment 10</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-05 20:27 PDT" data-time="1467775678">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-10">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-10" data-comment-id="11525944">(In reply to Hiroyuki Ikezoe (:hiro) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - use-after-poison in nsFrameManager::CaptureFrameState"
   href="/show_bug.cgi?id=1282076#c9">comment #9</a>)
<span class="quote">&gt; The reason why CalcSyleDifference returns NS_STYLE_HINT_NONE is that
&gt; PeekStyleDisplay() for the old style context is nullptr there.  Actually the
&gt; difference should be from position:fixed to position:absolute there (i.e., 
&gt; nsChangeHint_ReconstructFrame).  I don't know why the display is null yet.</span >

The reason is that we are hit by this condition[1] in nsRuleNode::GetStyleData.
<a rel="nofollow" href="http://hg.mozilla.org/mozilla-central/file/70e05c6832e8/layout/style/nsRuleNode.cpp#l10264">http://hg.mozilla.org/mozilla-central/file/70e05c6832e8/layout/style/nsRuleNode.cpp#l10264</a>

We have an animation and a pseudo element 'o305=document.createTextNode(&quot;{}:first-line{&quot;)'.
I am going to investigate <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Heap-use-after-free in nsFrame::DidSetStyleContext"
   href="/show_bug.cgi?id=1181011">bug 1181011</a> which introduced this condition.</pre></div><div class="change-set" id="c11"><div class="comment" data-id="11526467" data-no="11"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-11" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_131213" id="a995902_165012"><img src="https://secure.gravatar.com/avatar/9ec516861853d265a973cd0ef66735cf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_131213" id="a995902_165012"><a class="email " href="/user_profile?user_id=131213" > <span class="fna">Hiroyuki Ikezoe (:hiro)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-11"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-11" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c11">Comment 11</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-05 23:16 PDT" data-time="1467785808">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-11">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8768286"
         class="attachment patch obsolete"
         data-id="8768286" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="forceToCallRequestRestyle.patch">
      <meta itemprop="contentSize" content="1655">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8768286">
          <a class="link" href="attachment.cgi?id=8768286&amp;action=diff">
        <span id="att-8768286-description" itemprop="description">Force to call RequestRestyle when we have animations inside an pseudo element</span></a> (obsolete)
        — <a href="attachment.cgi?id=8768286&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1282076&attachment=8768286">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-11" data-comment-id="11526467">I have no idea what we can tweak nsRuleNode::GetStyleData for this bug cases.

So, this patch calls RequestRestyle to force to do layout when we have animations inside a pseudo element even if there is no property changes.

This is a behavior what we did before c920a4fb4664, so it's basically no risk, it has only a performance impact but the impact should be relatively small.

I'd like to hear opinions from Cameron, but he will be away until July 10.</pre></div><div class="change-set" id="c12"><div class="comment" data-id="11527627" data-no="12"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-12" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_8519" id="a995902_165012"><img src="https://secure.gravatar.com/avatar/cf7a6485ad75c35d66da0af6c88515d5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_8519" id="a995902_165012"><a class="email " href="/user_profile?user_id=8519" > <span class="fna">Marcia Knous [:marcia]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-12"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-12" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c12">Comment 12</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-06 08:26 PDT" data-time="1467818784">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-12">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-12" data-comment-id="11527627">Tracking 50+ for this crash.</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox50&amp;o1=isnotempty">tracking-firefox50</a>:
          <a href="/buglist.cgi?f1=cf_tracking_firefox50&amp;o1=equals&amp;v1=%3F">?</a> &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox50&amp;o1=equals&amp;v1=%2B">+</a></div></div></div><div class="change-set" id="c13"><div class="comment" data-id="11529034" data-no="13"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-13" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_131213" id="a995902_165012"><img src="https://secure.gravatar.com/avatar/9ec516861853d265a973cd0ef66735cf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_131213" id="a995902_165012"><a class="email " href="/user_profile?user_id=131213" > <span class="fna">Hiroyuki Ikezoe (:hiro)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-13"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-13" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c13">Comment 13</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-06 16:14 PDT" data-time="1467846858">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-13">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-13" data-comment-id="11529034">FYI: a try <a rel="nofollow" href="https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=37e9d4e2b305">https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=37e9d4e2b305</a></pre></div><div class="change-set" id="c14"><div class="comment" data-id="11536779" data-no="14"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-14" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_131213" id="a995902_165012"><img src="https://secure.gravatar.com/avatar/9ec516861853d265a973cd0ef66735cf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_131213" id="a995902_165012"><a class="email " href="/user_profile?user_id=131213" > <span class="fna">Hiroyuki Ikezoe (:hiro)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-14"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-14" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c14">Comment 14</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-10 16:55 PDT" data-time="1468194941">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-14">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-14" data-comment-id="11536779">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8768286" name="attach_8768286" title="Force to call RequestRestyle when we have animations inside an pseudo element">attachment 8768286</a> <a href="/attachment.cgi?id=8768286&amp;action=edit" title="Force to call RequestRestyle when we have animations inside an pseudo element">[details]</a> <a href="/attachment.cgi?id=8768286&amp;action=diff" title="Force to call RequestRestyle when we have animations inside an pseudo element">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1282076&amp;attachment=8768286'>[review]</a>
Force to call RequestRestyle when we have animations inside an pseudo element

In failure case, reparenting frame is not processed because RestyleManager::CaptureChange can not detect position style change from 'fixed' to 'absolute' due to nsStyleContext::CalcDifference in RestyleManager::CaptureChange does not return nsChangeHint_ReconstructFrame.  That's because because nsRuleNode::GetStyleData returns nullptr if the style has animation and is inside a pseudo-element.

Before this changeset, <a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/c920a4fb4664">https://hg.mozilla.org/integration/mozilla-inbound/rev/c920a4fb4664</a>, it did not appear since we called RequestRestyle(Layer), so reparenting frame was processed regardless of CaptureChange results.

This patch calls RequestRestyle(Layer) if we have animations inside a pseudo-element just like we did before, can be easily uplifted.

Cameron, what do you think of?</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8768286&amp;action=edit"
           title="Force to call RequestRestyle when we have animations inside an pseudo element"
           class=""
        >Attachment #8768286</a> -
        Flags: review?(cam)</div></div></div><div class="change-set" id="c15"><div class="comment" data-id="11537579" data-no="15"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-15" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_54040" id="a995902_165012"><img src="https://secure.gravatar.com/avatar/becfee04c4233fec739dd9cb43128591?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_54040" id="a995902_165012"><a class="email " href="/user_profile?user_id=54040" > <span class="fna">Cameron McCormack (:heycam)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-15"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-15" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c15">Comment 15</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-10 23:51 PDT" data-time="1468219899">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-15">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-15" data-comment-id="11537579">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8768286" name="attach_8768286" title="Force to call RequestRestyle when we have animations inside an pseudo element">attachment 8768286</a> <a href="/attachment.cgi?id=8768286&amp;action=edit" title="Force to call RequestRestyle when we have animations inside an pseudo element">[details]</a> <a href="/attachment.cgi?id=8768286&amp;action=diff" title="Force to call RequestRestyle when we have animations inside an pseudo element">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1282076&amp;attachment=8768286'>[review]</a>
Force to call RequestRestyle when we have animations inside an pseudo element

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8768286" name="attach_8768286" title="Force to call RequestRestyle when we have animations inside an pseudo element">attachment 8768286</a> <a href="/attachment.cgi?id=8768286&amp;action=edit" title="Force to call RequestRestyle when we have animations inside an pseudo element">[details]</a> <a href="/attachment.cgi?id=8768286&amp;action=diff" title="Force to call RequestRestyle when we have animations inside an pseudo element">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1282076&amp;attachment=8768286'>[review]</a>:
-----------------------------------------------------------------

(In reply to Hiroyuki Ikezoe (:hiro) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - use-after-poison in nsFrameManager::CaptureFrameState"
   href="/show_bug.cgi?id=1282076#c9">comment #9</a>)
<span class="quote">&gt; In restyling process between setTimeout() and 'o0.designMode='on'',
&gt; CalcSyleDifference in CaptureChange returns NS_STYLE_HINT_NONE instead of
&gt; nsChangeHint_ReconstructFrame, as a result, reframing is skipped, then the
&gt; child id mismatch in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - use-after-poison in nsFrameManager::CaptureFrameState"
   href="/show_bug.cgi?id=1282076#c8">comment 8</a> happens.</span >

When CalcStyleData calls PeekStyleData, it interprets a nullptr return value as meaning &quot;we don't care about this struct&quot;, since we never requested it, and therefore don't need to generate any change hints for it.  However, it looks like the <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Heap-use-after-free in nsFrame::DidSetStyleContext"
   href="/show_bug.cgi?id=1181011">bug 1181011</a> changes violated that expectation.  Normally, when we compute a reset struct, and the rule node decides that it can't be cached, we store the struct pointer on the style context:

<a rel="nofollow" href="http://searchfox.org/mozilla-central/rev/bc94fc8653d9821caf87f5af0e2cd830a09ca8d3/layout/style/nsRuleNode.cpp#2843-2845">http://searchfox.org/mozilla-central/rev/bc94fc8653d9821caf87f5af0e2cd830a09ca8d3/layout/style/nsRuleNode.cpp#2843-2845</a>

If the rule node does decide it can be cached, we avoid storing the struct pointer on the style context (since the style context can just ask the rule node for it, and we can maybe avoid allocating nsRuleNode::mResetData).

The problem that <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Heap-use-after-free in nsFrame::DidSetStyleContext"
   href="/show_bug.cgi?id=1181011">bug 1181011</a> was intended to address was that a single nsRuleNode, for an animation rule, can represent different style data, depending on whether the style context is for something inside a pseudo-element or not.  But the way we handle this is by still allowing the struct to be cached on the rule node (as long as its RuleNodeCacheConditions say it's OK), but then choosing not to return it from nsRuleNode::GetStyleData.  That means we don't store the struct pointer on the style context, which means PeekStyleData thinks we never computed the struct.

So I think we should fix this problem, rather than solve the crash by forcing the restyle in the animation code.  There are a couple of ways we could do it: we could always store reset struct pointers on the style context (even if cached unconditionally on the rule node) if we have animation data.  Or we could add an &quot;in a pseudo&quot; value to RuleNodeCacheConditions to be used if the rule node has animation data, like I was going to do in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Heap-use-after-free in nsFrame::DidSetStyleContext"
   href="/show_bug.cgi?id=1181011#c18">bug 1181011 comment 18</a> (though I'm not sure why that patch didn't work).

I think the former is the smaller change, so better for uplifting.  This is a small memory increase for style contexts with animations on them.

(The better solution would be to do <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Heap-use-after-free in nsFrame::DidSetStyleContext"
   href="/show_bug.cgi?id=1181011#c25">bug 1181011 comment 25</a>, which would use separate rule nodes for in-pseudo-animation-rule and not-in-pseudo-animation-rule, but that's a bigger change.)</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8768286&amp;action=edit"
           title="Force to call RequestRestyle when we have animations inside an pseudo element"
           class=""
        >Attachment #8768286</a> -
        Flags: review?(cam) &rarr; review-</div></div></div><div class="change-set" id="c16"><div class="comment" data-id="11547164" data-no="16"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-16" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_131213" id="a995902_165012"><img src="https://secure.gravatar.com/avatar/9ec516861853d265a973cd0ef66735cf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_131213" id="a995902_165012"><a class="email " href="/user_profile?user_id=131213" > <span class="fna">Hiroyuki Ikezoe (:hiro)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-16"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-16" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c16">Comment 16</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-13 22:09 PDT" data-time="1468472969">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-16">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-16" data-comment-id="11547164">Thank you, Cameron for detailed explanation!

(In reply to Cameron McCormack (:heycam) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - use-after-poison in nsFrameManager::CaptureFrameState"
   href="/show_bug.cgi?id=1282076#c15">comment #15</a>)
<span class="quote">&gt; So I think we should fix this problem, rather than solve the crash by
&gt; forcing the restyle in the animation code.  There are a couple of ways we
&gt; could do it: we could always store reset struct pointers on the style
&gt; context (even if cached unconditionally on the rule node) if we have
&gt; animation data.</span >

Initially I couldn't not understand what you mean, especially where the reset struct pointers stores.  After digging into the code, if I understand it correctly, I think you meant removing !(HasAnimationData() &amp;&amp; ParentHasPseudoElementData(aContext)) in STYLE_STRUCT_RESET macro[1].

[1] <a rel="nofollow" href="http://hg.mozilla.org/mozilla-central/file/5fd14a66be31/layout/style/nsRuleNode.h#l943">http://hg.mozilla.org/mozilla-central/file/5fd14a66be31/layout/style/nsRuleNode.h#l943</a>

Is this correct?</pre><div class="activity"><div class="change">Flags: needinfo?(cam)</div></div></div><div class="change-set" id="c17"><div class="comment" data-id="11547231" data-no="17"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-17" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_54040" id="a995902_165012"><img src="https://secure.gravatar.com/avatar/becfee04c4233fec739dd9cb43128591?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_54040" id="a995902_165012"><a class="email " href="/user_profile?user_id=54040" > <span class="fna">Cameron McCormack (:heycam)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-17"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-17" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c17">Comment 17</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-13 22:47 PDT" data-time="1468475244">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-17">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-17" data-comment-id="11547231">(In reply to Hiroyuki Ikezoe (:hiro) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - use-after-poison in nsFrameManager::CaptureFrameState"
   href="/show_bug.cgi?id=1282076#c16">comment #16</a>)
<span class="quote">&gt; Thank you, Cameron for detailed explanation!
&gt; 
&gt; (In reply to Cameron McCormack (:heycam) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - use-after-poison in nsFrameManager::CaptureFrameState"
   href="/show_bug.cgi?id=1282076#c15">comment #15</a>)
&gt; Initially I couldn't not understand what you mean, especially where the
&gt; reset struct pointers stores.  After digging into the code, if I understand
&gt; it correctly, I think you meant removing !(HasAnimationData() &amp;&amp;
&gt; ParentHasPseudoElementData(aContext)) in STYLE_STRUCT_RESET macro[1].
&gt; 
&gt; [1]
&gt; <a rel="nofollow" href="http://hg.mozilla.org/mozilla-central/file/5fd14a66be31/layout/style/">http://hg.mozilla.org/mozilla-central/file/5fd14a66be31/layout/style/</a>
&gt; nsRuleNode.h#l943
&gt; 
&gt; Is this correct?</span >

No, not removing this condition, since that would undo the fix from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Heap-use-after-free in nsFrame::DidSetStyleContext"
   href="/show_bug.cgi?id=1181011">bug 1181011</a>.  (It would mean that structs cached on the rule node get returned even if we have animation data in a pseudo-element, which was the problematic case.)

Here are all the places we currently cache a struct on the style context:

* <a rel="nofollow" href="http://searchfox.org/mozilla-central/rev/92616e983b8ad6e99ec148f341e146c3c6fa312a/layout/style/nsStyleContext.h#601-604">http://searchfox.org/mozilla-central/rev/92616e983b8ad6e99ec148f341e146c3c6fa312a/layout/style/nsStyleContext.h#601-604</a>
* <a rel="nofollow" href="http://searchfox.org/mozilla-central/rev/92616e983b8ad6e99ec148f341e146c3c6fa312a/layout/style/nsStyleContext.cpp#447-451">http://searchfox.org/mozilla-central/rev/92616e983b8ad6e99ec148f341e146c3c6fa312a/layout/style/nsStyleContext.cpp#447-451</a>

These are when we compute a new inherited struct, or get an existing one that was cached on the rule node.  We always cache inherited structs on the style context.

* <a rel="nofollow" href="http://searchfox.org/mozilla-central/rev/92616e983b8ad6e99ec148f341e146c3c6fa312a/layout/style/nsRuleNode.cpp#87-91">http://searchfox.org/mozilla-central/rev/92616e983b8ad6e99ec148f341e146c3c6fa312a/layout/style/nsRuleNode.cpp#87-91</a>

This is when we get an existing reset struct that was cached on the rule node with conditions.

* <a rel="nofollow" href="http://searchfox.org/mozilla-central/rev/92616e983b8ad6e99ec148f341e146c3c6fa312a/layout/style/nsRuleNode.cpp#2464-2473">http://searchfox.org/mozilla-central/rev/92616e983b8ad6e99ec148f341e146c3c6fa312a/layout/style/nsRuleNode.cpp#2464-2473</a>

This is when we are computing a new struct (inherited or reset), but we find we can just inherit the same struct from the parent style context.

* <a rel="nofollow" href="http://searchfox.org/mozilla-central/rev/92616e983b8ad6e99ec148f341e146c3c6fa312a/layout/style/nsRuleNode.cpp#2833-2841">http://searchfox.org/mozilla-central/rev/92616e983b8ad6e99ec148f341e146c3c6fa312a/layout/style/nsRuleNode.cpp#2833-2841</a>

This is when we just computed a new reset struct, which can be cached on the rule node with conditions.

* <a rel="nofollow" href="http://searchfox.org/mozilla-central/rev/92616e983b8ad6e99ec148f341e146c3c6fa312a/layout/style/nsRuleNode.cpp#2843-2845">http://searchfox.org/mozilla-central/rev/92616e983b8ad6e99ec148f341e146c3c6fa312a/layout/style/nsRuleNode.cpp#2843-2845</a>

This is when we just computed a new reset struct, and it can't be cached on the rule node.


These last two are in COMPUTE_END_RESET, so just when we finished computing a new reset struct.  It's the first case in this macro -- when we have a reset struct that can be cached on the rule node without conditions -- that we want to adjust so that it caches the struct on the style context too, if HasAnimationData() is true.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(cam)</span></div></div></div><div class="change-set" id="c18"><div class="comment" data-id="11547250" data-no="18"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-18" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_131213" id="a995902_165012"><img src="https://secure.gravatar.com/avatar/9ec516861853d265a973cd0ef66735cf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_131213" id="a995902_165012"><a class="email " href="/user_profile?user_id=131213" > <span class="fna">Hiroyuki Ikezoe (:hiro)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-18"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-18" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c18">Comment 18</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-13 23:02 PDT" data-time="1468476168">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-18">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-18" data-comment-id="11547250">(In reply to Cameron McCormack (:heycam) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - use-after-poison in nsFrameManager::CaptureFrameState"
   href="/show_bug.cgi?id=1282076#c17">comment #17</a>)
<span class="quote">&gt; <a rel="nofollow" href="http://searchfox.org/mozilla-central/rev/">http://searchfox.org/mozilla-central/rev/</a>
&gt; 92616e983b8ad6e99ec148f341e146c3c6fa312a/layout/style/nsRuleNode.cpp#2833-
&gt; 2841
&gt; 
&gt; This is when we just computed a new reset struct, which can be cached on the
&gt; rule node with conditions.
&gt; 
&gt; *
&gt; <a rel="nofollow" href="http://searchfox.org/mozilla-central/rev/">http://searchfox.org/mozilla-central/rev/</a>
&gt; 92616e983b8ad6e99ec148f341e146c3c6fa312a/layout/style/nsRuleNode.cpp#2843-
&gt; 2845
&gt; 
&gt; This is when we just computed a new reset struct, and it can't be cached on
&gt; the rule node.
&gt; 
&gt; 
&gt; These last two are in COMPUTE_END_RESET, so just when we finished computing
&gt; a new reset struct.  It's the first case in this macro -- when we have a
&gt; reset struct that can be cached on the rule node without conditions -- that
&gt; we want to adjust so that it caches the struct on the style context too, if
&gt; HasAnimationData() is true.</span >

Hmm, then I really don't understand it.  In the test case in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - use-after-poison in nsFrameManager::CaptureFrameState"
   href="/show_bug.cgi?id=1282076#c0">comment 0</a>, as far as I can confirm, COMPUTE_END_RESET for Display against an old nsStyleContext passed to CalcStyleDifferenct is not called between setTimeout() and 'o0.designMode='on'', it's called after document.execCommand('insertparagraph',false,null), but it's too late.</pre></div><div class="change-set" id="c19"><div class="comment" data-id="11547324" data-no="19"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-19" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_54040" id="a995902_165012"><img src="https://secure.gravatar.com/avatar/becfee04c4233fec739dd9cb43128591?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_54040" id="a995902_165012"><a class="email " href="/user_profile?user_id=54040" > <span class="fna">Cameron McCormack (:heycam)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-19"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-19" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c19">Comment 19</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-13 23:50 PDT" data-time="1468479009">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-19">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-19" data-comment-id="11547324">Maybe I misunderstood the problem then.  Looking through the test case, I think the element in question -- o577, the &lt;style&gt; element -- should have its Display struct computed during the flush that happens inside the scrollByLines() call.  Is this what happens?  (I don't have a build handy to test right now.)</pre></div><div class="change-set" id="c20"><div class="comment" data-id="11547352" data-no="20"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-20" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_131213" id="a995902_165012"><img src="https://secure.gravatar.com/avatar/9ec516861853d265a973cd0ef66735cf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_131213" id="a995902_165012"><a class="email " href="/user_profile?user_id=131213" > <span class="fna">Hiroyuki Ikezoe (:hiro)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-20"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-20" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c20">Comment 20</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-14 00:11 PDT" data-time="1468480316">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-20">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-20" data-comment-id="11547352">(In reply to Cameron McCormack (:heycam) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - use-after-poison in nsFrameManager::CaptureFrameState"
   href="/show_bug.cgi?id=1282076#c19">comment #19</a>)
<span class="quote">&gt; Maybe I misunderstood the problem then.  Looking through the test case, I
&gt; think the element in question -- o577, the &lt;style&gt; element -- should have
&gt; its Display struct computed during the flush that happens inside the
&gt; scrollByLines() call.  Is this what happens?  (I don't have a build handy to
&gt; test right now.)</span >

Yes, the style context at that time (the flush caused by scrollByLines) has a valid Display struct, but the style context is not the old style context passed to CalcStyleDifference.</pre></div><div class="change-set" id="c21"><div class="comment" data-id="11549475" data-no="21"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-21" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_131213" id="a995902_165012"><img src="https://secure.gravatar.com/avatar/9ec516861853d265a973cd0ef66735cf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_131213" id="a995902_165012"><a class="email " href="/user_profile?user_id=131213" > <span class="fna">Hiroyuki Ikezoe (:hiro)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-21"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-21" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c21">Comment 21</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-14 14:56 PDT" data-time="1468533396">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-21">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-21" data-comment-id="11549475">On IRC, Cameron taught me a lot of things to debug this issue.  I've been tracking down this issue with a fix suggested in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - use-after-poison in nsFrameManager::CaptureFrameState"
   href="/show_bug.cgi?id=1282076#c17">comment 17</a>.  I am still in the middle way, but found some interesting facts.

* Two style contexts are created for the same nsIFrame during the flush caused by scrollByLines().
 * The first one is maybe created in somewhere inside nsCSSFrameConstructor::ProcessChildren. This might be wrong, I couldn't track down where it exactly comes from.
 * The second one is created in RestyleManager::ReparentStyleContext.
  <a rel="nofollow" href="http://hg.mozilla.org/mozilla-central/file/08f8a5aacd83/layout/base/RestyleManager.cpp#l2385">http://hg.mozilla.org/mozilla-central/file/08f8a5aacd83/layout/base/RestyleManager.cpp#l2385</a>
* Two style context has the same rule node.
 * I don't know it's normal or not.
* StyleDisplay() is called against both of the style context.
 1. StyleDisplay() is called against the first style context.
 2. It leads to call nsRuleNode::WalkRuleTree and then COMPUTE_END_RESET.
 3. Display struct is stored in mStyleData.mResetData and is set against the *first style context*
 4. The second style is generated.
 5. StyleDisplay() is called against the second style context.
 6. It leads to call nsRuleNode::WalkRuleTree but not call COMPUTE_END_RESET because ...
 7. the rule node has the previous Display struct so we can get startStruct here, then .. 
   <a rel="nofollow" href="http://hg.mozilla.org/mozilla-central/file/08f8a5aacd83/layout/style/nsRuleNode.cpp#l2343">http://hg.mozilla.org/mozilla-central/file/08f8a5aacd83/layout/style/nsRuleNode.cpp#l2343</a>
 8. early return here
   <a rel="nofollow" href="http://hg.mozilla.org/mozilla-central/file/08f8a5aacd83/layout/style/nsRuleNode.cpp#l2431">http://hg.mozilla.org/mozilla-central/file/08f8a5aacd83/layout/style/nsRuleNode.cpp#l2431</a>
* This second style context is a problematic style context.  Its rule node has Display struct in mStyleData.mResetData but the style context itself does not have the Display struct. So
* PeekStyleDisplay() against the second style context returns nullptr because the second style context does not have the Display struct in mCachedResetData and the style context has animations inside a pseudo element.

Now I am inclined to conclude this issue is not related <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Heap-use-after-free in nsFrame::DidSetStyleContext"
   href="/show_bug.cgi?id=1181011">bug 1181011</a>. I think the issue has been in our code before <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Heap-use-after-free in nsFrame::DidSetStyleContext"
   href="/show_bug.cgi?id=1181011">bug 1181011</a>.

Two questions;
1) Is it normal behavior that multiple style contexts have the same rule node?
2) If so, don't we clear mStyleData.mResetData of the rule node when RestyleManager::ReparentStyleContext is called?

I should investigate further, but anyway, thank you Cameron for instructing me.</pre></div><div class="change-set" id="c22"><div class="comment" data-id="11549687" data-no="22"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-22" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_131213" id="a995902_165012"><img src="https://secure.gravatar.com/avatar/9ec516861853d265a973cd0ef66735cf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_131213" id="a995902_165012"><a class="email " href="/user_profile?user_id=131213" > <span class="fna">Hiroyuki Ikezoe (:hiro)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-22"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-22" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c22">Comment 22</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-14 16:35 PDT" data-time="1468539353">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-22">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-22" data-comment-id="11549687">(In reply to Hiroyuki Ikezoe (:hiro) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - use-after-poison in nsFrameManager::CaptureFrameState"
   href="/show_bug.cgi?id=1282076#c21">comment #21</a>)
<span class="quote">&gt; 
&gt; Two questions;
&gt; 1) Is it normal behavior that multiple style contexts have the same rule
&gt; node?</span >

This is normal case when reparenting style context.

<span class="quote">&gt; 2) If so, don't we clear mStyleData.mResetData of the rule node when
&gt; RestyleManager::ReparentStyleContext is called?</span >

I found an important comment.
<a rel="nofollow" href="http://hg.mozilla.org/mozilla-central/file/08f8a5aacd83/layout/base/RestyleManager.cpp#l2479">http://hg.mozilla.org/mozilla-central/file/08f8a5aacd83/layout/base/RestyleManager.cpp#l2479</a>

In this test case, position style is changed after reparenting context.  So a problem is inside position style code?</pre></div><div class="change-set" id="c23"><div class="comment" data-id="11549994" data-no="23"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-23" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_131213" id="a995902_165012"><img src="https://secure.gravatar.com/avatar/9ec516861853d265a973cd0ef66735cf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_131213" id="a995902_165012"><a class="email " href="/user_profile?user_id=131213" > <span class="fna">Hiroyuki Ikezoe (:hiro)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-23"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-23" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c23">Comment 23</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-14 20:24 PDT" data-time="1468553073">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-23">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-23" data-comment-id="11549994">(In reply to Hiroyuki Ikezoe (:hiro) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - use-after-poison in nsFrameManager::CaptureFrameState"
   href="/show_bug.cgi?id=1282076#c21">comment #21</a>)
<span class="quote">&gt; * StyleDisplay() is called against both of the style context.
&gt;  1. StyleDisplay() is called against the first style context.
&gt;  2. It leads to call nsRuleNode::WalkRuleTree and then COMPUTE_END_RESET.</span >

This was wrong. StyleDisplay() is called against other style context here　and it leads to call nsRuleNode::WalkRuleTree against the same rule node of the first style context.  Maybe the style context for body element?  I am confused.</pre></div><div class="change-set" id="c24"><div class="comment" data-id="11550024" data-no="24"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-24" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_131213" id="a995902_165012"><img src="https://secure.gravatar.com/avatar/9ec516861853d265a973cd0ef66735cf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_131213" id="a995902_165012"><a class="email " href="/user_profile?user_id=131213" > <span class="fna">Hiroyuki Ikezoe (:hiro)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-24"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-24" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c24">Comment 24</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-14 20:43 PDT" data-time="1468554182">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-24">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-24" data-comment-id="11550024">(In reply to Hiroyuki Ikezoe (:hiro) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - use-after-poison in nsFrameManager::CaptureFrameState"
   href="/show_bug.cgi?id=1282076#c23">comment #23</a>)
<span class="quote">&gt; (In reply to Hiroyuki Ikezoe (:hiro) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - use-after-poison in nsFrameManager::CaptureFrameState"
   href="/show_bug.cgi?id=1282076#c21">comment #21</a>)
&gt; &gt; * StyleDisplay() is called against both of the style context.
&gt; &gt;  1. StyleDisplay() is called against the first style context.
&gt; &gt;  2. It leads to call nsRuleNode::WalkRuleTree and then COMPUTE_END_RESET.
&gt; 
&gt; This was wrong. StyleDisplay() is called against other style context here
&gt; and it leads to call nsRuleNode::WalkRuleTree against the same rule node of
&gt; the first style context.  Maybe the style context for body element?  I am
&gt; confused.</span >

I am sorry for the confusion. The StyleDisplay() is actually called against a style context for an animated element (id=id2 in the test case) but not associated with the same nsIFrame of the other two style context.  I think this is the real first style context during ScrollByLines.</pre></div><div class="change-set" id="c25"><div class="comment" data-id="11550069" data-no="25"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-25" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_131213" id="a995902_165012"><img src="https://secure.gravatar.com/avatar/9ec516861853d265a973cd0ef66735cf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_131213" id="a995902_165012"><a class="email " href="/user_profile?user_id=131213" > <span class="fna">Hiroyuki Ikezoe (:hiro)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-25"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-25" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c25">Comment 25</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-14 21:20 PDT" data-time="1468556454">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-25">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-25" data-comment-id="11550069">We were setting the Display struct to the rule node here. So calling nsStyleContext::SetStyle in COMPUTE_END_RESET is not effective unfortunately.
<a rel="nofollow" href="http://searchfox.org/mozilla-central/source/layout/style/nsRuleNode.cpp#1744">http://searchfox.org/mozilla-central/source/layout/style/nsRuleNode.cpp#1744</a></pre></div><div class="change-set" id="c26"><div class="comment" data-id="11553449" data-no="26"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-26" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_131213" id="a995902_165012"><img src="https://secure.gravatar.com/avatar/9ec516861853d265a973cd0ef66735cf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_131213" id="a995902_165012"><a class="email " href="/user_profile?user_id=131213" > <span class="fna">Hiroyuki Ikezoe (:hiro)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-26"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-26" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c26">Comment 26</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-17 17:12 PDT" data-time="1468800741">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-26">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8771809"
         class="attachment patch obsolete"
         data-id="8771809" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="fix">
      <meta itemprop="contentSize" content="1485">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8771809">
          <a class="link" href="attachment.cgi?id=8771809&amp;action=diff">
        <span id="att-8771809-description" itemprop="description">Store the struct on the style context when we find the struct in cache inside WalkRuleTree</span></a> (obsolete)
        — <a href="attachment.cgi?id=8771809&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1282076&attachment=8771809">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-26" data-comment-id="11553449">Calling nsStyleContext::SetStyle() (with AddStyleBit) inside if (HasAnimationData()) check in STYLE_STRUCT_RESET, as Cameron suggested on IRC, causes memory leak (the struct pointer I think).  I got an assertion here.
<a rel="nofollow" href="http://hg.mozilla.org/mozilla-central/file/711963e8daa3/layout/base/nsPresShell.cpp#l840">http://hg.mozilla.org/mozilla-central/file/711963e8daa3/layout/base/nsPresShell.cpp#l840</a>

Calling nsStyleContext::SetStyle() without AddStyleBit causes another use-after-poison in nsStyleContext::StyleTextReset() in the test case <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - use-after-poison in nsFrameManager::CaptureFrameState"
   href="/show_bug.cgi?id=1282076#c0">comment 0</a>.

So I tried to move the call to nsRuleNode::GetStyleData(), and it failed with the same use-after-poison.  And then I moved the call to the place just before returning the struct found in mResetData in nsRuleNode::WalkRuleTree(), it does not cause any errors as far as I confirmed.  This patch is it.

To confirm that it does not cause any side-effets I did a try with this change.
<a rel="nofollow" href="https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=25fb69e1a8e8">https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=25fb69e1a8e8</a>

Of course our test cases might not cover failure cases, but I have no idea other than this.

Cameron, any thoughts?</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8768286&amp;action=edit"
           title="Force to call RequestRestyle when we have animations inside an pseudo element"
           class=""
        >Attachment #8768286</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8771809&amp;action=edit"
           title="Store the struct on the style context when we find the struct in cache inside WalkRuleTree"
           class=""
        >Attachment #8771809</a> -
        Flags: feedback?(cam)</div></div></div><div class="change-set" id="a2099384_75935"><div class="change" id="aa2099384_75935">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a2099384_75935"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_75935" id="a2099384_75935"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a2099384_75935"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a2099384_75935">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#a2099384_75935">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-18 14:20 PDT" data-time="1468876832">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox47&amp;o1=isnotempty">status-firefox47</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox47&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox47&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">Version: 50 Branch &rarr; 47 Branch</div></div></div><div class="change-set" id="a2099561_8519"><div class="change" id="aa2099561_8519">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_8519" id="a2099561_8519"><img src="https://secure.gravatar.com/avatar/cf7a6485ad75c35d66da0af6c88515d5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_8519" id="a2099561_8519"><a class="email " href="/user_profile?user_id=8519" > <span class="fna">Marcia Knous [:marcia]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a2099561_8519"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a2099561_8519">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#a2099561_8519">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-18 14:23 PDT" data-time="1468877009">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox47&amp;o1=isnotempty">tracking-firefox47</a>:
          <a href="/buglist.cgi?f1=cf_tracking_firefox47&amp;o1=equals&amp;v1=%3F">?</a> &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox47&amp;o1=equals&amp;v1=%2B">+</a></div></div></div><div class="change-set" id="a2100247_279663"><div class="change" id="aa2100247_279663">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_279663" id="a2100247_279663"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_279663" id="a2100247_279663"><a class="email " href="/user_profile?user_id=279663" > <span class="fna">Jim Mathies [:jimm]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a2100247_279663"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a2100247_279663">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#a2100247_279663">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-18 14:34 PDT" data-time="1468877695">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8771809&amp;action=edit"
           title="Store the struct on the style context when we find the struct in cache inside WalkRuleTree"
           class=""
        >Attachment #8771809</a> -
        Attachment is patch: true</div></div></div><div class="change-set" id="c27"><div class="comment" data-id="11557884" data-no="27"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-27" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_54040" id="a2100247_279663"><img src="https://secure.gravatar.com/avatar/becfee04c4233fec739dd9cb43128591?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_54040" id="a2100247_279663"><a class="email " href="/user_profile?user_id=54040" > <span class="fna">Cameron McCormack (:heycam)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-27"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-27" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c27">Comment 27</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-19 02:00 PDT" data-time="1468918804">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-27">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-27" data-comment-id="11557884">OK, so just to summarize my understanding, here are the codepaths under nsRuleNode::GetStyleData that nsStyleContext::StyleData can call into to get a non-inherited struct.

1. We have a non-inherited struct already stored on the rule node, and it's not the problematic case of a rule node with animation data and pseudo-element data.  We return the struct immediately, and don't set the bit.  nsStyleContext::GetStyleData doesn't cache the struct on the style context.

==&gt; This case needs changing, since we want all non-inherited structs that were stored on the rule node to be cached on the style context if we have animation data.  (Though I suppose this is not the case that triggers the problem in this bug, as you've identified that one in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - use-after-poison in nsFrameManager::CaptureFrameState"
   href="/show_bug.cgi?id=1282076#c26">comment 26</a>.)  To handle this, we can do

  if (HasAnimationData()) {
    aContext-&gt;AddStyleBit(...);
    aContext-&gt;SetStyle(...);
  }

like you do in your <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - use-after-poison in nsFrameManager::CaptureFrameState"
   href="/show_bug.cgi?id=1282076#c26">comment 26</a> patch.

2. nsRuleNode::GetStyleData calls into WalkRuleTree, and we return early with a struct from higher up in the rule tree (because we know that our rule node doesn't add any relevant properties), which is the case your <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - use-after-poison in nsFrameManager::CaptureFrameState"
   href="/show_bug.cgi?id=1282076#c26">comment 26</a> patch takes care of.  This change looks right.

3. WalkRuleTree finds we have |inherit| specified for all properties in the struct, and we |return parentStruct|.  The existing code there should be OK for non-inherited structs too.

4. We are computing structs for the root.  This doesn't need special handling.

5. WalkRuleTree computes a new struct, and in COMPUTE_END_RESET we decide we can cache it without dependencies.

==&gt; This case still needs changing, I think.  We need a block just like the <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - use-after-poison in nsFrameManager::CaptureFrameState"
   href="/show_bug.cgi?id=1282076#c26">comment 26</a> patch in here too.

6. WalkRuleTree computes a new struct, and in COMPUTE_END_RESET we decide we can cache it with dependencies.  The existing code here should be OK.

7. WalkRuleTree computes a new struct, and in COMPUTE_END_RESET we decide we can't cache it on the rule node.  The existing code here should be OK as we explicitly cache the struct on the style context.


So basically, any time we either look up an existing non-inherited struct cached on the rule node, or the rule node computes a new one that gets cached on the rule node too, and HasAnimationData() is true, we need to cache on the style context too.

It sounds like from your previous comment that the #5 change above was causing a leak, but I'm not sure why that is.  Can you show me the patch you had for that?  Also please try a patch that handles all three of these cases.  Thank you!</pre></div><div class="change-set" id="c28"><div class="comment" data-id="11558062" data-no="28"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-28" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_131213" id="a2100247_279663"><img src="https://secure.gravatar.com/avatar/9ec516861853d265a973cd0ef66735cf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_131213" id="a2100247_279663"><a class="email " href="/user_profile?user_id=131213" > <span class="fna">Hiroyuki Ikezoe (:hiro)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-28"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-28" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c28">Comment 28</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-19 03:33 PDT" data-time="1468924392">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-28">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-28" data-comment-id="11558062">Thank you, Cameron!

<a rel="nofollow" href="https://hg.mozilla.org/try/rev/4c8a65db67fa7bf0289b229dc788c4e9cf4762de">https://hg.mozilla.org/try/rev/4c8a65db67fa7bf0289b229dc788c4e9cf4762de</a>
Here is a try with all the three changes.
(In reply to Cameron McCormack (:heycam) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - use-after-poison in nsFrameManager::CaptureFrameState"
   href="/show_bug.cgi?id=1282076#c27">comment #27</a>)

<span class="quote">&gt; It sounds like from your previous comment that the #5 change above was
&gt; causing a leak, but I'm not sure why that is.  Can you show me the patch you
&gt; had for that? </span >

Actually the change which causes a leak is the change in STYLE_STRUCT_RESET macro.
<a rel="nofollow" href="https://hg.mozilla.org/try/rev/4c8a65db67fa7bf0289b229dc788c4e9cf4762de#l2.14">https://hg.mozilla.org/try/rev/4c8a65db67fa7bf0289b229dc788c4e9cf4762de#l2.14</a>

Though, in the changeset of the try, it also has a null check of newData, it results the same leak without the null check.  I did also add aComputeData check, it didn't help either.</pre></div><div class="change-set" id="c29"><div class="comment" data-id="11558095" data-no="29"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-29" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_54040" id="a2100247_279663"><img src="https://secure.gravatar.com/avatar/becfee04c4233fec739dd9cb43128591?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_54040" id="a2100247_279663"><a class="email " href="/user_profile?user_id=54040" > <span class="fna">Cameron McCormack (:heycam)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-29"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-29" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c29">Comment 29</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-19 03:55 PDT" data-time="1468925724">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-29">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-29" data-comment-id="11558095">I think the nsStyleStruct.h change you have in your patch needs to go inside the if statement in nsRuleNode::GetStyleData.  With the current location of that change, we will end up recording some newly computed structs that nsRuleNode returned with the bit set, meaning we won't delete it when the style context goes away.</pre></div><div class="change-set" id="c30"><div class="comment" data-id="11558151" data-no="30"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-30" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_131213" id="a2100247_279663"><img src="https://secure.gravatar.com/avatar/9ec516861853d265a973cd0ef66735cf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_131213" id="a2100247_279663"><a class="email " href="/user_profile?user_id=131213" > <span class="fna">Hiroyuki Ikezoe (:hiro)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-30"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-30" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c30">Comment 30</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-19 04:39 PDT" data-time="1468928397">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-30">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-30" data-comment-id="11558151">Ah, now I fully understand what you said.  The leak does not happen any more.

A new try.
<a rel="nofollow" href="https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=363dd896402e">https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=363dd896402e</a></pre></div><div class="change-set" id="c31"><div class="comment" data-id="11559986" data-no="31"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-31" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_131213" id="a2100247_279663"><img src="https://secure.gravatar.com/avatar/9ec516861853d265a973cd0ef66735cf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_131213" id="a2100247_279663"><a class="email " href="/user_profile?user_id=131213" > <span class="fna">Hiroyuki Ikezoe (:hiro)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-31"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-31" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c31">Comment 31</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-19 15:08 PDT" data-time="1468966112">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-31">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8772596"
         class="attachment patch obsolete"
         data-id="8772596" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="fix">
      <meta itemprop="contentSize" content="4501">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8772596">
          <a class="link" href="attachment.cgi?id=8772596&amp;action=diff">
        <span id="att-8772596-description" itemprop="description">Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data</span></a> (obsolete)
        — <a href="attachment.cgi?id=8772596&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1282076&attachment=8772596">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-31" data-comment-id="11559986">Thank you, Cameron. The try result seems good.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8771809&amp;action=edit"
           title="Store the struct on the style context when we find the struct in cache inside WalkRuleTree"
           class=""
        >Attachment #8771809</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8771809&amp;action=edit"
           title="Store the struct on the style context when we find the struct in cache inside WalkRuleTree"
           class=""
        >Attachment #8771809</a> -
        Flags: <span class="activity-deleted">feedback?(cam)</span></div><div class="change">
        <a href="/attachment.cgi?id=8772596&amp;action=edit"
           title="Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data"
           class=""
        >Attachment #8772596</a> -
        Flags: review?(cam)</div></div></div><div class="change-set" id="a2201904_54040"><div class="change" id="aa2201904_54040">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_54040" id="a2201904_54040"><img src="https://secure.gravatar.com/avatar/becfee04c4233fec739dd9cb43128591?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_54040" id="a2201904_54040"><a class="email " href="/user_profile?user_id=54040" > <span class="fna">Cameron McCormack (:heycam)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a2201904_54040"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a2201904_54040">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#a2201904_54040">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-19 18:49 PDT" data-time="1468979352">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8772596&amp;action=edit"
           title="Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data"
           class=""
        >Attachment #8772596</a> -
        Attachment is patch: true</div></div></div><div class="change-set" id="c32"><div class="comment" data-id="11560450" data-no="32"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-32" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_54040" id="a2201904_54040"><img src="https://secure.gravatar.com/avatar/becfee04c4233fec739dd9cb43128591?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_54040" id="a2201904_54040"><a class="email " href="/user_profile?user_id=54040" > <span class="fna">Cameron McCormack (:heycam)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-32"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-32" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c32">Comment 32</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-19 18:53 PDT" data-time="1468979595">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-32">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-32" data-comment-id="11560450">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8772596" name="attach_8772596" title="Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data">attachment 8772596</a> <a href="/attachment.cgi?id=8772596&amp;action=edit" title="Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data">[details]</a> <a href="/attachment.cgi?id=8772596&amp;action=diff" title="Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1282076&amp;attachment=8772596'>[review]</a>
Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8772596" name="attach_8772596" title="Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data">attachment 8772596</a> <a href="/attachment.cgi?id=8772596&amp;action=edit" title="Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data">[details]</a> <a href="/attachment.cgi?id=8772596&amp;action=diff" title="Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1282076&amp;attachment=8772596'>[review]</a>:
-----------------------------------------------------------------

Thanks, this is just about right.  A couple of things to address:

s/the we/we/ in the commit message.

::: layout/style/nsRuleNode.cpp
&#64;&#64; +2428,5 &#64;&#64;
<span class="quote">&gt;      if (!isReset) {
&gt;        aContext-&gt;AddStyleBit(nsCachedStyleData::GetBitForSID(aSID));
&gt; +    } else if (HasAnimationData()) {
&gt; +      // If we have animation data, the struct should be cached on the style
&gt; +      // context so that we can peek the struct.</span >

In this and the other comments, can you add &quot;See comment in AnimValuesStyleRule::MapRuleInfoInto&quot;.

&#64;&#64; +10284,5 &#64;&#64;
<span class="quote">&gt; +        // If we have animation data, the struct should be cached on the style
&gt; +        // context so that we can peek the struct.
&gt; +        aContext-&gt;AddStyleBit(nsCachedStyleData::GetBitForSID(aSID));
&gt; +        aContext-&gt;SetStyle(aSID, const_cast&lt;void*&gt;(data));
&gt; +      }</span >

We need to add this change to the macro-defined nsRuleNode::GetStyle##name_ functions, too (which I forgot to mention).</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8772596&amp;action=edit"
           title="Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data"
           class=""
        >Attachment #8772596</a> -
        Flags: review?(cam) &rarr; review-</div></div></div><div class="change-set" id="c33"><div class="comment" data-id="11560452" data-no="33"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-33" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_54040" id="a2201904_54040"><img src="https://secure.gravatar.com/avatar/becfee04c4233fec739dd9cb43128591?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_54040" id="a2201904_54040"><a class="email " href="/user_profile?user_id=54040" > <span class="fna">Cameron McCormack (:heycam)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-33"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-33" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c33">Comment 33</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-19 18:55 PDT" data-time="1468979728">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-33">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-33" data-comment-id="11560452"><span class="quote">&gt; We need to add this change to the macro-defined nsRuleNode::GetStyle##name_ functions,
&gt; too (which I forgot to mention).</span >

(But only for the non-inherited struct ones defined with STYLE_STRUCT_RESET.)</pre></div><div class="change-set" id="c34"><div class="comment" data-id="11560509" data-no="34"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-34" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_131213" id="a2201904_54040"><img src="https://secure.gravatar.com/avatar/9ec516861853d265a973cd0ef66735cf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_131213" id="a2201904_54040"><a class="email " href="/user_profile?user_id=131213" > <span class="fna">Hiroyuki Ikezoe (:hiro)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-34"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-34" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c34">Comment 34</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-19 20:03 PDT" data-time="1468983787">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-34">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8772662"
         class="attachment patch obsolete"
         data-id="8772662" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="fix">
      <meta itemprop="contentSize" content="8193">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8772662">
          <a class="link" href="attachment.cgi?id=8772662&amp;action=diff">
        <span id="att-8772662-description" itemprop="description">Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data</span></a> (obsolete)
        — <a href="attachment.cgi?id=8772662&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1282076&attachment=8772662">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-34" data-comment-id="11560509">Calling nsStyleContext's functions in nsRuleNode.h causes header inclusion hell.  I had to add a static function.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8772596&amp;action=edit"
           title="Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data"
           class=""
        >Attachment #8772596</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8772662&amp;action=edit"
           title="Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data"
           class=""
        >Attachment #8772662</a> -
        Flags: review?(cam)</div></div></div><div class="change-set" id="c35"><div class="comment" data-id="11560521" data-no="35"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-35" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_54040" id="a2201904_54040"><img src="https://secure.gravatar.com/avatar/becfee04c4233fec739dd9cb43128591?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_54040" id="a2201904_54040"><a class="email " href="/user_profile?user_id=54040" > <span class="fna">Cameron McCormack (:heycam)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-35"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-35" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c35">Comment 35</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-19 20:12 PDT" data-time="1468984366">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-35">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-35" data-comment-id="11560521">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8772662" name="attach_8772662" title="Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data">attachment 8772662</a> <a href="/attachment.cgi?id=8772662&amp;action=edit" title="Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data">[details]</a> <a href="/attachment.cgi?id=8772662&amp;action=diff" title="Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1282076&amp;attachment=8772662'>[review]</a>
Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8772662" name="attach_8772662" title="Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data">attachment 8772662</a> <a href="/attachment.cgi?id=8772662&amp;action=edit" title="Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data">[details]</a> <a href="/attachment.cgi?id=8772662&amp;action=diff" title="Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1282076&amp;attachment=8772662'>[review]</a>:
-----------------------------------------------------------------

r=me with this.  Thank you!

::: layout/style/nsRuleNode.h
&#64;&#64; +1073,5 &#64;&#64;
<span class="quote">&gt;                                      nsTimingFunction&amp; aResult);
&gt;  
&gt; +  // Store style struct on the style context and tell the style context
&gt; +  // that it doesn't own the data
&gt; +  static void StoreStyleOnContext(nsStyleContext* aContext,</span >

Let's make this private, since we only need to call it from within nsRuleNode methods.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8772662&amp;action=edit"
           title="Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data"
           class=""
        >Attachment #8772662</a> -
        Flags: review?(cam) &rarr; review+</div></div></div><div class="change-set" id="c36"><div class="comment" data-id="11560527" data-no="36"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-36" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_54040" id="a2201904_54040"><img src="https://secure.gravatar.com/avatar/becfee04c4233fec739dd9cb43128591?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_54040" id="a2201904_54040"><a class="email " href="/user_profile?user_id=54040" > <span class="fna">Cameron McCormack (:heycam)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-36"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-36" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c36">Comment 36</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-19 20:14 PDT" data-time="1468984452">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-36">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-36" data-comment-id="11560527">This is a regression from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Heap-use-after-free in nsFrame::DidSetStyleContext"
   href="/show_bug.cgi?id=1181011">bug 1181011</a>.</pre><div class="activity"><div class="change">Blocks: <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Heap-use-after-free in nsFrame::DidSetStyleContext"
   href="/show_bug.cgi?id=1181011">1181011</a></div></div></div><div class="change-set" id="c37"><div class="comment" data-id="11560769" data-no="37"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-37" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_131213" id="a2201904_54040"><img src="https://secure.gravatar.com/avatar/9ec516861853d265a973cd0ef66735cf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_131213" id="a2201904_54040"><a class="email " href="/user_profile?user_id=131213" > <span class="fna">Hiroyuki Ikezoe (:hiro)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-37"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-37" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c37">Comment 37</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-19 23:29 PDT" data-time="1468996174">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-37">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8772704"
         class="attachment patch"
         data-id="8772704" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="fix">
      <meta itemprop="contentSize" content="7894">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8772704">
          <a class="link" href="attachment.cgi?id=8772704&amp;action=diff">
        <span id="att-8772704-description" itemprop="description">Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data</span></a>
        — <a href="attachment.cgi?id=8772704&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1282076&attachment=8772704">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-37" data-comment-id="11560769">Made the static function private.  Carrying over review+.
<a rel="nofollow" href="https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=19308801b3c0">https://treeherder.mozilla.org/#/jobs?repo=try&amp;revision=19308801b3c0</a>

[Security approval request comment]
How easily could an exploit be constructed based on the patch?
* Not easily. 

Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
* No.

Which older supported branches are affected by this flaw?
* 45ESR.  The test case in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - use-after-poison in nsFrameManager::CaptureFrameState"
   href="/show_bug.cgi?id=1282076#c0">comment 0</a> does not affect 45ESR, but I think there are other cases to cause this use-after-poison on 45ESR.  It will be more difficult to attack though.

If not all supported branches, which bug introduced the flaw?
* <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Heap-use-after-free in nsFrame::DidSetStyleContext"
   href="/show_bug.cgi?id=1181011">Bug 1181011</a>.

Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
* Yes.  This patch can be applied to 45ESR.

How likely is this patch to cause regressions; how much testing does it need?
* Not likely.  It slightly increases memory consumption on sites that have animations, but it's negligible.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8772662&amp;action=edit"
           title="Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data"
           class=""
        >Attachment #8772662</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8772704&amp;action=edit"
           title="Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data"
           class=""
        >Attachment #8772704</a> -
        Flags: sec-approval?</div><div class="change">
        <a href="/attachment.cgi?id=8772704&amp;action=edit"
           title="Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data"
           class=""
        >Attachment #8772704</a> -
        Flags: review+</div></div></div><div class="change-set" id="c38"><div class="comment" data-id="11562417" data-no="38"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-38" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a2201904_54040"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_280903" id="a2201904_54040"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-38"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-38" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c38">Comment 38</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-20 09:59 PDT" data-time="1469033989">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-38">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-38" data-comment-id="11562417">I believe this is too late to make the current ESR45 or Firefox 48 releases. Sylvestre?</pre><div class="activity"><div class="change">Flags: needinfo?(sledru)</div></div></div><div class="change-set" id="c39"><div class="comment" data-id="11562424" data-no="39"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-39" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_495955" id="a2201904_54040"><img src="https://secure.gravatar.com/avatar/5aa2e382197a147b42d020b6878f8623?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_495955" id="a2201904_54040"><a class="email " href="/user_profile?user_id=495955" > <span class="fna">Sylvestre Ledru [:Sylvestre]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-39"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-39" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c39">Comment 39</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-20 10:01 PDT" data-time="1469034114">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-39">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-39" data-comment-id="11562424">The patch seems to touch important parts of the code: if we can wait, it would be better.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(sledru)</span></div></div></div><div class="change-set" id="c40"><div class="comment" data-id="11562476" data-no="40"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-40" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a2201904_54040"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_280903" id="a2201904_54040"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-40"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-40" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c40">Comment 40</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-20 10:17 PDT" data-time="1469035036">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-40">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-40" data-comment-id="11562476">Comment on <span class=""><a href="/attachment.cgi?id=8772704" name="attach_8772704" title="Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data">attachment 8772704</a> <a href="/attachment.cgi?id=8772704&amp;action=edit" title="Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data">[details]</a> <a href="/attachment.cgi?id=8772704&amp;action=diff" title="Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1282076&amp;attachment=8772704'>[review]</a>
Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data

sec-approval+ for trunk. Let's get an Aurora patch made and nominated as well (and in just after trunk).</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8772704&amp;action=edit"
           title="Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data"
           class=""
        >Attachment #8772704</a> -
        Flags: sec-approval? &rarr; sec-approval+</div></div></div><div class="change-set" id="c41"><div class="comment" data-id="11563551" data-no="41"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-41" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_131213" id="a2201904_54040"><img src="https://secure.gravatar.com/avatar/9ec516861853d265a973cd0ef66735cf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_131213" id="a2201904_54040"><a class="email " href="/user_profile?user_id=131213" > <span class="fna">Hiroyuki Ikezoe (:hiro)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-41"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-41" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c41">Comment 41</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-20 15:16 PDT" data-time="1469052988">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-41">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-41" data-comment-id="11563551"><a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/f2cfc74a93beafabdd057fc6e1b4582baa9bb078">https://hg.mozilla.org/integration/mozilla-inbound/rev/f2cfc74a93beafabdd057fc6e1b4582baa9bb078</a>
<a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - use-after-poison in nsFrameManager::CaptureFrameState"
   href="/show_bug.cgi?id=1282076">Bug 1282076</a> - Store all non-inherited structs which are stored on the rule node on the style context if we have animation data. r=heycam</pre></div><div class="change-set" id="c42"><div class="comment" data-id="11564020" data-no="42"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-42" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_131213" id="a2201904_54040"><img src="https://secure.gravatar.com/avatar/9ec516861853d265a973cd0ef66735cf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_131213" id="a2201904_54040"><a class="email " href="/user_profile?user_id=131213" > <span class="fna">Hiroyuki Ikezoe (:hiro)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-42"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-42" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c42">Comment 42</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-20 20:05 PDT" data-time="1469070351">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-42">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-42" data-comment-id="11564020">Comment on <span class=""><a href="/attachment.cgi?id=8772704" name="attach_8772704" title="Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data">attachment 8772704</a> <a href="/attachment.cgi?id=8772704&amp;action=edit" title="Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data">[details]</a> <a href="/attachment.cgi?id=8772704&amp;action=diff" title="Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1282076&amp;attachment=8772704'>[review]</a>
Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data

Approval Request Comment
[Feature/regressing bug #]: <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Heap-use-after-free in nsFrame::DidSetStyleContext"
   href="/show_bug.cgi?id=1181011">bug 1181011</a>
[User impact if declined]: A security hole caused by use-after-poison.
[Describe test coverage new/current, TreeHerder]: Not included in this patch.  Two test cases (in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - use-after-poison in nsFrameManager::CaptureFrameState"
   href="/show_bug.cgi?id=1282076#c0">comment 0</a> and <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - use-after-poison in nsFrameManager::CaptureFrameState"
   href="/show_bug.cgi?id=1282076#c5">comment 5</a>) will land after this bug is in public.  I've confirmed that both of the test cases work fine locally.
[Risks and why]: Low, it essentially increases memory consumption, but it's negligible.
[String/UUID change made/needed]: None</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8772704&amp;action=edit"
           title="Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data"
           class=""
        >Attachment #8772704</a> -
        Flags: approval-mozilla-aurora?</div></div></div><div class="change-set" id="c43"><div class="comment" data-id="11565306" data-no="43"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-43" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_277293" id="a2201904_54040"><img src="https://secure.gravatar.com/avatar/8378311bf1bd5e9eddc7896a07688876?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_277293" id="a2201904_54040"><a class="email disabled" href="/user_profile?user_id=277293" > <span class="fna">Carsten Book [:Tomcat]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-43"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-43" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c43">Comment 43</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-21 07:42 PDT" data-time="1469112146">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-43">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-43" data-comment-id="11565306"><a rel="nofollow" href="https://hg.mozilla.org/mozilla-central/rev/f2cfc74a93be">https://hg.mozilla.org/mozilla-central/rev/f2cfc74a93be</a></pre><div class="activity"><div class="change">Status: ASSIGNED &rarr; RESOLVED</div><div class="change">Closed: <span class="rel-time" title="2016-07-21 07:42 PDT" data-time="1469112146">5 years ago</span></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox50&amp;o1=isnotempty">status-firefox50</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox50&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox50&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">Resolution: --- &rarr; FIXED</div><div class="change">Target Milestone: --- &rarr; mozilla50</div></div></div><div class="change-set" id="a2361133_280903"><div class="change" id="aa2361133_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a2361133_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a2361133_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a2361133_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a2361133_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#a2361133_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-21 15:03 PDT" data-time="1469138581">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8772704&amp;action=edit"
           title="Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data"
           class=""
        >Attachment #8772704</a> -
        Flags: approval-mozilla-aurora? &rarr; approval-mozilla-aurora+</div></div></div><div class="change-set" id="c44"><div class="comment" data-id="11567493" data-no="44"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-44" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_131213" id="a2361133_280903"><img src="https://secure.gravatar.com/avatar/9ec516861853d265a973cd0ef66735cf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_131213" id="a2361133_280903"><a class="email " href="/user_profile?user_id=131213" > <span class="fna">Hiroyuki Ikezoe (:hiro)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-44"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-44" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c44">Comment 44</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-21 23:11 PDT" data-time="1469167865">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-44">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-44" data-comment-id="11567493"><a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-aurora/rev/f8e3b85fd772">https://hg.mozilla.org/releases/mozilla-aurora/rev/f8e3b85fd772</a></pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox49&amp;o1=isnotempty">status-firefox49</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox49&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox49&amp;o1=equals&amp;v1=fixed">fixed</a></div></div></div><div class="change-set" id="c45"><div class="comment" data-id="11574055" data-no="45"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-45" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_165012" id="a2361133_280903"><img src="https://secure.gravatar.com/avatar/b21107bc66be7d2aefff1fb59d5d8bae?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_165012" id="a2361133_280903"><a class="email " href="/user_profile?user_id=165012" > <span class="fna">Brian Birtles (:birtles)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-45"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-45" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c45">Comment 45</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-25 16:33 PDT" data-time="1469489621">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-45">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-45" data-comment-id="11574055">I assume from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - use-after-poison in nsFrameManager::CaptureFrameState"
   href="/show_bug.cgi?id=1282076#c38">comment 38</a> and <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - use-after-poison in nsFrameManager::CaptureFrameState"
   href="/show_bug.cgi?id=1282076#c39">comment 39</a> this should be status-firefox48: wontfix?</pre></div><div class="change-set" id="a3045079_1689"><div class="change" id="aa3045079_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a3045079_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a3045079_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a3045079_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a3045079_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#a3045079_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-29 13:02 PDT" data-time="1469822527">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: layout-core-security &rarr; core-security-release</div></div></div><div class="change-set" id="c46"><div class="comment" data-id="11589633" data-no="46"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-46" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_495955" id="a3045079_1689"><img src="https://secure.gravatar.com/avatar/5aa2e382197a147b42d020b6878f8623?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_495955" id="a3045079_1689"><a class="email " href="/user_profile?user_id=495955" > <span class="fna">Sylvestre Ledru [:Sylvestre]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-46"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-46" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c46">Comment 46</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-08-01 09:44 PDT" data-time="1470069862">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-46">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-46" data-comment-id="11589633">indeed, thanks</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox48&amp;o1=isnotempty">status-firefox48</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox48&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox48&amp;o1=equals&amp;v1=wontfix">wontfix</a></div></div></div><div class="change-set" id="a3397889_280903"><div class="change" id="aa3397889_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a3397889_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a3397889_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a3397889_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a3397889_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#a3397889_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-08-02 15:02 PDT" data-time="1470175337">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: sec-bounty?</div></div></div><div class="change-set" id="a3900541_1689"><div class="change" id="aa3900541_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a3900541_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a3900541_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a3900541_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a3900541_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#a3900541_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-08-08 10:39 PDT" data-time="1470677989">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=isnotempty">status-firefox-esr45</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=equals&amp;v1=unaffected">unaffected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr45&amp;o1=isnotempty">tracking-firefox-esr45</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox_esr45&amp;o1=equals&amp;v1=49%2B">49+</a></div><div class="change">Flags: sec-bounty? &rarr; sec-bounty+</div></div></div><div class="change-set" id="c47"><div class="comment" data-id="11608738" data-no="47"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-47" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_165012" id="a3900541_1689"><img src="https://secure.gravatar.com/avatar/b21107bc66be7d2aefff1fb59d5d8bae?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_165012" id="a3900541_1689"><a class="email " href="/user_profile?user_id=165012" > <span class="fna">Brian Birtles (:birtles)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-47"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-47" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c47">Comment 47</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-08-08 15:59 PDT" data-time="1470697153">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-47">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-47" data-comment-id="11608738">Is ESR45 really affected? This bug was introduced by <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - nsAnimationManager::CheckAnimationRule should not create temporary animations"
   href="/show_bug.cgi?id=1242872">bug 1242872</a> in Firefox 47 and not uplifted anywhere as far as I can see--but perhaps I'm misunderstanding something about our ESR releases.</pre><div class="activity"><div class="change">Flags: needinfo?(dveditz)</div></div></div><div class="change-set" id="c48"><div class="comment" data-id="11608744" data-no="48"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-48" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_165012" id="a3900541_1689"><img src="https://secure.gravatar.com/avatar/b21107bc66be7d2aefff1fb59d5d8bae?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_165012" id="a3900541_1689"><a class="email " href="/user_profile?user_id=165012" > <span class="fna">Brian Birtles (:birtles)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-48"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-48" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c48">Comment 48</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-08-08 16:00 PDT" data-time="1470697216">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-48">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-48" data-comment-id="11608744">(In reply to Brian Birtles (:birtles) from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - use-after-poison in nsFrameManager::CaptureFrameState"
   href="/show_bug.cgi?id=1282076#c47">comment #47</a>)
<span class="quote">&gt; Is ESR45 really affected? This bug was introduced by <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - nsAnimationManager::CheckAnimationRule should not create temporary animations"
   href="/show_bug.cgi?id=1242872">bug 1242872</a> in Firefox
&gt; 47 and not uplifted anywhere as far as I can see--but perhaps I'm
&gt; misunderstanding something about our ESR releases.</span >

Nevermind, I see <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - use-after-poison in nsFrameManager::CaptureFrameState"
   href="/show_bug.cgi?id=1282076#c37">comment 37</a> now.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(dveditz)</span></div></div></div><div class="change-set" id="c49"><div class="comment" data-id="11662789" data-no="49"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-49" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_495955" id="a3900541_1689"><img src="https://secure.gravatar.com/avatar/5aa2e382197a147b42d020b6878f8623?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_495955" id="a3900541_1689"><a class="email " href="/user_profile?user_id=495955" > <span class="fna">Sylvestre Ledru [:Sylvestre]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-49"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-49" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c49">Comment 49</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-08-29 03:04 PDT" data-time="1472465098">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-49">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-49" data-comment-id="11662789">Hiro, can we have an uplift request to esr45? Thanks</pre><div class="activity"><div class="change">Flags: needinfo?(hiikezoe)</div></div></div><div class="change-set" id="c50"><div class="comment" data-id="11662816" data-no="50"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-50" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_131213" id="a3900541_1689"><img src="https://secure.gravatar.com/avatar/9ec516861853d265a973cd0ef66735cf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_131213" id="a3900541_1689"><a class="email " href="/user_profile?user_id=131213" > <span class="fna">Hiroyuki Ikezoe (:hiro)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-50"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-50" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c50">Comment 50</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-08-29 03:20 PDT" data-time="1472466044">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-50">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-50" data-comment-id="11662816">Comment on <span class=""><a href="/attachment.cgi?id=8772704" name="attach_8772704" title="Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data">attachment 8772704</a> <a href="/attachment.cgi?id=8772704&amp;action=edit" title="Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data">[details]</a> <a href="/attachment.cgi?id=8772704&amp;action=diff" title="Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1282076&amp;attachment=8772704'>[review]</a>
Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data

[Approval Request Comment]
User impact if declined: A security hole caused by use-after-poison.
Fix Landed on Version: 49
Risk to taking this patch (and alternatives if risky):  Low, this patch has been landed on mozilla-central and 49 branch for a while and the patch slightly increases memory consumption.
String or UUID changes made by this patch: none</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(hiikezoe)</span></div><div class="change">
        <a href="/attachment.cgi?id=8772704&amp;action=edit"
           title="Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data"
           class=""
        >Attachment #8772704</a> -
        Flags: approval-mozilla-esr45?</div></div></div><div class="change-set" id="c51"><div class="comment" data-id="11662828" data-no="51"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-51" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_495955" id="a3900541_1689"><img src="https://secure.gravatar.com/avatar/5aa2e382197a147b42d020b6878f8623?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_495955" id="a3900541_1689"><a class="email " href="/user_profile?user_id=495955" > <span class="fna">Sylvestre Ledru [:Sylvestre]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-51"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-51" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c51">Comment 51</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-08-29 03:23 PDT" data-time="1472466212">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-51">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-51" data-comment-id="11662828">Comment on <span class=""><a href="/attachment.cgi?id=8772704" name="attach_8772704" title="Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data">attachment 8772704</a> <a href="/attachment.cgi?id=8772704&amp;action=edit" title="Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data">[details]</a> <a href="/attachment.cgi?id=8772704&amp;action=diff" title="Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1282076&amp;attachment=8772704'>[review]</a>
Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data

Let's take it in esr45, should be in 45.4</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8772704&amp;action=edit"
           title="Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data"
           class=""
        >Attachment #8772704</a> -
        Flags: approval-mozilla-esr45? &rarr; approval-mozilla-esr45+</div></div></div><div class="change-set" id="c52"><div class="comment" data-id="11663881" data-no="52"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-52" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_308534" id="a3900541_1689"><img src="https://secure.gravatar.com/avatar/bb55b2a8c34fd29f570ca139f13d46b8?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_308534" id="a3900541_1689"><a class="email " href="/user_profile?user_id=308534" > <span class="fna">Wes Kocher (:KWierso) (Not reading bugmail; email directly if needed)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-52"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-52" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c52">Comment 52</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-08-29 10:29 PDT" data-time="1472491777">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-52">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-52" data-comment-id="11663881"><a rel="nofollow" href="https://hg.mozilla.org/releases/mozilla-esr45/rev/10c9453407de">https://hg.mozilla.org/releases/mozilla-esr45/rev/10c9453407de</a></pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=isnotempty">status-firefox-esr45</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=equals&amp;v1=fixed">fixed</a></div></div></div><div class="change-set" id="a6374325_488993"><div class="change" id="aa6374325_488993">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_488993" id="a6374325_488993"><img src="https://secure.gravatar.com/avatar/42f2a9436bbaefa7e0028e214f2b9350?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_488993" id="a6374325_488993"><a class="email " href="/user_profile?user_id=488993" > <span class="fna">Andrei Vaida [:avaida]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a6374325_488993"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a6374325_488993">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#a6374325_488993">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-06 01:49 PDT" data-time="1473151773">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: qe-verify+</div></div></div><div class="change-set" id="c53"><div class="comment" data-id="11687992" data-no="53"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-53" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_428011" id="a6374325_488993"><img src="https://secure.gravatar.com/avatar/fd3242e15b9650c3201bd4d41f5beef6?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_428011" id="a6374325_488993"><a class="email " href="/user_profile?user_id=428011" > <span class="fna">Paul Silaghi, QA [:pauly]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-53"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-53" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c53">Comment 53</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-06 04:04 PDT" data-time="1473159859">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-53">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-53" data-comment-id="11687992">Reproduced the crash on FX 48.0.2.
Verified fixed FX 49.0, 50.0a2 (2016-09-05), 45.4.0 ESR on Win 7, Ubuntu 14.04, OS X 10.11.</pre><div class="activity"><div class="change">Status: RESOLVED &rarr; VERIFIED</div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox49&amp;o1=isnotempty">status-firefox49</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox49&amp;o1=equals&amp;v1=fixed">fixed</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox49&amp;o1=equals&amp;v1=verified">verified</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox50&amp;o1=isnotempty">status-firefox50</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox50&amp;o1=equals&amp;v1=fixed">fixed</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox50&amp;o1=equals&amp;v1=verified">verified</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=isnotempty">status-firefox-esr45</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=equals&amp;v1=fixed">fixed</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr45&amp;o1=equals&amp;v1=verified">verified</a></div></div></div><div class="change-set" id="a6429491_280903"><div class="change" id="aa6429491_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a6429491_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a6429491_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a6429491_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a6429491_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#a6429491_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-06 17:08 PDT" data-time="1473206939">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: [adv-main49+][adv-esr45.4+]</div></div></div><div class="change-set" id="a6513619_280903"><div class="change" id="aa6513619_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a6513619_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a6513619_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a6513619_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a6513619_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#a6513619_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-07 16:31 PDT" data-time="1473291067">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Alias: CVE-2016-5274</div></div></div><div class="change-set" id="c54"><div class="comment" data-id="11728367" data-no="54"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-54" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_131213" id="a6513619_280903"><img src="https://secure.gravatar.com/avatar/9ec516861853d265a973cd0ef66735cf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_131213" id="a6513619_280903"><a class="email " href="/user_profile?user_id=131213" > <span class="fna">Hiroyuki Ikezoe (:hiro)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-54"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-54" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c54">Comment 54</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-21 23:46 PDT" data-time="1474526781">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-54">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8793634"
         class="attachment patch"
         data-id="8793634" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="testBug1282076.patch">
      <meta itemprop="contentSize" content="4696">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8793634">
          <a class="link" href="attachment.cgi?id=8793634&amp;action=diff">
        <span id="att-8793634-description" itemprop="description">Crash tests</span></a>
        — <a href="attachment.cgi?id=8793634&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1282076&attachment=8793634">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-54" data-comment-id="11728367">Firefox 48 and ESR 45.4.0 have been released. Now I think it's time to land test cases.

This includes a test case in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - use-after-poison in nsFrameManager::CaptureFrameState"
   href="/show_bug.cgi?id=1282076#c0">comment 0</a> and <span class=""><a href="/attachment.cgi?id=8767517" name="attach_8767517" title="Web animations' test case">attachment 8767517</a> <a href="/attachment.cgi?id=8767517&amp;action=edit" title="Web animations' test case">[details]</a></span>.  An interesting fact is that current mozilla-central does not cause this use-after-poison even if the fix (<span class=""><a href="/attachment.cgi?id=8772704" name="attach_8772704" title="Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data">attachment 8772704</a> <a href="/attachment.cgi?id=8772704&amp;action=edit" title="Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data">[details]</a> <a href="/attachment.cgi?id=8772704&amp;action=diff" title="Store all non-inherited structs which are stored on the rule node on the style context if the we have animation data">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1282076&amp;attachment=8772704'>[review]</a>) is reverted but it's worth to add test cases.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8793634&amp;action=edit"
           title="Crash tests"
           class=""
        >Attachment #8793634</a> -
        Flags: review?(cam)</div></div></div><div class="change-set" id="c55"><div class="comment" data-id="11728378" data-no="55"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-55" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_54040" id="a6513619_280903"><img src="https://secure.gravatar.com/avatar/becfee04c4233fec739dd9cb43128591?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_54040" id="a6513619_280903"><a class="email " href="/user_profile?user_id=54040" > <span class="fna">Cameron McCormack (:heycam)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-55"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-55" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c55">Comment 55</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-21 23:52 PDT" data-time="1474527161">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-55">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-55" data-comment-id="11728378">Comment on <span class=""><a href="/attachment.cgi?id=8793634" name="attach_8793634" title="Crash tests">attachment 8793634</a> <a href="/attachment.cgi?id=8793634&amp;action=edit" title="Crash tests">[details]</a> <a href="/attachment.cgi?id=8793634&amp;action=diff" title="Crash tests">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1282076&amp;attachment=8793634'>[review]</a>
Crash tests

Review of <span class=""><a href="/attachment.cgi?id=8793634" name="attach_8793634" title="Crash tests">attachment 8793634</a> <a href="/attachment.cgi?id=8793634&amp;action=edit" title="Crash tests">[details]</a> <a href="/attachment.cgi?id=8793634&amp;action=diff" title="Crash tests">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1282076&amp;attachment=8793634'>[review]</a>:
-----------------------------------------------------------------

<span class="quote">&gt; Firefox 48 and ESR 45.4.0 have been released.</span >

(Firefox 49.)  r=me with a suitable commit message.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8793634&amp;action=edit"
           title="Crash tests"
           class=""
        >Attachment #8793634</a> -
        Flags: review?(cam) &rarr; review+</div></div></div><div class="change-set" id="c56"><div class="comment" data-id="11730930" data-no="56"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-56" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_131213" id="a6513619_280903"><img src="https://secure.gravatar.com/avatar/9ec516861853d265a973cd0ef66735cf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_131213" id="a6513619_280903"><a class="email " href="/user_profile?user_id=131213" > <span class="fna">Hiroyuki Ikezoe (:hiro)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-56"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-56" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c56">Comment 56</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-22 14:27 PDT" data-time="1474579677">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-56">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-56" data-comment-id="11730930"><a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/fd2b75b3e3ff85f25ffbe9166db4b1f0a93a8a09">https://hg.mozilla.org/integration/mozilla-inbound/rev/fd2b75b3e3ff85f25ffbe9166db4b1f0a93a8a09</a>
<a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - use-after-poison in nsFrameManager::CaptureFrameState"
   href="/show_bug.cgi?id=1282076">Bug 1282076</a> - Crashtest that struct data is cached if we have animation data. r=heycam</pre></div><div class="change-set" id="c57"><div class="comment" data-id="11732261" data-no="57"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-57" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_277293" id="a6513619_280903"><img src="https://secure.gravatar.com/avatar/8378311bf1bd5e9eddc7896a07688876?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_277293" id="a6513619_280903"><a class="email disabled" href="/user_profile?user_id=277293" > <span class="fna">Carsten Book [:Tomcat]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-57"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-57" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#c57">Comment 57</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-09-23 03:35 PDT" data-time="1474626927">5 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-57">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-57" data-comment-id="11732261"><a rel="nofollow" href="https://hg.mozilla.org/mozilla-central/rev/fd2b75b3e3ff">https://hg.mozilla.org/mozilla-central/rev/fd2b75b3e3ff</a></pre><div class="activity"><div class="change">Flags: in-testsuite? &rarr; in-testsuite+</div></div></div><div class="change-set" id="a19878310_1689"><div class="change" id="aa19878310_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a19878310_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a19878310_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a19878310_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a19878310_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1282076#a19878310_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2017-02-09 07:55 PST" data-time="1486655758">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: <span class="activity-deleted">core-security-release</span></div></div></div><div id="new-comment-notice">
          You need to <a href="/show_bug.cgi?id=1282076&amp;GoAheadAndLogIn=1">log in</a>
          before you can comment on or make changes to this bug.
        </div>



<div id="bottom-actions">
  <div id="bottom-right-actions">
    <button type="button" id="top-btn" class="secondary" aria-label="Go to Page Top">Top &uarr;</button>
  </div>
</div></div> 
</main> 
</div> 


</body>
</html>