<!DOCTYPE html>
















































<html class="hasSidebar hasPageActions hasBreadcrumb conceptual has-default-focus theme-light" lang="en-us" dir="ltr" data-css-variable-support="true" data-authenticated="false" data-auth-status-determined="false" data-target="docs" x-ms-format-detection="none">

<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<meta property="og:title" content="Microsoft Security Bulletin MS02-001 - Moderate" />
	<meta property="og:type" content="website" />
	<meta property="og:url" content="https://docs.microsoft.com/en-us/security-updates/securitybulletins/2002/ms02-001" />

	<meta name="twitter:card" content="summary" />

	<meta name="twitter:site" content="@docsmsft" />

	<meta name="color-scheme" content="light dark">


	<meta name="author" content="BetaFred" />
<meta name="breadcrumb_path" content="/security-updates/breadcrumb/toc.json" />
<meta name="depot_name" content="Security.security-updates" />
<meta name="document_id" content="953b94a1-ab62-279b-f4fe-c5a7f43ee23c" />
<meta name="document_version_independent_id" content="534be797-cfc8-525b-3039-10a5b9d0c705" />
<meta name="gitcommit" content="https://github.com/MicrosoftDocs/security-updates/blob/6dc3a10875edd52e4c959c02578f535867f7c5c4/security-updates/SecurityBulletins/2002/ms02-001.md" />
<meta name="locale" content="en-us" />
<meta name="ms.author" content="BetaFred" />
<meta name="ms.date" content="10/11/2017" />
<meta name="ms.service" content="security-updates" />
<meta name="ms.topic" content="article" />
<meta name="ms:assetid" content="ms02-001" />
<meta name="ms:contentKeyID" content="61221895" />
<meta name="ms:mtpsurl" content="https://technet.microsoft.com/en-us/library/ms02-001(v=Security.10)" />
<meta name="original_content_git_url" content="https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletins/2002/ms02-001.md" />
<meta name="schema" content="Conceptual" />
<meta name="site_name" content="Docs" />
<meta name="Title" content="Microsoft Security Bulletin MS02-001 - Moderate" />
<meta name="TOCTitle" content="MS02-001" />
<meta name="updated_at" content="2017-11-11 12:46 AM" />
<meta name="page_type" content="conceptual" />
<meta name="toc_rel" content="../../toc.json" />
<meta name="word_count" content="4544" />


<link href="https://docs.microsoft.com/en-us/security-updates/securitybulletins/2002/ms02-001" rel="canonical">
	<title>Microsoft Security Bulletin MS02-001 - Moderate | Microsoft Docs</title>

		<link rel="stylesheet" href="/_themes/docs.theme/master/en-us/_themes/styles/46dad2a9.site-ltr.css ">

	

	<script id="msdocs-script">
	var msDocs = {
		data: {
			timeOrigin: Date.now(),
			contentLocale: 'en-us',
			contentDir: 'ltr',
			userLocale: 'en-us',
			userDir: 'ltr',
			pageTemplate: 'Conceptual',
			brand: '',
			context: {

			},
			hasBinaryRating: true,
			hasGithubIssues: false,
			showFeedbackReport: false,
			enableTutorialFeedback: false,
			feedbackSystem: 'None',
			feedbackGitHubRepo: '',
			feedbackProductUrl: '',
			contentGitUrl: 'https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletins/2002/ms02-001.md',
			extendBreadcrumb: true,
			isEditDisplayable: false,
			hideViewSource: false,
			hasPageActions: true,
			hasBookmark: true,
			hasShare: true,
			hasRecommendations: true,
			contributors: [
						{ name: "BetaFred", url: "https://github.com/BetaFred" },
						{ name: "Santoshtambe", url: "https://github.com/Santoshtambe" }
],
		},
		functions:{}
	};
	</script>
	<script src="https://wcpstatic.microsoft.com/mscc/lib/v2/wcp-consent.js"></script>
	<script src="https://js.monitor.azure.com/scripts/c/ms.jsll-3.min.js"></script>

	<script src="/_themes/docs.theme/master/en-us/_themes/global/5cce29c0.deprecation.js"></script>
		<script src="/_themes/docs.theme/master/en-us/_themes/scripts/bb2ae21c.index-docs.js"></script>
</head>

<body lang="en-us" dir="ltr">
	<div class="header-holder has-default-focus">
		<a href="#main" class="skip-to-main-link has-outline-color-text visually-hidden-until-focused position-fixed has-inner-focus focus-visible top-0 left-0 right-0 padding-xs has-text-centered has-body-background" tabindex="1">Skip to main content</a>

		<div hidden id="cookie-consent-holder"></div>

		<div id="unsupported-browser" style="
			background-color: white;
			color: black;
			padding: 16px;
			border-bottom: 1px solid grey;"
			hidden
		>
			<div style="max-width: 800px; margin: 0 auto;">
				<p style="font-size: 24px">This browser is no longer supported.</p>
				<p style="font-size: 16px; margin-top: 16px;">Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.</p>
				<div style="margin-top: 12px;">
					<a href="https://go.microsoft.com/fwlink/p/?LinkID=2092881 "
						style="
						background-color: #0078d4;
						border: 1px solid #0078d4;
						color: white;
						padding: 6px 12px;
						border-radius: 2px;
						display: inline-block;
						">
Download Microsoft Edge					</a>
					<a href="https://docs.microsoft.com/en-US/lifecycle/faq/internet-explorer-microsoft-edge"
						style="
							background-color: white;
							padding: 6px 12px;
							border: 1px solid #505050;
							color: #171717;
							border-radius: 2px;
							display: inline-block;
							">
More info					</a>
				</div>
			</div>

		</div>
		<!-- liquid-tag banners global -->
		<div id="headerAreaHolder" data-bi-name="header">
<header role="banner" itemscope="itemscope" itemtype="http://schema.org/Organization">
	<div class="nav-bar">
		<div class="nav-bar-brand">
			<a itemprop="url" href="https://www.microsoft.com" aria-label="Microsoft" class="nav-bar-button">
				<div class="nav-bar-logo has-background-image theme-display is-light" role="presentation" aria-hidden="true" itemprop="logo" itemscope="itemscope"></div>
				<div class="nav-bar-logo has-background-image theme-display is-dark is-high-contrast" role="presentation" aria-hidden="true" itemprop="logo" itemscope="itemscope"></div>
			</a>
		</div>
	</div>
	<div class="is-hidden"></div>
</header>		</div>

						<div class="content-header uhf-container has-padding has-default-focus border-bottom-none" data-bi-name="content-header">
					<nav class="breadcrumb-holder has-padding-none has-padding-left-medium-tablet has-padding-right-medium-tablet has-padding-left-none-uhf-tablet has-padding-left-none-uhf-tablet has-padding-none-desktop flex-grow-1" data-bi-name="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList" role="navigation" aria-label="Breadcrumb">
						<ul id="page-breadcrumbs" class="breadcrumbs">
						</ul>
					</nav>
				<div class="content-header-controls">
					<button type="button" class="contents-button button" data-bi-name="contents-expand" aria-haspopup="true">
						<span class="icon"><span class="docon docon-menu" aria-hidden="true"></span></span>
						<span class="contents-expand-title">Contents</span>
					</button>
					<button type="button" class="ap-collapse-behavior ap-expanded button" data-bi-name="ap-collapse" aria-controls="action-panel">
						<span class="icon"><span class="docon docon-exit-mode" aria-hidden="true"></span></span>
						<span>Exit focus mode</span>
					</button>
				</div>
				<div class="has-padding-none-tablet padding-xs font-size-sm display-flex justify-content-space-between flex-grow-1 page-action-holder">
					<ul class="is-hidden-mobile action-list justify-content-flex-start has-flex-justify-content-end-tablet display-flex flex-wrap-wrap flex-grow-1 is-unstyled">
						<li hidden>
							<a id="lang-link" class="button button button-clear button-sm" title="Read in English" data-bi-name="language-toggle">
								<span id="lang-link-icon" class="icon docon docon-locale-globe" aria-hidden="true"></span>
								<span id="lang-link-text" class="is-visually-hidden-touch is-hidden-portrait"></span>
							</a>
						</li>
						<li>
							<button type="button" class="collection button button-clear button-sm has-inner-focus" data-list-type="collection" data-bi-name="collection" title="Add to collection">
								<span class="icon" aria-hidden="true">
									<span class="docon docon-circle-addition has-text-primary"></span>
								</span>
								<span class="collection-status is-visually-hidden-touch is-hidden-portrait">Save</span>
							</button>
						</li>
								<li id="contenteditbtn" hidden>
									<a href="https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletins/2002/ms02-001.md"  class=" button button-clear button-sm has-inner-focus" title="Edit This Document" data-bi-name="edit">
									<span class="icon" aria-hidden="true">
										<span class="docon docon-edit-outline"></span>
									</span>
									<span class="is-visually-hidden-touch is-hidden-portrait">Edit</span>
								</a>
							</li>
						<li>
<div class="sharing dropdown has-caret">
	<button class="dropdown-trigger button button-clear button-sm button-block justify-content-flex-start has-inner-focus" aria-controls="sharing-menu" aria-expanded="false" title="Share This Document" data-bi-name="share">
		<span class="icon" aria-hidden="true">
			<span class="docon docon-sharing"></span>
		</span>
		<span class="is-visually-hidden-touch is-hidden-portrait">Share</span>
	</button>
	<div class="dropdown-menu has-padding-small" id="sharing-menu">
		<ul data-bi-name="share-links">
			<li>
				<a class="button button-clear button-sm button-block justify-content-flex-start has-inner-focus share-twitter" data-bi-name="twitter">
					<span class="icon">
						<span class="docon docon-brand-twitter has-text-primary" aria-hidden="true"></span>
					</span>
					<span>Twitter</span>
				</a>
			</li>
			<li>
				<a class="button button-clear button-sm button-block justify-content-flex-start has-inner-focus share-linkedin" data-bi-name="linkedin">
					<span class="icon">
						<span class="docon docon-brand-linkedin has-text-primary" aria-hidden="true"></span>
					</span>
					<span>LinkedIn</span>
				</a>
			</li>
			<li>
				<a class="button button-clear button-sm button-block justify-content-flex-start has-inner-focus share-facebook" data-bi-name="facebook">
					<span class="icon">
						<span class="docon docon-brand-facebook has-text-primary" aria-hidden="true"></span>
					</span>
					<span>Facebook</span>
				</a>
			</li>
			<li>
				<a class="button button-clear button-sm button-block justify-content-flex-start has-inner-focus share-email" data-bi-name="email">
					<span class="icon">
						<span class="docon docon-mail-message-fill has-text-primary" aria-hidden="true"></span>
					</span>
					<span>Email</span>
				</a>
			</li>
		</ul>
	</div>
</div>						</li>
					</ul>
					<button type="button" class="border contents-button  button button-clear button-sm is-hidden-tablet has-inner-focus" aria-label="Contents" data-bi-name="contents-expand">
						<span class="icon">
							<span class="docon docon-editor-list-bullet" aria-hidden="true"></span>
						</span>
						<span class="contents-expand-title">Table of contents</span>
					</button>
					<div class="is-invisible"></div>
					<div class="is-hidden-tablet level-item is-flexible level-right">
						<button type="button" class="page-actions-button  button button-clear button-sm is-hidden-tablet has-inner-focus border is-full-height  has-margin-left-small" aria-label="Page Actions" data-bi-name="pageactions">
							<span class="icon">
								<span class="docon docon-more-vertical" aria-hidden="true"></span>
							</span>
						</button>
					</div>
				</div>
			</div>



		<div id="disclaimer-holder" class="has-overflow-hidden has-default-focus">
			<!-- liquid-tag banners sectional -->
		</div>
	</div>

	<div class="mainContainer  uhf-container has-top-padding  has-default-focus" data-bi-name="body">

		<div class="columns has-large-gaps is-gapless-mobile ">

			<div id="left-container" class="left-container is-hidden-mobile column is-one-third-tablet is-one-quarter-desktop">
				<nav id="affixed-left-container" class="position-fixed display-flex flex-direction-column" role="navigation" aria-label="Primary"></nav>
			</div>

			<!-- .primary-holder -->
			<section class="primary-holder column is-two-thirds-tablet is-three-quarters-desktop">
				<!--div.columns -->
				<div class="columns is-gapless-mobile has-large-gaps ">


					<div id="main-column" class="column  is-full is-8-desktop">

						<main id="main" role="main" class="content " data-bi-name="content" lang="en-us" dir="ltr">



							

								<ul class="metadata page-metadata" data-bi-name="page info" lang="en-us" dir="ltr">
									<li>
										<time class="is-invisible" data-article-date aria-label="Article review date" datetime="2017-11-11T00:46:00Z" data-article-date-source="git">11/11/2017</time>
									</li>
											<li class="readingTime">22 minutes to read</li>
										<li class="contributors-holder">
											<ul class="facepile has-margin-left-none is-small" data-bi-name="contributors">
																<li class="facepile-item">
																	<a href="https://github.com/BetaFred" title="BetaFred" aria-label="BetaFredGithub profile" data-src="https://github.com/BetaFred.png?size=32" data-contributor-name="BetaFred" class="facepile-item-coin"
																	>
																		<img class="facepile-item-coin-image durable-image" aria-hidden="true" src="https://github.com/BetaFred.png?size=32" role="presentation" onerror="this.className='facepile-item-coin-image durable-image has-error';"/>
																		<span class="facepile-item-coin-text durable-image-fallback facepile-item-teal"aria-hidden="true">B</span>
																	</a>
																</li>
																<li class="facepile-item">
																	<a href="https://github.com/Santoshtambe" title="Santoshtambe" aria-label="SantoshtambeGithub profile" data-src="https://github.com/Santoshtambe.png?size=32" data-contributor-name="Santoshtambe" class="facepile-item-coin"
																	>
																		<img class="facepile-item-coin-image durable-image" aria-hidden="true" src="https://github.com/Santoshtambe.png?size=32" role="presentation" onerror="this.className='facepile-item-coin-image durable-image has-error';"/>
																		<span class="facepile-item-coin-text durable-image-fallback facepile-item-red"aria-hidden="true">S</span>
																	</a>
																</li>
											</ul>
										</li>
								</ul>

								<nav id="center-doc-outline" class="doc-outline is-hidden-desktop" data-bi-name="intopic toc" role="navigation" aria-label="Article Outline">
									<h3>In this article</h3>
								</nav>


							<!-- <content> -->
								<p>Security Bulletin</p>
<h1 id="microsoft-security-bulletin-ms02-001---moderate">Microsoft Security Bulletin MS02-001 - Moderate</h1>
<h2 id="trusting-domains-do-not-verify-domain-membership-of-sids-in-authorization-data">Trusting Domains Do Not Verify Domain Membership of SIDs in Authorization Data</h2>
<p>Published: January 30, 2002 | Updated: May 09, 2003</p>
<p><strong>Version:</strong> 1.3</p>
<p><strong>Originally posted:</strong> January 30, 2002<br/>
<strong>Updated:</strong> May 09, 2003</p>
<h4 id="summary">Summary</h4>
<p><strong>Who should read this bulletin:</strong>
Administrators using Microsoft® Windows NT® 4.0 or Windows® 2000 domain controllers.</p>
<p><strong>Impact of vulnerability:</strong>
Privilege elevation.</p>
<p><strong>Recommendation:</strong>
System administrators should review the bulletin below and a technical white paper on the subject, and deploy SID Filtering on domain controllers where appropriate.</p>
<p><strong>Affected Software:</strong></p>
<ul>
<li>Microsoft Windows NT 4.0</li>
<li>Microsoft Windows 2000</li>
</ul>
<h3 id="general-information">General Information</h3>
<h2 id="technical-details">Technical details</h2>
<p><strong>Technical description:</strong></p>
<p>Trust relationships are created between Windows NT or Windows 2000 domains to allow users in one domain to access resources in other domains without requiring them to authenticate separately to each domain. When a user in a trusted domain requests access to a resource in a trusting domain, the trusted domain supplies authorization data in the form of a list of Security Identifiers (SIDs) that indicate the user's identity and group memberships. The trusting domain uses this data to determine whether to grant the user's request.</p>
<p>A vulnerability exists because the trusting domain does not verify that the trusted domain is actually authoritative for all the SIDs in the authorization data. If one of the SIDs in the list identified a user or security group that is not in the trusted domain, the trusting domain would accept the information and use it for subsequent access control decisions. If an attacker inserted SIDs of his choice into the authorization data at the trusted domain, he could elevate his privileges to those associated with any desired user or group, including the Domain Administrators group for the trusting domain. This would enable the attacker to gain full Domain Administrator access on computers in the trusting domain.</p>
<p>Exploiting this vulnerability would be difficult, and require administrative privileges on the trusted domain, as well as the technical wherewithal to modify low-level operating system functions and data structures.</p>
<ul>
<li>Windows NT 4.0 provides no mechanism by which additional SIDs could be added to authorization data. To exploit the vulnerability, an attacker would need to develop and install custom operating system components to add the SIDs.</li>
<li>Windows 2000 does provide a mechanism for introducing additional SIDs into authorization data, known as SIDHistory. However, there is no programming interface that would allow an attacker - even with administrative rights - to introduce a desired SID into the SIDHistory information; instead, an attacker would need to perform a binary edit of the data structures that hold the SIDHistory information.</li>
</ul>
<p>Microsoft has developed a mechanism called SID Filtering that eliminates the vulnerability and adds further protection between trusting domains. When installed and enabled on the domain controllers of a trusting domain, SID Filtering causes the system to inspect all incoming authorization data and remove any SIDs that do not identify a user or security group that is defined in the trusted domain.</p>
<p>There are, however, tradeoffs associated with using the SID Filtering mechanism. These are summarized in the FAQ and Caveats sections below, and are discussed in detail in Microsoft Knowledge Base article Q289243 and in a <a href="http://www.microsoft.com/technet/prodtechnol/windows2000serv/technologies/activedirectory/maintain/opsguide/part1/adogd05.mspx" data-linktype="external">technical white paper</a> that Microsoft strongly urges administrators to read before using SID Filtering. This is especially important in the case of administrators who are in the midst of migrating their networks from Windows NT 4.0 to Windows 2000.</p>
<p><strong>Mitigating factors:</strong></p>
<ul>
<li>The attacker would need to have domain administrator privileges in the trusted domain in order to exploit the vulnerability.</li>
<li>The attacker's domain would need to already be trusted by the target domain, or the target domain's administrator would need to approve the establishment of a new trust relationship. There is no capability for the attacker to unilaterally initiate a trust relationship with another domain or cause it to trust the attacker's domain.</li>
<li>The attacker would need to modify operating system components and data.</li>
</ul>
<p><strong>Severity Rating:</strong></p>
<table>
<thead>
<tr>
<th></th>
<th>Internet Servers</th>
<th>Intranet Servers</th>
<th>Client Systems</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Windows NT 4.0</strong></td>
<td>Low</td>
<td>Moderate</td>
<td>None</td>
</tr>
<tr>
<td><strong>Windows 2000</strong></td>
<td>Low</td>
<td>Moderate</td>
<td>None</td>
</tr>
</tbody>
</table>
<p>The above <a href="http://technet.microsoft.com/security/bulletin/rating" data-linktype="external">assessment</a> is based on the types of systems affected by the vulnerability, their typical deployment patterns, and the effect that exploiting the vulnerability would have on them. The vulnerability would require that a trust relationship be established between a vulnerable domain and one on which the attacker had domain administrator privileges, and even then would require that the attacker have the technical wherewithal to modify operating system functions and data structures while the system was running.</p>
<p><strong>Vulnerability identifier:</strong> <a href="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0018" data-linktype="external">CAN-2002-0018</a></p>
<p><strong>Tested Versions:</strong></p>
<p>Microsoft tested Windows NT 4.0 and Windows 2000 to assess whether they are affected by these vulnerabilities. Previous versions are no longer supported, and may or may not be affected by these vulnerabilities.</p>
<h2 id="frequently-asked-questions">Frequently asked questions</h2>
<p><strong>What's the scope of this vulnerability?</strong><br/>
This is a <a href="http://technet.microsoft.com/security/bulletin/glossary" data-linktype="external">privilege elevation</a> attack. If an attacker had domain administrator privileges on a domain, and the domain were trusted by another domain, it would be possible for the attacker to gain privileges on the trusting domain, up to and including administrator privileges.
Exploiting this vulnerability would be difficult:</p>
<ul>
<li>The attacker would need to already have complete administrative control over the trusted domain.</li>
<li>The vulnerability could only be exploited if there was a pre-existing trust relationship between the attacker's domain and the other one. The attacker would not be able to establish one by himself.</li>
<li>On both Windows NT 4.0 and Windows 2000 systems, the attacker would need to possess the technical skills to modify low-level operating system functions and data.</li>
</ul>
<p>Nevertheless, the worst case associated with this vulnerability is serious, and we encourage all Windows NT 4.0 and Windows 2000 administrators to consider deploying the fix if physical and personnel security considerations indicate sufficient risk.</p>
<p><strong>What causes the vulnerability?</strong><br/>
The vulnerability results because, when a trust relationship exists between two domains, the trusting domain will accept the SIDs specified within authorization data provided by the trusted domain - even if the SIDs are from domains other than the trusted one. If an attacker in a trusted domain were able to insert SIDs of his choice into authorization data, he could grant himself the privileges associated with a user in another domain, including the trusting domain itself.</p>
<p><strong>What is a trust relationship?</strong><br/>
Trust relationships allow users in one Windows NT or Windows 2000 domain to be authenticated and allowed access to resources in another domain. There are two parties in a trust relationship:</p>
<ul>
<li>The trusting domain, also known as the resource domain. This is the domain where resources like file servers are located.</li>
<li>The trusted domain, also know as the account domain. This is the domain where user accounts and security groups are defined.</li>
</ul>
<p>The account domain authenticates users when they logon and connect to network servers, and provides identity information to the resource domain, which trusts the account domain to do this correctly For this reason, the resource domain is usually referred to as the trusting domain, and the account domain is usually referred to as the trusted domain.</p>
<p><strong>What is a SID?</strong><br/>
A <a href="http://msdn2.microsoft.com/en-us/library/aa379594.aspx" data-linktype="external">SID</a> is a Security Identifier - a unique identifying value that's associates with a user account or group in Windows NT or Windows 2000. SIDs are used extensively in the Windows NT and Windows 20000 security architecture to support authentication and implement access control.</p>
<p><strong>How do SIDs determine access to resources?</strong><br/>
In Windows NT and Windows 2000, the owner of a resource regulates access to it using <a href="http://msdn2.microsoft.com/en-us/library/aa374872.aspx" data-linktype="external">Access Control Lists</a> (ACLs). An ACL consists of a table of <a href="http://msdn2.microsoft.com/en-us/library/aa374868.aspx" data-linktype="external">Access Control Entries</a> (ACEs), each of which specifies the SID for one user account or group, and the permissions that it has on the resource.
Whenever a user requests access to a protected resource, his account domain receives a request to authenticate the user. During this process, the account domain generates authorization data (listing the SIDs for the user's account and all the groups he belongs to) and sends it as part of the response. When the machine that hosts the resource receives the response, it uses the authorization data to build an <a href="http://msdn2.microsoft.com/en-us/library/aa374909.aspx" data-linktype="external">access token</a>. It then compares the SIDs in the token to the SIDs in the ACL and determines the privileges the user is entitled to.
To give an example, let's assume the following scenario:</p>
<ul>
<li>A trust relationship exists between two domains, called Domain A and Domain B.</li>
<li>Domain B trusts Domain A.</li>
<li>Joe has a user account in Domain A, and also is member of the Sales group there.</li>
<li>Joe logs into the system with his Domain A\Joe account.</li>
<li>Joe wants to access a file hosted on a computer in Domain B. The share and file name is \\ServerB\projects\plans.txt.</li>
<li>The owner of plans.txt has specified an ACL that grants full control to members of the Administrators group, read access to members of the Sales group in Domain A , and write access to user Joe in Domain A.</li>
</ul>
<p>When Joe tries to open the file, one of the domain controllers in Domain A is contacted to authenticate Joe. While processing the authentication request, it generates the authorization data that includes the SIDs for Domain A \Joe and for Domain A\ Sales, because Joe is a member of the Sales group. When ServerB receives this authorization data, it adds SIDs for any local machine groups that Joe is a member of, and builds an access token. ServerB uses this token to impersonate Joe and open the file. The file system compares the SIDs in the token to those in the ACL for the file. The file system determines that Joe has read permission by virtue of his membership in the Domain A \Sales group, and write permission by virtue of being Domain A \Joe, and therefore grants him both read and write permission to the file.</p>
<p><strong>What's wrong with the way authorization data is accepted?</strong><br/>
There is a flaw in the way a trusting Windows NT or Windows 2000 domain accepts the authorization data from a trusted domain. Specifically, the trusting domain accepts the authorization data as correct, even if some of SIDs in the list are from domains for which the trusted domain isn't authoritative.</p>
<p><strong>But you said above that the trusting domain always accepts the trusted domain's authentication. This sounds like it's in keeping with that statement.</strong>
The problem is that the trusting domain is, in this case, too trusting. By design, it should trust the trusted domain's authentication - but <strong>only</strong> for accounts the trusted domain is authoritative over. The trusted domain should not be able to make assertions about accounts that reside in other domains. This vulnerability could enable the trusted domain to make assertions about users and groups that are in some other domain.</p>
<p><strong>Just to be clear, does the vulnerability lie in the trusted domain or in the trusting one?</strong><br/>
The vulnerability lies in the mechanism by which the trusting domain uses authorization data. It's the trusting domain's responsibility to ensure that the trusted domain doesn't exceed the authority that the trusting domain granted it. Therefore, the trusting domain must check all the authorization information provided by the trusted domain. There is no vulnerability in the trusted domain.</p>
<p><strong>What would this vulnerability enable an attacker to do?</strong><br/>
If an attacker had sufficient privileges in a trusted domain, and he could modify the behavior of the security subsystem of the domain controller, he could insert SIDs of his choice into the authorization data and thereby elevate his privileges when connecting to computers in the trusting domain.
For instance, in the scenario we discussed above, suppose Joe only had read access to the file, plans.txt. If Joe were able to add a SID to the authorization data, he could identify himself as a member of a different group in a different domain - for example, Domain B/Domain Administrators. Not only would this grant him additional privileges on plans.txt, it also would give him full control of any computer in Domain B.</p>
<p><strong>What privileges would the attacker need in order to modify the authorization data?</strong><br/>
The attacker would need to have domain administrative privileges in the trusted domain.</p>
<p><strong>But if the attacker has administrative privileges, all bets are off. Isn't this the Sixth Immutable Law of Security?</strong><br/>
Actually, this situation goes a bit beyond the <a href="http://www.microsoft.com/technet/archive/community/columns/security/essays/10imlaws.mspx" data-linktype="external">Sixth Immutable Law of Security</a> (&quot;A machine is only as secure as the administrator is trustworthy&quot;). It's true that if the administrator of a machine (or, in this case, a domain) is untrustworthy, there is effectively no security on it. However, the damage should be limited to the domain that the administrator has authority over - he should not be able to extend his control to other domains. The fact that this issue would enable him to extend his control makes this a security vulnerability.</p>
<p><strong>How hard would it be for an attacker to modify the authorization data?</strong><br/>
It would be extremely difficult. As we discussed above, the vulnerability means that if an attacker could introduce SIDs into the authorization data from a trusted domain, the trusting domain would accept them. However, nothing in the vulnerability provides a way for the attacker to do this.
Windows NT 4.0 lacks any mechanism for adding SIDs to authorization data. An attacker could only exploit this vulnerability if he first implemented such a mechanism, then installed it onto the system. This would require that the attacker have the technical skills to write low-level operating system components, and the administrative privileges needed to install the components onto a domain controller.
Windows 2000 does provide a mechanism for adding SIDs to authorization data, called SIDHistory. However, this isn't as easily exploited as it might initially appear to be, because there are no functions by which the attacker - even with administrative privileges - could arbitrarily manipulate the SIDHistory data. To exploit the vulnerability, the attacker would either need to implement such functions, or manipulate data within low-level operating system data structures while the system was running.</p>
<p><strong>What is SIDHistory and what does it do?</strong><br/>
SIDHistory is mechanism that was introduced in Windows 2000 to aid in migrating user accounts from Windows NT 4.0 domains to Active Directory. Typically, when a Windows NT 4.0 network migrates to Windows 2000, the domain structure is revised to take advantage of the new efficiencies Windows 2000 offers. The number of domains is usually reduced, and user accounts are migrated into new, larger domains.
When a user account is migrated to a new domain, the account is assigned a new SID, but all of the ACLs on existing resources continue to refer to the account's old SID. As a result, a user whose account was migrated would lose access to all resources on the network. For instance, suppose Joe's domain, Domain A, was migrated to NewDomain. NewDomain\Joe would have a different SID than Domain A\Joe did, and NewDomain\Joe would not be able to access the resources he could as Domain A\Joe.
The SIDHistory mechanism retains the SID from the user's previous domain within the Active Directory, and includes it in any authorization data the domain generates. So, if NewDomain used the SIDHistory mechanism and NewDomain\Joe requested access to \\ServerB\projects\plans.txt, NewDomain would generate authorization data containing not only the SIDs for NewDomain\Joe and any groups he belonged to there, but also the SIDs for Domain A\Joe.</p>
<p><strong>Is the SIDHistory feature a security risk?</strong><br/>
No. There isn't a flaw in SIDHistory. It is simply a mechanism that could be misused, if the attacker had significant technical skills and complete administrative control over the machine.</p>
<p><strong>Could the attacker simply add new SIDHistory data for himself?</strong><br/>
No. There are neither system calls nor LDAP APIs that enable SIDHistory data to be modified. Instead, the attacker would need to either implement his own system calls, or use a debugger to modify the contents of the data structures that hold the SIDHistory data.</p>
<p><strong>Could an attacker set up a rogue domain on a network and grant himself privileges on other domains in the network?</strong><br/>
Simply setting up a machine in its own domain wouldn't give the attacker any kind of trust in other domains. This does, however, reinforce the need for domain administrators to be very careful when establishing trust relationships with other domains, and only grant trust to domains that truly are trustworthy.</p>
<p><strong>What's the solution to the vulnerability?</strong><br/>
Microsoft has developed a mechanism called SID Filtering to eliminate the vulnerability. When SID Filtering is installed on the domain controllers in a trusting domain, and enabled for a specific trusted domain, it has the effect of establishing a &quot;quarantine&quot; on the trusted domain. Thereafter, the trusting domain checks all incoming authorization data from that trusted domain and removes any SIDs that don't belong to it.
For instance, suppose SID Filtering were installed and enabled on the domain controllers in Domain B from the previous example. If an access token were received from Domain A that contained the SIDs for Domain A\Joe, Domain A\Sales and Domain B\Domain Administrators, SID Filtering would remove the SID for Domain B\Domain Administrators, as Domain A is not authoritative for users or groups in Domain B.</p>
<p><strong>Once the patch is installed, is SID Filtering enabled by default?</strong><br/>
No. As we'll discuss in more detail below, SID Filtering should only be enabled on particular domain controllers, and even then only after careful consideration of how it will affect your network. Microsoft Knowledge Base article Q289243 provides details for enabling and configuring SID Filtering. At a high level, though, in Windows NT 4.0, SID Filtering is enabled and configured using a registry entry (HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Netlogon\Parameters\QuarantinedDomains) and in Windows 2000 it's enabled and configured using the NetDom command.</p>
<p><strong>Should I enable SID Filtering on all machines in my network?</strong><br/>
No. To protect a domain, you only need to enable SID Filtering on the domain controllers. Member servers and workstations in the domain do not use or implement SID Filtering. You do, however, need to ensure you have enabled SID Filtering on <strong>all</strong> domain controllers in the domains you want to protect. If you miss one domain controller server, it might be possible for an attacker to exploit the vulnerability via that computer.</p>
<p><strong>Can I apply SID Filtering to domains within the same forest in a Windows 2000 network?</strong><br/>
No. SID Filtering should only be applied to external trusts -- that is, trust relationships between domains that are <strong>not</strong> in the same forest. It should not be applied to trust relationships within a forest, as doing so will block replication and other functions that are essential to the proper operation of forest. If a domain is sufficiently untrustworthy to warrant applying SID Filtering to it, it really should not be a member of the forest.</p>
<p><strong>Are there any drawbacks associated with using SID Filtering?</strong><br/>
Yes. SID Filtering operates by simply removing all SIDs that do not belong to the domain sending them. This does effectively screen out all falsified SIDs, but it will also screen out legitimate SIDs that simply do not come from the originating domain. Two cases in which this can interfere with legitimate operation are:</p>
<ul>
<li>Network migrations that use SIDHistory to mitigate the effects of migration until resources can be re-ACLed. SID Filtering will prevent the SIDHistory mechanism from working in quarantined domains.</li>
<li>Universal groups managed outside users' account domains.</li>
</ul>
<p><strong>Is there any other information I should consult before deploying SID Filtering?</strong><br/>
There are two particularly useful references that we recommend reading:</p>
<ul>
<li><a href="http://www.microsoft.com/technet/prodtechnol/windows2000serv/technologies/activedirectory/plan/addeladm.mspx" data-linktype="external">Design Considerations for Delegation of Administration in Active Directory</a>, which provides a detailed discussion of important Active Directory administration and security concepts. While this white paper doesn't discuss SID Filtering per se, it's very useful background reading.</li>
<li><a href="http://www.microsoft.com/windows2000/techinfo/administration/security/sidfilter.asp" data-linktype="external">Using SID Filtering to Prevent Elevation of Privilege Attacks</a>, which provides additional technical detail about the security issue, including detailed discussions of the drawbacks discussed above and strategies for using SID Filtering most effectively. We strongly recommend that all system administrators read the white paper before deploying SID Filtering.</li>
</ul>
<h2 id="patch-availability">Patch availability</h2>
<p><strong>Download locations for this patch</strong></p>
<ul>
<li><p>Windows NT 4.0 Server and Windows NT 4.0 Server, Enterprise Edition:</p>
<p>Included in the <a href="http://support.microsoft.com/kb/q299444/" data-linktype="external">Windows NT 4.0 Security Roll-up Package</a>.</p>
</li>
<li><p>Windows NT 4.0 Server, Terminal Server Edition:</p>
<p>Included in the <a href="http://support.microsoft.com/kb/317636" data-linktype="external">Windows NT Server 4.0, Terminal Server Edition Security Rollup Package</a>.</p>
</li>
<li><p>Windows 2000 Server and Advanced Server:</p>
<p>The fix for this issue is included in <a href="http://support.microsoft.com/kb/311401" data-linktype="external">Windows 2000 Security Roll-up Package 1</a></p>
</li>
<li><p>Windows 2000 Datacenter Server:</p>
<p>Patches for Windows 2000 Datacenter Server are hardware-specific and available from the original equipment manufacturer.</p>
</li>
</ul>
<h4 id="additional-information-about-this-patch">Additional information about this patch</h4>
<p><strong>Installation platforms:</strong></p>
<ul>
<li>The Windows NT 4.0 Security Roll-up Package can be installed on systems running <a href="http://support.microsoft.com/kb/241211" data-linktype="external">Service Pack 6a</a>.</li>
<li>Windows 2000 Security Roll-up Package 1 can be installed on systems running Windows 2000 <a href="http://www.microsoft.com/windows2000/downloads/servicepacks/sp2/default.mspx" data-linktype="external">Service Pack 2</a>.</li>
</ul>
<p><strong>Inclusion in future service packs:</strong></p>
<ul>
<li>The Windows 2000 fix will be included in Windows 2000 Service Pack 3. There are no future service packs planned for Windows NT 4.0.</li>
</ul>
<p><strong>Superseded patches:</strong></p>
<ul>
<li>The Windows NT 4.0 Security Roll-up Package supersedes the patches provided in the following security bulletins:
<ul>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms99-003" data-linktype="external">MS99-003</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms99-019" data-linktype="external">MS99-019</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms99-022" data-linktype="external">MS99-022</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms99-029" data-linktype="external">MS99-029</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms99-039" data-linktype="external">MS99-039</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms99-046" data-linktype="external">MS99-046</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms99-047" data-linktype="external">MS99-047</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms99-053" data-linktype="external">MS99-053</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms99-055" data-linktype="external">MS99-055</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms99-056" data-linktype="external">MS99-056</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms99-057" data-linktype="external">MS99-057</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms99-058" data-linktype="external">MS99-058</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms99-061" data-linktype="external">MS99-061</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-003" data-linktype="external">MS00-003</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-004" data-linktype="external">MS00-004</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-005" data-linktype="external">MS00-005</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-006" data-linktype="external">MS00-006</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-007" data-linktype="external">MS00-007</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-008" data-linktype="external">MS00-008</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-018" data-linktype="external">MS00-018</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-019" data-linktype="external">MS00-019</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-021" data-linktype="external">MS00-021</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-023" data-linktype="external">MS00-023</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-024" data-linktype="external">MS00-024</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-027" data-linktype="external">MS00-027</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-029" data-linktype="external">MS00-029</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-030" data-linktype="external">MS00-030</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-031" data-linktype="external">MS00-031</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-036" data-linktype="external">MS00-036</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-040" data-linktype="external">MS00-040</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-044" data-linktype="external">MS00-044</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-047" data-linktype="external">MS00-047</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-052" data-linktype="external">MS00-052</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-057" data-linktype="external">MS00-057</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-060" data-linktype="external">MS00-060</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-063" data-linktype="external">MS00-063</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-070" data-linktype="external">MS00-070</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-078" data-linktype="external">MS00-078</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-080" data-linktype="external">MS00-080</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-083" data-linktype="external">MS00-083</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-086" data-linktype="external">MS00-086</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-091" data-linktype="external">MS00-091</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-094" data-linktype="external">MS00-094</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-095" data-linktype="external">MS00-095</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-100" data-linktype="external">MS00-100</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms01-003" data-linktype="external">MS01-003</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms01-004" data-linktype="external">MS01-004</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms01-008" data-linktype="external">MS01-008</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms01-009" data-linktype="external">MS01-009</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms01-017" data-linktype="external">MS01-017</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms01-025" data-linktype="external">MS01-025</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms01-026" data-linktype="external">MS01-026</a>.</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms01-033" data-linktype="external">MS01-033</a>.</li>
</ul>
</li>
<li>Windows 2000 Security Rollup Package 1 supersedes the patches provided in the following security bulletins:
<ul>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-077" data-linktype="external">MS00-077</a></li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms00-079" data-linktype="external">MS00-079</a></li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms01-004" data-linktype="external">MS01-004</a></li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms01-007" data-linktype="external">MS01-007</a></li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms01-011" data-linktype="external">MS01-011</a></li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms01-013" data-linktype="external">MS01-013</a></li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms01-015" data-linktype="external">MS01-015</a> (Windows 2000 SRP1 only includes the fix for version 5.01 of IE, since this is the version that ships with Windows 2000)</li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms01-024" data-linktype="external">MS01-024</a></li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms01-025" data-linktype="external">MS01-025</a></li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms01-026" data-linktype="external">MS01-026</a></li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms01-031" data-linktype="external">MS01-031</a></li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms01-033" data-linktype="external">MS01-033</a></li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms01-035" data-linktype="external">MS01-035</a></li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms01-036" data-linktype="external">MS01-036</a></li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms01-037" data-linktype="external">MS01-037</a></li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms01-040" data-linktype="external">MS01-040</a></li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms01-041" data-linktype="external">MS01-041</a></li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms01-043" data-linktype="external">MS01-043</a></li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms01-044" data-linktype="external">MS01-044</a></li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms01-046" data-linktype="external">MS01-046</a></li>
<li>Microsoft Security Bulletin <a href="http://technet.microsoft.com/security/bulletin/ms01-052" data-linktype="external">MS01-052</a></li>
</ul>
</li>
</ul>
<p><strong>Verifying patch installation:</strong></p>
<p>Windows NT 4.0:</p>
<ul>
<li><p>To verify that the Windows NT 4.0 Security Roll-up Package has been installed on the machine, confirm that the following registry key has been created on the machine:</p>
<p>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\NT\CurrentVersion\Hotfix\Q299444.</p>
</li>
<li><p>To verify the individual files, consult the file manifest in Knowledge Base article Q299444</p>
</li>
<li><p>To verify that SID Filtering is enabled on the machine, confirm that the following registry key is present and that it contains the NetBIOS names of the domains to quarantine:</p>
<p>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Netlogon\Parameters\QuarantinedDomains</p>
</li>
</ul>
<p>Windows 2000:</p>
<ul>
<li><p>To verify that Windows 2000 Security Roll-up Package 1 has been installed on the machine, confirm that the following registry key has been created on the machine:</p>
<p>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Updates\Windows 2000\SP3\SP2SRP1.</p>
</li>
<li><p>To verify the individual files, use the date/time and version information provided in the following registry key:</p>
<p>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Updates\Windows 2000\SP3\SP2SRP1\Filelist</p>
</li>
</ul>
<p><strong>Caveats:</strong></p>
<ul>
<li>Subsequent to the initial release of this bulletin, a memory leak was found to affect several versions of COM+, including the one that ships with the Windows 2000 Security Roll-up Package 1. While the leak does not constitute a security risk, it could affect availability under some conditions. Customers using COM+ should consult Knowledge Base article Q313582 for information on how to eliminate the leak.</li>
<li>Simply installing the patch does not enable SID Filtering. SID Filtering must be explicitly enabled, and the domains to be quarantined must be explicitly specified, as discussed in Microsoft Knowledge Base articles Q289243 and Q289246.</li>
<li>For SID Filtering to be effective, it must be enabled on all domain controllers in the domains that require protection.</li>
<li>When used in a Windows 2000 network, SID Filtering should only be applied to external trusts (i.e., trust relationships between domains in different forests). This is discussed in more detail in the FAQ, as well as in a <a href="http://www.microsoft.com/windows2000/techinfo/administration/security/sidfilter.asp" data-linktype="external">technical white paper</a> that Microsoft strongly encourages system administrators to thoroughly read before deploying a solution.</li>
<li>SID Filtering works by removing all SIDs that do not belong to the domain sending them. While this does screen out all falsified SIDs, it will also screen out legitimate SIDs that simply do not come from the originating domain. This can interfere with network migrations that use the SIDHistory mechanism, as well as interfering with Universal groups managed outside users' account domains.</li>
</ul>
<p><strong>Localization:</strong></p>
<p>Localized versions of the Windows NT 4.0 Security Roll-up Package and Windows 2000 Security Roll-up Package 1 are available from the URLs listed above in &quot;Download locations for this patch&quot;.</p>
<p><strong>Obtaining other security patches:</strong></p>
<p>Patches for other security issues are available from the following locations:</p>
<ul>
<li>Security patches are available from the <a href="http://go.microsoft.com/fwlink/?linkid=21129" data-linktype="external">Microsoft Download Center</a>, and can be most easily found by doing a keyword search for &quot;security_patch&quot;.</li>
<li>Patches for consumer platforms are available from the <a href="http://windowsupdate.microsoft.com/" data-linktype="external">WindowsUpdate</a> web site.</li>
</ul>
<h4 id="other-information">Other information:</h4>
<p><strong>Acknowledgments</strong></p>
<p>Microsoft <a href="http://technet.microsoft.com/security/bulletin/policy" data-linktype="external">thanks</a> the following customers for reporting this issue to us and working with us to protect customers:</p>
<ul>
<li>Aelita Software (<a href="http://www.aelita.com/" data-linktype="external">http://www.aelita.com</a>)</li>
<li>Michel Trépanier of <a href="mailto:michel.trepanier@cmtsoft.com" data-linktype="external">CMT Inc.</a> and <a href="mailto:michel.trepanier@loto-quebec.com" data-linktype="external">Loto-Québec</a>.</li>
</ul>
<p><strong>Support:</strong></p>
<ul>
<li>Microsoft Knowledge Base articles Q311401, Q289243 and Q289246 discuss this issue and will be available approximately 24 hours after the release of this bulletin. Knowledge Base articles can be found on the <a href="http://support.microsoft.com/?scid=fh;en-us;kbhowto" data-linktype="external">Microsoft Online Support</a> web site.</li>
<li>Technical support is available from <a href="http://support.microsoft.com/directory/question.asp?sd=gn&amp;fr=0" data-linktype="external">Microsoft Product Support Services</a>. There is no charge for support calls associated with security patches.</li>
</ul>
<p><strong>Security Resources:</strong> The <a href="http://www.microsoft.com/technet/security/default.mspx" data-linktype="external">Microsoft TechNet Security</a> Web Site provides additional information about security in Microsoft products.</p>
<p><strong>Disclaimer:</strong></p>
<p>The information provided in the Microsoft Knowledge Base is provided &quot;as is&quot; without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.</p>
<p><strong>Revisions:</strong></p>
<ul>
<li>V1.0 (January 30, 2002): Bulletin Created.</li>
<li>V1.1 (April 24, 2002): Bulletin updated to advise availability of Windows NT 4.0 Server, Terminal Server Edition Security Rollup Package.</li>
<li>V1.2 (November 27, 2002): Caveats section updated to advise of a memory leak associated with the version of COM+ that shipped with Windows 2000 Security Roll-up Package 1.</li>
<li>V1.3 (May 09, 2003): Updated download links to Windows Update.</li>
</ul>
<p><em>Built at 2014-04-18T13:49:36Z-07:00</em></p>

							<!-- </content> -->

						</main>

						<!-- page rating section -->
								<div class="is-hidden-desktop border-top has-margin-top-large has-padding-top-large binary-rating-holder">
									
	
	

	<div class="feedback-verbatim border-bottom has-padding-bottom-large has-margin-bottom-small" data-bi-name="rating">
    <div class="binary-rating">
        <div class="binary-rating-buttons">
				<h3 class="font-weight-semibold has-margin-top-none font-size-h4 margin-bottom-xs">Is this page helpful?</h3>
			<div>
                <button class="thumb-rating like has-inner-focus" title="Yes" data-bi-name="rating-yes" aria-expanded="false" data-bi-sat="1" aria-controls="rating-container-desktop">
                    <span aria-hidden="true" class="icon docon docon-like"></span>
                    <span>Yes</span>
                </button>
                <button class="thumb-rating dislike has-inner-focus" title="No" data-bi-name="rating-no" data-bi-sat="0" aria-expanded="false" aria-controls="rating-container-desktop">
                    <span aria-hidden="true" class="icon docon docon-dislike"></span>
                    <span>No</span>
                </button>
            </div>
        </div>
        <form class="feedback-verbatim-form is-hidden" id="rating-container-desktop">
            <div class="verbatim-textarea box position-relative box-shadow-none border has-margin-top-small has-padding-extra-small font-size-xs">
                <label for="rating-textarea-desktop" class="visually-hidden">Any additional feedback?</label>
                <textarea id="rating-textarea-desktop" rows="4" maxlength="999" placeholder="Any additional feedback?" required class="textarea border-none box-shadow-none has-inner-focus"></textarea>
		    </div>
			<p class="font-size-xs has-line-height-reset">Feedback will be sent to Microsoft: By pressing the submit button, your feedback will be used to improve Microsoft products and services. <a href="https://privacy.microsoft.com/en-us/privacystatement">Privacy policy.</a></p>
            <div class="buttons buttons-right margin-top-xs has-margin-right-extra-small">
                <button class="skip-rating button button-clear button-primary button-sm" type="button">Skip</button>
                <button class="submit-rating button button-primary button-filled button-sm" data-bi-name="rating-verbatim" disabled type="submit">Submit</button>
            </div>
        </form>
    </div>
    <div class="thankyou-rating is-hidden" tabindex="-1">
        <p>Thank you.</p>
    </div>
</div>								</div>
						<!-- end page rating section -->



						<!-- recommendations section -->
							<section id="recommendations-section" data-bi-name="recommendations"></section>
						<!-- end recommendations section -->

						<!-- feedback section -->
						<!-- end feedback section -->

						<!-- feedback report section -->
						<!-- end feedback report section -->

						<div class="border-top is-visible-interactive has-default-focus has-margin-top-large ">



	<footer id="footer-interactive" data-bi-name="footer" class="footer-layout">
	<div class="display-flex is-full-height has-padding-right-extra-large-desktop">
			<a
				data-mscc-ic="false"
				class="locale-selector-link button button-clear flex-shrink-0"
				href="#"
				data-bi-name="select-locale">
					<span class="icon" aria-hidden="true">
						<span class="docon docon-world"></span>
					</span>
					<span class="local-selector-link-text"></span></a>
		<div class="margin-inline-xs flex-shrink-0">
<div class="dropdown has-caret-up">
	<button class="dropdown-trigger button button-clear button-sm has-inner-focus theme-dropdown-trigger"
		aria-controls="theme-menu-interactive" aria-expanded="false" title="Theme" data-bi-name="theme">
		<span class="icon">
			<span class="docon docon-sun" aria-hidden="true"></span>
		</span>
		<span>Theme</span>
	</button>
	<div class="dropdown-menu" id="theme-menu-interactive" role="menu">
		<ul class="theme-selector has-padding-small">
			<li class="theme is-block">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="light">
					<span class="theme-light has-margin-right-small">
						<span
							class="theme-selector-icon css-variable-support border is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
Light					</span>
				</button>
			</li>
			<li class="theme is-block">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="dark">
					<span class="theme-dark has-margin-right-small">
						<span
							class="border theme-selector-icon css-variable-support is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
Dark					</span>
				</button>
			</li>
			<li class="theme is-block">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="high-contrast">
					<span class="theme-high-contrast has-margin-right-small">
						<span
							class="border theme-selector-icon css-variable-support is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
High contrast					</span>
				</button>
			</li>
		</ul>
	</div>
</div>		</div>
	</div>
	<ul class="links" data-bi-name="footerlinks">
		<li class="manage-cookies-holder" hidden></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/previous-versions/" data-bi-name="archivelink">Previous Version Docs</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/teamblog" data-bi-name="bloglink">Blog</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/contribute" data-bi-name="contributorGuide">Contribute</a></li>
					<li><a data-mscc-ic="false" href="https://go.microsoft.com/fwlink/?LinkId=521839" data-bi-name="privacy">Privacy &amp; Cookies</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/legal/termsofuse" data-bi-name="termsofuse">Terms of Use</a></li>
				<li><a data-mscc-ic="false" href="https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/EN-US.aspx" data-bi-name="trademarks">Trademarks</a></li>
		<li>&copy; Microsoft 2021</li>
	</ul>
</footer>
						</div>
					</div>

						<div
							class="font-size-sm right-container column is-4-desktop display-none display-block-desktop"
							data-bi-name="pageactions"
							role="complementary"
							aria-label="Page Actions">

							<div id="affixed-right-container" class="doc-outline is-vertically-scrollable">
									
	
	

	<div class="feedback-verbatim border-bottom has-padding-bottom-small has-margin-bottom-small" data-bi-name="rating">
    <div class="binary-rating">
        <div class="binary-rating-buttons">
				<h3 class="font-weight-semibold has-margin-top-none has-margin-bottom-small">Is this page helpful?</h3>
			<div>
                <button class="thumb-rating like has-inner-focus" title="Yes" data-bi-name="rating-yes" aria-expanded="false" data-bi-sat="1" aria-controls="rating-container-mobile">
                    <span aria-hidden="true" class="icon docon docon-like"></span>
                    <span>Yes</span>
                </button>
                <button class="thumb-rating dislike has-inner-focus" title="No" data-bi-name="rating-no" data-bi-sat="0" aria-expanded="false" aria-controls="rating-container-mobile">
                    <span aria-hidden="true" class="icon docon docon-dislike"></span>
                    <span>No</span>
                </button>
            </div>
        </div>
        <form class="feedback-verbatim-form is-hidden" id="rating-container-mobile">
            <div class="verbatim-textarea box position-relative box-shadow-none border has-margin-top-small has-padding-extra-small font-size-xs">
                <label for="rating-textarea-mobile" class="visually-hidden">Any additional feedback?</label>
                <textarea id="rating-textarea-mobile" rows="4" maxlength="999" placeholder="Any additional feedback?" required class="textarea border-none box-shadow-none has-inner-focus"></textarea>
		    </div>
			<p class="font-size-xs has-line-height-reset">Feedback will be sent to Microsoft: By pressing the submit button, your feedback will be used to improve Microsoft products and services. <a href="https://privacy.microsoft.com/en-us/privacystatement">Privacy policy.</a></p>
            <div class="buttons buttons-right margin-top-xs has-margin-right-extra-small">
                <button class="skip-rating button button-clear button-primary button-sm" type="button">Skip</button>
                <button class="submit-rating button button-primary button-filled button-sm" data-bi-name="rating-verbatim" disabled type="submit">Submit</button>
            </div>
        </form>
    </div>
    <div class="thankyou-rating is-hidden" tabindex="-1">
        <p>Thank you.</p>
    </div>
</div>								<nav id="side-doc-outline" data-bi-name="intopic toc" role="navigation" aria-label="Article Outline">
									<h3>In this article</h3>
								</nav>
							</div>
						</div>

				</div>
				<!--end of div.columns -->

			</section>
			<!--end of .primary-holder -->

			<!-- interactive container -->
			<aside id="interactive-container" class="interactive-container is-visible-interactive column has-body-background-dark ">
			</aside>
			<!-- end of interactive container -->
		</div>

	</div>
	<!--end of .mainContainer -->

	<section class="border-top has-default-focus is-hidden-interactive has-margin-top-large ">



	<footer id="footer" data-bi-name="footer" class="footer-layout uhf-container has-padding" role="contentinfo">
	<div class="display-flex is-full-height has-padding-right-extra-large-desktop">
			<a
				data-mscc-ic="false"
				class="locale-selector-link button button-clear flex-shrink-0"
				href="#"
				data-bi-name="select-locale">
					<span class="icon" aria-hidden="true">
						<span class="docon docon-world"></span>
					</span>
					<span class="local-selector-link-text"></span></a>
		<div class="margin-inline-xs flex-shrink-0">
<div class="dropdown has-caret-up">
	<button class="dropdown-trigger button button-clear button-sm has-inner-focus theme-dropdown-trigger"
		aria-controls="theme-menu" aria-expanded="false" title="Theme" data-bi-name="theme">
		<span class="icon">
			<span class="docon docon-sun" aria-hidden="true"></span>
		</span>
		<span>Theme</span>
	</button>
	<div class="dropdown-menu" id="theme-menu" role="menu">
		<ul class="theme-selector has-padding-small">
			<li class="theme is-block">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="light">
					<span class="theme-light has-margin-right-small">
						<span
							class="theme-selector-icon css-variable-support border is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
Light					</span>
				</button>
			</li>
			<li class="theme is-block">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="dark">
					<span class="theme-dark has-margin-right-small">
						<span
							class="border theme-selector-icon css-variable-support is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
Dark					</span>
				</button>
			</li>
			<li class="theme is-block">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="high-contrast">
					<span class="theme-high-contrast has-margin-right-small">
						<span
							class="border theme-selector-icon css-variable-support is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
High contrast					</span>
				</button>
			</li>
		</ul>
	</div>
</div>		</div>
	</div>
	<ul class="links" data-bi-name="footerlinks">
		<li class="manage-cookies-holder" hidden></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/previous-versions/" data-bi-name="archivelink">Previous Version Docs</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/teamblog" data-bi-name="bloglink">Blog</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/contribute" data-bi-name="contributorGuide">Contribute</a></li>
					<li><a data-mscc-ic="false" href="https://go.microsoft.com/fwlink/?LinkId=521839" data-bi-name="privacy">Privacy &amp; Cookies</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/legal/termsofuse" data-bi-name="termsofuse">Terms of Use</a></li>
				<li><a data-mscc-ic="false" href="https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/EN-US.aspx" data-bi-name="trademarks">Trademarks</a></li>
		<li>&copy; Microsoft 2021</li>
	</ul>
</footer>
	</section>

	<div id="action-panel" role="region" aria-label="Action Panel" class="action-panel has-default-focus" tabindex="-1"></div>
</body>
</html>
