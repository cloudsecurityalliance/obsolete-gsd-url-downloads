<!doctype html>
<!--[if lt IE 7 ]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if IE 7 ]>    <html class="no-js lt-ie9 lt-ie8" lang="en"> <![endif]-->
<!--[if IE 8 ]>    <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
    <meta charset="UTF-8">
    <title>Many invalid memory access issues in libarchive | The Fuzzing Project</title>
    <meta name="generator" content="Serendipity v.2.3.5">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="index,follow">
    <link rel="canonical" href="https://blog.fuzzing-project.org/47-Many-invalid-memory-access-issues-in-libarchive.html">
    <link rel="stylesheet" href="https://blog.fuzzing-project.org/serendipity.css?v=">
    <script src="/templates/2k11/js/modernizr-2.7.1.min.js"></script>
    <link rel="alternate" type="application/rss+xml" title="The Fuzzing Project RSS feed" href="https://blog.fuzzing-project.org/feeds/index.rss2">
    <link rel="alternate" type="application/x.atom+xml"  title="The Fuzzing Project Atom feed"  href="https://blog.fuzzing-project.org/feeds/atom.xml">
    <link rel="trackback" type="application/x-www-form-urlencoded" href="https://blog.fuzzing-project.org/comment.php?type=trackback&amp;entry_id=47">
    <link rel="pingback" href="https://blog.fuzzing-project.org/comment.php?type=pingback&amp;entry_id=47">
    <script src="/templates/jquery.js"></script>
    <script>jQuery.noConflict();</script>

    <script src="https://blog.fuzzing-project.org/serendipity.js?v="></script>
</head>
<body>
<a class="visuallyhidden" href="#content"><span lang="en">Skip to content</span></a>
<div id="page" class="clearfix">
    <header id="banner" class="clearfix col2r">
        <div id="identity">
            <a href="https://blog.fuzzing-project.org/">
                <h1>The Fuzzing Project</h1>
                <p>Blog and Advisories</p>            </a>
        </div>

        <form id="searchform" action="/index.php" method="get">
        <div>
            <input type="hidden" name="serendipity[action]" value="search">
            <label for="serendipityQuickSearchTermField">Quicksearch</label>
            <input id="serendipityQuickSearchTermField" name="serendipity[searchTerm]" type="search" placeholder="Search term(s)" value="">
            <input id="searchsend" name="serendipity[searchButton]" type="submit" value="Go!">
        </div>
        </form>
        
            </header>
        <nav id="primary-nav">
        <h2 class="visuallyhidden">Navigation</h2>

        <ul class="clearfix"><li><a href="https://fuzzing-project.org/">Back to main page</a></li><li><a href="https://fuzzing-project.org/software.html">Software list</a></li></ul>
    </nav>
        <div class="clearfix col2r">
        <main id="content"  class="plain-images">
        
            <article id="post_47" class="clearfix serendipity_entry">
        <header class="clearfix">
            <h2><a href="/47-Many-invalid-memory-access-issues-in-libarchive.html">Many invalid memory access issues in libarchive</a></h2>

            <span class="serendipity_byline block_level"><span class="single_user">Posted by <a href="https://blog.fuzzing-project.org/authors/1-Hanno-Boeck">Hanno BÃ¶ck</a> on </span><time datetime="2016-06-17T14:43:00+02:00">Friday, June 17. 2016</time></span>
        </header>

        <div class="clearfix content serendipity_entry_body">
                libarchive version 3.2.0 (released on April 30th) fixed a large number of memory access bugs that I reported to them a while ago. All issues (except the test suite failure) were found with the help of american fuzzy lop and either address sanitizer or undefined behavior sanitizer.<br />
<br />
<a href="https://github.com/libarchive/libarchive/issues/503">Unclear invalid memory read in CPIO parser</a><br />
<a href="http://libarchive.github.io/google-code/issue-395/comment-0/crash.cpio">Sample file</a><br />
<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-8915">CVE-2015-8915</a><br />
<br />
<a href="https://github.com/libarchive/libarchive/issues/504">Null pointer access in RAR parser</a><br />
<a href="http://libarchive.github.io/google-code/issue-396/comment-0/crash.rar">Sample file</a><br />
<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-8916">CVE-2015-8916</a><br />
<br />
<a href="https://github.com/libarchive/libarchive/issues/505">Null pointer access in CAB parser</a><br />
<a href="http://libarchive.github.io/google-code/issue-397/comment-0/segf.cab">Sample file</a><br />
<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-8917">CVE-2015-8917</a><br />
<br />
<a href="https://github.com/libarchive/libarchive/issues/506">Overlapping memcpy in CAB parser</a><br />
<a href="http://libarchive.github.io/google-code/issue-398/comment-0/memcpy.cab">Sample file</a><br />
<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-8918">CVE-2015-8918</a><br />
<br />
<a href="https://github.com/libarchive/libarchive/issues/510">Heap out of bounds read in LHA/LZH parser</a><br />
<a href="http://libarchive.github.io/google-code/issue-402/comment-0/bsdtar-invalid-read.lzh">Sample file</a><br />
<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-8919">CVE-2015-8919</a><br />
<br />
<a href="https://github.com/libarchive/libarchive/issues/511">Stack out of bounds read in ar parser</a><br />
<a href="http://libarchive.github.io/google-code/issue-403/comment-0/bsdtar-invalid-read-stack.a">Sample file</a><br />
<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-8920">CVE-2015-8920</a><br />
<br />
<a href="https://github.com/libarchive/libarchive/issues/512">Global out of bounds read in mtree parser</a><br />
<a href="http://libarchive.github.io/google-code/issue-404/comment-0/invalid-read-overflow.mtree">Sample file</a><br />
<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-8921">CVE-2015-8921</a><br />
<br />
<a href="https://github.com/libarchive/libarchive/issues/513">Null pointe access in 7z parser</a><br />
<a href="http://libarchive.github.io/google-code/issue-405/comment-0/bsdtar-null-ptr.7z">Sample file</a><br />
<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-8922">CVE-2015-8922</a><br />
<br />
<a href="https://github.com/libarchive/libarchive/issues/514">Unclear crashes in ZIP parser</a><br />
<a href="http://libarchive.github.io/google-code/issue-406/comment-0/bsdtar-zip-crash-variant1.zip">Sample file</a><br />
<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-8923">CVE-2015-8923</a><br />
<br />
<a href="https://github.com/libarchive/libarchive/issues/515">Heap out of bounds read in TAR parser</a><br />
<a href="http://libarchive.github.io/google-code/issue-407/comment-0/tar-heap-overflow.tar">Sample file</a><br />
<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-8924">CVE-2015-8924</a><br />
<br />
<a href="https://github.com/libarchive/libarchive/issues/516">Unclear invalid memory read in mtree parser</a><br />
<a href="http://libarchive.github.io/google-code/issue-408/comment-0/read_mtree.mtree">Sample file</a><br />
<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-8925">CVE-2015-8925</a><br />
<br />
<a href="https://github.com/libarchive/libarchive/issues/518">Null pointer access in RAR parser</a><br />
<a href="http://libarchive.github.io/google-code/issue-410/comment-0/segfault.rar">Sample file</a><br />
<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-8926">CVE-2015-8926</a><br />
<br />
<a href="https://github.com/libarchive/libarchive/issues/523">Heap out of bounds heap read read when reading password for malformed ZIP</a><br />
<a href="http://libarchive.github.io/google-code/issue-415/comment-0/pwcrash.zip">Sample file</a><br />
<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-8927">CVE-2015-8927</a><br />
<br />
<a href="https://github.com/libarchive/libarchive/issues/550">Heap out of bounds read in mtree parser</a><br />
<a href="https://crashes.fuzzing-project.org/libarchive-oob-process_add_entry.mtree">Sample file</a><br />
<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-8928">CVE-2015-89208</a><br />
<br />
I also reported a couple of lower severity issues (leaks, hangs, undefined behavior issues):<br />
<br />
<a href="https://github.com/libarchive/libarchive/issues/517">Memory leak in TAR parser</a><br />
<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-8929">CVE-2015-8929</a><br />
<br />
<a href="https://github.com/libarchive/libarchive/issues/522">Endless loop in ISO parser</a><br />
<a href="http://libarchive.github.io/google-code/issue-414/comment-0/hang.iso">Sample file</a><br />
<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-8930">CVE-2015-8930</a><br />
<br />
<a href="https://github.com/libarchive/libarchive/issues/539">Undefined behavior / signed integer overflow in mtree parser</a><br />
<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-8931">CVE-2015-8931</a><br />
<br />
<a href="https://github.com/libarchive/libarchive/issues/540">Use after free in test suite</a><br />
<br />
<a href="https://github.com/libarchive/libarchive/issues/547">Undefined behavior / invalid shiftleft in TAR parser</a><br />
<a href="https://crashes.fuzzing-project.org/libarchive-undefined-shiftleft">Sample file</a><br />
<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-8932">CVE-2015-8932</a><br />
<br />
<a href="https://github.com/libarchive/libarchive/issues/548">Undefined behavior / signed integer overflow in TAR parser</a><br />
<a href="https://crashes.fuzzing-project.org/libarchive-undefined-signed-overflow.tar">Sample file</a><br />
<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-8933">CVE-2015-8933</a><br />
<br />
Unfortunately one <a href="https://github.com/libarchive/libarchive/issues/521">out of bounds heap read bug in the RAR parser</a> (<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-8934">CVE-2015-8934</a>, <a href="http://libarchive.github.io/google-code/issue-413/comment-0/bsdtar-invalid-read.rar">sample file</a>) remained unfixed. I hope a fix will find its way into the next version. I was interested in making libarchive more robust because once all issues are fixed it can serve as a safer alternative to many low quality command line tools for various archiving formats.
                </div>
                
        <footer class="clearfix">
                                            <a href="/47-Many-invalid-memory-access-issues-in-libarchive.html#comments" title="0 Comments, 1 Trackback">0 Comments</a>
                                                    
        </footer>

        <!--
        <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
                 xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/"
                 xmlns:dc="http://purl.org/dc/elements/1.1/">
        <rdf:Description
                 rdf:about="https://blog.fuzzing-project.org/feeds/ei_47.rdf"
                 trackback:ping="https://blog.fuzzing-project.org/comment.php?type=trackback&amp;entry_id=47"
                 dc:title="Many invalid memory access issues in libarchive"
                 dc:identifier="https://blog.fuzzing-project.org/47-Many-invalid-memory-access-issues-in-libarchive.html" />
        </rdf:RDF>
        -->

                                            
        <section id="trackbacks" class="serendipity_comments serendipity_section_trackbacks">
            <h3>Trackbacks</h3>

            <div id="trackback_url" class="block_level"><a rel="nofollow" href="https://blog.fuzzing-project.org/comment.php?type=trackback&amp;entry_id=47" title="This link is not meant to be clicked. It contains the trackback URI for this entry. You can use this URI to send ping- &amp; trackbacks from your own blog to this entry. To copy the link, right click and select &quot;Copy Shortcut&quot; in Internet Explorer or &quot;Copy Link Location&quot; in Mozilla.">Trackback specific URI for this entry</a></div>

            <article id="c716" class="clearfix serendipity_comment odd">
    <h4><cite>The Fuzzing Project</cite> on <time datetime="2016-06-23T15:56:18+02:00">Thursday, June 23. 2016</time>: <a href="http://blog.fuzzing-project.org/48-Out-of-bounds-read-and-signed-integer-overflow-in-libarchive.html">Out of bounds read and signed integer overflow in libarchive</a></h4>
    <details>
        <summary>Show preview</summary>
        <div class="content serendipity_commentBody">I recently wrote about a large number of bugs and potential security issues in libarchive. The release 3.2.0 missed one fix for an out of bounds read in the rar parser. Also I discovered one additional signed integer overflow issue with ubsan. Both issues</div>
    </details>
</article>

        </section>

        <section id="comments" class="serendipity_comments serendipity_section_comments">
            <h3>Comments</h3>

            <p class="manage_comments">Display comments as
                           <a rel="nofollow" href="/index.php?url=47-Many-invalid-memory-access-issues-in-libarchive.html&amp;serendipity[cview]=linear#comments">Linear</a> | Threaded
                        </p>

            <p class="nocomments">No comments</p>

                </section>
            <a id="feedback"></a>
                        <section id="respond" class="serendipity_section_commentform">
            <h3>Add Comment</h3>
            <div id="serendipityCommentFormC" class="serendipityCommentForm">
    <div id="serendipity_replyform_0"></div>
    <a id="serendipity_CommentForm"></a>
    <form id="serendipity_comment" action="/index.php?url=47-Many-invalid-memory-access-issues-in-libarchive.html#feedback" method="post">
    <div><input type="hidden" name="serendipity[entry_id]" value="47"></div>
    <div class="form_field">
        <label for="serendipity_commentform_name">Name*</label>
        <input id="serendipity_commentform_name" name="serendipity[name]" type="text" value="" placeholder="e.g. John Doe" required>
    </div>
    <div class="form_field">
        <label for="serendipity_commentform_email">Email</label>
        <input id="serendipity_commentform_email" name="serendipity[email]" type="email" value="" placeholder="e.g. mail@example.org">
    </div>
    <div class="form_field">
        <label for="serendipity_commentform_url">Homepage</label>
        <input id="serendipity_commentform_url" name="serendipity[url]" type="url" value="" placeholder="e.g. http://example.org">
    </div>
    <div class="form_tarea">
        <label for="serendipity_commentform_comment">Comment*</label>
        <textarea id="serendipity_commentform_comment" name="serendipity[comment]" rows="10" placeholder="What do you want to say?" required></textarea>
    </div>
    <div class="form_field">
        <label id="reply-to-hint" for="serendipity_replyTo">In reply to</label>
        <select id="serendipity_replyTo" onchange="" name="serendipity[replyTo]"><option value="0">[ Top level ]</option></select>
    </div>
    <div id="serendipity_comment_phone" class="serendipity_commentDirection comment_phone_input">
    <label for="serendipity_commentform_phone">Phone*</label>
    <input id="serendipity_commentform_phone" class="comment_phone_input" type="text" name="serendipity[phone]" value="" size="50" maxlength="60" placeholder="You don't want to give me your number, do you? ;)"/>
</div>
<div id="serendipity_comment_beecaptcha" class="form_field">
    <label for="bee_captcha">What is zero plus one?</label>
    <input class="" type="text" id="bee_captcha" name="serendipity[beecaptcha]" size="10" value="" placeholder=""/>
</div>
<div class="serendipity_commentDirection serendipity_comment_s9ymarkup">Enclosing asterisks marks text as bold (*word*), underscore are made via _word_.</div><div class="serendipity_commentDirection serendipity_comment_emoticate">Standard emoticons like :-) and ;-) are converted to images.</div><div class="serendipity_commentDirection serendipity_comment_spamblock">E-Mail addresses will not be displayed and will only be used for E-Mail notifications.</div><input type="hidden" name="serendipity[token]" value="a8aeadb5cd1c98a677ba3c2214a48157" />
<div class="serendipity_commentDirection serendipity_comment_captcha"><br />To prevent automated Bots from commentspamming, please enter the string you see in the image below in the appropriate input box. Your comment will only be submitted if the strings match. Please ensure that your browser supports and accepts cookies, or your comment cannot be verified correctly.<br /><img src="https://blog.fuzzing-project.org/plugin/captcha_e40f12d630128cbaea641cf6c843a764" onclick="this.src=this.src + '1'" title="Enter the string you see here in the input box!" alt="CAPTCHA" class="captcha" /><br /><label for="captcha">Enter the string from the spam-prevention image above: </label><br /><input class="input_textbox" type="text" size="5" name="serendipity[captcha]" value="" id="captcha" /></div>
    <fieldset class="form_toolbar">
        <legend class="visuallyhidden">Form options</legend>
        <div class="form_box">
            <input id="checkbox_remember" name="serendipity[remember]" type="checkbox" ><label for="checkbox_remember">Remember Information? </label>
        </div>
          <div class="form_box">
            <input id="checkbox_subscribe" name="serendipity[subscribe]" type="checkbox"  ><label for="checkbox_subscribe">Subscribe to this entry</label>
        </div>
      </fieldset>
    <div class="form_button">
        <input id="serendipity_preview" name="serendipity[preview]" type="submit" value="Preview">
        <input id="serendipity_submit" name="serendipity[submit]" type="submit" value="Submit Comment">
    </div>
</form>
</div>

        </section>

        
    </article>
        



        </main>
                <aside id="sidebar_right">
            <h2 class="visuallyhidden">Sidebar</h2>
                <section class="sidebar_plugin clearfix even serendipity_plugin_html_nugget">
                <h3>The Fuzzing Project</h3>
                <div class="sidebar_content clearfix">You  may want to go <a href="https://fuzzing-project.org/">back to the Fuzzing Project's main page</a> or <a href="https://fuzzing-project.org/software/">software list</a>.</div>
    </section>
    <section class="sidebar_plugin clearfix odd serendipity_plugin_archives">
                <h3>Archives</h3>
                <div class="sidebar_content clearfix"><ul class="plainList">
    <li><a href="/archives/2021/10.html" title="October 2021">October 2021</a></li>
    <li><a href="/archives/2021/09.html" title="September 2021">September 2021</a></li>
    <li><a href="/archives/2021/08.html" title="August 2021">August 2021</a></li>
    <li><a href="/index.php?frontpage">Recent...</a></li>
    <li><a href="https://blog.fuzzing-project.org/archive">Older...</a></li>
</ul>
</div>
    </section>
    <section class="sidebar_plugin clearfix even serendipity_plugin_categories">
                <h3>Categories</h3>
                <div class="sidebar_content clearfix"><form action="https://blog.fuzzing-project.org/index.php?frontpage" method="post">
              <div id="serendipity_category_form_content">
<ul id="serendipity_categories_list" style="list-style: none; margin: 0px; padding: 0px">
<li class="category_depth0 category_1" style="display: block;"><input style="width: 15px" type="checkbox" name="serendipity[multiCat][]" value="1" /><a class="serendipity_xml_icon" href="/feeds/categories/1-advisories.rss"><img src="/templates/2k11/img/xml.gif" alt="XML" style="border: 0px" /></a> <a href="/categories/1-advisories" title="" style="padding-left: 0px">advisories</a></li>
</ul>
<div class="category_submit"><input type="submit" name="serendipity[isMultiCat]" value="Go!" /></div>
</div>
</form>
</div>
    </section>
    <section class="sidebar_plugin clearfix odd serendipity_plugin_syndication">
                <h3>Syndicate This Blog</h3>
                <div class="sidebar_content clearfix">
<ul id="serendipity_syndication_list" class="plainList"><li><a class="subtome" href="https://blog.fuzzing-project.org/feeds/index.rss2" onclick="document.subtomeBtn=this;document.subtomeBtn.dataset['subtomeFeeds']='https%3A%2F%2Fblog.fuzzing-project.org%2Ffeeds%2Findex.rss2';var s=document.createElement('script');s.src='https://www.subtome.com/load.js';document.body.appendChild(s);return false;"><img src="/templates/2k11/img/subtome.png" alt="XML" style="border: 0px" /></a>
</li>
<li><a class="subtome" href="https://blog.fuzzing-project.org/feeds/comments.rss2" onclick="document.subtomeBtn=this;document.subtomeBtn.dataset['subtomeFeeds']='https%3A%2F%2Fblog.fuzzing-project.org%2Ffeeds%2Fcomments.rss2';var s=document.createElement('script');s.src='https://www.subtome.com/load.js';document.body.appendChild(s);return false;"><img src="/templates/2k11/img/xml.gif" alt="XML" style="border: 0px" /></a>
 <a href="https://blog.fuzzing-project.org/feeds/comments.rss2" onclick="document.subtomeBtn=this;document.subtomeBtn.dataset['subtomeFeeds']='https%3A%2F%2Fblog.fuzzing-project.org%2Ffeeds%2Fcomments.rss2';var s=document.createElement('script');s.src='https://www.subtome.com/load.js';document.body.appendChild(s);return false;">Comments</a>
</li>
</ul>
</div>
    </section>

        </aside>
        </div>

    <footer id="colophon">
        <p><span lang="en">Powered by <a href="http://s9y.org">Serendipity</a> &amp; the <i>2k11</i> theme.</span></p>
    </footer>
</div>

<script src="/templates/2k11/js/2k11.min.js"></script>

<script>var spamBeeData = function() { var PSWzI = {};var XiSbp = unescape('%64%65%66%61%75%6c%74');var YXHFt = unescape('%31%35%39%37%37%36%36%36%35%33');var kkkUK = unescape('%25%45%46%25%41%46%25%38%43');PSWzI['method'] = XiSbp;PSWzI['scrambleKey'] = YXHFt;PSWzI['answer'] = kkkUK;return PSWzI; }();</script>
<script src="/plugins/serendipity_event_spamblock_bee/serendipity_event_spamblock_bee.js"></script>

</body>
</html>
