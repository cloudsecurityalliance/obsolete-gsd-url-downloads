<!DOCTYPE html>
<html lang="ru">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link href="/bitrix/cache/css/s1/amonitoring/page_301e0515e9d3ba85666684946cf99eda/page_301e0515e9d3ba85666684946cf99eda_v1.css?15888514211100" type="text/css"  rel="stylesheet" />
<link href="/bitrix/cache/css/s1/amonitoring/template_2ce4d1bd7d3f721aeb2eaec43452af7a/template_2ce4d1bd7d3f721aeb2eaec43452af7a_v1.css?1588850961765" type="text/css"  data-template-style="true" rel="stylesheet" />
<script type="text/javascript">var _ba = _ba || []; _ba.push(["aid", "32b028ed9c27d643ac9e6fdca71a7c6b"]); _ba.push(["host", "amonitoring.ru"]); (function() {var ba = document.createElement("script"); ba.type = "text/javascript"; ba.async = true;ba.src = (document.location.protocol == "https:" ? "https://" : "http://") + "bitrix.info/ba.js";var s = document.getElementsByTagName("script")[0];s.parentNode.insertBefore(ba, s);})();</script>


    <title>One more Steam Windows Client Local Privilege Escalation 0day</title>    <meta content="Описание" name="description">
    <meta content="Ключевые слова" name="keywords">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <link rel="stylesheet" href="/bitrix/templates/amonitoring/css/bootstrap.css">
    <link rel="stylesheet" href="/bitrix/templates/amonitoring/css/owl.carousel.css">
    <link rel="stylesheet" href="/bitrix/templates/amonitoring/css/style.css">
    <link rel="icon" href="/favicon.ico">
    <link rel="shortcut icon" href="/favicon.ico">
    <!--[if lt IE 9]><script src="/bitrix/templates/amonitoring/js/html5shiv.js"></script><![endif]-->
    <link rel="stylesheet" href="/bitrix/templates/amonitoring/js/fancybox/jquery.fancybox.css">
    <script src="/bitrix/templates/amonitoring/js/jquery.min.js"></script>
            <script>
            var onloadCallback = function() {
                mysitekey = '6LfAmjQUAAAAAOlKkyCSJIr2n3xydI6U33qeRtNP';
                grecaptcha.render('captcha_footer', {
                    'sitekey' : mysitekey
                });
                grecaptcha.render('captcha_feedback', {
                    'sitekey' : mysitekey
                });
            };
        </script>
            <script src="https://www.google.com/recaptcha/api.js?onload=onloadCallback&render=explicit" async defer></script>
    </head>
<body>
<header class="header">
    <div class="container">
        <div class="header-table full">
            <div class="header-cell header-open hidden-md hidden-lg">
                <a href="#" class="nav-open icon icon-nav-open"></a>
            </div>
            <div class="header-cell header-logo">
                <div class="header-logo-table">
                    <div class="header-logo-cell">
                        <a href="/">
                            <img src="/bitrix/templates/amonitoring/img/logo.png" alt="" title="">
                        </a>
                    </div>
                    <div class="header-logo-cell header-title">ПЕРСПЕКТИВНЫЙ<br>МОНИТОРИНГ</div>
                </div>
            </div>
            <div class="header-cell header-incident hidden-xs hidden-sm">
                <a href="/incident/" class="button full">Сообщить об инциденте</a>
            </div>
            <div class="header-cell header-search hidden-xs hidden-sm">
    <form action="/search/" class="clearfix">
        <div class="header-search-input-outer">
            <input type="text" value="" name="q" placeholder="Поиск" class="header-search-input full">
            <button type="submit" class="header-search-submit icon icon-search">Найти</button>
        </div>
    </form>
</div>            <div class="header-cell header-contacts hidden-xs hidden-sm">
                <div class="header-social">
                    <a href="https://www.facebook.com/advancedmonitoring/" class="icon icon-social icon-fb"></a>
                    <a href="https://twitter.com/am_rnd" class="icon icon-social icon-tw"></a>
                    <a href="https://habrahabr.ru/company/pm/" class="icon icon-social icon-habr"></a>
                    <a href="https://t.me/pm_public" class="icon icon-social icon-tele"></a>
                    <a href="https://www.linkedin.com/company/advanced-monitoring" class="icon icon-social icon-in"></a>
                </div>
                <div class="header-phone">
                    <span class="icon icon-phone"></span> <a href="tel:+74957376197">+7 495 737-61-97</a>
                </div>
                <div class="header-mail">
                    <span class="icon icon-mail"></span> <a href="mailto:info@amonitoring.ru">info@amonitoring.ru</a>
                </div>
            </div>
        </div>
        <nav class="nav">
            <div class="nav-inner">
                

    <ul class="nav-level-1">
			<li><a href="/about/">Компания</a></li>
		
			<li><a href="/news/">Новости</a></li>
		
			<li><a href="/service/">Услуги</a></li>
		
			<li><a href="/product/">Продукты</a></li>
		
			<li><a href="/article/" class="selected">Статьи</a></li>
		
			<li><a href="/vacancy/">Карьера</a></li>
		
			<li><a href="/contact/">Контакты</a></li>
		

</ul>
                <div class="hidden-md hidden-lg">
                    <div class="nav-block header-incident">
                        <a href="#" class="button full">Сообщить об инциденте</a>
                    </div>
                    <div class="nav-bottom">
                        <div class="nav-block header-search">
                            <form action="#" class="clearfix">
                                <div class="header-search-input-outer">
                                    <input type="text" value="" placeholder="Поиск" class="header-search-input full">
                                    <button type="submit" class="header-search-submit icon icon-search-white">Найти</button>
                                </div>
                            </form>
                        </div>
                        <div class="nav-block header-contacts">
                            <div class="header-social">
                                <a href="https://www.facebook.com/advancedmonitoring/" class="icon icon-social icon-fb"></a>
                                <a href="https://twitter.com/am_rnd" class="icon icon-social icon-tw"></a>
                                <a href="https://habrahabr.ru/company/pm/" class="icon icon-social icon-habr"></a>
                                <a href="https://t.me/pm_public" class="icon icon-social icon-tele"></a>
                                <a href="https://www.linkedin.com/company/advanced-monitoring" class="icon icon-social icon-in"></a>
                            </div>
                            <div class="header-phone">
                                <span class="icon icon-phone"></span> <a href="tel:+74957376197">+7 495 737-61-97</a>
                            </div>
                            <div class="header-mail">
                                <span class="icon icon-mail"></span> <a href="mailto:info@amonitoring.ru">info@amonitoring.ru</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </nav>
    </div>
</header>
    <div class="content">
        <div class="container">
                            <h1 class="main-h1" style="visibility: hidden"></h1>
                            <main class="main">
	<input id="next_page" type="hidden" value="2">

<link href="/bitrix/css/main/font-awesome.css?151119204028777" type="text/css" rel="stylesheet" />
<div class="path" style="visibility: hidden">
				<a href="/" class="path-item">Отзывы</a>
				<a href="/article/" class="path-item">Статьи</a>
				<span class="path-item"> &gt; <a href="">One more Steam Windows Client Local Privilege Escalation 0day</a></span><div style="clear:both"></div></div><article class="new new-single clearfix">
    <div class="new-image">
        <img src="/upload/iblock/9ad/a62d2d9039df4829ee6e772fa2be28c2.svg" alt="" class="block">
    </div>
    <div class="new-header">
        <div class="new-date">20.08.2019</div>
        <h1 class="new-title">One more Steam Windows Client Local Privilege Escalation 0day</h1>
    </div>
    <div class="new-info">
        <div class="new-text text">
            <h2>Previously on Privilege Escalation</h2>
<p>
	 Not long ago I <a href="/article/steamclient-0day/">published an article</a> about Steam vulnerability. I received a lot of feedback. But Valve didn’t say a single word, HackerOne sent a huge letter and, mostly, kept silence. Eventually things escalated with Valve and I got banned by them on HackerOne — I can no longer participate in their vulnerability rejection program (the rest of H1 is still available though).
</p>
<p style="text-align: center;">
 <img width="541" alt="steameoph1.png" src="/upload/medialibrary/502/steameoph1.png" height="281" title="steameoph1.png"><br>
</p>
<p>
</p>
<p>
	 You can read the story in more detail in previous article, here is a couple of words about current situation.
</p>
<p>
	 And it’s sad and simple — Valve keeps failing. Last patch, that should have solved the problem, can be easily bypassed (<a href="https://twitter.com/general_nfs/status/1162067274443833344">https://twitter.com/general_nfs/status/1162067274443833344</a>) so the vulnerability still exists. Yes, I’ve checked, it works like a charm.
</p>
<p>
	 But this article is not about an old vulnerability, it’s about new one. Since Valve decided to read a public report instead of private report one more time, I won’t take that pleasure away from them.
</p>
<h2>Short vulnerability description</h2>
<p>
	 Vulnerability exploitation is quite simple and consists of three steps:
</p>
<p>
	 1)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Preparing the exploitation environment (you’ve got two ways via different weaknesses).
</p>
<p>
	 2)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Making Steam copy and run our DLL.
</p>
<p>
	 3)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DLL has to match some requirements.
</p>
<p>
</p>
<p>
	 Any of these actions could be performed by any OS user, more precisely — any program on computer. As a result any code code could be executed with maximum privileges, this vulnerability class is called «escalation of privileges» (eop) or «local privilege escalation» (lpe). Despite any application itself could be harmful, achieving maximum privileges can lead to much more disastrous consequences. For example, disabling firewall and antivirus, rootkit installation, concealing of process-miner, theft any PC user’s private data — is just a small portion of what could be done.
</p>
<h2>Theoretical minimum</h2>
<p>
	 It was very funny to read comments to previous article, where community wrote “user can’t write to HKLM registry keys” or “you need administrator rights to create a symlink”. What’s interesting is that checking this statements takes almost as long as writing such comment. And yes, just in case, both statements are false. Because of this I decided to write a small section in this article, where I describe some difficult steps of exploitation.
</p>
<p>
	 1)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; “User can’t write to HKLM registry section”.
</p>
<p>
	 There is no such general rule. There are specific security rules for specific registry keys. Valve gives full control to all users on HKLM\SOFTWARE\Wow6432Node\Valve\steam branch, so any user can do whatever he wants with it.
</p>
<p>
	 2)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; “It’s not possible to start or stop service without administrator rights”.
</p>
<p>
	 There is no such general rule. There are specific security rules for specific services. Valve gave any user permissions to start and stop Steam Client Service.
</p>
<p>
	 3)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; “You need administrator rights to create a symlink”.
</p>
<p>
	 This statement is funny itself, because there are five general types of links in Windows and only one and a half require such rights. Let me introduce you to: file symbolic link, object directory symbolic link, hard link, NTFS reparse point and reg_link. Administrator rights are necessary only to create file symbolic link and for permanent object directory symbolic link (temporary object directory symbolic link lives as long as lives the session, where it was created, most commonly until reboot, and doesn’t require any special rights).
</p>
<p>
	 4)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; “Folder to folder symlink”.
</p>
<p>
	 This is called NTFS reparse point or NTFS mount point. The name isn’t really important, the point is, this thing allows to use one directory as a link to another one. Could be created by user from an empty folder, if user has write permissions for it. Use CreateMountPoint.exe from symboliclink testing tools package (<a href="https://github.com/googleprojectzero/symboliclink-testing-tools/">https://github.com/googleprojectzero/symboliclink-testing-tools/</a>) to create it.
</p>
<p>
	 5)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Opportunistic Lock
</p>
<p>
	 Opportunistic Lock or OpLock (<a href="https://docs.microsoft.com/ru-ru/windows/win32/fileio/opportunistic-locks">https://docs.microsoft.com/ru-ru/windows/win32/fileio/opportunistic-locks</a>) is a special mechanism that allows to temporarily block access to a certain file. There are many details about OpLocks, that could be described here, like features of working with files and different types of access. In short, the program can “catch” an event of access to a certain file and temporarily hold it. OpLocks could be set with SetOpLock.exe utility from the same symboliclink testing tools package (<a href="https://github.com/googleprojectzero/symboliclink-testing-tools/">https://github.com/googleprojectzero/symboliclink-testing-tools/</a>). Launch of this utility sets the needed oplock; when access to oplocked file occurs, the utility prints a message; oplock is released by pressing “Enter”.
</p>
<p>
	 6)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BaitAndSwitch
</p>
<p>
	 It’s a name of a technique, that combines creation of links and oplocks to win TOCTOU (time of check\time of use). This method is simpler described with an example:
</p>
<p>
	 Imagine a program that does something like this:
</p>
<p>
 <i>ReadContentFromFile(“C:\test\myfile.txt”); </i>
</p>
 <i> </i>
<p>
 <i>
	ReadContentFromFile(“C:\test\myfile.txt”);</i>
</p>
<p>
	 It’s just a reading of the same file twice in a row. Is there always the same information read? No, not necessarily.
</p>
<p>
	 First, we create two folders with “C:\test1\myfile.txt” and “C:\test2\myfile.txt” files. Next, we empty “C:\test” and create a reparse point to “C:\test1” from it. Then we set oplock to the file from the first folder and run a program. As soon as it opens the file, oplock is being triggered. We change the reparse point, so “C:\test” links to “C:\test2”. Now, after oplock is released, program will read information for a second time from another file.
</p>
<p>
	 Where is it applicable? It’s easy to answer — there are quite typical situations, where firstly file is being checked (first read) and then executed (second read). That’s how you give one file for a check and the other for execution.
</p>
<p>
</p>
<p>
	 Now we’re all set for exploitation.
</p>
<h2>Exploitation 1. Preparing the environment</h2>
<p>
	 It’s necessary to prepare the working environment. Firstly, we need to obtain CreateMountPoint.exe and SetOpLock.exe files.
</p>
<p>
	 Now it’s needed to make some small changes to Steam file structure. Our goal is to have folder with Steam.exe and steamclient.dll, and without “bin” folder. There are two ways to do this.
</p>
<p>
 <b>Way 1</b>
</p>
<p>
	 Rename\remove bin folder from Steam root folder. That’s it, you’re gorgeous (Steam gives every user permissions for everything in it’s folder).
</p>
<p>
 <b>Way 2</b>
</p>
<p>
	 Change InstallPath value to path to any of our folders in HKLM\SOFTWARE\Wow6432Node\Valve\steam registry key. Copy Steam.exe and steamclient.dll to that folder from original Steam folder.
</p>
<p>
	 So, we’ve prepared C:\Steam folder (there could be any path, but I will use this in examples) with any of the ways. Now we have to create b1, b2, b3 and b4 folders in it. Let’s copy steamservice.dll in the first three of them (originally located in bin folder of Steam package), and copy specially crafted library with the same name — steamservice.dll — in b4. More specifically on library preparing in Exploitation 3.
</p>
<p>
</p>
<p>
	 Open two console windows. Now environment preparation is complete.
</p>
<h2>Exploitation 2. Switching the file</h2>
<p>
	 I think that it’s clear from preparations that it’s going to be something like BaitAndSwitch, described earlier.
</p>
<p>
</p>
<p>
	 ProcMon screenshot:
</p>
<p style="text-align: center;">
 <img width="892" alt="steameopprocmon.png" src="/upload/medialibrary/0a2/steameopprocmon.png" height="799" title="steameopprocmon.png"><br>
</p>
<p>
	 Above is a fragment of typical Steam Client Service start log. Take a look at the part, where firstly dll is being copied to C:\Program Files (x86)\Common Files\Steam and then is being loaded. We will make Steam copy our library from C:\Steam\b4 instead. Unfortunately, at first there are checks, among them the library signature is being checked to prevent dll hijacking (oh, irony).
</p>
<p>
	 So, I’ll describe exploitation step by step. Steps are combined in groups of similar actions. For each step there is noted what to execute, where to do it and what happens after it (the names of console windows are “cmd1” and “cmd2”).
</p>
<p>
	 1)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Create &nbsp;C:\Steam\bin folder and execute the following command in cmd1:
</p>
<p>
	 CreateMountPoint.exe С:\Steam\bin C:\Steam\b1
</p>
<p>
	 2)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set oplock in cmd1:
</p>
<p>
	 SetOpLock.exe C:\Steam\b1\steamservice.dll
</p>
<p>
	 3)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Run Steam Client Service. In cmd1 you can see that the access to the file has been caught.
</p>
<p>
 <br>
</p>
<p>
</p>
<p>
	 4)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Remove C:\Steam\bin, create C:\Steam\bin folder in it’s place and execute the following in cmd2:
</p>
<p>
	 CreateMountPoint.exe С:\Steam\bin C:\Steam\b2
</p>
<p>
	 5)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set oplock in cmd2:
</p>
<p>
	 SetOpLock.exe C:\Steam\b2\steamservice.dll
</p>
<p>
	 6)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Release oplock in cmd1. You can see that you’ve caught an access to file in cmd2.
</p>
<p>
</p>
<p>
 <br>
</p>
<p>
	 7)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Remove C:\Steam\bin, create C:\Steam\bin folder in it’s place and execute the following in cmd1:
</p>
<p>
	 CreateMountPoint.exe С:\Steam\bin C:\Steam\b3
</p>
<p>
	 8)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set oplock in cmd1:
</p>
<p>
	 SetOpLock.exe C:\Steam\b3\steamservice.dll
</p>
<p>
	 9)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Release oplock in cmd2. In cmd1 you can see that you’ve caught access to file.
</p>
<p>
</p>
<p>
 <br>
</p>
<p>
	 10)&nbsp;&nbsp; Remove C:\Steam\bin, create C:\Steam\bin folder in it’s place and execute the following in cmd2:
</p>
<p>
	 CreateMountPoint.exe С:\Steam\bin C:\Steam\b2
</p>
<p>
	 11)&nbsp;&nbsp; Set oplock in cmd2:
</p>
<p>
	 SetOpLock.exe C:\Steam\b2\steamservice.dll
</p>
<p>
	 12)&nbsp;&nbsp; Release oplock in cmd1. You can see that you’ve caught access to file in cmd2.
</p>
<p>
</p>
<p>
 <br>
</p>
<p>
	 13)&nbsp;&nbsp; Remove C:\Steam\bin, create C:\Steam\bin in it’s place and execute the following in cmd1:
</p>
<p>
	 CreateMountPoint.exe С:\Steam\bin C:\Steam\b3
</p>
<p>
	 14)&nbsp;&nbsp; Set oplock in cmd1:
</p>
<p>
	 SetOpLock.exe C:\Steam\b3\steamservice.dll
</p>
<p>
	 15)&nbsp;&nbsp; Release oplock in cmd2. In cmd1 you can see that you’ve caught access to file .
</p>
<p>
</p>
<p>
 <br>
</p>
<p>
	 16)&nbsp;&nbsp; Remove C:\Steam\bin, create C:\Steam\bin folder in it’s place and execute the following in cmd2:
</p>
<p>
	 CreateMountPoint.exe С:\Steam\bin C:\Steam\b4
</p>
<p>
	 17)&nbsp;&nbsp; Release oplock in cmd1.
</p>
<p>
	 It might look complicated, but the idea is quite simple: redirect first 5 (out of 6) accesses to C:\Steam\bin\steamservice.dll to the original file from different folders was given (in the access order: b1, b2, b3, b2, b3), and at the 6th access redirect to our payload.
</p>
<p>
	 Here is schematic description:<br>
</p>
<p>
 <img width="1024" alt="steameopscheme.png" src="/upload/medialibrary/0cf/steameopscheme.png" height="541" title="steameopscheme.png"><br>
</p>
<p>
	 On the left is a normal behavior of application, on the right is behavior during exploitation.
</p>
<h2>Exploitation 3. Injectable library</h2>
<p>
	 First I tried to use my most common dll, which creates interactive console in DllEntry, as a payload. Since the dll code is being executed within Steam Client Service, it will be executed with the service’s permissions — NT AUTHORITY\SYSTEM. But in the end of exploitation the console didn’t show up.
</p>
<p>
	 After loading, Steam service figures out that it’s being tricked and shuts down before payload in my dll is being executed.
</p>
<p>
	 I had to reverse a little bit and it turned out that the service checks the existence of
</p>
<p>
 <i>int WINAPI SteamService_RunMainLoop() </i>
</p>
 <i> </i>
<p>
 <i>
	void WINAPI SteamService_Stop()</i>
</p>
<p>
</p>
<p>
	 functions in library after dll loads. Moreover, service calls the first function, where I decided to place my payload (running of interactive console with service permissions — NT AUTHORITY\SYSTEM). That’s all, I repeat all actions and gain the console with maximum permissions.
</p>
<h2>Conclusion</h2>
<p>
	 All of it could be wrapped in exe-file, but I don’t really want to bother. I think the demo videos would be enough (registry way (<a href="https://www.youtube.com/watch?v=ZCHrjP0cMew">https://www.youtube.com/watch?v=ZCHrjP0cMew</a>), filesystem way (<a href="https://www.youtube.com/watch?v=I93aH86BUaE">https://www.youtube.com/watch?v=I93aH86BUaE</a>)).
</p>
<p>
	 I will not copy «Speculations» section from the previous article here. The facts are: the old vulnerability is relevant; you have just read about new one, and Valve still don’t want to hear about any problems.
</p>
<h2>Update (Aug 22, 2019)</h2>
<p>
	 Two hot news:
</p>
<p>
	 1) Beta Client got update with fix (<a href="https://steamcommunity.com/groups/SteamClientBeta#announcements/detail/1599262071399843693)">https://steamcommunity.com/groups/SteamClientBeta#announcements/detail/1599262071399843693)</a>. I'll check it when main client get this update.
</p>
<p>
	 2) Valve change their policy of LPE on h1 (<a href="https://hackerone.com/valve/policy_versions">https://hackerone.com/valve/policy_versions</a>). Great news!
</p>
<h2>
Update (Aug 27, 2019)</h2>
<p>
	 Good news.
</p>
<p>
	 Main client got update with fixes (<a href="https://store.steampowered.com/news/53677/)">https://store.steampowered.com/news/53677/)</a>.
</p>
<p>
	 I was unbanned on H1 and got reward.
</p>
<p>
 <br>
</p>
<h2>About author</h2>
<p>
	 Vasily Kravets, Lead Expert
</p>
<p>
 <a href="mailto:xi-tauw@xi-tauw.info">mailto:xi-tauw@xi-tauw.info</a>
</p>
<p>
 <a href="mailto:Vasily.Kravets@amonitoring.ru">mailto:Vasily.Kravets@amonitoring.ru</a>
</p>
<p>
 <a href="https://twitter.com/PsiDragon">https://twitter.com/PsiDragon</a>
</p>
<p>
 <a href="https://t.me/xitauw">https://t.me/xitauw</a>
</p>        </div>
        <div class="new-tags tags"> Теги:
            <div class="tags-inner">
                                                    <a href="/article/?tag=steam">steam</a>
                                        <a href="/article/?tag=0day">0day</a>
                                        <a href="/article/?tag=public">public</a>
                                        <a href="/article/?tag=disclosure">disclosure</a>
                                        <a href="/article/?tag=уязвимость">уязвимость</a>
                                        <a href="/article/?tag=уязвимость нулевого дня">уязвимость нулевого дня</a>
                                        <a href="/article/?tag=повышение привилегий">повышение привилегий</a>
                                        <a href="/article/?tag=eop">eop</a>
                                        <a href="/article/?tag=lpe">lpe</a>
                                </div>
        </div>
                    <script src="//yastatic.net/es5-shims/0.0.2/es5-shims.min.js"></script>
            <script src="//yastatic.net/share2/share.js"></script>
            <div class="social">Поделиться статьей в:
                <div class="ya-share2 social-inner" style="visibility: hidden; position: relative; bottom: 5px;" data-services="facebook,twitter,telegram,linkedin"></div>
            </div>
                </div>
</article>
    <div class="new-extra">
        <div class="new-extra-title">Рекомендуемые статьи</div>
        <div class="owl-carousel">
                            <div>
                    <div class="new-extra-item">
                        <div class="new-extra-item-image">
                            <img src="/upload/iblock/9ad/a62d2d9039df4829ee6e772fa2be28c2.svg" alt="" class="">
                        </div>
                                                <div class="new-date">20.08.2019</div>
                        <div class="new-title">One more Steam Windows Client Local Privilege Escalation 0day</div>
                        <div class="new-link">
                            <a href="/article/onemore_steam_eop_0day/">Читать</a>
                        </div>
                    </div>
                </div>
                                <div>
                    <div class="new-extra-item">
                        <div class="new-extra-item-image">
                            <img src="/upload/iblock/828/a62d2d9039df4829ee6e772fa2be28c2.svg" alt="" class="">
                        </div>
                                                <div class="new-date">07.08.2019 09:44:00</div>
                        <div class="new-title">Steam Windows Client Local Privilege Escalation 0day</div>
                        <div class="new-link">
                            <a href="/article/steamclient-0day/">Читать</a>
                        </div>
                    </div>
                </div>
                                <div>
                    <div class="new-extra-item">
                        <div class="new-extra-item-image">
                            <img src="/upload/iblock/960/a62d2d9039df4829ee6e772fa2be28c2.svg" alt="" class="">
                        </div>
                                                <div class="new-date">29.05.2019</div>
                        <div class="new-title">Анализ поверхности атаки для банков и организаций кредитно-финансовой сферы</div>
                        <div class="new-link">
                            <a href="/article/attack-surface/">Читать</a>
                        </div>
                    </div>
                </div>
                        </div>
    </div>
    <script>
    $(document).ready(function () {
        $(".main-h1").before($(".path"));
    });
    $(window).load(function () {
        $(".ya-share2__badge").each(function () {
            $(this).remove();
        });
        $(".ya-share2__title").each(function () {
            $(this).remove();
        });
        $(".ya-share2__item_service_facebook").children().eq(0).addClass("icon icon-social icon-fb");
        $(".ya-share2__item_service_twitter").children().eq(0).addClass("icon icon-social icon-tw");
        $(".ya-share2__item_service_telegram").children().eq(0).addClass("icon icon-social icon-tele");
        $(".ya-share2__item_service_linkedin").children().eq(0).addClass("icon icon-social icon-in");

        $(".ya-share2").css("visibility","visible");
    });
</script>
            </main>
        </div>
    </div>

<footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-6">
                <div class="row">
                    <div class="col-md-4">
                        <div class="footer-block">
                            <div class="footer-title">
                                <a href="/about/">О нас</a>
                            </div>
                            <div class="footer-content">
                                <ul>
                                    <li><a href="/about/">Компания</a></li>
                                    <li><a href="/vacancy/">Вакансии</a></li>
                                    <li><a href="/contact/">Контакты</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-8">
                        <div class="footer-block">
                            <div class="footer-title">
                                <a href="#">Услуги</a>
                            </div>
                            <div class="footer-content">
                                <ul>
                                    <li><a href="/service/security-operation-center/">Центр мониторинга компьютерных атак</a></li>
                                    <li><a href="/service/snort/">Разработка правил Snort IDS</a></li>
                                    <li><a href="/service/secure-development/">Внедрение процедур безопасной разработки ПО</a></li>
                                    <li><a href="/service/forensics/">Расследование компьютерных инцидентов</a></li>
                                    <li><a href="/service/compliance/">Соответствие требованиям по ИБ</a></li>
                                    <li><a href="/service/security-analysis/">Анализ защищённости</a></li>
                                    <li><a href="/service/pentest/">Пентесты</a></li>
                                    <li><a href="/service/incident-management/">Управление инцидентами ИБ</a></li>
                                    <li><a href="/service/gossopka/">ГосСОПКА</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6 footer-feedback-outer">
                <div class="footer-block">
                    <div class="footer-feedback-title footer-title">
                        <a href="#">Написать нам</a>
                    </div>
                    <div class="footer-content">
                        <div class="footer-feedback">
                            <form action="#" id="feedback">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="footer-feedback-field clearfix">
                                            <div class="footer-feedback-field-title">Имя</div>
                                            <div class="footer-feedback-field-input">
                                                <input type="text" value="" class="input full">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="footer-feedback-field clearfix">
                                            <div class="footer-feedback-field-title">Email</div>
                                            <div class="footer-feedback-field-input">
                                                <input type="email" value="" class="input full">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="footer-feedback-field clearfix">
                                    <div class="footer-feedback-field-title">Письмо</div>
                                    <div class="footer-feedback-field-input">
                                        <textarea class="input full" rows="5"></textarea>
                                    </div>
                                </div>
                                <div style="overflow:hidden">
                                <div style="float: right" id="captcha_footer" class="footer-feedback-field footer-feedback-capcha" data-sitekey="6LfAmjQUAAAAAOlKkyCSJIr2n3xydI6U33qeRtNP"></div>
                                </div>
                                    <div class="footer-feedback-field footer-feedback-submit">
                                    <input type="submit" value="Отправить" class="button">
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="footer-copyright">
            <span class="icon icon-stepup"></span> 2021        </div>
    </div>
</footer>
<div class="popup-overlay" id="popup-question">
    <div class="popup-table">
        <div class="popup-cell">
            <div class="popup">
                <a href="#" class="popup-x popup-close icon icon-close" title="Закрыть"></a>
                <div class="popup-content">
                    <form action="#" class="ajax">
                        <div class="form-field">
                            <input type="text" class="input full" placeholder="Как к вам обращаться?" name="name">
                            <div class="form-field-error"></div>
                        </div>
                        <div class="form-field">
                            <input type="text" class="input full" placeholder="Адрес электронной почты или телефон*" name="phone_email">
                            <div class="form-field-error"></div>
                        </div>
                        <div class="form-field">
                            <textarea class="input full" rows="8" placeholder="Ваш вопрос, запрос или пожелание связаться с вами" name="message"></textarea>
                            <div class="form-field-error"></div>
                        </div>
                        <div class="form-field">
                            <div class="form-field-text">
                                <div class="form-field-nospam">*Мы не спамим и не подписываем на рассылку</div>
                                <div>Быстро ответим только с 9 до 18 по Москве.<br>В противном случае &mdash; на следующий день.</div>
                            </div>
                        </div>
                        <div id="captcha_feedback" class="form-field" data-sitekey="6LfAmjQUAAAAAOlKkyCSJIr2n3xydI6U33qeRtNP"></div>
                        <div class="form-field">
                            <input type="submit" class="button button-black" value="Отправить">
                        </div>
                    </form>
                    <div class="form-message text" style="display: none">
                        <p>Сообщение отправлено.</p>
                        <p>Спасибо, мы с вами обязательно свяжемся.</p>
                        <p>
                            <a href="#" class="popup-close button button-black">OK</a>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    function initMap() {
        var line = [];
        var uluru = {lat: 55.800312, lng: 37.565437};
        var map = new google.maps.Map(document.getElementById('map1'), {
            zoom: 15,
            center: uluru
        });
        var marker = new google.maps.Marker({
            position: uluru,
            map: map
        });

        function route(flightPlanCoordinates, color) {
            for (var i=0; i<line.length; i++)
            {
                line[i].setMap(null); //or line[i].setVisible(false);
            }
            var route = new google.maps.Polyline({
                path: flightPlanCoordinates,
                geodesic: true,
                strokeColor: color,
                strokeOpacity: 1.0,
                strokeWeight: 4
            });
            line.push(route);
            route.setMap(map);
        }

        $(".contact_how").click(function () {
            switch ($(this).attr("id")){
                case("howAuto"):
                    var routePath = [
                        {lng: 37.555160438890596, lat:55.790646376051114},
                        {lng: 37.55754224049581, lat:55.79213336802756},
                        {lng: 37.5574778674795, lat:55.79219985821376},
                        {lng: 37.557654893274446, lat:55.79269853092611},
                        {lng: 37.55806795346278, lat:55.79307630902726},
                        {lng: 37.55888334500328, lat:55.79332412944713},
                        {lng: 37.55950561749472, lat:55.79371701225159},
                        {lng: 37.558904802675436, lat:55.79391647430447},
                        {lng: 37.5589799045278, lat:55.795203886511004},
                        {lng: 37.56795994030967, lat:55.798068678610754},
                        {lng: 37.56521335827845, lat:55.800878870271184}
                    ];
                    route(routePath, "#33cc00");
                    break;
                case("howTtk"):
                    var routePath = [
                        {lng:37.56551316706945, lat:55.80095569108},
                        {lng:37.568345579789266, lat:55.798036719495435},
                        {lng:37.56862452952684, lat:55.79746256879981},
                        {lng:37.568967852280764, lat:55.794283433130126},
                        {lng:37.56965449778857, lat:55.79075344106749},
                        {lng:37.57149985759082, lat:55.789749994268504},
                        {lng:37.574182153905035, lat:55.791617909044625},
                        {lng:37.57531941052734, lat:55.79183551573765},
                        {lng:37.57808745023072, lat:55.79198058618807},
                        {lng:37.57971823331173, lat:55.79201685370956},
                        {lng:37.5828939687854, lat:55.792282814550326},
                        {lng:37.58583366986572, lat:55.79216192348803},
                        {lng:37.58808672543823, lat:55.792246547271205}
                    ];
                    route(routePath, "#006cff");
                    break;
                case("howTransport"):
                    var routePath = [
                        {lat: 55.79057753175389, lng: 37.556452261444086},
                        {lat: 55.79132708087788, lng: 37.556344973083455},
                        {lat: 55.792034303463, lng: 37.557439314361524},
                        {lat: 55.79247555547622, lng: 37.55849074029541},
                        {lat: 55.793031646752226, lng: 37.56089399957274},
                        {lat: 55.79318880152918, lng: 37.5609261860809},
                        {lat: 55.79397456589992, lng: 37.559027182098355},
                        {lat: 55.795171314881316, lng: 37.55909155511475},
                        {lat: 55.79804215302112, lng: 37.56817887925712},
                        {lat: 55.80092486504567, lng: 37.565378653045606}
                    ];
                    route(routePath,  "#ff0000");
                    break;
            }
        });
    }
</script>
<script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBjS_0Yj5L1FNuflX6m5EkY0LFL2iNs6oA&callback=initMap">
</script>
<script src="/bitrix/templates/amonitoring/js/jquery.mobile.custom.min.js"></script>
<script src="/bitrix/templates/amonitoring/js/jquery.maskedinput.min.js"></script>
<script src="/bitrix/templates/amonitoring/js/owl.carousel.min.js"></script>
<script src="https://api-maps.yandex.ru/2.1/?lang=ru_RU"></script>
<script src="/bitrix/templates/amonitoring/js/fancybox/jquery.fancybox.pack.js"></script>
<script src="/bitrix/templates/amonitoring/js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
    (function (d, w, c) {
        (w[c] = w[c] || []).push(function() {
            try {
                w.yaCounter15525343 = new Ya.Metrika({
                    id:15525343,
                    clickmap:true,
                    trackLinks:true,
                    accurateTrackBounce:true,
                    webvisor:true
                });
            } catch(e) { }
        });

        var n = d.getElementsByTagName("script")[0],
            s = d.createElement("script"),
            f = function () { n.parentNode.insertBefore(s, n); };
        s.type = "text/javascript";
        s.async = true;
        s.src = "https://mc.yandex.ru/metrika/watch.js";

        if (w.opera == "[object Opera]") {
            d.addEventListener("DOMContentLoaded", f, false);
        } else { f(); }
    })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/15525343" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->

</body>
</html>