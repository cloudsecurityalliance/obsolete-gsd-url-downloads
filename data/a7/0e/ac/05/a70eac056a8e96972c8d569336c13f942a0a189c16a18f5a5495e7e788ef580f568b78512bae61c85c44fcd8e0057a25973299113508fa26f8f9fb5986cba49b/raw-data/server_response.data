<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="UTF-8">
<meta property="og:type" content="website">
<meta property="og:title" content="1507218 - (CVE-2018-18509) Wrong Thunderbird S/MIME signature status shown, if CMS signed data has data content.">
<meta property="og:url" content="https://bugzilla.mozilla.org/show_bug.cgi?id=1507218">
<meta property="og:description"
      content="RESOLVED (kaie) in MailNews Core - Security: S/MIME. Last updated 2020-08-08.">
<meta name="twitter:label1" value="Type">
<meta name="twitter:data1" value="defect">
<meta name="twitter:label2" value="Priority">
<meta name="twitter:data2" value="--">

    <meta name="viewport" content="width=1024">
    <meta name="color-scheme" content="dark light">
    <meta name="generator" content="Bugzilla 20211025.1">
    <meta name="bugzilla-global" content="dummy"
        id="bugzilla-global" data-bugzilla="{&quot;api_token&quot;:&quot;&quot;,&quot;config&quot;:{&quot;basepath&quot;:&quot;\/&quot;},&quot;constant&quot;:{&quot;COMMENT_COLS&quot;:80},&quot;param&quot;:{&quot;maxattachmentsize&quot;:&quot;10240&quot;,&quot;maxusermatches&quot;:&quot;50&quot;,&quot;splinter_base&quot;:&quot;\/page.cgi?id=splinter.html&amp;ignore=\/&quot;},&quot;string&quot;:{&quot;bug_type_required&quot;:&quot;You must select a Type for this bug&quot;,&quot;component_required&quot;:&quot;You must select a Component for this bug&quot;,&quot;description_required&quot;:&quot;You must enter a Description for this bug&quot;,&quot;short_desc_required&quot;:&quot;You must enter a Summary for this bug&quot;,&quot;version_required&quot;:&quot;You must select a Version for this bug&quot;},&quot;user&quot;:{&quot;is_new&quot;:1,&quot;login&quot;:&quot;&quot;}}">
    <title>1507218 - (CVE-2018-18509) Wrong Thunderbird S/MIME signature status shown, if CMS signed data has data content.</title>

<link rel="Top" href="/">

  


  
    <link rel="Show" title="Dependency Tree"
          href="/showdependencytree.cgi?id=1507218&amp;hide_resolved=1">
      <link rel="Show" title="Dependency Graph"
            href="/showdependencygraph.cgi?id=1507218">

      <link rel="Show" title="Bug Activity"
            href="/show_activity.cgi?id=1507218">

<link href="/static/v20211025.1/skins/yui.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/standard/global.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BugModal/web/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BMO/web/styles/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/EditComments/web/styles/inline-editor.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-structure-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-theme-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/lib/prism.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Needinfo/web/styles/needinfo.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Review/web/styles/badge.css" rel="stylesheet" type="text/css">



    
<script nonce="XXoIHl7fz9gzBDD175SVo864dcE77ADbiTbZpYXs1dV7lXYz" src="/static/v20211025.1/js/jquery/jquery-min.js"></script><script nonce="XXoIHl7fz9gzBDD175SVo864dcE77ADbiTbZpYXs1dV7lXYz" src="/static/v20211025.1/js/jquery/ui/jquery-ui-min.js"></script><script nonce="XXoIHl7fz9gzBDD175SVo864dcE77ADbiTbZpYXs1dV7lXYz" src="/static/v20211025.1/js/yui.js"></script><script nonce="XXoIHl7fz9gzBDD175SVo864dcE77ADbiTbZpYXs1dV7lXYz" src="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu-min.js"></script><script nonce="XXoIHl7fz9gzBDD175SVo864dcE77ADbiTbZpYXs1dV7lXYz" src="/static/v20211025.1/js/jquery/plugins/devbridgeAutocomplete/devbridgeAutocomplete-min.js"></script><script nonce="XXoIHl7fz9gzBDD175SVo864dcE77ADbiTbZpYXs1dV7lXYz" src="/static/v20211025.1/js/global.js"></script><script nonce="XXoIHl7fz9gzBDD175SVo864dcE77ADbiTbZpYXs1dV7lXYz" src="/static/v20211025.1/js/util.js"></script><script nonce="XXoIHl7fz9gzBDD175SVo864dcE77ADbiTbZpYXs1dV7lXYz" src="/static/v20211025.1/js/dropdown.js"></script>

      <script nonce="XXoIHl7fz9gzBDD175SVo864dcE77ADbiTbZpYXs1dV7lXYz">
          YAHOO.namespace('bugzilla');
          if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
              YAHOO.util.Event._simpleRemove(window, "unload",
                                             YAHOO.util.Event._unload);
          }BUGZILLA.value_descs = JSON.parse('{\"bug_status\":{},\"resolution\":{\"\":\"---\"}}');

  
    var tracking_flags_str = "{\"flags\":{\"tracking\":{\"cf_tracking_thunderbird_94\":\"---\",\"cf_status_thunderbird_esr78\":\"---\",\"cf_tracking_seamonkey257esr\":\"---\",\"cf_status_thunderbird_93\":\"---\",\"cf_status_thunderbird_esr60\":\"fixed\",\"cf_tracking_thunderbird_esr60\":\"65+\",\"cf_tracking_thunderbird_esr91\":\"---\",\"cf_status_thunderbird_94\":\"---\",\"cf_status_thunderbird_95\":\"---\",\"cf_status_thunderbird_67\":\"fixed\",\"cf_tracking_thunderbird_95\":\"---\",\"cf_tracking_seamonkey253\":\"---\",\"cf_status_seamonkey253\":\"---\",\"cf_tracking_thunderbird_93\":\"---\",\"cf_status_thunderbird_66\":\"fixed\",\"cf_status_seamonkey257esr\":\"---\",\"cf_status_thunderbird_esr91\":\"---\",\"cf_tracking_thunderbird_esr78\":\"---\",\"cf_tracking_firefox_relnote\":\"---\"},\"project\":{\"cf_tracking_firefox_sumo\":\"---\"}},\"comments\":{\"cf_tracking_firefox_sumo\":{\"none-needed\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox_relnote\":{\"?\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"}},\"types\":[\"tracking\"]}";
    var TrackingFlags = $.parseJSON(tracking_flags_str);

  

  
  BUGZILLA.bug_id = 1507218;
  BUGZILLA.bug_title = '1507218 - (CVE-2018-18509) Wrong Thunderbird S\/MIME signature status shown, if CMS signed data has data content.';
  BUGZILLA.bug_summary = 'Wrong Thunderbird S\/MIME signature status shown, if CMS signed data has data content.';
  BUGZILLA.bug_url = 'https:\/\/bugzilla.mozilla.org\/show_bug.cgi?id=1507218';
  BUGZILLA.bug_keywords = 'csectype-spoof, sec-high',
  BUGZILLA.user = {
    id: 0,
    login: '',
    is_insider: false,
    is_timetracker: false,
    can_tag: false,
    timezone: 'America\/Los_Angeles',
    settings: {
      quote_replies: 'quoted_reply',
      zoom_textareas: true,
      remember_collapsed: true,
      inline_attachments: true,
      autosize_comments: false
    }
  };

  BUGZILLA.bug_secure = false;
      </script>
<script nonce="XXoIHl7fz9gzBDD175SVo864dcE77ADbiTbZpYXs1dV7lXYz" src="/static/v20211025.1/extensions/BugModal/web/autosize.min.js"></script><script nonce="XXoIHl7fz9gzBDD175SVo864dcE77ADbiTbZpYXs1dV7lXYz" src="/static/v20211025.1/extensions/ProdCompSearch/web/js/prod_comp_search.js"></script><script nonce="XXoIHl7fz9gzBDD175SVo864dcE77ADbiTbZpYXs1dV7lXYz" src="/static/v20211025.1/extensions/BugModal/web/bug_modal.js"></script><script nonce="XXoIHl7fz9gzBDD175SVo864dcE77ADbiTbZpYXs1dV7lXYz" src="/static/v20211025.1/extensions/BugModal/web/comments.js"></script><script nonce="XXoIHl7fz9gzBDD175SVo864dcE77ADbiTbZpYXs1dV7lXYz" src="/static/v20211025.1/extensions/ComponentWatching/web/js/overlay.js"></script><script nonce="XXoIHl7fz9gzBDD175SVo864dcE77ADbiTbZpYXs1dV7lXYz" src="/static/v20211025.1/js/bugzilla-readable-status-min.js"></script><script nonce="XXoIHl7fz9gzBDD175SVo864dcE77ADbiTbZpYXs1dV7lXYz" src="/static/v20211025.1/js/field.js"></script><script nonce="XXoIHl7fz9gzBDD175SVo864dcE77ADbiTbZpYXs1dV7lXYz" src="/static/v20211025.1/js/comments.js"></script><script nonce="XXoIHl7fz9gzBDD175SVo864dcE77ADbiTbZpYXs1dV7lXYz" src="/static/v20211025.1/extensions/TrackingFlags/web/js/flags.js"></script><script nonce="XXoIHl7fz9gzBDD175SVo864dcE77ADbiTbZpYXs1dV7lXYz" src="/static/v20211025.1/extensions/BMO/web/js/firefox-crash-table.js"></script><script nonce="XXoIHl7fz9gzBDD175SVo864dcE77ADbiTbZpYXs1dV7lXYz" src="/static/v20211025.1/extensions/MozChangeField/web/js/severity-s1-priority-p1.js"></script><script nonce="XXoIHl7fz9gzBDD175SVo864dcE77ADbiTbZpYXs1dV7lXYz" src="/static/v20211025.1/extensions/MozChangeField/web/js/clear-tracking-priority-s1.js"></script><script nonce="XXoIHl7fz9gzBDD175SVo864dcE77ADbiTbZpYXs1dV7lXYz" src="/static/v20211025.1/extensions/MozChangeField/web/js/set-tracking-severity-s1.js"></script><script nonce="XXoIHl7fz9gzBDD175SVo864dcE77ADbiTbZpYXs1dV7lXYz" src="/static/v20211025.1/js/lib/prism.js"></script><script nonce="XXoIHl7fz9gzBDD175SVo864dcE77ADbiTbZpYXs1dV7lXYz" src="/static/v20211025.1/extensions/GoogleAnalytics/web/js/analytics.js"></script><script nonce="XXoIHl7fz9gzBDD175SVo864dcE77ADbiTbZpYXs1dV7lXYz" src="/static/v20211025.1/js/lib/md5.min.js"></script><script nonce="XXoIHl7fz9gzBDD175SVo864dcE77ADbiTbZpYXs1dV7lXYz" src="/static/v20211025.1/extensions/Review/web/js/badge.js"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla@Mozilla" href="/search_plugin.cgi"><link rel="shortcut icon" href="/extensions/BMO/web/images/favicon.ico">
<link rel="canonical" href="https://bugzilla.mozilla.org/show_bug.cgi?id=1507218">
<link rel="shorturl" href="https://bugzilla.mozilla.org/1507218"><meta name="google-analytics" content="UA-36116321-3" data-location="https://bugzilla.mozilla.org/bug/show-modal" data-title="1507218 - (CVE-2018-18509) Wrong Thunderbird S/MIME signature status shown, if CMS signed data has data content.">
<script async src="https://www.google-analytics.com/analytics.js"></script><meta name="robots" content="noarchive">
  </head>



  <body
        class="bugzilla-mozilla-org
               skin-standard bug_modal yui-skin-sam">



<div id="wrapper">

<header id="header" role="banner">
  <div class="inner">
    <h1 id="header-title" class="title"><a href="https://bugzilla.mozilla.org/home" title="Go to home page">Bugzilla</a></h1>
    <form role="search" id="header-search" class="quicksearch" action="/buglist.cgi" data-no-csrf>
      <section class="searchbox-outer dropdown" role="combobox" aria-expanded="false" aria-haspopup="listbox"
               aria-labelledby="header-search-label" aria-owns="header-search-dropdown">
        <h2 id="header-search-label">Quick Search</h2>
        <span class="icon" aria-hidden="true"></span>
        <input role="searchbox" id="quicksearch_top" class="dropdown-button" name="quicksearch" autocomplete="off"
               value="" placeholder="Search Bugs"
               title="Enter a bug number or some search terms" aria-controls="header-search-dropdown"
               aria-label="Quick Search"><div id="header-search-dropdown" class="dropdown-content right" role="listbox" style="display: none;">
  <div id="header-search-dropdown-wrapper">
  </div>
</div>
      </section>
    </form>
    <nav id="header-nav">
      <ul class="links">
        <li class="link-browse">
          <a href="/describecomponents.cgi" title="Browse bugs by component">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Browse</span>
          </a>
        </li>
        <li class="link-search">
          <a href="/query.cgi?format=advanced" title="Search bugs using various criteria">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Advanced Search</span>
          </a>
        </li>
      </ul>
      <div class="dropdown">
        <button type="button" id="header-tools-menu-button" class="dropdown-button minor" title="More tools…"
                aria-label="More tools…" aria-expanded="false" aria-haspopup="true" aria-controls="header-tools-menu">
          <span class="icon" aria-hidden="true"></span>
        </button>
        <ul class="dropdown-content left" id="header-tools-menu" role="menu" style="display:none;">
          <li role="presentation">
            <a href="/report.cgi" role="menuitem" tabindex="-1">Reports</a>
          </li>
            <li role="separator"></li>
            <li role="presentation">
              <a href="https://bmo.readthedocs.io/en/latest/" role="menuitem" tabindex="-1">Documentation</a>
            </li>
        </ul>
      </div>
    </nav>
      <ul id="header-login" class="links">
          <li id="moz_new_account_container_top"><a href="/createaccount.cgi">New Account</a></li><li id="mini_login_container_top">
  <a id="login_link_top" href="/index.cgi?GoAheadAndLogIn=1"
     class='show_mini_login_form' data-qs-suffix="_top">Log In</a>

  <div id="mini_login_top" class="mini-popup mini_login bz_default_hidden"><span id="github_mini_login_top" class="mini_login_top">
    <form method="post" action="/github.cgi">
      <input type="hidden" name="github_secret" value="MB8fjBt9pwh2to4J1Dfh3vXi7qVhOd3VLTRNmpIogvgb2TkvajYdEY29yL0f1eJWx6sBSmmnEJHmrZJCiN0QUsAEdALZoqZ4Y2CsqN60n6G9KDJTeCd3YyBcaYM2Z29rgL2MSrDsII3mxYywSWqSbigWP0D1wRVL1JF9nSRR2qtRLgmKgldQBD6Ao4iH7crn6foZvAy6fWPFYJlkfoxpn2A3BuW86TPckIoOSkSmR6IGIPUCgBmO9cMWo4nQ1PBk">
      <input type="hidden" name="target_uri" value="https://bugzilla.mozilla.org/show_bug.cgi">
      <input type="image" src="/extensions/GitHubAuth/web/images/sign_in.png" height="22" width="75" align="absmiddle"
             alt="Sign in with GitHub"
             title="Sign in with GitHub"> or
    </form>
  </span>

  <form action="/show_bug.cgi?id=1507218" method="POST"
        data-qs-suffix="_top">

    <input id="Bugzilla_login_top"
           class="bz_login"
           name="Bugzilla_login"
           title="Login"
           placeholder="Email"
           aria-label="Email"
           type="email"
           required
    >
    <input class="bz_password"
           id="Bugzilla_password_top"
           name="Bugzilla_password"
           type="password"
           title="Password"
           placeholder="Password"
           aria-label="Password"
           required
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text"
           id="Bugzilla_password_dummy_top" value="password"
           title="Password"
    >
      <input type="checkbox" id="Bugzilla_remember_top"
             name="Bugzilla_remember" value="on" class="bz_remember"
                 checked>
      <label for="Bugzilla_remember_top">Remember</label>
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
           class="check_mini_login_fields"
            id="log_in_top">
    <a href="#" id="hide_mini_login_top" aria-label="Close"
       class="close-button hide_mini_login_form" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
<li id="forgot_container_top">
  <a id="forgot_link_top" href="/index.cgi?GoAheadAndLogIn=1#forgot"
     class='show_forgot_form'
     data-qs-suffix="_top">Forgot Password</a>
  <div id="forgot_form_top" class="mini-popup mini_forgot bz_default_hidden">
  <form action="/token.cgi" method="post">
    <input type="email" name="loginname" size="20" placeholder="Email" aria-label="Email" required>
    <input id="forgot_button_top" value="Reset Password"
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <input type="hidden" id="token_top" name="token" value="1635623371-tEXlLvFy2FcuQvkNdVrQOuT6MqaCaUUDk_Q55O8SOV8">
    <a href="#" class="close-button hide_forgot_form" aria-label="Close" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
      </ul><div id="header-external-links" class="dropdown first">
  <button type="button" id="header-external-menu-button" class="dropdown-button minor" title="Mozilla"
          aria-label="Mozilla" aria-expanded="false" aria-haspopup="true" aria-controls="header-external-menu">
    <img src="/static/v20211025.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg" width="32" height="32" alt="">
  </button>
  <ul class="dropdown-content right" id="header-external-menu" role="menu" style="display:none;">
    <li role="presentation">
      <a href="https://www.mozilla.org/" role="menuitem" tabindex="-1">Mozilla Home</a>
    </li>
    <li role="separator"></li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/" role="menuitem" tabindex="-1">Privacy</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/#cookies" role="menuitem" tabindex="-1">Cookies</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/about/legal/" role="menuitem" tabindex="-1">Legal</a>
    </li>
  </ul>
</div>
  </div>
</header> 


<main id="bugzilla-body" tabindex="-1">

<aside id="message-container" role="complementary">
  <noscript>
    <div class="noscript">
      <div class="inner">
        <p>Please enable JavaScript in your browser to use all the features on this site.</p>
      </div>
    </div>
  </noscript>
</aside>

<div id="main-inner">




<div role="toolbar" id="page-toolbar">
  <div role="group" class="buttons">
    <button type="button" id="copy-summary" class="secondary"
      title="Copy bug number and summary to your clipboard">Copy Summary</button>
    <div id="clip-container" style="display:none"><input type="text" id="clip"></div>
    <div class="dropdown">
      <button type="button" id="action-menu-btn" aria-haspopup="true" aria-label="View"
        aria-expanded="false" aria-controls="action-menu" class="dropdown-button secondary">View &#9662;</button>
      <ul class="dropdown-content left" id="action-menu" role="menu" style="display:none;">
        <li role="presentation">
          <a id="action-reset" role="menuitem" tabindex="-1">Reset Sections</a>
        </li>
        <li role="presentation">
          <a id="action-expand-all" role="menuitem" tabindex="-1">Expand All Sections</a>
        </li>
        <li role="presentation">
          <a id="action-collapse-all" role="menuitem" tabindex="-1">Collapse All Sections</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a id="action-history" role="menuitem" tabindex="-1">History</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a href="/rest/bug/1507218" role="menuitem" tabindex="-1">JSON</a>
        </li>
        <li role="presentation">
          <a href="/show_bug.cgi?ctype=xml&amp;id=1507218" role="menuitem" tabindex="-1">XML</a>
        </li>
      </ul>
    </div>
  </div>
</div>



<div role="status" id="io-error" style="display:none"></div>
<div role="status" id="floating-message" style="display:none">
  <div id="floating-message-text"></div>
</div>
<section class="module"
>
  <div class="module-content"
  >
  <div id="summary-container">
    <div class="field indent" id="field-status_summary"
>


  
    <div class=" container">
        <span id="field-value-status_summary">
      <span class="bug-status-label text" data-status="closed">Closed</span>
      <span id="field-value-bug_id">
        <a href="/show_bug.cgi?id=1507218">Bug 1507218</a>
          <span class="edit-hide">(CVE-2018-18509)</span>
      </span>
      <span>
        <span class="bug-time-label">Opened <span class="rel-time" title="2018-11-14 09:38 PST" data-time="1542217104">3 years ago</span></span>
          <span class="bug-time-label">Closed <span class="rel-time" title="2019-02-28 02:18 PST" data-time="1551349120">3 years ago</span></span>
      </span>
        </span>
    </div>

  
</div>
<div class="field indent edit-hide"
>


  
    <div class=" container">
      

      <h1 id="field-value-short_desc">Wrong Thunderbird S/MIME signature status shown, if CMS signed data has data content<wbr>.</h1>
    </div>

  
</div>

    <div class="field edit-show" id="field-short_desc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc" id="short_desc-help-link" class="help">Summary:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-short_desc">
            Wrong Thunderbird S/MIME signature status shown, if CMS signed data has data content.

        </span>
    </div>

  
</div>
  </div>
  </div>
</section>


<section class="module" id="module-categories"
>
    <header id="module-categories-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Categories section"
           data-label-collapsed="Expand Categories section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-categories-content"
             aria-expanded="true"
             aria-labeledby="module-categories-title"
             aria-describedby="module-categories-subtitle"></div>
        <h2 class="module-title" id="module-categories-title">Categories</h2>
          <h3 class="module-subtitle" id="module-categories-subtitle">
            (MailNews Core :: Security: S/MIME, defect)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-categories-content"
  ><div class="fields-lhs">

    <div class="field" id="field-product"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=MailNews%20Core" id="product-help-link" class="help">Product:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-product">
      <div class="name-info-outer dropdown">
        <span id="product-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="product-info">MailNews Core
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="product-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Product description and actions">
          <header>
            <div class="title">MailNews Core</div>
            <div class="description">Mail and news components common to Thunderbird and SeaMonkey</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=MailNews%20Core&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Product</a></div>
            <div><a href="/enter_bug.cgi?product=MailNews%20Core"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Product</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="MailNews Core"
                         data-label-watch="Watch This Product" data-label-unwatch="Unwatch This Product"
                         data-source="BugModal">Watch This Product</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-component"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=MailNews%20Core&component=Security%3A%20S%2FMIME#Security%3A%20S%2FMIME" id="component-help-link" class="help">Component:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-component">
      <div class="name-info-outer dropdown">
        <span id="component-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="component-info">Security: S/MIME
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="component-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Component description and actions">
          <header>
            <div class="title">MailNews Core :: Security: S/MIME</div>
            <div class="description">S/MIME is the sending of signed and/or encrypted email.</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=MailNews%20Core&amp;component=Security%3A%20S%2FMIME&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Component</a></div>
            <div><a href="/buglist.cgi?product=MailNews%20Core&amp;component=Security%3A%20S%2FMIME&amp;chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__"
                    target="_blank" role="menuitem" tabindex="-1">Recently Fixed Bugs in This Component</a></div>
            <div><a href="/enter_bug.cgi?product=MailNews%20Core&amp;component=Security%3A%20S%2FMIME"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Component</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="MailNews Core" data-component="Security: S/MIME"
                         data-label-watch="Watch This Component" data-label-unwatch="Unwatch This Component"
                         data-source="BugModal">Watch This Component</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-version"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#version" id="version-help-link" class="help">Version:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-version">
            60

        </span>
    </div>

  
</div>

    <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform" id="-help-link" class="help">Platform:
        </a>
    </div>


  
    <div class=" container"><div class="field inline" id="field-rep_platform"
>


  
    <div class="value">
        <span id="field-value-rep_platform">
            Unspecified

        </span>
    </div>

  
</div><div class="field indent inline" id="field-op_sys"
>


  
    <div class="value">
        <span id="field-value-op_sys">
            Unspecified

        </span>
    </div>

  
</div><div class="field indent inline"
>


  
    <div class=" container">
    </div>

  
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field contains-buttons" id="field-bug_type"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type" id="bug_type-help-link" class="help">Type:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_type">
      <span class="bug-type-label iconic-text" data-type="defect">
        <span class="icon" aria-hidden="true"></span>defect</span>
        </span>
    </div>

  
</div>

    <div class="field" id="field-importance"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority" id="importance-help-link" class="help">Priority:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-importance"><div class="field inline" id="field-priority"
>


  
    <div class="value">
        <span id="field-value-priority">
          <em>Not set</em>
        </span>
    </div>

  
</div><div class="field inline" id="field-bug_severity"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity" id="bug_severity-help-link" class="help">Severity:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_severity">
            normal

        </span>
    </div>

  
</div>
        </span>
    </div>

  
</div>

    
</div>
  </div>
</section>


<section class="module" id="module-tracking"
>
    <header id="module-tracking-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Tracking section"
           data-label-collapsed="Expand Tracking section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-tracking-content"
             aria-expanded="true"
             aria-labeledby="module-tracking-title"
             aria-describedby="module-tracking-subtitle"></div>
        <h2 class="module-title" id="module-tracking-title">Tracking</h2>
          <h3 class="module-subtitle" id="module-tracking-subtitle">
            (thunderbird_esr6065+ fixed, thunderbird66 fixed, thunderbird67 fixed)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-tracking-content"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-status-view"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-view-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-view">RESOLVED
        FIXED
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-status-edit" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-edit-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-edit"><div class="field inline" id="field-bug_status"
>


  
    <div class="value">
        <span id="field-value-bug_status">
            RESOLVED

        </span>
    </div>

  
</div><div class="field indent inline" id="field-resolution"
>


  
    <div class="value">
        <span id="field-value-resolution">
            FIXED

        </span>
    </div>

  
</div>
  <div id="status-action-buttons">
      <div id="assigned-container" style="display:none">
        <button type="button" class="secondary" id="mark-as-assigned-btn">
          Mark as Assigned
        </button>
      </div>
  </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-target_milestone"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone" id="target_milestone-help-link" class="help">Milestone:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-target_milestone">
            Thunderbird 67.0

        </span>
    </div>

  
</div>

    


      <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Project Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <td class="tracking-flag-name">user-doc-firefox</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_sumo-dirty">
  <select id="cf_tracking_firefox_sumo" name="cf_tracking_firefox_sumo">
        <option value="---"
          id="v4660_cf_tracking_firefox_sumo" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

      <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Tracking Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-hide">
    <table class="layout-table tracking-flags">
        <tr>
          <th></th>
          <th>Tracking</th>
          <th>Status</th>
        </tr>
        <tr>
          <td class="tracking-flag-name">thunderbird_esr60</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_thunderbird_esr60&amp;o1=equals&amp;v1=65%2B">65+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_thunderbird_esr60&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">thunderbird66</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_thunderbird_66&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">thunderbird67</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_thunderbird_67&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
    </table>
  </div>


<div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <th></th>
        <th>Tracking</th>
        <th>Status</th>
      </tr>
      <tr>
        <td class="tracking-flag-name">relnote-firefox</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_relnote-dirty">
  <select id="cf_tracking_firefox_relnote" name="cf_tracking_firefox_relnote">
        <option value="---"
          id="v539_cf_tracking_firefox_relnote" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr60</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr60-dirty">
  <select id="cf_tracking_thunderbird_esr60" name="cf_tracking_thunderbird_esr60">
        <option value="65+"
          id="v3755_cf_tracking_thunderbird_esr60" selected
        >65+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr60-dirty">
  <select id="cf_status_thunderbird_esr60" name="cf_status_thunderbird_esr60">
        <option value="fixed"
          id="v3777_cf_status_thunderbird_esr60" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr78-dirty">
  <select id="cf_tracking_thunderbird_esr78" name="cf_tracking_thunderbird_esr78">
        <option value="---"
          id="v4823_cf_tracking_thunderbird_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr78-dirty">
  <select id="cf_status_thunderbird_esr78" name="cf_status_thunderbird_esr78">
        <option value="---"
          id="v4829_cf_status_thunderbird_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr91-dirty">
  <select id="cf_tracking_thunderbird_esr91" name="cf_tracking_thunderbird_esr91">
        <option value="---"
          id="v5236_cf_tracking_thunderbird_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr91-dirty">
  <select id="cf_status_thunderbird_esr91" name="cf_status_thunderbird_esr91">
        <option value="---"
          id="v5242_cf_status_thunderbird_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird66</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_66-dirty">
  <select id="cf_status_thunderbird_66" name="cf_status_thunderbird_66">
        <option value="fixed"
          id="v4138_cf_status_thunderbird_66" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird67</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_67-dirty">
  <select id="cf_status_thunderbird_67" name="cf_status_thunderbird_67">
        <option value="fixed"
          id="v4209_cf_status_thunderbird_67" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird93</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_93-dirty">
  <select id="cf_tracking_thunderbird_93" name="cf_tracking_thunderbird_93">
        <option value="---"
          id="v5262_cf_tracking_thunderbird_93" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_93-dirty">
  <select id="cf_status_thunderbird_93" name="cf_status_thunderbird_93">
        <option value="---"
          id="v5256_cf_status_thunderbird_93" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird94</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_94-dirty">
  <select id="cf_tracking_thunderbird_94" name="cf_tracking_thunderbird_94">
        <option value="---"
          id="v5300_cf_tracking_thunderbird_94" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_94-dirty">
  <select id="cf_status_thunderbird_94" name="cf_status_thunderbird_94">
        <option value="---"
          id="v5304_cf_status_thunderbird_94" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird95</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_95-dirty">
  <select id="cf_tracking_thunderbird_95" name="cf_tracking_thunderbird_95">
        <option value="---"
          id="v5332_cf_tracking_thunderbird_95" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_95-dirty">
  <select id="cf_status_thunderbird_95" name="cf_status_thunderbird_95">
        <option value="---"
          id="v5326_cf_status_thunderbird_95" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">seamonkey2.53</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_seamonkey253-dirty">
  <select id="cf_tracking_seamonkey253" name="cf_tracking_seamonkey253">
        <option value="---"
          id="v3334_cf_tracking_seamonkey253" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_seamonkey253-dirty">
  <select id="cf_status_seamonkey253" name="cf_status_seamonkey253">
        <option value="---"
          id="v3338_cf_status_seamonkey253" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">seamonkey2.57esr</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_seamonkey257esr-dirty">
  <select id="cf_tracking_seamonkey257esr" name="cf_tracking_seamonkey257esr">
        <option value="---"
          id="v3594_cf_tracking_seamonkey257esr" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_seamonkey257esr-dirty">
  <select id="cf_status_seamonkey257esr" name="cf_status_seamonkey257esr">
        <option value="---"
          id="v3588_cf_status_seamonkey257esr" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>

</div>
  </div>
</section>



<section class="module" id="module-people"
>
    <header id="module-people-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse People section"
           data-label-collapsed="Expand People section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-people-content"
             aria-expanded="false"
             aria-labeledby="module-people-title"
             aria-describedby="module-people-subtitle"></div>
        <h2 class="module-title" id="module-people-title">People</h2>
          <h3 class="module-subtitle" id="module-people-subtitle">
            (Reporter: poddebniak, Assigned: KaiE)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-people-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-assigned_to"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to"><div class="vcard vcard_36541" ><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=36541" > <span class="fna">KaiE</span></a>
</div>
        </span>
    </div>

  
</div><div class="field edit-show" id="field-assigned_to" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-assignee" name="set_default_assignee" class="set-default"
          value="1" data-for="assigned_to">
        <label for="set-default-assignee">Reset Assignee to default</label>
      </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-bug_mentors" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor" id="bug_mentors-help-link" class="help">Mentors:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_mentors">---
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-qa_contact" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact" id="qa_contact-help-link" class="help">QA Contact:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-qa_contact">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-qa-contact" name="set_default_qa_contact" class="set-default"
          value="1" data-for="qa_contact">
        <label for="set-default-qa-contact">Reset QA Contact to default</label>
      </div>
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-reporter"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter" id="reporter-help-link" class="help">Reporter:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-reporter">
            <div class="vcard vcard_628250" ><img src="https://secure.gravatar.com/avatar/4d8090afb6598115b731821b4bf77f7f?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=628250" > <span class="fna">poddebniak</span></a>
</div>

        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-triage_owner" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner" id="triage_owner-help-link" class="help">Triage Owner:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-triage_owner">
            ---

        </span>
    </div>

  
</div>

    

    <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc" id="-help-link" class="help">CC:
        </a>
    </div>


  
    <div class=" container">


        <span aria-owns="cc-summary cc-latch">
          <span role="button" tabindex="0" id="cc-summary" data-count="11">11 people
          </span>
        </span>


        <div id="cc-list" style="display:none"></div>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-references"
>
    <header id="module-references-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse References section"
           data-label-collapsed="Expand References section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-references-content"
             aria-expanded="false"
             aria-labeledby="module-references-title"
             aria-describedby="module-references-subtitle"></div>
        <h2 class="module-title" id="module-references-title">References</h2>
      </div>
    </header>
  <div class="module-content" id="module-references-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field bug-list" id="field-dependson"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson" id="dependson-help-link" class="help">Depends on:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-dependson">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - After updating TB from 60.5.0 to 60.5.1, S/MIME signed _and_ encrypted mails received from Outlook clients are marked as &quot;signature is not valid&quot;"
   href="/show_bug.cgi?id=1528615">1528615</a>
      </div>

        </span>
    </div>

  
</div><div class="field bug-list edit-show" id="field-blocked" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks" id="blocked-help-link" class="help">Blocks:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-blocked">
        ---
        </span>
    </div>

  
</div><div class="field" id="field-dependencytree"
>
    <div class="name">
    </div>


  
    <div class=" container">
        <span id="field-value-dependencytree">
        Dependency <a href="/showdependencytree.cgi?id=1507218&amp;hide_resolved=1">tree</a>
        / <a href="/showdependencygraph.cgi?id=1507218">graph</a>
        </span>
    </div>

  
</div>

    <div class="field bug-list edit-show" id="field-regresses" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses" id="regresses-help-link" class="help">Regressions:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regresses">
        ---
        </span>
    </div>

  
</div><div class="field bug-list edit-show" id="field-regressed_by" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by" id="regressed_by-help-link" class="help">Regressed by:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regressed_by">
        ---
        </span>
    </div>

  
</div>

    
</div><div class="fields-rhs">

    <div class="field edit-show" id="field-bug_file_loc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc" id="bug_file_loc-help-link" class="help">URL:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_file_loc"><div class="link">
    <a href="" target="_blank"
      rel="noreferrer" title=""
      class="bug-url" data-safe="0"></a>
  </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-see_also" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also" id="see_also-help-link" class="help">See Also:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-see_also">
        ---
        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-details"
>
    <header id="module-details-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Details section"
           data-label-collapsed="Expand Details section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-details-content"
             aria-expanded="false"
             aria-labeledby="module-details-title"
             aria-describedby="module-details-subtitle"></div>
        <h2 class="module-title" id="module-details-title">Details</h2>
          <h3 class="module-subtitle" id="module-details-subtitle">
            (Keywords: csectype-spoof, sec-high)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-details-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-show" id="field-alias" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias" id="alias-help-link" class="help">Alias:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-alias">
            CVE-2018-18509

        </span>
    </div>

  
</div>

    <div class="field" id="field-keywords"
>
    <div class="name">
        <a href="/describekeywords.cgi" id="keywords-help-link" class="help">Keywords:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-keywords">
          <a href="/buglist.cgi?keywords=csectype-spoof&amp;resolution=---">csectype-spoof</a>, 
          <a href="/buglist.cgi?keywords=sec-high&amp;resolution=---">sec-high</a>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-status_whiteboard" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/Whiteboard" id="status_whiteboard-help-link" class="help">Whiteboard:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-status_whiteboard">---
        </span>
    </div>

  
</div>

    

    

    <div class="field" id="field-votes"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes" id="votes-help-link" class="help">Votes:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-votes">0
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field edit-show" id="field-bug_flags" style="display:none"
>
    <div class="name">Bug Flags:
    </div>


  
    <div class=" container">
        <span id="field-value-bug_flags"><div id="bug-flags" class="flags">
  <table class="layout-table">
    <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="This bug should be considered by thunderbird-drivers and developers as high-value and worthy of design &amp; review attention if a contributor offers a patch." for="flag_type-598">wanted-thunderbird</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-598-dirty">
      <select id="flag_type-598" name="flag_type-598"
        title="This bug should be considered by thunderbird-drivers and developers as high-value and worthy of design &amp; review attention if a contributor offers a patch."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug." for="flag_type-803">sec-bounty</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-803-dirty">
      <select id="flag_type-803" name="flag_type-803"
        title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame." for="flag_type-913">sec-bounty-hof</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-913-dirty">
      <select id="flag_type-913" name="flag_type-913"
        title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-787">in-qa-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-787-dirty">
      <select id="flag_type-787" name="flag_type-787"
        title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>

      <td class="flag-requestee">
        <div id="requestee_type-787-container" style="display:none"><input
    name="requestee_type-787"
    value="" class="requestee bz_autocomplete_user"  id="requestee_type-787" 
  >
        </div>
      <td>

  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-37">in-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-37-dirty">
      <select id="flag_type-37" name="flag_type-37"
        title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Include a summary of changes made by this bug in the release notes." for="flag_type-893">relnote</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-893-dirty">
      <select id="flag_type-893" name="flag_type-893"
        title="Include a summary of changes made by this bug in the release notes."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr>
    </tbody>
  </table>
</div>
        </span>
    </div>

  
</div>
</div>

  
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-crash-data"
>
    <header id="module-crash-data-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Crash Data section"
           data-label-collapsed="Expand Crash Data section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-crash-data-content"
             aria-expanded="false"
             aria-labeledby="module-crash-data-title"
             aria-describedby="module-crash-data-subtitle"></div>
        <h2 class="module-title" id="module-crash-data-title">Crash Data</h2>
      </div>
    </header>
  <div class="module-content" id="module-crash-data-content" style="display:none"
  ><div class="field edit-show" id="field-cf_crash_signature" style="display:none"
>
    <div class="name">Signature:
    </div>


  
    <div class="value">
        <span id="field-value-cf_crash_signature">
        </span>
    </div>

  
</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-security"
>
    <header id="module-security-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Security section"
           data-label-collapsed="Expand Security section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-security-content"
             aria-expanded="false"
             aria-labeledby="module-security-title"
             aria-describedby="module-security-subtitle"></div>
        <h2 class="module-title" id="module-security-title">Security</h2>
          <h3 class="module-subtitle" id="module-security-subtitle">
            (public)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-security-content" style="display:none"
  ><div class="groups edit-hide">
    This bug is publicly visible.
</div>

<div class="groups edit-show" style="display:none">


</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-user-story" data-non-stick="1"
>
    <header id="module-user-story-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse User Story section"
           data-label-collapsed="Expand User Story section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-user-story-content"
             aria-expanded="false"
             aria-labeledby="module-user-story-title"
             aria-describedby="module-user-story-subtitle"></div>
        <h2 class="module-title" id="module-user-story-title">User Story</h2>
      </div>
    </header>
  <div class="module-content" id="module-user-story-content" style="display:none"
  >
    <pre id="user-story"></pre>
  </div>
</section>







<section class="module" id="module-attachments"
>
    <header id="module-attachments-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Attachments section"
           data-label-collapsed="Expand Attachments section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-attachments-content"
             aria-expanded="true"
             aria-labeledby="module-attachments-title"
             aria-describedby="module-attachments-subtitle"></div>
        <h2 class="module-title" id="module-attachments-title">Attachments</h2>
          <h3 class="module-subtitle" id="module-attachments-subtitle">
            (6 files, 1 obsolete file)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-attachments-content"
  ><table role="table" class="layout-table" id="attachments">
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9025094">eContentConfusion.eml</a>
        </div>
        <div>
            <a href="#c0" class="attach-time activity-ref"><span class="rel-time" title="2018-11-14 09:38 PST" data-time="1542217104">3 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_628250" ><a class="email " href="/user_profile?user_id=628250" > <span class="fna">Damian Poddebniak</span></a>
</div></span>
        </div>
        <div class="attach-info">7.97 KB,
          text/plain        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9025094&amp;action=edit">Details</a>
    </tr>
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9038945">testcase2.eml</a>
        </div>
        <div>
            <a href="#c13" class="attach-time activity-ref"><span class="rel-time" title="2019-01-24 14:17 PST" data-time="1548368231">3 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_36541" ><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div></span>
        </div>
        <div class="attach-info">8.09 KB,
          message/rfc822        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9038945&amp;action=edit">Details</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9039106">1507218-v1.patch (don't use yet)</a>
        </div>
        <div>
            <a href="#c14" class="attach-time activity-ref"><span class="rel-time" title="2019-01-25 06:49 PST" data-time="1548427767">3 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_36541" ><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div></span>
        </div>
        <div class="attach-info">18.71 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_11099" ><span class="fn">rrelyea</span>
</div>:
              <a href="#c22"
                  class="flag-name-status rel-time-title activity-ref"
                  title="3 years ago"
              data-time="1549542515"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9039106&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=9039106&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1507218&attachment=9039106">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9039222">no comment</a>
        </div>
        <div>
            <a href="#c15" class="attach-time activity-ref"><span class="rel-time" title="2019-01-25 13:08 PST" data-time="1548450530">3 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_36541" ><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div></span>
        </div>
        <div class="attach-info">47 bytes,
          text/x-phabricator-request        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9039222&amp;action=edit">Details</a>&#x0020; |
  <a href="/attachment.cgi?id=9039222">Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9042529">Patch without comment</a>
        </div>
        <div>
            <a href="#c27" class="attach-time activity-ref"><span class="rel-time" title="2019-02-08 09:12 PST" data-time="1549645921">3 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_36541" ><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div></span>
        </div>
        <div class="attach-info">14.08 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_36541" ><span class="fn">KaiE</span>
</div>:
              <a href="#c27"
                  class="flag-name-status rel-time-title activity-ref"
                  title="3 years ago"
              data-time="1549645921"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9042529&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=9042529&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1507218&attachment=9042529">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9042758">Patch without comment - merged to esr-60, uses local config for extra NSS symbols</a>
        </div>
        <div>
            <a href="#c34" class="attach-time activity-ref"><span class="rel-time" title="2019-02-09 11:50 PST" data-time="1549741827">3 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_36541" ><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div></span>
        </div>
        <div class="attach-info">18.70 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_176914" ><span class="fn">jorgk-bmo</span>
</div>:
              <a href="#a7541429_176914"
                  class="flag-name-status rel-time-title activity-ref"
                  title="3 years ago"
              data-time="1549758533"
            >
              approval-comm-esr60+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9042758&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=9042758&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1507218&attachment=9042758">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9043408">Fix for SeaMonkey link error</a>
        </div>
        <div>
            <a href="#c48" class="attach-time activity-ref"><span class="rel-time" title="2019-02-12 13:34 PST" data-time="1550007243">3 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_51884" ><a class="email " href="/user_profile?user_id=51884" > <span class="fna">Frank-Rainer Grahl (:frg)</span></a>
</div></span>
        </div>
        <div class="attach-info">639 bytes,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_51884" ><span class="fn">frg</span>
</div>:
              <a href="#c48"
                  class="flag-name-status rel-time-title activity-ref"
                  title="3 years ago"
              data-time="1550007243"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9043408&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=9043408&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1507218&attachment=9043408">Splinter Review</a>
    </tr>
</table>

<footer id="attachments-footer">
  <div id="attachments-actions">
      <button type="button" id="attachments-obsolete-btn" class="secondary">Show Obsolete</button>
  </div>
  
</footer>
  </div>
</section>



<script nonce="XXoIHl7fz9gzBDD175SVo864dcE77ADbiTbZpYXs1dV7lXYz">
  init_module_visibility();
</script>



<meta name="firefox-versions" content="{&quot;FIREFOX_AURORA&quot;:&quot;&quot;,&quot;FIREFOX_DEVEDITION&quot;:&quot;94.0b9&quot;,&quot;FIREFOX_ESR&quot;:&quot;78.15.0esr&quot;,&quot;FIREFOX_ESR_NEXT&quot;:&quot;91.2.0esr&quot;,&quot;FIREFOX_NIGHTLY&quot;:&quot;95.0a1&quot;,&quot;FIREFOX_PINEBUILD&quot;:&quot;&quot;,&quot;LAST_MERGE_DATE&quot;:&quot;2021-10-04&quot;,&quot;LAST_RELEASE_DATE&quot;:&quot;2021-10-05&quot;,&quot;LAST_SOFTFREEZE_DATE&quot;:&quot;2021-09-30&quot;,&quot;LATEST_FIREFOX_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_OLDER_VERSION&quot;:&quot;3.6.28&quot;,&quot;LATEST_FIREFOX_RELEASED_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_VERSION&quot;:&quot;93.0&quot;,&quot;NEXT_MERGE_DATE&quot;:&quot;2021-11-01&quot;,&quot;NEXT_RELEASE_DATE&quot;:&quot;2021-11-02&quot;,&quot;NEXT_SOFTFREEZE_DATE&quot;:&quot;2021-10-28&quot;}">


<div id="comment-actions">
    <button type="button" id="bottom-btn" class="secondary" aria-label="Go to Page Bottom">Bottom &darr;</button>
  <div class="dropdown">
    <button type="button" id="comment-tags-btn" aria-haspopup="true" aria-label="Tags"
      aria-expanded="false" aria-controls="comment-tags-menu" class="dropdown-button minor">Tags &#9662;</button>
    <ul id="comment-tags-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a role="menuitem" tabindex="-1" data-comment-tag="">Reset</a>
      </li>
    </ul>
  </div>
  <div class="dropdown">
    <button type="button" id="view-menu-btn" aria-haspopup="true" aria-label="Timeline"
      aria-expanded="false" aria-controls="view-menu" class="dropdown-button minor">Timeline &#9662;</button>
    <ul id="view-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a id="view-reset" role="menuitem" tabindex="-1">Reset</a>
      </li>
      <li role="separator"></li>
      <li role="presentation">
        <a id="view-collapse-all" role="menuitem" tabindex="-1">Collapse All</a>
      </li>
      <li role="presentation">
        <a id="view-expand-all" role="menuitem" tabindex="-1">Expand All</a>
      </li>
      <li role="presentation">
        <a id="view-comments-only" role="menuitem" tabindex="-1">Comments Only</a>
      </li>
    </ul>
   </div>
</div>
<div class="change-set" id="c0"><div class="comment" data-id="13756979" data-no="0"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-0" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_628250" ><img src="https://secure.gravatar.com/avatar/4d8090afb6598115b731821b4bf77f7f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_628250" ><a class="email " href="/user_profile?user_id=628250" > <span class="fna">Damian Poddebniak</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-0"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-0" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c0">Description</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-11-14 09:38 PST" data-time="1542217104">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-0">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9025094"
         class="attachment"
         data-id="9025094" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="eContentConfusion.eml">
      <meta itemprop="contentSize" content="8164">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=9025094" itemprop="contentUrl">
        <span id="att-9025094-description" itemprop="description">eContentConfusion.eml</span></a>
        — <a href="attachment.cgi?id=9025094&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-0" data-comment-id="13756979">User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:63.0) Gecko/20100101 Firefox/63.0

Steps to reproduce:

Build a special *.eml file with conflicting requirements. I used the der2ascii tool¹ to create this email. The error is further explained in the uploaded file itself.

¹ <a rel="nofollow" href="https://github.com/google/der-ascii">https://github.com/google/der-ascii</a>


Actual results:

The email is showed as being signed by Damian Poddebniak (me), even though the text can be freely changed.


Expected results:

Error out due to &quot;conflicting requirements&quot; OR display of the verified content only.</pre></div><div class="change-set" id="c1"><div class="comment" data-id="13757020" data-no="1"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-1" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_628250" ><img src="https://secure.gravatar.com/avatar/4d8090afb6598115b731821b4bf77f7f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_628250" ><a class="email " href="/user_profile?user_id=628250" > <span class="fna">Damian Poddebniak</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-1"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-1" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c1">Comment 1</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-11-14 09:54 PST" data-time="1542218070">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-1">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-1" data-comment-id="13757020">This works in the latest Thunderbirds (60.0, 60.2.1, 60.3.0) but I expect it to work in all (?) previous versions supporting opaque signing.</pre></div><div class="change-set" id="c2"><div class="comment" data-id="13759741" data-no="2"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-2" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_22599" ><img src="https://secure.gravatar.com/avatar/1a31769c00192ed0a23c3142d6deace0?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_22599" ><a class="email " href="/user_profile?user_id=22599" > <span class="fna">Ben Bucksch (:BenB)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-2"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-2" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c2">Comment 2</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-11-15 10:24 PST" data-time="1542306294">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-2">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-2" data-comment-id="13759741">Content of message with more explanation:

This is arbitrary text not covered by any signature. However,
Thunderbird shows this message together with all UI elements
indicating a valid signature.

In order to verify this, (1) change this text,
                         (2) reopen in Thunderbird, and
			 (3) see that nothing changes 

The problem is, that Thunderbird validates the signature against the
text contained in the CMS object in the second part of this email (the
eContent), but displays the detached part (this text here).

The solution is simple: error out in case that both the eContent and
some external content is present OR only show what was verified.</pre></div><div class="change-set" id="c3"><div class="comment" data-id="13760430" data-no="3"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-3" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_628250" ><img src="https://secure.gravatar.com/avatar/4d8090afb6598115b731821b4bf77f7f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_628250" ><a class="email " href="/user_profile?user_id=628250" > <span class="fna">Damian Poddebniak</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-3"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-3" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c3">Comment 3</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-11-15 16:54 PST" data-time="1542329663">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-3">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-3" data-comment-id="13760430">By the way, this could also potentially affect xpi addons. But as far as I tested, I was not able to bypass the signature check and change the manifest. I will continue testing.</pre></div><div class="change-set" id="a1300127_1689"><div class="change" id="aa1300127_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a1300127_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a1300127_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1300127_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1300127_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#a1300127_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-11-29 10:47 PST" data-time="1543517231">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Status: UNCONFIRMED &rarr; NEW</div><div class="change">Component: Security &rarr; Security: S/MIME</div><div class="change">Ever confirmed: true</div><div class="change">Keywords: <a href="/buglist.cgi?keywords=csectype-spoof&amp;resolution=---">csectype-spoof</a>, 
          
            <a href="/buglist.cgi?keywords=sec-high&amp;resolution=---">sec-high</a></div><div class="change">Product: Thunderbird &rarr; MailNews Core</div></div></div><div class="change-set" id="a1365759_253233"><div class="change" id="aa1365759_253233">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_253233" id="a1365759_253233"><img src="https://secure.gravatar.com/avatar/834e6840be1a79998020e3004c902ac7?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_253233" id="a1365759_253233"><a class="email " href="/user_profile?user_id=253233" > <span class="fna">Philipp Kewisch [:Fallen] [:📆][:🧩]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1365759_253233"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1365759_253233">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#a1365759_253233">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-11-30 05:01 PST" data-time="1543582863">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9025094&amp;action=edit"
           title="eContentConfusion.eml"
           class=""
        >Attachment #9025094</a> -
        Attachment mime type: message/rfc822 &rarr; text/plain</div></div></div><div class="change-set" id="c4"><div class="comment" data-id="13789249" data-no="4"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-4" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_253233" id="a1365759_253233"><img src="https://secure.gravatar.com/avatar/834e6840be1a79998020e3004c902ac7?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_253233" id="a1365759_253233"><a class="email " href="/user_profile?user_id=253233" > <span class="fna">Philipp Kewisch [:Fallen] [:📆][:🧩]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-4"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-4" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c4">Comment 4</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-11-30 05:02 PST" data-time="1543582920">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-4">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-4" data-comment-id="13789249">Thanks for the report. Magnus, can you have someone look into this or do so yourself?</pre><div class="activity"><div class="change">Flags: needinfo?(mkmelin+mozilla)</div></div></div><div class="change-set" id="c5"><div class="comment" data-id="13879453" data-no="5"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-5" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_628250" id="a1365759_253233"><img src="https://secure.gravatar.com/avatar/4d8090afb6598115b731821b4bf77f7f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_628250" id="a1365759_253233"><a class="email " href="/user_profile?user_id=628250" > <span class="fna">Damian Poddebniak</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-5"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-5" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c5">Comment 5</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-01-23 04:42 PST" data-time="1548247375">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-5">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-5" data-comment-id="13879453" data-ismarkdown="true" ><p>Any updates on this? :-)</p>
</div></div><div class="change-set" id="c6"><div class="comment" data-id="13879504" data-no="6"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-6" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_101158" id="a1365759_253233"><img src="https://secure.gravatar.com/avatar/18eb16a976feb4b40d839c5e9036bc3a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_101158" id="a1365759_253233"><a class="email " href="/user_profile?user_id=101158" > <span class="fna">Magnus Melin [:mkmelin]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-6"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-6" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c6">Comment 6</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-01-23 05:15 PST" data-time="1548249339">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-6">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-6" data-comment-id="13879504" data-ismarkdown="true" ><p>Yeah I was looking at this earlier with not a huge success. Will investigate some more now.</p>
</div><div class="activity"><div class="change">Assignee: nobody &rarr; mkmelin+mozilla</div><div class="change">Flags: <span class="activity-deleted">needinfo?(mkmelin+mozilla)</span></div></div></div><div class="change-set" id="c7"><div class="comment" data-id="13879631" data-no="7"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-7" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_628250" id="a1365759_253233"><img src="https://secure.gravatar.com/avatar/4d8090afb6598115b731821b4bf77f7f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_628250" id="a1365759_253233"><a class="email " href="/user_profile?user_id=628250" > <span class="fna">Damian Poddebniak</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-7"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-7" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c7">Comment 7</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-01-23 06:16 PST" data-time="1548253007">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-7">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-7" data-comment-id="13879631" data-ismarkdown="true" ><p>If I can assist somehow, please ask. It should be enough to open the provided mail in thunderbird as the used certificate is valid.</p>
</div></div><div class="change-set" id="c8"><div class="comment" data-id="13879634" data-no="8"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-8" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_628250" id="a1365759_253233"><img src="https://secure.gravatar.com/avatar/4d8090afb6598115b731821b4bf77f7f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_628250" id="a1365759_253233"><a class="email " href="/user_profile?user_id=628250" > <span class="fna">Damian Poddebniak</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-8"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-8" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c8">Comment 8</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-01-23 06:18 PST" data-time="1548253126">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-8">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-8" data-comment-id="13879634" data-ismarkdown="true" ><p>I am not familiar with the Thunderbird codebase (yet), but I expect that the signature is first checked somewhere and then some other code decided to take the detached text without noticing that the eContent was used for verification.</p>
</div></div><div class="change-set" id="c9"><div class="comment" data-id="13881795" data-no="9"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-9" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_101158" id="a1365759_253233"><img src="https://secure.gravatar.com/avatar/18eb16a976feb4b40d839c5e9036bc3a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_101158" id="a1365759_253233"><a class="email " href="/user_profile?user_id=101158" > <span class="fna">Magnus Melin [:mkmelin]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-9"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-9" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c9">Comment 9</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-01-24 02:37 PST" data-time="1548326269">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-9">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-9" data-comment-id="13881795" data-ismarkdown="true" ><p>As far as I can tell, this bug is in NSS. The structure of the message is not really odd, but once the signature part is sent off for verification it verifies against the internal text inside what&#39;s supposed to be the signature (though I suppose that&#39;s legal, as a non-detached signature?)</p>
<p>The comment at <a href="https://searchfox.org/comm-central/source/mailnews/mime/src/nsCMS.cpp#258-264" rel="nofollow">https://searchfox.org/comm-central/source/mailnews/mime/src/nsCMS.cpp#258-264</a> is not exactly encouraging... but maybe not the core issue.</p>
<p>Kai, can you make any sense of this?</p>
</div><div class="activity"><div class="change">Assignee: mkmelin+mozilla &rarr; kaie</div></div></div><div class="change-set" id="c10"><div class="comment" data-id="13881940" data-no="10"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-10" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_628250" id="a1365759_253233"><img src="https://secure.gravatar.com/avatar/4d8090afb6598115b731821b4bf77f7f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_628250" id="a1365759_253233"><a class="email " href="/user_profile?user_id=628250" > <span class="fna">Damian Poddebniak</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-10"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-10" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c10">Comment 10</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-01-24 04:59 PST" data-time="1548334746">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-10">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-10" data-comment-id="13881940" data-ismarkdown="true" ><p>S/MIME supports multiple signers (signerInfos is a list of signerInfo) in one CMS object. I think that the comment means that multiple signers are not supported at all. I like that. Especially, because having multiple signers may introduce problems like showing &quot;good signature&quot; even if some signatures are invalid. Also, the UI must be changed to support multiple signers. I think this will introduce more problems that it solves.</p>
<p>The internal text (called eContent in CMS-speak) is used in opaque signatures, i.e. those that are not send via multipart/signed. Having an empty eContent signals that the signed data must come from somewhere else. In the case of S/MIME this is typically the text in the detached part. But having a non-empty eContent AND a multipart/signed message makes no sense.</p>
<p>Maybe it is okay to just error out in this situation? This is what Claws Mail does.</p>
</div></div><div class="change-set" id="c11"><div class="comment" data-id="13881993" data-no="11"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-11" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a1365759_253233"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a1365759_253233"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-11"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-11" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c11">Comment 11</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-01-24 05:30 PST" data-time="1548336655">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-11">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-11" data-comment-id="13881993" data-ismarkdown="true" ><p>Damian, thanks for the bug report, test case and the explanations.</p>
<p>(In reply to Damian Poddebniak from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1507218#c10" title="RESOLVED FIXED - Wrong Thunderbird S/MIME signature status shown, if CMS signed data has data content.">comment #10</a>)</p>
<blockquote>
<p>But having a non-empty eContent AND a multipart/signed message makes no sense.<br>
Maybe it is okay to just error out in this situation? This is what Claws Mail does.</p>
</blockquote>
<p>The current implementation probably doesn&#39;t know about this potential inconsistency, and doesn&#39;t try to detect it. If it finds signature data at the matching MIME nesting level, then it will update the UI. I&#39;m reading through the code, to find the right place to fix it. We could simply ignore the signature (not display signature UI) if we find eContent in the context of multipart/signed, or, we could report the &quot;invalid signature icon&quot; without trying to verify.</p>
<p>(The source comment that Magnus mentioned in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1507218#c9" title="RESOLVED FIXED - Wrong Thunderbird S/MIME signature status shown, if CMS signed data has data content.">comment 9</a> seems to be unrelated.)</p>
</div></div><div class="change-set" id="c12"><div class="comment" data-id="13882620" data-no="12"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-12" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a1365759_253233"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a1365759_253233"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-12"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-12" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c12">Comment 12</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-01-24 09:48 PST" data-time="1548352094">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-12">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-12" data-comment-id="13882620" data-ismarkdown="true" ><p>Analyzing this bug raises concerns about inconsistencies in the code.</p>
<p>The MIME processing code calculates the digest/hash of the displayed message contents. We arrive in nsCMSMessage::CommonVerifySignature, which uses the locally computed digest data. The digest parameter has a variable size. If the multipart message mentioned micalg-sha256, the digest parameter has the expected size (32 bytes, 256 bits).</p>
<p>However, nsCMSMessage::CommonVerifySignature proceeds to tell NSS about the digest, by calling NSS_CMSSignedData_SetDigestValue. Here it uses a hardcoded value SEC_OID_SHA1.</p>
<p>Despite this inconsistency, NSS happily accepts the digest into and stores it. Later we arrive in NSS_CMSSignedData_VerifySignerInfo, which finds the digest, and thinks it&#39;s a digest of type SHA256, and the comparison succeeds.</p>
<p>I don&#39;t understand yet why this works. But it seems this is an inconsistency that should get analyzed further. The data structures used here by NSS have the ability to store multiple digests of different types, so maybe it only works for most messages, because there&#39;s usually just one digest calculated.</p>
<p>I think that code should be fixed, it should no longer hardcode SEC_OID_SHA1, but should use the same digest identifier that was used during digest calculation (e.g. hash_type in mimemcms.cpp), and pass on together as an additioan parameter, along with the digest data and length.</p>
<p>Now, back to this bug.</p>
<p>In this scenario, the decoding of the CMS content data by NSS has already triggered the calculation of a digest value, and NSS already has it remembered. It&#39;s of type SHA256.</p>
<p>nsCMSMessage::CommonVerifySignature attempts to tell NSS about the message content data that the MIME code has calulated. Because it uses the (incorrect) SEC_OID_SHA1 identifier, NSS stores it as an additional digest. Later, when verifying inside NSS_CMSSignedData_VerifySignerInfo, NSS picks the remembered SHA256 digest, and is happy.</p>
<p>As a quick test, I changed the hardcoded value to SEC_OID_SHA256. With this change, when nsCMSMessage::CommonVerifySignature calls NSS_CMSSignedData_SetDigestValue, it overrides the earlier SHA256 digest. And later in NSS_CMSSignedData_VerifySignerInfo, a mismatch is detected and the user interface shows the &quot;invalid signature&quot; icon.</p>
<p>So, in order to fix this bug, we should:</p>
<ul>
<li>
<p>try to understand if the hardcoded _SHA1 tag could cause other signature status display with other messages, too</p>
</li>
<li>
<p>replace the hardcoded _SHA1 with the correct information, the same as used during MIME digest calculation</p>
</li>
<li>
<p>ensure we correctly handle a scenario in which multiple digests are present. For example, the multipart message could request a migalg-sha384, but the CMS content info signature might use SHA256. When arriving inside NSS_CMSSignedData_VerifySignerInfo, it would find two difference digests, and might select any of it, and if it selects the SHA256 digest, it might again cause a correct signature display. I think when arriving in nsCMSMessage::CommonVerifySignature, we should remove all digests from the NSS structure, which NSS might have already created during CMS decoding, and ensure that only a single digest will be set, which is the one obtained from the MIME calculation, which hashed the displayed content. With this, we&#39;ll either get a mismatch, if the signature was created for a different content, or with a different hash algorithm. Or, if the CMS content is identical to the message content, and both use the same hash algorithm, and it matches the digest used in the signature, then we&#39;ll correctly get a valid signature display.</p>
</li>
</ul>
</div></div><div class="change-set" id="c13"><div class="comment" data-id="13883306" data-no="13"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-13" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a1365759_253233"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a1365759_253233"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-13"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-13" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c13">Comment 13</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-01-24 14:17 PST" data-time="1548368231">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-13">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9038945"
         class="attachment"
         data-id="9038945" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="sha384.eml">
      <meta itemprop="contentSize" content="8287">
      <meta itemprop="encodingFormat" content="message/rfc822">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=9038945" itemprop="contentUrl">
        <span id="att-9038945-description" itemprop="description">testcase2.eml</span></a>
        — <a href="attachment.cgi?id=9038945&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <div
        class="comment-text markdown-body "
        id="ct-13" data-comment-id="13883306" data-ismarkdown="true" ><p>This is an additional testcase. It&#39;s almost identical to Damian&#39;s file, only difference is that it says micalg-sha384 in the header.</p>
<p>After fixing the hardcoded SHA1 parameter, Damian&#39;s file no longer triggers the bug. But this sha384 file still triggers is.</p>
</div></div><div class="change-set" id="c14"><div class="comment" data-id="13884455" data-no="14"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-14" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a1365759_253233"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a1365759_253233"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-14"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-14" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c14">Comment 14</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-01-25 06:49 PST" data-time="1548427767">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-14">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9039106"
         class="attachment patch"
         data-id="9039106" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="1507218-v1.patch">
      <meta itemprop="contentSize" content="19160">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=9039106">
          <a class="link" href="attachment.cgi?id=9039106&amp;action=diff">
        <span id="att-9039106-description" itemprop="description">1507218-v1.patch (don't use yet)</span></a>
        — <a href="attachment.cgi?id=9039106&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1507218&attachment=9039106">Splinter Review</a>
      </div>
    </div></div><div class="change-set" id="a6210833_36541"><div class="change" id="aa6210833_36541">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a6210833_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_36541" id="a6210833_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a6210833_36541"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a6210833_36541">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#a6210833_36541">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-01-25 06:52 PST" data-time="1548427937">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Summary: eContent confusion (forgery of signed messages) &rarr; Wrong Thunderbird S/MIME signature status shown, if CMS signed data has data content.</div></div></div><div class="change-set" id="c15"><div class="comment" data-id="13885377" data-no="15"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-15" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a6210833_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a6210833_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-15"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-15" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c15">Comment 15</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-01-25 13:08 PST" data-time="1548450530">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-15">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9039222"
         class="attachment obsolete"
         data-id="9039222" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="phabricator-D17693-url.txt">
      <meta itemprop="contentSize" content="47">
      <meta itemprop="encodingFormat" content="text/x-phabricator-request">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=9039222" itemprop="contentUrl">
        <span id="att-9039222-description" itemprop="description">no comment</span></a> (obsolete)
        — <a href="attachment.cgi?id=9039222&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div></div><div class="change-set" id="c16"><div class="comment" data-id="13906994" data-no="16"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-16" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_628250" id="a6210833_36541"><img src="https://secure.gravatar.com/avatar/4d8090afb6598115b731821b4bf77f7f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_628250" id="a6210833_36541"><a class="email " href="/user_profile?user_id=628250" > <span class="fna">Damian Poddebniak</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-16"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-16" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c16">Comment 16</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-06 05:01 PST" data-time="1549458060">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-16">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-16" data-comment-id="13906994" data-ismarkdown="true" ><p>We may disclose this/and similar issues soon. I really don&#39;t want to stress, especially as the fix may not be trivial. Bit do you have any updates on this?</p>
<p>PS: we would also like to register a CVE as to document it appropriately. How should I proceed?</p>
</div></div><div class="change-set" id="a7325411_36541"><div class="change" id="aa7325411_36541">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a7325411_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_36541" id="a7325411_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a7325411_36541"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a7325411_36541">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#a7325411_36541">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-07 04:28 PST" data-time="1549542515">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9039106&amp;action=edit"
           title="1507218-v1.patch (don't use yet)"
           class=""
        >Attachment #9039106</a> -
        Flags: review?(rrelyea)</div></div></div><div class="change-set" id="c17"><div class="comment" data-id="13909473" data-no="17"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-17" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a7325411_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a7325411_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-17"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-17" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c17">Comment 17</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-07 05:23 PST" data-time="1549545823">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-17">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-17" data-comment-id="13909473" data-ismarkdown="true" ><blockquote>
<p>PS: we would also like to register a CVE as to document it appropriately. How should I proceed?</p>
</blockquote>
<p>Al, could you please help out and assign a CVE?</p>
</div><div class="activity"><div class="change">Flags: needinfo?(abillings)</div></div></div><div class="change-set" id="c18"><div class="comment" data-id="13909476" data-no="18"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-18" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a7325411_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a7325411_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-18"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-18" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c18">Comment 18</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-07 05:25 PST" data-time="1549545923">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-18">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-18" data-comment-id="13909476" data-ismarkdown="true" ><p>(In reply to Damian Poddebniak from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1507218#c16" title="RESOLVED FIXED - Wrong Thunderbird S/MIME signature status shown, if CMS signed data has data content.">comment #16</a>)</p>
<blockquote>
<p>We may disclose this/and similar issues soon. I really don&#39;t want to stress, especially as the fix may not be trivial. Bit do you have any updates on this?</p>
</blockquote>
<p>Hi Damian, thanks for the update.</p>
<p>Several of us have been travelling to various conferences during the past weeks, devconf.cz, fosdem.org and others, so I&#39;m sorry for the delay.</p>
<p>I&#39;ve just asked Bob for review, whom I had contacted in advance by email. I hope we&#39;ll be able to move forward on this issue soon.</p>
</div></div><div class="change-set" id="c19"><div class="comment" data-id="13909514" data-no="19"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-19" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_628250" id="a7325411_36541"><img src="https://secure.gravatar.com/avatar/4d8090afb6598115b731821b4bf77f7f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_628250" id="a7325411_36541"><a class="email " href="/user_profile?user_id=628250" > <span class="fna">Damian Poddebniak</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-19"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-19" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c19">Comment 19</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-07 05:43 PST" data-time="1549547001">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-19">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-19" data-comment-id="13909514" data-ismarkdown="true" ><p>Thanks! We evaluated signature-handling/signature-presentation from different directions and wrote a paper on that topic. This is why I can not say for sure when will be the best moment for us to put our test cases online for example.</p>
<p>Anyway, if you are interested in the unsuccesful tests, I can provide a link to our repository. I think some of the tests could be useful as unit tests to avoid regression in future.</p>
<p>Do you mind if I incorporate the test you provided into our test set? (testcase2.eml)</p>
</div></div><div class="change-set" id="c20"><div class="comment" data-id="13909643" data-no="20"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-20" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a7325411_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a7325411_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-20"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-20" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c20">Comment 20</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-07 06:36 PST" data-time="1549550184">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-20">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-20" data-comment-id="13909643" data-ismarkdown="true" ><p>(In reply to Damian Poddebniak from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1507218#c19" title="RESOLVED FIXED - Wrong Thunderbird S/MIME signature status shown, if CMS signed data has data content.">comment #19</a>)</p>
<blockquote>
<p>Do you mind if I incorporate the test you provided into our test set? (testcase2.eml)</p>
</blockquote>
<p>Sure, go ahead. Might be useful to slightly modify that message, for example use a different subject, to distinguish it more easily.</p>
</div></div><div class="change-set" id="c21"><div class="comment" data-id="13910456" data-no="21"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-21" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a7325411_36541"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_280903" id="a7325411_36541"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-21"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-21" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c21">Comment 21</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-07 11:56 PST" data-time="1549569361">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-21">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-21" data-comment-id="13910456" data-ismarkdown="true" ><p><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-18509">CVE-2018-18509</a> assigned.</p>
</div><div class="activity"><div class="change">Alias: CVE-2018-18509</div><div class="change">Flags: <span class="activity-deleted">needinfo?(abillings)</span></div></div></div><div class="change-set" id="c22"><div class="comment" data-id="13911269" data-no="22"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-22" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_11099" id="a7325411_36541"><img src="https://secure.gravatar.com/avatar/4e29cfbfaece102427b6d6aa84d135f5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_11099" id="a7325411_36541"><a class="email " href="/user_profile?user_id=11099" > <span class="fna">Robert Relyea</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-22"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-22" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c22">Comment 22</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-07 16:54 PST" data-time="1549587294">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-22">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-22" data-comment-id="13911269">Comment on <span class=""><a href="/attachment.cgi?id=9039106" name="attach_9039106" title="1507218-v1.patch (don't use yet)">attachment 9039106</a> <a href="/attachment.cgi?id=9039106&amp;action=edit" title="1507218-v1.patch (don't use yet)">[details]</a> <a href="/attachment.cgi?id=9039106&amp;action=diff" title="1507218-v1.patch (don't use yet)">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1507218&amp;attachment=9039106'>[review]</a>
1507218-v1.patch (don't use yet)

Review of <span class=""><a href="/attachment.cgi?id=9039106" name="attach_9039106" title="1507218-v1.patch (don't use yet)">attachment 9039106</a> <a href="/attachment.cgi?id=9039106&amp;action=edit" title="1507218-v1.patch (don't use yet)">[details]</a> <a href="/attachment.cgi?id=9039106&amp;action=diff" title="1507218-v1.patch (don't use yet)">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1507218&amp;attachment=9039106'>[review]</a>:
-----------------------------------------------------------------

basic comments. Nothing that needs to actually change.
r+
bob

::: mailnews/mime/src/nsCMS.cpp
&#64;&#64; +213,5 &#64;&#64;
<span class="quote">&gt; +      case SEC_OID_PKCS7_DIGESTED_DATA:
&gt; +      default: {
&gt; +        MOZ_LOG(gPIPNSSLog, LogLevel::Debug, (&quot;nsCMSMessage::CommonVerifySignature - unexpected ContentTypeTag\n&quot;));
&gt; +        rv = NS_ERROR_CMS_VERIFY_NO_CONTENT_INFO;
&gt; +        goto loser;</span >

style: you could simply  break here and let the if below handle it. That would be more 'efficient'. keeping the current code is probably better for future maintanence (a break only works as long as sigd is null coming in and the if below doesn't move). Also the current code is superior for debug/logging as it gives a unique message for failure because of incorrect content type as opposed to failure in NSS_CMSContentInfo_GetContent().

upshot: you could 'optimize' this with a break if you want to, but there are good reasons to keep the code as written.

&#64;&#64; +656,5 &#64;&#64;
<span class="quote">&gt; +      aOidTag = SEC_OID_SHA512;
&gt; +      break;
&gt; +    default:
&gt; +      rv = false;
&gt; +  }</span >

It's unfortunate you are using yet another way of specifying hashes separate from NSS. NSS already has at least 2 ways (SECOidTag and HASH_HashType). There are already ways of converting one to another. This code means that you'll have to update you code by hand in order to handle new hashes.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9039106&amp;action=edit"
           title="1507218-v1.patch (don't use yet)"
           class=""
        >Attachment #9039106</a> -
        Flags: review?(rrelyea) &rarr; review+</div></div></div><div class="change-set" id="c23"><div class="comment" data-id="13912735" data-no="23"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-23" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a7325411_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a7325411_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-23"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-23" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c23">Comment 23</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-08 07:42 PST" data-time="1549640547">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-23">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-23" data-comment-id="13912735" data-ismarkdown="true" ><p>Bob, thanks for the review.</p>
<p>(In reply to Robert Relyea from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1507218#c22" title="RESOLVED FIXED - Wrong Thunderbird S/MIME signature status shown, if CMS signed data has data content.">comment #22</a>)</p>
<blockquote>
<p>upshot: you could &#39;optimize&#39; this with a break if you want to, but there are<br>
good reasons to keep the code as written.</p>
</blockquote>
<p>I agree. Having the more detailed error logging is good, and making it explicit this is a failure scenario is good, too.</p>
<blockquote>
<p>It&#39;s unfortunate you are using yet another way of specifying hashes separate<br>
from NSS. NSS already has at least 2 ways (SECOidTag and HASH_HashType).<br>
There are already ways of converting one to another. This code means that<br>
you&#39;ll have to update you code by hand in order to handle new hashes.</p>
</blockquote>
<p>The constant symbols we&#39;re using here are from a PSM IDL, but they&#39;re expected to be in sync with the values from HASH_HashType. If there&#39;s an existing NSS conversion function from HASH_HashType to SECOidTag then we could reuse it.</p>
<p>However, I couldn&#39;t find an exported function for that, other places that need this conversion have also defined it locally, for example cmd/digest has an incomplete HashTypeToOID, and the new nss-tool for testing also has something that doesn&#39;t help here.</p>
<p>Given that we&#39;re likely to transplant this patch on older branches, I think it&#39;s best to potentially optimize your suggestion in a separate bug.</p>
</div></div><div class="change-set" id="c24"><div class="comment" data-id="13912800" data-no="24"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-24" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a7325411_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a7325411_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-24"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-24" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c24">Comment 24</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-08 08:14 PST" data-time="1549642453">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-24">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-24" data-comment-id="13912800" data-ismarkdown="true" ><p>I&#39;ve filed <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1526302" title="RESOLVED FIXED - remove MD2 support from nsICryptoHash, clarifiy hash IDs must be synchronized with NSS hasht.h">bug 1526302</a> and <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1526336" title="RESOLVED FIXED - Implement new HASH_GetHashOidTagByHashType">bug 1526336</a> so we can improve the mapping in the future.</p>
</div></div><div class="change-set" id="c25"><div class="comment" data-id="13912929" data-no="25"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-25" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a7325411_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a7325411_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-25"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-25" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c25">Comment 25</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-08 08:56 PST" data-time="1549644991">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-25">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-25" data-comment-id="13912929" data-ismarkdown="true" ><p>I wonder how widespread this kind of signature is. Damian, do you know if any common S/MIME sending software creates signatures with embedded content?</p>
<p>If Charlie wants to use this bug to send a spoofed message, claiming to be sent by Alice, then Charlie needs to obtain any signed message from Alice that contains a signature with embedded content.</p>
<p>If Charlie uses a signature which wasn&#39;t created by Alice (like Damian&#39;s signature in the example), as a consequence the signature&#39;s email address doesn&#39;t match Alice&#39;s address, then Thunderbird displays a &quot;questionable signature&quot;, not the expected &quot;broken signature&quot;.</p>
</div></div><div class="change-set" id="c26"><div class="comment" data-id="13912946" data-no="26"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-26" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a7325411_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a7325411_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-26"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-26" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c26">Comment 26</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-08 09:03 PST" data-time="1549645381">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-26">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-26" data-comment-id="13912946" data-ismarkdown="true" ><p>I think the patch is ready to land, but the Thunderbird drivers need to discuss when the fix can be released. I&#39;ll email them, and give an update once it&#39;s decided.</p>
<p>The patch contains a comment, which makes it pretty obvious what the bug is about:</p>
<ul>
<li>// Potentially there was embedded content in CMS signed data,</li>
<li>// and NSS has already calculated a digest for it.</li>
<li>// Because we don&#39;t display that embedded content, we set all</li>
<li>// preexisting digests to NULL, to ensure NSS won&#39;t use them.</li>
</ul>
<p>When landing before an embargo date, it might be better to land without that comment.</p>
<p>The checkin comment could be<br>
&quot;don&#39;t use a hardcoded SEC_OID_SHA1 parameter&quot;,<br>
which could serve as a valid description for most of the changes in the patch.</p>
</div></div><div class="change-set" id="c27"><div class="comment" data-id="13912964" data-no="27"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-27" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a7325411_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a7325411_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-27"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-27" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c27">Comment 27</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-08 09:12 PST" data-time="1549645921">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-27">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9042529"
         class="attachment patch"
         data-id="9042529" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1507218-no-hardcoded-sha1.patch">
      <meta itemprop="contentSize" content="14413">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=9042529">
          <a class="link" href="attachment.cgi?id=9042529&amp;action=diff">
        <span id="att-9042529-description" itemprop="description">Patch without comment</span></a>
        — <a href="attachment.cgi?id=9042529&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1507218&attachment=9042529">Splinter Review</a>
      </div>
    </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9042529&amp;action=edit"
           title="Patch without comment"
           class=""
        >Attachment #9042529</a> -
        Flags: review+</div></div></div><div class="change-set" id="a7428832_36541"><div class="change" id="aa7428832_36541">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a7428832_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_36541" id="a7428832_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a7428832_36541"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a7428832_36541">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#a7428832_36541">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-08 09:12 PST" data-time="1549645936">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9039222&amp;action=edit"
           title="no comment"
           class=""
        >Attachment #9039222</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="a7428859_36541"><div class="change" id="aa7428859_36541">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a7428859_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_36541" id="a7428859_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a7428859_36541"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a7428859_36541">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#a7428859_36541">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-08 09:12 PST" data-time="1549645963">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9039106&amp;action=edit"
           title="1507218-v1.patch (don't use yet)"
           class=""
        >Attachment #9039106</a> -
        Attachment description: 1507218-v1.patch &rarr; 1507218-v1.patch (don't use yet)</div></div></div><div class="change-set" id="c28"><div class="comment" data-id="13913027" data-no="28"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-28" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_628250" id="a7428859_36541"><img src="https://secure.gravatar.com/avatar/4d8090afb6598115b731821b4bf77f7f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_628250" id="a7428859_36541"><a class="email " href="/user_profile?user_id=628250" > <span class="fna">Damian Poddebniak</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-28"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-28" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c28">Comment 28</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-08 09:31 PST" data-time="1549647112">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-28">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-28" data-comment-id="13913027" data-ismarkdown="true" ><blockquote>
<p>I wonder how widespread this kind of signature is. Damian, do you know if any common S/MIME sending software creates signatures with embedded content?</p>
</blockquote>
<p>Yes. At least Outlook 2013 and 2016 use opaque-signed as default.</p>
<blockquote>
<p>If Charlie wants to use this bug to send a spoofed message, claiming to be sent by Alice, then Charlie needs to obtain any signed message from Alice that contains a signature with embedded content.</p>
</blockquote>
<p>Charlie can also obtain a multipart/signed message and transform it to an opaque-signed one. detached --&gt; opaque and opaque --&gt; detached can easily be converted.</p>
<blockquote>
<p>If Charlie uses a signature which wasn&#39;t created by Alice (like Damian&#39;s signature in the example), as a consequence the signature&#39;s email address doesn&#39;t match Alice&#39;s address, then Thunderbird displays a &quot;questionable signature&quot;, not the expected &quot;broken signature&quot;.</p>
</blockquote>
<p>Yes. In order to spoof a signed email from Alice, Charlie must obtain a signed email from her first. But this is easy: just ask Alice something and get a signed answer. Then use this signature to spoof arbitrary new messages of Alice.</p>
</div></div><div class="change-set" id="c29"><div class="comment" data-id="13913430" data-no="29"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-29" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a7428859_36541"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a7428859_36541"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-29"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-29" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c29">Comment 29</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-08 11:45 PST" data-time="1549655115">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-29">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-29" data-comment-id="13913430" data-ismarkdown="true" ><p>I&#39;m here to land whichever version you want with whichever commit message :-)</p>
</div></div><div class="change-set" id="c30"><div class="comment" data-id="13913513" data-no="30"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-30" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a7428859_36541"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a7428859_36541"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-30"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-30" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c30">Comment 30</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-08 12:18 PST" data-time="1549657122">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-30">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-30" data-comment-id="13913513" data-ismarkdown="true" ><p>Umm, that patch produces link errors :-(</p>
<p>0:15.60 lld-link.exe: error: undefined symbol: NSS_CMSSignedData_HasDigests<br>
0:15.60 &gt;&gt;&gt; referenced by c:\mozilla-source\comm-central\comm\mailnews\mime\src\nsCMS.cpp:228<br>
0:15.60 &gt;&gt;&gt;               ....\comm\mailnews\mime\src\nsCMS.obj:(?CommonVerifySignature@nsCMSMessage@@AEAA?AW4nsresult@@PEAEIF@Z)<br>
0:15.60 lld-link.exe: error: undefined symbol: NSS_CMSSignedData_GetDigestAlgs<br>
0:15.60 &gt;&gt;&gt; referenced by c:\mozilla-source\comm-central\comm\mailnews\mime\src\nsCMS.cpp:229<br>
0:15.60 &gt;&gt;&gt;               ....\comm\mailnews\mime\src\nsCMS.obj:(?CommonVerifySignature@nsCMSMessage@@AEAA?AW4nsresult@@PEAEIF@Z)</p>
</div></div><div class="change-set" id="c31"><div class="comment" data-id="13913578" data-no="31"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-31" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a7428859_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a7428859_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-31"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-31" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c31">Comment 31</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-08 12:41 PST" data-time="1549658492">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-31">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-31" data-comment-id="13913578" data-ismarkdown="true" ><p>I had only tested on Linux so far. Windows folds all NSS symbols into a single DLL, and it uses a whitelist of symbols that are used. The patch uses two functions from NSS that were previously unused.</p>
<p>This means we need a change to Gecko that adds the new symbols. I filed <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1526473" title="RESOLVED FIXED - Please export NSS_CMSSignedData_GetDigestAlgs and NSS_CMSSignedData_HasDigests in security/nss.symbols">bug 1526473</a>, attached the necessary change and asked for review.</p>
<p>It also means, when uplifting to older branches, we need a Gecko branch that uplifts that change (unless we can convince Firefox people to also uplift that). I can try to ask for Beta.</p>
</div></div><div class="change-set" id="c32"><div class="comment" data-id="13914598" data-no="32"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-32" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a7428859_36541"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a7428859_36541"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-32"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-32" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c32">Comment 32</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-09 03:28 PST" data-time="1549711692">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-32">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-32" data-comment-id="13914598" data-ismarkdown="true" ><p><a href="https://hg.mozilla.org/releases/comm-beta/rev/77a16669b9c81f4132378effa8a1201953b7eee7" rel="nofollow">https://hg.mozilla.org/releases/comm-beta/rev/77a16669b9c81f4132378effa8a1201953b7eee7</a></p>
<p><a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1526473" title="RESOLVED FIXED - Please export NSS_CMSSignedData_GetDigestAlgs and NSS_CMSSignedData_HasDigests in security/nss.symbols">Bug 1526473</a> landed on C-B already, so I&#39;m doing this in an unorthodox order ;-)</p>
</div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_thunderbird_66&amp;o1=isnotempty">status-thunderbird66</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_thunderbird_66&amp;o1=equals&amp;v1=fixed">fixed</a></div></div></div><div class="change-set" id="c33"><div class="comment" data-id="13914833" data-no="33"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-33" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a7428859_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a7428859_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-33"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-33" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c33">Comment 33</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-09 11:34 PST" data-time="1549740865">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-33">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-33" data-comment-id="13914833" data-ismarkdown="true" ><p>I discovered that it was unnecessary to change the Gecko branches...</p>
<p>Because of the hassle of getting Gecko changed, I filed <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1526519" title="RESOLVED WONTFIX - Change the Firefox build systems to allow other users of Gecko to override security/nss.symbols">bug 1526519</a> to figure out how to override the list of exported symbols from within an Thunderbird build, and then I discovered it&#39;s already possible.</p>
<p>Variable NSS_EXTRA_SYMBOLS_FILE can be defined at build time. It can point to a filename with extra symbols to export. If defined, Gecko&#39;s nss.symbols file will include the file defined by the variable. It needs to be a relative path, relative to the security directory.</p>
<p>For example:<br>
NSS_EXTRA_SYMBOLS_FILE=../comm/comm-extra-nss.symbols</p>
<p>It works to define that variable in comm/mail/confvars.sh</p>
<p>We could try that approach for comm-esr60.</p>
</div></div><div class="change-set" id="c34"><div class="comment" data-id="13914837" data-no="34"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-34" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a7428859_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a7428859_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-34"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-34" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c34">Comment 34</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-09 11:50 PST" data-time="1549741827">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-34">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9042758"
         class="attachment patch"
         data-id="9042758" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="1507218-esr60.patch">
      <meta itemprop="contentSize" content="19144">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=9042758">
          <a class="link" href="attachment.cgi?id=9042758&amp;action=diff">
        <span id="att-9042758-description" itemprop="description">Patch without comment - merged to esr-60, uses local config for extra NSS symbols</span></a>
        — <a href="attachment.cgi?id=9042758&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1507218&attachment=9042758">Splinter Review</a>
      </div>
    </div>

  
    <div
        class="comment-text markdown-body "
        id="ct-34" data-comment-id="13914837" data-ismarkdown="true" ><p>This might work.</p>
</div></div><div class="change-set" id="c35"><div class="comment" data-id="13914844" data-no="35"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-35" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a7428859_36541"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a7428859_36541"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-35"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-35" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c35">Comment 35</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-09 11:58 PST" data-time="1549742308">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-35">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-35" data-comment-id="13914844">Comment on <span class=""><a href="/attachment.cgi?id=9042758" name="attach_9042758" title="Patch without comment - merged to esr-60, uses local config for extra NSS symbols">attachment 9042758</a> <a href="/attachment.cgi?id=9042758&amp;action=edit" title="Patch without comment - merged to esr-60, uses local config for extra NSS symbols">[details]</a> <a href="/attachment.cgi?id=9042758&amp;action=diff" title="Patch without comment - merged to esr-60, uses local config for extra NSS symbols">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1507218&amp;attachment=9042758'>[review]</a>
Patch without comment - merged to esr-60, uses local config for extra NSS symbols

Review of <span class=""><a href="/attachment.cgi?id=9042758" name="attach_9042758" title="Patch without comment - merged to esr-60, uses local config for extra NSS symbols">attachment 9042758</a> <a href="/attachment.cgi?id=9042758&amp;action=edit" title="Patch without comment - merged to esr-60, uses local config for extra NSS symbols">[details]</a> <a href="/attachment.cgi?id=9042758&amp;action=diff" title="Patch without comment - merged to esr-60, uses local config for extra NSS symbols">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1507218&amp;attachment=9042758'>[review]</a>:
-----------------------------------------------------------------

::: mail/confvars.sh
&#64;&#64; +45,5 &#64;&#64;
<span class="quote">&gt;  MOZ_ENABLE_SIGNMAR=1
&gt;  
&gt;  MOZ_DEVTOOLS=all
&gt; +
&gt; +NSS_EXTRA_SYMBOLS_FILE=../comm/comm-extra-nss.symbols</span >

How about $commreltopsrcdir/comm-extra-nss.symbols ?</pre></div><div class="change-set" id="c36"><div class="comment" data-id="13914848" data-no="36"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-36" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a7428859_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a7428859_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-36"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-36" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c36">Comment 36</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-09 12:08 PST" data-time="1549742920">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-36">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-36" data-comment-id="13914848" data-ismarkdown="true" ><p>(In reply to Jorg K (GMT+1) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1507218#c35" title="RESOLVED FIXED - Wrong Thunderbird S/MIME signature status shown, if CMS signed data has data content.">comment #35</a>)</p>
<blockquote>
<p>How about $commreltopsrcdir/comm-extra-nss.symbols ?</p>
</blockquote>
<p>Thanks for the suggestion, sounds good. (I&#39;m not up to date on the build time variables.)<br>
If you prefer, we could also use a shorter filename, extra-nss.symbols</p>
</div></div><div class="change-set" id="c37"><div class="comment" data-id="13914854" data-no="37"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-37" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a7428859_36541"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a7428859_36541"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-37"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-37" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c37">Comment 37</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-09 12:12 PST" data-time="1549743174">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-37">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-37" data-comment-id="13914854" data-ismarkdown="true" ><p>I&#39;m not familiar with the build variables either, but I looked for examples in confvars.sh.</p>
</div></div><div class="change-set" id="c38"><div class="comment" data-id="13914856" data-no="38"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-38" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a7428859_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a7428859_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-38"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-38" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c38">Comment 38</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-09 12:15 PST" data-time="1549743352">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-38">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-38" data-comment-id="13914856" data-ismarkdown="true" ><p>It might not work.<br>
The other examples might assume PWD is the top level directory.</p>
<p>At the time the variable is used for loading, the PWD is mozilla/security/<br>
So, we either require an absolute path, or a relative path that will navigate out of the security subdirectory.</p>
<p>My objdir/mozilla-config.h defines it simply as &quot;comm&quot;. I think we need the ../ part in my suggestion.</p>
</div></div><div class="change-set" id="c39"><div class="comment" data-id="13914862" data-no="39"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-39" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a7428859_36541"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a7428859_36541"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-39"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-39" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c39">Comment 39</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-09 12:23 PST" data-time="1549743825">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-39">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-39" data-comment-id="13914862" data-ismarkdown="true" ><p>Umm, what is mozilla/security/? Looks like the old setup where M-C was stored in mozilla/.</p>
</div></div><div class="change-set" id="c40"><div class="comment" data-id="13914866" data-no="40"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-40" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a7428859_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a7428859_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-40"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-40" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c40">Comment 40</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-09 12:28 PST" data-time="1549744110">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-40">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-40" data-comment-id="13914866" data-ismarkdown="true" ><p>I use &quot;mozilla&quot; as a synonym for the toplevel directory of any mozilla tree.</p>
<p>The existing file nss.symbols is located in TOPLEVEL/security/nss.symbols</p>
<p>The comm tree is at TOPLEVEL/comm</p>
<p>We need a relative path from TOPLEVEL/security/nss.symbols to TOPLEVEL/comm,<br>
which is why I used ../comm/ as the prefix for an extra NSS symbols file inside the comm tree.</p>
</div></div><div class="change-set" id="c41"><div class="comment" data-id="13914868" data-no="41"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-41" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a7428859_36541"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a7428859_36541"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-41"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-41" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c41">Comment 41</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-09 12:38 PST" data-time="1549744693">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-41">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-41" data-comment-id="13914868" data-ismarkdown="true" ><p><a href="https://treeherder.mozilla.org/#/jobs?repo=try-comm-central&amp;revision=eb0b62b3628d4fd47a465b84c065bd54dac46a1f" rel="nofollow">https://treeherder.mozilla.org/#/jobs?repo=try-comm-central&amp;revision=eb0b62b3628d4fd47a465b84c065bd54dac46a1f</a></p>
<p>With <a href="https://hg.mozilla.org/try-comm-central/rev/1dd1572e6571a33dd8de173b369198c9210e2077#l2.13" rel="nofollow">https://hg.mozilla.org/try-comm-central/rev/1dd1572e6571a33dd8de173b369198c9210e2077#l2.13</a></p>
<p>Let&#39;s see.</p>
</div></div><div class="change-set" id="c42"><div class="comment" data-id="13914925" data-no="42"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-42" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a7428859_36541"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a7428859_36541"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-42"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-42" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c42">Comment 42</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-09 14:12 PST" data-time="1549750336">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-42">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-42" data-comment-id="13914925" data-ismarkdown="true" ><p><a href="https://hg.mozilla.org/comm-central/rev/32b5054643ac7bfd76a1b93883718f1e86dc55cb" rel="nofollow">https://hg.mozilla.org/comm-central/rev/32b5054643ac7bfd76a1b93883718f1e86dc55cb</a><br>
Don&#39;t use a hardcoded SEC_OID_SHA1 parameter. r=rrelyea</p>
</div></div><div class="change-set" id="c43"><div class="comment" data-id="13914926" data-no="43"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-43" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a7428859_36541"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a7428859_36541"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-43"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-43" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c43">Comment 43</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-09 14:14 PST" data-time="1549750470">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-43">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-43" data-comment-id="13914926" data-ismarkdown="true" ><p>BTW, my ESR 60 suggestion didn&#39;t work, so here&#39;s a try with Kai&#39;s original suggestion:<br>
<a href="https://treeherder.mozilla.org/#/jobs?repo=try-comm-central&amp;revision=bec21e91a896bec6f5dd515ed0a4634b94262012" rel="nofollow">https://treeherder.mozilla.org/#/jobs?repo=try-comm-central&amp;revision=bec21e91a896bec6f5dd515ed0a4634b94262012</a></p>
</div></div><div class="change-set" id="c44"><div class="comment" data-id="13914975" data-no="44"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-44" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a7428859_36541"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a7428859_36541"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-44"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-44" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c44">Comment 44</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-09 16:06 PST" data-time="1549757209">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-44">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-44" data-comment-id="13914975" data-ismarkdown="true" ><p>That worked, so I&#39;m putting together a TB 60.5.1 later today.</p>
</div></div><div class="change-set" id="a7541429_176914"><div class="change" id="aa7541429_176914">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a7541429_176914"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_176914" id="a7541429_176914"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a7541429_176914"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a7541429_176914">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#a7541429_176914">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-09 16:28 PST" data-time="1549758533">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9042758&amp;action=edit"
           title="Patch without comment - merged to esr-60, uses local config for extra NSS symbols"
           class=""
        >Attachment #9042758</a> -
        Flags: approval-comm-esr60+</div></div></div><div class="change-set" id="a7541463_176914"><div class="change" id="aa7541463_176914">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a7541463_176914"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_176914" id="a7541463_176914"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a7541463_176914"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a7541463_176914">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#a7541463_176914">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-09 16:29 PST" data-time="1549758567">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_thunderbird_67&amp;o1=isnotempty">status-thunderbird67</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_thunderbird_67&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">Target Milestone: --- &rarr; Thunderbird 67.0</div></div></div><div class="change-set" id="c45"><div class="comment" data-id="13915620" data-no="45"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-45" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a7541463_176914"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_280903" id="a7541463_176914"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-45"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-45" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c45">Comment 45</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-10 18:48 PST" data-time="1549853334">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-45">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-45" data-comment-id="13915620" data-ismarkdown="true" ><p>(In reply to Jorg K (GMT+1) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1507218#c44" title="RESOLVED FIXED - Wrong Thunderbird S/MIME signature status shown, if CMS signed data has data content.">comment #44</a>)</p>
<blockquote>
<p>That worked, so I&#39;m putting together a TB 60.5.1 later today.</p>
</blockquote>
<p>Is someone writing an advisory for this bug?</p>
</div><div class="activity"><div class="change">Flags: needinfo?(jorgk)</div></div></div><div class="change-set" id="c46"><div class="comment" data-id="13915626" data-no="46"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-46" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_29811" id="a7541463_176914"><img src="https://secure.gravatar.com/avatar/20697ca69672a5276f24a34382a1ddbd?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_29811" id="a7541463_176914"><a class="email " href="/user_profile?user_id=29811" > <span class="fna">Wayne Mery (:wsmwk)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-46"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-46" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c46">Comment 46</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-10 18:55 PST" data-time="1549853704">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-46">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-46" data-comment-id="13915626" data-ismarkdown="true" ><p>redirecting</p>
</div><div class="activity"><div class="change">Flags: needinfo?(kaie)</div></div></div><div class="change-set" id="a7651922_176914"><div class="change" id="aa7651922_176914">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a7651922_176914"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_176914" id="a7651922_176914"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a7651922_176914"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a7651922_176914">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#a7651922_176914">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-10 23:10 PST" data-time="1549869026">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(jorgk)</span></div></div></div><div class="change-set" id="c47"><div class="comment" data-id="13918494" data-no="47"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-47" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a7651922_176914"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a7651922_176914"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-47"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-47" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c47">Comment 47</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-11 08:28 PST" data-time="1549902536">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-47">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-47" data-comment-id="13918494" data-ismarkdown="true" ><p>TB 60.5.1:<br>
<a href="https://hg.mozilla.org/releases/comm-esr60/rev/a251d4246dcb54e4a06c94f63171dbceedd4c82e" rel="nofollow">https://hg.mozilla.org/releases/comm-esr60/rev/a251d4246dcb54e4a06c94f63171dbceedd4c82e</a></p>
</div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_thunderbird_esr60&amp;o1=isnotempty">status-thunderbird_esr60</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_thunderbird_esr60&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_thunderbird_esr60&amp;o1=isnotempty">tracking-thunderbird_esr60</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_thunderbird_esr60&amp;o1=equals&amp;v1=65%2B">65+</a></div></div></div><div class="change-set" id="c48"><div class="comment" data-id="13921932" data-no="48"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-48" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_51884" id="a7651922_176914"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_51884" id="a7651922_176914"><a class="email " href="/user_profile?user_id=51884" > <span class="fna">Frank-Rainer Grahl (:frg)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-48"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-48" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c48">Comment 48</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-12 13:34 PST" data-time="1550007243">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-48">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9043408"
         class="attachment patch"
         data-id="9043408" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="1507218-suiteconfvars.patch">
      <meta itemprop="contentSize" content="639">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=9043408">
          <a class="link" href="attachment.cgi?id=9043408&amp;action=diff">
        <span id="att-9043408-description" itemprop="description">Fix for SeaMonkey link error</span></a>
        — <a href="attachment.cgi?id=9043408&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1507218&attachment=9043408">Splinter Review</a>
      </div>
    </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9043408&amp;action=edit"
           title="Fix for SeaMonkey link error"
           class=""
        >Attachment #9043408</a> -
        Flags: review+</div></div></div><div class="change-set" id="c49"><div class="comment" data-id="13921941" data-no="49"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-49" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_51884" id="a7651922_176914"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_51884" id="a7651922_176914"><a class="email " href="/user_profile?user_id=51884" > <span class="fna">Frank-Rainer Grahl (:frg)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-49"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-49" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c49">Comment 49</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-12 13:36 PST" data-time="1550007411">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-49">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-49" data-comment-id="13921941">Comment on <span class=""><a href="/attachment.cgi?id=9043408" name="attach_9043408" title="Fix for SeaMonkey link error">attachment 9043408</a> <a href="/attachment.cgi?id=9043408&amp;action=edit" title="Fix for SeaMonkey link error">[details]</a> <a href="/attachment.cgi?id=9043408&amp;action=diff" title="Fix for SeaMonkey link error">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1507218&amp;attachment=9043408'>[review]</a>
Fix for SeaMonkey link error

<a rel="nofollow" href="https://hg.mozilla.org/releases/comm-esr60/rev/66fb1b1fc5059bc6069693ca9a2886a10835f51b">https://hg.mozilla.org/releases/comm-esr60/rev/66fb1b1fc5059bc6069693ca9a2886a10835f51b</a></pre></div><div class="change-set" id="c50"><div class="comment" data-id="13923846" data-no="50"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-50" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a7651922_176914"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a7651922_176914"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-50"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-50" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c50">Comment 50</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-13 09:57 PST" data-time="1550080649">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-50">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-50" data-comment-id="13923846" data-ismarkdown="true" ><p>Damian, when crediting you as the reporter of the bug, is it sufficient to mention your full name?</p>
</div></div><div class="change-set" id="c51"><div class="comment" data-id="13923909" data-no="51"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-51" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a7651922_176914"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a7651922_176914"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-51"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-51" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c51">Comment 51</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-13 10:25 PST" data-time="1550082316">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-51">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-51" data-comment-id="13923909" data-ismarkdown="true" ><p>(In reply to Al Billings [:abillings] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1507218#c45" title="RESOLVED FIXED - Wrong Thunderbird S/MIME signature status shown, if CMS signed data has data content.">comment #45</a>)</p>
<blockquote>
<p>Is someone writing an advisory for this bug?</p>
</blockquote>
<p>Draft advisory sent to <a href="mailto:security@m.o" rel="nofollow">security@m.o</a></p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(kaie)</span></div></div></div><div class="change-set" id="c52"><div class="comment" data-id="13925080" data-no="52"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-52" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_628250" id="a7651922_176914"><img src="https://secure.gravatar.com/avatar/4d8090afb6598115b731821b4bf77f7f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_628250" id="a7651922_176914"><a class="email " href="/user_profile?user_id=628250" > <span class="fna">Damian Poddebniak</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-52"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-52" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c52">Comment 52</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-14 00:37 PST" data-time="1550133424">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-52">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-52" data-comment-id="13925080" data-ismarkdown="true" ><p>(In reply to Kai Engert (:kaie:) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1507218#c50" title="RESOLVED FIXED - Wrong Thunderbird S/MIME signature status shown, if CMS signed data has data content.">comment #50</a>)</p>
<blockquote>
<p>Damian, when crediting you as the reporter of the bug, is it sufficient to mention your full name?</p>
</blockquote>
<p>Yes :-)</p>
</div></div><div class="change-set" id="c53"><div class="comment" data-id="13925085" data-no="53"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-53" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a7651922_176914"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a7651922_176914"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-53"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-53" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c53">Comment 53</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-14 00:42 PST" data-time="1550133747">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-53">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-53" data-comment-id="13925085" data-ismarkdown="true" ><p>Damian, FYI, it seems like we&#39;ll release a TB update today with the fix from the bug, with a security advisory that discloses the issue.</p>
</div></div><div class="change-set" id="c54"><div class="comment" data-id="13928336" data-no="54"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-54" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_628250" id="a7651922_176914"><img src="https://secure.gravatar.com/avatar/4d8090afb6598115b731821b4bf77f7f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_628250" id="a7651922_176914"><a class="email " href="/user_profile?user_id=628250" > <span class="fna">Damian Poddebniak</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-54"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-54" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c54">Comment 54</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-15 08:29 PST" data-time="1550248150">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-54">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-54" data-comment-id="13928336" data-ismarkdown="true" ><p>Thank you very much! (Also for discussing this so openly and keeping me up to date.)</p>
</div></div><div class="change-set" id="a8262371_101158"><div class="change" id="aa8262371_101158">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_101158" id="a8262371_101158"><img src="https://secure.gravatar.com/avatar/18eb16a976feb4b40d839c5e9036bc3a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_101158" id="a8262371_101158"><a class="email " href="/user_profile?user_id=101158" > <span class="fna">Magnus Melin [:mkmelin]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a8262371_101158"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a8262371_101158">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#a8262371_101158">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-18 00:44 PST" data-time="1550479475">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - After updating TB from 60.5.0 to 60.5.1, S/MIME signed _and_ encrypted mails received from Outlook clients are marked as &quot;signature is not valid&quot;"
   href="/show_bug.cgi?id=1528615">1528615</a></div></div></div><div class="change-set" id="c55"><div class="comment" data-id="13933970" data-no="55"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-55" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a8262371_101158"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a8262371_101158"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-55"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-55" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#c55">Comment 55</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-19 04:28 PST" data-time="1550579319">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-55">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-55" data-comment-id="13933970" data-ismarkdown="true" ><p>The fix introduced regression <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1528615" title="RESOLVED FIXED - After updating TB from 60.5.0 to 60.5.1, S/MIME signed _and_ encrypted mails received from Outlook clients are marked as &quot;signature is not valid&quot;">bug 1528615</a>.</p>
</div></div><div class="change-set" id="a9132016_36541"><div class="change" id="aa9132016_36541">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a9132016_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_36541" id="a9132016_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a9132016_36541"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a9132016_36541">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#a9132016_36541">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-02-28 02:18 PST" data-time="1551349120">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Status: NEW &rarr; RESOLVED</div><div class="change">Closed: <span class="rel-time" title="2019-02-28 02:18 PST" data-time="1551349120">3 years ago</span></div><div class="change">Resolution: --- &rarr; FIXED</div></div></div><div class="change-set" id="a9499904_75935"><div class="change" id="aa9499904_75935">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a9499904_75935"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_75935" id="a9499904_75935"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a9499904_75935"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a9499904_75935">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#a9499904_75935">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-03-04 08:30 PST" data-time="1551717008">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: mail-core-security &rarr; core-security-release</div></div></div><div class="change-set" id="a54687523_1689"><div class="change" id="aa54687523_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a54687523_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a54687523_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a54687523_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a54687523_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1507218#a54687523_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-08-08 09:37 PDT" data-time="1596904627">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: <span class="activity-deleted">core-security-release</span></div></div></div><div id="new-comment-notice">
          You need to <a href="/show_bug.cgi?id=1507218&amp;GoAheadAndLogIn=1">log in</a>
          before you can comment on or make changes to this bug.
        </div>



<div id="bottom-actions">
  <div id="bottom-right-actions">
    <button type="button" id="top-btn" class="secondary" aria-label="Go to Page Top">Top &uarr;</button>
  </div>
</div></div> 
</main> 
</div> 


</body>
</html>