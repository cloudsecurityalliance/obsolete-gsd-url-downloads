<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
<title>#34141 - Stackoverflow triggered at lib/regexec.c:1948 - GNU bug report logs</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="robots" content="noindex, nofollow">
<link rel="stylesheet" href="/css/bugs.css" type="text/css">

<script type="text/javascript">
function toggle_infmessages()
{
        allDivs=document.getElementsByTagName("div");
        for (var i = 0 ; i < allDivs.length ; i++ )
        {
                if (allDivs[i].className == "infmessage")
                {
                        allDivs[i].style.display=(allDivs[i].style.display == 'none' | allDivs[i].style.display == '') ? 'block' : 'none';
                }
        }
}
</script>
</head>
<body>
<h1>GNU bug report logs - 
#34141<br/>
Stackoverflow triggered at lib/regexec.c:1948</h1>
<p><a href="bugreport.cgi?bug=34140">Previous</a> <a href="bugreport.cgi?bug=34142">Next</a></p>
<div class="versiongraph"></div>
<div class="pkginfo">
  <p>Package:
     <a class="submitter" href="pkgreport.cgi?package=sed">sed</a>;
</p>
</div>

<div class="buginfo">
  <p>Reported by: <a href="pkgreport.cgi?submitter=leftcopy.chx%40gmail.com">Hongxu Chen &lt;leftcopy.chx &lt;at&gt; gmail.com&gt;</a></p>
  <p>Date: Sun, 20 Jan 2019 05:59:01 UTC</p>

<p>Severity: normal</p>
<p></p>




</div>

<p>To reply to this bug, email your comments to 34141 AT debbugs.gnu.org.
<p><a href="javascript:toggle_infmessages();">Toggle</a> the display of automated, internal messages from the tracker.</p><div class="msgreceived"><p>View this report as an <a href="bugreport.cgi?bug=34141;mbox=yes" title="Folder with messages as they arrived at the tracker">mbox folder</a>, <a href="bugreport.cgi?mboxstat=yes;bug=34141" title="Folder with a status summary message at the start">status mbox</a>, <a href="bugreport.cgi?mbox=yes;mboxmaint=yes;bug=34141" title="Folder of messages as sent from the tracker to the maintainers">maintainer mbox</a></p></div>

<div class="infmessage"><hr>
<a name="1"></a>
<!-- request_addr: bug-sed &lt;at&gt; gnu.org -->
<!-- time:1547963941 -->
<strong>Report forwarded</strong>
to <code>bug-sed &lt;at&gt; gnu.org</code>:<br>
<code>bug#34141</code>; Package <code>sed</code>.
 (Sun, 20 Jan 2019 05:59:01 GMT) <a href="bugreport.cgi?bug=34141;msg=2">Full text</a> and <a href="bugreport.cgi?mbox=yes;msg=2;bug=34141">rfc822 format</a> available.</div>

<div class="infmessage"><hr>
<a name="3"></a>
<!-- request_addr: Hongxu Chen &lt;leftcopy.chx &lt;at&gt; gmail.com&gt; -->
<!-- time:1547963941 -->
<strong>Acknowledgement sent</strong>
to <code>Hongxu Chen &lt;leftcopy.chx &lt;at&gt; gmail.com&gt;</code>:<br>
New bug report received and forwarded.  Copy sent to <code>bug-sed &lt;at&gt; gnu.org</code>.
 (Sun, 20 Jan 2019 05:59:01 GMT) <a href="bugreport.cgi?bug=34141;msg=4">Full text</a> and <a href="bugreport.cgi?msg=4;mbox=yes;bug=34141">rfc822 format</a> available.</div>

<hr><p class="msgreceived"><a name="5"></a><a name="msg5"></a><a href="#5">Message #5</a> received at submit &lt;at&gt; debbugs.gnu.org (<a href="bugreport.cgi?bug=34141;msg=5">full text</a>, <a href="bugreport.cgi?bug=34141;mbox=yes;msg=5">mbox</a>):</p>
<pre class="headers">
<b>From:</b> Hongxu Chen &lt;leftcopy.chx &lt;at&gt; gmail.com&gt;
<b>To:</b> bug-sed &lt;at&gt; gnu.org
<b>Subject:</b> Stackoverflow triggered at lib/regexec.c:1948
<b>Date:</b> Sun, 20 Jan 2019 13:58:01 +0800
</pre>
<pre class="mime">[<a href="bugreport.cgi?msg=5;bug=34141;att=0">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message">Hi,

    Latest sed (4.7.4-f8503-dirty; and prior to this, e.g. 4.4) may trigger
a stack overflow error by executing the following command.

    echo 0 | ./sed &#39;/\(\)\(\1\(\)\1\(\)\)*/c0&#39;    # equivalently sed -f
c01.sed c01.in

    ASan reports like this:
AddressSanitizer:DEADLYSIGNAL



=================================================================



==26879==ERROR: AddressSanitizer: stack-overflow on address 0x7ffea609bff8
(pc 0x0000005b0b76 bp 0x7ffea609c090 sp 0x7ffea609bf20 T0)


    #0 0x5b0b75 in check_dst_limits_calc_pos_1
/home/hongxu/FOT/sed-O0/./lib/regexec.c:1912:18


    #1 0x5b0ed3 in check_dst_limits_calc_pos_1
/home/hongxu/FOT/sed-O0/./lib/regexec.c:1948:7


    #2 0x5b0ed3 in check_dst_limits_calc_pos_1
/home/hongxu/FOT/sed-O0/./lib/regexec.c:1948:7


    #3 0x5b0ed3 in check_dst_limits_calc_pos_1
/home/hongxu/FOT/sed-O0/./lib/regexec.c:1948:7


    #4 0x5b0ed3 in check_dst_limits_calc_pos_1
/home/hongxu/FOT/sed-O0/./lib/regexec.c:1948:7


    #5 0x5b0ed3 in check_dst_limits_calc_pos_1
/home/hongxu/FOT/sed-O0/./lib/regexec.c:1948:7


    #6 0x5b0ed3 in check_dst_limits_calc_pos_1
/home/hongxu/FOT/sed-O0/./lib/regexec.c:1948:7


    #7 0x5b0ed3 in check_dst_limits_calc_pos_1
/home/hongxu/FOT/sed-O0/./lib/regexec.c:1948:7
...
    #247 0x5b0ed3 in check_dst_limits_calc_pos_1
/home/hongxu/FOT/sed-O0/./lib/regexec.c:1948:7


    #248 0x5b0ed3 in check_dst_limits_calc_pos_1
/home/hongxu/FOT/sed-O0/./lib/regexec.c:1948:7


    #249 0x5b0ed3 in check_dst_limits_calc_pos_1
/home/hongxu/FOT/sed-O0/./lib/regexec.c:1948:7






SUMMARY: AddressSanitizer: stack-overflow
/home/hongxu/FOT/sed-O0/./lib/regexec.c:1912:18 in
check_dst_limits_calc_pos_1

==26879==ABORTING

Best Regards,
Hongxu
</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=34141;msg=5">Message part 2</a> (text/html, inline)]</pre>
<pre class="mime">[<a href="bugreport.cgi?bug=34141;att=2;filename=c01.in;msg=5">c01.in</a> (application/octet-stream, attachment)]</pre>
<pre class="mime">[<a href="bugreport.cgi?filename=c01.sed;msg=5;bug=34141;att=3">c01.sed</a> (application/octet-stream, attachment)]</pre>
<pre class="mime">[<a href="bugreport.cgi?msg=5;filename=c01.asan;att=4;bug=34141">c01.asan</a> (application/octet-stream, attachment)]</pre>

<div class="infmessage"><hr>
<a name="6"></a>
<!-- request_addr: bug-sed &lt;at&gt; gnu.org -->
<!-- time:1547976121 -->
<strong>Information forwarded</strong>
to <code>bug-sed &lt;at&gt; gnu.org</code>:<br>
<code>bug#34141</code>; Package <code>sed</code>.
 (Sun, 20 Jan 2019 09:22:01 GMT) <a href="bugreport.cgi?msg=7;bug=34141">Full text</a> and <a href="bugreport.cgi?bug=34141;mbox=yes;msg=7">rfc822 format</a> available.</div>

<hr><p class="msgreceived"><a name="8"></a><a name="msg8"></a><a href="#8">Message #8</a> received at 34141 &lt;at&gt; debbugs.gnu.org (<a href="bugreport.cgi?bug=34141;msg=8">full text</a>, <a href="bugreport.cgi?bug=34141;mbox=yes;msg=8">mbox</a>):</p>
<pre class="headers">
<b>From:</b> Assaf Gordon &lt;assafgordon &lt;at&gt; gmail.com&gt;
<b>To:</b> Hongxu Chen &lt;leftcopy.chx &lt;at&gt; gmail.com&gt;, 34141 &lt;at&gt; debbugs.gnu.org,
 &quot;bug-gnulib &lt;at&gt; gnu.org List&quot; &lt;bug-gnulib &lt;at&gt; gnu.org&gt;
<b>Subject:</b> Re: bug#34141: Stackoverflow triggered at lib/regexec.c:1948
<b>Date:</b> Sun, 20 Jan 2019 02:20:57 -0700
</pre>
<pre class="message">(forwarding to gnulib)

Hello,

Hongxu Chen reported a stack-overflow in regexec.
I suspect it is the same as the one reported here:
  <a href="https://lists.gnu.org/r/bug-gnulib/2018-09/msg00066.html">https://lists.gnu.org/r/bug-gnulib/2018-09/msg00066.html</a>

But just in case, the full report is below.

regards,
 - assaf

On 2019-01-19 10:58 p.m., Hongxu Chen wrote:
&gt; Hi,
&gt; 
&gt;      Latest sed (4.7.4-f8503-dirty; and prior to this, e.g. 4.4) may trigger
&gt; a stack overflow error by executing the following command.
&gt; 
&gt;      echo 0 | ./sed &#39;/\(\)\(\1\(\)\1\(\)\)*/c0&#39;    # equivalently sed -f
&gt; c01.sed c01.in
&gt; 
&gt;      ASan reports like this:
&gt; AddressSanitizer:DEADLYSIGNAL
&gt; 
&gt; 
&gt; 
&gt; =================================================================
&gt; 
&gt; 
&gt; 
&gt; ==26879==ERROR: AddressSanitizer: stack-overflow on address 0x7ffea609bff8
&gt; (pc 0x0000005b0b76 bp 0x7ffea609c090 sp 0x7ffea609bf20 T0)
&gt; 
&gt; 
&gt;      #0 0x5b0b75 in check_dst_limits_calc_pos_1
&gt; /home/hongxu/FOT/sed-O0/./lib/regexec.c:1912:18
&gt; 
&gt; 
&gt;      #1 0x5b0ed3 in check_dst_limits_calc_pos_1
&gt; /home/hongxu/FOT/sed-O0/./lib/regexec.c:1948:7
&gt; 
&gt; 
&gt;      #2 0x5b0ed3 in check_dst_limits_calc_pos_1
&gt; /home/hongxu/FOT/sed-O0/./lib/regexec.c:1948:7
&gt; 
&gt; 
&gt;      #3 0x5b0ed3 in check_dst_limits_calc_pos_1
&gt; /home/hongxu/FOT/sed-O0/./lib/regexec.c:1948:7
&gt; 
&gt; 
&gt;      #4 0x5b0ed3 in check_dst_limits_calc_pos_1
&gt; /home/hongxu/FOT/sed-O0/./lib/regexec.c:1948:7
&gt; 
&gt; 
&gt;      #5 0x5b0ed3 in check_dst_limits_calc_pos_1
&gt; /home/hongxu/FOT/sed-O0/./lib/regexec.c:1948:7
&gt; 
&gt; 
&gt;      #6 0x5b0ed3 in check_dst_limits_calc_pos_1
&gt; /home/hongxu/FOT/sed-O0/./lib/regexec.c:1948:7
&gt; 
&gt; 
&gt;      #7 0x5b0ed3 in check_dst_limits_calc_pos_1
&gt; /home/hongxu/FOT/sed-O0/./lib/regexec.c:1948:7
&gt; ...
&gt;      #247 0x5b0ed3 in check_dst_limits_calc_pos_1
&gt; /home/hongxu/FOT/sed-O0/./lib/regexec.c:1948:7
&gt; 
&gt; 
&gt;      #248 0x5b0ed3 in check_dst_limits_calc_pos_1
&gt; /home/hongxu/FOT/sed-O0/./lib/regexec.c:1948:7
&gt; 
&gt; 
&gt;      #249 0x5b0ed3 in check_dst_limits_calc_pos_1
&gt; /home/hongxu/FOT/sed-O0/./lib/regexec.c:1948:7
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; SUMMARY: AddressSanitizer: stack-overflow
&gt; /home/hongxu/FOT/sed-O0/./lib/regexec.c:1912:18 in
&gt; check_dst_limits_calc_pos_1
&gt; 
&gt; ==26879==ABORTING
&gt; 
&gt; Best Regards,
&gt; Hongxu
&gt; 




</pre>

<hr>
<div class="msgreceived">This bug report was last modified 2 years and 284 days ago.</div>

<hr>
<p><a href="bugreport.cgi?bug=34140">Previous</a> <a href="bugreport.cgi?bug=34142">Next</a></p>
<!--
<p class="msgreceived">Send a report that <a href="//debbugs.gnu.org/cgi/bugspam.cgi">this bug log contains spam</a>.</p> -->
<hr>
<P>
<A HREF="//debbugs.gnu.org/">GNU bug tracking system</A><BR>
Copyright (C) 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson.
</ADDRESS>

</body>
</html>
