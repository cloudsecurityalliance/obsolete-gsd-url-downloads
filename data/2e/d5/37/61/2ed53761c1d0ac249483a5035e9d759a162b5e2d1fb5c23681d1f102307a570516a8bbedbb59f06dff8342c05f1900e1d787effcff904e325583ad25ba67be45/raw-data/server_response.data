<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>f5334952131afa835dd3f08601fb3bced7b781cd - platform/frameworks/base - Git at Google</title><link rel="stylesheet" type="text/css" href="/+static/base.css"><!-- default customHeadTagPart --></head><body class="Site"><header class="Site-header"><div class="Header"><a class="Header-image" href="/"><img src="//www.gstatic.com/images/branding/lockups/2x/lockup_git_color_108x24dp.png" width="108" height="24" alt="Google Git"></a><div class="Header-menu"> <a class="Header-menuItem" href="https://accounts.google.com/AccountChooser?service=gerritcodereview&amp;continue=https://android.googlesource.com/login/platform/frameworks/base/%2B/f5334952131afa835dd3f08601fb3bced7b781cd">Sign in</a> </div></div></header><div class="Site-content"><div class="Container "><div class="Breadcrumbs"><a class="Breadcrumbs-crumb" href="/?format=HTML">android</a> / <a class="Breadcrumbs-crumb" href="/platform/">platform</a> / <a class="Breadcrumbs-crumb" href="/platform/frameworks/">frameworks</a> / <a class="Breadcrumbs-crumb" href="/platform/frameworks/base/">base</a> / <span class="Breadcrumbs-crumb">f5334952131afa835dd3f08601fb3bced7b781cd</span></div><div class="u-monospace Metadata"><table><tr><th class="Metadata-title">commit</th><td>f5334952131afa835dd3f08601fb3bced7b781cd</td><td><span>[<a href="/platform/frameworks/base/+log/f5334952131afa835dd3f08601fb3bced7b781cd">log</a>]</span> <span>[<a href="/platform/frameworks/base/+archive/f5334952131afa835dd3f08601fb3bced7b781cd.tar.gz">tgz</a>]</span></td></tr><tr><th class="Metadata-title">author</th><td>Jim Miller &lt;jaggies@google.com&gt;</td><td>Mon Aug 08 20:16:22 2016 -0700</td></tr><tr><th class="Metadata-title">committer</th><td>gitbuildkicker &lt;android-build@google.com&gt;</td><td>Fri Aug 26 10:40:54 2016 -0700</td></tr><tr><th class="Metadata-title">tree</th><td><a href="/platform/frameworks/base/+/f5334952131afa835dd3f08601fb3bced7b781cd/">1e64855b298c247452040d1e4f4796d2289e7a3a</a></td></tr><tr><th class="Metadata-title">parent</th><td><a href="/platform/frameworks/base/+/f5334952131afa835dd3f08601fb3bced7b781cd%5E">96daf7d4893f614714761af2d53dfb93214a32e4</a> <span>[<a href="/platform/frameworks/base/+/f5334952131afa835dd3f08601fb3bced7b781cd%5E%21/">diff</a>]</span></td></tr></table></div><pre class="u-pre u-monospace MetadataMessage">Bind fingerprint when we start authentication

This fixes a bug where it was possible to authenticate the wrong user.
We now bind the userId when we start authentication and confirm it when
authentication completes.

Fixes bug 30744668

(Cherry pick from Change-Id: <a href="https://android-review.googlesource.com/#/q/I346d92c301414ed81e11fa9c171584c7ae4341c2">I346d92c301414ed81e11fa9c171584c7ae4341c2</a>)

Change-Id: <a href="https://android-review.googlesource.com/#/q/I3584790c39eb2e8c435ad1b2d887bf9b8ebd36fe">I3584790c39eb2e8c435ad1b2d887bf9b8ebd36fe</a>
(cherry picked from commit 837d052ed4b5b75dfd4af44f5ad268e683bf2e13)
</pre><ul class="DiffTree"><li><a href="/platform/frameworks/base/+/f5334952131afa835dd3f08601fb3bced7b781cd/core/java/android/hardware/fingerprint/FingerprintManager.java">core/java/android/hardware/fingerprint/FingerprintManager.java</a><span class="DiffTree-action DiffTree-action--modify">[<a href="/platform/frameworks/base/+/f5334952131afa835dd3f08601fb3bced7b781cd%5E%21/#F0">diff</a>]</span></li><li><a href="/platform/frameworks/base/+/f5334952131afa835dd3f08601fb3bced7b781cd/core/java/android/hardware/fingerprint/IFingerprintServiceReceiver.aidl">core/java/android/hardware/fingerprint/IFingerprintServiceReceiver.aidl</a><span class="DiffTree-action DiffTree-action--modify">[<a href="/platform/frameworks/base/+/f5334952131afa835dd3f08601fb3bced7b781cd%5E%21/#F1">diff</a>]</span></li><li><a href="/platform/frameworks/base/+/f5334952131afa835dd3f08601fb3bced7b781cd/packages/Keyguard/src/com/android/keyguard/KeyguardUpdateMonitor.java">packages/Keyguard/src/com/android/keyguard/KeyguardUpdateMonitor.java</a><span class="DiffTree-action DiffTree-action--modify">[<a href="/platform/frameworks/base/+/f5334952131afa835dd3f08601fb3bced7b781cd%5E%21/#F2">diff</a>]</span></li><li><a href="/platform/frameworks/base/+/f5334952131afa835dd3f08601fb3bced7b781cd/services/core/java/com/android/server/fingerprint/AuthenticationClient.java">services/core/java/com/android/server/fingerprint/AuthenticationClient.java</a><span class="DiffTree-action DiffTree-action--modify">[<a href="/platform/frameworks/base/+/f5334952131afa835dd3f08601fb3bced7b781cd%5E%21/#F3">diff</a>]</span></li><li><a href="/platform/frameworks/base/+/f5334952131afa835dd3f08601fb3bced7b781cd/services/core/java/com/android/server/fingerprint/FingerprintService.java">services/core/java/com/android/server/fingerprint/FingerprintService.java</a><span class="DiffTree-action DiffTree-action--modify">[<a href="/platform/frameworks/base/+/f5334952131afa835dd3f08601fb3bced7b781cd%5E%21/#F4">diff</a>]</span></li></ul><div class="DiffSummary">5 files changed</div><div class="TreeDetail"><div class="u-sha1 u-monospace TreeDetail-sha1">tree: 1e64855b298c247452040d1e4f4796d2289e7a3a</div><ol class="FileList"><li class="FileList-item FileList-item--regularFile" title="Regular file - Android.mk"><a class="FileList-itemLink" href="/platform/frameworks/base/+/f5334952131afa835dd3f08601fb3bced7b781cd/Android.mk">Android.mk</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - CleanSpec.mk"><a class="FileList-itemLink" href="/platform/frameworks/base/+/f5334952131afa835dd3f08601fb3bced7b781cd/CleanSpec.mk">CleanSpec.mk</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - MODULE_LICENSE_APACHE2"><a class="FileList-itemLink" href="/platform/frameworks/base/+/f5334952131afa835dd3f08601fb3bced7b781cd/MODULE_LICENSE_APACHE2">MODULE_LICENSE_APACHE2</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - NOTICE"><a class="FileList-itemLink" href="/platform/frameworks/base/+/f5334952131afa835dd3f08601fb3bced7b781cd/NOTICE">NOTICE</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - api/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/f5334952131afa835dd3f08601fb3bced7b781cd/api/">api/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - cmds/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/f5334952131afa835dd3f08601fb3bced7b781cd/cmds/">cmds/</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - compiled-classes-phone"><a class="FileList-itemLink" href="/platform/frameworks/base/+/f5334952131afa835dd3f08601fb3bced7b781cd/compiled-classes-phone">compiled-classes-phone</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - core/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/f5334952131afa835dd3f08601fb3bced7b781cd/core/">core/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - data/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/f5334952131afa835dd3f08601fb3bced7b781cd/data/">data/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - docs/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/f5334952131afa835dd3f08601fb3bced7b781cd/docs/">docs/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - drm/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/f5334952131afa835dd3f08601fb3bced7b781cd/drm/">drm/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - graphics/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/f5334952131afa835dd3f08601fb3bced7b781cd/graphics/">graphics/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - include/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/f5334952131afa835dd3f08601fb3bced7b781cd/include/">include/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - keystore/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/f5334952131afa835dd3f08601fb3bced7b781cd/keystore/">keystore/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - libs/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/f5334952131afa835dd3f08601fb3bced7b781cd/libs/">libs/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - location/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/f5334952131afa835dd3f08601fb3bced7b781cd/location/">location/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - media/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/f5334952131afa835dd3f08601fb3bced7b781cd/media/">media/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - native/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/f5334952131afa835dd3f08601fb3bced7b781cd/native/">native/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - nfc-extras/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/f5334952131afa835dd3f08601fb3bced7b781cd/nfc-extras/">nfc-extras/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - obex/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/f5334952131afa835dd3f08601fb3bced7b781cd/obex/">obex/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - opengl/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/f5334952131afa835dd3f08601fb3bced7b781cd/opengl/">opengl/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - packages/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/f5334952131afa835dd3f08601fb3bced7b781cd/packages/">packages/</a></li><li class="FileList-item FileList-item--regularFile" title="Regular file - preloaded-classes"><a class="FileList-itemLink" href="/platform/frameworks/base/+/f5334952131afa835dd3f08601fb3bced7b781cd/preloaded-classes">preloaded-classes</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - proto/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/f5334952131afa835dd3f08601fb3bced7b781cd/proto/">proto/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - rs/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/f5334952131afa835dd3f08601fb3bced7b781cd/rs/">rs/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - samples/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/f5334952131afa835dd3f08601fb3bced7b781cd/samples/">samples/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - sax/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/f5334952131afa835dd3f08601fb3bced7b781cd/sax/">sax/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - services/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/f5334952131afa835dd3f08601fb3bced7b781cd/services/">services/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - telecomm/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/f5334952131afa835dd3f08601fb3bced7b781cd/telecomm/">telecomm/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - telephony/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/f5334952131afa835dd3f08601fb3bced7b781cd/telephony/">telephony/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - test-runner/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/f5334952131afa835dd3f08601fb3bced7b781cd/test-runner/">test-runner/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - tests/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/f5334952131afa835dd3f08601fb3bced7b781cd/tests/">tests/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - tools/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/f5334952131afa835dd3f08601fb3bced7b781cd/tools/">tools/</a></li><li class="FileList-item FileList-item--gitTree" title="Tree - wifi/"><a class="FileList-itemLink" href="/platform/frameworks/base/+/f5334952131afa835dd3f08601fb3bced7b781cd/wifi/">wifi/</a></li></ol></div></div> <!-- Container --></div> <!-- Site-content --><footer class="Site-footer"><div class="Footer"><span class="Footer-poweredBy">Powered by <a href="https://gerrit.googlesource.com/gitiles/">Gitiles</a>| <a href="https://policies.google.com/privacy">Privacy</a></span><span class="Footer-formats"><a class="u-monospace Footer-formatsItem" href="?format=TEXT">txt</a> <a class="u-monospace Footer-formatsItem" href="?format=JSON">json</a></span></div></footer></body></html>