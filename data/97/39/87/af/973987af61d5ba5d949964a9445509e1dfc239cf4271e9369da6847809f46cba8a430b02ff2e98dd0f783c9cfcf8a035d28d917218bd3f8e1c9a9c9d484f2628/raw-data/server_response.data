<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
<link rel="icon" href="/favicon.png">
<title>#942578 - imagemagick: CVE-2019-17540: heap-based buffer overflow in ReadPSInfo in coders/ps.c - Debian Bug report logs</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="/css/bugs.css" type="text/css">

<link rel="canonical" href="&lt;a href=&quot;bugreport.cgi?bug=942578&quot;&gt;942578&lt;/a&gt;">
<script type="text/javascript">
<!--
function toggle_infmessages()
{
        allDivs=document.getElementsByTagName("div");
        for (var i = 0 ; i < allDivs.length ; i++ )
        {
                if (allDivs[i].className == "infmessage")
                {
                        allDivs[i].style.display=(allDivs[i].style.display == 'none' | allDivs[i].style.display == '') ? 'block' : 'none';
                }
        }
}
-->
</script>
</head>
<body>
<h1>Debian Bug report logs - 
<a href="mailto:942578@bugs.debian.org">#942578</a><br>
imagemagick: CVE-2019-17540: heap-based buffer overflow in ReadPSInfo in coders/ps.c</h1>
<div class="versiongraph"><a href="version.cgi?package=src%3Aimagemagick;info=1;absolute=0;found=imagemagick%2F8%3A6.9.10.23%2Bdfsg-2.1;collapse=1"><img alt="version graph" src="version.cgi?absolute=0;package=src%3Aimagemagick;height=2;width=2;collapse=1;found=imagemagick%2F8%3A6.9.10.23%2Bdfsg-2.1"></a></div>
<div class="pkginfo">
  <p>Package:
     <a class="submitter" href="pkgreport.cgi?src=imagemagick">src:imagemagick</a>;
Maintainer for <a href="pkgreport.cgi?src=imagemagick">src:imagemagick</a> is <a href="pkgreport.cgi?maint=pkg-gmagick-im-team%40lists.alioth.debian.org">ImageMagick Packaging Team &lt;pkg-gmagick-im-team@lists.alioth.debian.org&gt;</a>; </p>

</div>

<div class="buginfo">
  <p>Reported by: <a href="pkgreport.cgi?submitter=hle%40debian.org">Hugo Lefeuvre &lt;hle@debian.org&gt;</a></p>
  <p>Date: Fri, 18 Oct 2019 12:33:02 UTC</p>

<p>Severity: important</p>
<p>Tags: security, upstream</p>

<p>Found in version imagemagick/8:6.9.10.23+dfsg-2.1</p>

<p><strong>Done:</strong> Hugo Lefeuvre &lt;hle@debian.org&gt;</p>

<p>Bug is archived. No further changes may be made.<p></div>

<p><a href="javascript:toggle_infmessages();">Toggle useless messages</a></p><div class="msgreceived"><p>View this report as an <a href="bugreport.cgi?bug=942578;mbox=yes">mbox folder</a>, <a href="bugreport.cgi?bug=942578;mbox=yes;mboxstatus=yes">status mbox</a>, <a href="bugreport.cgi?bug=942578;mbox=yes;mboxmaint=yes">maintainer mbox</a></p></div>

<div class="infmessage"><hr><p>
<a name="1"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, team@security.debian.org, ImageMagick Packaging Team &lt;pkg-gmagick-im-team@lists.alioth.debian.org&gt; -->
<!-- time:1571401984 -->
<strong>Report forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, team@security.debian.org, ImageMagick Packaging Team &lt;pkg-gmagick-im-team@lists.alioth.debian.org&gt;</code>:<br>
<code>Bug#942578</code>; Package <code>src:imagemagick</code>.
 (Fri, 18 Oct 2019 12:33:04 GMT) (<a href="bugreport.cgi?bug=942578;msg=2">full text</a>, <a href="bugreport.cgi?bug=942578;mbox=yes;msg=2">mbox</a>, <a href="#1">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="3"></a>
<!-- request_addr: Hugo Lefeuvre &lt;hle@debian.org&gt; -->
<!-- time:1571401984 -->
<strong>Acknowledgement sent</strong>
to <code>Hugo Lefeuvre &lt;hle@debian.org&gt;</code>:<br>
New Bug report received and forwarded.  Copy sent to <code>team@security.debian.org, ImageMagick Packaging Team &lt;pkg-gmagick-im-team@lists.alioth.debian.org&gt;</code>.
 (Fri, 18 Oct 2019 12:33:04 GMT) (<a href="bugreport.cgi?bug=942578;msg=4">full text</a>, <a href="bugreport.cgi?bug=942578;mbox=yes;msg=4">mbox</a>, <a href="#3">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="5"></a><a name="msg5"></a><a href="#5">Message #5</a> received at submit@bugs.debian.org (<a href="bugreport.cgi?bug=942578;msg=5">full text</a>, <a href="bugreport.cgi?bug=942578;mbox=yes;msg=5">mbox</a>, <a href="mailto:942578@bugs.debian.org?body=On%20Fri%2C%2018%20Oct%202019%2014%3A31%3A15%20%2B0200%20Hugo%20Lefeuvre%20%3Chle%40debian.org%3E%20wrote%3A%0A%3E%20Source%3A%20imagemagick%0A%3E%20Version%3A%208%3A6.9.10.23%2Bdfsg-2.1%0A%3E%20Severity%3A%20important%0A%3E%20%0A%3E%20Hi%2C%0A%3E%20%0A%3E%20imagemagick%20is%20affected%20by%20CVE-2019-17540%2C%20a%20heap-based%20buffer%20overflow%20in%0A%3E%20ReadPSInfo%20in%20coders%2Fps.c.%0A%3E%20%0A%3E%20There%20are%20very%20few%20information%20online%20regarding%20this%20vulnerability.%20I%20had%20a%0A%3E%20look%20and%20found%20the%20following%20four%20commits%3A%0A%3E%20%0A%3E%20https%3A%2F%2Fgithub.com%2FImageMagick%2FImageMagick%2Fcommit%2F668d6a970553a94b0a2e378afda1d37abac94b5c%0A%3E%20https%3A%2F%2Fgithub.com%2FImageMagick%2FImageMagick%2Fcommit%2F9667a9034a5eeedb30dfb18cfd1083ff32fd679b%0A%3E%20https%3A%2F%2Fgithub.com%2FImageMagick%2FImageMagick%2Fcommit%2F73dd03cfb57f8f8c0a732fa062b9966ec7bf2f91%0A%3E%20https%3A%2F%2Fgithub.com%2FImageMagick%2FImageMagick%2Fcommit%2Fe868e227085463932c5db32e5e0f27e306a0eb95%0A%3E%20%0A%3E%20this%20looks%20like%20what%20we%20are%20searching%20for%3B%20a%20buffer%20overflow%20WRITE%20of%20size%0A%3E%201%20in%20ReadPSInfo.%20I%20will%20contact%20Dirk%20Lemstra%20and%20ask%20for%20more%20information.%0A%3E%20%0A%3E%20regards%2C%0A%3E%20Hugo%0A%3E%20%0A%3E%20%5B0%5D%20https%3A%2F%2Fsecurity-tracker.debian.org%2Ftracker%2FCVE-2019-17540%0A%3E%20%0A%3E%20--%20%0A%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Hugo%20Lefeuvre%20%28hle%29%20%20%20%20%7C%20%20%20%20www.owl.eu.com%0A%3E%20RSA4096_%20360B%2003B3%20BF27%204F4D%207A3F%20D5E8%2014AA%201EB8%20A247%203DFD%0A%3E%20ed25519_%2037B2%206D38%200B25%20B8A2%206B9F%203A65%20A36F%205357%205F2D%20DC4C%0A%3E%20%0A&amp;subject=Re%3A%20imagemagick%3A%20CVE-2019-17540%3A%20heap-based%20buffer%20overflow%20in%0A%20ReadPSInfo%20in%20coders%2Fps.c&amp;In-Reply-To=%3C20191018123115.knxcwvcno3eji3te%40behemoth.owl.eu.com.local%3E&amp;References=%3C20191018123115.knxcwvcno3eji3te%40behemoth.owl.eu.com.local%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=hle%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Hugo Lefeuvre &lt;hle@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> submit@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> imagemagick: CVE-2019-17540: heap-based buffer overflow in
 ReadPSInfo in coders/ps.c</div>
<div class="header"><span class="headerfield">Date:</span> Fri, 18 Oct 2019 14:31:15 +0200</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=0;bug=942578;msg=5">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message">Source: imagemagick
Version: 8:6.9.10.23+dfsg-2.1
Severity: important

Hi,

imagemagick is affected by <a href="https://security-tracker.debian.org/tracker/CVE-2019-17540">CVE-2019-17540</a>, a heap-based buffer overflow in
ReadPSInfo in coders/ps.c.

There are very few information online regarding this vulnerability. I had a
look and found the following four commits:

<a href="https://github.com/ImageMagick/ImageMagick/commit/668d6a970553a94b0a2e378afda1d37abac94b5c">https://github.com/ImageMagick/ImageMagick/commit/668d6a970553a94b0a2e378afda1d37abac94b5c</a>
<a href="https://github.com/ImageMagick/ImageMagick/commit/9667a9034a5eeedb30dfb18cfd1083ff32fd679b">https://github.com/ImageMagick/ImageMagick/commit/9667a9034a5eeedb30dfb18cfd1083ff32fd679b</a>
<a href="https://github.com/ImageMagick/ImageMagick/commit/73dd03cfb57f8f8c0a732fa062b9966ec7bf2f91">https://github.com/ImageMagick/ImageMagick/commit/73dd03cfb57f8f8c0a732fa062b9966ec7bf2f91</a>
<a href="https://github.com/ImageMagick/ImageMagick/commit/e868e227085463932c5db32e5e0f27e306a0eb95">https://github.com/ImageMagick/ImageMagick/commit/e868e227085463932c5db32e5e0f27e306a0eb95</a>

this looks like what we are searching for; a buffer overflow WRITE of size
1 in ReadPSInfo. I will contact Dirk Lemstra and ask for more information.

regards,
Hugo

[0] <a href="https://security-tracker.debian.org/tracker/CVE-2019-17540">https://security-tracker.debian.org/tracker/CVE-2019-17540</a>

-- 
                Hugo Lefeuvre (hle)    |    www.owl.eu.com
RSA4096_ 360B 03B3 BF27 4F4D 7A3F D5E8 14AA 1EB8 A247 3DFD
ed25519_ 37B2 6D38 0B25 B8A2 6B9F 3A65 A36F 5357 5F2D DC4C

</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=942578;filename=signature.asc;msg=5">signature.asc</a> (application/pgp-signature, inline)]</pre>

<div class="infmessage"><hr><p>
<a name="6"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, ImageMagick Packaging Team &lt;pkg-gmagick-im-team@lists.alioth.debian.org&gt; -->
<!-- time:1571417294 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, ImageMagick Packaging Team &lt;pkg-gmagick-im-team@lists.alioth.debian.org&gt;</code>:<br>
<code>Bug#942578</code>; Package <code>src:imagemagick</code>.
 (Fri, 18 Oct 2019 16:48:14 GMT) (<a href="bugreport.cgi?bug=942578;msg=7">full text</a>, <a href="bugreport.cgi?bug=942578;mbox=yes;msg=7">mbox</a>, <a href="#6">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="8"></a>
<!-- request_addr: Hugo Lefeuvre &lt;hle@debian.org&gt; -->
<!-- time:1571417294 -->
<strong>Acknowledgement sent</strong>
to <code>Hugo Lefeuvre &lt;hle@debian.org&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>ImageMagick Packaging Team &lt;pkg-gmagick-im-team@lists.alioth.debian.org&gt;</code>.
 (Fri, 18 Oct 2019 16:48:14 GMT) (<a href="bugreport.cgi?bug=942578;msg=9">full text</a>, <a href="bugreport.cgi?bug=942578;mbox=yes;msg=9">mbox</a>, <a href="#8">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="10"></a><a name="msg10"></a><a href="#10">Message #10</a> received at 942578@bugs.debian.org (<a href="bugreport.cgi?bug=942578;msg=10">full text</a>, <a href="bugreport.cgi?bug=942578;mbox=yes;msg=10">mbox</a>, <a href="mailto:942578@bugs.debian.org?In-Reply-To=%3C20191018164316.47kq7pagcvrfdxgj%40behemoth.owl.eu.com.local%3E&amp;References=%3C20191018164316.47kq7pagcvrfdxgj%40behemoth.owl.eu.com.local%3E&amp;subject=Re%3A%20CVE-2019-17540%3A%20heap-based%20buffer%20overflow%20in%20ReadPSInfo%20in%0A%20coders%2Fps.c&amp;body=On%20Fri%2C%2018%20Oct%202019%2018%3A43%3A16%20%2B0200%20Hugo%20Lefeuvre%20%3Chle%40debian.org%3E%20wrote%3A%0A%3E%20FTR%3A%20Dirk%20Lemstra%20confirmed%20that%20those%20four%20commits%20correspond%20to%20the%20fixes%0A%3E%20for%20CVE-2019-17540.%0A%3E%20%0A%3E%20--%20%0A%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Hugo%20Lefeuvre%20%28hle%29%20%20%20%20%7C%20%20%20%20www.owl.eu.com%0A%3E%20RSA4096_%20360B%2003B3%20BF27%204F4D%207A3F%20D5E8%2014AA%201EB8%20A247%203DFD%0A%3E%20ed25519_%2037B2%206D38%200B25%20B8A2%206B9F%203A65%20A36F%205357%205F2D%20DC4C%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=hle%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Hugo Lefeuvre &lt;hle@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> 942578@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: CVE-2019-17540: heap-based buffer overflow in ReadPSInfo in
 coders/ps.c</div>
<div class="header"><span class="headerfield">Date:</span> Fri, 18 Oct 2019 18:43:16 +0200</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=0;bug=942578;msg=10">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message">FTR: Dirk Lemstra confirmed that those four commits correspond to the fixes
for <a href="https://security-tracker.debian.org/tracker/CVE-2019-17540">CVE-2019-17540</a>.

-- 
                Hugo Lefeuvre (hle)    |    www.owl.eu.com
RSA4096_ 360B 03B3 BF27 4F4D 7A3F D5E8 14AA 1EB8 A247 3DFD
ed25519_ 37B2 6D38 0B25 B8A2 6B9F 3A65 A36F 5357 5F2D DC4C
</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=942578;filename=signature.asc;msg=10">signature.asc</a> (application/pgp-signature, inline)]</pre>

<div class="msgreceived"><hr><p>
<a name="11"></a>
<!-- command:tag -->
<!-- requester: Salvatore Bonaccorso &lt;carnil@debian.org&gt; -->
<!-- request_addr: control@bugs.debian.org -->
<!-- time:1571425383 -->
<!-- new_data:
$new_data = {
              &#39;keywords&#39; =&gt; &#39;upstream security&#39;
            };
-->
<!-- old_data:
$old_data = {
              &#39;keywords&#39; =&gt; &#39;&#39;
            };
-->
<strong>Added tag(s) security and upstream.</strong>
Request was from <code>Salvatore Bonaccorso &lt;carnil@debian.org&gt;</code>
to <code>control@bugs.debian.org</code>.
 (Fri, 18 Oct 2019 19:03:03 GMT) (<a href="bugreport.cgi?bug=942578;msg=12">full text</a>, <a href="bugreport.cgi?bug=942578;mbox=yes;msg=12">mbox</a>, <a href="#11">link</a>).</p></p></div>

<div class="msgreceived"><hr><p>
<a name="13"></a>
<!-- request_addr: Hugo Lefeuvre &lt;hle@debian.org&gt; -->
<!-- time:1571647513 -->
<strong>Reply sent</strong>
to <code>Hugo Lefeuvre &lt;hle@debian.org&gt;</code>:<br>
You have taken responsibility.
 (Mon, 21 Oct 2019 08:45:13 GMT) (<a href="bugreport.cgi?bug=942578;msg=14">full text</a>, <a href="bugreport.cgi?bug=942578;mbox=yes;msg=14">mbox</a>, <a href="#13">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="15"></a>
<!-- request_addr: Hugo Lefeuvre &lt;hle@debian.org&gt; -->
<!-- time:1571647514 -->
<strong>Notification sent</strong>
to <code>Hugo Lefeuvre &lt;hle@debian.org&gt;</code>:<br>
Bug acknowledged by developer.
 (Mon, 21 Oct 2019 08:45:14 GMT) (<a href="bugreport.cgi?bug=942578;msg=16">full text</a>, <a href="bugreport.cgi?bug=942578;mbox=yes;msg=16">mbox</a>, <a href="#15">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="17"></a><a name="msg17"></a><a href="#17">Message #17</a> received at 942578-done@bugs.debian.org (<a href="bugreport.cgi?bug=942578;msg=17">full text</a>, <a href="bugreport.cgi?bug=942578;mbox=yes;msg=17">mbox</a>, <a href="mailto:942578@bugs.debian.org?body=On%20Mon%2C%2021%20Oct%202019%2010%3A31%3A11%20%2B0200%20Hugo%20Lefeuvre%20%3Chle%40debian.org%3E%20wrote%3A%0A%3E%20Hi%2C%0A%3E%20%0A%3E%20after%20further%20investigation%2C%20it%20appears%20that%20no%20Debian%20release%20is%20affected%0A%3E%20by%20this%20issue.%20The%20vulnerable%20code%20was%20introduced%20after%206.9.10-54%20and%20fixed%0A%3E%20a%20few%20days%20later.%0A%3E%20%0A%3E%20For%20more%20information%2C%20please%20see%0A%3E%20%0A%3E%20https%3A%2F%2Fsecurity-tracker.debian.org%2Ftracker%2FCVE-2019-17540%0A%3E%20%0A%3E%20regards%2C%0A%3E%20Hugo%0A%3E%20%0A%3E%20--%20%0A%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Hugo%20Lefeuvre%20%28hle%29%20%20%20%20%7C%20%20%20%20www.owl.eu.com%0A%3E%20RSA4096_%20360B%2003B3%20BF27%204F4D%207A3F%20D5E8%2014AA%201EB8%20A247%203DFD%0A%3E%20ed25519_%2037B2%206D38%200B25%20B8A2%206B9F%203A65%20A36F%205357%205F2D%20DC4C%0A&amp;References=%3C20191021083111.jtffcdxuwh6wsdco%40behemoth.owl.eu.com.local%3E&amp;In-Reply-To=%3C20191021083111.jtffcdxuwh6wsdco%40behemoth.owl.eu.com.local%3E&amp;subject=Re%3A%20CVE-2019-17540%3A%20no%20Debian%20release%20affected">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=hle%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Hugo Lefeuvre &lt;hle@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> 942578-done@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> CVE-2019-17540: no Debian release affected</div>
<div class="header"><span class="headerfield">Date:</span> Mon, 21 Oct 2019 10:31:11 +0200</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=0;bug=942578;msg=17">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message">Hi,

after further investigation, it appears that no Debian release is affected
by this issue. The vulnerable code was introduced after 6.9.10-54 and fixed
a few days later.

For more information, please see

<a href="https://security-tracker.debian.org/tracker/CVE-2019-17540">https://security-tracker.debian.org/tracker/CVE-2019-17540</a>

regards,
Hugo

-- 
                Hugo Lefeuvre (hle)    |    www.owl.eu.com
RSA4096_ 360B 03B3 BF27 4F4D 7A3F D5E8 14AA 1EB8 A247 3DFD
ed25519_ 37B2 6D38 0B25 B8A2 6B9F 3A65 A36F 5357 5F2D DC4C
</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=942578;filename=signature.asc;msg=17">signature.asc</a> (application/pgp-signature, inline)]</pre>

<div class="msgreceived"><hr><p>
<a name="18"></a>
<!-- command:archive -->
<!-- requester: Debbugs Internal Request &lt;owner@bugs.debian.org&gt; -->
<!-- request_addr: internal_control@bugs.debian.org -->
<!-- time:1574148514 -->
<!-- new_data:
$new_data = {};
-->
<!-- old_data:
$old_data = {};
-->
<strong>Bug archived.</strong>
Request was from <code>Debbugs Internal Request &lt;owner@bugs.debian.org&gt;</code>
to <code>internal_control@bugs.debian.org</code>.
 (Tue, 19 Nov 2019 07:28:34 GMT) (<a href="bugreport.cgi?bug=942578;msg=19">full text</a>, <a href="bugreport.cgi?bug=942578;mbox=yes;msg=19">mbox</a>, <a href="#18">link</a>).</p></p></div>

<hr>
<p class="msgreceived">Send a report that <a href="https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=942578">this bug log contains spam</a>.</p>
<hr>
<ADDRESS>Debian bug tracking system administrator &lt;<A HREF="mailto:owner@bugs.debian.org">owner@bugs.debian.org</A>&gt;.
Last modified:
<!--timestamp-->Sat Oct 30 18:36:08 2021<!--end timestamp-->; 
Machine Name:
<!--machinename-->buxtehude<!--machinename-->
<P>
<A HREF="https://www.debian.org/Bugs/">Debian Bug tracking system</A>
</p>
<p>
  Debbugs is free software and licensed under the terms of the GNU
  Public License version 2. The current version can be obtained
  from <a href="https://bugs.debian.org/debbugs-source/">https://bugs.debian.org/debbugs-source/</a>.
</p>
<p>
Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.
</p>
</ADDRESS>

</body>
</html>
