<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
<link rel="icon" href="/favicon.png">
<title>#639151 - Local privilege escalation - Debian Bug report logs</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="/css/bugs.css" type="text/css">

<link rel="canonical" href="&lt;a href=&quot;bugreport.cgi?bug=639151&quot;&gt;639151&lt;/a&gt;">
<script type="text/javascript">
<!--
function toggle_infmessages()
{
        allDivs=document.getElementsByTagName("div");
        for (var i = 0 ; i < allDivs.length ; i++ )
        {
                if (allDivs[i].className == "infmessage")
                {
                        allDivs[i].style.display=(allDivs[i].style.display == 'none' | allDivs[i].style.display == '') ? 'block' : 'none';
                }
        }
}
-->
</script>
</head>
<body>
<h1>Debian Bug report logs - 
<a href="mailto:639151@bugs.debian.org">#639151</a><br>
Local privilege escalation</h1>
<div class="versiongraph"><a href="version.cgi?collapse=1;absolute=0;info=1;fixed=lightdm%2F0.9.6-1;package=lightdm"><img alt="version graph" src="version.cgi?fixed=lightdm%2F0.9.6-1;height=2;absolute=0;collapse=1;package=lightdm;width=2"></a></div>
<div class="pkginfo">
  <p>Package:
     <a class="submitter" href="pkgreport.cgi?package=lightdm">lightdm</a>;
Maintainer for <a href="pkgreport.cgi?package=lightdm">lightdm</a> is <a href="pkgreport.cgi?maint=debian-xfce%40lists.debian.org">Debian Xfce Maintainers &lt;debian-xfce@lists.debian.org&gt;</a>; Source for <a href="pkgreport.cgi?package=lightdm">lightdm</a> is <a href="pkgreport.cgi?src=lightdm">src:lightdm</a> (<a href="https://tracker.debian.org/pkg/lightdm">PTS</a>, <a href="https://buildd.debian.org/lightdm">buildd</a>, <a href="https://qa.debian.org/popcon.php?package=lightdm">popcon</a>). </p>

</div>

<div class="buginfo">
  <p>Reported by: <a href="pkgreport.cgi?submitter=jmm%40debian.org">Moritz Muehlenhoff &lt;jmm@debian.org&gt;</a></p>
  <p>Date: Wed, 24 Aug 2011 16:36:04 UTC</p>

<p>Severity: <em class="severity">grave</em></p>
<p>Tags: security</p>

<p>Fixed in version lightdm/0.9.6-1</p>

<p><strong>Done:</strong> Yves-Alexis Perez &lt;corsac@debian.org&gt;</p>

<p>Bug is archived. No further changes may be made.<p><p>Forwarded to <a href="https://bugs.launchpad.net/debian/+source/lightdm/+bug/834079">https://bugs.launchpad.net/debian/+source/lightdm/+bug/834079</a></p>
</div>

<p><a href="javascript:toggle_infmessages();">Toggle useless messages</a></p><div class="msgreceived"><p>View this report as an <a href="bugreport.cgi?bug=639151;mbox=yes">mbox folder</a>, <a href="bugreport.cgi?bug=639151;mbox=yes;mboxstatus=yes">status mbox</a>, <a href="bugreport.cgi?bug=639151;mbox=yes;mboxmaint=yes">maintainer mbox</a></p></div>

<div class="infmessage"><hr><p>
<a name="1"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, team@security.debian.org, secure-testing-team@lists.alioth.debian.org, Debian Xfce Maintainers &lt;pkg-xfce-devel@lists.alioth.debian.org&gt; -->
<!-- time:1314203767 -->
<strong>Report forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, team@security.debian.org, secure-testing-team@lists.alioth.debian.org, Debian Xfce Maintainers &lt;pkg-xfce-devel@lists.alioth.debian.org&gt;</code>:<br>
<code>Bug#639151</code>; Package <code>lightdm</code>.
 (Wed, 24 Aug 2011 16:36:07 GMT) (<a href="bugreport.cgi?bug=639151;msg=2">full text</a>, <a href="bugreport.cgi?bug=639151;mbox=yes;msg=2">mbox</a>, <a href="#1">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="3"></a>
<!-- request_addr: Moritz Muehlenhoff &lt;jmm@debian.org&gt; -->
<!-- time:1314203767 -->
<strong>Acknowledgement sent</strong>
to <code>Moritz Muehlenhoff &lt;jmm@debian.org&gt;</code>:<br>
New Bug report received and forwarded.  Copy sent to <code>team@security.debian.org, secure-testing-team@lists.alioth.debian.org, Debian Xfce Maintainers &lt;pkg-xfce-devel@lists.alioth.debian.org&gt;</code>.
 (Wed, 24 Aug 2011 16:36:07 GMT) (<a href="bugreport.cgi?bug=639151;msg=4">full text</a>, <a href="bugreport.cgi?bug=639151;mbox=yes;msg=4">mbox</a>, <a href="#3">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="5"></a><a name="msg5"></a><a href="#5">Message #5</a> received at submit@bugs.debian.org (<a href="bugreport.cgi?bug=639151;msg=5">full text</a>, <a href="bugreport.cgi?bug=639151;mbox=yes;msg=5">mbox</a>, <a href="mailto:639151@bugs.debian.org?References=%3C20110824163345.3764.96701.reportbug%40pisco.westfalen.local%3E&amp;In-Reply-To=%3C20110824163345.3764.96701.reportbug%40pisco.westfalen.local%3E&amp;body=On%20Wed%2C%2024%20Aug%202011%2018%3A33%3A45%20%2B0200%20Moritz%20Muehlenhoff%20%3Cjmm%40debian.org%3E%20wrote%3A%0A%3E%20Package%3A%20lightdm%0A%3E%20Severity%3A%20grave%0A%3E%20Tags%3A%20security%0A%3E%20%0A%3E%20Sebastian%20Kramer%20posted%20the%20following%20to%20oss-security%3A%0A%3E%20%0A%3E%20---%0A%3E%20%0A%3E%20From%3A%20Sebastian%20Krahmer%20%3Ckrahmer%40suse.de%3E%0A%3E%20To%3A%20oss-security%40lists.openwall.com%0A%3E%20Cc%3A%20robert.ancell%40canonical.com%0A%3E%20Subject%3A%20%5Boss-security%5D%20lightdm%20issues%0A%3E%20%0A%3E%20Hi%2C%0A%3E%20%0A%3E%20lightdm%20%280.9.2%29%20which%20aims%20to%20be%20a%20xdm%20replacement%20seems%20to%0A%3E%20fall%20into%20the%20same%20pitfalls%20like%20kdm%20and%20gdm%20recently.%20There%20is%0A%3E%20a%20lot%20of%20uid%200%20code%20creating%20and%20chown%28%29ing%20files%20in%20user%20dirs%20such%20as%0A%3E%20for%20~%2F.dmrc%20and%20~%2F.Xauthority.%20Probably%20more%2C%20depending%20on%0A%3E%20how%20the%20permissions%20of%20cache%20and%20log%20directories%20are%20set%20up.%20For%20example%0A%3E%20process_start%28%29%20also%20creates%20and%20chown%28%29s%20logfiles%20on%20users%20behalf.%0A%3E%20%0A%3E%20There%20is%20also%20one%20thing%20that%20I%20dont%20understand%20about%20the%20lightdm%0A%3E%20user%20itself%20and%20why%20pam%20sessions%20seem%20to%20be%20started%20for%20it%20inside%0A%3E%20the%20greeter%20session%20code.%0A%3E%20%0A%3E%20The%20xdmcp%20code%20seems%20to%20be%20OK%20so%20far%2C%20after%20a%20quick%20review.%0A%3E%20%0A%3E%20---%0A%3E%20%0A%3E%20Cheers%2C%0A%3E%20%20%20%20%20%20%20%20%20Moritz%0A%3E%20%0A%3E%20--%20System%20Information%3A%0A%3E%20Debian%20Release%3A%20wheezy%2Fsid%0A%3E%20%20%20APT%20prefers%20unstable%0A%3E%20%20%20APT%20policy%3A%20%28500%2C%20%27unstable%27%29%0A%3E%20Architecture%3A%20amd64%20%28x86_64%29%0A%3E%20%0A%3E%20Kernel%3A%20Linux%203.0.0-1-amd64%20%28SMP%20w%2F2%20CPU%20cores%29%0A%3E%20Locale%3A%20LANG%3Dde_DE.UTF-8%2C%20LC_CTYPE%3Dde_DE.UTF-8%20%28charmap%3DUTF-8%29%0A%3E%20Shell%3A%20%2Fbin%2Fsh%20linked%20to%20%2Fbin%2Fdash%0A%3E%20%0A%3E%20%0A%3E%20%0A&amp;subject=Re%3A%20Local%20privilege%20escalation">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=jmm%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Moritz Muehlenhoff &lt;jmm@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> Debian Bug Tracking System &lt;submit@bugs.debian.org&gt;</div>
<div class="header"><span class="headerfield">Subject:</span> Local privilege escalation</div>
<div class="header"><span class="headerfield">Date:</span> Wed, 24 Aug 2011 18:33:45 +0200</div>
</div>
<pre class="message">Package: lightdm
Severity: grave
Tags: security

Sebastian Kramer posted the following to oss-security:

---

From: Sebastian Krahmer &lt;krahmer@suse.de&gt;
To: oss-security@lists.openwall.com
Cc: robert.ancell@canonical.com
Subject: [oss-security] lightdm issues

Hi,

lightdm (0.9.2) which aims to be a xdm replacement seems to
fall into the same pitfalls like kdm and gdm recently. There is
a lot of uid 0 code creating and chown()ing files in user dirs such as
for ~/.dmrc and ~/.Xauthority. Probably more, depending on
how the permissions of cache and log directories are set up. For example
process_start() also creates and chown()s logfiles on users behalf.

There is also one thing that I dont understand about the lightdm
user itself and why pam sessions seem to be started for it inside
the greeter session code.

The xdmcp code seems to be OK so far, after a quick review.

---

Cheers,
        Moritz

-- System Information:
Debian Release: wheezy/sid
  APT prefers unstable
  APT policy: (500, &#39;unstable&#39;)
Architecture: amd64 (x86_64)

Kernel: Linux 3.0.0-1-amd64 (SMP w/2 CPU cores)
Locale: LANG=de_DE.UTF-8, LC_CTYPE=de_DE.UTF-8 (charmap=UTF-8)
Shell: /bin/sh linked to /bin/dash



</pre>

<div class="infmessage"><hr><p>
<a name="6"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Debian Xfce Maintainers &lt;pkg-xfce-devel@lists.alioth.debian.org&gt; -->
<!-- time:1314205207 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Debian Xfce Maintainers &lt;pkg-xfce-devel@lists.alioth.debian.org&gt;</code>:<br>
<code>Bug#639151</code>; Package <code>lightdm</code>.
 (Wed, 24 Aug 2011 17:00:07 GMT) (<a href="bugreport.cgi?bug=639151;msg=7">full text</a>, <a href="bugreport.cgi?bug=639151;mbox=yes;msg=7">mbox</a>, <a href="#6">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="8"></a>
<!-- request_addr: Yves-Alexis Perez &lt;corsac@debian.org&gt; -->
<!-- time:1314205207 -->
<strong>Acknowledgement sent</strong>
to <code>Yves-Alexis Perez &lt;corsac@debian.org&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Debian Xfce Maintainers &lt;pkg-xfce-devel@lists.alioth.debian.org&gt;</code>.
 (Wed, 24 Aug 2011 17:00:07 GMT) (<a href="bugreport.cgi?bug=639151;msg=9">full text</a>, <a href="bugreport.cgi?bug=639151;mbox=yes;msg=9">mbox</a>, <a href="#8">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="10"></a><a name="msg10"></a><a href="#10">Message #10</a> received at 639151@bugs.debian.org (<a href="bugreport.cgi?bug=639151;msg=10">full text</a>, <a href="bugreport.cgi?bug=639151;mbox=yes;msg=10">mbox</a>, <a href="mailto:639151@bugs.debian.org?References=%3C20110824163345.3764.96701.reportbug%40pisco.westfalen.local%3E%0A%20%3C1314204970.9503.5.camel%40oban%3E&amp;In-Reply-To=%3C1314204970.9503.5.camel%40oban%3E&amp;body=On%20Wed%2C%2024%20Aug%202011%2018%3A56%3A09%20%2B0200%20Yves-Alexis%20Perez%20%3Ccorsac%40debian.org%3E%20wrote%3A%0A%3E%20On%20mer.%2C%202011-08-24%20at%2018%3A33%20%2B0200%2C%20Moritz%20Muehlenhoff%20wrote%3A%0A%3E%20%3E%20Sebastian%20Kramer%20posted%20the%20following%20to%20oss-security%3A%0A%3E%20%3E%20%0A%3E%20%3E%20---%0A%3E%20%3E%20%0A%3E%20%3E%20From%3A%20Sebastian%20Krahmer%20%3Ckrahmer%40suse.de%3E%0A%3E%20%3E%20To%3A%20oss-security%40lists.openwall.com%0A%3E%20%3E%20Cc%3A%20robert.ancell%40canonical.com%0A%3E%20%3E%20Subject%3A%20%5Boss-security%5D%20lightdm%20issues%0A%3E%20%3E%20%0A%3E%20%3E%20Hi%2C%0A%3E%20%3E%20%0A%3E%20%3E%20lightdm%20%280.9.2%29%20which%20aims%20to%20be%20a%20xdm%20replacement%20seems%20to%0A%3E%20%3E%20fall%20into%20the%20same%20pitfalls%20like%20kdm%20and%20gdm%20recently.%20There%20is%0A%3E%20%3E%20a%20lot%20of%20uid%200%20code%20creating%20and%20chown%28%29ing%20files%20in%20user%20dirs%20such%20as%0A%3E%20%3E%20for%20~%2F.dmrc%20and%20~%2F.Xauthority.%20Probably%20more%2C%20depending%20on%0A%3E%20%3E%20how%20the%20permissions%20of%20cache%20and%20log%20directories%20are%20set%20up.%20For%0A%3E%20%3E%20example%0A%3E%20%3E%20process_start%28%29%20also%20creates%20and%20chown%28%29s%20logfiles%20on%20users%20behalf.%0A%3E%20%3E%20%0A%3E%20%3E%20There%20is%20also%20one%20thing%20that%20I%20dont%20understand%20about%20the%20lightdm%0A%3E%20%3E%20user%20itself%20and%20why%20pam%20sessions%20seem%20to%20be%20started%20for%20it%20inside%0A%3E%20%3E%20the%20greeter%20session%20code.%0A%3E%20%3E%20%0A%3E%20%3E%20The%20xdmcp%20code%20seems%20to%20be%20OK%20so%20far%2C%20after%20a%20quick%20review.%20%0A%3E%20%0A%3E%20Yup%2C%20I%27m%20on%20oss-sec%20so%20I%27ve%20seen%20this%20and%20am%20waiting%20for%20Robert%20answer.%0A%3E%20%0A%3E%20I%20guess%20the%20proper%20way%20to%20do%20it%20would%20be%20to%20move%20all%20the%20user-related%0A%3E%20work%20%2Aafter%2A%20the%20setuid%28%29%20call%20and%20before%20exec%28%29ing%20the%20session%0A%3E%20wrapper.%20%0A%3E%20Not%20sure%20how%20gdm3%2Fxdm%2Fslim%20handle%20that%20but%20there%20might%20be%20inspiration%0A%3E%20there%20too.%0A%3E%20%0A%3E%20Regards%2C%0A%3E%20--%20%0A%3E%20Yves-Alexis%0A%3E%20%0A%3E%20%0A%3E%20%0A%3E%20%0A&amp;subject=Re%3A%20%5BPkg-xfce-devel%5D%20Bug%23639151%3A%20Local%20privilege%20escalation">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=corsac%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Yves-Alexis Perez &lt;corsac@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> Moritz Muehlenhoff &lt;jmm@debian.org&gt;, 639151@bugs.debian.org</div>
<div class="header"><span class="headerfield">Cc:</span> robert.ancell@canonical.com</div>
<div class="header"><span class="headerfield">Subject:</span> Re: [Pkg-xfce-devel] Bug#639151: Local privilege escalation</div>
<div class="header"><span class="headerfield">Date:</span> Wed, 24 Aug 2011 18:56:09 +0200</div>
</div>
<pre class="message">On mer., 2011-08-24 at 18:33 +0200, Moritz Muehlenhoff wrote:
&gt; Sebastian Kramer posted the following to oss-security:
&gt; 
&gt; ---
&gt; 
&gt; From: Sebastian Krahmer &lt;krahmer@suse.de&gt;
&gt; To: oss-security@lists.openwall.com
&gt; Cc: robert.ancell@canonical.com
&gt; Subject: [oss-security] lightdm issues
&gt; 
&gt; Hi,
&gt; 
&gt; lightdm (0.9.2) which aims to be a xdm replacement seems to
&gt; fall into the same pitfalls like kdm and gdm recently. There is
&gt; a lot of uid 0 code creating and chown()ing files in user dirs such as
&gt; for ~/.dmrc and ~/.Xauthority. Probably more, depending on
&gt; how the permissions of cache and log directories are set up. For
&gt; example
&gt; process_start() also creates and chown()s logfiles on users behalf.
&gt; 
&gt; There is also one thing that I dont understand about the lightdm
&gt; user itself and why pam sessions seem to be started for it inside
&gt; the greeter session code.
&gt; 
&gt; The xdmcp code seems to be OK so far, after a quick review. 

Yup, I&#39;m on oss-sec so I&#39;ve seen this and am waiting for Robert answer.

I guess the proper way to do it would be to move all the user-related
work *after* the setuid() call and before exec()ing the session
wrapper. 
Not sure how gdm3/xdm/slim handle that but there might be inspiration
there too.

Regards,
-- 
Yves-Alexis




</pre>

<div class="infmessage"><hr><p>
<a name="11"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Debian Xfce Maintainers &lt;pkg-xfce-devel@lists.alioth.debian.org&gt; -->
<!-- time:1314212223 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Debian Xfce Maintainers &lt;pkg-xfce-devel@lists.alioth.debian.org&gt;</code>:<br>
<code>Bug#639151</code>; Package <code>lightdm</code>.
 (Wed, 24 Aug 2011 18:57:03 GMT) (<a href="bugreport.cgi?bug=639151;msg=12">full text</a>, <a href="bugreport.cgi?bug=639151;mbox=yes;msg=12">mbox</a>, <a href="#11">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="13"></a>
<!-- request_addr: Yves-Alexis Perez &lt;corsac@debian.org&gt; -->
<!-- time:1314212223 -->
<strong>Acknowledgement sent</strong>
to <code>Yves-Alexis Perez &lt;corsac@debian.org&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Debian Xfce Maintainers &lt;pkg-xfce-devel@lists.alioth.debian.org&gt;</code>.
 (Wed, 24 Aug 2011 18:57:03 GMT) (<a href="bugreport.cgi?bug=639151;msg=14">full text</a>, <a href="bugreport.cgi?bug=639151;mbox=yes;msg=14">mbox</a>, <a href="#13">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="15"></a><a name="msg15"></a><a href="#15">Message #15</a> received at 639151@bugs.debian.org (<a href="bugreport.cgi?bug=639151;msg=15">full text</a>, <a href="bugreport.cgi?bug=639151;mbox=yes;msg=15">mbox</a>, <a href="mailto:639151@bugs.debian.org?In-Reply-To=%3C1314212117.2809.1.camel%40scapa%3E&amp;References=%3C20110824163345.3764.96701.reportbug%40pisco.westfalen.local%3E%0A%09%20%3C1314204970.9503.5.camel%40oban%3E%0A%20%3C1314212117.2809.1.camel%40scapa%3E&amp;body=On%20Wed%2C%2024%20Aug%202011%2020%3A55%3A12%20%2B0200%20Yves-Alexis%20Perez%20%3Ccorsac%40debian.org%3E%20wrote%3A%0A%3E%20On%20mer.%2C%202011-08-24%20at%2018%3A56%20%2B0200%2C%20Yves-Alexis%20Perez%20wrote%3A%0A%3E%20%3E%20On%20mer.%2C%202011-08-24%20at%2018%3A33%20%2B0200%2C%20Moritz%20Muehlenhoff%20wrote%3A%0A%3E%20%3E%20%3E%20Sebastian%20Kramer%20posted%20the%20following%20to%20oss-security%3A%0A%3E%20%3E%20%3E%20%0A%3E%20%3E%20%3E%20---%0A%3E%20%3E%20%3E%20%0A%3E%20%3E%20%3E%20From%3A%20Sebastian%20Krahmer%20%3Ckrahmer%40suse.de%3E%0A%3E%20%3E%20%3E%20To%3A%20oss-security%40lists.openwall.com%0A%3E%20%3E%20%3E%20Cc%3A%20robert.ancell%40canonical.com%0A%3E%20%3E%20%3E%20Subject%3A%20%5Boss-security%5D%20lightdm%20issues%0A%3E%20%3E%20%3E%20%0A%3E%20%3E%20%3E%20Hi%2C%0A%3E%20%3E%20%3E%20%0A%3E%20%3E%20%3E%20lightdm%20%280.9.2%29%20which%20aims%20to%20be%20a%20xdm%20replacement%20seems%20to%0A%3E%20%3E%20%3E%20fall%20into%20the%20same%20pitfalls%20like%20kdm%20and%20gdm%20recently.%20There%20is%0A%3E%20%3E%20%3E%20a%20lot%20of%20uid%200%20code%20creating%20and%20chown%28%29ing%20files%20in%20user%20dirs%20such%20as%0A%3E%20%3E%20%3E%20for%20~%2F.dmrc%20and%20~%2F.Xauthority.%20Probably%20more%2C%20depending%20on%0A%3E%20%3E%20%3E%20how%20the%20permissions%20of%20cache%20and%20log%20directories%20are%20set%20up.%20For%0A%3E%20%3E%20%3E%20example%0A%3E%20%3E%20%3E%20process_start%28%29%20also%20creates%20and%20chown%28%29s%20logfiles%20on%20users%20behalf.%0A%3E%20%3E%20%3E%20%0A%3E%20%3E%20%3E%20There%20is%20also%20one%20thing%20that%20I%20dont%20understand%20about%20the%20lightdm%0A%3E%20%3E%20%3E%20user%20itself%20and%20why%20pam%20sessions%20seem%20to%20be%20started%20for%20it%20inside%0A%3E%20%3E%20%3E%20the%20greeter%20session%20code.%0A%3E%20%3E%20%3E%20%0A%3E%20%3E%20%3E%20The%20xdmcp%20code%20seems%20to%20be%20OK%20so%20far%2C%20after%20a%20quick%20review.%20%0A%3E%20%3E%20%0A%3E%20%3E%20Yup%2C%20I%27m%20on%20oss-sec%20so%20I%27ve%20seen%20this%20and%20am%20waiting%20for%20Robert%20answer.%0A%3E%20%3E%20%0A%3E%20%3E%20I%20guess%20the%20proper%20way%20to%20do%20it%20would%20be%20to%20move%20all%20the%20user-related%0A%3E%20%3E%20work%20%2Aafter%2A%20the%20setuid%28%29%20call%20and%20before%20exec%28%29ing%20the%20session%0A%3E%20%3E%20wrapper.%20%0A%3E%20%3E%20Not%20sure%20how%20gdm3%2Fxdm%2Fslim%20handle%20that%20but%20there%20might%20be%20inspiration%0A%3E%20%3E%20there%20too.%0A%3E%20%0A%3E%20And%2C%20out%20of%20curiosity%2C%20how%20would%20you%20achieve%20privilege%20escalation%3F%20You%0A%3E%20should%20be%20able%20to%20erase%2Frewrite%20arbitrary%20files%2C%20including%20%2Fetc%2Fshadow%2C%0A%3E%20but%20you%20don%27t%20really%20have%20control%20on%20what%27s%20written%20there.%0A%3E%20%0A%3E%20Regards%2C%0A%3E%20--%20%0A%3E%20Yves-Alexis%0A&amp;subject=Re%3A%20%5BPkg-xfce-devel%5D%20Bug%23639151%3A%20Bug%23639151%3A%20Local%20privilege%0A%20escalation">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=corsac%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Yves-Alexis Perez &lt;corsac@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> 639151@bugs.debian.org</div>
<div class="header"><span class="headerfield">Cc:</span> Moritz Muehlenhoff &lt;jmm@debian.org&gt;, robert.ancell@canonical.com</div>
<div class="header"><span class="headerfield">Subject:</span> Re: [Pkg-xfce-devel] Bug#639151: Bug#639151: Local privilege
 escalation</div>
<div class="header"><span class="headerfield">Date:</span> Wed, 24 Aug 2011 20:55:12 +0200</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=0;bug=639151;msg=15">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message">On mer., 2011-08-24 at 18:56 +0200, Yves-Alexis Perez wrote:
&gt; On mer., 2011-08-24 at 18:33 +0200, Moritz Muehlenhoff wrote:
&gt; &gt; Sebastian Kramer posted the following to oss-security:
&gt; &gt; 
&gt; &gt; ---
&gt; &gt; 
&gt; &gt; From: Sebastian Krahmer &lt;krahmer@suse.de&gt;
&gt; &gt; To: oss-security@lists.openwall.com
&gt; &gt; Cc: robert.ancell@canonical.com
&gt; &gt; Subject: [oss-security] lightdm issues
&gt; &gt; 
&gt; &gt; Hi,
&gt; &gt; 
&gt; &gt; lightdm (0.9.2) which aims to be a xdm replacement seems to
&gt; &gt; fall into the same pitfalls like kdm and gdm recently. There is
&gt; &gt; a lot of uid 0 code creating and chown()ing files in user dirs such as
&gt; &gt; for ~/.dmrc and ~/.Xauthority. Probably more, depending on
&gt; &gt; how the permissions of cache and log directories are set up. For
&gt; &gt; example
&gt; &gt; process_start() also creates and chown()s logfiles on users behalf.
&gt; &gt; 
&gt; &gt; There is also one thing that I dont understand about the lightdm
&gt; &gt; user itself and why pam sessions seem to be started for it inside
&gt; &gt; the greeter session code.
&gt; &gt; 
&gt; &gt; The xdmcp code seems to be OK so far, after a quick review. 
&gt; 
&gt; Yup, I&#39;m on oss-sec so I&#39;ve seen this and am waiting for Robert answer.
&gt; 
&gt; I guess the proper way to do it would be to move all the user-related
&gt; work *after* the setuid() call and before exec()ing the session
&gt; wrapper. 
&gt; Not sure how gdm3/xdm/slim handle that but there might be inspiration
&gt; there too.

And, out of curiosity, how would you achieve privilege escalation? You
should be able to erase/rewrite arbitrary files, including /etc/shadow,
but you don&#39;t really have control on what&#39;s written there.

Regards,
-- 
Yves-Alexis
</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=639151;filename=signature.asc;msg=15">signature.asc</a> (application/pgp-signature, inline)]</pre>

<div class="infmessage"><hr><p>
<a name="16"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Debian Xfce Maintainers &lt;pkg-xfce-devel@lists.alioth.debian.org&gt; -->
<!-- time:1314287827 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Debian Xfce Maintainers &lt;pkg-xfce-devel@lists.alioth.debian.org&gt;</code>:<br>
<code>Bug#639151</code>; Package <code>lightdm</code>.
 (Thu, 25 Aug 2011 15:57:07 GMT) (<a href="bugreport.cgi?bug=639151;msg=17">full text</a>, <a href="bugreport.cgi?bug=639151;mbox=yes;msg=17">mbox</a>, <a href="#16">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="18"></a>
<!-- request_addr: Yves-Alexis Perez &lt;corsac@debian.org&gt; -->
<!-- time:1314287827 -->
<strong>Acknowledgement sent</strong>
to <code>Yves-Alexis Perez &lt;corsac@debian.org&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Debian Xfce Maintainers &lt;pkg-xfce-devel@lists.alioth.debian.org&gt;</code>.
 (Thu, 25 Aug 2011 15:57:07 GMT) (<a href="bugreport.cgi?bug=639151;msg=19">full text</a>, <a href="bugreport.cgi?bug=639151;mbox=yes;msg=19">mbox</a>, <a href="#18">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="20"></a><a name="msg20"></a><a href="#20">Message #20</a> received at 639151@bugs.debian.org (<a href="bugreport.cgi?bug=639151;msg=20">full text</a>, <a href="bugreport.cgi?bug=639151;mbox=yes;msg=20">mbox</a>, <a href="mailto:639151@bugs.debian.org?In-Reply-To=%3C1314287667.1902.16.camel%40scapa%3E&amp;References=%3C20110824163345.3764.96701.reportbug%40pisco.westfalen.local%3E%0A%09%20%3C1314204970.9503.5.camel%40oban%3E%20%3C1314212117.2809.1.camel%40scapa%3E%0A%20%3C1314287667.1902.16.camel%40scapa%3E&amp;body=On%20Thu%2C%2025%20Aug%202011%2017%3A54%3A23%20%2B0200%20Yves-Alexis%20Perez%20%3Ccorsac%40debian.org%3E%20wrote%3A%0A%3E%20On%20mer.%2C%202011-08-24%20at%2020%3A55%20%2B0200%2C%20Yves-Alexis%20Perez%20wrote%3A%0A%3E%20%3E%20And%2C%20out%20of%20curiosity%2C%20how%20would%20you%20achieve%20privilege%20escalation%3F%20You%0A%3E%20%3E%20should%20be%20able%20to%20erase%2Frewrite%20arbitrary%20files%2C%20including%20%2Fetc%2Fshadow%2C%0A%3E%20%3E%20but%20you%20don%27t%20really%20have%20control%20on%20what%27s%20written%20there.%20%0A%3E%20%0A%3E%20In%20gdm%20%28CVE-2011-0727%20I%20guess%29%20the%20issue%20was%20that%20a%20g_file_copy%28%29%20was%0A%3E%20run%20as%20root%20from%20files%20under%20user%20control%20%28.dmrc%20and%20the%20avatar%29%2C%20to%20a%0A%3E%20cache%20dir%20with%20write%20permissions%20%28afaict%29.%20So%20it%20was%20easy%20to%20put%0A%3E%20whatever%20stuff%20you%20need%20in%20the%20original%20file%20and%20make%20a%20symlink%0A%3E%20to%20%2Fetc%2Fshadow%20in%20the%20destination%20folder%20so%20the%20g_file_copy%28%29%20would%0A%3E%20erase%20that%3A%0A%3E%20%0A%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20res%20%3D%20g_file_copy%20%28src_file%2C%0A%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20dst_file%2C%0A%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20G_FILE_COPY_OVERWRITE%20%7C%0A%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20G_FILE_COPY_NOFOLLOW_SYMLINKS%2C%0A%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20NULL%2C%0A%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20NULL%2C%0A%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20NULL%2C%0A%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%26error%29%3B%0A%3E%20%0A%3E%20%0A%3E%20I%27m%20not%20too%20sure%20what%20G_FILE_COPY_OVERWRITE%20means%2C%20if%20it%20truncate%28%29s%20and%0A%3E%20write%20over%20of%20if%20it%20unlink%28%29s%20and%20start%20fresh%20%28digging%20in%20glib%20to%20find%0A%3E%20out%29.%20Apparenlty%20in%20the%20fallback%20case%20%28not%20sure%20if%20it%27s%20the%20case%20here%29%0A%3E%20it%20ends%20up%20doing%20a%20g_file_replace%28%29%29.%0A%3E%20%0A%3E%20In%20any%20case%2C%20in%20lightdm%20case%2C%20for%20.Xauthority%20file%20it%20uses%0A%3E%20g_file_replace%28%29%20which%20creates%20a%20temporary%20file%20and%20then%20rename%20over%20the%0A%3E%20new%20file%2C%20so%20in%20the%20worst%20case%20you%20overwrite%20a%20system%20file%20with%0A%3E%20xauthority%20data.%0A%3E%20%0A%3E%20Same%20thing%20for%20.dmrc%2C%20you%20can%20overwrite%20system%20files%20but%20with%20dmrc%20data%0A%3E%20which%20look%20like%20%0A%3E%20%0A%3E%20%5BDesktop%5D%0A%3E%20Session%3Dxfce%0A%3E%20Lang%3Dfr_FR.UTF-8%0A%3E%20%0A%3E%20so%20it%20doesn%27t%20look%20easy%20to%20gain%20root%20access%20with%20that.%0A%3E%20%0A%3E%20LightDM%20maintains%20a%20cache%20for%20dmrc%20files%20in%20%2Fvar%2Fcache%2Flightdm%20but%20the%0A%3E%20folder%20is%20created%200700%20so%20it%20doesn%27t%20look%20like%20one%20can%20put%20symlinks%0A%3E%20there%20and%20have%20it%20use%20a%20user-controled%20.dmrc.%0A%3E%20%0A%3E%20All%20in%20all%2C%20I%27m%20not%20too%20sure%20there%27s%20a%20privilege%20escalation%20for%0A%3E%20Xauthority%2F.dmrc%20files%20%28but%20if%20one%20exists%2C%20I%27m%20interested%20in%20how%20to%20do%0A%3E%20it%2C%20by%20curiosity%29.%20But%20you%20still%20damage%20pretty%20much%20any%20arbitrary%20file%2C%0A%3E%20which%20is%20still%20an%20easy%20DoS.%0A%3E%20%0A%3E%20Regards%2C%0A%3E%20--%20%0A%3E%20Yves-Alexis%0A&amp;subject=Re%3A%20%5BPkg-xfce-devel%5D%20Bug%23639151%3A%20Bug%23639151%3A%20Bug%23639151%3A%20Local%0A%20privilege%20escalation">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=corsac%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Yves-Alexis Perez &lt;corsac@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> 639151@bugs.debian.org</div>
<div class="header"><span class="headerfield">Cc:</span> Moritz Muehlenhoff &lt;jmm@debian.org&gt;, robert.ancell@canonical.com, 
	Sebastian Krahmer
	 &lt;krahmer@suse.de&gt;, oss-security@lists.openwall.com</div>
<div class="header"><span class="headerfield">Subject:</span> Re: [Pkg-xfce-devel] Bug#639151: Bug#639151: Bug#639151: Local
 privilege escalation</div>
<div class="header"><span class="headerfield">Date:</span> Thu, 25 Aug 2011 17:54:23 +0200</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=0;bug=639151;msg=20">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message">On mer., 2011-08-24 at 20:55 +0200, Yves-Alexis Perez wrote:
&gt; And, out of curiosity, how would you achieve privilege escalation? You
&gt; should be able to erase/rewrite arbitrary files, including /etc/shadow,
&gt; but you don&#39;t really have control on what&#39;s written there. 

In gdm (<a href="https://security-tracker.debian.org/tracker/CVE-2011-0727">CVE-2011-0727</a> I guess) the issue was that a g_file_copy() was
run as root from files under user control (.dmrc and the avatar), to a
cache dir with write permissions (afaict). So it was easy to put
whatever stuff you need in the original file and make a symlink
to /etc/shadow in the destination folder so the g_file_copy() would
erase that:

                 res = g_file_copy (src_file,
                                    dst_file,
                                    G_FILE_COPY_OVERWRITE |
                                    G_FILE_COPY_NOFOLLOW_SYMLINKS,
                                    NULL,
                                    NULL,
                                    NULL,
                                    &amp;error);


I&#39;m not too sure what G_FILE_COPY_OVERWRITE means, if it truncate()s and
write over of if it unlink()s and start fresh (digging in glib to find
out). Apparenlty in the fallback case (not sure if it&#39;s the case here)
it ends up doing a g_file_replace()).

In any case, in lightdm case, for .Xauthority file it uses
g_file_replace() which creates a temporary file and then rename over the
new file, so in the worst case you overwrite a system file with
xauthority data.

Same thing for .dmrc, you can overwrite system files but with dmrc data
which look like 

[Desktop]
Session=xfce
Lang=fr_FR.UTF-8

so it doesn&#39;t look easy to gain root access with that.

LightDM maintains a cache for dmrc files in /var/cache/lightdm but the
folder is created 0700 so it doesn&#39;t look like one can put symlinks
there and have it use a user-controled .dmrc.

All in all, I&#39;m not too sure there&#39;s a privilege escalation for
Xauthority/.dmrc files (but if one exists, I&#39;m interested in how to do
it, by curiosity). But you still damage pretty much any arbitrary file,
which is still an easy DoS.

Regards,
-- 
Yves-Alexis
</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=639151;filename=signature.asc;msg=20">signature.asc</a> (application/pgp-signature, inline)]</pre>

<div class="msgreceived"><hr><p>
<a name="21"></a>
<!-- command:forwarded -->
<!-- requester: Yves-Alexis Perez &lt;corsac@debian.org&gt; -->
<!-- request_addr: control@bugs.debian.org -->
<!-- time:1314303486 -->
<!-- new_data:
$new_data = {
              &#39;forwarded&#39; =&gt; &#39;<a href="https://bugs.launchpad.net/debian/+source/lightdm/+bug/834079">https://bugs.launchpad.net/debian/+source/lightdm/+bug/834079</a>&#39;
            };
-->
<!-- old_data:
$old_data = {
              &#39;forwarded&#39; =&gt; &#39;&#39;
            };
-->
<strong>Set Bug forwarded-to-address to &#39;<a href="https://bugs.launchpad.net/debian/+source/lightdm/+bug/834079">https://bugs.launchpad.net/debian/+source/lightdm/+bug/834079</a>&#39;.</strong>
Request was from <code>Yves-Alexis Perez &lt;corsac@debian.org&gt;</code>
to <code>control@bugs.debian.org</code>.
 (Thu, 25 Aug 2011 20:18:06 GMT) (<a href="bugreport.cgi?bug=639151;msg=22">full text</a>, <a href="bugreport.cgi?bug=639151;mbox=yes;msg=22">mbox</a>, <a href="#21">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="23"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Debian Xfce Maintainers &lt;pkg-xfce-devel@lists.alioth.debian.org&gt; -->
<!-- time:1314348483 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Debian Xfce Maintainers &lt;pkg-xfce-devel@lists.alioth.debian.org&gt;</code>:<br>
<code>Bug#639151</code>; Package <code>lightdm</code>.
 (Fri, 26 Aug 2011 08:48:03 GMT) (<a href="bugreport.cgi?bug=639151;msg=24">full text</a>, <a href="bugreport.cgi?bug=639151;mbox=yes;msg=24">mbox</a>, <a href="#23">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="25"></a>
<!-- request_addr: Sebastian Krahmer &lt;krahmer@suse.de&gt; -->
<!-- time:1314348483 -->
<strong>Acknowledgement sent</strong>
to <code>Sebastian Krahmer &lt;krahmer@suse.de&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Debian Xfce Maintainers &lt;pkg-xfce-devel@lists.alioth.debian.org&gt;</code>.
 (Fri, 26 Aug 2011 08:48:03 GMT) (<a href="bugreport.cgi?bug=639151;msg=26">full text</a>, <a href="bugreport.cgi?bug=639151;mbox=yes;msg=26">mbox</a>, <a href="#25">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="27"></a><a name="msg27"></a><a href="#27">Message #27</a> received at 639151@bugs.debian.org (<a href="bugreport.cgi?bug=639151;msg=27">full text</a>, <a href="bugreport.cgi?bug=639151;mbox=yes;msg=27">mbox</a>, <a href="mailto:639151@bugs.debian.org?body=On%20Fri%2C%2026%20Aug%202011%2010%3A43%3A55%20%2B0200%20Sebastian%20Krahmer%20%3Ckrahmer%40suse.de%3E%20wrote%3A%0A%3E%20%0A%3E%20Hi%2C%0A%3E%20%0A%3E%20You%20probably%20dont%20take%20into%20account%20the%20chown%28%29%20that%20happens%20in%20lightdm.%0A%3E%20Just%20unlink%20the%20created%20~%2F.dmrc%20or%20~%2F.Xauthority%20files%20after%20creation%20and%20make%20a%20symlink%0A%3E%20to%20%2Fetc%2Fpasswd%20to%20chown%20it%20to%20yourself.%0A%3E%20However%20I%20didnt%20dig%20deep%20enough%20into%20it%20to%20write%20an%20exploit%20as%20I%20dont%20have%0A%3E%20a%20working%20lightdm%20setup.%20The%20correct%20behavior%20is%20to%20temporarily%20drop%20euid%2Ffsuid%0A%3E%20to%20that%20of%20the%20user%20if%20doing%20anything%20with%20his%20files.%0A%3E%20%0A%3E%20The%20PAM%20issue%20that%20I%20was%20curious%20about%20was%20that%20a%20pam_start%28%29%20etc%20is%20done%0A%3E%20for%20the%20greeter-user%20%28which%20I%20expect%20to%20be%20some%20%22lightdm%22%20user%29%3F%0A%3E%20%0A%3E%20I%20would%20expect%20all%20pam_%20calls%20are%20only%20done%20for%20the%20user%20who%20is%20actually%0A%3E%20about%20to%20login.%20The%20question%20that%20came%20up%20to%20me%20was%20whether%20pam_environment%0A%3E%20from%20the%20user%20would%20have%20impact%20on%20uid-0%20called%20programs%2Fscripts%20since%0A%3E%20you%20transfer%20the%20PAM%20env%20to%20the%20process%20env.%0A%3E%20%0A%3E%20Sebastian%0A%3E%20%0A%3E%20On%20Thu%2C%20Aug%2025%2C%202011%20at%2005%3A54%3A23PM%20%2B0200%2C%20Yves-Alexis%20Perez%20wrote%3A%0A%3E%20%3E%20On%20mer.%2C%202011-08-24%20at%2020%3A55%20%2B0200%2C%20Yves-Alexis%20Perez%20wrote%3A%0A%3E%20%3E%20%3E%20And%2C%20out%20of%20curiosity%2C%20how%20would%20you%20achieve%20privilege%20escalation%3F%20You%0A%3E%20%3E%20%3E%20should%20be%20able%20to%20erase%2Frewrite%20arbitrary%20files%2C%20including%20%2Fetc%2Fshadow%2C%0A%3E%20%3E%20%3E%20but%20you%20don%27t%20really%20have%20control%20on%20what%27s%20written%20there.%20%0A%3E%20%3E%20%0A%3E%20%3E%20In%20gdm%20%28CVE-2011-0727%20I%20guess%29%20the%20issue%20was%20that%20a%20g_file_copy%28%29%20was%0A%3E%20%3E%20run%20as%20root%20from%20files%20under%20user%20control%20%28.dmrc%20and%20the%20avatar%29%2C%20to%20a%0A%3E%20%3E%20cache%20dir%20with%20write%20permissions%20%28afaict%29.%20So%20it%20was%20easy%20to%20put%0A%3E%20%3E%20whatever%20stuff%20you%20need%20in%20the%20original%20file%20and%20make%20a%20symlink%0A%3E%20%3E%20to%20%2Fetc%2Fshadow%20in%20the%20destination%20folder%20so%20the%20g_file_copy%28%29%20would%0A%3E%20%3E%20erase%20that%3A%0A%3E%20%3E%20%0A%3E%20%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20res%20%3D%20g_file_copy%20%28src_file%2C%0A%3E%20%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20dst_file%2C%0A%3E%20%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20G_FILE_COPY_OVERWRITE%20%7C%0A%3E%20%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20G_FILE_COPY_NOFOLLOW_SYMLINKS%2C%0A%3E%20%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20NULL%2C%0A%3E%20%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20NULL%2C%0A%3E%20%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20NULL%2C%0A%3E%20%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%26error%29%3B%0A%3E%20%3E%20%0A%3E%20%3E%20%0A%3E%20%3E%20I%27m%20not%20too%20sure%20what%20G_FILE_COPY_OVERWRITE%20means%2C%20if%20it%20truncate%28%29s%20and%0A%3E%20%3E%20write%20over%20of%20if%20it%20unlink%28%29s%20and%20start%20fresh%20%28digging%20in%20glib%20to%20find%0A%3E%20%3E%20out%29.%20Apparenlty%20in%20the%20fallback%20case%20%28not%20sure%20if%20it%27s%20the%20case%20here%29%0A%3E%20%3E%20it%20ends%20up%20doing%20a%20g_file_replace%28%29%29.%0A%3E%20%3E%20%0A%3E%20%3E%20In%20any%20case%2C%20in%20lightdm%20case%2C%20for%20.Xauthority%20file%20it%20uses%0A%3E%20%3E%20g_file_replace%28%29%20which%20creates%20a%20temporary%20file%20and%20then%20rename%20over%20the%0A%3E%20%3E%20new%20file%2C%20so%20in%20the%20worst%20case%20you%20overwrite%20a%20system%20file%20with%0A%3E%20%3E%20xauthority%20data.%0A%3E%20%3E%20%0A%3E%20%3E%20Same%20thing%20for%20.dmrc%2C%20you%20can%20overwrite%20system%20files%20but%20with%20dmrc%20data%0A%3E%20%3E%20which%20look%20like%20%0A%3E%20%3E%20%0A%3E%20%3E%20%5BDesktop%5D%0A%3E%20%3E%20Session%3Dxfce%0A%3E%20%3E%20Lang%3Dfr_FR.UTF-8%0A%3E%20%3E%20%0A&amp;subject=Re%3A%20%5BPkg-xfce-devel%5D%20Bug%23639151%3A%20Bug%23639151%3A%20Bug%23639151%3A%20Local%20privilege%20escalation&amp;In-Reply-To=%3C20110826084355.GB27079%40suse.de%3E&amp;References=%3C20110824163345.3764.96701.reportbug%40pisco.westfalen.local%3E%20%3C1314204970.9503.5.camel%40oban%3E%20%3C1314212117.2809.1.camel%40scapa%3E%20%3C1314287667.1902.16.camel%40scapa%3E%0A%20%3C20110826084355.GB27079%40suse.de%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=krahmer%40suse.de" alt="">
<div class="header"><span class="headerfield">From:</span> Sebastian Krahmer &lt;krahmer@suse.de&gt;</div>
<div class="header"><span class="headerfield">To:</span> Yves-Alexis Perez &lt;corsac@debian.org&gt;</div>
<div class="header"><span class="headerfield">Cc:</span> 639151@bugs.debian.org, Moritz Muehlenhoff &lt;jmm@debian.org&gt;,
	robert.ancell@canonical.com, oss-security@lists.openwall.com</div>
<div class="header"><span class="headerfield">Subject:</span> Re: [Pkg-xfce-devel] Bug#639151: Bug#639151: Bug#639151: Local privilege escalation</div>
<div class="header"><span class="headerfield">Date:</span> Fri, 26 Aug 2011 10:43:55 +0200</div>
</div>
<pre class="message">
Hi,

You probably dont take into account the chown() that happens in lightdm.
Just unlink the created ~/.dmrc or ~/.Xauthority files after creation and make a symlink
to /etc/passwd to chown it to yourself.
However I didnt dig deep enough into it to write an exploit as I dont have
a working lightdm setup. The correct behavior is to temporarily drop euid/fsuid
to that of the user if doing anything with his files.

The PAM issue that I was curious about was that a pam_start() etc is done
for the greeter-user (which I expect to be some &quot;lightdm&quot; user)?

I would expect all pam_ calls are only done for the user who is actually
about to login. The question that came up to me was whether pam_environment
from the user would have impact on uid-0 called programs/scripts since
you transfer the PAM env to the process env.

Sebastian

On Thu, Aug 25, 2011 at 05:54:23PM +0200, Yves-Alexis Perez wrote:
&gt; On mer., 2011-08-24 at 20:55 +0200, Yves-Alexis Perez wrote:
&gt; &gt; And, out of curiosity, how would you achieve privilege escalation? You
&gt; &gt; should be able to erase/rewrite arbitrary files, including /etc/shadow,
&gt; &gt; but you don&#39;t really have control on what&#39;s written there. 
&gt; 
&gt; In gdm (<a href="https://security-tracker.debian.org/tracker/CVE-2011-0727">CVE-2011-0727</a> I guess) the issue was that a g_file_copy() was
&gt; run as root from files under user control (.dmrc and the avatar), to a
&gt; cache dir with write permissions (afaict). So it was easy to put
&gt; whatever stuff you need in the original file and make a symlink
&gt; to /etc/shadow in the destination folder so the g_file_copy() would
&gt; erase that:
&gt; 
&gt;                  res = g_file_copy (src_file,
&gt;                                     dst_file,
&gt;                                     G_FILE_COPY_OVERWRITE |
&gt;                                     G_FILE_COPY_NOFOLLOW_SYMLINKS,
&gt;                                     NULL,
&gt;                                     NULL,
&gt;                                     NULL,
&gt;                                     &amp;error);
&gt; 
&gt; 
&gt; I&#39;m not too sure what G_FILE_COPY_OVERWRITE means, if it truncate()s and
&gt; write over of if it unlink()s and start fresh (digging in glib to find
&gt; out). Apparenlty in the fallback case (not sure if it&#39;s the case here)
&gt; it ends up doing a g_file_replace()).
&gt; 
&gt; In any case, in lightdm case, for .Xauthority file it uses
&gt; g_file_replace() which creates a temporary file and then rename over the
&gt; new file, so in the worst case you overwrite a system file with
&gt; xauthority data.
&gt; 
&gt; Same thing for .dmrc, you can overwrite system files but with dmrc data
&gt; which look like 
&gt; 
&gt; [Desktop]
&gt; Session=xfce
&gt; Lang=fr_FR.UTF-8
&gt; 
&gt; so it doesn&#39;t look easy to gain root access with that.
&gt; 
&gt; LightDM maintains a cache for dmrc files in /var/cache/lightdm but the
&gt; folder is created 0700 so it doesn&#39;t look like one can put symlinks
&gt; there and have it use a user-controled .dmrc.
&gt; 
&gt; All in all, I&#39;m not too sure there&#39;s a privilege escalation for
&gt; Xauthority/.dmrc files (but if one exists, I&#39;m interested in how to do
&gt; it, by curiosity). But you still damage pretty much any arbitrary file,
&gt; which is still an easy DoS.
&gt; 
&gt; Regards,
&gt; -- 
&gt; Yves-Alexis



-- 

~ perl self.pl
~ $_=&#39;print&quot;\$_=\47$_\47;eval&quot;&#39;;eval
~ krahmer@suse.de - SuSE Security Team

---
SUSE LINUX Products GmbH,
GF: Jeff Hawn, Jennifer Guild, Felix Imendörffer, HRB 16746 (AG Nürnberg)
Maxfeldstraße 5
90409 Nürnberg
Germany




</pre>

<div class="infmessage"><hr><p>
<a name="28"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Debian Xfce Maintainers &lt;pkg-xfce-devel@lists.alioth.debian.org&gt; -->
<!-- time:1314349383 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Debian Xfce Maintainers &lt;pkg-xfce-devel@lists.alioth.debian.org&gt;</code>:<br>
<code>Bug#639151</code>; Package <code>lightdm</code>.
 (Fri, 26 Aug 2011 09:03:03 GMT) (<a href="bugreport.cgi?bug=639151;msg=29">full text</a>, <a href="bugreport.cgi?bug=639151;mbox=yes;msg=29">mbox</a>, <a href="#28">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="30"></a>
<!-- request_addr: Yves-Alexis Perez &lt;corsac@debian.org&gt; -->
<!-- time:1314349401 -->
<strong>Acknowledgement sent</strong>
to <code>Yves-Alexis Perez &lt;corsac@debian.org&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Debian Xfce Maintainers &lt;pkg-xfce-devel@lists.alioth.debian.org&gt;</code>.
 (Fri, 26 Aug 2011 09:03:21 GMT) (<a href="bugreport.cgi?bug=639151;msg=31">full text</a>, <a href="bugreport.cgi?bug=639151;mbox=yes;msg=31">mbox</a>, <a href="#30">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="32"></a><a name="msg32"></a><a href="#32">Message #32</a> received at 639151@bugs.debian.org (<a href="bugreport.cgi?bug=639151;msg=32">full text</a>, <a href="bugreport.cgi?bug=639151;mbox=yes;msg=32">mbox</a>, <a href="mailto:639151@bugs.debian.org?body=On%20Fri%2C%2026%20Aug%202011%2010%3A58%3A26%20%2B0200%20Yves-Alexis%20Perez%20%3Ccorsac%40debian.org%3E%20wrote%3A%0A%3E%20On%20ven.%2C%202011-08-26%20at%2010%3A43%20%2B0200%2C%20Sebastian%20Krahmer%20wrote%3A%0A%3E%20%3E%20Hi%2C%0A%3E%20%3E%20%0A%3E%20%3E%20You%20probably%20dont%20take%20into%20account%20the%20chown%28%29%20that%20happens%20in%20lightdm.%0A%3E%20%3E%20Just%20unlink%20the%20created%20~%2F.dmrc%20or%20~%2F.Xauthority%20files%20after%20creation%20and%20make%20a%20symlink%0A%3E%20%3E%20to%20%2Fetc%2Fpasswd%20to%20chown%20it%20to%20yourself.%0A%3E%20%0A%3E%20The%20chown%20will%20be%20applied%20to%20the%20symlink%2C%20not%20the%20target.%20I%27ve%20tried%20to%0A%3E%20make%20.Xauthority%20a%20symlink%20to%20a%20root-owned%20file%20and%20the%20destination%20was%0A%3E%20indeed%20destroyed%2C%20but%20it%27s%20still%20root-owned.%0A%3E%20%0A%3E%20%3E%20However%20I%20didnt%20dig%20deep%20enough%20into%20it%20to%20write%20an%20exploit%20as%20I%20dont%20have%0A%3E%20%3E%20a%20working%20lightdm%20setup.%20The%20correct%20behavior%20is%20to%20temporarily%20drop%20euid%2Ffsuid%0A%3E%20%3E%20to%20that%20of%20the%20user%20if%20doing%20anything%20with%20his%20files.%0A%3E%20%0A%3E%20Yeah%2C%20I%27m%20currently%20cooking%20patches%20doing%20that%2C%20though%20they%27ll%20need%0A%3E%20review%20before%20apply.%0A%3E%20%3E%20%0A%3E%20%3E%20The%20PAM%20issue%20that%20I%20was%20curious%20about%20was%20that%20a%20pam_start%28%29%20etc%20is%20done%0A%3E%20%3E%20for%20the%20greeter-user%20%28which%20I%20expect%20to%20be%20some%20%22lightdm%22%20user%29%3F%0A%3E%20%0A%3E%20Yes%0A%3E%20%3E%20%0A%3E%20%3E%20I%20would%20expect%20all%20pam_%20calls%20are%20only%20done%20for%20the%20user%20who%20is%20actually%0A%3E%20%3E%20about%20to%20login.%20The%20question%20that%20came%20up%20to%20me%20was%20whether%20pam_environment%0A%3E%20%3E%20from%20the%20user%20would%20have%20impact%20on%20uid-0%20called%20programs%2Fscripts%20since%0A%3E%20%3E%20you%20transfer%20the%20PAM%20env%20to%20the%20process%20env.%0A%3E%20%0A%3E%20Yeah%2C%20that%20looks%20fishy%2C%20though%20I%20have%20no%20idea%20how%20it%27s%20exactly%20cooked%0A%3E%20that%20way%2C%20we%27ll%20have%20to%20wait%20for%20an%20answer%20from%20Robert.%0A%3E%20%0A%3E%20Regards%2C%0A%3E%20--%20%0A%3E%20Yves-Alexis%0A&amp;subject=Re%3A%20%5BPkg-xfce-devel%5D%20Bug%23639151%3A%20Bug%23639151%3A%20Bug%23639151%3A%20Local%0A%20privilege%20escalation&amp;References=%3C20110824163345.3764.96701.reportbug%40pisco.westfalen.local%3E%0A%09%20%3C1314204970.9503.5.camel%40oban%3E%20%3C1314212117.2809.1.camel%40scapa%3E%0A%09%20%3C1314287667.1902.16.camel%40scapa%3E%20%3C20110826084355.GB27079%40suse.de%3E%0A%20%3C1314349111.23138.13.camel%40scapa%3E&amp;In-Reply-To=%3C1314349111.23138.13.camel%40scapa%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=corsac%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Yves-Alexis Perez &lt;corsac@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> Sebastian Krahmer &lt;krahmer@suse.de&gt;</div>
<div class="header"><span class="headerfield">Cc:</span> 639151@bugs.debian.org, Moritz Muehlenhoff &lt;jmm@debian.org&gt;, 
	robert.ancell@canonical.com, oss-security@lists.openwall.com</div>
<div class="header"><span class="headerfield">Subject:</span> Re: [Pkg-xfce-devel] Bug#639151: Bug#639151: Bug#639151: Local
 privilege escalation</div>
<div class="header"><span class="headerfield">Date:</span> Fri, 26 Aug 2011 10:58:26 +0200</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=0;bug=639151;msg=32">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message">On ven., 2011-08-26 at 10:43 +0200, Sebastian Krahmer wrote:
&gt; Hi,
&gt; 
&gt; You probably dont take into account the chown() that happens in lightdm.
&gt; Just unlink the created ~/.dmrc or ~/.Xauthority files after creation and make a symlink
&gt; to /etc/passwd to chown it to yourself.

The chown will be applied to the symlink, not the target. I&#39;ve tried to
make .Xauthority a symlink to a root-owned file and the destination was
indeed destroyed, but it&#39;s still root-owned.

&gt; However I didnt dig deep enough into it to write an exploit as I dont have
&gt; a working lightdm setup. The correct behavior is to temporarily drop euid/fsuid
&gt; to that of the user if doing anything with his files.

Yeah, I&#39;m currently cooking patches doing that, though they&#39;ll need
review before apply.
&gt; 
&gt; The PAM issue that I was curious about was that a pam_start() etc is done
&gt; for the greeter-user (which I expect to be some &quot;lightdm&quot; user)?

Yes
&gt; 
&gt; I would expect all pam_ calls are only done for the user who is actually
&gt; about to login. The question that came up to me was whether pam_environment
&gt; from the user would have impact on uid-0 called programs/scripts since
&gt; you transfer the PAM env to the process env.

Yeah, that looks fishy, though I have no idea how it&#39;s exactly cooked
that way, we&#39;ll have to wait for an answer from Robert.

Regards,
-- 
Yves-Alexis
</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=639151;filename=signature.asc;msg=32">signature.asc</a> (application/pgp-signature, inline)]</pre>

<div class="infmessage"><hr><p>
<a name="33"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Debian Xfce Maintainers &lt;pkg-xfce-devel@lists.alioth.debian.org&gt; -->
<!-- time:1314349760 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Debian Xfce Maintainers &lt;pkg-xfce-devel@lists.alioth.debian.org&gt;</code>:<br>
<code>Bug#639151</code>; Package <code>lightdm</code>.
 (Fri, 26 Aug 2011 09:09:20 GMT) (<a href="bugreport.cgi?bug=639151;msg=34">full text</a>, <a href="bugreport.cgi?bug=639151;mbox=yes;msg=34">mbox</a>, <a href="#33">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="35"></a>
<!-- request_addr: Yves-Alexis Perez &lt;corsac@debian.org&gt; -->
<!-- time:1314349762 -->
<strong>Acknowledgement sent</strong>
to <code>Yves-Alexis Perez &lt;corsac@debian.org&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Debian Xfce Maintainers &lt;pkg-xfce-devel@lists.alioth.debian.org&gt;</code>.
 (Fri, 26 Aug 2011 09:09:22 GMT) (<a href="bugreport.cgi?bug=639151;msg=36">full text</a>, <a href="bugreport.cgi?bug=639151;mbox=yes;msg=36">mbox</a>, <a href="#35">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="37"></a><a name="msg37"></a><a href="#37">Message #37</a> received at 639151@bugs.debian.org (<a href="bugreport.cgi?bug=639151;msg=37">full text</a>, <a href="bugreport.cgi?bug=639151;mbox=yes;msg=37">mbox</a>, <a href="mailto:639151@bugs.debian.org?subject=Re%3A%20%5Boss-security%5D%20Re%3A%20%5BPkg-xfce-devel%5D%20Bug%23639151%3A%20Bug%23639151%3A%0A%20Bug%23639151%3A%20Local%20privilege%20escalation&amp;body=On%20Fri%2C%2026%20Aug%202011%2011%3A07%3A20%20%2B0200%20Yves-Alexis%20Perez%20%3Ccorsac%40debian.org%3E%20wrote%3A%0A%3E%20On%20ven.%2C%202011-08-26%20at%2010%3A58%20%2B0200%2C%20Yves-Alexis%20Perez%20wrote%3A%0A%3E%20%3E%20%3E%20However%20I%20didnt%20dig%20deep%20enough%20into%20it%20to%20write%20an%20exploit%20as%20I%20dont%20have%0A%3E%20%3E%20%3E%20a%20working%20lightdm%20setup.%20The%20correct%20behavior%20is%20to%20temporarily%20drop%20euid%2Ffsuid%0A%3E%20%3E%20%3E%20to%20that%20of%20the%20user%20if%20doing%20anything%20with%20his%20files.%0A%3E%20%3E%20%0A%3E%20%3E%20Yeah%2C%20I%27m%20currently%20cooking%20patches%20doing%20that%2C%20though%20they%27ll%20need%0A%3E%20%3E%20review%20before%20apply.%20%0A%3E%20%0A%3E%20Would%20something%20like%3A%0A%3E%20%0A%3E%20diff%20--git%20a%2Fsrc%2Fdmrc.c%20b%2Fsrc%2Fdmrc.c%0A%3E%20index%20bff1da8..9f38faf%20100644%0A%3E%20---%20a%2Fsrc%2Fdmrc.c%0A%3E%20%2B%2B%2B%20b%2Fsrc%2Fdmrc.c%0A%3E%20%40%40%20-80%2C11%20%2B80%2C25%20%40%40%20dmrc_save%20%28GKeyFile%20%2Admrc_file%2C%20const%20gchar%20%2Ausername%29%0A%3E%20%20%20%20%20%20%2F%2A%20Update%20the%20users%20.dmrc%20%2A%2F%0A%3E%20%20%20%20%20%20if%20%28user%29%0A%3E%20%20%20%20%20%20%7B%0A%3E%20%2B%20%20%20%20%20%20%2F%2A%20write%20the%20file%20as%20the%20user%20itself%20%2A%2F%0A%3E%20%2B%20%20%20%20%20%20pid_t%20pid%3B%0A%3E%20%2B%20%20%20%20%20%20pid%20%3D%20fork%28%29%3B%0A%3E%20%2B%0A%3E%20%2B%20%20%20%20%20%20if%20%28pid%20%3D%3D%200%29%0A%3E%20%2B%20%20%20%20%20%20%7B%0A%3E%20%2B%20%20%20%20%20%20%20%20if%20%28setuid%20%28user_get_uid%28user%29%29%20%3C%200%29%0A%3E%20%2B%20%20%20%20%20%20%20%20%7B%0A%3E%20%2B%20%20%20%20%20%20%20%20%20%20g_warning%28%22Error%20changing%20uid%20for%20%25s%3A%20%25s%22%2C%20username%2C%20g_strerror%28errno%29%29%3B%0A%3E%20%2B%20%20%20%20%20%20%20%20%20%20_exit%28EXIT_FAILURE%29%3B%0A%3E%20%2B%20%20%20%20%20%20%20%20%7D%0A%3E%20%20%20%20%20%20%20%20%20%20path%20%3D%20g_build_filename%20%28user_get_home_directory%20%28user%29%2C%20%22.dmrc%22%2C%20NULL%29%3B%0A%3E%20%20%20%20%20%20%20%20%20%20g_file_set_contents%20%28path%2C%20data%2C%20length%2C%20NULL%29%3B%0A%3E%20-%20%20%20%20%20%20%20%20if%20%28getuid%20%28%29%20%3D%3D%200%20%26%26%20chown%20%28path%2C%20user_get_uid%20%28user%29%2C%20user_get_gid%20%28user%29%29%20%3C%200%29%0A%3E%20-%20%20%20%20%20%20%20%20%20%20%20%20g_warning%20%28%22Error%20setting%20ownership%20on%20%25s%3A%20%25s%22%2C%20path%2C%20strerror%20%28errno%29%29%3B%0A%3E%20%20%20%20%20%20%20%20%20%20g_free%20%28path%29%3B%0A%3E%20%2B%20%20%20%20%20%20%20%20_exit%28EXIT_SUCCESS%29%3B%0A%3E%20%2B%0A%3E%20%2B%20%20%20%20%20%20%7D%0A%3E%20%2B%20%20%20%20%20%20if%20%28pid%20%3E%200%29%0A%3E%20%2B%20%20%20%20%20%20%20%20wait%28NULL%29%3B%0A%3E%20%20%20%20%20%20%7D%0A%3E%20%20%0A%3E%20%20%20%20%20%20%2F%2A%20Update%20the%20.dmrc%20cache%20%2A%2F%0A%3E%20%0A%3E%20do%20the%20job%20%28untested%2C%20it%27s%20more%20like%20a%20RFC%20right%20now%29.%0A%3E%20%0A%3E%20Regards%2C%0A%3E%20--%20%0A%3E%20Yves-Alexis%0A&amp;In-Reply-To=%3C1314349640.23138.14.camel%40scapa%3E&amp;References=%3C20110824163345.3764.96701.reportbug%40pisco.westfalen.local%3E%0A%09%20%3C1314204970.9503.5.camel%40oban%3E%20%3C1314212117.2809.1.camel%40scapa%3E%0A%09%20%3C1314287667.1902.16.camel%40scapa%3E%20%3C20110826084355.GB27079%40suse.de%3E%0A%09%20%3C1314349111.23138.13.camel%40scapa%3E%0A%20%3C1314349640.23138.14.camel%40scapa%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=corsac%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Yves-Alexis Perez &lt;corsac@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> oss-security@lists.openwall.com</div>
<div class="header"><span class="headerfield">Cc:</span> Sebastian Krahmer &lt;krahmer@suse.de&gt;, 639151@bugs.debian.org, Moritz
	Muehlenhoff &lt;jmm@debian.org&gt;, robert.ancell@canonical.com</div>
<div class="header"><span class="headerfield">Subject:</span> Re: [oss-security] Re: [Pkg-xfce-devel] Bug#639151: Bug#639151:
 Bug#639151: Local privilege escalation</div>
<div class="header"><span class="headerfield">Date:</span> Fri, 26 Aug 2011 11:07:20 +0200</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=0;bug=639151;msg=37">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message">On ven., 2011-08-26 at 10:58 +0200, Yves-Alexis Perez wrote:
&gt; &gt; However I didnt dig deep enough into it to write an exploit as I dont have
&gt; &gt; a working lightdm setup. The correct behavior is to temporarily drop euid/fsuid
&gt; &gt; to that of the user if doing anything with his files.
&gt; 
&gt; Yeah, I&#39;m currently cooking patches doing that, though they&#39;ll need
&gt; review before apply. 

Would something like:

diff --git a/src/dmrc.c b/src/dmrc.c
index bff1da8..9f38faf 100644
--- a/src/dmrc.c
+++ b/src/dmrc.c
@@ -80,11 +80,25 @@ dmrc_save (GKeyFile *dmrc_file, const gchar *username)
     /* Update the users .dmrc */
     if (user)
     {
+      /* write the file as the user itself */
+      pid_t pid;
+      pid = fork();
+
+      if (pid == 0)
+      {
+        if (setuid (user_get_uid(user)) &lt; 0)
+        {
+          g_warning(&quot;Error changing uid for %s: %s&quot;, username, g_strerror(errno));
+          _exit(EXIT_FAILURE);
+        }
         path = g_build_filename (user_get_home_directory (user), &quot;.dmrc&quot;, NULL);
         g_file_set_contents (path, data, length, NULL);
-        if (getuid () == 0 &amp;&amp; chown (path, user_get_uid (user), user_get_gid (user)) &lt; 0)
-            g_warning (&quot;Error setting ownership on %s: %s&quot;, path, strerror (errno));
         g_free (path);
+        _exit(EXIT_SUCCESS);
+
+      }
+      if (pid &gt; 0)
+        wait(NULL);
     }
 
     /* Update the .dmrc cache */

do the job (untested, it&#39;s more like a RFC right now).

Regards,
-- 
Yves-Alexis
</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=639151;filename=signature.asc;msg=37">signature.asc</a> (application/pgp-signature, inline)]</pre>

<div class="infmessage"><hr><p>
<a name="38"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Debian Xfce Maintainers &lt;pkg-xfce-devel@lists.alioth.debian.org&gt; -->
<!-- time:1314358032 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Debian Xfce Maintainers &lt;pkg-xfce-devel@lists.alioth.debian.org&gt;</code>:<br>
<code>Bug#639151</code>; Package <code>lightdm</code>.
 (Fri, 26 Aug 2011 11:27:12 GMT) (<a href="bugreport.cgi?bug=639151;msg=39">full text</a>, <a href="bugreport.cgi?bug=639151;mbox=yes;msg=39">mbox</a>, <a href="#38">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="40"></a>
<!-- request_addr: Yves-Alexis Perez &lt;corsac@debian.org&gt; -->
<!-- time:1314358033 -->
<strong>Acknowledgement sent</strong>
to <code>Yves-Alexis Perez &lt;corsac@debian.org&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Debian Xfce Maintainers &lt;pkg-xfce-devel@lists.alioth.debian.org&gt;</code>.
 (Fri, 26 Aug 2011 11:27:13 GMT) (<a href="bugreport.cgi?bug=639151;msg=41">full text</a>, <a href="bugreport.cgi?bug=639151;mbox=yes;msg=41">mbox</a>, <a href="#40">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="42"></a><a name="msg42"></a><a href="#42">Message #42</a> received at 639151@bugs.debian.org (<a href="bugreport.cgi?bug=639151;msg=42">full text</a>, <a href="bugreport.cgi?bug=639151;mbox=yes;msg=42">mbox</a>, <a href="mailto:639151@bugs.debian.org?body=On%20Fri%2C%2026%20Aug%202011%2013%3A24%3A42%20%2B0200%20Yves-Alexis%20Perez%20%3Ccorsac%40debian.org%3E%20wrote%3A%0A%3E%20%28droppping%20oss-sec%20in%20order%20to%20not%20be%20too%20noisy%29%0A%3E%20%0A%3E%20On%20ven.%2C%202011-08-26%20at%2010%3A58%20%2B0200%2C%20Yves-Alexis%20Perez%20wrote%3A%0A%3E%20%3E%20%3E%20You%20probably%20dont%20take%20into%20account%20the%20chown%28%29%20that%20happens%20in%20lightdm.%0A%3E%20%3E%20%3E%20Just%20unlink%20the%20created%20~%2F.dmrc%20or%20~%2F.Xauthority%20files%20after%20creation%20and%20make%20a%20symlink%0A%3E%20%3E%20%3E%20to%20%2Fetc%2Fpasswd%20to%20chown%20it%20to%20yourself.%0A%3E%20%3E%20%0A%3E%20%3E%20The%20chown%20will%20be%20applied%20to%20the%20symlink%2C%20not%20the%20target.%20I%27ve%20tried%20to%0A%3E%20%3E%20make%20.Xauthority%20a%20symlink%20to%20a%20root-owned%20file%20and%20the%20destination%20was%0A%3E%20%3E%20indeed%20destroyed%2C%20but%20it%27s%20still%20root-owned.%20%0A%3E%20%0A%3E%20Ok%20that%27s%20wrong%2C%20chown%28%29%20is%20supposed%20to%20dereference%20symlinks%2C%20so%20I%27m%20not%0A%3E%20sure%20why%20the%20target%20file%20wasn%27t%20chown%28%29ed%20in%20my%20case.%0A%3E%20%0A%3E%20I%27ve%20tried%20replacing%20.dmrc%20by%20a%20symlink%20to%20a%20root-owned%20file%20and%2C%20in%0A%3E%20that%20case%3A%0A%3E%20%0A%3E%20%2A%20the%20target%20file%20disappeared%0A%3E%20%2A%20the%20symlink%20disappeared%0A%3E%20%2A%20a%20new%20.dmrc%20file%20was%20written%2C%20belonging%20to%20my%20user%0A%3E%20%0A%3E%20so%20the%20net%20result%20is%20that%20you%20can%20simply%20erase%20any%20root-owned%20file%20in%0A%3E%20that%20case%20%28but%20not%20overwrite%20it%20with%20arbitrary%20content%2C%20afaict%29.%0A%3E%20%0A%3E%20Regards%2C%0A%3E%20--%20%0A%3E%20Yves-Alexis%0A&amp;subject=Re%3A%20%5BPkg-xfce-devel%5D%20Bug%23639151%3A%20Bug%23639151%3A%20Bug%23639151%3A%0A%20Bug%23639151%3A%20Local%20privilege%20escalation&amp;References=%3C20110824163345.3764.96701.reportbug%40pisco.westfalen.local%3E%0A%09%20%3C1314204970.9503.5.camel%40oban%3E%20%3C1314212117.2809.1.camel%40scapa%3E%0A%09%20%3C1314287667.1902.16.camel%40scapa%3E%20%3C20110826084355.GB27079%40suse.de%3E%0A%09%20%3C1314349111.23138.13.camel%40scapa%3E%0A%20%3C1314357886.23138.28.camel%40scapa%3E&amp;In-Reply-To=%3C1314357886.23138.28.camel%40scapa%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=corsac%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Yves-Alexis Perez &lt;corsac@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> 639151@bugs.debian.org</div>
<div class="header"><span class="headerfield">Cc:</span> Sebastian Krahmer &lt;krahmer@suse.de&gt;, Moritz Muehlenhoff
 &lt;jmm@debian.org&gt;,  robert.ancell@canonical.com</div>
<div class="header"><span class="headerfield">Subject:</span> Re: [Pkg-xfce-devel] Bug#639151: Bug#639151: Bug#639151:
 Bug#639151: Local privilege escalation</div>
<div class="header"><span class="headerfield">Date:</span> Fri, 26 Aug 2011 13:24:42 +0200</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=0;bug=639151;msg=42">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message">(droppping oss-sec in order to not be too noisy)

On ven., 2011-08-26 at 10:58 +0200, Yves-Alexis Perez wrote:
&gt; &gt; You probably dont take into account the chown() that happens in lightdm.
&gt; &gt; Just unlink the created ~/.dmrc or ~/.Xauthority files after creation and make a symlink
&gt; &gt; to /etc/passwd to chown it to yourself.
&gt; 
&gt; The chown will be applied to the symlink, not the target. I&#39;ve tried to
&gt; make .Xauthority a symlink to a root-owned file and the destination was
&gt; indeed destroyed, but it&#39;s still root-owned. 

Ok that&#39;s wrong, chown() is supposed to dereference symlinks, so I&#39;m not
sure why the target file wasn&#39;t chown()ed in my case.

I&#39;ve tried replacing .dmrc by a symlink to a root-owned file and, in
that case:

* the target file disappeared
* the symlink disappeared
* a new .dmrc file was written, belonging to my user

so the net result is that you can simply erase any root-owned file in
that case (but not overwrite it with arbitrary content, afaict).

Regards,
-- 
Yves-Alexis
</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=639151;filename=signature.asc;msg=42">signature.asc</a> (application/pgp-signature, inline)]</pre>

<div class="infmessage"><hr><p>
<a name="43"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Debian Xfce Maintainers &lt;pkg-xfce-devel@lists.alioth.debian.org&gt; -->
<!-- time:1314379443 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Debian Xfce Maintainers &lt;pkg-xfce-devel@lists.alioth.debian.org&gt;</code>:<br>
<code>Bug#639151</code>; Package <code>lightdm</code>.
 (Fri, 26 Aug 2011 17:24:03 GMT) (<a href="bugreport.cgi?bug=639151;msg=44">full text</a>, <a href="bugreport.cgi?bug=639151;mbox=yes;msg=44">mbox</a>, <a href="#43">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="45"></a>
<!-- request_addr: Solar Designer &lt;solar@openwall.com&gt; -->
<!-- time:1314379443 -->
<strong>Acknowledgement sent</strong>
to <code>Solar Designer &lt;solar@openwall.com&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Debian Xfce Maintainers &lt;pkg-xfce-devel@lists.alioth.debian.org&gt;</code>.
 (Fri, 26 Aug 2011 17:24:03 GMT) (<a href="bugreport.cgi?bug=639151;msg=46">full text</a>, <a href="bugreport.cgi?bug=639151;mbox=yes;msg=46">mbox</a>, <a href="#45">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="47"></a><a name="msg47"></a><a href="#47">Message #47</a> received at 639151@bugs.debian.org (<a href="bugreport.cgi?bug=639151;msg=47">full text</a>, <a href="bugreport.cgi?bug=639151;mbox=yes;msg=47">mbox</a>, <a href="mailto:639151@bugs.debian.org?subject=Re%3A%20%5Boss-security%5D%20%5BPkg-xfce-devel%5D%20Bug%23639151%3A%20Bug%23639151%3A%20Bug%23639151%3A%20Local%20privilege%20escalation&amp;body=On%20Fri%2C%2026%20Aug%202011%2021%3A14%3A30%20%2B0400%20Solar%20Designer%20%3Csolar%40openwall.com%3E%20wrote%3A%0A%3E%20Hi%2C%0A%3E%20%0A%3E%20I%20haven%27t%20been%20watching%20this%20discussion%20closely%2C%20but%20here%20are%20some%0A%3E%20comments%20that%20might%20be%20of%20help%3A%0A%3E%20%0A%3E%20On%20Fri%2C%20Aug%2026%2C%202011%20at%2011%3A07%3A20AM%20%2B0200%2C%20Yves-Alexis%20Perez%20wrote%3A%0A%3E%20%3E%20Would%20something%20like%3A%0A%3E%20%3E%20%0A%3E%20%3E%20diff%20--git%20a%2Fsrc%2Fdmrc.c%20b%2Fsrc%2Fdmrc.c%0A%3E%20%3E%20index%20bff1da8..9f38faf%20100644%0A%3E%20%3E%20---%20a%2Fsrc%2Fdmrc.c%0A%3E%20%3E%20%2B%2B%2B%20b%2Fsrc%2Fdmrc.c%0A%3E%20%3E%20%40%40%20-80%2C11%20%2B80%2C25%20%40%40%20dmrc_save%20%28GKeyFile%20%2Admrc_file%2C%20const%20gchar%20%2Ausername%29%0A%3E%20%3E%20%20%20%20%20%20%2F%2A%20Update%20the%20users%20.dmrc%20%2A%2F%0A%3E%20%3E%20%20%20%20%20%20if%20%28user%29%0A%3E%20%3E%20%20%20%20%20%20%7B%0A%3E%20%3E%20%2B%20%20%20%20%20%20%2F%2A%20write%20the%20file%20as%20the%20user%20itself%20%2A%2F%0A%3E%20%3E%20%2B%20%20%20%20%20%20pid_t%20pid%3B%0A%3E%20%3E%20%2B%20%20%20%20%20%20pid%20%3D%20fork%28%29%3B%0A%3E%20%3E%20%2B%0A%3E%20%3E%20%2B%20%20%20%20%20%20if%20%28pid%20%3D%3D%200%29%0A%3E%20%3E%20%2B%20%20%20%20%20%20%7B%0A%3E%20%3E%20%2B%20%20%20%20%20%20%20%20if%20%28setuid%20%28user_get_uid%28user%29%29%20%3C%200%29%0A%3E%20%3E%20%2B%20%20%20%20%20%20%20%20%7B%0A%3E%20%3E%20%2B%20%20%20%20%20%20%20%20%20%20g_warning%28%22Error%20changing%20uid%20for%20%25s%3A%20%25s%22%2C%20username%2C%20g_strerror%28errno%29%29%3B%0A%3E%20%3E%20%2B%20%20%20%20%20%20%20%20%20%20_exit%28EXIT_FAILURE%29%3B%0A%3E%20%3E%20%2B%20%20%20%20%20%20%20%20%7D%0A%3E%20%0A%3E%20You%20also%20need%20to%20switch%20gid%20and%20groups%2C%20and%20you%20do%20not%20have%20to%20fork%28%29%20if%0A%3E%20you%20only%20switch%20euid%2Fegid%2Fgroups%20or%20fsuid%2Ffsgid%2Fgroups.%20%20The%20latter%20may%0A%3E%20be%20less%20portable%2C%20but%20at%20least%20on%20Linux%20it%20affects%20only%20the%20current%0A%3E%20thread%20in%20a%20multi-threaded%20process.%20%20Probably%20this%20difference%20is%0A%3E%20irrelevant%20in%20your%20case%2C%20though.%0A%3E%20%0A%3E%20Here%27s%20an%20example%3A%0A%3E%20%0A%3E%20http%3A%2F%2Fgit.altlinux.org%2Fpeople%2Fldv%2Fpackages%2F%3Fp%3Dpam.git%3Ba%3Dcommitdiff%3Bh%3Dpam_modutil_priv%0A%3E%20%0A%3E%20A%20tricky%20part%20is%20what%20to%20do%20when%20you%20have%20partially%20switched%20credentials%0A%3E%20and%20one%20of%20the%20syscalls%20fails%20%28e.g.%2C%20you%27ve%20switched%20the%20gid%20but%20not%20yet%0A%3E%20the%20uid%29.%20%20The%20code%20referenced%20above%20%28Linux-PAM%20commit%29%20tries%20to%20restore%0A%3E%20the%20old%20credentials%2C%20but%20ignores%20possible%20failure%20to%20do%20so.%20%20A%20better%0A%3E%20action%20might%20be%20to%20terminate%20the%20current%20process%20on%20failure%20to%20restore%0A%3E%20old%20credentials.%0A%3E%20%0A%3E%20%3E%20%20%20%20%20%20%20%20%20%20path%20%3D%20g_build_filename%20%28user_get_home_directory%20%28user%29%2C%20%22.dmrc%22%2C%20NULL%29%3B%0A%3E%20%3E%20%20%20%20%20%20%20%20%20%20g_file_set_contents%20%28path%2C%20data%2C%20length%2C%20NULL%29%3B%0A%3E%20%3E%20-%20%20%20%20%20%20%20%20if%20%28getuid%20%28%29%20%3D%3D%200%20%26%26%20chown%20%28path%2C%20user_get_uid%20%28user%29%2C%20user_get_gid%20%28user%29%29%20%3C%200%29%0A%3E%20%3E%20-%20%20%20%20%20%20%20%20%20%20%20%20g_warning%20%28%22Error%20setting%20ownership%20on%20%25s%3A%20%25s%22%2C%20path%2C%20strerror%20%28errno%29%29%3B%0A%3E%20%3E%20%20%20%20%20%20%20%20%20%20g_free%20%28path%29%3B%0A%3E%20%3E%20%2B%20%20%20%20%20%20%20%20_exit%28EXIT_SUCCESS%29%3B%0A%3E%20%3E%20%2B%0A%3E%20%3E%20%2B%20%20%20%20%20%20%7D%0A%3E%20%3E%20%2B%20%20%20%20%20%20if%20%28pid%20%3E%200%29%0A%3E%20%3E%20%2B%20%20%20%20%20%20%20%20wait%28NULL%29%3B%0A%3E%20%3E%20%20%20%20%20%20%7D%0A%3E%20%0A%3E%20You%27re%20lucky%20that%20you%20don%27t%20seem%20to%20need%20to%20pass%20the%20result%20of%0A%3E%20g_file_set_contents%28%29%20back%20to%20the%20parent%20process.%20%20If%20you%20were%20reading%0A%3E%20rather%20than%20writing%20a%20file%2C%20you%27d%20have%20difficulty%20using%20the%20fork%28%29%0A&amp;References=%3C20110824163345.3764.96701.reportbug%40pisco.westfalen.local%3E%20%3C1314204970.9503.5.camel%40oban%3E%20%3C1314212117.2809.1.camel%40scapa%3E%20%3C1314287667.1902.16.camel%40scapa%3E%20%3C20110826084355.GB27079%40suse.de%3E%20%3C1314349111.23138.13.camel%40scapa%3E%20%3C1314349640.23138.14.camel%40scapa%3E%0A%20%3C20110826171430.GA1883%40openwall.com%3E&amp;In-Reply-To=%3C20110826171430.GA1883%40openwall.com%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=solar%40openwall.com" alt="">
<div class="header"><span class="headerfield">From:</span> Solar Designer &lt;solar@openwall.com&gt;</div>
<div class="header"><span class="headerfield">To:</span> Yves-Alexis Perez &lt;corsac@debian.org&gt;</div>
<div class="header"><span class="headerfield">Cc:</span> oss-security@lists.openwall.com, Sebastian Krahmer &lt;krahmer@suse.de&gt;,
	639151@bugs.debian.org, Moritz Muehlenhoff &lt;jmm@debian.org&gt;,
	robert.ancell@canonical.com</div>
<div class="header"><span class="headerfield">Subject:</span> Re: [oss-security] [Pkg-xfce-devel] Bug#639151: Bug#639151: Bug#639151: Local privilege escalation</div>
<div class="header"><span class="headerfield">Date:</span> Fri, 26 Aug 2011 21:14:30 +0400</div>
</div>
<pre class="message">Hi,

I haven&#39;t been watching this discussion closely, but here are some
comments that might be of help:

On Fri, Aug 26, 2011 at 11:07:20AM +0200, Yves-Alexis Perez wrote:
&gt; Would something like:
&gt; 
&gt; diff --git a/src/dmrc.c b/src/dmrc.c
&gt; index bff1da8..9f38faf 100644
&gt; --- a/src/dmrc.c
&gt; +++ b/src/dmrc.c
&gt; @@ -80,11 +80,25 @@ dmrc_save (GKeyFile *dmrc_file, const gchar *username)
&gt;      /* Update the users .dmrc */
&gt;      if (user)
&gt;      {
&gt; +      /* write the file as the user itself */
&gt; +      pid_t pid;
&gt; +      pid = fork();
&gt; +
&gt; +      if (pid == 0)
&gt; +      {
&gt; +        if (setuid (user_get_uid(user)) &lt; 0)
&gt; +        {
&gt; +          g_warning(&quot;Error changing uid for %s: %s&quot;, username, g_strerror(errno));
&gt; +          _exit(EXIT_FAILURE);
&gt; +        }

You also need to switch gid and groups, and you do not have to fork() if
you only switch euid/egid/groups or fsuid/fsgid/groups.  The latter may
be less portable, but at least on Linux it affects only the current
thread in a multi-threaded process.  Probably this difference is
irrelevant in your case, though.

Here&#39;s an example:

<a href="http://git.altlinux.org/people/ldv/packages/?p=pam.git;a=commitdiff;h=pam_modutil_priv">http://git.altlinux.org/people/ldv/packages/?p=pam.git;a=commitdiff;h=pam_modutil_priv</a>

A tricky part is what to do when you have partially switched credentials
and one of the syscalls fails (e.g., you&#39;ve switched the gid but not yet
the uid).  The code referenced above (Linux-PAM commit) tries to restore
the old credentials, but ignores possible failure to do so.  A better
action might be to terminate the current process on failure to restore
old credentials.

&gt;          path = g_build_filename (user_get_home_directory (user), &quot;.dmrc&quot;, NULL);
&gt;          g_file_set_contents (path, data, length, NULL);
&gt; -        if (getuid () == 0 &amp;&amp; chown (path, user_get_uid (user), user_get_gid (user)) &lt; 0)
&gt; -            g_warning (&quot;Error setting ownership on %s: %s&quot;, path, strerror (errno));
&gt;          g_free (path);
&gt; +        _exit(EXIT_SUCCESS);
&gt; +
&gt; +      }
&gt; +      if (pid &gt; 0)
&gt; +        wait(NULL);
&gt;      }

You&#39;re lucky that you don&#39;t seem to need to pass the result of
g_file_set_contents() back to the parent process.  If you were reading
rather than writing a file, you&#39;d have difficulty using the fork()
approach.  However, in your case fork() may actually be fine (but you do
need to drop gid and groups as well).

I hope this helps.

Alexander



</pre>

<div class="infmessage"><hr><p>
<a name="48"></a>
<!-- request_addr: debian-bugs-dist@lists.debian.org, Debian Xfce Maintainers &lt;pkg-xfce-devel@lists.alioth.debian.org&gt; -->
<!-- time:1315461423 -->
<strong>Information forwarded</strong>
to <code>debian-bugs-dist@lists.debian.org, Debian Xfce Maintainers &lt;pkg-xfce-devel@lists.alioth.debian.org&gt;</code>:<br>
<code>Bug#639151</code>; Package <code>lightdm</code>.
 (Thu, 08 Sep 2011 05:57:03 GMT) (<a href="bugreport.cgi?bug=639151;msg=49">full text</a>, <a href="bugreport.cgi?bug=639151;mbox=yes;msg=49">mbox</a>, <a href="#48">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="50"></a>
<!-- request_addr: Yves-Alexis Perez &lt;corsac@debian.org&gt; -->
<!-- time:1315461423 -->
<strong>Acknowledgement sent</strong>
to <code>Yves-Alexis Perez &lt;corsac@debian.org&gt;</code>:<br>
Extra info received and forwarded to list.  Copy sent to <code>Debian Xfce Maintainers &lt;pkg-xfce-devel@lists.alioth.debian.org&gt;</code>.
 (Thu, 08 Sep 2011 05:57:03 GMT) (<a href="bugreport.cgi?bug=639151;msg=51">full text</a>, <a href="bugreport.cgi?bug=639151;mbox=yes;msg=51">mbox</a>, <a href="#50">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="52"></a><a name="msg52"></a><a href="#52">Message #52</a> received at 639151@bugs.debian.org (<a href="bugreport.cgi?bug=639151;msg=52">full text</a>, <a href="bugreport.cgi?bug=639151;mbox=yes;msg=52">mbox</a>, <a href="mailto:639151@bugs.debian.org?body=On%20Thu%2C%2008%20Sep%202011%2007%3A54%3A44%20%2B0200%20Yves-Alexis%20Perez%20%3Ccorsac%40debian.org%3E%20wrote%3A%0A%3E%20On%20jeu.%2C%202011-09-08%20at%2010%3A13%20%2B1000%2C%20Robert%20Ancell%20wrote%3A%0A%3E%20%3E%20On%207%20September%202011%2017%3A30%2C%20Yves-Alexis%20Perez%20%3Ccorsac%40debian.org%3E%20wrote%3A%0A%3E%20%3E%20%3E%20On%20mer.%2C%202011-09-07%20at%2016%3A49%20%2B1000%2C%20Robert%20Ancell%20wrote%3A%0A%3E%20%3E%20%3E%3E%20Lot%27s%20of%20good%20stuff...%0A%3E%20%3E%20%3E%0A%3E%20%3E%20%3E%20Any%20news%20on%20%23834079%20%3F%0A%3E%20%3E%20%0A%3E%20%3E%20I%20was%20going%20to%20put%20that%20in%20this%20release%2C%20but%20I%20think%20it%20might%20take%20a%0A%3E%20%3E%20little%20refactoring%20to%20fit%20in%20well.%20%20So%20send%20me%20angry%20email%20if%20it%27s%20not%0A%3E%20%3E%20in%200.9.6...%20%3A%29%20%20%28And%20if%200.9.6%20isn%27t%20released%20by%20the%20end%20of%20next%20week%29.%0A%3E%20%0A%3E%20Ok%2C%20thanks.%20Feel%20free%20to%20ask%20for%20review%20on%20oss-sec%20list%20if%20needed.%0A%3E%20%0A%3E%20Regards%2C%0A%3E%20--%20%0A%3E%20Yves-Alexis%0A&amp;subject=Re%3A%20%5BLightDM%5D%20Version%200.9.5%20released&amp;In-Reply-To=%3C1315461289.10595.6.camel%40scapa%3E&amp;References=%3CCADsFeGYcGnp%2BLYGhZXxD3QGzsAYd4bWmWVEBJiMYB3mTdNJBUw%40mail.gmail.com%3E%0A%09%20%3C1315380638.23249.1.camel%40scapa%3E%0A%09%20%3CCADsFeGZP42VZUAdSHU1U-qo8ZhD4_0aU5mo%2BD0Mj%2BCzaCqXecQ%40mail.gmail.com%3E%0A%20%3C1315461289.10595.6.camel%40scapa%3E">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=corsac%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Yves-Alexis Perez &lt;corsac@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> Robert Ancell &lt;robert.ancell@gmail.com&gt;</div>
<div class="header"><span class="headerfield">Cc:</span> lightdm@lists.freedesktop.org, 639151@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Re: [LightDM] Version 0.9.5 released</div>
<div class="header"><span class="headerfield">Date:</span> Thu, 08 Sep 2011 07:54:44 +0200</div>
</div>
<pre class="mime">[<a href="bugreport.cgi?att=0;bug=639151;msg=52">Message part 1</a> (text/plain, inline)]</pre>
<pre class="message">On jeu., 2011-09-08 at 10:13 +1000, Robert Ancell wrote:
&gt; On 7 September 2011 17:30, Yves-Alexis Perez &lt;corsac@debian.org&gt; wrote:
&gt; &gt; On mer., 2011-09-07 at 16:49 +1000, Robert Ancell wrote:
&gt; &gt;&gt; Lot&#39;s of good stuff...
&gt; &gt;
&gt; &gt; Any news on #834079 ?
&gt; 
&gt; I was going to put that in this release, but I think it might take a
&gt; little refactoring to fit in well.  So send me angry email if it&#39;s not
&gt; in 0.9.6... :)  (And if 0.9.6 isn&#39;t released by the end of next week).

Ok, thanks. Feel free to ask for review on oss-sec list if needed.

Regards,
-- 
Yves-Alexis
</pre>
<pre class="mime">[<a href="bugreport.cgi?att=1;bug=639151;filename=signature.asc;msg=52">signature.asc</a> (application/pgp-signature, inline)]</pre>

<div class="msgreceived"><hr><p>
<a name="53"></a>
<!-- request_addr: Yves-Alexis Perez &lt;corsac@debian.org&gt; -->
<!-- time:1316081126 -->
<strong>Reply sent</strong>
to <code>Yves-Alexis Perez &lt;corsac@debian.org&gt;</code>:<br>
You have taken responsibility.
 (Thu, 15 Sep 2011 10:05:26 GMT) (<a href="bugreport.cgi?bug=639151;msg=54">full text</a>, <a href="bugreport.cgi?bug=639151;mbox=yes;msg=54">mbox</a>, <a href="#53">link</a>).</p></p></div>

<div class="infmessage"><hr><p>
<a name="55"></a>
<!-- request_addr: Moritz Muehlenhoff &lt;jmm@debian.org&gt; -->
<!-- time:1316081129 -->
<strong>Notification sent</strong>
to <code>Moritz Muehlenhoff &lt;jmm@debian.org&gt;</code>:<br>
Bug acknowledged by developer.
 (Thu, 15 Sep 2011 10:05:29 GMT) (<a href="bugreport.cgi?bug=639151;msg=56">full text</a>, <a href="bugreport.cgi?bug=639151;mbox=yes;msg=56">mbox</a>, <a href="#55">link</a>).</p></p></div>

<hr><p class="msgreceived"><a name="57"></a><a name="msg57"></a><a href="#57">Message #57</a> received at 639151-close@bugs.debian.org (<a href="bugreport.cgi?bug=639151;msg=57">full text</a>, <a href="bugreport.cgi?bug=639151;mbox=yes;msg=57">mbox</a>, <a href="mailto:639151@bugs.debian.org?In-Reply-To=%3CE1R48mm-0004EO-81%40franck.debian.org%3E&amp;References=%3CE1R48mm-0004EO-81%40franck.debian.org%3E&amp;subject=Re%3A%20Bug%23639151%3A%20fixed%20in%20lightdm%200.9.6-1&amp;body=On%20Thu%2C%2015%20Sep%202011%2010%3A03%3A12%20%2B0000%20Yves-Alexis%20Perez%20%3Ccorsac%40debian.org%3E%20wrote%3A%0A%3E%20Source%3A%20lightdm%0A%3E%20Source-Version%3A%200.9.6-1%0A%3E%20%0A%3E%20We%20believe%20that%20the%20bug%20you%20reported%20is%20fixed%20in%20the%20latest%20version%20of%0A%3E%20lightdm%2C%20which%20is%20due%20to%20be%20installed%20in%20the%20Debian%20FTP%20archive%3A%0A%3E%20%0A%3E%20liblightdm-gobject-1-0_0.9.6-1_amd64.deb%0A%3E%20%20%20to%20main%2Fl%2Flightdm%2Fliblightdm-gobject-1-0_0.9.6-1_amd64.deb%0A%3E%20liblightdm-gobject-dev_0.9.6-1_amd64.deb%0A%3E%20%20%20to%20main%2Fl%2Flightdm%2Fliblightdm-gobject-dev_0.9.6-1_amd64.deb%0A%3E%20liblightdm-qt-1-0_0.9.6-1_amd64.deb%0A%3E%20%20%20to%20main%2Fl%2Flightdm%2Fliblightdm-qt-1-0_0.9.6-1_amd64.deb%0A%3E%20liblightdm-qt-dev_0.9.6-1_amd64.deb%0A%3E%20%20%20to%20main%2Fl%2Flightdm%2Fliblightdm-qt-dev_0.9.6-1_amd64.deb%0A%3E%20lightdm-gtk-greeter_0.9.6-1_amd64.deb%0A%3E%20%20%20to%20main%2Fl%2Flightdm%2Flightdm-gtk-greeter_0.9.6-1_amd64.deb%0A%3E%20lightdm-qt-greeter_0.9.6-1_amd64.deb%0A%3E%20%20%20to%20main%2Fl%2Flightdm%2Flightdm-qt-greeter_0.9.6-1_amd64.deb%0A%3E%20lightdm-vala_0.9.6-1_amd64.deb%0A%3E%20%20%20to%20main%2Fl%2Flightdm%2Flightdm-vala_0.9.6-1_amd64.deb%0A%3E%20lightdm_0.9.6-1.debian.tar.gz%0A%3E%20%20%20to%20main%2Fl%2Flightdm%2Flightdm_0.9.6-1.debian.tar.gz%0A%3E%20lightdm_0.9.6-1.dsc%0A%3E%20%20%20to%20main%2Fl%2Flightdm%2Flightdm_0.9.6-1.dsc%0A%3E%20lightdm_0.9.6-1_amd64.deb%0A%3E%20%20%20to%20main%2Fl%2Flightdm%2Flightdm_0.9.6-1_amd64.deb%0A%3E%20lightdm_0.9.6.orig.tar.gz%0A%3E%20%20%20to%20main%2Fl%2Flightdm%2Flightdm_0.9.6.orig.tar.gz%0A%3E%20%0A%3E%20%0A%3E%20%0A%3E%20A%20summary%20of%20the%20changes%20between%20this%20version%20and%20the%20previous%20one%20is%0A%3E%20attached.%0A%3E%20%0A%3E%20Thank%20you%20for%20reporting%20the%20bug%2C%20which%20will%20now%20be%20closed.%20%20If%20you%0A%3E%20have%20further%20comments%20please%20address%20them%20to%20639151%40bugs.debian.org%2C%0A%3E%20and%20the%20maintainer%20will%20reopen%20the%20bug%20report%20if%20appropriate.%0A%3E%20%0A%3E%20Debian%20distribution%20maintenance%20software%0A%3E%20pp.%0A%3E%20Yves-Alexis%20Perez%20%3Ccorsac%40debian.org%3E%20%28supplier%20of%20updated%20lightdm%20package%29%0A%3E%20%0A%3E%20%28This%20message%20was%20generated%20automatically%20at%20their%20request%3B%20if%20you%0A%3E%20believe%20that%20there%20is%20a%20problem%20with%20it%20please%20contact%20the%20archive%0A%3E%20administrators%20by%20mailing%20ftpmaster%40debian.org%29%0A%3E%20%0A%3E%20%0A%3E%20-----BEGIN%20PGP%20SIGNED%20MESSAGE-----%0A%3E%20Hash%3A%20SHA512%0A%3E%20%0A%3E%20Format%3A%201.8%0A%3E%20Date%3A%20Thu%2C%2015%20Sep%202011%2011%3A36%3A21%20%2B0200%0A%3E%20Source%3A%20lightdm%0A%3E%20Binary%3A%20lightdm%20lightdm-gtk-greeter%20lightdm-qt-greeter%20lightdm-vala%20liblightdm-gobject-1-0%20liblightdm-qt-1-0%20liblightdm-gobject-dev%20liblightdm-qt-dev%0A%3E%20Architecture%3A%20source%20amd64%0A%3E%20Version%3A%200.9.6-1%0A%3E%20Distribution%3A%20unstable%0A%3E%20Urgency%3A%20low%0A%3E%20Maintainer%3A%20Debian%20Xfce%20Maintainers%20%3Cpkg-xfce-devel%40lists.alioth.debian.org%3E%0A%3E%20Changed-By%3A%20Yves-Alexis%20Perez%20%3Ccorsac%40debian.org%3E%0A">reply</a>):</p>
<div class="headers">
<img src="/cgi-bin/libravatar.cgi?email=corsac%40debian.org" alt="">
<div class="header"><span class="headerfield">From:</span> Yves-Alexis Perez &lt;corsac@debian.org&gt;</div>
<div class="header"><span class="headerfield">To:</span> 639151-close@bugs.debian.org</div>
<div class="header"><span class="headerfield">Subject:</span> Bug#639151: fixed in lightdm 0.9.6-1</div>
<div class="header"><span class="headerfield">Date:</span> Thu, 15 Sep 2011 10:03:12 +0000</div>
</div>
<pre class="message">Source: lightdm
Source-Version: 0.9.6-1

We believe that the bug you reported is fixed in the latest version of
lightdm, which is due to be installed in the Debian FTP archive:

liblightdm-gobject-1-0_0.9.6-1_amd64.deb
  to main/l/lightdm/liblightdm-gobject-1-0_0.9.6-1_amd64.deb
liblightdm-gobject-dev_0.9.6-1_amd64.deb
  to main/l/lightdm/liblightdm-gobject-dev_0.9.6-1_amd64.deb
liblightdm-qt-1-0_0.9.6-1_amd64.deb
  to main/l/lightdm/liblightdm-qt-1-0_0.9.6-1_amd64.deb
liblightdm-qt-dev_0.9.6-1_amd64.deb
  to main/l/lightdm/liblightdm-qt-dev_0.9.6-1_amd64.deb
lightdm-gtk-greeter_0.9.6-1_amd64.deb
  to main/l/lightdm/lightdm-gtk-greeter_0.9.6-1_amd64.deb
lightdm-qt-greeter_0.9.6-1_amd64.deb
  to main/l/lightdm/lightdm-qt-greeter_0.9.6-1_amd64.deb
lightdm-vala_0.9.6-1_amd64.deb
  to main/l/lightdm/lightdm-vala_0.9.6-1_amd64.deb
lightdm_0.9.6-1.debian.tar.gz
  to main/l/lightdm/lightdm_0.9.6-1.debian.tar.gz
lightdm_0.9.6-1.dsc
  to main/l/lightdm/lightdm_0.9.6-1.dsc
lightdm_0.9.6-1_amd64.deb
  to main/l/lightdm/lightdm_0.9.6-1_amd64.deb
lightdm_0.9.6.orig.tar.gz
  to main/l/lightdm/lightdm_0.9.6.orig.tar.gz



A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 639151@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Yves-Alexis Perez &lt;corsac@debian.org&gt; (supplier of updated lightdm package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Format: 1.8
Date: Thu, 15 Sep 2011 11:36:21 +0200
Source: lightdm
Binary: lightdm lightdm-gtk-greeter lightdm-qt-greeter lightdm-vala liblightdm-gobject-1-0 liblightdm-qt-1-0 liblightdm-gobject-dev liblightdm-qt-dev
Architecture: source amd64
Version: 0.9.6-1
Distribution: unstable
Urgency: low
Maintainer: Debian Xfce Maintainers &lt;pkg-xfce-devel@lists.alioth.debian.org&gt;
Changed-By: Yves-Alexis Perez &lt;corsac@debian.org&gt;
Description: 
 liblightdm-gobject-1-0 - simple display manager (gobject library)
 liblightdm-gobject-dev - simple display manager (gobject development files)
 liblightdm-qt-1-0 - simple display manager (Qt library)
 liblightdm-qt-dev - simple display manager (Qt development files)
 lightdm    - simple display manager
 lightdm-gtk-greeter - simple display manager (GTK+ greeter)
 lightdm-qt-greeter - simple display manager (Qt greeter)
 lightdm-vala - simple display manager (Vala files)
Closes: <a href="bugreport.cgi?bug=639151">639151</a>
Changes: 
 lightdm (0.9.6-1) unstable; urgency=low
 .
   * New upstream release:
     - don&#39;t write user files as root to prevent symlinks attacks
       [<a href="https://security-tracker.debian.org/tracker/CVE-2011-3349">CVE-2011-3349</a>]                                           closes: #<a href="bugreport.cgi?bug=639151">639151</a>
   * debian/patches:
     - 01_set-default-path, 02_default-config, 03_quit-plymouth,
       04_default-gtk-greeter-config refreshed.
     - 05_always-export-XAUTHORITY dropped, included upstream.
     - 05_dont-add-pkglibexecdir-path added, don&#39;t add /usr/lib/lightdm/lightdm
       to the PATH, it&#39;s ugly.
   * debian/rules:
     - don&#39;t install gdmflexiserver script for now until the PATH issue is
       solved.
   * debian/lightdm.install
     - install lightdm-set-default and dm-tool there.
   * debian/lightdm-{gtk,qt}-greeter.{config,templates,postinst,prerm}:
     - provide a way to select the current greeter through debconf. Other
       packages providing a greeter use the same templates/config to register
       themselves in debconf.
   * debian/control:
     - add suggests on accountsservice.
Checksums-Sha1: 
 77c68e52808f2d8648904486dddcaa6cb1b6c0e9 2338 lightdm_0.9.6-1.dsc
 1debe4e00244f93a08faac5b3c4fffbc5f2cafdc 623109 lightdm_0.9.6.orig.tar.gz
 a15621b81341f44dda7ba8ab72ab4d8c1b572c70 31512 lightdm_0.9.6-1.debian.tar.gz
 1ca7999ce4b3f5833c1ca512e271e2a0fdccd82c 113648 lightdm_0.9.6-1_amd64.deb
 9d2a4bfbc8dae90c811657f20dbe25a209b388f0 27312 lightdm-gtk-greeter_0.9.6-1_amd64.deb
 9e4d31a3c5e498b2636b6f250aa1ad164916ce7f 21630 lightdm-qt-greeter_0.9.6-1_amd64.deb
 d0dcf0b70c2d4377530f20353c0604537b1548b5 4044 lightdm-vala_0.9.6-1_amd64.deb
 d3d3bd4d30d2b630d8d2fdf6f9cc76a1667bb82b 28272 liblightdm-gobject-1-0_0.9.6-1_amd64.deb
 4658e49264f46a343b07bf35aa4fc26befb34d15 50496 liblightdm-qt-1-0_0.9.6-1_amd64.deb
 3de1d119fbf87ef383fccb5edc156bcafd48c394 52564 liblightdm-gobject-dev_0.9.6-1_amd64.deb
 73f5f85785487b5df02d34888a23ffd74dbd17a7 62290 liblightdm-qt-dev_0.9.6-1_amd64.deb
Checksums-Sha256: 
 c0ce0aa80475acd4461a7f8f6ffb99afa5374d6dc8e66d83334045e2aefcae69 2338 lightdm_0.9.6-1.dsc
 660c4bd8fd113cb7273beb6a8f2c18e659b676deda499bfb5a09c73fb079fb8d 623109 lightdm_0.9.6.orig.tar.gz
 1cc4b48246fb0b014ae96ec7e3fc84018f5b0c27fdc7b148026846e8411e6c50 31512 lightdm_0.9.6-1.debian.tar.gz
 b3856f0432edc48de3aa743da6793a933375ea3be1d92898573ed70d6296fc0c 113648 lightdm_0.9.6-1_amd64.deb
 0d22d6ee55a6210c39e67206232f131bc0dfcf86c7ff7738f51104f6587d15f1 27312 lightdm-gtk-greeter_0.9.6-1_amd64.deb
 cf8642d2ad13f6cea6d448d7ca9a4a50d54ff8db57ade3562c444e0dc2cd4cd2 21630 lightdm-qt-greeter_0.9.6-1_amd64.deb
 d214ababacf2e79fbd6b5402e5126b1c79adc13cfe6981cbfcb08cf2afa3abee 4044 lightdm-vala_0.9.6-1_amd64.deb
 e7f4bb881589e3944dc0b0b5df9afe52e9b6ee8d6012257f0b0cd74f12fe8244 28272 liblightdm-gobject-1-0_0.9.6-1_amd64.deb
 15587188185891fde13986900498cd61ffa6656a2052b9ec6f0195fe9aff0d38 50496 liblightdm-qt-1-0_0.9.6-1_amd64.deb
 ee3408e5c58e7ee28f99a26334d8b871f378cfa901770a290cc8c31f1b9a4f7e 52564 liblightdm-gobject-dev_0.9.6-1_amd64.deb
 3579b32fd15f3b069e00b2630fde5e7a3a7764b222f9f2f9a52034e479314846 62290 liblightdm-qt-dev_0.9.6-1_amd64.deb
Files: 
 a5b238a5c40140b847b0dc848141666e 2338 x11 optional lightdm_0.9.6-1.dsc
 088cb083185e39f9a5be846aab270e3c 623109 x11 optional lightdm_0.9.6.orig.tar.gz
 89547715255fdfe6cb595c5c987cb829 31512 x11 optional lightdm_0.9.6-1.debian.tar.gz
 56fb86e075114b570b9c3f15be8a7e10 113648 x11 optional lightdm_0.9.6-1_amd64.deb
 f23dfd47c231a628dfd0921cf9feee63 27312 x11 optional lightdm-gtk-greeter_0.9.6-1_amd64.deb
 be0f22afcd844dd31faf48fd903a8a74 21630 x11 optional lightdm-qt-greeter_0.9.6-1_amd64.deb
 071edaecacb3621b7b256cac929618ff 4044 x11 optional lightdm-vala_0.9.6-1_amd64.deb
 64ae5e0c486664668e72fa38fe6ec031 28272 libdevel optional liblightdm-gobject-1-0_0.9.6-1_amd64.deb
 d53f5593bfa83e2e21c8351c44282b8a 50496 libdevel optional liblightdm-qt-1-0_0.9.6-1_amd64.deb
 325c9d5572f13e9eb1d571197fdbde92 52564 libdevel optional liblightdm-gobject-dev_0.9.6-1_amd64.deb
 83e36b2a79927d1ba2d327f857df6191 62290 libdevel optional liblightdm-qt-dev_0.9.6-1_amd64.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (GNU/Linux)

iQIcBAEBCgAGBQJOcckUAAoJEDBVD3hx7wuoXokQAJoeUcxbrrRc4fLXfYQHfMEf
a2K8Wy8CXYusisHJRIXpT1Zu91pABgfHxH6r1xxeS4RLMfgcHRtIP4ct+rDZWa5C
TxzXuoL3X6v9nCyrCuvkK6XCB82jz0GunXtrXGvgJ44CxVUFtjLwzwWdClXR7snn
O0XqW/LMC27zyNitFpgZUfAx02okjr/XRmUb0ieyIzZjYRUkXcTstkRB0SfGSYlS
YHLpcCjUKxnuo+Fo++dUt+WgOtZjapqrIXXUB5ESZ+pbfocKRglMczefUDTBqkTs
K8hdGCptp8RgNh7L2KNLENsJSoiHoZXJs22hpFHH7SMaxJLQ+OA/9hDD0MsdG9ta
CswXbt7u+aOOmuijEqRqYBpgSmNB5Q+qTPkTLrtiptYMcisjydN8Fj49ZuUJYYYK
atU9kW2Kpu4JXG2GTJuzGWoBdqd0utigjjLEMGGB+WgFZpYcfoc85/fc2Zo0QLkP
y5ThWHJYNNJHUaBQD5Mr2ph8mZfBKdBUQUiD4le8D0cPgYKDLV4KmRrNwocAEmlQ
tvwDPISg71cuHm6uoZkl1WGOetNaKkfunNDrv7+KvWNzL+yUXYhZeZmdRmtdRhQT
b8isQMovEX+ejxKT/+JeqfkHKigah3RkHfnxgLzY2K1WL8edzAqZTf76Ypou5rMH
Yo7zDta3kKU23edEfyW8
=wpSM
-----END PGP SIGNATURE-----




</pre>

<div class="msgreceived"><hr><p>
<a name="58"></a>
<!-- command:archive -->
<!-- requester: Debbugs Internal Request &lt;owner@bugs.debian.org&gt; -->
<!-- request_addr: internal_control@bugs.debian.org -->
<!-- time:1318577724 -->
<!-- new_data:
$new_data = {};
-->
<!-- old_data:
$old_data = {};
-->
<strong>Bug archived.</strong>
Request was from <code>Debbugs Internal Request &lt;owner@bugs.debian.org&gt;</code>
to <code>internal_control@bugs.debian.org</code>.
 (Fri, 14 Oct 2011 07:35:24 GMT) (<a href="bugreport.cgi?bug=639151;msg=59">full text</a>, <a href="bugreport.cgi?bug=639151;mbox=yes;msg=59">mbox</a>, <a href="#58">link</a>).</p></p></div>

<hr>
<p class="msgreceived">Send a report that <a href="https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=639151">this bug log contains spam</a>.</p>
<hr>
<ADDRESS>Debian bug tracking system administrator &lt;<A HREF="mailto:owner@bugs.debian.org">owner@bugs.debian.org</A>&gt;.
Last modified:
<!--timestamp-->Sat Oct 30 18:27:09 2021<!--end timestamp-->; 
Machine Name:
<!--machinename-->buxtehude<!--machinename-->
<P>
<A HREF="https://www.debian.org/Bugs/">Debian Bug tracking system</A>
</p>
<p>
  Debbugs is free software and licensed under the terms of the GNU
  Public License version 2. The current version can be obtained
  from <a href="https://bugs.debian.org/debbugs-source/">https://bugs.debian.org/debbugs-source/</a>.
</p>
<p>
Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.
</p>
</ADDRESS>

</body>
</html>
