<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="UTF-8">
<meta property="og:type" content="website">
<meta property="og:title" content="1464056 - (CVE-2018-12373) [efail] S/MIME plaintext can be leaked through HTML reply/forward">
<meta property="og:url" content="https://bugzilla.mozilla.org/show_bug.cgi?id=1464056">
<meta property="og:description"
      content="RESOLVED (mkmelin+mozilla) in Thunderbird - Security. Last updated 2020-02-16.">
<meta name="twitter:label1" value="Type">
<meta name="twitter:data1" value="defect">
<meta name="twitter:label2" value="Priority">
<meta name="twitter:data2" value="--">

    <meta name="viewport" content="width=1024">
    <meta name="color-scheme" content="dark light">
    <meta name="generator" content="Bugzilla 20211025.1">
    <meta name="bugzilla-global" content="dummy"
        id="bugzilla-global" data-bugzilla="{&quot;api_token&quot;:&quot;&quot;,&quot;config&quot;:{&quot;basepath&quot;:&quot;\/&quot;},&quot;constant&quot;:{&quot;COMMENT_COLS&quot;:80},&quot;param&quot;:{&quot;maxattachmentsize&quot;:&quot;10240&quot;,&quot;maxusermatches&quot;:&quot;50&quot;,&quot;splinter_base&quot;:&quot;\/page.cgi?id=splinter.html&amp;ignore=\/&quot;},&quot;string&quot;:{&quot;bug_type_required&quot;:&quot;You must select a Type for this bug&quot;,&quot;component_required&quot;:&quot;You must select a Component for this bug&quot;,&quot;description_required&quot;:&quot;You must enter a Description for this bug&quot;,&quot;short_desc_required&quot;:&quot;You must enter a Summary for this bug&quot;,&quot;version_required&quot;:&quot;You must select a Version for this bug&quot;},&quot;user&quot;:{&quot;is_new&quot;:1,&quot;login&quot;:&quot;&quot;}}">
    <title>1464056 - (CVE-2018-12373) [efail] S/MIME plaintext can be leaked through HTML reply/forward</title>

<link rel="Top" href="/">

  


  
    <link rel="Show" title="Dependency Tree"
          href="/showdependencytree.cgi?id=1464056&amp;hide_resolved=1">
      <link rel="Show" title="Dependency Graph"
            href="/showdependencygraph.cgi?id=1464056">

      <link rel="Show" title="Bug Activity"
            href="/show_activity.cgi?id=1464056">

<link href="/static/v20211025.1/skins/yui.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/standard/global.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BugModal/web/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BMO/web/styles/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/EditComments/web/styles/inline-editor.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-structure-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-theme-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/lib/prism.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Needinfo/web/styles/needinfo.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Review/web/styles/badge.css" rel="stylesheet" type="text/css">



    
<script nonce="kHuvwnofv0ajoiixz64dVy0gyzDjcRizAsvFh9DfBwuLw5Q8" src="/static/v20211025.1/js/jquery/jquery-min.js"></script><script nonce="kHuvwnofv0ajoiixz64dVy0gyzDjcRizAsvFh9DfBwuLw5Q8" src="/static/v20211025.1/js/jquery/ui/jquery-ui-min.js"></script><script nonce="kHuvwnofv0ajoiixz64dVy0gyzDjcRizAsvFh9DfBwuLw5Q8" src="/static/v20211025.1/js/yui.js"></script><script nonce="kHuvwnofv0ajoiixz64dVy0gyzDjcRizAsvFh9DfBwuLw5Q8" src="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu-min.js"></script><script nonce="kHuvwnofv0ajoiixz64dVy0gyzDjcRizAsvFh9DfBwuLw5Q8" src="/static/v20211025.1/js/jquery/plugins/devbridgeAutocomplete/devbridgeAutocomplete-min.js"></script><script nonce="kHuvwnofv0ajoiixz64dVy0gyzDjcRizAsvFh9DfBwuLw5Q8" src="/static/v20211025.1/js/global.js"></script><script nonce="kHuvwnofv0ajoiixz64dVy0gyzDjcRizAsvFh9DfBwuLw5Q8" src="/static/v20211025.1/js/util.js"></script><script nonce="kHuvwnofv0ajoiixz64dVy0gyzDjcRizAsvFh9DfBwuLw5Q8" src="/static/v20211025.1/js/dropdown.js"></script>

      <script nonce="kHuvwnofv0ajoiixz64dVy0gyzDjcRizAsvFh9DfBwuLw5Q8">
          YAHOO.namespace('bugzilla');
          if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
              YAHOO.util.Event._simpleRemove(window, "unload",
                                             YAHOO.util.Event._unload);
          }BUGZILLA.value_descs = JSON.parse('{\"bug_status\":{},\"resolution\":{\"\":\"---\"}}');

  
    var tracking_flags_str = "{\"flags\":{\"tracking\":{\"cf_status_thunderbird_93\":\"---\",\"cf_status_thunderbird_esr78\":\"---\",\"cf_tracking_thunderbird_94\":\"---\",\"cf_status_thunderbird_61\":\"wontfix\",\"cf_status_thunderbird_62\":\"fixed\",\"cf_status_thunderbird_esr60\":\"fixed\",\"cf_tracking_thunderbird_esr91\":\"---\",\"cf_status_thunderbird_95\":\"---\",\"cf_status_thunderbird_94\":\"---\",\"cf_status_thunderbird_esr52\":\"fixed\",\"cf_status_thunderbird_60\":\"fixed\",\"cf_tracking_thunderbird_95\":\"---\",\"cf_tracking_thunderbird_93\":\"---\",\"cf_tracking_thunderbird_esr78\":\"---\",\"cf_status_thunderbird_esr91\":\"---\"}},\"types\":[\"tracking\"],\"comments\":{}}";
    var TrackingFlags = $.parseJSON(tracking_flags_str);

  

  
  BUGZILLA.bug_id = 1464056;
  BUGZILLA.bug_title = '1464056 - (CVE-2018-12373) [efail] S\/MIME plaintext can be leaked through HTML reply\/forward';
  BUGZILLA.bug_summary = '[efail] S\/MIME plaintext can be leaked through HTML reply\/forward';
  BUGZILLA.bug_url = 'https:\/\/bugzilla.mozilla.org\/show_bug.cgi?id=1464056';
  BUGZILLA.bug_keywords = 'csectype-disclosure, sec-high',
  BUGZILLA.user = {
    id: 0,
    login: '',
    is_insider: false,
    is_timetracker: false,
    can_tag: false,
    timezone: 'America\/Los_Angeles',
    settings: {
      quote_replies: 'quoted_reply',
      zoom_textareas: true,
      remember_collapsed: true,
      inline_attachments: true,
      autosize_comments: false
    }
  };

  BUGZILLA.bug_secure = false;
      </script>
<script nonce="kHuvwnofv0ajoiixz64dVy0gyzDjcRizAsvFh9DfBwuLw5Q8" src="/static/v20211025.1/extensions/BugModal/web/autosize.min.js"></script><script nonce="kHuvwnofv0ajoiixz64dVy0gyzDjcRizAsvFh9DfBwuLw5Q8" src="/static/v20211025.1/extensions/ProdCompSearch/web/js/prod_comp_search.js"></script><script nonce="kHuvwnofv0ajoiixz64dVy0gyzDjcRizAsvFh9DfBwuLw5Q8" src="/static/v20211025.1/extensions/BugModal/web/bug_modal.js"></script><script nonce="kHuvwnofv0ajoiixz64dVy0gyzDjcRizAsvFh9DfBwuLw5Q8" src="/static/v20211025.1/extensions/BugModal/web/comments.js"></script><script nonce="kHuvwnofv0ajoiixz64dVy0gyzDjcRizAsvFh9DfBwuLw5Q8" src="/static/v20211025.1/extensions/ComponentWatching/web/js/overlay.js"></script><script nonce="kHuvwnofv0ajoiixz64dVy0gyzDjcRizAsvFh9DfBwuLw5Q8" src="/static/v20211025.1/js/bugzilla-readable-status-min.js"></script><script nonce="kHuvwnofv0ajoiixz64dVy0gyzDjcRizAsvFh9DfBwuLw5Q8" src="/static/v20211025.1/js/field.js"></script><script nonce="kHuvwnofv0ajoiixz64dVy0gyzDjcRizAsvFh9DfBwuLw5Q8" src="/static/v20211025.1/js/comments.js"></script><script nonce="kHuvwnofv0ajoiixz64dVy0gyzDjcRizAsvFh9DfBwuLw5Q8" src="/static/v20211025.1/extensions/TrackingFlags/web/js/flags.js"></script><script nonce="kHuvwnofv0ajoiixz64dVy0gyzDjcRizAsvFh9DfBwuLw5Q8" src="/static/v20211025.1/extensions/BMO/web/js/firefox-crash-table.js"></script><script nonce="kHuvwnofv0ajoiixz64dVy0gyzDjcRizAsvFh9DfBwuLw5Q8" src="/static/v20211025.1/extensions/MozChangeField/web/js/severity-s1-priority-p1.js"></script><script nonce="kHuvwnofv0ajoiixz64dVy0gyzDjcRizAsvFh9DfBwuLw5Q8" src="/static/v20211025.1/extensions/MozChangeField/web/js/clear-tracking-priority-s1.js"></script><script nonce="kHuvwnofv0ajoiixz64dVy0gyzDjcRizAsvFh9DfBwuLw5Q8" src="/static/v20211025.1/extensions/MozChangeField/web/js/set-tracking-severity-s1.js"></script><script nonce="kHuvwnofv0ajoiixz64dVy0gyzDjcRizAsvFh9DfBwuLw5Q8" src="/static/v20211025.1/js/lib/prism.js"></script><script nonce="kHuvwnofv0ajoiixz64dVy0gyzDjcRizAsvFh9DfBwuLw5Q8" src="/static/v20211025.1/extensions/GoogleAnalytics/web/js/analytics.js"></script><script nonce="kHuvwnofv0ajoiixz64dVy0gyzDjcRizAsvFh9DfBwuLw5Q8" src="/static/v20211025.1/js/lib/md5.min.js"></script><script nonce="kHuvwnofv0ajoiixz64dVy0gyzDjcRizAsvFh9DfBwuLw5Q8" src="/static/v20211025.1/extensions/Review/web/js/badge.js"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla@Mozilla" href="/search_plugin.cgi"><link rel="shortcut icon" href="/extensions/BMO/web/images/favicon.ico">
<link rel="canonical" href="https://bugzilla.mozilla.org/show_bug.cgi?id=1464056">
<link rel="shorturl" href="https://bugzilla.mozilla.org/1464056"><meta name="google-analytics" content="UA-36116321-3" data-location="https://bugzilla.mozilla.org/bug/show-modal" data-title="1464056 - (CVE-2018-12373) [efail] S/MIME plaintext can be leaked through HTML reply/forward">
<script async src="https://www.google-analytics.com/analytics.js"></script><meta name="robots" content="noarchive">
  </head>



  <body
        class="bugzilla-mozilla-org
               skin-standard bug_modal yui-skin-sam">



<div id="wrapper">

<header id="header" role="banner">
  <div class="inner">
    <h1 id="header-title" class="title"><a href="https://bugzilla.mozilla.org/home" title="Go to home page">Bugzilla</a></h1>
    <form role="search" id="header-search" class="quicksearch" action="/buglist.cgi" data-no-csrf>
      <section class="searchbox-outer dropdown" role="combobox" aria-expanded="false" aria-haspopup="listbox"
               aria-labelledby="header-search-label" aria-owns="header-search-dropdown">
        <h2 id="header-search-label">Quick Search</h2>
        <span class="icon" aria-hidden="true"></span>
        <input role="searchbox" id="quicksearch_top" class="dropdown-button" name="quicksearch" autocomplete="off"
               value="" placeholder="Search Bugs"
               title="Enter a bug number or some search terms" aria-controls="header-search-dropdown"
               aria-label="Quick Search"><div id="header-search-dropdown" class="dropdown-content right" role="listbox" style="display: none;">
  <div id="header-search-dropdown-wrapper">
  </div>
</div>
      </section>
    </form>
    <nav id="header-nav">
      <ul class="links">
        <li class="link-browse">
          <a href="/describecomponents.cgi" title="Browse bugs by component">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Browse</span>
          </a>
        </li>
        <li class="link-search">
          <a href="/query.cgi?format=advanced" title="Search bugs using various criteria">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Advanced Search</span>
          </a>
        </li>
      </ul>
      <div class="dropdown">
        <button type="button" id="header-tools-menu-button" class="dropdown-button minor" title="More tools…"
                aria-label="More tools…" aria-expanded="false" aria-haspopup="true" aria-controls="header-tools-menu">
          <span class="icon" aria-hidden="true"></span>
        </button>
        <ul class="dropdown-content left" id="header-tools-menu" role="menu" style="display:none;">
          <li role="presentation">
            <a href="/report.cgi" role="menuitem" tabindex="-1">Reports</a>
          </li>
            <li role="separator"></li>
            <li role="presentation">
              <a href="https://bmo.readthedocs.io/en/latest/" role="menuitem" tabindex="-1">Documentation</a>
            </li>
        </ul>
      </div>
    </nav>
      <ul id="header-login" class="links">
          <li id="moz_new_account_container_top"><a href="/createaccount.cgi">New Account</a></li><li id="mini_login_container_top">
  <a id="login_link_top" href="/index.cgi?GoAheadAndLogIn=1"
     class='show_mini_login_form' data-qs-suffix="_top">Log In</a>

  <div id="mini_login_top" class="mini-popup mini_login bz_default_hidden"><span id="github_mini_login_top" class="mini_login_top">
    <form method="post" action="/github.cgi">
      <input type="hidden" name="github_secret" value="AWOi5EzsrbEpXhUY0WkB9CHhCcWizvqdFmDGFzUD1VILXxXv5aEO0wGOliUW7fJbnzIuIYJODAFdQU6z0J9CSDutCEiqMFkRZ13CgZ19Okey4XCBwJwJCBUMFPy0ruoFaKVW5ICRd92ONVmEW456HdJoKr74wlWiGN1fk5CPzhvNfAsUbnwYpdJTbmpVSm3RSjfKM4FQWPj4z0XYS2Q02lEQJgSiyX6v2CTWcCTrZTiMkY6Ukc83uOsjk8RjCrC0">
      <input type="hidden" name="target_uri" value="https://bugzilla.mozilla.org/show_bug.cgi">
      <input type="image" src="/extensions/GitHubAuth/web/images/sign_in.png" height="22" width="75" align="absmiddle"
             alt="Sign in with GitHub"
             title="Sign in with GitHub"> or
    </form>
  </span>

  <form action="/show_bug.cgi?id=1464056" method="POST"
        data-qs-suffix="_top">

    <input id="Bugzilla_login_top"
           class="bz_login"
           name="Bugzilla_login"
           title="Login"
           placeholder="Email"
           aria-label="Email"
           type="email"
           required
    >
    <input class="bz_password"
           id="Bugzilla_password_top"
           name="Bugzilla_password"
           type="password"
           title="Password"
           placeholder="Password"
           aria-label="Password"
           required
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text"
           id="Bugzilla_password_dummy_top" value="password"
           title="Password"
    >
      <input type="checkbox" id="Bugzilla_remember_top"
             name="Bugzilla_remember" value="on" class="bz_remember"
                 checked>
      <label for="Bugzilla_remember_top">Remember</label>
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
           class="check_mini_login_fields"
            id="log_in_top">
    <a href="#" id="hide_mini_login_top" aria-label="Close"
       class="close-button hide_mini_login_form" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
<li id="forgot_container_top">
  <a id="forgot_link_top" href="/index.cgi?GoAheadAndLogIn=1#forgot"
     class='show_forgot_form'
     data-qs-suffix="_top">Forgot Password</a>
  <div id="forgot_form_top" class="mini-popup mini_forgot bz_default_hidden">
  <form action="/token.cgi" method="post">
    <input type="email" name="loginname" size="20" placeholder="Email" aria-label="Email" required>
    <input id="forgot_button_top" value="Reset Password"
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <input type="hidden" id="token_top" name="token" value="1635623340-LNHpKUKLeLggHeDkZeKumU_7yEZnh2zH7Zzbq8H6QEo">
    <a href="#" class="close-button hide_forgot_form" aria-label="Close" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
      </ul><div id="header-external-links" class="dropdown first">
  <button type="button" id="header-external-menu-button" class="dropdown-button minor" title="Mozilla"
          aria-label="Mozilla" aria-expanded="false" aria-haspopup="true" aria-controls="header-external-menu">
    <img src="/static/v20211025.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg" width="32" height="32" alt="">
  </button>
  <ul class="dropdown-content right" id="header-external-menu" role="menu" style="display:none;">
    <li role="presentation">
      <a href="https://www.mozilla.org/" role="menuitem" tabindex="-1">Mozilla Home</a>
    </li>
    <li role="separator"></li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/" role="menuitem" tabindex="-1">Privacy</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/#cookies" role="menuitem" tabindex="-1">Cookies</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/about/legal/" role="menuitem" tabindex="-1">Legal</a>
    </li>
  </ul>
</div>
  </div>
</header> 


<main id="bugzilla-body" tabindex="-1">

<aside id="message-container" role="complementary">
  <noscript>
    <div class="noscript">
      <div class="inner">
        <p>Please enable JavaScript in your browser to use all the features on this site.</p>
      </div>
    </div>
  </noscript>
</aside>

<div id="main-inner">




<div role="toolbar" id="page-toolbar">
  <div role="group" class="buttons">
    <button type="button" id="copy-summary" class="secondary"
      title="Copy bug number and summary to your clipboard">Copy Summary</button>
    <div id="clip-container" style="display:none"><input type="text" id="clip"></div>
    <div class="dropdown">
      <button type="button" id="action-menu-btn" aria-haspopup="true" aria-label="View"
        aria-expanded="false" aria-controls="action-menu" class="dropdown-button secondary">View &#9662;</button>
      <ul class="dropdown-content left" id="action-menu" role="menu" style="display:none;">
        <li role="presentation">
          <a id="action-reset" role="menuitem" tabindex="-1">Reset Sections</a>
        </li>
        <li role="presentation">
          <a id="action-expand-all" role="menuitem" tabindex="-1">Expand All Sections</a>
        </li>
        <li role="presentation">
          <a id="action-collapse-all" role="menuitem" tabindex="-1">Collapse All Sections</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a id="action-history" role="menuitem" tabindex="-1">History</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a href="/rest/bug/1464056" role="menuitem" tabindex="-1">JSON</a>
        </li>
        <li role="presentation">
          <a href="/show_bug.cgi?ctype=xml&amp;id=1464056" role="menuitem" tabindex="-1">XML</a>
        </li>
      </ul>
    </div>
  </div>
</div>



<div role="status" id="io-error" style="display:none"></div>
<div role="status" id="floating-message" style="display:none">
  <div id="floating-message-text"></div>
</div>
<section class="module"
>
  <div class="module-content"
  >
  <div id="summary-container">
    <div class="field indent" id="field-status_summary"
>


  
    <div class=" container">
        <span id="field-value-status_summary">
      <span class="bug-status-label text" data-status="closed">Closed</span>
      <span id="field-value-bug_id">
        <a href="/show_bug.cgi?id=1464056">Bug 1464056</a>
          <span class="edit-hide">(CVE-2018-12373)</span>
      </span>
      <span>
        <span class="bug-time-label">Opened <span class="rel-time" title="2018-05-24 06:04 PDT" data-time="1527167042">4 years ago</span></span>
          <span class="bug-time-label">Closed <span class="rel-time" title="2018-06-18 23:15 PDT" data-time="1529388925">3 years ago</span></span>
      </span>
        </span>
    </div>

  
</div>
<div class="field indent edit-hide"
>


  
    <div class=" container">
      

      <h1 id="field-value-short_desc">[efail] S/MIME plaintext can be leaked through HTML reply/forward</h1>
    </div>

  
</div>

    <div class="field edit-show" id="field-short_desc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc" id="short_desc-help-link" class="help">Summary:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-short_desc">
            [efail] S/MIME plaintext can be leaked through HTML reply/forward

        </span>
    </div>

  
</div>
  </div>
  </div>
</section>


<section class="module" id="module-categories"
>
    <header id="module-categories-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Categories section"
           data-label-collapsed="Expand Categories section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-categories-content"
             aria-expanded="true"
             aria-labeledby="module-categories-title"
             aria-describedby="module-categories-subtitle"></div>
        <h2 class="module-title" id="module-categories-title">Categories</h2>
          <h3 class="module-subtitle" id="module-categories-subtitle">
            (Thunderbird :: Security, defect)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-categories-content"
  ><div class="fields-lhs">

    <div class="field" id="field-product"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=Thunderbird" id="product-help-link" class="help">Product:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-product">
      <div class="name-info-outer dropdown">
        <span id="product-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="product-info">Thunderbird
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="product-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Product description and actions">
          <header>
            <div class="title">Thunderbird</div>
            <div class="description">For bugs in the Thunderbird mail client front-end. Bugs in the back-end (e.g. protocols) should be filed under MailNews Core. Bugs in Thunderbird's built in calendar and chat features should be filed in the Calendar or Chat components respectively.</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=Thunderbird&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Product</a></div>
            <div><a href="/enter_bug.cgi?product=Thunderbird"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Product</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="Thunderbird"
                         data-label-watch="Watch This Product" data-label-unwatch="Unwatch This Product"
                         data-source="BugModal">Watch This Product</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-component"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=Thunderbird&component=Security#Security" id="component-help-link" class="help">Component:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-component">
      <div class="name-info-outer dropdown">
        <span id="component-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="component-info">Security
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="component-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Component description and actions">
          <header>
            <div class="title">Thunderbird :: Security</div>
            <div class="description">For app-level security bugs.
<p>
If the problem relates to underlying components (PSM, NSS, Core, Toolkit) then please file it in the appropriate product instead of here.</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=Thunderbird&amp;component=Security&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Component</a></div>
            <div><a href="/buglist.cgi?product=Thunderbird&amp;component=Security&amp;chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__"
                    target="_blank" role="menuitem" tabindex="-1">Recently Fixed Bugs in This Component</a></div>
            <div><a href="/enter_bug.cgi?product=Thunderbird&amp;component=Security"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Component</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="Thunderbird" data-component="Security"
                         data-label-watch="Watch This Component" data-label-unwatch="Unwatch This Component"
                         data-source="BugModal">Watch This Component</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-version" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#version" id="version-help-link" class="help">Version:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-version">
            unspecified

        </span>
    </div>

  
</div>

    <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform" id="-help-link" class="help">Platform:
        </a>
    </div>


  
    <div class=" container"><div class="field inline" id="field-rep_platform"
>


  
    <div class="value">
        <span id="field-value-rep_platform">
            Unspecified

        </span>
    </div>

  
</div><div class="field indent inline" id="field-op_sys"
>


  
    <div class="value">
        <span id="field-value-op_sys">
            Unspecified

        </span>
    </div>

  
</div><div class="field indent inline"
>


  
    <div class=" container">
    </div>

  
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field contains-buttons" id="field-bug_type"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type" id="bug_type-help-link" class="help">Type:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_type">
      <span class="bug-type-label iconic-text" data-type="defect">
        <span class="icon" aria-hidden="true"></span>defect</span>
        </span>
    </div>

  
</div>

    <div class="field" id="field-importance"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority" id="importance-help-link" class="help">Priority:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-importance"><div class="field inline" id="field-priority"
>


  
    <div class="value">
        <span id="field-value-priority">
          <em>Not set</em>
        </span>
    </div>

  
</div><div class="field inline" id="field-bug_severity"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity" id="bug_severity-help-link" class="help">Severity:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_severity">
            normal

        </span>
    </div>

  
</div>
        </span>
    </div>

  
</div>

    
</div>
  </div>
</section>


<section class="module" id="module-tracking"
>
    <header id="module-tracking-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Tracking section"
           data-label-collapsed="Expand Tracking section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-tracking-content"
             aria-expanded="true"
             aria-labeledby="module-tracking-title"
             aria-describedby="module-tracking-subtitle"></div>
        <h2 class="module-title" id="module-tracking-title">Tracking</h2>
          <h3 class="module-subtitle" id="module-tracking-subtitle">
            (thunderbird_esr52 fixed, thunderbird_esr60 fixed, thunderbird60 fixed, thunderbird61 wontfix, thunderbird62 fixed)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-tracking-content"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-status-view"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-view-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-view">RESOLVED
        FIXED
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-status-edit" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-edit-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-edit"><div class="field inline" id="field-bug_status"
>


  
    <div class="value">
        <span id="field-value-bug_status">
            RESOLVED

        </span>
    </div>

  
</div><div class="field indent inline" id="field-resolution"
>


  
    <div class="value">
        <span id="field-value-resolution">
            FIXED

        </span>
    </div>

  
</div>
  <div id="status-action-buttons">
      <div id="assigned-container" style="display:none">
        <button type="button" class="secondary" id="mark-as-assigned-btn">
          Mark as Assigned
        </button>
      </div>
  </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-target_milestone"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone" id="target_milestone-help-link" class="help">Milestone:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-target_milestone">
            Thunderbird 62.0

        </span>
    </div>

  
</div>

    


</div><div class="fields-rhs">

      <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Tracking Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-hide">
    <table class="layout-table tracking-flags">
        <tr>
          <th></th>
          <th>Tracking</th>
          <th>Status</th>
        </tr>
        <tr>
          <td class="tracking-flag-name">thunderbird_esr52</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_thunderbird_esr52&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">thunderbird_esr60</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_thunderbird_esr60&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">thunderbird60</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_thunderbird_60&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">thunderbird61</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_thunderbird_61&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">thunderbird62</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_thunderbird_62&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
    </table>
  </div>


<div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <th></th>
        <th>Tracking</th>
        <th>Status</th>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr52</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr52-dirty">
  <select id="cf_status_thunderbird_esr52" name="cf_status_thunderbird_esr52">
        <option value="fixed"
          id="v3090_cf_status_thunderbird_esr52" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr60</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr60-dirty">
  <select id="cf_status_thunderbird_esr60" name="cf_status_thunderbird_esr60">
        <option value="fixed"
          id="v3777_cf_status_thunderbird_esr60" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr78-dirty">
  <select id="cf_tracking_thunderbird_esr78" name="cf_tracking_thunderbird_esr78">
        <option value="---"
          id="v4823_cf_tracking_thunderbird_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr78-dirty">
  <select id="cf_status_thunderbird_esr78" name="cf_status_thunderbird_esr78">
        <option value="---"
          id="v4829_cf_status_thunderbird_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr91-dirty">
  <select id="cf_tracking_thunderbird_esr91" name="cf_tracking_thunderbird_esr91">
        <option value="---"
          id="v5236_cf_tracking_thunderbird_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr91-dirty">
  <select id="cf_status_thunderbird_esr91" name="cf_status_thunderbird_esr91">
        <option value="---"
          id="v5242_cf_status_thunderbird_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird60</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_60-dirty">
  <select id="cf_status_thunderbird_60" name="cf_status_thunderbird_60">
        <option value="fixed"
          id="v3574_cf_status_thunderbird_60" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird61</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_61-dirty">
  <select id="cf_status_thunderbird_61" name="cf_status_thunderbird_61">
        <option value="wontfix"
          id="v3683_cf_status_thunderbird_61" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird62</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_62-dirty">
  <select id="cf_status_thunderbird_62" name="cf_status_thunderbird_62">
        <option value="fixed"
          id="v3765_cf_status_thunderbird_62" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird93</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_93-dirty">
  <select id="cf_tracking_thunderbird_93" name="cf_tracking_thunderbird_93">
        <option value="---"
          id="v5262_cf_tracking_thunderbird_93" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_93-dirty">
  <select id="cf_status_thunderbird_93" name="cf_status_thunderbird_93">
        <option value="---"
          id="v5256_cf_status_thunderbird_93" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird94</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_94-dirty">
  <select id="cf_tracking_thunderbird_94" name="cf_tracking_thunderbird_94">
        <option value="---"
          id="v5300_cf_tracking_thunderbird_94" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_94-dirty">
  <select id="cf_status_thunderbird_94" name="cf_status_thunderbird_94">
        <option value="---"
          id="v5304_cf_status_thunderbird_94" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird95</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_95-dirty">
  <select id="cf_tracking_thunderbird_95" name="cf_tracking_thunderbird_95">
        <option value="---"
          id="v5332_cf_tracking_thunderbird_95" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_95-dirty">
  <select id="cf_status_thunderbird_95" name="cf_status_thunderbird_95">
        <option value="---"
          id="v5326_cf_status_thunderbird_95" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>

</div>
  </div>
</section>



<section class="module" id="module-people"
>
    <header id="module-people-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse People section"
           data-label-collapsed="Expand People section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-people-content"
             aria-expanded="false"
             aria-labeledby="module-people-title"
             aria-describedby="module-people-subtitle"></div>
        <h2 class="module-title" id="module-people-title">People</h2>
          <h3 class="module-subtitle" id="module-people-subtitle">
            (Reporter: jens.a.mueller, Assigned: mkmelin)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-people-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-assigned_to"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to"><div class="vcard vcard_101158" ><img src="https://secure.gravatar.com/avatar/18eb16a976feb4b40d839c5e9036bc3a?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=101158" > <span class="fna">mkmelin</span></a>
</div>
        </span>
    </div>

  
</div><div class="field edit-show" id="field-assigned_to" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-assignee" name="set_default_assignee" class="set-default"
          value="1" data-for="assigned_to">
        <label for="set-default-assignee">Reset Assignee to default</label>
      </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-bug_mentors" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor" id="bug_mentors-help-link" class="help">Mentors:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_mentors">---
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-qa_contact" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact" id="qa_contact-help-link" class="help">QA Contact:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-qa_contact">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-qa-contact" name="set_default_qa_contact" class="set-default"
          value="1" data-for="qa_contact">
        <label for="set-default-qa-contact">Reset QA Contact to default</label>
      </div>
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-reporter"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter" id="reporter-help-link" class="help">Reporter:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-reporter">
            <div class="vcard vcard_588172" ><img src="https://secure.gravatar.com/avatar/7f3a7a857e94b4dfe1317452a3591feb?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=588172" > <span class="fna">jens.a.mueller</span></a>
</div>

        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-triage_owner" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner" id="triage_owner-help-link" class="help">Triage Owner:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-triage_owner">
            ---

        </span>
    </div>

  
</div>

    

    <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc" id="-help-link" class="help">CC:
        </a>
    </div>


  
    <div class=" container">


        <span aria-owns="cc-summary cc-latch">
          <span role="button" tabindex="0" id="cc-summary" data-count="10">10 people
          </span>
        </span>


        <div id="cc-list" style="display:none"></div>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-references"
>
    <header id="module-references-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse References section"
           data-label-collapsed="Expand References section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-references-content"
             aria-expanded="false"
             aria-labeledby="module-references-title"
             aria-describedby="module-references-subtitle"></div>
        <h2 class="module-title" id="module-references-title">References</h2>
          <h3 class="module-subtitle" id="module-references-subtitle">
            (Blocks 1 open bug)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-references-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field bug-list edit-show" id="field-dependson" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson" id="dependson-help-link" class="help">Depends on:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-dependson">
        ---
        </span>
    </div>

  
</div><div class="field bug-list" id="field-blocked"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks" id="blocked-help-link" class="help">Blocks:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-blocked">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_NEW"
   title="NEW - Thunderbird don't decrypt S/MIME mails from Gmail/G Suite"
   href="/show_bug.cgi?id=1594253">1594253</a>
      </div>
      <div class="bug-list">
        <span class="bug-type-label iconic" title="enhancement"
              aria-label="enhancement" data-type="enhancement">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Cross-mailpart layout redressing with CSS"
   href="/show_bug.cgi?id=1463360">1463360</a>
      </div>

        </span>
    </div>

  
</div><div class="field" id="field-dependencytree"
>
    <div class="name">
    </div>


  
    <div class=" container">
        <span id="field-value-dependencytree">
        Dependency <a href="/showdependencytree.cgi?id=1464056&amp;hide_resolved=1">tree</a>
        / <a href="/showdependencygraph.cgi?id=1464056">graph</a>
        </span>
    </div>

  
</div>

    <div class="field bug-list edit-show" id="field-regresses" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses" id="regresses-help-link" class="help">Regressions:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regresses">
        ---
        </span>
    </div>

  
</div><div class="field bug-list edit-show" id="field-regressed_by" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by" id="regressed_by-help-link" class="help">Regressed by:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regressed_by">
        ---
        </span>
    </div>

  
</div>

    
</div><div class="fields-rhs">

    <div class="field edit-show" id="field-bug_file_loc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc" id="bug_file_loc-help-link" class="help">URL:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_file_loc"><div class="link">
    <a href="" target="_blank"
      rel="noreferrer" title=""
      class="bug-url" data-safe="0"></a>
  </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-see_also" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also" id="see_also-help-link" class="help">See Also:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-see_also">
        ---
        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-details"
>
    <header id="module-details-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Details section"
           data-label-collapsed="Expand Details section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-details-content"
             aria-expanded="false"
             aria-labeledby="module-details-title"
             aria-describedby="module-details-subtitle"></div>
        <h2 class="module-title" id="module-details-title">Details</h2>
          <h3 class="module-subtitle" id="module-details-subtitle">
            (Keywords: csectype-disclosure, sec-high)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-details-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-show" id="field-alias" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias" id="alias-help-link" class="help">Alias:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-alias">
            CVE-2018-12373

        </span>
    </div>

  
</div>

    <div class="field" id="field-keywords"
>
    <div class="name">
        <a href="/describekeywords.cgi" id="keywords-help-link" class="help">Keywords:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-keywords">
          <a href="/buglist.cgi?keywords=csectype-disclosure&amp;resolution=---">csectype-disclosure</a>, 
          <a href="/buglist.cgi?keywords=sec-high&amp;resolution=---">sec-high</a>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-status_whiteboard" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/Whiteboard" id="status_whiteboard-help-link" class="help">Whiteboard:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-status_whiteboard">---
        </span>
    </div>

  
</div>

    

    

    <div class="field" id="field-votes"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes" id="votes-help-link" class="help">Votes:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-votes">0
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field edit-show" id="field-bug_flags" style="display:none"
>
    <div class="name">Bug Flags:
    </div>


  
    <div class=" container">
        <span id="field-value-bug_flags"><div id="bug-flags" class="flags">
  <table class="layout-table">
    <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="This bug should be considered by thunderbird-drivers and developers as high-value and worthy of design &amp; review attention if a contributor offers a patch." for="flag_type-598">wanted-thunderbird</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-598-dirty">
      <select id="flag_type-598" name="flag_type-598"
        title="This bug should be considered by thunderbird-drivers and developers as high-value and worthy of design &amp; review attention if a contributor offers a patch."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug." for="flag_type-803">sec-bounty</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-803-dirty">
      <select id="flag_type-803" name="flag_type-803"
        title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame." for="flag_type-913">sec-bounty-hof</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-913-dirty">
      <select id="flag_type-913" name="flag_type-913"
        title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-787">in-qa-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-787-dirty">
      <select id="flag_type-787" name="flag_type-787"
        title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>

      <td class="flag-requestee">
        <div id="requestee_type-787-container" style="display:none"><input
    name="requestee_type-787"
    value="" class="requestee bz_autocomplete_user"  id="requestee_type-787" 
  >
        </div>
      <td>

  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-37">in-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-37-dirty">
      <select id="flag_type-37" name="flag_type-37"
        title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr>
    </tbody>
  </table>
</div>
        </span>
    </div>

  
</div>
</div>

  
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-crash-data"
>
    <header id="module-crash-data-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Crash Data section"
           data-label-collapsed="Expand Crash Data section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-crash-data-content"
             aria-expanded="false"
             aria-labeledby="module-crash-data-title"
             aria-describedby="module-crash-data-subtitle"></div>
        <h2 class="module-title" id="module-crash-data-title">Crash Data</h2>
      </div>
    </header>
  <div class="module-content" id="module-crash-data-content" style="display:none"
  ><div class="field edit-show" id="field-cf_crash_signature" style="display:none"
>
    <div class="name">Signature:
    </div>


  
    <div class="value">
        <span id="field-value-cf_crash_signature">
        </span>
    </div>

  
</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-security"
>
    <header id="module-security-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Security section"
           data-label-collapsed="Expand Security section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-security-content"
             aria-expanded="false"
             aria-labeledby="module-security-title"
             aria-describedby="module-security-subtitle"></div>
        <h2 class="module-title" id="module-security-title">Security</h2>
          <h3 class="module-subtitle" id="module-security-subtitle">
            (public)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-security-content" style="display:none"
  ><div class="groups edit-hide">
    This bug is publicly visible.
</div>

<div class="groups edit-show" style="display:none">


</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-user-story" data-non-stick="1"
>
    <header id="module-user-story-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse User Story section"
           data-label-collapsed="Expand User Story section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-user-story-content"
             aria-expanded="false"
             aria-labeledby="module-user-story-title"
             aria-describedby="module-user-story-subtitle"></div>
        <h2 class="module-title" id="module-user-story-title">User Story</h2>
      </div>
    </header>
  <div class="module-content" id="module-user-story-content" style="display:none"
  >
    <pre id="user-story"></pre>
  </div>
</section>







<section class="module" id="module-attachments"
>
    <header id="module-attachments-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Attachments section"
           data-label-collapsed="Expand Attachments section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-attachments-content"
             aria-expanded="true"
             aria-labeledby="module-attachments-title"
             aria-describedby="module-attachments-subtitle"></div>
        <h2 class="module-title" id="module-attachments-title">Attachments</h2>
          <h3 class="module-subtitle" id="module-attachments-subtitle">
            (4 files, 6 obsolete files)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-attachments-content"
  ><table role="table" class="layout-table" id="attachments">
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8980272">smime-reply-exfiltration.eml</a>
        </div>
        <div>
            <a href="#c0" class="attach-time activity-ref"><span class="rel-time" title="2018-05-24 06:04 PDT" data-time="1527167042">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_588172" ><a class="email " href="/user_profile?user_id=588172" > <span class="fna">Jens Müller</span></a>
</div></span>
        </div>
        <div class="attach-info">1.37 KB,
          text/plain        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8980272&amp;action=edit">Details</a>
    </tr>
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8980273"
              title="smime-reply-exfiltration.png"
              class="lightbox">
              <img src="/extensions/BugModal/web/image.png" width="16" height="16">smime-reply-exfiltration.png
            </a>
        </div>
        <div>
            <a href="#c1" class="attach-time activity-ref"><span class="rel-time" title="2018-05-24 06:04 PDT" data-time="1527167058">4 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_588172" ><a class="email " href="/user_profile?user_id=588172" > <span class="fna">Jens Müller</span></a>
</div></span>
        </div>
        <div class="attach-info">60.26 KB,
          image/png        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8980273&amp;action=edit">Details</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8985832">bug1464056_efail_decrypt2.patch</a>
        </div>
        <div>
            <a href="#c21" class="attach-time activity-ref"><span class="rel-time" title="2018-06-17 05:57 PDT" data-time="1529240275">3 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_101158" ><a class="email " href="/user_profile?user_id=101158" > <span class="fna">Magnus Melin [:mkmelin]</span></a>
</div></span>
        </div>
        <div class="attach-info">10.74 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_100230" ><span class="fn">patrick</span>
</div>:
              <a href="#c23"
                  class="flag-name-status rel-time-title activity-ref"
                  title="3 years ago"
              data-time="1529240275"
            >
              feedback+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_176914" ><span class="fn">jorgk-bmo</span>
</div>:
              <a href="#c22"
                  class="flag-name-status rel-time-title activity-ref"
                  title="3 years ago"
              data-time="1529242172"
            >
              feedback+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8985832&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8985832&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1464056&attachment=8985832">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8985845">bug1464056_efail_decrypt2.patch</a>
        </div>
        <div>
            <a href="#c25" class="attach-time activity-ref"><span class="rel-time" title="2018-06-17 11:36 PDT" data-time="1529260610">3 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_101158" ><a class="email " href="/user_profile?user_id=101158" > <span class="fna">Magnus Melin [:mkmelin]</span></a>
</div></span>
        </div>
        <div class="attach-info">10.77 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8985845&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8985845&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1464056&attachment=8985845">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8985850">bug1464056_efail_decrypt2.patch - rebased</a>
        </div>
        <div>
            <a href="#c26" class="attach-time activity-ref"><span class="rel-time" title="2018-06-17 12:51 PDT" data-time="1529265099">3 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_176914" ><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div></span>
        </div>
        <div class="attach-info">10.66 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8985850&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8985850&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1464056&attachment=8985850">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8985852">bug1464056_efail_decrypt2.patch - rebased (v2)</a>
        </div>
        <div>
            <a href="#c27" class="attach-time activity-ref"><span class="rel-time" title="2018-06-17 13:19 PDT" data-time="1529266774">3 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_176914" ><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div></span>
        </div>
        <div class="attach-info">10.65 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_176914" ><span class="fn">jorgk-bmo</span>
</div>:
              <a href="#c28"
                  class="flag-name-status rel-time-title activity-ref"
                  title="3 years ago"
              data-time="1529267143"
            >
              feedback+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8985852&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8985852&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1464056&attachment=8985852">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8986026">bug1464056_efail_decrypt2.patch - v3</a>
        </div>
        <div>
            <a href="#c31" class="attach-time activity-ref"><span class="rel-time" title="2018-06-18 12:31 PDT" data-time="1529350319">3 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_101158" ><a class="email " href="/user_profile?user_id=101158" > <span class="fna">Magnus Melin [:mkmelin]</span></a>
</div></span>
        </div>
        <div class="attach-info">10.58 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8986026&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8986026&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1464056&attachment=8986026">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8986030">bug1464056_efail_decrypt2.patch - v4</a>
        </div>
        <div>
            <a href="#c33" class="attach-time activity-ref"><span class="rel-time" title="2018-06-18 12:53 PDT" data-time="1529351622">3 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_101158" ><a class="email " href="/user_profile?user_id=101158" > <span class="fna">Magnus Melin [:mkmelin]</span></a>
</div></span>
        </div>
        <div class="attach-info">10.60 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_176914" ><span class="fn">jorgk-bmo</span>
</div>:
              <a href="#c34"
                  class="flag-name-status rel-time-title activity-ref"
                  title="3 years ago"
              data-time="1529351622"
            >
              review+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_176914" ><span class="fn">jorgk-bmo</span>
</div>:
              <a href="#c34"
                  class="flag-name-status rel-time-title activity-ref"
                  title="3 years ago"
              data-time="1529352832"
            >
              approval-comm-beta+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_176914" ><span class="fn">jorgk-bmo</span>
</div>:
              <a href="#c34"
                  class="flag-name-status rel-time-title activity-ref"
                  title="3 years ago"
              data-time="1529352832"
            >
              approval-comm-esr52+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_176914" ><span class="fn">jorgk-bmo</span>
</div>:
              <a href="#c34"
                  class="flag-name-status rel-time-title activity-ref"
                  title="3 years ago"
              data-time="1529352832"
            >
              approval-comm-esr60+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8986030&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8986030&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1464056&attachment=8986030">Splinter Review</a>
    </tr>
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8986076">1464056-follow-up.patch</a>
        </div>
        <div>
            <a href="#c39" class="attach-time activity-ref"><span class="rel-time" title="2018-06-18 17:35 PDT" data-time="1529368541">3 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_176914" ><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div></span>
        </div>
        <div class="attach-info">6.54 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_101158" ><span class="fn">mkmelin</span>
</div>:
              <a href="#c40"
                  class="flag-name-status rel-time-title activity-ref"
                  title="3 years ago"
              data-time="1529368541"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8986076&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8986076&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1464056&attachment=8986076">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8986101">1464056-follow-up.patch</a>
        </div>
        <div>
            <a href="#c42" class="attach-time activity-ref"><span class="rel-time" title="2018-06-18 23:09 PDT" data-time="1529388549">3 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_176914" ><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div></span>
        </div>
        <div class="attach-info">6.82 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_176914" ><span class="fn">jorgk-bmo</span>
</div>:
              <a href="#c42"
                  class="flag-name-status rel-time-title activity-ref"
                  title="3 years ago"
              data-time="1529388549"
            >
              review+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8986101&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8986101&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1464056&attachment=8986101">Splinter Review</a>
    </tr>
</table>

<footer id="attachments-footer">
  <div id="attachments-actions">
      <button type="button" id="attachments-obsolete-btn" class="secondary">Show Obsolete</button>
  </div>
  
</footer>
  </div>
</section>



<script nonce="kHuvwnofv0ajoiixz64dVy0gyzDjcRizAsvFh9DfBwuLw5Q8">
  init_module_visibility();
</script>



<meta name="firefox-versions" content="{&quot;FIREFOX_AURORA&quot;:&quot;&quot;,&quot;FIREFOX_DEVEDITION&quot;:&quot;94.0b9&quot;,&quot;FIREFOX_ESR&quot;:&quot;78.15.0esr&quot;,&quot;FIREFOX_ESR_NEXT&quot;:&quot;91.2.0esr&quot;,&quot;FIREFOX_NIGHTLY&quot;:&quot;95.0a1&quot;,&quot;FIREFOX_PINEBUILD&quot;:&quot;&quot;,&quot;LAST_MERGE_DATE&quot;:&quot;2021-10-04&quot;,&quot;LAST_RELEASE_DATE&quot;:&quot;2021-10-05&quot;,&quot;LAST_SOFTFREEZE_DATE&quot;:&quot;2021-09-30&quot;,&quot;LATEST_FIREFOX_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_OLDER_VERSION&quot;:&quot;3.6.28&quot;,&quot;LATEST_FIREFOX_RELEASED_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_VERSION&quot;:&quot;93.0&quot;,&quot;NEXT_MERGE_DATE&quot;:&quot;2021-11-01&quot;,&quot;NEXT_RELEASE_DATE&quot;:&quot;2021-11-02&quot;,&quot;NEXT_SOFTFREEZE_DATE&quot;:&quot;2021-10-28&quot;}">


<div id="comment-actions">
    <button type="button" id="bottom-btn" class="secondary" aria-label="Go to Page Bottom">Bottom &darr;</button>
  <div class="dropdown">
    <button type="button" id="comment-tags-btn" aria-haspopup="true" aria-label="Tags"
      aria-expanded="false" aria-controls="comment-tags-menu" class="dropdown-button minor">Tags &#9662;</button>
    <ul id="comment-tags-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a role="menuitem" tabindex="-1" data-comment-tag="">Reset</a>
      </li>
    </ul>
  </div>
  <div class="dropdown">
    <button type="button" id="view-menu-btn" aria-haspopup="true" aria-label="Timeline"
      aria-expanded="false" aria-controls="view-menu" class="dropdown-button minor">Timeline &#9662;</button>
    <ul id="view-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a id="view-reset" role="menuitem" tabindex="-1">Reset</a>
      </li>
      <li role="separator"></li>
      <li role="presentation">
        <a id="view-collapse-all" role="menuitem" tabindex="-1">Collapse All</a>
      </li>
      <li role="presentation">
        <a id="view-expand-all" role="menuitem" tabindex="-1">Expand All</a>
      </li>
      <li role="presentation">
        <a id="view-comments-only" role="menuitem" tabindex="-1">Comments Only</a>
      </li>
    </ul>
   </div>
</div>
<div class="change-set" id="c0"><div class="comment" data-id="13344528" data-no="0"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-0" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_588172" ><img src="https://secure.gravatar.com/avatar/7f3a7a857e94b4dfe1317452a3591feb?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_588172" ><a class="email " href="/user_profile?user_id=588172" > <span class="fna">Jens Müller</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-0"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-0" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c0">Description</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-05-24 06:04 PDT" data-time="1527167042">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-0">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8980272"
         class="attachment"
         data-id="8980272" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="smime-reply-exfiltration.eml">
      <meta itemprop="contentSize" content="1407">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=8980272" itemprop="contentUrl">
        <span id="att-8980272-description" itemprop="description">smime-reply-exfiltration.eml</span></a>
        — <a href="attachment.cgi?id=8980272&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-0" data-comment-id="13344528">User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:52.0) Gecko/20100101 Firefox/52.0
Build ID: 20180326230345

Steps to reproduce:

A variant of Efail's direct exfiltration attack still work in TB nightly (2018-05-22). S/MIME: decrypted MIME parts can be completely hidden with CSS; if user replies/forwards in HTML format the (non-visible) plaintext is leaked, otherwise (in text-only reply mode) the victim could be fooled by inserting newlines
---------------------------------------------------
Content-Type: multipart/mixed; boundary=&quot;BOUNDARY&quot;

--BOUNDARY
Content-Type: text/html

Reply please to this email
&lt;div style=&quot;color: red;&quot;&gt;

--BOUNDARY
Content-Type: application/pkcs7-mime; name=&quot;smime.p7m&quot;; smime-type=enveloped-data
Content-Transfer-Encoding: base64
...
--BOUNDARY--
---------------------------------------------------


Actual results:

Quoted S/MIME plaintext is hidden and leaked when user replies/forwards the message


Expected results:

Plaintext should in other MIME parts than the very first one should not be quoted</pre></div><div class="change-set" id="c1"><div class="comment" data-id="13344541" data-no="1"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-1" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_588172" ><img src="https://secure.gravatar.com/avatar/7f3a7a857e94b4dfe1317452a3591feb?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_588172" ><a class="email " href="/user_profile?user_id=588172" > <span class="fna">Jens Müller</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-1"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-1" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c1">Comment 1</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-05-24 06:04 PDT" data-time="1527167058">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-1">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8980273"
         class="attachment"
         data-id="8980273" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="smime-reply-exfiltration.png">
      <meta itemprop="contentSize" content="61711">
      <meta itemprop="encodingFormat" content="image/png">
      <div class="label">
        Attached image
          <a class="link lightbox" href="attachment.cgi?id=8980273" itemprop="contentUrl">
        <span id="att-8980273-description" itemprop="description">smime-reply-exfiltration.png</span></a>
        — <a href="attachment.cgi?id=8980273&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div></div><div class="change-set" id="c2"><div class="comment" data-id="13355733" data-no="2"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-2" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" ><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_1689" ><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-2"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-2" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c2">Comment 2</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-05-24 10:11 PDT" data-time="1527181864">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-2">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-2" data-comment-id="13355733">Wayne: please CC additional Thunderbird folks as necessary</pre><div class="activity"><div class="change">Flags: needinfo?(vseerror)</div></div></div><div class="change-set" id="a14896_1689"><div class="change" id="aa14896_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a14896_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a14896_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a14896_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a14896_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#a14896_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-05-24 10:12 PDT" data-time="1527181938">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: needinfo?(ben.bucksch)</div></div></div><div class="change-set" id="a15370_29811"><div class="change" id="aa15370_29811">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_29811" id="a15370_29811"><img src="https://secure.gravatar.com/avatar/20697ca69672a5276f24a34382a1ddbd?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_29811" id="a15370_29811"><a class="email " href="/user_profile?user_id=29811" > <span class="fna">Wayne Mery (:wsmwk)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a15370_29811"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a15370_29811">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#a15370_29811">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-05-24 10:20 PDT" data-time="1527182412">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(vseerror)</span></div></div></div><div class="change-set" id="c3"><div class="comment" data-id="13361826" data-no="3"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-3" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_101158" id="a15370_29811"><img src="https://secure.gravatar.com/avatar/18eb16a976feb4b40d839c5e9036bc3a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_101158" id="a15370_29811"><a class="email " href="/user_profile?user_id=101158" > <span class="fna">Magnus Melin [:mkmelin]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-3"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-3" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c3">Comment 3</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-05-24 12:18 PDT" data-time="1527189521">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-3">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-3" data-comment-id="13361826">I don't see that - I get no &quot;THIS IS A S/MIME ENCRYPTED MESSAGE....&quot;. Are you sure you're using 62 nightly trunk? Or which nightly did you mean? From here <a rel="nofollow" href="http://ftp.mozilla.org/pub/thunderbird/nightly/latest-comm-central/">http://ftp.mozilla.org/pub/thunderbird/nightly/latest-comm-central/</a>

As I've written elsewhere for replies/forwards efail is only a bit mitigated now. But the sample eml you provided here - that case is fixed by parsing parts separately.</pre></div><div class="change-set" id="c4"><div class="comment" data-id="13361971" data-no="4"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-4" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_588172" id="a15370_29811"><img src="https://secure.gravatar.com/avatar/7f3a7a857e94b4dfe1317452a3591feb?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_588172" id="a15370_29811"><a class="email " href="/user_profile?user_id=588172" > <span class="fna">Jens Müller</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-4"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-4" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c4">Comment 4</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-05-24 13:04 PDT" data-time="1527192264">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-4">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-4" data-comment-id="13361971">Reproduced with <a rel="nofollow" href="http://ftp.mozilla.org/pub/thunderbird/nightly/latest-comm-central/thunderbird-62.0a1.en-US.linux-x86_64.tar.bz2">http://ftp.mozilla.org/pub/thunderbird/nightly/latest-comm-central/thunderbird-62.0a1.en-US.linux-x86_64.tar.bz2</a> (of course the S/MIME base64 blob needs to be replaced by a S/MIME message you have the secret key for)</pre></div><div class="change-set" id="c5"><div class="comment" data-id="13362763" data-no="5"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-5" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_22599" id="a15370_29811"><img src="https://secure.gravatar.com/avatar/1a31769c00192ed0a23c3142d6deace0?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_22599" id="a15370_29811"><a class="email " href="/user_profile?user_id=22599" > <span class="fna">Ben Bucksch (:BenB)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-5"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-5" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c5">Comment 5</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-05-24 19:53 PDT" data-time="1527216783">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-5">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-5" data-comment-id="13362763">From <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"
   href="/show_bug.cgi?id=1419417#c57">bug 1419417 comment 57</a>:

3. Only decrypt, if the entire message is encrypted, not attachments

Normally, if we receive an encrypted email, the entire email will be encrypted. There's little point in leaving part of the message encrypted.

Part of the bug here was that we are automatically decrypting and inlining MIME subparts. That led to that &quot;mixed content&quot;. Patrick had no way to stop that &quot;mixed content&quot; in Enigmail, because the code is in libmime.

We should only automatically decrypt a message, if the entire message is encrypted. That's true for all normal encrypted emails.
If an attachment is encrypted, we should simply show it as external attachment. The user can click on it to open or save it.
(In the first version of the patch, I might only allow saving the attachment, not opening it directly by double-click - depending on how difficult it is to implement.)

-----

I think that would fix the bug here.

We can either fix that in libmime, or in Enigmail.

Enigmail would have to use Part numbers, which is a little hacky, but advantage is that it's easier to implement than in libmime.</pre><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(ben.bucksch)</span></div></div></div><div class="change-set" id="c6"><div class="comment" data-id="13362934" data-no="6"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-6" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_100230" id="a15370_29811"><img src="https://secure.gravatar.com/avatar/da0befc896cd73c16805f598f0e18bcb?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_100230" id="a15370_29811"><a class="email " href="/user_profile?user_id=100230" > <span class="fna">Patrick Brunschwig</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-6"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-6" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c6">Comment 6</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-05-24 23:16 PDT" data-time="1527228977">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-6">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-6" data-comment-id="13362934">(In reply to Ben Bucksch (:BenB) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - [efail] S/MIME plaintext can be leaked through HTML reply/forward"
   href="/show_bug.cgi?id=1464056#c5">comment #5</a>)
<span class="quote">&gt; From <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"
   href="/show_bug.cgi?id=1419417#c57">bug 1419417 comment 57</a>:
&gt; 
&gt; 3. Only decrypt, if the entire message is encrypted, not attachments
&gt; 
&gt; Normally, if we receive an encrypted email, the entire email will be
&gt; encrypted. There's little point in leaving part of the message encrypted.
&gt; 
&gt; Part of the bug here was that we are automatically decrypting and inlining
&gt; MIME subparts. That led to that &quot;mixed content&quot;. Patrick had no way to stop
&gt; that &quot;mixed content&quot; in Enigmail, because the code is in libmime.</span >

I actually did fix it in Enigmail 2.0.5 a way that works for all use-cases, except for forwarding. The solution works like this: I receive the message URL (including the &amp;part=1.2.3) from libmime, and I also receive the MIME part number that I'm decrypting. From this I can derive if the message is encrypted as a whole (MIME part number == &quot;1&quot;) or if the message is an encrypted attachment (URL contains &amp;part=1.2.3, and MIME part number matches /^1.2.3.1/)</pre></div><div class="change-set" id="c7"><div class="comment" data-id="13362954" data-no="7"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-7" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_101158" id="a15370_29811"><img src="https://secure.gravatar.com/avatar/18eb16a976feb4b40d839c5e9036bc3a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_101158" id="a15370_29811"><a class="email " href="/user_profile?user_id=101158" > <span class="fna">Magnus Melin [:mkmelin]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-7"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-7" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c7">Comment 7</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-05-24 23:42 PDT" data-time="1527230541">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-7">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-7" data-comment-id="13362954">Why is the red color from the unclosed &lt;div style=&quot;color: red;&quot;&gt; from part1 leaking into the rest of the message? Is the <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"
   href="/show_bug.cgi?id=1419417">bug 1419417</a> working as expected? I would expect parsing and outputting to close that div.</pre></div><div class="change-set" id="a65898_22599"><div class="change" id="aa65898_22599">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_22599" id="a65898_22599"><img src="https://secure.gravatar.com/avatar/1a31769c00192ed0a23c3142d6deace0?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_22599" id="a65898_22599"><a class="email " href="/user_profile?user_id=22599" > <span class="fna">Ben Bucksch (:BenB)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a65898_22599"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a65898_22599">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#a65898_22599">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-05-25 00:22 PDT" data-time="1527232940">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Status: UNCONFIRMED &rarr; NEW</div><div class="change">Ever confirmed: true</div></div></div><div class="change-set" id="c8"><div class="comment" data-id="13363076" data-no="8"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-8" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a65898_22599"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a65898_22599"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-8"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-8" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c8">Comment 8</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-05-25 00:56 PDT" data-time="1527234971">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-8">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-8" data-comment-id="13363076">As per <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED WONTFIX - Sanitize HTML quotes before sending them to the composer when replying"
   href="/show_bug.cgi?id=1462488#c20">bug 1462488 comment #20</a>: I don't think |&lt;div style=&quot;color: red;&quot;&gt;| makes anything hidden. A possible attack is |&lt;style&gt;div { display: none; } pre { display: none; }&lt;/style&gt;|.

BTW, why is this bug access restricted, if <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED WONTFIX - Sanitize HTML quotes before sending them to the composer when replying"
   href="/show_bug.cgi?id=1462488">bug 1462488</a> is not?</pre></div><div class="change-set" id="c9"><div class="comment" data-id="13363599" data-no="9"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-9" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_588172" id="a65898_22599"><img src="https://secure.gravatar.com/avatar/7f3a7a857e94b4dfe1317452a3591feb?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_588172" id="a65898_22599"><a class="email " href="/user_profile?user_id=588172" > <span class="fna">Jens Müller</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-9"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-9" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c9">Comment 9</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-05-25 05:02 PDT" data-time="1527249776">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-9">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-9" data-comment-id="13363599">Of course the red color is not meant to hide anything but just to show the problem: Basically, attacker-controlled CSS is leaked into other MIME parts, it defines how sensitive information such as decrypted mails are displayed. This is bad and there are lots of variants of how to actually exploit it.</pre></div><div class="change-set" id="c10"><div class="comment" data-id="13363795" data-no="10"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-10" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_101158" id="a65898_22599"><img src="https://secure.gravatar.com/avatar/18eb16a976feb4b40d839c5e9036bc3a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_101158" id="a65898_22599"><a class="email " href="/user_profile?user_id=101158" > <span class="fna">Magnus Melin [:mkmelin]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-10"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-10" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c10">Comment 10</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-05-25 06:37 PDT" data-time="1527255465">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-10">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-10" data-comment-id="13363795">Yes we need to see why the red color still shows. It shouldn't.</pre></div><div class="change-set" id="c11"><div class="comment" data-id="13364776" data-no="11"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-11" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a65898_22599"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a65898_22599"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-11"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-11" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c11">Comment 11</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-05-25 11:36 PDT" data-time="1527273413">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-11">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-11" data-comment-id="13364776">Please read <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED WONTFIX - Sanitize HTML quotes before sending them to the composer when replying"
   href="/show_bug.cgi?id=1462488#c20">bug 1462488 comment #20</a>. There is not red colour. If instead you use |&lt;style&gt;body { color: red; }&lt;/style&gt;| then the whole thing is read since all parts share the same HTML document. That's expected.</pre></div><div class="change-set" id="c12"><div class="comment" data-id="13365358" data-no="12"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-12" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_22599" id="a65898_22599"><img src="https://secure.gravatar.com/avatar/1a31769c00192ed0a23c3142d6deace0?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_22599" id="a65898_22599"><a class="email " href="/user_profile?user_id=22599" > <span class="fna">Ben Bucksch (:BenB)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-12"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-12" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c12">Comment 12</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-05-25 15:13 PDT" data-time="1527286385">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-12">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-12" data-comment-id="13365358"><span class="quote">&gt; I actually did fix it in Enigmail 2.0.5
&gt; I can derive if the message is encrypted as a whole (MIME part number == &quot;1&quot;)</span >

&#64;Patrick: nice!
Could you please verify that this fixes the bug here? Then we can set this FIXED and unhide the bug.</pre></div><div class="change-set" id="c13"><div class="comment" data-id="13365804" data-no="13"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-13" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_100230" id="a65898_22599"><img src="https://secure.gravatar.com/avatar/da0befc896cd73c16805f598f0e18bcb?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_100230" id="a65898_22599"><a class="email " href="/user_profile?user_id=100230" > <span class="fna">Patrick Brunschwig</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-13"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-13" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c13">Comment 13</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-05-26 00:35 PDT" data-time="1527320108">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-13">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-13" data-comment-id="13365804">The fix does work for most but not all cases in Enigmail 2.0.5 because I wasn't restrictive enough. The rules I described are implemented on master and will be part of the next release. And yes, this fixes the bug in Enigmail. But I can't fix this for S/MIME.</pre></div><div class="change-set" id="c14"><div class="comment" data-id="13366150" data-no="14"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-14" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_101158" id="a65898_22599"><img src="https://secure.gravatar.com/avatar/18eb16a976feb4b40d839c5e9036bc3a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_101158" id="a65898_22599"><a class="email " href="/user_profile?user_id=101158" > <span class="fna">Magnus Melin [:mkmelin]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-14"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-14" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c14">Comment 14</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-05-26 13:09 PDT" data-time="1527365347">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-14">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-14" data-comment-id="13366150">(In reply to Jorg K (GMT+2) (bustage-fix and urgent reviews only) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - [efail] S/MIME plaintext can be leaked through HTML reply/forward"
   href="/show_bug.cgi?id=1464056#c11">comment #11</a>)
<span class="quote">&gt; Please read <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED WONTFIX - Sanitize HTML quotes before sending them to the composer when replying"
   href="/show_bug.cgi?id=1462488#c20">bug 1462488 comment #20</a>. There is not red colour. </span >

But there is! See <a rel="nofollow" href="https://bugzilla.mozilla.org/attachment.cgi?id=8980273">https://bugzilla.mozilla.org/attachment.cgi?id=8980273</a> and I see this too on trunk

So there is still a problem here

This is the html we're producing for the above test mail on trunk: 
---
&lt;body&gt;

&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; &quot;&gt;Reply please to this email
&lt;div style=&quot;color: red;&quot;&gt;
&lt;plaintext&gt;
&lt;/plaintext&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;&lt;BR&gt;&lt;FIELDSET CLASS=&quot;mimeAttachmentHeader&quot;&gt;&lt;/FIELDSET&gt;&lt;div class=&quot;moz-text-plain&quot; wrap=true graphical-quote=true style=&quot;font-family: -moz-fixed; font-size: 14px;&quot; lang=&quot;x-western&quot;&gt;&lt;pre wrap class=&quot;moz-quote-pre&quot;&gt;
&lt;/pre&gt;&lt;/div&gt;&lt;/body&gt;
&lt;/html&gt;
&lt;/plaintext&gt;&lt;/div&gt;&lt;/body&gt;
---

Appears the plaintext is closed, but then due to the second &lt;/plaintext&gt;, the &quot;could be decrypted part&quot; is interpreted as text.</pre></div><div class="change-set" id="c15"><div class="comment" data-id="13366155" data-no="15"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-15" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a65898_22599"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a65898_22599"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-15"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-15" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c15">Comment 15</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-05-26 13:13 PDT" data-time="1527365592">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-15">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-15" data-comment-id="13366155">(In reply to Magnus Melin from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - [efail] S/MIME plaintext can be leaked through HTML reply/forward"
   href="/show_bug.cgi?id=1464056#c14">comment #14</a>)
<span class="quote">&gt; See <a rel="nofollow" href="https://bugzilla.mozilla.org/attachment.cgi?id=8980273">https://bugzilla.mozilla.org/attachment.cgi?id=8980273</a></span >
That's a picture. Kindly supply a message.</pre></div><div class="change-set" id="a198584_176914"><div class="change" id="aa198584_176914">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a198584_176914"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_176914" id="a198584_176914"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a198584_176914"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a198584_176914">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#a198584_176914">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-05-26 13:13 PDT" data-time="1527365626">4 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8980272&amp;action=edit"
           title="smime-reply-exfiltration.eml"
           class=""
        >Attachment #8980272</a> -
        Attachment mime type: message/rfc822 &rarr; text/plain</div></div></div><div class="change-set" id="c16"><div class="comment" data-id="13366157" data-no="16"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-16" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a198584_176914"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a198584_176914"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-16"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-16" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c16">Comment 16</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-05-26 13:14 PDT" data-time="1527365665">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-16">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-16" data-comment-id="13366157">Oh, you mean <span class=""><a href="/attachment.cgi?id=8980272" name="attach_8980272" title="smime-reply-exfiltration.eml">attachment 8980272</a> <a href="/attachment.cgi?id=8980272&amp;action=edit" title="smime-reply-exfiltration.eml">[details]</a></span> (no need to past the entire link).</pre></div><div class="change-set" id="c17"><div class="comment" data-id="13366161" data-no="17"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-17" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_101158" id="a198584_176914"><img src="https://secure.gravatar.com/avatar/18eb16a976feb4b40d839c5e9036bc3a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_101158" id="a198584_176914"><a class="email " href="/user_profile?user_id=101158" > <span class="fna">Magnus Melin [:mkmelin]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-17"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-17" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c17">Comment 17</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-05-26 13:16 PDT" data-time="1527365774">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-17">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-17" data-comment-id="13366161">Yes, the mail is <span class=""><a href="/attachment.cgi?id=8980272" name="attach_8980272" title="smime-reply-exfiltration.eml">attachment 8980272</a> <a href="/attachment.cgi?id=8980272&amp;action=edit" title="smime-reply-exfiltration.eml">[details]</a></span>, as I assume you saw now.</pre></div><div class="change-set" id="c18"><div class="comment" data-id="13366168" data-no="18"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-18" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a198584_176914"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a198584_176914"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-18"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-18" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c18">Comment 18</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-05-26 13:56 PDT" data-time="1527368209">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-18">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-18" data-comment-id="13366168">(In reply to Magnus Melin from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - [efail] S/MIME plaintext can be leaked through HTML reply/forward"
   href="/show_bug.cgi?id=1464056#c14">comment #14</a>)
<span class="quote">&gt; But there is!</span >
OK, I see it now. <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - [efail] S/MIME plaintext can be leaked through HTML reply/forward"
   href="/show_bug.cgi?id=1464056#c0">Comment #0</a> DID NOT have the &lt;plaintext&gt; tag that causes all the problems.

But that's not a sign that the fix in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"
   href="/show_bug.cgi?id=1419417">bug 1419417</a> didn't work. The HTML is parsed correctly. I ran it in the debugger and the HTML that comes from parsing is this:
&lt;html&gt;&lt;head&gt;
&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=&quot;&gt;&lt;/head&gt;&lt;body&gt;
 Reply please to this email
&lt;div style=&quot;color: red;&quot;&gt;
&lt;plaintext&gt;
&lt;/plaintext&gt;
&lt;/div&gt;
&lt;/body&gt;&lt;/html&gt;

So the code from <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"
   href="/show_bug.cgi?id=1419417">bug 1419417</a> DOES work, it closes the &lt;div&gt; and the &lt;plaintext&gt; tags SUCCESSFULLY!!

In the Inspector I see:

&lt;html&gt;&lt;head&gt;
&lt;title&gt;Testcase 'reply-mix-css' (S/MIME)&lt;/title&gt;
&lt;link rel=&quot;important stylesheet&quot; href=&quot;chrome://messagebody/skin/messageBody.css&quot;&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div class=&quot;moz-text-html&quot; lang=&quot;x-western&quot;&gt;
&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; &quot;&gt;
  Reply please to this email
  &lt;div style=&quot;color: red;&quot;&gt;
    &lt;plaintext&gt;
    &lt;/plaintext&gt;
  &lt;/div&gt;
&lt;/div&gt; &lt;-- inserted by my code from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - In &quot;original HTML&quot; and &quot;simple HTML&quot; view the body of the message is placed outside &lt;div class=moz-text-html&gt;"
   href="/show_bug.cgi?id=1462895">bug 1462895</a>.
&lt;/body&gt;&lt;/html&gt;

&lt;BR&gt;&lt;FIELDSET CLASS=&quot;mimeAttachmentHeader&quot;&gt;&lt;/FIELDSET&gt;
&lt;div class=&quot;moz-text-plain&quot; wrap=true graphical-quote=true style=&quot;font-family: -moz-fixed; font-size: 14px;&quot; lang=&quot;x-unicode&quot;&gt;
  &lt;pre wrap class=&quot;moz-quote-pre&quot;&gt;(Decrypted text)&lt;/pre&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
&lt;/plaintext&gt;    &lt;- pseudo tag inserted by Dev tools.
&lt;/div&gt;          &lt;- pseudo tag inserted by Dev tools.
&lt;/div&gt;          &lt;- pseudo tag inserted by Dev tools.
&lt;/body&gt;&lt;/html&gt;  &lt;- pseudo tag inserted by Dev tools.

The problem comes from the &lt;plaintext&gt; tag which the rendering engine interprets according to:
<a rel="nofollow" href="https://html.com/tags/plaintext/">https://html.com/tags/plaintext/</a>
===
The &lt;plaintext&gt; element was used to render HTML code as plain text. Since everything after the opening tag was rendered as plain text, there was no closing &lt;plaintext&gt; tag. This element is obsolete and should not be used.
===

If you remove the plaintext tag from the message, everything becomes good.

So it's interpreted as:
&lt;html&gt;&lt;head&gt;
&lt;title&gt;Testcase 'reply-mix-css' (S/MIME)&lt;/title&gt;
&lt;link rel=&quot;important stylesheet&quot; href=&quot;chrome://messagebody/skin/messageBody.css&quot;&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div class=&quot;moz-text-html&quot; lang=&quot;x-western&quot;&gt;
&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; &quot;&gt;
  Reply please to this email
  &lt;div style=&quot;color: red;&quot;&gt;
    &lt;plaintext&gt;

|    &lt;/plaintext&gt;
|  &lt;/div&gt;
|&lt;/div&gt; &lt;-- inserted by my code from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - In &quot;original HTML&quot; and &quot;simple HTML&quot; view the body of the message is placed outside &lt;div class=moz-text-html&gt;"
   href="/show_bug.cgi?id=1462895">bug 1462895</a>.
|&lt;/body&gt;&lt;/html&gt;
|&lt;BR&gt;&lt;FIELDSET CLASS=&quot;mimeAttachmentHeader&quot;&gt;&lt;/FIELDSET&gt;
|&lt;div class=&quot;moz-text-plain&quot; wrap=true graphical-quote=true style=&quot;font-family: -moz-fixed; font-size: 14px;&quot; lang=&quot;x-unicode&quot;&gt;
|  &lt;pre wrap class=&quot;moz-quote-pre&quot;&gt;(Decrypted text)&lt;/pre&gt;
|&lt;/div&gt;
|&lt;/body&gt;
|&lt;/html&gt;

&lt;/plaintext&gt;    &lt;- pseudo tag inserted by Dev tools.
&lt;/div&gt;          &lt;- pseudo tag inserted by Dev tools.
&lt;/div&gt;          &lt;- pseudo tag inserted by Dev tools.
&lt;/body&gt;&lt;/html&gt;  &lt;- pseudo tag inserted by Dev tools.

All the stuff marked | is displayed verbatim as &quot;plain text&quot;. So despite closing the &lt;plaintext&gt; tag correctly, by definition it cannot be closed.

This goes into the same category of problems which can be created with CSS leaking into other message parts. CSS leaks by definition, and &lt;plaintext&gt; has a similar effect.</pre></div><div class="change-set" id="c19"><div class="comment" data-id="13366364" data-no="19"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-19" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a198584_176914"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a198584_176914"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-19"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-19" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c19">Comment 19</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-05-26 22:50 PDT" data-time="1527400256">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-19">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-19" data-comment-id="13366364">Note: Stripping the &lt;plaintext&gt; tag would be easy, but that still doesn't fix the CSS attack vector.</pre></div><div class="change-set" id="c20"><div class="comment" data-id="13366501" data-no="20"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-20" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_101158" id="a198584_176914"><img src="https://secure.gravatar.com/avatar/18eb16a976feb4b40d839c5e9036bc3a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_101158" id="a198584_176914"><a class="email " href="/user_profile?user_id=101158" > <span class="fna">Magnus Melin [:mkmelin]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-20"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-20" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c20">Comment 20</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-05-27 04:32 PDT" data-time="1527420750">4 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-20">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-20" data-comment-id="13366501">Every day you learn something new. Nice analysis!

I filed <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Suppress &lt;plaintext&gt; in email messages"
   href="/show_bug.cgi?id=1464667">bug 1464667</a> to really remove &lt;plaintext&gt; support. This can't be the only case where someone can use that to do bad things.</pre></div><div class="change-set" id="a1225488_1689"><div class="change" id="aa1225488_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a1225488_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a1225488_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1225488_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1225488_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#a1225488_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-07 10:28 PDT" data-time="1528392530">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Keywords: <a href="/buglist.cgi?keywords=csectype-disclosure&amp;resolution=---">csectype-disclosure</a>, 
          
            <a href="/buglist.cgi?keywords=sec-high&amp;resolution=---">sec-high</a></div></div></div><div class="change-set" id="c21"><div class="comment" data-id="13408482" data-no="21"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-21" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_101158" id="a1225488_1689"><img src="https://secure.gravatar.com/avatar/18eb16a976feb4b40d839c5e9036bc3a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_101158" id="a1225488_1689"><a class="email " href="/user_profile?user_id=101158" > <span class="fna">Magnus Melin [:mkmelin]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-21"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-21" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c21">Comment 21</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-17 05:57 PDT" data-time="1529240275">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-21">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8985832"
         class="attachment patch obsolete"
         data-id="8985832" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1464056_efail_decrypt2.patch">
      <meta itemprop="contentSize" content="10998">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8985832">
          <a class="link" href="attachment.cgi?id=8985832&amp;action=diff">
        <span id="att-8985832-description" itemprop="description">bug1464056_efail_decrypt2.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8985832&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1464056&attachment=8985832">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-21" data-comment-id="13408482">This patch disallows encrypted sub parts. Only top level encryption will be allowed. If an encrypted subpart is found it is shown as an attachment.

I added a pref mail.decrypt_children to disable this, in case there is a need for it, which I don't think we know before we deploy it at large scale.

I've tested that 
 - normal mails work
 - normal encrypted mails work (as produced by Thunderbird)
 - messages such as <span class=""><a href="/attachment.cgi?id=8980272" name="attach_8980272" title="smime-reply-exfiltration.eml">attachment 8980272</a> <a href="/attachment.cgi?id=8980272&amp;action=edit" title="smime-reply-exfiltration.eml">[details]</a></span> will be prevented from showing encrypted content inline

I've not tested that an encrypted message containing an encrypted sub part will work. But I have no reason to think it wouldn't. I'm not sure how to produce such a message though.

Patrick, what do you think? And is there a similar check we should add for PGP?</pre><div class="activity"><div class="change">Assignee: nobody &rarr; mkmelin+mozilla</div><div class="change">Status: NEW &rarr; ASSIGNED</div><div class="change">
        <a href="/attachment.cgi?id=8985832&amp;action=edit"
           title="bug1464056_efail_decrypt2.patch"
           class=""
        >Attachment #8985832</a> -
        Flags: feedback?(patrick)</div></div></div><div class="change-set" id="c22"><div class="comment" data-id="13408490" data-no="22"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-22" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a1225488_1689"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a1225488_1689"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-22"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-22" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c22">Comment 22</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-17 06:29 PDT" data-time="1529242172">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-22">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-22" data-comment-id="13408490">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8985832" name="attach_8985832" title="bug1464056_efail_decrypt2.patch">attachment 8985832</a> <a href="/attachment.cgi?id=8985832&amp;action=edit" title="bug1464056_efail_decrypt2.patch">[details]</a> <a href="/attachment.cgi?id=8985832&amp;action=diff" title="bug1464056_efail_decrypt2.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1464056&amp;attachment=8985832'>[review]</a>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - [efail] S/MIME plaintext can be leaked through HTML reply/forward"
   href="/show_bug.cgi?id=1464056">bug1464056</a>_efail_decrypt2.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8985832" name="attach_8985832" title="bug1464056_efail_decrypt2.patch">attachment 8985832</a> <a href="/attachment.cgi?id=8985832&amp;action=edit" title="bug1464056_efail_decrypt2.patch">[details]</a> <a href="/attachment.cgi?id=8985832&amp;action=diff" title="bug1464056_efail_decrypt2.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1464056&amp;attachment=8985832'>[review]</a>:
-----------------------------------------------------------------

I haven't tried, but it looks reasonable by visual inspection. I'll test when review is requested.

::: mailnews/mime/src/mimei.cpp
&#64;&#64; +718,5 &#64;&#64;
<span class="quote">&gt; +        if (!Preferences::GetBool(&quot;mail.decrypt_children&quot;, false) &amp;&amp;
&gt; +            opts-&gt;is_child) {
&gt; +          // We do not allow encrypted parts except as top level.
&gt; +          // Allowing them would leak the plan text in case the part is
&gt; +          // clevely hidden and the decrypted content gets included in</span >

Two typos: plan text and clevely.

::: mailnews/mime/src/modlmime.h
&#64;&#64; +176,5 &#64;&#64;
<span class="quote">&gt;                   xlated for them doesn't work.  We have to
&gt;                   dexlate it before sending it.
&gt;                 */
&gt;  
&gt; +  bool is_child = false; /* Whether this part is a child and not top level. */</span >

Grammar?</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8985832&amp;action=edit"
           title="bug1464056_efail_decrypt2.patch"
           class=""
        >Attachment #8985832</a> -
        Flags: feedback+</div></div></div><div class="change-set" id="c23"><div class="comment" data-id="13408499" data-no="23"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-23" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_100230" id="a1225488_1689"><img src="https://secure.gravatar.com/avatar/da0befc896cd73c16805f598f0e18bcb?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_100230" id="a1225488_1689"><a class="email " href="/user_profile?user_id=100230" > <span class="fna">Patrick Brunschwig</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-23"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-23" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c23">Comment 23</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-17 07:24 PDT" data-time="1529245479">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-23">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-23" data-comment-id="13408499">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8985832" name="attach_8985832" title="bug1464056_efail_decrypt2.patch">attachment 8985832</a> <a href="/attachment.cgi?id=8985832&amp;action=edit" title="bug1464056_efail_decrypt2.patch">[details]</a> <a href="/attachment.cgi?id=8985832&amp;action=diff" title="bug1464056_efail_decrypt2.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1464056&amp;attachment=8985832'>[review]</a>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - [efail] S/MIME plaintext can be leaked through HTML reply/forward"
   href="/show_bug.cgi?id=1464056">bug1464056</a>_efail_decrypt2.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8985832" name="attach_8985832" title="bug1464056_efail_decrypt2.patch">attachment 8985832</a> <a href="/attachment.cgi?id=8985832&amp;action=edit" title="bug1464056_efail_decrypt2.patch">[details]</a> <a href="/attachment.cgi?id=8985832&amp;action=diff" title="bug1464056_efail_decrypt2.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1464056&amp;attachment=8985832'>[review]</a>:
-----------------------------------------------------------------

The idea is very good, and -- given my limited knowledge of libmime -- I think the implementation is reasonable. I don't think we need it in the PgpMimeProxy, I already do something very similar within the Enigmail code.

What will happen if the user wants to open an &quot;S/MIME attachment&quot;?</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8985832&amp;action=edit"
           title="bug1464056_efail_decrypt2.patch"
           class=""
        >Attachment #8985832</a> -
        Flags: feedback?(patrick) &rarr; feedback+</div></div></div><div class="change-set" id="c24"><div class="comment" data-id="13408548" data-no="24"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-24" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_101158" id="a1225488_1689"><img src="https://secure.gravatar.com/avatar/18eb16a976feb4b40d839c5e9036bc3a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_101158" id="a1225488_1689"><a class="email " href="/user_profile?user_id=101158" > <span class="fna">Magnus Melin [:mkmelin]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-24"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-24" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c24">Comment 24</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-17 11:36 PDT" data-time="1529260568">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-24">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-24" data-comment-id="13408548">(In reply to Patrick Brunschwig from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - [efail] S/MIME plaintext can be leaked through HTML reply/forward"
   href="/show_bug.cgi?id=1464056#c23">comment #23</a>)
<span class="quote">&gt; What will happen if the user wants to open an &quot;S/MIME attachment&quot;?</span >

It's opened like an attachment and you get to select how to open it. I'm not sure there's any way to actually open it for viewing decrypted. (The file seems binary.)</pre></div><div class="change-set" id="c25"><div class="comment" data-id="13408549" data-no="25"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-25" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_101158" id="a1225488_1689"><img src="https://secure.gravatar.com/avatar/18eb16a976feb4b40d839c5e9036bc3a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_101158" id="a1225488_1689"><a class="email " href="/user_profile?user_id=101158" > <span class="fna">Magnus Melin [:mkmelin]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-25"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-25" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c25">Comment 25</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-17 11:36 PDT" data-time="1529260610">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-25">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8985845"
         class="attachment patch obsolete"
         data-id="8985845" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1464056_efail_decrypt2.patch">
      <meta itemprop="contentSize" content="11027">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8985845">
          <a class="link" href="attachment.cgi?id=8985845&amp;action=diff">
        <span id="att-8985845-description" itemprop="description">bug1464056_efail_decrypt2.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8985845&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1464056&attachment=8985845">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-25" data-comment-id="13408549">Fixed language/typos.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8985832&amp;action=edit"
           title="bug1464056_efail_decrypt2.patch"
           class=""
        >Attachment #8985832</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8985845&amp;action=edit"
           title="bug1464056_efail_decrypt2.patch"
           class=""
        >Attachment #8985845</a> -
        Flags: review?(jorgk)</div></div></div><div class="change-set" id="a2097379_176914"><div class="change" id="aa2097379_176914">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a2097379_176914"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_176914" id="a2097379_176914"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a2097379_176914"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a2097379_176914">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#a2097379_176914">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-17 12:40 PDT" data-time="1529264421">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Summary: [efail] S/MIME plaintext can be leaked trough HTML reply/forward &rarr; [efail] S/MIME plaintext can be leaked through HTML reply/forward</div></div></div><div class="change-set" id="c26"><div class="comment" data-id="13408567" data-no="26"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-26" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a2097379_176914"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a2097379_176914"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-26"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-26" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c26">Comment 26</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-17 12:51 PDT" data-time="1529265099">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-26">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8985850"
         class="attachment patch obsolete"
         data-id="8985850" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1464056_efail_decrypt2.patch">
      <meta itemprop="contentSize" content="10911">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8985850">
          <a class="link" href="attachment.cgi?id=8985850&amp;action=diff">
        <span id="att-8985850-description" itemprop="description">bug1464056_efail_decrypt2.patch - rebased</span></a> (obsolete)
        — <a href="attachment.cgi?id=8985850&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1464056&attachment=8985850">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-26" data-comment-id="13408567">Rebased after <a rel="nofollow" href="https://hg.mozilla.org/comm-central/rev/01215911a27e">https://hg.mozilla.org/comm-central/rev/01215911a27e</a> turned mimei.cpp upside down.</pre></div><div class="change-set" id="a2099194_176914"><div class="change" id="aa2099194_176914">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a2099194_176914"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_176914" id="a2099194_176914"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a2099194_176914"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a2099194_176914">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#a2099194_176914">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-17 13:10 PDT" data-time="1529266236">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8985845&amp;action=edit"
           title="bug1464056_efail_decrypt2.patch"
           class=""
        >Attachment #8985845</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8985845&amp;action=edit"
           title="bug1464056_efail_decrypt2.patch"
           class=""
        >Attachment #8985845</a> -
        Flags: <span class="activity-deleted">review?(jorgk)</span></div></div></div><div class="change-set" id="c27"><div class="comment" data-id="13408573" data-no="27"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-27" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a2099194_176914"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a2099194_176914"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-27"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-27" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c27">Comment 27</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-17 13:19 PDT" data-time="1529266774">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-27">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8985852"
         class="attachment patch obsolete"
         data-id="8985852" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1464056_efail_decrypt2.patch">
      <meta itemprop="contentSize" content="10904">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8985852">
          <a class="link" href="attachment.cgi?id=8985852&amp;action=diff">
        <span id="att-8985852-description" itemprop="description">bug1464056_efail_decrypt2.patch - rebased (v2)</span></a> (obsolete)
        — <a href="attachment.cgi?id=8985852&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1464056&attachment=8985852">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-27" data-comment-id="13408573">I've done some whitespace adjustments here.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8985850&amp;action=edit"
           title="bug1464056_efail_decrypt2.patch - rebased"
           class=""
        >Attachment #8985850</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="c28"><div class="comment" data-id="13408576" data-no="28"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-28" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a2099194_176914"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a2099194_176914"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-28"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-28" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c28">Comment 28</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-17 13:25 PDT" data-time="1529267143">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-28">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-28" data-comment-id="13408576">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8985852" name="attach_8985852" title="bug1464056_efail_decrypt2.patch - rebased (v2)">attachment 8985852</a> <a href="/attachment.cgi?id=8985852&amp;action=edit" title="bug1464056_efail_decrypt2.patch - rebased (v2)">[details]</a> <a href="/attachment.cgi?id=8985852&amp;action=diff" title="bug1464056_efail_decrypt2.patch - rebased (v2)">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1464056&amp;attachment=8985852'>[review]</a>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - [efail] S/MIME plaintext can be leaked through HTML reply/forward"
   href="/show_bug.cgi?id=1464056">bug1464056</a>_efail_decrypt2.patch - rebased (v2)

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8985852" name="attach_8985852" title="bug1464056_efail_decrypt2.patch - rebased (v2)">attachment 8985852</a> <a href="/attachment.cgi?id=8985852&amp;action=edit" title="bug1464056_efail_decrypt2.patch - rebased (v2)">[details]</a> <a href="/attachment.cgi?id=8985852&amp;action=diff" title="bug1464056_efail_decrypt2.patch - rebased (v2)">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1464056&amp;attachment=8985852'>[review]</a>:
-----------------------------------------------------------------

This works for me. I've tested with S/MIME encrypted messages and encrypted subordinate parts.

::: mailnews/mime/src/mimemult.cpp
&#64;&#64; +434,5 &#64;&#64;
<span class="quote">&gt;     auto-uudecode-hack won't ever be done for subparts of a
&gt;     multipart, but only for untyped children of message/rfc822.
&gt;     */
&gt; +  if (!obj-&gt;options)  // Just to make sure.
&gt; +    obj-&gt;options = new MimeDisplayOptions();</span >

Are you sure this line is correct? I didn't find any other call site where the options are set up that way.

&#64;&#64; +436,5 &#64;&#64;
<span class="quote">&gt;     */
&gt; +  if (!obj-&gt;options)  // Just to make sure.
&gt; +    obj-&gt;options = new MimeDisplayOptions();
&gt; +
&gt; +  obj-&gt;options-&gt;is_child = true;</span >

Have you considered:
if (obj-&gt;options)
  obj-&gt;options-&gt;is_child = true;
?

I understand that options have a plethora of fields. Would setting just one field to the right thing? I don't think so.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8985852&amp;action=edit"
           title="bug1464056_efail_decrypt2.patch - rebased (v2)"
           class=""
        >Attachment #8985852</a> -
        Flags: feedback+</div></div></div><div class="change-set" id="c29"><div class="comment" data-id="13409810" data-no="29"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-29" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_101158" id="a2099194_176914"><img src="https://secure.gravatar.com/avatar/18eb16a976feb4b40d839c5e9036bc3a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_101158" id="a2099194_176914"><a class="email " href="/user_profile?user_id=101158" > <span class="fna">Magnus Melin [:mkmelin]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-29"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-29" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c29">Comment 29</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-17 23:26 PDT" data-time="1529303205">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-29">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-29" data-comment-id="13409810">(In reply to Jorg K (GMT+2) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - [efail] S/MIME plaintext can be leaked through HTML reply/forward"
   href="/show_bug.cgi?id=1464056#c28">comment #28</a>)
<span class="quote">&gt; Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8985852" name="attach_8985852" title="bug1464056_efail_decrypt2.patch - rebased (v2)">attachment 8985852</a> <a href="/attachment.cgi?id=8985852&amp;action=edit" title="bug1464056_efail_decrypt2.patch - rebased (v2)">[details]</a> <a href="/attachment.cgi?id=8985852&amp;action=diff" title="bug1464056_efail_decrypt2.patch - rebased (v2)">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1464056&amp;attachment=8985852'>[review]</a>
&gt; <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - [efail] S/MIME plaintext can be leaked through HTML reply/forward"
   href="/show_bug.cgi?id=1464056">bug1464056</a>_efail_decrypt2.patch - rebased (v2)
&gt; Have you considered:
&gt; if (obj-&gt;options)
&gt;   obj-&gt;options-&gt;is_child = true;
&gt; ?</span >

That should probably be ok to. So far I didn't find a case where options isn't set. It's hard to verify though.

<span class="quote">&gt; I understand that options have a plethora of fields. Would setting just one
&gt; field to the right thing? I don't think so.</span >

As far as I understand, it's quit a mess. Lots of options that can be set at some point, but often at the points you really need a field from there, it's not set (yet) :/</pre></div><div class="change-set" id="c30"><div class="comment" data-id="13410154" data-no="30"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-30" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a2099194_176914"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a2099194_176914"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-30"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-30" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c30">Comment 30</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-18 01:48 PDT" data-time="1529311685">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-30">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-30" data-comment-id="13410154">(In reply to Magnus Melin from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - [efail] S/MIME plaintext can be leaked through HTML reply/forward"
   href="/show_bug.cgi?id=1464056#c29">comment #29</a>)
<span class="quote">&gt; That should probably be ok to. So far I didn't find a case where options
&gt; isn't set. It's hard to verify though.</span >
Can we go with that then, please. Please use the patch where I did the white-space adjustments.

As I said in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - [efail] S/MIME plaintext can be leaked through HTML reply/forward"
   href="/show_bug.cgi?id=1464056#c28">comment #28</a>, I didn't find any other call site where the options are set up that way. Can you show me an example where those options are created to motivate the &quot;new MimeDisplayOptions();&quot;? If it's hard to verify, we should at least run something which is well understood.</pre></div><div class="change-set" id="c31"><div class="comment" data-id="13411223" data-no="31"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-31" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_101158" id="a2099194_176914"><img src="https://secure.gravatar.com/avatar/18eb16a976feb4b40d839c5e9036bc3a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_101158" id="a2099194_176914"><a class="email " href="/user_profile?user_id=101158" > <span class="fna">Magnus Melin [:mkmelin]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-31"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-31" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c31">Comment 31</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-18 12:31 PDT" data-time="1529350319">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-31">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8986026"
         class="attachment patch obsolete"
         data-id="8986026" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1464056_efail_decrypt2.patch">
      <meta itemprop="contentSize" content="10829">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8986026">
          <a class="link" href="attachment.cgi?id=8986026&amp;action=diff">
        <span id="att-8986026-description" itemprop="description">bug1464056_efail_decrypt2.patch - v3</span></a> (obsolete)
        — <a href="attachment.cgi?id=8986026&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1464056&attachment=8986026">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-31" data-comment-id="13411223">Now not creating the options. No null check is needed, it's used later in the function without a check.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8985852&amp;action=edit"
           title="bug1464056_efail_decrypt2.patch - rebased (v2)"
           class=""
        >Attachment #8985852</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8986026&amp;action=edit"
           title="bug1464056_efail_decrypt2.patch - v3"
           class=""
        >Attachment #8986026</a> -
        Flags: review?(jorgk)</div></div></div><div class="change-set" id="c32"><div class="comment" data-id="13411247" data-no="32"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-32" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a2099194_176914"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a2099194_176914"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-32"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-32" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c32">Comment 32</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-18 12:41 PDT" data-time="1529350899">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-32">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-32" data-comment-id="13411247">(In reply to Magnus Melin from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - [efail] S/MIME plaintext can be leaked through HTML reply/forward"
   href="/show_bug.cgi?id=1464056#c31">comment #31</a>)
<span class="quote">&gt; Now not creating the options. No null check is needed, it's used later in
&gt; the function without a check.</span >
Really?

  body = mime_create(((ct &amp;&amp; *ct) ? ct : (dct ? dct: TEXT_PLAIN)),
***           mult-&gt;hdrs, obj-&gt;options);
  PR_FREEIF(ct);
  if (!body) return MIME_OUT_OF_MEMORY;
  status = ((MimeContainerClass *) obj-&gt;clazz)-&gt;add_child(obj, body);
  if (status &lt; 0)
  {
    mime_free(body);
    return status;
  }

#ifdef MIME_DRAFTS
***  if ( obj-&gt;options &amp;&amp;
     obj-&gt;options-&gt;decompose_file_p &amp;&amp;
     obj-&gt;options-&gt;is_multipart_msg &amp;&amp;
     obj-&gt;options-&gt;decompose_file_init_fn )
  {

In the first line it could be passed as NULL, then it's tested before dereferencing it.

BTW, is MIME_DRAFTS defined, I've never done the research.</pre></div><div class="change-set" id="c33"><div class="comment" data-id="13411275" data-no="33"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-33" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_101158" id="a2099194_176914"><img src="https://secure.gravatar.com/avatar/18eb16a976feb4b40d839c5e9036bc3a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_101158" id="a2099194_176914"><a class="email " href="/user_profile?user_id=101158" > <span class="fna">Magnus Melin [:mkmelin]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-33"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-33" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c33">Comment 33</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-18 12:53 PDT" data-time="1529351622">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-33">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8986030"
         class="attachment patch"
         data-id="8986030" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="bug1464056_efail_decrypt2.patch">
      <meta itemprop="contentSize" content="10852">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8986030">
          <a class="link" href="attachment.cgi?id=8986030&amp;action=diff">
        <span id="att-8986030-description" itemprop="description">bug1464056_efail_decrypt2.patch - v4</span></a>
        — <a href="attachment.cgi?id=8986030&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1464056&attachment=8986030">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-33" data-comment-id="13411275">Yes MIME_DRAFTS is defined.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8986026&amp;action=edit"
           title="bug1464056_efail_decrypt2.patch - v3"
           class=""
        >Attachment #8986026</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8986026&amp;action=edit"
           title="bug1464056_efail_decrypt2.patch - v3"
           class=""
        >Attachment #8986026</a> -
        Flags: <span class="activity-deleted">review?(jorgk)</span></div><div class="change">
        <a href="/attachment.cgi?id=8986030&amp;action=edit"
           title="bug1464056_efail_decrypt2.patch - v4"
           class=""
        >Attachment #8986030</a> -
        Flags: review?(jorgk)</div></div></div><div class="change-set" id="c34"><div class="comment" data-id="13411308" data-no="34"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-34" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a2099194_176914"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a2099194_176914"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-34"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-34" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c34">Comment 34</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-18 13:13 PDT" data-time="1529352832">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-34">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-34" data-comment-id="13411308">Comment on <span class=""><a href="/attachment.cgi?id=8986030" name="attach_8986030" title="bug1464056_efail_decrypt2.patch - v4">attachment 8986030</a> <a href="/attachment.cgi?id=8986030&amp;action=edit" title="bug1464056_efail_decrypt2.patch - v4">[details]</a> <a href="/attachment.cgi?id=8986030&amp;action=diff" title="bug1464056_efail_decrypt2.patch - v4">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1464056&amp;attachment=8986030'>[review]</a>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - [efail] S/MIME plaintext can be leaked through HTML reply/forward"
   href="/show_bug.cgi?id=1464056">bug1464056</a>_efail_decrypt2.patch - v4

Thanks. I'll get this landed and uplifted.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8986030&amp;action=edit"
           title="bug1464056_efail_decrypt2.patch - v4"
           class=""
        >Attachment #8986030</a> -
        Flags: <span class="activity-deleted">review?(jorgk)</span></div><div class="change">
        <a href="/attachment.cgi?id=8986030&amp;action=edit"
           title="bug1464056_efail_decrypt2.patch - v4"
           class=""
        >Attachment #8986030</a> -
        Flags: review+</div><div class="change">
        <a href="/attachment.cgi?id=8986030&amp;action=edit"
           title="bug1464056_efail_decrypt2.patch - v4"
           class=""
        >Attachment #8986030</a> -
        Flags: approval-comm-esr60+</div><div class="change">
        <a href="/attachment.cgi?id=8986030&amp;action=edit"
           title="bug1464056_efail_decrypt2.patch - v4"
           class=""
        >Attachment #8986030</a> -
        Flags: approval-comm-esr52+</div><div class="change">
        <a href="/attachment.cgi?id=8986030&amp;action=edit"
           title="bug1464056_efail_decrypt2.patch - v4"
           class=""
        >Attachment #8986030</a> -
        Flags: approval-comm-beta+</div></div></div><div class="change-set" id="c35"><div class="comment" data-id="13411326" data-no="35"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-35" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a2099194_176914"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a2099194_176914"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-35"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-35" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c35">Comment 35</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-18 13:24 PDT" data-time="1529353469">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-35">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-35" data-comment-id="13411326"><a rel="nofollow" href="https://hg.mozilla.org/comm-central/rev/b474dfcfa256b5f5800083d592a8307b430d1303">https://hg.mozilla.org/comm-central/rev/b474dfcfa256b5f5800083d592a8307b430d1303</a>
Don't decrypt S/MIME sub parts. Only allow decryption at top level. r=jorgk DONTBUILD
(will be build with the next push)</pre><div class="activity"><div class="change">Status: ASSIGNED &rarr; RESOLVED</div><div class="change">Closed: <span class="rel-time" title="2018-06-18 13:24 PDT" data-time="1529353469">3 years ago</span></div><div class="change">Resolution: --- &rarr; FIXED</div><div class="change">Target Milestone: --- &rarr; Thunderbird 62.0</div></div></div><div class="change-set" id="c36"><div class="comment" data-id="13411376" data-no="36"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-36" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a2099194_176914"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a2099194_176914"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-36"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-36" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c36">Comment 36</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-18 13:44 PDT" data-time="1529354688">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-36">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-36" data-comment-id="13411376">TB 60 beta 8 (BETA_60_CONTINUATION branch):
<a rel="nofollow" href="https://hg.mozilla.org/releases/comm-beta/rev/b938c7733c51941c8033603a46efc2c1b2d02574">https://hg.mozilla.org/releases/comm-beta/rev/b938c7733c51941c8033603a46efc2c1b2d02574</a></pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_thunderbird_60&amp;o1=isnotempty">status-thunderbird60</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_thunderbird_60&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_thunderbird_61&amp;o1=isnotempty">status-thunderbird61</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_thunderbird_61&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_thunderbird_62&amp;o1=isnotempty">status-thunderbird62</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_thunderbird_62&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_thunderbird_esr52&amp;o1=isnotempty">status-thunderbird_esr52</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_thunderbird_esr52&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_thunderbird_esr60&amp;o1=isnotempty">status-thunderbird_esr60</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_thunderbird_esr60&amp;o1=equals&amp;v1=affected">affected</a></div></div></div><div class="change-set" id="c37"><div class="comment" data-id="13411583" data-no="37"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-37" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a2099194_176914"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a2099194_176914"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-37"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-37" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c37">Comment 37</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-18 15:41 PDT" data-time="1529361660">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-37">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-37" data-comment-id="13411583">This caused a test failure:
TEST-UNEXPECTED-FAIL | comm/mailnews/mime/test/unit/test_alternate_p7m_handling.js | xpcshell return code: 0
TEST-UNEXPECTED-FAIL | comm/mailnews/mime/test/unit/test_alternate_p7m_handling.js | thunderbird_default/&lt; - [thunderbird_default/&lt; : 41] false == true

Looking at the test it seems that all that was required to fix this bug was to set the preference mailnews.p7m_external to true.</pre><div class="activity"><div class="change">Status: RESOLVED &rarr; REOPENED</div><div class="change">Resolution: FIXED &rarr; ---</div></div></div><div class="change-set" id="c38"><div class="comment" data-id="13411604" data-no="38"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-38" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a2099194_176914"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a2099194_176914"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-38"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-38" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c38">Comment 38</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-18 16:02 PDT" data-time="1529362951">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-38">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-38" data-comment-id="13411604">(In reply to Jorg K (GMT+2) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - [efail] S/MIME plaintext can be leaked through HTML reply/forward"
   href="/show_bug.cgi?id=1464056#c37">comment #37</a>)
<span class="quote">&gt; Looking at the test it seems that all that was required to fix this bug was
&gt; to set the preference mailnews.p7m_external to true.</span >
That's incorrect. With that pref set, not even the body in the top part is decrypted.</pre></div><div class="change-set" id="c39"><div class="comment" data-id="13411705" data-no="39"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-39" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a2099194_176914"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a2099194_176914"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-39"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-39" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c39">Comment 39</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-18 17:35 PDT" data-time="1529368541">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-39">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8986076"
         class="attachment patch obsolete"
         data-id="8986076" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="1464056-follow-up.patch">
      <meta itemprop="contentSize" content="6695">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8986076">
          <a class="link" href="attachment.cgi?id=8986076&amp;action=diff">
        <span id="att-8986076-description" itemprop="description">1464056-follow-up.patch</span></a> (obsolete)
        — <a href="attachment.cgi?id=8986076&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1464056&attachment=8986076">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-39" data-comment-id="13411705">I suggest to rename the new preference to mailnews.p7m_child_external so it lines up with the existing mailnews.p7m_external.

This patch also fixes the failing test and removes duplicated code.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8986076&amp;action=edit"
           title="1464056-follow-up.patch"
           class=""
        >Attachment #8986076</a> -
        Flags: review?(mkmelin+mozilla)</div></div></div><div class="change-set" id="c40"><div class="comment" data-id="13411889" data-no="40"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-40" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_101158" id="a2099194_176914"><img src="https://secure.gravatar.com/avatar/18eb16a976feb4b40d839c5e9036bc3a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_101158" id="a2099194_176914"><a class="email " href="/user_profile?user_id=101158" > <span class="fna">Magnus Melin [:mkmelin]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-40"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-40" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c40">Comment 40</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-18 22:52 PDT" data-time="1529387575">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-40">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-40" data-comment-id="13411889">Comment on <span class="bz_obsolete"><a href="/attachment.cgi?id=8986076" name="attach_8986076" title="1464056-follow-up.patch">attachment 8986076</a> <a href="/attachment.cgi?id=8986076&amp;action=edit" title="1464056-follow-up.patch">[details]</a> <a href="/attachment.cgi?id=8986076&amp;action=diff" title="1464056-follow-up.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1464056&amp;attachment=8986076'>[review]</a>
1464056-follow-up.patch

Review of <span class="bz_obsolete"><a href="/attachment.cgi?id=8986076" name="attach_8986076" title="1464056-follow-up.patch">attachment 8986076</a> <a href="/attachment.cgi?id=8986076&amp;action=edit" title="1464056-follow-up.patch">[details]</a> <a href="/attachment.cgi?id=8986076&amp;action=diff" title="1464056-follow-up.patch">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1464056&amp;attachment=8986076'>[review]</a>:
-----------------------------------------------------------------

LGTM, with the below. r=mkmelin

Came to mind, mailnews.p7m_child_external actually seems obsolete now (though leave it for the moment). With mailnews.p7m_child_external, p7m attachments are always external so you don't need to set the mailnews.p7m_external pref.

::: mailnews/mime/test/unit/test_alternate_p7m_handling.js
&#64;&#64; +53,5 &#64;&#64;
<span class="quote">&gt;  
&gt;  /* ===== Driver ===== */
&gt;  
&gt;  var tests = [
&gt; +  parameterizeTest(worker, [{ messages, pref1: false, pref2: false, count: 0 }]),</span >

Naming these pref1 and pref2 makes this very hard to read. Please use the names like p7m_external instead.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8986076&amp;action=edit"
           title="1464056-follow-up.patch"
           class=""
        >Attachment #8986076</a> -
        Flags: review?(mkmelin+mozilla) &rarr; review+</div></div></div><div class="change-set" id="c41"><div class="comment" data-id="13411892" data-no="41"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-41" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a2099194_176914"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a2099194_176914"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-41"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-41" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c41">Comment 41</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-18 22:59 PDT" data-time="1529387989">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-41">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-41" data-comment-id="13411892">(In reply to Magnus Melin from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - [efail] S/MIME plaintext can be leaked through HTML reply/forward"
   href="/show_bug.cgi?id=1464056#c40">comment #40</a>)
<span class="quote">&gt; Came to mind, mailnews.p7m_child_external actually seems obsolete now
&gt; (though leave it for the moment). With mailnews.p7m_child_external, p7m
&gt; attachments are always external so you don't need to set the
&gt; mailnews.p7m_external pref.</span >
No. When you set mailnews.p7m_external even the top part is made external. Try it now on a secure BMO message, assuming that you have S/MIME in use. Then you will see it doesn't decode at all.

If the test were more sophisticated, that is with an S/MIME encoded body, you'd see the difference there.

New patch coming. I'll also rename mailnews.p7m_child_external to mailnews.p7m_subparts_external since users don't know of the MIME tree where subparts are children. Agreed, even the concept of a subpart is difficult to graps.</pre></div><div class="change-set" id="c42"><div class="comment" data-id="13411896" data-no="42"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-42" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a2099194_176914"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a2099194_176914"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-42"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-42" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c42">Comment 42</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-18 23:09 PDT" data-time="1529388549">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-42">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8986101"
         class="attachment patch"
         data-id="8986101" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="1464056-follow-up.patch">
      <meta itemprop="contentSize" content="6984">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8986101">
          <a class="link" href="attachment.cgi?id=8986101&amp;action=diff">
        <span id="att-8986101-description" itemprop="description">1464056-follow-up.patch</span></a>
        — <a href="attachment.cgi?id=8986101&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1464056&attachment=8986101">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-42" data-comment-id="13411896">Changes discussed in the previous comment.</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8986076&amp;action=edit"
           title="1464056-follow-up.patch"
           class=""
        >Attachment #8986076</a> -
        Attachment is obsolete: true</div><div class="change">
        <a href="/attachment.cgi?id=8986101&amp;action=edit"
           title="1464056-follow-up.patch"
           class=""
        >Attachment #8986101</a> -
        Flags: review+</div></div></div><div class="change-set" id="c43"><div class="comment" data-id="13411901" data-no="43"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-43" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a2099194_176914"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a2099194_176914"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-43"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-43" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c43">Comment 43</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-18 23:15 PDT" data-time="1529388925">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-43">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-43" data-comment-id="13411901">C-C: <a rel="nofollow" href="https://hg.mozilla.org/comm-central/rev/6332ffbfd6518278cf3e49b99b6bcd0b87c1ebbb">https://hg.mozilla.org/comm-central/rev/6332ffbfd6518278cf3e49b99b6bcd0b87c1ebbb</a>
C-B: <a rel="nofollow" href="https://hg.mozilla.org/releases/comm-beta/rev/acfbb53a1e1a597954b3999288251f292b40b0c1">https://hg.mozilla.org/releases/comm-beta/rev/acfbb53a1e1a597954b3999288251f292b40b0c1</a> (BETA_60_CONTINUATION branch)</pre><div class="activity"><div class="change">Status: REOPENED &rarr; RESOLVED</div><div class="change">Closed: <span class="rel-time" title="2018-06-18 13:24 PDT" data-time="1529353469">3 years ago</span> &rarr; <span class="rel-time" title="2018-06-18 23:15 PDT" data-time="1529388925">3 years ago</span></div><div class="change">Resolution: --- &rarr; FIXED</div></div></div><div class="change-set" id="c44"><div class="comment" data-id="13411905" data-no="44"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-44" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_101158" id="a2099194_176914"><img src="https://secure.gravatar.com/avatar/18eb16a976feb4b40d839c5e9036bc3a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_101158" id="a2099194_176914"><a class="email " href="/user_profile?user_id=101158" > <span class="fna">Magnus Melin [:mkmelin]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-44"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-44" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c44">Comment 44</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-18 23:20 PDT" data-time="1529389249">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-44">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-44" data-comment-id="13411905">(In reply to Jorg K (GMT+2) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - [efail] S/MIME plaintext can be leaked through HTML reply/forward"
   href="/show_bug.cgi?id=1464056#c41">comment #41</a>)
<span class="quote">&gt; (In reply to Magnus Melin from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - [efail] S/MIME plaintext can be leaked through HTML reply/forward"
   href="/show_bug.cgi?id=1464056#c40">comment #40</a>)
&gt; &gt; Came to mind, mailnews.p7m_child_external actually seems obsolete now
&gt; &gt; (though leave it for the moment). With mailnews.p7m_child_external, p7m
&gt; &gt; attachments are always external so you don't need to set the
&gt; &gt; mailnews.p7m_external pref.
&gt; No. When you set mailnews.p7m_external even the top part is made external.
&gt; Try it now on a secure BMO message, assuming that you have S/MIME in use.
&gt; Then you will see it doesn't decode at all.</span >

Sorry I confused the pref names now. It's  mailnews.p7m_external that became obsolete.</pre></div><div class="change-set" id="c45"><div class="comment" data-id="13411910" data-no="45"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-45" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a2099194_176914"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a2099194_176914"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-45"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-45" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c45">Comment 45</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-18 23:39 PDT" data-time="1529390380">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-45">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-45" data-comment-id="13411910">(In reply to Magnus Melin from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - [efail] S/MIME plaintext can be leaked through HTML reply/forward"
   href="/show_bug.cgi?id=1464056#c44">comment #44</a>)
<span class="quote">&gt; Sorry I confused the pref names now. It's mailnews.p7m_external that became
&gt; obsolete.</span >
Hmm, how can I convince you otherwise:

1) mailnews.p7m_external==true =&gt; all p7m parts are made external, including the top part.
2) mailnews.p7m_external==false, mailnews.p7m_subparts_external==true =&gt; (attacking) subparts are made external.

Or are you saying 1) is not a useful option? We'd need to research how people are using it:
<a rel="nofollow" href="https://www.google.com.au/search?q=mailnews.p7m_external">https://www.google.com.au/search?q=mailnews.p7m_external</a>
There are a few hits and as you know, people cry out when we make the slightest change :-(
We could also research why this was added.</pre></div><div class="change-set" id="c46"><div class="comment" data-id="13411918" data-no="46"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-46" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_101158" id="a2099194_176914"><img src="https://secure.gravatar.com/avatar/18eb16a976feb4b40d839c5e9036bc3a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_101158" id="a2099194_176914"><a class="email " href="/user_profile?user_id=101158" > <span class="fna">Magnus Melin [:mkmelin]</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-46"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-46" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c46">Comment 46</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-18 23:48 PDT" data-time="1529390934">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-46">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-46" data-comment-id="13411918">(In reply to Jorg K (GMT+2) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - [efail] S/MIME plaintext can be leaked through HTML reply/forward"
   href="/show_bug.cgi?id=1464056#c45">comment #45</a>)
<span class="quote">&gt; 1) mailnews.p7m_external==true =&gt; all p7m parts are made external, including
&gt; the top part.</span >

Yes, but I imagine that's not the intended use case. 
It's used for (in particular in Italian administration) allowing signed pdf files to get received properly and not have thunderbird trying to decode them.</pre></div><div class="change-set" id="c47"><div class="comment" data-id="13416162" data-no="47"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-47" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_22599" id="a2099194_176914"><img src="https://secure.gravatar.com/avatar/1a31769c00192ed0a23c3142d6deace0?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_22599" id="a2099194_176914"><a class="email " href="/user_profile?user_id=22599" > <span class="fna">Ben Bucksch (:BenB)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-47"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-47" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c47">Comment 47</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-20 14:59 PDT" data-time="1529531947">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-47">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-47" data-comment-id="13416162">My 2 cents to the pref names: Prefs are much easier to use when they are in the positive. &quot;external&quot; is essentially &quot;do not show inline&quot;, and therefore a negation, and &quot;external false&quot; essentially a double-negation. Even I had a hard time to understand what the pref means.

&quot;show_foo_inline&quot; is something that most advanced users can understand, because they know the &quot;show images inline&quot; options.</pre></div><div class="change-set" id="c48"><div class="comment" data-id="13416183" data-no="48"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-48" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a2099194_176914"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a2099194_176914"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-48"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-48" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c48">Comment 48</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-20 15:09 PDT" data-time="1529532558">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-48">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-48" data-comment-id="13416183">Agreed, but the pref was pre-existing.</pre></div><div class="change-set" id="a2422105_1689"><div class="change" id="aa2422105_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a2422105_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a2422105_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a2422105_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a2422105_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#a2422105_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-21 06:52 PDT" data-time="1529589147">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: mail-core-security &rarr; core-security-release</div></div></div><div class="change-set" id="c49"><div class="comment" data-id="13438368" data-no="49"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-49" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a2422105_1689"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a2422105_1689"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-49"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-49" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c49">Comment 49</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-06-29 08:56 PDT" data-time="1530287814">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-49">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-49" data-comment-id="13438368">TB 52.9:
<a rel="nofollow" href="https://hg.mozilla.org/releases/comm-esr52/rev/fdefe5691f32ddfc7a8035661ff9a5bfd4c23765">https://hg.mozilla.org/releases/comm-esr52/rev/fdefe5691f32ddfc7a8035661ff9a5bfd4c23765</a>
Merged patch. Landed with preference set to false, so no change in behaviour.
People worried about the issue can set the pref to true, this will be stated in the release notes.</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_thunderbird_esr52&amp;o1=isnotempty">status-thunderbird_esr52</a>:
          <a href="/buglist.cgi?f1=cf_status_thunderbird_esr52&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_thunderbird_esr52&amp;o1=equals&amp;v1=fixed">fixed</a></div></div></div><div class="change-set" id="a3482985_280903"><div class="change" id="aa3482985_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a3482985_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a3482985_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a3482985_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a3482985_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#a3482985_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-07-03 13:33 PDT" data-time="1530650027">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Alias: CVE-2018-12373</div></div></div><div class="change-set" id="c50"><div class="comment" data-id="13470162" data-no="50"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-50" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_176914" id="a3482985_280903"><img src="https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_176914" id="a3482985_280903"><a class="email disabled" href="/user_profile?user_id=176914" > <span class="fna">Jorg K (CEST = GMT+2)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-50"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-50" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c50">Comment 50</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-07-13 13:40 PDT" data-time="1531514432">3 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-50">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-50" data-comment-id="13470162"><a rel="nofollow" href="https://hg.mozilla.org/releases/comm-esr60/rev/974ee91603eb">https://hg.mozilla.org/releases/comm-esr60/rev/974ee91603eb</a>
<a rel="nofollow" href="https://hg.mozilla.org/releases/comm-esr60/rev/4698a00fad7a">https://hg.mozilla.org/releases/comm-esr60/rev/4698a00fad7a</a></pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_thunderbird_esr60&amp;o1=isnotempty">status-thunderbird_esr60</a>:
          <a href="/buglist.cgi?f1=cf_status_thunderbird_esr60&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_thunderbird_esr60&amp;o1=equals&amp;v1=fixed">fixed</a></div></div></div><div class="change-set" id="a7794142_101158"><div class="change" id="aa7794142_101158">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_101158" id="a7794142_101158"><img src="https://secure.gravatar.com/avatar/18eb16a976feb4b40d839c5e9036bc3a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_101158" id="a7794142_101158"><a class="email " href="/user_profile?user_id=101158" > <span class="fna">Magnus Melin [:mkmelin]</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a7794142_101158"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a7794142_101158">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#a7794142_101158">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2018-08-22 11:06 PDT" data-time="1534961184">3 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Blocks: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Cross-mailpart layout redressing with CSS"
   href="/show_bug.cgi?id=1463360">1463360</a></div></div></div><div class="change-set" id="c51"><div class="comment" data-id="14318081" data-no="51"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-51" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a7794142_101158"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_36541" id="a7794142_101158"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-51"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-51" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#c51">Comment 51</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2019-08-23 06:37 PDT" data-time="1566567435">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-51">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-51" data-comment-id="14318081" data-ismarkdown="true" ><p>For the record, the change that added an early return in mime_find_clazz can trigger crashes. The code must be allowed to execute until the end of the function, to ensure mimeExternalObjectClass gets initialized correctly, if it&#39;s the first time it&#39;s being used. I&#39;ll fix that in another bug.</p>
</div></div><div class="change-set" id="a52376102_36541"><div class="change" id="aa52376102_36541">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_36541" id="a52376102_36541"><img src="https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_36541" id="a52376102_36541"><a class="email " href="/user_profile?user_id=36541" > <span class="fna">Kai Engert (:KaiE:)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a52376102_36541"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a52376102_36541">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#a52376102_36541">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-20 09:59 PST" data-time="1579543144">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Blocks: <a class="bz_bug_link
          bz_status_NEW"
   title="NEW - Thunderbird don't decrypt S/MIME mails from Gmail/G Suite"
   href="/show_bug.cgi?id=1594253">1594253</a></div></div></div><div class="change-set" id="a54734957_1689"><div class="change" id="aa54734957_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a54734957_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a54734957_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a54734957_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a54734957_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1464056#a54734957_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-02-16 17:13 PST" data-time="1581901999">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: <span class="activity-deleted">core-security-release</span></div></div></div><div id="new-comment-notice">
          You need to <a href="/show_bug.cgi?id=1464056&amp;GoAheadAndLogIn=1">log in</a>
          before you can comment on or make changes to this bug.
        </div>



<div id="bottom-actions">
  <div id="bottom-right-actions">
    <button type="button" id="top-btn" class="secondary" aria-label="Go to Page Top">Top &uarr;</button>
  </div>
</div></div> 
</main> 
</div> 


</body>
</html>