-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

IBM SECURITY ADVISORY

First Issued: Tue Feb 10 12:08:53 CST 2009

The most recent version of this document is available here:

http://aix.software.ibm.com/aix/efixes/security/at_advisory.asc
or
ftp://aix.software.ibm.com/aix/efixes/security/at_advisory.asc

                           VULNERABILITY SUMMARY

VULNERABILITY:   AIX at information disclosure vulnerability

PLATFORMS:       AIX 5.2, 5.3, 6.1

SOLUTION:        Apply the fix or workaround as described below.

THREAT:          A local attacker may read any file on the system.

CERT VU Number:  n/a
CVE Number:      n/a

Reboot required?    NO
Workarounds?        YES
Protected by FPM?   NO
Protected by SED?   NO

                           DETAILED INFORMATION

I. OVERVIEW

    The at command does not drop permissions when reading certain
    files.  A local attacker may exploit this error to read any file
    on the system because the command is setuid root.

    The following file is vulnerable:

    /usr/bin/at

II. PLATFORM VULNERABILITY ASSESSMENT

    To determine if your system is vulnerable, execute the following
    command:

    lslpp -L bos.rte.cron

    The following fileset levels are currently vulnerable:

    AIX Fileset           Lower Level       Upper Level
    ---------------------------------------------------
    bos.rte.cron          5.2.0.0           5.2.0.106
    bos.rte.cron          5.3.0.0           5.3.0.63
    bos.rte.cron          5.3.7.0           5.3.7.1
    bos.rte.cron          5.3.8.0           5.3.8.1
    bos.rte.cron          5.3.9.0           5.3.9.0
    bos.rte.cron          6.1.0.0           6.1.0.1
    bos.rte.cron          6.1.1.0           6.1.1.2
    bos.rte.cron          6.1.2.0           6.1.2.0

III. SOLUTIONS

    A. APARS

        IBM has assigned the following APARs to this problem:

        AIX Level           APAR number        Availability
        ----------------------------------------------------
        5.2.0               IZ43452            7/22/2009
        5.3.0               IZ43453            4/29/2009
        5.3.7               IZ43454            4/29/2009
        5.3.8               IZ43455            4/29/2009
        5.3.9               IZ43456            4/29/2009
        6.1.0               IZ43457            6/03/2009
        6.1.1               IZ43458            6/03/2009
        6.1.2               IZ43459            6/03/2009

        Subscribe to the APARs here:

        http://www.ibm.com/support/docview.wss?uid=isg1IZ43452
        http://www.ibm.com/support/docview.wss?uid=isg1IZ43453
        http://www.ibm.com/support/docview.wss?uid=isg1IZ43454
        http://www.ibm.com/support/docview.wss?uid=isg1IZ43455
        http://www.ibm.com/support/docview.wss?uid=isg1IZ43456
        http://www.ibm.com/support/docview.wss?uid=isg1IZ43457
        http://www.ibm.com/support/docview.wss?uid=isg1IZ43458
        http://www.ibm.com/support/docview.wss?uid=isg1IZ43459

        By subscribing, you will receive periodic email alerting you
        to the status of the APAR, and a link to download the fix once
        it becomes available.

    B. FIXES

        Fixes are now available.  The fixes can be downloaded from:

        http://aix.software.ibm.com/aix/efixes/security/at_fix.tar
        ftp://aix.software.ibm.com/aix/efixes/security/at_fix.tar

        The links above are to a tar file containing this signed
        advisory, fix packages, and PGP signatures for each package.

        AIX Level         Fix
        ----------------------------------------------------
        5.2.0 TL10        IZ43452_10.090206.epkg.Z
        5.3.0 TL6         IZ43453_06.090206.epkg.Z
        5.3.7             IZ43454_07.090206.epkg.Z
        5.3.8             IZ43455_08.090206.epkg.Z
        5.3.9             IZ43456_09.090206.epkg.Z
        6.1.0             IZ43457_00.090206.epkg.Z
        6.1.1             IZ43458_01.090206.epkg.Z
        6.1.2             IZ43459_02.090206.epkg.Z

        To extract the fixes from the tar file:

        tar xvf at_fix.tar
        cd at_fix

        Verify you have retrieved the fixes intact:

        The checksums below were generated using the "csum -h SHA1"
        (sha1sum) commands and are as follows:

        csum -h SHA1 (sha1sum)                    filename
        ------------------------------------------------------------------
        5027642b26eb5c336e2a935780afead9fa2a50bc  IZ43452_10.090206.epkg.Z
        e2034961fe8902ceb68a38382861bd9e911aa2d5  IZ43453_06.090206.epkg.Z
        ff59e96307b014ff999313c42093599edd4908db  IZ43454_07.090206.epkg.Z
        1b536c647f57da7e8d2d520339c9db7fb8fe41be  IZ43455_08.090206.epkg.Z
        7d84846c200e5e257fcdcd27f9e928d06e213a3b  IZ43456_09.090206.epkg.Z
        649a4e775898d1d955fd03c1b05fef17b3a3f420  IZ43457_00.090206.epkg.Z
        47b91524b68b15e1421aad3c07d8e70d9c1ae498  IZ43458_01.090206.epkg.Z
        881b95a2eb1a8529abf4d1d133efd055898886b7  IZ43459_02.090206.epkg.Z

        To verify the sums, use the text of this advisory as input to
        csum or sha1sum. For example:

        csum -h SHA1 -i Advisory.asc
        sha1sum -c Advisory.asc

        These sums should match exactly. The PGP signatures in the tar
        file and on this advisory can also be used to verify the
        integrity of the fixes.  If the sums or signatures cannot be
        confirmed, contact IBM AIX Security and describe the
        discrepancy at the following address:

            security-alert@austin.ibm.com

     C. INTERIM FIX INSTALLATION

        IMPORTANT: If possible, it is recommended that a mksysb backup
        of the system be created.  Verify it is both bootable and
        readable before proceeding.

        Interim fixes have had limited functional and regression
        testing but not the full regression testing that takes place
        for Service Packs; thus, IBM does not warrant the fully
        correct functionality of an interim fix.

        Interim fix management documentation can be found at:

        http://www14.software.ibm.com/webapp/set2/sas/f/aix.efixmgmt/home.html

        To preview an interim fix installation:

        emgr -e ipkg_name -p         # where ipkg_name is the name of the  
                                     # interim fix package being previewed.

        To install an interim fix package:

        emgr -e ipkg_name -X         # where ipkg_name is the name of the  
                                     # interim fix package being installed.


IV. WORKAROUND

    Change the permissions of these commands to remove the setuid bit
    using the following commands:

    chmod 500 /usr/bin/at

    NOTE: chmod will disable functionality of these commands for all
    users except root.

V. OBTAINING FIXES

    AIX security fixes can be downloaded from:

        http://aix.software.ibm.com/aix/efixes/security
        or
        ftp://aix.software.ibm.com/aix/efixes/security

    AIX fixes can be downloaded from:

        http://www.ibm.com/eserver/support/fixes/fixcentral/main/pseries/aix

    NOTE: Affected customers are urged to upgrade to the latest
    applicable Technology Level and Service Pack.

VI. CONTACT INFORMATION

    If you would like to receive AIX Security Advisories via email,
    please visit:
 
        http://www.ibm.com/systems/support
 
    and click on the "My notifications" link.
 
    To view previously issued advisories, please visit:
 
        http://www14.software.ibm.com/webapp/set2/subscriptions/pqvcmjd
 
    Comments regarding the content of this announcement can be
    directed to:
 
        security-alert@austin.ibm.com
 
    To obtain the PGP public key that can be used to communicate
    securely with the AIX Security Team you can either:
 
        A. Download the key from our web page:
 
  http://www.ibm.com/systems/resources/systems_p_os_aix_security_pgpkey.txt
 
        B. Download the key from a PGP Public Key Server. The key ID is:
 
            0xADA6EB4D
 
    Please contact your local IBM AIX support center for any
    assistance.
 
    eServer is a trademark of International Business Machines
    Corporation.  IBM, AIX and pSeries are registered trademarks of
    International Business Machines Corporation.  All other trademarks
    are property of their respective holders.

VII. ACKNOWLEDGMENTS

    This vulnerability was reported by iDefense Labs.

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.7 (AIX)

iD8DBQFJkc2YP9Qud62m600RAoBgAKCtA57mm2MmZ8havDsbb40wwPJmcACgv8aW
N05oJmQtlL5GPGFSu/WCtV8=
=UPjo
-----END PGP SIGNATURE-----
