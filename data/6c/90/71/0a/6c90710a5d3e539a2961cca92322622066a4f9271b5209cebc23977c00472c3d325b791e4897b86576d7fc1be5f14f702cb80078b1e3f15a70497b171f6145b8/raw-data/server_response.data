<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>HCSEC-2021-25 - Terraform Enterprise Configuration Versions API Discloses Sensitive URL - Security - HashiCorp Discuss</title>
    <meta name="description" content="Bulletin ID: HCSEC-2021-25 
Affected Products / Versions: Terraform Enterprise up to v202108-1; fixed in v202109-1. 
Publication Date: September 14, 2021 
Summary 
Terraform Enterprise versions up to v202108-1 included a&amp;hellip;">
    <meta name="generator" content="Discourse 2.8.0.beta7 - https://github.com/discourse/discourse version 436edbb51a15c634e65c0d7cdccdb4ce9aecd8f1">
<link rel="icon" type="image/png" href="https://aws1.discourse-cdn.com/hashicorp/optimized/1X/768b0c508ad4facc44cabe5a30aff4d7f8afa863_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="https://aws1.discourse-cdn.com/hashicorp/optimized/1X/154331ed085112b536f7a0c4c5355c17a57e53c1_2_180x180.png">
<meta name="theme-color" content="#ffffff">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="https://discuss.hashicorp.com/t/hcsec-2021-25-terraform-enterprise-configuration-versions-api-discloses-sensitive-url/29508" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://discuss.hashicorp.com","potentialAction":{"@type":"SearchAction","target":"https://discuss.hashicorp.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="https://discuss.hashicorp.com/opensearch.xml" title="HashiCorp Discuss Search">

      <link href="https://sea2.discourse-cdn.com/hashicorp/stylesheets/desktop_3efd433df85c59aaefb5500dd3bf1fda39cbdf6b.css?__ws=discuss.hashicorp.com" media="all" rel="stylesheet" data-target="desktop"  />
      <link href="https://sea2.discourse-cdn.com/hashicorp/stylesheets/desktop_theme_19_b1232ab7e1a63dce3d47ad01483d60057495aa70.css?__ws=discuss.hashicorp.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="19" data-theme-name="discourse-hashicorp-theme"/>
    


<script src="https://sea2.discourse-cdn.com/hashicorp/theme-javascripts/d50ac3dedd3ea76578c300e5e62bc17c5b4f01d2.js?__ws=discuss.hashicorp.com"></script>
    <meta id="data-ga-universal-analytics" data-tracking-code="UA-36299135-17" data-json="{&quot;cookieDomain&quot;:&quot;auto&quot;}" data-auto-link-domains="">

  <link rel="preload" href="https://aws1.discourse-cdn.com/hashicorp/assets/google-universal-analytics-v3-706f1d28f0a97f67a47515c96189277240ec4940d968955042066d7873fd1fe8.gz.js" as="script">
<script src="https://aws1.discourse-cdn.com/hashicorp/assets/google-universal-analytics-v3-706f1d28f0a97f67a47515c96189277240ec4940d968955042066d7873fd1fe8.gz.js"></script>


        <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;HCSEC-2021-25 - Terraform Enterprise Configuration Versions API Discloses Sensitive URL&#39;" href="https://discuss.hashicorp.com/t/hcsec-2021-25-terraform-enterprise-configuration-versions-api-discloses-sensitive-url/29508.rss" />
    <meta property="og:site_name" content="HashiCorp Discuss" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://aws1.discourse-cdn.com/hashicorp/original/1X/154331ed085112b536f7a0c4c5355c17a57e53c1.png" />
<meta property="og:image" content="https://aws1.discourse-cdn.com/hashicorp/original/1X/154331ed085112b536f7a0c4c5355c17a57e53c1.png" />
<meta property="og:url" content="https://discuss.hashicorp.com/t/hcsec-2021-25-terraform-enterprise-configuration-versions-api-discloses-sensitive-url/29508" />
<meta name="twitter:url" content="https://discuss.hashicorp.com/t/hcsec-2021-25-terraform-enterprise-configuration-versions-api-discloses-sensitive-url/29508" />
<meta property="og:title" content="HCSEC-2021-25 - Terraform Enterprise Configuration Versions API Discloses Sensitive URL" />
<meta name="twitter:title" content="HCSEC-2021-25 - Terraform Enterprise Configuration Versions API Discloses Sensitive URL" />
<meta property="og:description" content="Bulletin ID: HCSEC-2021-25  Affected Products / Versions: Terraform Enterprise up to v202108-1; fixed in v202109-1.  Publication Date: September 14, 2021  Summary  Terraform Enterprise versions up to v202108-1 included a sensitive URL in specific responses to the Configuration Versions API, allowing potential privilege escalation or configuration manipulation. This vulnerability, CVE-2021-40862, was fixed in Terraform Enterprise v202109-1.  Background  Terraform Enterprise utilizes an internal s..." />
<meta name="twitter:description" content="Bulletin ID: HCSEC-2021-25  Affected Products / Versions: Terraform Enterprise up to v202108-1; fixed in v202109-1.  Publication Date: September 14, 2021  Summary  Terraform Enterprise versions up to v202108-1 included a sensitive URL in specific responses to the Configuration Versions API, allowing potential privilege escalation or configuration manipulation. This vulnerability, CVE-2021-40862, was fixed in Terraform Enterprise v202109-1.  Background  Terraform Enterprise utilizes an internal s..." />
<meta property="article:published_time" content="2021-09-14T22:33:51+00:00" />
<meta property="og:ignore_canonical" content="true" />


    
  </head>
  <body class="crawler">
    <!-- Replace icons -->






<script src="https://sea2.discourse-cdn.com/hashicorp/theme-javascripts/350479ec786d3192eb5f22fc034f23a6abba1c60.js?__ws=discuss.hashicorp.com"></script>
    <header>
      <a href="/">
          <img src="https://aws1.discourse-cdn.com/hashicorp/original/1X/668e19cbc79e3eaa176133c3679dc30aa57ba474.svg" alt="HashiCorp Discuss" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
        <div id="topic-title">
    <h1>
      <a href="/t/hcsec-2021-25-terraform-enterprise-configuration-versions-api-discloses-sensitive-url/29508">HCSEC-2021-25 - Terraform Enterprise Configuration Versions API Discloses Sensitive URL</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://discuss.hashicorp.com/c/security/52" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #0088CC'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Security</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

      <div class="topic-category">
        <div class='discourse-tags list-tags'>
            <a href='https://discuss.hashicorp.com/tag/security-terraform' class='discourse-tag' rel="tag">security-terraform</a>
        </div>
      </div>
  </div>

  


      <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
          <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
            <meta itemprop='name' content='HashiCorp'>
              <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                <meta itemprop='url' content='https://aws1.discourse-cdn.com/hashicorp/original/1X/668e19cbc79e3eaa176133c3679dc30aa57ba474.svg'>
              </div>
          </div>
          <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://discuss.hashicorp.com/u/jfinnigan'><span itemprop='name'>jfinnigan</span></a>
            
          </span>

          <link itemprop="mainEntityOfPage" href="https://discuss.hashicorp.com/t/hcsec-2021-25-terraform-enterprise-configuration-versions-api-discloses-sensitive-url/29508">


          <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2021-09-14T22:33:51Z' class='post-time'>
                September 14, 2021, 10:33pm
              </time>
              <meta itemprop='dateModified' content='2021-09-24T17:56:47Z'>
          <span itemprop='position'>#1</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
          <p><strong>Bulletin ID:</strong> HCSEC-2021-25<br>
<strong>Affected Products / Versions:</strong> Terraform Enterprise up to v202108-1; fixed in v202109-1.<br>
<strong>Publication Date:</strong> September 14, 2021</p>
<p><strong>Summary</strong><br>
Terraform Enterprise versions up to v202108-1 included a sensitive URL in specific responses to the Configuration Versions API, allowing potential privilege escalation or configuration manipulation. This vulnerability, CVE-2021-40862, was fixed in Terraform Enterprise v202109-1.</p>
<p><strong>Background</strong><br>
Terraform Enterprise utilizes an internal service for the storage of configuration version information. Access to this service is via URLs containing a securely generated secret (<a href="https://www.terraform.io/docs/cloud/api/index.html#blob-storage-authentication">as documented</a>) that are generated automatically when configuration versions are created.</p>
<p><strong>Details</strong><br>
During internal security testing, it was found that an endpoint associated with the <a href="https://www.terraform.io/docs/cloud/api/configuration-versions.html">Configuration Versions API</a> (used as part of the <a href="https://www.terraform.io/docs/cloud/run/api.html">API-driven run workflow</a>) erroneously exposed the sensitive URL associated with a Configuration Version.</p>
<p>A malicious user with read-only access to a workspace could leverage this weakness to perform privilege escalation or unauthorized modification of the Terraform configuration associated with a Terraform Enterprise workspace.</p>
<p>Note that the URLs in question expire after 25 hours.</p>
<p><strong>Remediation</strong><br>
The sensitive URL is now only returned by the Configuration Versions API the first time it is generated, as required for Terraform Enterprise operation. The sensitive URL will not be returned on subsequent API interactions.</p>
<p>Customers should update to Terraform Enterprise v202109-1 or newer.</p>
<p><strong>Acknowledgement</strong><br>
This issue was identified by the HashiCorp security team.</p>
<p><em>We deeply appreciate any effort to coordinate disclosure of security vulnerabilities. For information about security at HashiCorp and the reporting of security vulnerabilities, please see <a href="https://hashicorp.com/security" class="inline-onebox">Security at HashiCorp</a>.</em></p>
        </div>

        <meta itemprop='headline' content='HCSEC-2021-25 - Terraform Enterprise Configuration Versions API Discloses Sensitive URL'>
          <meta itemprop='keywords' content='security-terraform'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
           <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
           <meta itemprop="userInteractionCount" content="0" />
           <span class='post-likes'></span>
         </div>

         <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0" />
          </div>

      </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav'>
        <ul>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='/' itemprop="url">Home </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='/categories' itemprop="url">Categories </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='/guidelines' itemprop="url">FAQ/Guidelines </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
    
  </body>
  
</html>
