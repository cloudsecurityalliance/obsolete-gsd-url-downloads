<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="UTF-8">
<meta property="og:type" content="website">
<meta property="og:title" content="1216837 - (CVE-2016-1970) Underflow in srtp_unprotect could cause memory-safety bug">
<meta property="og:url" content="https://bugzilla.mozilla.org/show_bug.cgi?id=1216837">
<meta property="og:description"
      content="RESOLVED (rjesup) in Core - WebRTC: Networking. Last updated 2017-03-29.">
<meta name="twitter:label1" value="Type">
<meta name="twitter:data1" value="defect">
<meta name="twitter:label2" value="Priority">
<meta name="twitter:data2" value="P1">

    <meta name="viewport" content="width=1024">
    <meta name="color-scheme" content="dark light">
    <meta name="generator" content="Bugzilla 20211025.1">
    <meta name="bugzilla-global" content="dummy"
        id="bugzilla-global" data-bugzilla="{&quot;api_token&quot;:&quot;&quot;,&quot;config&quot;:{&quot;basepath&quot;:&quot;\/&quot;},&quot;constant&quot;:{&quot;COMMENT_COLS&quot;:80},&quot;param&quot;:{&quot;maxattachmentsize&quot;:&quot;10240&quot;,&quot;maxusermatches&quot;:&quot;50&quot;,&quot;splinter_base&quot;:&quot;\/page.cgi?id=splinter.html&amp;ignore=\/&quot;},&quot;string&quot;:{&quot;bug_type_required&quot;:&quot;You must select a Type for this bug&quot;,&quot;component_required&quot;:&quot;You must select a Component for this bug&quot;,&quot;description_required&quot;:&quot;You must enter a Description for this bug&quot;,&quot;short_desc_required&quot;:&quot;You must enter a Summary for this bug&quot;,&quot;version_required&quot;:&quot;You must select a Version for this bug&quot;},&quot;user&quot;:{&quot;is_new&quot;:1,&quot;login&quot;:&quot;&quot;}}">
    <title>1216837 - (CVE-2016-1970) Underflow in srtp_unprotect could cause memory-safety bug</title>

<link rel="Top" href="/">

  


  
    <link rel="Show" title="Dependency Tree"
          href="/showdependencytree.cgi?id=1216837&amp;hide_resolved=1">
      <link rel="Show" title="Dependency Graph"
            href="/showdependencygraph.cgi?id=1216837">

      <link rel="Show" title="Bug Activity"
            href="/show_activity.cgi?id=1216837">

<link href="/static/v20211025.1/skins/yui.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/standard/global.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BugModal/web/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BMO/web/styles/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/EditComments/web/styles/inline-editor.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-structure-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-theme-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/lib/prism.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Needinfo/web/styles/needinfo.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Review/web/styles/badge.css" rel="stylesheet" type="text/css">



    
<script nonce="pGyYGEtK9bTGoq8RBZjiIsWn26XPEs3RazAhWOk2YovlfVcR" src="/static/v20211025.1/js/jquery/jquery-min.js"></script><script nonce="pGyYGEtK9bTGoq8RBZjiIsWn26XPEs3RazAhWOk2YovlfVcR" src="/static/v20211025.1/js/jquery/ui/jquery-ui-min.js"></script><script nonce="pGyYGEtK9bTGoq8RBZjiIsWn26XPEs3RazAhWOk2YovlfVcR" src="/static/v20211025.1/js/yui.js"></script><script nonce="pGyYGEtK9bTGoq8RBZjiIsWn26XPEs3RazAhWOk2YovlfVcR" src="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu-min.js"></script><script nonce="pGyYGEtK9bTGoq8RBZjiIsWn26XPEs3RazAhWOk2YovlfVcR" src="/static/v20211025.1/js/jquery/plugins/devbridgeAutocomplete/devbridgeAutocomplete-min.js"></script><script nonce="pGyYGEtK9bTGoq8RBZjiIsWn26XPEs3RazAhWOk2YovlfVcR" src="/static/v20211025.1/js/global.js"></script><script nonce="pGyYGEtK9bTGoq8RBZjiIsWn26XPEs3RazAhWOk2YovlfVcR" src="/static/v20211025.1/js/util.js"></script><script nonce="pGyYGEtK9bTGoq8RBZjiIsWn26XPEs3RazAhWOk2YovlfVcR" src="/static/v20211025.1/js/dropdown.js"></script>

      <script nonce="pGyYGEtK9bTGoq8RBZjiIsWn26XPEs3RazAhWOk2YovlfVcR">
          YAHOO.namespace('bugzilla');
          if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
              YAHOO.util.Event._simpleRemove(window, "unload",
                                             YAHOO.util.Event._unload);
          }BUGZILLA.value_descs = JSON.parse('{\"bug_status\":{},\"resolution\":{\"\":\"---\"}}');

  
    var tracking_flags_str = "{\"comments\":{\"cf_tracking_firefox_esr78\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox95\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox94\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox93\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_a11y_review_project_flag\":{\"requested\":\"Description:\\nPlease provide an explanation of the feature or change. Include a description of the user scenario in which it would be used and how the user would complete the task(s).\\nScreenshots and visual UI specs are welcome, but please include sufficient accompanying explanation so that blind members of the accessibility team are able to understand the feature\/change.\\n\\nHow do we test this?\\nIf there is an implementation to test, please provide instructions for testing it; e.g. setting preferences, other preparation, how to trigger the UI, etc.\\n\\nWhen will this ship?\\nTracking bug\/issue:\\nDesign documents (e.g. Product Requirements Document, UI spec):\\nEngineering lead:\\nProduct manager:\\n\\nThe accessibility team has developed the Mozilla Accessibility Release Guidelines which outline what is needed to make user interfaces accessible:\\nhttps:\/\/wiki.mozilla.org\/Accessibility\/Guidelines\\nPlease describe the accessibility guidelines you considered and what steps you\'ve taken to address them:\\n\\nDescribe any areas of concern to which you want the accessibility team to give special attention:\"},\"cf_tracking_firefox_sumo\":{\"none-needed\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox_relnote\":{\"?\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox_esr91\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox42\":{\"?\":\"[Tracking Requested - why for this release]:\"}},\"flags\":{\"project\":{\"cf_root_cause\":\"---\",\"cf_tracking_firefox_sumo\":\"---\",\"cf_webcompat_priority\":\"---\",\"cf_a11y_review_project_flag\":\"---\",\"cf_fission_milestone\":\"---\"},\"tracking\":{\"cf_status_firefox43\":\"affected\",\"cf_tracking_firefox94\":\"---\",\"cf_status_firefox95\":\"---\",\"cf_tracking_firefox_relnote\":\"---\",\"cf_tracking_firefox_esr91\":\"---\",\"cf_status_firefox_esr78\":\"---\",\"cf_tracking_firefox_esr78\":\"---\",\"cf_status_thunderbird_esr91\":\"---\",\"cf_status_thunderbird_esr78\":\"---\",\"cf_status_firefox93\":\"---\",\"cf_tracking_firefox42\":\"-\",\"cf_tracking_thunderbird_esr91\":\"---\",\"cf_status_firefox45\":\"fixed\",\"cf_tracking_firefox95\":\"---\",\"cf_tracking_firefox93\":\"---\",\"cf_tracking_thunderbird_esr78\":\"---\",\"cf_status_firefox_esr91\":\"---\",\"cf_status_firefox94\":\"---\",\"cf_status_b2g_2_0\":\"affected\",\"cf_status_firefox41\":\"wontfix\",\"cf_status_firefox42\":\"wontfix\",\"cf_status_firefox44\":\"affected\",\"cf_status_firefox_esr38\":\"wontfix\"},\"blocking\":{\"cf_backlog\":\"webrtc\/webaudio+\"}},\"types\":[\"blocking\",\"tracking\"]}";
    var TrackingFlags = $.parseJSON(tracking_flags_str);

  

  
  BUGZILLA.bug_id = 1216837;
  BUGZILLA.bug_title = '1216837 - (CVE-2016-1970) Underflow in srtp_unprotect could cause memory-safety bug';
  BUGZILLA.bug_summary = 'Underflow in srtp_unprotect could cause memory-safety bug';
  BUGZILLA.bug_url = 'https:\/\/bugzilla.mozilla.org\/show_bug.cgi?id=1216837';
  BUGZILLA.bug_keywords = 'csectype-bounds, sec-moderate',
  BUGZILLA.user = {
    id: 0,
    login: '',
    is_insider: false,
    is_timetracker: false,
    can_tag: false,
    timezone: 'America\/Los_Angeles',
    settings: {
      quote_replies: 'quoted_reply',
      zoom_textareas: true,
      remember_collapsed: true,
      inline_attachments: true,
      autosize_comments: false
    }
  };

  BUGZILLA.bug_secure = false;
      </script>
<script nonce="pGyYGEtK9bTGoq8RBZjiIsWn26XPEs3RazAhWOk2YovlfVcR" src="/static/v20211025.1/extensions/BugModal/web/autosize.min.js"></script><script nonce="pGyYGEtK9bTGoq8RBZjiIsWn26XPEs3RazAhWOk2YovlfVcR" src="/static/v20211025.1/extensions/ProdCompSearch/web/js/prod_comp_search.js"></script><script nonce="pGyYGEtK9bTGoq8RBZjiIsWn26XPEs3RazAhWOk2YovlfVcR" src="/static/v20211025.1/extensions/BugModal/web/bug_modal.js"></script><script nonce="pGyYGEtK9bTGoq8RBZjiIsWn26XPEs3RazAhWOk2YovlfVcR" src="/static/v20211025.1/extensions/BugModal/web/comments.js"></script><script nonce="pGyYGEtK9bTGoq8RBZjiIsWn26XPEs3RazAhWOk2YovlfVcR" src="/static/v20211025.1/extensions/ComponentWatching/web/js/overlay.js"></script><script nonce="pGyYGEtK9bTGoq8RBZjiIsWn26XPEs3RazAhWOk2YovlfVcR" src="/static/v20211025.1/js/bugzilla-readable-status-min.js"></script><script nonce="pGyYGEtK9bTGoq8RBZjiIsWn26XPEs3RazAhWOk2YovlfVcR" src="/static/v20211025.1/js/field.js"></script><script nonce="pGyYGEtK9bTGoq8RBZjiIsWn26XPEs3RazAhWOk2YovlfVcR" src="/static/v20211025.1/js/comments.js"></script><script nonce="pGyYGEtK9bTGoq8RBZjiIsWn26XPEs3RazAhWOk2YovlfVcR" src="/static/v20211025.1/extensions/TrackingFlags/web/js/flags.js"></script><script nonce="pGyYGEtK9bTGoq8RBZjiIsWn26XPEs3RazAhWOk2YovlfVcR" src="/static/v20211025.1/extensions/BMO/web/js/firefox-crash-table.js"></script><script nonce="pGyYGEtK9bTGoq8RBZjiIsWn26XPEs3RazAhWOk2YovlfVcR" src="/static/v20211025.1/extensions/MozChangeField/web/js/severity-s1-priority-p1.js"></script><script nonce="pGyYGEtK9bTGoq8RBZjiIsWn26XPEs3RazAhWOk2YovlfVcR" src="/static/v20211025.1/extensions/MozChangeField/web/js/clear-tracking-priority-s1.js"></script><script nonce="pGyYGEtK9bTGoq8RBZjiIsWn26XPEs3RazAhWOk2YovlfVcR" src="/static/v20211025.1/extensions/MozChangeField/web/js/set-tracking-severity-s1.js"></script><script nonce="pGyYGEtK9bTGoq8RBZjiIsWn26XPEs3RazAhWOk2YovlfVcR" src="/static/v20211025.1/js/lib/prism.js"></script><script nonce="pGyYGEtK9bTGoq8RBZjiIsWn26XPEs3RazAhWOk2YovlfVcR" src="/static/v20211025.1/extensions/GoogleAnalytics/web/js/analytics.js"></script><script nonce="pGyYGEtK9bTGoq8RBZjiIsWn26XPEs3RazAhWOk2YovlfVcR" src="/static/v20211025.1/js/lib/md5.min.js"></script><script nonce="pGyYGEtK9bTGoq8RBZjiIsWn26XPEs3RazAhWOk2YovlfVcR" src="/static/v20211025.1/extensions/Review/web/js/badge.js"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla@Mozilla" href="/search_plugin.cgi"><link rel="shortcut icon" href="/extensions/BMO/web/images/favicon.ico">
<link rel="canonical" href="https://bugzilla.mozilla.org/show_bug.cgi?id=1216837">
<link rel="shorturl" href="https://bugzilla.mozilla.org/1216837"><meta name="google-analytics" content="UA-36116321-3" data-location="https://bugzilla.mozilla.org/bug/show-modal" data-title="1216837 - (CVE-2016-1970) Underflow in srtp_unprotect could cause memory-safety bug">
<script async src="https://www.google-analytics.com/analytics.js"></script><meta name="robots" content="noarchive">
  </head>



  <body
        class="bugzilla-mozilla-org
               skin-standard bug_modal yui-skin-sam">



<div id="wrapper">

<header id="header" role="banner">
  <div class="inner">
    <h1 id="header-title" class="title"><a href="https://bugzilla.mozilla.org/home" title="Go to home page">Bugzilla</a></h1>
    <form role="search" id="header-search" class="quicksearch" action="/buglist.cgi" data-no-csrf>
      <section class="searchbox-outer dropdown" role="combobox" aria-expanded="false" aria-haspopup="listbox"
               aria-labelledby="header-search-label" aria-owns="header-search-dropdown">
        <h2 id="header-search-label">Quick Search</h2>
        <span class="icon" aria-hidden="true"></span>
        <input role="searchbox" id="quicksearch_top" class="dropdown-button" name="quicksearch" autocomplete="off"
               value="" placeholder="Search Bugs"
               title="Enter a bug number or some search terms" aria-controls="header-search-dropdown"
               aria-label="Quick Search"><div id="header-search-dropdown" class="dropdown-content right" role="listbox" style="display: none;">
  <div id="header-search-dropdown-wrapper">
  </div>
</div>
      </section>
    </form>
    <nav id="header-nav">
      <ul class="links">
        <li class="link-browse">
          <a href="/describecomponents.cgi" title="Browse bugs by component">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Browse</span>
          </a>
        </li>
        <li class="link-search">
          <a href="/query.cgi?format=advanced" title="Search bugs using various criteria">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Advanced Search</span>
          </a>
        </li>
      </ul>
      <div class="dropdown">
        <button type="button" id="header-tools-menu-button" class="dropdown-button minor" title="More tools…"
                aria-label="More tools…" aria-expanded="false" aria-haspopup="true" aria-controls="header-tools-menu">
          <span class="icon" aria-hidden="true"></span>
        </button>
        <ul class="dropdown-content left" id="header-tools-menu" role="menu" style="display:none;">
          <li role="presentation">
            <a href="/report.cgi" role="menuitem" tabindex="-1">Reports</a>
          </li>
            <li role="separator"></li>
            <li role="presentation">
              <a href="https://bmo.readthedocs.io/en/latest/" role="menuitem" tabindex="-1">Documentation</a>
            </li>
        </ul>
      </div>
    </nav>
      <ul id="header-login" class="links">
          <li id="moz_new_account_container_top"><a href="/createaccount.cgi">New Account</a></li><li id="mini_login_container_top">
  <a id="login_link_top" href="/index.cgi?GoAheadAndLogIn=1"
     class='show_mini_login_form' data-qs-suffix="_top">Log In</a>

  <div id="mini_login_top" class="mini-popup mini_login bz_default_hidden"><span id="github_mini_login_top" class="mini_login_top">
    <form method="post" action="/github.cgi">
      <input type="hidden" name="github_secret" value="Jo9DVnvXPdG8tCi1tISMkI5hSQtD1u90TcZFTerdV1U0lPGRD2aqh4FejmERlB5NlGUH4GqbasVYFREFAeuLARVY4TuqMtohw94PRSjZRw5zM0n8dg6gk3zNr8SThPSOwugkynJGLzM1uRmQZCPq8miDrZt5UoUD50vH0GHf1qQaouEc7vEzGoIWfFSpNakTN38fehKkL8gs0k8mCakcb0iT4mXe4He4jHA7UZGrhnwpKv7tKKeXhOSyYdfDYfEW">
      <input type="hidden" name="target_uri" value="https://bugzilla.mozilla.org/show_bug.cgi">
      <input type="image" src="/extensions/GitHubAuth/web/images/sign_in.png" height="22" width="75" align="absmiddle"
             alt="Sign in with GitHub"
             title="Sign in with GitHub"> or
    </form>
  </span>

  <form action="/show_bug.cgi?id=1216837" method="POST"
        data-qs-suffix="_top">

    <input id="Bugzilla_login_top"
           class="bz_login"
           name="Bugzilla_login"
           title="Login"
           placeholder="Email"
           aria-label="Email"
           type="email"
           required
    >
    <input class="bz_password"
           id="Bugzilla_password_top"
           name="Bugzilla_password"
           type="password"
           title="Password"
           placeholder="Password"
           aria-label="Password"
           required
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text"
           id="Bugzilla_password_dummy_top" value="password"
           title="Password"
    >
      <input type="checkbox" id="Bugzilla_remember_top"
             name="Bugzilla_remember" value="on" class="bz_remember"
                 checked>
      <label for="Bugzilla_remember_top">Remember</label>
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
           class="check_mini_login_fields"
            id="log_in_top">
    <a href="#" id="hide_mini_login_top" aria-label="Close"
       class="close-button hide_mini_login_form" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
<li id="forgot_container_top">
  <a id="forgot_link_top" href="/index.cgi?GoAheadAndLogIn=1#forgot"
     class='show_forgot_form'
     data-qs-suffix="_top">Forgot Password</a>
  <div id="forgot_form_top" class="mini-popup mini_forgot bz_default_hidden">
  <form action="/token.cgi" method="post">
    <input type="email" name="loginname" size="20" placeholder="Email" aria-label="Email" required>
    <input id="forgot_button_top" value="Reset Password"
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <input type="hidden" id="token_top" name="token" value="1635622808-9sU8y1yx-2Lds9fQvIMLqFCFnVid1-NlKHjtCl9gHLk">
    <a href="#" class="close-button hide_forgot_form" aria-label="Close" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
      </ul><div id="header-external-links" class="dropdown first">
  <button type="button" id="header-external-menu-button" class="dropdown-button minor" title="Mozilla"
          aria-label="Mozilla" aria-expanded="false" aria-haspopup="true" aria-controls="header-external-menu">
    <img src="/static/v20211025.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg" width="32" height="32" alt="">
  </button>
  <ul class="dropdown-content right" id="header-external-menu" role="menu" style="display:none;">
    <li role="presentation">
      <a href="https://www.mozilla.org/" role="menuitem" tabindex="-1">Mozilla Home</a>
    </li>
    <li role="separator"></li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/" role="menuitem" tabindex="-1">Privacy</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/#cookies" role="menuitem" tabindex="-1">Cookies</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/about/legal/" role="menuitem" tabindex="-1">Legal</a>
    </li>
  </ul>
</div>
  </div>
</header> 


<main id="bugzilla-body" tabindex="-1">

<aside id="message-container" role="complementary">
  <noscript>
    <div class="noscript">
      <div class="inner">
        <p>Please enable JavaScript in your browser to use all the features on this site.</p>
      </div>
    </div>
  </noscript>
</aside>

<div id="main-inner">




<div role="toolbar" id="page-toolbar">
  <div role="group" class="buttons">
    <button type="button" id="copy-summary" class="secondary"
      title="Copy bug number and summary to your clipboard">Copy Summary</button>
    <div id="clip-container" style="display:none"><input type="text" id="clip"></div>
    <div class="dropdown">
      <button type="button" id="action-menu-btn" aria-haspopup="true" aria-label="View"
        aria-expanded="false" aria-controls="action-menu" class="dropdown-button secondary">View &#9662;</button>
      <ul class="dropdown-content left" id="action-menu" role="menu" style="display:none;">
        <li role="presentation">
          <a id="action-reset" role="menuitem" tabindex="-1">Reset Sections</a>
        </li>
        <li role="presentation">
          <a id="action-expand-all" role="menuitem" tabindex="-1">Expand All Sections</a>
        </li>
        <li role="presentation">
          <a id="action-collapse-all" role="menuitem" tabindex="-1">Collapse All Sections</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a id="action-history" role="menuitem" tabindex="-1">History</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a href="/rest/bug/1216837" role="menuitem" tabindex="-1">JSON</a>
        </li>
        <li role="presentation">
          <a href="/show_bug.cgi?ctype=xml&amp;id=1216837" role="menuitem" tabindex="-1">XML</a>
        </li>
      </ul>
    </div>
  </div>
</div>



<div role="status" id="io-error" style="display:none"></div>
<div role="status" id="floating-message" style="display:none">
  <div id="floating-message-text"></div>
</div>
<section class="module"
>
  <div class="module-content"
  >
  <div id="summary-container">
    <div class="field indent" id="field-status_summary"
>


  
    <div class=" container">
        <span id="field-value-status_summary">
      <span class="bug-status-label text" data-status="closed">Closed</span>
      <span id="field-value-bug_id">
        <a href="/show_bug.cgi?id=1216837">Bug 1216837</a>
          <span class="edit-hide">(CVE-2016-1970)</span>
      </span>
      <span>
        <span class="bug-time-label">Opened <span class="rel-time" title="2015-10-20 18:13 PDT" data-time="1445389988">6 years ago</span></span>
          <span class="bug-time-label">Closed <span class="rel-time" title="2015-12-07 05:27 PST" data-time="1449494858">6 years ago</span></span>
      </span>
        </span>
    </div>

  
</div>
<div class="field indent edit-hide"
>


  
    <div class=" container">
      

      <h1 id="field-value-short_desc">Underflow in srtp<wbr>_unprotect could cause memory-safety bug</h1>
    </div>

  
</div>

    <div class="field edit-show" id="field-short_desc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc" id="short_desc-help-link" class="help">Summary:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-short_desc">
            Underflow in srtp_unprotect could cause memory-safety bug

        </span>
    </div>

  
</div>
  </div>
  </div>
</section>


<section class="module" id="module-categories"
>
    <header id="module-categories-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Categories section"
           data-label-collapsed="Expand Categories section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-categories-content"
             aria-expanded="true"
             aria-labeledby="module-categories-title"
             aria-describedby="module-categories-subtitle"></div>
        <h2 class="module-title" id="module-categories-title">Categories</h2>
          <h3 class="module-subtitle" id="module-categories-subtitle">
            (Core :: WebRTC: Networking, defect, P1)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-categories-content"
  ><div class="fields-lhs">

    <div class="field" id="field-product"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=Core" id="product-help-link" class="help">Product:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-product">
      <div class="name-info-outer dropdown">
        <span id="product-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="product-info">Core
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="product-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Product description and actions">
          <header>
            <div class="title">Core</div>
            <div class="description">Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the <a href="https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox">Firefox</a> product. (<a href="https://wiki.mozilla.org/Modules/All#Core">More info</a>)</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=Core&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Product</a></div>
            <div><a href="/enter_bug.cgi?product=Core"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Product</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="Core"
                         data-label-watch="Watch This Product" data-label-unwatch="Unwatch This Product"
                         data-source="BugModal">Watch This Product</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-component"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=Core&component=WebRTC%3A%20Networking#WebRTC%3A%20Networking" id="component-help-link" class="help">Component:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-component">
      <div class="name-info-outer dropdown">
        <span id="component-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="component-info">WebRTC: Networking
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="component-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Component description and actions">
          <header>
            <div class="title">Core :: WebRTC: Networking</div>
            <div class="description">Bugs in the networking portions of WebRTC (PeerConnection dataChannels, SCTP, DTLS, SRTP, ICE, TURN, STUN, etc)</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=Core&amp;component=WebRTC%3A%20Networking&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Component</a></div>
            <div><a href="/buglist.cgi?product=Core&amp;component=WebRTC%3A%20Networking&amp;chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__"
                    target="_blank" role="menuitem" tabindex="-1">Recently Fixed Bugs in This Component</a></div>
            <div><a href="/enter_bug.cgi?product=Core&amp;component=WebRTC%3A%20Networking"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Component</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="Core" data-component="WebRTC: Networking"
                         data-label-watch="Watch This Component" data-label-unwatch="Unwatch This Component"
                         data-source="BugModal">Watch This Component</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-version"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#version" id="version-help-link" class="help">Version:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-version">
            41 Branch

        </span>
    </div>

  
</div>

    <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform" id="-help-link" class="help">Platform:
        </a>
    </div>


  
    <div class=" container"><div class="field inline" id="field-rep_platform"
>


  
    <div class="value">
        <span id="field-value-rep_platform">
            Unspecified

        </span>
    </div>

  
</div><div class="field indent inline" id="field-op_sys"
>


  
    <div class="value">
        <span id="field-value-op_sys">
            Unspecified

        </span>
    </div>

  
</div><div class="field indent inline"
>


  
    <div class=" container">
    </div>

  
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field contains-buttons" id="field-bug_type"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type" id="bug_type-help-link" class="help">Type:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_type">
      <span class="bug-type-label iconic-text" data-type="defect">
        <span class="icon" aria-hidden="true"></span>defect</span>
        </span>
    </div>

  
</div>

    <div class="field" id="field-importance"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority" id="importance-help-link" class="help">Priority:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-importance"><div class="field inline" id="field-priority"
>


  
    <div class="value">
        <span id="field-value-priority">P1
        </span>
    </div>

  
</div><div class="field inline" id="field-bug_severity"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity" id="bug_severity-help-link" class="help">Severity:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_severity">
            normal

        </span>
    </div>

  
</div><div class="field inline edit-hide" id="field-cf_rank"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#rank" id="cf_rank-help-link" class="help">Rank:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-cf_rank">
            10

        </span>
    </div>

  
</div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-cf_fx_points" style="display:none"
>
    <div class="name">Points:
    </div>


  
    <div class="value">
        <span id="field-value-cf_fx_points">
            ---

        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-tracking"
>
    <header id="module-tracking-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Tracking section"
           data-label-collapsed="Expand Tracking section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-tracking-content"
             aria-expanded="true"
             aria-labeledby="module-tracking-title"
             aria-describedby="module-tracking-subtitle"></div>
        <h2 class="module-title" id="module-tracking-title">Tracking</h2>
          <h3 class="module-subtitle" id="module-tracking-subtitle">
            (<span id="readable-bug-status" data-readable-bug-status="{&quot;cf_status_firefox95&quot;:&quot;---&quot;,&quot;cf_fission_milestone&quot;:&quot;---&quot;,&quot;cf_status_firefox43&quot;:&quot;affected&quot;,&quot;cf_tracking_firefox94&quot;:&quot;---&quot;,&quot;dupe_of&quot;:null,&quot;cf_tracking_firefox_esr91&quot;:&quot;---&quot;,&quot;cf_status_firefox_esr78&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_relnote&quot;:&quot;---&quot;,&quot;cf_status_thunderbird_esr78&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_esr78&quot;:&quot;---&quot;,&quot;cf_status_thunderbird_esr91&quot;:&quot;---&quot;,&quot;keywords&quot;:[&quot;csectype-bounds&quot;,&quot;sec-moderate&quot;],&quot;target_milestone&quot;:&quot;mozilla45&quot;,&quot;cf_tracking_thunderbird_esr91&quot;:&quot;---&quot;,&quot;cf_tracking_firefox42&quot;:&quot;-&quot;,&quot;cf_status_firefox45&quot;:&quot;fixed&quot;,&quot;cf_status_firefox93&quot;:&quot;---&quot;,&quot;cf_root_cause&quot;:&quot;---&quot;,&quot;status&quot;:&quot;RESOLVED&quot;,&quot;cf_a11y_review_project_flag&quot;:&quot;---&quot;,&quot;flags&quot;:[{&quot;status&quot;:&quot;+&quot;,&quot;name&quot;:&quot;sec-bounty&quot;}],&quot;id&quot;:1216837,&quot;cf_tracking_firefox95&quot;:&quot;---&quot;,&quot;cf_tracking_firefox93&quot;:&quot;---&quot;,&quot;cf_status_b2g_2_0&quot;:&quot;affected&quot;,&quot;cf_status_firefox41&quot;:&quot;wontfix&quot;,&quot;cf_status_firefox_esr91&quot;:&quot;---&quot;,&quot;cf_tracking_thunderbird_esr78&quot;:&quot;---&quot;,&quot;cf_status_firefox94&quot;:&quot;---&quot;,&quot;priority&quot;:&quot;P1&quot;,&quot;resolution&quot;:&quot;FIXED&quot;,&quot;cf_status_firefox42&quot;:&quot;wontfix&quot;,&quot;cf_status_firefox44&quot;:&quot;affected&quot;,&quot;cf_status_firefox_esr38&quot;:&quot;wontfix&quot;,&quot;cf_webcompat_priority&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_sumo&quot;:&quot;---&quot;,&quot;cf_backlog&quot;:&quot;webrtc/webaudio+&quot;}"></span>)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-tracking-content"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-status-view"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-view-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-view">RESOLVED
        FIXED
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-status-edit" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-edit-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-edit"><div class="field inline" id="field-bug_status"
>


  
    <div class="value">
        <span id="field-value-bug_status">
            RESOLVED

        </span>
    </div>

  
</div><div class="field indent inline" id="field-resolution"
>


  
    <div class="value">
        <span id="field-value-resolution">
            FIXED

        </span>
    </div>

  
</div>
  <div id="status-action-buttons">
      <div id="assigned-container" style="display:none">
        <button type="button" class="secondary" id="mark-as-assigned-btn">
          Mark as Assigned
        </button>
      </div>
  </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-target_milestone"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone" id="target_milestone-help-link" class="help">Milestone:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-target_milestone">
            mozilla45

        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-cf_fx_iteration" style="display:none"
>
    <div class="name">Iteration:
    </div>


  
    <div class="value">
        <span id="field-value-cf_fx_iteration">
            ---

        </span>
    </div>

  
</div>


      <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Project Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <td class="tracking-flag-name">a11y-review</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_a11y_review_project_flag-dirty">
  <select id="cf_a11y_review_project_flag" name="cf_a11y_review_project_flag">
        <option value="---"
          id="v4876_cf_a11y_review_project_flag" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Root Cause</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_root_cause-dirty">
  <select id="cf_root_cause" name="cf_root_cause">
        <option value="---"
          id="v4701_cf_root_cause" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Webcompat Priority</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_webcompat_priority-dirty">
  <select id="cf_webcompat_priority" name="cf_webcompat_priority">
        <option value="---"
          id="v4274_cf_webcompat_priority" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">user-doc-firefox</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_sumo-dirty">
  <select id="cf_tracking_firefox_sumo" name="cf_tracking_firefox_sumo">
        <option value="---"
          id="v4660_cf_tracking_firefox_sumo" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Fission Milestone</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_fission_milestone-dirty">
  <select id="cf_fission_milestone" name="cf_fission_milestone">
        <option value="---"
          id="v4222_cf_fission_milestone" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

      <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Tracking Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-hide">
    <table class="layout-table tracking-flags">
        <tr>
          <th></th>
          <th>Tracking</th>
          <th>Status</th>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox41</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox41&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox42</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox42&amp;o1=equals&amp;v1=-">-</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox42&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox43</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox43&amp;o1=equals&amp;v1=affected">affected</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox44</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox44&amp;o1=equals&amp;v1=affected">affected</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox45</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox45&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox-esr38</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox_esr38&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">b2g-v2.0</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_b2g_2_0&amp;o1=equals&amp;v1=affected">affected</a>
          </td>
        </tr>
    </table>
  </div>


<div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <th></th>
        <th>Tracking</th>
        <th>Status</th>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox41</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox41-dirty">
  <select id="cf_status_firefox41" name="cf_status_firefox41">
        <option value="wontfix"
          id="v2260_cf_status_firefox41" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox42</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox42-dirty">
  <select id="cf_tracking_firefox42" name="cf_tracking_firefox42">
        <option value="-"
          id="v2306_cf_tracking_firefox42" selected
        >-
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox42-dirty">
  <select id="cf_status_firefox42" name="cf_status_firefox42">
        <option value="wontfix"
          id="v2312_cf_status_firefox42" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox43</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox43-dirty">
  <select id="cf_status_firefox43" name="cf_status_firefox43">
        <option value="affected"
          id="v2370_cf_status_firefox43" selected
        >affected
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox44</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox44-dirty">
  <select id="cf_status_firefox44" name="cf_status_firefox44">
        <option value="affected"
          id="v2430_cf_status_firefox44" selected
        >affected
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox45</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox45-dirty">
  <select id="cf_status_firefox45" name="cf_status_firefox45">
        <option value="fixed"
          id="v2486_cf_status_firefox45" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr38</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr38-dirty">
  <select id="cf_status_firefox_esr38" name="cf_status_firefox_esr38">
        <option value="wontfix"
          id="v2154_cf_status_firefox_esr38" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">b2g-v2.0</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_b2g_2_0-dirty">
  <select id="cf_status_b2g_2_0" name="cf_status_b2g_2_0">
        <option value="affected"
          id="v1602_cf_status_b2g_2_0" selected
        >affected
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">relnote-firefox</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_relnote-dirty">
  <select id="cf_tracking_firefox_relnote" name="cf_tracking_firefox_relnote">
        <option value="---"
          id="v539_cf_tracking_firefox_relnote" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr78-dirty">
  <select id="cf_tracking_thunderbird_esr78" name="cf_tracking_thunderbird_esr78">
        <option value="---"
          id="v4823_cf_tracking_thunderbird_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr78-dirty">
  <select id="cf_status_thunderbird_esr78" name="cf_status_thunderbird_esr78">
        <option value="---"
          id="v4829_cf_status_thunderbird_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">thunderbird_esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_thunderbird_esr91-dirty">
  <select id="cf_tracking_thunderbird_esr91" name="cf_tracking_thunderbird_esr91">
        <option value="---"
          id="v5236_cf_tracking_thunderbird_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_thunderbird_esr91-dirty">
  <select id="cf_status_thunderbird_esr91" name="cf_status_thunderbird_esr91">
        <option value="---"
          id="v5242_cf_status_thunderbird_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr78-dirty">
  <select id="cf_tracking_firefox_esr78" name="cf_tracking_firefox_esr78">
        <option value="---"
          id="v4808_cf_tracking_firefox_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr78-dirty">
  <select id="cf_status_firefox_esr78" name="cf_status_firefox_esr78">
        <option value="---"
          id="v4813_cf_status_firefox_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr91-dirty">
  <select id="cf_tracking_firefox_esr91" name="cf_tracking_firefox_esr91">
        <option value="---"
          id="v5194_cf_tracking_firefox_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr91-dirty">
  <select id="cf_status_firefox_esr91" name="cf_status_firefox_esr91">
        <option value="---"
          id="v5199_cf_status_firefox_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox93</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox93-dirty">
  <select id="cf_tracking_firefox93" name="cf_tracking_firefox93">
        <option value="---"
          id="v5266_cf_tracking_firefox93" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox93-dirty">
  <select id="cf_status_firefox93" name="cf_status_firefox93">
        <option value="---"
          id="v5271_cf_status_firefox93" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox94</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox94-dirty">
  <select id="cf_tracking_firefox94" name="cf_tracking_firefox94">
        <option value="---"
          id="v5284_cf_tracking_firefox94" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox94-dirty">
  <select id="cf_status_firefox94" name="cf_status_firefox94">
        <option value="---"
          id="v5289_cf_status_firefox94" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox95</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox95-dirty">
  <select id="cf_tracking_firefox95" name="cf_tracking_firefox95">
        <option value="---"
          id="v5311_cf_tracking_firefox95" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox95-dirty">
  <select id="cf_status_firefox95" name="cf_status_firefox95">
        <option value="---"
          id="v5316_cf_status_firefox95" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>

      <div class="field"
>
    <div class="name">Blocking Flags:
    </div>


  
    <div class=" container"><div class="flags edit-hide">
    <table class="layout-table tracking-flags">
        <tr>
          <td class="tracking-flag-name">backlog</td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_backlog&amp;o1=equals&amp;v1=webrtc%2Fwebaudio%2B">webrtc/webaudio+</a>
          </td>
        </tr>
    </table>
  </div>


<div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <td class="tracking-flag-name">backlog</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_backlog-dirty">
  <select id="cf_backlog" name="cf_backlog">
        <option value="webrtc/webaudio+"
          id="v2227_cf_backlog" selected
        >webrtc/webaudio+
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>
</div>
  </div>
</section>



<section class="module" id="module-people"
>
    <header id="module-people-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse People section"
           data-label-collapsed="Expand People section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-people-content"
             aria-expanded="false"
             aria-labeledby="module-people-title"
             aria-describedby="module-people-subtitle"></div>
        <h2 class="module-title" id="module-people-title">People</h2>
          <h3 class="module-subtitle" id="module-people-subtitle">
            (Reporter: q1, Assigned: jesup)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-people-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-assigned_to"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to"><div class="vcard vcard_11539" ><img src="https://secure.gravatar.com/avatar/ae002109ba1cfbb7f5ad990cc5d9fbaf?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=11539" > <span class="fna">jesup</span></a>
</div>
        </span>
    </div>

  
</div><div class="field edit-show" id="field-assigned_to" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-assignee" name="set_default_assignee" class="set-default"
          value="1" data-for="assigned_to">
        <label for="set-default-assignee">Reset Assignee to default</label>
      </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-bug_mentors" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor" id="bug_mentors-help-link" class="help">Mentors:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_mentors">---
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-qa_contact" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact" id="qa_contact-help-link" class="help">QA Contact:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-qa_contact">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-qa-contact" name="set_default_qa_contact" class="set-default"
          value="1" data-for="qa_contact">
        <label for="set-default-qa-contact">Reset QA Contact to default</label>
      </div>
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-reporter"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter" id="reporter-help-link" class="help">Reporter:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-reporter">
            <div class="vcard vcard_140243" ><img src="https://secure.gravatar.com/avatar/6f792da717b676641d0a7095b55f0fdf?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=140243" > <span class="fna">q1</span></a>
</div>

        </span>
    </div>

  
</div>

    <div class="field" id="field-triage_owner"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner" id="triage_owner-help-link" class="help">Triage Owner:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-triage_owner">
            <div class="vcard vcard_478411" ><img src="https://secure.gravatar.com/avatar/3e201149abea356acc9bb6f0eea8b5a0?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=478411" > <span class="fna">bwc</span></a>
</div>

        </span>
    </div>

  
</div>

    

    <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc" id="-help-link" class="help">CC:
        </a>
    </div>


  
    <div class=" container">


        <span aria-owns="cc-summary cc-latch">
          <span role="button" tabindex="0" id="cc-summary" data-count="12">12 people
          </span>
        </span>


        <div id="cc-list" style="display:none"></div>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-references"
>
    <header id="module-references-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse References section"
           data-label-collapsed="Expand References section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-references-content"
             aria-expanded="false"
             aria-labeledby="module-references-title"
             aria-describedby="module-references-subtitle"></div>
        <h2 class="module-title" id="module-references-title">References</h2>
      </div>
    </header>
  <div class="module-content" id="module-references-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field bug-list edit-show" id="field-dependson" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson" id="dependson-help-link" class="help">Depends on:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-dependson">
        ---
        </span>
    </div>

  
</div><div class="field bug-list edit-show" id="field-blocked" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks" id="blocked-help-link" class="help">Blocks:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-blocked">
        ---
        </span>
    </div>

  
</div>

    <div class="field bug-list edit-show" id="field-regresses" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses" id="regresses-help-link" class="help">Regressions:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regresses">
        ---
        </span>
    </div>

  
</div><div class="field bug-list edit-show" id="field-regressed_by" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by" id="regressed_by-help-link" class="help">Regressed by:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regressed_by">
        ---
        </span>
    </div>

  
</div>

    
</div><div class="fields-rhs">

    <div class="field edit-show" id="field-bug_file_loc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc" id="bug_file_loc-help-link" class="help">URL:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_file_loc"><div class="link">
    <a href="" target="_blank"
      rel="noreferrer" title=""
      class="bug-url" data-safe="0"></a>
  </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-see_also" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also" id="see_also-help-link" class="help">See Also:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-see_also">
        ---
        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-details"
>
    <header id="module-details-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Details section"
           data-label-collapsed="Expand Details section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-details-content"
             aria-expanded="false"
             aria-labeledby="module-details-title"
             aria-describedby="module-details-subtitle"></div>
        <h2 class="module-title" id="module-details-title">Details</h2>
          <h3 class="module-subtitle" id="module-details-subtitle">
            (Keywords: csectype-bounds, sec-moderate, Whiteboard: [adv-main45+][post-critsmash-triage])
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-details-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-show" id="field-alias" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias" id="alias-help-link" class="help">Alias:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-alias">
            CVE-2016-1970

        </span>
    </div>

  
</div>

    <div class="field" id="field-keywords"
>
    <div class="name">
        <a href="/describekeywords.cgi" id="keywords-help-link" class="help">Keywords:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-keywords">
          <a href="/buglist.cgi?keywords=csectype-bounds&amp;resolution=---">csectype-bounds</a>, 
          <a href="/buglist.cgi?keywords=sec-moderate&amp;resolution=---">sec-moderate</a>
        </span>
    </div>

  
</div>

    <div class="field" id="field-status_whiteboard"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/Whiteboard" id="status_whiteboard-help-link" class="help">Whiteboard:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-status_whiteboard">[adv-main45+][post-critsmash-triage]
        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_qa_whiteboard" style="display:none"
>
    <div class="name">QA Whiteboard:
    </div>


  
    <div class="value">
        <span id="field-value-cf_qa_whiteboard">
        ---
        </span>
    </div>

  
</div>

    

    <div class="field edit-show" id="field-cf_has_regression_range" style="display:none"
>
    <div class="name">Has Regression Range:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_regression_range">
            ---

        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_has_str" style="display:none"
>
    <div class="name">Has STR:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_str">
            ---

        </span>
    </div>

  
</div>

    <div class="field" id="field-votes"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes" id="votes-help-link" class="help">Votes:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-votes">0
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-bug_flags"
>
    <div class="name">Bug Flags:
    </div>


  
    <div class=" container">
        <span id="field-value-bug_flags"><div id="bug-flags" class="flags">
  <table class="layout-table">
          <tbody class="edit-hide"><tr>
    <td class="flag-setter"><div class="vcard vcard_280903" ><a class="email " href="/user_profile?user_id=280903" > <span class="fna">abillings</span></a>
</div>
    </td>

    <td class="flag-name">
        <a href="#a4728043_280903"
            class="rel-time-title activity-ref"
            title="6 years ago"
        data-time="1445557214"
      >sec-bounty</a>
    </td>

    <td class="flag-value">+
    </td>

  </tr>
          </tbody>
          <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter"><div class="vcard vcard_280903" ><a class="email " href="/user_profile?user_id=280903" > <span class="fna">abillings</span></a>
</div>
    </td>

    <td class="flag-name">
      <label title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug." for="flag-1278160">sec-bounty</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag-1278160-dirty">
      <select id="flag-1278160" name="flag-1278160"
        title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug."
        class="bug-flag">
            <option value="+" selected>+</option>
      </select>
    </td>


  </tr>
          </tbody>
    <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?" for="flag_type-930">behind-pref</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-930-dirty">
      <select id="flag_type-930" name="flag_type-930"
        title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?"
        class="bug-flag">
          <option value="X"></option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag tracking inclusion in the desktop Firefox product backlog." for="flag_type-846">firefox-backlog</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-846-dirty">
      <select id="flag_type-846" name="flag_type-846"
        title="Flag tracking inclusion in the desktop Firefox product backlog."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame." for="flag_type-913">sec-bounty-hof</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-913-dirty">
      <select id="flag_type-913" name="flag_type-913"
        title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-787">in-qa-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-787-dirty">
      <select id="flag_type-787" name="flag_type-787"
        title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>

      <td class="flag-requestee">
        <div id="requestee_type-787-container" style="display:none"><input
    name="requestee_type-787"
    value="" class="requestee bz_autocomplete_user"  id="requestee_type-787" 
  >
        </div>
      <td>

  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-37">in-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-37-dirty">
      <select id="flag_type-37" name="flag_type-37"
        title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually" for="flag_type-864">qe-verify</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-864-dirty">
      <select id="flag_type-864" name="flag_type-864"
        title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually"
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr>
    </tbody>
  </table>
</div>
        </span>
    </div>

  
</div>
</div>

  
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-crash-data"
>
    <header id="module-crash-data-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Crash Data section"
           data-label-collapsed="Expand Crash Data section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-crash-data-content"
             aria-expanded="false"
             aria-labeledby="module-crash-data-title"
             aria-describedby="module-crash-data-subtitle"></div>
        <h2 class="module-title" id="module-crash-data-title">Crash Data</h2>
      </div>
    </header>
  <div class="module-content" id="module-crash-data-content" style="display:none"
  ><div class="field edit-show" id="field-cf_crash_signature" style="display:none"
>
    <div class="name">Signature:
    </div>


  
    <div class="value">
        <span id="field-value-cf_crash_signature">
        </span>
    </div>

  
</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-security"
>
    <header id="module-security-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Security section"
           data-label-collapsed="Expand Security section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-security-content"
             aria-expanded="false"
             aria-labeledby="module-security-title"
             aria-describedby="module-security-subtitle"></div>
        <h2 class="module-title" id="module-security-title">Security</h2>
          <h3 class="module-subtitle" id="module-security-subtitle">
            (public)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-security-content" style="display:none"
  ><div class="groups edit-hide">
    This bug is publicly visible.
</div>

<div class="groups edit-show" style="display:none">


</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-user-story" data-non-stick="1"
>
    <header id="module-user-story-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse User Story section"
           data-label-collapsed="Expand User Story section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-user-story-content"
             aria-expanded="false"
             aria-labeledby="module-user-story-title"
             aria-describedby="module-user-story-subtitle"></div>
        <h2 class="module-title" id="module-user-story-title">User Story</h2>
      </div>
    </header>
  <div class="module-content" id="module-user-story-content" style="display:none"
  >
    <pre id="user-story"></pre>
  </div>
</section>







<section class="module" id="module-attachments"
>
    <header id="module-attachments-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Attachments section"
           data-label-collapsed="Expand Attachments section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-attachments-content"
             aria-expanded="true"
             aria-labeledby="module-attachments-title"
             aria-describedby="module-attachments-subtitle"></div>
        <h2 class="module-title" id="module-attachments-title">Attachments</h2>
          <h3 class="module-subtitle" id="module-attachments-subtitle">
            (1 file, 1 obsolete file)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-attachments-content"
  ><table role="table" class="layout-table" id="attachments">
    <tr class=" attach-obsolete attach-patch
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8681001">add explicit error checks for packet length in srtp</a>
        </div>
        <div>
            <a href="#c12" class="attach-time activity-ref"><span class="rel-time" title="2015-10-29 18:41 PDT" data-time="1446169306">6 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_11539" ><a class="email " href="/user_profile?user_id=11539" > <span class="fna">Randell Jesup [:jesup] (needinfo me)</span></a>
</div></span>
        </div>
        <div class="attach-info">2.70 KB,
          patch        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8681001&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8681001&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1216837&attachment=8681001">Splinter Review</a>
    </tr>
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=8683192">add explicit error checks for packet length in srtp</a>
        </div>
        <div>
            <a href="#c17" class="attach-time activity-ref"><span class="rel-time" title="2015-11-04 09:33 PST" data-time="1446658395">6 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_11539" ><a class="email " href="/user_profile?user_id=11539" > <span class="fna">Randell Jesup [:jesup] (needinfo me)</span></a>
</div></span>
        </div>
        <div class="attach-info">1.88 KB,
          patch        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_32546" ><span class="fn">mcmanus</span>
</div>:
              <a href="#a1471477_32546"
                  class="flag-name-status rel-time-title activity-ref"
                  title="6 years ago"
              data-time="1446658395"
            >
              review+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_32546" ><span class="fn">mcmanus</span>
</div>:
              <a href="#c23"
                  class="flag-name-status rel-time-title activity-ref"
                  title="6 years ago"
              data-time="1446683073"
            >
              feedback+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=8683192&amp;action=edit">Details</a>
          | <a href="/attachment.cgi?id=8683192&amp;action=diff">Diff</a>&#x0020; |
  <a href="/page.cgi?id=splinter.html&ignore=&bug=1216837&attachment=8683192">Splinter Review</a>
    </tr>
</table>

<footer id="attachments-footer">
  <div id="attachments-actions">
      <button type="button" id="attachments-obsolete-btn" class="secondary">Show Obsolete</button>
  </div>
  
</footer>
  </div>
</section>



<script nonce="pGyYGEtK9bTGoq8RBZjiIsWn26XPEs3RazAhWOk2YovlfVcR">
  init_module_visibility();
</script>



<meta name="firefox-versions" content="{&quot;FIREFOX_AURORA&quot;:&quot;&quot;,&quot;FIREFOX_DEVEDITION&quot;:&quot;94.0b9&quot;,&quot;FIREFOX_ESR&quot;:&quot;78.15.0esr&quot;,&quot;FIREFOX_ESR_NEXT&quot;:&quot;91.2.0esr&quot;,&quot;FIREFOX_NIGHTLY&quot;:&quot;95.0a1&quot;,&quot;FIREFOX_PINEBUILD&quot;:&quot;&quot;,&quot;LAST_MERGE_DATE&quot;:&quot;2021-10-04&quot;,&quot;LAST_RELEASE_DATE&quot;:&quot;2021-10-05&quot;,&quot;LAST_SOFTFREEZE_DATE&quot;:&quot;2021-09-30&quot;,&quot;LATEST_FIREFOX_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_OLDER_VERSION&quot;:&quot;3.6.28&quot;,&quot;LATEST_FIREFOX_RELEASED_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_VERSION&quot;:&quot;93.0&quot;,&quot;NEXT_MERGE_DATE&quot;:&quot;2021-11-01&quot;,&quot;NEXT_RELEASE_DATE&quot;:&quot;2021-11-02&quot;,&quot;NEXT_SOFTFREEZE_DATE&quot;:&quot;2021-10-28&quot;}">


<div id="comment-actions">
    <button type="button" id="bottom-btn" class="secondary" aria-label="Go to Page Bottom">Bottom &darr;</button>
  <div class="dropdown">
    <button type="button" id="comment-tags-btn" aria-haspopup="true" aria-label="Tags"
      aria-expanded="false" aria-controls="comment-tags-menu" class="dropdown-button minor">Tags &#9662;</button>
    <ul id="comment-tags-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a role="menuitem" tabindex="-1" data-comment-tag="">Reset</a>
      </li>
    </ul>
  </div>
  <div class="dropdown">
    <button type="button" id="view-menu-btn" aria-haspopup="true" aria-label="Timeline"
      aria-expanded="false" aria-controls="view-menu" class="dropdown-button minor">Timeline &#9662;</button>
    <ul id="view-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a id="view-reset" role="menuitem" tabindex="-1">Reset</a>
      </li>
      <li role="separator"></li>
      <li role="presentation">
        <a id="view-collapse-all" role="menuitem" tabindex="-1">Collapse All</a>
      </li>
      <li role="presentation">
        <a id="view-expand-all" role="menuitem" tabindex="-1">Expand All</a>
      </li>
      <li role="presentation">
        <a id="view-comments-only" role="menuitem" tabindex="-1">Comments Only</a>
      </li>
    </ul>
   </div>
</div>
<div class="change-set" id="c0"><div class="comment" data-id="10857764" data-no="0"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-0" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_140243" ><img src="https://secure.gravatar.com/avatar/6f792da717b676641d0a7095b55f0fdf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_140243" ><a class="email " href="/user_profile?user_id=140243" > <span class="fna">q1</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-0"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-0" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1216837#c0">Description</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-10-20 18:13 PDT" data-time="1445389988">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-0">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-0" data-comment-id="10857764">srtp_unprotect (netwerk\srtp\src\srtp\srtp.c) can experience an integer underflow. If it does, it calls a decryption function with a buffer pointer pointing to memory to which it has no right, and with a very large buffer length. This call could scramble large portions of memory, causing incorrect and possibly insecure behavior.

It is unclear whether the bug can be invoked, because that depends upon behavior of a decryption function that I don't currently understand.

(There is also a similar bug in srtp_unprotect_rtcp).


Details
-------

The bug is in this code:

950: err_status_t
951: srtp_unprotect(srtp_ctx_t *ctx, void *srtp_hdr, int *pkt_octet_len) {
...
1073:   if (stream-&gt;rtp_services &amp; sec_serv_conf) {
1074:     enc_start = (uint32_t *)hdr + uint32s_in_rtp_header + hdr-&gt;cc;  
1075:     if (hdr-&gt;x == 1) {
1076:       srtp_hdr_xtnd_t *xtn_hdr = (srtp_hdr_xtnd_t *)enc_start;
1077:       enc_start += (ntohs(xtn_hdr-&gt;length) + 1);
1078:     }  
1079:     enc_octet_len = (uint32_t)(*pkt_octet_len - tag_len 
1080: 			       - ((enc_start - (uint32_t *)hdr) &lt;&lt; 2));
1081:   } else {
1082:     enc_start = NULL;
1083:   }
...
1162:   if (enc_start) {
1163:     status = cipher_decrypt(stream-&gt;rtp_cipher, 
1164: 			    (uint8_t *)enc_start, &amp;enc_octet_len);
1165:     if (status)
1166:       return err_status_cipher_fail;
1167:   }

which does not check whether |hdr-&gt;cc| (line 1074) and |xtn_hdr-&gt;length| (line 1077) are such that any portion of the region described by |enc_start| and |enc_octet_len| lies outside of the packet that begins at |hdr| and extends for |*pkt_octet_len| bytes.

When using Firefox Hello, |cipher_decrypt| devolves to |aes_icm_encrypt_ismacryp| (netwerk\srtp\src\crypto\cipher\aes_icm.c), which checks the decryption buffer length thusly:

344: err_status_t
345: aes_icm_encrypt_ismacryp(aes_icm_ctx_t *c,
346:               unsigned char *buf, unsigned int *enc_len, 
347:               int forIsmacryp) {
348:   unsigned int bytes_to_encr = *enc_len;
349:   unsigned int i;
350:   uint32_t *b;
351:
352:   /* check that there's enough segment left but not for ismacryp*/
353:   if (!forIsmacryp &amp;&amp; (bytes_to_encr + htons(c-&gt;counter.v16[7])) &gt; 0xffff)
354:     return err_status_terminus;
...

with |forIsmacryp| == false. I don't understand how |c-&gt;counter.v16[7]| is used. If it can ever be &gt;= 0x0400 (&gt;= 4 when decoded), then an attacking peer can send a malformed packet that yields an |*enc_len| &lt;= 0xfffffffc, which will pass the test on line 353 and cause aes_icm_encrypt_ismacryp to scramble |*enc_len| bytes of memory.

|c-&gt;counter.v16[7]| has never been nonzero in my testing using Firefox Hello.</pre></div><div class="change-set" id="a167226_280903"><div class="change" id="aa167226_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a167226_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a167226_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a167226_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a167226_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1216837#a167226_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-10-22 16:40 PDT" data-time="1445557214">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: sec-bounty?</div></div></div><div class="change-set" id="a191194_1689"><div class="change" id="aa191194_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a191194_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a191194_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a191194_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a191194_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1216837#a191194_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-10-22 23:19 PDT" data-time="1445581182">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: core-security &rarr; network-core-security</div></div></div><div class="change-set" id="c1"><div class="comment" data-id="10878135" data-no="1"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-1" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_406194" id="a191194_1689"><img src="https://secure.gravatar.com/avatar/0a70c84cd33dba0151fe15f2f8773137?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_406194" id="a191194_1689"><a class="email " href="/user_profile?user_id=406194" > <span class="fna">Andrew McCreight [:mccr8]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-1"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-1" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1216837#c1">Comment 1</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-10-27 10:35 PDT" data-time="1445967339">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-1">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-1" data-comment-id="10878135">Randell, it looks like you are the last person to touch this code, by landing it from somewhere else in 2012. Could you take a look? Thanks.</pre><div class="activity"><div class="change">Flags: needinfo?(rjesup)</div></div></div><div class="change-set" id="c2"><div class="comment" data-id="10879279" data-no="2"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-2" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_11539" id="a191194_1689"><img src="https://secure.gravatar.com/avatar/ae002109ba1cfbb7f5ad990cc5d9fbaf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_11539" id="a191194_1689"><a class="email " href="/user_profile?user_id=11539" > <span class="fna">Randell Jesup [:jesup] (needinfo me)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-2"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-2" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1216837#c2">Comment 2</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-10-27 15:07 PDT" data-time="1445983671">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-2">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-2" data-comment-id="10879279">This is libsrtp (upstream); I'll check into this.  I'll verify if this can actually fail or not.  My suspicion is that it can't, but I'll have to go over the code carefully to verify.  (I'm also an author/peer for libsrtp, though I haven't done anything there recently other than monitor it.)

Moving to Unconfirmed as it's not clear if there's really a bug here yet, per <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Underflow in srtp_unprotect could cause memory-safety bug"
   href="/show_bug.cgi?id=1216837#c0">comment 0</a>.

Thanks for the report!  I'll also check it against latest upstream source.  libsrtp has been very stable, overall, though there is some ongoing work (largely cleanup and modernization).</pre><div class="activity"><div class="change">Status: NEW &rarr; UNCONFIRMED</div><div class="change">Component: Networking &rarr; WebRTC: Networking</div><div class="change">Ever confirmed: false</div><div class="change">Flags: <span class="activity-deleted">needinfo?(rjesup)</span></div></div></div><div class="change-set" id="c3"><div class="comment" data-id="10882435" data-no="3"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-3" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_140243" id="a191194_1689"><img src="https://secure.gravatar.com/avatar/6f792da717b676641d0a7095b55f0fdf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_140243" id="a191194_1689"><a class="email " href="/user_profile?user_id=140243" > <span class="fna">q1</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-3"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-3" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1216837#c3">Comment 3</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-10-28 12:08 PDT" data-time="1446059316">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-3">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-3" data-comment-id="10882435"><span class="quote">&gt; Thanks for the report!</span >

You're welcome. Here is one way to manifest the bug. RtpHeaderParser::Parse (media\webrtc\trunk\webrtc\modules\rtp_rtcp\source\rtp_utility.cc) can overflow while parsing the packet extension:

378:  if (X) {
379:    /* RTP header extension, RFC 3550.
370:     0                   1                   2                   3
381:     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
382:    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
383:    |      defined by profile       |           length              |
384:    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
385:    |                        header extension                       |
386:    |                             ....                              |
387:    */
388:    const ptrdiff_t remain = _ptrRTPDataEnd - ptr;
389:    if (remain &lt; 4) {
390:      return false;
391:    }
392:
393:    header.headerLength += 4;
394:
395:    uint16_t definedByProfile = *ptr++ &lt;&lt; 8;
396:    definedByProfile += *ptr++;
397:
398:    uint16_t XLen = *ptr++ &lt;&lt; 8;
399:    XLen += *ptr++; // in 32 bit words
400:    XLen *= 4; // in octs
401:
402:    if (remain &lt; (4 + XLen)) {
403:      return false;
404:    }
405:    if (definedByProfile == kRtpOneByteHeaderExtensionId) {
406:      const uint8_t* ptrRTPDataExtensionEnd = ptr + XLen;
407:      ParseOneByteExtensionHeader(header,
408:                                  ptrExtensionMap,
409:                                  ptrRTPDataExtensionEnd,
410:                                  ptr);
411:    }
412:    header.headerLength += XLen;
413:  }
414:  return true;
415:}

This can occur if the 2 length bytes fetched in lines 398-99 total &gt;= 0x4000. Choosing exactly 0x4000, line 400 then computes 0. This passes the test on line 402, has no impact on lines 405-11, |leaves header.headerLength| on line 412 unchanged, and causes success status to be returned. (Should I file this as a separate bug?)

Later, when srtp_unprotect is called, it blithely fetches the same length bytes from the packet on line 1077 (above), adds 1 (computing the value 0x4001), then adds them to |enc_start|. This then causes an underflow in the computation of |enc_octet_len| on lines 1079-80.

You can verify this scenario by modifying the extension header length in the debugger when control is at the beginning of MediaPipeline::PacketReceived (before any parsing) and then stepping the relevant code. You have to skip the auth checking in srtp_unprotect lines 1139-40 because you've modified the packet. However, an attacking peer would simply send the nasty packet with the correct auth data, so this doesn't invalidate the test case. Also maybe it's possible for |sec_serv_auth| to be disabled?</pre></div><div class="change-set" id="c4"><div class="comment" data-id="10883954" data-no="4"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-4" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_11539" id="a191194_1689"><img src="https://secure.gravatar.com/avatar/ae002109ba1cfbb7f5ad990cc5d9fbaf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_11539" id="a191194_1689"><a class="email " href="/user_profile?user_id=11539" > <span class="fna">Randell Jesup [:jesup] (needinfo me)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-4"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-4" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1216837#c4">Comment 4</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-10-28 20:53 PDT" data-time="1446090838">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-4">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-4" data-comment-id="10883954">(In reply to q1 from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Underflow in srtp_unprotect could cause memory-safety bug"
   href="/show_bug.cgi?id=1216837#c0">comment #0</a>)
<span class="quote">&gt; srtp_unprotect (netwerk\srtp\src\srtp\srtp.c) can experience an integer
&gt; underflow. If it does, it calls a decryption function with a buffer pointer
&gt; pointing to memory to which it has no right, and with a very large buffer
&gt; length. This call could scramble large portions of memory, causing incorrect
&gt; and possibly insecure behavior.
&gt; 
&gt; It is unclear whether the bug can be invoked, because that depends upon
&gt; behavior of a decryption function that I don't currently understand.
&gt; 
&gt; (There is also a similar bug in srtp_unprotect_rtcp).
&gt; 
&gt; 
&gt; Details
&gt; -------
&gt; 
&gt; The bug is in this code:
&gt; 
&gt; 950: err_status_t
&gt; 951: srtp_unprotect(srtp_ctx_t *ctx, void *srtp_hdr, int *pkt_octet_len) {
&gt; ...
&gt; 1073:   if (stream-&gt;rtp_services &amp; sec_serv_conf) {
&gt; 1074:     enc_start = (uint32_t *)hdr + uint32s_in_rtp_header + hdr-&gt;cc;  
&gt; 1075:     if (hdr-&gt;x == 1) {
&gt; 1076:       srtp_hdr_xtnd_t *xtn_hdr = (srtp_hdr_xtnd_t *)enc_start;
&gt; 1077:       enc_start += (ntohs(xtn_hdr-&gt;length) + 1);
&gt; 1078:     }  
&gt; 1079:     enc_octet_len = (uint32_t)(*pkt_octet_len - tag_len 
&gt; 1080: 			       - ((enc_start - (uint32_t *)hdr) &lt;&lt; 2));
&gt; 1081:   } else {
&gt; 1082:     enc_start = NULL;
&gt; 1083:   }
&gt; ...
&gt; 1162:   if (enc_start) {
&gt; 1163:     status = cipher_decrypt(stream-&gt;rtp_cipher, 
&gt; 1164: 			    (uint8_t *)enc_start, &amp;enc_octet_len);
&gt; 1165:     if (status)
&gt; 1166:       return err_status_cipher_fail;
&gt; 1167:   }
&gt; 
&gt; which does not check whether |hdr-&gt;cc| (line 1074) and |xtn_hdr-&gt;length|
&gt; (line 1077) are such that any portion of the region described by |enc_start|
&gt; and |enc_octet_len| lies outside of the packet that begins at |hdr| and
&gt; extends for |*pkt_octet_len| bytes.</span >

hdr-&gt;cc and xtn_hdr-&gt;length are both unsigned (:4 and uint16_t respectively).
Clearly this could push enc_start into the packet, or past the end of the packet, since they're not checked.

Then enc_octet_len is calculated by dropping the tag len from the count, and then calculating how many 32-bit words enc_start is after hdr, and converting to a byte count.  Then it's subtracted from *pkt_octet_len.  If that's past the end of the packet, these subtractions will underflow (it's a uint32_t), yielding a very large value.

As discussed, this will run decryption on memory past the end of the packet.  Auth will be run, but auth is not run using enc_start or enc_octet_len; it uses hdr and tag_len and pkt_octet_len, so doing this won't fail auth.
Running decryption over this memory will (effectively) scramble it; it's *close* to the equivalent of writing random values into that memory.  There's still the issue of getting counter.v16[7] to be non-zero... so see below.

Upstream code has already resolved this by adding:
    if (!((uint8_t*)enc_start &lt; (uint8_t*)hdr + *pkt_octet_len))
      return srtp_err_status_parse_err;

There's a similar (though not exactly the same) issue in RTCP handling, where a check was added upstream for negative lengths/etc

<span class="quote">&gt; 
&gt; When using Firefox Hello, |cipher_decrypt| devolves to
&gt; |aes_icm_encrypt_ismacryp| (netwerk\srtp\src\crypto\cipher\aes_icm.c), which
&gt; checks the decryption buffer length thusly:
&gt; 
&gt; 344: err_status_t
&gt; 345: aes_icm_encrypt_ismacryp(aes_icm_ctx_t *c,
&gt; 346:               unsigned char *buf, unsigned int *enc_len, 
&gt; 347:               int forIsmacryp) {
&gt; 348:   unsigned int bytes_to_encr = *enc_len;
&gt; 349:   unsigned int i;
&gt; 350:   uint32_t *b;
&gt; 351:
&gt; 352:   /* check that there's enough segment left but not for ismacryp*/
&gt; 353:   if (!forIsmacryp &amp;&amp; (bytes_to_encr + htons(c-&gt;counter.v16[7])) &gt;
&gt; 0xffff)
&gt; 354:     return err_status_terminus;
&gt; ...
&gt; 
&gt; with |forIsmacryp| == false. I don't understand how |c-&gt;counter.v16[7]| is
&gt; used. If it can ever be &gt;= 0x0400 (&gt;= 4 when decoded), then an attacking
&gt; peer can send a malformed packet that yields an |*enc_len| &lt;= 0xfffffffc,
&gt; which will pass the test on line 353 and cause aes_icm_encrypt_ismacryp to
&gt; scramble |*enc_len| bytes of memory.
&gt; 
&gt; |c-&gt;counter.v16[7]| has never been nonzero in my testing using Firefox Hello.</span >

I believe the input to aes_icm_encrypt_ismacryp() of c-&gt;counter.v16[7] is *always* zero in our usage in aes_icm in libsrtp - before encrypting/decrypting each packet, it calls cipher_set_iv() -&gt; aes_icm_set_iv() with a nonce which has 0's in those 16 bits always (built from est&lt;&lt;16 - and est is a 16-bit sequence number (est = (xtd_seq_num_t) ntohs(hdr-&gt;seq);)/  aes_icm_set_iv xors the context's offset value with the nonce to generate the new counter value.  The offset is created with this comment:   /* force last two octets of the offset to be left zero (for srtp compatibility) */, and it only sets offset.v8[0-13], leaving [14] and [15] 0.  Thus, set_iv always leaves counter.v16[7] == 0, so it's always 0 at entry to that routine.  v16[7] does get incremented within the routine, but it's reset by cipher_set_iv() before re-entering.

Thus this: &quot;If it can ever be &gt;= 0x0400 (&gt;= 4 when decoded)&quot; can't happen.

Ugh, what a pain tracing this though.  And I can see why they added a clear failure mode/return for this sort of error to upstream.</pre></div><div class="change-set" id="c5"><div class="comment" data-id="10884001" data-no="5"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-5" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_11539" id="a191194_1689"><img src="https://secure.gravatar.com/avatar/ae002109ba1cfbb7f5ad990cc5d9fbaf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_11539" id="a191194_1689"><a class="email " href="/user_profile?user_id=11539" > <span class="fna">Randell Jesup [:jesup] (needinfo me)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-5"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-5" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1216837#c5">Comment 5</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-10-28 21:13 PDT" data-time="1446091992">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-5">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-5" data-comment-id="10884001">Just to clarify:

<span class="quote">&gt; Thus this: &quot;If it can ever be &gt;= 0x0400 (&gt;= 4 when decoded)&quot; can't happen.</span >

That's true... 

<span class="quote">&gt; with |forIsmacryp| == false. I don't understand how |c-&gt;counter.v16[7]| is
&gt; used. If it can ever be &gt;= 0x0400 (&gt;= 4 when decoded), then an attacking
&gt; peer can send a malformed packet that yields an |*enc_len| &lt;= 0xfffffffc,
&gt; which will pass the test on line 353 and cause aes_icm_encrypt_ismacryp to
&gt; scramble |*enc_len| bytes of memory.</span >

The code is: if (!forIsmacryp &amp;&amp; (bytes_to_encr + htons(c-&gt;counter.v16[7])) &gt; 0xffff) 
return an error.  So it will return an error if a) forIsmcryp is 0, and b) bytes_to_encr+0 &gt; 0xffff.
a) is true, and b will be true on any overflow where we wrap around, unless we go so far around that we're under 0xffff.  To do that, enc_start would have to be almost 4G *past* hdr, which can't be done with the 16-bits-of-32-bit-words header extension length.

I believe this is the (unstated) reason why the quoted text says it's a bug if v16[7] can be large enough 0x4, since that could let a small overflow sneak past this check.</pre></div><div class="change-set" id="c6"><div class="comment" data-id="10885913" data-no="6"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-6" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_140243" id="a191194_1689"><img src="https://secure.gravatar.com/avatar/6f792da717b676641d0a7095b55f0fdf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_140243" id="a191194_1689"><a class="email " href="/user_profile?user_id=140243" > <span class="fna">q1</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-6"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-6" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1216837#c6">Comment 6</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-10-29 09:33 PDT" data-time="1446136410">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-6">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-6" data-comment-id="10885913">(In reply to Randell Jesup [:jesup] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Underflow in srtp_unprotect could cause memory-safety bug"
   href="/show_bug.cgi?id=1216837#c4">comment #4</a>)
...

<span class="quote">&gt; Upstream code has already resolved this by adding:
&gt;    if (!((uint8_t*)enc_start &lt; (uint8_t*)hdr + *pkt_octet_len))
&gt;      return srtp_err_status_parse_err;</span >

That's not good enough. It also has to check whether |enc_start + enc_octet_len &lt; (uint8_t*)hdr + *pkt_octet_len)|. Try doctoring the length bytes to yield a length of 5 in the debugger. With | *pkt_octet_len == 0x27| (a typical value), |enc_start| ends up == |hdr + *pkt_octet_len - 3|, so it passes the new upstream test. However, |enc_octet_len| ends up == 0x27 - 0xa - (9 &lt;&lt; 2) == 0xfffffff9.

<span class="quote">&gt; Ugh, what a pain tracing this though.</span >

Thank you for doing so.

<span class="quote">&gt; And I can see why they added a clear
&gt; failure mode/return for this sort of error to upstream.</span >

Yes. As much as reasonable within well-defined constraints (e.g., performance), code should protect itself from insecure behavior. Along those lines, I will file the bug in RtpHeaderParser::Parse that I noted in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Underflow in srtp_unprotect could cause memory-safety bug"
   href="/show_bug.cgi?id=1216837#c3">comment 3</a> separately.</pre></div><div class="change-set" id="c7"><div class="comment" data-id="10885939" data-no="7"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-7" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_140243" id="a191194_1689"><img src="https://secure.gravatar.com/avatar/6f792da717b676641d0a7095b55f0fdf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_140243" id="a191194_1689"><a class="email " href="/user_profile?user_id=140243" > <span class="fna">q1</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-7"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-7" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1216837#c7">Comment 7</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-10-29 09:38 PDT" data-time="1446136712">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-7">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-7" data-comment-id="10885939">Oops, |enc_start + enc_octet_len &lt; (uint8_t*)hdr + *pkt_octet_len)| should read |(uint8 *)enc_start + enc_octet_len &lt; (uint8_t*)hdr + *pkt_octet_len)|. The point is still the same, however.</pre></div><div class="change-set" id="c8"><div class="comment" data-id="10885975" data-no="8"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-8" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_140243" id="a191194_1689"><img src="https://secure.gravatar.com/avatar/6f792da717b676641d0a7095b55f0fdf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_140243" id="a191194_1689"><a class="email " href="/user_profile?user_id=140243" > <span class="fna">q1</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-8"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-8" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1216837#c8">Comment 8</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-10-29 09:45 PDT" data-time="1446137155">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-8">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-8" data-comment-id="10885975">(In reply to q1 from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Underflow in srtp_unprotect could cause memory-safety bug"
   href="/show_bug.cgi?id=1216837#c6">comment #6</a>)
<span class="quote">&gt; I will file the bug in RtpHeaderParser::Parse that I noted in comment
&gt; 3 separately.</span >

<a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Overflow in RtpHeaderParser::Parse can cause memory-safety bug"
   href="/show_bug.cgi?id=1219814">https://bugzilla.mozilla.org/show_bug.cgi?id=1219814</a></pre></div><div class="change-set" id="c9"><div class="comment" data-id="10886937" data-no="9"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-9" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_140243" id="a191194_1689"><img src="https://secure.gravatar.com/avatar/6f792da717b676641d0a7095b55f0fdf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_140243" id="a191194_1689"><a class="email " href="/user_profile?user_id=140243" > <span class="fna">q1</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-9"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-9" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1216837#c9">Comment 9</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-10-29 13:35 PDT" data-time="1446150936">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-9">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-9" data-comment-id="10886937">srtp_unprotect also should check whether |*pkt_octet_len| is sufficiently long to accommodate an auth string of length |tag_len|. At present this is coincidentally covered by the check of |*pkt_octet_len| against |octets_in_rtp_header| because all of the crypto policies (see srtp.c) use &lt;= 10 auth bytes, but if anyone uses more than 12 auth bytes (which appears to be allowed by RFC 3711), that check will no longer be sufficient.</pre></div><div class="change-set" id="c10"><div class="comment" data-id="10887303" data-no="10"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-10" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_11539" id="a191194_1689"><img src="https://secure.gravatar.com/avatar/ae002109ba1cfbb7f5ad990cc5d9fbaf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_11539" id="a191194_1689"><a class="email " href="/user_profile?user_id=11539" > <span class="fna">Randell Jesup [:jesup] (needinfo me)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-10"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-10" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1216837#c10">Comment 10</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-10-29 15:19 PDT" data-time="1446157160">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-10">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-10" data-comment-id="10887303">(In reply to q1 from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Underflow in srtp_unprotect could cause memory-safety bug"
   href="/show_bug.cgi?id=1216837#c9">comment #9</a>)
<span class="quote">&gt; srtp_unprotect also should check whether |*pkt_octet_len| is sufficiently
&gt; long to accommodate an auth string of length |tag_len|. At present this is
&gt; coincidentally covered by the check of |*pkt_octet_len| against
&gt; |octets_in_rtp_header| because all of the crypto policies (see srtp.c) use
&gt; &lt;= 10 auth bytes, but if anyone uses more than 12 auth bytes (which appears
&gt; to be allowed by RFC 3711), that check will no longer be sufficient.</span >

If so, it would be a bug in upstream libsrtp, but not in our usage of it.  I'd suggest filing an issue on the tracker at github.com/cisco/libsrtp</pre></div><div class="change-set" id="c11"><div class="comment" data-id="10887889" data-no="11"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-11" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_11539" id="a191194_1689"><img src="https://secure.gravatar.com/avatar/ae002109ba1cfbb7f5ad990cc5d9fbaf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_11539" id="a191194_1689"><a class="email " href="/user_profile?user_id=11539" > <span class="fna">Randell Jesup [:jesup] (needinfo me)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-11"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-11" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1216837#c11">Comment 11</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-10-29 18:33 PDT" data-time="1446168826">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-11">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-11" data-comment-id="10887889">[Tracking Requested - why for this release]:
sec bug, though very hard to exploit.

(In reply to q1 from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Underflow in srtp_unprotect could cause memory-safety bug"
   href="/show_bug.cgi?id=1216837#c6">comment #6</a>)
<span class="quote">&gt; (In reply to Randell Jesup [:jesup] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Underflow in srtp_unprotect could cause memory-safety bug"
   href="/show_bug.cgi?id=1216837#c4">comment #4</a>)
&gt; ...
&gt; 
&gt; &gt; Upstream code has already resolved this by adding:
&gt; &gt;    if (!((uint8_t*)enc_start &lt; (uint8_t*)hdr + *pkt_octet_len))
&gt; &gt;      return srtp_err_status_parse_err;
&gt; 
&gt; That's not good enough. It also has to check whether |enc_start +
&gt; enc_octet_len &lt; (uint8_t*)hdr + *pkt_octet_len)|. Try doctoring the length
&gt; bytes to yield a length of 5 in the debugger. With | *pkt_octet_len == 0x27|
&gt; (a typical value), |enc_start| ends up == |hdr + *pkt_octet_len - 3|, so it
&gt; passes the new upstream test. However, |enc_octet_len| ends up == 0x27 - 0xa
&gt; - (9 &lt;&lt; 2) == 0xfffffff9.</span >

So if it passes the new check, hdr &lt;= enc_start &lt; hdr + *pkt_octet_len.  So there are 0 or more bytes following enc_start that are in the packet.  Then we calculate
    enc_octet_len = (uint32_t)(*pkt_octet_len - tag_len -
                               ((uint8_t*)enc_start - (uint8_t*)hdr));
so worst case (enc_start+1 == hdr + *pkt_octet_len, 0 bytes following enc_start in the packet): you would end up with -tag_len bytes - which is a negative value, which means underflow in uint32_t land.

So the upstream test is insufficient, but only because it doesn't take tag_len into account.  Change upstream to 
    if (!((uint8_t*)enc_start &lt; (uint8_t*)hdr + (*pkt_octet_len - tag_len)))
      return err_status_parse_err;
and we're good - if enc_start is as large as possible to pass that, enc_octet_len will be 0.  It appears that aes_icm_encrypt_ismacryp() handles an input length of 0, though we could tighten it if it makes sense.   

There's another upstream bug (small) where if tag_len &gt; length-of-packet it could in theory read before the start of the packet.  I think in practice this is impossible unless you create a crypto profile with a tag longer than an RTP header - and the worst case an attacker could do there would be to cause it to crash on a read.

<span class="quote">&gt; &gt; Ugh, what a pain tracing this though.
&gt; 
&gt; Thank you for doing so.</span >

No problem; thanks for finding it.  We'll coordinate our landing with an upstream patch for this (don't want to 0-day anyone, not that this would be very exploitable - mostly just unpredictably(?) scrambling some memory following the packet.)  The attacker can predict the keys/etc used by the decryption call, so it knows what operation will happen on the memory.  But it doesn't know what the values in that memory are (though it may be able to guess some, since it knows it's a fresh allocation), and the operation is an encrypt operation, so tends to be very randomizing.  Very (extremely!) hard to exploit beyond simple denial-of-service, though probably not *quite* impossible (very close though).

Also, underflowing the length by a small number bytes means a Very Large number of bytes will be randomized, not just a few.  (MAX_UNSIGNED minus a few).  This means a large amount of memory will be trashed, all the more likely leading to a fast random/unpredictable crash.

Based on that, I'm going to sec-moderate.  Also this analysis gives a reduced risk to other libsrtp users, though I still plan to coordinate a fix and landing with them.

Thanks!!</pre><div class="activity"><div class="change">Assignee: nobody &rarr; rjesup</div><div class="change">Status: UNCONFIRMED &rarr; ASSIGNED</div><div class="change">backlog: --- &rarr; webrtc/webaudio+</div><div class="change">Rank: 10</div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_b2g_2_0&amp;o1=isnotempty">status-b2g-v2.0</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_b2g_2_0&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox41&amp;o1=isnotempty">status-firefox41</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox41&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox42&amp;o1=isnotempty">status-firefox42</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox42&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox43&amp;o1=isnotempty">status-firefox43</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox43&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox44&amp;o1=isnotempty">status-firefox44</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox44&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox45&amp;o1=isnotempty">status-firefox45</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox45&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr38&amp;o1=isnotempty">status-firefox-esr38</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr38&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox42&amp;o1=isnotempty">tracking-firefox42</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox42&amp;o1=equals&amp;v1=%3F">?</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr38&amp;o1=isnotempty">tracking-firefox-esr38</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox_esr38&amp;o1=equals&amp;v1=%3F">?</a></div><div class="change">Ever confirmed: true</div><div class="change">Keywords: <a href="/buglist.cgi?keywords=csectype-bounds&amp;resolution=---">csectype-bounds</a>, 
          
            <a href="/buglist.cgi?keywords=sec-moderate&amp;resolution=---">sec-moderate</a></div><div class="change">Priority: -- &rarr; P1</div></div></div><div class="change-set" id="c12"><div class="comment" data-id="10887907" data-no="12"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-12" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_11539" id="a191194_1689"><img src="https://secure.gravatar.com/avatar/ae002109ba1cfbb7f5ad990cc5d9fbaf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_11539" id="a191194_1689"><a class="email " href="/user_profile?user_id=11539" > <span class="fna">Randell Jesup [:jesup] (needinfo me)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-12"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-12" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1216837#c12">Comment 12</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-10-29 18:41 PDT" data-time="1446169306">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-12">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8681001"
         class="attachment patch obsolete"
         data-id="8681001" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="libsrtp">
      <meta itemprop="contentSize" content="2764">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8681001">
          <a class="link" href="attachment.cgi?id=8681001&amp;action=diff">
        <span id="att-8681001-description" itemprop="description">add explicit error checks for packet length in srtp</span></a> (obsolete)
        — <a href="attachment.cgi?id=8681001&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1216837&attachment=8681001">Splinter Review</a>
      </div>
    </div></div><div class="change-set" id="c13"><div class="comment" data-id="10889920" data-no="13"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-13" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_140243" id="a191194_1689"><img src="https://secure.gravatar.com/avatar/6f792da717b676641d0a7095b55f0fdf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_140243" id="a191194_1689"><a class="email " href="/user_profile?user_id=140243" > <span class="fna">q1</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-13"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-13" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1216837#c13">Comment 13</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-10-30 10:03 PDT" data-time="1446224627">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-13">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-13" data-comment-id="10889920">(In reply to Randell Jesup [:jesup] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Underflow in srtp_unprotect could cause memory-safety bug"
   href="/show_bug.cgi?id=1216837#c11">comment #11</a>)
<span class="quote">&gt; [Tracking Requested - why for this release]:
&gt; sec bug, though very hard to exploit.
&gt; 
&gt; (In reply to q1 from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Underflow in srtp_unprotect could cause memory-safety bug"
   href="/show_bug.cgi?id=1216837#c6">comment #6</a>)
&gt; &gt; (In reply to Randell Jesup [:jesup] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Underflow in srtp_unprotect could cause memory-safety bug"
   href="/show_bug.cgi?id=1216837#c4">comment #4</a>)
&gt; &gt; ...
&gt; &gt; 
&gt; &gt; &gt; Upstream code has already resolved this by adding:
&gt; &gt; &gt;    if (!((uint8_t*)enc_start &lt; (uint8_t*)hdr + *pkt_octet_len))
&gt; &gt; &gt;      return srtp_err_status_parse_err;
&gt; &gt; 
&gt; &gt; That's not good enough. It also has to check whether |enc_start +
&gt; &gt; enc_octet_len &lt; (uint8_t*)hdr + *pkt_octet_len)|. Try doctoring the length
&gt; &gt; bytes to yield a length of 5 in the debugger. With | *pkt_octet_len == 0x27|
&gt; &gt; (a typical value), |enc_start| ends up == |hdr + *pkt_octet_len - 3|, so it
&gt; &gt; passes the new upstream test. However, |enc_octet_len| ends up == 0x27 - 0xa
&gt; &gt; - (9 &lt;&lt; 2) == 0xfffffff9.
&gt; ...
&gt; So the upstream test is insufficient, but only because it doesn't take
&gt; tag_len into account.  Change upstream to 
&gt;     if (!((uint8_t*)enc_start &lt; (uint8_t*)hdr + (*pkt_octet_len - tag_len)))
&gt;       return err_status_parse_err;
&gt; and we're good - if enc_start is as large as possible to pass that,
&gt; enc_octet_len will be 0.  It appears that aes_icm_encrypt_ismacryp() handles
&gt; an input length of 0, though we could tighten it if it makes sense.   </span >

OK, that works, though only because enc_start can't overflow to &lt; hdr, which is only because hdr-&gt;cc is 4 (unsigned) bits and xtn_hdr is 16 (unsigned) bits. I'd be more comfortable with a double-ended test, which guarantees an error if any portion of [enc_start, enc_start+enc_octet_len) lies outside [hdr, hdr+*pkt_octet_len); it's more future-proof.
 
<span class="quote">&gt; There's another upstream bug (small) where if tag_len &gt; length-of-packet it
&gt; could in theory read before the start of the packet.  I think in practice
&gt; this is impossible unless you create a crypto profile with a tag longer than
&gt; an RTP header - and the worst case an attacker could do there would be to
&gt; cause it to crash on a read.</span >

It wouldn't necessarily crash; it (meaning the auth code on line 1139) could read data from before the packet's beginning. It also would cause other code to malfunction (probably causing leaks and possibly out-of-bounds writing) because of the |*pkt_octet_len -= tag_len| on line 1221. But as you say, you need to create a nondefault crypto profile to make all that happen.</pre></div><div class="change-set" id="c14"><div class="comment" data-id="10889931" data-no="14"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-14" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_140243" id="a191194_1689"><img src="https://secure.gravatar.com/avatar/6f792da717b676641d0a7095b55f0fdf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_140243" id="a191194_1689"><a class="email " href="/user_profile?user_id=140243" > <span class="fna">q1</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-14"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-14" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1216837#c14">Comment 14</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-10-30 10:06 PDT" data-time="1446224778">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-14">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-14" data-comment-id="10889931">By &quot;leaks&quot; in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Underflow in srtp_unprotect could cause memory-safety bug"
   href="/show_bug.cgi?id=1216837#c13">comment 13</a>, I mean leakage of information from one session into another, not memory leaks.</pre></div><div class="change-set" id="c15"><div class="comment" data-id="10890473" data-no="15"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-15" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_140243" id="a191194_1689"><img src="https://secure.gravatar.com/avatar/6f792da717b676641d0a7095b55f0fdf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_140243" id="a191194_1689"><a class="email " href="/user_profile?user_id=140243" > <span class="fna">q1</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-15"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-15" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1216837#c15">Comment 15</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-10-30 12:46 PDT" data-time="1446234384">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-15">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-15" data-comment-id="10890473">There are also similar bugs in srtp_unprotect_rtcp that I will file separately.</pre></div><div class="change-set" id="c16"><div class="comment" data-id="10903204" data-no="16"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-16" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_11539" id="a191194_1689"><img src="https://secure.gravatar.com/avatar/ae002109ba1cfbb7f5ad990cc5d9fbaf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_11539" id="a191194_1689"><a class="email " href="/user_profile?user_id=11539" > <span class="fna">Randell Jesup [:jesup] (needinfo me)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-16"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-16" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1216837#c16">Comment 16</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-11-04 09:31 PST" data-time="1446658302">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-16">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-16" data-comment-id="10903204">Fixed upstream in <a rel="nofollow" href="https://github.com/cisco/libsrtp/commit/2583150aa9729fccfdcd58e9811cc7ed161b1ccd">https://github.com/cisco/libsrtp/commit/2583150aa9729fccfdcd58e9811cc7ed161b1ccd</a>
after I chatted with them via email.
They don't have much of a flow (ok, none) for handling sec issues; luckily there have been few.  I'll queue up an import of the 1.5 branch once this patch lands there.</pre></div><div class="change-set" id="c17"><div class="comment" data-id="10903216" data-no="17"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-17" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_11539" id="a191194_1689"><img src="https://secure.gravatar.com/avatar/ae002109ba1cfbb7f5ad990cc5d9fbaf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_11539" id="a191194_1689"><a class="email " href="/user_profile?user_id=11539" > <span class="fna">Randell Jesup [:jesup] (needinfo me)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-17"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-17" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1216837#c17">Comment 17</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-11-04 09:33 PST" data-time="1446658395">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-17">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-8683192"
         class="attachment patch"
         data-id="8683192" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="libsrtp">
      <meta itemprop="contentSize" content="1926">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached patch
          <meta itemprop="contentUrl" content="attachment.cgi?id=8683192">
          <a class="link" href="attachment.cgi?id=8683192&amp;action=diff">
        <span id="att-8683192-description" itemprop="description">add explicit error checks for packet length in srtp</span></a>
        — <a href="attachment.cgi?id=8683192&amp;action=edit" itemprop="url">Details</a>
          — <a href="/page.cgi?id=splinter.html&ignore=&bug=1216837&attachment=8683192">Splinter Review</a>
      </div>
    </div>

  
    <pre
        class="comment-text  "
        id="ct-17" data-comment-id="10903216">Patrick - can you review ASAP (it's simple)?  I could rs= based on cherry-picking upstream, but that seems wrong (as I effectively gave the fix to them).  Thanks</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8683192&amp;action=edit"
           title="add explicit error checks for packet length in srtp"
           class=""
        >Attachment #8683192</a> -
        Flags: review?(mcmanus)</div></div></div><div class="change-set" id="a1268409_11539"><div class="change" id="aa1268409_11539">
    <table class="layout-table change-head assignee" role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_11539" id="a1268409_11539"><img src="https://secure.gravatar.com/avatar/ae002109ba1cfbb7f5ad990cc5d9fbaf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_11539" id="a1268409_11539"><a class="email " href="/user_profile?user_id=11539" > <span class="fna">Randell Jesup [:jesup] (needinfo me)</span></a>
</div>
            <span class="user-role">Assignee</span>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1268409_11539"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1268409_11539">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1216837#a1268409_11539">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-11-04 09:33 PST" data-time="1446658397">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8681001&amp;action=edit"
           title="add explicit error checks for packet length in srtp"
           class=""
        >Attachment #8681001</a> -
        Attachment is obsolete: true</div></div></div><div class="change-set" id="c18"><div class="comment" data-id="10903256" data-no="18"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-18" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_140243" id="a1268409_11539"><img src="https://secure.gravatar.com/avatar/6f792da717b676641d0a7095b55f0fdf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_140243" id="a1268409_11539"><a class="email " href="/user_profile?user_id=140243" > <span class="fna">q1</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-18"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-18" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1216837#c18">Comment 18</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-11-04 09:44 PST" data-time="1446659088">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-18">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-18" data-comment-id="10903256">Why isn't the check in srtp_protect identical to the one in srtc_unprotect?</pre></div><div class="change-set" id="c19"><div class="comment" data-id="10903258" data-no="19"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-19" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_140243" id="a1268409_11539"><img src="https://secure.gravatar.com/avatar/6f792da717b676641d0a7095b55f0fdf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_140243" id="a1268409_11539"><a class="email " href="/user_profile?user_id=140243" > <span class="fna">q1</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-19"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-19" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1216837#c19">Comment 19</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-11-04 09:45 PST" data-time="1446659106">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-19">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-19" data-comment-id="10903258">(In reply to q1 from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Underflow in srtp_unprotect could cause memory-safety bug"
   href="/show_bug.cgi?id=1216837#c18">comment #18</a>)
<span class="quote">&gt; Why isn't the check in srtp_protect identical to the one in srtc_unprotect?</span >

srtp_unprotect.</pre></div><div class="change-set" id="c20"><div class="comment" data-id="10903487" data-no="20"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-20" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_11539" id="a1268409_11539"><img src="https://secure.gravatar.com/avatar/ae002109ba1cfbb7f5ad990cc5d9fbaf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_11539" id="a1268409_11539"><a class="email " href="/user_profile?user_id=11539" > <span class="fna">Randell Jesup [:jesup] (needinfo me)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-20"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-20" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1216837#c20">Comment 20</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-11-04 10:34 PST" data-time="1446662048">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-20">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-20" data-comment-id="10903487">(In reply to q1 from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Underflow in srtp_unprotect could cause memory-safety bug"
   href="/show_bug.cgi?id=1216837#c18">comment #18</a>)
<span class="quote">&gt; Why isn't the check in srtp_protect identical to the one in srtc_unprotect?</span >

Because on srtp_protect, we're going to add the tag to the packet (after this point).  We've calculated what the tag_len will be, but it's not there yet, just the header and payload data.</pre></div><div class="change-set" id="c21"><div class="comment" data-id="10903504" data-no="21"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-21" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_11539" id="a1268409_11539"><img src="https://secure.gravatar.com/avatar/ae002109ba1cfbb7f5ad990cc5d9fbaf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_11539" id="a1268409_11539"><a class="email " href="/user_profile?user_id=11539" > <span class="fna">Randell Jesup [:jesup] (needinfo me)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-21"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-21" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1216837#c21">Comment 21</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-11-04 10:38 PST" data-time="1446662313">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-21">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-21" data-comment-id="10903504">We did (in upstream) move the check in srtp_protect() out of the &quot;if (hdr-&gt;x == 1)&quot; (it was already outside of it in srtp_protect_aead() IIRC).  In the code here, I simply added it to the right place.</pre></div><div class="change-set" id="c22"><div class="comment" data-id="10903629" data-no="22"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-22" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_140243" id="a1268409_11539"><img src="https://secure.gravatar.com/avatar/6f792da717b676641d0a7095b55f0fdf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_140243" id="a1268409_11539"><a class="email " href="/user_profile?user_id=140243" > <span class="fna">q1</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-22"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-22" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1216837#c22">Comment 22</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-11-04 11:05 PST" data-time="1446663939">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-22">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-22" data-comment-id="10903629">(In reply to Randell Jesup [:jesup] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Underflow in srtp_unprotect could cause memory-safety bug"
   href="/show_bug.cgi?id=1216837#c20">comment #20</a>)
<span class="quote">&gt; (In reply to q1 from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Underflow in srtp_unprotect could cause memory-safety bug"
   href="/show_bug.cgi?id=1216837#c18">comment #18</a>)
&gt; &gt; Why isn't the check in srtp_protect identical to the one in srtc_unprotect?
&gt; 
&gt; Because on srtp_protect, we're going to add the tag to the packet (after
&gt; this point).  We've calculated what the tag_len will be, but it's not there
&gt; yet, just the header and payload data.</span >

But how, then, do you know how much space is really available in the packet? I see that srtp_protect is called from SrtpFlow::ProtectRtp/ProtectRtcp, which doesn't pass it its |max_len| argument, so it appears that srpt_protect has no way to know how long its |rtp_hdr| buffer really is. Apparently the |max_len| limit is enforced only by ProtectR*'s |MOZ_ASSERT(len &lt;= max_len);| and by a related assert in MediaPipeline::PipelineTransport::SendRtpRtcpPacket_s . That's rather fragile.</pre></div><div class="change-set" id="c23"><div class="comment" data-id="10904822" data-no="23"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-23" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_32546" id="a1268409_11539"><img src="https://secure.gravatar.com/avatar/2b0de973c803f192309b00777c594202?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_32546" id="a1268409_11539"><a class="email " href="/user_profile?user_id=32546" > <span class="fna">Patrick McManus [:mcmanus]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-23"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-23" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1216837#c23">Comment 23</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-11-04 16:24 PST" data-time="1446683073">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-23">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-23" data-comment-id="10904822">Comment on <span class=""><a href="/attachment.cgi?id=8683192" name="attach_8683192" title="add explicit error checks for packet length in srtp">attachment 8683192</a> <a href="/attachment.cgi?id=8683192&amp;action=edit" title="add explicit error checks for packet length in srtp">[details]</a> <a href="/attachment.cgi?id=8683192&amp;action=diff" title="add explicit error checks for packet length in srtp">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1216837&amp;attachment=8683192'>[review]</a>
add explicit error checks for packet length in srtp

Review of <span class=""><a href="/attachment.cgi?id=8683192" name="attach_8683192" title="add explicit error checks for packet length in srtp">attachment 8683192</a> <a href="/attachment.cgi?id=8683192&amp;action=edit" title="add explicit error checks for packet length in srtp">[details]</a> <a href="/attachment.cgi?id=8683192&amp;action=diff" title="add explicit error checks for packet length in srtp">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1216837&amp;attachment=8683192'>[review]</a>:
-----------------------------------------------------------------

as far as I understand this code the check makes sense to me, but this isn't code I'm familiar with so I don't know that it has a a lot of value.. and q1 poses an interesting question.

so I'll f+ it and delegate the review based on reaching consensus with the reporter.

Thanks for this!</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8683192&amp;action=edit"
           title="add explicit error checks for packet length in srtp"
           class=""
        >Attachment #8683192</a> -
        Flags: review?(q1)</div><div class="change">
        <a href="/attachment.cgi?id=8683192&amp;action=edit"
           title="add explicit error checks for packet length in srtp"
           class=""
        >Attachment #8683192</a> -
        Flags: <span class="activity-deleted">review?(mcmanus)</span></div><div class="change">
        <a href="/attachment.cgi?id=8683192&amp;action=edit"
           title="add explicit error checks for packet length in srtp"
           class=""
        >Attachment #8683192</a> -
        Flags: feedback+</div></div></div><div class="change-set" id="c24"><div class="comment" data-id="10905179" data-no="24"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-24" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_140243" id="a1268409_11539"><img src="https://secure.gravatar.com/avatar/6f792da717b676641d0a7095b55f0fdf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_140243" id="a1268409_11539"><a class="email " href="/user_profile?user_id=140243" > <span class="fna">q1</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-24"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-24" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1216837#c24">Comment 24</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-11-04 19:31 PST" data-time="1446694313">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-24">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-24" data-comment-id="10905179">Comment on <span class=""><a href="/attachment.cgi?id=8683192" name="attach_8683192" title="add explicit error checks for packet length in srtp">attachment 8683192</a> <a href="/attachment.cgi?id=8683192&amp;action=edit" title="add explicit error checks for packet length in srtp">[details]</a> <a href="/attachment.cgi?id=8683192&amp;action=diff" title="add explicit error checks for packet length in srtp">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1216837&amp;attachment=8683192'>[review]</a>
add explicit error checks for packet length in srtp

Review of <span class=""><a href="/attachment.cgi?id=8683192" name="attach_8683192" title="add explicit error checks for packet length in srtp">attachment 8683192</a> <a href="/attachment.cgi?id=8683192&amp;action=edit" title="add explicit error checks for packet length in srtp">[details]</a> <a href="/attachment.cgi?id=8683192&amp;action=diff" title="add explicit error checks for packet length in srtp">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1216837&amp;attachment=8683192'>[review]</a>:
-----------------------------------------------------------------

(In reply to Patrick McManus [:mcmanus] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Underflow in srtp_unprotect could cause memory-safety bug"
   href="/show_bug.cgi?id=1216837#c23">comment #23</a>)
<span class="quote">&gt; Comment on <span class=""><a href="/attachment.cgi?id=8683192" name="attach_8683192" title="add explicit error checks for packet length in srtp">attachment 8683192</a> <a href="/attachment.cgi?id=8683192&amp;action=edit" title="add explicit error checks for packet length in srtp">[details]</a> <a href="/attachment.cgi?id=8683192&amp;action=diff" title="add explicit error checks for packet length in srtp">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1216837&amp;attachment=8683192'>[review]</a>
&gt; add explicit error checks for packet length in srtp
&gt; 
&gt; Review of <span class=""><a href="/attachment.cgi?id=8683192" name="attach_8683192" title="add explicit error checks for packet length in srtp">attachment 8683192</a> <a href="/attachment.cgi?id=8683192&amp;action=edit" title="add explicit error checks for packet length in srtp">[details]</a> <a href="/attachment.cgi?id=8683192&amp;action=diff" title="add explicit error checks for packet length in srtp">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1216837&amp;attachment=8683192'>[review]</a>:
&gt; -----------------------------------------------------------------
&gt; 
&gt; as far as I understand this code the check makes sense to me, but this isn't
&gt; code I'm familiar with so I don't know that it has a a lot of value.. and q1
&gt; poses an interesting question.
&gt; 
&gt; so I'll f+ it and delegate the review based on reaching consensus with the
&gt; reporter.
&gt; 
&gt; Thanks for this!</span >

And thank you. I think the patch is OK as far as it goes. However, relying on asserts to enforce correctness always makes me uneasy, because you then have to test all the applicable code paths in the debug build. So I would tend to want ProtectRtp to pass its |max_len| argument to srtp_protect, which should then ensure that it doesn't add enough to the packet to exceed that many octets. On the other hand, every time you modify a line of code you can add a bug (or three). Since I'm really a newbie with this code, I'm going to bounce the ultimate decision back to Randell.</pre></div><div class="change-set" id="c25"><div class="comment" data-id="10910739" data-no="25"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-25" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_495955" id="a1268409_11539"><img src="https://secure.gravatar.com/avatar/5aa2e382197a147b42d020b6878f8623?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_495955" id="a1268409_11539"><a class="email " href="/user_profile?user_id=495955" > <span class="fna">Sylvestre Ledru [:Sylvestre]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-25"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-25" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1216837#c25">Comment 25</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-11-06 07:43 PST" data-time="1446824590">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-25">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-25" data-comment-id="10910739">Too late for 42, we have time for 43.</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox42&amp;o1=isnotempty">status-firefox42</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox42&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox42&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox42&amp;o1=isnotempty">tracking-firefox42</a>:
          <a href="/buglist.cgi?f1=cf_tracking_firefox42&amp;o1=equals&amp;v1=%3F">?</a> &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox42&amp;o1=equals&amp;v1=-">-</a></div></div></div><div class="change-set" id="c26"><div class="comment" data-id="10910796" data-no="26"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-26" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_140243" id="a1268409_11539"><img src="https://secure.gravatar.com/avatar/6f792da717b676641d0a7095b55f0fdf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_140243" id="a1268409_11539"><a class="email " href="/user_profile?user_id=140243" > <span class="fna">q1</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-26"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-26" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1216837#c26">Comment 26</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-11-06 08:01 PST" data-time="1446825690">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-26">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-26" data-comment-id="10910796">Comment on <span class=""><a href="/attachment.cgi?id=8683192" name="attach_8683192" title="add explicit error checks for packet length in srtp">attachment 8683192</a> <a href="/attachment.cgi?id=8683192&amp;action=edit" title="add explicit error checks for packet length in srtp">[details]</a> <a href="/attachment.cgi?id=8683192&amp;action=diff" title="add explicit error checks for packet length in srtp">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1216837&amp;attachment=8683192'>[review]</a>
add explicit error checks for packet length in srtp

Review of <span class=""><a href="/attachment.cgi?id=8683192" name="attach_8683192" title="add explicit error checks for packet length in srtp">attachment 8683192</a> <a href="/attachment.cgi?id=8683192&amp;action=edit" title="add explicit error checks for packet length in srtp">[details]</a> <a href="/attachment.cgi?id=8683192&amp;action=diff" title="add explicit error checks for packet length in srtp">[diff]</a></span> <a href='/page.cgi?id=splinter.html&amp;ignore=&amp;bug=1216837&amp;attachment=8683192'>[review]</a>:
-----------------------------------------------------------------

Fobbing the review back to Mr. McManus. Maybe you can suggest someone who's more qualified in this code?</pre><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8683192&amp;action=edit"
           title="add explicit error checks for packet length in srtp"
           class=""
        >Attachment #8683192</a> -
        Flags: review?(q1) &rarr; review?(mcmanus)</div></div></div><div class="change-set" id="a1440668_1689"><div class="change" id="aa1440668_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a1440668_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a1440668_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1440668_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1440668_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1216837#a1440668_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-11-06 09:24 PST" data-time="1446830656">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: media-core-security</div></div></div><div class="change-set" id="c27"><div class="comment" data-id="10912165" data-no="27"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-27" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_11539" id="a1440668_1689"><img src="https://secure.gravatar.com/avatar/ae002109ba1cfbb7f5ad990cc5d9fbaf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_11539" id="a1440668_1689"><a class="email " href="/user_profile?user_id=11539" > <span class="fna">Randell Jesup [:jesup] (needinfo me)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-27"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-27" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1216837#c27">Comment 27</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-11-06 14:48 PST" data-time="1446850096">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-27">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-27" data-comment-id="10912165">I'll note that the equivalent patch has landed upstream (though not in the 1.5 branch yet).  They decided to just patch it immediately without checking with me; there's no real sec policy in the upstream project.  While the concern level for us is low, upstream is concerned with servers using this code being DOSed (which wouldn't be hard).</pre></div><div class="change-set" id="c28"><div class="comment" data-id="10912266" data-no="28"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-28" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_140243" id="a1440668_1689"><img src="https://secure.gravatar.com/avatar/6f792da717b676641d0a7095b55f0fdf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_140243" id="a1440668_1689"><a class="email " href="/user_profile?user_id=140243" > <span class="fna">q1</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-28"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-28" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1216837#c28">Comment 28</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-11-06 15:29 PST" data-time="1446852545">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-28">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-28" data-comment-id="10912266">(In reply to Randell Jesup [:jesup] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Underflow in srtp_unprotect could cause memory-safety bug"
   href="/show_bug.cgi?id=1216837#c27">comment #27</a>)
<span class="quote">&gt; I'll note that the equivalent patch has landed upstream (though not in the
&gt; 1.5 branch yet).  They decided to just patch it immediately without checking
&gt; with me; [***]there's no real sec policy in the upstream project.[***]</span >

In this day and age?

<span class="quote">&gt; While the
&gt; concern level for us is low, upstream is concerned with servers using this
&gt; code being DOSed (which wouldn't be hard).</span >

Then Mozilla should patch it soon; I might not have found the best way to exploit it. As I said above, I think the patch is OK, but I am a total newbie in the code, so I'd be more comfortable with a qualified Mozillian looking it over.</pre></div><div class="change-set" id="a1471477_32546"><div class="change" id="aa1471477_32546">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_32546" id="a1471477_32546"><img src="https://secure.gravatar.com/avatar/2b0de973c803f192309b00777c594202?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_32546" id="a1471477_32546"><a class="email " href="/user_profile?user_id=32546" > <span class="fna">Patrick McManus [:mcmanus]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1471477_32546"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1471477_32546">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1216837#a1471477_32546">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-11-06 17:57 PST" data-time="1446861465">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=8683192&amp;action=edit"
           title="add explicit error checks for packet length in srtp"
           class=""
        >Attachment #8683192</a> -
        Flags: review?(mcmanus) &rarr; review+</div></div></div><div class="change-set" id="c29"><div class="comment" data-id="10991311" data-no="29"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-29" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_11539" id="a1471477_32546"><img src="https://secure.gravatar.com/avatar/ae002109ba1cfbb7f5ad990cc5d9fbaf?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_11539" id="a1471477_32546"><a class="email " href="/user_profile?user_id=11539" > <span class="fna">Randell Jesup [:jesup] (needinfo me)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-29"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-29" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1216837#c29">Comment 29</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-12-05 08:13 PST" data-time="1449332020">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-29">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-29" data-comment-id="10991311"><a rel="nofollow" href="https://hg.mozilla.org/integration/mozilla-inbound/rev/35d0e5235621">https://hg.mozilla.org/integration/mozilla-inbound/rev/35d0e5235621</a>

Note upstream landed an equivalent patch (and a follow-up fix to their patch that doesn't affect us until we update to 1.5.x)</pre></div><div class="change-set" id="c30"><div class="comment" data-id="10993047" data-no="30"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-30" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_277293" id="a1471477_32546"><img src="https://secure.gravatar.com/avatar/8378311bf1bd5e9eddc7896a07688876?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_277293" id="a1471477_32546"><a class="email disabled" href="/user_profile?user_id=277293" > <span class="fna">Carsten Book [:Tomcat]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-30"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-30" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1216837#c30">Comment 30</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-12-07 05:27 PST" data-time="1449494858">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-30">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-30" data-comment-id="10993047"><a rel="nofollow" href="https://hg.mozilla.org/mozilla-central/rev/35d0e5235621">https://hg.mozilla.org/mozilla-central/rev/35d0e5235621</a></pre><div class="activity"><div class="change">Status: ASSIGNED &rarr; RESOLVED</div><div class="change">Closed: <span class="rel-time" title="2015-12-07 05:27 PST" data-time="1449494858">6 years ago</span></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox45&amp;o1=isnotempty">status-firefox45</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox45&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox45&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">Resolution: --- &rarr; FIXED</div><div class="change">Target Milestone: --- &rarr; mozilla45</div></div></div><div class="change-set" id="a4728043_280903"><div class="change" id="aa4728043_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a4728043_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a4728043_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a4728043_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a4728043_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1216837#a4728043_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-12-14 10:33 PST" data-time="1450118031">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: sec-bounty? &rarr; sec-bounty+</div></div></div><div class="change-set" id="a4892670_1689"><div class="change" id="aa4892670_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a4892670_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a4892670_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a4892670_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a4892670_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1216837#a4892670_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2015-12-16 08:17 PST" data-time="1450282658">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: media-core-security, network-core-security &rarr; core-security-release</div></div></div><div class="change-set" id="c31"><div class="comment" data-id="11100661" data-no="31"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-31" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_451704" id="a4892670_1689"><img src="https://secure.gravatar.com/avatar/6168ea97fda0cefa449331e59b24e8f7?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_451704" id="a4892670_1689"><a class="email " href="/user_profile?user_id=451704" > <span class="fna">Liz Henry (:lizzard Please n-i to RyanVM, jcristau, or pascal)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-31"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-31" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1216837#c31">Comment 31</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-01-22 14:08 PST" data-time="1453500519">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-31">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-31" data-comment-id="11100661">Since this didn't make it into 44 but is fixed in 45, let's uplift this when we build 38.7.0esr.</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr38&amp;o1=isnotempty">tracking-firefox-esr38</a>:
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr38&amp;o1=equals&amp;v1=%3F">?</a> &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox_esr38&amp;o1=equals&amp;v1=45%2B">45+</a></div></div></div><div class="change-set" id="c32"><div class="comment" data-id="11204743" data-no="32"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-32" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a4892670_1689"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_280903" id="a4892670_1689"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-32"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-32" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1216837#c32">Comment 32</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-29 12:19 PST" data-time="1456777147">6 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-32">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><pre
        class="comment-text  "
        id="ct-32" data-comment-id="11204743">Missed ESR 38.7 and is a sec-moderate.</pre><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr38&amp;o1=isnotempty">status-firefox-esr38</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox_esr38&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr38&amp;o1=equals&amp;v1=wontfix">wontfix</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr38&amp;o1=isnotempty">tracking-firefox-esr38</a>:
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr38&amp;o1=equals&amp;v1=45%2B">45+</a> &rarr; ---</div><div class="change">Whiteboard: [adv-main45+]</div></div></div><div class="change-set" id="a11392451_452604"><div class="change" id="aa11392451_452604">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_452604" id="a11392451_452604"><img src="https://secure.gravatar.com/avatar/7bb698c4991c5af83adabe3c3b8ee8aa?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_452604" id="a11392451_452604"><a class="email disabled" href="/user_profile?user_id=452604" > <span class="fna">Matt Wobensmith [:mwobensmith][:matt:]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a11392451_452604"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a11392451_452604">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1216837#a11392451_452604">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-02-29 13:47 PST" data-time="1456782439">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: [adv-main45+] &rarr; [adv-main45+][post-critsmash-triage]</div></div></div><div class="change-set" id="a11499690_280903"><div class="change" id="aa11499690_280903">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_280903" id="a11499690_280903"><img src="https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_280903" id="a11499690_280903"><a class="email " href="/user_profile?user_id=280903" > <span class="fna">Al Billings [:abillings - ex-MoCo]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a11499690_280903"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a11499690_280903">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1216837#a11499690_280903">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-03-01 19:34 PST" data-time="1456889678">6 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Alias: CVE-2016-1970</div></div></div><div class="change-set" id="a22094559_1689"><div class="change" id="aa22094559_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a22094559_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a22094559_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a22094559_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a22094559_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1216837#a22094559_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2016-07-02 11:35 PDT" data-time="1467484547">5 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: <span class="activity-deleted">core-security-release</span></div></div></div><div id="new-comment-notice">
          You need to <a href="/show_bug.cgi?id=1216837&amp;GoAheadAndLogIn=1">log in</a>
          before you can comment on or make changes to this bug.
        </div>



<div id="bottom-actions">
  <div id="bottom-right-actions">
    <button type="button" id="top-btn" class="secondary" aria-label="Go to Page Top">Top &uarr;</button>
  </div>
</div></div> 
</main> 
</div> 


</body>
</html>