<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
  <head>
<base href="https://code.launchpad.net/%7Ecyphermox/software-properties/lp1036839/+merge/119753/+index" />

    <meta charset="UTF-8" />
    <title>Merge into main : lp1036839 : Code : Software Properties</title>
    <link rel="shortcut icon" href="/@@/launchpad.png" />
    
    
    

    
  
  <link type="text/css" rel="stylesheet" media="screen, print" href="/+icing/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/combo.css" />


    

    
      
      
    

    
    
      <meta property="og:title" content="Merge into main : lp1036839 : Code : Software Properties" />
      <meta property="og:type" content="website" />
      <meta property="og:image" content="/@@/launchpad.png" />
      <meta property="og:url" content="https://code.launchpad.net/%7Ecyphermox/software-properties/lp1036839/+merge/119753/+index" />
      <meta property="og:site_name" content="Launchpad" />
    

    

    
  

  
  
  <script type="text/javascript">
    var LP = {
        cache: {},
        links: {}
    };
  </script>

  

  <script type="text/javascript">var cookie_scope = '; Path=/; Secure; Domain=.launchpad.net';</script>

   <script type="text/javascript" src="/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?yui/yui/yui-min.js&amp;lp/meta.js&amp;yui/loader/loader-min.js"></script>
   <script type="text/javascript">
        var raw = null;
        if (LP.devmode) {
           raw = 'raw';
        }
        YUI.GlobalConfig = {
            combine: true,
            comboBase: '/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?',
            root: 'yui/',
            filter: raw,
            debug: false,
            fetchCSS: false,
            maxURLLength: 2000,
            groups: {
                lp: {
                    combine: true,
                    base: '/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?lp/',
                    comboBase: '/+combo/rev0d8de2bfee2024772b3040d4d19f42f47395ac0d/?',
                    root: 'lp/',
                    // comes from including lp/meta.js
                    modules: LP_MODULES,
                    fetchCSS: false
                }
            }
        }</script>

  <script type="text/javascript">
      // we need this to create a single YUI instance all events and code
      // talks across. All instances of YUI().use should be based off of
      // LPJS instead.
      var LPJS = new YUI();
  </script>



    <script id="base-layout-load-scripts" type="text/javascript">
        //<![CDATA[
        LPJS.use('base', 'node', 'console', 'event',
            'oop', 'lp', 'lp.app.foldables','lp.app.sorttable',
            'lp.app.inlinehelp', 'lp.app.links',
            'lp.bugs.bugtask_index', 'lp.bugs.subscribers',
            'lp.app.ellipsis', 'lp.code.branchmergeproposal.diff',
            'lp.views.global',
             function(Y) {

            Y.on("domready", function () {
                var global_view = new Y.lp.views.Global();
                global_view.render();

                Y.lp.app.sorttable.SortTable.init();
                Y.lp.app.inlinehelp.init_help();
                Y.lp.activate_collapsibles();
                Y.lp.app.foldables.activate();
                Y.lp.app.links.check_valid_lp_links();
            });

            Y.on('lp:context:web_link:changed', function(e) {
                  window.location = e.new_value;
            });
        });
        //]]>
    </script>
    <script id="base-helper-functions" type="text/javascript">
         //<![CDATA[
        // This code is pulled from lp.js that needs to be available on every
        // request. Pulling here to get it outside the scope of the YUI block.
        function setFocusByName(name) {
            // Focus the first element matching the given name which can be focused.
            var nodes = document.getElementsByName(name);
            var i, node;
            for (i = 0; i < nodes.length; i++) {
                node = nodes[i];
                if (node.focus) {
                    try {
                        // Trying to focus a hidden element throws an error in IE8.
                        if (node.offsetHeight !== 0) {
                            node.focus();
                        }
                    } catch (e) {
                        LPJS.use('console', function(Y) {
                            Y.log('In setFocusByName(<' +
                                node.tagName + ' type=' + node.type + '>): ' + e);
                        });
                    }
                    break;
                }
            }
        }

        function selectWidget(widget_name, event) {
          if (event && (event.keyCode === 9 || event.keyCode === 13)) {
              // Avoid firing if user is tabbing through or simply pressing
              // enter to submit the form.
              return;
          }
          document.getElementById(widget_name).checked = true;
        }
        //]]>
    </script>

    
      
  <style type="text/css">
    .menu-link-set_commit_message {
    margin-top: 1em;
    }
    #code-review-votes {
      margin: 1em 0;
    }
    #add-comment-form {
      max-width: 60em;
      padding-bottom: 3em;
    }
    #add-comment-form textarea{
      width: 100%;
      max-width: inherit;
    }
    #add-comment-form .actions {
      float: right;
      margin: 0 -0.5em;
    }
    #add-comment-review-fields {
      margin-top: 1em;
    }
    #add-comment-review-fields div {
      display: inline;
    }
    .yui3-publishdrafts:before {
      content: " ";
    }
    #proposal-summary th {
      font-weight: bold;
      color: #717171;
    }
    #proposal-summary td {
      padding-left: 0.5em;
    }
    .related-bugs-list {
      padding-left: 20px;
      padding-bottom: 10px;
    }
  </style>

    
  </head>

  <body id="document" itemscope="" itemtype="http://schema.org/WebPage" class="tab-branches
      main_side
      public
      yui3-skin-sam">
          
          
    <div class="yui-d0">
      <div id="locationbar" class="login-logout">
        

<div id="logincontrol"><a href="https://code.launchpad.net/~cyphermox/software-properties/lp1036839/+merge/119753/+login">Log in / Register</a></div>



      </div><!--id="locationbar"-->

      <div id="watermark" class="watermark-apps-portlet">
        <div>
          <a href="https://launchpad.net/software-properties"><img alt="" width="64" height="64" src="/@@/product-logo" /></a>
        </div>
        <div class="wide">
          <h2 id="watermark-heading"><a href="https://launchpad.net/software-properties">Software Properties</a></h2>
        </div>
        
  <!-- Application Menu -->
  <ul class="facetmenu">
    
      
      <li class="overview"><a href="https://launchpad.net/software-properties">Overview</a></li>
      
    
    
      <li class="branches active"><a href="https://code.launchpad.net/software-properties">Code</a></li>
      
      
    
    
      
      <li class="bugs"><a href="https://bugs.launchpad.net/software-properties">Bugs</a></li>
      
    
    
      
      <li class="specifications"><a href="https://blueprints.launchpad.net/software-properties">Blueprints</a></li>
      
    
    
      
      <li class="translations"><a href="https://translations.launchpad.net/software-properties">Translations</a></li>
      
    
    
      
      <li class="answers"><a href="https://answers.launchpad.net/software-properties">Answers</a></li>
      
    
  </ul>

      </div>

      <div class="yui-t4">
        <div id="maincontent" class="yui-main">
          <div class="yui-b" dir="ltr">
            <div class="context-publication">
              <h1>Merge lp:~cyphermox/software-properties/lp1036839 into lp:software-properties</h1>
              <ol itemprop="breadcrumb" class="breadcrumbs">


  <li>
    <a href="https://code.launchpad.net/~cyphermox/software-properties/lp1036839">lp1036839</a>
  </li>


  <li>
    Merge into main
  </li>

</ol>

              <div id="registration" class="registering">
                
  Proposed by
  <a href="https://launchpad.net/~cyphermox" class="sprite person">Mathieu Trudel-Lapierre</a>
  <time title="2012-08-15 17:49:06 UTC" datetime="2012-08-15T17:49:06.876528+00:00">on 2012-08-15</time>

              </div>
            </div>

            
            <div id="request-notifications">
              
            </div>

            
              <div>

  <div class="yui-g first">
    <table id="proposal-summary">

  <tbody>
    
    <tr id="summary-row-1-status">
      <th>Status:</th>
      <td id="branchmergeproposal-status-value">

        
          
          <span class="value mergestatusMERGED">Merged</span>
            
        
      </td>
    </tr>
    
    
      
    
    
      <tr id="summary-row-6-merge-reporter">
        <th>Merge reported by:</th>
        <td><a href="https://launchpad.net/~mdeslaur" class="sprite person">Marc Deslauriers</a></td>
      </tr>
      <tr id="summary-row-7-merged-revision">
        <th>Merged at revision:</th>
        <td>
          
            not available
          
          
          
        </td>
      </tr>
    
    <tr id="summary-row-8-source-branch">
      <th>Proposed branch:</th>
      <td><a href="/~cyphermox/software-properties/lp1036839" class="sprite branch">lp:~cyphermox/software-properties/lp1036839</a></td>
    </tr>
    <tr id="summary-row-9-target-branch">
      <th>Merge into:</th>
      <td><a href="/~ubuntu-core-dev/software-properties/main" class="sprite branch">lp:software-properties</a></td>
    </tr>
    
    <tr id="summary-row-b-diff">
      <th>Diff against target:</th>
      <td>
        
  <a href="https://code.launchpad.net/~cyphermox/software-properties/lp1036839/+merge/119753/+preview-diff/276347/+files/preview.diff" class="diff-link">141 lines (+57/-16)</a><div class="collapsible"><span>3 files modified</span><div>add-apt-repository (+4/-3)<br/>debian/changelog (+8/-1)<br/>softwareproperties/ppa.py (+45/-12)</div></div>
  


      </td>
    </tr>
    

    <tr id="summary-row-merge-instruction">
      <th>To merge this branch:</th>
      <td>bzr merge <span class="branch-url">lp:~cyphermox/software-properties/lp1036839</span></td>
    </tr>
    <tr id="related-bugs">
      <th style="vertical-align: top;">Related bugs:</th>
      <td>
        <div id="buglinks">
          <div id="buglink-list">
            

  

  <table>
    
      <tr class="buglink-summary" id="buglink-1036839">
        <td class="first"><a href="https://bugs.launchpad.net/ubuntu/+source/software-properties/+bug/1036839" class="sprite bug-high" title="High - Fix Released">Bug #1036839: Quantal software-properties incorrectly validating ssl certs</a></td>
        <td>
          <span class="importanceHIGH">High</span>
        </td>
        <td>
          <span class="statusFIXRELEASED">Fix Released</span>
        </td>
        <td>
          <a title="Remove link" class="delete-buglink" href="+unlinkbug?field.bugs=1036839" id="delete-buglink-1036839">
            <img src="/@@/remove" alt="Remove" />
          </a>
        </td>
      </tr>
    
  </table>


          </div>
          <div>
            <a id="linkbug" class="sprite add" href="https://code.launchpad.net/~cyphermox/software-properties/lp1036839/+merge/119753/+linkbug">Link a bug report</a>
          </div>
        </div>
        <script type="text/javascript">
          LPJS.use('io-base', 'lp.code.branch.bugspeclinks', function(Y) {
            Y.on('domready', function() {
              var logged_in = LP.links['me'] !== undefined;

              if (logged_in) {
                var config = {
                  picker_activator: '#linkbug'
                };
                var linked_bug_picker = new
                  Y.lp.code.branch.bugspeclinks.LinkedBugPicker(config);
                linked_bug_picker.render();
                linked_bug_picker.hide();
              }
            });
          });
        </script>
      </td>
    </tr>
    
  </tbody>
</table>

  </div>

  <div class="yui-g">
    <div id="votes-target"><div id="code-review-votes">

<table class="listing compressed">
  <thead>
    <tr>
      <th>Reviewer</th>
      <th>Review Type</th>
      <th>Date Requested</th>
      <th>Status</th>
    </tr>
  </thead>
  <tbody>
    <!-- Current reviews -->
    <tr id="review-mdeslaur">
      <td>
        <a href="https://launchpad.net/~mdeslaur" class="sprite person">Marc Deslauriers</a>
        </td>
      <td></td>
      <td>
        
          <span title="Requested by Mathieu Trudel-Lapierre">
            <time title="2012-08-15 17:49:06 UTC" datetime="2012-08-15T17:49:06.876528+00:00">2012-08-15</time>
          </span>
        
      </td>
      <td>
        <span class="voteAPPROVE">Approve</span>
        <time title="2012-08-16 18:53:03 UTC" datetime="2012-08-16T18:53:03.971390+00:00">on 2012-08-16</time>
        
      </td>
    </tr>
    <!-- Pending reviews -->
    <tr id="email-review">
      <td colspan="4" style="padding-top: 1em; patting-bottom: 0.5em">
        Review <a href="https://help.launchpad.net/Code/Review" class="help">via email</a>:
        <img src="/@@/mail" style="padding-left:0.5em" />
        <a href="mailto:mp+119753@code.launchpad.net">mp+119753@code.launchpad.net</a>
      </td>
    </tr>

    
  </tbody>
</table>

</div>
</div>
  </div>

  
  

  <div id="commit-message" class="yui-g">
    
    <div>
  <div class="lazr-multiline-edit hidden" id="edit-commit_message">
  <div class="clearfix">
    

    <h3>Commit message</h3>
  </div>

  <div class="yui3-editable_text-text"></div>
  </div>

  
</div>

  </div>

  <div id="description" class="yui-g">
    
    <div>
  <div class="lazr-multiline-edit hidden" id="edit-description">
  <div class="clearfix">
    

    <h3>Description of the change</h3>
  </div>

  <div class="yui3-editable_text-text"></div>
  </div>

  
</div>

  </div>

  <div class="yui-g">
    
      <div align="center" id="add-comment-login-first">
        To post a comment you must <a href="+login">log in</a>.
      </div>
    

    

    <div id="conversation">

  

   <div itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message None">
    <div class="boardCommentDetails">

  <a href="/~cyphermox/software-properties/lp1036839" class="sprite branch">lp:~cyphermox/software-properties/lp1036839</a>
  updated
  <time title="2012-08-16 18:50:09 UTC" datetime="2012-08-16T18:50:09.940291+00:00">on 2012-08-16</time>


</div>
    
    <div class="boardCommentActivity">

  
    
      

  
  <style type="text/css">
    .subordinate {
      margin-left: 1em;
    }
  </style>
  <dl class="revision">
    <!-- Display the extended revision listing -->
    <!-- Display the standard revision listing -->
    
      

  
  <dt class="revision-details">
    
    <a href="https://bazaar.launchpad.net/~cyphermox/software-properties/lp1036839/revision/788">788</a>.
    By
    
      
        <a href="https://launchpad.net/~cyphermox" class="sprite person">Mathieu Trudel-Lapierre</a>
      
      
    

    <time title="2012-08-16 18:49:11 UTC" datetime="2012-08-16T18:49:11.086000+00:00">on 2012-08-16</time>
  </dt>
  <dd class="subordinate revision-comment">
    <p>ppa: Update comment for LAUNCHPAD_PPA_CERT; we don&#x27;t want people to ever set it<br />
to None; which would mean &quot;don&#x27;t check certs&quot;.</p>
  </dd>

  

    
    
  </dl>


    
  
  
  


</div>
    
  </div>




  

   <div itemscope="" itemtype="http://schema.org/UserComments" class="boardComment editable-message " data-baseurl="/~cyphermox/software-properties/lp1036839/+merge/119753/comments/257872">
    <div class="boardCommentDetails">

<div class="message-revision-container">
  <div class="message-revision-container-header">
    <span>Revision history for this message</span>
    <img src="/+icing/build/overlay/assets/skins/sam/images/close.gif" class="message-revision-close" />
  </div>
  <script type="text/template">
    <div class='message-revision-item'>
      <div class='message-revision-title'>
          <a class="sprite remove action-icon message-revision-del-btn">
              Remove
          </a>
          <a class="js-action">
              Revision #{revision}, created at {date_created_display}
          </a>
      </div>
      <div class='message-revision-body'>{content}</div>
    </div>
  </script>
  <div class="message-revision-list"></div>
</div>

<table>
  <tbody>
    <tr>
    <td data-from-superseded="False">
      <span itemprop="creator"><a href="https://launchpad.net/~mdeslaur" class="sprite person">Marc Deslauriers (mdeslaur)</a></span>
        wrote
        <time itemprop="commentTime" datetime="2012-08-16T18:53:03.971390+00:00" title="2012-08-16 18:53:03 UTC">on 2012-08-16</time><span class="editable-message-last-edit-date">:
          </span>
        
      </td>

      <td>
        
      </td>
      <td>
        
      </td>
      <td class="bug-comment-index">
        <a itemprop="url" href="/~cyphermox/software-properties/lp1036839/+merge/119753/comments/257872">#</a>
      </td>

    </tr>
  </tbody>
</table>

</div>
    <div class="boardCommentBody" itemprop="commentText">

  <div>

  
  <div class="editable-message-body">
    <div class="comment-text editable-message-text" itemprop="commentText"><p>Looks good, thanks! ACK</p></div>
    
    
    
  </div>

  <div class="editable-message-form" style="display: none">
     <textarea style="width: 100%" rows="10">Looks good, thanks! ACK</textarea>
     <input type="button" value="Update" class="editable-message-update-btn" />
     <input type="button" value="Cancel" class="editable-message-cancel-btn" />
  </div>

</div>


</div>
    <div class="boardCommentActivity">

  <strong>review:</strong>
  <span class="voteAPPROVE">Approve</span>
  


</div>
    
  </div>




</div>
    
  </div>

  

  <div class="yui-g">
    
  </div>

  <div id="diff-area">
    
    
    
    <div id="review-diff">
      <h2>Preview Diff </h2>

      <div class="diff-navigator">
      </div>

      <div class="diff-content">
        

  <div class="boardComment attachment diff">
    
      <div class="boardCommentDetails filename">
        <div class="editorShortcutTip">[H/L] Next/Prev Comment, [J/K] Next/Prev File, [N/P] Next/Prev Hunk</div>
        <ul class="horizontal">
          <li>
            <a href="https://code.launchpad.net/~cyphermox/software-properties/lp1036839/+merge/119753/+preview-diff/276347/+files/preview.diff">
              <img src="/@@/download" />
              Download diff
            </a>
          </li>
          <li>
            <a href="?ss=1">Side-by-side diff</a>
          </li>
          
        </ul>
      </div>
      <div class="attachmentBody">
        <table class="diff unidiff"><tr id="diff-line-1"><td class="line-no unselectable">1</td><td class="diff-file text">=== modified file &#x27;add-apt-repository&#x27;</td></tr><tr id="diff-line-2"><td class="line-no unselectable">2</td><td class="diff-header text">--- add-apt-repository	2012-07-10 08:55:00 +0000</td></tr><tr id="diff-line-3"><td class="line-no unselectable">3</td><td class="diff-header text">+++ add-apt-repository	2012-08-16 18:51:31 +0000</td></tr><tr id="diff-line-4"><td class="line-no unselectable">4</td><td class="diff-chunk text">@@ -17,7 +17,8 @@</td></tr><tr id="diff-line-5"><td class="line-no unselectable">5</td><td class="text"> try:</td></tr><tr id="diff-line-6"><td class="line-no unselectable">6</td><td class="text">     from urllib.error import HTTPError, URLError</td></tr><tr id="diff-line-7"><td class="line-no unselectable">7</td><td class="text"> except ImportError:</td></tr><tr id="diff-line-8"><td class="line-no unselectable">8</td><td class="diff-removed text">-    from urllib2 import HTTPError, URLError</td></tr><tr id="diff-line-9"><td class="line-no unselectable">9</td><td class="diff-added text">+    import pycurl</td></tr><tr id="diff-line-10"><td class="line-no unselectable">10</td><td class="diff-added text">+    HTTPError = pycurl.error</td></tr><tr id="diff-line-11"><td class="line-no unselectable">11</td><td class="text"> </td></tr><tr id="diff-line-12"><td class="line-no unselectable">12</td><td class="text"> def _maybe_suggest_ppa_name_based_on_user(user):</td></tr><tr id="diff-line-13"><td class="line-no unselectable">13</td><td class="text">     try:</td></tr><tr id="diff-line-14"><td class="line-no unselectable">14</td><td class="diff-chunk text">@@ -109,7 +110,7 @@</td></tr><tr id="diff-line-15"><td class="line-no unselectable">15</td><td class="text"> </td></tr><tr id="diff-line-16"><td class="line-no unselectable">16</td><td class="text">     # display PPA info (if needed)</td></tr><tr id="diff-line-17"><td class="line-no unselectable">17</td><td class="text">     if line.startswith(&quot;ppa:&quot;) and not options.assume_yes:</td></tr><tr id="diff-line-18"><td class="line-no unselectable">18</td><td class="diff-removed text">-        from softwareproperties.ppa import get_ppa_info_from_lp, LAUNCHPAD_PPA_API</td></tr><tr id="diff-line-19"><td class="line-no unselectable">19</td><td class="diff-added text">+        from softwareproperties.ppa import PPAException, get_ppa_info_from_lp, LAUNCHPAD_PPA_API</td></tr><tr id="diff-line-20"><td class="line-no unselectable">20</td><td class="text">         user, sep, ppa_name = line.split(&quot;:&quot;)[1].partition(&quot;/&quot;)</td></tr><tr id="diff-line-21"><td class="line-no unselectable">21</td><td class="text">         ppa_name = ppa_name or &quot;ppa&quot;</td></tr><tr id="diff-line-22"><td class="line-no unselectable">22</td><td class="text">         try:</td></tr><tr id="diff-line-23"><td class="line-no unselectable">23</td><td class="diff-chunk text">@@ -123,7 +124,7 @@</td></tr><tr id="diff-line-24"><td class="line-no unselectable">24</td><td class="text">             # exists. If it exists, list down the PPAs</td></tr><tr id="diff-line-25"><td class="line-no unselectable">25</td><td class="text">             _maybe_suggest_ppa_name_based_on_user(user)</td></tr><tr id="diff-line-26"><td class="line-no unselectable">26</td><td class="text">             sys.exit(1)</td></tr><tr id="diff-line-27"><td class="line-no unselectable">27</td><td class="diff-removed text">-        except (ValueError, URLError):</td></tr><tr id="diff-line-28"><td class="line-no unselectable">28</td><td class="diff-added text">+        except (ValueError, PPAException):</td></tr><tr id="diff-line-29"><td class="line-no unselectable">29</td><td class="text">             print(_(&quot;Cannot access PPA (%s) to get PPA information, &quot;</td></tr><tr id="diff-line-30"><td class="line-no unselectable">30</td><td class="text">                     &quot;please check your internet connection.&quot;) % \</td></tr><tr id="diff-line-31"><td class="line-no unselectable">31</td><td class="text">                 (LAUNCHPAD_PPA_API % (user, ppa_name)))</td></tr><tr id="diff-line-32"><td class="line-no unselectable">32</td><td class="text"></td></tr><tr id="diff-line-33"><td class="line-no unselectable">33</td><td class="diff-file text">=== modified file &#x27;debian/changelog&#x27;</td></tr><tr id="diff-line-34"><td class="line-no unselectable">34</td><td class="diff-header text">--- debian/changelog	2012-08-15 07:11:41 +0000</td></tr><tr id="diff-line-35"><td class="line-no unselectable">35</td><td class="diff-header text">+++ debian/changelog	2012-08-16 18:51:31 +0000</td></tr><tr id="diff-line-36"><td class="line-no unselectable">36</td><td class="diff-chunk text">@@ -5,7 +5,14 @@</td></tr><tr id="diff-line-37"><td class="line-no unselectable">37</td><td class="text">     - Fixed the source code checkbox and the submit statistics </td></tr><tr id="diff-line-38"><td class="line-no unselectable">38</td><td class="text">       checkbox labels to be left-aligned instead of centered.</td></tr><tr id="diff-line-39"><td class="line-no unselectable">39</td><td class="text"> </td></tr><tr id="diff-line-40"><td class="line-no unselectable">40</td><td class="diff-removed text">- -- Michael Vogt &lt;michael.vogt@ubuntu.com&gt;  Wed, 15 Aug 2012 09:10:56 +0200</td></tr><tr id="diff-line-41"><td class="line-no unselectable">41</td><td class="diff-added text">+  [ Mathieu Trudel-Lapierre ]</td></tr><tr id="diff-line-42"><td class="line-no unselectable">42</td><td class="diff-added text">+  * Reinstate pycurl to use for getting PPA information from Launchpad, since</td></tr><tr id="diff-line-43"><td class="line-no unselectable">43</td><td class="diff-added text">+    it can actually verify SSL certificates with python2. Also set</td></tr><tr id="diff-line-44"><td class="line-no unselectable">44</td><td class="diff-added text">+    LAUNCHPAD_PPA_CERT so that it&#x27;s a valid path to the system CA certificates</td></tr><tr id="diff-line-45"><td class="line-no unselectable">45</td><td class="diff-added text">+    bundle to use for urllib and pycurl. (LP: #1036839)</td></tr><tr id="diff-line-46"><td class="line-no unselectable">46</td><td class="diff-added text">+    - CVE-2012-0955</td></tr><tr id="diff-line-47"><td class="line-no unselectable">47</td><td class="diff-added text">+</td></tr><tr id="diff-line-48"><td class="line-no unselectable">48</td><td class="diff-added text">+ -- Mathieu Trudel-Lapierre &lt;mathieu-tl@ubuntu.com&gt;  Wed, 15 Aug 2012 13:18:05 -0400</td></tr><tr id="diff-line-49"><td class="line-no unselectable">49</td><td class="text"> </td></tr><tr id="diff-line-50"><td class="line-no unselectable">50</td><td class="text"> software-properties (0.91) quantal; urgency=low</td></tr><tr id="diff-line-51"><td class="line-no unselectable">51</td><td class="text"> </td></tr><tr id="diff-line-52"><td class="line-no unselectable">52</td><td class="text"></td></tr><tr id="diff-line-53"><td class="line-no unselectable">53</td><td class="diff-file text">=== modified file &#x27;softwareproperties/ppa.py&#x27;</td></tr><tr id="diff-line-54"><td class="line-no unselectable">54</td><td class="diff-header text">--- softwareproperties/ppa.py	2012-07-05 13:32:44 +0000</td></tr><tr id="diff-line-55"><td class="line-no unselectable">55</td><td class="diff-header text">+++ softwareproperties/ppa.py	2012-08-16 18:51:31 +0000</td></tr><tr id="diff-line-56"><td class="line-no unselectable">56</td><td class="diff-chunk text">@@ -28,18 +28,31 @@</td></tr><tr id="diff-line-57"><td class="line-no unselectable">57</td><td class="text"> from threading import Thread</td></tr><tr id="diff-line-58"><td class="line-no unselectable">58</td><td class="text"> </td></tr><tr id="diff-line-59"><td class="line-no unselectable">59</td><td class="text"> try:</td></tr><tr id="diff-line-60"><td class="line-no unselectable">60</td><td class="diff-removed text">-  import urllib.request as urllib2</td></tr><tr id="diff-line-61"><td class="line-no unselectable">61</td><td class="diff-added text">+  import urllib.request</td></tr><tr id="diff-line-62"><td class="line-no unselectable">62</td><td class="text">   from urllib.error import URLError</td></tr><tr id="diff-line-63"><td class="line-no unselectable">63</td><td class="text">   import urllib.parse</td></tr><tr id="diff-line-64"><td class="line-no unselectable">64</td><td class="text"> except ImportError:</td></tr><tr id="diff-line-65"><td class="line-no unselectable">65</td><td class="diff-removed text">-  import urllib2</td></tr><tr id="diff-line-66"><td class="line-no unselectable">66</td><td class="diff-added text">+  import pycurl</td></tr><tr id="diff-line-67"><td class="line-no unselectable">67</td><td class="text"> </td></tr><tr id="diff-line-68"><td class="line-no unselectable">68</td><td class="text"> DEFAULT_KEYSERVER = &quot;hkp://keyserver.ubuntu.com:80/&quot;</td></tr><tr id="diff-line-69"><td class="line-no unselectable">69</td><td class="text"> # maintained until 2015</td></tr><tr id="diff-line-70"><td class="line-no unselectable">70</td><td class="text"> LAUNCHPAD_PPA_API = &#x27;https://launchpad.net/api/1.0/~%s/+archive/%s&#x27;</td></tr><tr id="diff-line-71"><td class="line-no unselectable">71</td><td class="diff-removed text">-# None means use the system default SSL store.</td></tr><tr id="diff-line-72"><td class="line-no unselectable">72</td><td class="diff-removed text">-# Otherwise a path to a file is expected (as a bundle of certs)</td></tr><tr id="diff-line-73"><td class="line-no unselectable">73</td><td class="diff-removed text">-LAUNCHPAD_PPA_CERT = None</td></tr><tr id="diff-line-74"><td class="line-no unselectable">74</td><td class="diff-added text">+# Specify to use the system default SSL store; change to a different path</td></tr><tr id="diff-line-75"><td class="line-no unselectable">75</td><td class="diff-added text">+# to test with custom certificates.</td></tr><tr id="diff-line-76"><td class="line-no unselectable">76</td><td class="diff-added text">+LAUNCHPAD_PPA_CERT = &quot;/etc/ssl/certs/ca-certificates.crt&quot;</td></tr><tr id="diff-line-77"><td class="line-no unselectable">77</td><td class="diff-added text">+</td></tr><tr id="diff-line-78"><td class="line-no unselectable">78</td><td class="diff-added text">+class CurlCallback:</td></tr><tr id="diff-line-79"><td class="line-no unselectable">79</td><td class="diff-added text">+    def __init__(self):</td></tr><tr id="diff-line-80"><td class="line-no unselectable">80</td><td class="diff-added text">+        self.contents = &#x27;&#x27;</td></tr><tr id="diff-line-81"><td class="line-no unselectable">81</td><td class="diff-added text">+</td></tr><tr id="diff-line-82"><td class="line-no unselectable">82</td><td class="diff-added text">+    def body_callback(self, buf):</td></tr><tr id="diff-line-83"><td class="line-no unselectable">83</td><td class="diff-added text">+        self.contents = self.contents + buf</td></tr><tr id="diff-line-84"><td class="line-no unselectable">84</td><td class="diff-added text">+</td></tr><tr id="diff-line-85"><td class="line-no unselectable">85</td><td class="diff-added text">+class PPAException(Exception):</td></tr><tr id="diff-line-86"><td class="line-no unselectable">86</td><td class="diff-added text">+    def __init__(self, value):</td></tr><tr id="diff-line-87"><td class="line-no unselectable">87</td><td class="diff-added text">+        self.value = value</td></tr><tr id="diff-line-88"><td class="line-no unselectable">88</td><td class="diff-added text">+    def __str__(self):</td></tr><tr id="diff-line-89"><td class="line-no unselectable">89</td><td class="diff-added text">+        return repr(self.value)</td></tr><tr id="diff-line-90"><td class="line-no unselectable">90</td><td class="text"> </td></tr><tr id="diff-line-91"><td class="line-no unselectable">91</td><td class="text"> def encode(s):</td></tr><tr id="diff-line-92"><td class="line-no unselectable">92</td><td class="text">     return re.sub(&quot;[^a-zA-Z0-9_-]&quot;,&quot;_&quot;, s)</td></tr><tr id="diff-line-93"><td class="line-no unselectable">93</td><td class="diff-chunk text">@@ -70,12 +83,32 @@</td></tr><tr id="diff-line-94"><td class="line-no unselectable">94</td><td class="text">     # we ask for a JSON structure from lp_page, we could use</td></tr><tr id="diff-line-95"><td class="line-no unselectable">95</td><td class="text">     # simplejson, but the format is simple enough for the regexp</td></tr><tr id="diff-line-96"><td class="line-no unselectable">96</td><td class="text">     # only useful for testing</td></tr><tr id="diff-line-97"><td class="line-no unselectable">97</td><td class="diff-removed text">-    request = urllib2.Request(str(lp_url), headers={&quot;Accept&quot;:&quot; application/json&quot;})</td></tr><tr id="diff-line-98"><td class="line-no unselectable">98</td><td class="text">     try:</td></tr><tr id="diff-line-99"><td class="line-no unselectable">99</td><td class="diff-removed text">-        lp_page = urllib2.urlopen(request, cafile=LAUNCHPAD_PPA_CERT)</td></tr><tr id="diff-line-100"><td class="line-no unselectable">100</td><td class="diff-removed text">-    except TypeError:</td></tr><tr id="diff-line-101"><td class="line-no unselectable">101</td><td class="diff-removed text">-        lp_page = urllib2.urlopen(request)</td></tr><tr id="diff-line-102"><td class="line-no unselectable">102</td><td class="diff-removed text">-    return json.loads(lp_page.read().decode(&quot;utf-8&quot;, &quot;strict&quot;))</td></tr><tr id="diff-line-103"><td class="line-no unselectable">103</td><td class="diff-added text">+        try:</td></tr><tr id="diff-line-104"><td class="line-no unselectable">104</td><td class="diff-added text">+            request = urllib.request.Request(str(lp_url), headers={&quot;Accept&quot;:&quot; application/json&quot;})</td></tr><tr id="diff-line-105"><td class="line-no unselectable">105</td><td class="diff-added text">+            lp_page = urllib.request.urlopen(request, cafile=LAUNCHPAD_PPA_CERT)</td></tr><tr id="diff-line-106"><td class="line-no unselectable">106</td><td class="diff-added text">+            json_data = lp_page.read().decode(&quot;utf-8&quot;, &quot;strict&quot;)</td></tr><tr id="diff-line-107"><td class="line-no unselectable">107</td><td class="diff-added text">+        except URLError as e:</td></tr><tr id="diff-line-108"><td class="line-no unselectable">108</td><td class="diff-added text">+            raise PPAException(&quot;Error reading %s: %s&quot; % (lp_url, e.reason))</td></tr><tr id="diff-line-109"><td class="line-no unselectable">109</td><td class="diff-added text">+    except PPAException:</td></tr><tr id="diff-line-110"><td class="line-no unselectable">110</td><td class="diff-added text">+        raise</td></tr><tr id="diff-line-111"><td class="line-no unselectable">111</td><td class="diff-added text">+    except:</td></tr><tr id="diff-line-112"><td class="line-no unselectable">112</td><td class="diff-added text">+        try:</td></tr><tr id="diff-line-113"><td class="line-no unselectable">113</td><td class="diff-added text">+            callback = CurlCallback()</td></tr><tr id="diff-line-114"><td class="line-no unselectable">114</td><td class="diff-added text">+            curl = pycurl.Curl()</td></tr><tr id="diff-line-115"><td class="line-no unselectable">115</td><td class="diff-added text">+            curl.setopt(pycurl.SSL_VERIFYPEER, 1)</td></tr><tr id="diff-line-116"><td class="line-no unselectable">116</td><td class="diff-added text">+            curl.setopt(pycurl.SSL_VERIFYHOST, 2)</td></tr><tr id="diff-line-117"><td class="line-no unselectable">117</td><td class="diff-added text">+            curl.setopt(pycurl.WRITEFUNCTION, callback.body_callback)</td></tr><tr id="diff-line-118"><td class="line-no unselectable">118</td><td class="diff-added text">+            if LAUNCHPAD_PPA_CERT:</td></tr><tr id="diff-line-119"><td class="line-no unselectable">119</td><td class="diff-added text">+                curl.setopt(pycurl.CAINFO, LAUNCHPAD_PPA_CERT)</td></tr><tr id="diff-line-120"><td class="line-no unselectable">120</td><td class="diff-added text">+            curl.setopt(pycurl.URL, str(lp_url))</td></tr><tr id="diff-line-121"><td class="line-no unselectable">121</td><td class="diff-added text">+            curl.setopt(pycurl.HTTPHEADER, [&quot;Accept: application/json&quot;])</td></tr><tr id="diff-line-122"><td class="line-no unselectable">122</td><td class="diff-added text">+            curl.perform()</td></tr><tr id="diff-line-123"><td class="line-no unselectable">123</td><td class="diff-added text">+            curl.close()</td></tr><tr id="diff-line-124"><td class="line-no unselectable">124</td><td class="diff-added text">+            json_data = callback.contents</td></tr><tr id="diff-line-125"><td class="line-no unselectable">125</td><td class="diff-added text">+        except pycurl.error as e:</td></tr><tr id="diff-line-126"><td class="line-no unselectable">126</td><td class="diff-added text">+            raise PPAException(&quot;Error reading %s: %s&quot; % (lp_url, e[1]))</td></tr><tr id="diff-line-127"><td class="line-no unselectable">127</td><td class="diff-added text">+    return json.loads(json_data)</td></tr><tr id="diff-line-128"><td class="line-no unselectable">128</td><td class="text"> </td></tr><tr id="diff-line-129"><td class="line-no unselectable">129</td><td class="text"> class AddPPASigningKeyThread(Thread):</td></tr><tr id="diff-line-130"><td class="line-no unselectable">130</td><td class="text">     &quot; thread class for adding the signing key in the background &quot;</td></tr><tr id="diff-line-131"><td class="line-no unselectable">131</td><td class="diff-chunk text">@@ -98,8 +131,8 @@</td></tr><tr id="diff-line-132"><td class="line-no unselectable">132</td><td class="text">         owner_name, ppa_name, distro = ppa_path[1:].split(&#x27;/&#x27;)</td></tr><tr id="diff-line-133"><td class="line-no unselectable">133</td><td class="text">         try:</td></tr><tr id="diff-line-134"><td class="line-no unselectable">134</td><td class="text">             ppa_info = get_ppa_info_from_lp(owner_name, ppa_name)</td></tr><tr id="diff-line-135"><td class="line-no unselectable">135</td><td class="diff-removed text">-        except URLError as e:</td></tr><tr id="diff-line-136"><td class="line-no unselectable">136</td><td class="diff-removed text">-            print(&quot;Error reading %s: %s&quot; % (lp_url, e.strerror))</td></tr><tr id="diff-line-137"><td class="line-no unselectable">137</td><td class="diff-added text">+        except PPAException as e:</td></tr><tr id="diff-line-138"><td class="line-no unselectable">138</td><td class="diff-added text">+            print(e.value)</td></tr><tr id="diff-line-139"><td class="line-no unselectable">139</td><td class="text">             return False</td></tr><tr id="diff-line-140"><td class="line-no unselectable">140</td><td class="text">         try:</td></tr><tr id="diff-line-141"><td class="line-no unselectable">141</td><td class="text">             signing_key_fingerprint = ppa_info[&quot;signing_key_fingerprint&quot;]</td></tr></table>
        
        
      </div>
      
    
    
  </div>



      </div>
    </div>
  </div>

<script id='codereview-script' type='text/javascript'>
  conf = {"status_widget_items": [{"value": "Work in progress", "disabled": false, "style": "", "css_class": "mergestatusWORK_IN_PROGRESS", "name": "Work in progress", "description": "", "description_css_class": "choice-description", "help": ""}, {"value": "Needs review", "disabled": false, "style": "", "css_class": "mergestatusNEEDS_REVIEW", "name": "Needs review", "description": "", "description_css_class": "choice-description", "help": ""}, {"value": "Merged", "disabled": false, "style": "", "css_class": "mergestatusMERGED", "name": "Merged", "description": "", "description_css_class": "choice-description", "help": ""}], "status_value": "Merged", "user_can_edit_status": false, "source_revid": "mathieu-tl@ubuntu.com-20120816184911-eml3hkb57hxyy2ei"}
  LPJS.use('io-base', 'lp.code.branchmergeproposal.reviewcomment',
          'lp.code.branchmergeproposal.status', 'lp.app.comment',
          'lp.app.widgets.expander',
          'lp.code.branch.revisionexpander',
          'lp.code.branchmergeproposal.inlinecomments',
          'lp.services.messages.edit', function(Y) {

    Y.on('load', function() {
        var logged_in = LP.links['me'] !== undefined;
        var comment = null;
        if (logged_in) {
            comment = new Y.lp.app.comment.CodeReviewComment();
            comment.render();
        }

        var review_diff_node = Y.one('#review-diff');
        if (review_diff_node !== null) {
            var ic = Y.lp.code.branchmergeproposal.inlinecomments;
            var diffnav = new ic.DiffNav({srcNode: review_diff_node});
            if (comment !== null) {
                comment.on('CodeReviewComment.appended', function () {
                    diffnav.update_on_new_comment();
                });
                Y.lp.code.branchmergeproposal.status.connect_status(conf);
            }
            Y.lp.code.branchmergeproposal.reviewcomment.connect_links();
            diffnav.render();
        }

        LP.cache.comment_context = LP.cache.context;
        var cl = new Y.lp.app.comment.CommentList({
            comment_list_container: Y.one('#conversation')
        });
        if (comment !== null) {
            comment.on('CodeReviewComment.appended', cl.bind_new_comment);
        }
        cl.render();
    }, window);

    Y.on('domready', function() {
        Y.lp.app.widgets.expander.createByCSS(
            '.revision-group-diff',
            '.expander-icon',
            '.expander-content',
            false,
            Y.lp.code.branch.revisionexpander.bmp_diff_loader);
        Y.lp.services.messages.edit.setup();
    });
  });
</script>

</div>
            
            
          </div><!-- yui-b -->
        </div><!-- yui-main -->

        
          <div id="side-portlets" class="yui-b side">
            

  
  <div class="portlet" id="portlet-subscribers">

  <h2 class="unnecessary">Subscribers</h2>

    <p>
      
        People
      
      
      subscribed via source and target branches
    </p>

    <div id="full-subscribers">
      <img src="/@@/mail" /> to all changes:
      <ul>
        <li><a href="https://launchpad.net/~grz" class="sprite person"> lapi</a></li>
      </ul>
      <ul>
        <li><a href="https://launchpad.net/~eddy89" class="sprite person-inactive">Eduardo</a></li>
      </ul>
      <ul>
        <li><a href="https://launchpad.net/~hmollercl" class="sprite person">Hans P. Möller</a></li>
      </ul>
      <ul>
        <li><a href="https://launchpad.net/~plentha" class="sprite person">Hans Plenter</a></li>
      </ul>
      <ul>
        <li><a href="https://launchpad.net/~cyphermox" class="sprite person">Mathieu Trudel-Lapierre</a></li>
      </ul>
      <ul>
        <li><a href="https://launchpad.net/~mvo" class="sprite person">Michael Vogt</a></li>
      </ul>
      <ul>
        <li><a href="https://launchpad.net/~airene-natividad08" class="sprite person">airene</a></li>
      </ul>
      <ul>
        <li><a href="https://launchpad.net/~e6yu83" class="sprite person">eytue768</a></li>
      </ul>
      <ul>
        <li><a href="https://launchpad.net/~jamie-thompson1973" class="sprite person">jammers</a></li>
      </ul>
      <ul>
        <li><a href="https://launchpad.net/~jcarlosgvaz" class="sprite person">josé carlos galvão vaz</a></li>
      </ul>
    </div>

    <div id="status-subscribers">
      <img src="/@@/mail" /> to status/vote changes:
      <ul>
        <li><a href="https://launchpad.net/~luckydog76501" class="sprite person">Rick McMeen</a></li>
      </ul>
      <ul>
        <li><a href="https://launchpad.net/~michaelvannuffel1993" class="sprite person">michael vannuffel</a></li>
      </ul>
      <ul>
        <li><a href="https://launchpad.net/~alan-ar06" class="sprite person-inactive">todaioan</a></li>
      </ul>
    </div>
</div>




          </div><!-- yui-b side -->
        
      </div><!-- yui-t4 -->

      
  <div id="footer" class="footer">
    <div class="lp-arcana">
        <div class="lp-branding">
          <a href="https://launchpad.net/"><img src="/@@/launchpad-logo-and-name-hierarchy.png" alt="Launchpad" /></a>
          &nbsp;&bull;&nbsp;
          <a href="https://launchpad.net/+tour">Take the tour</a>
          &nbsp;&bull;&nbsp;
          <a href="https://help.launchpad.net/">Read the guide</a>
          &nbsp;
          <form id="globalsearch" method="get" accept-charset="UTF-8" action="https://launchpad.net/+search">
            <input type="search" id="search-text" name="field.text" />
            <input type="image" src="/@@/search" style="vertical-align:5%" alt="Search Launchpad" />
          </form>
        </div>
        
  

    </div>

    <div class="colophon">
      &copy; 2004-2021
      <a href="http://canonical.com/">Canonical&nbsp;Ltd.</a>
      &nbsp;&bull;&nbsp;
      <a href="https://launchpad.net/legal">Terms of use</a>
      &nbsp;&bull;&nbsp;
      <a href="https://www.ubuntu.com/legal/dataprivacy">Data privacy</a>
      &nbsp;&bull;&nbsp;
      <a href="/feedback">Contact Launchpad Support</a>
      
      &nbsp;&bull;&nbsp;
      <a href="http://blog.launchpad.net/">Blog</a>
      
	&nbsp;&bull;&nbsp;
	<a href="https://canonical.com/careers">Careers</a>
      
      &nbsp;&bull;&nbsp;
      <a href="https://twitter.com/launchpadstatus">System status</a>
      <span id="lp-version">
      &nbsp;&bull;&nbsp;
        r0d8de2b
        
        
        (<a href="https://dev.launchpad.net/">Get the code!</a>)
      </span>
    </div>
  </div>

    </div><!-- yui-d0-->

    
  
  
  <script id="json-cache-script">LP.cache = {"branch_diff_link": "https://code.launchpad.net/~cyphermox/software-properties/lp1036839/+diff/", "branch_name": "lp1036839", "related_features": {}, "context": {"self_link": "https://code.launchpad.net/api/devel/~cyphermox/software-properties/lp1036839/+merge/119753", "web_link": "https://code.launchpad.net/~cyphermox/software-properties/lp1036839/+merge/119753", "resource_type_link": "https://code.launchpad.net/api/devel/#branch_merge_proposal", "bugs_collection_link": "https://code.launchpad.net/api/devel/~cyphermox/software-properties/lp1036839/+merge/119753/bugs", "private": false, "source_branch_link": "https://code.launchpad.net/api/devel/~cyphermox/software-properties/lp1036839", "source_git_repository_link": null, "source_git_path": null, "target_branch_link": "https://code.launchpad.net/api/devel/~ubuntu-core-dev/software-properties/main", "target_git_repository_link": null, "target_git_path": null, "prerequisite_branch_link": null, "prerequisite_git_repository_link": null, "prerequisite_git_path": null, "registrant_link": "https://code.launchpad.net/api/devel/~cyphermox", "description": null, "queue_status": "Merged", "reviewer_link": null, "preview_diffs_collection_link": "https://code.launchpad.net/api/devel/~cyphermox/software-properties/lp1036839/+merge/119753/preview_diffs", "preview_diff_link": "https://code.launchpad.net/api/devel/~cyphermox/software-properties/lp1036839/+merge/119753/+preview-diff/276347", "reviewed_revid": null, "commit_message": null, "merged_revno": null, "merged_revision_id": null, "date_merged": "2012-08-16T18:55:38.123170+00:00", "merge_reporter_link": "https://code.launchpad.net/api/devel/~mdeslaur", "supersedes_link": null, "superseded_by_link": null, "date_created": "2012-08-15T17:49:06.876528+00:00", "date_review_requested": "2012-08-15T17:49:06.876528+00:00", "date_reviewed": null, "all_comments_collection_link": "https://code.launchpad.net/api/devel/~cyphermox/software-properties/lp1036839/+merge/119753/all_comments", "address": "\u003cemail address hidden\u003e", "votes_collection_link": "https://code.launchpad.net/api/devel/~cyphermox/software-properties/lp1036839/+merge/119753/votes", "http_etag": "\"65e501ea4e5a60e5b1f448c8adc3936bb136ef0f-e8af1596d95d0a79cdae06741baf2084b690a15e\""}};</script>

    
  

    
  </body>


  <!--
    Facet name: branches
    Page type: main_side
    Has global search: True
    Has application tabs: True
    Has side portlets: True

    At least 88 queries/external actions issued in 1.70 seconds

    Features: {'hard_timeout': '15000', 'visible_render_time': None, 'app.mainsite_only.canonical_url': None, 'app.maintenance_message': None, 'js.yui_version': None, 'profiling.enabled': None, 'code.incremental_diffs.enabled': None, 'code.bzr.diff.disable_proxy': None, 'code.ajax_revision_diffs.enabled': None, 'baselayout.careers_link.disabled': None}

    r0d8de2b

    -->

</html>

