<!doctype html>
<html lang="en-US" style="margin:0px !important">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
  
  
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-110011290-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-110011290-1');
</script>
  
<!-- Global site tag (gtag.js) - Google Ads: 749377018 --> 
<script async src="https://www.googletagmanager.com/gtag/js?id=AW-749377018"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'AW-749377018'); </script>  
	
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="https://gmpg.org/xfn/11">

	
<!-- Bootstrap Latest compiled and minified CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
  
  	<title>There’s a Hole in the Boot - Eclypsium </title>
<link rel="alternate" hreflang="en" href="/2020/07/29/theres-a-hole-in-the-boot/">
<meta name="description" content="The BootHole vulnerability in the GRUB2 bootloader opens up Windows and Linux devices using Secure Boot to attack. The majority of laptops, desktops, servers and workstations are affected, as well as network appliances and other special purpose equipment">
<meta name="robots" content="index, follow">
<meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
<meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
<link rel="canonical" href="/2020/07/29/theres-a-hole-in-the-boot/">
<meta name="author" content="Eclypsium">
<meta property="og:url" content="/2020/07/29/theres-a-hole-in-the-boot/">
<meta property="og:site_name" content="Eclypsium">
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="There’s a Hole in the Boot - Eclypsium ">
<meta property="og:description" content="The BootHole vulnerability in the GRUB2 bootloader opens up Windows and Linux devices using Secure Boot to attack. The majority of laptops, desktops, servers and workstations are affected, as well as network appliances and other special purpose equipment">
<meta property="og:image" content="/wp-content/uploads/2020/07/feature_image_boothole.jpg">
<meta property="og:image:secure_url" content="/wp-content/uploads/2020/07/feature_image_boothole.jpg">
<meta property="og:image:width" content="1520">
<meta property="og:image:height" content="1000">
<meta property="og:image:alt" content="Grub in a hole in a boot">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="There’s a Hole in the Boot - Eclypsium ">
<meta name="twitter:description" content="The BootHole vulnerability in the GRUB2 bootloader opens up Windows and Linux devices using Secure Boot to attack. The majority of laptops, desktops, servers and workstations are affected, as well as network appliances and other special purpose equipment">
<meta name="twitter:image:src" content="/wp-content/uploads/2020/07/feature_image_boothole-1024x674.jpg">
<link rel="dns-prefetch" href="//s.w.org">
<link rel="alternate" type="application/rss+xml" title="Eclypsium &raquo; Feed" href="/feed/">
<link rel="alternate" type="application/rss+xml" title="Eclypsium &raquo; Comments Feed" href="/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="Eclypsium &raquo; There’s a Hole in the Boot Comments Feed" href="/2020/07/29/theres-a-hole-in-the-boot/feed/">
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/svg\/","svgExt":".svg","source":{"concatemoji":"\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.8.1"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([10084,65039,8205,55357,56613],[10084,65039,8203,55357,56613])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel="stylesheet" id="wp-block-library-css" href="/wp-includes/css/dist/block-library/style.min.css?ver=5.8.1" type="text/css" media="all">
<link rel="stylesheet" id="wpml-legacy-horizontal-list-0-css" href="/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.min.css?ver=1" type="text/css" media="all">
<link rel="stylesheet" id="eclypsium-style-css" href="/wp-content/themes/eclypsium-10-28-21a/style.css?ver=5.8.1" type="text/css" media="all">
<script type="text/javascript" id="wpml-browser-redirect-js-extra">
/* <![CDATA[ */
var wpml_browser_redirect_params = {"pageLanguage":"en","languageUrls":{"en_us":"\/2020\/07\/29\/theres-a-hole-in-the-boot\/","en":"\/2020\/07\/29\/theres-a-hole-in-the-boot\/","us":"\/2020\/07\/29\/theres-a-hole-in-the-boot\/"},"cookie":{"name":"_icl_visitor_lang_js","domain":"wp.eclypsium.io","path":"\/","expiration":24}};
/* ]]> */
</script>
<script type="text/javascript" src="/wp-content/plugins/sitepress-multilingual-cms/dist/js/browser-redirect/app.js?ver=4.4.12" id="wpml-browser-redirect-js"></script>
<link rel="https://api.w.org/" href="/wp-json/"><link rel="alternate" type="application/json" href="/wp-json/wp/v2/posts/6559"><link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wp-includes/wlwmanifest.xml"> 
<meta name="generator" content="WordPress 5.8.1">
<link rel="shortlink" href="/?p=6559">
<link rel="alternate" type="application/json+oembed" href="/wp-json/oembed/1.0/embed?url=%2F2020%2F07%2F29%2Ftheres-a-hole-in-the-boot%2F">
<link rel="alternate" type="text/xml+oembed" href="/wp-json/oembed/1.0/embed?url=%2F2020%2F07%2F29%2Ftheres-a-hole-in-the-boot%2F&#038;format=xml">
<meta name="generator" content="WPML ver:4.4.12 stt:1,28;">
<link rel="pingback" href="/xmlrpc.php"><style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style><link rel="preload" as="style" href="/wp-content/plugins/code-prettify/prettify/prettify.css"><link rel="icon" href="/wp-content/uploads/2018/12/e-150x150.png" sizes="32x32">
<link rel="icon" href="/wp-content/uploads/2018/12/e-300x300.png" sizes="192x192">
<link rel="apple-touch-icon" href="/wp-content/uploads/2018/12/e-300x300.png">
<meta name="msapplication-TileImage" content="/wp-content/uploads/2018/12/e-300x300.png">
  
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
	
<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css">
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>	
	
	

	
	
<script src="/wp-content/themes/eclypsium-10-28-21a/js/eclypsium-main.js"></script>

	
<!-- Google Roboto Font -->
<link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Roboto+Condensed:wght@300;400;700;900&amp;display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Roboto+Slab:100,300,400,700,900&amp;display=swap" rel="stylesheet">
	
	

</head>

<body class="post-template-default single single-post postid-6559 single-format-standard">
<div id="page" class="site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	<header id="masthead" class="site-header">
		<div class="site-branding">

		
		
		</div><!-- .site-branding -->

		<nav id="site-navigation" class="main-navigation">
		</nav><!-- #site-navigation -->
	</header><!-- #masthead -->

	<div id="content" class="site-content">


<div id="single-post">
<div class="nav-padding"></div>

	


<div id="main-nav" class="container-fluid no-pm d-none d-md-block">
	<div class="container">
		<div class="row no-pm justify-content-center">
			<div id="menu-top" class="col-lg-10 no-pm">
				
				<div id="nav-logo-container">
					<a href="/"><img id="nav-logo" src="/wp-content/themes/eclypsium-10-28-21a/img/logo-eclypsium-ps.svg"></a>
				</div>
				<div id="nav-links-container">
					<div id="nav-links-top">
						<a class="nav-link-small" href="/blog/">BLOG</a>
						<a class="nav-link-small" href="/contact/">CONTACT US</a>						
					</div>
					<div id="nav-links-bottom-container">
						<div class="nav-link-bottom">
							<a class="nav-link-big" href="/enterprise-firmware-security/">PRODUCT</a>
							<div class="nav-sub-pages">
								<a class="nav-link-sub" href="/enterprise-firmware-security/endpoints/">ENDPOINTS</a>
                <a class="nav-link-sub" href="/enterprise-firmware-security/servers/">SERVERS<br></a>
								<a class="nav-link-sub" href="/enterprise-firmware-security/network/">NETWORK <br>DEVICES</a>
								<a class="nav-link-sub" href="/enterprise-firmware-security/platform/">PLATFORM &amp; <br>INTEGRATIONS</a>								
							</div>
						</div>
						<div class="nav-link-bottom">
							<a class="nav-link-big" href="/solutions/">SOLUTIONS</a>
							<div class="nav-sub-pages">
                
                
								<a class="nav-link-sub" href="/solutions/identify/">IDENTIFY</a>
								<a class="nav-link-sub" href="/solutions/verify/">VERIFY</a>
								<a class="nav-link-sub" href="/solutions/fortify/">FORTIFY</a>
								<a class="nav-link-sub" href="/solutions/zero-trust/">ZERO TRUST</a>  
								<a class="nav-link-sub" href="/solutions/supply-chain-risk-management/">SUPPLY CHAIN</a>
                
								<a class="nav-link-sub" href="/risk-assessment/">DEVICE HEALTH</a>								
								<a class="nav-link-sub" href="/remote-work/">REMOTE WORK</a>
								<a class="nav-link-sub" href="/travel/">HIGH-RISK <br>TRAVEL</a>

							</div>
						</div>
						<div class="nav-link-bottom">
							<a class="nav-link-big" href="/resources/">RESOURCES</a>
							<div class="nav-sub-pages">
								<a class="nav-link-sub" href="/know-your-own-device/">KNOW YOUR <br>OWN DEVICE</a>	                
								<a class="nav-link-sub" href="/firmware-threat-report/">THREAT REPORT</a> 
								<a class="nav-link-sub" href="/resources/#solutionbriefs">SOLUTION BRIEFS</a>								
								<a class="nav-link-sub" href="/resources/#productbriefs">PRODUCT BRIEFS</a>								
								<a class="nav-link-sub" href="/resources/#whitepapers">WHITE PAPERS</a>	
								<a class="nav-link-sub" href="/resources/#videos">VIDEOS</a>
								<a class="nav-link-sub" href="/resources/#bestpractices">BEST PRACTICES</a>
							</div>
							
						</div>
						<div class="nav-link-bottom">
							<a class="nav-link-big" href="/company/">COMPANY</a>
							<div class="nav-sub-pages">
								<a class="nav-link-sub" href="/events/">EVENTS</a>
								<a class="nav-link-sub" href="/news/">NEWS ROOM</a>
								<a class="nav-link-sub" href="/news#pressreleases">PRESS RELEASES</a>
								<a class="nav-link-sub" href="/careers/">CAREERS</a>
								<a class="nav-link-sub" href="/company#contact">CONTACT US</a>
								
							</div>
						</div>
					</div>
				</div>
        
        <div class="nav-request-btn-container">
						<a class="nav-request-btn" href="/demo/">REQUEST A DEMO</a>						
        </div>
				<!--
				<div class="nav-search-container">
					<img id="search-icon" src="/wp-content/themes/eclypsium-10-28-21a/img/icon-search.svg">
					<input id="search-input" class=""  placeholder="Search ..." />
				</div>
				-->
				
			</div>
		</div>
	</div>	
</div>


<div id="mobile-nav" class="container-fluid no-pm">
	<div class="container">
		<div class="row no-pm">
			<div class="col-3 no-pm">

				<div id="mobile-nav-logo-container">
					<a href="/"><img id="nav-logo-mobile" src="/wp-content/themes/eclypsium-10-28-21a/img/logo-eclypsium-ps.svg"></a>
				</div>
			
			
			</div>
      
      <div class="col-6 no-pm wrapper-center">
					<a class="nav-request-btn" href="/demo/">REQUEST A DEMO</a>						
	    </div>	
        
      <div class="col-3 no-pm ">

				<div class="mobile-nav-dot-container ">
					<div class="mobile-dots" tabIndex="1"></div>				
				</div>
			</div>

		</div>
		
		<div class="mobile-nav-bottom">
			<div class="row no-pm">
				<div class="col-12">
					<a class="nav-link-small" href="/blog/">BLOG</a>
					<a class="nav-link-small" href="/contact/">CONTACT US</a>                    
        </div>
			</div>	


			<div class="row no-pm divider-20 nav-link-big-container">
				<div class="col-6 col-md-3">
					<a class="nav-link-big-mobile" href="/enterprise-firmware-security/">PRODUCT</a>
					<div class="nav-sub-pages">
          
						<a class="nav-link-sub" href="/enterprise-firmware-security/endpoints/">ENDPOINTS</a>
						<a class="nav-link-sub" href="/enterprise-firmware-security/servers/">SERVERS</a>
						<a class="nav-link-sub" href="/enterprise-firmware-security/network/">NETWORK <br>DEVICES</a>
						<a class="nav-link-sub" href="/enterprise-firmware-security/platform/">PLATFORM &amp; <br>INTEGRATIONS</a>
          
          </div>
					<br><br>
					<a class="nav-link-big-mobile" href="/solutions/">SOLUTIONS</a>
					<div class="nav-sub-pages">
            
								<a class="nav-link-sub" href="/solutions/identify/">IDENTIFY</a>
								<a class="nav-link-sub" href="/solutions/verify/">VERIFY</a>
								<a class="nav-link-sub" href="/solutions/fortify/">FORTIFY</a>
								<a class="nav-link-sub" href="/solutions/zero-trust/">ZERO TRUST</a>  
								<a class="nav-link-sub" href="/solutions/supply-chain-risk-management/">SUPPLY CHAIN</a>
                
								<a class="nav-link-sub" href="/risk-assessment/">DEVICE HEALTH</a>								
								<a class="nav-link-sub" href="/remote-work/">REMOTE WORK</a>
								<a class="nav-link-sub" href="/travel/">HIGH-RISK <br>TRAVEL</a>
            
					</div>
					<br>


				</div>
				<div class="col-6 col-md-3 inline">
					<a class="nav-link-big-mobile" href="/company/">COMPANY</a>
					
					<div class="nav-sub-pages">
						<a class="nav-link-sub" href="/events/">EVENTS</a>						
						<a class="nav-link-sub" href="/news/">NEWS ROOM</a>
						<a class="nav-link-sub" href="/news#pressreleases">PRESS RELEASES</a>
						<a class="nav-link-sub" href="/careers/">CAREERS</a>
						<a class="nav-link-sub" href="/company/#contact">CONTACT US</a>
					</div>
					<br>
					<a class="nav-link-big-mobile" href="/resources/">RESOURCES</a>
					<div class="nav-sub-pages">
								<a class="nav-link-sub" href="/know-your-own-device/">KNOW YOUR <br>OWN DEVICE</a>
            
						<a class="nav-link-sub" onClick="$('.mobile-dots').trigger('click')" href="/firmware-threat-report/">THREAT REPORT</a>            							
						<a class="nav-link-sub" onClick="$('.mobile-dots').trigger('click')" href="/resources/#solutionbriefs">SOLUTION BRIEFS</a>
						<a class="nav-link-sub" onClick="$('.mobile-dots').trigger('click')" href="/resources/#productbriefs">PRODUCT BRIEFS</a>
						<a class="nav-link-sub" onClick="$('.mobile-dots').trigger('click')" href="/resources/#whitepapers">WHITE PAPERS</a>
						<a class="nav-link-sub" onClick="$('.mobile-dots').trigger('click')" href="/resources/#videos">VIDEOS</a>
						<a class="nav-link-sub" onClick="$('.mobile-dots').trigger('click')" href="/resources/#bestpractices">BEST PRACTICES</a>						
						
					</div>
          
          <div class="divider-40"></div>
          

				</div>			
			</div>	
		</div>
	</div>
</div>	







	

<div class="container-fluid  no-pm">
	<div class="row no-pm">
		<div class="col-lg-12">

			<div class="container">
				<div class="row">
					<div class="col-lg-12 wrapper-center">




					</div>
				</div>
			</div>	
			
			
		</div>
	</div>
	

	</div>

			
		
	
	<div id="primary" class="content-area">
		<main id="main" class="site-main">

		


  



<article id="post-6559" class="post-6559 post type-post status-publish format-standard has-post-thumbnail hentry category-research">
	<header class="entry-header bkgd-ltgrey">
		<div class="container">
			<div class="row">
				<div class="col-lg-12 wrapper-center">

					<h1 class="entry-title">There’s a Hole in the Boot</h1>						<div class="entry-meta">
							<span class="posted-on"><time class="entry-date published navy" datetime="2020-07-29T00:01:00-04:00">July 29, 2020</time><time class="updated" datetime="2020-08-07T15:55:26-04:00">August 7, 2020</time></span>&nbsp&nbsp&nbsp/&nbsp&nbsp&nbsp<span class="byline"> <span class="author vcard navy">Eclypsium</span></span>						</div><!-- .entry-meta -->
										</div>
				</div>
			</div>	

	</header><!-- .entry-header -->

	
	<div class="container-fluid no-pm bkgd-ltgrey wrapper-thumbnail"><div class="row no-pm"><div class="col-lg-12 no-pm"><div class="container"><div class="row"><div class="col-lg-12 wrapper-center no-pm">
			<div class="post-thumbnail">
				<img width="1520" height="1000" src="/wp-content/uploads/2020/07/feature_image_boothole.jpg" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="Grub in a hole in a boot" loading="lazy" srcset="/wp-content/uploads/2020/07/feature_image_boothole.jpg 1520w, /wp-content/uploads/2020/07/feature_image_boothole-300x197.jpg 300w, /wp-content/uploads/2020/07/feature_image_boothole-1024x674.jpg 1024w, /wp-content/uploads/2020/07/feature_image_boothole-768x505.jpg 768w" sizes="(max-width: 1520px) 100vw, 1520px">			</div><!-- .post-thumbnail -->

		<img class="img-fluid" src="/wp-content/themes/eclypsium-10-28-21a/img/feature-image-shadow.png">  
                  <div class="bkgd-navy blog-email-sub-container">    
                    <div class="blog-email-wrapper cta">
                      <span class="white bold">Subscribe to Eclypsium’s Threat Report</span> 
                    </div>

                    <div class="blog-email-wrapper subbtn">
                        <!--[if lte IE 8]>
                      <script charset="utf-8" type="text/javascript" src="//js.hsforms.net/forms/v2-legacy.js"></script>
                      <![endif]-->
                      <script charset="utf-8" type="text/javascript" src="//js.hsforms.net/forms/v2.js"></script>
                      <script>
                        hbspt.forms.create({
                        portalId: "5610435",
                        formId: "8c6fcf7e-8993-484e-aebd-eedf458d6c21"
                      });
                      </script>
                    </div>
                  </div>
  
                </div></div></div></div></div></div>	
	
	
	<div class="entry-content">
		<div class="container">
			<div class="row">
				<div class="col-lg-12">
		
		
<p><em>“BootHole” vulnerability in the GRUB2 bootloader opens up Windows and Linux devices using Secure Boot to attack. All operating systems using GRUB2 with Secure Boot must release new installers and bootloaders.&nbsp;</em></p>



<p>Join Eclypsium for a recorded webinar &#8220;<a href="https://www.brighttalk.com/webcast/17865/430345?utm_source=Eclypsium&amp;utm_medium=brighttalk&amp;utm_campaign=430345">Managing The Hole In Secure Boot</a>&#8220;, where CEO Yuriy Bulygin and VP R&amp;D John Loucaides explain the BootHole vulnerability and provide advice on mitigation. </p>



<p><a class="bold" href="/wp-content/uploads/2020/08/Theres-a-Hole-in-the-Boot.pdf">Download the PDF &gt;</a></p>



<h2>Introduction</h2>



<p>Eclypsium researchers, Mickey Shkatov and Jesse Michael, have discovered a vulnerability — dubbed “BootHole” — in the GRUB2 bootloader utilized by most Linux systems that can be used to gain arbitrary code execution during the boot process, even when Secure Boot is enabled. Attackers exploiting this vulnerability can install persistent and stealthy bootkits or malicious bootloaders that could give them near-total control over the victim device.&nbsp;</p>



<p>The vulnerability affects systems using Secure Boot, even if they are not using GRUB2. Almost all signed versions of GRUB2 are vulnerable, meaning virtually every Linux distribution is affected. In addition, GRUB2 supports other operating systems, kernels and hypervisors such as Xen. The problem also extends to any Windows device that uses Secure Boot with the standard Microsoft Third Party UEFI Certificate Authority. Thus the majority of laptops, desktops, servers and workstations are affected, as well as network appliances and other special purpose equipment used in industrial, healthcare, financial and other industries. This vulnerability makes these devices susceptible to attackers such as the <a href="https://twitter.com/ESETresearch/status/1275770256389222400">threat actors recently discovered</a> using malicious UEFI bootloaders.</p>



<p>Eclypsium has coordinated the responsible disclosure of this vulnerability with a variety of industry entities, including OS vendors, computer manufacturers, and CERTs. Mitigation will require new bootloaders to be signed and deployed, and vulnerable bootloaders should be revoked to prevent adversaries from using older, vulnerable versions in an attack. This will likely be a long process and take considerable time for organizations to complete patching.</p>



<h2>Table of Contents</h2>



<ul><li><a href="#background">Background: Secure Boot, GRUB2, and CAs</a><ul><li><a href="#threats">Threats to the Boot Process</a></li><li><a href="#uefi">UEFI Secure Boot</a></li><li><a href="#chains">Chains of Trust and GRUB2</a></li><li><a href="#challenges">Challenges of Secure Boot</a></li></ul></li><li><a href="#breaking">Breaking Secure Boot Through GRUB2</a><ul><li><a href="#vulnerability">Vulnerability Analysis</a></li><li><a href="#additional">Additional Vulnerabilities</a></li><li><a href="#impacts">Impact</a></li></ul></li><li><a href="#mitigation">Mitigation</a><ul><li><a href="#recs">Recommendations</a></li></ul></li><li><a href="#conclusions">Conclusions</a></li></ul>



<div id="background" class="anchor"></div>



<h2>Background: Secure Boot, GRUB2, and CA<span style="text-transform:lowercase !important">s</span></h2>



<p>Secure Boot can be a fairly deep and technical topic. Our goal here is to give a high-level introduction to the key concepts relevant to this research without going into all the granular details. We have included a variety of external links to provide additional information for those interested. Alternatively, you can go straight to the <a href="#breaking">description of the vulnerability</a> itself.</p>



<div id="threats" class="anchor"></div>



<h3>Threats to the Boot Process</h3>



<p>The boot process is one of the most fundamentally important aspects of security for any device. It relies on a variety of firmware that controls how a device’s various components and peripherals are initialized and ultimately coordinates the loading of the operating system itself. In general, the earlier code is loaded, the more privileged it is.<br><br>If this process is compromised, attackers can control how the operating system is loaded and subvert all higher-layer security controls. Recent research has identified ransomware in the wild using <a href="https://twitter.com/ESETresearch/status/1275770256389222400">malicious EFI bootloaders</a> as a way to take control of machines at the time of boot. Previously threat actors used malware tampering with legacy OS bootloaders including &nbsp;<a href="https://attack.mitre.org/software/S0112/">APT41 Rockboot</a>, <a href="https://news.sophos.com/en-us/2020/04/24/lockbit-ransomware-borrows-tricks-to-keep-up-with-revil-and-maze/">LockBit</a>, <a href="https://arstechnica.com/information-technology/2015/12/nemesis-malware-hijacks-pcs-boot-process-to-gain-stealth-persistence/">FIN1 Nemesis</a>, <a href="https://www.cybereason.com/blog/night-of-the-devil-ransomware-or-wiper-a-look-into-targeted-attacks-in-japan">MBR-ONI</a>, <a href="https://us-cert.cisa.gov/ncas/alerts/TA17-181A">Petya/NotPetya</a>, and <a href="https://malpedia.caad.fkie.fraunhofer.de/details/win.rovnix">Rovnix</a>.</p>



<p>Additional information on threats to the modern PC boot process is available in the “<a href="https://github.com/abazhaniuk/firmware-security-training/blob/master/BIOS-UEFI-Security.2-BootkitsSecureBoot.pdf">Bootkits and UEFI Secure Boot</a>” section of the System Firmware training.</p>



<div id="uefi" class="anchor"></div>



<h3>UEFI Secure Boot</h3>



<p>UEFI Secure Boot was originally developed by the UEFI Forum as a way to protect the boot process from these types of attacks. There are other implementations of secure boot designed for different environments, but UEFI Secure Boot is the standard for PCs and servers. The goal is to prevent malicious code from being introduced into the boot process by cryptographically checking each piece of firmware and software before it is run. Any code not recognized as valid is not executed in the boot process.&nbsp;</p>



<p>Secure Boot uses cryptographic signatures to verify the integrity of each piece of code as it is needed during the boot process. There are two critical databases involved in this process: the Allow DB (db) of approved components and the Disallow DB (dbx) of vulnerable or malicious components, including firmware, drivers, and bootloaders. Access to modify these databases is protected by a Key Exchange Key (KEK), which in turn is verified by a Platform Key (PK). Although the PK is used as a root of trust for updates to the platform, it’s not expressly part of the boot process (but is shown below for reference). It is dbx, db, and KEK that are used to verify the signatures for loaded executables at boot time.</p>



<figure class="wp-block-image size-large blog-image-thick-border"><img src="/wp-content/uploads/2020/07/bh_diagram_1.png" alt class="wp-image-6567"></figure>



<p>Additional details on the Secure Boot process can be found in this <a href="http://www.c7zero.info/stuff/Windows8SecureBoot_Bulygin-Furtak-Bazhniuk_BHUSA2013.pdf">PDF</a>.</p>



<div id="chains" class="anchor"></div>



<h3>Chains of Trust and GRUB2</h3>



<p>Next, OEMs must manage a list of who is permitted to sign code trusted by the Secure Boot Database. Instead of having every OEM manage certificates from every possible firmware, driver, or OS provider, Secure Boot allows for the use of a centralized Certificate Authority (CA). Microsoft’s 3rd Party UEFI CA provides the industry standard signing service for Secure Boot. In short, third parties can submit their code to Microsoft, and Microsoft will validate and sign the code with the Microsoft CA. This establishes a chain of trust that only requires OEMs to enroll the Microsoft 3rd Party UEFI CA to their platforms to enable them to boot third-party installation media and operating systems by default when Secure Boot is enabled.</p>



<p>This includes the ability to sign bootloaders from non-Microsoft operating systems such as Linux. In almost every modern Linux distribution, GRUB (the Grand Unified Bootloader) is the bootloader that loads and transfers control to the operating system. In this document, all references to GRUB are intended to refer to GRUB2, which was a complete rewrite from the previous version commonly referred to as “GRUB Legacy.” Starting in 2009, all widely used Linux distributions have transitioned to using GRUB2. GRUB Legacy has been deprecated and is generally only found in older releases.</p>



<p><a href="https://techcommunity.microsoft.com/t5/hardware-dev-center/updated-uefi-signing-requirements/ba-p/1062916">Due to legal issues arising from license incompatibilities</a>, open-source projects and other third parties build a small application called a “shim,” which contains the vendor’s certificate and code that verifies and runs the bootloader (GRUB2). The vendor’s shim is verified using the Microsoft 3rd Party UEFI CA and then the shim loads and verifies the GRUB2 bootloader using the vendor certificate embedded inside itself.</p>



<figure class="wp-block-image size-large blog-image-thick-border blog-image-1000px"><img src="/wp-content/uploads/2020/07/bh_diagram_2.png" alt class="wp-image-6568"></figure>



<div style="height:20px" aria-hidden="true" class="wp-block-spacer"></div>



<p>Additional detail on the role of the Microsoft UEFI CA in the boot process is available <a href="https://docs.microsoft.com/en-us/windows-hardware/manufacture/desktop/windows-secure-boot-key-creation-and-management-guidance" target="_blank" rel="noreferrer noopener">here</a>.</p>



<div id="challenges" class="anchor"></div>



<h3>Challenges of Secure Boot</h3>



<p>As with any technical process, Secure Boot is not without its potential problems. The process involves many pieces of code, and a vulnerability in any one of them presents a single point of failure that could allow an attacker to bypass Secure Boot. Additionally, although UEFI Secure Boot attempts to provide certain integrity guarantees to the boot process, other misconfigurations of the hardware or missing protection features can undermine boot security. One such example is a <a href="/2020/01/30/direct-memory-access-attacks/">DMA attack</a> using tools such as <a href="https://github.com/Cr4sh/s6_pcie_microblaze">PCIe Microblaze</a>. Additionally, as we will show in this blog post, a vulnerability in the boot process that enables arbitrary code execution can allow attackers to control the boot process and operating system, even when secure boot signatures are verified.</p>



<p>Attackers can also use a vulnerable bootloader against the system. For example, if a valid bootloader was found to have a vulnerability, a piece of malware could replace the device’s existing bootloader with the vulnerable version. The bootloader would be allowed by Secure Boot and give the malware complete control over the system and OS. Mitigating this requires very active management of the dbx database used to identify malicious or vulnerable code.</p>



<figure class="wp-block-image size-large blog-image-1000px"><img loading="lazy" width="1024" height="247" src="/wp-content/uploads/2020/07/diagram_3_newr-1024x247.png" alt class="wp-image-6792" srcset="/wp-content/uploads/2020/07/diagram_3_newr-1024x247.png 1024w, /wp-content/uploads/2020/07/diagram_3_newr-300x72.png 300w, /wp-content/uploads/2020/07/diagram_3_newr-768x185.png 768w, /wp-content/uploads/2020/07/diagram_3_newr-1536x370.png 1536w, /wp-content/uploads/2020/07/diagram_3_newr.png 2001w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>Additionally, updates and fixes to the Secure Boot process can be particularly complex and run the risk of inadvertently <a href="https://www.securityweek.com/microsoft-pulls-uefi-related-windows-update-after-users-report-problems">breaking machines</a>. The boot process naturally involves a variety of players and components including device OEMs, operating system vendors, and administrators. Given the fundamental nature of the boot process, any sort of problems run a high risk of rendering a device unusable. As a result, updates to Secure Boot are typically slow and require extensive industry testing.&nbsp;&nbsp;</p>



<div id="breaking" class="anchor"></div>



<h2>Breaking Secure Boot Through GRUB2</h2>



<p>In the course of Eclypsium’s analysis, we have identified a buffer overflow vulnerability in the way that GRUB2 parses content from the GRUB2 config file (grub.cfg). Of note: The GRUB2 config file is a text file and typically is not signed like other files and executables. This vulnerability enables arbitrary code execution within GRUB2 and thus control over the booting of the operating system. As a result, an attacker could modify the contents of the GRUB2 configuration file to ensure that attack code is run before the operating system is loaded. In this way, attackers gain persistence on the device.&nbsp;</p>



<p>Such an attack would require an attacker to have elevated privileges. However, it would provide the attacker with a powerful additional escalation of privilege and persistence on the device, even with Secure Boot enabled and properly performing signature verification on all loaded executables. One of the explicit design goals of Secure Boot is to prevent unauthorized code, even running with administrator privileges, from gaining additional privileges and pre-OS persistence by disabling Secure Boot or otherwise modifying the boot chain.</p>



<p>With the sole exception of one bootable tool vendor who added custom code to perform a signature verification of the grub.cfg config file in addition to the signature verification performed on the GRUB2 executable, all versions of GRUB2 that load commands from an external grub.cfg configuration file are vulnerable. As such, this will require the release of new installers and bootloaders for all versions of Linux. Vendors will need to release new versions of their bootloader shims to be signed by the Microsoft 3rd Party UEFI CA. It is important to note that until all affected versions are added to the dbx revocation list, an attacker would be able to use a vulnerable version of shim and GRUB2 to attack the system. This means that every device that trusts the Microsoft 3rd Party UEFI CA will be vulnerable for that period of time.</p>



<p>In addition to vendors using shims signed by the Microsoft 3rd Party UEFI CA, some OEMs that control both the hardware and the software stack in their devices use their own key that is provisioned into the hardware at the factory to sign GRUB2 directly. They will need to provide updates and revocation of previous vulnerable versions of GRUB2 for these systems as well.</p>



<p>This vulnerability was assigned CVE-2020-10713 “GRUB2: crafted grub.cfg file can lead to arbitrary code execution during boot process” with a CVSS rating of 8.2 (High) / CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H.</p>



<p>Follow these links to go directly to the <a href="#impacts">Impact</a> and <a href="#mitigation">Mitigations</a> sections.</p>



<div id="vulnerability" class="anchor"></div>



<h3>Vulnerability Analysis</h3>



<p>The vulnerability is a buffer overflow that occurs in GRUB2 when parsing the grub.cfg file. This configuration file is an external file commonly located in the EFI System Partition and can therefore be modified by an attacker with administrator privileges without altering the integrity of the signed vendor shim and GRUB2 bootloader executables. The buffer overflow allows the attacker to gain arbitrary code execution within the UEFI execution environment, which could be used to run malware, alter the boot process, directly patch the OS kernel, or execute any number of other malicious actions.</p>



<p>To dig a little deeper into the vulnerability itself, we’ll take a closer look at how the code works internally. In order to process commands from the external configuration file, GRUB2 uses flex and bison to generate a parsing engine for a domain-specific language (DSL) from language description files and helper functions.</p>



<p>This is generally considered to be a better approach than manually writing a custom parser for each DSL. However, GRUB2, flex, and bison are all complex software packages with their own design assumptions that can be easy to overlook. And those mismatched design assumptions can result in vulnerable code.</p>



<p>The parser engine generated by flex includes this define as part of the token processing code:</p>



<pre class="wp-block-code">#define YY_DO_BEFORE_ACTION \
    yyg-&gt;yytext_ptr = yy_bp; \
    yyleng = (int) (yy_cp - yy_bp); \
    yyg-&gt;yy_hold_char = *yy_cp; \
    *yy_cp = '\0'; \
    <span style="color:#ef4130">if ( yyleng &gt;= YYLMAX ) \
        YY_FATAL_ERROR( "token too large, exceeds YYLMAX" ); \</span>
    yy_flex_strncpy( yytext, yyg-&gt;yytext_ptr, yyleng + 1 , yyscanner); \
    yyg-&gt;yy_c_buf_p = yy_cp;
</pre>



<p>In this macro, the generated code detects that it has encountered a token that is too large to fit into flex’s internal parse buffer and calls <code>YY_FATAL_ERROR()</code>, which is a helper function provided by the software that is using the flex-generated parser.</p>



<p>However, the <code>YY_FATAL_ERROR()</code> implementation provided in the GRUB2 software package is:</p>



<pre class="wp-block-code">#define YY_FATAL_ERROR(msg)                     \
  do {                                          \
    <span style="color:#ef4130">grub_printf (_("fatal error: %s\n"), _(msg));     \</span>
  } while (0)
</pre>



<p>Rather than halting execution or exiting, it just prints an error to the console and returns to the calling function. Unfortunately, the flex code has been written with the expectation that any calls to <code>YY_FATAL_ERROR()</code> will never return. This results in <code>yy_flex_strncpy()</code> being called and copying the source string from the configuration file into a buffer that is too small to contain it.</p>



<figure class="wp-block-image size-large blog-image-1000px"><img loading="lazy" width="1024" height="696" src="/wp-content/uploads/2020/07/bh_diagram_4-1024x696.png" alt class="wp-image-6582" srcset="/wp-content/uploads/2020/07/bh_diagram_4-1024x696.png 1024w, /wp-content/uploads/2020/07/bh_diagram_4-300x204.png 300w, /wp-content/uploads/2020/07/bh_diagram_4-768x522.png 768w, /wp-content/uploads/2020/07/bh_diagram_4-1536x1044.png 1536w, /wp-content/uploads/2020/07/bh_diagram_4.png 2000w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>Beyond just this specific path, a number of additional places throughout the flex-generated code also expect that any calls to <code>YY_FATAL_ERROR()</code> never return and perform unsafe operations when that expectation is broken. Mismatched assumptions between producers and consumers of an API are a very common source of vulnerabilities.&nbsp;</p>



<p>Ultimately, by providing a configuration file with input tokens that are too long to be handled by the parser, this buffer overflow overwrites critical structures in the heap. These overwritten fields include internal parser structure elements, which can be used as an arbitrary write-what-where primitive to gain arbitrary code execution and hijack the boot process.</p>



<figure class="wp-block-image size-large blog-image-1000px"><img loading="lazy" width="1024" height="891" src="/wp-content/uploads/2020/07/bh_diagram_5-1024x891.png" alt class="wp-image-6583" srcset="/wp-content/uploads/2020/07/bh_diagram_5-1024x891.png 1024w, /wp-content/uploads/2020/07/bh_diagram_5-300x261.png 300w, /wp-content/uploads/2020/07/bh_diagram_5-768x668.png 768w, /wp-content/uploads/2020/07/bh_diagram_5-1536x1336.png 1536w, /wp-content/uploads/2020/07/bh_diagram_5.png 2001w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>Of further note, the UEFI execution environment does not have Address Space Layout Randomization (ASLR) or Data Execution Prevention (DEP/NX) or other exploit mitigation technologies typically found in modern operating systems, so creating exploits for this kind of vulnerability is significantly easier. The heap is fully executable without the need to build ROP chains.</p>



<p>Finally, rather than being architecture-specific, this vulnerability is in a common code path and was also confirmed using a signed ARM64 version of GRUB2.</p>



<div id="additional" class="anchor"></div>



<h3>Additional Vulnerabilities</h3>



<p>There have been a couple of examples of previous vulnerabilities found in GRUB2 that result in arbitrary code execution, but with a much smaller scope.</p>



<p>In April 2019, a vulnerability in how GRUB2 was used by the Kaspersky Rescue Disk was <a href="https://habr.com/en/post/446238/">publicly disclosed</a>. In February 2020, more than six months after a fixed version had been released, Microsoft pushed an update to revoke the vulnerable bootloader across all Windows systems by updating the UEFI revocation list (dbx) to block the known-vulnerable Kaspersky bootloader. Unfortunately, this resulted in systems from multiple vendors encountering unexpected errors, including bricked devices, and the <a href="https://www.windowslatest.com/2020/02/15/windows-10-kb4524244-issues/">update was removed from the update servers</a>.</p>



<p>Additionally, in May 2020, Dmytro Oleksiuk <a href="https://twitter.com/d_olex/status/1264238411679887360">disclosed</a> that certain HPE ProLiant servers contained a version of GRUB2 signed by a HP CA that allows the use of the &#8220;insmod&#8221; command to load unsigned code. This issue was assigned CVE-2020-7205 and is also embargoed until July 29th.</p>



<p>In response to our initial vulnerability report, additional scrutiny was applied to the GRUB2 code and a number of additional vulnerabilities were discovered by the Canonical security team:</p>



<ul><li><strong>CVE-2020-14308 GRUB2:</strong> grub_malloc does not validate allocation size allowing for arithmetic overflow and subsequent heap-based buffer overflow<ul><li>6.4 (Medium) / CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H</li></ul></li><li><strong>CVE-2020-14309 GRUB2:</strong> Integer overflow in grub_squash_read_symlink may lead to heap based overflow<ul><li>5.7 (Medium) / CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:N/I:H/A:H</li></ul></li><li><strong>CVE-2020-14310 GRUB2:</strong> Integer overflow read_section_from_string may lead to heap based overflow<ul><li>5.7 (Medium) / CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:N/I:H/A:H</li></ul></li><li><strong>CVE-2020-14311 GRUB2:</strong> Integer overflow in grub_ext2_read_link leads to heap based buffer overflow,<ul><li>5.7 (Medium) / CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:N/I:H/A:H</li></ul></li><li><strong>CVE-2020-15705 GRUB2:</strong> avoid loading unsigned kernels when grub is booted directly under secure boot without shim<ul><li>6.4 (Medium) /CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H</li></ul></li><li><strong>CVE-2020-15706 GRUB2 script:</strong> Avoid a use-after-free when redefining a function during execution<ul><li>6.4 (Medium) /CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H</li></ul></li><li><strong>CVE-2020-15707 GRUB2:</strong> Integer overflow in initrd size handling.<ul><li>5.7 (Medium) /CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:N/I:H/A:H</li></ul></li></ul>



<p>Given the difficulty of this kind of ecosystem-wide update/revocation, there is a strong desire to avoid having to do it again six months later. To that end, a large effort — spanning multiple security teams at Oracle, Red Hat, Canonical, VMware, and Debian — using static analysis tools and manual review helped identify and fix dozens of further vulnerabilities and dangerous operations throughout the codebase that do not yet have individual CVEs assigned.</p>



<div id="impacts" class="anchor"></div>



<h3>Impact</h3>



<p>Due to a weakness in the way GRUB2 parses its configuration file, an attacker can execute arbitrary code that bypasses signature verification. The Boot Hole vulnerability discovered by Eclypsium can be used to install persistent and stealthy bootkits or malicious bootloaders that operate even when Secure Boot is enabled and functioning correctly. This can ensure attacker code runs before the operating system and can allow the attacker to control how the operating system is loaded, directly patch the operating system, or even direct the bootloader to alternate OS images. It gives the attacker virtually unlimited control over the victim device. Malicious bootloaders have recently been <a href="https://twitter.com/ESETresearch/status/1275770256389222400">observed in the wild</a>, and this vulnerability would make devices susceptible to these types of threats.&nbsp;</p>



<p>All signed versions of GRUB2 that read commands from an external grub.cfg file are vulnerable, affecting every Linux distribution. To date, more than 80 shims are known to be affected. In addition to Linux systems, any system that uses Secure Boot with the standard Microsoft UEFI CA is vulnerable to this issue. As a result, we believe that the majority of modern systems in use today, including servers and workstations, laptops and desktops, and a large number of Linux-based OT and IoT systems, are potentially affected by these vulnerabilities.</p>



<p>Additionally, any hardware root of trust mechanisms that rely on UEFI Secure Boot could be bypassed as well.</p>



<div id="mitigation" class="anchor"></div>



<h2>Mitigation</h2>



<p>Full mitigation of this issue will require coordinated efforts from a variety of entities: affected open-source projects, Microsoft, and the owners of affected systems, among others. This will include:</p>



<ol><li>Updates to GRUB2 to address the vulnerability.</li><li>Linux distributions and other vendors using GRUB2 will need to update their installers, bootloaders, and shims.</li><li>New shims will need to be signed by the Microsoft 3rd Party UEFI CA.</li><li>Administrators of affected devices will need to update installed versions of operating systems in the field as well as installer images, including disaster recovery media.</li><li>Eventually the <a href="https://uefi.org/revocationlistfile">UEFI revocation list (dbx)</a> needs to be updated in the firmware of each affected system to prevent running this vulnerable code during boot.</li></ol>



<p>On the Coordinated Release Date (CRD) of July 29, we expect to see advisories and/or updates from the following affected parties:</p>



<ul><li>Microsoft</li><li>UEFI Security Response Team (USRT)</li><li>Oracle</li><li>Red Hat (Fedora and RHEL)</li><li>Canonical (Ubuntu)</li><li>SuSE (SLES and openSUSE)</li><li>Debian</li><li>Citrix</li><li>VMware</li><li>Various OEMs</li><li>Software vendors, including security software, are also impacted by this vulnerability and will be updating their bootloaders.</li><li>… more to be added once we have a full list &#8230;</li></ul>



<p><br>However, full deployment of this revocation process will likely be very slow. UEFI-related updates have had a <a href="https://www.securityweek.com/microsoft-pulls-uefi-related-windows-update-after-users-report-problems">history of making devices unusable</a>, and vendors will need to be very cautious. If the revocation list (dbx) is updated before a given Linux bootloader and shim are updated, then the operating system will not load. As a result, updates to the revocation list will take place over time to prevent breaking systems that have yet to be updated. There are also edge cases where updating the dbx can be difficult, such as with dual-boot or deprovisioned machines. When any OS is installed or launched, the bootloader and OS need to be updated before the revocation is applied to the system.</p>



<p>Further complicating matters, enterprise disaster recovery processes can run into issues where approved recovery media no longer boots on a system if dbx updates have been applied. In addition when a device swap is needed due to failing hardware, new systems of the same model may have already had dbx updates applied and will fail when attempting to boot previously-installed operating systems. Before dbx updates are pushed out to enterprise fleet systems, recovery and installation media must be updated and verified as well.<br></p>



<p>Microsoft will be releasing a set of signed dbx updates, which can be applied to systems to block shims that can be used to load the vulnerable versions of GRUB2. Due to the risk of bricking systems or otherwise breaking operational or recovery workflows, these dbx updates will initially be made available for interested parties to manually apply to their systems rather than pushing the revocation entries and applying them automatically. This will allow IT professionals, enthusiasts, and others the opportunity to test the revocation updates on their individual systems and identify any issues before making the revocations mandatory.</p>



<p>Organizations should additionally ensure they have appropriate capabilities for monitoring UEFI bootloaders and firmware and verifying UEFI configurations, including revocation lists, in their systems. Organizations should also test recovery capabilities as updates become available, including the “reset to factory defaults” functionality in the UEFI setup. This will ensure that they can recover devices if a device is negatively impacted by an update. Finally, organizations should be monitoring their systems for threats and ransomware that use vulnerable bootloaders to infect or damage systems.&nbsp;</p>



<div id="recs" class="anchor"></div>



<h3>Recommendations</h3>



<ol><li>Right away, start monitoring the contents of the bootloader partition (EFI system partition). This will buy time for the rest of the process and help identify affected systems in your environment. For those who have deployed the Eclypsium solution, you can see this monitoring under the “MBR/Bootloader” component of a device.<br></li><li> Continue to install OS updates as usual across desktops, laptops, servers, and appliances. Attackers can leverage privilege escalation flaws in the OS and applications to take advantage of this vulnerability so preventing them from gaining administrative level access to your systems is critical. Systems are still vulnerable after this, but it is a necessary first step. Once the revocation update is installed later, the old bootloader should stop working. This includes rescue disks, installers, enterprise gold images, virtual machines, or other bootable media.<br></li><li>Test the revocation list update. Be sure to specifically test the same firmware versions and models that are used in the field. It may help to update to the latest firmware first in order to reduce the number of test cases.<br></li><li>To close this vulnerability, you need to deploy the revocation update. Make sure that all bootable media has received OS updates first, roll it out slowly to only a small number of devices at a time, and incorporate lessons learned from testing as part of this process.<br></li><li> Engage with your third-party vendors to validate they are aware of, and are addressing, this issue. They should provide you a response as to its applicability to the services/solutions they provide you as well as their plans for remediation of this high rated vulnerability.</li></ol>



<p>Eclypsium has <a href="https://github.com/eclypsium/BootHole/">powershell and bash scripts available</a> which can be used to detect bootloaders that are being revoked by this dbxupdate.</p>



<div id="conclusions" class="anchor"></div>



<h2>Conclusions&nbsp;</h2>



<p>While Secure Boot is easily taken for granted by most users, it is the foundation of security within most devices. Once compromised, attackers can gain virtually complete control over the device, its operating system, and its applications and data. And as this research shows, when problems are found in the boot process, they can have far-reaching effects across many types of devices.&nbsp;</p>



<p>We will update this blog post as more information becomes available, and we encourage users and administrators to closely monitor alerts and notifications from their hardware vendors, the <a href="https://www.microsoft.com/en-us/msrc">Microsoft MSRC</a>, and any relevant open-source projects.<br><br>Have questions? Learn more on this recorded webinar &#8220;<a href="https://www.brighttalk.com/webcast/17865/430345?utm_source=Eclypsium&amp;utm_medium=brighttalk&amp;utm_campaign=430345">Managing the Hole in Secure Boot</a>.&#8221;</p>



<h3><strong>July 30 Important Update</strong></h3>



<p>Some of the Linux distribution updates appear to be leading to unsuccessful reboots. The developers and distribution maintainers are working to provide new updates. The maintainers are recommending to avoid installing updates for grub2, shim, and other bootloader-related applications until new packages are available. Some of the issues to watch are listed below:</p>



<ul><li><a target="_blank" href="https://access.redhat.com/security/vulnerabilities/grub2bootloader" rel="noreferrer noopener">https://access.redhat.com/security/vulnerabilities/grub2bootloader</a></li><li><a target="_blank" href="https://bugzilla.redhat.com/show_bug.cgi?id=1862045" rel="noreferrer noopener">https://bugzilla.redhat.com/show_bug.cgi?id=1862045</a></li><li><a target="_blank" href="https://bugzilla.redhat.com/show_bug.cgi?id=1861977" rel="noreferrer noopener">https://bugzilla.redhat.com/show_bug.cgi?id=1861977</a></li><li><a target="_blank" href="https://bugs.launchpad.net/ubuntu/+source/grub2/+bug/1889556" rel="noreferrer noopener">https://bugs.launchpad.net/ubuntu/+source/grub2/+bug/1889556</a></li><li><a target="_blank" href="https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=966554" rel="noreferrer noopener">https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=966554</a></li><li><a target="_blank" href="https://status.cloud.google.com/incident/compute/20009#20009005" rel="noreferrer noopener">https://status.cloud.google.com/incident/compute/20009#20009005</a></li></ul>



<div id="references" class="anchor"></div>



<p><strong>References:</strong></p>



<ul><li>Microsoft<ul><li>Security advisory<ul><li><a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/ADV200011">https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/ADV200011</a></li></ul></li></ul></li><li>UEFI Forum<ul><li>Updated Revocation List<ul><li><a href="https://uefi.org/revocationlistfile">https://uefi.org/revocationlistfile</a></li></ul></li></ul></li><li>Debian<ul><li>Security advisory<ul><li><a href="https://www.debian.org/security/2020-GRUB-UEFI-SecureBoot">https://www.debian.org/security/2020-GRUB-UEFI-SecureBoot</a>&nbsp;</li></ul></li></ul></li><li>Canonical:<ul><li>Security advisory<ul><li><a href="https://ubuntu.com/security/notices/USN-4432-1">https://ubuntu.com/security/notices/USN-4432-1</a>&nbsp;</li></ul></li><li>KnowledgeBase article<ul><li><a href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/GRUB2SecureBootBypass">https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/GRUB2SecureBootBypass</a></li></ul></li></ul></li><li>Red Hat<ul><li>Customer documentation<ul><li><a href="https://access.redhat.com/security/vulnerabilities/grub2bootloader">https://access.redhat.com/security/vulnerabilities/grub2bootloader</a></li></ul></li><li>CVE information<ul><li><a href="https://access.redhat.com/security/cve/cve-2020-10713">https://access.redhat.com/security/cve/cve-2020-10713</a></li></ul></li><li>Vulnerability response article<ul><li><a href="https://access.redhat.com/security/vulnerabilities/grub2bootloader">https://access.redhat.com/security/vulnerabilities/grub2bootloader</a></li></ul></li></ul></li></ul>



<ul><li>SUSE<ul><li>Security advisory:<ul><li><a href="https://www.suse.com/c/suse-addresses-grub2-secure-boot-issue/">https://www.suse.com/c/suse-addresses-grub2-secure-boot-issue/</a></li></ul></li><li>Knowledge Base article:<ul><li><a href="https://www.suse.com/support/kb/doc/?id=000019673">https://www.suse.com/support/kb/doc/?id=000019673</a></li></ul></li></ul></li></ul>



<ul><li>HP<ul><li>Security advisory<ul><li><a href="https://support.hp.com/us-en/document/c06707446">HPSBHF03678 rev. 1 &#8211; GRUB2 Bootloader Arbitrary Code Execution</a></li></ul></li></ul></li><li>HPE<ul><li>Security advisory<ul><li><a href="https://techhub.hpe.com/eginfolib/securityalerts/Boot_Hole/boot_hole.html">https://techhub.hpe.com/eginfolib/securityalerts/Boot_Hole/boot_hole.html</a></li></ul></li></ul></li><li>VMware<ul><li>Knowledge Base article<ul><li><a href="https://kb.vmware.com/s/article/80181">https://kb.vmware.com/s/article/80181</a></li></ul></li></ul></li><li>NSA<ul><li>Cybersecurity advisory<ul><li><a rel="noreferrer noopener" target="_blank" href="https://media.defense.gov/2020/Jul/30/2002467902/-1/-1/0/CSA_MITIGATE_THE_GRUB2_BOOTHOLE_VULNERABILITY_20200730_NSA_GOV%20-%20COPY.PDF">https://media.defense.gov/2020/Jul/30/2002467902/-1/-1/0/CSA_MITIGATE_THE_GRUB2_BOOTHOLE_VULNERABILITY_20200730_NSA_GOV%20-%20COPY.PDF</a></li></ul></li></ul></li><li>Lenovo<ul><li>Security advisory<ul><li><a href="https://support.lenovo.com/us/en/product_security/LEN-34794">https://support.lenovo.com/us/en/product_security/LEN-34794</a></li></ul></li></ul></li><li>NetApp<ul><li>Security advisory<ul><li><a rel="noreferrer noopener" target="_blank" href="https://security.netapp.com/advisory/ntap-20200731-0008/">https://security.netapp.com/advisory/ntap-20200731-0008/</a></li></ul></li></ul></li><li>Cisco<ul><li>Security advisory<ul><li><a href="https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-grub2-code-exec-xLePCAPY">https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-grub2-code-exec-xLePCAPY</a></li></ul></li></ul></li><li>Dell<ul><li>Knowledge Base article<ul><li><a href="https://www.dell.com/support/article/en-bo/sln322283/dell-response-to-grub2-vulnerabilities-which-may-allow-secure-boot-bypass?lang=en">https://www.dell.com/support/article/en-bo/sln322283/dell-response-to-grub2-vulnerabilities-which-may-allow-secure-boot-bypass?lang=en</a></li></ul></li><li>Knowledge Base article<ul><li><a href="https://www.dell.com/support/article/en-bo/sln322287/additional-information-regarding-the-boothole-grub-vulnerability?lang=en">https://www.dell.com/support/article/en-bo/sln322287/additional-information-regarding-the-boothole-grub-vulnerability?lang=en</a></li></ul></li></ul></li></ul>



<ul><li>Upstream Grub2 project<ul><li><a href="http://git.savannah.gnu.org/gitweb/?p=grub.git&amp;view=view+git+repository">GRUB2 Git Repository</a></li><li><a href="https://lists.gnu.org/mailman/listinfo/grub-devel/">GRUB Developer Mailing List</a></li></ul></li></ul>



<div style="height:20px" aria-hidden="true" class="wp-block-spacer"></div>



<p><a href="/contact/" class="bold orange font-bump-125">Contact us if you need help with this issue.</a></p>
				</div>
			</div>
		</div>	
					
	</div><!-- .entry-content -->
	

	<footer class="entry-footer section">
		
		
		<div class="container-fluid no-pm  wrapper-thumbnail"><div class="row no-pm"><div class="col-lg-12 no-pm"><div class="container"><div class="row"><div class="col-lg-12 wrapper-center "><span class="cat-links">Posted in <a href="/category/research/" rel="category tag">Research</a></span></div></div></div></div></div></div>
		
		
		
		
	</footer><!-- .entry-footer -->
</article><!-- #post-6559 -->
<div class="container-fluid no-pm bkgd-ltgrey post-nav"><div class="row no-pm"><div style="text-align:right" class="col-5">&laquo;&nbsp;<a href="/2020/06/29/screwed-drivers-open-atms-to-attack/" rel="prev">Screwed Drivers Open ATMs to Attack</a></div><div class="col-2 wrapper-center">|</div><div class="col-5"><a href="/2020/08/21/securing-the-enterprise-from-boothole/" rel="next">Securing the Enterprise From BootHole</a>&nbsp;&raquo;</div></div></div>
			
			

			
			
		</main><!-- #main -->
	</div><!-- #primary -->
</div>

	</div><!-- #content -->

	<footer id="colophon" class="site-footer">
		<div class="site-info">

			<div class="footer container-fluid">
				
				
				<div class="row no-pm">
					<div class="col-lg-12 wrapper-center">
							<div id="backtotop" class="navy"><img width="16" height="10" class="footer-arrow" src="/wp-content/themes/eclypsium-10-28-21a/img/arrow-up-blue.svg"><br>
						<b>Back to Top</b></div>
					</div>
				</div>	
				
				
				<div class="row no-pm divider-30">
					<div class="col-lg-12">
						<a class="orange bold" href="https://info.eclypsium.com/subscribe">Subscribe to Below the Surface</a><br><span style="color:#c4c4c4">A firmware and hardware threat report from our research team.</span>
						
					</div>
				</div>	
				
				<div class="row no-pm divider-40">
					<div class="col-lg-12">

						<a href="https://www.linkedin.com/company/eclypsium" class="icon-social-container" target="_blank"><img class="icon-social" src="/wp-content/themes/eclypsium-10-28-21a/img/icon-social-li.svg"><img< a>
						<a href="https://twitter.com/eclypsium" class="icon-social-container" target="_blank"><img class="icon-social" src="/wp-content/themes/eclypsium-10-28-21a/img/icon-social-tw.svg"><img< a>
						<a href="https://www.facebook.com/Eclypsium/" class="icon-social-container" target="_blank"><img class="icon-social" src="/wp-content/themes/eclypsium-10-28-21a/img/icon-social-fb.svg"><img< a>

							
						
					</img<></a></img<></a></img<></a></div>
				</div>	
				
			<div class="row no-pm divider-10">
					<div class="col-lg-12">
					<a class href="/privacy/">Privacy Policy</a><br><br>					
				</div>
				</div>	
							
				<div class="row no-pm">
					<div class="col-lg-12">
						<div id="copyright">&copy;<script type="text/javascript">document.write(new Date().getFullYear())</script> Eclypsium, Inc.</div>
					</div>
				</div>	
				<div class="row no-pm">
					<div class="col-lg-12">
							<a href="/"><img class="footer-logo" src="/wp-content/themes/eclypsium-10-28-21a/img/logo-eclypsium-grey.svg"></a>
					</div>
				</div>	
				

			</div>
		
		
		</div><!-- .site-info -->
	</footer><!-- #colophon -->


</div><!-- #page -->

<script type="text/javascript" id="code-prettify-js-extra">
/* <![CDATA[ */
var codePrettifyLoaderBaseUrl = "\/wp-content\/plugins\/code-prettify\/prettify";
/* ]]> */
</script>
<script type="text/javascript" src="/wp-content/plugins/code-prettify/prettify/run_prettify.js?ver=1.4.0" id="code-prettify-js"></script>
<script type="text/javascript" src="/wp-content/themes/eclypsium-10-28-21a/js/navigation.js?ver=20151215" id="eclypsium-navigation-js"></script>
<script type="text/javascript" src="/wp-content/themes/eclypsium-10-28-21a/js/skip-link-focus-fix.js?ver=20151215" id="eclypsium-skip-link-focus-fix-js"></script>
<script type="text/javascript" src="/wp-includes/js/wp-embed.min.js?ver=5.8.1" id="wp-embed-js"></script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
    
<script type="text/javascript" language="javascript">
  var sf14gv = 32633;
  (function() {
    var sf14g = document.createElement('script');
    sf14g.src = 'https://tracking.leadlander.com/lt.min.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(sf14g, s);
  })();
</script>		
	
<script> (function(){ window.ldfdr = window.ldfdr || {}; (function(d, s, ss, fs){ fs = d.getElementsByTagName(s)[0]; function ce(src){ var cs = d.createElement(s); cs.src = src; setTimeout(function(){fs.parentNode.insertBefore(cs,fs)}, 1); } ce(ss); })(document, 'script', 'https://lftracker.leadfeeder.com/lftracker_v1_DzLR5a5nBBW8BoQ2.js'); })(); </script>
	
<!-- Start of HubSpot Embed Code
<script type="text/javascript" id="hs-script-loader" async defer src="//js.hs-scripts.com/5610435.js"></script>
<!-- End of HubSpot Embed Code -->

		
</body>
</html>
