<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    
        <link rel='alternate' type='application/rss+xml' title='PHAR related Bug #71331 - RDF' href='rss/bug.php?id=71331'>
        <link rel='alternate' type='application/rss+xml' title='PHAR related Bug #71331 - RSS 2.0' href='rss/bug.php?id=71331&format=rss2'>
        <base href="https://bugs.php.net/">
    <title>PHP :: Sec Bug #71331 :: Uninitialized pointer in phar_make_dirstream()</title>
    <link rel="shortcut icon" href="https://bugs.php.net/images/favicon.ico">
    <link rel="stylesheet" href="https://bugs.php.net/css/style.css">
</head>

<body>

<table id="top" class="head" cellspacing="0" cellpadding="0">
    <tr>
        <td class="head-logo">
            <a href="/"><img src="images/logo.png" alt="Bugs" vspace="2" hspace="2"></a>
        </td>

        <td class="head-menu">
            <a href="https://php.net/">php.net</a>&nbsp;|&nbsp;
            <a href="https://php.net/support.php">support</a>&nbsp;|&nbsp;
            <a href="https://php.net/docs.php">documentation</a>&nbsp;|&nbsp;
            <a href="report.php">report a bug</a>&nbsp;|&nbsp;
            <a href="search.php">advanced search</a>&nbsp;|&nbsp;
            <a href="search-howto.php">search howto</a>&nbsp;|&nbsp;
            <a href="stats.php">statistics</a>&nbsp;|&nbsp;
            <a href="random">random bug</a>&nbsp;|&nbsp;
            <a href="login.php">login</a>
        </td>
    </tr>

    <tr>
        <td class="head-search" colspan="2">
            <form method="get" action="search.php">
                <p class="head-search">
                    <input type="hidden" name="cmd" value="display">
                    <small>go to bug id or search bugs for</small>
                    <input class="small" type="text" name="search_for" value="" size="30">
                    <input type="image" src="images/small_submit_white.gif" alt="search" style="vertical-align: middle;">
                </p>
            </form>
        </td>
    </tr>
</table>

<table class="middle" cellspacing="0" cellpadding="0">
    <tr>
        <td class="content">
<div id="bugheader">
    <table id="details">
        <tr id="title">
            <th class="details" id="number"><a href="bug.php?id=71331">Sec Bug</a>&nbsp;#71331</th>
            <td id="summary" colspan="5">Uninitialized pointer in phar_make_dirstream()</td>
        </tr>
        <tr id="submission">
            <th class="details">Submitted:</th>
            <td style="white-space: nowrap;">2016-01-10 17:51 UTC</td>
            <th class="details">Modified:</th>
            <td style="white-space: nowrap;">2016-04-28 16:59 UTC</td>
            <td rowspan="6">


            </td>
        </tr>

        <tr id="submitter">
            <th class="details">From:</th>
            <td>manhluat &#x61;&#116; vnsecurity &#x64;&#111;&#x74; net</td>
            <th class="details">Assigned:</th>
            <td><a href="search.php?cmd=display&amp;assign=stas">stas</a> (<a href="https://people.php.net/stas">profile</a>)</td>
        </tr>

        <tr id="categorization">
            <th class="details">Status:</th>
            <td>Closed</td>
            <th class="details">Package:</th>
            <td><a href="search.php?cmd=display&amp;package_name[]=PHAR+related">PHAR related</a></td>
        </tr>

        <tr id="situation">
            <th class="details">PHP Version:</th>
            <td>5.6.17</td>
            <th class="details">OS:</th>
            <td>Linux, Mac</td>
        </tr>

        <tr id="private">
            <th class="details">Private report:</th>
            <td>No</td>
            <th class="details">CVE-ID:</th>
            <td><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-4343" target="_blank">2016-4343</a></td>
        </tr>
    </table>
</div>

<div class="controls">
<span id='control_0' class='control active'>View</span>
<span id='control_3' class='control'><a href='bug.php?id=71331&amp;edit=3'>Add Comment</a></span>
<span id='control_1' class='control'><a href='bug.php?id=71331&amp;edit=1'>Developer</a></span>
<span id='control_2' class='control'><a href='bug.php?id=71331&amp;edit=2'>Edit</a></span>
</div>
<div class="clear"></div>



<div class='comment type_comment' ><a name="1452448275">&nbsp;</a><strong>[2016-01-10 17:51 UTC] manhluat &#x61;&#116; vnsecurity &#x64;&#111;&#x74; net</strong>
<pre class='note'>Description:
------------
There is a bug in phar_make_dirstream, when it tries to parse malicious &quot;.tar&quot; file.

The problem starts here:

tar.c

345		if (!last_was_longlink &amp;&amp; hdr-&gt;typeflag == 'L') {
			last_was_longlink = 1;
			/* support the ././@LongLink system for storing long filenames */
			entry.filename_len = entry.uncompressed_filesize;

You can see that if hdr-&gt;typeflag == 'L', it will parse input .tar file as longlink filename and entry.filename_len will be assigned with value of entry.uncompressed_filesize (which is retrieved from .tar file also).

Assume that I can set entry.filename_len=entry.uncompressed_filesize=0.

And a bit later, it will call phar_make_dirstream().

===========================

dirstream.c

static php_stream *phar_make_dirstream(char *dir, HashTable *manifest TSRMLS_DC) /* {{{ */
{
...
char *entry, *found, *save, *str_key;uint keylen;// Uninitialized variables
...

201	while (FAILURE != zend_hash_has_more_elements(manifest)) {
		if (HASH_KEY_NON_EXISTENT == zend_hash_get_current_key_ex(manifest, &amp;str_key, &amp;keylen, &amp;unused, 0, NULL)) {
			break;
		}
..
216 if (keylen &gt;= sizeof(&quot;.phar&quot;)-1 &amp;&amp; !memcmp(str_key, &quot;.phar&quot;, sizeof(&quot;.phar&quot;)-1)) {
...



=======================

zend_hash.c

1068 ZEND_API int zend_hash_get_current_key_ex(const HashTable *ht, char **str_index, uint *str_length, ulong *num_index, zend_bool duplicate, HashPosition *pos)
{
	Bucket *p;

	p = pos ? (*pos) : ht-&gt;pInternalPointer;

	IS_CONSISTENT(ht);

	if (p) {
		if (p-&gt;nKeyLength) {
			if (duplicate) {
				*str_index = estrndup(p-&gt;arKey, p-&gt;nKeyLength - 1);
			} else {
				*str_index = (char*)p-&gt;arKey;
			}
			if (str_length) {
				*str_length = p-&gt;nKeyLength;
			}
			return HASH_KEY_IS_STRING;
		} else {
			*num_index = p-&gt;h;
			return HASH_KEY_IS_LONG;
		}
	}
	return HASH_KEY_NON_EXISTENT;
}

As you can see above, if p-&gt;nKeyLength is zero (entry.filename_len), it will try to parse current bucket in hashtable as HASH_KEY_IS_LONG. Ok get back to dirstream.c

After zend_hash_get_current_key_ex() is called, str_key/key_len will be exactly the old value if the current_hash is INT value, zend_hash_get_current_key_ex() will just assign the 3rd value as a longint value.

The problem is here...

The 201th line in dirstream.c doesn't check whether return type of zend_hash_get_current_key_ex() is STRING or INT. (as you see, it just check if it is HASH_KEY_NON_EXISTENT or not). And use it as string pointer in further (216th line).

So attacker,by somehow, he could control the stack frame at the moment before calling zend_hash_get_current_key_ex() then he could take over these variables (str_key/key_len) and it could lead to some evil scenario.

PoC works with PHP latest version (php-5.6.17) in Linux and Mac as well.

PoC can be downloaded at <a href="http://l4w.io/files/PHP-PoC/93aa2719f76a916b118fa77c62981f5f/PoC/" rel="nofollow">http://l4w.io/files/PHP-PoC/93aa2719f76a916b118fa77c62981f5f/PoC/</a>

* How to fix:
I think we should check return type of zend_hash_get_current_key_ex() in 
phar_make_dirstream() is whether STRING or LONGINT.
And check entry.filename_len&gt;0 when parsing longlink filename also.

Test script:
---------------
&lt;?php
new PharData($argv[1]);
?&gt;

Expected result:
----------------
Program received signal SIGSEGV, Segmentation fault.

Actual result:
--------------
gdb-peda$ r ./PoC/poc.php ./PoC/000.tar 
Starting program: /root/test/php-5.6.17/sapi/cli/php ./PoC/poc.php ./PoC/000.tar

Program received signal SIGSEGV, Segmentation fault.
[----------------------------------registers-----------------------------------]
EAX: 0x16 
EBX: 0x8804000 --&gt; 0x8803dd8 --&gt; 0x1 
ECX: 0x5 
EDX: 0x86fbc93 (&quot;.phar&quot;)
ESI: 0xf7bd9254 --&gt; 0x8 
EDI: 0xf7d5a75f (&lt;__memcpy_ssse3_rep+47&gt;:       add    ebx,0x37561)
EBP: 0xf7bd94d8 --&gt; 0xf7bd002f --&gt; 0x0 
ESP: 0xffff9c78 --&gt; 0x8804000 --&gt; 0x8803dd8 --&gt; 0x1 
EIP: 0xf7d68fd0 (&lt;__memcmp_sse4_2+64&gt;:  mov    bl,BYTE PTR [eax])
EFLAGS: 0x10293 (CARRY parity ADJUST zero SIGN trap INTERRUPT direction overflow)
[-------------------------------------code-------------------------------------]
   0xf7d68fc7 &lt;__memcmp_sse4_2+55&gt;:     add    ebx,DWORD PTR [ebx+ecx*4]
   0xf7d68fca &lt;__memcmp_sse4_2+58&gt;:     jmp    ebx
   0xf7d68fcc &lt;__memcmp_sse4_2+60&gt;:     lea    esi,[esi+eiz*1+0x0]
=&gt; 0xf7d68fd0 &lt;__memcmp_sse4_2+64&gt;:     mov    bl,BYTE PTR [eax]
   0xf7d68fd2 &lt;__memcmp_sse4_2+66&gt;:     cmp    bl,BYTE PTR [edx]
   0xf7d68fd4 &lt;__memcmp_sse4_2+68&gt;:     jne    0xf7d6901f &lt;__memcmp_sse4_2+143&gt;
   0xf7d68fd6 &lt;__memcmp_sse4_2+70&gt;:     mov    bl,BYTE PTR [eax+0x1]
   0xf7d68fd9 &lt;__memcmp_sse4_2+73&gt;:     cmp    bl,BYTE PTR [edx+0x1]
[------------------------------------stack-------------------------------------]
0000| 0xffff9c78 --&gt; 0x8804000 --&gt; 0x8803dd8 --&gt; 0x1 
0004| 0xffff9c7c --&gt; 0x8169a4c (&lt;phar_make_dirstream+988&gt;:      mov    ecx,DWORD PTR [esp+0x30])
0008| 0xffff9c80 --&gt; 0x16 
0012| 0xffff9c84 --&gt; 0x86fbc93 (&quot;.phar&quot;)
0016| 0xffff9c88 --&gt; 0x5 
0020| 0xffff9c8c --&gt; 0xffff9cc8 --&gt; 0x1505 
0024| 0xffff9c90 --&gt; 0x0 
0028| 0xffff9c94 --&gt; 0x0 
[------------------------------------------------------------------------------]
Legend: code, data, rodata, value
Stopped reason: SIGSEGV
__memcmp_sse4_2 () at ../sysdeps/i386/i686/multiarch/memcmp-sse4.S:114
114     ../sysdeps/i386/i686/multiarch/memcmp-sse4.S: No such file or directory.
gdb-peda$ bt
#0  __memcmp_sse4_2 () at ../sysdeps/i386/i686/multiarch/memcmp-sse4.S:114
#1  0x08169a4c in phar_make_dirstream (dir=0xf7bd94d8 &quot;/&quot;, manifest=0xf7bd9254) at /root/test/php-5.6.17/ext/phar/dirstream.c:216
#2  0x08169e14 in phar_wrapper_open_dir (wrapper=0x8805220 &lt;php_stream_phar_wrapper&gt;, path=0xf7bd9448 &quot;phar:///root/test/PoC/000.tar/&quot;, mode=0x87241b8 &quot;r&quot;, options=0x0, opened_path=0x0, context=0x0)
    at /root/test/php-5.6.17/ext/phar/dirstream.c:357
#3  0x08268dae in _php_stream_opendir (path=path@entry=0xf7bd9448 &quot;phar:///root/test/PoC/000.tar/&quot;, options=options@entry=0x8, context=0x0) at /root/test/php-5.6.17/main/streams/streams.c:1986
#4  0x081bdf88 in spl_filesystem_dir_open (intern=intern@entry=0xf7bd9f58, path=0xf7bd9448 &quot;phar:///root/test/PoC/000.tar/&quot;) at /root/test/php-5.6.17/ext/spl/spl_directory.c:250
#5  0x081c18af in spl_filesystem_object_construct (ht=ht@entry=0x2, return_value=return_value@entry=0xf7bd8a30, return_value_ptr=return_value_ptr@entry=0xffff9f4c, this_ptr=this_ptr@entry=0xf7bd8a68, 
    return_value_used=return_value_used@entry=0x1, ctor_flags=ctor_flags@entry=0x1) at /root/test/php-5.6.17/ext/spl/spl_directory.c:731
#6  0x081c1977 in zim_spl_RecursiveDirectoryIterator___construct (ht=0x2, return_value=0xf7bd8a30, return_value_ptr=0xffff9f4c, this_ptr=0xf7bd8a68, return_value_used=0x1) at /root/test/php-5.6.17/ext/spl/spl_directory.c:1597
#7  0x082a3fc1 in zend_call_function (fci=fci@entry=0xffff9f7c, fci_cache=fci_cache@entry=0xffff9f68) at /root/test/php-5.6.17/Zend/zend_execute_API.c:847
#8  0x082cc101 in zend_call_method (object_pp=object_pp@entry=0xffffa02c, obj_ce=&lt;optimized out&gt;, fn_proxy=fn_proxy@entry=0x88a3c84, function_name=function_name@entry=0x836d76a &quot;__construct&quot;, 
    function_name_len=function_name_len@entry=0xb, retval_ptr_ptr=retval_ptr_ptr@entry=0x0, param_count=param_count@entry=0x2, arg1=arg1@entry=0xffffa030, arg2=arg2@entry=0xffffa040)
    at /root/test/php-5.6.17/Zend/zend_interfaces.c:97
#9  0x081754e1 in zim_Phar___construct (ht=0x1, return_value=0xf7bd8a4c, return_value_ptr=0xf7bbf088, this_ptr=0xf7bd8a68, return_value_used=0x0) at /root/test/php-5.6.17/ext/phar/phar_object.c:1255
#10 0x083615c0 in zend_do_fcall_common_helper_SPEC (execute_data=&lt;optimized out&gt;) at /root/test/php-5.6.17/Zend/zend_vm_execute.h:558
#11 0x082f1446 in execute_ex (execute_data=execute_data@entry=0xf7bbf0c4) at /root/test/php-5.6.17/Zend/zend_vm_execute.h:363
#12 0x0835f272 in zend_execute (op_array=0xf7bd8f58) at /root/test/php-5.6.17/Zend/zend_vm_execute.h:388
#13 0x082b4c1e in zend_execute_scripts (type=type@entry=0x8, retval=retval@entry=0x0, file_count=file_count@entry=0x3) at /root/test/php-5.6.17/Zend/zend.c:1341
#14 0x0824ef3e in php_execute_script (primary_file=primary_file@entry=0xffffc438) at /root/test/php-5.6.17/main/main.c:2597
#15 0x08363473 in do_cli (argc=argc@entry=0x3, argv=argv@entry=0x8820878) at /root/test/php-5.6.17/sapi/cli/php_cli.c:994
#16 0x08063f04 in main (argc=0x3, argv=0x8820878) at /root/test/php-5.6.17/sapi/cli/php_cli.c:1378
#17 0xf7c40a83 in __libc_start_main (main=0x80639f0 &lt;main&gt;, argc=0x3, argv=0xffffd744, init=0x836c520 &lt;__libc_csu_init&gt;, fini=0x836c590 &lt;__libc_csu_fini&gt;, rtld_fini=0xf7feb180 &lt;_dl_fini&gt;, stack_end=0xffffd73c) at libc-start.c:287
#18 0x08063f8a in _start ()

</pre>
</div><h2>Patches</h2>
<p><a href='patch-add.php?bug_id=71331'>Add a Patch</a></p><h2>Pull Requests</h2>
<p><a href='gh-pull-add.php?bug_id=71331'>Add a Pull Request</a></p><h2 style="border-bottom:2px solid #666;margin-bottom:0;padding:5px 0;">History</h2><div id='comment_filter' class='controls comments'><span id='type_all' class='control active' onclick='do_comment(this);'>All</span><span id='type_comment' class='control ' onclick='do_comment(this);'>Comments</span><span id='type_log' class='control ' onclick='do_comment(this);'>Changes</span><span id='type_svn' class='control ' onclick='do_comment(this);'>Git/SVN commits</span><span id='type_related' class='control ' onclick='do_comment(this);'>Related reports</span>            </div>
            <div id='comments_view' style='clear:both;'>
<div class='comment type_log' ><a name="1452841247">&nbsp;</a><strong>[2016-01-15 07:00 UTC] <a href="//people.php.net/stas">stas@php.net</a></strong>
<div class='log_note'><div class="changeset">
<span class="removed">-Assigned To:</span>
<span class="added">+Assigned To: stas</span>
</div></div></div><div class='comment type_comment' ><a name="1452841247">&nbsp;</a><strong>[2016-01-15 07:00 UTC] <a href="//people.php.net/stas">stas@php.net</a></strong>
<pre class='note'>Fix in <a href="https://gist.github.com/smalyshev/853621a4627e19e57f2c" rel="nofollow">https://gist.github.com/smalyshev/853621a4627e19e57f2c</a> and security repo commit 4c2424eb24b0178456acc404dbfff528cdc44197
</pre>
</div><div class='comment type_log' ><a name="1454385476">&nbsp;</a><strong>[2016-02-02 03:57 UTC] <a href="//people.php.net/stas">stas@php.net</a></strong>
<div class='log_note'><div class="changeset">
<span class="removed">-Status: Assigned</span>
<span class="added">+Status: Closed</span>
</div></div></div><div class='comment type_comment' ><a name="1454385476">&nbsp;</a><strong>[2016-02-02 03:57 UTC] <a href="//people.php.net/stas">stas@php.net</a></strong>
<pre class='note'>The fix for this bug has been committed.

Snapshots of the sources are packaged every three hours; this change
will be in the next snapshot. You can grab the snapshot at
<a href="http://snaps.php.net/" rel="nofollow">http://snaps.php.net/</a>.

 For Windows:

<a href="http://windows.php.net/snapshots/" rel="nofollow">http://windows.php.net/snapshots/</a>
 
Thank you for the report, and for helping us make PHP better.


</pre>
</div><div class='comment type_svn' ><a name="1454388397">&nbsp;</a><strong>[2016-02-02 04:46 UTC] <a href="//people.php.net/stas">stas@php.net</a></strong>
<pre class='note'>Automatic comment on behalf of stas
Revision: <a href="http://git.php.net/?p=php-src.git;a=commit;h=4c2424eb24b0178456acc404dbfff528cdc44197" rel="nofollow">http://git.php.net/?p=php-src.git;a=commit;h=4c2424eb24b0178456acc404dbfff528cdc44197</a>
Log: Fixed <a href='bug.php?id=71331'>bug #71331</a> - Uninitialized pointer in phar_make_dirstream()
</pre>
</div><div class='comment type_comment' ><a name="1454646976">&nbsp;</a><strong>[2016-02-05 04:36 UTC] manhluat &#x61;&#116; vnsecurity &#x64;&#111;&#x74; net</strong>
<pre class='note'>Looks like i cant see this on the latest patches :D
</pre>
</div><div class='comment type_comment' ><a name="1454648404">&nbsp;</a><strong>[2016-02-05 05:00 UTC] <a href="//people.php.net/stas">stas@php.net</a></strong>
<pre class='note'>Please explain - what don't you see in latest patches?
</pre>
</div><div class='comment type_comment' ><a name="1454824034">&nbsp;</a><strong>[2016-02-07 05:47 UTC] manhluat &#x61;&#116; vnsecurity &#x64;&#111;&#x74; net</strong>
<pre class='note'>Ah, I'm sorry. I just didnt see it on <a href="http://php.net/ChangeLog-5.php" rel="nofollow">http://php.net/ChangeLog-5.php</a>
But the patches still exists in commit.
</pre>
</div><div class='comment type_comment' ><a name="1457358872">&nbsp;</a><strong>[2016-03-07 13:54 UTC] manhluat &#x61;&#116; vnsecurity &#x64;&#111;&#x74; net</strong>
<pre class='note'>hello folks,

Can we assign a CVE for this ? :)
</pre>
</div><div class='comment type_log' ><a name="1461862788">&nbsp;</a><strong>[2016-04-28 16:59 UTC] <a href="//people.php.net/remi">remi@php.net</a></strong>
<div class='log_note'><div class="changeset">
<span class="removed">-CVE-ID:</span>
<span class="added">+CVE-ID: 2016-4343</span>
</div></div></div><div class='comment type_svn' ><a name="1462200698">&nbsp;</a><strong>[2016-05-02 14:51 UTC] <a href="//people.php.net/jpauli">jpauli@php.net</a></strong>
<pre class='note'>Automatic comment on behalf of stas
Revision: <a href="http://git.php.net/?p=php-src.git;a=commit;h=9649ca1630433473a307d015ba1a79a4a7a779f5" rel="nofollow">http://git.php.net/?p=php-src.git;a=commit;h=9649ca1630433473a307d015ba1a79a4a7a779f5</a>
Log: Fixed <a href='bug.php?id=71331'>bug #71331</a> - Uninitialized pointer in phar_make_dirstream()
</pre>
</div><div class='comment type_svn' ><a name="1464135716">&nbsp;</a><strong>[2016-05-25 00:21 UTC] <a href="//people.php.net/stas">stas@php.net</a></strong>
<pre class='note'>Automatic comment on behalf of stas
Revision: <a href="http://git.php.net/?p=php-src.git;a=commit;h=9649ca1630433473a307d015ba1a79a4a7a779f5" rel="nofollow">http://git.php.net/?p=php-src.git;a=commit;h=9649ca1630433473a307d015ba1a79a4a7a779f5</a>
Log: Fixed <a href='bug.php?id=71331'>bug #71331</a> - Uninitialized pointer in phar_make_dirstream()
</pre>
</div><div class='comment type_svn' ><a name="1464148277">&nbsp;</a><strong>[2016-05-25 03:51 UTC] <a href="//people.php.net/stas">stas@php.net</a></strong>
<pre class='note'>Automatic comment on behalf of stas
Revision: <a href="http://git.php.net/?p=php-src.git;a=commit;h=9649ca1630433473a307d015ba1a79a4a7a779f5" rel="nofollow">http://git.php.net/?p=php-src.git;a=commit;h=9649ca1630433473a307d015ba1a79a4a7a779f5</a>
Log: Fixed <a href='bug.php?id=71331'>bug #71331</a> - Uninitialized pointer in phar_make_dirstream()
</pre>
</div><div class='comment type_svn' ><a name="1464148332">&nbsp;</a><strong>[2016-05-25 03:52 UTC] <a href="//people.php.net/stas">stas@php.net</a></strong>
<pre class='note'>Automatic comment on behalf of stas
Revision: <a href="http://git.php.net/?p=php-src.git;a=commit;h=9649ca1630433473a307d015ba1a79a4a7a779f5" rel="nofollow">http://git.php.net/?p=php-src.git;a=commit;h=9649ca1630433473a307d015ba1a79a4a7a779f5</a>
Log: Fixed <a href='bug.php?id=71331'>bug #71331</a> - Uninitialized pointer in phar_make_dirstream()
</pre>
</div><div class='comment type_svn' ><a name="1464148438">&nbsp;</a><strong>[2016-05-25 03:53 UTC] <a href="//people.php.net/stas">stas@php.net</a></strong>
<pre class='note'>Automatic comment on behalf of stas
Revision: <a href="http://git.php.net/?p=php-src.git;a=commit;h=9649ca1630433473a307d015ba1a79a4a7a779f5" rel="nofollow">http://git.php.net/?p=php-src.git;a=commit;h=9649ca1630433473a307d015ba1a79a4a7a779f5</a>
Log: Fixed <a href='bug.php?id=71331'>bug #71331</a> - Uninitialized pointer in phar_make_dirstream()
</pre>
</div></div>
        </td>
    </tr>
</table>

<script src='js/util.js'></script>
<script src='https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js'></script>
<script src="js/jquery.cookie.js"></script>
<script>
function do_comment(nd)
{
    $('#comment_filter > .control.active').removeClass("active");
    $(nd).addClass("active");

    $.cookie('history_tab', nd.id, { expires: 365 });

    if (nd.id == 'type_all') {
        $('#comments_view > .comment:hidden').show('slow');
    } else {
        $('#comments_view > .comment').each(function(i) {
            if ($(this).hasClass(nd.id)) {
                $(this).show('slow');
            } else {
                $(this).hide('slow');
            }
        });
    }
    return false;
}
</script>
<table class="foot" cellspacing="0" cellpadding="0">
    <tr>
        <td class="foot-bar" colspan="2">&nbsp;</td>
    </tr>

    <tr>
        <td class="foot-copy">
            <small>
                <a href="https://php.net/"><img src="images/logo-small.gif" align="left" valign="middle" hspace="3" alt="PHP"></a>
                <a href="https://php.net/copyright.php">Copyright &copy; 2001-2021 The PHP Group</a><br>
                All rights reserved.
            </small>
        </td>
        <td class="foot-source">
            <small>Last updated: Sat Oct 30 19:03:34 2021 UTC</small>
        </td>
    </tr>
</table>
</body>
</html>
